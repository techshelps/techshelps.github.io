<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>End Statement</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>End Statement</H2>Description</P>
Ends a <SPAN CLASS="pop">procedure</SPAN> or block.</P>
Syntax</P>
<SPAN CLASS="lee">End</SPAN></P>
<SPAN CLASS="lee">End</SPAN> <SPAN CLASS="lee">Function </SPAN></P>
<SPAN CLASS="lee">End</SPAN> <SPAN CLASS="lee">If</SPAN></P>
<SPAN CLASS="lee">End Property</SPAN> </P>
<SPAN CLASS="lee">End Select</SPAN></P>
<SPAN CLASS="lee">End Sub</SPAN></P>
<SPAN CLASS="lee">End Type</SPAN></P>
<SPAN CLASS="lee">End With</SPAN></P>
The <SPAN CLASS="lee">End</SPAN> statement syntax has these forms</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="81pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="277pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Statement</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Terminates execution immediately. Never required by itself but may be placed anywhere in a procedure to end code execution, close files opened with the <SPAN CLASS="lee">Open</SPAN> statement and to clear <SPAN CLASS="pop">variables</SPAN>.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End Function</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required to end a <SPAN CLASS="lee">Function</SPAN> statement.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End If</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required to end a block <SPAN CLASS="lee">If…Then…Else</SPAN> statement.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End Property</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required to end a <SPAN CLASS="lee">Property Let</SPAN>,<SPAN CLASS="lee"> Property Get</SPAN>, or <SPAN CLASS="lee">Property Set</SPAN> procedure.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End Select</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required to end a <SPAN CLASS="lee">Select Case</SPAN> statement.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End Sub</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required to end a <SPAN CLASS="lee">Sub</SPAN> statement.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End Type</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required to end a <SPAN CLASS="pop">user-defined type</SPAN> definition (<SPAN CLASS="lee">Type</SPAN> statement).</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">End With</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required to end a <SPAN CLASS="lee">With</SPAN> statement.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
When executed, the <SPAN CLASS="lee">End</SPAN> statement resets all <SPAN CLASS="pop">module-level</SPAN> variables and all static local variables in all <SPAN CLASS="pop">modules</SPAN>. To preserve the value of these variables, use the <SPAN CLASS="lee">Stop</SPAN> statement instead. You can then resume execution while preserving the value of those variables.</P>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;The <SPAN CLASS="lee">End</SPAN> statement stops code execution abruptly, without invoking the Unload, QueryUnload, or Terminate event, or any other Visual Basic code. Code you have placed in the Unload, QueryUnload, and Terminate events of <SPAN CLASS="pop">forms</SPAN> and <SPAN CLASS="pop">class modules</SPAN> is not executed. Objects created from class modules are destroyed, files opened using the <SPAN CLASS="lee">Open</SPAN> statement are closed, and memory used by your program is freed. Object references held by other programs are invalidated. </P>
The <SPAN CLASS="lee">End</SPAN> statement provides a way to force your program to halt. For normal termination of a Visual Basic program, you should unload all forms. Your program closes as soon as there are no other programs holding references to objects created from your public class modules and no code executing.</P>
See Also</P>
<SPAN CLASS="eln">Exit</SPAN> statement, <SPAN CLASS="eln">Function</SPAN> statement, <B>If...Then...</B><SPAN CLASS="eln">Else</SPAN> statement, <B>Property</B> <SPAN CLASS="eln">Get</SPAN> statement, <B>Property</B> <SPAN CLASS="eln">Let</SPAN> statement, <B>Property</B> <SPAN CLASS="eln">Set</SPAN> statement, <B>Select</B> <SPAN CLASS="eln">Case</SPAN> statement, <SPAN CLASS="eln">Stop</SPAN> statement, <SPAN CLASS="eln">Sub</SPAN> statement, <SPAN CLASS="eln">Type</SPAN> statement, <SPAN CLASS="eln">With</SPAN> statement.</P>
Example </P>
This example uses the <SPAN CLASS="lee">End </SPAN>Statement to end code execution if the user enters an invalid password.</P>

<pre><code>Sub Form_Load
    Dim Password, Pword
    PassWord = "Swordfish"
    Pword = InputBox("Type in your password")
    If Pword &lt;&gt; PassWord Then
        MsgBox "Sorry, incorrect password"
        End
    End If
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
