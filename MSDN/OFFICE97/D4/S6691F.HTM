<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sub-document</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H2>sub-document</H2><P>A separate logical stream of text with properties for which correspondences with the main document text are maintained. Word's headers/footers, footnotes, endnotes,<B> </B>macro procedure text, annotation text, and text within textboxes are kept in separate subdocuments. Each subdocument has its own CP coordinate space. In other words, data structures are stored in Word files that are components of these subdocuments. These data structures contain CP coordinates whose 0 point is the beginning of the subdocument text stream instead of the beginning of the main document text stream.</P>
<P>In<B> full-saved documents</B>, a simple calculation with values stored in the <B>FIB </B>produces<B> </B>the file offset of the beginning of the subdocument text streams (if they exist). The length of these streams is also stored.</P>
<P>In <B>fast-saved documents</B>, the <B>piece tables</B> of subdocuments are concatenated to the end of the main document piece table. In this case, to identify the beginning of subdocument text , you must sum the length of the main document text stream with the lengths of any subdocument text streams stored ahead of the subdocument (information stored in the <B>FIB</B>) and treat this sum as a <B>CP</B> coordinate. To retrieve the text of the subdocument, you must do lookups in the piece table, starting with the piece that contains the beginning <B>CP</B> coordinate, to find the physical location of each piece of the subdocument text stream.</P></BODY></HTML>
