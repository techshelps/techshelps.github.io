<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Stylesheet</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H2>STYLESHEET</H1></P>
A stylesheet is a collection of styles.<B> </B>In Word, each document has its own stylesheet.</P>
</P>
A style is a set of formatting information collected together and given a name.<B> </B>Word 6.0 supports paragraph and character styles, previous versions supported only paragraph styles.<B> </B>Character styles have just character formatting, paragraph styles have both character and paragraph formatting.<B> </B>The style sheet establishes a correspondence between a style code and a style definition.</P>
</P>
Note that the storage and behavior of styles has changed radically since Word 2 for Windows, beginning with nFib 63.<B> </B>Some of the differences are:</P>
Character styles are supported.</P>
The style code is called an istd, rather than an stc.</P>
The istd is a short, where the stc was a byte.</P>
The range of the istd is 0-4095, where 4095 is the null style.<B> </B>The range of the stc was 0-256, with 222 as the null style.</P>
PAPX's have a short istd at the beginning, rather than a byte stc.</P>
CHPX's are a grpprl, not a CHP.</P>
Many other changes...</P>
This document describes only the final Word 6.0 version of the stylesheet, not the Word 2.x version.</P>
</P>
The styles for a document (both paragraph and character styles) are stored in an array in each document. When new styles are created, they are added to the end of the array.<B> </B>The array can have unused slots.<B> </B>Some slots at the beginning of the array are reserved for specific styles, whether they have been created yet or not.<B> </B>Paragraph and character styles are stored in the same array.<B> </B>Each document has a separate array, so the same style will usually have a different istd in two different documents.<B> </B>Thus style matching between documents must be done by name (or by sti if the styles are built-in.)</P>
</P>
Styles are usually referred to using an istd.<B> </B>The istd is an index into an array of STD's (STyle Descriptions).<B> </B>A (doc, istd) pair uniquely identifies a style because it tells which style in which array.</P>
</P>
Parts of a style (for more information, see the STD structure below):</P>
sti: A style identifier.<B> </B>Built-in styles have an sti that indicates which built-in style they are.<B> </B>User-defined styles all have stiUser.</P>
sgc: The type of style, either paragraph or character.</P>
istdBase: The style that this style is based on.</P>
istdNext: The style that should be applied after this one.</P>
stzName: The name of a style, unique within its stylesheet.</P>
UPX: The difference between this style and the one it is based on.</P>
UPE: The properties of this style (a PAP, CHP, and/or grpprl).</P>
</P>
Every paragraph has a paragraph style.<B> </B>Every character has a character style.<B> </B>The default paragraph style is Normal (stiNormal, istdNormal).<B> </B>The default character style is Default Paragraph Font (stiNormalChar, istdNormalChar).</P>
</P>
The formatting of a paragraph (the PAP) and a character (the CHP) depend on the paragraph and character styles applied to them, as well as any additional formatting stored in the FKPs.<B> </B>The PAP and CHP are constructed in a layered fashion:</P>
For a PAP:</P>
An initial PAP is determined by getting the PAP from the paragraph's style.</P>
Any paragraph formatting stored in the file (the FKP papx's) is then applied to that PAP.</P>
For a CHP:</P>
An initial CHP is determined by getting the CHP from the paragraph's style.</P>
Properties from the character's style (the UPX.chpx.grpprl) are then applied to that CHP.</P>
Any character formatting stored in the file (the FKP chpx's) is the applied to that CHP.</P>
Note that the resulting PAP and CHP have fields that indicate what style was applied: PAP.istd, CHP.istd.</P>
</P></BODY></HTML>
