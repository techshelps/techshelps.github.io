<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Shape Container    msofbtSpContainer</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H3>Shape Container    msofbtSpContainer</H3>A shape is the elemental object that composes a drawing. All graphical figures on a drawing are shapes. Each shape has a list of properties, which is stored in an array. A shape container contains the following records:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="109pt" VALIGN="TOP"><COL WIDTH="111pt" VALIGN="TOP"><COL WIDTH="178pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Record Type</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Condition</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Comments</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtSpgr</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Shape is a group shape.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Group-shape-specific information.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtSp</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Always.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A shape atom record. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtOPT</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Always.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The properties of a shape. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtAnchor or msofbtChildAnchor or msofbtClientAnchor</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Always, except for the background shape.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The anchor or location of the shape. If the shape is saved to a clipboard, a msofbtAnchor record is used. If the shape is a child of a group shape, a msofbtChildAnchor is used. Otherwise, for top-level shapes, a host anchor record is present. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtClientData</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Always.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A client data record, the content of which is up to the host.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtClientTextbox or msofbtTextbox</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Shape has attached text.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">If the shape has text, a text record is written. For clipboard streams, a msofbtTextbox record is used. Otherwise, a msofbtClientTextbox record is used, the content of which is up to the host.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtOleObject</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Shape is an OLE object.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Used only in the clipboard format.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">msofbtDeletedPspl</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Shape is deleted.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Link to previous spot of object.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<H4 CLASS="h3"><A NAME="sec0"></A>Group Shape Record    msofbtSpgr</H4>This record is present only in group shapes (not shapes <I>in</I> groups, shapes that <I>are </I>groups). The group shape record defines the coordinate system of the shape, which the anchors of the child shape are expressed in. All other information is stored in the shape records that follow. </P>

<pre><code>typedef struct _FSPGR
   {
   RECT   rcgBounds;
   } FSPGR;</code></pre>
<H4 CLASS="h3"><A NAME="sec1"></A>Shape Record    msofbtSp</H4>The instance field of the record header contains the shape type; the record itself contains the shape ID and a group of persistent flags:</P>

<pre><code>typedef struct _FSP
   {
   MSOSPID  spid;           // The shape id 
   ULONG    grfPersistent;
   } FSP;
</code></pre>
The flags for the shape are:</P>

<pre><code>typedef struct 
{
   ULONG fGroup : 1;        // This shape is a group shape
   ULONG fChild : 1;        // Not a top-level shape
   ULONG fPatriarch : 1;    // This is the topmost group shape.
                            // Exactly one of these per drawing. 
   ULONG fDeleted : 1;      // The shape has been deleted
   ULONG fOleShape : 1;     // The shape is an OLE object
   ULONG fHaveMaster : 1;   // Shape has a hspMaster property
   ULONG fFlipH : 1;        // Shape is flipped horizontally
   ULONG fFlipV : 1;        // Shape is flipped vertically
   ULONG fConnector : 1;    // Connector type of shape
   ULONG fHaveAnchor : 1;   // Shape has an anchor of some kind
   ULONG fBackground : 1;   // Background shape
   ULONG fHaveSpt : 1;      // Shape has a shape type property
   ULONG reserved : 20;     // Not yet used
}
</code></pre>
<H4 CLASS="h3"><A NAME="sec2"></A>Property Table Record    msofbtOPT</H4>A shape's properties are stored in a sorted array of property id-value pairs.  Only the properties that differ from the per-shape-type defaults or the per-property defaults are saved.  (Note that the per-property defaults are unrelated to the default property table stored in the drawing group container).</P>
<P>The format of a property table record is in another section of this document. </P>
<H4 CLASS="h3"><A NAME="sec3"></A>Anchor Record    msofbtAnchor</H4>An anchor record is used for top-level shapes when the shape streamed to the clipboard. The content of the record is simply a RECT with a coordinate system of 100,000 units per inch and origin in the top-left of the drawing.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>Child Anchor Record    msofbtChildAnchor</H4>A child anchor record is used for all shapes that belong to a group. The content of the record is simply a RECT in the coordinate system of the parent group shape. </P>
<H4 CLASS="h3"><A NAME="sec5"></A>Textbox Record    msofbtTextbox</H4>A textbox record is used when a shape with attached text is written to a clipboard stream. It just contains an RTF string.</P>
<H4 CLASS="h3"><A NAME="sec6"></A>OLE Object Record    msofbtOleObject</H4>An OLE object record is present when a shape that is an OLE object is saved to the clipboard.  It contains the OLE object's storage, serialized using OleConvertIStorageToOLESTREAM. </P>
<H4 CLASS="h3"><A NAME="sec7"></A>Deleted PSPL Record    msofbtDeletedPspl</H4>Top-level deleted shapes save a pointer back into their former position in the shape tree, so that if they are undeleted via undo they can be easily put back into the main shape tree.</P>
The record consists of a single FPSPL:</P>

<pre><code>// FPSPL - File PSPL
typedef struct _FPSPL 
   {
   union
      {
      ULONG lAll;
      struct
         {
         ULONG spid : 30;   // The SPID of the shape PSPL points at.
         ULONG fFirst : 1;  // Is this a pointer to the m_splFirst?
         ULONG fLast  : 1;  // Is this a pointer to the m_splLast?
         };
      };
   } FPSPL;</code></pre></FONT></BODY>
</HTML>
