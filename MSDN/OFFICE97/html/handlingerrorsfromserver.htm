<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handling Errors from the Server</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h2><a name="handlingerrorsfromserver"></a>Handling Errors from the Server</h2>
<p>
Whenever your application causes an error to occur on the server, Microsoft Access displays two messages: first the Microsoft Access error message and then the message from the server. If you trap an ODBC error (numbered 3146 through 3299) in a Visual Basic procedure, the <b>Err</b> object returns both the Microsoft Access message and all server error messages concatenated together. The value returned by the <b>Err</b> object tells you which server error occurred as well as the text of the server error message.</p>
<p>
The following error-handling code demonstrates how you can obtain the server error number and message when an ODBC error occurs.</p>
<pre><code>Dim intRemoteError As Integer, strErrorText As String
Dim intNumStart As Integer, intTextStart As Integer

Select Case Err
&#09;Case 3146 To 3299&#09;&#09;&#09;' It's an ODBC error, so parse it.
&#09;&#09;' Find error number.
&#09;&#09;intNumStart = InStr(Err, &quot;(#&quot;) + 2
&#09;&#09;intRemoteError = Val(Mid$(Err, intNumStart))

&#09;&#09;' Find error message.
&#09;&#09;intTextStart = InStr(Err, &quot;] &quot;) + 2
&#09;&#09;strErrorText = Mid$(Err, intTextStart, _
&#09;&#09;&#09;intNumStart - intTextStart - 3)
&#09;&#09;.
&#09;&#09;. ' Handle remote error.
&#09;&#09;.
&#09;Case Else
&#09;&#09;.
&#09;&#09;. ' Handle other errors.
&#09;&#09;.
End Select
</code></pre>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;For more information on errors, search the Help index for “errors.”</p>
</FONT></FONT></BODY>
</HTML>
