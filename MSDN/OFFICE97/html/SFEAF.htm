<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Argument Information</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Argument Information</H2><P CLASS="t">The argument-constructor functions in dispargs.c place argument information in global arrays.</P>

<pre><code><FONT FACE="Courier" SIZE="2">int            g_iArgCount;
int            g_iNamedArgCount;
VARIANTARG    g_aVargs[MAX_DISP_ARGS];
DISPID        g_aDispIds[MAX_DISP_ARGS + 1];    
LPOLESTR        g_alpszArgNames[MAX_DISP_ARGS + 1];
WORD            g_awFlags[MAX_DISP_ARGS];
</FONT></code></pre>
<P></P>
<P></P>
<P></P>
<P CLASS="t">The Vargs array contains the argument values; the lpszArgNames array contains the argument names (unnamed arguments have NULL names); and the wFlags array contains argument flags (such as NOFREEVARIANT). The information in these arrays is used to build the argument list for an IDispatch interface call. The arrays in dispargs.c are statically allocated to reduce complexity; this places a limit on the number of arguments that can be passed. To remove this limit and manage memory more effectively, the code could be modified to allocate memory dynamically.</P>
<P CLASS="t">When the Invoke function is called, it uses the IDispatch::GetIDsOfNames function to convert the names in the lpszArgNames array into DISPID values for the IDispatch::Invoke function. The resulting DISPID values are placed in the DispIds array. The first element of the DispIds array is the DISPID of the method or property, and the first element of the lpszArgNames array is the method or property name.</P></FONT>
</FONT></BODY></HTML>
