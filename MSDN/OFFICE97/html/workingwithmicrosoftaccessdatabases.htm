<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with Microsoft Access Databases</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h2><a name="workingwithmicrosoftaccessdatabases"></a>Working with Microsoft Access Databases</h2>
<p>
You can access data from tables located in external Microsoft Access databases from your Microsoft Access application. The procedures for linking and opening external Microsoft Access tables directly are very similar to those for linking and opening tables in other external databases. The one difference is that you don’t need to specify a source database type.</p>
<h3>Linking an External Microsoft Access Table</h3>
<p>
To link an external Microsoft Access table to your local Microsoft Access database, use the <b>CurrentDb</b> function to return an object variable that represents the current Microsoft Access database. Then create a <b>TableDef</b> object and set the connection string and source table name: set the <b>TableDef</b> object’s<b> Connect</b> property to specify the full path to the external table and set its <b>SourceTableName</b> property to the name of the external table. This method works for databases created in Microsoft Access versions 1.<i>x</i>, 2.0, 7.0, and 8.0.</p>
<p>
The following example links an external Microsoft Access table and then displays a message box as confirmation. Notice that the connection string begins with just a semicolon (;) rather than a source database type. It isn’t necessary to specify a source database type in your connection string when you access data from external databases that use Microsoft Jet. This example assumes you want to link the Accounts table in a Microsoft Access database named AP.mdb, which is located on the server and shared folder \\Access\Data.</p>
<pre><code>Sub LinkAccessTable()
&#09;Dim dbs As Database
&#09;Dim tdf As TableDef

&#09;' Open the Microsoft Access database.
&#09;Set dbs = CurrentDb

&#09;' Create a TableDef object.
&#09;Set tdf = dbs.CreateTableDef(&quot;Linked Accounts Table&quot;)

&#09;' Set the connection string to specify the full path to the file that
&#09;' contains the table you want to link.
&#09;tdf.Connect = &quot;;DATABASE=\\Access\Data\AP.mdb&quot;

&#09;' Set the SourceTableName property to the name of the table you want to access.
&#09;tdf.SourceTableName = &quot;Accounts&quot;

&#09;' Append the TableDef object to the TableDefs collection to create a link.
&#09;dbs.TableDefs.Append tdf

&#09;' Display the confirmation message.
&#09;MsgBox &quot;Finished linking &quot; &amp; tdf.SourceTableName &amp; &quot;.&quot;, 0
End Sub
</code></pre>
<p>
<img src="abac18_1.gif" border=0></p>
<p>
Tip   Instead of specifying the connection string and source table name by setting properties of the <b>TableDef</b> object, you can specify them by using the<i> connect</i> and <i>source</i> arguments of the <b>CreateTableDef</b> method. You can also use the Microsoft Access user interface to link external data. For more information on using the<b> CreateTableDef</b> method or the user interface to link external data, see “Linking External Tables” earlier in this chapter.</p>
<h3>Opening an External Microsoft Access Table</h3>
<p>
To open an external Microsoft Access table directly, create a <b>Database</b> object and set the arguments of the <b>OpenDatabase</b> method to specify the full path to the external table, whether to open the table exclusively, whether to open it with read/write or read-only permissions, and the source database type.</p>
<p>
The following example opens an external Microsoft Access table directly from a Microsoft Access database and then creates a <b>Recordset</b> object from the table. Notice that source database type is a zero-length string (&quot;&quot;). It isn’t necessary to specify a source database type in your connection string when you access data from external databases that use Microsoft Jet.</p>
<pre><code>Sub OpenAccessTable()
&#09;Dim dbs As Database
&#09;Dim rstAccounts As Recordset

&#09;' Open an external Microsoft Access database named AP.mdb
&#09;' without exclusive access and with read/write permissions.
&#09;Set dbs = OpenDatabase(&quot;\\Access\Data\AP.mdb&quot;, False, False, &quot;&quot;)

&#09;' Create a Recordset object from the Accounts table.
&#09;Set rstAccounts = dbs.OpenRecordset(&quot;Accounts&quot;)
End Sub
</code></pre>
</FONT></FONT></BODY>
</HTML>
