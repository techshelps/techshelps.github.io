<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>REGISTER (Form 1)</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>REGISTER (Form 1)</H2><P CLASS="t">Called from a Microsoft Excel XLM macro sheet or DLL. This function makes a&nbsp;function or command in a DLL or command available to Microsoft Excel, and&nbsp;returns the register ID identifying the function for use by CALL and UNREGISTER.</P>
<P CLASS="t">Returns the register ID of the function (xltypeNum), which can be used in subsequent CALL and UNREGISTER calls.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>Syntax</H4><P CLASS="t">From a macro sheet:</P>

<pre><code><FONT FACE="Courier" SIZE="2">REGISTER(module_text,procedure,type_text,function_text,<BR>argument_text,macro_type,category,shortcut_text)
</FONT></code></pre>
<P CLASS="t">From a DLL:</P>

<pre><code><FONT FACE="Courier" SIZE="2">Excel4(xlfRegister, LPXLOPER pxRes, 8,
    LPXLOPER pxModuleText,   LPXLOPER pxProcedure,
    LPXLOPER pxTypeText,     LPXLOPER pxFunctionText,
    LPXLOPER pxArgumentText, LPXLOPER pxMacroType,
    LPXLOPER pxCategory,     LPXLOPER pxShortcutText);
</FONT></code></pre>
<P CLASS="term1"><I>module_text</I> (xltypeStr)</P>
<P CLASS="dt1">The name of the DLL containing the function.</P>
<P CLASS="term1"><I>procedure</I> (xltypeStr or xltypeNum)</P>
<P CLASS="dt1">If a string, the name of the function to call. If a number, the ordinal export number of the function to call. For clarity and robustness, always use the string&nbsp;form.</P>
<P CLASS="term1"><I>type_text</I> (xltypeStr)</P>
<P CLASS="dt1">An optional string specifying the types of all the arguments to the function and the type of the return value of the function. For more information, see the following "Remarks" section. This argument can be omitted for a stand-alone DLL (XLL) that includes an xlAutoRegister function.</P>
<P CLASS="term1"><I>function_text</I> (xltypeStr)</P>
<P CLASS="dt1">The name of the function as it will appear in the Function Wizard. This argument is optional; if omitted, the function will not be available in the Function Wizard, and it can be called only using the CALL function.</P>
<P CLASS="term1"><I>argument_text</I> (xltypeStr)</P>
<P CLASS="dt1">An optional text string describing the arguments to the&nbsp;function. The user sees this in the Function Wizard. If omitted, it will be constructed based on the <I>type_text.</I></P>
<P></P>
<P></P>
<P></P>
<P CLASS="term1"><I>macro_type</I> (xltypeNum)</P>
<P CLASS="dt1">An optional argument indicating the type of function. Use 0 for none, 1 for a function (default), or 2 for a command. This argument can be used to define hidden functions (use <I>macro_type</I> = 0) or to define functions available only from macro sheets (use <I>macro_type</I> = 2).</P>
<P CLASS="term1"><I>category</I> (xltypeStr or xltypeNum)</P>
<P CLASS="dt1">An optional argument allowing you to specify which category the new function or command should belong to. The Function Wizard divides functions by type (category). You can specify a category name or a sequential number, where the number is the position in which the category appears in the Function Wizard. For more information, see "Category Names" on page 225. If omitted, the User Defined category is assumed.</P>
<P CLASS="term1"><I>shortcut_text</I> (xltypeStr)</P>
<P CLASS="dt1">A one-character, case-sensitive string specifying the control key that will be assigned to this command. For example, "A" will assign this command to CONTROL+SHIFT+A. This argument is optional and is used for commands only.</P>
<P></P>
<H4 CLASS="h4"><A NAME="sec1"></A>Remarks</H4><H5 CLASS="h5"><A NAME="sec2"></A>Data Types</H5><P CLASS="t">In the CALL, REGISTER, and REGISTER.ID functions, the <I>type_text</I> argument specifies the data type of the return value and the data types of all arguments to the DLL function or code resource. The first character of <I>type_text</I> specifies the data type of the return value. The remaining characters indicate the data types of all the arguments. For example, a DLL function that returns a floating-point number and takes an integer and a floating-point number as arguments would require "BIB" for the <I>type_text</I> argument.</P>
<P CLASS="t">The following table contains a complete list of the data type codes that Microsoft Excel recognizes, a description of each data type, how the argument or return value is passed, and a typical declaration for the data type in the C programming language.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="24pt" VALIGN="TOP"><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="68pt" VALIGN="TOP"><COL WIDTH="112pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Code</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Pass by</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>C declaration</B></P></FONT></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Logical <BR>(FALSE = 0, TRUE = 1)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Value</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">short int</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">B</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">IEEE 8-byte floating-point number</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Value</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">double</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">C</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Null-terminated string (maximum string length = 255 characters)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">char *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">D</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Byte-counted string (first byte contains length of string, maximum string length = 255 characters)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">unsigned char *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">E</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">IEEE 8-byte floating-point number</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">double *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">F</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Null-terminated string (maximum string length = 255 characters)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference (modify in place)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">char *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">G</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Byte-counted string (first byte contains length of string, maximum string length = 255 characters)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference (modify in place)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">unsigned char *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">H</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Unsigned 2-byte integer</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Value</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">unsigned short int</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">I</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Signed 2-byte integer</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Value</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">short int</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">J</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Signed 4-byte integer</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Value</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">long int</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">K</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Array</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">FP *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">L</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Logical <BR>(FALSE = 0, TRUE = 1)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">short int *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">M</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Signed 2-byte integer</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">short int *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">N</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Signed 4-byte integer</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">long int *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">O</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Array</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Three arguments are passed:<BR>unsigned short int *<BR>unsigned short int *<BR>double []</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">P</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Microsoft Excel OPER data structure</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">OPER *</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">R</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Microsoft Excel XLOPER data structure</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Reference</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">XLOPER *</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">When working with the data types displayed in the preceding table, keep the following in mind:</P>
<UL><LI CLASS="ULI1">The C-language declarations are based on the assumption that your compiler defaults to 8-byte doubles, 2-byte short integers, and 4-byte long integers.</LI><LI CLASS="ULI1">All functions in DLLs and code resources are called using the __stdcall calling&nbsp;convention. Most C compilers allow you to use the __stdcall calling convention by adding the __stdcall keyword to the function declaration, as&nbsp;shown in the following example:

<pre><code><FONT FACE="Courier" SIZE="2">__stdcall void main (rows,columns,a)
</FONT></code></pre></LI><LI CLASS="ULI1">If a function uses a pass-by-reference data type for its return value, you can pass a null pointer as the return value. Microsoft Excel will interpret the null pointer as the #NUM! error value.</LI></UL><P></P>
<P></P>
<P></P>
<P></P>
<H4 CLASS="h4"><A NAME="sec3"></A>Additional Data Type Information</H4><P CLASS="t">This section contains detailed information about the E, F, G, K, O, P, and R data types, and other information about the <I>type_text</I> argument.</P>
<H5 CLASS="h5"><A NAME="sec4"></A>E Data Type</H5><P CLASS="t">Microsoft Excel expects a DLL using the E data type to pass pointers to floating-point numbers on the stack. This can cause problems with some languages (for example, Borland C++) that expect the number to be passed on the coprocessor emulator stack. The workaround is to pass a pointer to the number on the coprocessor stack. The following example shows how to return a double from Borland C++:</P>

<pre><code><FONT FACE="Courier" SIZE="2">typedef double * lpDbl;
extern "C" lpDbl __stdcall AddDbl(double D1,
    double D2, WORD npDbl)
{
    lpDbl Result;
    Result = (lpDbl)MK_FP(_SS, npDbl);
    *Result = D1 + D2;
    return (Result);
}
</FONT></code></pre>
<H5 CLASS="h5"><A NAME="sec5"></A>F and G Data Types</H5><P CLASS="t">With the F and G data types, a function can modify a string buffer that is allocated by Microsoft Excel. If the return value type code is F or G, then Microsoft Excel ignores the value returned by the function. Instead, Microsoft Excel searches the&nbsp;list of function arguments for the first corresponding data type (F or G) and then takes the current contents of the allocated string buffer as the return value. Microsoft Excel allocates 256 bytes for the argument, so the function may return a&nbsp;larger string than it received.</P>
<H5 CLASS="h5"><A NAME="sec6"></A>K Data Type</H5><P CLASS="t">The K data type uses a pointer to a variable-size FP structure. You should define this structure in the DLL or code resource as follows:</P>

<pre><code><FONT FACE="Courier" SIZE="2">typedef struct _FP
{
    unsigned short int rows;
    unsigned short int columns;
    double array[1];        /* Actually, array[rows][columns] */
} FP;
</FONT></code></pre>
<P CLASS="t">The declaration double array[1] allocates storage only for a single-element array. The number of elements in the actual array equals the number of rows multiplied by the number of columns.</P>
<P></P>
<P></P>
<P></P>
<H5 CLASS="h5"><A NAME="sec7"></A>O Data Type</H5><P CLASS="t">The O data type can be used only as an argument, not as a return value. It passes three items: a pointer to the number of rows in an array, a pointer to the number of&nbsp;columns in an array, and a pointer to a two-dimensional array of floating-point numbers.</P>
<P CLASS="t">Instead of returning a value, a function can modify an array passed by the O data type. To do this, you could use "&gt;O" as the <I>type_text</I> argument. For more information about modifying an array, see the section<B> </B>"Modifying in Place — Functions Declared as Void" on page 225.</P>
<P CLASS="t">The O data type was created for direct compatibility with FORTRAN DLLs, which pass arguments by reference.</P>
<H5 CLASS="h5"><A NAME="sec8"></A>P Data Type</H5><P CLASS="t">The P data type is a pointer to an OPER structure. The OPER structure contains 8&nbsp;bytes of data, followed by a 2-byte identifier that specifies the type of data. With&nbsp;the P data type, a DLL function or code resource can take and return any Microsoft Excel data type.</P>
<P CLASS="t">The OPER structure is defined as follows:</P>

<pre><code><FONT FACE="Courier" SIZE="2">typedef struct _oper
{
    union
    {
        double num;
        unsigned char *str;
        unsigned short int bool;
        unsigned short int err;
        struct
        {
            struct _oper *lparray;
            unsigned short int rows;
            unsigned short int columns;
        } array;
    } val;
    unsigned short int type;
} OPER;
</FONT></code></pre>
<P CLASS="t">The <I>type</I> field contains one of the values listed in the following table.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="40pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"><COL WIDTH="102pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Type</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Val field to use</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">1</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Numeric</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">num</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">2</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">String (first byte contains length of string)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">str</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">4</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Boolean (logical)</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">bool</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">16</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Error: the error values are:<BR>    0    #NULL!<BR>    7    #DIV/0!<BR>    15    #VALUE!<BR>    23    #REF!<BR>    29    #NAME?<BR>    36    #NUM!<BR>    42    #N/A</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">err</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">64</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Array</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">array</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">128</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Missing argument</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">256</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Empty cell</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The last two values can be used only as arguments, not return values. The missing argument value (128) is passed when the caller omits an argument. The empty cell value (256) is passed when the caller passes a reference to an empty cell.</P>
<H5 CLASS="h5"><A NAME="sec9"></A>R Data Type — Calling Microsoft Excel Functions from DLLs</H5><P CLASS="t">The R data type is a pointer to an XLOPER structure, which is an enhanced version of the OPER structure. In Microsoft Excel versions 5.0 and later, you can use the R data type to write DLLs and code resources that call Microsoft Excel functions. With the XLOPER structure, a DLL function can pass sheet references and implement flow control, in addition to passing data. For more information about flow control, see the section "Advanced Flow Control in Macro Sheets" on page&nbsp;191.</P>
<H5 CLASS="h5"><A NAME="sec10"></A>Volatile Functions and Recalculation</H5><P CLASS="t">Microsoft Excel usually calculates a DLL function (or a code resource) only when it is entered into a cell, when one of its precedents changes, or when the cell is calculated during a macro. On a worksheet, you can make a DLL function or code&nbsp;resource volatile, which means that it recalculates every time the worksheet recalculates. To make a function volatile, add an exclamation point (!) as the last character in the <I>type_text</I> argument.</P>
<P CLASS="t">For example, in Microsoft Excel for Windows, the following worksheet formula recalculates every time the worksheet recalculates:</P>

<pre><code><FONT FACE="Courier" SIZE="2">CALL("User","GetTickCount","J!")
</FONT></code></pre>
<P></P>
<P></P>
<P></P>
<H5 CLASS="h5"><A NAME="sec11"></A>Modifying in Place — Functions Declared as Void</H5><P CLASS="t">You can use a single digit <I>n</I> for the return type code in <I>type_text,</I> where <I>n</I> is a number from 1 to 9. This tells Microsoft Excel to take the value of the variable in the location pointed to by the <I>n</I>th argument in <I>type_text</I> as the return value. This is also known as modifying in place. The <I>n</I>th argument must be a pass-by-reference data type (C, D, E, F, G, K, L, M, N, O, P, or R). The DLL function or code resource also must be declared with the void keyword in the C language (or the procedure keyword in the Pascal language).</P>
<P CLASS="t">For example, a DLL function that takes a null-terminated string and two pointers to integers as arguments can modify the string in place. Use "1FMM" as the <I>type_text</I> argument, and declare the function as void.</P>
<P CLASS="t">Previous versions of Microsoft Excel used the &gt; character to modify the first argument in place — there was no way to modify any argument other than the first.&nbsp;The &gt; character is equivalent to <I>n</I> = 1 in Microsoft Excel versions 5.0 and&nbsp;later.</P>
<H5 CLASS="h5"><A NAME="sec12"></A>Handling Uncalculated Cells</H5><P CLASS="t">Appending a number sign (#) to the end of <I>type_text</I> changes the way the DLL handles uncalculated cells when called from a worksheet. If the number sign is&nbsp;present, dereferencing uncalculated cells returns the old values (this is the behavior found in the macro language). If the number sign is not present, evaluating an uncalculated cell will result in an xlretUncalced error, and the current function will be called again once the cell has been calculated. In addition, if the number sign is not present, the DLL may call only Class 1 functions. If the&nbsp;number sign is present, the DLL may call any Class 2 function. For more information about working with uncalculated cells, see the section "Dealing with&nbsp;Uncalculated Cells" on page 196.</P>
<H5 CLASS="h5"><A NAME="sec13"></A>Category Names</H5><P CLASS="t">Here are some guidelines for determining which category you should put your XLL functions in (the <I>category</I> argument to REGISTER).</P>
<UL><LI CLASS="ULI1">If the function does something that could be done by the user as a part of your add-in's user interface, you should put the function in the Commands category.</LI><LI CLASS="ULI1">If the function returns information about the state of the add-in or any other useful information, you should put the function in the Information category.</LI><LI CLASS="ULI1">An add-in should never add functions or commands to the User Defined category. This category is for the exclusive use of end users.</LI></UL><P></P>
<P></P>
<P></P>
<P></P>
<H4 CLASS="h4"><A NAME="sec14"></A>Example for a Macro</H4><P CLASS="t">The following example registers the CalcCircum function in CIRCUM.DLL, and&nbsp;then&nbsp;calls the function using the defined name for cell B1.</P>
<P CLASS="a">    <img src="CH08_04.gif"></P>
<H4 CLASS="h4"><A NAME="sec15"></A>Example</H4><P CLASS="t">See the code for the xlAutoOpen function in GENERIC.C in the FRAMEWRK directory.</P>
<H4 CLASS="h4"><A NAME="sec16"></A>Related Functions</H4><P CLASS="t">CALL, REGISTER.ID, UNREGISTER</P></FONT>
</FONT></BODY></HTML>
