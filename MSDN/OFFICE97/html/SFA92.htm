<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Defining Custom Menus and Custom Commands</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Defining Custom Menus and Custom Commands</H2><P CLASS="t">You can use the Init Menus and Init Commands subkeys to define custom menus and commands. These custom menus and commands appear every time you start Microsoft Excel and enable you to load add-ins or standard macro sheets after you choose the custom command.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">The Add-In Manager (the Add-Ins command on the Tools menu) reads and writes entries in both the Init Menus and Init Commands subkeys.</P>
<P></P>
<H3><A NAME="sec0"></A>The Init Commands Subkey</H3><P CLASS="t">The syntax for Init Commands subkey entries is as follows:</P>

<pre><code><FONT FACE="Courier" SIZE="2"><B>Entry        Value</B>
&lt;Keyword&gt;    &lt;menu_bar_num&gt;,&lt;menu_name&gt;,&lt;command_name&gt;,&lt;macro&gt;,<BR>&lt;command_position&gt;,&lt;macro_key&gt;,&lt;status_text&gt;,&lt;help_reference&gt;
</FONT></code></pre>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="100pt" VALIGN="TOP"><COL WIDTH="248pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;keyword&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A unique keyword, such as Scenario, that Microsoft Windows uses to identify commands added by an INI file.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_bar_num&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The number of the built-in menu bar to which you want to add the command.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_name&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The name of the new menu.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;command_name&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The name of the new command.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;macro&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A reference to a macro on an add-in workbook. Choosing the&nbsp;command opens the add-in and runs the specified macro.</P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="t"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;command_position&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The position of the command on the menu. This may be the name of the command after which you want to place the new command or a number indicating the command's position on&nbsp;the menu. If omitted, the command appears at the end of the menu.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;macro_key&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The key assigned to the macro, if any.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;status_text&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A message to be displayed in the status bar when the command is selected.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;help_reference&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The file name and topic number for a custom Help topic relating to the command.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The following example shows how an Init Commands entry specifies two commands to be added to built-in menu bar number 1.</P>

<pre><code><FONT FACE="Courier" SIZE="2"><B>Entry        Value</B>
Views        1, Window, &amp;View...,'C:\EXCEL\LIBRARY\VIEWS.XLA'!STUB,-,,<BR>Show or define a named view,EXCELHLP.HLP!1730
Solver        1, Formula, Sol&amp;ver...,'C:\EXCEL\LIBRARY\SOLVER\SOLVER.XLA'!STUB<BR>,,,Find solution to worksheet model,EXCELHLP.HLP!1830
</FONT></code></pre>
<H3><A NAME="sec1"></A>The Init Menus Subkey</H3><P CLASS="t">The syntax for Init Menus subkey entries is as follows:</P>

<pre><code><FONT FACE="Courier" SIZE="2"><B>Entry        Value</B>
&lt;Keyword&gt;    &lt;menu_bar_num&gt;,&lt;menu_name&gt;,&lt;menu_position&gt;
</FONT></code></pre>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="253pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;keyword&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A unique keyword, such as Custom1, that Microsoft Windows uses to identify menus added by an Init Menus registry entry.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_bar_num&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The number of the built-in menu bar to which you want to add the menu or command.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_name&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The name of the new menu.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_position&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The position of the new menu on the menu bar. This may be the name of the menu after which you want to place the new menu or a number indicating the menu's position from the left of the menu bar. If there is a menu_parent, then menu_position is the position of the new menu on the menu_parent.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_parent&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Optional. If defining a submenu, this is the menu name or number on the menu bar that will contain this new submenu.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;keyword&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A unique keyword, such as Custom1, that Microsoft Windows uses to identify menus added by an Init Menus registry entry.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_bar_num&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The number of the built-in menu bar to which you want to add the menu or command.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_name&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The name of the new menu.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_position&gt;</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The position of the new menu on the menu bar. This may be the name of the menu after which you want to place the new menu or a number indicating the menu's position from the left of the menu bar. If there is a menu_parent, then menu_position is the position of the new menu on the menu_parent.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">&lt;menu_parent&gt; </P>
<P CLASS="tt"></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Optional. If defining a submenu, this is the menu name or number on the menu bar that will contain this new submenu.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">Microsoft Excel doesn't allow more than one new level of submenus.</P>
<P></P>
<P CLASS="t">The following example shows how an Init Menus entry specifies a custom menu to be added to the right of the Window menu.</P>

<pre><code><FONT FACE="Courier" SIZE="2"><B>Entry        Value</B>
Custom1        1,Work,Window
</FONT></code></pre></FONT>
</FONT></BODY></HTML>
