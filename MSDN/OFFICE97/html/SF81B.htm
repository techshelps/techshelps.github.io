<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting the Add-In Manager</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Supporting the Add-In Manager </H2><P CLASS="t">There are some additional steps you can take to work with the Microsoft Excel Add-In Manager.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="252pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>This function</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Is called when the Add-In Manager</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="t"></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P>
<P CLASS="tr"></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="t"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xlAutoAdd()</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Adds an XLL</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="t"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xlAutoRemove()</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Removes an XLL</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="t"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xlAddInManagerInfo()</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Needs additional information from the XLL</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="t"></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P></P>
<P></P>
<P></P>
<H3><A NAME="sec0"></A>Adding New XLLs with the Add-In Manager</H3><P CLASS="t">The following steps describe how to use the Add-In Manager to add new XLLs.</P>
<P CLASS="ls">    1.    The user chooses the Add-Ins... command from the Tools menu and selects the check box next to the name of the add-in or chooses the Browse button if the add-in is in a different directory.</P>
<P CLASS="indent">    a.    If the user chooses the Browse button, the Add-In Manager displays the Browse dialog box, allowing the user to select XLA files or XLL files.</P>
<P CLASS="indent">    b.    The user chooses a file. If it is an XLL file, the Add-In Manager attempts to register and run the xlAutoAdd function in the XLL. This function takes no arguments. Your XLL can optionally display a message telling the user that the XLL is now available and how to get it.</P>
<P CLASS="ls">    2.    The Add-In Manager calls REGISTER() on the XLL, which causes the XLL's xlAutoOpen function to run.</P>
<P CLASS="ls">    3.    The Add-In Manager attempts to register and run a function called xlAutoAdd in the XLL. This function takes no arguments. It can do anything you want it to do before your add-in is added by the Add-In Manager.</P>
<P CLASS="ls">    4.    The Add-In Manager also adds an OPEN= line to the "Microsoft Excel" key in&nbsp;the registry. This causes Microsoft Excel to automatically open your XLL whenever Microsoft Excel is started.</P>
<P CLASS="ls">    5.    The Add-In Manager tries to register and call the xlAddInManagerInfo function in your XLL to find out more information about the XLL. For more information, see the section "Supporting the Add-In Manager's Long Names" on page 190.</P>
<P></P>
<H3><A NAME="sec1"></A>Removing XLLs with the Add-In Manager</H3><P CLASS="t">The following steps describe how to use the Add-In Manager to remove installed&nbsp;XLLs.</P>
<P CLASS="ls">    1.    The user runs the Add-Ins... command from the Tools menu and deselects the&nbsp;check box for the XLL.</P>
<P CLASS="ls">    2.    The Add-In Manager attempts to register and run a function called xlAutoRemove in the XLL. This function takes no arguments. It can do anything you want it to do before your add-in is removed with the Add-In&nbsp;Manager.</P>
<P CLASS="ls">    3.    The Add-In Manager calls UNREGISTER on the XLL, which causes the XLL's xlAutoClose function to run and unregisters all the functions in the XLL, removing it from memory.</P>
<P CLASS="ls">    4.    The Add-In Manager also removes the OPEN= line from the "Microsoft Excel" key in the registry.</P>
<P></P>
<P></P>
<P></P>
<H3><A NAME="sec2"></A>Supporting the Add-In Manager's Long Names</H3><P CLASS="t">The Add-In Manager can optionally display a longer, more descriptive name for&nbsp;your XLL, in addition to the file name. When running with MS-DOS, this is&nbsp;preferable to seeing only the eight-character file name. To support this, the Add-In Manager attempts to register and call a function in your XLL named xlAddInManagerInfo. This function is of type "PP", which takes a value LPXLOPER and returns a value LPXLOPER. When the Add-In Manager needs&nbsp;a&nbsp;long file name, it calls this function with 1 as the argument. Your xlAddInManagerInfo function should check this argument. If it is 1, the function should return an xltypeStr containing the long name of the XLL add-in. If the argument is not 1, the function should return #VALUE! as an xlypeErr.</P></FONT>
</FONT></BODY></HTML>
