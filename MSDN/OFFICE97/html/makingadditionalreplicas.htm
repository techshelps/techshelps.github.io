<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Making Additional Replicas</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h2><a name="makingadditionalreplicas"></a>Making Additional Replicas</h2>
<p>
Although you can make changes to the design of the database only in the Design Master replica, you can make additional replicas from any replica in the set. In fact, the only way to include new copies of the database in the replica set is to create them from an existing replica. Once you create them, all new replicas become part of the replica set.</p>
<p>
All the replicas in a replica set have a unique identity and can communicate and synchronize with one another. Each replica set is independent from all other replica sets, and replicas in different sets cannot communicate or synchronize with each other.</p>
<p>
Important   Never try to make additional replicas from the original, nonreplicated database. The result would not be an additional replica, but rather a new Design Master and replica set.</p>
<p>
When you convert your database to a Design Master by setting its <b>ReplicableBool </b>property to <b>True</b>, you have only one replica (the Design Master) in the replica set, and you make your second replica from the first. You can make your second replica, and subsequent replicas, by using the <b>Create Replica</b> command (<b>Tools</b> menu, <b>Replication</b> submenu) in Microsoft Access, or by using the <b>MakeReplica </b>method in code. For example, to make a replica of your database, you can use the following code:</p>
<pre><code>Function MakeAdditionalReplica(strReplicableDB As String, _
&#09;strNewReplica As String, intOptions As Integer) As Boolean

&#09;Dim dbs As Database
&#09;
&#09;On Error GoTo ErrorHandler

&#09;Set dbs = OpenDatabase(strReplicableDB)
&#09;
&#09;' If no options are passed to MakeAdditionalReplica, omit the options
&#09;' argument, which defaults to a full, read/write replica. Otherwise,
&#09;' use the value of intOptions.
&#09;If intOptions = 0 Then&#09;
&#09;&#09;dbs.MakeReplica strNewReplica, &quot;Replica of &quot; &amp; strReplicableDB
&#09;Else
&#09;&#09;dbs.MakeReplica strNewReplica, &quot;Replica of &quot; &amp; strReplicableDB, intOptions
&#09;End If
&#09;dbs.Close

ErrorHandler: 
&#09;Select Case Err
&#09;&#09;Case 0: 
&#09;&#09;&#09;MakeAdditionalReplica = True
&#09;&#09;&#09;Exit Function
&#09;&#09;Case Else:&#09;&#09;&#09;MsgBox &quot;Error &quot; &amp; Err &amp; &quot; : &quot; &amp; Error
&#09;&#09;&#09;MakeAdditionalReplica = False
&#09;&#09;&#09;Exit Function
&#09;End Select

End Function
</code></pre>
<p>
If you specify the <b>dbRepMakeReadOnly </b>constant<b> </b>in the <i>options</i> argument of the <b>MakeReplica</b> method, then the objects in the newly created replica cannot be modified. Otherwise, users are able to make changes to the data in the new replica. If you specify the <b>dbRepMakePartial</b> constant<b> </b>in the <i>options</i> argument of the<b> MakeReplica</b> method, you create a partial replica rather than a full replica.</p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;For more information on partial replicas, see “Replicating Part of a Database” later in this chapter.</p>
<p>
When Microsoft Jet creates the new replica, all property settings of the source replica except custom property settings are included in the new replica. You can make subsequent replicas from either the Design Master replica or from another replica in the set.</p>
<p>
Microsoft Jet locks objects while they are open in Design view or while their data is being updated. When you use the <b>MakeReplica</b> method, be sure that the objects you are replicating aren’t locked. If objects are locked when you make a replica, the <b>MakeReplica</b> method fails.</p>
<p>
<b>Note</b>&nbsp;&nbsp;&nbsp;When you make a new replica, you copy all of the objects and properties that can be replicated from the source replica to the new replica. Although you copy all linked tables, the path to a linked table may no longer be accurate because of the new replica’s location on the network. Be sure to test the new replica to determine if you need to establish a new path for any of the linked tables. You can change the path specified in the connection string of the <b>Connect</b> property for a linked table even though modifying the connection information is a design change. All other design changes must be made in the Design Master.</p>
<h3>Using Replicas Instead of Backups </h3>
<p>
With database replication, it’s no longer necessary to make a separate backup copy of your database. If the Design Master is destroyed, you can recover your data from any one of the replicas in the replica set. However, depending on how frequently you synchronize, a replica may not contain all the data in the Design Master or in other replicas. If you want to be able to recover most of the information in your Design Master, be sure to synchronize frequently.</p>
<p>
Although it’s possible to back up replicas by using traditional backup methods, it’s strongly advised not to back up and restore replicas as you would ordinary files. If you back up and restore the Design Master, you could lose critical information about changes to the design of the database as well as the ability of the Design Master to synchronize with the other replicas in the set. If the Design Master is damaged or unusable, don’t copy or restore an older version of the Design Master; instead, make another replica the Design Master.</p>
</FONT></FONT></BODY>
</HTML>
