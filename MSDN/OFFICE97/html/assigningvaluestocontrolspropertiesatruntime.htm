<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Assigning Values to Controls and Properties at Run Time</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h2><a name="assigningvaluestocontrolspropertiesatruntime"></a>Assigning Values to Controls and Properties at Run Time</h2>
<p>
By assigning values to controls and properties on a form or report while your application is running, you can make your forms and reports more responsive to your users’ needs.</p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;To find out whether you can set a particular property at run time, search the Help index for the name of the property.</p>
<p>
For example, after a user selects a customer for an order, you may want to fill in the controls that contain the shipping address with the customer’s address. You do this by assigning values to the shipping controls. Or you may want to disable some controls on the form in response to values the user enters in other controls. You do this by setting the <b>Enabled</b> property of each control to <b>False</b> when the user enters the values.</p>
<p>
In a macro, use the SetValue action, as shown in the following illustrations.</p>
<p>
<img src="abac03_3.gif" border=0></p>
<p>
If the control to which you assign a value is located on a form or report other than the one that runs the macro, you must enter its full identifier as the Item argument.</p>
<p>
<img src="abac03_4.gif" border=0></p>
<p>
If you want to use Visual Basic to assign a value to a control or property, use a simple assignment statement. To refer to a control that is located on the form or report from which you’re running the event procedure, you don’t need to use its full identifier.</p>
<pre><code>ShipCity = City 
Details.Enabled = False
</code></pre>
<p>
To refer to a control on a different form or report, use its full identifier.</p>
<pre><code>Forms!ShipForm!ShipCity = City
</code></pre>
<p>
<b>Note</b>&nbsp;&nbsp;&nbsp;Although property names with more than one word appear in the property sheet with spaces between words, you must concatenate them when you refer to them in Visual Basic. For example, to refer to the <b>RecordSource</b> property, which appears in the property sheet as Record&nbsp;Source, you would use the following line of code:</p>
<pre><code>Forms!Orders.RecordSource = &quot;OrdersQuery&quot;
</code></pre>
<h5>Example</h5>
<h5>Disabling a Command Button at Run Time</h5>
<p>
As described previously in this chapter, the Orders form in the Orders sample application includes a command button named Details that opens the ProductsPopup form. This pop-up form shows details about the current product in the Orders subform. The Details button works fine as long as the ProductID field in the current record of the subform contains a value. But if the user clicks in the new record of the Orders subform or starts a new order, then the <i>wherecondition</i> argument in the button’s <b>DoCmd.OpenForm</b> statement returns no record, and the ProductsPopup form opens with no record in it. To avoid having the ProductsPopup form show no information, you can disable the Details button when there’s no value in the ProductID field for the current record of the subform, and enable it when there is a value in the ProductID field.</p>
<p>
For example, the Current event of the Orders subform occurs when the Orders form first opens, every time the focus moves from one record to another on the subform, and every time you requery the subform. You can write an event procedure for the Current event that disables the Details button when there’s no value in the ProductID field for the current record of the subform, and enables it when there is one.</p>
<pre><code>Private Sub Form_Current()
&#09;If IsNull(ProductID) Then
&#09;&#09;Me.Parent!Details.Enabled = False
&#09;Else
&#09;&#09;Me.Parent!Details.Enabled = True
&#09;End If
End Sub
</code></pre>
<p>
The statements in this event procedure use the <b>Parent</b> property of the Orders subform to refer to the Orders form. If there’s no value in the ProductID field in the subform, the first statement sets the <b>Enabled</b> property of the Details button on the Orders form to <b>False</b> (the same as No in the property sheet). If there is a value in the field, the second statement sets the <b>Enabled</b> property to <b>True</b> (the same as Yes in the property sheet).</p>
<p>
When you use the <b>Parent</b> property to refer to the main form from an event procedure attached to a subform, the code runs only when the main form is open. If you open the subform by itself as a separate form, the code that refers to the main form doesn’t work.</p>
<p>
<b>Note</b>&nbsp;&nbsp;&nbsp;As described previously in this chapter, the Form_Current event procedure for the Orders subform also contains code that updates the record values in the ProductsPopup form to match the current record in the subform.</p>
</FONT></FONT></BODY>
</HTML>
