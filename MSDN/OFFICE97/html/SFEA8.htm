<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDispatch Step by Step</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H1>IDispatch Step by Step</H1><P CLASS="t">Using IDispatch to access exposed OLE Automation objects involves the following steps:</P>
<P CLASS="ls">    1.    Initialize OLE using the OleInitialize function.</P>
<P CLASS="ls">    2.    Create an instance of the object you wish to access using the CoCreateInstance function.</P>
<P CLASS="lt1">If the object's application is not yet running, OLE starts it and initializes the object. Note that if OLE starts the application, it may not be visible. With Microsoft Excel, you must set the Visible property for the application to make it visible.</P>
<P CLASS="ls">    3.    Obtain a reference to the object's IDispatch interface using the QueryInterface member function.</P>
<P CLASS="lt1">With Microsoft Excel, you can combine steps 2 and 3 and obtain the IDispatch reference directly from the CoCreateInstance function.</P>
<P CLASS="ls">    4.    Use the GetIDsOfNames member function to obtain the DISPID values for the&nbsp;desired method or property exposed in the object's IDispatch interface.</P>
<P CLASS="ls">    5.    Use the Invoke member function to access the method or property.</P>
<P CLASS="ls">    6.    Terminate the object by invoking the appropriate method in its IDispatch interface.</P>
<P CLASS="ls">    7.    Uninitialize OLE, using the OleUninitialize function.</P>
<P></P>
<P CLASS="t">Complete information about accessing OLE Automation objects appears in Chapter&nbsp;3 in Volume 2 of the <I>OLE 2 Programmer's Reference.</I></P>
<P></P>
<P></P>
<P></P></FONT>
</FONT></BODY></HTML>
