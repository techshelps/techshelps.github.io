<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Orienting a Style with xlVertical</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Orienting a Style with xlVertical</H2><P CLASS="t">A bug in Microsoft Excel&nbsp;97 does not allow for the proper creation of a style if the orientation of the style is xlVertical. Thus the following code, which will work in Microsoft Excel&nbsp;95, will not work in Microsoft Excel&nbsp;97:</P>

<pre><code><FONT FACE="Courier" SIZE="2">Sub NewStyle
     Set MyStyle = ThisWorkbook.Styles.Add(Name:="Test")
     MyStyle.Orientation = xlVertical
End Sub</FONT></code></pre>
<P></P>
<P></P>
<P></P>
<P CLASS="t">Creating a style at run time is not common, and the vertical orientation is probably less so. Nevertheless, developers who create styles at run time should be aware of this bug and the following workaround:</P>

<pre><code><FONT FACE="Courier" SIZE="2">Sub VerticalStyleWorkaround()
    With Selection
        .Orientation = xlVertical
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
    End With
    ActiveWorkbook.Styles.Add Name:="VerticalOrientation"
End Sub
</FONT></code></pre>
<P CLASS="t">Essentially, you must first create the style in a cell, and then add it to the selection (the coding equivalent of manually adding a style "by example").</P></FONT>
</FONT></BODY></HTML>
