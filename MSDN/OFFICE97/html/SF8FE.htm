<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xlStack</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>xlStack</H2><P CLASS="t">This function checks the amount of space left on the stack.</P>
<P CLASS="t">Returns the number of bytes (xltypeInt) remaining on the stack.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>Syntax</H4>
<pre><code><FONT FACE="Courier" SIZE="2">Excel4(xlStack, LPXLOPER pxRes, 0);
</FONT></code></pre>
<P CLASS="t">This function has no arguments.</P>
<H4 CLASS="h4"><A NAME="sec1"></A>Remarks</H4><P CLASS="t">Microsoft Excel 97 has quite a bit more stack space than previous versions. This has caused a problem, since the amount of stack space is returned as a signed integer. This means that xlStack can return a value between -32767 and 32768. The stack space in Microsoft Excel 97 typically exceeds 40K, which causes xlStack to report a value like -12076. To obtain the correct value, cast the returned&nbsp;value to an unsigned short.</P>
<P CLASS="t">Microsoft Excel has a limited amount of space on the stack, and you should take care not to overrun this space. First, never put large data structures on the stack. Make as many local variables as possible static. Avoid calling functions recursively, because that will quickly fill up the stack.</P>
<P CLASS="t">If you suspect that you are overrunning the stack, call this function frequently to see how much stack space is left.</P>
<P CLASS="t">If you desperately need more stack space than the 44K or so that you normally get, you can use the Windows functions SwitchStackTo and SwitchStackBack.</P>
<P></P>
<P></P>
<P></P>
<H4 CLASS="h4"><A NAME="sec2"></A>Example</H4><P CLASS="t">The following example displays an alert message containing the amount of stack space left.</P>
<P CLASS="t">\SAMPLES\EXAMPLE\EXAMPLE.C</P>

<pre><code><FONT FACE="Courier" SIZE="2">short int WINAPI xlStackExample(void)
{
    XLOPER xRes;
    XLOPER xAlert;

    Excel4(xlStack, (LPXLOPER)&amp;xRes, 0);

    xAlert.xltype = xltypeNum;
    // Cast to an unsigned short first to get rid of the overflow problem
    xAlert.val.num = (double)(unsigned short) xRes.val.w;
    Excel4(xlcAlert, 0, 1, (LPXLOPER)&amp;xAlert);
    return 1;
}
</FONT></code></pre></FONT>
</FONT></BODY></HTML>
