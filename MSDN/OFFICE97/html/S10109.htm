<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Line Print Subkey</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>The Line Print Subkey</H2><P CLASS="t">The following is a list of entries in a typical Line Print subkey:</P>

<pre><code><FONT FACE="Courier" SIZE="2">BotMarg
Comment<BR>LeftMarg<BR>Options<BR>PgLen<BR>RightMarg<BR>Setup 
TopMarg<BR></FONT></code></pre>
<P CLASS="t">This section controls settings used in Lotus 1-2-3 macro line printing. These settings are defined using the various Lotus 1-2-3 Worksheet Global Default Printer (/wgdp) commands and are updated in the Line Print subkey whenever Microsoft Excel encounters a Lotus 1-2-3 Worksheet Global Default Update (/wgdu) command.</P>
<P></P>
<P></P>
<P></P>
<P CLASS="t">The LeftMarg, RightMarg, TopMarg, and BotMarg entries control the respective margin settings. The values for LeftMarg and RightMarg refer to numbers of characters. While these two values can be from 0 to 1000, a standard page is 80 characters wide. The values for TopMarg and BotMarg refer to numbers of lines. While these two values can be from 0 to 240, standard 11-inch paper can accommodate a maximum of 66 lines, as indicated by the PgLen entry.</P>
<P CLASS="t">The Setup entry is equivalent to the Lotus 1-2-3 Worksheet Global Default Printer Settings (/wgdps) command and specifies the printer setup string.</P>
<P CLASS="t">The Options entry controls four global settings using an 8-bit binary number entered in hex format. Each bit is either 0, corresponding to N (no); or 1, corresponding to Y (yes). The following table lists the values used with the Options entry.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="50pt" VALIGN="TOP"><COL WIDTH="298pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Bit</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Lotus 1-2-3 /wgdp command</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">0</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Wait</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">1</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Formatted</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">2</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">AutoLf</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">3</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Port (0 through 7)</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">4</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">(Used for port)</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">5</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">(Used for port)</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The best way to determine the appropriate decimal number to use with the Options entry is to construct the binary number first and then convert it to a hex value. The default value is 0x00000002(2)&nbsp;or, in binary, 0000 0010,&nbsp;&nbsp;meaning that bit 1 is set to the value 1 (the Formatted option set to Y) while all others are set to zero (N). For example, the Options entry that is written to the registry when bits 0, 1, and 2 are set to 1 (0000 0111) is the hex value 0x00000007(7), meaning that the Wait, Formatted, and AutoLf options are set to Y.</P>
<P CLASS="t">The three bits (3, 4, and 5) that are devoted to the port indicate the setting used by Lotus 1-2-3 to specify the hardware port to be used for printing. With Microsoft Excel, this is interpreted as a logical port. The default port setting is LPT1:, meaning that bits 3, 4, and 5 are all set to zero. The following table shows the binary bit and port settings.</P>
<P></P>
<P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="135pt" VALIGN="TOP"><COL WIDTH="213pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Binary value (bits 3, 4, and 5)</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Port</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx00 0xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">LPT1:</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx00 1xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">COM1:</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx01 0xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">LPT2:</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx01 1xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">COM2:</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx10 0xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">LPT1:</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx10 1xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">LPT2:</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx11 0xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">LPT3:</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">xx11 1xxx</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">LPT4:</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">Note that in the preceeding table, LPT1: and LPT2: are each represented twice. Either combination of bits can be used with equivalent results.</P>
<P CLASS="t">The actual hex value entered in the Options entry depends on the combination of&nbsp;all the values in the preceding table. For example, if both the Formatted and AutoLf settings are turned on (bits 1 and 2 set to 1), and COM2: is the specified port (bits 3 and 4 set to 1), the Options entry value 0x0000001E(30)<I> </I>is written to the Line Print subkey, which is equivalent to the binary number 0001 1110.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">To assist you in translations between binary and decimal numbers, you can use the&nbsp;BIN2DEC and DEC2BIN add-in functions that are part of the Analysis ToolPak that is shipped with Microsoft Excel&nbsp;97. To load these functions, open&nbsp;the ADDINFNS.XLA macro sheet, located in the LIBRARY\ANALYSIS subdirectory of the directory where Microsoft Excel is installed.</P>
<P></P></FONT>
</FONT></BODY></HTML>
