<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dispargs.c</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H1>Dispargs.c</H1><P CLASS="t">Method calls more complex than the PropertyGet and PropertyPut examples shown in the preceding section require extensive setup work. Before you can call the Invoke function, each argument must be placed into the argument array. After the Invoke function call, any variant arguments that were allocated (created BSTR or SAFEARRAY values) must be freed. Creating arrays of BSTR values requires repetitive allocation, testing, and error handling.</P>
<P CLASS="t">The functions provided in dispargs.c on the sample disk (in the sample\autoxl directory) were written to simplify these tasks. The following procedure shows how to use these functions:</P>
<UL><LI CLASS="ULI1">Use the ClearAllArgs function to clear and reset the argument array.</LI><LI CLASS="ULI1">Use the AddArgument<I>Type</I> argument-constructor function(s) to set the appropriate argument(s).</LI><LI CLASS="ULI1">Use the Invoke function to invoke the method (note that this is the Invoke function in dispargs.c, not the Invoke function provided by OLE&nbsp;2).</LI><LI CLASS="ULI1">Free any arguments not automatically freed by the Invoke function.</LI><LI CLASS="ULI1">Free the return value if a return value was requested. Use the ReleaseVariant function to free variant return values and arguments.</LI></UL><P></P>
<P CLASS="t">The following sections discuss the argument-constructor functions and the Invoke function in more detail.</P></FONT>
</FONT></BODY></HTML>
