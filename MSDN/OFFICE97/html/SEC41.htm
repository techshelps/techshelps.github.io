<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL.REQUEST</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H1>SQL.REQUEST</H1><P CLASS="t">Connects with an external data source, and runs a query from a worksheet. SQL.REQUEST then returns the result as an array without the need for macro programming. If this function is not available, you must install the Microsoft Excel ODBC add-in (XLODBC.XLA).</P>
<P><B>Syntax</B></P>
<P CLASS="syn"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B>SQL.REQUEST</B></FONT>(<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B>connection_string</B></FONT>,output_ref,driver_prompt,<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B>query_text</B></FONT>,col_names_logical)</P>
<P CLASS="dt1"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B>Connection_string</B></FONT>&nbsp;&nbsp;&nbsp;supplies information, such as the data source name, user ID, and passwords, required by the driver being used to connect to a data source and must follow the driver's format. The following table provides three example connection strings for three drivers.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="79pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Driver</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Connection_string</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">dBASE</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">DSN=NWind;PWD=test</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">SQL Server</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">DSN=MyServer;UID=dbayer; PWD=123;Database=Pubs</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">ORACLE</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">DNS=My Oracle Data Source;DBQ=MYSER VER;UID=JohnS; PWD=Sesame</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><UL><LI>You must define the data source name (DSN) used in connection_string before you try to connect to it.</LI><LI>You can enter connection_string as an array or a string. If connection_string exceeds 250 characters, you must enter it as an array.</LI><LI>If SQL.REQUEST is unable to gain access to the data source using connection_string, it returns the #N/A error value.</LI></UL><P CLASS="dt1">Output_ref&nbsp;&nbsp;&nbsp;is a cell reference where you want the completed connection string placed. If you enter SQL.REQUEST on a worksheet, then output_ref is ignored.</P>
<UL><LI>Use output_ref when you want SQL.REQUEST to return the completed connection string (you must enter SQL.REQUEST on a macro sheet in this case).</LI><LI>If you omit output_ref, SQL.REQUEST does not return a completed connection string.</LI></UL><P CLASS="dt1">Driver_prompt&nbsp;&nbsp;&nbsp;specifies when the driver dialog box is displayed and which options are available. Use one of the numbers described in the following table. If driver_prompt is omitted, SQL.REQUEST uses 2 as the default.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="79pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Driver_prompt</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">1</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is always displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">2</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is displayed only if information provided by the connection string and the data source specification is not sufficient to complete the connection. All dialog box options are available.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">3</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is displayed only if information provided by the connection string and the data source specification is not sufficient to complete the connection. Dialog box options appear dimmed and unavailable if they are not required.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">4</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is not displayed. If the connection is not successful, it returns an error.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="dt1"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B>Query_text</B></FONT>&nbsp;&nbsp;&nbsp;is the SQL statement that you want to execute on the data source.</P>
<UL><LI>If SQL.REQUEST is unable to execute query_text on the specified data source, it returns the #N/A error value.</LI><LI>You can update a query by concatenating references into query_text. In the following example, every time $A$3 changes, SQL.REQUEST uses the new value to update the query.</LI></UL><P CLASS="lt1">"SELECT Name FROM Customers WHERE Balance &gt; "&amp;$A$3&amp;"".</P>
<P CLASS="lt1">Microsoft Excel limits strings to a length of 255 characters. If query_text exceeds that length, enter the query in a vertical range of cells, and use the entire range as the query_text. The values of the cells are concatenated to form the complete SQL statement.</P>
<P CLASS="dt1">Column_names_logical&nbsp;&nbsp;&nbsp;indicates whether column names are returned as the first row of the results. Set this argument to TRUE if you want the column names to be returned as the first row of the results. Use FALSE if you do not want the column names returned. If column_names_logical is omitted, SQL.REQUEST does not return column names.</P>
<P><B>Return Value</B></P>
<UL><LI>If this function completes all of its actions, it returns an array of query results or the number of rows affected by the query.</LI><LI>If SQL.REQUEST is unable to access the data source using connection_string, it returns the #N/A error value.
</LI></UL><P><B>Remarks</B></P>
<UL><LI>SQL.REQUEST can be entered as an array. When you enter SQL.REQUEST as an array, it returns an array to fit that range.</LI><LI>If the range of cells is larger than the result set, SQL.REQUEST adds empty cells to the returned array to increase it to the necessary size.</LI><LI>If the result set is larger than the range entered as an array, SQL.REQUEST returns the whole array.</LI><LI>The arguments to SQL.REQUEST are in a different order than the arguments to the SQLRequest function in Visual Basic<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">&reg;</FONT> for Applications.
</LI></UL><P><B>Example</B></P>
<P CLASS="t">Suppose you want to make a query of a dBASE database named DBASE4. When you enter the following formula in a cell, an array of query results is returned, with the first row being the column names:</P>
<P CLASS="spacing"><BR></P>
<pre><code><FONT FACE="Courier" SIZE="2">SQL.REQUEST("DSN=NWind;DBQ=c:\msquery;FIL=dBASE4", c15, 2,</FONT></code></pre>
<P CLASS="spacing"><BR></P>
<pre><code><FONT FACE="Courier" SIZE="2">"Select Custmr_ID, Due_Date from Orders WHERE order_Amt&gt;100", TRUE)</FONT></code></pre></FONT>
</FONT></BODY></HTML>
