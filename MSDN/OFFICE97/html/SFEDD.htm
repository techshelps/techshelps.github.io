<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using International Versions of Microsoft Excel</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Using International Versions of Microsoft Excel</H2><P CLASS="t">So far, you have read about running DLLs on only the U.S. version of Microsoft Excel. However, you may want to create an international DLL. This is a DLL that will work with any international version of Microsoft Excel.</P>
<P CLASS="t">The first argument to the Excel4 function, specifying which function to execute, is&nbsp;universal. Every version of Microsoft Excel uses the same function codes, although the name the user may see for the codes is different in international versions. For example, the SUM function is called SOMME in French Microsoft Excel, but it still uses function code 4. A problem arises only when you need to refer to this function by name; for example, if you want to place a SUM formula in a cell, and you are calling the FORMULA function. In the U.S. version, you could call FORMULA("=SUM(1,2)"), but this would not be understood in the French version.</P>
<P CLASS="t">To get around this problem, you can set the international bit (xlIntl). This tells&nbsp;Microsoft Excel to treat the following command as if it were executed in&nbsp;U.S.&nbsp;Microsoft Excel. As a result, setting the xlIntl bit and calling FORMULA("=SUM(1,2)") has the same effect on any version of Microsoft Excel. The French Microsoft Excel user simply sees =SOMME(1,2) entered on&nbsp;the sheet.</P>

<pre><code><FONT FACE="Courier" SIZE="2">int WINAPI InternationalExample()
{
    XLOPER xResult, xSum;

    xSum.xltype = xltypeStr;
    xSum.val.str = "\012=SUM(1,2)";

    Excel4(xlcFormula | xlIntl, &amp;xResult, 2, (LPXLOPER) &amp;xSum, 
        TempActiveRef(237,237,1,1));

    return TRUE;
}
</FONT></code></pre>
<P></P>
<P></P>
<P></P></FONT>
</FONT></BODY></HTML>
