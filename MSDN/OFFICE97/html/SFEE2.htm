<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Names in DLLs</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Setting Names in DLLs</H2><P CLASS="t">You can use DLLs even though no macro sheet is present. However, you may want to define some names to help you keep data between calls to your DLL. For example, you may want to call xlfSetName from a DLL even though there is no macro sheet where you can define the name.</P>
<P CLASS="t">For this purpose, Microsoft Excel has a special, hidden name space that is accessible only to DLLs. This allows you to store temporary names in Microsoft Excel. However, it is important to remember that this name space is shared by all&nbsp;DLLs within the same instance of Microsoft Excel. Therefore, if you want to ensure that your names do not conflict with names defined by another DLL, be sure to begin all your names with a unique prefix, preferably the name of your DLL. For example, if your DLL is called MYDLL.DLL, create names such as MYDLL_hWnd.</P>
<P></P>
<P></P>
<P></P>
<P CLASS="t">The following is a way you might use the hidden name space:</P>
<UL><LI CLASS="ULI1">You can keep instance-specific static data when running with Windows. For&nbsp;more information, see "Multiple Instances of Microsoft Excel" on page&nbsp;176.</LI></UL><P></P>
<P CLASS="t">The hidden name space is not accessible when the DLL is calculating a function on a worksheet. If the DLL function was called as part of a normal recalculation on a worksheet, names refer to the current sheet unless the DLL was registered as&nbsp;a macro type DLL (the data type string contained "#"). However, if the DLL was called from a macro sheet or if the DLL function was invoked through a menu, keyboard shortcut, toolbar, or otherwise, names will refer to the hidden name space.</P></FONT>
</FONT></BODY></HTML>
