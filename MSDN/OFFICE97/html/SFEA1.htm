<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Static Arrays</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Static Arrays</H2><P CLASS="t">If you declare and dimension an array:</P>

<pre><code><FONT FACE="Courier" SIZE="2">Dim x(5) as String
</FONT></code></pre>
<P CLASS="t">The pointer you receive in your C function points to a static array (the fFeatures element of the SAFEARRAY structure has the FADF_STATIC flag set). You can read the array, but you cannot redimension the array or modify the pointer, and you cannot copy over the array. If you need to modify the array in the DLL (to create a&nbsp;new one, for example), you must not dimension it in Visual Basic or pass a variant containing a SAFEARRAY. In the latter case, you can then free the SAFEARRAY and redirect the variant to a new SAFEARRAY created by your&nbsp;DLL.</P></FONT>
</FONT></BODY></HTML>
