<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xlGetInst</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>xlGetInst</H2><P CLASS="t">This function returns the instance handle of the instance of Microsoft Excel that is currently calling a DLL.</P>
<P CLASS="t">The instance handle (xltypeInt) will be in the val.w field.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>Syntax</H4>
<pre><code><FONT FACE="Courier" SIZE="2">Excel4(xlGetInst, LPXLOPER pxRes, 0);
</FONT></code></pre>
<P CLASS="t">This function has no arguments.</P>
<H4 CLASS="h4"><A NAME="sec1"></A>Remarks</H4><P CLASS="t">This function can be used to distinguish between multiple running instances of Microsoft Excel that are calling the DLL.</P>
<H4 CLASS="h4"><A NAME="sec2"></A>Example</H4><P CLASS="t">The following example compares the instance of the last copy of Microsoft Excel that called it to the current copy of Microsoft Excel that called it. If they are the same, it returns 1; if not, it returns 0.</P>
<P></P>
<P></P>
<P></P>
<P CLASS="t">\SAMPLES\EXAMPLE\EXAMPLE.C</P>

<pre><code><FONT FACE="Courier" SIZE="2">short WINAPI xlGetInstExample(void)
{
    XLOPER xRes;
    static HANDLE hOld = 0;
    int iRet;

    Excel4(xlGetInst, (LPXLOPER)&amp;xRes, 0);

    if((unsigned int)xRes.val.w != hOld)
        iRet = 0;
    else
        iRet = 1;

    hOld = xRes.val.w;

    return iRet;
}
</FONT></code></pre>
<H4 CLASS="h4"><A NAME="sec3"></A>Related Function</H4><P CLASS="t">xlGetHwnd</P></FONT>
</FONT></BODY></HTML>
