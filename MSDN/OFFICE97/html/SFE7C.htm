<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error Handling Ctrl-Break While MsgBox Shown</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Error Handling Ctrl-Break While MsgBox Shown</H2><P CLASS="t">Microsoft Excel&nbsp;95 does not produce a run-time error when a message box is showing and Ctrl-Break is executed (it simply dismisses the box and continues). Because Microsoft Excel&nbsp;97 will generate a run-time error in this case, you may want to add error handling around your message boxes, or at least be aware that your existing error handling will be called. When doing so, note that under Microsoft Excel&nbsp;97 there is a difference between Resume and Resume Next. Whereas Resume Next will skip two lines following the line that caused the error, Resume will simply continue. Consider the following example:</P>

<pre><code><FONT FACE="Courier" SIZE="2">Sub Excel97MsgBoxExample()
     On Error Goto ERRORHANDLER
     Application.EnableCancelKey = xlErrorHandler
     MsgBox "First"
     MsgBox "Second"    'This line gets skipped if Resume Next used
     MsgBox "Third"
     Exit Sub
ERRORHANDLER:
     MsgBox "Escape Key Hit"
     Resume             'Using Resume here ensures that no lines skipped
End Sub
</FONT></code></pre>
<P CLASS="t">Remember that the condition we are describing here does not apply to dialog boxes or UserForms.</P></FONT>
</FONT></BODY></HTML>
