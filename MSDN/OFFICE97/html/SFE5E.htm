<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Converting 16-bit API Calls</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Converting 16-bit API Calls</H2><P CLASS="t">Migrating to Microsoft Excel&nbsp;97 implies that you are running a 32-bit operating system. If your application was designed for a 16-bit operating system and makes use of 16-bit Windows API calls, these calls will have to be converted to 32-bit calls. An application with adequate error handling may mask calls to the incorrect API, so you should check that all your API calls are "wrapped" to make them operating system independent.</P>
<P></P>
<P></P>
<P></P>
<P CLASS="t">The following routine checks the operating system version and sets a variable to&nbsp;identify it. The second routine uses the OSBitness variable to call the appropriate&nbsp;API:</P>

<pre><code><FONT FACE="Courier" SIZE="2">Function OSBitness() As Integer
    If InStr(Application.OperatingSystem, "32") &gt; 0 Then
        OSBitness = 32
    Else         'default is 16 bit
        OSBitness = 16
    End If
End Function

Sub ReadIni()
If OSBitness = 16 Then
        nReturn = GetPrivateProfileString16("Reports", "ReportNumberSelected", "", sGetINIValue, 255, sINIFile)
Else
    nReturn = GetPrivateProfileString32("Reports", _
        "ReportNumberSelected", "", sGetINIValue, 255, sINIFile)
    gnReportNumSelected = Val(Left$(sGetINIValue, nReturn))
End Sub
</FONT></code></pre>
<P CLASS="t">For more information about the Win32 API and migrating from 16-bit to 32-bit, see "Calling the Win32 API" in <I>Porting Your 16-Bit Microsoft Office-Based Solutions to 32-Bit Microsoft Office</I>, at http://www.microsoft.com/officedev/techinfo/porting.htm#Calling.</P></FONT>
</FONT></BODY></HTML>
