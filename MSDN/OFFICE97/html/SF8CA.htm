<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xlDefineBinaryName</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>xlDefineBinaryName</H2><P CLASS="t">Used to allocate persistent storage for a bigdata XLOPER. Data with a defined binary name is saved with the workbook, and can be accessed by name at any&nbsp;time.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>Syntax</H4>
<pre><code><FONT FACE="Courier" SIZE="2">Excel4(xlDefineBinaryName, 0, 2, LPXLOPER pxName, LPXLOPER pxData);
</FONT></code></pre>
<P CLASS="term1"><I>pxName</I></P>
<P CLASS="dt1">String XLOPER specifying the name of the data.</P>
<P CLASS="term1"><I>pxData</I></P>
<P CLASS="dt1">Bigdata XLOPER specifying the data. When you call this function, the lpbData member of the bigdata structure should point to the data for which the name is being defined, and the cbData member should contain the length of the data in bytes.</P>
<P CLASS="dt1">If the <I>pxData</I> argument is not specified (xltypeMissing), the named allocation specified by <I>pxName</I> is deleted.</P>
<P></P>
<P></P>
<P></P>
<P></P>
<H4 CLASS="h4"><A NAME="sec1"></A>Example</H4><P CLASS="t">This example accepts a name, a pointer to data, and the length of the data. It uses the xlDefineBinaryName function to allocate memory for the data, and returns the result of the Excel4 function (success or failure).</P>

<pre><code><FONT FACE="Courier" SIZE="2">int WINAPI xlDefineBinaryNameExample(LPSTR lpszName,
    LPBYTE lpbData, long cbData)
{
    char stBuf[255];
    XLOPER xName, xData;

    lstrcpy(stBuf + 1, lpszName);
    stBuf[0] = lstrlen(lpszName);

    xName.xltype = xltypeStr;
    xName.val.str = stBuf;

    xData.xltype = xltypeBigData;
    xData.val.bigdata.h.lpbData = lpbData;
    xData.val.bigdata.cbData = cbData;

    return Excel4(xlDefineBinaryName, 0, 2, (LPXLOPER)&amp;xName,
        (LPXLOPER)&amp;xData);
}
</FONT></code></pre>
<H4 CLASS="h4"><A NAME="sec2"></A>Related Function</H4><P CLASS="t">xlGetBinaryName</P></FONT>
</FONT></BODY></HTML>
