<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ERR() Function Returns a Long</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>ERR() Function Returns a Long</H2><P CLASS="t">In Microsoft Excel&nbsp;95 there were no error codes that could not be coerced into integers. This is not the case with Microsoft Excel&nbsp;97. While the following code worked in Microsoft Excel&nbsp;95, it may return an error in Microsoft Excel&nbsp;97:</P>

<pre><code><FONT FACE="Courier" SIZE="2">Function DemoErr()
    Dim iError As Integer
    On Error GoTo ErrorHandler
    ThisWorkbook.Worksheets("Q1PineManor").Range("Lynn") = 28 / 0
    Exit Function
ErrorHandler:
    iError = Err
    MsgBox "Error Number:" &amp; iError
End Function
</FONT></code></pre>
<P CLASS="t">To restate, you should not rely on the particular error code that Microsoft Excel returns. You may run into an unexpected data type, as in the above case, and even if the data type is correct you may not get the value that you expect.</P></FONT>
</FONT></BODY></HTML>
