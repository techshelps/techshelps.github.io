<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Looking Up Names</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Looking Up Names</H2><P CLASS="t">In the XLM macro language, you can find out what names refer to simply by invoking them. The only way to do this from a DLL is to call the function xlfEvaluate, which is the equivalent of the XLM macro language function EVALUATE. In the macro language, EVALUATE is not very useful because things are evaluated automatically anyway. However, from C, xlfEvaluate is quite&nbsp;useful.</P>
<P></P>
<P></P>
<P></P>
<P CLASS="t">The xlfEvaluate function takes any string containing a valid Microsoft Excel expression (anything that could be typed into a worksheet cell) and evaluates it using the standard Microsoft Excel evaluator. For example:</P>

<pre><code><FONT FACE="Courier" SIZE="2">XLOPER x1, x2;

/* Evaluate the string "15+17" */
x1.xltype = xltypeStr;
x1.val.str = "\005" "15+17";

Excel4(xlfEvaluate, &amp;x2, 1, (LPXLOPER) &amp;x1);

/* x2 now contains 32 */
</FONT></code></pre>
<P CLASS="t">Although you can theoretically evaluate any expression, remember that the string you pass has to be parsed, which is a slow process. So if speed is important, avoid using xlfEvaluate.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">Calling xlfEvaluate is equivalent to pressing F9 in the formula bar. It cannot evaluate external references to sheets that are not open.</P>
<P></P>
<P CLASS="t">The xlfEvaluate function is most commonly used to look up the values assigned to names in a sheet. For example:</P>

<pre><code><FONT FACE="Courier" SIZE="2">XLOPER x1, x2;

/* Look up the defined name "profits" on the active sheet */
x1.xltype = xltypeStr;
x1.val.str = "\010!profits";

Excel4(xlfEvaluate, &amp;x2, 1, (LPXLOPER) &amp;x1);
Excel4(xlFree, 0, 1, (LPXLOPER) &amp;x2);

/* x2 now contains the definition of "profits" */
</FONT></code></pre>
<P CLASS="t">Note that xlfEvaluate cannot evaluate command equivalents, because they cannot be entered into cells on worksheets.</P></FONT>
</FONT></BODY></HTML>
