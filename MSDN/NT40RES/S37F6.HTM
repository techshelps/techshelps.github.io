<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Solving Users' Environment Problems by using the Registry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Solving Users' Environment Problems by using the Registry</H2><P CLASS="t">Using a Registry editor to view the contents of the Registry for a remote computer makes it easier for a system administrator to solve users' configuration problems. </P>
<P CLASS="t">Windows&nbsp;NT&nbsp;4.0 includes two tools for viewing and editing the Registry, both called Registry Editor. The traditional tool, <B>Regedt32.exe</B>, is documented more thoroughly in these chapters. The new tool, <B>Regedit.exe</B>, has a Windows&nbsp;NT Explorer interface. It has many of the same functions as <B>Regedt32</B> and an expanded search capability. Both tools are installed automatically when you install Windows&nbsp;NT on any computer.</P>
<P CLASS="t">You can use a Registry editor on your computer to view and edit the Registry of a remote computer. Then you can browse Registry entries to identify problems. To view and edit the Registry of a remote computer:</P>
<UL><LI>In <B>Regedt32</B>, from the <B>Registry</B> menu, click <B>Select Computer</B>, then type the name of the remote computer.</LI><LI>In <B>Regedit</B>, from the <B>Registry</B> menu, click <B>Connect Network Registry</B>, then type the name of the remote computer.</LI></UL><P></P>
<P CLASS="t">You can also load a copy of a hive from another computer to view and change entries, as described in "Loading Hives from a Remote Computer" in Chapter 24, "Registry Editors and Registry Administration."</P>
<P CLASS="t">Registry Editor is most useful as a tool to find the source of problems, not to edit value entries. After you find the source of a problem, Control Panel or other tools can be more safely used to solve the problem.</P>
<P CLASS="t">For example, you can easily check the user's desktop settings by examining the values under the Console and Control Panel subkeys for the user. The Console subkeys define settings for the command prompt and other character-based applications. The Control Panel subkeys in the Registry define the appearance and behavior of items in the Windows&nbsp;NT desktop.</P>
<H3><A NAME="sec0"></A>To view a user's desktop settings</H3><P>    1.    Use a Registry editor to view the Registry of the user's computer. </P>
<P>    2.    Under HKEY_USERS for the selected computer, double-click the subkey that represents the profile of the user. (The subkeys are named by the Security ID string (<I>SID_#</I>) of each user.)</P>
<P><B>Tip   </B>To determine which <I>SID_#</I> subkey is associated with a user, see the values for <B>ProfileImagePath</B> in the following Registry path:</P>
<P>HKEY_LOCAL_MACHINE\Software<BR>    \Microsoft<BR>        \Windows&nbsp;NT<BR>            \CurrentVersion<BR>                \ProfileList<BR>                    \<I>SID_#</I></P>
<P>Double-click the <B>ProfileImagePath</B> value entry. The value of <B>ProfileImagePath</B> is a binary representation of the directory name of the user's profile, which includes the user's name.</P>
<P></P>
<P>    3.    Double-click the Console subkey if the problem involves a character-based screen.</P>
<P>– Or –</P>
<P>Double-click the Control Panel subkey if the problem involves a Windows&nbsp;NT window.</P>
<P>    4.    Check values as described in the Help topic for User Preferences on the <I>Windows&nbsp;NT Workstation Resource Kit</I> CD.</P>
<P></P>
<P CLASS="t">For example, suppose a user complains that their screen turns black whenever they click the shortcut icon for a utility that runs in a command prompt window. You can select this computer in a Registry editor, and then select the following subkey:</P>
<P CLASS="t">HKEY_USERS<BR>    \<I>SID_#<BR></I>        \Console<BR>            \<I>Name of shortcut</I></P>
<P CLASS="t">In this example, if the value of <B>ScreenColors</B> is 0, both the text and the screen background have been set to black, and this is the source of the user's problem. To fix this by selecting new colors, the user can double-click the shortcut icon, press alt+spacebar  to display the <B>Control</B> menu, click <B>Properties</B>, then click the <B>Colors</B> tab. </P>
<P></P>
<P CLASS="t"><B>Tip</B></P>
<P>To change the colors or the bitmap that appear on the CTRL+ALT+DELETE logon screen, change the <B>Wallpaper</B> value entry under HKEY_USERS\.DEFAULT\Control Panel\Desktop. For example, if you want a bitmap of your company's logo on the logon screen, change the value of <B>Wallpaper</B> to specify the path and filename of the logo bitmap. </P>
<P></P>
<P></P></BODY></HTML>
