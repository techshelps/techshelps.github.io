<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reconstructing a System with Damaged Files</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Reconstructing a System with Damaged Files </H3><P CLASS="t">You might need to restore a user's system configuration and working environment if hardware fails or is being replaced, or if files have been damaged on the hard disk. You can use the Emergency Repair Disk created during Windows&nbsp;NT installation to restore the system files. However, you lose any changes that were made to the system after installation when you use the Emergency Repair Disk to repair files such as the Registry hives unless you updated hive files on the Emergency Repair Disk. To update the Emergency Repair Disk with a current copy of the Registry hive files, use Repair Disk Utility (<B>Rdisk.exe</B>), a tool installed with Windows&nbsp;NT.</P>
<P></P>
<P CLASS="t">You can use one of the following methods to reconstruct the system from backups (as described in "Backing Up and Restoring Registry Hives" in Chapter&nbsp;24, "Registry Editors and Registry Administration"):</P>
<UL><LI>Use Windows&nbsp;NT Restore to restore the Registry from tape backups<I>.</I></LI></UL><UL><LI>Start the computer by using another instance of the operating system (or by using MS-DOS for a FAT partition). Copy the backup files to the <I>Systemroot</I>\System32\Config and <I>Systemroot</I>\Profiles subdirectories. </LI></UL><P>If you attempt to restore damaged SAM or Security hives, you must use this second method. You cannot replace these hives while Windows&nbsp;NT is running. This means that if your system files are on an NTFS volume, you must have another instance of Windows&nbsp;NT available on that system to be able to restore the SAM and Security hives. Or, you can use the Emergency Repair Disk to restore the default SAM and Security hives.</P>
<UL><LI>Use <B>Regrest.exe</B>, a tool on the <I>Windows&nbsp;NT Workstation Resource Kit</I> CD. <B>Regrest</B> replaces the default files installed by Windows&nbsp;NT Setup with data from backup files, and saves the default files under other filenames.</LI></UL><P></P>
<P></P></BODY></HTML>
