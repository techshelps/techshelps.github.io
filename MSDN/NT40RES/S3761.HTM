<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Diskperf:  Enabling the Disk Counters</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Diskperf:  Enabling the Disk Counters</H2><P CLASS="t">To use the Performance Monitor physical and logical disk counters, you must first run the Diskperf utility included in Window NT. Once you run Diskperf and restart the computer, Performance Monitor can collect disk data. Otherwise, Performance Monitor displays zeros for all counter values for the disks.</P>
<P CLASS="t">Diskperf installs the Disk Performance Statistics Driver that collects data for Performance Monitor and a high-precision timer that times each disk transfer. The timer and the driver are omitted by default to avoid their overhead when you're not monitoring disk performance. This overhead has been measured at less than 1% on a 33-MHz 486 processor.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>By default, Diskperf installs the Disk Performance Statistics Driver above the fault tolerant driver, Ftdisk.sys, in the I/O Manager's disk driver stack. To monitor the physical disks in disk configurations which include Ftdisk, use the <B>diskperf&nbsp;-ye</B> option. To determine if Ftdisk is started in your configuration, use the Devices Control Panel.</P>
<P></P>
<P CLASS="t">You must be a member of the Administrator's local group on a computer to run Diskperf on it. Run Diskperf from a command prompt window. At the command prompt, type one of the following, then restart the computer: The counters remain enabled, even when you reboot, until you remove them by using the <B>diskperf&nbsp;-n</B> option.</P>
<P CLASS="spacing"><BR></P>
<PRE>c:\&gt; diskperf -y
</PRE>
<P CLASS="t">This enables the counters on a standard disk configuration.</P>
<P CLASS="t">To run diskperf on a remote computer, type one of the  commands in the following table, followed by the computer name, then restart the computer. For example: </P>
<P CLASS="spacing"><BR></P>
<PRE>diskperf -y \\<I>ComputerName</I>
</PRE>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="233pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Command</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>diskperf</B></P></TD><TD VALIGN="TOP"><P>Tells whether disk counters are enabled or disabled.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>diskperf -y</B></P></TD><TD VALIGN="TOP"><P>Enables the disk counters.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>diskperf -ye</B></P></TD><TD VALIGN="TOP"><P>Enables disk counters on mirror and stripe sets and other noncontiguous partition sets.</P>
<P>This option installs the performance statistics driver below the fault tolerant driver (Ftdisk) in the I/O stack.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>diskperf -n</B></P></TD><TD VALIGN="TOP"><P>Disables the disk counters.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P></BODY></HTML>
