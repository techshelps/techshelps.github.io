<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HKEY_CURRENT_CONFIG</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>HKEY_CURRENT_CONFIG</H2><P CLASS="t">The HKEY_CURRENT_CONFIG subtree, new to Windows&nbsp;NT&nbsp;4.0, contains configuration data for the hardware profile currently in use on the computer. This subtree is actually an alias pointing to HKEY_LOCAL_MACHINE\System\CurrentControlSet\Hardware&nbsp;Profiles\Current. The contents of the Hardware&nbsp;Profiles\Current subkey appear in this subtree.</P>
<P CLASS="t">HKEY_CURRENT_CONFIG was added to the Windows&nbsp;NT&nbsp;4.0 Registry to be compatible with the HKEY_CURRENT_CONFIG subtree in the Windows&nbsp;95 Registry. Because it was added to Windows&nbsp;NT, applications that use the HKEY_CURRENT_CONFIG subtree can run on both Windows&nbsp;95 and Windows&nbsp;NT.</P>
<P CLASS="t"><B>Warning:   </B>The Windows&nbsp;NT Registry has a different structure than the Windows 95 Registry. Hardware data is stored in different locations in the two registries. In your applications, use the standard Device Installer API or Config Manager API to change data in the Class and Enum subkeys of HKEY_CURRENT_CONFIG. If your application refers to these Registry keys by path, it will not run on both Windows&nbsp;NT and Windows&nbsp;95.</P>
<P CLASS="t">Figure 23.28 displays the structure of HKEY_CURRENT_CONFIG and demonstrates that HKEY_CURRENT_CONFIG is just another way to view the contents of HKEY_LOCAL_MACHINE\System\CurrentControlSet\Hardware&nbsp;Profiles\Current.</P>
<P><img src="xwr_v32.gif"></P>
<P>Figure 23.28   HKEY_CURRENT_CONFIG and the Hardware Profile\Current subkey of HKEY_LOCAL_MACHINE</P>
<P CLASS="t">HKEY_CURRENT_CONFIG contains data that describes the current hardware profile. </P>
<P CLASS="t">A hardware profile is a set of changes to the standard configuration of devices and services (including drivers and Win32 services) loaded by Windows&nbsp;NT when the system starts. For example, a hardware profile can include an instruction to disable (that is, not load) a driver, or an instruction to Windows&nbsp;NT to not connect an undocked laptop computer to the network. Because of the instructions in this subkey, users can modify the service configuration for a particular use while preserving the standard configuration unchanged for more general uses. </P>
<P CLASS="t">The <I>current</I> hardware profile is the one used to start Windows&nbsp;NT. Users can create multiple hardware profiles and, when Windows&nbsp;NT starts, select from them the settings they want. To create hardware profiles, use the System, Services, and Device options in Control Panel. For more information on creating hardware profiles, double-click <B>System</B> in Control Panel, click the <B>Hardware Profiles</B> tab and open Help.</P>
<P CLASS="t">In the Registry, hardware profiles are stored in the Hardware Profiles subkey in all control sets under HKEY_LOCAL_MACHINE\System. The current hardware profile appears in the Current subkey under each Hardware Profiles subkey, and the subkey under CurrentControlSet appears in HKEY_CURRENT_CONFIG. </P>
<P CLASS="t">The data in HKEY_CURRENT_CONFIG consists of profile-specific modifications to the standard service configuration. This standard configuration is defined by data stored throughout the Software and System subkeys of HKEY_LOCAL_MACHINE. Hence, the structure of HKEY_CURRENT_CONFIG is modeled on the structure of HKEY_LOCAL_MACHINE and can be thought of as a limited or condensed version of HKEY_LOCAL_MACHINE. </P>
<P CLASS="t">When the current hardware profile specifies a change to a value entry in the Software or System subkeys of HKEY_LOCAL_MACHINE, the original value in the Software or System subkey is not changed; instead that change is stored in the analogous subkey of HKEY_CURRENT_CONFIG.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>If you change a hardware profile by using a Registry editor, most drivers will be unable to read those changes. Use Control Panel to create and configure hardware profiles.</P>
<P></P>
<P CLASS="t">For example, if a user creates a hardware profile in which the Diskperf driver (which collects performance statistics for disks) is not loaded, the HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\Root\LEGACY_DISPERF subkey is not changed. Instead, the change is stored in HKEY_LOCAL_MACHINE\System\CurrentControlSet\Hardware Profiles\<I>Number</I>\System\CurrentControlSet\Enum\Root\LEGACY_DISPERF<I>.</I> </P>
<P CLASS="t">Figure 23.29 shows the subkeys in this example.</P>
<P><img src="xwr_v33.gif"></P>
<P>Figure 23.29   The Diskperf driver subkeys in HKEY_CURRENT_CONFIG and HKEY_LOCAL_MACHINE </P>
<P CLASS="t">For more information on the contents of HKEY_CURRENT_CONFIG, see "Hardware Profiles Subkey for All Control Sets" in "HKEY_LOCAL_MACHINE," earlier in this chapter. </P></BODY></HTML>
