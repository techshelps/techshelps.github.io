<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Control Sets in the Registry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Control Sets in the Registry</H2><P CLASS="t">A control set contains system configuration information, such as which device drivers and services to load and start. Control sets are stored in the Registry as subkeys of HKEY_LOCAL_MACHINE\SYSTEM. There can be several control sets, depending on how often you change system settings or have problems with the settings you choose. A typical installation of Windows&nbsp;NT contains these control set subkeys:</P>
<UL><LI>Clone</LI></UL><UL><LI>ControlSet001</LI></UL><UL><LI>ControlSet002</LI></UL><UL><LI>ControlSet003</LI></UL><UL><LI>CurrentControlSet</LI></UL><P></P>
<P CLASS="t">The CurrentControlSet subkey is a pointer to one of the ControlSet00x keys. The Clone control set is a clone of the control set used to initialize the computer (either Default or LastKnownGood), and is created by the Kernel initialization process each time you start your computer. The Clone control set is not available after a user logs on.</P>
<P CLASS="t">In order to better understand how these control sets are used, you should know about the Registry subkey HKEY_LOCAL_MACHINE\SYSTEM\Select, which contains the following values:  </P>
<UL><LI>Current</LI></UL><UL><LI>Default</LI></UL><UL><LI>Failed</LI></UL><UL><LI>LastKnownGood</LI></UL><P></P>
<P CLASS="t">Each of these values contain a REG_DWORD data type, which refers to a specific control set. For example, if the Current value is set to 0x1, then CurrentControlSet is pointing to ControlSet001. Similarly, if LastKnownGood is set to 0x2, then the Last Known Good control set is ControlSet002. The Default value is usually the same value as Current. Failed is the control set that was pointed to by Default when a user last started the computer by using the LastKnownGood control set.</P>
<P CLASS="t">The section titled "Selecting the Configuration to Use," presented earlier in this chapter, describes initializing Windows&nbsp;NT by using either the Default configuration or the LastKnownGood configuration. When you select the Default configuration, the Kernel uses the value of Default to determine which control set to use.</P>
<P CLASS="t">There are only two times when the Kernel attempts to load the LastKnownGood configuration:</P>
<UL><LI>The system is recovering from a severe or critical device driver loading error. For more information about this processing, see the section titled "ErrorControl Values," presented later in this chapter.</LI></UL><UL><LI>You select the Last Known Good Configuration from the <B>Hardware Profile/Last Known Good</B> menu.</LI></UL><P></P>
<P CLASS="t">Starting by using the LastKnownGood control set provides a way to recover from problems such as:</P>
<UL><LI>A device driver added to the system since the last startup is causing problems.</LI></UL><UL><LI>User-modified value entries in the Registry prevent the computer from starting up.</LI></UL><P></P>
<P CLASS="t">The LastKnownGood option is useful only in cases of incorrect configurations. It does not solve problems caused by corrupted or missing device drivers or files. </P>
<P></P>
<P CLASS="t"><B>Important</B></P>
<P>If you select the Last Known Good Configuration, any configuration changes made during the last system boot are lost.</P>
<P></P>
<P CLASS="t">Once you have logged on, the CurrentControlSet is that one that is changed whenever you make changes to your configuration by using options in Control Panel. If you are manually editing a control set for some reason, the CurrentControlSet is the only one that you should change.</P>
<P CLASS="t">If you are not sure where to look under the CurrentControlSet for a particular key, you can use <B>Find Key</B> on the <B>View</B> menu of the Windows&nbsp;NT Registry Editor. Each control set contains two subkeys: Control and Services. Control contains miscellaneous system information, such as the size and location of the page file. Services contains device driver information, such as file system drivers, Kernel drivers, and status information for each. </P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>There are two Registry Editor programs on the Windows&nbsp;NT Workstation product CD, Regedt32.exe and Regedit.exe. You can use either one to view the Registry.</P>
<P></P></BODY></HTML>
