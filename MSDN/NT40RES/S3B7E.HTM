<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Signals Used by the UPS Service</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Signals Used by the UPS Service</H3><P CLASS="t">Windows&nbsp;NT uses a serial (COM) port to connect to the UPS. Table 20.1 shows the signals that the Windows&nbsp;NT UPS service uses to communicate with the UPS, the associated pin numbers, and the function each signal provides to the UPS service. You need to know which of these signals your UPS supports so that you can configure the UPS service.</P>
<P CLASS="t">If you use a UPS service provided by your UPS vendor, the signals and their usage will probably be different than the signals that the Windows&nbsp;NT UPS service uses.</P>
<P>Table 20.1    UPS serial port connections</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="90pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B>RS-232 Signal</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>9 Pin Connector Pin #</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>25 Pin Connector Pin #</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>UPS Usage</B></P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>CTS</P></TD><TD VALIGN="TOP"><P>8</P></TD><TD VALIGN="TOP"><P>5</P></TD><TD VALIGN="TOP"><P>Power failure</P></TD></TR><TR><TD VALIGN="TOP"><P>DCD</P></TD><TD VALIGN="TOP"><P>1</P></TD><TD VALIGN="TOP"><P>8</P></TD><TD VALIGN="TOP"><P>Low battery</P></TD></TR><TR><TD VALIGN="TOP"><P>DTR</P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>20</P></TD><TD VALIGN="TOP"><P>UPS shutdown</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">In the <B>UPS Configuration</B> group box, check the boxes that correspond to the signals that your UPS supports. For each of these signals, the <B>UPS Interface Voltages</B> (negative or positive) indicates the voltage present when that event occurs. </P>
<H4><A NAME="sec0"></A>Low Battery Signal</H4><P CLASS="t">When the UPS battery begins to run low, the UPS uses this signal to notify the UPS service.</P>
<P CLASS="t">When fully charged, UPSs typically deliver from five to 20 minutes of DC power after AC power has failed. If your UPS can detect when the battery is running down, you should check the low battery signal box in the <B>UPS Configuration</B> group box.</P>
<P CLASS="t">If you do not check the low battery signal box, the UPS service uses the information in the <B>UPS Characteristics</B> group box to estimate how much time remains on the battery after a power failure.</P>
<H4><A NAME="sec1"></A>Remote UPS Shutdown</H4><P CLASS="t">You want to conserve the life of the UPS battery for as long as possible. The UPS service uses the UPS Shutdown signal to notify the UPS that Windows&nbsp;NT has completed its orderly shutdown and that the UPS can shut off power to the computer.</P>
<H4><A NAME="sec2"></A>Power Failure Signal </H4><P CLASS="t">The power failure signal is generated by the UPS to signal the UPS service that a power failure has occurred. The Windows&nbsp;NT processing that occurs when it receives this signal depends upon whether the UPS can send a low battery signal.</P>
<P CLASS="t">If the UPS can send a low battery signal:</P>
<UL><LI>The Windows&nbsp;NT UPS service waits the amount of time specified in the <B>Time between power failure and initial warning message</B> field of the <B>UPS Service</B> group box. It then sends a message to all users connected to the computer running Windows&nbsp;NT telling them that a power failure has occurred. No more users can connect to the computer after the message is sent.</LI></UL><UL><LI>If a signal is received from the UPS indicating that power has been restored before the low battery signal occurs, normal operations are resumed. Users are again allowed to connect to the computer.</LI></UL><UL><LI>When the UPS signals a low battery condition, the file specified in the <B>Execute Command File</B> group box is executed. After execution of this file, Windows&nbsp;NT initiates shutdown.</LI></UL><UL><LI>Once the shutdown is complete, the UPS service signals the UPS that battery power can be turned off if you have checked <B>Remote UPS Shutdown</B>.</LI></UL><P></P>
<P CLASS="t">If the UPS cannot send a low battery signal:</P>
<UL><LI>The UPS service computes the expected battery life left by dividing the <B>Battery recharge time per minute of run time</B> (in the <B>UPS Characteristics</B> group box) into the amount of time that Windows&nbsp;NT has been running. If the result is less than two minutes, then the file specified in the <B>Execute Command File</B> group box is executed and allowed 30 seconds to complete. Windows&nbsp;NT then initiates a shutdown.</LI></UL><UL><LI>If the expected battery life is greater than two minutes, the UPS service waits the amount of time specified in the <B>Time between power failure and initial warning message</B> field of the <B>UPS Service</B> group box. It then sends a message to all users connected to the computer running Windows&nbsp;NT telling them that a power failure has occurred. No more users can connect to the computer after the message is sent.</LI></UL><UL><LI>If a signal is received from the UPS indicating that power has been restored while the expected battery life is still greater than two minutes, normal operation resumes. Users are again allowed to connect to the computer.</LI></UL><UL><LI>When the calculated battery life reaches two minutes, the file specified in the <B>Execute Command File</B> group box is executed. After execution of this file, Windows&nbsp;NT initiates shutdown. If the program takes longer than 30 seconds to complete, Windows&nbsp;NT terminates it, and final shutdown take places.</LI></UL><UL><LI>Once the shutdown is complete, the UPS service signals the UPS that battery power can be turned off if you have checked <B>Remote UPS Shutdown</B>.</LI></UL></BODY></HTML>
