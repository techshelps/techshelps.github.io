<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Problems With Logon Scripts</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Troubleshooting Problems With Logon Scripts</H2><P CLASS="t">Use this list to troubleshoot the most common problems with logon scripts:</P>
<UL><LI>Make sure the logon script is in the directory specified in the Server option of Control Panel. When Windows&nbsp;NT is installed, the logon script directory is as follows:
<P CLASS="spacing"><BR></P>
<PRE><I>systemroot\</I>system32\repl\import\scripts
</PRE></LI></UL><P>The only valid path option is a subdirectory of the default logon script directory. If the path is any other directory or it uses the environment variable <B>%homepath%</B>, the logon script fails.</P>
<UL><LI>If the logon script is on an NTFS partition, make sure the user has Read permission for the logon script directory. If no permissions have been explicitly assigned, the logon script might fail without providing an error message.</LI></UL><UL><LI>Make sure the logon script has a filename extension of either .cmd or .bat. The .exe extension is also supported, but only for genuine executable programs. If you use a nondefault file extension for your processor, be sure to specify it with the filename of the logon script.</LI></UL><P>Attempting to use the .exe extension for a script file results in the following error message:</P>
<P CLASS="spacing"><BR></P>
<PRE>NTVDM CPU has encountered an illegal instruction.
</PRE>
<P>If this error message appears, close the window in which the logon script is running.</P>
<UL><LI>If the logon script is to run on a Windows for Workgroups computer, make sure the Windows&nbsp;NT domain name is specified as a startup option in the Network option of Control Panel.</LI></UL><UL><LI>Make sure any new or modified logon scripts have been replicated to all domain controllers. Replication of logon scripts happens periodically, not immediately. To manually force replication, use Server Manager. See the Server Manager chapter of the <I>Windows&nbsp;NT Server System Guide </I>for detailed information.</LI></UL><P CLASS="t"></P></BODY></HTML>
