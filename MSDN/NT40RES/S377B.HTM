<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Chapter 15 - Detecting Cache Bottlenecks</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H1>Chapter 15 - Detecting Cache Bottlenecks</H1><P CLASS="t">The <I>Windows&nbsp;NT file system cache</I> is an area of memory into which the I/O system maps recently used data from disk. When processes need to read from or write to the files mapped in the cache, the I/O Manager copies the data from or to the cache as if it were an array in memory — without buffering or calling the file system. Because memory access is quicker than file operations, the cache provides an important performance boost to the processes.</P>
<P CLASS="t">Because the cache is just a part of physical memory, it is never really a bottleneck (although memory can be). However, when there is not enough memory to create an effective cache, the file system must retrieve more data from disk. This shortage of cache space is known as a <I>cache bottleneck</I>.</P>
<P CLASS="t">The size of the Windows&nbsp;NT file system cache is continually adjusted by the Virtual Memory Manager based upon the size of physical memory and the demand for memory space. In many operating systems, administrators can tune the cache size, but the Windows&nbsp;NT cache is designed to be self-tuning; you cannot change the cache size. For more information about the Cache Manager and the Virtual Memory Manager, see Chapter 5, "Windows&nbsp;NT Workstation Architecture."</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>Cache bottlenecks are rare on workstations. More often the cache is monitored as an indication of application I/O, since almost all application file system activity is mediated by the cache.</P>
<P></P>
<P CLASS="t">Cache bottlenecks are mainly a server problem: Workstations rarely generate enough traffic to pressure the cache. However, complex programs such as CAD/CAM applications and large databases that access large blocks of multiple files and benefit from the cache will suffer when the cache is too small. Also, cache bottlenecks only affect applications that use the cache effectively, for example, by using data in the same sequence in which it is stored, so data requested is likely to be in the cache.</P>
<P CLASS="t">To monitor the cache, log the Memory, Cache, and Logical Disk objects for several days at a 60-second update interval, then chart the following counters:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Object</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Counter</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Memory</P></TD><TD VALIGN="TOP"><P>Cache Bytes</P></TD></TR><TR><TD VALIGN="TOP"><P>Memory</P></TD><TD VALIGN="TOP"><P>Cache Faults/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Memory</P></TD><TD VALIGN="TOP"><P>Page Fault/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Cache</P></TD><TD VALIGN="TOP"><P>Copy Reads/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Cache</P></TD><TD VALIGN="TOP"><P>Data Flushes/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Cache</P></TD><TD VALIGN="TOP"><P>Copy Read Hits%</P></TD></TR><TR><TD VALIGN="TOP"><P>Cache</P></TD><TD VALIGN="TOP"><P>Lazy Write Pages/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Cache</P></TD><TD VALIGN="TOP"><P>Lazy Write Flushes/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Cache</P></TD><TD VALIGN="TOP"><P>Read Aheads/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Logical Disk</P></TD><TD VALIGN="TOP"><P>Disk Reads/sec</P></TD></TR><TR><TD VALIGN="TOP"><P>Logical Disk</P></TD><TD VALIGN="TOP"><P>Pages Input/sec</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P></BODY></HTML>
