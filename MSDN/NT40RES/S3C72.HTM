<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Finding Service and Device Dependencies</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Finding Service and Device Dependencies</H3><P CLASS="t">This section describes using information in the Control and Services subkeys to troubleshoot problems with your computer. The next screen shot shows the CurrentControlSet and its subkeys.</P>
<P><img src="xwrjj06.gif"></P>
<P CLASS="t">When you install Windows NT, it creates the Control and Services subkeys for each control set in HKEY_LOCAL_MACHINE\SYSTEM. Some information, such as which services are part of which group, and the order in which to load the groups, is the same for all Windows NT computers. Other information, such as which devices and services to load when you start your computer, is based on the hardware installed on your computer and the network software that you select for installation.</P>
<P CLASS="t">Each control set has four subkeys:</P>
<UL><LI>Control — Contains startup data for Windows&nbsp;NT, including the maximum size of the Registry.</LI></UL><UL><LI>Enum — Contains the Plug and Play hardware tree.</LI></UL><UL><LI>Hardware Profiles — Enables you to define different configurations for your computer and select the one you want to use at startup.</LI></UL><UL><LI>Services — Lists all Kernel device drivers, file system drivers, and Win32 service drivers that can be loaded by the boot loader, the I/O Manager, and the Service Control Manager. It also contains subkeys describing which drivers are attached to which hardware devices, as well as the services that are installed on the system.</LI></UL><P></P>
<H4><A NAME="sec0"></A>ServiceGroupOrder Subkey</H4><P CLASS="t">You can see the order in which device drivers should be loaded and initialized by viewing the Registry subkey HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder. Individual drivers that are members of a service group are loaded in the following order:</P>
<UL><LI>System Bus Extender </LI></UL><UL><LI>SCSI miniport</LI></UL><UL><LI>Port</LI></UL><UL><LI>Primary disk</LI></UL><UL><LI>SCSI class</LI></UL><UL><LI>SCSI CDROM class</LI></UL><UL><LI>Filter</LI></UL><UL><LI>Boot file system</LI></UL><UL><LI>Base</LI></UL><UL><LI>Pointer Port</LI></UL><UL><LI>Keyboard Port</LI></UL><UL><LI>Pointer Class</LI></UL><UL><LI>Keyboard Class</LI></UL><UL><LI>Video Init</LI></UL><UL><LI>Video</LI></UL><UL><LI>Video Save</LI></UL><UL><LI>File system</LI></UL><UL><LI>Event log</LI></UL><UL><LI>Streams Drivers</LI></UL><UL><LI>PNP_TDI</LI></UL><UL><LI>NDIS</LI></UL><UL><LI>TDI</LI></UL><UL><LI>NetBIOSGroup</LI></UL><UL><LI>SpoolerGroup</LI></UL><UL><LI>NetDDEGroup</LI></UL><UL><LI>Parallel arbitrator</LI></UL><UL><LI>Extended base</LI></UL><UL><LI>RemoteValidation</LI></UL><UL><LI>PCI Configuration</LI></UL><P></P>
<P CLASS="t">"Service Groups," presented later in this chapter, lists drivers that are in each group.</P>
<H4><A NAME="sec1"></A>Services Subkey</H4><P CLASS="t">The Registry subkey HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\<I>Service name</I> controls how services are loaded. This section describes some of the value entries for this subkey, with an explanation of their values. The next screen shot shows the subey HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation and its value entries.</P>
<P><img src="xwrjj07.gif"></P>
<P>Figure 36.1    The Registry subkey HKEY_LOCAL_MACHINE\SYSTEM<BR>\CurrentControlSet\Services\LanmanWorkstation</P>
<H5 CLASS="h4"><A NAME="sec2"></A>DependOnGroup Value Entry</H5><P CLASS="t">When a subkey has a value for the DependOnGroup value entry, at least one service from the group must be loaded before this service is loaded. This table shows services that have a value for DependOnGroup. The LanmanWorkstation service, shown in Figure 36.1, has a value for the DependOnGroup value entry.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="113pt" VALIGN="TOP"><COL WIDTH="232pt" VALIGN="TOP"><COL WIDTH="13pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Service</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Depends on</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Cdfs</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>SCSI CDROM Class</P></TD></TR><TR><TD VALIGN="TOP"><P>Cdrom</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>SCSI miniport</P></TD></TR><TR><TD VALIGN="TOP"><P>Disk</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>SCSI miniport</P></TD></TR><TR><TD VALIGN="TOP"><P>LanmanServer</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>TDI</P></TD></TR><TR><TD VALIGN="TOP"><P>LanmanWorkstation</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>TDI</P></TD></TR><TR><TD VALIGN="TOP"><P>LmHosts</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Network Provider</P></TD></TR><TR><TD VALIGN="TOP"><P>NetBIOS</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>TDI</P></TD></TR><TR><TD VALIGN="TOP"><P>Parallel</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Parallel arbitrator</P></TD></TR><TR><TD VALIGN="TOP"><P>Scsiprnt</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>SCSI miniport</P></TD></TR><TR><TD VALIGN="TOP"><P>Scsiscan</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>SCSI miniport</P></TD></TR><TR><TD VALIGN="TOP"><P>Sfloppy</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>SCSI miniport</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H5 CLASS="h4"><A NAME="sec3"></A>DependOnService Value Entry</H5><P CLASS="t">This value entry identifies specific services that must be loaded before this service is loaded. The "Troubleshooting Example," presented later in this chapter, shows how you can use information in the DependOnService value entry to determine which services need to be started. </P>
<P CLASS="t">This table lists the services on the example computer that have a value for DependOnServices.</P>

<TABLE COLS="5" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="59pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="79pt" VALIGN="TOP"><COL WIDTH="6pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Service</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Depends on</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B></B></P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Alerter</P></TD><TD VALIGN="TOP"><P>LanmanWorkstation</P></TD><TD VALIGN="TOP"><P></P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Browser</P></TD><TD VALIGN="TOP"><P>LanmanWorkstation</P></TD><TD VALIGN="TOP"><P>LanmanServer</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>LmHosts</P></TD></TR><TR><TD VALIGN="TOP"><P>ClipSrv</P></TD><TD VALIGN="TOP"><P>NetDDE</P></TD><TD VALIGN="TOP"><P></P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>DHCP</P></TD><TD VALIGN="TOP"><P>Afd</P></TD><TD VALIGN="TOP"><P>NetBT</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>TCP/IP</P></TD></TR><TR><TD VALIGN="TOP"><P>Messenger</P></TD><TD VALIGN="TOP"><P>LanmanWorkstation</P></TD><TD VALIGN="TOP"><P>NetBIOS</P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>NetBT</P></TD><TD VALIGN="TOP"><P>TCP/IP</P></TD><TD VALIGN="TOP"><P></P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>NetDDE</P></TD><TD VALIGN="TOP"><P>NetDDEDSDM</P></TD><TD VALIGN="TOP"><P></P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>NetLogon</P></TD><TD VALIGN="TOP"><P>LanmanWorkstation </P></TD><TD VALIGN="TOP"><P>LmHosts</P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Parallel</P></TD><TD VALIGN="TOP"><P>Parport</P></TD><TD VALIGN="TOP"><P></P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Replicator</P></TD><TD VALIGN="TOP"><P>LanmanServer</P></TD><TD VALIGN="TOP"><P>LanmanWorkstation</P></TD><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">By knowing the dependencies, you can troubleshoot a problem more effectively. For example, if you stop the Workstation service, the Alerter, Messenger, and Net Logon services are also stopped, because they are dependent upon the Workstation service. If an error occurs when you try to start the Workstation service, any of the files that are part of Workstation service could be missing or corrupt. This is also why, if you start one of the services that depend on Workstation service, the Service Control Manager will automatically start the Workstation service if it is not already running.</P>
<H5 CLASS="h4"><A NAME="sec4"></A>ErrorControl Value Entry</H5><P CLASS="t">This value entry controls whether an error during the startup of this driver will cause the system to switch to the LastKnownGood control set. If the value is 0 (Ignore, no error is reported) or 1 (Normal, error reported), startup proceeds. If the value is 2 (Severe) or 3 (Critical), an error is reported and LastKnownGood control set will be used.</P>
<P CLASS="t">The ErrorControl value for LanmanWorkstation is 0x1, which indicates that if there was an error starting LanmanWorkstation, an error would be logged in the event log, but Windows&nbsp;NT would complete startup.</P>
<H5 CLASS="h4"><A NAME="sec5"></A>ImagePath Value Entry</H5><P CLASS="t">This value entry identifies the path and file name of the driver. You can use My Computer or Windows NT Explorer to verify the existence of the named file. The ImagePath for LanmanWorkstation is %SystemRoot%\System32\Services.exe.</P>
<H5 CLASS="h4"><A NAME="sec6"></A>Start Value Entry</H5><P CLASS="t">This value entry determines when services are loaded during system startup. If a service is not starting, you need to know when and how it should be starting. Then look for the services that should have been loaded prior to this service. The values are described as follows:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="36pt" VALIGN="TOP"><COL WIDTH="67pt" VALIGN="TOP"><COL WIDTH="241pt" VALIGN="TOP"><COL WIDTH="13pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Value</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Meaning</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>0 </P></TD><TD VALIGN="TOP"><P>Boot</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Loaded by the boot loader (NTLDR or OSLOADER) <BR>during the startup sequence.</P></TD></TR><TR><TD VALIGN="TOP"><P>1 </P></TD><TD VALIGN="TOP"><P>System </P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Loaded at Kernel initialization during the load sequence.</P></TD></TR><TR><TD VALIGN="TOP"><P>2 </P></TD><TD VALIGN="TOP"><P>Auto Load </P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Loaded or started automatically at system startup.</P></TD></TR><TR><TD VALIGN="TOP"><P>3 </P></TD><TD VALIGN="TOP"><P>Load On Demand </P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Driver is manually started by the user or another process. </P></TD></TR><TR><TD VALIGN="TOP"><P>4 </P></TD><TD VALIGN="TOP"><P>Disabled </P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Driver is not to be started under any condition. If a driver is accidentally disabled, reset this value by using the Services option in Control Panel. File System drivers are the one exception to the Start value. They are loaded even if they have a start value of 4. </P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H5 CLASS="h4"><A NAME="sec7"></A>Type Value Entry</H5><P CLASS="t">The Type value entry helps you know where the service fits in the architecture. These are its possible values:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="36pt" VALIGN="TOP"><COL WIDTH="308pt" VALIGN="TOP"><COL WIDTH="13pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Value</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>0x1</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Kernel device driver.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x2 </P></TD><TD COLSPAN="2" VALIGN="TOP"><P>File System driver, which is also a Kernel device driver. </P></TD></TR><TR><TD VALIGN="TOP"><P>0x4 </P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Set of arguments for an adapter.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x10 </P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A Win32 program that can be started by the Service Controller and that obeys the service control protocol. This type of Win32 service runs in a process by itself. </P></TD></TR><TR><TD VALIGN="TOP"><P>0x20</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A Win32 service that can share a process with other Win32 services.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P></P>
<P CLASS="t">Many of the services that have a Type value of 0x20 are part of the Services.exe. For example, if your network protocol is TCP/IP, and you are configured to use a DHCP server to get IP addresses, these services that have a Type value of 0x20 are in the Services.exe:</P>
<UL><LI>Alerter</LI></UL><UL><LI>Browser</LI></UL><UL><LI>DHCP</LI></UL><UL><LI>EventLog</LI></UL><UL><LI>LanmanServer</LI></UL><UL><LI>LanmanWorkstation</LI></UL><UL><LI>LmHosts</LI></UL><UL><LI>Messenger</LI></UL><UL><LI>NtLmSsp</LI></UL><UL><LI>PlugPlay</LI></UL><P></P>
<P CLASS="t">These services are part of the NETDDE.exe:</P>
<UL><LI>NetDDE</LI></UL><UL><LI>NetDDEdsdm</LI></UL><P></P>
<H5 CLASS="h4"><A NAME="sec8"></A>Service Groups</H5><P CLASS="t">Many device drivers are arranged in groups to make startup easier. When device drivers and services are being loaded, Windows NT loads the groups in the order defined by ServiceGroupOrder. The next table shows which drivers are in each group.</P>

<TABLE COLS="5" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="86pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="80pt" VALIGN="TOP"><COL WIDTH="81pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Group name</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Services</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD></TR><TR><TD COLSPAN="5" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>BASE</P></TD><TD VALIGN="TOP"><P>Beep</P></TD><TD VALIGN="TOP"><P>KSecDD</P></TD><TD VALIGN="TOP"><P>Null</P></TD></TR><TR><TD VALIGN="TOP"><P>Boot Files System</P></TD><TD VALIGN="TOP"><P>Fastfat</P></TD><TD VALIGN="TOP"><P>Fs_Rec</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Event log</P></TD><TD VALIGN="TOP"><P>EventLog</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Extended Base</P></TD><TD VALIGN="TOP"><P>Modem<BR>Parallel</P></TD><TD VALIGN="TOP"><P>Scsiprnt</P></TD><TD VALIGN="TOP"><P>Serial</P></TD></TR><TR><TD VALIGN="TOP"><P>File System</P></TD><TD VALIGN="TOP"><P>Cdfs<BR>Msfs</P></TD><TD VALIGN="TOP"><P>Npfs</P></TD><TD VALIGN="TOP"><P>Ntfs</P></TD></TR><TR><TD VALIGN="TOP"><P>Filter</P></TD><TD VALIGN="TOP"><P>Cdaudio<BR>Changer</P></TD><TD VALIGN="TOP"><P>Diskperf <BR>Ftdisk</P></TD><TD VALIGN="TOP"><P>Simbad</P></TD></TR><TR><TD VALIGN="TOP"><P>Keyboard Class</P></TD><TD VALIGN="TOP"><P>Kbdclass</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Keyboard Port</P></TD><TD VALIGN="TOP"><P>i8042prt</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>NDIS</P></TD><TD VALIGN="TOP"><P>EE16</P></TD><TD VALIGN="TOP"><P>NDIS</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>NetBIOSGroup</P></TD><TD VALIGN="TOP"><P>NetBIOS</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>NetDDEGroup</P></TD><TD VALIGN="TOP"><P>NetDDE</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Network</P></TD><TD VALIGN="TOP"><P>Mup</P></TD><TD VALIGN="TOP"><P>Rdr</P></TD><TD VALIGN="TOP"><P>Srv</P></TD></TR><TR><TD VALIGN="TOP"><P>NetworkProvider </P></TD><TD VALIGN="TOP"><P>LanmanWorkstation</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Parallel Arbitrator</P></TD><TD VALIGN="TOP"><P>Parport</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>PCI Configuration</P></TD><TD VALIGN="TOP"><P>PCIDump</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>PlugPlay</P></TD><TD VALIGN="TOP"><P>PlugPlay</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Pointer Class</P></TD><TD VALIGN="TOP"><P>Mouclass</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Pointer Port</P></TD><TD VALIGN="TOP"><P>Busmouse</P></TD><TD VALIGN="TOP"><P>Inport</P></TD><TD VALIGN="TOP"><P>Sermouse</P></TD></TR><TR><TD VALIGN="TOP"><P>Port</P></TD><TD VALIGN="TOP"><P>none</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>PNP_TDI</P></TD><TD VALIGN="TOP"><P>NetBT</P></TD><TD VALIGN="TOP"><P>Tcpip</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Primary Disk</P></TD><TD VALIGN="TOP"><P>Abiosdsk<BR>Atdisk</P></TD><TD VALIGN="TOP"><P>Floppy</P></TD><TD VALIGN="TOP"><P>Sfloppy</P></TD></TR><TR><TD VALIGN="TOP"><P>RemoteValidation</P></TD><TD VALIGN="TOP"><P>NetLogon</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>SCSI CDROM Class</P></TD><TD VALIGN="TOP"><P>Cdrom</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>SCSI Class</P></TD><TD VALIGN="TOP"><P>Disk</P></TD><TD VALIGN="TOP"><P>Scsiscan</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>SCSI Miniport</P></TD><TD VALIGN="TOP"><P>Aha154x<BR>Aha174x<BR>aic78xx<BR>Always<BR>ami0nt<BR>amsint<BR>Arrow<BR>atapi<BR>BusLogic<BR>Cpqarray<BR>dac960nt<BR>dce376nt</P></TD><TD VALIGN="TOP"><P>Delldsa <BR>DptScsi<BR>dtc329x<BR>Fd16_700<BR>Fd7000ex<BR>Fd8xx<BR>mitsumi<BR>mkecr5xx<BR>Ncr53c9x<BR>Ncrc700<BR>Ncrc710<BR>ncrc810</P></TD><TD VALIGN="TOP"><P>Oliscsi Ql10wnt slcd32<BR>Sparrow<BR>Spock<BR>T128<BR>T13B<BR>tmv1<BR>Ultra124<BR>Ultra14f Ultra24f<BR>Wd33c93</P></TD></TR><TR><TD VALIGN="TOP"><P>SpoolerGroup</P></TD><TD VALIGN="TOP"><P>Spooler</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Streams Drivers</P></TD><TD VALIGN="TOP"><P>none</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>System Bus Extender</P></TD><TD VALIGN="TOP"><P>Pcmcia</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>TDI</P></TD><TD VALIGN="TOP"><P>Afd</P></TD><TD VALIGN="TOP"><P>DHCP</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Video</P></TD><TD VALIGN="TOP"><P>Ati<BR>Cirrus<BR>Dell_DGX<BR>Et400<BR>Jazzg30<BR>Jazzg364<BR>Jzvxl484</P></TD><TD VALIGN="TOP"><P>mga <BR>mga_mil<BR>ncr77c22<BR>psidisp<BR>qv<BR>s3<BR>tga</P></TD><TD VALIGN="TOP"><P>v7vram<BR>VgaSave<BR>wd90c24a<BR>wdvga<BR>weitekp9<BR>Xga</P></TD></TR><TR><TD VALIGN="TOP"><P>Video Init</P></TD><TD VALIGN="TOP"><P>VgaStart</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Video Save</P></TD><TD VALIGN="TOP"><P>VgaSave</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4><A NAME="sec9"></A>Troubleshooting Example</H4><P CLASS="t">This section describes using information in the DependOnGroup and DependOnService value entries to find the cause of the following error message that you see after you log on.</P>
<P><img src="xwrjj10.gif"></P>
<P CLASS="t">You can use the Event Viewer to see which services or drivers did not start. </P>
<H5 CLASS="h4"><A NAME="sec10"></A>To run Event Viewer</H5><P>    1.    Click the <B>Start</B> button</P>
<P>    2.    Click <B>Programs</B></P>
<P>    3.    Click <B>Administrative Tools (Common)</B></P>
<P>    4.    Double-click <B>Event Viewer</B></P>
<P>    5.    If the screen is displaying a log other than System Log, on the <B>Log</B> menu, click <B>System</B></P>
<P></P>
<P CLASS="t">The event log shows the following entries. </P>
<P><img src="xwrjj11.gif"></P>
<P CLASS="t">Sometimes, as you can see by the preceding System Log screen shot, several events are logged at approximately the same time. In this example, the newest event is entered at the top. Usually, if you look at the oldest event, you will find the reason that all of the events are logged. In this example, the fourth entry from the top was the first one logged at 1:41:24. Double-clicking on it results in this event detail. </P>
<P><img src="xwrjj12.gif"></P>
<P CLASS="t">But you look in the Registry there is no subkey HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Workstation. How do you find it? You have two methods that you can use. </P>
<P CLASS="t">You can use Regedit.exe to find the name anywhere in the control set. </P>
<H5 CLASS="h4"><A NAME="sec11"></A>To use Regedit.exe to find the Workstation service</H5><P>    1.    Click the <B>Start</B> button.</P>
<P>    2.    Click <B>Run</B>, and enter Regedit.exe.</P>
<P>    3.    Double-click <B>HKEY_LOCAL_MACHINE</B>, double-click <B>SYSTEM</B>, double-click <B>CurrentControlSet</B>, and click <B>Services</B>.</P>
<P>    4.    On the <B>Edit</B> menu, click <B>Find</B>.</P>
<P>    5.    In the <B>Find what</B> box, enter <B>Workstation</B> and check the <B>Keys</B> and <B>Data</B> checkboxes. Clear <B>Match whole string</B> only.</P>
<P>    6.    Click <B>Find</B>. </P>
<P>    7.    If the match is not what you are looking for, on the <B>Edit</B> menu, click <B>Find Next</B> until you find the correct key. </P>
<P></P>
<P CLASS="t">If you think that the service name is part of the key name, you can use the Windows&nbsp;NT Registry Editor.</P>
<H5 CLASS="h4"><A NAME="sec12"></A>To use Regedt32.exe to find the Workstation service</H5><P>    1.    Click the <B>Start</B> button.</P>
<P>    2.    Click <B>Run</B>, and enter Regedt32.exe.</P>
<P>    3.    Double-click <B>HKEY_LOCAL_MACHINE</B>, double-click <B>SYSTEM</B>, double-click <B>CurrentControlSet</B>, and click <B>Services</B>.</P>
<P>    4.    On the <B>View</B> menu, click <B>Find key</B>.</P>
<P>    5.    In the <B>Find what</B> box, enter <B>Workstation</B>. Clear <B>Match whole word only</B> and <B>Match case</B>. </P>
<P>    6.    Click <B>Find Next</B>.</P>
<P></P>
<P CLASS="t">Both Registry editors find a match on the subkey HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation. The DisplayName value entry contains the name that you see when you use the Services icon in Control Panel, or the Services tab in the Windows&nbsp;NT Diagnostics administrative tool, to view information about services.</P>
<P CLASS="t">Therefore, this subkey is the one you are searching for. Its Start value is 0x4, which means it is disabled. It should be set to 0x2, which indicates it would start automatically when you start Windows&nbsp;NT.</P>
<P CLASS="t">As it turns out, you specifically disabled the Workstation service by using the Services icon in Control Panel and setting the <B>Startup Type</B> to <B>Disabled</B>. The computer was restarted to see what happened.</P>
<P CLASS="t">But what about the other errors that are in the event log? If you double-click each of the first three entries, you find the following descriptions:</P>
<P CLASS="spacing"><BR></P>
<PRE>The Messenger service depends on the Workstation service which <BR>failed to start because of the following error.
The specified service is disabled and cannot be started. 

The Computer Browser service depends on the TCP/IP NetBIOS<BR>Helper service which failed to start because of the following error.
The dependency group or service failed to start.

The TCP/IP NetBIOS Helper service depends on the NetworkProvider<BR>group and no member of this group started.
</PRE>
<P CLASS="t">Changing the LanmanWorkstation service to start automatically will solve the problem with the Messenger service failing to start.</P>
<P CLASS="t">The Computer Browser and TCP/IP NetBIOS errors are both the result of no member of the NetworkProvider group starting. How do you find what services are in the NetworkProvider group? Regedt32.exe doesn't have an option to search for data, so you can use the Regedit.exe to find the NetworkProvider group. </P>
<H5 CLASS="h4"><A NAME="sec13"></A>To use Regedit.exe to find the NetworkProvider group</H5><P>    1.    Click the <B>Start</B> button.</P>
<P>    2.    Click <B>Run</B>, and enter Regedit.exe.</P>
<P>    3.    Double-click <B>HKEY_LOCAL_MACHINE</B>, double-click <B>SYSTEM</B>, double-click <B>CurrentControlSet</B>, and click <B>Services</B>.</P>
<P>    4.    On the <B>Edit</B> menu, click <B>Find</B>.</P>
<P>    5.    In the <B>Find what</B> box, enter <B>NetworkProvider</B> and check the <B>Data</B> checkbox. </P>
<P>    6.    Click <B>Find Next</B>. </P>
<P></P>
<P CLASS="t">The only subkey that has a Group value of NetworkProvider is LanmanWorkstation. Changing LanmanWorkstation to start automatically will also solve these problem.</P></BODY></HTML>
