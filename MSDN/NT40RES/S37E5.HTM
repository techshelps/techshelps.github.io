<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Maintaining Registry Security</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Maintaining Registry Security</H3><P CLASS="t">Do not allow a user to log on as a member of the Administrators group unless that individual has specific administrative duties.</P>
<P CLASS="t">You can also opt not to put <B>Regedt32.exe</B> on workstations, because you can easily administer any workstation from a remote computer. And you can place access controls on <B>Regedt32.exe</B> in Windows&nbsp;NT Explorer, which limits the rights of users to start this program.</P>
<P CLASS="t">This section describes the additional steps you can take to protect the Registry:</P>
<UL><LI>Protect Registry files.</LI></UL><UL><LI>Assign access rights to Registry keys.</LI></UL><UL><LI>Audit Registry activities.</LI></UL><P></P>
<H4><A NAME="sec0"></A>Protecting Registry Files for User Profiles</H4><P CLASS="t">You can protect the user profiles in the Registry in the same way that you protect other files in Windows&nbsp;NT—by restricting access through Windows&nbsp;NT Explorer. If the files are stored on an NTFS volume, you can use the security features of Windows&nbsp;NT Explorer to assign permissions for the Registry files or Registry editors. From the <B>File</B> menu, click <B>Properties</B>, then click the <B>Security</B> tab. For details about using these commands, see the Windows&nbsp;NT Explorer Help.</P>
<P></P>
<P CLASS="t"><B>Caution   </B>You should change permissions for user profiles only. The permissions for other Registry keys are maintained automatically by the system and should not be changed.</P>
<P CLASS="t">For information about safeguarding files with backups, see "Backing Up and Restoring Registry Hives," later in this chapter.</P>
<H4><A NAME="sec1"></A>Assigning Access Rights to Registry Keys</H4><P CLASS="t">To determine who has access to specific Registry data, set permissions on the Registry keys to specify the users and groups that can have access to that key. (This is sometimes called <I>changing ACLs</I>, in reference to the <I>access control lists</I> that govern who has access to data.) You can also add names to or remove names from the list of users or groups authorized to access the Registry keys.</P>
<P CLASS="t">You can assign access rights to Registry keys regardless of the type of file system on the partition where the Windows&nbsp;NT files are stored.</P>
<P></P>
<P CLASS="t"><B>Caution   </B>Changing the permissions to limit access to a Registry key can have severe consequences. If, for example, you set No Access permissions on a key needed for configuration by the <B>Network</B> option in Control Panel, the application will fail.</P>
<P CLASS="t">At a minimum, give Administrators and the System full access to the key, thus ensuring that the system starts and that the Registry key can be repaired by an administrator.</P>
<P CLASS="t">If you change permissions on a Registry key, you should audit that key for failed access attempts. For details, see "Auditing Registry Activities," later in this chapter.</P>
<P CLASS="t">Because assigning permissions on specific keys can have serious consequences, you should reserve this action for keys that you add to accommodate custom applications or other custom settings. After you change permissions on a Registry key, be sure to turn on auditing in User Manager, and then test the system extensively through a variety of activities while logged on under different user and administrative accounts.</P>
<P></P>
<P CLASS="t">In <B>Regedt32</B>, the commands on the <B>Security</B> menu for assigning permission and ownership of keys work in the same way as similar commands for NTFS partitions in Windows&nbsp;NT Explorer for assigning access rights for files and directories. For details about these commands, see help for the Registry editor. </P>
<H5 CLASS="h4"><A NAME="sec2"></A>To assign permissions on a key</H5><P>    1.    Make a backup copy of the Registry key before making changes.</P>
<P>    2.    Select the key for which you want to assign access permission. Then, from the <B>Security</B> menu, click <B>Permissions</B>.</P>
<P>3.     In the <B>Registry Key Permissions</B> dialog box, assign an access level to the selected key by selecting an option in the <B>Type of Access</B> box as described in the following table, and then click <B>OK</B>.</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="70pt" VALIGN="TOP"><COL WIDTH="263pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Type of access </B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Meaning</B></P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Read </B></P></TD><TD VALIGN="TOP"><P>Allows users on the <B>Permissions</B> list to read the key's contents, but prevents changes from being saved.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Full Control </B></P></TD><TD VALIGN="TOP"><P>Allows users on the <B>Permissions</B> list to access, edit, or take ownership of the selected key.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Special Access</B></P></TD><TD VALIGN="TOP"><P>Allows users on the <B>Permissions</B> list some custom combination of access and edit permission for the selected key. For a description of the Special Access types, see "Auditing Registry Activities," later in this chapter.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P>    4.    Turn on auditing in User Manager (in Windows&nbsp;NT Workstation) or User Manager for Domains (in Windows&nbsp;NT Server), and then test the system extensively to ensure that the new access control does not interfere with system or application operations.</P>
<P></P>
<P CLASS="t">As a system administrator, you might need to take ownership of a key to protect access to that key. To take ownership of a Registry key, click <B>Owner</B> on the <B>Security</B> menu, then complete the <B>Ownership</B> dialog box. You add users or groups to the <B>Permissions</B> list by following the same procedure for managing lists of users and groups as you use throughout Windows&nbsp;NT.</P>
<P CLASS="t">You (or any user) can take ownership of any Registry key if you log on to the computer as a member of the Administrator group. However, if an Administrator takes ownership of a key without being assigned full control by its owner, the key cannot be given back to its original owner, and the event is audited.</P>
<H4><A NAME="sec3"></A>Auditing Registry Activities</H4><P CLASS="t">To audit Registry activities, you must complete these separate activities:</P>
<UL><LI>Turn on auditing and set the audit policies in User Manager or User Manager for Domains for the activities you want to audit.</LI></UL><UL><LI>Specify the groups and users whose activities you want to audit for selected keys by using the <B>Auditing</B> command in Registry Editor.</LI></UL><UL><LI>View the Security log in Event Viewer for a selected computer to see the results of auditing.</LI></UL><P></P>
<P CLASS="t">For each of these activities, you must be logged on as a member of the Administrators group for the specific computer you are auditing. Auditing policies are set on a per-computer basis. Before you can audit activities in Registry keys, you must turn on security auditing for the computer.</P>
<H5 CLASS="h4"><A NAME="sec4"></A>To turn on auditing</H5><P>    1.    In User Manager or User Manager for Domains, from the <B>Policies</B> menu, click <B>Audit</B>. Select the <B>Audit These Events</B> option to turn on auditing.</P>
<P>    2.    Select <B>Success</B> and <B>Failure</B> options for each type of event to be audited,  then click <B>OK</B>.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>At a minimum, you should select the <B>Failure</B> option for <B>File And Object Access</B>. Selecting <B>Success</B> for many items can produce a large number of meaningless entries in the event log.</P>
<P></P>
<P></P>
<P CLASS="t">You can audit actions for a specific Registry key. For example, you can audit:</P>
<UL><LI>Keys where you want to know about changes being made by users or applications.</LI></UL><UL><LI>Keys you added that you want to test.</LI></UL><P></P>
<P></P>
<H5 CLASS="h4"><A NAME="sec5"></A>To audit user actions for a selected Registry key</H5><P>    1.    From the <B>Security</B> menu in Registry Editor, click <B>Auditing</B>, then complete the dialog box. </P>
<P>This command in Registry Editor is similar to the <B>Auditing</B> command in Windows&nbsp;NT Explorer. </P>
<P>    2.    Select the <B>Success</B> or <B>Failure</B> option for the following activities:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="89pt" VALIGN="TOP"><COL WIDTH="244pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Audit option</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Audits events that attempt to</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Query Value</P></TD><TD VALIGN="TOP"><P>Open a key with Query Value access.</P></TD></TR><TR><TD VALIGN="TOP"><P>Set Value</P></TD><TD VALIGN="TOP"><P>Open a key with Set Value access.</P></TD></TR><TR><TD VALIGN="TOP"><P>Create Subkey</P></TD><TD VALIGN="TOP"><P>Open a key with Create Value access.</P></TD></TR><TR><TD VALIGN="TOP"><P>Enumerate Subkeys</P></TD><TD VALIGN="TOP"><P>Open a key with Enumerate Subkeys access (that is, events that try to find the subkeys of a key).</P></TD></TR><TR><TD VALIGN="TOP"><P>Notify</P></TD><TD VALIGN="TOP"><P>Open a key with Notify access.</P></TD></TR><TR><TD VALIGN="TOP"><P>Create Link</P></TD><TD VALIGN="TOP"><P>Open a key with Create Link access.</P></TD></TR><TR><TD VALIGN="TOP"><P>Delete</P></TD><TD VALIGN="TOP"><P>Delete the key.</P></TD></TR><TR><TD VALIGN="TOP"><P>Write DAC</P></TD><TD VALIGN="TOP"><P>Determine who has access to the key.</P></TD></TR><TR><TD VALIGN="TOP"><P>Read Control</P></TD><TD VALIGN="TOP"><P>Find the owner of a key.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H5 CLASS="h4"><A NAME="sec6"></A>To view the results of auditing</H5><P> <FONT FACE="symbol">·</FONT>    Run Event Viewer, select the computer that you are interested in, then click <B>Security</B> on the <B>Log</B> menu.</P>
<P></P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>If you change permissions for any Registry key, you should turn on Auditing in User Manager and specify the <B>Failure</B> auditing option for <B>File And Object Access</B>. Then, if any application is not working because of changes in permissions, you can check the Security event log for details.</P>
<P></P>
<P></P></BODY></HTML>
