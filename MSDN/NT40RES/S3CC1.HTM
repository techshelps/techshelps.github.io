<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>High-Level Software Security Considerations</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>High-Level Software Security Considerations</H3><P CLASS="t">Some high-security options can be implemented only by using the Registry Editor. The Registry Editor should be used only by administrators who are familiar with the material in Part 5 of this book.</P>
<H4><A NAME="sec0"></A>User Rights</H4><P CLASS="t">There are several user rights that administrators of high-security installations should be aware of and possibly audit.  Of these, you might want to change the default permissions on two rights, as follows:</P>
<P CLASS="t"></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="119pt" VALIGN="TOP"><COL WIDTH="119pt" VALIGN="TOP"><COL WIDTH="119pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>User Right</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Groups assigned this right by default</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Recommended change</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Log on locally.<BR>Allows a user to log on at the computer, from the computer's keyboard.</P></TD><TD VALIGN="TOP"><P>Administrators, Backup Operators, Everyone, Guests, Power Users, and Users</P></TD><TD VALIGN="TOP"><P>Deny Everyone and Guests this right.</P></TD></TR><TR><TD VALIGN="TOP"><P>Shut down the system. (SeShutdownPrivilege) <BR>Allows a user to shut down Windows&nbsp;NT.</P></TD><TD VALIGN="TOP"><P>Administrators, Backup Operators, Everyone, Power Users, and Users</P></TD><TD VALIGN="TOP"><P>Deny Everyone and Users this right.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t"></P>
<P CLASS="t">The rights in the following table generally require no changes to the default settings, even in the most highly secure installations.</P>

<TABLE COLS="6" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"><COL WIDTH="137pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Right</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Allows</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="th"><B>Initially assigned to</B></P></TD></TR><TR><TD COLSPAN="6" VALIGN="TOP"><P></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Access this computer from the network</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to connect over the network to the computer.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Everyone, Power Users</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Act as part of the operating system</P>
<P>(SeTcbPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A process to perform as a secure, trusted part of the operating system. Some subsystems are granted this right.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Add workstations to the domain (SeMachineAccountPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Nothing. This right has no effect on computers running Windows&nbsp;NT.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Back up files and directories <BR>(SeBackupPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to back up files and directories. This right supersedes file and directory permissions.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Backup Operators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Bypass traverse checking (SeChangeNotifyPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to change directories and access files and subdirectories even if the user has no permission to access parent directories.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Everyone</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Change the system time<BR>(SeSystemTimePrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to set the time for the internal clock of the computer.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Power Users</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Create a pagefile <I><BR></I>(SeCreatePagefilePrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Nothing. This right has no effect in current versions of Windows&nbsp;NT.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Create a token object <BR>(SeCreateTokenPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A process to create access tokens. Only the Local Security Authority can do this.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD VALIGN="TOP"><P>Create permanent shared objects <BR>(SeCreatePermanentPrivilege)</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>A user to create special permanent objects, such as \\Device, that are used within Windows&nbsp;NT.</P></TD><TD COLSPAN="4" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Debug programs<I><BR></I>(SeDebugPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to debug various low-level objects such as threads.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Force shutdown from a remote system <BR>(SeRemoteShutdownPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Nothing. This right has no effect in current versions of Windows&nbsp;NT.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Power Users</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Generate security audits <BR>(SeAuditPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A process to generate security audit log entries.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Increase quotas<I> <BR></I>(SeIncreaseQuotaPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Nothing. This right has no effect in current versions of Windows&nbsp;NT.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Increase scheduling priority <BR>(SeIncreaseBasePriorityPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to boost the execution priority of a process.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Power Users</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Load and unload device drivers <BR>(SeLoadDriverPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to install and remove device drivers. </P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Lock pages in memory<BR>(SeLockMemoryPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to lock pages in memory so they cannot be paged out to a backing store such as Pagefile.sys.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Log on as a batch job</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>Nothing. This right has no effect in current versions of Windows&nbsp;NT.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Log on as a service</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A process to register with the system as a service.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Log on locally</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to log on at the computer, from the computer's keyboard.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Backup Operators, Guests, Power Users, Users</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Manage auditing and security<I> log</I> <BR>(SeSecurityPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to specify what types of resource access (such as file access) are to be audited, and to view and clear the security log. Note that this right does not allow a user to set system auditing policy using the Audit command in the Policy menu of User Manager. Also, members of the Administrators group always have the ability to view and clear the security log.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Modify firmware environment variables <BR>(SeSystemEnvironmentPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to modify system environment variables stored in nonvolatile RAM on systems that support this type of configuration.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Profile single process <BR>(SeProfSingleProcess)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to perform profiling (performance sampling) on a process.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Power Users</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Profile system performance <BR>(SeSystemProfilePrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to perform profiling (performance sampling) on the system.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Replace a process-level token<I><BR></I>(SeAssignPrimaryTokenPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to modify a process's security access token. This is a powerful right used only by the system.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>(None)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Restore files and directories <BR>(SeRestorePrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to restore backed-up files and directories. This right supersedes file and directory permissions.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Backup Operators</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Shut down the system<I> <BR></I>(SeShutdownPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to shut down Windows&nbsp;NT.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators, Backup Operators, Power Users, Users</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Take ownership of files or other objects <BR>(SeTakeOwnershipPrivilege)</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>A user to take ownership of files, directories, printers, and other objects on the computer. This right supersedes permissions protecting objects.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Administrators</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4><A NAME="sec1"></A>Protecting Files and Directories</H4><P CLASS="t">Among the files and directories to be protected are those that make up the operating system software itself. The standard set of permissions on system files and directories provide a reasonable degree of security without interfering with the computer's usability. For high-level security installations, however, you might want to set directory permissions to all subdirectories and existing files, as shown in the following list, immediately after Windows&nbsp;NT is installed. Be sure to apply permissions to parent directories before applying permissions to subdirectories.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Directory</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Permissions</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control<BR>CREATOR OWNER: Full Control<BR>Everyone: Read<BR>SYSTEM: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\REPAIR    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control<BR>CREATOR OWNER: Full Control<BR>Everyone: Read<BR>SYSTEM: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control<BR>CREATOR OWNER: Full Control<BR>Everyone: Read<BR>SYSTEM: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32\CONFIG    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control<BR>CREATOR OWNER: Full Control<BR>Everyone: List<BR>SYSTEM: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32\DHCP    </P></TD><TD VALIGN="TOP"><P>(Delete this directory)</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32\DRIVERS    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control<BR>CREATOR OWNER: Full Control<BR>Everyone: Read<BR>SYSTEM: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32\RAS    </P></TD><TD VALIGN="TOP"><P>(Delete this directory)</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32\OS2    </P></TD><TD VALIGN="TOP"><P>(Delete this directory)</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32\SPOOL    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control<BR>CREATOR OWNER: Full Control<BR>Everyone: Read<BR>Power Users: Change<BR>SYSTEM: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\WINNT35\SYSTEM32\WINS    </P></TD><TD VALIGN="TOP"><P>(Delete this directory)</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">Several critical operating system files exist in the root directory of the system partition on Intel 80486 and Pentium-based systems. In high-security installations you might want to assign the following permissions to these files:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>File</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>C2-Level Permissions</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>\BOOT.INI, \NTDETECT.COM, \NTLDR    </P></TD><TD VALIGN="TOP"><P>Administrators: Full Control<BR>SYSTEM: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>\AUTOEXEC.BAT, \CONFIG.SYS</P></TD><TD VALIGN="TOP"><P>Everybody: Read<BR>Administrators: Full Control<BR>SYSTEM: Full Control</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P>*</P>
<P CLASS="t">To view these files in File Manager, choose the <B>By File Type</B> command from the <B>View</B> menu, then select the <B>Show Hidden/System Files</B> check box in the <B>By File Type</B> dialog box.</P>
<H4><A NAME="sec2"></A>Protecting the Registry</H4><P CLASS="t">In addition to the considerations for standard security, the administrator of a high-security installation might want to set protections on certain keys in the Registry. </P>
<P CLASS="t">By default, protections are set on the various components of the Registry that allow work to be done while providing standard-level security. For high-level security, you might want to assign access rights to specific Registry keys. This should be done with caution, because programs that the users require to do their jobs often need to access certain keys on the users' behalf. For more information, see Chapter 24, "Registry Editor and Registry Administration."</P>
<P CLASS="t">In particular, you might want to change the protections of the following keys so that the group Everyone is only allowed QueryValue, Enumerate Subkeys, Notify, and Read Control accesses.</P>
<P CLASS="t">In the HKEY_LOCAL_MACHINE on Local Machine dialog:</P>
<P>\Software\Microsoft\RPC (and its subkeys)</P>
<P>\Software\Microsoft\Windows&nbsp;NT\CurrentVersion</P>
<P CLASS="t">And under the \Software\Microsoft\Windows&nbsp;NT\CurrentVersion\ subtree:</P>
<P>    Profile List</P>
<P>    AeDebug</P>
<P>    Compatibility</P>
<P>    Drivers</P>
<P>    Embedding</P>
<P>    Fonts</P>
<P>    FontSubstitutes</P>
<P>    GRE_Initialize</P>
<P>    MCI</P>
<P>    FontSubstitutes</P>
<P>    GRE_Initialize</P>
<P>    MCI</P>
<P>    MCI Extensions</P>
<P>    Port (and all subkeys)</P>
<P>    WOW (and all subkeys)</P>
<P>    Windows3.1MigrationStatus (and all subkeys)</P>
<P></P>
<P CLASS="t">In the HKEY_CLASSES_ROOT on Local Machine dialog:</P>
<P>\HKEY_CLASSES_ROOT (and all subkeys)</P>
<P CLASS="spacing"><BR></P>
<PRE></PRE>
<P CLASS="t">Remote access to the Windows&nbsp;NT registry is supported by the Registry Editor. To restrict network access to the registry, use the Registry Editor to create the following registry key:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="48pt" VALIGN="TOP"><COL WIDTH="299pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Hive:</P></TD><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE</P></TD></TR><TR><TD VALIGN="TOP"><P>Key:</P></TD><TD VALIGN="TOP"><P>\CurrentcontrolSet\Control\SecurePipeServers</P></TD></TR><TR><TD VALIGN="TOP"><P>Name:</P></TD><TD VALIGN="TOP"><P>\winreg</P></TD></TR><TR><TD VALIGN="TOP"><P>Type </P></TD><TD VALIGN="TOP"><P>REG_DWORD</P></TD></TR><TR><TD VALIGN="TOP"><P>Value:</P></TD><TD VALIGN="TOP"><P>1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The security permissions set on this key define which users or groups can connect to the system for remote registry access. The default Windows&nbsp;NT Workstation installation does not define this key and does not restrict remote access to the registry. Windows&nbsp;NT Server permits only Administrators remote access to the registry.</P>
<H4><A NAME="sec3"></A>The Schedule Service (AT Command)</H4><P CLASS="t">The Schedule service (also known as the <B>AT</B> command) is used to schedule tasks to run automatically at a preset time. Because the scheduled task is run in the context run by the Schedule service (typically the operating system's context), this service should not be used in a highly secure environment. </P>
<P CLASS="t">By default, only Administrators can submit <B>AT</B> commands. To allow System Operators to also submit <B>AT</B> commands, use the Registry Editor to create or assign the following Registry key value:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="48pt" VALIGN="TOP"><COL WIDTH="299pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Hive:</P></TD><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE\SYSTEM</P></TD></TR><TR><TD VALIGN="TOP"><P>Key:</P></TD><TD VALIGN="TOP"><P>\CurrentControlSet\Control\Lsa</P></TD></TR><TR><TD VALIGN="TOP"><P>Name:</P></TD><TD VALIGN="TOP"><P>Submit Control</P></TD></TR><TR><TD VALIGN="TOP"><P>Type:</P></TD><TD VALIGN="TOP"><P>REG_DWORD</P></TD></TR><TR><TD VALIGN="TOP"><P>Value:</P></TD><TD VALIGN="TOP"><P>1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">There is no way to allow anyone else to submit <B>AT</B> commands. The changes will take effect the next time the computer is started. You might want to update the Emergency Repair Disk to reflect these changes.</P>
<H4><A NAME="sec4"></A>Hiding the Last Username</H4><P CLASS="t">By default, Windows&nbsp;NT places the username of the last user to log on the computer in the Username text box of the <B>Logon </B>dialog box. This makes it more convenient for the most frequent user to log on. To help keep usernames secret, you can prevent Windows&nbsp;NT from displaying the username from the last logon. This is especially important if a computer that is generally accessible is being used for the (renamed) built-in Administrator account. </P>
<P CLASS="t">To prevent display of a username in the Logon dialog box, use the Registry Editor to create or assign the following Registry key value:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="48pt" VALIGN="TOP"><COL WIDTH="299pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Hive:</P></TD><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE\SOFTWARE</P></TD></TR><TR><TD VALIGN="TOP"><P>Key:</P></TD><TD VALIGN="TOP"><P>\Microsoft\Windows&nbsp;NT\Current Version\Winlogon</P></TD></TR><TR><TD VALIGN="TOP"><P>Name:</P></TD><TD VALIGN="TOP"><P>DontDisplayLastUserName</P></TD></TR><TR><TD VALIGN="TOP"><P>Type:</P></TD><TD VALIGN="TOP"><P>REG_SZ</P></TD></TR><TR><TD VALIGN="TOP"><P>Value:</P></TD><TD VALIGN="TOP"><P>1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4><A NAME="sec5"></A>Restricting the Boot Process</H4><P CLASS="t">Most personal computers today can start a number of different operating systems. For example, even if you normally start Windows NT from the C: drive, someone could select another version of Windows on another drive, including a floppy drive or CD-ROM drive. If this happens, security precautions you have taken within your normal version of Windows NT might be circumvented.</P>
<P CLASS="t">In general, you should install only those operating systems that you want to be used on the computer you are setting up. For a highly secure system, this will probably mean installing one version of Windows&nbsp;NT. However, you must still protect the CPU physically to ensure that no other operating system is loaded. Depending on your circumstances, you might choose to remove the floppy drive or drives. In some computers you can disable booting from the floppy drive by setting switches or jumpers inside the CPU. If you use hardware settings to disable booting from the floppy drive, you might want to lock the computer case (if possible) or lock the machine in a cabinet with a hole in the front to provide access to the floppy drive. If the CPU is in a locked area away from the keyboard and monitor, drives cannot be added or hardware settings changed for the purpose of starting from another operating system. </P>
<H4><A NAME="sec6"></A>Allowing Only Logged-On Users to Shut Down the Computer</H4><P CLASS="t">Normally, you can shut down a computer running Windows&nbsp;NT Workstation without logging on by choosing Shutdown in the <B>Logon</B> dialog box. This is appropriate where the computer's operational switches can be accessed by users; otherwise, they might tend to turn off the computer's power or reset it without properly shutting down Windows&nbsp;NT Workstation. However, you can remove this feature if the CPU is locked away. (This step is not required for Windows&nbsp;NT Server, because it is configured this way by default.)</P>
<P CLASS="t">To require users to log on before shutting down the computer, use the Registry Editor to create or assign the following Registry key value:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="48pt" VALIGN="TOP"><COL WIDTH="299pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Hive:</P></TD><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE\SOFTWARE</P></TD></TR><TR><TD VALIGN="TOP"><P>Key:</P></TD><TD VALIGN="TOP"><P>\Microsoft\Windows&nbsp;NT\Current Version\Winlogon</P></TD></TR><TR><TD VALIGN="TOP"><P>Name:</P></TD><TD VALIGN="TOP"><P>ShutdownWithoutLogon</P></TD></TR><TR><TD VALIGN="TOP"><P>Type:</P></TD><TD VALIGN="TOP"><P>REG_SZ</P></TD></TR><TR><TD VALIGN="TOP"><P>Value:</P></TD><TD VALIGN="TOP"><P>0</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The changes will take effect the next time the computer is started. You might want to update the Emergency Repair Disk to reflect these changes.</P>
<H4><A NAME="sec7"></A>Controlling Access to Removable Media </H4><P CLASS="t">By default, Windows NT allows any program to access files on floppy disks and CDs. In a highly secure, multi-user environment, you might want to allow only the person interactively logged on to access those devices. This allows the interactive user to write sensitive information to these drives, confident that no other user or program can see or modify that data.</P>
<P CLASS="t">When operating in this mode, the floppy disks and/or CDs on your system are allocated to a user as part of the interactive logon process. These devices are automatically freed for general use or for reallocation when that user logs off. Because of this, it is important to remove sensitive data from the floppy or CD-ROM drives before logging off.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>Windows&nbsp;NT allows all users access to the tape drive, and therefore any user can read and write the contents of any tape in the drive. In general this is not a concern, because only one user is interactively logged on at a time. However, in some rare instances, a program started by a user can continue running after the user logs off. When another user logs on and puts a tape in the tape drive, this program can secretly transfer sensitive data from the tape. If this is a concern, restart the computer before using the tape drive.</P>
<P></P>
<H5 CLASS="h4"><A NAME="sec8"></A>To allocate floppy drives during logon </H5><P> <FONT FACE="symbol">·</FONT>    Use the Registry Editor to create or assign the following Registry key value:</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="46pt" VALIGN="TOP"><COL WIDTH="283pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Hive:</P></TD><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE\SOFTWARE</P></TD></TR><TR><TD VALIGN="TOP"><P>Key:</P></TD><TD VALIGN="TOP"><P>\Microsoft\WindowsNT\CurrentVersion\Winlogon</P></TD></TR><TR><TD VALIGN="TOP"><P>Name:</P></TD><TD VALIGN="TOP"><P>AllocateFloppies</P></TD></TR><TR><TD VALIGN="TOP"><P>Type:</P></TD><TD VALIGN="TOP"><P>REG_SZ</P></TD></TR><TR><TD VALIGN="TOP"><P>Value:</P></TD><TD VALIGN="TOP"><P>1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P>If the value does not exist, or is set to any other value, then floppy devices will be available for shared use by all processes on the system.</P>
<P>This value will take effect at the next logon. If a user is already logged on when this value is set, it will have no effect for that logon session. The user must log off and log on again to cause the device(s) to be allocated.</P>
<P></P>
<H5 CLASS="h4"><A NAME="sec9"></A> <FONT FACE="symbol">Û</FONT>    To allocate CD-ROMs during logon </H5><P> <FONT FACE="symbol">·</FONT>    Use the Registry Editor to create or assign the following Registry key value:</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="46pt" VALIGN="TOP"><COL WIDTH="283pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Hive:</P></TD><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE\SOFTWARE</P></TD></TR><TR><TD VALIGN="TOP"><P>Key:</P></TD><TD VALIGN="TOP"><P>\Microsoft\WindowsNT\CurrentVersion\Winlogon</P></TD></TR><TR><TD VALIGN="TOP"><P>Name:</P></TD><TD VALIGN="TOP"><P>AllocateCDRoms</P></TD></TR><TR><TD VALIGN="TOP"><P>Type:</P></TD><TD VALIGN="TOP"><P>REG_SZ</P></TD></TR><TR><TD VALIGN="TOP"><P>Value:</P></TD><TD VALIGN="TOP"><P>1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P>If the value does not exist, or is set to any other value, then CD-ROM devices will be available for shared use by all processes on the system.</P>
<P>This value will take effect at the next logon. If a user is already logged on when this value is set, it will have no effect for that logon session. The user must log off and log on again to cause the device(s) to be allocated.</P>
<P></P></BODY></HTML>
