<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interoperating with Windows 3.x</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Interoperating with Windows 3.<I>x</I></H3><P CLASS="t">If a previous version of Windows (Windows 3.<I>x</I>, Windows for Workgroups) is installed on your computer, and you want to run your installed applications from both the previous version of Windows and from Windows NT, then install Windows NT in the same directory as the previous version of Windows. This allows Windows NT to configure the Windows environment based on the existing environment and allows Windows NT to support the features of currently installed applications.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>For information about interoperating with Windows 95, see "Compatibility with Windows 95" later in this chapter.</P>
<P></P>
<P CLASS="t">When the first logon occurs on the newly-installed Windows NT computer, the system migrates Reg.dat and portions of the various .ini files from the previous version of Windows to the Registry in Windows&nbsp;NT. See the following section "What is Migrated at the First Logon" for a complete list. The status of each step in the migration is recorded in the Application Log, which can be viewed with Event Viewer. For more information about Event Viewer, see Chapter 9,"Monitoring Events," of <I>Microsoft Windows&nbsp;NT Server Concepts and Planning</I></P>
<P CLASS="t">The first time new users log in, Windows NT presents a dialog box that lets them select the parts of the previous version of Windows to migrate into the Windows NT environment. The users can select whether to migrate the .ini files and/or the Program Manager .grp files to the Registry. If the users cancel the dialog box and would later like to migrate the files, they must delete the following keys from the Registry and then log off and log back into Windows NT:</P>
<P CLASS="spacing"><BR></P>
<PRE>HKEY_CURRENT_USER\Windows&nbsp;3.1&nbsp;Migration&nbsp;Status

HKEY_LOCAL_MACHINE\SOFTWARE\Windows 3.1 Migration Status
</PRE>
<P CLASS="t">Refer to Part 5, "Windows NT Registry," for information on the Registry and its entries.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>The per-user dialog box and migration option do not happen for the Administrator, Guest, and System user accounts.</P>
<P></P>
<P CLASS="t">If users choose to migrate the .ini files, then each time they log into Windows NT, the system reads the Win.ini file and the System.ini file and stores the information in the Registry. When the user logs off from Windows NT, the system updates the Win.ini file and the System.ini file with any changes made to the environment. This keeps the configuration of Windows NT and the previous version of Windows synchronized with each other.</P>
<P></P>
<P CLASS="t">If Windows NT is not installed in the same directory as the previous version of Windows, then configuration changes made under one version of Windows are not available to the other version. The same is true if you install Windows 3.<I>x</I> after installing Windows&nbsp;NT.</P>
<P CLASS="t">If you install an application under Windows 3.<I>x</I> after installing Windows&nbsp;NT, that application would not be available in Windows&nbsp;NT. You can reinstall the application under Windows NT (into the same directory into which it is installed under Windows3.<I>x</I>). Or, you can delete the two Windows 3.1 Migration Status registry keys mentioned earlier in this section, and then remigrate the settings by logging on again.</P>
<P CLASS="t">Regardless of where Windows NT is installed, changes made to the Desktop or to the arrangement of the Program Groups are not synchronized with the previous version of Windows.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>Setup installs TrueType font and font header files in <I>%SystemRoot%</I>SYSTEM\FONTS. Be careful not to delete the TrueType files from this directory. These files are used by Windows NT 32-bit applications as well as 16-bit applications. For more information on the TrueType font and font header files included with Windows NT, refer to Chapter 8, "Fonts."</P>
<P></P></BODY></HTML>
