<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Replacing the Master Boot Record and the Partition Boot Sector</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Replacing the Master Boot Record and the Partition Boot Sector </H3><P CLASS="t">For information about determining if you have a problem with either of these disk sectors, and procedures for displaying them, see Chapter 21, "Troubleshooting Startup and Disk Problems." For information about the utilities that you can use to save, replace, and edit these disk sectors, see Chapter 22, "Disk, File System, and Backup Utilities."</P>
<P CLASS="t"><B>Caution   </B>Be careful when you use the low-level disk editors described in this section. If you replace the wrong sector, or change individual bytes to the wrong data, you can make your problems far worse. You could destroy information that is needed by Windows&nbsp;NT, and your only option would be to reformat the partition or the entire disk.</P>
<H4><A NAME="sec0"></A>Replacing the Master Boot Record</H4><P CLASS="t">There are two problems that can occur in the sector containing the Master Boot Record:</P>
<UL><LI>The Master Boot Record might be corrupt.</LI></UL><UL><LI>The Partition Tables can be damaged.</LI></UL><P></P>
<P CLASS="t">On many x86-based computers, the fastest and simplest way to replace the Master Boot Record is to use an MS-DOS bootable floppy disk with the MS-DOS-based program Fdisk on it.</P>
<P CLASS="t"><B>Caution   </B>Do not use Fdisk to replace the Master Boot Record if you are using a:</P>
<UL><LI>Third-party translation program.</LI></UL><UL><LI>Dual-boot program that writes information in the area between the code and the Partition Table. </LI></UL><UL><LI>Third-party partitioning program that writes information in the area between the code and the Partition Table.</LI></UL><P></P>
<P CLASS="t">If you do not know whether you are using a program like this, you should not use this method. </P>
<H5 CLASS="h4"><A NAME="sec1"></A>To replace the Master Boot Record</H5><P>    1.    Start the computer by using the MS-DOS bootable floppy disk. (You did run virus check and lock the floppy disk after you made it, didn't you?)</P>
<P>    2.    At the <B>A:\</B> prompt, type <B>fdisk /mbr</B>.</P>
<P>This command replaces the Master Boot Record without altering the Partition Tables at the end of the sector. There is no message or response. </P>
<P></P>
<P CLASS="t">If there is a <I>Windows&nbsp;NT</I> disk signature in the Master Boot Record, it is overwritten by the new Master Boot Record. Overwriting the disk signature is a problem only if the disk contains partitions or logical drives that are members of volume sets or stripe sets. You can safely overwrite the disk signature when the disk has no volume sets or stripe sets, because Disk Administrator writes a new disk signature the next time you run it.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>The <B>fdisk /mbr</B> command requires MS-DOS 5.0 or later, and only works on the first hard disk on the computer.</P>
<P></P>
<P CLASS="t">If you have saved the Master Boot Record by using either DiskSave (x86-based computers only) or DiskProbe, you can use one of these utilities to replace the Master Boot Record. These utilities rewrite the entire sector, including the Partition Table. If you cannot start Windows&nbsp;NT from the hard disk, you can usually start the computer by using the Windows&nbsp;NT startup floppy disk if you want to use DiskProbe to replace the Master Boot Record. </P>
<P CLASS="t">If none of these methods are available to you, you can use a low-level disk editor to copy a good Master Boot Record from another disk to the startup disk (usually disk 0 on x86-based computers). Since the smallest disk write is a sector, when you copy the Master Boot Record from another disk, you are also copying the other disk's Partition Table, which is not valid for the current disk. Therefore, you must first write down the partition information in the Master Boot Record that you are going to replace, starting from 0x1BE. You have to manually reenter the Partition Table information in hex format into the newly copied sector. </P>
<P CLASS="t">If you can start Windows&nbsp;NT by using the Windows&nbsp;NT startup floppy disk, you can use DiskMap to print a map of the disk. When you have copied a Master Boot Record from another computer of the same type (for example, another computer made by the same manufacturer with the same models of disk controllers), use DiskProbe to enter the information for the Partition Table. For information about DiskMap and DiskProbe, see Chapter 22, "Disk, File System, and Backup Utilities."</P>
<P CLASS="t">After you have replaced the Master Boot Record, you should check that it is now correct. If the Master Boot Record is not correct after replacing it, there is either a hardware problem, such as incorrect SCSI termination, or (on x86-based computers) there is a virus in memory that is trapping INT 13 calls. You have to isolate and correct the problem that is corrupting the Master Boot Record.</P>
<H4><A NAME="sec2"></A>Repairing the Partition Table</H4><P CLASS="t">If you have not changed the Partition Table since you saved the Master Boot Record, replacing the Master Boot Record also replaces the Partition Table. </P>
<P CLASS="t">If you have made only minor changes to the Partition Table since you saved the Master Boot Record, you might be able to use the information on the backup to help you repair the Partition Table. For instance, if the only change you have made is to convert a partition from FAT to NTFS, just change the System ID byte from 06 to 07.</P>
<P CLASS="t">If your disk has more than one partition, and you did not save the Master Boot Record or write down the information, you might be able to reconstruct it. You can use DiskProbe to edit the Partition Table.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>If you will have to completely rebuild your Partition Table, either because of corruption or you had to copy the Master Boot Record from another computer, it might be safer to completely rebuild your disk. In this case, you should back up all of your files to tape (or another computer), recreate and reformat the partitions on the hard disk, and restore the data. If the disk with the invalid Partition Table contains your system or your boot partition, you will probably have to use the Windows&nbsp;NT startup floppy disk to start your computer.</P>
<P></P>
<H4><A NAME="sec3"></A>Replacing the Partition Boot Sector</H4><P CLASS="t">There are several methods that you can use to replace the Partition Boot Sector.</P>
<P CLASS="t">If you have saved the Partition Boot Sector by using either the DiskProbe or the DiskSave program, you can replace the sector from the backup. This is the fastest way to replace the Partition Boot Sector. </P>
<P CLASS="t">For NTFS volumes, there is one other alternative. When you create or reformat an existing volume as an NTFS volume, the NTFS file system writes a duplicate of the Partition Boot Sector at the end of the volume (Windows&nbsp;NT version 4.0) or at the logical center of the volume (Windows&nbsp;NT 3.51 and earlier). You can use the Windows&nbsp;NT–based program DiskProbe to locate and copy this sector to the beginning of the volume. There are also third-party MS-DOS-based disk utilities that you can use to locate and copy this sector. </P>
<P CLASS="t">You might want to display the Partition Boot Sector to make sure it is now correct. Once you have copied the Partition Boot Sector to the first sector of the partition, you should be able to start Windows&nbsp;NT.</P></BODY></HTML>
