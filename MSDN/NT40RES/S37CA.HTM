<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Loading Hives from a Remote Computer</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Loading Hives from a Remote Computer</H3><P CLASS="t">An alternative to viewing another computer's Registry remotely is to save copies of the other computer's Registry hives and then load them into <B>Regedt32</B> on your computer. You can use this method to view and change the keys and subkeys of the HKEY_LOCAL_MACHINE and HKEY_USERS hives of another computer's Registry. This enables you to investigate and repair the Registry values and value entries of a computer that is not configured properly or cannot connect to the network.</P>
<P></P>
<P CLASS="t">The subtrees of your computer's Registry are loaded automatically when you start the computer, and you can view its contents in a Registry editor. To view or change the contents of another computer's Registry, you must load a saved copy of all or part of its hive. </P>
<P CLASS="t">You might load the hive of another computer's Registry for the following reasons:</P>
<UL><LI>To view or repair a hive on a computer that temporarily cannot run Windows&nbsp;NT. For details, see "Backing Up and Restoring Registry Hives," later in this chapter.</LI></UL><UL><LI>To view or repair the profiles of users who aren't currently logged on to a computer. For details and examples, see "Managing User Profiles Through the Registry" in Chapter 25, "Configuration Management and the Registry."</LI><LI>To view or repair a hive of a computer that is not connected to the network. Save a copy of its hive on a floppy disk, then load it into <B>Regedt32</B> on another computer.</LI></UL><UL><LI>To create a custom version of the LastKnownGood control set and other startup controls. For details and examples, see "Making Sure the System Always Starts" in Chapter 25, "Configuration Management and the Registry."</LI></UL><P></P>
<P CLASS="t">Please note the following rules when loading a hive from another computer's Registry by using <B>Regedt32</B>:</P>
<UL><LI>Before you can load a hive, you must save it as a file by using the <B>Save Key</B> command in <B>Regedt32</B> (described later in this chapter). You can also load another computer's system hive files—those that Windows&nbsp;NT creates for its own use—but only while Windows&nbsp;NT is not running on that computer. By default, the system's hive files are stored in <I>Systemroot</I>\System32\Config and <I>Systemroot</I>\Profiles.</LI><LI>You can load only the keys and subkeys of HKEY_LOCAL_MACHINE and HKEY_USERS. Also, you can neither save nor load keys and subkeys that are <I>volatile</I>, that is, those that are created each time the system starts and deleted when the system stops. (You can save nonvolatile keys in volatile hives. For example, although the HKEY_LOCAL_MACHINE\Hardware key is volatile, you can save nonvolatile subkeys under that key.)</LI><LI>To load or unload a hive, you must log on to the computer as Administrator or as a member of the Administrator group, and you must have Restore and Backup permissions.</LI><LI>The <B>Load Hive</B> command is enabled only when the HKEY_USERS or HKEY_LOCAL_MACHINE subtree is selected in <B>Regedt32</B>. The <B>Unload Hive</B> command is enabled only when the root (highest key) of a loaded hive is selected. </LI></UL><P> <FONT FACE="symbol"></FONT></P>
<P CLASS="t"><B>Note</B></P>
<P>Versions of Windows&nbsp;NT previous to version 4.0 did not allow you to load hive files that had filename extensions. This restriction does not apply to Windows&nbsp;NT&nbsp;4.0.</P>
<P></P>
<P></P>
<P CLASS="t">If you are unable to connect to another computer over the network, you can load a hive file from a floppy disk.</P>
<H4><A NAME="sec0"></A>To load a hive file into Regedt32</H4><P>    1.    In <B>Regedt32</B>, click the HKEY_LOCAL_MACHINE or HKEY_USERS subtree window.</P>
<P>    2.    From the <B>Registry</B> menu, click <B>Load Hive</B>. <BR>The <B>Load Hive</B> dialog box appears. This is a Windows&nbsp;NT Explorer dialog box that lists the drives of the local computer and represents all computers connected to the local computer. </P>
<P>    3.    Locate the saved hive file and double-click its entry. </P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>When locating a hive file on a remote computer, use a path relative to the remote computer, not to the local computer. For example, if you are using your G: drive to connect to \\Text01\Public to save Hive.tst, enter <B>\\Text01\Public\Hive.tst</B>, not <B>G:\Hive.tst</B>. The G:\Hive.tst entry directs <B>Regedt32</B> to look for the file on the G: drive of the remote computer, not the G: drive of the local computer.</P>
<P></P>
<P>    4.    In the second <B>Load Hive</B> dialog box, type the name you want to use for the key where the hive will be loaded, then click <B>OK</B>.</P>
<P>This names a new subkey in the selected subtree. You can specify any name that is not being used for another file or another key in the Registry. </P>
<P></P>
<P CLASS="t">Data from the loaded hive appears as a new subkey in the subtree selected when you loaded the hive file. A loaded hive remains in the system until you unload it.</P>
<P CLASS="t">The <B>Load Hive</B> command creates a new hive in the memory space of the Registry and uses the specified file as the backing hive file (<I>Filename</I>.log) for it. The specified file is held open, but nothing is copied to the file unless the information in a key or value entry is changed. Likewise, the <B>Unload Hive</B> command does not copy or create anything; it merely unloads a loaded hive. </P>
<H4><A NAME="sec1"></A>To unload a hive from Regedt32</H4><P> <FONT FACE="symbol">·</FONT>    Select the root (top) key of the hive you want to unload. From the <B>Registry</B> menu, click <B>Unload Hive</B>.</P>
<P>The connection is ended and the selected key is removed from <B>Regedt32</B>.</P>
<P><B>Note   </B>You cannot unload a hive that was loaded by the system. Also, you cannot unload a hive if an application has an open handle to any subkey in the hive. (A <I>handle</I> is a means for controlling access to objects in the system.) However, there is no way to detect whether an application has an open handle to a key. </P>
<P>If an attempt to use the <B>Unload Hive</B> command fails, close all applications not in immediate use and try again.</P></BODY></HTML>
