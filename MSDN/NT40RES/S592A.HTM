<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Removable Disks and Floppy Disks</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Using Removable Disks and Floppy Disks</H2><P CLASS="t">Most types of removable media can work with Window NT. Even though removable media are assigned a floppy disk icon in My Computer and Windows&nbsp;NT Explorer, they are not handled by the same part of the operating system. Floppy disks are handled by Floppy.sys. All SCSI-based removable media are handled through the normal SCSI disk device drivers. Most magneto-optical, Bernoulli, Syquest, and similar removable-media disks are treated like hard disks under Windows&nbsp;NT, and do not require special disk device drivers.</P>
<P CLASS="t">You can use My Computer or Windows&nbsp;NT Explorer to remove media while Windows&nbsp;NT is running. When pointing at the device, click the right mouse button. If the media can be ejected, the <B>Eject</B> command is available. If there is no <B>Eject</B> command in the menu, or the command is grayed, you cannot eject the media. </P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>WORM and other types of "Write once" media are not supported in Windows&nbsp;NT.</P>
<P></P>
<P CLASS="t">There are several limitations that are unique to removable media in Windows&nbsp;NT.</P>
<UL><LI>Removable media can only have a single primary partition. Extended partitions are not supported.</LI></UL><UL><LI>Removable media devices cannot be used as part of a volume set or stripe set.</LI></UL><UL><LI>It is not possible to format a floppy disk with the NTFS file system. The Windows&nbsp;NT operating system formats all floppy disks with the FAT file system, because the additional files required for the NTFS file system use too much space on a floppy disk.</LI></UL><UL><LI>If you format a removable disk with the FAT file system, you can remove the disk while Windows&nbsp;NT is running.</LI></UL><UL><LI>When you format any removable disk with the NTFS file system, or if the page file is located on removable media, you must force Windows&nbsp;NT to unmount the disk before you can remove it. This task is necessary because the removable disk could be used, and modified, on another system. If the NTFS disk was allowed to be remounted without being closed, it is possible that the NTFS information stored in memory would no longer be accurate. </LI></UL><P>The steps that Windows&nbsp;NT needs to do to unmount a removable disk include:</P>
<UL><LI>Closing all open file handles, while ensuring that no new files are opened.</LI></UL><UL><LI>Flushing all data, including user data and file system metadata, to the disk.</LI></UL><UL><LI>Unregistering the disk, so that it is no longer possible to access it.</LI></UL><P></P>
<P>To unmount the disk, Windows&nbsp;NT has to insure that no program accesses the disk after NTFS has tried to flush the data, but before the disk is taken off line. Flushing works at shutdown, because shutdown terminates all processes that might want to write to the disk so there's nothing left running after the final flush.</P>
<P CLASS="t"></P></BODY></HTML>
