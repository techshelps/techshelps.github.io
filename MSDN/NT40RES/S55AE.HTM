<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Paging and Disk Writes</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Paging and Disk Writes</H3><P CLASS="t">Paging causes many reads from the disk, but it also causes some writing to disk. When the Virtual Memory Manager locates a faulted page, if memory is available, it simply adds the retrieved pages to the working set of the process. When memory is scarce, it deletes a page of the current working set for every new page it brings in. If data on the page has changed, it must write the data to disk before it frees up the page frame. If many of the faulted pages are data pages with changes, the writing can be significant, and Performance Monitor can measure it.</P>
<P></P>
<P CLASS="t"><B>Tip</B></P>
<P>If your application's page faults are causing disk writes, they are probably faulting data pages, not code pages. Reorganizing your application's data structures and the way the program references them can reduce page faults.</P>
<P></P>
<P CLASS="t">To limit the writes to disk, the Virtual Memory Manager maintains a <I>modified page list</I>, a list of changed pages that need to be written to disk. Periodically, the <I>modified page writer,</I> a thread in the System process, writes some of the pages out to free up space. As free space becomes scarce, the modified page thread is activated more often.</P>
<P CLASS="t">To measure writes to disk resulting from paging, chart:</P>
<UL><LI>Memory: Page Writes/sec</LI></UL><UL><LI>Memory: Pages Output/sec</LI></UL><UL><LI>Logical Disk: Disk Writes/sec</LI></UL><UL><LI>Logical Disk: Disk Write Bytes/sec</LI></UL><UL><LI>Logical Disk: Avg. Disk Write Queue Length.</LI></UL><P></P>
<P CLASS="t">JBJBMemory: Page Writes/sec indicates how often changes to pages had to be written to back to disk to free up space in a working set.</P>
<P CLASS="t">Logical Disk: Disk Writes/sec represents all writing to disk, including writes not associated with paging, like writing the Performance Monitor log file, or updating system statistics. Comparing Disk Writes to Page Writes reveals the proportion of total disk writing that consists of writing pages from memory back to disk.</P>
<P CLASS="t">Comparing Memory: Pages Output/sec and Logical Disk: Disk Write Bytes/sec also indicates the proportion of disk writing activity that is directly related to paging, but it shows it in bytes, rather than time.</P>
<P CLASS="t">Pages output/sec is the number of pages written to disk to free up page frames.</P>
<P CLASS="t">Disk Write Bytes/sec is the number of bytes written to disk per second for all purposes.</P>
<P CLASS="t">To compare Pages Output/sec to Disk Write Bytes/sec, multiply the number of pages by the number of bytes per page. MIPS, Intel, and PowerPC processors have 4096 bytes per page; DEC Alpha processors have 8192 bytes per page.</P>
<P><img src="xwr_k10.gif"></P>
<P CLASS="t">This graph compares disk read time with disk write time while the system is paging. The black line represents time reading from both physical disks on the system; the white line represents time writing. In this example, there was far more reading than writing, but the amount of writing is not insignificant.</P>
<P><img src="xwr_k11.gif"></P>
<P CLASS="t">This graph of the same events shows how much of the writing time is attributable to paging. The thin black line represents all writes to disk per second; the heavy, white line represents disk-writes due to paging. The space between them represents disk-writes other than changed pages.</P>
<P CLASS="t">In this example, the curves are almost the same shape, but the there are twice as many disk writes as page writes. This indicates that the disk writes that didn't consist of writing changed pages were related to writing them, such as writing the Performance Monitor log and writing system records.</P>
<P CLASS="t">The following report shows another measure of writing. The report includes counts of writing in pages as well as time.</P>
<P><img src="xwr_k12.gif"></P>
<P CLASS="t">To compare the Disk Write Bytes/sec to Pages Output/sec, multiply the number of pages by the page size, in this case, 4096 bytes/page. In this example, 11.952 pages out of 14.452, or 82% of disk writing is directly attributable to paging.</P></BODY></HTML>
