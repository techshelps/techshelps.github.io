<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HKEY_LOCAL_MACHINE\Software Key</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>HKEY_LOCAL_MACHINE\Software Key</H3><P CLASS="t">The HKEY_LOCAL_MACHINE\Software key contains specific configuration information about software on the local computer. The entries under this key, which applies to any user of the computer, show which software is installed on the computer.</P>
<P CLASS="t">HKEY_LOCAL_MACHINE\Software\Classes contains data to associate applications with file types (by filename extension). It also includes Registry information associated with COM objects. The data under the Classes subkey is also reflected in HKEY_CLASSES_ROOT.</P>
<P CLASS="t">Figure 23.13 shows how the HKEY_LOCAL_MACHINE\Software subkey appears on one machine.</P>
<P><img src="xwr_v18.gif"></P>
<P>Figure 23.13   The HKEY_LOCAL_MACHINE\Software subkey</P>
<P CLASS="t">The HKEY_LOCAL_MACHINE\Software subtree contains several subkeys. The Classes, Program Groups, and Secure subkeys are described here, plus general information about the various <I>Description</I> subkeys that can appear in a Registry. </P>
<H4><A NAME="sec0"></A>Classes Subkey</H4><P CLASS="t">The Classes subkey contains two types of subkeys: </P>
<P></P>
<P> </P>
<UL><LI><I>Filename-extension subkeys</I> associate applications with file types by their filename extension. These subkeys contain information you add by using the <B>File Types</B> tab in Windows&nbsp;NT Explorer, information added during installation of Windows-based applications, and information about applications installed by Windows&nbsp;NT.</LI></UL><P>Figure 23.14 shows where data is stored to associate .avi files with an application.</P>
<P><img src="xwr_v19.gif"></P>
<P><B>Figure 23.14   Filename-association subkeys in the Classes subkey</B></P>
<UL><LI><I>Class-definition subkeys</I> contain Registry information associated with Component Object Model (COM) objects. The data in these subkeys specifies the shell and OLE (COM) properties of an object. If an application supports dynamic data exchange (DDE), the Shell subkey can contain Open and Print subkeys that define DDE commands for opening and printing files, similar to the information stored in the Registry database under versions of Windows for MS-DOS. </LI></UL><P>Figure 23.15 shows the shell properties of <B>Regfile.exe</B>, the executable file for <B>Regedit</B>. In this example, the service (or friendly) name of <B>Regedit</B> is specified.</P>
<P><img src="xwr_v20.gif"></P>
<P><B>Figure 23.15   Shell properties for Regfile.exe in the Classes subkey</B></P>
<P></P>
<P CLASS="t"><B>Important</B></P>
<P>The COM information in the Registry must be created by the COM application. Do not change this information by using Registry Editor. To change the association between a file type and an application, click <B>Options</B> on the <B>View</B> menu in Windows&nbsp;NT Explorer, then use the <B>File Types</B> tab in the <B>Options</B> dialog box. </P>
<P></P>
<H4><A NAME="sec1"></A>Description Subkeys</H4><P CLASS="t">The HKEY_LOCAL_MACHINE\Software\<I>Description</I> subkeys contain the names and version numbers of the software installed on the local computer. (Information about the configuration of these applications is stored on a per-user basis under HKEY_CURRENT_USER.) </P>
<P CLASS="t">During installation, applications record this information in the following form:</P>
<P CLASS="t">HKEY_LOCAL_MACHINE\Software\Description\<I>CompanyName</I>\<I>ProductName</I>\<I>Version</I></P>
<P></P>
<P></P>
<P CLASS="t">Figure 23.16 shows some entries under the subkey for Microsoft (a&nbsp;<I>CompanyName</I>), which contains entries for the service software installed on the computer:</P>
<P><img src="xwr_v34.gif"></P>
<P>Figure 23.16   Description subkey entries </P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>The information in each subkey is added by the related application. Do not edit entries in these subkeys unless directed to do so by your application vendor.</P>
<P></P>
<H4><A NAME="sec2"></A>Microsoft Subkey</H4><P CLASS="t">The HKEY_LOCAL_MACHINE\Software\Microsoft subkey contains configuration settings for Microsoft software installed on the computer. </P>
<P CLASS="t">The Windows&nbsp;NT\CurrentVersion subkey is of particular interest. This subkey contains information about software that supports services built into Windows&nbsp;NT, as well as data about the version and type of the current release (multiprocessor versus uniprocessor). For example, it is possible to run a Windows&nbsp;NT uniprocessor kernel on a multiprocessor computer, but you do not get any multiprocessor benefits by doing so. To find out which kernel type is running on a computer, see the data in the Registry under the Windows&nbsp;NT\CurrentVersion subkey.</P>
<H4><A NAME="sec3"></A>Program Groups Subkey</H4><P CLASS="t">The Program Groups subkey under HKEY_LOCAL_MACHINE\Software is redefined in Windows&nbsp;NT&nbsp;4.0. In previous versions of Windows&nbsp;NT, it contained a list of the program groups used by all users of the local computer. In Windows&nbsp;NT&nbsp;4.0, program groups have been replaced by the Windows NT Explorer directory structure. Now, this subkey is used only to record—as a yes/no, 0x1/0x0 value—whether all former program groups have been converted to the new directory structure.</P>
<P CLASS="t">The <B>ConvertedToLinks</B> value entry indicates whether the program groups were converted. A value of 1 (0x1) indicates that the conversion is complete. </P>
<P CLASS="t">When Windows&nbsp;NT&nbsp;4.0 is installed on a computer that has never run Windows&nbsp;NT, there are no subkeys under the Program Groups subkey. However, upgraded versions can still contain binary data for common program groups that appear as Program Groups subkeys.</P>
<H4><A NAME="sec4"></A>Secure Subkey</H4><P CLASS="t">The Secure subkey provides a convenient place for applications to store configuration information that should be changed only by an administrator.</P>
<H4><A NAME="sec5"></A>Windows 3.1 Migration Status Subkey</H4><P CLASS="t">The Windows&nbsp;3.1 Migration Status subkey contains data if the computer has been upgraded from Windows&nbsp;3.<I>x</I> to Windows&nbsp;NT&nbsp;4.0. The values in this subkey indicate whether .ini and Reg.dat files have migrated successfully to the Windows&nbsp;NT&nbsp;4.0 format. If this subkey is deleted, Windows&nbsp;NT again attempts to migrate the files when the system is restarted. </P>
<P CLASS="t">There is also a Windows&nbsp;3.1 Migration Status subkey under HKEY_CURRENT_USER. It tracks the migration of Program Group (.grp) files to the Windows&nbsp;NT Explorer format.</P>
<P CLASS="t">For more information about Windows&nbsp;3.<I>x </I>migration, see Part 6, Chapter 27, "Compatibility and Migration: Windows&nbsp;3.<I>x </I>and Windows&nbsp;95<I> </I>," in this book.</P></BODY></HTML>
