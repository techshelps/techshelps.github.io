<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Context Switches</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Context Switches</H3><P CLASS="t">A <I>context switch </I>is when the microkernel switches the processor from one thread to another. Therefore, context switches are an indirect indicator of threads getting processor time. A careful examination of context switch data reveals the patterns of processor use for a thread and indicates how efficiently it shares the processor with other threads of the process or other processes.</P>
<P CLASS="t">Performance Monitor has context switch counters on the System and Thread objects:</P>
<UL><LI>System: Context Switches/sec counts all context switches.</LI></UL><UL><LI>Thread:&nbsp;Context Switches/sec is incremented when the thread gets or loses the attention of the processor.</LI></UL><P></P>
<P CLASS="t">Both rates are an average over the last two seconds. System: Context Switches/sec and Thread: Context Switches/sec: _Total should be identical or within the range of experimental error.</P>
<P CLASS="t">Care must be taken in interpreting the data. An application that is really monopolizing the processor actually lowers the rate of context switches because it doesn't let other process get much processor time. A high rate of context switching means that the processor is being shared, if only briefly.</P>
<P CLASS="t">The following figure is a histogram of Context Switches/sec for all running threads.</P>
<P><img src="xwr_l17.gif"></P>
<P CLASS="t">This histogram shows which threads are getting at least <I>some</I> processor time during a bottleneck. The large bars on the right side of the graph are system threads being moved onto and off of the processor during a bottleneck. The bottleneck is caused by the process represented by the first bar on the left. The process in the middle is Performance Monitor, which runs at a high priority to insure that it gets some processor time.</P>
<P CLASS="t">The following figure is a graph of System: Context Switches/sec during a transient bottleneck:</P>
<P><img src="xwr_l18.gif"></P>
<P></P>
<P CLASS="t">In this graph, System: %&nbsp;Total Processor time (the thick line running along the top of the graph) remains at 100% during the sample interval. System: Processor Queue Length (the thin line, scaled by a factor of 10), shows that the queue varies from 4 to 8, with a mean near 5. System: Context Switches (the white line), reveals an average of about 150 switches per second, a moderate rate. A much higher rate of context switches (near 500 per second) might indicate a problem with a network card or device driver.</P></BODY></HTML>
