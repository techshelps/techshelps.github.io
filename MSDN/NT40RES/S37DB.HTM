<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Editing Values in the Registry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Editing Values in the Registry </H3><P CLASS="t">Each value entry in Registry Editor appears as a string that consists of three components, as shown in Figure 24.2.</P>
<P><img src="xwr_w02.gif"></P>
<P>Figure 24.2    The three components of a value entry</P>
<P CLASS="t">The following rules govern the content of these three value entry components: </P>
<UL><LI>The name of the value is a string of up to 16,000 Unicode characters (32K). This name can contain backslash (<B>\</B>) characters. The name itself can be null (that is, <B>"&nbsp;"</B>).</LI></UL><UL><LI>The data type of the value is REG_BINARY, REG_DWORD, REG_EXPAND_SZ, REG_MULTI_SZ, or REG_SZ. Other data types can be defined by programs, but Registry Editor edits values of these types only. For more information about the value types, see "Value Entries for Registry Keys" in Chapter 23, "Overview of the Windows&nbsp;NT Registry."</LI></UL><UL><LI>The value in a value entry can be data of a size up to 1&nbsp;MB in any datatype except REG_DWORD, including arbitrary strings and raw binary data. However, to be efficient, values larger than 2048 bytes should be stored as files, with the filenames stored in the Registry.</LI></UL><P></P>
<P CLASS="t">The Registry preserves case as you type it for any entry but ignores case in evaluating the data. However, the data is defined by specific applications (or users), so applications that use the data might be case sensitive, depending on how the program that uses it treats the data.</P>
<P></P>
<H4><A NAME="sec0"></A>To edit a value by using Regedt32 or Regedit</H4><P>    1.    In the right pane of the Registry Editor window, double-click the value entry.</P>
<P>– Or –</P>
<P>In <B>Regedt32</B>, from the <B>Edit</B> menu, click <B>String</B>, <B>Binary</B>, <B>DWORD</B>, or <B>Multi String</B> as appropriate for the selected value. In <B>Regedit</B>, from the <B>Edit</B> menu, click <B>Modify</B>. </P>
<P>    2.    Edit the value that appears in the related <B>Editor</B> dialog box, then click <B>OK</B>.</P>
<P>The <B>Binary</B> and <B>DWORD</B> options in <B>Regedt32</B> let you select the base of the number system you use to edit your data. In the Binary editor, you can edit your data as binary (base 2) or hexadecimal (<I>hex</I>—base 16). In the DWORD editor, you can edit your data in binary, hex, or decimal (base 10). Hex is the default base for both editors. The right pane of the Registry Editor always displays these types of data in hex. </P>
<P>BMW </P>
<P CLASS="t"><B>Tip</B></P>
<P>To view numbers in decimal format, double-click the value entry and select the <B>Decimal</B> format option. Cancel the dialog box when you finish checking the value.</P>
<P></P>
<P></P>
<P CLASS="t">Information stored in a nonvolatile key remains in the Registry until you delete it. Information stored in a volatile key is discarded when you shut down the system. However, volatile keys can contain nonvolatile subkeys and nonvolatile keys can contain volatile subkeys. For example, the HKEY_LOCAL_MACHINE\ Hardware key is volatile, but many of its subkeys are nonvolatile.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>As your Registry grows in size, eventually you might want to set a larger value for <B>RegistrySizeLimit</B>. For more information, see "Registry Size Limit" in Chapter 23, "Overview of the Windows&nbsp;NT Registry."</P>
<P></P>
<H4><A NAME="sec1"></A>Adding a Key</H4><P CLASS="t">You can add a key to store data in the Registry. For example, you can add a subkey under CurrentControlSet\Services to start a service process you have written or to install a device driver that doesn't have an installation program. </P>
<P CLASS="t">To do this, you must have Create Subkey access permission for the key under which you are adding a subkey, as described in "Assigning Access Rights to Registry Keys," later in this chapter. </P>
<P></P>
<H5 CLASS="h4"><A NAME="sec2"></A>To add a key to the Registry by using Regedt32</H5><P>Select the key or subkey under which you want the new key to appear. </P>
<P>From the <B>Edit</B> menu, click <B>Add Key</B> or press the INS key. </P>
<P>In the <B>Key Name</B> box of the <B>Add Key</B> dialog box, type the name that you want to assign to your key.</P>
<P>The key name cannot contain a backslash (<B>\</B>), and it must be unique in relation to other subkeys at the same level in the hierarchy. That is, Key1 and Key2 can each have a subkey named Key3, but Key1 cannot have two subkeys named Key3.</P>
<P>Leave the <B>Class</B> box blank. This box is reserved for a future use.</P>
<P>Click <B>OK</B> to display the new key in the Registry Editor window.</P>
<P></P>
<H5 CLASS="h4"><A NAME="sec3"></A>To add a key to the Registry with Regedit</H5><P>Select the key or subkey under which you want the new key to appear. </P>
<P>From the <B>Edit</B> menu, click <B>New</B>, then click <B>Key</B>. A new folder appears under the selected key, with the name of the folder selected so that you can edit it.</P>
<P>Type a name for the key and press Enter.</P>
<H4><A NAME="sec4"></A>Adding a Value Entry to a Registry Key</H4><P CLASS="t">You can use the Registry editors to assign a new value entry to a key or edit the value entry of an existing key. When you do this, the value that you add appears in the data pane of the selected Registry window.</P>
<P CLASS="t">To determine value entries you might add, see the tuning and troubleshooting information in Regentry.hlp, which is included in the <I>Windows&nbsp;NT Workstation Resource Kit</I> CD.</P>
<H5 CLASS="h4"><A NAME="sec5"></A>To add a value entry to a Registry key by using Regedt32</H5><P>    1.    Select the subkey to which you want to add a value entry.</P>
<P>    2.    From the <B>Edit</B> menu, click <B>Add Value</B>.</P>
<P></P>
<P CLASS="t"><B>Tip</B></P>
<P>To quickly open the <B>Add Value</B> dialog box, switch to the right pane by using the TAB key or the mouse, then press the INS key.</P>
<P></P>
<P>    3.    In the <B>Add Value</B> dialog box, type the name you want to assign to the new value entry.</P>
<P></P>
<P>    4.    In the <B>Data Type</B> box, select the type that you want to assign to the value entry. </P>
<P>The data types are described in "Value Entries in the Registry Keys" in Chapter 23, "Overview of the Windows&nbsp;NT Registry."</P>
<P>    5.    Click OK, then type the value in the <B>String Editor</B> dialog box. Click <B>OK</B> again to display the new entry in the Registry Editor window.</P>
<P></P>
<H5 CLASS="h4"><A NAME="sec6"></A>To add a value entry to a Registry key by using Regedit</H5><P>    1.    Select the subkey to which you want to add a value entry.</P>
<P>    2.    From the <B>Edit</B> menu, click <B>New</B>, then click <B>String Value</B>, <B>Binary Value</B>, or <B>DWORD Value</B> depending upon the data type of the value you are adding. </P>
<P>    3.    The new value entry appears in the right panel with the name of the value entry selected so you can edit it.</P>
<P>    4.    Type a name for the value entry.</P>
<P>    5.    To edit the value, double-click the value entry, then edit the value in the <B>Value</B> <B>data</B> box of the <I>Datatype</I><B> Editor </B>dialog box, then click <B>OK</B>.</P>
<P></P>
<H4><A NAME="sec7"></A>Deleting a Key or a Value Entry</H4><P CLASS="t">To remove selected keys or value entries from the Registry, you can use the <B>Delete</B> command from the <B>Edit</B> menu or you can press the DELETE key. However, you cannot delete any of the predefined subtrees or change the name of a key. </P>
<P></P>
<P CLASS="t"><B>Caution   </B>There is no <B>Undo</B> command for deletions. Registry Editor prompts you to confirm the deletions if <B>Confirm On Delete</B> is selected from the <B>Options</B> menu. When you delete a key, the message does not include the name of the key you are deleting. Check your selection carefully before proceeding. To recover a subkey of HKEY_LOCAL_MACHINE\System\CurrentControlSet, restart the computer. Press the spacebar immediately when you see the message <B>Press spacebar now to invoke Hardware Profile/Last Known Good Menu</B>.</P>
<P CLASS="t">In <B>Regedt32</B>, you can protect the Registry from accidental deletions by using the following methods:</P>
<UL><LI>Protect data through read-only mode.</LI></UL><P>From the <B>Options</B> menu, select <B>Read Only Mode</B>. When this option is selected, <B>Regedt32</B> does not save any changes. This protects the data from accidental changes.</P>
<UL><LI>Protect data through confirmation.</LI></UL><P>From the <B>Options</B> menu, select <B>Confirm On Delete</B>. When this option is selected, <B>Regedt32</B> prompts you to confirm deletion of any key or value.</P>
<P></P>
<P></P></BODY></HTML>
