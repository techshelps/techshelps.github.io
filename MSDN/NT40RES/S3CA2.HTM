<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Security Event Examples</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Security Event Examples</H3><P CLASS="t">As described earlier, you can track several categories of security events. This section provides examples for most of these categories. This set of examples does not constitute a strategy for using the auditing capabilities of Windows&nbsp;NT; it merely serves as an introduction to show how to turn on auditing and to help you interpret these events when you enable auditing for your Windows&nbsp;NT system. </P>
<H4><A NAME="sec0"></A>Example 1: Tracking File and Object Access</H4><P CLASS="t">In this example, a user opens, modifies, saves, and closes a text file. Each of these actions generates an audit event. You must be logged on as an administrator, and make sure to enable auditing for file and object access in User Manager.</P>
<P>    1.    Create a .txt file using Notepad (it need not contain any text).</P>
<P>    2.    In Windows&nbsp;NT Explorer or in My computer, right-click on the .txt file icon, select Properties, and then click the Security tab.</P>
<P>    3.    Click Permissions, click Add, and then click Show Users.</P>
<P>    4.    Click to select the user, click Add to add the selected user to the list, and then click <B>OK</B>.</P>
<P>    5.    Give the user Full Control, and then click <B>OK</B>.</P>
<P>    6.    Click Auditing, click Add, and then click Show Users.</P>
<P>    7.    Click to select the user, click Add to add the selected user to the list, and then click <B>OK</B>.</P>
<P>    8.    Select the <B>Read Success</B>, <B>Read Failure</B>, <B>Write Success</B>, and <B>Write Failure</B> check boxes.</P>
<P>    9.    Click <B>OK</B> in both dialog boxes.</P>
<P>    10.    Have the user double-click the .txt file, write data to the file, save it, and then close the file.</P>
<P></P>
<P CLASS="t">This results in audit events, as shown in the following illustration:</P>
<P><img src="xwr_e14.gif"></P>
<P CLASS="t">From this view of the security log, you get a quick summary of security-related events that occurred. Double-click the first event to examine the details. (For example, details of this first event are shown in the Event Detail box.)</P>
<P CLASS="t">The data that needs to be interpreted is listed in the Description list box. The following table summarizes the audited events for this example, in the order they occurred: </P>
<P>Table 6.1    Security Events for File Access Example</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B></B></P>
<P CLASS="th"><B>Event ID and description</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B></B></P>
<P CLASS="th"><B>Analysis</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Event 560: Object Open<BR>Event 561: Handle Allocated<BR>Event 562: Handle Closed</P></TD><TD VALIGN="TOP"><P>In this sequence of events, Windows&nbsp;NT is doing some internal checks, such as checking to see if the file exists and checking to see that there is no sharing violation.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 592: A New Process Has Been Created<BR>Event 560: Object Open<BR>Event 561: Handle Allocated<BR>Event 562: Handle Closed</P></TD><TD VALIGN="TOP"><P>In this series of events, a new process is created for Notepad.exe. This process opens the .txt file for reading. Next, the process allocates, then closes, a handle to the file. Note that from the security log it is clear that Notepad does not keep an open handle to the file; it simply keeps a copy of the file in memory.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 560: Object Open<BR>Event 561: Handle Allocated<BR>Event 562: Handle Closed</P></TD><TD VALIGN="TOP"><P>The process opens the file for reading and writing, and since the event is a successful audit, new data is written to the file. Next, the handle is allocated for the open file, then closed.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 593: A Process Has Exited</P></TD><TD VALIGN="TOP"><P>This event indicates that the process, whose process ID relates to Notepad.exe, has ended.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4><A NAME="sec1"></A>Example 2: Use of User Rights</H4><P CLASS="t">In this example, auditing is enabled by using User Manager to enable auditing for Success and Failure of Use of User Rights.</P>
<P CLASS="t">Use of User Rights generates audit events when a process initiates an operation that requires special privilege. For example, in order to set the system time, a user first must be given the user right to "Change The System Time" in User Manager.</P>
<P CLASS="t">For more information about User Rights see "User Rights" in the "High-Level Security" section later in this chapter.</P>
<P CLASS="t">When the user tries to change the system time, only one event is generated, as shown in the following illustration:</P>
<P><img src="xwr_e17.gif"></P>
<P CLASS="t">This event indicates that a privileged service was called and that a server component named <I>Kernel</I> has called an audit check on the primary username of the user. The audit type is a Success Audit, meaning that the user successfully exercised the right to use the SeSystemtimePrivilege (that is, the right to change the system time).</P>
<H4><A NAME="sec2"></A>Example 3: User and Group Management</H4><P CLASS="t">In this example, a new user account is added to the user accounts database. Auditing is enabled in User Manager by specifying both Success and Failure of User and Group Management. This generates four audit events, as shown in the following illustration:</P>
<P><img src="xwr_e15.gif"></P>
<P CLASS="t"></P>
<P>Table 6.2    Security Events for Added User Account</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B></B></P>
<P CLASS="th"><B>Event ID and description</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B></B></P>
<P CLASS="th"><B>Analysis</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Event 632: Global Group Member Added<BR>Event 624: User Account Created</P></TD><TD VALIGN="TOP"><P>A new security ID (member) is created and added to the group represented by the target account ID. This is a default global group Domain Users. At this point, the security ID does not have a username allocated to it.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 642: User Account Changed</P></TD><TD VALIGN="TOP"><P>This event indicates that the account name of the security ID represented by the Target Account ID has been changed to the new user's.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 636: Local Group Member Added</P></TD><TD VALIGN="TOP"><P>This event indicates that the account represented by the new user's security ID is created. The new user is added to the local group represented by the security ID under Target Account ID (Users).</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4><A NAME="sec3"></A>Example 4: Restart, Shutdown and System</H4><P CLASS="t">In this example, auditing is enabled in User Manager for both Success and Failure of Restart, Shutdown and System.</P>
<P CLASS="t">In this example, seven events were generated. Note, however, that the number of events generated is related to the number of trusted systems that you start when the system is restarted. This number might vary if you replicate this scenario on your own Windows&nbsp;NT computer.</P>
<P><img src="xwr_e18.gif"></P>
<P>Table 6.3    Security Events for System Startup</P>

<TABLE COLS="5" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="238pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="5" VALIGN="TOP"><P></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B></B></P>
<P CLASS="th"><B>Event ID and description</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="th"><B></B></P>
<P CLASS="th"><B>Analysis</B></P></TD></TR><TR><TD COLSPAN="5" VALIGN="TOP"><P></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Event 512: Windows&nbsp;NT  <BR>is starting up.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>Identifies the date and time the system started.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P>Event 514: Authentication <BR>package loaded</P></TD><TD COLSPAN="3" VALIGN="TOP"><P>The description of this event says </P>
<P>An authentication package has been loaded by<BR>the Local Security Authority. This <BR>authentication package will be used to <BR>authenticate logon attempts.<BR>Authentication Package Name: msv 1_0</P>
<P>This is the standard authentication package shipped with Windows&nbsp;NT. </P></TD></TR><TR><TD VALIGN="TOP"><P>Events 515: Trusted <BR>logon process</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>The description for each of these events says</P>
<P>A trusted logon process has registered with the<BR>Local Security Authority. This logon process<BR>will be trusted to submit logon requests.</P>
<P>The logon process name is listed for each of these events, as follows:</P>
<P>  Winlogon<BR>  Service Control Manager<BR>  LAN Manager Workstation Service<BR>  LAN Manager Server<BR>  LAN Manager Redirector</P>
<P>Each of these events is a successful audit in the category of system event. These events indicate that the respective logon processes have registered with the Local Security Authority and are now trusted to submit logon requests.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P></BODY></HTML>
