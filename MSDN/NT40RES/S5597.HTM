<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Timing Extensible Counters</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Timing Extensible Counters</H3><P CLASS="t">Windows&nbsp;NT&nbsp;4.0 Performance Library now times the Open procedure call of all extensible counters and writes an error to the Event Viewer application event log if the call time exceeds a threshold. The log entry helps you to identify counters that may be delaying or locking Performance Monitor during initialization. While the open call proceeds, local users cannot use Performance Monitor and remote users cannot log on to the affected computer. Usually this takes just a few milliseconds.</P>
<P></P>
<P CLASS="t"><B>Tip</B></P>
<P>Extensible Counter List (Exctrlst.exe), a tool on the Windows NT Resource Kit 4.0 CD in the Performance Tools group (\PerfTool\CntrTool), displays the names of the Open, Collect, and Close procedure calls of the extensible counters installed on a computer. For more information, see Rktools.hlp.</P>
<P></P>
<P CLASS="t">You can adjust the time threshold to allow more time for slower calls that are not in error. Only the Open calls of extensible counters are timed. Standard Performance Monitor counters and other calls to extensible counter functions are not affected.</P>
<P CLASS="t">To change the time threshold, use a Registry Editor, such as Regedt32, to add or change the OpenProcedureWaitTime value entry in the Registry, and then restart the computer.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="85pt" VALIGN="TOP"><COL WIDTH="262pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Subtree</P></TD><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE</P></TD></TR><TR><TD VALIGN="TOP"><P>Key</P></TD><TD VALIGN="TOP"><P>\Software\Microsoft\WindowsNT\CurrentVersion\Perflib</P></TD></TR><TR><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>OpenProcedureWaitTime</P></TD></TR><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>REG_DWORD</P></TD></TR><TR><TD VALIGN="TOP"><P>Values</P></TD><TD VALIGN="TOP"><P>0 - 4 billion, in milliseconds. The default is 5000 milliseconds (5&nbsp;seconds).</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">Remember to check the Event Viewer application event log for errors and to clear the log periodically to save space on the disk.</P></BODY></HTML>
