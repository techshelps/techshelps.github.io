<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Measuring and Tuning Priorities</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Measuring and Tuning Priorities</H3><P CLASS="t">Windows NT and the Windows NT Resource Kit 4.0 CD include several tools for monitoring the base priority of processes and threads and the dynamic priority of threads. You can set the base priority of processes and threads in the application code. Some Windows NT tools and Resource Kit tools let you change the base priority of a process as it runs, but the change lasts only until the process stops.</P>
<P CLASS="t"><B>Warning   </B>Changing priorities may destabilize the system. Increase the priority of a process may prevent other processes, including system services, from running. Decreasing the priority of a process may prevent it from running, not just allow to run less frequently.</P>
<P></P>
<P CLASS="t"><B>Tip</B></P>
<P>When you start processes from a command prompt window by using the <B>Start</B> command, you can specify a base priority for the process for that run. To see all of the start options, type<B> Start  /?</B> at the command prompt.</P>
<P></P>
<H4><A NAME="sec0"></A>Using Performance Monitor </H4><P CLASS="t">Performance Monitor lets you watch and record—but not change—the base and dynamic priorities of threads and processes. Performance Monitor has priority counters on the Process and Thread objects:</P>
<UL><LI>Process:  Priority Base</LI></UL><UL><LI>Thread:  Priority Base</LI></UL><UL><LI>Thread:  Priority Current</LI></UL><P></P>
<P CLASS="t">Because these counters are instantaneous and display whole number values, averages and the _Total instance are meaningless, and are displayed as zero. </P>
<P CLASS="t">The following figure is a graph of the base priorities of several processes. It shows the relative priority of the running applications. The Idle process (the white line at the bottom of the graph) runs at a priority of Idle (0) so it never interrupts another process.</P>
<P><img src="xwr_l24.gif"></P>
<P></P>
<P CLASS="t">The following figure is a graph of the dynamic priority of the single thread in the Paintbrush applet, Pbrush.exe, as it changes in response to user actions. The base priority of the thread (the gray line) is 8 (foreground Normal). During this period of foreground use, the dynamic priority of the thread (the black line) is 14, but drops to 8 when other processes need to run.</P>
<P><img src="xwr_l25.gif"></P>
<H4><A NAME="sec1"></A>Using Task Manager</H4><P CLASS="t">Task Manager displays and let you change the base priority of a process, but it does not monitor threads. Base priorities changed with Task Manager are effective only as long as the process runs. For more information, see "Task Manger" in Chapter 3, "Performance Monitoring Tools."</P>
<H5 CLASS="h4"><A NAME="sec2"></A>To display the base priorities of processes in Task Manager </H5><P>    1.    Open Task Manager (Ctrl+Shift+ Esc), and click the <B>Processes</B> tab.</P>
<P>    2.    From the <B>View</B> menu, click <B>Select Columns</B>.</P>
<P>    3.    Select <B>Base Priority</B>.</P>
<P></P>
<H5 CLASS="h4"><A NAME="sec3"></A>To change the base priority of a process</H5><P>    1.    Click the Processes tab.</P>
<P>    2.    Click a process name with the right mouse button. A menu appears.</P>
<P>    3.    Click <B>Set Priority</B>, then click a new base priority to change it.</P>
<P></P>
<P CLASS="t">The change is effective at the next Task Manager update; you need not restart the process.</P>
<H4><A NAME="sec4"></A>Using Process Viewer</H4><P CLASS="t">Process Viewer (Pviewer.exe), a tool on the Windows NT Resource Kit 4.0 CD in the Performance Tools group (\PerfTool\MeasTool), lets you monitor process and thread priority and change the base priority class of a process. For more information, see "Process Viewer" in Chapter 2, "Performance Monitoring Tools" and Rktoools.hlp.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>Process Explode (Pview.exe), also on the Windows NT Resource Kit 4.0 CD, is a superset of the functions of Process Viewer. Although the interface is different, both utilities get their information from the same source and you can change the base priority class by using either tool. For more information, see "Process Explode" in Chapter 11, "Performance Monitoring Tools."</P>
<P></P>
<P CLASS="t">To display the base priority of a process, open Process Viewer and select the computer you want to monitor.</P>
<P><img src="xwr_l27.gif"></P>
<H5 CLASS="h4"><A NAME="sec5"></A>To display or change the base priority of a process</H5><P>    1.    In the Process box, click the line representing the process. All data in the dialog box changes to show the values for that process. The base priority of the process appears in the Priority box (under the Process box.).</P>
<P>    2.    To change the priority of the process for this run, click a button in the Priority box. The three priority classes listed—Idle, Normal, and Very High—are associated with the priority classes Idle, Normal, and High, respectively. You cannot change a process to the Real-time priority class.</P>
<P></P>
<H5 CLASS="h4"><A NAME="sec6"></A>To display the dynamic priority of a thread</H5><P>    1.    In the Process box, click the line representing the process.</P>
<P>    2.    From the Thread box (near the bottom), select the line representing the thread. All thread data changes to show values for that thread. The Thread Priority box (to the left of the thread box) displays the thread's dynamic priority in radio buttons, but the buttons do not work: You cannot change the dynamic priority of a thread by using Process Viewer.</P>
<P></P>
<H4><A NAME="sec7"></A>Tuning Foreground and Background Priorities</H4><P CLASS="t">When a user interacts with an application, the application moves to the <I>foreground</I> and the operating system <I>boosts</I> (increases) the base priority of the process to improve its response to the user. The application returns to <I>background</I> priority—and loses the boost—when the user interacts with a different process. </P>
<P CLASS="t">You can change the amount of boost given to foreground applications and, in so doing, change the relative priority of foreground to background applications. Reducing the boost improve the response of background process when they are not getting enough processor time.</P>
<H5 CLASS="h4"><A NAME="sec8"></A>To change the priority of foreground application</H5><P>    1.    Double-click the Control Panel System applet and select the Performance tab. The Application Performance box shows the current setting for the boost.</P>
<P>    2.    Drag the arrow to set the boost. The default is Maximum (a priority boost of 2) but you can change it to 1 or to None (0), the setting at which foreground processes have no advantage over background processes. For example, most applications run at Normal priority (7) and are boosted to Foreground Normal priority (9) when the user moves the application window to the top of the window stack.</P>
<P></P>
<P><img src="xwr_l28.gif"></P></BODY></HTML>
