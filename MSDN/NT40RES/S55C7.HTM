<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Page Faults and Cache Bottlenecks</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Page Faults and Cache Bottlenecks</H3><P CLASS="t">When memory is scarce, more data must remain on the disk. Accordingly, page faults are more likely. Similarly, when the cache is trimmed, cache hit rates drop and cache faults increase. Cache faults are a subset of all page faults.</P>
<P></P>
<P CLASS="t"><B>Note</B></P>
<P>The operating system sees the cache as the file system's working set, its dedicated area of physical memory. When data isn't found in the cache, the system counts it as a <I>page fault</I>, just as it would when data was not found in the working set of a process.</P>
<P></P>
<P CLASS="t">To monitor the effect of cache bottlenecks on disk, use the following counters:</P>
<UL><LI>Memory:  Cache Faults/sec</LI></UL><UL><LI>Memory:  Page Faults/sec</LI></UL><UL><LI>Memory:  Page Reads/sec</LI></UL><UL><LI>Logical Disk:  Disk Reads/sec</LI></UL><P></P>
<P CLASS="t">The following graph shows the proportion of page faults that can be traced to the cache. Cache Faults/sec includes data sought by the file system for mapping as well as misses in copy reads for applications. Because both the Cache Faults/sec and Page Faults/sec counters are measured in numbers of pages, they can be compared without conversions.</P>
<P><img src="xwr_m04.gif"></P>
<P></P>
<P CLASS="t">In this example, the thin black line represents all faulted pages; the thick black line represents pages faulted from the cache. Places where the curves meet indicate that nearly all page faults are cache faults. Space between the curves indicates faults from the working sets of processes. In this example, on average, only 10% of the relatively high rate of page faults happen in the cache. </P>
<P CLASS="t">The important page faults, however, are those that require disk reads to find the faulted pages. But the memory counters that measure disk operations due to paging make no distinction between the number of reads or pages read due to cache faults and those caused by all faults.</P>
<P><img src="xwr_m05.gif"></P>
<P CLASS="t">This graph and the report that follows show that most faulted pages are soft faults. Of the average of 182 pages faulted per second, only 21.586—less than 12%—are hard faults. It is even more difficult to attribute any of the pages input due to faults to the cache.</P>
<P><img src="xwr_m06.gif"></P></BODY></HTML>
