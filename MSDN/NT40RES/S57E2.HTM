<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting by Using the Last Known Good Configuration</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Troubleshooting by Using the Last Known Good Configuration </H3><P CLASS="t">Windows&nbsp;NT provides two configurations in which you can start your computer:</P>
<UL><LI>Default, the configuration that was saved when you shutdown the computer.</LI></UL><UL><LI>Last Known Good, the configuration that was saved when you last logged on to your computer.</LI></UL><P></P>
<P CLASS="t">The configurations are stored as control sets in the Registry key HKEY_LOCAL_MACHINE\SYSTEM. If you made changes to your configuration when you were last logged on, such as adding drivers, changing services, or changing hardware, the two control sets will contain different information. As soon as you log on however, the information in these control sets will be the same. Therefore, if you are having problems with startup, and think the problems might be related to changes in your configuration, do not log on. Instead, shutdown the computer and restart it. Then, select <B>Last Known Good</B> from the <B>Hardware Profile/Last Known Good</B> menu to recover from the following types of problems:</P>
<UL><LI>You install a new device driver, restart Windows&nbsp;NT, and the system stops responding. The Last Known Good control set enables you to startup because it does not contain any reference to the new, faulty driver.</LI></UL><UL><LI>You install a new video driver and are able to restart the system. However, you cannot see anything, because the new video resolution is incompatible with your video adapter. Do not try to log on. If you have the option to shutdown the computer without logging on, do so. If that option is not available, you need to restart your computer by turning it off or using the reset button. Wait for all disk activity to stop before you initiate the restart, especially if the computer has FAT volumes.</LI></UL><UL><LI>You accidentally disable a critical device driver (such as the Scsiport driver). Windows NT is not be able to start and automatically reverts to the Last Known Good control set.</LI></UL><P></P>
<P CLASS="t">Using the Last Known Good control set does not help in the following situations:</P>
<UL><LI>Any problem that is not related to changes in control set information, such as information like user profiles and file permissions.</LI></UL><UL><LI>After you logged on after making changes. Here, the Last Known Good control set has already been updated to include the changes.</LI></UL><UL><LI>Switching between different hardware profiles, such as docked and undocked laptops. The Last Known Good control set is only a method to switch between configuration information in the Registry. Use Hardware Profiles for this.</LI></UL><UL><LI>Startup failures caused by hardware failures or corrupted files.</LI></UL><UL><LI>Copying a new driver over the top of an old one, and the old one is already active.</LI></UL><P></P>
<P CLASS="t">For more information about hardware profiles and control sets, see Chapter 19, "What Happens When You Start Your Computer." Chapter 36, "General Troubleshooting," contains more details about troubleshooting by using the Registry key HKEY_LOCAL_MACHINE.</P></BODY></HTML>
