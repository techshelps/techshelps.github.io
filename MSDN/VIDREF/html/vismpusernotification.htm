<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>User Notification Sample</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="vismpusernotification"></a>User Notification Sample</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vismpUserNotification_C;vismpUserNotificationC">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vismpUserNotification_T;vismpUserNotificationT">
</object></p>
<p>
This sample uses user authentication to post and receive messages from other users that have access to this page.</p>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>For the sample to work properly, you must turn off Anonymous access to the UserNote directory. This can be done using the Microsoft Management Console. Right-click on the UserNote directory in the Gallery project and select Properties. Authentication control can be adjusted using the Directory Security tab in the Properties dialog.</p>
<h2>Behind the Scenes</h2>
<p>
This sample uses three files: UserNote.asp, DelNote.asp and SendNote.asp. 
<ul type=disc>
<li>
<B><b>UserNote.asp</b></B> displays messages sent by other members of the organization to the user logged into this page. <br><br></li>
<li>
<B><b>DelNote.asp</b></B> deletes messages from the list of stored messages. <br><br></li>
<li>
<B><b>SendNote.asp</b></B> stores messages from the user that are to be sent to other users of the organization.</li>
</ul>
<p>
UserNote.asp uses a <a href="victlrecordsetcontrol.htm">recordset</a> control and a data-bound <a href="victlgridcontrol.htm">grid</a> control to display messages that have been posted for the user. </p>
<p>
The messages are retrieved from the UserNote table in the Gallery database. The recordset queries the table to find any messages for the current user. Below is the SQL statement used to achieve this:</p>
<pre><code>   function DTCRecordset1_onbeforeopen() {
      newSQL = "Select * FROM UserNote WHERE (TO = '" + Request.ServerVariables("AUTH_USER") + "')";
      DTCRecordset1.setSQL(newSQL);
   }
</code></pre>
<p>
If there are no messages for the current user, the grid is not displayed and there is only a link to send messages. If there are messages for the current user they are displayed in the grid. The grid displays the message text as well as who the message is from. There is also an option to delete each message. </p>
<p>
DelNote.asp is called when the user wants to delete a particular message. The ID number of the message is passed to DelNote.asp and the corresponding record is deleted from the database. After the message is deleted the user is redirected back to the UserNote.asp page.</p>
<p>
SendNote.asp uses data-bound controls in conjunction with the <a href="victlformmanagercontrol.htm">FormManager</a> control to store user input into the UserNote table. </p>
<p>
There are two controls that accept input: a <a href="victltextboxcontrol.htm">textbox</a> control denotes who the message is being sent to and a text area control contains the message. </p>
<p>
When addressing the message to another member of your organization you must enter both the domain and user name (such as, Domain1\User1). This address is not case sensitive. In this example the message is limited to 255 characters.</p>
</BODY>
</HTML>
