<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>setParameter Method</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="viprosetparametermethod"></a>setParameter Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="viproSetParameterMethod_C">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="viproSetParameterMethod_T">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="viproSetParameterMethod_A">
</object></p>
<p>
Sets a parameter for a stored procedure or parameterized query that is referenced by the recordset</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i>.<b>setParameter</b>(<i>nIndex</i>, <i>strParameter</i>)</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>object</i></p>
<p class=indent>
A <a href="victlrecordsetobject.htm">Recordset</a> script object.</p>
<p class=dt>
<i>nIndex</i></p>
<p class=indent>
An integer that specifies the zero-based index of a particular parameter within the array of parameters.</p>
<p class=dt>
<i>strParameter</i></p>
<p class=indent>
The string value that you want to assign to the parameter.</p>
<p class=label>
<b>Remarks</b></p>
<p>
To return a parameter of stored procedure or parameterized query, use the <a href="viprogetparametermethod.htm">getParameter</a> method.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;In JavaScript, all data types in parameters are passed as strings.</p>
<p>
For information on parameterized queries and DHTML, see the white paper "Using Parameterized Queries in DHTML" on the Microsoft<sup>®</sup> Visual InterDev™ Web site at <a href="http://www.microsoft.com/vinterdev/">http://www.microsoft.com/vinterdev/</a>.</p>
<p class=label>
<b>Example for a stored procedure</b></p>
<p>
This example sets the parameters for the stored procedure identified in a Recordset design-time control that is named "DTCRecordset1." This sample assumes that the Recordset control has been added to the page, that the database object is set to "Stored Procedure," and that the specific stored procedure has been selected in the Object Name field. </p>
<p>
In the <a href="virefimplementationtabrecordsetpropertiesdialogbox.htm">Implementation Tab</a> of the Recordset design-time control property pages, the value for "Automatically open the recordset" has been unchecked.</p>
<p>
In the example, the input parameters are set, the recordset opened, and then the return parameter is retrieved and evaluated for special conditions. </p>
<p>
Note that with stored procedures, the parameters array is 0-based (where the "0" parameter is the return value while in script the parameters passed to the stored procedure start with "1").</p>
<pre><code>&lt;script language=javascript runat=server&gt;
function InsertUser(strFName,strLName,strEName,stPassword)
   {
   DTCRecordset1.setParameter(1,strFName);
   DTCRecordset1.setParameter(2,strLName);
   DTCRecordset1.setParameter(3,strEName);
   DTCRecordset1.setParameter(4,stPassword);         
   DTCRecordset1.open();
   // Get the new ID
   var getID = DTCRecordset1.getParameter(0);
   // check the return value.&nbsp; Either ID or special case
   if (getID &lt; 1)
      {
      var msg = "Sorry, Couldn't add &lt;b&gt;" + strFName + " " + strLName + "&lt;/b&gt;&lt;br&gt;";
      switch (getID)
         {
         case -1:
            msg += "You are already a user in the system." + "&lt;br&gt;";
         }
         Response.Write(msg);   
      }
   else if (getID &gt;= 1)
      {
      // Formulate the response message
      Response.Write("Welcome " + strFName + " " + strLName + "&lt;p&gt;");
      }
}
&lt;/script&gt;
</code></pre>
<p class=label>
<b>Example for a parameterized query</b></p>
<p>
This example of a parameterized query sets the parameters for the SQL statement identified in the Recordset design-time control named "DTCRecordset1". </p>
<p>
This sample assumes that the Recordset design-time control has been added to the page, that the database object is set to "SQL Statement", and that the SQL Statement is "SELECT * FROM AUser WHERE email=?". </p>
<p>
In the <a href="virefimplementationtabrecordsetpropertiesdialogbox.htm">Implementation Tab</a> of the Recordset design-time control property pages, the value for "Automatically open the recordset" has been un-checked. Parameterized queries only work for ASP pages.</p>
<p>
In the example, the input parameter is being set, the recordset opened, and then the parameter is returned to display a warning condition. Note that with parameterized queries, the parameters array is zero-based</p>
<pre><code>&lt;script language=javascript runat=server&gt;
   function UserStatus(strEName)
      {
         DTCRecordset1.setParameter(0,strEName);
         DTCRecordset1.open();
         if (DTCRecordset1.getCount() &gt; 0)
         {
         var strFName = DTCRecordset1.fields.getValue("FName")
         var strLName = DTCRecordset1.fields.getValue("LName")
         Response.Write("Welcome " + strFName + " " + strLName + "&lt;p&gt;");
         }
         else
         {
         Response.Write(DTCRecordset1.getParameter(0) + " is not in the system");
         }
      }
&lt;/script&gt;
</code></pre>
</BODY>
</HTML>
