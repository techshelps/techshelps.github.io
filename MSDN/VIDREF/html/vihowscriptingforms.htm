<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Event-Driven Forms</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="vihowscriptingforms"></a>Creating Event-Driven Forms</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vihowScriptingForms_C">
</object></p>
<p>
You can easily create a form with different modes on your Web page using the FormManager control. For example, you can create a data-entry form with Insert, Update, and Delete modes. When specified control events, such as clicking a button, occur, the form moves from one mode to another. </p>
<p>
You can also specify property settings and methods to run both when a particular form mode is established, and during the transitions from mode to mode. All of this is accomplished without scripting, using the FormManager control's property pages. </p>
<p>
For detailed examples of how to create a data-entry form using the FormManager control, see <a href="viconsimplifyingdataentrypages.htm">Simplifying Data Entry Pages</a> and <a href="vismpadataentryform.htm">Data Entry Form Sample</a>. For more information on the FormManager control's property pages, see <a href="virefformmanagerpropertiesdialogbox.htm">FormManager Properties Dialog Box</a>.</p>
<p>
The first steps in creating a Web page on which you'll use the FormManager control are to add a Recordset control and any other design-time controls you'll want to display on the page in the various form modes. For example, you may want text boxes to display data, and buttons to use to switch between form modes. For information on how to add data-bound controls to ASP or HTML pages, see <a href="vihowqueryingdatabase.htm">Querying the Database</a>, <a href="vihowdisplayingrecords.htm">Displaying Records</a>, and <a href="viovrviewingdata.htm">Viewing Data</a>.</p>
<p>
When you have the controls you want to use in your form modes on the page, you can add a FormManager control, and then define its modes and transitions.</p>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>Although it's common, you don't have to display data on forms created using the FormManager control. If you aren't displaying data on your forms, you don't need to use a Recordset control.</p>
<p class=label>
<b>To add a FormManager control to a page</b>
<ol>
<li>
Make sure that you have set options to view controls graphically. From the <b>View</b> menu, choose <b>View Controls Graphically</b>. To set this option as default, use the <b>HTML</b> node of the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="csdlgHTMLEditorOptions(HTMLOptionsDialogBox)">
</object><a href=JavaScript:alink_2.Click()>Options</a> dialog box.<br><br></li>
<li>
Open the ASP or HTML page in the editor.<br><br></li>
<li>
Drag the <a href="victlformmanagercontrol.htm">FormManager control</a> from the <b>Design-Time Controls</b> tab of the <b>Toolbox</b> onto the page.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you're using DHTML on your page, be sure to place the FormManager control on the page below any of the controls you want to use with the form. This ensures that the FormManager will have access to all objects on the page. </p></li>
</ol>
<p class=label>
<b>To add a form mode</b>
<ol>
<li>
Right-click the FormManager control on the page and select the <b>Properties</b> command from the shortcut menu.<br><br></li>
<li>
On the <b>Form Mode</b> tab of the <b>Property Pages</b>, enter a name for the FormManager control if you want. This name is used to identify the control in the script that it generates. If you don't supply a name, a default name is used.<br><br></li>
<li>
In the <b>States</b> group, enter the name you want to use for the mode in the <b>New Mode</b> box.<br><br></li>
<li>
Choose the arrow key to the right of the <b>New Mode</b> box.<br><br></li>
<li>
The new mode's name is displayed in the <b>Form Mode</b> list.<p class=tl>
For information on how to define the mode, see "To define a mode" below.</P></li>
</ol>
<p class=label>
<b>To specify a default mode</b>
<ol>
<li>
Right-click the FormManager control on the page and select the <b>Properties</b> command from the shortcut menu.<br><br></li>
<li>
On the <b>Form Mode</b> tab of the <b>Property Pages</b>, select the mode you want to use for the default mode in the <b>Default Mode</b> list box.<p class=tl>
This mode must be one of the modes you've named and placed in the <b>Form Mode</b> list.</P></li>
</ol>
<p class=label>
<b>To define a mode</b>
<ol>
<li>
Right-click the FormManager control on the page and select the <b>Properties</b> command from the shortcut menu.<br><br></li>
<li>
On the <b>Form Mode</b> tab of the <b>Property Pages</b>, select the mode you want to define in the <b>Form Mode</b> list.<br><br></li>
<li>
In the <b>Actions Performed for Mode</b> table, select a control whose property you want to set or for which you want to run a method in the <b>Object</b> field. For example, you can set a <a href="victltextboxcontrol.htm">Textbox</a> control's <a href="viprodisabledproperty.htm">disabled</a> property to true, or use the <a href="viproadditemmethod.htm">addItem</a> method to add a value to a <a href="victllistboxcontrol.htm">Listbox</a> control.<br><br></li>
<li>
In the <b>Member</b> field, select the property you want to set or the method you want to run.<br><br></li>
<li>
In the <b>Value</b> field enter the value you want to set the property to, or any parameters for the method. <p class=tl>
If you're setting a property, the <b>Value</b> field will show &lt;value&gt;. Replace this with the property setting. If the setting is a string, use quotation marks.</P><p class=tl>
If you're running a method, the <b>Value</b> field will show empty parentheses. Put any parameters for the method inside the parentheses. In the drop-down list in the <b>Member</b> field, the methods are listed with their parameters.</P></li>
<li>
Repeat steps 3 through 5 until you've defined all the property settings and methods for this form mode.<p class=tl>
For more information on defining form modes, see <a href="viconsimplifyingdataentrypages.htm">Simplifying Data Entry Pages</a>. For information on the various script objects for design-time controls and their properties, methods, and events, see <a href="viovrscriptobjectmodelobjects.htm">Script Objects</a>.</P></li>
</ol>
<p class=label>
<b>To specify when mode transitions occur</b>
<ol>
<li>
Right-click the FormManager control on the page and select the <b>Properties</b> command from the shortcut menu.<br><br></li>
<li>
On the <b>Action</b> tab of the <b>Property Pages</b>, select the mode whose transition you want to define in the <b>Current Mode</b> field of the <b>Form Mode Transitions</b> table.<br><br></li>
<li>
In the <b>Object</b> field, select the object you want to use to trigger a change from this mode to another mode. For example, you may want the user to click the Insert button to move from Update mode to Insert mode.<br><br></li>
<li>
In the <b>Event</b> field, select the control event that will trigger the mode transition. For example, the <a href="viproonclickevent.htm">onclick</a> event of the Insert button.<br><br></li>
<li>
In the <b>Next Mode</b> field, select the mode you want to move to when the control event occurs. For example, you might move to Insert mode.<br><br></li>
<li>
Repeat steps 2 through 5 until you've defined transitions among all the modes on your form.<br><br></li>
<li>
In the <b>Actions Performed Before Transition</b> table, you can also set properties and define methods that will take effect when a mode transition occurs, but before you move to the new mode. For information on how to make these settings, see "To define a mode", above.</li>
</ol>
<p>
In addition to the methods provided with Microsoft Visual InterDev and the design-time controls' <a href="viovrscriptingobjectmodel.htm">Scripting Object Model</a>, you can also reference methods you've defined in the page's script in a mode or a mode transition. For example, you might want to run a method that validates data after you press a Save button, but before you move to a new mode.</p>
<p class=label>
<b>To associate user-defined methods with a mode</b>
<ol>
<li>
Follow the instructions in "To define a mode" or "To specify when mode transitions occur" above.<br><br></li>
<li>
In the <b>Member</b> field of the <b>Actions Performed for Mode</b> table on the <b>Form Mode</b> tab, or the <b>Member</b> field of the <b>Actions Performed Before Transition</b> table on the <b>Action</b> tab, enter your user-defined method.<br><br></li>
<li>
Enter the method's parameters (if any) within parentheses in the <b>Value</b> field.<p class=tl>
Your method will run when the mode is activated, or when the mode transition occurs. If you have more than one user-defined method, the methods will run in the order in which they appear in the table on the property pages.</P></li>
</ol>
<p>
For an example of a user-defined method on a data-entry form, see the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vismpADataEntryForm">
</object><a href=JavaScript:alink_3.Click()>Data Entry Form Sample</a>.</p>
</BODY>
</HTML>
