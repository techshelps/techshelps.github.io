<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Site Hits Log Sample</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="vismpsitehitslog"></a>Site Hits Log Sample</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vismpSiteHitsLog_C;vismpSiteHitsLogC">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vismpSiteHitsLog_T;vismpSiteHitsLogT">
</object></p>
<p>
This sample tracks each hit to an ASP page and logs information about the user viewing the page. The IP address, the path of the page being viewed, and the client browser are all stored in the Counter table in the Gallery database. These values are stored to allow reports to be run to see the activity of a page. </p>
<h2>Behind the Scenes</h2>
<p>
This samples uses one file: Counter.asp. This file uses the <a href="victlrecordsetcontrol.htm">Recordset design-time control</a> to create a connection to the Counter table in the Gallery database. After the recordset is open, a new record is added to the table and data is written into the appropriate fields:</p>
<pre><code>function CounterRecordset_ondatasetcomplete(){
      CounterRecordset.addImmediate();
      CounterRecordset.fields.setValue("Remote_Host", Request.ServerVariables("Remote_Addr"));
      CounterRecordset.fields.setValue("Path_Info", Request.ServerVariables("Path_Info"));
      CounterRecordset.fields.setValue("HTTP_User_Agent", Request.ServerVariables("HTTP_User_Agent"));
      CounterRecordset.updateRecord();
   }
</code></pre>
<p>
Using a <a href="victllabelcontrol.htm">Label design-time control</a>, the total number of records from the recordset is used to display the current count of hits to this page.</p>
</BODY>
</HTML>
