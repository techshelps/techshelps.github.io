<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Random Advertisement Sample</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="vismprandomadvertisement"></a>Random Advertisement Sample</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vismpRandomAdvertisement_C;vismpRandomAdvertisementC">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vismpRandomAdvertisement_T;vismpRandomAdvertisementT">
</object></p>
<p>
This sample shows how to create a random display on your page.</p>
<h2>Behind the Scenes</h2>
<p>
This sample uses three files:
<ul type=disc>
<li>
<B><b>RandomAd.asp</b></B> displays the randomly selected advertisement.<br><br></li>
<li>
<B><b>RandomAd.txt</b></B> defines which advertisements to use.<br><br></li>
<li>
<B><b>AdRedir.asp</b></B> redirects the user after an ad is chosen.</li>
</ul>
<h4>RandomAd.asp</h4>
<p>
RandomAd.asp uses just two lines of script to display the advertisement. The first line creates the object reference to the AdRotator component and the second line gets information from the RandomAd.txt file to display the ad:</p>
<pre><code>&lt;%Set ad = Server.CreateObject("MSWC.AdRotator")%&gt;
&lt;%= ad.GetAdvertisement("RandomAd.txt") %&gt;  
</code></pre>
<h4>RandomAd.txt</h4>
<p>
RandomAd.txt is used as the rotator schedule file. The rotator schedule file contains information that the Advertisement Rotator component uses to manage and display the various advertisement images. In it, you specify the details for the advertisements, such as the size of the advertisement space, the image files to use, and the percentage of time that each file should be displayed.</p>
<p>
The rotator schedule file has two sections: 
<ul type=disc>
<li>
The first section sets parameters that apply to all advertisement images in the rotation schedule. <br><br></li>
<li>
The second section specifies file and location information for each individual advertisement and the weight of display time that each advertisement should receive. The weight is a number between 0 and 4,294,967,295 that indicates the relative weight of the advertisement. <p class=tl>
For example, if a rotator schedule file contains three ads with weights set to 2, 3, and 5, the first advertisement is displayed 20 percent of the time, the second 30 percent of the time, and the third 50 percent of the time.</P></li>
</ul>
<p>
A line containing only an asterisk separates the two sections (*). Below is a portion of the RandomAd.txt file that shows one advertisement entry:</p>
<pre><code>REDIRECT AdRedir.asp
WIDTH 468
HEIGHT 60
BORDER 1
*
../images/rollover.gif
http://www.microsoft.com/frontpage
Free Beta Copy of Microsoft FrontPage 98
2 
</code></pre>
<h4>AdRedir.asp</h4>
<p>
AdRedir.asp redirects users to the appropriate URL after they have clicked on the advertisement.</p>
<pre><code>&lt;%
If Request.QueryString("url") &lt;&gt; "" Then
   Response.Redirect(Request.QueryString("url"))
End If
%&gt;</code></pre>
<p>
You can also include script in the redirection file to count the number of users that have clicked on a particular advertisement and save this information to a file on the server.</p>
</BODY>
</HTML>
