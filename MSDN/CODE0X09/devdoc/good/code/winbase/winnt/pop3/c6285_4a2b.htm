<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>POP3SRV.C</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context6293"></a>POP3SRV.C</h2>
<pre><code><br>/******************************************************************************\ <br>*       This is a part of the Microsoft Source Code Samples. <br>*       Copyright 1992 - 1998 Microsoft Corporation. <br>*       All rights reserved.  <br>*       This source code is only intended as a supplement to  <br>*       Microsoft Development Tools and/or WinHelp documentation. <br>*       See these sources for detailed information regarding the  <br>*       Microsoft samples programs. <br>\******************************************************************************/ <br> <br>//+--------------------------------------------------------------------------- <br>// <br>//  File:       pop3svr.c <br>// <br>//  Contents: <br>// <br>//  Classes: <br>// <br>//  Functions: <br>// <br>//---------------------------------------------------------------------------- <br> <br>#include "pop3srvp.h" <br>#pragma hdrstop <br> <br> <br>BOOL    fService = TRUE; <br>BOOL    fTestMode = FALSE; <br> <br>// <br>// This table is the service dispatch table.  It lists the services in <br>// this process by name, and the entry point to invoke to start them.  This <br>// example has but one service, but this could be extended to include, for <br>// instance, an SMTP server.  Be sure to have the prototype for your entry <br>// point in a global header file, so that you don't get a compiler complaint. <br>// <br>SERVICE_TABLE_ENTRY Pop3SrvTable[] = { <br>            {APPLICATION_NAME, Pop3SrvMain}, <br>            {NULL, NULL } }; <br> <br> <br> <br>//+--------------------------------------------------------------------------- <br>// <br>//  Function:   DoArgs <br>// <br>//  Synopsis:   This parses the process's start arguments, basically just to <br>//              see if we have a -noservice flag so that we don't talk to the <br>//              service controller. <br>// <br>//  Arguments:  [argc] -- <br>//              [argv] -- <br>// <br>//  History:    1-09-95   RichardW   Created <br>// <br>//  Notes: <br>// <br>//---------------------------------------------------------------------------- <br>void <br>DoArgs( <br>    int argc, <br>    char * argv[]) <br>{ <br>    int i; <br>    char * arg; <br> <br>    for (i = 1; i &lt; argc ; i++) <br>    { <br>        arg = argv[i]; <br> <br>        if (*arg == '-') <br>        { <br>            // <br>            // Ooo, an option. <br>            // <br>            if (_stricmp(arg, "-noservice") == 0) <br>            { <br>                fService = FALSE; <br>                continue; <br>            } <br>            if (_stricmp(arg, "-testmode") == 0) <br>            { <br>                fTestMode = TRUE; <br>                continue; <br>            } <br>        } <br>    } <br>} <br> <br>//+--------------------------------------------------------------------------- <br>// <br>//  Function:   DoServiceController <br>// <br>//  Synopsis:   This calls into the service controller, and is never heard <br>//              from again. <br>// <br>//  Arguments:  (none) <br>// <br>//  Requires: <br>// <br>//  Returns: <br>// <br>//  History:    1-09-95   RichardW   Created <br>// <br>//  Notes: <br>// <br>//---------------------------------------------------------------------------- <br>void <br>DoServiceController(void) <br>{ <br>    StartServiceCtrlDispatcher(Pop3SrvTable); <br>} <br> <br> <br> <br>//+--------------------------------------------------------------------------- <br>// <br>//  Function:   main <br>// <br>//  Synopsis:   Process entry point.  Unless we're told to start without <br>//              the service controller, we quickly wait for a service start <br>//              command. <br>// <br>//  Arguments:  [argc] -- <br>//              [argv] -- <br>// <br>//  Requires: <br>// <br>//  Returns: <br>// <br>//  History:    1-09-95   RichardW   Created <br>// <br>//  Notes: <br>// <br>//---------------------------------------------------------------------------- <br>void <br>main (int argc, char *argv[]) <br>{ <br> <br>    // <br>    // Initialize the debug support, by reading our debug level from the <br>    // registry. <br>    // <br>    InitDebugSupport(); <br> <br>    // <br>    // Parse the arguments <br>    // <br>    DoArgs(argc, argv); <br> <br>    // <br>    // If we're a service, go to the service controller, otherwise start <br>    // the service immediately. <br>    // <br>    if (fService) <br>    { <br>        DoServiceController(); <br>    } <br>    else <br>    { <br>        Pop3SrvMain(argc, NULL); <br>    } <br> <br>} </code></pre>
<p>&nbsp;</p></body>
</HTML>
