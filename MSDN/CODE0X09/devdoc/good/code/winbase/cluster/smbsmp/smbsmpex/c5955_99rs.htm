<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RESPROP.CPP</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5968"></a>RESPROP.CPP</h2>
<pre><code>///////////////////////////////////////////////////////////////////////////// <br>// <br>//Copyright (c) 1997 &lt;company name&gt; <br>// <br>//Module Name: <br>//ResProp.cpp <br>// <br>//Abstract: <br>//Implementation of the resource extension property page classes. <br>// <br>//Author: <br>//&lt;name&gt; (&lt;e-mail name&gt;) Mmmm DD, 1997 <br>// <br>//Revision History: <br>// <br>//Notes: <br>// <br>///////////////////////////////////////////////////////////////////////////// <br> <br>#include "stdafx.h" <br>#include "SmbSmpEx.h" <br>#include "ResProp.h" <br>#include "ExtObj.h" <br>#include "DDxDDv.h" <br> <br>#ifdef _DEBUG <br>#define new DEBUG_NEW <br>#undef THIS_FILE <br>static char THIS_FILE[] = __FILE__; <br>#endif <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CSmbSmpParamsPage property page <br>///////////////////////////////////////////////////////////////////////////// <br> <br>IMPLEMENT_DYNCREATE(CSmbSmpParamsPage, CBasePropertyPage) <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// Message Maps <br> <br>BEGIN_MESSAGE_MAP(CSmbSmpParamsPage, CBasePropertyPage) <br>//{{AFX_MSG_MAP(CSmbSmpParamsPage) <br>ON_EN_CHANGE(IDC_PP_SMBSMP_SHARENAME, OnChangeRequiredField) <br>ON_EN_CHANGE(IDC_PP_SMBSMP_PATH, OnChangeRequiredField) <br>//}}AFX_MSG_MAP <br>// TODO: Modify the following lines to represent the data displayed on this page. <br>ON_EN_CHANGE(IDC_PP_SMBSMP_SHARENAME, CBasePropertyPage::OnChangeCtrl) <br>ON_EN_CHANGE(IDC_PP_SMBSMP_PATH, CBasePropertyPage::OnChangeCtrl) <br>ON_EN_CHANGE(IDC_PP_SMBSMP_REMARK, CBasePropertyPage::OnChangeCtrl) <br>END_MESSAGE_MAP() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>//++ <br>// <br>//CSmbSmpParamsPage::CSmbSmpParamsPage <br>// <br>//Routine Description: <br>//Default constructor. <br>// <br>//Arguments: <br>//None. <br>// <br>//Return Value: <br>//None. <br>// <br>//-- <br>///////////////////////////////////////////////////////////////////////////// <br>CSmbSmpParamsPage::CSmbSmpParamsPage(void) : CBasePropertyPage(CSmbSmpParamsPage::IDD) <br>{ <br>// TODO: Modify the following lines to represent the data displayed on this page. <br>//{{AFX_DATA_INIT(CSmbSmpParamsPage) <br>m_strShareName = _T(""); <br>m_strPath = _T(""); <br>m_strRemark = _T(""); <br>//}}AFX_DATA_INIT <br> <br>// Setup the property array. <br>{ <br>m_rgProps[epropShareName].Set(REGPARAM_SMBSMP_SHARENAME, m_strShareName, m_strPrevShareName); <br>m_rgProps[epropPath].Set(REGPARAM_SMBSMP_PATH, m_strPath, m_strPrevPath); <br>m_rgProps[epropRemark].Set(REGPARAM_SMBSMP_REMARK, m_strRemark, m_strPrevRemark); <br>}  // Setup the property array <br> <br>m_iddPropertyPage = IDD_PP_SMBSMP_PARAMETERS; <br>m_iddWizardPage = IDD_WIZ_SMBSMP_PARAMETERS; <br> <br>}  //*** CSmbSmpParamsPage::CSmbSmpParamsPage() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>//++ <br>// <br>//CSmbSmpParamsPage::DoDataExchange <br>// <br>//Routine Description: <br>//Do data exchange between the dialog and the class. <br>// <br>//Arguments: <br>//pDX[IN OUT] Data exchange object  <br>// <br>//Return Value: <br>//None. <br>// <br>//-- <br>///////////////////////////////////////////////////////////////////////////// <br>void CSmbSmpParamsPage::DoDataExchange(CDataExchange * pDX) <br>{ <br>AFX_MANAGE_STATE(AfxGetStaticModuleState()); <br> <br>// TODO: Modify the following lines to represent the data displayed on this page. <br>//{{AFX_DATA_MAP(CSmbSmpParamsPage) <br>DDX_Control(pDX, IDC_PP_SMBSMP_SHARENAME, m_editShareName); <br>DDX_Control(pDX, IDC_PP_SMBSMP_PATH, m_editPath); <br>DDX_Text(pDX, IDC_PP_SMBSMP_SHARENAME, m_strShareName); <br>DDX_Text(pDX, IDC_PP_SMBSMP_PATH, m_strPath); <br>DDX_Text(pDX, IDC_PP_SMBSMP_REMARK, m_strRemark); <br>//}}AFX_DATA_MAP <br> <br>// Handle numeric parameters. <br>// TODO: Change the last argument to TRUE if any of these are signed values. <br>if (!BBackPressed()) <br>{ <br>}  // if:  back button not pressed <br> <br>// TODO: Add any additional field validation here. <br>if (pDX-&gt;m_bSaveAndValidate) <br>{ <br>// Make sure all required fields are present. <br>if (!BBackPressed()) <br>{ <br>DDV_RequiredText(pDX, IDC_PP_SMBSMP_SHARENAME, IDC_PP_SMBSMP_SHARENAME_LABEL, m_strShareName); <br>DDV_RequiredText(pDX, IDC_PP_SMBSMP_PATH, IDC_PP_SMBSMP_PATH_LABEL, m_strPath); <br>}  // if:  back button not pressed <br>}  // if:  saving data from dialog <br> <br>CBasePropertyPage::DoDataExchange(pDX); <br> <br>}  //*** CSmbSmpParamsPage::DoDataExchange() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>//++ <br>// <br>//CSmbSmpParamsPage::OnInitDialog <br>// <br>//Routine Description: <br>//Handler for the WM_INITDIALOG message. <br>// <br>//Arguments: <br>//None. <br>// <br>//Return Value: <br>//TRUEWe need the focus to be set for us. <br>//FALSEWe already set the focus to the proper control. <br>// <br>//-- <br>///////////////////////////////////////////////////////////////////////////// <br>BOOL CSmbSmpParamsPage::OnInitDialog(void) <br>{ <br>AFX_MANAGE_STATE(AfxGetStaticModuleState()); <br> <br>CBasePropertyPage::OnInitDialog(); <br> <br>// TODO: <br>// Limit the size of the text that can be entered in edit controls. <br> <br>return TRUE;// return TRUE unless you set the focus to a control <br>// EXCEPTION: OCX Property Pages should return FALSE <br> <br>}  //*** CSmbSmpParamsPage::OnInitDialog() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>//++ <br>// <br>//CSmbSmpParamsPage::OnSetActive <br>// <br>//Routine Description: <br>//Handler for the PSN_SETACTIVE message. <br>// <br>//Arguments: <br>//None. <br>// <br>//Return Value: <br>//TRUEPage successfully initialized. <br>//FALSEPage not initialized. <br>// <br>//-- <br>///////////////////////////////////////////////////////////////////////////// <br>BOOL CSmbSmpParamsPage::OnSetActive(void) <br>{ <br>AFX_MANAGE_STATE(AfxGetStaticModuleState()); <br> <br>// Enable/disable the Next/Finish button. <br>if (BWizard()) <br>EnableNext(BAllRequiredFieldsPresent()); <br> <br>return CBasePropertyPage::OnSetActive(); <br> <br>}  //*** CSmbSmpParamsPage::OnSetActive() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>//++ <br>// <br>//CSmbSmpParamsPage::OnChangeRequiredField <br>// <br>//Routine Description: <br>//Handler for the EN_CHANGE message on the Share name or Path edit <br>//controls. <br>// <br>//Arguments: <br>//None. <br>// <br>//Return Value: <br>//None. <br>// <br>//-- <br>///////////////////////////////////////////////////////////////////////////// <br>void CSmbSmpParamsPage::OnChangeRequiredField(void) <br>{ <br>AFX_MANAGE_STATE(AfxGetStaticModuleState()); <br> <br>OnChangeCtrl(); <br> <br>if (BWizard()) <br>EnableNext(BAllRequiredFieldsPresent()); <br> <br>}  //*** CSmbSmpParamsPage::OnChangeRequiredField() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>//++ <br>// <br>//CSmbSmpParamsPage::BAllRequiredFieldsPresent <br>// <br>//Routine Description: <br>//Handler for the EN_CHANGE message on the Share name or Path edit <br>//controls. <br>// <br>//Arguments: <br>//None. <br>// <br>//Return Value: <br>//None. <br>// <br>//-- <br>///////////////////////////////////////////////////////////////////////////// <br>BOOL CSmbSmpParamsPage::BAllRequiredFieldsPresent(void) const <br>{ <br>BOOLbPresent; <br> <br>if (0 <br>|| (m_editShareName.GetWindowTextLength() == 0) <br>|| (m_editPath.GetWindowTextLength() == 0) <br>) <br>bPresent = FALSE; <br>else <br>bPresent = TRUE; <br> <br>return bPresent; <br> <br>}  //*** CSmbSmpParamsPage::BAllRequiredFieldsPresent() </code></pre>
<p>&nbsp;</p></body>
</HTML>
