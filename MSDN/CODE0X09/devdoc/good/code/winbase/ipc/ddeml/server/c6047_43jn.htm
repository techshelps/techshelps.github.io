<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SERVER.H</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context6053"></a>SERVER.H</h2>
<pre><code><br>/******************************************************************************\ <br>*       This is a part of the Microsoft Source Code Samples. <br>*       Copyright 1993 - 1998 Microsoft Corporation. <br>*       All rights reserved. <br>*       This source code is only intended as a supplement to <br>*       Microsoft Development Tools and/or WinHelp documentation. <br>*       See these sources for detailed information regarding the <br>*       Microsoft samples programs. <br>\******************************************************************************/ <br> <br>#include &lt;windows.h&gt; <br>#include &lt;ddeml.h&gt; <br>#include &lt;tchar.h&gt; <br> <br>#define IDM_ABOUT 100 <br>#define IDM_BLOCKALLCBS 200 <br>#define IDM_ENABLEONECB 201 <br>#define IDM_BLOCKNEXTCB 202 <br>#define IDM_TERMNEXTCB  203 <br>#define IDM_RUNAWAY     204 <br>#define IDM_CHANGEDATA  205 <br>#define IDM_RENDERDELAY 206 <br>#define IDM_SETTOPIC    207 <br>#define IDM_SETSERVER   208 <br>#define IDM_UNBLOCKALLCBS 209 <br>#define IDM_HELP        210 <br>#define IDM_CONTEXT     211 <br>#define IDM_APPOWNED    212 <br> <br>#define IDS_BADLENGTH   1 <br> <br>#define MAX_TOPIC       20 <br>#define MAX_COMMENT     40 <br>#define MAX_EXEC        40 <br>#define CCHARS          80 <br>#define CLINES          40 <br> <br>#define UM_CHGDATA      (WM_USER + 435) <br> <br>#define CSYSTEMITEMS 4 <br>#define CTESTITEMS  4 <br>#define CTOPICS     2 <br> <br>#include "dialog.h" <br> <br>/****** Structrues ******/ <br> <br>// predefined format list item <br> <br>typedef struct { <br>    ATOM atom; <br>    PTSTR sz; <br>} FORMATINFO; <br>#define CFORMATS 3 <br> <br>extern FORMATINFO aFormats[]; <br> <br>typedef struct _XFERINFO { <br>    UINT wType; <br>    UINT wFmt; <br>    HCONV hConv; <br>    HSZ hszTopic; <br>    HSZ hszItem; <br>    HDDEDATA hData; <br>    DWORD lData1; <br>    DWORD lData2; <br>} XFERINFO; <br>typedef XFERINFO *PXFERINFO; <br> <br>typedef struct _ITEMLIST { <br>    HSZ hszItem; <br>    HDDEDATA (*npfnCallback)(PXFERINFO, WORD); <br>    PTSTR pszItem; <br>} ITEMLIST; <br> <br>typedef struct _TOPICLIST { <br>    HSZ hszTopic; <br>    ITEMLIST *pItemList; <br>    UINT cItems; <br>    PTSTR pszTopic; <br>} TOPICLIST; <br> <br>typedef struct {    // used to passinfo to/from TextDataEntryDlgProc and <br>    HDDEDATA hDdeData; <br>    UINT wFmt; <br>    HSZ hszItem; <br>} XACT; <br> <br> <br> <br>// GLOBALS <br> <br>extern DWORD idInst; <br>extern CONVCONTEXT CCFilter; <br>extern HANDLE hInst; <br>extern HWND hwndServer; <br>extern RECT rcRand; <br>extern RECT rcCount; <br>extern RECT rcComment; <br>extern RECT rcExec; <br>extern RECT rcConnCount; <br>extern RECT rcRndrDelay; <br>extern RECT rcRunaway; <br>extern RECT rcAllBlock; <br>extern RECT rcNextAction; <br>extern RECT rcHugeSize; <br>extern RECT rcAppowned; <br>extern BOOL fAllBlocked; <br>extern BOOL fAllEnabled; <br>extern BOOL fEnableOneCB; <br>extern BOOL fBlockNextCB; <br>extern BOOL fTermNextCB; <br>extern BOOL fAppowned; <br>extern WORD cRunaway; <br>extern WORD RenderDelay; <br>extern DWORD count; <br>extern HSZ hszAppName; <br>extern TCHAR szClass[]; <br>extern TCHAR szTopic[MAX_TOPIC]; <br>extern TCHAR szServer[MAX_TOPIC]; <br>extern TCHAR szComment[MAX_COMMENT]; <br>extern TCHAR szExec[MAX_EXEC]; <br>extern TCHAR *pszComment; <br>extern WORD seed; <br>extern WORD cyText; <br>extern WORD cServers; <br>extern HDDEDATA hDataHelp[CFORMATS]; <br>extern HDDEDATA hDataCount[CFORMATS]; <br>extern HDDEDATA hDataRand[CFORMATS]; <br>extern HDDEDATA hDataHuge[CFORMATS]; <br>extern DWORD cbHuge; <br> <br>extern TCHAR szDdeHelp[]; <br>extern FORMATINFO aFormats[CFORMATS]; <br>extern ITEMLIST SystemTopicItemList[CSYSTEMITEMS]; <br>extern ITEMLIST TestTopicItemList[CTESTITEMS]; <br>extern TOPICLIST topicList[CTOPICS]; <br> <br> <br>// FUNCTIONS <br> <br> <br>BOOL InitApplication(HANDLE); <br>BOOL InitInstance(HANDLE, INT); <br>INT FAR DoDialog(LPTSTR lpTemplateName, DLGPROC lpDlgProc, LPARAM param, BOOL fRememberFocus); <br>LONG  APIENTRY MainWndProc(HWND, UINT, WPARAM, LONG); <br>BOOL  APIENTRY About(HWND, UINT, WPARAM, LONG); <br>BOOL  APIENTRY RenderDelayDlgProc(HWND, UINT, WPARAM, LONG); <br>BOOL  APIENTRY SetTopicDlgProc(HWND, UINT, WPARAM, LONG); <br>BOOL  APIENTRY SetServerDlgProc(HWND, UINT, WPARAM, LONG); <br>BOOL  APIENTRY ContextDlgProc(HWND, UINT, WPARAM, LONG); <br>VOID PaintServer(HWND hwnd); <br>VOID DrawTextLine(HDC hdc, RECT *prcClip, RECT *prcText, PTSTR psz); <br>HDDEDATA CALLBACK DdeCallback(UINT wType, UINT wFmt, HCONV hConv, HSZ hszTopic, <br>        HSZ hszItem, HDDEDATA hData, DWORD lData1, DWORD lData2); <br>HDDEDATA TopicListXfer(PXFERINFO pXferInfo, WORD iFmt); <br>HDDEDATA ItemListXfer(PXFERINFO pXferInfo, WORD iFmt); <br>HDDEDATA sysFormatsXfer(PXFERINFO pXferInfo, WORD iFmt); <br>HDDEDATA TestRandomXfer(PXFERINFO pXferInfo, WORD iFmt); <br>HDDEDATA TestCountXfer(PXFERINFO pXferInfo, WORD iFmt); <br>HDDEDATA TestHugeXfer(PXFERINFO pXferInfo, WORD iFmt); <br>HDDEDATA HelpXfer(PXFERINFO pXferInfo, WORD iFmt); <br>VOID Hszize(VOID); <br>VOID UnHszize(VOID); <br>VOID Delay(DWORD delay, BOOL fModal); <br> <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
