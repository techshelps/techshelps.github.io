<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupLogError</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setuplogerror"></a>SetupLogError</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>SetupLogError</b> function writes an error message to a log file.  It is meant to be used during the installation of Windows NT, but it is always available.  It is not intended to be used after Windows NT is installed—the event log should be used instead.</p>
<pre><code><b>BOOL SetupLogError (
</b>  <b>PCTSTR</b> <i>MessageString</i>,   //String to be saved to log
  <b>LogSeverity</b><i> Severity    </i>//Severity message
  <b>);</b></code></pre>
<h4>Parameters:</h4>
<dl>
<dt>
<i>MessageString</i></dt>
<dd>
Specifies the string that should be saved to Setup's log.  It must end with a return-linefeed combination (\r\n).  The message is always saved to the action log, <b>setupact.log</b>.  If Severity is <b>LogSevWarning</b>, <b>LogSevError</b>, or <b>LogSevFatalError</b>, Setup also saves the message to the error log, <b>setuperr.log</b>.  Both logs are stored in the Windows directory.</dd>
<dt>
<i>Severity</i></dt>
<dd>
Specifies the severity of the message, one of the following : <b>LogSevInformation</b>, <b>LogSevWarning</b>, <b>LogSevError</b>, or <b>LogSevFatalError</b>.</dd>
</dl>
<h4>Remarks</h4>
<ul>
<li>
The action log is intended for recording all modifications made to the system during installation of Windows NT.</li>
<li>
The error log is intended for errors during installation of Windows NT only.</li>
<li>
The <i>MessageString</i> parameter may be formatted further by Setup (though it does no additional processing now).</li>
<li>
The error log will be presented to the user at the end of NT setup.</li>
</ul>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a non-zero value. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 5.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, </p>
<p>&nbsp;</p></body>
</HTML>
