<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Extracting File Information from the INF file</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_setupapi_extracting_file_information_from_the_inf_file"></a>Extracting File Information from the INF file</h3>
<p>
After the INF file is opened, you can gather information from it to build the user interface, or to direct the installation process. The setup functions provide several levels of functionality for gathering information from an INF file. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>To gather information…</th>
<th align=left width=52%>Use these functions…</th>
</tr>
<tr valign=top>
<td width=48%>About the INF file </td>
<td width=52%><a href="setupapi_2dri.htm"><b>SetupGetInfInformation</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_8lv2.htm"><b>SetupQueryInfFileInformation</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_0tri.htm"><b>SetupQueryInfVersionInformation</b></a>. </td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%>About source and target files</td>
<td width=52%><a href="setupapi_07u6.htm"><b>SetupGetSourceFileLocation</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_5vtx.htm"><b>SetupGetSourceFileSize</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_1jag.htm"><b>SetupGetTargetPath</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_0mi7.htm"><b>SetupGetSourceInfo</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%>From a line of an INF file</td>
<td width=52%><a href="setupapi_6lbo.htm"><b>SetupGetLineText</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_84bp.htm"><b>SetupFindNextLine</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_6j51.htm"><b>SetupFindNextMatchLine</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_8xtk.htm"><b>SetupGetLineByIndex</b></a> </td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_2tid.htm"><b>SetupFindFirstLine</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%>From a field of a line in an INF file</td>
<td width=52%><a href="setupapi_9x0k.htm"><b>SetupGetStringField</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_29yc.htm"><b>SetupGetIntField</b></a>, </td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_3o4k.htm"><b>SetupGetBinaryField</b></a></td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%><a href="setupapi_5rdw.htm"><b>SetupGetMultiSzField</b></a></td>
</tr>
</table><br>
<p>
The following example uses the <b>SetupGetSourceInfo</b> function to retrieve the human-readable description of a source media from an INF file.</p>
<pre><code>test = SetupGetSourceInfo (
     MyInf,                   \\Handle to the INF file to access
     SourceId,                \\Id of the source media
     SRCINFO_DESCRIPTION,     \\which information to retrieve
     Buffer,                  \\a pointer to the buffer to 
                              \\  receive the information
     MaxBufSize,              \\the size allocated for the buffer
     &amp;BufSize                 \\buffer size actually needed
);
 </code></pre>
<p>
In the example, <i>MyInf</i> is the handle to the open INF file. <i>SourceId</i> is the identifier for a specific source media. The value SRCINFO_DESCRIPTION specifies that the <b>SetupGetSourceInfo</b> function should retrieve the source media description. <i>Buffer </i>points to a string that will receive the description, <i>MaxBufSize</i> indicates the resources allocated to the buffer, and <i>BufSize </i>indicates the resources necessary to store the buffer.</p>
<p>
If <i>BufSize </i>is greater than MaxBufSize, the function will return FALSE, and a subsequent call to <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a> will return ERROR_INSUFFICIENT_BUFFER.</p>
<p>&nbsp;</p></body>
</HTML>
