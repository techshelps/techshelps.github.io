<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupQueryInfVersionInformation</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setupqueryinfversioninformation"></a>SetupQueryInfVersionInformation</h1>
<p>
The <b>SetupQueryInfVersionInformation</b> function returns INF file version information from an <a href="setupapi_8qgi.htm"><b>SP_INF_INFORMATION</b></a> structure to a caller-supplied buffer.</p>
<pre><code><b>BOOL SetupQueryInfVersionInformation(
  PSP_INF_INFORMATION</b><i> InfInformation</i><b>,</b>
<b>                       </b>// structure that contains INF info
<b>  UINT</b><i> InfIndex</i><b>,       </b>// index of the file to investigate
<b>  PCTSTR</b><i> Key</i><b>,          </b>// optional, the key to retrieve
<b>  PTSTR</b><i> ReturnBuffer</i><b>,  </b>// optional, receives the version info
<b>  DWORD</b><i> ReturnBufferSize</i><b>,  </b>// size of the supplied buffer
<b>  PDWORD</b><i> RequiredSize  </i>// optional, buffer size needed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>InfInformation</i></dt>
<dd>
Points to an <b>SP_INF_INFORMATION</b> structure previously returned from a call to the <a href="setupapi_2dri.htm"><b>SetupGetInfInformation</b></a> function.</dd>
<dt>
<i>InfIndex</i></dt>
<dd>
Specifies the index of the constituent INF file to retrieve version information from. This index can be in the range [0,<i> InfInformation.InfCount</i>).   Meaning that the values zero through, but not including, <i>InfInformation.InfCount</i> are valid.</dd>
<dt>
<i>Key</i></dt>
<dd>
An optional parameter that points to a null-terminated string containing the key name whose associated string is to be retrieved. If this parameter is NULL, all resource keys are copied to the supplied buffer. Each string is null-terminated, with an extra null at the end of the list.</dd>
<dt>
<i>ReturnBuffer</i></dt>
<dd>
If not NULL, <i>ReturnBuffer</i> points to a call-supplied character buffer in which this function returns the INF file style.</dd>
<dt>
<i>ReturnBufferSize</i></dt>
<dd>
Specifies the size of the buffer pointed to by the <i>ReturnBuffer</i> parameter.</dd>
<dt>
<i>RequiredSize</i></dt>
<dd>
If not NULL, points to a caller-supplied variable in which this function returns the size required for the buffer pointed to by the <i>ReturnBuffe</i>r parameter. If <i>ReturnBuffer</i> is specified and the actual size is larger than the value specified by <i>ReturnBufferSize</i>, the function fails and a call to <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a> returns ERROR_INSUFFICIENT_BUFFER.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a non-zero value. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_2.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
For the Unicode version of this function, the buffer sizes <i>ReturnBufferSize</i>, and <i>ReturnRequiredSize </i>are specified in number of characters. This number includes the null terminator. For the ANSI version of this function, the sizes are specified in number of bytes.</p>
<p>
If this function is called with a <i>ReturnBuffer</i> of NULL and a <i>ReturnBufferSize</i> of zero, the function puts the buffer size needed to hold the specified data into the variable pointed to by <i>RequiredSize</i>. If the function succeeds in this, the return value is a non-zero value. Otherwise, the return value is zero and extended error information can be obtained by calling <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_3.Click()><b>GetLastError</b></a>.</p>
<p>
Thus, you can call the function once to get the required buffer size, allocate the necessary memory, and then call the function a second time to retrieve the data. Using this technique, you can avoid errors due to an insufficient buffer size.</p>
<p>
If <b>SetupQueryInfVersionInformation</b> is called on a Windows NT 3.x INF file, then version information is generated from the Windows NT 3.x INF file in the following manner:
<ol>
<li>
The OptionType key in the <b>Identification </b>section of the Windows&nbsp;NT&nbsp;3.<i>x</i> INF file is returned as the Class key value.</li>
<li>
The FileType key in the <b>Signature </b>section of the Windows NT 3.<i>x</i> INF file becomes the Signature key value. </li>
<li>
If the value of the FileType key of the Windows NT 3.<i>x</i> INF file is MICROSOFT_FILE, then the Provider key value is set to "Microsoft".</li>
</ol>
<p>
The following table summarizes how the information is translated before it is passed into the <b>SP_INF_INFORMATION</b> structure.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Windows NT 3.x information</th>
<th align=left width=52%>mapped to Windows 95 or Windows NT 4.0 data</th>
</tr>
<tr valign=top>
<td width=48%><code>[Identification]<br>
OptionType = Mouse</code></td>
<td width=52%><code>[Version]<br>
Class=Mouse</code></td>
</tr>
<tr valign=top>
<td width=48%><code>[Signature]<br>
FileType = MICROSOFT_FILE</code></td>
<td width=52%><code><br>
Signature=MICROSOFT_FILE</code></td>
</tr>
<tr valign=top>
<td width=48%>(if the FileType is <code>MICROSOFT_FILE)</code></td>
<td width=52%><br>
<code>Provider="Microsoft"</code></td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_2dri.htm"><b>SetupGetInfInformation</b></a>, <a href="setupapi_8lv2.htm"><b>SetupQueryInfFileInformation</b></a><b> </b></p>
<p>&nbsp;</p></body>
</HTML>
