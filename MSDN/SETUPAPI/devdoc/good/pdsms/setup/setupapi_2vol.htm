<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupOpenInfFile</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setupopeninffile"></a>SetupOpenInfFile</h1>
<p>
The <b>SetupOpenInfFile</b> function opens an INF file and returns a handle to it.</p>
<pre><code><b>HINF SetupOpenInfFile(
  PCTSTR</b><i> FileName</i><b>, </b>// name of the INF to open
<b>  PCTSTR</b><i> InfClass</i><b>, </b>// optional, the class of the INF file
<b>  DWORD</b><i> InfStyle</i><b>,  </b>// specifies the style of the INF file
<b>  PUINT</b><i> ErrorLine  </i>// optional, receives error information
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>FileName</i></dt>
<dd>
Points to a null-terminated string containing the name (and optional path) of the INF file to be opened. If the filename does not contain path separator characters, it is searched for, first in the <i>%windir%</i>\<i>inf </i>directory, and then in the <i>%windir%\system32</i> directory. If the filename contains path separator characters, it is assumed to be a full path specification and no further processing is performed on it.</dd>
<dt>
<i>InfClass</i></dt>
<dd>
An optional parameter that points to a null-terminated string containing the class of INF file desired. For legacy INF files, this string must match the type specified in the OptionType value of the <b>Identification</b> section in the INF file (for example, OptionType=NetAdapter). For Windows 95- or Windows NT 4.0-style INF files, this string must match the Class value of the <a href="setupapi_0xwu.htm"><b>Version</b></a> section (for example, Class=Net). If there is no entry in the Class value, but there is an entry for ClassGUID in the <b>Version</b> section, the corresponding class name for that GUID is retrieved and used for the comparison.</dd>
<dt>
<i>InfStyle</i></dt>
<dd>
Specifies the style of INF file to open. May be a combination of the following flags:
<dl>
<dt>
<b>INF_STYLE_OLDNT</b></dt>
<dd>
Windows NT 3.x script-based INF files.</dd>
<dt>
<b>INF_STYLE_WIN4</b></dt>
<dd>
Windows 95- or Windows NT 4.0-style INF files.</dd>
</dl>
</dd>
<dt>
<i>ErrorLine</i></dt>
<dd>
An optional parameter that points to a caller-supplied variable to which this function returns the (1-based) line number where an error occurred during loading of the INF file. This value is generally reliable only if <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a> does not return ERROR_NOT_ENOUGH_MEMORY. If an out-of-memory condition does occur, <i>ErrorLine</i> may be 0.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The function returns a handle to the opened INF file if it is successful. Otherwise, the return value is INVALID_HANDLE_VALUE. Extended error information can be retrieved by a call to <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_2.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
If the load fails because the INF file type does not match<i> InfClass</i>, the function returns INVALID_HANDLE_VALUE and a call to <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_3.Click()><b>GetLastError</b></a> returns ERROR_CLASS_MISMATCH.</p>
<p>
If multiple INF file styles are specified, the style of the INF file opened can be determined by calling the <a href="setupapi_2dri.htm"><b>SetupGetInfInformation</b></a> function.</p>
<p>
Since there may be more than one class GUID with the same class name, callers interested in INF files of a particular class (that is, a particular class GUID) should retrieve the ClassGUID value from the INF file by calling <a href="setupapi_0tri.htm"><b>SetupQueryInfVersionInformation</b></a>.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_6k85.htm"><b>SetupOpenAppendInfFile</b></a>, <a href="setupapi_5rad.htm"><b>SetupCloseInfFile</b></a>, <a href="setupapi_2dri.htm"><b>SetupGetInfInformation</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
