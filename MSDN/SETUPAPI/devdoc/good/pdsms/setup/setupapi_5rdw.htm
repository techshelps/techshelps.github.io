<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupGetMultiSzField</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setupgetmultiszfield"></a>SetupGetMultiSzField</h1>
<p>
The <b>SetupGetMultiSzField</b> function retrieves multiple strings stored in a line of an INF file, from the specified field to the end of the line.</p>
<pre><code><b>BOOL SetupGetMultiSzField(
  PINFCONTEXT</b><i> Context</i><b>, </b>// context of a line in an INF file
<b>  DWORD</b><i> FieldIndex</i><b>,    </b>// index of the starting field
<b>  PTSTR</b><i> ReturnBuffer</i><b>,  </b>// optional, receives the fields
<b>  DWORD</b><i> ReturnBufferSize</i><b>,  </b>// size of the supplied buffer
<b>  LPDWORD</b><i> RequiredSize </i>// optional, buffer size needed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Context</i></dt>
<dd>
Pointer to the context for a line in an INF file.</dd>
<dt>
<i>FieldIndex</i></dt>
<dd>
The 1-based index of the starting field within the specified line from which the strings should be retrieved. The string list is built from each field starting at this point to the end of the line. A <i>FieldIndex</i> of 0 is not valid with this function.</dd>
<dt>
<i>ReturnBuffer</i></dt>
<dd>
This optional parameter points to a caller-supplied character buffer that receives the strings. Each string is null-terminated, with an extra null at the end of the string list.</dd>
<dt>
<i>ReturnBufferSize</i></dt>
<dd>
Specifies the size of the buffer pointed to by <i>ReturnBuffer</i>.</dd>
<dt>
<i>RequiredSize</i></dt>
<dd>
This optional parameter points to a caller-supplied variable that receives the size required for the buffer pointed to by <i>ReturnBuffer</i>. If the size needed is larger than the value specified by <i>ReturnBufferSize</i>, the function fails and a call to <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a><b> </b>returns ERROR_INSUFFICIENT_BUFFER.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a non-zero value. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_2.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
For the Unicode version of this function, the buffer sizes <i>ReturnBufferSize</i> and <i>RequiredSize</i> are specified in number of characters. This number includes the null terminator. For the ANSI version of this function, the sizes are specified in number of bytes.</p>
<p>
If this function is called with a <i>ReturnBuffer</i> of NULL and a <i>ReturnBufferSize</i> of zero, the function puts the buffer size needed to hold the specified data into the variable pointed to by <i>RequiredSize</i>. If the function succeeds in this, the return value is a non-zero value. Otherwise, the return value is zero and extended error information can be obtained by calling <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_3.Click()><b>GetLastError</b></a>.</p>
<p>
Thus, you can call the function once to get the required buffer size, allocate the necessary memory, and then call the function a second time to retrieve the data. Using this technique, you can avoid errors due to an insufficient buffer size.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_3o4k.htm"><b>SetupGetBinaryField</b></a>, <a href="setupapi_29yc.htm"><b>SetupGetIntField</b></a>, <a href="setupapi_9x0k.htm"><b>SetupGetStringField</b></a></p>
<p>&nbsp;</p></body>
</HTML>
