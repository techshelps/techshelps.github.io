<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupInstallFile</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setupinstallfile"></a>SetupInstallFile</h1>
<p>
The <b>SetupInstallFile </b>function installs a file as specified either by an <a href="setupapi_8b1u.htm"><b>INFCONTEXT</b></a> returned by <b>SetupFindXXXLine</b> or explicitly by the filename and path information.</p>
<pre><code><b>BOOL SetupInstallFile(
  HINF</b><i> InfHandle</i><b>,         </b>// optional, handle to the INF file
<b>  PINFCONTEXT</b><i> InfContext</i><b>,  </b>// optional, context for a INF file line
<b>  PCTSTR</b><i> SourceFile</i><b>,      </b>// optional, name of file to copy
<b>  PCTSTR</b><i> SourcePathRoot</i><b>,  </b>// optional, root path to source
<b>  PCTSTR</b><i> DestinationName</i><b>,  </b>// optional, filename after copy
<b>  DWORD</b><i> CopyStyle</i><b>,        </b>// specifies copy behavior
<b>  PSP_FILE_CALLBACK</b><i> CopyMsgHandler</i><b>,</b> 
                          // optional, callback routine to use
<b>  PVOID</b><i> Context           </i>// optional, callback routine context
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>InfHandle</i></dt>
<dd>
This optional parameter points to the handle of an INF file that contains <a href="setupapi_7sxf.htm"><b>SourceDisksNames</b></a> and <a href="setupapi_5wvn.htm"><b>SourceDisksFiles</b></a> sections. If platform-specific sections exist for the user's system (for example, <b>SourceDisksNames.mips</b> and <b>SourceDisksFiles.mips</b>), the platform-specific section will be used. If <i>InfContext</i> is NULL and <i>CopySyle</i> includes SP_COPY_SOURCE_ABSOLUTE or SP_COPY_SOURCEPATH_ABSOLUTE, <i>InfHandle</i> is ignored.</dd>
<dt>
<i>InfContext</i></dt>
<dd>
This optional parameter points to the context of a line in a <a href="setupapi_6ncj.htm"><b>Copy Files</b></a> section in an INF file. The routine looks this file up in the <b>SourceDisksFiles</b> section of <i>InfHandle</i> to get file copy information. If <i>InfContext</i> is<i> </i>not specified, <i>SourceFile</i> must be.</dd>
<dt>
<i>SourceFile</i></dt>
<dd>
This optional parameter supplies the filename (no path) of the file to copy. The file is looked up in the <b>SourceDisksFiles</b> section. The <i>SourceFile</i> parameter must be specified if <i>InfContext</i> is not, and is ignored if <i>InfContext</i> is specified.</dd>
<dt>
<i>SourcePathRoot</i></dt>
<dd>
This optional parameter supplies the root path for the file to be copied (for example, A:\ or F:\). Paths in the <b>SourceDisksNames</b> section are appended to this path. The <i>SourcePathRoot</i> parameter is ignored if <i>CopyStyle</i> includes the SP_COPY_SOURCE_ABSOLUTE flag.</dd>
<dt>
<i>DestinationName</i></dt>
<dd>
This optional parameter<i> </i>supplies the filename only (no path) of the target file. This parameter can be NULL to indicate that the target file should have the same name as the source file. If <i>InfContext</i> is not specified, <i>DestinationName </i>supplies the full target path and filename for the target.</dd>
<dt>
<i>CopyStyle</i></dt>
<dd>
Flags that control the behavior of the file copy operation. These flags may be a combination of the following values:
<dl>
<dt>
SP_COPY_DELETESOURCE</dt>
<dd>
Delete the source file upon successful copy. The caller is not notified if the delete fails.</dd>
<dt>
SP_COPY_REPLACEONLY</dt>
<dd>
Copy the file only if doing so would overwrite a file at the destination path. If the target doesn't exist, the function returns FALSE and <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a><b> </b>returns NO_ERROR.</dd>
<dt>
SP_COPY_NEWER</dt>
<dd>
Examine each file being copied to see if its version resources indicate that it is not newer than an existing copy on the target. 
<p>
The file version information used during version checks is that specified in the <b>dwFileVersionMS </b>and <b>dwFileVersionLS</b> members of a <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_vs_fixedfileinfo_str">
</object><a href=JavaScript:alink_2.Click()><b>VS_FIXEDFILEINFO</b></a> structure, as filled in by the Win32 version functions. If one of the files does not have version resources, or if they have identical version information, the source file is considered newer. 

<p>
If the source file is not newer, and <i>CopyMsgHandler</i> is specified, the caller is notified and may cancel the copy. If <i>CopyMsgHandler</i> is not specified, the file is not copied.
</dd>
<dt>
SP_COPY_NOOVERWRITE</dt>
<dd>
Check whether the target file exists, and, if so, notify the caller who may veto the copy. If <i>CopyMsgHandler</i> is not specified, the file is not overwritten.</dd>
<dt>
SP_COPY_NODECOMP</dt>
<dd>
Do not decompress the file. When this flag is set, the target file is not given the uncompressed form of the source name (if appropriate). For example, copying f:<i>\mips\cmd.ex_ </i>to <i>\\install\temp</i> results in a target file of <i>\\install\temp\cmd.ex_</i>. If the SP_COPY_NODECOMP flag was not specified, the file would be decompressed and the target would be called <i>\\install\temp\cmd.exe</i>. The filename part of <i>DestinationName</i>, if specified, is stripped and replaced with the filename of the source file. When SP_COPY_NODECOMP is specified, SP_COPY_LANGUAGEAWARE and SP_COPY_NEWER are ignored.</dd>
<dt>
SP_COPY_LANGUAGEAWARE</dt>
<dd>
Examine each file being copied to see if its language differs from the language of any existing file already on the target. If so, and <i>CopyMsgHandler</i> is specified, the caller is notified and may cancel the copy. If <i>CopyMsgHandler</i> is not specified, the file is not copied.</dd>
<dt>
SP_COPY_SOURCE_ABSOLUTE</dt>
<dd>
<i>SourceFile</i> is a full source path. Do not look it up in the <b>SourceDisksNames</b> section of the INF file.</dd>
<dt>
SP_COPY_SOURCEPATH_ABSOLUTE</dt>
<dd>
<i>SourcePathRoot</i> is the full path part of the source file. Ignore the relative source specified in the <b>SourceDisksNames</b> section of the INF file for the source media where the file is located. This flag is ignored if SP_COPY_SOURCE_ABSOLUTE is specified.</dd>
<dt>
SP_COPY_FORCE_IN_USE</dt>
<dd>
If the target exists, behave as if it is in use and queue the file for copying on the next system reboot.</dd>
<dt>
SP_COPY_FORCE_NOOVERWRITE</dt>
<dd>
Check whether the target file exists, and, if so, the file is not overwritten. The caller is not notified.</dd>
<dt>
SP_COPY_FORCE_NEWER</dt>
<dd>
Examine each file being copied to see if its version resources (or timestamps for non-image files) indicate that it is not newer than an existing copy on the target. If the file being copied is not newer, the file is not copied. The caller is not notified. The function returns FALSE, and <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_3.Click()><b>GetLastError</b></a><b> </b>returns NO_ERROR.</dd>
</dl>
</dd>
<dt>
<i>CopyMsgHandler</i></dt>
<dd>
This optional parameter points to a callback function to be notified of various conditions that may arise during the file copy.</dd>
<dt>
<i>Context</i></dt>
<dd>
This optional parameter points to a caller-defined value that is passed as the first parameter of the callback function.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a non-zero value. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_4.Click()><b>GetLastError</b></a>.</p>
<p>
If <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_5.Click()><b>GetLastError</b></a> returns NO_ERROR, the file copy operation was not completed because the callback function returned FALSE.</p>
<h4>Remarks</h4>
<p>
If a UNC directory is specified as the target directory of a file installation, you must ensure it exists before you call <b>SetupInstallFile</b>. The setup functions do not check for the existence of and do not create UNC directories. If the target UNC directory does not exist, the file installation will fail.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_2qat.htm"><b>SetupCloseFileQueue</b></a>, <a href="setupapi_5nz9.htm"><b>SetupCommitFileQueue</b></a>, <a href="setupapi_4sh1.htm"><b>SetupOpenFileQueue</b></a>, <a href="setupapi_7wqh.htm"><b>SetupQueueCopy</b></a></p>
<p>&nbsp;</p></body>
</HTML>
