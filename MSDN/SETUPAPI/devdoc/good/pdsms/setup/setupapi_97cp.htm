<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INI File to Registry</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_ini_file_to_registry"></a>INI File to Registry</h1>
<p>
The <b>INI File to Registry </b>section moves lines or sections from an INI file to the registry, creating or replacing a registry entry under the specified key in the registry. The section name <i>ini</i>-<i>to</i>-<i>registry</i>-<i>section</i> must appear in an <b>Ini2Reg</b> item in an <a href="setupapi_25po.htm"><b>Install</b></a> section of the INF file.</p>
<pre><code>[<i>ini-to-registry-section</i>]
<i>ini-file</i>, <i>ini-section</i>, [<i>ini-key</i>],<i>reg-root-string,subkey</i>[<i>,flags</i>]
.
.
.
 </code></pre>
<dl>
<dt>
<i>ini-file</i></dt>
<dd>
Name of the INI file containing the key to copy. For more information about specifying the INI filename, see the <a href="setupapi_53dx.htm"><b>Update Ini File</b></a> section.</dd>
<dt>
<i>ini-section</i></dt>
<dd>
Name of the section in the INI file containing the key to copy.</dd>
<dt>
<i>ini-key</i></dt>
<dd>
Name of the key in the INI file to copy to the registry. If <i>ini</i>-<i>key</i> is empty, the whole section is transferred to the specified registry key.</dd>
<dt>
<i>reg-root-string</i></dt>
<dd>
Registry root name. This parameter can be one of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=16%>HKCR</td>
<td width=84%>Same as <b>HKEY_CLASSES_ROOT</b>.</td>
</tr>
<tr valign=top>
<td width=16%>HKCU</td>
<td width=84%>Same as <b>HKEY_CURRENT_USER</b>.</td>
</tr>
<tr valign=top>
<td width=16%>HKLM</td>
<td width=84%>Same as <b>HKEY_LOCAL_MACHINE</b>.</td>
</tr>
<tr valign=top>
<td width=16%>HKU</td>
<td width=84%>Same as <b>HKEY_USERS</b>.</td>
</tr>
<tr valign=top>
<td width=16%>HKR</td>
<td width=84%>Relative from the key passed into <a href="setupapi_0zvy.htm"><b>SetupInstallFromInfSection</b></a>.</td>
</tr>
</table><br>

</dd>
<dt>
<i>subkey</i></dt>
<dd>
Identifies the subkey to receive the value. Has the form <i>key1</i>\<i>key2</i>\<i>key3</i>...</dd>
<dt>
<i>flags</i></dt>
<dd>
Indicates whether to delete the INI key after transfer to the registry and whether to overwrite the value in the registry if the registry key already exists. This parameter can be one of the following values.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=17%>Bit</th>
<th align=left width=17%>Value</th>
<th align=left width=66%>Meaning</th>
</tr>
<tr valign=top>
<td width=17%>0</td>
<td width=17%>0</td>
<td width=66%>(Default) Do not delete the INI entry from the INI file after moving the information in the entry to the registry. </td>
</tr>
<tr valign=top>
<td width=17%>0</td>
<td width=17%>1</td>
<td width=66%>Delete the INI entry from the INI file after moving the information in the entry to the registry.</td>
</tr>
<tr valign=top>
<td width=17%>1</td>
<td width=17%>0</td>
<td width=66%>(Default) If the registry subkey exists, do not replace its current value.</td>
</tr>
<tr valign=top>
<td width=17%>1</td>
<td width=17%>1</td>
<td width=66%>If the registry subkey exists, replace its current value with the value from the INI file entry.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_5wkl.htm">INF File Format Reference</a> </p>
<p>&nbsp;</p></body>
</HTML>
