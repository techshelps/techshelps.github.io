<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Updating Registry Information</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_setupapi_updating_registry_information"></a>Updating Registry Information</h3>
<p>
After the queue has successfully committed, you will need to update registry information for the product you are installing. It is reccommended that you wait until all necessary file copy operations have been successfully completed before altering registry information.</p>
<p>
One way to update the registry is to call <a href="setupapi_0zvy.htm"><b>SetupInstallFromInfSection</b></a><b> </b>with the SPINST_INIFILES, SPINST_REGISTRY, or SPINST_INI2REG flags specified. These flags can be combined in one call to <b>SetupInstallFromInfSection</b>. </p>
<p>
The following example uses SPINST_ALL^SPINST_FILES to indicate that the function should process all of the listed operations except file operations. Since only INI, registry, and file operations are listed in the <b>Install </b>section, this is a shorthand method of specifying the function should process all INI and registry operations.</p>
<p>
The following example shows how to install registry information using the <b>SetupInstallFromINFSection </b>function.</p>
<pre><code>Test = SetupInstallFromINFSection (
     NULL,                     \\Window to own any dialog boxes
                               \\  created 
     MyInf,                    \\INF file containing the section 
     MySection,                \\the section to install
     SPINST_ALL ^ SPINST_FILES,\\which installation operations 
                               \\  to process
     NULL,                     \\the relative root key
     "A:\",                    \\the source root path
     0,                        \\copy style
     NULL,                     \\Message handler routine
     NULL,                     \\Context
     NULL,                     \\Device info set
     NULL                      \\device info data
);
 </code></pre>
<p>
In the example, <i>OwnerWindow</i> is NULL because only file operations generate dialog boxes, and thus a parent window is not needed. <i>MyInf</i> is the INF file containing the section to process. The parameter, <i>MySection</i>, specifies the section to be installed. The combined flags, SPINST_ALL ^ SPINST_FILES, specify which installation operations to process, in this case, all operations except file operations. The source root path is specified as <i>"A:\"</i>. </p>
<p>
Since no copy operations are being processed, the <i>CopyFlags</i>, <i>MsgHandler</i>, <i>Context</i>, <i>DeviceInfoSet</i>, and <i>DeviceInfoData </i>parameters are not specified.</p>
<p>&nbsp;</p></body>
</HTML>
