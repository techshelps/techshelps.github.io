<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Update INI File</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_update_ini_file"></a>Update INI File</h1>
<p>
The <b>Update INI File</b> section replaces, deletes, or adds complete entries in the INI file. The section name, <i>update</i>-<i>ini</i>-<i>section</i>-<i>name</i>, must appear in the <b>UpdateInis</b> item in the <a href="setupapi_25po.htm"><b>Install</b></a><b> </b>section of the INF file.</p>
<pre><code>[<i>update-ini-section-name</i>]
<i>ini-file</i>,<i>ini-section</i>,[<i>old-ini-entry</i>],[<i>new-ini-entry</i>],[<i>flags</i>]
.
.
.
 </code></pre>
<dl>
<dt>
<i>ini-file</i></dt>
<dd>
The INI file containing the entry to change. </dd>
<dt>
<i>ini</i>-<i>section</i></dt>
<dd>
Name of the section containing the entry to change.</dd>
<dt>
<i>old</i>-<i>ini</i>-<i>entry</i></dt>
<dd>
Optional. Usually in the form <i>key</i>=<i>value</i>.</dd>
<dt>
<i>new</i>-<i>ini</i>-<i>entry</i></dt>
<dd>
Optional. Usually in the form<i> key</i>=<i>value</i>. Either the key or value may specify replaceable strings. For example, either the key or value specified in the <i>new</i>-<i>ini</i>-<i>entry</i> parameter may be %String1%, where the string that replaces %String1% is defined in the <a href="setupapi_4r77.htm"><b>Strings</b></a> section of the INF file.</dd>
<dt>
<i>flags</i></dt>
<dd>
Optional action flags. The <i>flags</i> parameter can be one of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=11%>Value</th>
<th align=left width=89%>Meaning</th>
</tr>
<tr valign=top>
<td width=11%>0</td>
<td width=89%>Default. If <i>old</i>-<i>ini</i>-<i>entry</i> key is present in an INI file entry, that entry is replaced with <i>new</i>-<i>ini</i>-<i>entry</i>. Only the keys of the <i>old</i>-<i>ini</i>-<i>entry</i> parameter and the INF file entry must match; the value of each entry is ignored.<p>
To add <i>new</i>-<i>ini</i>-<i>entry</i> to the INI file unconditionally, set <i>old</i>-<i>ini</i>-<i>entry</i> to NULL. To delete <i>old</i>-<i>ini</i>-<i>entry</i> from the INI file unconditionally, set<i> new</i>-<i>ini</i>-<i>entry</i> to NULL.</p>
</td>
</tr>
<tr valign=top>
<td width=11%>1</td>
<td width=89%>If both key and value of <i>old</i>-<i>ini</i>-<i>entry </i>exist in an INI file entry, that entry is replaced with <i>new</i>-<i>ini-entry</i>. The <i>old</i>-<i>ini</i>-<i>entry</i> parameter and the INF file entry must match on both key and value for the replacement to be made (this is in contrast to using an action flag value of 0, where only the keys must match for the replacement to be made).</td>
</tr>
<tr valign=top>
<td width=11%>2</td>
<td width=89%>If the key in the <i>old</i>-<i>ini</i>-<i>entry</i> parameter does not exist in the INI file, no operation is performed on the INI file.<p>
If the key in the <i>old</i>-<i>ini-entry</i> parameter exists in an INI file entry and the key in the <i>new</i>-<i>ini</i>-<i>entry</i> parameter exists in an INI file entry, the INI file entry that matches the key in the <i>new</i>-<i>ini-entry</i> parameter is deleted, and the key of the INI file entry that matches the <i>old</i>-<i>ini</i>-<i>entry</i> parameter is replaced with the key in the <i>new</i>-<i>ini</i>-<i>entry</i> parameter.</p>
<p>
If the key in the <i>old</i>-<i>ini</i>-<i>entry</i> parameter exists in an INI file entry and the key in the <i>new</i>-<i>ini</i>-<i>entry</i> parameter does not exist in an INI file entry, an entry made up of the key in the <i>new</i>-<i>ini</i>-<i>entry</i> parameter and the old value is added to the INI file.</p>
<p>
The match of the <i>old</i>-<i>ini</i>-<i>entry</i> parameter and an INI file entry is based on key alone, not key and value.</p>
</td>
</tr>
<tr valign=top>
<td width=11%>3</td>
<td width=89%>Same as the <i>flags</i> parameter value of 2 described preceding, except the match of the <i>old</i>-<i>ini</i>-<i>entry </i>parameter and an entry in the INF file is based on matching both key and value, not just the key.</td>
</tr>
</table><br>


<p>
You can use the wild card character (*) in specifying the key and value and they will be interpreted correctly.

</dd>
</dl>
<p>
The <i>ini</i>-<i>filename</i> can be a string or a string key. A string key has the form <i>%strkey%</i> where <i>strkey</i> is defined in the<b> <a href="setupapi_4r77.htm">Strings</a></b> section in the INF file. The name must be a valid filename.</p>
<p>
The <i>ini</i>-<i>filename</i> should include the name of the directory containing the file, but the directory name should be given as a directory identifier rather than an actual name. The installer replaces a directory identifier with an actual name during installation.</p>
<p>
A directory identifier has the form <i>%dirid%</i> where <i>dirid</i> is one of the predefined identifiers or an identifier set by <a href="setupapi_1mec.htm"><b>SetupSetDirectoryId</b></a>. When using a directory identifier, you should use the backslash in a path. For example, you can use <i>%11%\card.ini</i> to reference CARD.INI in the System32 directory.</p>
<p>
The following examples illustrate individual items in an <b>Update INI File</b> section:</p>
<pre><code>%11%\sample.ini, Section1,, Value1=2             ; adds new entry
%11%\sample.ini, Section2, Value3=*,             ; deletes old entry
%11%\sample.ini, Section4, Value5=1, Value5=4    ; replaces old entry
 </code></pre>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_5wkl.htm">INF File Format Reference</a> </p>
<p>&nbsp;</p></body>
</HTML>
