<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupLogFile</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setuplogfile"></a>SetupLogFile</h1>
<p>
The <b>SetupLogFile</b> function adds an entry to the log file.</p>
<pre><code><b>BOOL SetupLogFile(
  HSPFILELOG</b><i> FileLogHandle</i><b>,  </b>// handle to the log file
<b>  PCTSTR</b><i> LogSectionName</i><b>,  </b>// optional, name to group files by
<b>  PCTSTR</b><i> SourceFileName</i><b>,  </b>// filename on source media
<b>  PCTSTR</b><i> TargetFileName</i><b>,  </b>// filename in target directory
<b>  DWORD</b><i> Checksum</i><b>,         </b>// optional, 32-bit checksum value
<b>  PCTSTR </b><i> DiskTagfile</i><b>,    </b>// optional, source media tag file
<b>  PCTSTR</b><i> DiskDescription</i><b>,  </b>// optional, media description
<b>  PCTSTR</b><i> OtherInfo</i><b>,       </b>// optional, additional information
<b>  DWORD</b><i> Flags             </i>// indicates whether OEM file
<b>);</b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>FileLogHandle</i></dt>
<dd>
Supplies the handle to the file log as returned by <a href="setupapi_6gbr.htm"><b>SetupInitializeFileLog</b></a>. The caller must not have passed SPFILELOG_QUERYONLY when the log file was initialized.</dd>
<dt>
<i>LogSectionName</i></dt>
<dd>
This optional parameter supplies the name for a logical grouping of names within the log file. Required if SPFILELOG_SYSTEMLOG was not passed when the file log was initialized. Otherwise, <i>LogSectionName</i> is optional.</dd>
<dt>
<i>SourceFileName</i></dt>
<dd>
Supplies the name of the file as it exists on the source media from which it was installed. This name should be in whatever format is meaningful to the caller.</dd>
<dt>
<i>TargetFileName</i></dt>
<dd>
Supplies the name of the file as it exists on the target. This name should be in whatever format is meaningful to the caller.</dd>
<dt>
<i>Checksum</i></dt>
<dd>
This optional parameter supplies a 32-bit checksum value. Required for the system log.</dd>
<dt>
<i>DiskTagfile</i></dt>
<dd>
This optional parameter specifies the tagfile for the media from which the file was installed. Required for the system log if SPFILELOG_OEMFILE is specified. Ignored for the system log if SPFILELOG_OEMFILE is not specified.</dd>
<dt>
<i>DiskDescription</i></dt>
<dd>
This optional parameter provides the human-readable description of the media from which the file was installed. Required for the system log if SPFILELOG_OEMFILE is specified in the <i>Flags </i>parameter. Ignored for the system log if SPFILELOG_OEMFILE is not specified in the <i>Flags </i>parameter.</dd>
<dt>
<i>OtherInfo</i></dt>
<dd>
This optional parameter supplies additional information to be associated with the file.</dd>
<dt>
<i>Flags</i></dt>
<dd>
This parameter can be SPFILELOG_OEMFILE, which is meaningful only for the system log and indicates that the file is not supplied by Microsoft. This parameter can be used to convert an existing file's entry, such as when an OEM overwrites a Microsoft-supplied system file.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a non-zero value. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_6s8p.htm"><b>SetupRemoveFileLogEntry</b></a></p>
<p>&nbsp;</p></body>
</HTML>
