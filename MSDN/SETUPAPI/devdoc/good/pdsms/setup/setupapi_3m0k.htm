<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupAddToSourceList</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setupaddtosourcelist"></a>SetupAddToSourceList</h1>
<p>
The <b>SetupAddToSourceList</b> function appends a value to the list of installation sources for either the current user or the system. If the value already exists, it is removed first, so that duplicate entries are not created.</p>
<pre><code><b>BOOL SetupAddToSourceList(
  DWORD</b><i> Flags</i><b>,  </b>// specifies a list to append to
<b>  PCTSTR</b><i> Source </i>// the source to add to the list
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Flags</i></dt>
<dd>
Specifies which list to append the source to. This parameter can be any combination of the following values:
<dl>
<dt>
SRCLIST_SYSTEM</dt>
<dd>
Add the source to the per-system list. The caller must be an administrator.</dd>
<dt>
SRCLIST_USER</dt>
<dd>
Add the source to the per-user list.</dd>
<dt>
SRCLIST_SYSIFADMIN</dt>
<dd>
If the caller is an administrator, the source is added to the per-system list; if the caller is not a member of the administrators local group, the source is added to the per-user list for the current user.

<p>
<b>Note </b>If a temporary list is currently in use (see <b>SetupSetSourceList</b>), the preceding flags are ignored and the source is added to the temporary list.

</dd>
<dt>
SRCLIST_APPEND</dt>
<dd>
Add the source to the end of the list. If this flag is not specified, the source is added to the beginning of the list.</dd>
</dl>
</dd>
<dt>
<i>Source</i></dt>
<dd>
Pointer to the source to add to the list.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a non-zero value. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_1mes.htm"><b>SetupRemoveFromSourceList</b></a>, <a href="setupapi_1tf8.htm"><b>SetupSetSourceList</b></a></p>
<p>&nbsp;</p></body>
</HTML>
