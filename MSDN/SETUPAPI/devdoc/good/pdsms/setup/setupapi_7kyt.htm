<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Cabinet Callback Routine</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_setupapi_creating_a_cabinet_callback_routine"></a>Creating a Cabinet Callback Routine</h3>
<p>
Because the Setup API does not supply a default cabinet callback routine, you need to supply a routine. The callback routine that the <a href="setupapi_61bo.htm"><b>SetupIterateCabinet</b></a> function requires must have the same form as those pointed to by <a href="setupapi_7k8b.htm"><b>SP_FILE_CALLBACK</b></a>. </p>
<p>
Following is the syntax that <b>SetupIterateCabinet</b> uses to send a notification to the callback routine.</p>
<pre><code>MsgHandler(          //the specified callback routine
    Context,         //context used by the callback routine
    Notification,    //cabinet notification
    Param1,          //additional notification information
    Param2               //additional notification information
);
 </code></pre>
<p>
The <i>Context</i> parameter is a void pointer to a context variable or structure that can be used by the callback routine to store information that needs to persist between subsequent calls to the callback routine.</p>
<p>
This context's implementation is specified by the callback routine, and it is never referenced or altered by <b>SetupIterateCabinet</b>. </p>
<p>
The <i>Notification</i> parameter is an unsigned integer and will be one of the following values. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=52%><a href="setupapi_4gpw.htm">SPFILENOTIFY_FILEEXTRACTED</a></td>
<td width=48%>The file has been extracted from the cabinet.</td>
</tr>
<tr valign=top>
<td width=52%><a href="setupapi_7z90.htm">SPFILENOTIFY_FILEINCABINET</a></td>
<td width=48%>A file is encountered in the cabinet.</td>
</tr>
<tr valign=top>
<td width=52%><a href="setupapi_8fuc.htm">SPFILENOTIFY_NEEDNEWCABINET</a></td>
<td width=48%>The current file is continued in the next cabinet.</td>
</tr>
</table><br>
<p>
The final two parameters, <i>Param1 </i>and <i>Param2</i>, are also unsigned integers and contain additional information relevant to the notification. For more information about the notifications sent by <b>SetupIterateCabinet</b>, see <a href="setupapi_5mgj.htm">Cabinet File Notifications</a>.</p>
<p>
A SP_FILE_NOTIFY_CALLBACK routine returns an unsigned integer. The cabinet callback routine should return one of the following values depending on the notification.</p>
<p>
For the SPFILENOTIFY_FILEINCABINET notification, <b>SetupIterateCabinet</b> expects one of the following values to be returned by the callback routine.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=41%>FILEOP_ABORT</td>
<td width=59%>Abort cabinet processing.</td>
</tr>
<tr valign=top>
<td width=41%>FILEOP_DOIT</td>
<td width=59%>Extract the current file.</td>
</tr>
<tr valign=top>
<td width=41%>FILEOP_SKIP</td>
<td width=59%>Skip the current file.</td>
</tr>
</table><br>
<p>
For SPFILENOTIFY_NEEDNEWCABINET and SPFILENOTIFY_FILEEXTRACTED notifications, <b>SetupIterateCabient </b>expects one of the following values to be returned by the callback routine.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=41%>NO_ERROR</td>
<td width=59%>No error was encountered, continue processing the cabinet.</td>
</tr>
<tr valign=top>
<td width=41%>ERROR_XXX</td>
<td width=59%>An error of the specified type occurred. The <b>SetupIterateCabinet </b>function will return FALSE, and the specified error code will be returned by a call to <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</td>
</tr>
</table><br>
<p>
If the callback routine returns FILEOP_DOIT, the routine must also provide a full target path. For more information see <a href="setupapi_7z90.htm">SPFILENOTIFY_FILEINCABINET</a>.</p>
<p>&nbsp;</p></body>
</HTML>
