<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupQueryFileLog</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setupqueryfilelog"></a>SetupQueryFileLog</h1>
<p>
The <b>SetupQueryFileLog</b> function returns information from a setup file log.</p>
<pre><code><b>BOOL SetupQueryFileLog(
  HSPFILELOG</b><i> FileLogHandle</i><b>,  </b>// handle to the log file
<b>  PCTSTR</b><i> LogSectionName</i><b>,     </b>// optional, name to group by
<b>  PCTSTR</b><i> TargetFileName</i><b>,     </b>// name of target file
<b>  SetupFileLogInfo</b><i> DesiredInfo</i><b>,  </b>// specifies info to return
<b>  PTSTR</b><i> DataOut</i><b>,             </b>// optional, receives info
<b>  DWORD</b><i> ReturnBufferSize</i><b>,    </b>// size of supplied buffer
<b>  PDWORD</b><i> RequiredSize        </i>// optional, needed buffer size
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>FileLogHandle</i></dt>
<dd>
Supplies the handle to the file log as returned by <b>SetupInitializeLogFile</b>. </dd>
<dt>
<i>LogSectionName</i></dt>
<dd>
This optional parameter supplies the section name for the log file in a format that is meaningful to the caller. Required for non-system logs. If no <i>LogSectionName</i> is specified for a system log, a default is supplied.</dd>
<dt>
<i>TargetFileName</i></dt>
<dd>
Supplies the name of the file for which log information is desired.</dd>
<dt>
<i>DesiredInfo</i></dt>
<dd>
Indicates what information should be returned to the <i>DataOut </i>buffer. It can take one of the following enumerated values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>SetupFileLogSourceFilename</td>
<td width=52%>The name of the source file as it exists on the source media</td>
</tr>
<tr valign=top>
<td width=48%>SetupFileLogChecksum</td>
<td width=52%>A 32-bit checksum value used by the system log</td>
</tr>
<tr valign=top>
<td width=48%>SetupFileLogDiskTagfile</td>
<td width=52%>The name of the tag file of the media source containing the source file</td>
</tr>
<tr valign=top>
<td width=48%>SetupFileLogDiskDescription</td>
<td width=52%>The human-readable description of the media where the source file resides</td>
</tr>
<tr valign=top>
<td width=48%>SetupFileLogOtherInfo</td>
<td width=52%>Additional information associated with the logged file</td>
</tr>
</table><br>

</dd>
<dt>
<i>DataOut</i></dt>
<dd>
This optional parameter points to a caller-supplied buffer in which this function returns the requested information for the file. Not all information is provided for every file. An error is not returned if an empty entry for the file exists in the log.</dd>
<dt>
<i>ReturnBufferSize</i></dt>
<dd>
Supplies the size of the buffer, pointed to by <i>DataOut</i>. If the buffer is too small and <i>DataOut</i> is specified, data is not stored in the buffer and the function returns zero. If <i>DataOut</i> is not specified, the <i>ReturnBufferSize</i> parameter is ignored.</dd>
<dt>
<i>RequiredSize</i></dt>
<dd>
This optional parameter points to a caller-supplied variable in which this function returns the required size of <i>DataOut</i>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a non-zero value. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
For the Unicode version of this function, the buffer sizes <i>ReturnBufferSize</i>, and <i>ReturnRequiredSize </i>are specified in number of characters. This number includes the null terminator. For the ANSI version of this function, the sizes are specified in number of bytes.</p>
<p>
If this function is called with a <i>ReturnBuffer</i> of NULL and a <i>ReturnBufferSize</i> of zero, the function puts the buffer size needed to hold the specified data into the variable pointed to by <i>RequiredSize</i>. If the function succeeds in this, the return value is a non-zero value. Otherwise, the return value is zero and extended error information can be obtained by calling <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_2.Click()><b>GetLastError</b></a>.</p>
<p>
Thus, you can call the function once to get the required buffer size, allocate the necessary memory, and then call the function a second time to retrieve the data. Using this technique, you can avoid errors due to an insufficient buffer size.</p>
<h4>Remarks</h4>
<p>
If the value of <i>DesiredInfo </i>is greater than <i>SetupFileLogOtherInfo </i>the function will fail, and <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_3.Click()><b>GetLastError</b></a> will return ERROR_INVALID_PARAMETER.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_2rtx.htm"><b>SetupLogFile</b></a></p>
<p>&nbsp;</p></body>
</HTML>
