<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupInitializeFileLog</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setupapi_setupinitializefilelog"></a>SetupInitializeFileLog</h1>
<p>
The <b>SetupInitializeFileLog</b> function initializes a file to record installation operations and outcomes. This can be the system log, where the system tracks the files installed as part of Windows NT, or any other file.</p>
<pre><code><b>HSPFILELOG SetupInitializeFileLog(
  PCTSTR</b><i> LogFileName</i><b>,  </b>// optional, name of a log file to use
<b>  DWORD</b><i> Flags          </i>// controls initialization
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>LogFileName</i></dt>
<dd>
This optional parameter supplies the filename of the file to use as the log file. The <i>LogFileName</i> parameter must be specified if <i>Flags</i> does not include SPFILELOG_SYSTEMLOG. The <i>LogFileName</i> parameter must not be specified if <i>Flags</i> includes SPFILELOG_SYSTEMLOG.</dd>
<dt>
<i>Flags</i></dt>
<dd>
A set of flags that controls the log file initialization. This parameter can be a combination of the following:
<dl>
<dt>
SPFILELOG_SYSTEMLOG </dt>
<dd>
Use the Windows NT system file log which is used to track what files are installed as part of Windows NT. The user must be Administrator to specify this option unless SPFILELOG_QUERYONLY is specified and <i>LogFileName</i> is not specified. Do not specify SPFILELOG_SYSTEMLOG in combination with SPFILELOG_FORCENEW.</dd>
<dt>
SPFILELOG_FORCENEW</dt>
<dd>
If the log file exits, overwrite it. If the log file exists and this flag is not specified, any new files that are installed are added to the list in the existing log file. Do not specify in combination with SPFILELOG_SYSTEMLOG.</dd>
<dt>
SPFILELOG_QUERYONLY</dt>
<dd>
Open the log file for querying only.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
The function returns the handle to the log file if it is successful. Otherwise, the the return value is INVALID_HANDLE_VALUE and the logged error can be retrieved by a call to <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 and later.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in setupapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with setupapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="setupapi_6n1z.htm">Overview</a>, <a href="setupapi_0pv7.htm">Functions</a>, <a href="setupapi_51d3.htm"><b>SetupTerminateFileLog</b></a>, <a href="setupapi_2rtx.htm"><b>SetupLogFile</b></a></p>
<p>&nbsp;</p></body>
</HTML>
