<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.2 WFS_INF_PIN_CAPABILITIES</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
3.2 WFS_INF_PIN_CAPABILITIES</h5>
<p>
<b>Description</b> This command is used to retrieve the capabilities of the PIN pad.</p>
<p>
<b>Input Param </b>None.</p>
<p>
<b>Output Param</b> <code>LPWFSPINCAPS lpCaps;</code></p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_pin_caps<BR> {<BR> WORD   wClass;<BR> WORD   fwType;<BR> BOOL   bCompound;<BR> USHORT   usKeyNum;<BR> WORD   fwAlgorithms;<BR> WORD   fwPinFormats;<BR> WORD   fwDerivationAlgorithms;<BR> WORD   fwPresentationAlgorithms;<BR> WORD   fwDisplay;<BR> BOOL   bIDConnect;<BR> WORD   fwIDKey;<BR> WORD   fwValidationAlgorithms;<BR> LPSTR   lpszExtra;<BR> } WFSPINCAPS, * LPWFSPINCAPS;</FONT></pre>
<p>
 <i>wClass</i><BR>Specifies the logical service class, value is:<BR>WFS_SERVICE_CLASS_PIN</p>
<p>
 <i>fwType</i><BR>Specifies the type of the PIN pad security module as a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_TYPEEPP electronic PIN pad</p>
<p>
WFS_PIN_TYPEEDM encryption/decryption module</p>
<p>
 <i>bCompound</i><BR>Specifies whether the logical device is part of a compound physical device and is either TRUE or FALSE.</p>
<p>
 <i>usKeyNum</i><BR>Number of the keys which can be stored in the encryption/decryption module.</p>
<p>
 <i>fwAlgorithms</i><BR>Supported encryption modes; a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_CRYPTDESECB Electronic Code Book</p>
<p>
WFS_PIN_CRYPTDESCBC Cipher Block Chaining</p>
<p>
WFS_PIN_CRYPTDESMAC MAC calculation using CBC</p>
<p>
WFS_PIN_CRYPTDESCFB Cipher Feed Back</p>
<p>
WFS_PIN_CRYPTRSA RSA Encryption</p>
<p>
WFS_PIN_CRYPTECMA ECMA Encryption</p>
<p>
WFS_PIN_CRYPTTRIDESECB Triple DES with Electronic Code Book</p>
<p>
WFS_PIN_CRYPTTRIDESCBC Triple DES with Cipher Block Chaning</p>
<p>
WFS_PIN_CRYPTTRIDESCFB Triple DES with Cipher Feed Back</p>
<p>
WFS_PIN_CRYPTTRIDESMAC Triple DES MAC calculation using CBC</p>
<p>
 <i>fwPinFormats</i><BR>Supported PIN formats; a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_FORM3624 PIN left justified, filled with padding characters, PIN length 4-16 digits</p>
<p>
WFS_PIN_FORMANSI PIN is preceded by 0x00 and the length of the PIN (0x04 to 0x0C), filled with padding character 0x0F to the right, PIN length 4-12 digits, XORed with PAN (Primary Account Number, minimum 12 digits without check number)</p>
<p>
WFS_PIN_FORMISO0 PIN is preceded by 0x00 and the length of the PIN (0x04 to 0x0C), filled with padding character 0x0F to the right, PIN length 4-12 digits, XORed with PAN (Primary Account Number, no minimum length specified, missing digits are filled with 0x00)</p>
<p>
WFS_PIN_FORMISO1 PIN is preceded by 0x01 and the length of the PIN (0x04 to 0x0C), padding characters are taken from a transaction field (10 digits) </p>
<p>
WFS_PIN_FORMECI2 (similar to WFS_PIN_FORM3624), PIN only 4 digits</p>
<p>
WFS_PIN_FORMECI3 PIN is preceded by the length (digit), PIN length 4-6 digits, padded with 0x00</p>
<p>
WFS_PIN_FORMVISA same as WFS_PIN_FORMECI3</p>
<p>
WFS_PIN_FORMDIEBOLD PIN is padded with the padding character and may be not encrypted, single encrypted or double encrypted.</p>
<p>
WFS_PIN_FORMDIEBOLDCO PIN is preceeded by the two-digit coordination number, padded with the padding character and may be not encrypted, single encrypted or double encrypted.</p>
<p>
 <i>fwDerivationAlgorithms</i><BR> Supported derivation algorithms; a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_CHIP_ZKA Algorithm for the derivation of a chip card individual key as described by the German ZKA.</p>
<p>
 <i>fwPresentationAlgorithms</i><BR> Supported presentation algorithms; a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_PRESENT_CLEAR Algorithm for the presentation of a clear text PIN to a chip card.</p>
<p>
 <i>fwDisplay</i><BR>Specifies the type of the display used in the PIN pad module as one of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_DISPNONE no display unit</p>
<p>
WFS_PIN_DISPLEDTHROUGH lights next to text guide user</p>
<p>
WFS_PIN_DISPDISPLAY a real display is available (this doesn’t apply for self-service)</p>
<p>
 <i>bIDConnect</i><BR>Specifies whether the PIN pad is directly physically connected to the ID card unit. The value of this parameter is either TRUE or FALSE.</p>
<p>
 <i>fwIDKey</i><BR>Specifies whether an ID key is supported as a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_IDKEYINITIALIZATION ID key supported in the WFS_CMD_PIN_INITIALIZATION command.</p>
<p>
WFS_PIN_IDKEYIMPORT ID key supported in the WFS_CMD_PIN_IMPORT_KEY command.</p>
<p>
 <i>fwValidationAlgorithms</i><BR>Specifies the algorithms for PIN validation supported by the service; combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_DES DES algorithm</p>
<p>
WFS_PIN_EUROCHEQUE EUROCHEQUE algorithm</p>
<p>
WFS_PIN_VISA VISA algorithm</p>
<p>
WFS_PIN_DES_OFFSET DES offset generation algorithm</p>
<p>
 <i>lpszExtra</i><BR>Points to a list of vendor-specific, or any other extended information. The information is returned as a series of  “<i>key=value</i>” strings so that it is easily extendable by service providers. Each string is null-terminated, with the final string terminating with two null characters.</p>
<p>
<b>Error Codes </b> There are no additional error codes generated by this command.</p>
<p>
<b>Comments</b> Applications which require or expect specific information to be present in the <i>lpsExtra</i><b> </b>parameter may not be device or vendor-independent.</p>
</BODY>
</HTML>
