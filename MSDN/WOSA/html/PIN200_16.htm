<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.6 WFS_CMD_PIN_CREATE_OFFSET</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
4.6 WFS_CMD_PIN_CREATE_OFFSET</h5>
<p>
<b>Description</b> This function is used to generate a PIN Offset that is used to verify PINs using the WFS_CMD_PIN_LOCAL_DES execute command. The PIN offset is computed by combining validation data with the keypad entered PIN. This command will clear the PIN</p>
<p>
<b>Input Param </b><code>LPWFSPINCREATEOFFSET lpPINOffset;</code></p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_pin_create_offset<BR> {<BR> LPSTR   lpsValidationData;<BR> BYTE   bPadding;<BR> USHORT   usMaxPIN;<BR> USHORT   usValDigits;<BR> LPSTR   lpsKey;<BR> LPWFSXDATA lpxKeyEncKey;<BR> LPSTR   lpsDecTable;<BR> } WFSPINCREATEOFFSET, * LPWFSPINCREATEOFFSET;</FONT></pre>
<p>
 <i>lpsValidationData</i><BR>Validation data</p>
<p>
 <i>bPadding</i><BR>Specifies the padding character for validation data.</p>
<p>
 <i>usMaxPIN</i><BR>Maximum number of PIN digits to be used for PIN Offset creation.</p>
<p>
 <i>usValDigits</i><BR>Number of Validation Data digits to be used for PIN Offset creation.</p>
<p>
 <i>lpsKey</i><b><BR></b>Name of the validation key</p>
<p>
 <i>lpxKeyEncKey</i><b><BR></b>If NULL, <i>lpsKey</i> is used directly in PIN Offset creation. Otherwise, <i>lpsKey</i> is used to decrypt the encrypted key passed in <i>lpxKeyEncKey</i> and the result is used in PIN Offset creation.</p>
<p>
 <i>lpsDecTable</i><BR>ASCII decimalization table (16 character string containing characters ‘0’ to ‘9’). Used to convert the hexadecimal digits (0x0 to 0xF) of the encrypted validation data to decimal digits (0x0 to 0x9).</p>
<p>
<b>Output Param</b> <code>LPSTR lpsOffset;</code></p>
<p>
<i> lpsOffset</i><BR>Computed PIN Offset.</p>
<p>
<b>Error Codes</b> The following additional error codes can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_ERR_PIN_KEYNOTFOUND The specified key was not found.</p>
<p>
WFS_ERR_PIN_KEYNOVALUE The specified key is not loaded.</p>
<p>
WFS_ERR_PIN_USEVIOLATION The specified use is not supported by this key.</p>
<p>
WFS_ERR_PIN_ACCESSDENIED The encryption module is either not initialized or not ready for any vendor specific reason.</p>
<p>
WFS_ERR_PIN_NOPIN PIN has not been entered or has been cleared.</p>
<p>
WFS_ERR_PIN_NOTALLOWED PIN entered by the user is not allowed.</p>
<p>
<b>Events </b>The following additional events can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_SRVE_PIN_ILLEGAL_KEY_ACCESS An error occured accessing an encryption key.</p>
<p>
<b>Comments</b> The list of ‘forbidden’ PINs (values that cannot be chosen as a PIN, e.g. 1111) is configured in the device in a vendor dependent way during the configuration of the system.</p>
</BODY>
</HTML>
