<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>7.5 WFMEnumKey</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
7.5 WFMEnumKey</h5>
<p>
<b>HRESULT  WFMEnumKey </b>(<i> hKey, iSubKey, lpszName, lpcchName, lpftLastWrite</i> )</p>
<p>
Enumerates the subkeys of the specified open key.  Retrieves information about one subkey each time it is called.</p>
<p>
<b>Parameters</b> <b>HKEY  </b><i>hKey</i></p>
<p>
Handle to a currently open key, or the predefined handle value:<BR> WFS_CFG_HKEY_XFS_ROOT<BR>The keys enumerated by this function are subkeys of the key identified by this parameter.</p>
<p>
 <b>DWORD   </b><i>iSubKey</i> </p>
<p>
The index of the subkey to retrieve.  This parameter should be zero for the first call to this function, then incremented for each subsequent call, in order to enumerate all the subkeys of the specified open key.</p>
<p>
Because subkeys are not ordered, any new subkey will have an arbitrary index.  This means that the function may return subkeys in any order.</p>
<p>
 <b>LPSTR   </b><i>lpszName</i> </p>
<p>
Pointer to a buffer that receives the name of the subkey, including the terminating null character.</p>
<p>
<i> </i><b>LPDWORD </b> <i>lpcchName</i></p>
<p>
Pointer to a variable that specifies the size, in characters, of the buffer specified by the <i>lpszName</i> parameter, including the terminating null character.  When the function returns, this variable contains the the number of characters actually stored in the buffer, <b><i>not</i></b> including the terminating null character.</p>
<p>
<i> </i><b>PFILETIME </b> <i>lpftLastWrite</i></p>
<dl>
<dt>
Pointer to a variable that receives the time the enumerated subkey was last written to, in the form of a FILETIME structure (see <i>Microsoft Win32 Programmer's Reference, Vol. 5</i>):</dt>
<dd>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _FILETIME {<BR> DWORD  dwLowDateTime;<BR> DWORD  dwHighDateTime;<BR>} FILETIME;</FONT></pre>
</dd>
</dl>
<p>
<b>Comments</b> While a program is using this function iteratively, it should not call any other configuration functions that would change the key being enumerated. </p>
<p>
<b>Error Codes</b> If the function return is not WFS_SUCCESS, it is one of the following error conditions.  </p>
<dl>
<dt>
WFS_ERR_CFG_INVALID_HKEY</dt>
<dd>
The specified <i>hKey</i> parameter does not correspond to a currently open key.<br>
</dd>
<dt>
WFS_ERR_CFG_NO_MORE_ITEMS</dt>
<dd>
There are no more subkeys to be returned (the <i>iSubKey</i> parameter is greater than the index of the last subkey).<br>
</dd>
<dt>
WFS_ERR_CFG_NAME_TOO_LONG</dt>
<dd>
The length of the name to be returned exceeds the length of the buffer.<br>
</dd>
<dt>
WFS_ERR_INVALID_POINTER</dt>
<dd>
A pointer parameter does not point to accessible memory.</dd>
</dl>
</BODY>
</HTML>
