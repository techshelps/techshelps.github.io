<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>5.10 WFPUnloadService</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
5.10 WFPUnloadService</h5>
<p>
<b>HRESULT WFPUnloadService</b>( )</p>
<p>
Asks the called service provider whether it is OK for the XFS Manager to unload the service provider’s DLL.</p>
<p>
<b>Parameters</b> None</p>
<p>
<b>Mode</b> Immediate</p>
<p>
<b>Comments</b> This function is issued after the XFS Manager has received a <b>WFMReleaseDLL</b> request from the service provider or during the processing of the <b>WFSCleanUp</b> command.  The service provider returns WFS_SUCCESS only if it has fully “cleaned up,” i.e., has freed any resources it has allocated, has no separate threads running, etc.  If this is not true, it returns the error below, and initiates or continues the clean up process.</p>
<p>
<b>Error Codes</b> If the function return is not WFS_SUCCESS, it is one of the following error conditions:</p>
<dl>
<dt>
WFS_ERR_NOT_OK_TO_UNLOAD</dt>
<dd>
The XFS Manager may not unload the service provider DLL at this time.  It will repeat this request to the service provider until the return is WFS_SUCCESS, or until a new session is started by an application with this service provider.</dd>
</dl>
</BODY>
</HTML>
