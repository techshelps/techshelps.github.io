<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.13 WFSGetInfo</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
4.13 WFSGetInfo</h5>
<p>
<b>HRESULT WFSGetInfo</b>( <i>hService, dwCategory, lpQueryDetails, dwTimeOut, lppResult</i> )</p>
<p>
Retrieves information from the specified service provider.  The synchronous version of <b>WFSAsyncGetInfo</b>.</p>
<p>
<b>Parameters</b> <b>HSERVICE</b>   <i>hService</i></p>
<p>
Handle to the service provider as returned by <b>WFSOpen</b> or <b>WFSAsyncOpen.</b></p>
<p>
 <b>DWORD</b>   <i>dwCategory</i> </p>
<p>
Specifies the category of the query (e.g., for a printer, WFS_INF_PTR_STATUS to request status or WFS_INF_PTR_CAPABILITIES to request capabilities).  The available categories depend on the service class, the service provider and the service.  The information requested can be either static or dynamic, e.g., basic service capabilities (static) or current service status (dynamic).</p>
<p>
 <b>LPVOID</b>   <i>lpQueryDetails</i></p>
<p>
Pointer to the data structure to be passed to the service provider, containing further details to make the query more precise, e.g., a form name.  (Many queries have no input parameters, in which case this pointer is NULL.)</p>
<p>
 <b>DWORD</b>   <i>dwTimeOut</i></p>
<p>
Number of milliseconds to wait for completion (WFS_INDEFINITE_WAIT to specify a request that will wait until completion).</p>
<p>
 <b>LPWFSRESULT   * </b><i>lppResult</i></p>
<p>
Pointer to the pointer to the data structure to be filled with the result of the execution.  The service provider allocates the memory for the structure.</p>
<p>
<b>Mode</b> Synchronous</p>
<p>
<b>Comments</b> The XFS Manager passes the request to the service provider, and since the information may be stored remotely, the function cannot be immediate.  Note that many requests <b><i>can</i></b> be satisfied by the service provider and will therefore complete immediately.</p>
<p>
 The definitions of the <i>dwCategory</i> and <i>lpQueryDetails</i> parameters are provided in the service-specific command sections of this specification.  Note that these information retrieval functions are separate from the other service-specific commands, since those commands can be executed only via <b>WFSExecute</b> or <b>WFSAsyncExecute</b>, which require that the service be either locked by the application issuing the command, or unlocked.  The <b>GetInfo</b> functions, however, can be used even when a service is locked by another application.</p>
<p>
 The application <b><i>must</i></b> call <b>WFSFreeResult</b> to deallocate the WFSRESULT data structure which is returned by this function.  Note that a WFSRESULT structure may be returned even if the function completes with an error; see Section 3.13.</p>
<p>
<b>Error Codes</b> If the function return is not WFS_SUCCESS, it is one of the following error conditions.  Any service-specific errors that can be returned are defined in the specifications for each service class.</p>
<dl>
<dt>
WFS_ERR_CANCELED</dt>
<dd>
The request was canceled by <b>WFSCancelBlockingCall</b>.<br>
</dd>
<dt>
WFS_ERR_CONNECTION_LOST</dt>
<dd>
The connection to the service is lost.<br>
</dd>
<dt>
WFS_ERR_DEV_NOT_READY </dt>
<dd>
The function required device access, and the device was not ready or timed out. <br>
</dd>
<dt>
WFS_ERR_HARDWARE_ERROR </dt>
<dd>
The function required device access, and an error occured on the device. <br>
</dd>
<dt>
WFS_ERR_INTERNAL_ERROR </dt>
<dd>
An internal inconsistency or other unexpected error occurred in the WOSA/XFS subsystem. <br>
</dd>
<dt>
WFS_ERR_INVALID_CATEGORY</dt>
<dd>
The <i>dwCategory </i>issued is not supported by this service class.<br>
</dd>
<dt>
WFS_ERR_INVALID_DATA</dt>
<dd>
The data structure passed as input parameter contains invalid data.<br>
</dd>
<dt>
WFS_ERR_INVALID_HSERVICE</dt>
<dd>
The <i>hService</i> parameter is not a valid service handle.<br>
</dd>
<dt>
WFS_ERR_INVALID_POINTER</dt>
<dd>
A pointer parameter does not point to accessible memory.<br>
</dd>
<dt>
WFS_ERR_NOT_STARTED</dt>
<dd>
The application has not previously performed a successful <b>WFSStartUp</b>.<br>
</dd>
<dt>
WFS_ERR_OP_IN_PROGRESS</dt>
<dd>
A blocking operation is in progress on the thread; only <b>WFSCancelBlockingCall</b> and <b>WFSIsBlocking</b> are permitted at this time.<br>
</dd>
<dt>
WFS_ERR_SOFTWARE_ERROR </dt>
<dd>
The function required access to configuration information, and an error occured on the software.<br>
</dd>
<dt>
WFS_ERR_TIMEOUT</dt>
<dd>
The timeout interval expired.<br>
</dd>
<dt>
WFS_ERR_UNSUPP_CATEGORY</dt>
<dd>
The <i>dwCategory</i> issued, although valid for this service class, is not supported by this service provider.</dd>
</dl>
<p>
<b>See Also</b> <b>WFSAsyncGetInfo</b></p>
</BODY>
</HTML>
