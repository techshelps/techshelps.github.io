<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>9.7 Version Negotiation Failures</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
9.7 Version Negotiation Failures</h5>
<p>
Failures in version negotiation are reported as system events.  This is in addition to being reported by the version error code returned by the <b>WFSStartUp</b> or <b>WFSOpen</b> functions.  The WFSRESULT data structure (defined in Section 8.1) is utilized as follows:</p>
<p>
<b>Field Description<i> </i></b></p>
<p>
<i>RequestID</i> (not used)</p>
<p>
<i>hService</i> (not used)</p>
<p>
<i>tsTimestamp </i>Time the error occurred (local time, in a Win32 SYSTEMTIME structure)</p>
<p>
<i>hResult </i>The version error code (e.g., WFS_ERR_SPI_VER_TOO_HIGH)</p>
<p>
<i>u.dwEventID</i> = WFS_SYSE_VERSION_ERROR</p>
<p>
<i>lpBuffer </i>Pointer to a WFSVRSNERROR structure:</p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_vrsnerror {
 LPSTR   lpszLogicalName;
 LPSTR   lpszWorkstationName;
 LPSTR   lpszAppID;
 DWORD   dwSize;
 LPBYTE   lpbDescription;
 LPWFSVERSION lpWFSVersion;
} <b>WFSVRSNERROR, * LPWFSVRSNERROR</b></FONT></pre>
<p>
The members of this structure are:</p>
<p>
<b>Field Description<i> </i></b></p>
<p>
<i>lpszLogicalName</i> Pointer to the logical service name of the service being opened (NULL if <b>WFSStartUp</b>)</p>
<p>
<i>lpszWorkstationName</i> Pointer to the name of the workstation in which the application made the <b>WFSStartUp</b> or <b>WFSOpen</b> request</p>
<p>
<i>lpszAppID </i>Pointer to the application ID from the open request that failed (NULL if <b>WFSStartUp</b>)</p>
<p>
<i>dwSize </i>The size in bytes of the following description</p>
<p>
<i>lpbDescription </i>Pointer to a vendor-specific description of the version negotiation failure</p>
<p>
<i>lpWFSVersion </i>Pointer to the WFSVERSION structure reporting the results of the version negotiation</p>
</BODY>
</HTML>
