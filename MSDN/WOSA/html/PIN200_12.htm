<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.2 WFS_CMD_PIN_IMPORT_KEY</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
4.2 WFS_CMD_PIN_IMPORT_KEY</h5>
<p>
<b>Description</b> The key passed by the application is loaded in the encryption module. The key can be passed in clear text mode or encrypted with an accompanying “key encryption key”.</p>
<p>
<b>Input Param </b><code>LPWFSPINIMPORT lpImport;</code></p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_pin_import<BR> {<BR> LPSTR    lpsKey;<BR> LPSTR    lpsEncKey;<BR> LPWFSXDATA  lpxIdent;<BR> LPWFSXDATA  lpxValue;<BR> WORD    fwUse;<BR> } WFSPINIMPORT, * LPWFSPINIMPORT;</FONT></pre>
<p>
 <i>lpsKey</i><BR>Specifies the name of key being loaded.</p>
<p>
 <i>lpsEncKey</i><BR>If <i>lpsEncKey</i> is NULL the key is loaded directly into the encryption module. Otherwise, <i>lpsEncKey</i> specifies a key name or a format name which were used to encrypt the key string passed in <i>lpxValue</i>.</p>
<p>
 <i>lpxIdent</i><BR>Specifies the key owner identification. The use of this parameter is vendor dependent.</p>
<p>
 <i>lpxValue</i><BR>Specifies the value of key to be loaded.</p>
<p>
 <i>fwUse<BR></i>Specifies the type of access for which the key can be used as a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_PIN_USECRYPT key can be used for encryption/decryption</p>
<p>
WFS_PIN_USEFUNCTION key can be used for PIN functions</p>
<p>
WFS_PIN_USEMACING key can be used for MACing</p>
<p>
WFS_PIN_USEKEYENCKEY key is used as key encryption key</p>
<p>
WFS_PIN_USESVENCKEY key is used as CBC Start Value encryption key</p>
<p>
WFS_PIN_USENODUPLICATE key can be imported only once</p>
<p>
<b>Output Param </b><code>LPWFSXDATA lpxKVC;</code></p>
<p>
 <i>lpxKVC</i><BR>pointer to the key verification code data that can be used for verification of the loaded key, NULL if device does not have that capability.</p>
<p>
<b>Error Codes</b> The following additional error codes can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_ERR_PIN_KEYNOTFOUND The specified key encryption key was not found.</p>
<p>
WFS_ERR_PIN_KEYNOVALUE The specified key encryption key is not loaded.</p>
<p>
WFS_ERR_PIN_USEVIOLATION The specified use is not supported by this key.</p>
<p>
WFS_ERR_PIN_ACCESSDENIED The encryption module is either not initialized or not ready for any vendor specific reason.</p>
<p>
WFS_ERR_PIN_INVALIDID The ID passed was not valid.</p>
<p>
WFS_ERR_PIN_DUPLICATEKEY A key exists with that name and cannot be overwritten.</p>
<p>
WFS_ERR_PIN_INVALIDKEYLENGTH The length of <i>lpxValue</i> is not supported.</p>
<p>
<b>Events </b>The following additional events can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_SRVE_PIN_ILLEGAL_KEY_ACCESS An error occured accessing an encryption key.</p>
<p>
<b>Comments</b> None.</p>
</BODY>
</HTML>
