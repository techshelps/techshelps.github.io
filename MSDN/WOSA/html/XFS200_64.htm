<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>5.5 WFPGetInfo</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
5.5 WFPGetInfo</h5>
<p>
<b>HRESULT  WFPGetInfo</b>( <i>hService, dwCategory, lpQueryDetails, dwTimeOut, hWnd, ReqID</i> )</p>
<p>
Retrieves various kinds of information from the specified service provider. </p>
<p>
<b>Parameters</b> <b>HSERVICE</b>   <i>hService</i></p>
<p>
Handle to the service provider.</p>
<p>
 <b>DWORD</b>   <i>dwCategory</i> </p>
<p>
Specifies the category of the query (e.g., for a printer, WFS_INF_PTR_STATUS to request status or WFS_INF_PTR_CAPABILITIES to request capabilities).  The available categories depend on the service class, the service provider and the service.  The information requested can be either static or dynamic, e.g., basic service capabilities (static) or current service status (dynamic).</p>
<p>
<i> </i><b>LPVOID   </b><i>lpQueryDetails</i></p>
<p>
Pointer to the data structure to be passed to the service provider, containing further details to make the query more precise, e.g., a form name.  (Many queries have no input parameters, in which case this pointer is NULL.)</p>
<p>
 <b>DWORD</b>   <i>dwTimeOut</i></p>
<p>
Number of milliseconds to wait for completion (WFS_INDEFINITE_WAIT to specify a request that will wait until completion).</p>
<p>
 <b>HWND</b>   <i>hWnd</i></p>
<p>
The window handle which is to receive the completion message for this request.</p>
<p>
<i> </i><b>REQUESTID</b>   <i>ReqID </i></p>
<p>
Request identification number.</p>
<p>
<b>Mode</b> Asynchronous</p>
<p>
<b>Comments</b> The XFS Manager retrieves the information requested from the service provider itself, and, since the information can be stored remotely, the function cannot be guaranteed to complete immediately.  Note that, typically, requests for generic and class specific categories <b><i>can</i></b> complete immediately.  See <b>WFSGetInfo</b> for additional discussion.</p>
<p>
 The specifications for the information structures for each service class can be found in the specifications for the service-specific commmands.</p>
<p>
<b>Messages </b>WFS_GETINFO_COMPLETE  </p>
<p>
<b>Error Codes</b> If the function return is not WFS_SUCCESS, it is one of the following error conditions, indicating that the asynchronous operation was not initiated.  Any service-specific errors that can be returned are defined in the specifications for each service class.</p>
<dl>
<dt>
WFS_ERR_CONNECTION_LOST</dt>
<dd>
The connection to the service is lost.<br>
</dd>
<dt>
WFS_ERR_INTERNAL_ERROR </dt>
<dd>
An internal inconsistency or other unexpected error occurred in the WOSA/XFS subsystem. <br>
</dd>
<dt>
WFS_ERR_INVALID_CATEGORY</dt>
<dd>
The <i>dwCategory </i>issued is not supported by this service class.<br>
</dd>
<dt>
WFS_ERR_INVALID_HSERVICE</dt>
<dd>
The <i>hService</i> parameter is not a valid service handle.<br>
</dd>
<dt>
WFS_ERR_INVALID_HWND</dt>
<dd>
The <i>hWnd</i> parameter is not a valid window handle.<br>
</dd>
<dt>
WFS_ERR_INVALID_POINTER</dt>
<dd>
A pointer parameter does not point to accessible memory.<br>
</dd>
<dt>
WFS_ERR_UNSUPP_CATEGORY</dt>
<dd>
The <i>dwCategory</i> issued, although valid for this service class, is not supported by this service provider.</dd>
</dl>
<p>
The following error conditions are returned via the asynchronous command completion message, as the <i>hResult</i> from the WFSRESULT structure.  Any service-specific errors that can be returned are defined in the specifications for each service class.</p>
<dl>
<dt>
WFS_ERR_CANCELED</dt>
<dd>
The request was canceled by <b>WFSCancelAsyncRequest</b>.<br>
</dd>
<dt>
WFS_ERR_DEV_NOT_READY </dt>
<dd>
The function required device access, and the device was not ready or timed out. <br>
</dd>
<dt>
WFS_ERR_HARDWARE_ERROR </dt>
<dd>
The function required device access, and an error occured on the device. <br>
</dd>
<dt>
WFS_ERR_INTERNAL_ERROR </dt>
<dd>
An internal inconsistency or other unexpected error occurred in the WOSA/XFS subsystem. <br>
</dd>
<dt>
WFS_ERR_INVALID_DATA</dt>
<dd>
The data structure passed as input parameter contains invalid data..<br>
</dd>
<dt>
WFS_ERR_SOFTWARE_ERROR </dt>
<dd>
The function required access to configuration information, and an error occured on the software.<br>
</dd>
<dt>
WFS_ERR_TIMEOUT</dt>
<dd>
The timeout interval expired.</dd>
</dl>
</BODY>
</HTML>
