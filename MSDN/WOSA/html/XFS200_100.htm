<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>9.4 Undeliverable Messages</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
9.4 Undeliverable Messages</h5>
<p>
If a command completion or event message cannot be delivered, it is reported as a system event.  The WFSRESULT data structure (defined in Section 8.1) is utilized as follows:</p>
<p>
<b>Field Description </b></p>
<p>
<i>RequestID</i> (not used)</p>
<p>
<i>hService</i> Service handle identifying the session associated with the completion or event</p>
<p>
<i>tsTimestamp </i>Time the event occurred (local time, in a Win32 SYSTEMTIME structure)</p>
<p>
<i>hResult </i>(not used)</p>
<p>
<i>u.dwEventID </i>= WFS_SYSE_UNDELIVERABLE_MSG</p>
<p>
<i>lpBuffer </i>Pointer to a WFSUNDEVMSG structure:</p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_undevmsg {
 LPSTR   lpszLogicalName;
 LPSTR   lpszWorkstationName;
 LPSTR   lpszAppID;
 DWORD   dwSize;
 LPBYTE   lpbDescription;
 DWORD   dwMsg;
 LPWFSRESULT lpWFSResult;
} <b>WFSUNDEVMSG, * LPWFSUNDEVMSG</b>;</FONT></pre>
<p>
The members of this structure are:</p>
<p>
<b>Field Description<i> </i></b></p>
<p>
<i>lpszLogicalName</i> Pointer to the logical service name of the service that generated the original undeliverable message</p>
<p>
<i>lpszWorkstationName</i> Pointer to the the name of the workstation in which the logical service name is defined</p>
<p>
<i>lpszAppID </i>Pointer to the the application ID associated with the session that generated the original message</p>
<p>
<i>dwSize </i>The size in bytes of the following description</p>
<p>
<i>lpbDescription </i>Pointer to a vendor-specific description of the reason why the message could not be delivered</p>
<p>
<i>dwMsg </i>The message identifier of the original message</p>
<p>
<i>lpWFSResult </i>Pointer to the WFSRESULT structure of the original message (which has the <i>lpBuffer</i> parameter set to NULL)</p>
</BODY>
</HTML>
