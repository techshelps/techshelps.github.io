<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.8 WFS_CMD_PIN_LOCAL_VISA</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
4.8 WFS_CMD_PIN_LOCAL_VISA</h5>
<p>
<b>Description</b> The PIN, which was entered with the WFS_PIN_GET_PIN command,  is combined with the requisite data specified by the VISA validation algorithm and locally verified for correctness. The result of the verification is returned to the application. This command will clear the PIN.</p>
<p>
<b>Input Param </b><code>LPWFSPINLOCALVISA lpLocalVISA;</code></p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_pin_local_visa<BR> {<BR> LPSTR   lpsPAN;<BR> LPSTR   lpsPVV;<BR> WORD   wPVVDigits;<BR> LPSTR   lpsKey;<BR> LPWFSXDATA lpxKeyEncKey;<BR> } WFSPINLOCALVISA, * LPWFSPINLOCALVISA;</FONT></pre>
<p>
 <i>lpsPAN</i><BR>Primary Account Number from track data.</p>
<p>
 <i>lpsPVV</i><BR>PIN Validation Value from track data.</p>
<p>
 <i>wPVVDigits</i><BR>Number of digits of PVV.</p>
<p>
 <i>lpsKey</i><b><BR></b>Name of the validation key.</p>
<p>
<i> lpxKeyEncKey</i><b><BR></b>If NULL, <i>lpsKey</i> is used directly for PIN validation. Otherwise, <i>lpsKey</i> is used to decrypt the encrypted key passed in <i>lpxKeyEncKey</i> and the result is used for PIN validation.</p>
<p>
<b>Output Param</b> <code>LPBOOL  lpbResult;</code></p>
<p>
 <i>lpbResult</i><BR>Pointer to a boolean value which specifies whether the PIN is correct or not.</p>
<p>
<b>Error Codes</b> The following additional error codes can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_ERR_PIN_KEYNOTFOUND The specified key was not found.</p>
<p>
WFS_ERR_PIN_KEYNOVALUE The specified key is not loaded.</p>
<p>
WFS_ERR_PIN_USEVIOLATION The specified use is not supported by this key.</p>
<p>
WFS_ERR_PIN_ACCESSDENIED The encryption module is either not initialized or not ready for any vendor specific reason.</p>
<p>
WFS_ERR_PIN_NOPIN PIN has not been entered or has been cleared.</p>
<p>
<b>Events </b>The following additional events can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_SRVE_PIN_ILLEGAL_KEY_ACCESS An error occured accessing an encryption key.</p>
<p>
<b>Comments</b> None.</p>
</BODY>
</HTML>
