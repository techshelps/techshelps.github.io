<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.7 WFS_CMD_IDC_READ_RAW_DATA</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
4.7 WFS_CMD_IDC_READ_RAW_DATA</h5>
<p>
<b>Description</b> For motor driven card readers, the ID card unit checks whether a card has been inserted. If so, all specified tracks are read immediately. If reading the chip is requested, the chip will be contacted and reset and the ATR (Answer To Reset) data will be read. When this command completes the chip will be in contacted position. This command can also be used for an explicit reset of a previously contacted chip.</p>
<p>
 If no card has been inserted, and for all other categories of card readers, the ID card unit waits for the period of time specified in the <b>WFSExecute</b> call for a card to be either inserted or pulled through. The next step is trying to read all tracks specified.</p>
<p>
 Magnetic stripe track data is converted from its 5 or 7 bit character form to 8 bit ASCII form. The parity bit from each 5 or 7 bit magnetic stripe character is discarded. Start and end sentinel characters are not returned to the application. Field separator characters are returned to the application, and are also converted to 8 bit ASCII form.</p>
<p>
 In addition to that, a security check via a security module (i.e., MM, CIM86) can be requested.</p>
<p>
<b>Input Param</b> <code>LPWORD lpwReadData</code>;</p>
<p>
 <i>lpwReadData</i><BR>Specifies which data should be read as a combination of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_IDC_TRACK1 Track 1 of the magnetic stripe will be read.</p>
<p>
WFS_IDC_TRACK2 Track 2 of the magnetic stripe will be read.</p>
<p>
WFS_IDC_TRACK3 Track 3 of the magnetic stripe will be read.</p>
<p>
WFS_IDC_CHIP The chip will be read.</p>
<p>
WFS_IDC_SECURITY A security check will be performed.</p>
<p>
<b>Output Param</b> <code>LPWFSIDCCARDDATA *lppCardData</code>;</p>
<p>
 Pointer to a null-terminated array of pointers to card data structures:</p>
<pre><FONT FACE="COURIER NEW" SIZE=2>struct _wfs_idc_card_data<BR> {<BR> WORD   wDataSource;<BR> WORD   wStatus;<BR> ULONG   ulDataLength;<BR> LPBYTE   lpbData;<BR> } WFSIDCCARDDATA, * LPWFSIDCCARDDATA;</FONT></pre>
<p>
<i>wDataSource</i></p>
<p>
Specifies the source of the card data as one of the following flags:</p>
<p>
Value Meaning</p>
<p>
WFS_IDC_TRACK1 <i>lpbData</i> contains data read from track 1.</p>
<p>
WFS_IDC_TRACK2 <i>lpbData</i> contains data read from track 2.</p>
<p>
WFS_IDC_TRACK3 <i>lpbData</i> contains data read from track 3. </p>
<p>
WFS_IDC_CHIP <i>lpbData</i> contains ATR data read from the chip.</p>
<p>
WFS_IDC_SECURITY <i>lpbData</i> contains the value returned by the security module.</p>
<p>
<i>wStatus</i></p>
<p>
Status of reading the card data. Possible values are:</p>
<p>
Value Meaning</p>
<p>
WFS_IDC_DATAOK The data is ok.</p>
<p>
WFS_IDC_DATAMISSING The track/chip is blank.</p>
<p>
WFS_IDC_DATAINVALID The data contained on the track/chip is invalid.</p>
<p>
 WFS_IDC_DATATOOLONG The data contained on the track/chip is too long.</p>
<p>
WFS_IDC_DATATOOSHORT The data contained on the track/chip is too short.</p>
<p>
WFS_IDC_DATASRCNOTSUPP The data source to read from is not supported by the service provider.</p>
<p>
WFS_IDC_DATASRCMISSING The data source to read from is missing on the card.</p>
<p>
<i>ulDataLength</i></p>
<p>
Specifies the length of the following field <i>lpbData</i>.</p>
<p>
<i>lpbData</i></p>
<p>
Points to the data read from the track/chip or the value returned by the security module.</p>
<p>
<b>Error Codes</b> The following additional error codes can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_ERR_IDC_MEDIAJAM The card is jammed. Operator intervention is required.</p>
<p>
WFS_ERR_IDC_SHUTTERFAIL The open of the shutter failed due to manipulation or hardware error. Operator intervention is required</p>
<p>
WFS_ERR_IDC_NOMEDIA The card was  removed before completion of the read action.</p>
<p>
WFS_ERR_IDC_INVALIDMEDIA No track or chip found; card may have been inserted or pulled through the wrong way.</p>
<p>
<b>Events</b> The following additional events can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_EXEE_IDC_MEDIAINSERTED This event is generated when a card is detected in the device, giving early warning of card entry to an application, allowing it to remove a user prompt and/or do other processing while the card is being read.</p>
<p>
WFS_SRVE_IDC_MEDIAREMOVED This event is generated when a card is removed before completion of a read operation.</p>
<p>
WFS_EXEE_IDC_INVALIDMEDIA The user is attempting to insert the media in the wrong orientation. The card has not been accepted into the device. The device is still ready to accept a card inserted in the correct orientation.</p>
<p>
<b>Comments </b>None.</p>
</BODY>
</HTML>
