<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.3 WFS_CMD_PIN_DERIVE_KEY</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
4.3 WFS_CMD_PIN_DERIVE_KEY</h5>
<p>
<b>Description</b> A key is derived from input data using a key generating key and an initialization vector. The input data can be expanded with a fill-character to the necessary length (mandated by the encryption algorithm being used). The derived key is imported into the encryption module and is used for encryption or decryption operations. </p>
<p>
<b>Input Param </b><code>LPWFSPINDERIVE lpDerive;</code></p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_pin_derive<BR> {<BR> WORD    wDerivationAlgorithm;<BR> LPSTR    lpsKey;<BR> LPSTR    lpsKeyGenKey;<BR> LPSTR    lpsStartValueKey;<BR> LPWFSXDATA  lpxStartValue;<BR> BYTE    bPadding;<BR> LPWFSXDATA  lpxInputData;<BR> LPWFSXDATA  lpxIdent;<BR> } WFSPINDERIVE, * LPWFSPINDERIVE;</FONT></pre>
<p>
 <i>wDerivationAlgorithm</i><BR>Specifies the algorithm that is used for derivation. Possible values are:<BR>(see command WFS_INF_PIN_CAPABILITIES)</p>
<p>
 <i>lpsKey</i><BR>Specifies the name where the derived key will be stored.</p>
<p>
 <i>lpsKeyGenKey</i><BR>Specifies the name of the key generating key that is used for the derivation.</p>
<p>
 <i>lpsStartValueKey</i><BR>Specifies the name of the stored key used to decrypt the <i>lpxStartValue</i> to obtain the Initialization Vector. If this parameter is NULL, <i>lpxStartValue</i> is used as the Initialization Vector.</p>
<p>
 <i>lpxStartValue</i><BR>DES initialization vector for the encryption step within the derivation. </p>
<p>
<i> bPadding<BR></i>Specifies the padding character for the encryption step within the derivation. </p>
<p>
 <i>lpxInputData</i><BR>Pointer to the data to be used for key derivation.</p>
<p>
 <i>lpxIdent</i><BR>Specifies the key owner identification. The use of this parameter is vendor dependent.</p>
<p>
<b>Output Param</b> None.</p>
<p>
<b>Error Codes</b> The following additional error codes can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_ERR_PIN_KEYNOTFOUND The specified key was not found.</p>
<p>
WFS_ERR_PIN_KEYNOVALUE The specified key is not loaded.</p>
<p>
WFS_ERR_PIN_USEVIOLATION The specified use is not supported by this key.</p>
<p>
WFS_ERR_PIN_MODENOTSUPPORTED The specified algorithm is not supported.</p>
<p>
WFS_ERR_PIN_ACCESSDENIED The encryption module is either not initialized (or not ready for some vendor specific reason).</p>
<p>
WFS_ERR_PIN_INVALIDID The ID passed was not valid.</p>
<p>
WFS_ERR_PIN_DUPLICATEKEY A key exists with that name and cannot be overwritten.</p>
<p>
WFS_ERR_PIN_INVALIDKEYLENGTH The length of <i>lpxStartValue</i> is not supported.</p>
<p>
<b>Events </b>The following additional events can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_SRVE_PIN_ILLEGAL_KEY_ACCESS An error occured accessing an encryption key.</p>
<p>
<b>Comments</b> None.</p>
</BODY>
</HTML>
