<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.5 WFS_CMD_PIN_LOCAL_DES</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
4.5 WFS_CMD_PIN_LOCAL_DES</h5>
<p>
<b>Description</b> The PIN, which was entered with the WFS_PIN_GET_PIN command,  is combined with the requisite data specified by the DES validation algorithm and locally verified for correctness. The local DES verification is based on the IBM 3624 standard. The result of the verification is returned to the application. This command will clear the PIN.</p>
<p>
<b>Input Param </b><code>LPWFSPINLOCALDES lpLocalDES;</code></p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_pin_local_des<BR> {<BR> LPSTR   lpsValidationData;<BR> LPSTR   lpsOffset;<BR> BYTE   bPadding;<BR> USHORT   usMaxPIN;<BR> USHORT   usValDigits;<BR> BOOL   bNoLeadingZero;<BR> LPSTR   lpsKey;<BR> LPWFSXDATA lpxKeyEncKey;<BR> LPSTR   lpsDecTable;<BR> } WFSPINLOCALDES, * LPWFSPINLOCALDES;</FONT></pre>
<p>
 <i>lpsValidationData</i><BR>Validation data</p>
<p>
 <i>lpsOffset</i><BR>Offset for the PIN block; if NULL then no offset is used.</p>
<p>
 <i>bPadding</i><BR>Specifies the padding character for validation data.</p>
<p>
 <i>usMaxPIN</i><BR>Maximum number of PIN digits to be used for validation.</p>
<p>
 <i>usValDigits</i><BR>Number of Validation digits to be used for validation.</p>
<p>
 <i>bNoLeadingZero</i><BR>If set to TRUE and the first digit of result of the modulo 10 addition is a X’0’, it is replaced with X’1’ before performing the verification against the entered PIN. If set to FALSE, a leading zero is allowed in entered PINs.</p>
<p>
 <i>lpsKey</i><b><BR></b>Name of the validation key</p>
<p>
 <i>lpxKeyEncKey</i><b><BR></b>If NULL, <i>lpsKey</i> is used directly for PIN validation. Otherwise, <i>lpsKey</i> is used to decrypt the encrypted key passed in <i>lpxKeyEncKey</i> and the result is used for PIN validation.</p>
<p>
 <i>lpsDecTable</i><BR>ASCII decimalization table (16 character string containing characters ‘0’ to ‘9’). Used to convert the hexadecimal digits (0x0 to 0xF) of the encrypted validation data to decimal digits (0x0 to 0x9).</p>
<p>
<b>Output Param</b> <code>LPBOOL  pbResult;</code></p>
<p>
 <i>lpbResult</i><BR>Pointer to a boolean value which specifies whether the PIN is correct or not.</p>
<p>
<b>Error Codes</b> The following additional error codes can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_ERR_PIN_KEYNOTFOUND The specified key was not found.</p>
<p>
WFS_ERR_PIN_KEYNOVALUE The specified key is not loaded.</p>
<p>
WFS_ERR_PIN_USEVIOLATION The specified use is not supported by this key.</p>
<p>
WFS_ERR_PIN_ACCESSDENIED The encryption module is either not initialized or not ready for any vendor specific reason.</p>
<p>
WFS_ERR_PIN_NOPIN PIN has not been entered or has been cleared.</p>
<p>
<b>Events </b>The following additional events can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_SRVE_PIN_ILLEGAL_KEY_ACCESS An error occured accessing an encryption key.</p>
<p>
<b>Comments</b> None.</p>
</BODY>
</HTML>
