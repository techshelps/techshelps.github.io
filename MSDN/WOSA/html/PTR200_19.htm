<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>7.2 WFS_CMD_PTR_PRINT_FORM</TITLE>
<BODY bgcolor=white>

<FONT FACE="verdana"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<h5>
7.2 WFS_CMD_PTR_PRINT_FORM</h5>
<p>
<b>Description </b>This command is used to print a form by merging the supplied variable field data with the defined form and field data specified in the form. If no media is present, the device waits for the period of time specified by the <i>dwTimeOut</i> parameter in the <b>WFSExecute </b>call for media to be inserted.</p>
<p>
<b>Input Param</b> <code>LPWFSPTRPRINTFORM lpPrintForm;</code></p>
<pre><FONT FACE="COURIER NEW" SIZE=2>typedef struct _wfs_ptr_print_form<BR> {<BR> LPSTR  lpszFormName;<BR> LPSTR  lpszMediaName;<BR> WORD  wAlignment<BR> WORD  wOffsetX;<BR> WORD  wOffsetY;<BR> WORD  wResolution;<BR> DWORD  dwMediaControl;<BR> LPSTR  lpszFields;<BR> } WFSPTRPRINTFORM, * LPWFSPTRPRINTFORM;</FONT></pre>
<p>
 <i>lpszFormName</i><b><BR></b>Pointer to the null-terminated form name.</p>
<p>
 <i>lpszMediaName</i><b><BR></b>Pointer to the null-terminated media name.</p>
<p>
 <i>wAlignment</i><b><BR></b>Specifies the alignment of the form on the physical medium, as one of these values:</p>
<p>
Value Meaning</p>
<p>
WFS_PTR_ALNUSEFORMDEFN Use the alignment specified in the form definition.</p>
<p>
WFS_PTR_ALNTOPLEFT Align form to top left of physical medium.</p>
<p>
WFS_PTR_ALNTOPRIGHT Align form to top right of physical medium.</p>
<p>
WFS_PTR_ALNBOTTOMLEFT Align form to bottom left of physical medium.</p>
<p>
WFS_PTR_ALNBOTTOMRIGHT Align form to bottom right of physical medium.</p>
<p>
 <i>wOffsetX</i><b><BR></b>Specifies the horizontal offset of the form, relative to the horizontal alignment specified in <i>wAlignment</i>, in horizontal resolution units (from form definition); always a positive number (i.e., if aligned to the right side of the medium, means offset the form to the left). A value of WFS_PTR_OFFSETUSEFORMDEFN indicates that the <i>xoffset</i> value from the form definition should be used.</p>
<p>
 <i>wOffsetY</i><b><BR></b>Specifies the vertical offset of the form, relative to the vertical alignment specified in <i>wAlignment</i>, in vertical resolution units (from form definition); always a positive number <BR>(i.e., if aligned to the bottom of the medium, means offset the form upward). A value of WFS_PTR_OFFSETUSEFORMDEFN indicates that the <i>yoffset</i> value from the form definition should be used.</p>
<p>
 <i>wResolution</i><b><BR></b>Specifies the resolution in which to print the form. Possible values are:</p>
<p>
Value Meaning</p>
<p>
WFS_PTR_RESLOW Print form with low resolution.</p>
<p>
WFS_PTR_RESMED Print form with medium resolution.</p>
<p>
WFS_PTR_RESHIGH Print form with high resolution.</p>
<p>
WFS_PTR_RESVERYHIGH Print form with very high resolution.</p>
<p>
 <i>dwMediaControl</i><b><BR></b>Specifies the manner in which the media should be handled, as a combination of the flags described under WFS_CMD_PTR_CONTROL_MEDIA. A NULL value of this parameter means to do none of these actions, as when printing multiple forms on a single page.</p>
<p>
 <i>lpszFields</i><BR>Pointer to a series of &quot;&lt;FieldName&gt;=&lt;FieldValue&gt;&quot; strings, where each string is null-terminated with the final string terminating with two null characters. If the field is an index field, then the syntax of the string is instead &quot;&lt;FieldName&gt;<b>[</b>&lt;index&gt;<b>]</b>=&lt;FieldValue&gt;&quot;, where &lt;index&gt; specifies the zero-based element of the index field.</p>
<p>
<b>Output Param </b>None.</p>
<p>
<b>Error Codes</b> The following additional error codes can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_ERR_PTR_FORMNOTFOUND The specified form definition cannot be found.</p>
<p>
WFS_ERR_PTR_FORMINVALID The specified form definition is invalid.</p>
<p>
WFS_ERR_PTR_MEDIANOTFOUND The specified media definition cannot be found.</p>
<p>
WFS_ERR_PTR_MEDIAINVALID The specified media definition is invalid.</p>
<p>
WFS_ERR_PTR_MEDIASKEWED The media skew exceeded the limit in the form definition.</p>
<p>
WFS_ERR_PTR_MEDIAOVERFLOW The form overflowed the media.</p>
<p>
WFS_ERR_PTR_FIELDSPECFAILURE The syntax of the <i>lpszFields</i> member is invalid.</p>
<p>
WFS_ERR_PTR_FIELDERROR An error occurred while processing a field, causing termination of the print request. An execute event WFS_EXEE_PTR_FIELDERROR is posted with the details.</p>
<p>
<b>Events </b>The following additional events can be generated by this command:</p>
<p>
Value Meaning</p>
<p>
WFS_EXEE_PTR_NOMEDIA No media is present in the device.</p>
<p>
WFS_EXEE_PTR_FIELDERROR A fatal error occured while processing a field.</p>
<p>
WFS_EXEE_PTR_FIELDWARNING A non-fatal error occured while processing a field.</p>
<p>
WFS_EXEE_PTR_MEDIAINSERTED Media has been inserted into the device.</p>
<p>
<b>Comments </b>All error codes (except WFS_ERR_PTR_NOMEDIAPRESENT) and events listed under the WFS_CMD_PTR_CONTROL_MEDIA command description can also occur on this command<b>.</b></p>
<p>
<b> </b>An invalid field name is treated as a WFS_EXEE_PTR_FIELDWARNING event with WFS_PTR_FIELDNOTFOUND status. A WFS_EXEE_PTR_FIELDWARNING event is returned with WFS_PTR_FIELDOVERFLOW status if the data overflows the field, and the field definition OVERFLOW value is TRUNCATE, BESTFIT, OVERWRITE or WORDWRAP. Other field-related problems generate a field error return and event.</p>
</BODY>
</HTML>
