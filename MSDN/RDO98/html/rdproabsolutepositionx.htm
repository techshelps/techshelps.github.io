<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AbsolutePosition Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdproabsolutepositionx"></a>AbsolutePosition Property Example</h1>
<p>
The following example uses the SQL Server Pubs database to illustrate use of the <b>AbsolutePosition</b> property as a secondary letter index to a set of rows. The program begins by fetching the name and ID of all publishers into a dropdown <b>ComboBox</b> control. Initially, and as a specific publisher is chosen from the <b>ComboBox</b>, the set of titles for this publisher is fetched from the Titles table. This is accomplished by creating a query using the concatenation method and setting the <b>RemoteData</b> control's SQL property to this query. A <b>DataGrid</b> control is bound to the <b>RemoteData</b> control, so it reflects the current set of titles based on the publisher chosen. In the process of populating the result set, the first letter of each title is placed in an array along with the <b>AbsolutePosition</b> value for the row. When a letter is chosen and the MoveToRow button is clicked, the <b>RemoteData</b> control's <b>AbsolutePosition</b> property is set to the value associated with the letter.</p>
<pre><code>Dim cn As rdoConnection
Dim en As rdoEnvironment
Dim rs As rdoResultset
Dim LetterIndex() As Long

Private Sub Form_Load()
Dim Li As Integer
'
'&nbsp;&nbsp; Open the connection. This is a DSN-less Connection
'
Set en = rdoEnvironments(0)
Set cn = en.OpenConnection(dsName:="", _
 &nbsp;&nbsp; Prompt:=rdDriverNoPrompt, _
 &nbsp;&nbsp; Connect:="uid=;pwd=;driver={SQL Server};" _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; "server=SEQUEL;database=pubs;")

MsRdc1.Connect = cn.Connect

'
'&nbsp;&nbsp; Fill Publishers list combo box.
'
Set rs = cn.OpenResultset _
 &nbsp;&nbsp; ("Select distinct Pub_Name, Pub_ID" _
   &amp; " from Publishers",&nbsp; _
   rdOpenStatic, rdConcurReadOnly)
Do Until rs.EOF
 &nbsp;&nbsp; If rs(0) = Null Then
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PubList.AddItem " " _
         &amp; rs!Pub_ID &amp; ":" &amp; rs!Pub_Name
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; rs.MoveNext
Loop
PubList.ListIndex = 1
rs.Close

PubList_Click ' Make the first query

End Sub

Sub GetLetterIndexes()
'
'   Build an index array for the first
'   occurance of a letter in the list
'   of titles. Save an <span class=cfe><b>AbsolutePosition</b></span>
'   for each letter.

ReDim LetterIndex(122) As Long
Screen.MousePointer = vbHourglass

Set rs = MsRdc1.Resultset
Do Until rs.EOF
 &nbsp;&nbsp; Li = Convert(Left$(rs!Title, 1))
 &nbsp;&nbsp; If LetterIndex(Li) = 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LetterIndex(Li) = rs.<span class=cfe><b>AbsolutePosition</b></span>
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; rs.MoveNext
Loop

Screen.MousePointer = vbDefault
End Sub
'
'   Position the RemoteData control's 
'   rdoResultset to the first row of the letter
'   chosen based on the <span class=cfe><b>AbsolutePosition</b></span>
'
Private Sub MoveToRow_Click()
Dim i
i = Convert(LetterWanted)
If LetterIndex(i) &gt; 0 Then
 &nbsp;&nbsp; MsRdc1.Resultset.<span class=cfe><b>AbsolutePosition</b></span> = LetterIndex(i)
Else
 &nbsp;&nbsp; LetterWanted = "(Not Found)"
 &nbsp;&nbsp; Beep
 &nbsp;&nbsp; For i = i + 1 To Asc("z")
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If LetterIndex(i) &gt; 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsRdc1.Resultset.<span class=cfe><b>AbsolutePosition</b></span> = _                   LetterIndex(i)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LetterWanted = Chr(i + 64)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit For
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp; Next i
End If
End Sub

Private Function Convert(Li As String) As Integer
Dim i As Integer
i = Asc(Li) ' Only references first letter
Select Case i
 &nbsp;&nbsp; Case Is &lt; 65: Convert = 0
 &nbsp;&nbsp; Case Is &gt; 122: Convert = 58
 &nbsp;&nbsp; Case Else: Convert = i - 64
End Select
End Function
'
'   Fetch List of Titles for this 
'   publisher
'
Private Sub PubList_Click()
Dim PubWanted As String
'   Pick off the PUB_ID
'
'   Build the SQL Query based on
'   publisher chosen
'
PubWanted = Trim(Left(PubList,&nbsp; 
   InStr(PubList, ":") - 1))
Screen.MousePointer = vbHourglass

MsRdc1.SQL = "select * from Titles" _
 &nbsp;&nbsp; &amp; " where Pub_ID = '" _
 &nbsp;&nbsp; &amp; PubWanted &amp; "'" _
 &nbsp;&nbsp; &amp; " order by Title"
MsRdc1.Refresh
Screen.MousePointer = vbDefault
If MsRdc1.Resultset.EOF Then
 &nbsp;&nbsp; MoveToRow.Enabled = False
Else
 &nbsp;&nbsp; MoveToRow.Enabled = True
 &nbsp;&nbsp; GetLetterIndexes
 &nbsp;&nbsp; MsRdc1.Resultset.MoveFirst
End If
End Sub
</code></pre>
</BODY>
</HTML>
