<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Requery Method Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdprorequeryx"></a>Requery Method Example</h1>
<p>
The following example illustrates use of the <b>Requery</b> method to re-execute an <b>rdoQuery</b>. Note that the <b>rdoResultset</b> is created only at form load and only re-executed on each invocation of the <b>Requery</b> method.</p>
<pre><code>Option Explicit
Dim Cn As New rdoConnection
Dim Rs As rdoResultset
Dim Col As rdoColumn
Dim Qy As rdoQuery
Dim SQL As String
Dim TimeExpected As Single
Dim Ts As Single, Tn As Single


Private Sub SpWho_Click()
Rs.Cancel
With Rs
   .Requery
   While .StillExecuting
      SpinGlobe
      DoEvents
   Wend
   ShowRS
End With

End Sub
Sub ShowRS()
With Rs
   Form1.Cls
   For Each Col In .rdoColumns
      Print Col.Name,
   Next
   Print
   Do Until .EOF
      For Each Col In .rdoColumns
         Print Col,
      Next
      Print
      .MoveNext
   Loop
End With
End Sub
Sub SpinGlobe()
' Animate a globe here to show query is in progress.
Print ".";
End Sub

Private Sub Form_Load()
With Cn
   .Connect = "UID=;PWD=;Database=WorkDB;" _
   &amp; "Server=sequel;Driver={SQL Server}" _
   &amp; "DSN='';"
   .LoginTimeout = 5
   .EstablishConnection rdDriverNoPrompt, True
   Set Qy = .<span class=cfe><b>CreateQuery</b></span>("SpWho", _
   "{ call master..sp_who (?) }")
   Qy.RowsetSize = 1
   Set Rs = Qy.OpenResultset(rdOpenForwardOnly, _
   rdConcurReadOnly, rdAsyncEnable)
   Show
   ShowRS
End With
End Sub
</code></pre>
</BODY>
</HTML>
