<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PercentPosition Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdpropercentpositionx"></a>PercentPosition Property Example</h1>
<p>
This example illustrates use of the <b>PercentPosition</b> property. In this example a list of publishers is generated and when one of these is chosen, a list of associated titles is displayed in a <b>DataGrid</b> control. When the scroll bar associated with the grid is manipulated, the relative location of the selected row is determined by examining the <b>PercentPosition</b> property and displayed. See the <b>AbsolutePosition</b> property example for further details on this example.</p>
<pre><code>Dim rs As rdoResultset

Private Sub Form_Load()
Dim Li As Integer
'
'&nbsp;&nbsp; Fill Sections list combo box.
'
Set en = rdoEnvironments(0)
Set cn = en.OpenConnection(dsName:="", _
 &nbsp;&nbsp; Prompt:=rdDriverNoPrompt, _
 &nbsp;&nbsp; Connect:="uid=;pwd=;driver={SQL Server};" _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; "server=BETAV486;database=pubs;")

MsRdc1.Connect = cn.Connect

Set rs = cn.OpenResultset _
 &nbsp;&nbsp; ("Select distinct Pub_Name, Pub_ID from Publishers", rdOpenStatic, rdConcurReadOnly)
Do Until rs.EOF
 &nbsp;&nbsp; If rs(0) = Null Then
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PubList.AddItem " " &amp; rs!Pub_ID &amp; ":" &amp; rs!Pub_Name
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; rs.MoveNext
Loop
PubList.ListIndex = 1
rs.Close

Publist_Click


End Sub

Private Sub MoveCRow_Change()
MoveCRow_Scroll
End Sub

Private Sub MoveCRow_Scroll()
PercentPoint = MoveCRow.Value &amp; "%"
MsRdc1.Resultset.<span class=cfe><b>PercentPosition</b></span> = MoveCRow.Value
End Sub

Private Sub Publist_Click()
SetSQL
If MsRdc1.Resultset.EOF Then
 &nbsp;&nbsp; MoveCRow.Enabled = False
Else
 &nbsp;&nbsp; MoveCRow.Enabled = True
 &nbsp;&nbsp; MsRdc1.Resultset.MoveFirst
End If
End Sub

Sub SetSQL()
Dim PubWanted As String
PubWanted = Trim(Left(PubList, InStr(PubList, ":") - 1))
Screen.MousePointer = vbHourglass

MsRdc1.SQL = "select * from Titles" _
 &nbsp;&nbsp; &amp; " where Pub_ID = '" _
 &nbsp;&nbsp; &amp; PubWanted &amp; "'" _
 &nbsp;&nbsp; &amp; " order by Title"
MsRdc1.Refresh
Screen.MousePointer = vbDefault
End Sub
</code></pre>
</BODY>
</HTML>
