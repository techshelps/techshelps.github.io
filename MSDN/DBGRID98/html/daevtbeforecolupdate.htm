<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BeforeColUpdate Event</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="daevtbeforecolupdate"></a>BeforeColUpdate Event</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daevtBeforeColUpdate_C;daevtBeforeColUpdateC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daevtBeforeColUpdate_X;daevtBeforeColUpdateX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daevtBeforeColUpdate_A;daevtBeforeColUpdateA;vbctlDataGridControl">
</object></p>
<p>
Occurs after editing is completed in a cell, but before data is moved from the cell to the <b>DataGrid</b> control's copy buffer.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_BeforeColUpdate</b> <b>(</b>[<b> </b><i>index</i><b> As Integer</b>,]<b> </b><i>colindex</i> <b>As Integer</b>,<b> </b><i>oldvalue</i><b> As Variant</b>, <i>cancel</i><b> As Integer)</b></p>
<p>
The BeforeColUpdate event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Part</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><i>object</i></td>
<td width=71%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=29%><i>index</i></td>
<td width=71%>An integer that identifies a control if it is in a <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcontrolarray">
</object><a href=JavaScript:alink_5.Click()>control array</a>.</td>
</tr>
<tr valign=top>
<td width=29%><i>colindex</i></td>
<td width=71%>An integer that identifies the column.</td>
</tr>
<tr valign=top>
<td width=29%><i>oldvalue</i></td>
<td width=71%>A value that contains the value contained in the cell prior to the change. </td>
</tr>
<tr valign=top>
<td width=29%><i>cancel</i></td>
<td width=71%>A <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defboolean">
</object><a href=JavaScript:alink_6.Click()>Boolean expression</a> expression that specifies whether the change occurs, as described in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>cancel</i> are:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Setting</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><b>True</b></td>
<td width=71%>Cancels the change, restores cell to <i>oldvalue</i>, and restores focus to the control.</td>
</tr>
<tr valign=top>
<td width=29%><b>False</b></td>
<td width=71%>(Default) Continues with change and permits change of focus.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The data specified by the o<i>ldvalue</i> argument moves from the cell to the control's copy buffer when a user completes editing within a cell, as when tabbing to another column in the same row, pressing ENTER, or changing focus away from the cell. Before the data has been moved from the cell into the control's copy buffer, the BeforeColUpdate event is triggered. This event gives your application an opportunity to check the individual grid cells before they are committed to the control's copy buffer.</p>
<p>
If your event procedures set the <i>cancel</i> argument to <b>True</b>, the previous value is restored in the cell and focus remains on the control and the AfterColUpdate event is not triggered.</p>
<p>
To restore <i>oldvalue</i> in the cell and permit the user to move focus off of the cell, set <i>cancel</i> to <b>False</b> and set the cell to <i>oldvalue</i> as follows:</p>
<pre><code>Cancel = False
DataGrid1.Columns(ColIndex).Value = OldValue
</code></pre>
<p>
The AfterColUpdate event occurs after the BeforeColUpdate event.</p>
<p>
By setting the <i>cancel</i> argument to <b>True</b>, the user can not move the focus from the control until the application determines that the data can be safely moved back to the control's copy buffer.</p>
</BODY>
</HTML>
