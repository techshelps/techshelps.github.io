<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL to C: Timestamp</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsql_to_c__timestamp"></a>SQL to C: Timestamp</h1>
<p>
The identifier for the timestamp ODBC SQL data type is:</p>
<p>
SQL_TYPE_TIMESTAMP</p>
<p>
The following table shows the ODBC C data types to which timestamp SQL data may be converted. For an explanation of the columns and terms in the table, see “<a href="odappdpr_4o4z.htm">Converting Data from SQL to C Data Types</a>.”</p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows width=606>
<tr valign=top>
<td class=label width=26%><b><br>
C type identifier</b></td>
<td class=label width=26%><b><br>
Test</b></td>
<td class=label width=19%><b><br>
*<i>TargetValuePtr</i></b></td>
<td class=label width=18%><b>*<i>StrLen_or<br>
_IndPtr</i></b></td>
<td class=label width=11%><b>SQL-<br>
STATE</b></td>
</tr>
<tr valign=top>
<td width=26%>SQL_C_CHAR</td>
<td width=26%><i>BufferLength</i> &gt; Character byte length<p>
20 &lt;= <i>BufferLength</i> &lt;= Character byte length</p>
<p>
<i>BufferLength</i> &lt; 20</p>
</td>
<td width=19%>Data<br>
<p>
Truncated <br>
data [b]</p>
<p>
Undefined</p>
</td>
<td width=18%>Length of data in bytes<p>
Length of data in bytes</p>
<p>
Undefined</p>
</td>
<td width=11%>n/a<br>
<p>
01004<br>
</p>
<p>
22003</p>
</td>
</tr>
<tr valign=top>
<td width=26%>SQL_C_WCHAR</td>
<td width=26%><i>BufferLength</i> &gt; Character length<p>
20 &lt;= <i>BufferLength</i> &lt;= Character length</p>
<p>
<i>BufferLength</i> &lt; 20</p>
</td>
<td width=19%>Data<br>
<p>
Truncated <br>
data [b]</p>
<p>
Undefined</p>
</td>
<td width=18%>Length of data in characters<p>
Length of data in characters</p>
<p>
Undefined</p>
</td>
<td width=11%>n/a<br>
<p>
01004<br>
</p>
<p>
22003</p>
</td>
</tr>
<tr valign=top>
<td width=26%>SQL_C_BINARY</td>
<td width=26%>Byte length of data &lt;= <i>BufferLength</i><p>
Byte length of data &gt; <i>BufferLength</i></p>
</td>
<td width=19%>Data<br>
<p>
Undefined</p>
</td>
<td width=18%>Length of data in bytes<p>
Undefined</p>
</td>
<td width=11%>n/a<br>
<p>
22003</p>
</td>
</tr>
<tr valign=top>
<td width=26%>SQL_C_TYPE_DATE</td>
<td width=26%>Time portion of timestamp is zero [a]<p>
Time portion of timestamp is non-zero [a]</p>
</td>
<td width=19%>Data<br>
<p>
Truncated <br>
data [c]</p>
</td>
<td width=18%>6 [f]<br>
<p>
6 [f]</p>
</td>
<td width=11%>n/a<br>
<p>
01S07</p>
</td>
</tr>
<tr valign=top>
<td width=26%>SQL_C_TYPE_TIME</td>
<td width=26%>Fractional seconds portion of timestamp is zero [a]<p>
Fractional seconds portion of timestamp is non-zero [a]</p>
</td>
<td width=19%>Data [d]<br>
<p>
Truncated <br>
data [d], [e]</p>
</td>
<td width=18%>6 [f]<br>
<p>
6 [f]</p>
</td>
<td width=11%>n/a<br>
<p>
01S07</p>
</td>
</tr>
<tr valign=top>
<td width=26%>SQL_C_TYPE_<br>
TIMESTAMP</td>
<td width=26%>Fractional seconds portion of timestamp is not truncated [a]<p>
Fractional seconds portion of timestamp is truncated [a]</p>
</td>
<td width=19%>Data [e]<br>
<br>
<p>
Truncated data [e]</p>
</td>
<td width=18%>16 [f]<br>
<br>
<p>
16 [f]</p>
</td>
<td width=11%>n/a<br>
<br>
<p>
01S07</p>
</td>
</tr>
</table><br>
<p class=mini>
[a]The value of <i>BufferLength</i> is ignored for this conversion. The driver assumes that the size of *<i>TargetValuePtr</i> is the size of the C data type.</p>
<p class=mini>
[b]The fractional seconds of the timestamp are truncated.</p>
<p class=mini>
[c]The time portion of the timestamp is truncated.</p>
<p class=mini>
[d]The date portion of the timestamp is ignored.</p>
<p class=mini>
[e]The fractional seconds portion of the timestamp is truncated.</p>
<p class=mini>
[f]This is the size of the corresponding C data type.</p>
<p>
When timestamp SQL data is converted to character C data, the resulting string is in the “<i>yyyy</i>-<i>mm</i>-<i>dd</i> <i>hh</i>:<i>mm</i>:<i>ss</i>[.<i>f...</i>]” format, where up to nine digits may be used for fractional seconds. This format is not affected by the Windows country setting. (Except for the decimal point and fractional seconds, the entire format must be used, regardless of the precision of the timestamp SQL data type.)</p>
</font></BODY>
</HTML>
