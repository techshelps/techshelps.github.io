<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLRemoveDSNFromIni</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlremovedsnfromini"></a>SQLRemoveDSNFromIni</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 1.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLRemoveDSNFromIni</b> removes a data source from the system information.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLRemoveDSNFromIni</b>(<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszDSN</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpszDSN</i></p>
<p class=indent>
[Input]<br>
Name of the data source to remove.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it removes the data source or the data source was not in the ODBC.INI file. It returns FALSE if it fails to remove the data source.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLRemoveDSNFromIni</b> returns FALSE, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=26%><b><i>*pfErrorCode</i></b></td>
<td class=label width=25%><b>Error</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=25%>General installer error</td>
<td width=49%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
INVALID_DSN</td>
<td width=25%>Invalid DSN</td>
<td width=49%>The <i>lpszDSN</i> argument was invalid.</td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
REQUEST_<br>
FAILED</td>
<td width=25%>Request failed</td>
<td width=49%>The installer could not remove the DSN info from the registry.</td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
OUT_OF_MEM</td>
<td width=25%>Out of memory</td>
<td width=49%>The installer could not perform the function because of a lack of memory.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLRemoveDSNFromIni</b> removes the data source name from the [ODBC Data Sources] section of the system information. It also removes the data source specification section from the system information.</p>
<p>
This function should only be called from a driver setup library.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Adding, modifying, or removing a data source</td>
<td width=52%><a href="odch22pr_786m.htm">ConfigDSN</a></td>
</tr>
<tr valign=top>
<td width=48%>Adding, modifying, or removing a data source</td>
<td width=52%><a href="odch23pr_3kit.htm">SQLConfigDataSource</a></td>
</tr>
<tr valign=top>
<td width=48%>Removing the default data source</td>
<td width=52%><a href="odch23pr_2c2t.htm">SQLRemoveDefaultDataSource</a></td>
</tr>
<tr valign=top>
<td width=48%>Adding a data source name to the system information</td>
<td width=52%><a href="odch23pr_5mjt.htm">SQLWriteDSNToIni</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
