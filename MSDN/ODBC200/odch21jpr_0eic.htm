<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLRowCount</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlrowcount"></a>SQLRowCount</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 1.0<br>
Standards Compliance:ISO 92</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLRowCount</b> returns the number of rows affected by an <b>UPDATE</b>, <b>INSERT</b>, or <b>DELETE</b> statement, an SQL_ADD, SQL_UPDATE_BY_BOOKMARK, or SQL_DELETE_BY_BOOKMARK operation in <b>SQLBulkOperations, </b>or an SQL_UPDATE or SQL_DELETE operation in <b>SQLSetPos</b>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLRowCount</b>(<br>
SQLHSTMT<i>StatementHandle</i>,<br>
SQLINTEGER *<i>RowCountPtr</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>StatementHandle</i></p>
<p class=indent>
[Input]<br>
Statement handle.</p>
<p class=dt>
<i>RowCountPtr</i></p>
<p class=indent>
[Output]<br>
Points to a buffer in which to return a row count. For <b>UPDATE</b>, <b>INSERT</b>, and <b>DELETE</b> statements, for the SQL_ADD, SQL_UPDATE_BY_BOOKMARK, and SQL_DELETE_BY_BOOKMARK operations in <b>SQLBulkOperations,</b> and for the SQL_UPDATE or SQL_DELETE operations in <b>SQLSetPos</b>, the value returned in *<i>RowCountPtr</i> is the number of rows affected by the request or –1 if the number of affected rows is not available. </p>
<p class=tl>
When <b>SQLExecute</b>, <b>SQLExecDirect</b>, <b>SQLBulkOperations</b>, <b>SQLSetPos, or SQLMoreResults</b> is called, the SQL_DIAG_ROW_COUNT field of the diagnostic data structure is set to the row count, and the row count is cached in an implementation-dependent way. <b>SQLRowCount</b> returns the cached row count value. The cached row count value is valid until the statement handle is set back to the prepared or allocated state, the statement is reexecuted, or <b>SQLCloseCursor</b> is called. Note that if a function has been called since the SQL_DIAG_ROW_COUNT field was set, the value returned by <b>SQLRowCount </b>might be different from the value in the SQL_DIAG_ROW_COUNT field, because the SQL_DIAG_ROW_COUNT field is reset to 0 by any function call.</P><p class=tl>
For other statements and functions, the driver may define the value returned in *<i>RowCountPtr</i>. For example, some data sources may be able to return the number of rows returned by a <b>SELECT</b> statement or a catalog function before fetching the rows.</P><p class=atl>
<B><b>Note</b></B> Many data sources cannot return the number of rows in a result set before fetching them; for maximum interoperability, applications should not rely on this behavior. </p><p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLRowCount </b>returns SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value can be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_STMT and a <i>Handle</i> of <i>StatementHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLRowCount</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation error</td>
<td width=52%>The driver was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=22%>HY010</td>
<td width=26%>Function sequence error</td>
<td width=52%>(DM) The function was called prior to calling <b>SQLExecute</b>, <b>SQLExecDirect</b>, <b>SQLBulkOperations</b>, or <b>SQLSetPos</b> for the <i>StatementHandle</i>.<p>
(DM) An asynchronously executing function was called for the <i>StatementHandle</i> and was still executing when this function was called.</p>
<p>
(DM) <b>SQLExecute</b>, <b>SQLExecDirect</b>, <b>SQLBulkOperations</b>, or <b>SQLSetPos</b> was called for the <i>StatementHandle</i> and returned SQL_NEED_DATA. This function was called before data was sent for all data-at-execution parameters or columns.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HYT01</td>
<td width=26%>Connection timeout expired</td>
<td width=52%>The connection timeout period expired before the data source responded to the request. The connection timeout period is set through <b>SQLSetConnectAttr</b>, SQL_ATTR_CONNECTION_TIMEOUT.</td>
</tr>
<tr valign=top>
<td width=22%>IM001</td>
<td width=26%>Driver does not support this function</td>
<td width=52%>(DM) The driver associated with the <i>StatementHandle</i> does not support the function.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
If the last SQL statement executed on the statement handle was not an <b>UPDATE</b>, <b>INSERT</b>, or <b>DELETE</b> statement, or the <i>Operation</i> argument in the previous call to <b>SQLBulkOperations</b> was not SQL_ADD, SQL_UPDATE_BY_BOOKMARK, or SQL_DELETE_BY_BOOKMARK, or the <i>Operation</i> argument in the previous call to <b>SQLSetPos</b> was not SQL_UPDATE or SQL_DELETE, the value of *<i>RowCountPtr </i>is driver-defined. For more information, see “<a href="odch12pr_7lwz.htm">Determining the Number of Affected Rows</a>” in Chapter 12, “Updating Data.”</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>  Executing an SQL statement</td>
<td width=52%><a href="odch21epr_35x0.htm">SQLExecDirect</a></td>
</tr>
<tr valign=top>
<td width=48%>  Executing a prepared SQL statement</td>
<td width=52%><a href="odch21epr_0yg5.htm">SQLExecute</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
