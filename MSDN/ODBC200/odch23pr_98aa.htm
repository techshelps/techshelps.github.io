<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLConfigDriver</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlconfigdriver"></a>SQLConfigDriver</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 2.5</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLConfigDriver</b> loads the appropriate driver setup DLL and calls the <b>ConfigDriver</b> function.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLConfigDriver</b> (<br>
&nbsp;&nbsp;&nbsp;HWND&nbsp;&nbsp;&nbsp;<i>hwndParent</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>fRequest</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszDriver</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszArgs</i>,<br>
&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;&nbsp;<i>lpszMsg</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>cbMsgMax</i>,<br>
&nbsp;&nbsp;&nbsp;WORD *&nbsp;&nbsp;&nbsp;<i>pcbMsgOut</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>hwndParent</i></p>
<p class=indent>
[Input]<br>
Parent window handle. The function will not display any dialog boxes if the handle is null.</p>
<p class=dt>
<i>fRequest</i></p>
<p class=indent>
[Input]<br>
Type of request. <i>fRequest</i> must contain one of the following values:</p>
<p class=tl>
ODBC_CONFIG_DRIVER: Changes the connection pooling timeout used by the driver.</P><p class=tl>
ODBC_INSTALL_DRIVER: Installs a new driver.</P><p class=tl>
ODBC_REMOVE_DRIVER: Removes an existing driver.</P><p class=tl>
This option can also be driver-specific, in which case the <i>fRequest</i> for the first option must start from ODBC_CONFIG_DRIVER_MAX+1. The <i>fRequest</i> for any additional option must also start from a value greater than ODBC_CONFIG_DRIVER_MAX+1.</P><p class=dt>
<i>lpszDriver</i></p>
<p class=indent>
[Input]<br>
The name of the driver as registered in the system information.</p>
<p class=dt>
<i>lpszArgs</i></p>
<p class=indent>
[Input]<br>
A null-terminated string containing arguments for a driver-specific <i>fRequest</i>.</p>
<p class=dt>
<i>lpszMsg</i></p>
<p class=indent>
[Output]<br>
A null-terminated string containing an output message from the driver setup.</p>
<p class=dt>
<i>cbMsgMax</i></p>
<p class=indent>
[Input]<br>
Length of <i>lpszMsg.</i></p>
<p class=dt>
<i>pcbMsgOut</i></p>
<p class=indent>
[Output]<br>
Total number of bytes available to return in <i>lpszMsg</i>. If the number of bytes available to return is greater than or equal to <i>cbMsgMax</i>, the output message in <i>lpszMsg</i> is truncated to <i>cbMsgMax</i> minus the null-termination character. The <i>pcbMsgOut</i> argument can be a null pointer.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it is successful, FALSE if it fails.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLConfigDriver</b> returns FALSE, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=27%><b><i>*pfErrorCode</i></b></td>
<td class=label width=24%><b>Error</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=24%>General installer error</td>
<td width=49%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
INVALID_BUFF_<br>
LEN</td>
<td width=24%>Invalid buffer length</td>
<td width=49%>The <i>lpszMsg</i> argument was invalid.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
INVALID_HWND</td>
<td width=24%>Invalid window handle</td>
<td width=49%>The <i>hwndParent</i> argument was invalid.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
INVALID_<br>
REQUEST_TYPE</td>
<td width=24%>Invalid type of request</td>
<td width=49%>The <i>fRequest</i> argument was not one of the following:<p>
ODBC_INSTALL_DRIVER<br>
ODBC_REMOVE_DRIVER</p>
<p>
The <i>fRequest</i> argument was a driver-specific option that was less than or equal to ODBC_CONFIG_DRIVER_MAX.</p>
</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
INVALID_NAME</td>
<td width=24%>Invalid driver or translator name</td>
<td width=49%>The <i>lpszDriver</i> argument was invalid. It could not be found in the registry.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
INVALID_<br>
KEYWORD_<br>
VALUE</td>
<td width=24%>Invalid keyword-value pairs</td>
<td width=49%>The <i>lpszAttributes</i> argument contained a syntax error.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
REQUEST_<br>
FAILED</td>
<td width=24%><i>Request</i> failed</td>
<td width=49%>The installer could not perform the operation requested by the <i>fRequest</i> argument. The call to <b>ConfigDriver</b> failed.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
LOAD_LIBRARY_<br>
FAILED</td>
<td width=24%>Could not load the driver or translator setup library</td>
<td width=49%>The driver setup library could not be loaded.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
OUT_OF_MEM</td>
<td width=24%>Out of memory</td>
<td width=49%>The installer could not perform the function because of a lack of memory.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLConfigDriver</b> allows an application to call a driver’s <b>ConfigDriver</b> routine without having to know the name and load the driver-specific setup DLL. A setup program calls this function after the driver setup DLL has been installed. The calling program should be aware that this function may not be available for all drivers. In such a case, the calling program should continue without error.</p>
<h1>Driver-Specific Options</h1>
<p>
An application can request driver-specific features exposed by the driver by using the <i>fRequest</i> argument. The <i>fRequest</i> for the first option will be ODBC_CONFIG_DRIVER_MAX+1, and additional options will be incremented by 1 from that value. Any arguments required by the driver for that function should be provided in a null-terminated string passed in the <i>lpszArgs</i> argument. Drivers providing such functionality should maintain a table of driver-specific options. The options should be fully documented in driver documentation. Application writers who make use of driver-specific options should be aware that this use will make the application less interoperable.</p>
<h1>Setting Connection Pooling Timeout</h1>
<p>
Connection pooling timeout properties can be set when setting the configuration of the driver. <b>SQLConfigDriver</b> is called with an <i>fRequest</i> of ODBC_CONFIG_DRIVER and <i>lpszArgs</i> set to <b>CPTimeout</b>. <b>CPTimeout</b> determines the amount of time that a connection can remain in the connection pool without being used. When the timeout expires, the connection is closed and removed from the pool. The default timeout is 60 seconds.</p>
<p>
When <b>SQLConfigDriver</b> is called with <i>fRequest</i> set to ODBC_INSTALL_DRIVER or ODBC_REMOVE_DRIVER, the Driver Manager loads the appropriate driver setup DLL and calls the <b>ConfigDriver</b> function. When <b>SQLConfigDriver</b> is called with an <i>fRequest</i> of ODBC_CONFIG_DRIVER, all processing is performed in the ODBC installer, so the driver setup DLL does not need to be loaded.</p>
<h1>Messages</h1>
<p>
A driver setup routine can send a text message to an application as null-terminated strings in the <i>lpszMsg</i> buffer. The message will be truncated to <i>cbMsgMax</i> minus the null-termination character by the <b>ConfigDriver</b> function if it is greater than or equal to <i>cbMsgMax</i> characters.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=54%><b>For information about</b></td>
<td class=label width=46%><b>See</b></td>
</tr>
<tr valign=top>
<td width=54%>Adding, modifying, or removing a driver</td>
<td width=46%><a href="odch22pr_29wy.htm">ConfigDriver</a><b> </b>(in the setup DLL)</td>
</tr>
<tr valign=top>
<td width=54%>Removing the default data source</td>
<td width=46%><a href="odch23pr_2c2t.htm">SQLRemoveDefaultDataSource</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
