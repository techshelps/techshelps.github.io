<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Behavioral Changes</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcbehavioral_changes"></a>Behavioral Changes</h2>
<p>
Behavioral changes are those changes for which the <i>syntax</i> of the interface remains the same, but the <i>semantics</i> have changed. For these changes, functionality used in ODBC 2.<i>x </i>behaves differently than the same functionality in ODBC 3.<i>x</i>.</p>
<p>
Whether an application exhibits ODBC 2.<i>x</i> behavior or ODBC 3.<i>x</i> behavior is determined by the SQL_ATTR_ODBC_VERSION environment attribute. This 32-bit value is set to SQL_OV_ODBC2 to exhibit ODBC 2.<i>x</i> behavior, and SQL_OV_ODBC3 to exhibit ODBC 3.<i>x</i> behavior.</p>
<p>
The SQL_ATTR_ODBC_VERSION environment attribute is set by a call to <b>SQLSetEnvAttr</b>. When an application calls <b>SQLAllocHandle</b> to allocate an environment handle, then it must call<i> </i><b>SQLSetEnvAttr</b> immediately to set the behavior it exhibits. (As a result, there is a new environment state to describe the environment handle in an allocated, but versionless state.) For more information, see Appendix B, "<a href="odappbpr_5v3n.htm">ODBC State Transition Tables</a>."</p>
<p>
An application states what behavior it exhibits with the SQL_ATTR_ODBC_VERSION environment attribute, but the attribute has no effect on the application's connection with an ODBC 2.<i>x</i> or ODBC 3.<i>x</i> driver. An ODBC 3.<i>x</i> application will be able to connect to either an ODBC 2.<i>x </i>or 3.<i>x</i> driver, no matter what the setting of the environment attribute.</p>
<p>
ODBC 3.<i>x</i> applications should never call <b>SQLAllocEnv</b>. As a result, if the Driver Manager receives a call to <b>SQLAllocEnv</b>, it recognizes the application as an ODBC 2.<i>x </i>application.</p>
<p>
The SQL_ATTR_ODBC_VERSION attribute affects three different aspects of an ODBC 3.<i>x</i> driver's behavior:
<ul type=disc>
<li>
SQLSTATEs<br><br></li>
<li>
Data types for date, time, and timestamp<br><br></li>
<li>
The <i>CatalogName</i> argument in <b>SQLTables</b> accepts search patterns in ODBC 3.<i>x</i>, but not in ODBC 2.<i>x</i></li>
</ul>
<p>
The setting of the SQL_ATTR_ODBC_VERSION environment attribute does not affect <b>SQLSetParam</b> or <b>SQLBindParam</b>. <b>SQLColAttribute</b> is also not affected by this bit. Although <b>SQLColAttribute</b> returns attributes that are affected by the version of ODBC (date type, precision, scale and length), the intended behavior is determined by the value of the <i>FieldIdentifier</i> argument. When <i>FieldIdentifier </i>is equal to SQL_DESC_TYPE, <b>SQLColAttribute</b> returns the ODBC 3.<i>x</i> codes for date, time, and timestamp; when <i>FieldIdentifier</i> is equal to SQL_COLUMN_TYPE, <b>SQLColAttribute</b> returns the ODBC 2.<i>x </i>codes for date, time, and timestamp.</p>
</font></BODY>
</HTML>
