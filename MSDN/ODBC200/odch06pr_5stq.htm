<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Driver-Specific Connection Information</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbcdriver_specific_connection_information"></a>Driver-Specific Connection Information</h3>
<p>
<b>SQLConnect</b> assumes that a data source name, user ID, and password are sufficient to connect to a data source and that all other connection information can be stored on the system. This is often not the case. For example, a driver might need one user ID and password to log into a server and a different user ID and password to log into a DBMS. Because <b>SQLConnect</b> accepts a single user ID and password, this means that the other user ID and password must be stored with the data source information on the system if <b>SQLConnect</b> is to be used. This is a potential breach of security and should be avoided unless the password is encrypted.</p>
<p>
<b>SQLDriverConnect</b> allows the driver to define an arbitrary amount of connection information in the keyword-value pairs of the connection string. For example, suppose a driver requires a data source name, a user ID and password for the server, and a user ID and password for the DBMS. A custom program that always uses the XYZ Corp data source might prompt the user for IDs and passwords and build the following set of keyword-value pairs, or <i>connection string</i>, to pass to <b>SQLDriverConnect</b>:</p>
<pre><code>DSN=XYZ Corp;UID=Gomez;PWD=Sesame;UIDDBMS=JGomez;PWDDBMS=Shazam;
</code></pre>
<p>
The <b>DSN</b> (Data Source Name) keyword names the data source, the <b>UID</b> and <b>PWD</b> keywords specify the user ID and password for the server, and the <b>UIDDBMS</b> and <b>PWDDBMS</b> keywords specify the user ID and password for the DBMS. Note that the final semicolon is optional. <b>SQLDriverConnect</b> parses this string; uses the XYZ Corp data source name to retrieve additional connection information from the system, such as the server address; and logs on to the server and DBMS using the specified user IDs and passwords.</p>
<p>
Keyword-value pairs in <b>SQLDriverConnect</b> must follow certain syntax rules. The keywords and their values should not contain the <b>[]{}(),;?*=!@</b> characters. The value of the <b>DSN</b> keyword cannot consist only of blanks, and should not contain leading blanks. Because of the registry grammar, keywords and data source names cannot contain the backslash (\) character. Spaces are not allowed around the equal sign in the keyword-value pair.</p>
<p>
The <b>FILEDSN</b> keyword can be used in a call to <b>SQLDriverConnect</b> to specify the name of a file containing data source information (see “<a href="odch06pr_16lv.htm">Connecting Using File Data Sources</a>” later in this section). The <b>SAVEFILE</b> keyword can be used to specify the name of a .dsn file in which the keyword-value pairs of a successful connection made by the call to <b>SQLDriverConnect</b> will be saved. For more information on file data sources, see the <a href="odch21dpr_4ed0.htm">SQLDriverConnect</a> function description.</p>
</font></BODY>
</HTML>
