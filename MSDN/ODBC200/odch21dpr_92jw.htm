<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLDescribeCol</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqldescribecol"></a>SQLDescribeCol</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 1.0<br>
Standards Compliance:ISO 92</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLDescribeCol</b> returns the result descriptor — column name<b>, </b>type, column size, decimal digits, and nullability — for one column in the result set. This information also is available in the fields of the IRD.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLDescribeCol</b>(<br>
SQLHSTMT<i>StatementHandle</i>,<br>
SQLSMALLINT<i>ColumnNumber</i>,<br>
SQLCHAR *<i>ColumnName</i>,<br>
SQLSMALLINT<i>BufferLength</i>,<br>
SQLSMALLINT *<i>NameLengthPtr</i>,<br>
SQLSMALLINT *<i>DataTypePtr</i>,<br>
SQLUINTEGER *<i>ColumnSizePtr</i>,<br>
SQLSMALLINT *<i>DecimalDigitsPtr</i>,<br>
SQLSMALLINT *<i>NullablePtr</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>StatementHandle</i></p>
<p class=indent>
[Input]<br>
Statement handle.</p>
<p class=dt>
<i>ColumnNumber</i></p>
<p class=indent>
[Input]<br>
Column number of result data, ordered sequentially in increasing column order, starting at 1. The <i>ColumnNumber</i> argument can also be set to 0 to describe the bookmark column.</p>
<p class=dt>
<i>ColumnName</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the column name. This value is read from the SQL_DESC_NAME field of the IRD. If the column is unnamed or the column name cannot be determined, the driver returns an empty string.</p>
<p class=dt>
<i>BufferLength</i></p>
<p class=indent>
[Input]<br>
Length of the *<i>ColumnName</i> buffer, in bytes. If the <i>*ColumnName</i> value is a Unicode string (when calling <b>SQLDescribeColW</b>), the <i>BufferLength</i> argument must be an even number.</p>
<p class=dt>
<i>NameLengthPtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the total number of bytes (excluding the null-termination byte) available to return in *<i>ColumnName</i>. If the number of bytes available to return is greater than or equal to <i>BufferLength</i>, the column name in *<i>ColumnName</i> is truncated to <i>BufferLength</i> minus the length of a null-termination character.</p>
<p class=dt>
<i>DataTypePtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the SQL data type of the column. This value is read from the SQL_DESC_CONCISE_TYPE field of the IRD. This will be one of the values in the “<a href="odappdpr_8fcj.htm">SQL Data Types</a>” section of Appendix D, “Data Types,” or a driver-specific SQL data type. If the data type cannot be determined, the driver returns SQL_UNKNOWN_TYPE.</p>
<p class=tl>
In ODBC 3.x, SQL_TYPE_DATE, SQL_TYPE_TIME, or SQL_TYPE_TIMESTAMP is returned in <i>*DataTypePtr</i> for date, time, or timestamp data, respectively; in ODBC 2<i>.x</i>, SQL_DATE, SQL_TIME, or SQL_TIMESTAMP is returned. The Driver Manager performs the required mappings when an ODBC 2.<i>x</i> application is working with an ODBC 3.x driver, or an ODBC 3.x application is working with an ODBC 2.<i>x</i> driver.</P><p class=tl>
When <i>ColumnNumber</i> is equal to 0 (for a bookmark column), SQL_BINARY is returned in <i>*DataTypePtr</i> for variable-length bookmarks. (SQL_INTEGER is returned if bookmarks are used by an ODBC 3.x application working with an ODBC 2.<i>x</i> driver, or an ODBC 2.<i>x</i> application working with an ODBC 3.x driver.)</P><p class=tl>
For more information on these data types, see “<a href="odappdpr_8fcj.htm">SQL Data Types</a>” in Appendix D, “Data Types.” For information about driver-specific SQL data types, see the driver’s documentation.</P><p class=dt>
<i>ColumnSizePtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the size of the column on the data source. If the column size cannot be determined, the driver returns 0. For more information on column size, see “<a href="odappdpr_7ch1.htm">Column Size, Decimal Digits, Transfer Octet Length, and Display Size</a>” in Appendix D, “Data Types.”</p>
<p class=dt>
<i>DecimalDigitsPtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the number of decimal digits of the column on the data source. If the number of decimal digits cannot be determined or is not applicable, the driver returns 0. For more information on decimal digits, see “<a href="odappdpr_7ch1.htm">Column Size, Decimal Digits, Transfer Octet Length, and Display Size</a>” in Appendix D, “Data Types.”</p>
<p class=dt>
<i>NullablePtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return a value that indicates whether the column allows NULL values. This value is read from the SQL_DESC_NULLABLE field of the IRD. The value is one of the following:</p>
<p class=tl>
SQL_NO_NULLS: The column does not allow NULL values.</P><p class=tl>
SQL_NULLABLE: The column allows NULL values.</P><p class=tl>
SQL_NULLABLE_UNKNOWN: The driver cannot determine if the column allows NULL values.</P><p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLDescribeCol</b> returns either SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value can be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_STMT and a <i>Handle</i> of <i>StatementHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLDescribeCol</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>01004</td>
<td width=26%>String data, right truncated</td>
<td width=52%>The buffer *<i>ColumnName</i> was not large enough to return the entire column name, so the column name was truncated. The length of the untruncated column name is returned in *<i>NameLengthPtr</i>. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>07005</td>
<td width=26%>Prepared statement not a <i>cursor-<br>
specification</i></td>
<td width=52%>The statement associated with the <i>StatementHandle</i> did not return a result set. There were no columns to describe.</td>
</tr>
<tr valign=top>
<td width=22%>07009</td>
<td width=26%>Invalid descriptor index</td>
<td width=52%>(DM) The value specified for the argument <i>ColumnNumber</i> was equal to 0, and the SQL_ATTR_USE_BOOKMARKS statement option was SQL_UB_OFF.<p>
The value specified for the argument <i>ColumnNumber</i> was greater than the number of columns in the result set.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>08S01</td>
<td width=26%>Communication link failure</td>
<td width=52%>The communication link between the driver and the data source to which the driver was connected failed before the function completed processing.</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation failure</td>
<td width=52%>The driver was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=22%>HY008</td>
<td width=26%>Operation canceled</td>
<td width=52%>Asynchronous processing was enabled for the <i>StatementHandle</i>. The function was called and, before it completed execution, <b>SQLCancel</b> was called on the <i>StatementHandle</i>. Then the function was called again on the <i>StatementHandle</i>.<p>
The function was called and, before it completed execution, <b>SQLCancel</b> was called on the <i>StatementHandle</i> from a different thread in a multithread application.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY010</td>
<td width=26%>Function sequence error</td>
<td width=52%>(DM) An asynchronously executing function (not this one) was called for the <i>StatementHandle</i> and was still executing when this function was called.<p>
(DM) The function was called prior to calling <b>SQLPrepare</b>, <b>SQLExecute</b>, or a catalog function on the statement handle.</p>
<p>
(DM) <b>SQLExecute</b>, <b>SQLExecDirect</b>, <b>SQLBulkOperations</b>, or <b>SQLSetPos</b> was called for the <i>StatementHandle</i> and returned SQL_NEED_DATA. This function was called before data was sent for all data-at-execution parameters or columns.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HY090</td>
<td width=26%>Invalid string or buffer length </td>
<td width=52%>(DM) The value specified for argument <i>BufferLength</i> was less than 0.</td>
</tr>
<tr valign=top>
<td width=22%>HYT01</td>
<td width=26%>Connection timeout expired</td>
<td width=52%>The connection timeout period expired before the data source responded to the request. The connection timeout period is set through <b>SQLSetConnectAttr</b>, SQL_ATTR_CONNECTION_TIMEOUT.</td>
</tr>
<tr valign=top>
<td width=22%>IM001</td>
<td width=26%>Driver does not support this function</td>
<td width=52%>(DM) The driver associated with the <i>StatementHandle</i> does not support the function.</td>
</tr>
</table><br>
<p>
<b>SQLDescribeCol</b> can return any SQLSTATE that can be returned by <b>SQLPrepare</b> or <b>SQLExecute</b> when called after <b>SQLPrepare</b> and before <b>SQLExecute</b>, depending on when the data source evaluates the SQL statement associated with the statement handle.</p>
<p>
For performance reasons, an application should not call <b>SQLDescribeCol</b> before executing a statement.</p>
<p class=label>
<b>Comments</b></p>
<p>
An application typically calls <b>SQLDescribeCol</b> after a call to <b>SQLPrepare</b> and before or after the associated call to <b>SQLExecute</b>. An application can also call <b>SQLDescribeCol</b> after a call to <b>SQLExecDirect</b>. For more information, see “<a href="odch10pr_80dd.htm">Result Set Metadata</a>” in Chapter 10, “Retrieving Results (Basic).”</p>
<p>
<b>SQLDescribeCol</b> retrieves the column name, type, and length generated by a <b>SELECT</b> statement. If the column is an expression, *<i>ColumnName</i> is either an empty string or a driver-defined name.</p>
<p class=indent>
<B><b>Note</b></B> ODBC supports SQL_NULLABLE_UNKNOWN as an extension, even though the X/Open and SQL Access Group Call Level Interface specification does not specify the option for <b>SQLDescribeCol</b>.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Binding a buffer to a column in a result set</td>
<td width=52%><a href="odch21bpr_0ht8.htm">SQLBindCol</a></td>
</tr>
<tr valign=top>
<td width=48%>Canceling statement processing</td>
<td width=52%><a href="odch21bpr_5b58.htm">SQLCancel</a></td>
</tr>
<tr valign=top>
<td width=48%>Returning information about a column in a result set</td>
<td width=52%><a href="odch21bpr_365h.htm">SQLColAttribute</a></td>
</tr>
<tr valign=top>
<td width=48%>Fetching multiple rows of data</td>
<td width=52%><a href="odch21epr_4zoo.htm">SQLFetch</a></td>
</tr>
<tr valign=top>
<td width=48%>Returning the number of result set columns</td>
<td width=52%><a href="odch21ipr_74hf.htm">SQLNumResultCols</a></td>
</tr>
<tr valign=top>
<td width=48%>Preparing a statement for execution</td>
<td width=52%><a href="odch21ipr_3td1.htm">SQLPrepare</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
