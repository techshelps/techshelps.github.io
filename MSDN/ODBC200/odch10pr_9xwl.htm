<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLDescribeCol and SQLColAttribute</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcsqldescribecol_and_sqlcolattribute"></a>SQLDescribeCol and SQLColAttribute</h2>
<p>
<b>SQLDescribeCol</b> and <b>SQLColAttribute</b> are used to retrieve result set metadata. The difference between these two functions is that <b>SQLDescribeCol</b> always returns the same five pieces of information (a column’s name, data type, precision, scale, and nullability), while <b>SQLColAttribute</b> returns a single piece of information requested by the application. However, <b>SQLColAttribute</b> can return a much richer selection of metadata, including a column’s case sensitivity, display size, updatability, and searchability.</p>
<p>
Many applications, especially ones that only display data, only require the metadata returned by <b>SQLDescribeCol</b>. For these applications, it is faster to use <b>SQLDescribeCol</b> than <b>SQLColAttribute</b> because the information is returned in a single call. Other applications, especially ones that update data, require the additional metadata returned by <b>SQLColAttribute</b> and so use both functions. In addition, <b>SQLColAttribute</b> supports driver-specific metadata; for more information, see “<a href="odch17pr_7dbn.htm">Driver-Specific Data Types, Descriptor Types, Information Types, Diagnostic Types, and Attributes</a>” in Chapter 17, “Programming Considerations.”</p>
<p>
An application can retrieve result set metadata at any time after a statement has been prepared or executed, and before the cursor over the result set is closed. Very few applications require result set metadata after the statement is prepared and before it is executed. If possible, applications should wait to retrieve metadata until after the statement is executed. The reason is that some data sources cannot return metadata for prepared statements, and emulating this capability in the driver is often a slow process. For example, the driver might generate a zero row result set by replacing the <b>WHERE</b> clause of a <b>SELECT</b> statement with the clause <b>WHERE 1 = 2</b> and executing the resulting statement.</p>
<p>
Metadata is often expensive to retrieve from the data source. Because of this, drivers should cache any metadata they retrieve from the server and hold it for as long as the cursor over the result set is open. Also, applications should request only the metadata they absolutely need.</p>
</font></BODY>
</HTML>
