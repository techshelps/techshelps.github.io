<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLInstallDriverManager</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlinstalldrivermanager"></a>SQLInstallDriverManager</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 1.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLInstallDriverManager</b> returns the path of the target directory for the installation of the ODBC core components. The calling program must actually copy the Driver Manager’s files to the target directory.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLInstallDriverManager</b>(<br>
&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;&nbsp;<i>lpszPath</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>cbPathMax</i>,<br>
&nbsp;&nbsp;&nbsp;WORD *&nbsp;&nbsp;&nbsp;<i>pcbPathOut</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpszPath</i></p>
<p class=indent>
[Output]<br>
Path of the target directory of the installation.</p>
<p class=dt>
<i>cbPathMax</i></p>
<p class=indent>
[Input]<br>
Length of <i>lpszPath</i>. This must be at least _MAX_PATH bytes.</p>
<p class=dt>
<i>pcbPathOut</i></p>
<p class=indent>
[Output]<br>
Total number of bytes (excluding the null-termination byte) returned in <i>lpszPath</i>. If the number of bytes available to return is greater than or equal to <i>cbPathMax</i>, the path in <i>lpszPath</i> is truncated to <i>cbPathMax</i> minus the null-termination character. The <i>pcbPathOut</i> argument can be a null pointer.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it is successful, FALSE if it fails.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLInstallDriverManager</b> returns FALSE, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=27%><b><i>*pfErrorCode</i></b></td>
<td class=label width=24%><b>Error</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=24%>General installer error</td>
<td width=49%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
INVALID_BUFF_<br>
LEN</td>
<td width=24%>Invalid buffer length</td>
<td width=49%>The <i>lpszPath</i> argument was not large enough to contain the output path. The buffer contains the truncated path.<p>
The <i>cbPathMax</i> argument was less than _MAX_PATH.</p>
</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
USAGE_<br>
UPDATE_FAILED</td>
<td width=24%>Could not increment or decrement the component usage count</td>
<td width=49%>The installer failed to increment the ODBC core component usage count.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
OUT_OF_MEM</td>
<td width=24%>Out of memory</td>
<td width=49%>The installer could not perform the function because of a lack of memory.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLInstallDriverManager</b> is called to return the path for ODBC core components and increment the component usage count in the system information. If a version of the Driver Manager already exists, but the component usage count for the driver does not exist, the new component usage count value is set to 2.</p>
<p>
The application setup program is responsible for physically copying the core component files, and maintaining the file usage counts. If a core component file has not previously been installed, the application setup program must copy the file, and create the file usage count. If the file has previously been installed, the setup program merely increments the file usage count.</p>
<p>
If an older version of the Driver Manager was previously installed by the application setup program, the core components should be uninstalled, then reinstalled, so that the core component usage count is valid. <b>SQLRemoveDriverManager</b> should first be called to decrement the component usage count. <b>SQLInstallDriverManager</b> should then be called to increment the component usage count. The application setup program must physically replace the old core component files with the new files. The file usage counts will remain the same, and other applications that used the older version core component files will now use the newer version files.</p>
<p>
In a fresh install of the ODBC core components, drivers, and translators, the application setup program should call the following functions in sequence: <b>SQLInstallDriverManager</b>, <b>SQLInstallDriverEx</b>, <b>SQLConfigDriver</b> (with an <i>fRequest</i> of ODBC_INSTALL_DRIVER), then <b>SQLInstallTranslatorEx</b>. In an uninstall of the core components, drivers, and translators, the application setup program should call the following functions in sequence: <b>SQLRemoveTranslator</b>, <b>SQLRemoveDriver</b>, then <b>SQLRemoveDriverManager</b>. These functions must be called in this sequence. In an upgrade of all components, all the uninstall functions should be called in sequence, then all the install functions should be called in sequence.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=44%><b>For information about</b></td>
<td class=label width=56%><b>See</b></td>
</tr>
<tr valign=top>
<td width=44%>Adding, modifying, or removing a driver</td>
<td width=56%><a href="odch23pr_98aa.htm">SQLConfigDriver</a></td>
</tr>
<tr valign=top>
<td width=44%>Installing a driver</td>
<td width=56%><a href="odch23pr_0vy0.htm">SQLInstallDriverEx</a></td>
</tr>
<tr valign=top>
<td width=44%>Installing a translator</td>
<td width=56%><a href="odch23pr_63aw.htm">SQLInstallTranslatorEx</a></td>
</tr>
<tr valign=top>
<td width=44%>Removing a driver</td>
<td width=56%><a href="odch23pr_1esy.htm">SQLRemoveDriver</a></td>
</tr>
<tr valign=top>
<td width=44%>Removing the Driver Manager</td>
<td width=56%><a href="odch23pr_1u0i.htm">SQLRemoveDriverManager</a></td>
</tr>
<tr valign=top>
<td width=44%>Removing a translator</td>
<td width=56%><a href="odch23pr_9gdu.htm">SQLRemoveTranslator</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
