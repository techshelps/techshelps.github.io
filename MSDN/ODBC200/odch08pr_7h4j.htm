<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Procedure Calls</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcprocedure_calls"></a>Procedure Calls</h2>
<p>
A <i>procedure</i> is an executable object stored on the data source. Generally, it is one or more SQL statements that have been precompiled. The escape sequence for calling a procedure is:</p>
<p>
<b>{</b>[<b>?=</b>]<b>call</b> <i>procedure-name</i>[<b>(</b>[<i>parameter</i>][<b>,</b>[<i>parameter</i>]]...<b>)</b>]<b>}</b></p>
<p>
where <i>procedure-name</i> specifies the name of a procedure and <i>parameter</i> specifies a procedure parameter.</p>
<p>
For more information on the procedure call escape sequence, see “<a href="odappcpr_8pt1.htm">Procedure Call Escape Sequence</a>” in Appendix C, “SQL Grammar.”</p>
<p>
A procedure can have zero or more parameters. It can also return a value, as indicated by the optional parameter marker <b>?=</b> at the start of the syntax. If <i>parameter</i> is an input or an input/output parameter, it can be a literal or a parameter marker. However, interoperable applications should always use parameter markers, because some data sources do not accept literal parameter values. If <i>parameter</i> is an output parameter, it must be a parameter marker. Parameter markers must be bound with <b>SQLBindParameter</b> before the procedure call statement is executed.</p>
<p>
Input and input/output parameters can be omitted from procedure calls. If a procedure is called with parentheses but without any parameters, such as {call <i>procedure-name</i>()}, the driver instructs the data source to use the default value for the first parameter. If the procedure does not have any parameters, this may cause the procedure to fail. If a procedure is called without parentheses, such as {call <i>procedure-name</i>}, the driver does not send any parameter values.</p>
<p>
Literals can be specified for input and input/output parameters in procedure calls. For example, suppose the procedure InsertOrder has five input parameters. The following call to InsertOrder omits the first parameter, provides a literal for the second parameter, and uses a parameter marker for the third, fourth, and fifth parameters:</p>
<pre><code>{call InsertOrder(, 10, ?, ?, ?)} // Not interoperable!
</code></pre>
<p>
Note that if a parameter is omitted, the comma delimiting it from other parameters must still appear. If an input or input/output parameter is omitted, the procedure uses the default value of the parameter. Another way to specify the default value of an input or input/output parameter is to set the value of the length/indicator buffer bound to the parameter to SQL_DEFAULT_PARAM.</p>
<p>
If an input/output parameter is omitted or if a literal is supplied for the parameter, the driver discards the output value. Similarly, if the parameter marker for the return value of a procedure is omitted, the driver discards the return value. Finally, if an application specifies a return value parameter for a procedure that does not return a value, the driver sets the value of the length/indicator buffer bound to the parameter to SQL_NULL_DATA.</p>
<p>
Suppose the procedure PARTS_IN_ORDERS creates a result set containing a list of orders which contain a particular part number. The following code calls this procedure for part number 544:</p>
<pre><code>SQLUINTEGER PartID;
SQLINTEGER&nbsp; PartIDInd = 0;

// Bind the parameter.
SQLBindParameter(hstmt, 1, SQL_PARAM_INPUT, SQL_C_SLONG, SQL_INTEGER, 0, 0,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;PartID, 0, PartIDInd);

// Place the department number in PartID.
PartID = 544;

// Execute the statement.
SQLExecDirect(hstmt, "{call PARTS_IN_ORDERS(?)}", SQL_NTS);
</code></pre>
<p>
To determine if a data source supports procedures, an application calls <b>SQLGetInfo</b> with the SQL_PROCEDURES option.</p>
<p>
For more information about procedures, see “<a href="odch09pr_2ab7.htm">Procedures</a>” in Chapter 9, “Executing Statements.”</p>
</font></BODY>
</HTML>
