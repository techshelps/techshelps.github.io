<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Get Data All (Results Menu)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="get_data_all"></a>Get Data All (Results Menu)</h1>
<p>
The <b>Get Data All</b> function tool attempts to retrieve and display the data in every row and column in the result set on the current <i>statement handle</i>. The <b>Get Data All</b> function tool may not be able to display data for bound columns or columns that occur before the last bound column. This tool performs the following actions:
<ol>
<li>
Calls <b>SQLGetFunctions</b> to determine if the driver supports <b>SQLMoreResults</b>.<br><br></li>
<li>
Calls <b>SQLNumResultCols</b>.<br><br></li>
<li>
If the statement does not return a result set (the number of rows returned by <b>SQLNumResultCol</b> is 0), it calls <b>SQLRowCount</b>, and displays the number of rows affected by the insert, update, delete, or other statement. Skip to step 8.<br><br></li>
<li>
If the statement returns a result set, it calls <b>SQLDescribeCol</b> to retrieve the name and column size of each column in the result set. Based on the column size, it allocates an output buffer of up to 65,535 bytes for each column.<br><br></li>
<li>
Calls <b>SQLFetch</b>.<br><br></li>
<li>
Calls <b>SQLGetData</b> for each column in the result set with a <i>TargetType</i> argument of SQL_C_CHAR. The <b>Get Data All</b> function tool calls <b>SQLGetData</b> only once for each column. If the data is longer than 65,535 bytes, &lt;trunc&gt; is displayed before the first byte of data in the buffer.<br><br></li>
<li>
If SQL_ATTR_ROW_ARRAY_SIZE is greater than 1, it calls <b>SQLSetPos</b> to position to the next row in the rowset.<br><br></li>
<li>
Repeats steps 4 through 6 until <b>SQLFetch</b> returns SQL_NO_DATA.<br><br></li>
<li>
If the driver supports it, it calls <b>SQLMoreResults</b>. If <b>SQLMoreResults</b> returns SQL_SUCCESS or SQL_SUCCESS_WITH_INFO, the <b>Get Data All</b> function tool returns to step 2. Otherwise, it calls <b>SQLFreeStmt</b> with <i>Option</i> set to SQL_CLOSE to clear the result set.</li>
</ol>
</font></BODY>
</HTML>
