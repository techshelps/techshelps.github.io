<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLValidDSN</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlvaliddsn"></a>SQLValidDSN</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 2.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLValidDSN</b> checks the length and validity of the data source name before the name is added to the system information.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLValidDSN</b>(<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszDSN</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpszDSN</i></p>
<p class=indent>
[Input]<br>
Data source name to be checked.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if the data source name is valid. It returns FALSE if the data source name is invalid or the function call failed. </p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLValidDSN</b> returns FALSE, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. A <i>*pfErrorCode</i> is returned only if the function call failed, not if FALSE was returned because the data source name is invalid. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=27%><b><i>*pfErrorCode</i></b></td>
<td class=label width=24%><b>Error</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=24%>General installer error</td>
<td width=49%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=27%>ODBC_ERROR_<br>
OUT_OF_MEM</td>
<td width=24%>Out of memory</td>
<td width=49%>The installer could not perform the function because of a lack of memory.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLValidDSN</b> is called by a driver’s <a href="odch22pr_786m.htm">ConfigDSN</a> to check the length of the data source name, and the validity of the individual characters in the data source name. It checks whether the length of the name is greater than SQL_MAX_DSN_LENGTH, as defined in SQLEXT.H. (Note that the length of the data source name is also checked by <a href="odch23pr_5mjt.htm">SQLWriteDSNToIni</a>.) <b>SQLValidDSN</b> checks whether any of the following invalid characters are included in the data source name:</p>
<p>
&nbsp;&nbsp;&nbsp;[ ] { } ( ) , ; ? * = ! @ \</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=38%><b>For information about</b></td>
<td class=label width=62%><b>See</b></td>
</tr>
<tr valign=top>
<td width=38%>Adding, modifying, or removing a data source</td>
<td width=62%><a href="odch22pr_786m.htm">ConfigDSN</a> (in the Setup DLL)</td>
</tr>
<tr valign=top>
<td width=38%>Adding, modifying, or removing a data source</td>
<td width=62%><a href="odch23pr_3kit.htm">SQLConfigDataSource</a></td>
</tr>
<tr valign=top>
<td width=38%>Writing a data source name to the system information</td>
<td width=62%><a href="odch23pr_5mjt.htm">SQLWriteDSNToIni</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
