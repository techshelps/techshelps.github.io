<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLGetPrivateProfileString</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlgetprivateprofilestring"></a>SQLGetPrivateProfileString</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 2.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLGetPrivateProfileString</b> gets a list of names of values or data corresponding to a value of the system information.</p>
<p class=label>
<b>Syntax</b></p>
<p>
int <b>SQLGetPrivateProfileString</b>(<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszSection</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszEntry</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszDefault</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>RetBuffer,<br>
</i>&nbsp;&nbsp;&nbsp;<i>INT</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>cbRetBuffer,<br>
</i>&nbsp;&nbsp;&nbsp;<i>LPCSTR</i>&nbsp;&nbsp;&nbsp;<i>lpszFilename</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpszSection</i></p>
<p class=indent>
[Input]<br>
Points to a null-terminated string that specifies the section containing the key name. If this argument is NULL, the function copies all section names in the file to the supplied buffer.</p>
<p class=dt>
<i>lpszEntry</i></p>
<p class=indent>
[Input]<br>
Points to the null-terminated string containing the key name whose associated string is to be retrieved. If this argument is NULL, all key names in the section specified by the <i>lpszSection</i> argument are copied to the buffer specified by the <i>RetBuffer</i> argument.</p>
<p class=dt>
<i>lpszDefault</i></p>
<p class=indent>
[Input]<i><br>
</i>Points to a null-terminated string that specifies the default value for the given key if the key cannot be found in the initialization file. This argument cannot be NULL.</p>
<p class=dt>
<i>RetBuffer</i></p>
<p class=indent>
[Output]<i><br>
</i>Points to the buffer that receives the retrieved string.</p>
<p class=dt>
<i>cbRetBuffer</i></p>
<p class=indent>
[Input]<i><br>
</i>Specifies the size, in characters, of the buffer pointed to by the RetBuffer argument.</p>
<p class=dt>
<i>lpszFilename</i></p>
<p class=indent>
[Output]<br>
Points to a null-terminated string that names the initialization file. If this argument does not contain a full path to the file, the default directory is searched.</p>
<p class=label>
<b>Returns</b></p>
<p>
<b>SQLGetPrivateProfileString</b> returns an integer value that indicates the number of characters read.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When a call to <b>SQLGetPrivateProfileString</b> fails, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError</b> and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=28%><b><i>*pfErrorCode</i></b></td>
<td class=label width=24%><b>Error</b></td>
<td class=label width=48%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=24%>General installer error</td>
<td width=48%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
OUT_OF_MEM</td>
<td width=24%>Out of memory</td>
<td width=48%>The installer could not perform the function because of a lack of memory.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLGetPrivateProfileString</b> is provided as a simple way to port drivers and driver setup DLLs from Windows to Windows NT. Calls to <b>GetPrivateProfileString</b> that retrieve a profile string from the ODBC.INI file should be replaced with calls to <b>SQLGetPrivateProfileString</b>. <b>SQLGetPrivateProfileString</b> calls functions in the Win32 API to retrieve the requested names of values or data corresponding to a value of the ODBC.INI subkey of the system information.</p>
<p>
The configuration mode (as set by <b>SQLSetConfigMode</b>) indicates where the ODBC.INI entry listing DSN values is in the system information. If the DSN is a User DSN (the configuration mode is USERDSN_ONLY), the function reads from the ODBC.INI entry in HKEY_CURRENT_USER. If the DSN is a System DSN (SYSTEMDSN_ONLY), the function reads from the ODBC.INI entry in HKEY_LOCAL_MACHINE. If the configuration mode is BOTHDSN, HKEY_CURRENT_USER is tried, and if it fails, then HKEY_LOCAL_MACHINE is used.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Writing a value to the system information</td>
<td width=52%><a href="odch23pr_2uav.htm">SQLWritePrivateProfileString</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
