<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Diagnostic Handling Rules</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcdiagnostic_handling_rules"></a>Diagnostic Handling Rules</h2>
<p>
The following rules govern diagnostic handling in <b>SQLGetDiagRec</b> and <b>SQLGetDiagField</b>.</p>
<p>
All ODBC components:
<ul type=disc>
<li>
Must not replace, alter, or mask errors or warnings received from another ODBC component.<br><br></li>
<li>
May add an additional status record when they receive a diagnostic message from another ODBC component. The added record must add real information value to the original message.</li>
</ul>
<p>
The ODBC component that directly interfaces a data source:
<ul type=disc>
<li>
Must prefix its vendor identifier, its component identifier, and the data source’s identifier to the diagnostic message it receives from the data source.<br><br></li>
<li>
Must preserve the data source’s native error code.<br><br></li>
<li>
Must preserve the data source’s diagnostic message.</li>
</ul>
<p>
Any ODBC component that generates an error or warning independent of the data source:
<ul type=disc>
<li>
Must supply the correct SQLSTATE for the error or warning.<br><br></li>
<li>
Must generate the text of the diagnostic message.<br><br></li>
<li>
Must prefix its vendor identifier and its component identifier to the diagnostic message.<br><br></li>
<li>
Must return a native error code, if one is available and meaningful.</li>
</ul>
<p>
The ODBC component that interfaces with the Driver Manager:
<ul type=disc>
<li>
Must initialize the output arguments of <b>SQLGetDiagRec</b> and <b>SQLGetDiagField</b>.<br><br></li>
<li>
Must format and return the diagnostic information as output arguments of <b>SQLGetDiagRec</b> and <b>SQLGetDiagField</b> when that function is called.</li>
</ul>
<p>
One ODBC component other than the Driver Manager:
<ul type=disc>
<li>
Must set the SQLSTATE based on the native error. For file-based drivers and DBMS-based drivers that do not use a gateway, the driver must set the SQLSTATE. For DBMS-based drivers that use a gateway, either the driver or a gateway that supports ODBC may set the SQLSTATE.</li>
</ul>
</font></BODY>
</HTML>
