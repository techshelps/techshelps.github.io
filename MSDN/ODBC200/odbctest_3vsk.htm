<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Writing an Auto Test</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="writing_an_auto_test"></a>Writing an Auto Test</h1>
<p>
Writing an auto test is like writing any other ODBC application. You must write code to allocate and free handles, connect to and disconnect from data sources, and access data. As a starting point, you can use custom.c or quiktest.c in the \Samples\Odbc\Quiktest directory.</p>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>An auto test does not have to manage handles or connections if it uses the ODBC Test Handles test source. </p>
<p>
An auto test contains one or more <i>test cases</i>, each of which tests some specific functionality. For example, an auto test for <b>SQLAllocStmt</b> might contain two test cases, one to call <b>SQLAllocStmt</b> with all combinations of valid and invalid arguments and one to call <b>SQLAllocStmt</b> repeatedly until the driver runs out of statement handles.</p>
<p>
The QTBUILD program shipped with the SDK requires specified names for the source files for an auto-test DLL. </p>
<p>
The auto test must export the following functions, which are called by ODBC Test:
<ul type=disc>
<li>
<b>AutoTestName</b>. This function returns the name of the auto test and the number of test cases it includes. ODBC Test displays the auto test name in the <b>Manage Auto Tests</b>, <b>Manage Test Groups</b>, and <b>Run Auto Tests</b> dialog boxes.<br><br></li>
<li>
<b>AutoTestDesc</b>. This function returns the name and description of a specific test case. ODBC Test displays the test case name and description in the <b>Run Auto Tests</b> dialog box.<br><br></li>
<li>
<b>AutoTestFunc</b>. This function invokes the auto test for a specific test source. Information about the test source and a bit array of the test cases to execute are passed to the auto test in a structure created by ODBC Test.</li>
</ul>
<p>
An auto test can call the following two functions in gtrtst32.dll:
<ul type=disc>
<li>
<b>szLogPrintf</b>.<b> </b>An auto test calls this function to log test results and other information to the screen and the log file.<br><br></li>
<li>
<b>szMessageBox</b>.<b> </b>An auto test calls this function to display a message box. This function encapsulates the <b>MessageBox</b> function in the Windows API. Unlike the <b>MessageBox</b> function, it accepts a format string and a list of arguments with which it constructs a string to pass to <b>MessageBox</b>.</li>
</ul>
</font></BODY>
</HTML>
