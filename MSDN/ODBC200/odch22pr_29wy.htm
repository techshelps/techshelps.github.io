<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ConfigDriver</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcconfigdriver"></a>ConfigDriver</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 2.5</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>ConfigDriver</b> allows a setup program to perform install and uninstall functions without requiring the program to call <b>ConfigDSN</b>. This function will perform driver-specific functions such as creating driver-specific system information and performing DSN conversions during installation, and cleaning up system information modifications during uninstall. This function is exposed by the driver setup DLL or a separate setup DLL.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>ConfigDriver</b> (<br>
<b>&nbsp;&nbsp;&nbsp;</b>HWND&nbsp;&nbsp;&nbsp;<i>hwndParent</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>fRequest</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR<b>&nbsp;&nbsp;&nbsp;</b><i>lpszDriver</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR<b>&nbsp;&nbsp;&nbsp;</b><i>lpszArgs</i>,<br>
&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;&nbsp;<i>lpszMsg</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>cbMsgMax</i>,<br>
&nbsp;&nbsp;&nbsp;WORD *<b>&nbsp;&nbsp;&nbsp;</b><i>pcbMsgOut</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>hwndParent</i></p>
<p class=indent>
[Input]<br>
Parent window handle. The function will not display any dialog boxes if the handle is null.</p>
<p class=dt>
<i>fRequest</i></p>
<p class=indent>
[Input]<br>
Type of request. <i>fRequest</i> must contain one of the following values:</p>
<p class=tl>
ODBC_INSTALL_DRIVER: Install a new driver. </P><p class=tl>
ODBC_REMOVE_DRIVER: Remove a driver.</P><p class=tl>
This option can also be driver-specific, in which case the <i>fRequest</i> for the first option must start from ODBC_CONFIG_DRIVER_MAX+1. The <i>fRequest</i> for any additional option must also start from a value greater than ODBC_CONFIG_DRIVER_MAX+1.</P><p class=dt>
<i>lpszDriver</i></p>
<p class=indent>
[Input]<br>
The name of the driver as registered in the ODBCINST.INI key of the system information.</p>
<p class=dt>
<i>lpszArgs</i></p>
<p class=indent>
[Input]<br>
A null-terminated string containing arguments for a driver-specific <i>fRequest</i>.</p>
<p class=dt>
<i>lpszMsg</i></p>
<p class=indent>
[Output]<br>
A null-terminated string containing an output message from the driver setup.</p>
<p class=dt>
<i>cbMsgMax</i></p>
<p class=indent>
[Input]<br>
Length of <i>lpszMsg</i>.</p>
<p class=dt>
<i>pcbMsgOut</i></p>
<p class=indent>
[Output]<br>
Total number of bytes available to return in <i>lpszMsg</i>.</p>
<p class=tl>
If the number of bytes available to return is greater than or equal to <i>cbMsgMax</i>, the output message in <i>lpszMsg</i> is truncated to <i>cbMsgMax</i> minus the null-termination character. The <i>pcbMsgOut</i> argument can be a null pointer.</P><p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it is successful, FALSE if it fails.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>ConfigDriver</b> returns FALSE, an associated <i>*pfErrorCode</i> value is posted to the installer error buffer by a call to <b>SQLPostInstallerError</b>, and may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=28%><i>*pfErrorCode</i></td>
<td class=label width=24%><b>Error</b></td>
<td class=label width=48%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_HWND</td>
<td width=24%>Invalid window handle</td>
<td width=48%>The <i>hwndParent</i> argument was invalid.</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_<br>
REQUEST_TYPE</td>
<td width=24%>Invalid type of request</td>
<td width=48%>The <i>fRequest</i> argument was not one of the following:<p>
ODBC_INSTALL_DRIVER.</p>
<p>
ODBC_REMOVE_DRIVER.</p>
<p>
The driver-specific option was less than or equal to ODBC_CONFIG_DRIVER_MAX.</p>
</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_NAME</td>
<td width=24%>Invalid driver or translator name</td>
<td width=48%>The <i>lpszDriver</i> argument was invalid. It could not be found in the registry.</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
REQUEST_<br>
FAILED</td>
<td width=24%><i>Request</i> failed</td>
<td width=48%>Could not perform the operation requested by the <i>fRequest</i> argument.</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
DRIVER_<br>
SPECIFIC</td>
<td width=24%>Driver- or translator-specific error</td>
<td width=48%>A driver-specific error for which there is no defined ODBC installer error.&nbsp; The <i>SzError</i> argument in a call to the <b>SQLPostInstallerError</b> function should contain the driver-specific error message.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p class=label>
<b>Driver-Specific Options</b></p>
<p>
An application can request driver-specific features exposed by the driver by using the <i>fRequest</i> argument. The <i>fRequest</i> for the first option will be ODBC_CONFIG_DRIVER_MAX plus 1, and additional options will be incremented by 1 from that value. Any arguments required by the driver for that function should be provided in a null-terminated string passed in the <i>lpszArgs</i> argument. Drivers providing such functionality should maintain a table of driver-specific options. The options should be fully documented in driver documentation. Application writers who use driver-specific options should be aware that this will make the application less interoperable.</p>
<p class=label>
<b>Messages</b></p>
<p>
A driver setup routine can send a text message to an application as a null-terminated string in the <i>lpszMsg</i> buffer. The message will be truncated to <i>cbMsgMax</i> minus the null-termination character by the <b>ConfigDriver</b> function if it is greater than or equal to <i>cbMsgMax</i> characters.</p>
</font></BODY>
</HTML>
