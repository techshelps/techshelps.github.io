<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLWritePrivateProfileString</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlwriteprivateprofilestring"></a>SQLWritePrivateProfileString</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 2.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLWritePrivateProfileString</b> writes a value name and data to the ODBC.INI subkey of the system information.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLWritePrivateProfileString</b>(<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszSection</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszEntry</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszString</i>,<br>
&nbsp;&nbsp;&nbsp;<i>LPCSTR</i>&nbsp;&nbsp;&nbsp;<i>lpszFilename</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpszSection</i></p>
<p class=indent>
[Input]<br>
Points to a null-terminated string containing the name of the section to which the string will be copied. If the section does not exist, it is created. The name of the section is case-independent; the string can be any combination of uppercase and lowercase letters.</p>
<p class=dt>
<i>lpszEntry</i></p>
<p class=indent>
[Input]<br>
Points to a null-terminated string containing the name of the key to be associated with a string. If the key does not exist in the specified section, it is created. If this argument is NULL, the entire section, including all entries within the section, is deleted.</p>
<p class=dt>
<i>lpszString</i></p>
<p class=indent>
[Input]<br>
Points to a null-terminated string to be written to the file. If this argument is NULL, the key pointed to by the <i>lpszEntry </i>argument is deleted.</p>
<p class=dt>
<i>lpszFilename</i></p>
<p class=indent>
[Output]<br>
Points to a null-terminated string that names the initialization file.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it is successful, FALSE if it fails.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLWritePrivateProfileString</b> returns FALSE, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=29%><b><i>*pfErrorCode</i></b></td>
<td class=label width=24%><b>Error</b></td>
<td class=label width=47%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=24%>General installer error</td>
<td width=47%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=29%>ODBC_ERROR_<br>
REQUEST_FAILED</td>
<td width=24%>Request failed</td>
<td width=47%>The requested system information could not be written.</td>
</tr>
<tr valign=top>
<td width=29%>ODBC_ERROR_<br>
OUT_OF_MEM</td>
<td width=24%>Out of memory</td>
<td width=47%>The installer could not perform the function because of a lack of memory.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLWritePrivateProfileString</b> is provided as a simple way to port drivers and driver setup DLLs from Windows to Windows NT. Calls to <b>WritePrivateProfileString</b> that write a profile string to the ODBC.INI file should be replaced with calls to <b>SQLWritePrivateProfileString</b>. <b>SQLWritePrivateProfileString</b> calls functions in the Win32 API to add the specified value name and data to the ODBC.INI subkey of the system information.</p>
<p>
A configuration mode indicates where the ODBC.INI entry listing DSN values is in the system information. If the DSN is a User DSN (the state variable is USERDSN_ONLY), the function writes to the ODBC.INI entry in HKEY_CURRENT_USER. If the DSN is a System DSN (SYSTEMDSN_ONLY), the function writes to the ODBC.INI entry in HKEY_LOCAL_MACHINE. If the state variable is BOTHDSN, HKEY_CURRENT_USER is tried, and if it fails, then HKEY_LOCAL_MACHINE is used.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Getting a value from the system information</td>
<td width=52%><a href="odch23pr_8q93.htm">SQLGetPrivateProfileString</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
