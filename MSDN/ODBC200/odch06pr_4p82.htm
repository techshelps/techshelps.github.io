<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Choosing a Data Source or Driver</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcchoosing_a_data_source_or_driver"></a>Choosing a Data Source or Driver</h1>
<p>
The data source or driver used by an application is sometimes hard-coded in the application. For example, a custom application written by an MIS department to transfer data from one data source to another would contain the names of those data sources — the application simply would not work with any other data sources. Another example is a vertical application, such as one used for order entry. Such an application always uses the same data source, which has a predefined schema known by the application.</p>
<p>
Other applications choose the data source or driver at run time. Usually, these are generic applications that do ad hoc queries, such as a spreadsheet that uses ODBC to import data. Such applications usually list the available data sources or drivers and let users choose the ones they want to work with. Whether a generic application lists data sources, drivers, or both often depends on whether the application uses DBMS- or file-based drivers.</p>
<p>
DBMS-based drivers usually require a fairly complex set of connection information, such as the network address, network protocol, database name, and so on. The purpose of a data source is to hide all of this information. Hence, the data source paradigm lends itself to use with DBMS-based drivers. An application can display a list of data sources to the user in one of two ways. It can call <b>SQLDriverConnect</b> with the <b>DSN</b> (Data Source Name) keyword and no associated value; the Driver Manager will display a list of data source names. If the application wants control over the appearance of the list, it calls <b>SQLDataSources</b> to retrieve a list of available data sources and constructs its own dialog box. This function is implemented by the Driver Manager and can be called before any drivers are loaded. The application then calls a connection function and passes it the name of the chosen data source.</p>
<p>
If a data source is not specified, the default data source indicated by the system information is used. (For more information, see “<a href="odch19pr_5kjd.htm">Default Subkey</a>” in Chapter 19, “Configuring Data Sources.”) If <b>SQLConnect</b> is called with a <i>ServerName</i> argument that cannot be found, is a null pointer, or is “DEFAULT”, the Driver Manager connects to the default data source. The default data source is also used if the connection string used in a call to <b>SQLDriverConnect</b> or <b>SQLBrowseConnect </b>contains the DSN keyword set to “DEFAULT”, or the data source is not found. Additionally, the default data source is used if the connection string used in a call to <b>SQLDriverConnect </b>does not contain the DSN keyword.</p>
<p>
With file-based drivers, it is possible to use a file paradigm. For data stored on the local machine, users often know that their data is in a particular file, such as EMPLOYEE.DBF. Rather than choosing an unknown data source, it is easier for such users to choose the file they know. To implement this, the application first calls <b>SQLDrivers</b>. This function is implemented by the Driver Manager and can be called before any drivers are loaded. <b>SQLDrivers</b> returns a list of available drivers; it also returns values for the <b>FileUsage</b> and <b>FileExtns</b> keywords. The <b>FileUsage</b> keyword explains whether file-based drivers treat files as tables, such as Xbase, or databases, such as Microsoft Access. The <b>FileExtns</b> keyword lists the file extensions the driver recognizes, such as .dbf for an Xbase driver. Using this information, the application constructs a dialog box with which the user chooses a file. Based on the extension of the chosen file, the application then connects directly to the driver by calling <b>SQLDriverConnect</b> with the <b>DRIVER</b> keyword.</p>
<p>
There is nothing to stop an application from using a data source with a file-based driver or calling <b>SQLDriverConnect</b> with the <b>DRIVER</b> keyword to connect directly to a DBMS-based driver. Here are several common uses of the <b>DRIVER</b> keyword for DBMS-based drivers:
<ul type=disc>
<li>
<b>Not creating data sources.</b> For example, a custom application might use a particular driver and database. If the driver name and all information needed to connect to the database is hard-coded in the application, users do not need to create a data source on their computer to run the application — all they need to do is install the application and driver.<p class=tl>
A disadvantage of this method is that the application must be recompiled and redistributed if the connection information changes. If a data source name is hard-coded in the application instead of complete connection information, then each user only needs to change the information in the data source.</P></li>
<li>
<b>Accessing a particular DBMS a single time.</b> For example, a spreadsheet that retrieves data by calling ODBC functions might contain the <b>DRIVER</b> keyword to identify a particular driver. Because the driver name is meaningful to any users that have that driver, the spreadsheet could be passed among those users. If the spreadsheet contained a data source name, each user would have to create the same data source to use the spreadsheet. <br><br></li>
<li>
<b>Browsing the system for all databases accessible to a particular driver.</b> For more information, see “<a href="odch06pr_1kqc.htm">Connecting with SQLBrowseConnect</a>,” later in this chapter.</li>
</ul>
</font></BODY>
</HTML>
