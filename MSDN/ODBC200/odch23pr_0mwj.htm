<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLGetInstalledDrivers</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlgetinstalleddrivers"></a>SQLGetInstalledDrivers</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 1.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLGetInstalledDrivers</b> reads the [ODBC Drivers] section of the system information and returns a list of descriptions of the installed drivers.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLGetInstalledDrivers</b>(<br>
&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;&nbsp;<i>lpszBuf</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>cbBufMax</i>,<br>
&nbsp;&nbsp;&nbsp;WORD *&nbsp;&nbsp;&nbsp;<i>pcbBufOut</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpszBuf</i></p>
<p class=indent>
[Output]<br>
List of descriptions of the installed drivers. For information about the list structure, see “Comments.”</p>
<p class=dt>
<i>cbBufMax</i></p>
<p class=indent>
[Input]<br>
Length of <i>lpszBuf</i>.</p>
<p class=dt>
<i>pcbBufOut</i></p>
<p class=indent>
[Output]<br>
Total number of bytes (excluding the null-termination byte) returned in <i>lpszBuf</i>. If the number of bytes available to return is greater than or equal to <i>cbBufMax</i>, the list of driver descriptions in <i>lpszBuf</i> is truncated to <i>cbBufMax</i> minus the null-termination character. The <i>pcbBufOut</i> argument can be a null pointer.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it is successful, FALSE if it fails.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLGetInstalledDrivers</b> returns FALSE, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=26%><b><i>*pfErrorCode</i></b></td>
<td class=label width=25%><b>Error</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=25%>General installer error</td>
<td width=49%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
INVALID_BUFF_<br>
LEN</td>
<td width=25%>Invalid buffer length</td>
<td width=49%>The <i>lpszBuf</i> argument was NULL or invalid, or the cbBufMax argument was less than or equal to 0.</td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
COMPONENT_<br>
NOT_FOUND</td>
<td width=25%>Component not found in registry</td>
<td width=49%>The installer could not find the [ODBC Drivers] section in the registry.</td>
</tr>
<tr valign=top>
<td width=26%>ODBC_ERROR_<br>
OUT_OF_MEM</td>
<td width=25%>Out of memory</td>
<td width=49%>The installer could not perform the function because of a lack of memory.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
Each driver description is terminated with a null byte and the entire list is terminated with a null byte (that is, two null bytes mark the end of the list). If the allocated buffer is not large enough to hold the entire list, the list is truncated without error. An error is returned if a null pointer is passed in as <i>lpszBuf</i>.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Returning driver descriptions and attributes</td>
<td width=52%><a href="odch21dpr_3pwz.htm">SQLDrivers</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
