<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLInstallTranslatorEx</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlinstalltranslatorex"></a>SQLInstallTranslatorEx</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 3.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLInstallTranslatorEx</b> adds information about a translator to the ODBCINST.INI section of the system information.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLInstallTranslatorEx</b> (<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszTranslator</i>,<br>
&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;<i>lpszPathIn</i>,<br>
&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;&nbsp;<i>lpszPathOut</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>cbPathOutMax</i>,<br>
&nbsp;&nbsp;&nbsp;WORD *&nbsp;&nbsp;&nbsp;<i>pcbPathOut</i>,<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>fRequest</i>,<br>
&nbsp;&nbsp;&nbsp;LPDWORD&nbsp;&nbsp;&nbsp;<i>lpdwUsageCount</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpszTranslator</i></p>
<p class=indent>
[Input]<br>
This must contain a list of keyword-value pairs describing the translator. The <b>Translator</b> and <b>Setup</b> keywords have to be included in the <i>lpszTranslator</i> string. The translation DLL is listed with the <b>Translator</b> keyword, and the translator setup DLL is listed with the <b>Setup</b> keyword. Each pair is terminated with a NULL byte, and the entire list is terminated with a NULL byte (that is, two NULL bytes mark the end of the list). The format of <i>lpszTranslator</i> is:</p>
<p class=dt>
<i>translator-desc</i></p>
<p class=indent>
\0Translator=<i>translator-DLL-filename</i>\0[Setup=<i>setup-DLL-filename</i>\0]\0</p>
<p class=dt>
<i>lpszPathIn</i></p>
<p class=indent>
[Input]<br>
Full path of where the translator is to be installed or a null pointer. If <i>lpszPath</i> is a null pointer, then the translators will be installed in the System directory.</p>
<p class=dt>
<i>lpszPathOut</i></p>
<p class=indent>
[Output]<br>
The path of the target directory where the translator should be installed. If the translator has never been installed, then <i>lpszPathOut</i> is the same as <i>lpszPathIn</i>. If there exists a prior installation of the translator, then <i>lpszPathOut</i> is the path of the prior installation.</p>
<p class=dt>
<i>cbPathOutMax</i></p>
<p class=indent>
[Input]<br>
Length of <i>lpszPathOut.</i></p>
<p class=dt>
<i>pcbPathOut</i></p>
<p class=indent>
[Output]<br>
Total number of bytes available to return in <i>lpszPathOut</i>. If the number of bytes available to return is greater than or equal to <i>cbPathOutMax</i>, the output path in <i>lpszPathOut</i> is truncated to <i>pcbPathOutMax</i> minus the null-termination character. The <i>pcbPathOut</i> argument can be a null pointer.</p>
<p class=dt>
<i>fRequest</i></p>
<p class=indent>
[Input]<br>
Type of request. <i>fRequest </i>must contain one of the following values:</p>
<p class=tl>
ODBC_INSTALL_INQUIRY: Inquire about where a translator can be installed.</P><p class=tl>
ODBC_INSTALL_COMPLETE: Complete the installation request.</P><p class=dt>
<i>lpdwUsageCount</i></p>
<p class=indent>
[Output]<br>
The usage count of the translator after this function has been called.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it is successful, FALSE if it fails.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLInstallTranslatorEx</b> returns FALSE, an associated <i>*pfErrorCode</i> value may be obtained by calling <b>SQLInstallerError</b>. The following table lists the <i>*pfErrorCode</i> values that can be returned by <b>SQLInstallerError </b>and explains each one in the context of this function.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=28%><b><i>*pfErrorCode</i></b></td>
<td class=label width=24%><b>Error</b></td>
<td class=label width=48%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
GENERAL_ERR</td>
<td width=24%>General installer error</td>
<td width=48%>An error occurred for which there was no specific installer error.</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_BUFF_<br>
LEN</td>
<td width=24%>Invalid buffer length</td>
<td width=48%>The <i>lpszPathOut</i> argument was not large enough to contain the output path. The buffer contains the truncated path.<p>
The <i>cbPathOutMax</i> argument was 0 and the <i>fRequest</i> argument was ODBC_INSTALL_COMPLETE.</p>
</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_<br>
REQUEST_TYPE</td>
<td width=24%>Invalid type of request</td>
<td width=48%>The <i>fRequest</i> argument was not one of the following:<p>
ODBC_INSTALL_INQUIRY<br>
ODBC_INSTALL_COMPLETE</p>
</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_<br>
KEYWORD_<br>
VALUE</td>
<td width=24%>Invalid keyword-value pairs</td>
<td width=48%>The <i>lpszTranslator</i> argument contained a syntax error.</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_PATH</td>
<td width=24%>Invalid install path</td>
<td width=48%>The <i>lpszPathIn</i> argument contained an invalid path.</td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
INVALID_<br>
PARAM_<br>
SEQUENCE</td>
<td width=24%>Invalid parameter sequence</td>
<td width=48%>The <i>lpszTranslator</i> argument did not contain a list of keyword-value pairs. </td>
</tr>
<tr valign=top>
<td width=28%>ODBC_ERROR_<br>
USAGE_<br>
UPDATE_<br>
FAILED</td>
<td width=24%>Could not increment or decrement the registry’s component usage count</td>
<td width=48%>The installer failed to increment the translator’s usage count.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLInstallTranslatorEx</b> provides a mechanism to install just the translator. This function does not actually copy any files. The calling program is responsible for copying the translator files.</p>
<p>
<b>SQLInstallTranslatorEx</b> increments the component usage count for the installed translator by 1. If a version of the translator already exists, but the component usage count for the translator does not exist, the new component usage count value is set to 2. </p>
<p>
The application setup program is responsible for physically copying the translator file, and maintaining the file usage count. If the translator file has not previously been installed, the application setup program must copy the file or files, and create the file or files usage count. If the file has previously been installed, the setup program simply increments the file usage count.</p>
<p>
If an older version of the translator was previously installed by the application, the translator should be uninstalled, then reinstalled, so that the translator component usage count is valid. <b>SQLRemoveTranslator</b> should be called to decrement the component usage count, and then <b>SQLInstallTranslatorEx</b> should then be called to increment the component usage count. The application setup program must physically replace the old file or files with the new file. The file usage count will remain the same, and other applications that used the older version file will now use the newer version.</p>
<p>
The length of the path in <i>lpszPathOut</i> in <b>SQLInstallTranslatorEx</b> allows for a two-phase install process, so an application can determine what <i>cbPathOutMax</i> should be by calling <b>SQLInstallTranslatorEx</b> with an <i>fRequest</i> of ODBC_INSTALL_INQUIRY mode. This will return the total number of bytes available in the <i>pcbPathOut</i> buffer. <b>SQLInstallTranslatorEx</b> can then be called with an <i>fRequest</i> of ODBC_INSTALL_COMPLETE and the <i>cbPathOutMax</i> argument set to the value in the <i>pcbPathOut</i> buffer, plus the null-termination character.</p>
<p>
If you choose not to use the two-phase model for <b>SQLInstallTranslatorEx</b>, then you must set <i>cbPathOutMax</i>, which defines the size of the storage for the path of the target directory, to the value _MAX_PATH, as defined in STDLIB.H, to prevent truncation.</p>
<p>
When <i>fRequest</i> is ODBC_INSTALL_COMPLETE, <b>SQLInstallTranslatorEx</b> does not allow <i>lpszPathOut</i> to be NULL (or <i>cbPathOutMax</i> to be 0). If <i>fRequest</i> is ODBC_INSTALL_COMPLETE, FALSE is returned when the number of bytes available to return is greater than or equal to <i>cbPathOutMax</i>, with the result that truncation occurs.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Returning a default translation option</td>
<td width=52%><a href="odch22pr_83hu.htm">ConfigTranslator</a></td>
</tr>
<tr valign=top>
<td width=48%>Selecting translators</td>
<td width=52%><a href="odch23pr_1ho2.htm">SQLGetTranslator</a></td>
</tr>
<tr valign=top>
<td width=48%>Removing translators</td>
<td width=52%><a href="odch23pr_9gdu.htm">SQLRemoveTranslator</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
