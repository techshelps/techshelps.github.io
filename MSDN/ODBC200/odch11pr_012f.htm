<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Relative and Absolute Scrolling</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcrelative_and_absolute_scrolling"></a>Relative and Absolute Scrolling</h2>
<p>
Most of the scrolling options in <b>SQLFetchScroll</b> position the cursor relative to the current position or to an absolute position. <b>SQLFetchScroll</b> supports fetching the next, prior, first, and last rowsets, as well as relative fetching (fetch the rowset <i>n</i> rows from the start of the current rowset) and absolute fetching (fetch the rowset starting at row <i>n</i>). If <i>n</i> is negative in an absolute fetch, rows are counted from the end of the result set. Thus, an absolute fetch of row&nbsp;–&nbsp;1 means to fetch the rowset that starts with the last row in the result set.</p>
<p>
Dynamic cursors detect rows inserted into and deleted from the result set, so there is no easy way for dynamic cursors to retrieve the row at a particular number other than reading from the start of the result set, which is likely to be slow. Furthermore, absolute fetching is not very useful in dynamic cursors because row numbers change as rows are inserted and deleted; thus, successively fetching the same row number can yield different rows.</p>
<p>
Applications that use <b>SQLFetchScroll</b> only for its block cursor capabilities, such as reports, are likely to pass through the result set a single time, using only the option to fetch the next rowset. Screen-based applications, on the other hand, can take advantage of all the capabilities of <b>SQLFetchScroll</b>. If the application sets the rowset size to the number of rows displayed on the screen and binds the screen buffers to the result set, it can translate scroll bar operations directly to calls to <b>SQLFetchScroll</b>:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=35%><b>Scroll bar operation</b></td>
<td class=label width=65%><b>SQLFetchScroll scrolling option</b></td>
</tr>
<tr valign=top>
<td width=35%>Page up</td>
<td width=65%>SQL_FETCH_PRIOR</td>
</tr>
<tr valign=top>
<td width=35%>Page down</td>
<td width=65%>SQL_FETCH_NEXT</td>
</tr>
<tr valign=top>
<td width=35%>Line up</td>
<td width=65%>SQL_FETCH_RELATIVE with <i>FetchOffset</i> equal to &nbsp;–&nbsp;1</td>
</tr>
<tr valign=top>
<td width=35%>Line down</td>
<td width=65%>SQL_FETCH_RELATIVE with <i>FetchOffset</i> equal to 1</td>
</tr>
<tr valign=top>
<td width=35%>Scroll box at top</td>
<td width=65%>SQL_FETCH_FIRST</td>
</tr>
<tr valign=top>
<td width=35%>Scroll box at bottom</td>
<td width=65%>SQL_FETCH_LAST</td>
</tr>
<tr valign=top>
<td width=35%>Random scroll box position</td>
<td width=65%>SQL_FETCH_ABSOLUTE</td>
</tr>
</table><br>
<p>
Such applications also need to position the scroll box after a scrolling operation, which requires the current row number and the number of rows. For the current row number, applications can either keep track of the current row number or call <b>SQLGetStmtAttr</b> with the SQL_ATTR_ROW_NUMBER attribute to retrieve it.</p>
<p>
The number of rows in the cursor, which is the size of the result set, is available as the SQL_DIAG_CURSOR_ROW_COUNT field of the diagnostic header. The value in this field is defined only after <b>SQLExecute</b>, <b>SQLExecDirect</b>, or <b>SQLMoreResult</b> has been called. This count can be either an approximate count or an exact count, depending on the capabilities of the driver. The driver’s support can be determined by calling <b>SQLGetInfo</b> with the cursor attributes information types, and checking whether the SQL_CA2_CRC_APPROXIMATE or SQL_CA2_CRC_EXACT bit is returned for the type of cursor.</p>
<p>
An exact row count is never supported for a dynamic cursor. For other types of cursors, the driver can either support exact or approximate row counts, but not both. If the driver supports neither exact nor approximate row counts for a specific cursor type, then the SQL_DIAG_CURSOR_ROW_COUNT field contains the number of rows that have been fetched so far. Regardless of what the driver supports, <b>SQLFetchScroll</b> with an <i>Operation</i> of SQL_FETCH_LAST will cause the SQL_DIAG_CURSOR_ROW_COUNT field to contain the exact row count.</p>
</font></BODY>
</HTML>
