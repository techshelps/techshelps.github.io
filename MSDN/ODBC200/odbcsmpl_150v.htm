<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Run Admin Demo</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><sup><a name="odbchow_to_run_admin_demo"></a></sup>How to Run Admin Demo</h1>
<p>
You can run the Admin Demo by double-clicking the ADMNDEMO.EXE file in Windows Explorer, or by clicking <b>Start</b>, then <b>Run</b>, and typing <b>\&lt;path&gt;\ADMNDEMO.EXE</b>.</p>
<h2>Admin Demo Command-Line Switches</h2>
<p>
Admin Demo supports command-line switches to automatically connect to data sources, execute SQL scripts, and trace ODBC function calls. The switches are:</p>
<p class=label>
<b>/D[connection-string]</b></p>
<p>
This switch specifies a connection string for <b>SQLDriverConnect</b>. See the driver documentation for the precise syntax of this string. For example:</p>
<pre><code>&nbsp;/D[DSN=myserver;UID=Smith;PWD=Sesame;]
</code></pre>
<p class=indent>
<b>Note&nbsp;&nbsp;&nbsp;</b>Except for the /T option, the /D option must be specified for any other option to work.</p>
<p class=label>
<b>/Ffilename</b></p>
<p>
This switch specifies the full path of a file to execute in the same manner used for the <b>File/Execute</b> menu item.</p>
<p class=label>
<b>/O:option</b></p>
<p>
This switch specifies a set of options that determine how the file specified with /F is executed. Each option is separated by a colon.
<ul type=disc>
<li>
T—The statement terminator, either CR (default) or '&lt;value&gt;'<br><br></li>
<li>
M—Maximum statement size (default is 1000)</li>
</ul>
<p class=label>
<b>/Tfilename</b></p>
<p>
This switch specifies the full path of a file to use for tracing of ODBC statements made by Admin Demo. This filename is used as a parameter to the <b>SQLSetConnectAttr</b> function with the SQL_ATTR_TRACEFILE option.</p>
<p class=label>
<b>/Xoption</b></p>
<p>
Set this switch to 'Y' to force Admin Demo to exit once all other switches have been processed; set it to 'N' (the default) to leave Admin Demo running.</p>
<h2>Examples</h2>
<p>
In the following example, the statement terminator is the semicolon and the maximum statement size is 500:</p>
<pre><code>/O:T';':M500
</code></pre>
<p>
In the next example, the statement terminator is a carriage return-linefeed character. The maximum statement size is 2500:</p>
<pre><code>/O:TCR:M2500</code></pre>
<p>
In the final example, all options are used:</p>
<pre><code>ADMNDEMO.EXE /FC:\SQLADMIN\BACKUP.SQL
 /D[DSN=myserver;UID=Smith;PWD=;]
 /O:TCR:M2000 /TC:\TMP\ADMNDEMO.LOG /XN
</code></pre>
<p>
When Admin Demo is run, ODBC calls are logged to the C:\TMP\ADMNDEMO.LOG file, and Admin Demo connects to 'myserver' as user 'Smith' with no password. Once connected, the file C:\SQLADMIN\BACKUP.SQL is executed using a carriage return-linefeed character as a statement terminator with a maximum statement size of 2000. After the file has been executed, the application releases control to the user instead of exiting.</p>
</font></BODY>
</HTML>
