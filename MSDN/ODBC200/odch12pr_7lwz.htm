<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining the Number of Affected Rows</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcdetermining_the_number_of_affected_rows"></a>Determining the Number of Affected Rows</h1>
<p>
After an application updates, deletes, or inserts rows, it can call <b>SQLRowCount</b> to determine how many rows were affected. <b>SQLRowCount</b> returns this value regardless of whether the rows were updated, deleted, or inserted by executing an <b>UPDATE</b>, <b>DELETE</b>, or <b>INSERT</b> statement, by executing a positioned update or delete statement, or by calling <b>SQLSetPos</b>.</p>
<p>
If a batch of SQL statements is executed, the count of affected rows might be a total count for all statements in the batch or individual counts for each statement in the batch. For more information, see “<a href="odch09pr_3joz.htm">Batches of SQL Statements</a>” in Chapter 9, “Executing Statements,” and “<a href="odch11pr_6ovn.htm">Multiple Results</a>” in Chapter 11, “Retrieving Results (Advanced).”</p>
<p>
The number of affected rows is also returned in the SQL_DIAG_ROW_COUNT diagnostic header field in the diagnostic area associated with the statement handle. However, the data in this field is reset after every function call on the same statement handle, whereas the value returned by <b>SQLRowCount</b> remains the same until a call to <b>SQLBulkOperations</b>, <b>SQLExecute</b>, <b>SQLExecDirect</b>, <b>SQLPrepare</b>, or <b>SQLSetPos</b>.</p>
</font></BODY>
</HTML>
