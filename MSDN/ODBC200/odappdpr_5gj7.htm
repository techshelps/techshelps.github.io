<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Rules for Conversions</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcrules_for_conversions"></a>Rules for Conversions</h1>
<p>
The rules in this section apply for conversions involving numeric literals. For the purposes of these rules, the following terms are defined:
<ul type=disc>
<li>
<i>Store assignment:</i> When you are sending data into a table column in a database. This occurs during calls to <b>SQLExecute</b>, <b>SQLExecDirect</b>, and <b>SQLSetPos</b>. During store assignment, “target” refers to a database column, and “source” refers to data in application buffers.<br><br></li>
<li>
<i>Retrieval assignment:</i> When you are retrieving data from the database into application buffers. This occurs during calls to <b>SQLFetch</b>, <b>SQLGetData</b>, <b>SQLFetchScroll</b>, and <b>SQLSetPos</b>. During retrieval assignment, “target” refers to the application buffers, and “source” refers to the database column.<br><br></li>
<li>
<i>CS:</i> The value in the character source.<br><br></li>
<li>
<i>NT:</i> The value in the numeric target.<br><br></li>
<li>
<i>NS</i>: The value in the numeric source.<br><br></li>
<li>
<i>CT</i>: The value in the character target.<br><br></li>
<li>
Precision of an exact numeric literal: the number of digits it contains. <br><br></li>
<li>
The scale of an exact numeric literal: the number of digits to the right of the expressed or implied period.<br><br></li>
<li>
The precision of an approximate numeric literal: the precision of its mantissa.</li>
</ul>
<h1>Character Source to Numeric Target</h1>
<p>
The rules for converting from a character source (CS) to a numeric target (NT) are:
<ol>
<li>
Replace CS with the value obtained by removing any leading or trailing spaces in CS. If CS is not a valid <i>numeric-literal</i>, SQLSTATE 22018 (Invalid character value for cast specification) is returned.<br><br></li>
<li>
Replace CS with the value obtained by removing leading zeroes before the decimal point, trailing zeroes after the decimal point, or both.<br><br></li>
<li>
Convert CS to NT. If the conversion results in a loss of significant digits, then SQLSTATE 22003 (Numeric value out of range) is returned. If the conversion results in the loss of non-significant digits, then SQLSTATE 01S07 (Fractional truncation) is returned.</li>
</ol>
<h1>Numeric Source to Character Target</h1>
<p>
The rules for converting from a numeric source (NS) to a character target (CT) are:
<ol>
<li>
Let LT be the length in characters of CT. For retrieval assignment, LT is equal to the length of the buffer in characters minus the number of bytes in the null-termination character for this character set.<br><br></li>
<li>
Cases:</li>
</ol>
<ul type=disc>
<li>
If NS is an exact numeric type, then let YP equal the shortest character string that conforms to the definition of <i>exact-numeric-literal</i> such that the scale of YP is the same as the scale of NS, and the interpreted value of YP is the absolute value of NS.<br><br></li>
<li>
If NS is an approximate numeric type, then let YP be a character string as follows:<br><br></li>
<li>
Case:<ul type=disc>
<li>
If NS is equal to 0, then YP is 0.<br><br></li>
<li>
Let YSN be the shortest character string that conforms to the definition of exact-<i>numeric-literal</i> and whose interpreted value is the absolute value of NS. If the length of YSN is less than the (<i>precision</i> + 1) of the data type of NS, then let YP equal YSN.<br><br></li>
<li>
Otherwise, YP is the shortest character string that conforms to the definition of <i>approximate-numeric-literal </i>whose interpreted value is the absolute value of NS and whose <i>mantissa</i> consists of a single <i>digit</i> that is not '0', followed by a <i>period</i> and an <i>unsigned-integer</i>.</li>
</ul>
</li>
</ul>
<ol start=3>
<li>
Case:<ul type=disc>
<li>
If NS is less than 0, then let Y be the result of:<br><br></li>
<li>
'-' || YP<br><br></li>
<li>
where '||' is the string concatenation operator.<br><br></li>
<li>
Otherwise, let Y equal YP.</li>
</ul>
</li>
<li>
Let LY be the length in characters of Y.<br><br></li>
<li>
Case:</li>
</ol>
<ul type=disc>
<li>
If LY equals LT, then CT is set to Y.<br><br></li>
<li>
If LY is less than LT, then CT is set to Y extended on the right by appropriate number of spaces.<br><br></li>
<li>
Otherwise (LY &gt; LT), copy the first LT characters of Y into CT. Case:<ul type=disc>
<li>
If this is a store assignment, return the error SQLSTATE 22001 (String data, right truncated).<br><br></li>
<li>
If this is retrieval assignment, return the warning SQLSTATE 01004 (String data, right truncated). When the copy results in the loss of fractional digits (other than trailing zeros), then it is driver-defined whether one of the following occurs: <p class=tl>
(1) The driver truncates the string in Y to an appropriate scale (which can be zero also) and writes the result into CT.<br>
(2) The driver rounds the string in Y to an appropriate scale (which can be zero also) and writes the result into CT.<br>
(3) The driver neither truncates nor rounds, but just copies the first LT characters of Y into CT.</P></li>
</ul>
</li>
</ul>
</font></BODY>
</HTML>
