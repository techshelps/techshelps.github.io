<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLConnect</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlconnect"></a>SQLConnect</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 1.0<br>
Standards Compliance:ISO 92</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLConnect</b> establishes connections to a driver and a data source. The connection handle references storage of all information about the connection to the data source, including status, transaction state, and error information.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLConnect</b>(<br>
SQLHDBC<i>ConnectionHandle</i>,<br>
SQLCHAR *<i>ServerName</i>,<br>
SQLSMALLINT<i>NameLength1</i>,<br>
SQLCHAR *<i>UserName</i>,<br>
SQLSMALLINT<i>NameLength2</i>,<br>
SQLCHAR *<i>Authentication</i>,<br>
SQLSMALLINT<i>NameLength3</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>ConnectionHandle</i></p>
<p class=indent>
[Input]<br>
Connection handle.</p>
<p class=dt>
<i>ServerName</i></p>
<p class=indent>
[Input]<br>
Data source name. For information about how an application chooses a data source, see “<a href="odch06pr_4p82.htm">Choosing a Data Source or Driver</a>” in Chapter 6, “Connecting to a Data Source or Driver.”</p>
<p class=dt>
<i>NameLength1</i></p>
<p class=indent>
[Input]<br>
Length of *<i>ServerName</i>.</p>
<p class=dt>
<i>UserName</i></p>
<p class=indent>
[Input]<br>
User identifier.</p>
<p class=dt>
<i>NameLength2</i></p>
<p class=indent>
[Input]<br>
Length of *<i>UserName</i>.</p>
<p class=dt>
<i>Authentication</i></p>
<p class=indent>
[Input]<br>
Authentication string (typically the password).</p>
<p class=dt>
<i>NameLength3</i></p>
<p class=indent>
[Input]<br>
Length of *<i>Authentication</i>.</p>
<p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLConnect</b> returns SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value can be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_DBC and a <i>Handle</i> of <i>ConnectionHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLConnect</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>01S02</td>
<td width=26%>Option value changed</td>
<td width=52%>The driver did not support the specified value of the <i>ValuePtr </i>argument in <b>SQLSetConnectAttr</b> and substituted a similar value. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>08001</td>
<td width=26%>Client unable to establish connection</td>
<td width=52%>The driver was unable to establish a connection with the data source.</td>
</tr>
<tr valign=top>
<td width=22%>08002</td>
<td width=26%>Connection name in use</td>
<td width=52%>(DM) The specified <i>ConnectionHandle</i> had already been used to establish a connection with a data source and the connection was still open or the user was browsing for a connection.</td>
</tr>
<tr valign=top>
<td width=22%>08004</td>
<td width=26%>Server rejected the connection</td>
<td width=52%>The data source rejected the establishment of the connection for implementation-defined reasons.</td>
</tr>
<tr valign=top>
<td width=22%>08S01</td>
<td width=26%>Communication link failure</td>
<td width=52%>The communication link between the driver and the data source to which the driver was attempting to connect failed before the function completed processing.</td>
</tr>
<tr valign=top>
<td width=22%>28000</td>
<td width=26%>Invalid authorization specification</td>
<td width=52%>The value specified for the argument <i>UserName</i> or the value specified for the argument <i>Authentication</i> violated restrictions defined by the data source.</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation<br>
error</td>
<td width=52%>(DM) The Driver Manager was unable to allocate memory required to support execution or completion of the function.<p>
The driver was unable to allocate memory required to support execution or completion of the function.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HY090</td>
<td width=26%>Invalid string or buffer length </td>
<td width=52%>(DM) The value specified for argument <i>NameLength1, NameLength2</i>, or <i>NameLength3 </i>was less than 0, but not equal to SQL_NTS.<p>
(DM) The value specified for argument <i>NameLength1</i> exceeded the maximum length for a data source name.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HYT00</td>
<td width=26%>Timeout expired</td>
<td width=52%>The query timeout period expired before the connection to the data source completed. The timeout period is set through <b>SQLSetConnectAttr</b>, SQL_ATTR_LOGIN_TIMEOUT.</td>
</tr>
<tr valign=top>
<td width=22%>HYT01</td>
<td width=26%>Connection timeout expired</td>
<td width=52%>The connection timeout period expired before the data source responded to the request. The connection timeout period is set through <b>SQLSetConnectAttr</b>, SQL_ATTR_CONNECTION_TIMEOUT.</td>
</tr>
<tr valign=top>
<td width=22%>IM001</td>
<td width=26%>Driver does not support this function</td>
<td width=52%>(DM) The driver specified by the data source name does not support the function.</td>
</tr>
<tr valign=top>
<td width=22%>IM002</td>
<td width=26%>Data source not found and no default driver specified</td>
<td width=52%>(DM) The data source name specified in the argument <i>ServerName</i> was not found in the system information, nor was there a default driver specification.</td>
</tr>
<tr valign=top>
<td width=22%>IM003</td>
<td width=26%>Specified driver could not be connected to</td>
<td width=52%>(DM) The driver listed in the data source specification in system information was not found or could not be connected to for some other reason.</td>
</tr>
<tr valign=top>
<td width=22%>IM004</td>
<td width=26%>Driver’s SQLAllocHandle on SQL_HANDLE_<br>
ENV failed</td>
<td width=52%>(DM) During <b>SQLConnect</b>, the Driver Manager called the driver’s <b>SQLAllocHandle</b> function with a <i>HandleType</i> of SQL_HANDLE_ENV and the driver returned an error.</td>
</tr>
<tr valign=top>
<td width=22%>IM005</td>
<td width=26%>Driver’s SQLAllocHandle on SQL_HANDLE_<br>
DBC failed</td>
<td width=52%>(DM) During <b>SQLConnect</b>, the Driver Manager called the driver’s <b>SQLAllocHandle</b> function with a <i>HandleType</i> of SQL_HANDLE_DBC and the driver returned an error.</td>
</tr>
<tr valign=top>
<td width=22%>IM006</td>
<td width=26%>Driver’s SQLSetConnectAttr failed</td>
<td width=52%>During <b>SQLConnect</b>, the Driver Manager called the driver’s <b>SQLSetConnectAttr</b> function and the driver returned an error. (Function returns SQL_SUCCESS_WITH_INFO).</td>
</tr>
<tr valign=top>
<td width=22%>IM009</td>
<td width=26%>Unable to connect to translation DLL</td>
<td width=52%>The driver was unable to connect to the translation DLL that was specified for the data source.</td>
</tr>
<tr valign=top>
<td width=22%>IM010</td>
<td width=26%>Data source name too long</td>
<td width=52%>(DM) <i>*ServerName</i> was longer than SQL_MAX_DSN_LENGTH characters.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
For information about why an application uses <b>SQLConnect</b>, see “<a href="odch06pr_0g8k.htm">Connecting with SQLConnect</a>” in Chapter 6, “Connecting to a Data Source or Driver.”</p>
<p>
The Driver Manager does not connect to a driver until the application calls a function (<b>SQLConnect</b>, <b>SQLDriverConnect</b>, or <b>SQLBrowseConnect</b>) to connect to the driver. Until that point, the Driver Manager works with its own handles and manages connection information. When the application calls a connection function, the Driver Manager checks whether a driver is currently connected to for the specified <i>ConnectionHandle</i>:
<ul type=disc>
<li>
If a driver is not connected to, the Driver Manager connects to the driver and calls <b>SQLAllocHandle</b> with a <i>HandleType </i>of SQL_HANDLE_ENV, <b>SQLAllocHandle</b> with a <i>HandleType</i> of SQL_HANDLE_DBC, <b>SQLSetConnectAttr</b> (if the application specified any connection attributes), and the connection function in the driver. The Driver Manager returns SQLSTATE IM006 (Driver’s <b>SQLSetConnectOption</b> failed) and SQL_SUCCESS_WITH_INFO for the connection function if the driver returned an error for <b>SQLSetConnectAttr</b>. For more information, see Chapter 6, “<a href="odch06pr_3smq.htm">Connecting to a Data Source or Driver</a>.”<br><br></li>
<li>
If the specified driver is already connected to on the <i>ConnectionHandle</i>, the Driver Manager only calls the connection function in the driver. In this case, the driver must make sure that all connection attributes for the <i>ConnectionHandle</i> maintain their current settings.<br><br></li>
<li>
If a different driver is connected to, the Driver Manager calls <b>SQLFreeHandle</b> with a <i>HandleType</i> of SQL_HANDLE_DBC, and then, if no other driver is connected to in that environment, it calls <b>SQLFreeHandle</b> with a <i>HandleType</i> of SQL_HANDLE_ENV in the connected driver and then disconnects that driver. It then performs the same operations as when a driver is not connected to.</li>
</ul>
<p>
The driver then allocates handles and initializes itself.</p>
<p>
When the application calls <b>SQLDisconnect</b>, the Driver Manager calls <b>SQLDisconnect</b> in the driver. However, it does not disconnect the driver. This keeps the driver in memory for applications that repeatedly connect to and disconnect from a data source. When the application calls <b>SQLFreeHandle</b> with a <i>HandleType</i> of SQL_HANDLE_DBC, the Driver Manager calls <b>SQLFreeHandle</b> with a <i>HandleType</i> of SQL_HANDLE_DBC and then <b>SQLFreeHandle</b> with a <i>HandleType</i> of SQL_HANDLE_ENV in the driver, and then disconnects the driver.</p>
<p>
An ODBC application can establish more than one connection.</p>
<h1>Driver Manager Guidelines</h1>
<p>
The contents of *<i>ServerName</i> affect how the Driver Manager and a driver work together to establish a connection to a data source.
<ul type=disc>
<li>
If *<i>ServerName</i> contains a valid data source name, the Driver Manager locates the corresponding data source specification in the system information and connects to the associated driver. The Driver Manager passes each <b>SQLConnect</b> argument to the driver.<br><br></li>
<li>
If the data source name cannot be found or <i>ServerName</i> is a null pointer, the Driver Manager locates the default data source specification and connects to the associated driver. The Driver Manager passes to the driver the <i>UserName</i> and <i>Authentication</i> arguments unmodified, and “DEFAULT” for the <i>ServerName</i> argument.<br><br></li>
<li>
If the <i>ServerName</i> argument is “DEFAULT,” the Driver Manager locates the default data source specification and connects to the associated driver. The Driver Manager passes each <b>SQLConnect</b> argument to the driver.<br><br></li>
<li>
If the data source name cannot be found or <i>ServerName</i> is a null pointer, and the default data source specification does not exist, the Driver Manager returns SQL_ERROR with SQLSTATE IM002 (Data source name not found and no default driver specified).</li>
</ul>
<p>
After being connected to by the Driver Manager, a driver can locate its corresponding data source specification in the system information and use driver-specific information from the specification to complete its set of required connection information.</p>
<p>
If a default translation library is specified in the system information for the data source, the driver connects to it. A different translation library can be connected to by calling <b>SQLSetConnectAttr</b> with the SQL_ATTR_TRANSLATE_LIB attribute. A translation option can be specified by calling <b>SQLSetConnectAttr</b> with the SQL_ATTR_TRANSLATE_OPTION attribute.</p>
<p>
If a driver supports <b>SQLConnect</b>, the driver keyword section of the system information for the driver must contain the <b>ConnectFunctions</b> keyword with the first character set to “Y.” </p>
<h1>Connection Pooling</h1>
<p>
Connection pooling allows an application to reuse a connection that has already been created. When connection pooling is enabled and <b>SQLConnect</b> is called, the Driver Manager attempts to make the connection using a connection that is part of a pool of connections in an environment that has been designated for connection pooling. This environment is a shared environment that is used by all applications that use the connections in the pool.</p>
<p>
Connection pooling is enabled before the environment is allocated by calling <b>SQLSetEnvAttr</b> to set SQL_ATTR_CONNECTION_POOLING to SQL_CP_ONE_PER_DRIVER (which specifies a maximum of one pool per driver) or SQL_CP_ONE_PER_HENV (which specifies a maximum of one pool per environment). <b>SQLSetEnvAttr</b> in this case is called with <i>EnvironmentHandle</i> set to null, which makes the attribute a process-level attribute. If SQL_ATTR_CONNECTION_POOLING is set to SQL_CP_OFF, connection pooling is disabled.</p>
<p>
Once connection pooling has been enabled, <b>SQLAllocHandle</b> with a <i>HandleType</i> of SQL_HANDLE_ENV is called to allocate an environment. The environment allocated by this call is a shared environment because connection pooling has been enabled. The environment to be used is not determined, however, until <b>SQLAllocHandle</b> with a <i>HandleType</i> of SQL_HANDLE_DBC is called.</p>
<p>
<b>SQLAllocHandle</b> with a <i>HandleType</i> of SQL_HANDLE_DBC is called to allocate a connection. The Driver Manager attempts to find an existing shared environment that matches the environment attributes set by the application. If no such environment exists, one is created as an implicit <i>shared environment</i>. If a matching shared environment is found, the environment handle is returned to the application, and its reference count is incremented.</p>
<p>
The connection to be used is not determined, however, until <b>SQLConnect</b> is called. At that point, the Driver Manager attempts to find an existing connection in the connection pool that matches the criteria requested by the application. This criteria includes the connection options requested in the call to <b>SQLConnect</b> (the values of the <i>ServerName</i>, <i>UserName</i>, and <i>Authentication</i> keywords) and any connection attributes set since <b>SQLAllocHandle</b> with a <i>HandleType</i> of SQL_HANDLE_DBC was called. The Driver Manager checks this criteria against the corresponding connection keywords and attributes in connections in the pool. If a match is found, the connection in the pool is used. If no match is found, a new connection is created.</p>
<p>
If the SQL_ATTR_CP_MATCH environment attribute is set to SQL_CP_STRICT_MATCH, the match must be exact for a connection in the pool to be used. If the SQL_ATTR_CP_MATCH environment attribute is set to SQL_CP_RELAXED_MATCH, the connection options in the call to <b>SQLConnect</b> must match, but not all of the connection attributes must match.</p>
<p>
The following rules are applied when a connection attribute, as set by the application before <b>SQLConnect</b> is called, does not match the connection attribute of the connection in the pool:
<ul type=disc>
<li>
If the connection attribute must be set before the connection is made:<p class=tl>
If SQL_ATTR_CP_MATCH is SQL_CP_STRICT_MATCH, SQL_ATTR_PACKET_SIZE in the pooled connection must be identical to the attribute set by the application. If SQL_CP_RELAXED_MATCH, the values of SQL_ATTR_PACKET_SIZE can be different.</P><p class=tl>
The value of SQL_ATTR_LOGIN_VALUE does not affect the match.</P></li>
<li>
If the connection attribute can be set either before or after the connection is made:<p class=tl>
If the connection attribute has not been set by the application, but has been set on the connection in the pool, and there is a default, the connection attribute in the pooled connection is set back to the default, and a match is declared. If there is no default, the pooled connection is not considered a match.</P><p class=tl>
If the connection attribute has been set by the application, but has not been set on the connection in the pool, the connection attribute on the pool is changed to that set by the application, and a match is declared.</P><p class=tl>
If the connection attribute has been set by the application, and has also been set on the connection in the pool, but the values are different, the value of the application’s connection attribute is used, and a match is declared.</P></li>
<li>
If the values of driver-specific connection attributes are not identical and SQL_ATTR_CP_MATCH is set to SQL_CP_STRICT_MATCH, the connection in the pool is not used.</li>
</ul>
<p>
When the application calls <b>SQLDisconnect</b> to disconnect, the connection is returned to the connection pool, and is available for reuse.</p>
<p>
When Connection Pooling is enabled and the database server has become unavailable, the Driver Manager attempts to re-establish a connection to the server repeatedly. <b>ODBCSetTryWaitValue</b> and <b>ODBCGetTryWaitValue</b> prevent this, and consequently, the large number of generated requests. <b>ODBCSetTryWaitValue</b> saves the information in the registry at the following location:</p>
<p>
HKEY_LOCAL_MACHINE<br>
SOFTWARE<br>
Odbc<br>
Odbcinst.ini<br>
ODBC Connection Pooling<br>
Retry Wait</p>
<p>
If there is a bad connection in the pool, the ODBC Driver Manager will attempt to connect before the connection can be reused for the first time. If the connection still fails, the ODBC Driver Manager returns the error and marks the connection with the time. From that point until the <b>RetryWait</b> value expires, the ODBC Driver Manager returns a failure without testing the connection.</p>
<pre><code>BOOL ODBCSetTryWaitValue ( DWORD dwValue );</code></pre>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>dwValue</i> [Input]</p>
<p class=indent>
The number of seconds to wait until the Driver Manager attempts to connect again.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns TRUE if it is successful, FALSE if it fails.</p>
<pre><code>DWORD ODBCGetTryWaitValue ( );
</code></pre>
<p class=label>
<b>Arguments</b></p>
<p>
None.</p>
<p class=label>
<b>Returns</b></p>
<p>
The function returns a <b>DWORD</b> value containing the number of seconds the Driver Manager will wait before attempting to connect again.</p>
<p class=label>
<b>Optimizing Connection Pooling Performance</b></p>
<p>
When distributed transactions are involved, it is possible to optimize connection pooling performance by using <b>SQL_DTC_TRANSITION_COST</b>, which is a SQLUINTEGER bitmask. The transitions referred to are the transitions of the connection attribute SQL_ATTR_ENLIST_IN_DTC going from value 0 to nonzero, and vice versa. This is a connection going from not enlisted in a distributed transaction to enlisted in a distributed transaction, and vice versa. Depending on how the driver has implemented enlistment (setting connection attribute SQL_ATTR_ENLIST_IN_DTC), these transitions may be expensive and should therefore be avoided for best performance.</p>
<p>
The value returned by the driver contains any combination of the following bits:
<ul type=disc>
<li>
<b>SQL_DTC_ENLIST_EXPENSIVE, </b>when set, implies the zero to nonzero transition is significantly more expensive than a transition from nonzero to another nonzero value (enlisting a previously enlisted connection in its next transaction).<br><br></li>
<li>
<b>SQL_DTC_UNENLIST_EXPENSIVE, </b>when set, implies the nonzero to zero transition is significantly more expensive than using a connection whose SQL_ATTR_ENLIST_IN_DTC attribute is already set to zero.</li>
</ul>
<p>
There is a performance vs. connection usage tradeoff. If a driver indicates that one or more of these transitions are expensive, then the driver manager's connection pooler responds to this by keeping more connections in the pool. Some of the connections in the pool are preferred for nontransactional use, and some are preferred for transactional use. However, if the driver indicates that these transitions are not expensive, then fewer connections may be used, perhaps alternating between nontransactional and transactional use.</p>
<p>
Drivers that do not support SQL_ATTR_ENLIST_IN_DTC do not need to support SQL_DTC_TRANSITION_COST. For drivers that support SQL_ATTR_ENLIST_IN_DTC but not SQL_DTC_TRANSITION_COST, it is assumed that the transitions are not expensive, as though the driver returned 0 (no bits set) for this value.</p>
<p>
Although SQL_DTC_TRANSITION_COST was introduced in ODBC 3.5, a ODBC 2.<i>x</i> driver can also support it because the driver manager will query this information regardless of the driver version.</p>
<p class=label>
<b>Code Example</b></p>
<p>
In the following example, an application allocates environment and connection handles. It then connects to the SalesOrders data source with the user ID JohnS and the password Sesame and processes data. When it has finished processing data, it disconnects from the data source and frees the handles.</p>
<pre><code>SQLHENV&nbsp; henv;
SQLHDBC&nbsp; hdbc;
SQLHSTMT hstmt;
SQLRETURN&nbsp; retcode;

      /*Allocate environment handle */
retcode = SQLAllocHandle(SQL_HANDLE_ENV, SQL_NULL_HANDLE, &amp;henv);&nbsp; 

if (retcode == SQL_SUCCESS || retcode == SQL_SUCCESS_WITH_INFO) {
   /* Set the ODBC version environment attribute */
   retcode = SQLSetEnvAttr(henv, SQL_ATTR_ODBC_VERSION, (void*)SQL_OV_ODBC3, 0); 

   if (retcode == SQL_SUCCESS || retcode == SQL_SUCCESS_WITH_INFO) {
      /* Allocate connection handle */
      retcode = SQLAllocHandle(SQL_HANDLE_DBC, henv, &amp;hdbc); 

      if (retcode == SQL_SUCCESS || retcode == SQL_SUCCESS_WITH_INFO) {
         /* Set login timeout to 5 seconds. */
         SQLSetConnectAttr(hdbc, (void*)SQL_LOGIN_TIMEOUT, 5, 0);

         /* Connect to data source */
         retcode = SQLConnect(hdbc, (SQLCHAR*) "Sales", SQL_NTS,
       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (SQLCHAR*) "JohnS", SQL_NTS,
       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (SQLCHAR*) "Sesame", SQL_NTS);

         if (retcode == SQL_SUCCESS || retcode == SQL_SUCCESS_WITH_INFO){
            /* Allocate statement handle */
            retcode = SQLAllocHandle(SQL_HANDLE_STMT, hdbc, &amp;hstmt); 

            if (retcode == SQL_SUCCESS || retcode == SQL_SUCCESS_WITH_INFO) {
            /* Process data */
               ...;
               ...;
               ...;

               SQLFreeHandle(SQL_HANDLE_STMT, hstmt);
            }
            SQLDisconnect(hdbc);
         }
         SQLFreeHandle(SQL_HANDLE_DBC, hdbc);
      }
   }
   SQLFreeHandle(SQL_HANDLE_ENV, henv);
</code></pre>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Allocating a handle</td>
<td width=52%><a href="odch21bpr_689x.htm">SQLAllocHandle</a></td>
</tr>
<tr valign=top>
<td width=48%>Discovering and enumerating values required to connect to a data source</td>
<td width=52%><a href="odch21bpr_15bo.htm">SQLBrowseConnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Disconnecting from a data source</td>
<td width=52%><a href="odch21dpr_26us.htm">SQLDisconnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Connecting to a data source using a connection string or dialog box</td>
<td width=52%><a href="odch21dpr_4ed0.htm">SQLDriverConnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Returning the setting of a connection attribute</td>
<td width=52%><a href="odch21fpr_0j1u.htm">SQLGetConnectAttr</a></td>
</tr>
<tr valign=top>
<td width=48%>Setting a connection attribute</td>
<td width=52%><a href="odch21jpr_4zn6.htm">SQLSetConnectAttr</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
