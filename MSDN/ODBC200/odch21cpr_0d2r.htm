<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLDataSources</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqldatasources"></a>SQLDataSources</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 1.0<br>
Standards Compliance:ISO 92</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLDataSources</b> returns information about a data source. This function is implemented solely by the Driver Manager.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLDataSources</b>(<br>
SQLHENV<i>EnvironmentHandle</i>,<br>
SQLUSMALLINT<i>Direction</i>,<br>
SQLCHAR *<i>ServerName</i>,<br>
SQLSMALLINT<i>BufferLength1</i>,<br>
SQLSMALLINT *<i>NameLength1Ptr</i>,<br>
SQLCHAR *<i>Description</i>,<br>
SQLSMALLINT<i>BufferLength2</i>,<br>
SQLSMALLINT *<i>NameLength2Ptr</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>EnvironmentHandle</i></p>
<p class=indent>
[Input]<br>
Environment handle.</p>
<p class=dt>
<i>Direction</i></p>
<p class=indent>
[Input]<br>
Determines which data source the Driver Manager returns information on. Can be:</p>
<p class=tl>
SQL_FETCH_NEXT (to fetch the next data source name in the list), SQL_FETCH_FIRST (to fetch from the beginning of the list), SQL_FETCH_FIRST_USER (to fetch the first user DSN), or SQL_FETCH_FIRST_SYSTEM (to fetch the first system DSN).</P><p class=tl>
When <i>Direction</i> is set to SQL_FETCH_FIRST, subsequent calls to <b>SQLDataSources</b> with <i>Direction</i> set to SQL_FETCH_NEXT return both user and system DSNs. When <i>Direction</i> is set to SQL_FETCH_FIRST_USER, all subsequent calls to <b>SQLDataSources</b> with <i>Direction</i> set to SQL_FETCH_NEXT return only user DSNs. When <i>Direction</i> is set to SQL_FETCH_FIRST_SYSTEM, all subsequent calls to <b>SQLDataSources</b> with <i>Direction</i> set to SQL_FETCH_NEXT return only system DSNs.</P><p class=dt>
<i>ServerName</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the data source name.</p>
<p class=dt>
<i>BufferLength1</i></p>
<p class=indent>
[Input]<br>
Length of the *<i>ServerName</i> buffer, in bytes; this does not need to be longer than SQL_MAX_DSN_LENGTH plus the null-termination character.</p>
<p class=dt>
<i>NameLength1Ptr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the total number of bytes (excluding the null-termination byte) available to return in *<i>ServerName</i>. If the number of bytes available to return is greater than or equal to <i>BufferLength1</i>, the data source name in *<i>ServerName</i> is truncated to <i>BufferLength1</i> minus the length of a null-termination character.</p>
<p class=dt>
<i>Description</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the description of the driver associated with the data source. For example, dBASE or SQL Server.</p>
<p class=dt>
<i>BufferLength2</i></p>
<p class=indent>
[Input]<br>
Length of the *<i>Description</i> buffer.</p>
<p class=dt>
<i>NameLength2Ptr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the total number of bytes (excluding the null-termination byte) available to return in *<i>Description</i>. If the number of bytes available to return is greater than or equal to <i>BufferLength2</i>, the driver description in *<i>Description</i> is truncated to <i>BufferLength2</i> minus the length of a null-termination character.</p>
<p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLDataSources</b> returns either SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value may be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_ENV and a <i>Handle</i> of <i>EnvironmentHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLDataSources</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>(DM) Driver Manager&nbsp;–&nbsp;specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>01004</td>
<td width=26%>String data, right truncated</td>
<td width=52%>(DM) The buffer *<i>ServerName</i> was not large enough to return the entire data source name, so the name was truncated. The length of the entire data source name is returned in *<i>NameLength1Ptr</i>. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%></td>
<td width=26%></td>
<td width=52%>(DM) The buffer *<i>Description</i> was not large enough to return the entire driver description, so the description was truncated. The length of the untruncated data source description is returned in *<i>NameLength2Ptr</i>. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>(DM) An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation error</td>
<td width=52%>(DM) The Driver Manager was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HY090</td>
<td width=26%>Invalid string or buffer length</td>
<td width=52%>(DM) The value specified for argument <i>BufferLength1</i> was less than 0.<p>
(DM) The value specified for argument <i>BufferLength2</i> was less than 0.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY103</td>
<td width=26%>Invalid retrieval code</td>
<td width=52%>(DM) The value specified for the argument <i>Direction</i> was not equal to SQL_FETCH_FIRST, SQL_FETCH_FIRST_USER, SQL_FETCH_FIRST_SYSTEM, or SQL_FETCH_NEXT.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
Because <b>SQLDataSources</b> is implemented in the Driver Manager, it is supported for all drivers regardless of a particular driver’s standards compliance.</p>
<p>
An application can call <b>SQLDataSources</b> multiple times to retrieve all data source names. The Driver Manager retrieves this information from the system information. When there are no more data source names, the Driver Manager returns SQL_NO_DATA. If <b>SQLDataSources</b> is called with SQL_FETCH_NEXT immediately after it returns SQL_NO_DATA, it will return the first data source name. For information about how an application uses the information returned by <b>SQLDataSources</b>, see “<a href="odch06pr_4p82.htm">Choosing a Data Source or Driver</a>” in Chapter 6, “Connecting to a Data Source or Driver.”</p>
<p>
If SQL_FETCH_NEXT is passed to <b>SQLDataSources</b> the very first time it is called, it will return the first data source name.</p>
<p>
The driver determines how data source names are mapped to actual data sources.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Discovering and listing values required to connect to a data source</td>
<td width=52%><a href="odch21bpr_15bo.htm">SQLBrowseConnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Connecting to a data source</td>
<td width=52%><a href="odch21cpr_7stw.htm">SQLConnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Connecting to a data source using a connection string or dialog box</td>
<td width=52%><a href="odch21dpr_4ed0.htm">SQLDriverConnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Returning driver descriptions and attributes</td>
<td width=52%><a href="odch21dpr_3pwz.htm">SQLDrivers</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
