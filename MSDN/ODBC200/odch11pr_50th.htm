<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cursor Characteristics and Cursor Type</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbccursor_characteristics_and_cursor_type"></a>Cursor Characteristics and Cursor Type</h3>
<p>
An application can specify the characteristics of a cursor rather than specifying the cursor type (forward-only, static, keyset-driven, or dynamic). To do so, the application selects the cursor’s scrollability (by setting the SQL_ATTR_CURSOR_SCROLLABLE statement attribute) and sensitivity (by setting the SQL_ATTR_CURSOR_SENSITIVITY statement attribute) before opening the cursor on the statement handle. The driver then chooses the cursor type that most efficiently provides the characteristics that the application requested.</p>
<p>
Whenever an application sets any of the statement attributes SQL_ATTR_CONCURRENCY, SQL_ATTR_CURSOR_SCROLLABLE, SQL_ATTR_CURSOR_SENSITIVITY, or SQL_ATTR_CURSOR_TYPE, the driver makes any required change to the other statement attributes in this set of four attributes, so that their values remain consistent. As a result, when the application specifies a cursor characteristic, the driver can change the attribute that indicates cursor type based on this implicit selection; when the application specifies a type, the driver can change any of the other attributes to be consistent with the characteristics of the selected type. For more information on these statement attributes, see the <a href="odch21kpr_77jm.htm">SQLSetStmtAttr</a> function description.</p>
<p>
An application that sets statement attributes to specify both a cursor type and cursor characteristics runs the risk of obtaining a cursor that is not the most efficient method available on that driver of meeting the application’s requirements.</p>
<p>
The implicit setting of statement attributes is driver-defined except that it must follow these rules:
<ul type=disc>
<li>
Forward-only cursors are never scrollable; see the definition of SQL_ATTR_CURSOR_SCROLLABLE in <a href="odch21kpr_77jm.htm">SQLSetStmtAttr</a>.<br><br></li>
<li>
Insensitive cursors are never updatable (and thus their concurrency is read-only); this is based on their definition of insensitive cursors in the ISO SQL standard.</li>
</ul>
<p>
Consequently, the implicit setting of statement attributes occurs in the following cases:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Application sets attribute to</b></td>
<td class=label width=50%><b>Other attributes set implicitly</b></td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CONCURRENCY to SQL_CONCUR_READ_ONLY</td>
<td width=50%>SQL_ATTR_CURSOR_SENSITIVITY to SQL_INSENSITIVE</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CONCURRENCY to SQL_CONCUR_LOCK, SQL_CONCUR_ROWVER, or SQL_CONCUR_VALUES</td>
<td width=50%>SQL_ATTR_CURSOR_SENSITIVITY to SQL_UNSPECIFIED or SQL_SENSITIVE, as defined by the driver. It can never be set to SQL_INSENSITIVE, because insensitive cursors are always read-only.</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_SCROLLABLE to SQL_NONSCROLLABLE</td>
<td width=50%>SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_FORWARD_ONLY</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_SCROLLABLE to SQL_SCROLLABLE</td>
<td width=50%>SQL_ATTR_CURSOR_TYPE to either SQL_CURSOR_STATIC, SQL_CURSOR_KEYSET_DRIVEN, or SQL_CURSOR_DYNAMIC, as specified by the driver. It is never set to SQL_CURSOR_FORWARD_ONLY.</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_SENSITIVITY to SQL_INSENSITIVE</td>
<td width=50%>SQL_ATTR_CONCURRENCY to SQL_CONCUR_READ_ONLY <p>
SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_STATIC</p>
</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_SENSITIVITY to SQL_SENSITIVE</td>
<td width=50%>SQL_ATTR_CONCURRENCY to SQL_CONCUR_LOCK, SQL_CONCUR_ROWVER, or SQL_CONCUR_VALUES, as specified by the driver. It is never set to SQL_CONCUR_READ_ONLY<p>
SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_FORWARD_ONLY, SQL_CURSOR_STATIC, SQL_CURSOR_KEYSET_DRIVEN, or SQL_CURSOR_DYNAMIC, as specified by the driver</p>
</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_SENSITIVITY to SQL_UNSPECIFIED</td>
<td width=50%>SQL_ATTR_CONCURRENCY to SQL_CONCUR_READ_ONLY, SQL_CONCUR_LOCK, SQL_CONCUR_ROWVER, or SQL_CONCUR_VALUES, as specified by the driver<p>
SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_FORWARD_ONLY, SQL_CURSOR_STATIC, SQL_CURSOR_KEYSET_DRIVEN, or SQL_CURSOR_DYNAMIC, as specified by the driver</p>
</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_DYNAMIC</td>
<td width=50%>SQL_ATTR_SCROLLABLE to SQL_SCROLLABLE <p>
SQL_ATTR_CURSOR_SENSITIVITY to SQL_SENSITIVE (but only if SQL_ATTR_CONCURRENCY is not equal to SQL_CONCUR_READ_ONLY. Updatable dynamic cursors are always sensitive to changes made in their own transaction.)</p>
</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_FORWARD_ONLY</td>
<td width=50%>SQL_ATTR_CURSOR_SCROLLABLE to SQL_NONSCROLLABLE</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_KEYSET_DRIVEN</td>
<td width=50%>SQL_ATTR_SCROLLABLE to SQL_SCROLLABLE <p>
SQL_ATTR_SENSITIVITY to SQL_UNSPECIFIED or SQL_SENSITIVE (according to driver-defined criteria, if SQL_ATTR_CONCURRENCY is not SQL_CONCUR_READ_ONLY)</p>
</td>
</tr>
<tr valign=top>
<td width=50%>SQL_ATTR_CURSOR_TYPE to SQL_CURSOR_STATIC</td>
<td width=50%>SQL_ATTR_SCROLLABLE to SQL_SCROLLABLE <p>
SQL_ATTR_SENSITIVITY to SQL_INSENSITIVE (if SQL_ATTR_CONCURRENCY is SQL_CONCUR_READ_ONLY)</p>
<p>
SQL_ATTR_SENSITIVITY to SQL_UNSPECIFIED or SQL_SENSITIVE (if SQL_ATTR_CONCURRENCY is not SQL_CONCUR_READ_ONLY)</p>
</td>
</tr>
</table><br>
</font></BODY>
</HTML>
