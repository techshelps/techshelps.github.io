<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Building an Auto Test</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="building_an_auto_test"></a>Building an Auto Test</h1>
<p>
To build an auto-test DLL from code you have written, change your directory to \Samples\Odbc\Quiktest. You can use the \Samples\Odbc\Quiktest\Qtbuild.bat file to set the proper environment and invoke the appropriate compiler and linker.</p>
<p>
<b>QTBUILD</b> <i>tstname</i> [<i>option</i>s]</p>
<p>
where <i>tstname</i> is the base name of your .C file and <i>options</i> are one or more of the following:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>Option</b></td>
<td class=label width=78%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=22%>-CLEAN</td>
<td width=78%>Build all targets, even if the targets are not out of date with respect to their dependencies.</td>
</tr>
<tr valign=top>
<td width=22%>-DEBUG32</td>
<td width=78%>Build the 32-bit debug version in the \Samples\Odbc\Quiktest\Debug32 directory.</td>
</tr>
<tr valign=top>
<td width=22%>-NDEBUG32</td>
<td width=78%>Build the 32-bit non-debug version in the \Samples\Odbc\Quiktest\Ndebug32 directory.</td>
</tr>
<tr valign=top>
<td width=22%>-?</td>
<td width=78%>Display usage information.</td>
</tr>
</table><br>
<p>
QTBUILD.BAT calls NMAKE, the Microsoft Program Maintenance Utility provided with Microsoft C, version 7.0 or later, to process MAKEFILE to build the auto test DLL. If MAKEFILE is not modified, QTBUILD.BAT rebuilds the original QUIKTEST.DLL.</p>
<h3>Required Files</h3>
<p>
To build an auto test, QTbuild.exe needs the following files:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>File Name</b></td>
<td class=label width=78%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>autotest.h</td>
<td width=78%>Include file containing the constants and prototypes required to build an auto-test DLL. All auto tests must include this file.</td>
</tr>
<tr valign=top>
<td width=22%>dllstub.c</td>
<td width=78%>Source file containing the library entry points for 16- and 32-bit DLLs.</td>
</tr>
<tr valign=top>
<td width=22%>Makefile</td>
<td width=78%>Makefile for auto test DLLs.</td>
</tr>
<tr valign=top>
<td width=22%><i>tstname</i>.c<br>
<i>tstname</i>1.c<br>
<i>tstname</i>2.c</td>
<td width=78%>Source files. Only <i>tstname</i>.c is required. However, if your auto test requires additional source files, the Makefile makefile requires that they are named <i>tstname</i>1.c and <i>tstname</i>2.c.</td>
</tr>
<tr valign=top>
<td width=22%><i>tstname</i>.h</td>
<td width=78%>Optional include file.</td>
</tr>
<tr valign=top>
<td width=22%><i>tstname</i>.rc</td>
<td width=78%>Optional resource file.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
