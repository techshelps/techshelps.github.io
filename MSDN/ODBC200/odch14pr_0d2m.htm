<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scrollable Cursors and Transaction Isolation</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcscrollable_cursors_and_transaction_isolation"></a>Scrollable Cursors and Transaction Isolation</h2>
<p>
The following table lists the factors governing the visibility of changes.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>Changes made by:</b></td>
<td class=label width=52%><b>Visibility depends on:</b></td>
</tr>
<tr valign=top>
<td width=48%>Cursor</td>
<td width=52%>Cursor type, cursor implementation</td>
</tr>
<tr valign=top>
<td width=48%>Other statements in same transaction</td>
<td width=52%>Cursor type</td>
</tr>
<tr valign=top>
<td width=48%>Statements in other transactions</td>
<td width=52%>Cursor type, transaction isolation level</td>
</tr>
</table><br>
<p>
These factors are illustrated here.</p>
<p>
<img src="pr23.gif" border=0></p>
<p class=label>
<b>Visibility of changes</b></p>
<p>
The following table summarizes the ability of each cursor type to detect changes made by itself, by other operations in its own transaction, and by other transactions. The visibility of the latter changes depends on the cursor type and the isolation level of the transaction containing the cursor.</p>
<table border=1 cellpadding=5 cols=7 frame=below rules=rows width=587>
<tr valign=top>
<td width=14%></td>
<td class=label width=14%><b><br>
<br>
Self</b></td>
<td class=label width=14%><b><br>
Own<br>
Txn</b></td>
<td class=label width=15%><b>Othr<br>
Txn<br>
(RU [a])</b></td>
<td class=label width=14%><b>Othr<br>
Txn<br>
(RC [a])</b></td>
<td class=label width=14%><b>Othr<br>
Txn<br>
(RR [a])</b></td>
<td class=label width=15%><b>Othr<br>
Txn<br>
(S [a])</b></td>
</tr>
<tr valign=top>
<td width=14%>Static</td>
<td width=14%></td>
<td width=14%></td>
<td width=15%></td>
<td width=14%></td>
<td width=14%></td>
<td width=15%></td>
</tr>
<tr valign=top>
<td width=14%> Insert</td>
<td width=14%>Maybe [b]</td>
<td width=14%>No</td>
<td width=15%>No</td>
<td width=14%>No</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%> Update</td>
<td width=14%>Maybe [b]</td>
<td width=14%>No</td>
<td width=15%>No</td>
<td width=14%>No</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%> Delete</td>
<td width=14%>Maybe [b]</td>
<td width=14%>No</td>
<td width=15%>No</td>
<td width=14%>No</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%>Keyset<br>
-driven</td>
<td width=14%></td>
<td width=14%></td>
<td width=15%></td>
<td width=14%></td>
<td width=14%></td>
<td width=15%></td>
</tr>
<tr valign=top>
<td width=14%> Insert</td>
<td width=14%>Maybe [b]</td>
<td width=14%>No</td>
<td width=15%>No</td>
<td width=14%>No</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%> Update</td>
<td width=14%>Yes</td>
<td width=14%>Yes</td>
<td width=15%>Yes</td>
<td width=14%>Yes</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%> Delete</td>
<td width=14%>Maybe [b]</td>
<td width=14%>Yes</td>
<td width=15%>Yes</td>
<td width=14%>Yes</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%>Dynamic</td>
<td width=14%></td>
<td width=14%></td>
<td width=15%></td>
<td width=14%></td>
<td width=14%></td>
<td width=15%></td>
</tr>
<tr valign=top>
<td width=14%> Insert</td>
<td width=14%>Yes</td>
<td width=14%>Yes</td>
<td width=15%>Yes</td>
<td width=14%>Yes</td>
<td width=14%>Yes</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%> Update</td>
<td width=14%>Yes</td>
<td width=14%>Yes</td>
<td width=15%>Yes</td>
<td width=14%>Yes</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
<tr valign=top>
<td width=14%> Delete</td>
<td width=14%>Yes</td>
<td width=14%>Yes</td>
<td width=15%>Yes</td>
<td width=14%>Yes</td>
<td width=14%>No</td>
<td width=15%>No</td>
</tr>
</table><br>
<p class=mini>
[a]&nbsp; The letters in parentheses indicate the isolation level of the transaction containing the cursor; the isolation level of the other transaction (in which the change was made) is irrelevant.</p>
<p class=mini>
RU: Read uncommitted<br>
RC: Read committed<br>
RR: Repeatable read<br>
S: Serializable</p>
<p class=mini>
[b]&nbsp; Depends on how the cursor is implemented. Whether the cursor can detect such changes is reported through the SQL_STATIC_SENSITIVITY option in <b>SQLGetInfo</b>.</p>
</font></BODY>
</HTML>
