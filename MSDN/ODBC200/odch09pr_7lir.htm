<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Executing Batches</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbcexecuting_batches"></a>Executing Batches</h3>
<p>
Before an application executes a batch of statements, it should first check whether they are supported. To do this, the application calls <b>SQLGetInfo</b> with the SQL_BATCH_SUPPORT, SQL_PARAM_ARRAY_ROW_COUNTS, and SQL_PARAM_ARRAY_SELECTS options. The first option returns whether row count–generating and result set–generating statements are supported in explicit batches and procedures, while the latter two options return information about the availability of row counts and result sets in parameterized execution.</p>
<p>
Batches of statements are executed through <b>SQLExecute</b> or <b>SQLExecDirect</b>. For example, the following call executes an explicit batch of statements to open a new sales order.</p>
<pre><code>SQLCHAR *BatchStmt =
 "INSERT INTO Orders (OrderID, CustID, OpenDate, SalesPerson, Status)"
  "VALUES (2002, 1001, {fn CURDATE()}, 'Garcia', 'OPEN');"
 "INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (2002, 1, 1234, 10);"
 "INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (2002, 2, 987, 8);"
 "INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (2002, 3, 566, 17);"
 "INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (2002, 4, 412, 500)";

SQLExecDirect(hstmt, BatchStmt, SQL_NTS);
</code></pre>
<p>
When a batch of result-generating statements is executed, it returns one or more row counts or result sets. For information about how to retrieve these, see “<a href="odch11pr_6ovn.htm">Multiple Results</a>” in Chapter 11, “Retrieving Results (Advanced).”</p>
<p>
If a batch of statements includes parameter markers, these are numbered in increasing parameter order as they are in any other statement. For example, the following batch of statements has parameters numbered from 1 to 21; those in the first <b>INSERT</b> statement are numbered 1 to 5 and those in the last <b>INSERT</b> statement are numbered 18 to 21.</p>
<pre><code>INSERT INTO Orders (OrderID, CustID, OpenDate, SalesPerson, Status)
 VALUES (?, ?, ?, ?, ?);
INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (?, ?, ?, ?);
INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (?, ?, ?, ?);
INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (?, ?, ?, ?);
INSERT INTO Lines (OrderID, Line, PartID, Quantity) VALUES (?, ?, ?, ?);
</code></pre>
<p>
For more information about parameters, see “<a href="odch09pr_2tpv.htm">Statement Parameters</a>,” later in this chapter.</p>
</font></BODY>
</HTML>
