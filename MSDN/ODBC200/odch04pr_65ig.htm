<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Data Buffer Length</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcdata_buffer_length"></a>Data Buffer Length</h1>
<p>
The application passes the byte length of the data buffer to the driver in an argument, named <i>BufferLength</i> or a similar name. For example, in the following call to <b>SQLBindCol</b>, the application specifies the length of the <i>ValuePtr</i> buffer (<b>sizeof(</b><i>ValuePtr</i><b>)</b>):</p>
<pre><code>SQLCHAR&nbsp; ValuePtr[50];
SQLINTEGER ValueLenOrInd;
SQLBindCol(hstmt, 1, SQL_C_CHAR, ValuePtr, sizeof(ValuePtr), &amp;ValueLenOrInd);
</code></pre>
<p>
A driver will always return the number of bytes, not the number of characters, in the buffer length argument of any function that has an output string argument.</p>
<p>
Data buffer lengths are required only for output buffers; the driver uses them to avoid writing past the end of the buffer. However, the driver checks the data buffer length only when the buffer contains variable-length data, such as character or binary data. If the buffer contains fixed-length data, such as an integer or date structure, the driver ignores the data buffer length and assumes the buffer is large enough to hold the data; that is, it never truncates fixed-length data. It is therefore important for the application to allocate a large enough buffer for fixed-length data.</p>
<p>
When a truncation of non-data output strings occurs (such as the cursor name returned for <b>SQLGetCursorName</b>), the returned length in the buffer length argument is the maximum byte length possible. That means that it is twice the number of characters, because the string could contain DBCS characters. For example, if the cursor name is 10 ANSI characters long (10 bytes), and an application calls <b>SQLGetCursorName</b> to try to retrieve the cursor name into a buffer that is 6 bytes long, the value returned in <i>*NameLengthPtr</i> will be 20.</p>
<p>
Data buffer lengths are not required for input buffers because the driver does not write to these buffers.</p>
</font></BODY>
</HTML>
