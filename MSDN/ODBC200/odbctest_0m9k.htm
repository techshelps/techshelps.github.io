<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>szMessageBox</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="szmessagebox"></a>szMessageBox</h1>
<p class=label>
<b>Description</b></p>
<p>
<b>szMessageBox</b> formats a string and displays it using the <b>MessageBox</b> function in the Windows API.</p>
<p class=label>
<b>C Prototype</b></p>
<p>
<b>int szMessageBox</b>(<br>
HWND <i>hwnd</i>, /* Input:&nbsp; Parent window handle */<br>
UINT <i>style</i>, /* Input:&nbsp; Style of message box */<br>
LPSTR <i>szTitle</i>, /* Input:&nbsp; Title of message box */<br>
LPSTR <i>szFmt</i>, /* Input:&nbsp; Format string */<br>
<b>...</b>); /* Input:&nbsp; Arguments for format string */</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>hwnd</i></p>
<p class=indent>
The parent window handle to be passed to <b>MessageBox</b>. This should be the <i>hwnd</i> member of the <i>lpServer</i> structure passed to <b>AutoTestFunc</b>.</p>
<p class=dt>
<i>style</i></p>
<p class=indent>
The style of the message box. For more information, see the <i>fuStyle</i> argument of the <b>MessageBox</b> function in the Windows API.</p>
<p class=dt>
<i>szTitle</i></p>
<p class=indent>
The title of the message box. For more information, see the <i>lpszTitle</i> argument of the <b>MessageBox</b> function in the Windows API.</p>
<p class=dt>
<i>szFmt</i></p>
<p class=indent>
A null-terminated format string compatible with the <b>wsprintf</b> function.</p>
<p class=dt>
<b>...</b></p>
<p class=indent>
Arguments for the format string specified in the <i>szFmt</i> argument.</p>
<p class=label>
<b>Return Value</b></p>
<p>
<b>szMessageBox</b> returns the value returned by <b>MessageBox</b>.</p>
<p class=label>
<b>Comments</b></p>
<p>
Auto tests can call this function to display a message box. Because most auto tests are designed to be run without user interaction, this function should be called only when user interaction is required. To routinely log output, an auto test should call <b>szLogPrintf</b>.</p>
<p class=label>
<b>Code Example</b></p>
<p>
The following code example shows how <b>AutoTestFunc</b> might use <b>szMessageBox</b> to tell the user how to use a dialog box displayed by <b>SQLDriverConnect</b>:</p>
<pre><code>#define CONN_STR_LEN 100
SQLCHAR InConnectString[CONN_STR_LEN], OutConnectString[CONN_STR_LEN];
SQLSMALLINT StringLength2;

/* szTestName is the test name returned by AutoTestName */
szMessageBox(lpServer-&gt;hwnd,
 &nbsp;&nbsp;&nbsp; MB_ICONINFORMATION | MB_OK,
 &nbsp;&nbsp;&nbsp; szTestName,
 &nbsp;&nbsp;&nbsp; "Click the Cancel button in the next 
               dialog box.");

lstrcpy(InConnectString, "DSN=");
lstrcat(InConnectString, lpServer-&gt;szValidServer0);
SQLDriverConnect(ConnectionHandle, lpServer-&gt;hwnd,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InConnectString, lstrlen(InConnectString),
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OutConnectString, CONN_STR_LEN, 
                 &amp;StringLength2,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQL_DRIVER_PROMPT);
</code></pre>
</font></BODY>
</HTML>
