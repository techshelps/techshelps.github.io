<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scalar Function Calls</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcscalar_function_calls"></a>Scalar Function Calls</h2>
<p>
Scalar functions return a value for each row. For example, the absolute value scalar function takes a numeric column as an argument and returns the absolute value of each value in the column. The escape sequence for calling a scalar function is:</p>
<p>
<b>{fn </b><i>scalar-function</i><b>}</b></p>
<p>
where <i>scalar-function</i> is one of the functions listed in Appendix E, “<a href="odappepr_3wc3.htm">Scalar Functions</a>.” For more information on the scalar function escape sequence, see “<a href="odappcpr_1qcl.htm">Scalar Function Escape Sequence</a>” in Appendix C, “SQL Grammar.”</p>
<p>
For example, the following SQL statements create the same result set of uppercase customer names. The first statement uses the escape-sequence syntax. The second statement uses the native syntax for Ingres for OS/2 and is not interoperable.</p>
<pre><code>SELECT {fn UCASE(Name)} FROM Customers

SELECT uppercase(Name) FROM Customers
</code></pre>
<p>
An application can mix calls to scalar functions that use native syntax and calls to scalar functions that use ODBC syntax. For example, assume that names in the Employee table are stored as a last name, a comma, and a first name. The following SQL statement creates a result set of last names of employees in the Employee table. The statement uses the ODBC scalar function <b>SUBSTRING</b> and the SQL Server scalar function <b>CHARINDEX</b>, and will execute correctly only on SQL Server.</p>
<pre><code>SELECT {fn SUBSTRING(Name, 1, CHARINDEX(',', Name) – 1)} FROM Customers
</code></pre>
<p>
For maximum interoperability, applications should use the <b>CONVERT</b> scalar function to make sure the output of a scalar function is the required type. The <b>CONVERT</b> function converts data from one SQL data type to the specified SQL data type. The syntax of the <b>CONVERT</b> function is:</p>
<p>
<b>CONVERT(</b><i>value_exp</i><b>,</b> <i>data_type</i><b>)</b></p>
<p>
where <i>value_exp</i> is a column name, the result of another scalar function, or a literal value, and <i>data_type</i> is a keyword that matches the <b>#define</b> name used by an SQL data type identifier as defined in Appendix D, “<a href="odappdpr_8kab.htm">Data Types</a>.” For example, the following SQL statement uses the <b>CONVERT</b> function to make sure that the output of the <b>CURDATE</b> function is a date, rather than a timestamp or character data:</p>
<pre><code>INSERT INTO Orders (OrderID, CustID, OpenDate, SalesPerson, Status)
 VALUES (?, ?, {fn CONVERT({fn CURDATE()}, SQL_DATE)}, ?, ?)
</code></pre>
<p>
To determine which scalar functions are supported by a data source, an application calls <b>SQLGetInfo</b> with the SQL_CONVERT_FUNCTIONS, SQL_NUMERIC_FUNCTIONS, SQL_STRING_FUNCTIONS, SQL_SYSTEM_FUNCTIONS, and SQL_TIMEDATE_FUNCTIONS options. To determine which conversion operations are supported by the <b>CONVERT</b> function, an application calls <b>SQLGetInfo</b> with any of the options that start with SQL_CONVERT.</p>
</font></BODY>
</HTML>
