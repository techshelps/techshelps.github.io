<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Descriptor Transitions</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcdescriptor_transitions"></a>Descriptor Transitions</h1>
<p>
ODBC descriptors have the following three states.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=13%><b>State</b></td>
<td class=label width=87%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=13%>D0</td>
<td width=87%>Unallocated descriptor</td>
</tr>
<tr valign=top>
<td width=13%>D1i</td>
<td width=87%>Implicitly allocated descriptor</td>
</tr>
<tr valign=top>
<td width=13%>D1e</td>
<td width=87%>Explicitly allocated descriptor</td>
</tr>
</table><br>
<p>
The following tables show how each ODBC function affects the descriptor state.</p>
<h1>SQLAllocHandle</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>D0<br>
Unallocated</b></td>
<td class=label width=17%><b>D1i<br>
Implicit</b></td>
<td class=label width=62%><b>D1e<br>
Explicit</b></td>
</tr>
<tr valign=top>
<td width=21%>  D1i [1]</td>
<td width=17%>--</td>
<td width=62%>--</td>
</tr>
<tr valign=top>
<td width=21%>D1e [2]</td>
<td width=17%>--</td>
<td width=62%>--</td>
</tr>
</table><br>
<p class=mini>
[1]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_STMT.</p>
<p class=mini>
[2]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_DESC.</p>
<h1>SQLCopyDesc</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>D0<br>
Unallocated</b></td>
<td class=label width=17%><b>D1i<br>
Implicit</b></td>
<td class=label width=62%><b>D1e<br>
Explicit</b></td>
</tr>
<tr valign=top>
<td width=21%>(IH)</td>
<td width=17%>--</td>
<td width=62%>--</td>
</tr>
</table><br>
<h1>SQLFreeHandle</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>D0<br>
Unallocated</b></td>
<td class=label width=17%><b>D1i<br>
Implicit</b></td>
<td class=label width=62%><b>D1e<br>
Explicit</b></td>
</tr>
<tr valign=top>
<td width=21%>-- [1]</td>
<td width=17%>D0</td>
<td width=62%>--</td>
</tr>
<tr valign=top>
<td width=21%>(IH) [2]</td>
<td width=17%>(HY017)</td>
<td width=62%>D0</td>
</tr>
</table><br>
<p class=mini>
[1]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_STMT.</p>
<p class=mini>
[2]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_DESC.</p>
<h1>SQLGetDescField and SQLGetDescRec</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>D0<br>
Unallocated</b></td>
<td class=label width=17%><b>D1i<br>
Implicit</b></td>
<td class=label width=62%><b>D1e<br>
Explicit</b></td>
</tr>
<tr valign=top>
<td width=21%>(IH)</td>
<td width=17%>--</td>
<td width=62%>--</td>
</tr>
</table><br>
<h1>SQLSetDescField and SQLSetDescRec</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>D0<br>
Unallocated</b></td>
<td class=label width=17%><b>D1i<br>
Implicit</b></td>
<td class=label width=62%><b>D1e<br>
Explicit</b></td>
</tr>
<tr valign=top>
<td width=21%>(IH) [1]</td>
<td width=17%>--</td>
<td width=62%>--</td>
</tr>
</table><br>
<p class=mini>
[1]This row shows transitions when <i>DescriptorHandle</i> was the handle of an ARD, APD, or IPD, or (for <b>SQLSetDescField</b>) when <i>DescriptorHandle</i> was the handle of an IRD and <i>FieldIdentifier</i> was SQL_DESC_ARRAY_STATUS_PTR or SQL_DESC_ROWS_PROCESSED_PTR.</p>
<h1>All Other ODBC Functions</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>D0<br>
Unallocated</b></td>
<td class=label width=17%><b>D1i<br>
Implicit</b></td>
<td class=label width=62%><b>D1e<br>
Explicit</b></td>
</tr>
<tr valign=top>
<td width=21%>--</td>
<td width=17%>--</td>
<td width=62%>--</td>
</tr>
</table><br>
</font></BODY>
</HTML>
