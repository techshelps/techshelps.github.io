<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 4a: Fetch the Results</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcstep_4a__fetch_the_results"></a>Step 4a: Fetch the Results</h1>
<p>
The next step is to fetch the results, as shown in the following figure.</p>
<p>
<img src="pr14.gif" border=0></p>
<p>
If the statement executed in Step 3, “Build and Execute an SQL Statement,” was a <b>SELECT</b> statement or a catalog function, the application first calls <b>SQLNumResultCols</b> to determine the number of columns in the result set. This step is not necessary if the application already knows the number of result set columns, such as when the SQL statement is hard-coded in a vertical or custom application.</p>
<p>
Next, the application retrieves the name, data type, precision, and scale of each result set column with <b>SQLDescribeCol</b>. Again, this is not necessary for applications such as vertical and custom applications that already know this information. It passes this information to <b>SQLBindCol</b>, which binds an application variable to a column in the result set.</p>
<p>
The application now calls <b>SQLFetch</b> to retrieve the first row of data and place the data from that row in the variables bound with <b>SQLBindCol</b>. If there is any long data in the row, it then calls <b>SQLGetData</b> to retrieve that data. The application continues to call <b>SQLFetch</b> and <b>SQLGetData</b> to retrieve additional data. After it has finished fetching data, it calls <b>SQLCloseCursor</b> to close the cursor.</p>
<p>
For a complete description of retrieving results, see Chapter 10, “<a href="odch10pr_9iu7.htm">Retrieving Results (Basic)</a>” and Chapter 11, “<a href="odch11pr_9mxr.htm">Retrieving Results (Advanced)</a>.”</p>
<p>
The application now returns to Step 3, “Build and Execute an SQL Statement,” to execute another statement in the same transaction; or proceeds to Step 5, “Commit the Transaction,” to commit or roll back the transaction.</p>
</font></BODY>
</HTML>
