<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLInstallerError</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlinstallererror"></a>SQLInstallerError</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced: ODBC 3.0</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLInstallerError</b> returns error or status information for the ODBC installer functions.</p>
<p class=label>
<b>Syntax</b></p>
<p>
RETCODE <b>SQLInstallerError</b>(<br>
&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;<i>iError</i>,<br>
&nbsp;&nbsp;&nbsp;DWORD *&nbsp;&nbsp;&nbsp;<i>pfErrorCode</i>,<br>
&nbsp;&nbsp;&nbsp;LPSTR &nbsp;&nbsp;&nbsp;<i>lpszErrorMsg</i>,<br>
&nbsp;&nbsp;&nbsp;WORD &nbsp;&nbsp;&nbsp;<i>cbErrorMsgMax</i>,<br>
&nbsp;&nbsp;&nbsp;WORD *&nbsp;&nbsp;&nbsp;<i>pcbErrorMsg</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>iError</i></p>
<p class=indent>
[Input]<br>
Error record number. Valid numbers are from 1 to 8.</p>
<p class=dt>
<i>pfErrorCode</i></p>
<p class=indent>
[Output]<br>
Installer error code. (For more information, see “Comments.”)</p>
<p class=dt>
<i>lpszErrorMsg</i></p>
<p class=indent>
[Output]<br>
Pointer to storage for the error message text.</p>
<p class=dt>
<i>cbErrorMsgMax</i></p>
<p class=indent>
[Input]<br>
Maximum length of the <i>szErrorMsg</i> buffer. This must be less than or equal to SQL_MAX_MESSAGE_LENGTH minus the null-termination character.</p>
<p class=dt>
<i>cbErrorMsgMax</i></p>
<p class=indent>
[Input]<br>
Maximum length of the <i>szErrorMsg</i> buffer. This must be less than or equal to SQL_MAX_MESSAGE_LENGTH minus the null-termination character.</p>
<p class=dt>
<i>pcbErrorMsg</i></p>
<p class=indent>
[Output]<br>
Pointer to the total number of bytes (excluding the null-termination character) available to return in <i>lpszErrorMsg</i>. If the number of bytes available to return is greater than or equal to <i>cbErrorMsgMax</i>, the error message text in <i>lpszErrorMsg</i> is truncated to <i>cbErrorMsgMax</i> minus the null-termination character bytes. The <i>pcbErrorMsg</i> argument can be a null pointer.</p>
<p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, or SQL_ERROR.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
<b>SQLInstallerError</b> does not post error values for itself. <b>SQLInstallerError</b> returns SQL_NO_DATA when it is unable to retrieve any error information (in which case <i>pfErrorCode</i> is undefined). If <b>SQLInstallerError</b> cannot access error values for any reason that would normally return SQL_ERROR, <b>SQLInstallerError</b> returns SQL_ERROR, but does not post any error values. If either the <i>lpszErrorMsg</i> argument is NULL, the <i>cbErrorMsgMax</i> is less than or equal to 0, then this function returns SQL_ERROR. If the buffer for the error message is too short, <b>SQLInstallerError</b> returns SQL_SUCCESS_WITH_INFO, and returns the correct <i>pfErrorCode</i> value for <b>SQLInstallerError</b>.</p>
<p>
To determine whether a truncation occurred in the error message, an application can compare the value in the <i>cbErrorMsgMax</i> argument to the actual length of the message text written to the <i>pcbErrorMsg</i> argument. If truncation does occur, the correct buffer length should be allocated for <i>lpszErrorMsg</i> and <b>SQLInstallerError</b> should be called again with the corresponding <i>iError</i> record.</p>
<p class=label>
<b>Comments</b></p>
<p>
An application calls <b>SQLInstallerError</b> when a previous call to the ODBC installer function returns FALSE. ODBC installer and driver or translator setup functions post zero or more errors only when the function fails (returns FALSE); therefore, an application calls <b>SQLInstallerError</b> only after an ODBC installer function fails.</p>
<p>
The ODBC installer error queue is flushed each time a new installer function is called. Therefore, an application cannot expect to retrieve errors for functions other than from the last installer function call.</p>
<p>
To retrieve multiple errors for a function call, an application calls <b>SQLInstallerError</b> multiple times.</p>
<p>
When there is no additional information, <b>SQLInstallerError</b> returns SQL_NO_DATA, the <i>pfErrorCode</i> argument is undefined, the <i>pcbErrorMsg</i> argument equals 0, and the <i>lpszErrorMsg</i> argument contains a single null-termination character (unless the <i>cbErrorMsgMax</i> argument is equal to 0).</p>
</font></BODY>
</HTML>
