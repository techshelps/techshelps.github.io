<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLNumResultCols</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlnumresultcols"></a>SQLNumResultCols</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 1.0<br>
Standards Compliance:ISO 92</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLNumResultCols</b> returns the number of columns in a result set.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLNumResultCols</b>(<br>
SQLHSTMT<i>StatementHandle</i>,<br>
SQLSMALLINT *<i>ColumnCountPtr</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>StatementHandle</i></p>
<p class=indent>
[Input]<br>
Statement handle.</p>
<p class=dt>
<i>ColumnCountPtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the number of columns in the result set. This count does not include a bound bookmark column.</p>
<p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLNumResultCols</b> returns SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value can be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_STMT and a <i>Handle</i> of <i>StatementHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLNumResultCols </b>and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>08S01</td>
<td width=26%>Communication link failure</td>
<td width=52%>The communication link between the driver and the data source to which the driver was connected failed before the function completed processing.</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation error</td>
<td width=52%>The driver was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=22%>HY008</td>
<td width=26%>Operation canceled</td>
<td width=52%>Asynchronous processing was enabled for the <i>StatementHandle</i>. The function was called and, before it completed execution, <b>SQLCancel</b> was called on the <i>StatementHandle</i>; the function was then called again on the <i>StatementHandle</i>.<p>
The function was called and, before it completed execution, <b>SQLCancel</b> was called on the <i>StatementHandle</i> from a different thread in a multithread application.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY010</td>
<td width=26%>Function sequence error</td>
<td width=52%>(DM) The function was called prior to calling <b>SQLPrepare</b> or <b>SQLExecDirect</b> for the <i>StatementHandle</i>.<p>
(DM) An asynchronously executing function (not this one) was called for the <i>StatementHandle</i> and was still executing when this function was called.</p>
<p>
(DM) <b>SQLExecute</b>, <b>SQLExecDirect</b>, <b>SQLBulkOperations</b>, or <b>SQLSetPos</b> was called for the <i>StatementHandle</i> and returned SQL_NEED_DATA. This function was called before data was sent for all data-at-execution parameters or columns.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HYT01</td>
<td width=26%>Connection timeout expired</td>
<td width=52%>The connection timeout period expired before the data source responded to the request. The connection timeout period is set through <b>SQLSetConnectAttr</b>, SQL_ATTR_CONNECTION_TIMEOUT.</td>
</tr>
<tr valign=top>
<td width=22%>IM001</td>
<td width=26%>Driver does not support this function</td>
<td width=52%>(DM) The driver associated with the <i>StatementHandle</i> does not support the function.</td>
</tr>
</table><br>
<p>
<b>SQLNumResultCols</b> can return any SQLSTATE that can be returned by <b>SQLPrepare</b> or <b>SQLExecute</b> when called after <b>SQLPrepare</b> and before <b>SQLExecute</b>, depending on when the data source evaluates the SQL statement associated with the statement.</p>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLNumResultCols</b> can be called successfully only when the statement is in the prepared, executed, or positioned state.</p>
<p>
If the statement associated with <i>StatementHandle</i> does not return columns, <b>SQLNumResultCols</b> sets *<i>ColumnCountPtr</i> to 0.</p>
<p>
The number of columns returned by <b>SQLNumResultCols</b> is the same value as the SQL_DESC_COUNT field of the IRD.</p>
<p>
For more information, see “<a href="odch10pr_9ntr.htm">Was a Result Set Created?</a>” and “<a href="odch10pr_1pi7.htm">How is Metadata Used?</a>” in Chapter 10, “Retrieving Results (Basic).”</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>For information about</b></td>
<td class=label width=50%><b>See</b></td>
</tr>
<tr valign=top>
<td width=50%>Binding a buffer to a column in a result set</td>
<td width=50%><a href="odch21bpr_0ht8.htm">SQLBindCol</a></td>
</tr>
<tr valign=top>
<td width=50%>Canceling statement processing</td>
<td width=50%><a href="odch21bpr_5b58.htm">SQLCancel</a></td>
</tr>
<tr valign=top>
<td width=50%>Returning information about a column in a result set</td>
<td width=50%><a href="odch21bpr_365h.htm">SQLColAttribute</a></td>
</tr>
<tr valign=top>
<td width=50%>Returning information about a column in a result set</td>
<td width=50%><a href="odch21dpr_92jw.htm">SQLDescribeCol</a></td>
</tr>
<tr valign=top>
<td width=50%>Executing an SQL statement</td>
<td width=50%><a href="odch21epr_35x0.htm">SQLExecDirect</a></td>
</tr>
<tr valign=top>
<td width=50%>Executing a prepared SQL statement</td>
<td width=50%><a href="odch21epr_0yg5.htm">SQLExecute</a></td>
</tr>
<tr valign=top>
<td width=50%>Fetching a block of data or scrolling through a result set</td>
<td width=50%><a href="odch21epr_5m24.htm">SQLFetchScroll</a></td>
</tr>
<tr valign=top>
<td width=50%>Fetching a single row or a block of data in a forward-only direction</td>
<td width=50%><a href="odch21epr_4zoo.htm">SQLFetch</a></td>
</tr>
<tr valign=top>
<td width=50%>Fetching part or all of a column of data</td>
<td width=50%><a href="odch21gpr_682p.htm">SQLGetData</a></td>
</tr>
<tr valign=top>
<td width=50%>Preparing an SQL statement for execution</td>
<td width=50%><a href="odch21ipr_3td1.htm">SQLPrepare</a></td>
</tr>
<tr valign=top>
<td width=50%>Setting cursor scrolling options</td>
<td width=50%><a href="odch21kpr_77jm.htm">SQLSetStmtAttr</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
