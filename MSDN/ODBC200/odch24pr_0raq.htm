<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLDataSourceToDriver</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqldatasourcetodriver"></a>SQLDataSourceToDriver</h1>
<p>
<b>SQLDataSourceToDriver</b> supports<b> </b>translations for ODBC drivers. This function is not called by ODBC-enabled applications; applications request translation through <b>SQLSetConnectAttr</b>. The driver associated with the <i>ConnectionHandle </i>specified in <b>SQLSetConnectAttr</b> calls the specified DLL to perform translations of all data flowing from the data source to the driver. A default translation DLL can be specified in the ODBC initialization file.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BOOL <b>SQLDataSourceToDriver</b>(<br>
&nbsp;&nbsp;&nbsp;UDWORD&nbsp;&nbsp;&nbsp;<i>fOption</i>,<br>
&nbsp;&nbsp;&nbsp;SWORD&nbsp;&nbsp;&nbsp;<i>fSqlType</i>,<br>
&nbsp;&nbsp;&nbsp;PTR&nbsp;&nbsp;&nbsp;<i>rgbValueIn</i>,<br>
&nbsp;&nbsp;&nbsp;SDWORD&nbsp;&nbsp;&nbsp;<i>cbValueIn</i>,<br>
&nbsp;&nbsp;&nbsp;PTR&nbsp;&nbsp;&nbsp;<i>rgbValueOut</i>,<br>
&nbsp;&nbsp;&nbsp;SDWORD&nbsp;&nbsp;&nbsp;<i>cbValueOutMax</i>,<br>
&nbsp;&nbsp;&nbsp;SDWORD *&nbsp;&nbsp;&nbsp;<i>pcbValueOut</i>,<br>
&nbsp;&nbsp;&nbsp;UCHAR *&nbsp;&nbsp;&nbsp;<i>szErrorMsg</i>,<br>
&nbsp;&nbsp;&nbsp;SWORD&nbsp;&nbsp;&nbsp;<i>cbErrorMsgMax</i>,<br>
&nbsp;&nbsp;&nbsp;SWORD *&nbsp;&nbsp;&nbsp;<i>pcbErrorMsg</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>fOption</i></p>
<p class=indent>
[Input]<br>
Option value.</p>
<p class=dt>
<i>fSqlType</i></p>
<p class=indent>
[Input]<br>
The SQL data type. This argument tells the driver how to convert <i>rgbValueIn</i> into a form acceptable by the application. For a list of valid SQL data types, see the “<a href="odappdpr_8fcj.htm">SQL Data Types</a>” section in Appendix D, “Data Types.”</p>
<p class=dt>
<i>rgbValueIn</i></p>
<p class=indent>
[Input]<br>
Value to translate.</p>
<p class=dt>
<i>cbValueIn</i></p>
<p class=indent>
[Input]<br>
Length of <i>rgbValueIn</i>.</p>
<p class=dt>
<i>rgbValueOut</i></p>
<p class=indent>
[Output]<br>
Result of the translation.</p>
<p class=atl>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>The translation DLL does not null-terminate this value.</p><p class=dt>
<i>cbValueOutMax</i></p>
<p class=indent>
[Input]<br>
Length of <i>rgbValueOut</i>.</p>
<p class=dt>
<i>pcbValueOut</i></p>
<p class=indent>
[Output]<br>
The total number of bytes (excluding the null-termination byte) available to return in <i>rgbValueOut</i>.</p>
<p class=tl>
For character or binary data, if this is greater than or equal to <i>cbValueOutMax</i>, the data in <i>rgbValueOut</i> is truncated to <i>cbValueOutMax</i> bytes.</P><p class=tl>
For all other data types, the value of <i>cbValueOutMax</i> is ignored and the translation DLL assumes that the size of <i>rgbValueOut</i> is the size of the default C data type of the SQL data type specified with <i>fSqlType</i>. </P><p class=tl>
The <i>pcbValueOut</i> argument can be a null pointer.</P><p class=dt>
<i>szErrorMsg</i></p>
<p class=indent>
[Output]<br>
Pointer to storage for an error message. This is an empty string unless the translation failed.</p>
<p class=dt>
<i>cbErrorMsgMax</i></p>
<p class=indent>
[Input]<br>
Length of <i>szErrorMsg</i>.</p>
<p class=dt>
<i>pcbErrorMsg</i></p>
<p class=indent>
[Output]<br>
Pointer to the total number of bytes (excluding the null-termination byte) available to return in <i>szErrorMsg</i>. If this is greater than or equal to <i>cbErrorMsg</i>, the data in <i>szErrorMsg</i> is truncated to <i>cbErrorMsgMax</i> minus the null-termination character. The <i>pcbErrorMsg</i> argument can be a null pointer.</p>
<p class=label>
<b>Returns</b></p>
<p>
TRUE if the translation was successful.</p>
<p>
FALSE if the translation failed.</p>
<p class=label>
<b>Comments</b></p>
<p>
The driver calls <b>SQLDataSourceToDriver</b> to translate <i>all </i>data (result set data, table names, row counts, error messages, and so on) passing from the data source to the driver. The translation DLL may not translate some data, depending on the data’s type and the purpose of the translation DLL; for example, a DLL that translates character data from one code page to another ignores all numeric and binary data.</p>
<p>
The value of <i>fOption</i> is set to the value of <i>vParam</i> specified by calling <b>SQLSetConnectAttr</b> with the SQL_ATTR_TRANSLATE_OPTION attribute. It is a 32-bit value which has a specific meaning for a given translation DLL. For example, it could specify a certain character set translation.</p>
<p>
If the same buffer is specified for <i>rgbValueIn</i> and <i>rgbValueOut</i>, the translation of data in the buffer will be performed in place.</p>
<p>
Note that, although <i>cbValueIn</i>, <i>cbValueOutMax</i>, and <i>pcbValueOut</i> are of the type SDWORD, <b>SQLDataSourceToDriver</b> does not necessarily support huge pointers.</p>
<p>
If <b>SQLDataSourceToDriver</b> returns FALSE, data truncation may have occurred during translation. If <i>pcbValueOut</i>, the number of bytes available to return in the output buffer, is greater than <i>cbValueOutMax</i>, the length of the output buffer, then truncation occurred. The driver must determine whether the truncation was acceptable. If truncation did not occur, the <b>SQLDataSourceToDriver</b> returned FALSE due to another error. In either case, a specific error message is returned in <i>szErrorMsg</i>.</p>
<p>
For more information about translating data, see “<a href="odch17pr_5ier.htm">Translation DLLs</a>” in Chapter 17, “Programming Considerations.”</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>For information about</b></td>
<td class=label width=50%><b>See</b></td>
</tr>
<tr valign=top>
<td width=50%>Translating data being sent to the data source</td>
<td width=50%><a href="odch24pr_9x9h.htm">SQLDriverToDataSource</a></td>
</tr>
<tr valign=top>
<td width=50%>Returning the setting of a connection attribute</td>
<td width=50%><a href="odch21fpr_0j1u.htm">SQLGetConnectAttr</a></td>
</tr>
<tr valign=top>
<td width=50%>Setting a connection attribute</td>
<td width=50%><a href="odch21jpr_4zn6.htm">SQLSetConnectAttr</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
