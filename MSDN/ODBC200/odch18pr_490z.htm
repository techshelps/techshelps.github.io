<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Driver Specification Subkeys</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcdriver_specification_subkeys"></a>Driver Specification Subkeys</h2>
<p>
Each driver listed in the ODBC Drivers subkey has a subkey of its own. This subkey has the same name as the corresponding value under the ODBC Drivers subkey. The values under this subkey list the full paths of the driver and driver setup DLLs, the values of the driver keywords returned by <b>SQLDrivers</b>, and the usage count. The formats of the values are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=27%><b>Name</b></td>
<td class=label width=21%><b>Data type</b></td>
<td class=label width=52%><b>Data</b></td>
</tr>
<tr valign=top>
<td width=27%>APILevel</td>
<td width=21%>REG_SZ</td>
<td width=52%><b>0 </b>|<b> 1 </b>|<b> 2</b></td>
</tr>
<tr valign=top>
<td width=27%>ConnectFunctions</td>
<td width=21%>REG_SZ</td>
<td width=52%>{<b>Y</b>|<b>N</b>}{<b>Y</b>|<b>N</b>}{<b>Y</b>|<b>N</b>}</td>
</tr>
<tr valign=top>
<td width=27%>CreateDSN</td>
<td width=21%>REG_SZ</td>
<td width=52%><i>driver-description</i></td>
</tr>
<tr valign=top>
<td width=27%>Driver</td>
<td width=21%>REG_SZ</td>
<td width=52%><i>driver-DLL-path</i></td>
</tr>
<tr valign=top>
<td width=27%>DriverODBCVer</td>
<td width=21%>REG_SZ</td>
<td width=52%><i>nn.nn</i></td>
</tr>
<tr valign=top>
<td width=27%>FileExtns</td>
<td width=21%>REG_SZ</td>
<td width=52%><b>*.</b> <i>file-extension1</i>[<b>,*.</b> <i>file-extension2</i>]...</td>
</tr>
<tr valign=top>
<td width=27%>FileUsage</td>
<td width=21%>REG_SZ</td>
<td width=52%><b>0 </b>|<b> 1 </b>|<b> 2</b></td>
</tr>
<tr valign=top>
<td width=27%>Setup</td>
<td width=21%>REG_SZ</td>
<td width=52%><i>setup-DLL-path</i></td>
</tr>
<tr valign=top>
<td width=27%>SQLLevel</td>
<td width=21%>REG_SZ</td>
<td width=52%><b>0 </b>|<b> 1 </b>|<b> 2</b></td>
</tr>
<tr valign=top>
<td width=27%>UsageCount</td>
<td width=21%>REG_DWORD</td>
<td width=52%><i>count</i></td>
</tr>
</table><br>
<p>
where the use of each keyword is:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=27%><b>Keyword</b></td>
<td class=label width=73%><b>Usage</b></td>
</tr>
<tr valign=top>
<td width=27%><b>APILevel</b></td>
<td width=73%>A number indicating the ODBC interface conformance level supported by the driver:<p>
0 = None</p>
<p>
1 = Level 1 supported</p>
<p>
2 = Level 2 supported</p>
<p>
This must be the same as the value returned for the SQL_ODBC_INTERFACE_CONFORMANCE option in <b>SQLGetInfo</b>.</p>
</td>
</tr>
<tr valign=top>
<td width=27%><b>CreateDSN</b></td>
<td width=73%>The name of one or more data sources to be created when the driver is installed. The system information must include one data source specification section for each data source listed with the <b>CreateDSN</b> keyword. These sections should not include the <b>Driver</b> keyword, since this is specified in the driver specification section, but must include enough information for the <b>ConfigDSN</b> function in the driver setup DLL to create a data source specification without displaying any dialog boxes. For the format of a data source specification section, see “<a href="odch19pr_6trn.htm">Data Source Specification Subkeys</a>” in Chapter 19, “Configuring Data Sources.”</td>
</tr>
<tr valign=top>
<td width=27%><b>ConnectFunctions</b></td>
<td width=73%>A three-character string indicating whether the driver supports <b>SQLConnect</b>, <b>SQLDriverConnect</b>, and <b>SQLBrowseConnect</b>. If the driver supports <b>SQLConnect</b>, the first character is “Y”; otherwise, it is “N”. If the driver supports <b>SQLDriverConnect</b>, the second character is “Y”; otherwise, it is “N”. If the driver supports <b>SQLBrowseConnect</b>, the third character is “Y”; otherwise, it is “N”. For example, if a driver supports <b>SQLConnect</b> and <b>SQLDriverConnect</b>, but not <b>SQLBrowseConnect</b>, the three-character string is “YYN”.</td>
</tr>
<tr valign=top>
<td width=27%><b>DriverODBCVer</b></td>
<td width=73%>A character string with the version of ODBC that the driver supports. The version is of the form <i>nn.nn</i>, where the first two digits are the major version and the next two digits are the minor version. For the version of ODBC described in this manual, the driver must return “03.00”.<p>
This must be the same as the value returned for the SQL_DRIVER_ODBC_VER option in <b>SQLGetInfo</b>.</p>
</td>
</tr>
<tr valign=top>
<td width=27%><b>FileExtns</b></td>
<td width=73%>For file-based drivers, a comma-separated list of extensions of the files the driver can use. For example, a dBASE driver might specify *.dbf and a formatted text file driver might specify *.txt,*.csv. For an example of how an application might use this information, see the <b>FileUsage</b> keyword.</td>
</tr>
<tr valign=top>
<td width=27%><b>FileUsage</b></td>
<td width=73%>A number indicating how a file-based driver directly treats files in a data source.<p>
0 = The driver is not a file-based driver. For example, an ORACLE driver is a DBMS-based driver.</p>
<p>
1 = A file-based driver treats files in a data source as tables. For example, an Xbase driver treats each Xbase file as a table.</p>
<p>
2 = A file-based driver treats files in a data source as a catalog. For example, a Microsoft Access driver treats each Microsoft Access file as a complete database.</p>
<p>
An application might use this to determine how users will select data. For example, Xbase and Paradox users often think of data as stored in files, while ORACLE and Microsoft Access users generally think of data as stored in tables.</p>
<p>
When a user selects <b>Open Data File</b> from the <b>File </b>menu, an application could display the <b>Windows File Open</b> common dialog box. The list of file types would use the file extensions specified with the <b>FileExtns</b> keyword for drivers that specify a <b>FileUsage</b> value of 1 and “Y” as the second character of the value of the <b>ConnectFunctions</b> keyword. After the user selects a file, the application would call <b>SQLDriverConnect</b> with the <b>DRIVER</b> keyword, then execute a <b>SELECT * FROM</b> <b><i>table-name</i></b> statement.</p>
<p>
When the user selects <b>Import Data</b> from the <b>File </b>menu, an application could display a list of descriptions for drivers that specify a <b>FileUsage</b> value of 0 or 2 and “Y” as the second character of the value of the <b>ConnectFunctions</b> keyword. After the user selects a driver, the application would call <b>SQLDriverConnect</b> with the <b>DRIVER</b> keyword, then display a custom <b>Select Table</b> dialog box.</p>
</td>
</tr>
<tr valign=top>
<td width=27%><b>SQLLevel</b></td>
<td width=73%>A number indicating the SQL92 grammar supported by the driver:<p>
0 = SQL92 Entry</p>
<p>
1 = FIPS127-2 Transitional</p>
<p>
2 = SQL92 Intermediate</p>
<p>
3 = SQL92 Full</p>
<p>
This must be the same as the value returned for the SQL_SQL_CONFORMANCE option in <b>SQLGetInfo</b>.</p>
</td>
</tr>
</table><br>
<p>
For information about usage counts, see “<a href="odch18pr_93dz.htm">Usage Counting</a>” earlier in this chapter.</p>
<p>
For example, suppose a driver for formatted text files has a driver DLL named TEXT.DLL, a separate driver setup DLL named TXTSETUP.DLL, and has been installed three times. If the driver supports the Level 1 API conformance level, supports the Minimum SQL grammar conformance level, treats files as tables, and can use files with the .txt and .csv extensions, the values under the Text subkey might be:</p>
<pre><code>APILevel : REG_SZ : 1
ConnectFunctions : REG_SZ : YYN
Driver : REG_SZ : C:\WINDOWS\SYSTEM32\TEXT.DLL
DriverODBCVer : REG_SZ : 03.00.00
FileExtns : REG_SZ : *.txt,*.csv
FileUsage : REG_SZ : 1
Setup : REG_SZ : C:\WINDOWS\SYSTEM32\TXTSETUP.DLL
SQLLevel : REG_SZ : 0
UsageCount : REG_DWORD : 0x3
</code></pre>
</font></BODY>
</HTML>
