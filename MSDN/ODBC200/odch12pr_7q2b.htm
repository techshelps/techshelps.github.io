<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Updating Data with SQLSetPos</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcupdating_data_with_sqlsetpos"></a>Updating Data with SQLSetPos</h1>
<p>
Applications can update or delete any row in the rowset with <b>SQLSetPos</b>. Calling <b>SQLSetPos</b> is a convenient alternative to constructing and executing an SQL statement. It lets an ODBC driver support positioned updates even when the data source does not support positioned SQL statements. It is part of the paradigm of achieving complete database access by means of function calls.</p>
<p>
<b>SQLSetPos</b> operates on the current rowset and can be used only after a call to <b>SQLFetchScroll</b>. The application specifies the number of the row to update, delete, or insert, and the driver retrieves the new data for that row from the rowset buffers. <b>SQLSetPos</b> can also be used to designate a specified row as the current row, or to refresh a particular row in the rowset from the data source.</p>
<p>
Rowset size is set by a call to <b>SQLSetStmtAttr</b> with an <i>Attribute</i> argument of SQL_ATTR_ROW_ARRAY_SIZE. <b>SQLSetPos</b> uses a new rowset size, however, only after a call to <b>SQLFetch</b> or <b>SQLFetchScroll</b>. For example, if the rowset size is changed, then <b>SQLSetPos</b> is called, then <b>SQLFetch</b> or <b>SQLFetchScroll</b> is called, the call to <b>SQLSetPos</b> uses the old rowset size, but <b>SQLFetch</b> or <b>SQLFetchScroll</b> uses the new rowset size.</p>
<p>
The first row in the rowset is row number 1. The <i>RowNumber</i> argument in <b>SQLSetPos</b> must identify a row in the rowset; that is, its value must be in the range between 1 and the number of rows that were most recently fetched (which may be less than the rowset size). If <i>RowNumber</i> is 0, the operation applies to every row in the rowset.</p>
<p>
Because most interaction with relational databases is done through SQL, <b>SQLSetPos</b> is not widely supported. However, a driver can easily emulate it by constructing and executing an <b>UPDATE</b> or <b>DELETE</b> statement.</p>
<p>
To determine what operations <b>SQLSetPos</b> supports, an application calls <b>SQLGetInfo</b> with the SQL_DYNAMIC_CURSOR_ATTRIBUTES1, SQL_FORWARD_ONLY_CURSOR_ATTRIBUTES1, SQL_KEYSET_CURSOR_ATTRIBUTES1, or SQL_STATIC_CURSOR_ATTRIBUTES1 information option (depending on the type of the cursor).</p>
</font></BODY>
</HTML>
