<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connecting Using File Data Sources</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbcconnecting_using_file_data_sources"></a>Connecting Using File Data Sources</h3>
<p>
<i>The connection information for a file data source</i> is stored in a .dsn file. As a result, the connection string can be used repeatedly by a single user or shared among several users if they have the appropriate driver installed. The file contains a driver name (or another data source name in the case of an unshareable file data source) and optionally, a connection string that can be used by <b>SQLDriverConnect</b>. The Driver Manager builds the connection string for the call to <b>SQLDriverConnect</b> from the keywords in the .dsn file.</p>
<p>
A file data source allows an application to specify connection options without having to build a connection string for use with <b>SQLDriverConnect</b>. The file data source usually is created by specifying the <b>SAVEFILE</b> keyword, which causes the Driver Manager to save the output connection string created by a call to <b>SQLDriverConnect</b> to the .dsn file. That connection string can be used repeatedly by calling <b>SQLDriverConnect</b> with the <b>FILEDSN</b> keyword. This streamlines the connection process and provides a persistent source of the connection string.</p>
<p>
File data sources also can be created by calling <b>SQLCreateDataSource</b> in the installer DLL. Information can be written into the .dsn file by calling <b>SQLWriteFileDSN</b>, and read from the .dsn file by calling <b>SQLReadFileDSN</b>; both of these functions are also in the installer DLL. For information about the installer DLL, see Chapter 19, “<a href="odch19pr_9hv7.htm">Configuring Data Sources</a>.”</p>
<p>
The keywords used for connection information are in the [ODBC] section of a .dsn file. The minimum information that a shareable .dsn file would have in the [ODBC] section is the DRIVER keyword:</p>
<pre><code>DRIVER = SQL Server
</code></pre>
<p>
The shareable .dsn file usually contains a connection string, as follows:</p>
<pre><code>DRIVER = SQL Server
UID = Larry
DATABASE = MyDB
</code></pre>
<p>
When the file data source is unshareable, the .dsn file contains only a <b>DSN</b> keyword. When the Driver Manager is sent the information in an unshareable file data source, it connects as necessary to the data source indicated by the <b>DSN</b> keyword. An unshareable .dsn file would contain the following keyword:</p>
<pre><code>DSN = MyDataSource
</code></pre>
<p>
The connection string used for a file data source is the union of the keywords specified in the .dsn file and the keywords specified in the connection string in the call to <b>SQLDriverConnect</b>. If any of the keywords in the .dsn file conflict with keywords in the connection string, the Driver Manager decides which keyword value should be used. For more information, see <a href="odch21dpr_4ed0.htm">SQLDriverConnect</a>.</p>
</font></BODY>
</HTML>
