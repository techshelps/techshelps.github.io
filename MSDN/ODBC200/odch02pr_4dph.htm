<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Embedded SQL Example</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbcembedded_sql_example"></a>Embedded SQL Example</h3>
<p>
The following code is a simple embedded SQL program, written in C. The program illustrates many, but not all, of the embedded SQL techniques. The program prompts the user for an order number, retrieves the customer number, salesperson, and status of the order, and displays them on the screen.</p>
<pre><code>main()
{
 EXEC SQL INCLUDE SQLCA;
 EXEC SQL BEGIN DECLARE SECTION;
  int OrderID;&nbsp;&nbsp; /* Employee ID (from user)&nbsp;&nbsp; */
  int CustID;&nbsp;&nbsp;&nbsp; /* Retrieved customer ID&nbsp;&nbsp; */
  char&nbsp; SalesPerson[10]&nbsp; /* Retrieved salesperson name */
  char&nbsp; Status[6]&nbsp;&nbsp;&nbsp; /* Retrieved order status&nbsp; */
 EXEC SQL END DECLARE SECTION;

 /* Set up error processing */
 EXEC SQL WHENEVER SQLERROR GOTO query_error; 
 EXEC SQL WHENEVER NOT FOUND GOTO bad_number;

 /* Prompt the user for order number */
 printf ("Enter order number: ");
 scanf("%d", &amp;OrderID);

 /* Execute the SQL query */
 EXEC SQL SELECT CustID, SalesPerson, Status
 &nbsp;&nbsp; FROM Orders
 &nbsp;&nbsp; WHERE OrderID = :OrderID
 &nbsp;&nbsp; INTO :CustID, :SalesPerson, :Status;

 /* Display the results */
 printf ("Customer number:&nbsp; %d\n", CustID);
 printf ("Salesperson: %s\n", SalesPerson);
 printf ("Status: %s\n", Status);
 exit();

query_error:
 printf ("SQL error: %ld\n", SQLCA.SQLCODE);
 exit();

bad_number:
 printf ("Invalid order number.\n");
 exit();
}
</code></pre>
<p>
Note the following about this program:
<ul type=disc>
<li>
<b>Host Variables</b>. The host variables are declared in a section enclosed by the <b>BEGIN DECLARE SECTION</b> and <b>END DECLARE SECTION</b> keywords. Each host variable name is prefixed by a colon (:) when it appears in an embedded SQL statement. The colon allows the precompiler to distinguish between host variables and database objects, such as tables and columns, that have the same name.<br><br></li>
<li>
<b>Data Types</b>. The data types supported by a DBMS and a host language can be quite different. This affects host variables because they play a dual role. On one hand, host variables are program variables, declared and manipulated by host language statements. On the other hand, they are used in embedded SQL statements to retrieve database data. If there is no host language type that corresponds to a DBMS data type, then the DBMS automatically converts the data. However, because each DBMS has its own rules and idiosyncrasies associated with the conversion process, the host variable types must be chosen carefully.<br><br></li>
<li>
<b>Error Handling</b>. The DBMS reports run-time errors to the applications program through a SQL Communications Area, or SQLCA. In the code example, the first embedded SQL statement is INCLUDE SQLCA. This tells the precompiler to include the SQLCA structure in the program. This is required whenever the program will process errors returned by the DBMS. The WHENEVER...GOTO statement tells the precompiler to generate error-handling code that branches to a specific label when an error occurs.<br><br></li>
<li>
<b>Singleton SELECT</b>. The statement used to return the data is a singleton SELECT statement; that is, it returns only a single row of data. Therefore, the code example does not declare or use cursors.</li>
</ul>
</font></BODY>
</HTML>
