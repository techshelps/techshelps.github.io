<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Environment Transitions</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcenvironment_transitions"></a>Environment Transitions</h1>
<p>
ODBC environments have the following three states.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=13%><b>State</b></td>
<td class=label width=87%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=13%>E0</td>
<td width=87%>Unallocated environment</td>
</tr>
<tr valign=top>
<td width=13%>E1</td>
<td width=87%>Allocated environment, unallocated connection</td>
</tr>
<tr valign=top>
<td width=13%>E2</td>
<td width=87%>Allocated environment, allocated connection</td>
</tr>
</table><br>
<p>
The following tables show how each ODBC function affects the environment state.</p>
<h1>SQLAllocHandle</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=570>
<tr valign=top>
<td class=label width=30%><b>E0<br>
Unallocated</b></td>
<td class=label width=31%><b>E1<br>
Allocated</b></td>
<td class=label width=39%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=30%> E1 [1]</td>
<td width=31%>-- [4]</td>
<td width=39%>-- [4]</td>
</tr>
<tr valign=top>
<td width=30%>(IH) [2]</td>
<td width=31%>E2 [5]<br>
(HY010) [6]</td>
<td width=39%>-- [4]</td>
</tr>
<tr valign=top>
<td width=30%>(IH) [3]</td>
<td width=31%>(IH)</td>
<td width=39%>-- [4]</td>
</tr>
</table><br>
<p class=mini>
[1]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_ENV.</p>
<p class=mini>
[2]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_DBC.</p>
<p class=mini>
[3]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_STMT or SQL_HANDLE_DESC.</p>
<p class=mini>
[4]Calling <b>SQLAllocHandle</b> with <i>OutputHandlePtr</i> pointing to a valid handle overwrites that handle. This may be an application programming error. </p>
<p class=mini>
[5]The SQL_ATTR_ODBC_VERSION environment attribute had been set on the environment.</p>
<p class=mini>
[6]The SQL_ATTR_ODBC_VERSION environment attribute had not been set on the environment.</p>
<h1>SQLDataSources and SQLDrivers</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=570>
<tr valign=top>
<td class=label width=30%><b>E0<br>
Unallocated</b></td>
<td class=label width=31%><b>E1<br>
Allocated</b></td>
<td class=label width=39%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=30%>(IH)</td>
<td width=31%>-- [1]<br>
(HY010) [2]</td>
<td width=39%>-- [1]<br>
(HY010) [2]</td>
</tr>
</table><br>
<p class=mini>
[1]The SQL_ATTR_ODBC_VERSION environment attribute had been set on the environment.</p>
<p class=mini>
[2]The SQL_ATTR_ODBC_VERSION environment attribute had not been set on the environment.</p>
<h1>SQLEndTran</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=570>
<tr valign=top>
<td class=label width=30%><b>E0<br>
Unallocated</b></td>
<td class=label width=31%><b>E1<br>
Allocated</b></td>
<td class=label width=39%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=30%>(IH) [1]</td>
<td width=31%>-- [3]<br>
(HY010) [4]</td>
<td width=39%>-- [3]<br>
(HY010) [4]</td>
</tr>
<tr valign=top>
<td width=30%>(IH) [2]</td>
<td width=31%>(IH)</td>
<td width=39%>--</td>
</tr>
</table><br>
<p class=mini>
[1]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_ENV.</p>
<p class=mini>
[2]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_DBC.</p>
<p class=mini>
[3]The SQL_ATTR_ODBC_VERSION environment attribute had been set on the environment.</p>
<p class=mini>
[4]The SQL_ATTR_ODBC_VERSION environment attribute had not been set on the environment.</p>
<h1>SQLFreeHandle</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=570>
<tr valign=top>
<td class=label width=30%><b>E0<br>
Unallocated</b></td>
<td class=label width=31%><b>E1<br>
Allocated</b></td>
<td class=label width=39%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=30%> (IH) [1]</td>
<td width=31%>E0</td>
<td width=39%>(HY010)</td>
</tr>
<tr valign=top>
<td width=30%>(IH) [2]</td>
<td width=31%>(IH)</td>
<td width=39%>-- [4]<br>
E1 [5]</td>
</tr>
<tr valign=top>
<td width=30%>(IH) [3]</td>
<td width=31%>(IH)</td>
<td width=39%>--</td>
</tr>
</table><br>
<p class=mini>
[1]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_ENV.</p>
<p class=mini>
[2]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_DBC.</p>
<p class=mini>
[3]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_STMT or SQL_HANDLE_DESC.</p>
<p class=mini>
[4]There were other allocated connection handles.</p>
<p class=mini>
[5]The connection handle specified in <i>Handle</i> was the only allocated connection handle.</p>
<h1>SQLGetDiagField and SQLGetDiagRec</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=570>
<tr valign=top>
<td class=label width=30%><b>E0<br>
Unallocated</b></td>
<td class=label width=31%><b>E1<br>
Allocated</b></td>
<td class=label width=39%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=30%>(IH) [1]</td>
<td width=31%>--</td>
<td width=39%>--</td>
</tr>
<tr valign=top>
<td width=30%>(IH) [2]</td>
<td width=31%>(IH)</td>
<td width=39%>--</td>
</tr>
</table><br>
<p class=mini>
[1]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_ENV.</p>
<p class=mini>
[2]This row shows transitions when <i>HandleType</i> was SQL_HANDLE_DBC, SQL_HANDLE_STMT, or SQL_HANDLE_DESC.</p>
<h1>SQLGetEnvAttr</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=570>
<tr valign=top>
<td class=label width=30%><b>E0<br>
Unallocated</b></td>
<td class=label width=31%><b>E1<br>
Allocated</b></td>
<td class=label width=39%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=30%>(IH)</td>
<td width=31%>-- [1]<br>
(HY010) [2]</td>
<td width=39%>--</td>
</tr>
</table><br>
<p class=mini>
[1]The SQL_ATTR_ODBC_VERSION environment attribute had been set on the environment.</p>
<p class=mini>
[2]The SQL_ATTR_ODBC_VERSION environment attribute had not been set on the environment.</p>
<h1>SQLSetEnvAttr</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=570>
<tr valign=top>
<td class=label width=30%><b>E0<br>
Unallocated</b></td>
<td class=label width=31%><b>E1<br>
Allocated</b></td>
<td class=label width=39%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=30%>(IH)</td>
<td width=31%>-- [1]<br>
(HY010) [2]</td>
<td width=39%>(HY011)</td>
</tr>
</table><br>
<p class=mini>
[1]The SQL_ATTR_ODBC_VERSION environment attribute had been set on the environment.</p>
<p class=mini>
[2]The <i>Attribute</i> argument was not SQL_ATTR_ODBC_VERSION and the SQL_ATTR_ODBC_VERSION environment attribute had not been set on the environment.</p>
<h1>All Other ODBC Functions</h1>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=29%><b>E0<br>
Unallocated</b></td>
<td class=label width=30%><b>E1<br>
Allocated</b></td>
<td class=label width=41%><b>E2<br>
Connection</b></td>
</tr>
<tr valign=top>
<td width=29%>(IH)</td>
<td width=30%>(IH)</td>
<td width=41%>--</td>
</tr>
</table><br>
</font></BODY>
</HTML>
