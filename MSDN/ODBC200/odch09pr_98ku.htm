<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Direct Execution</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcdirect_execution"></a>Direct Execution</h2>
<p>
Direct execution is the simplest way to execute a statement. When the statement is submitted for execution, the data source compiles it into an access plan and then executes that access plan.</p>
<p>
Direct execution is commonly used by generic applications that build and execute statements at run time. For example, the following code builds an SQL statement and executes it a single time:</p>
<pre><code>SQLCHAR *SQLStatement;

// Build an SQL statement.
BuildStatement(SQLStatement);

// Execute the statement.
SQLExecDirect(hstmt, SQLStatement, SQL_NTS);
</code></pre>
<p>
Direct execution works best for statements that will be executed a single time. Its major drawback is that the SQL statement is parsed every time it is executed. In addition, the application cannot retrieve information about the result set created by the statement (if any) until after the statement is executed; this is possible if the statement is prepared and executed in two separate steps.</p>
<p>
To execute a statement directly, the application:
<ol>
<li>
Sets the values of any parameters. For more information, see “<a href="odch09pr_2tpv.htm">Statement Parameters</a>,” later in this chapter.<br><br></li>
<li>
Calls <b>SQLExecDirect</b> and passes it a string containing the SQL statement.<br><br></li>
<li>
When <b>SQLExecDirect</b> is called, the driver:<ul type=disc>
<li>
Modifies the SQL statement to use the data source’s SQL grammar without parsing the statement; this includes replacing the escape sequences discussed in “<a href="odch08pr_34df.htm">Escape Sequences in ODBC</a>” in Chapter 8, “SQL Statements.” The application can retrieve the modified form of an SQL statement by calling <b>SQLNativeSql</b>. Note that escape sequences are not replaced if the SQL_ATTR_NOSCAN statement attribute is set.<br><br></li>
<li>
Retrieves the current parameter values and converts them as necessary. For more information, see “<a href="odch09pr_2tpv.htm">Statement Parameters</a>,” later in this chapter.<br><br></li>
<li>
Sends the statement and converted parameter values to the data source for execution.<br><br></li>
<li>
Returns any errors. These include sequencing or state diagnostics such as SQLSTATE 24000 (Invalid cursor state), syntactic errors such as SQLSTATE 42000 (Syntax error or access violation), and semantic errors such as SQLSTATE 42S02 (Base table or view not found).</li>
</ul>
</li>
</ol>
</font></BODY>
</HTML>
