<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Datetime Data Types</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcdatetime_data_types"></a>Datetime Data Types</h1>
<p>
In ODBC 3.x, the identifiers for date, time, and timestamp SQL data types have changed from SQL_DATE, SQL_TIME, and SQL_TIMESTAMP (with instances of <b>#define</b> in the header file of 9, 10, and 11) to SQL_TYPE_DATE, SQL_TYPE_TIME, and SQL_TYPE_TIMESTAMP (with instances of <b>#define</b> in the header file of 91, 92, and 93), respectively. The corresponding C type identifiers have changed from SQL_C_DATE, SQL_C_TIME, and SQL_C_TIMESTAMP to SQL_C_TYPE_DATE, SQL_C_TYPE_TIME, and SQL_C_TYPE_TIMESTAMP, respectively, and the instances of <b>#define</b> have changed accordingly. </p>
<p>
The column size and decimal digits returned for the SQL datetime data types in ODBC 3.x are the same as the precision and scale returned for them in ODBC 2.<i>x</i>. These values are different than the values in the SQL_DESC_PRECISION and SQL_DESC_SCALE descriptor fields. (For more information, see Appendix D, “<a href="odappdpr_8kab.htm">Data Types</a>.”)</p>
<p>
These changes affect <b>SQLDescribeCol</b>, <b>SQLDescribeParam</b>, and <b>SQLColAttributes</b>; <b>SQLBindCol</b>, <b>SQLBindParameter</b>, and <b>SQLGetData</b>; and <b>SQLColumns</b>, <b>SQLGetTypeInfo</b>, <b>SQLProcedureColumns</b>, <b>SQLStatistics</b>, and <b>SQLSpecialColumns</b>.</p>
<p>
An ODBC 3.x driver processes the function calls listed in the previous paragraph according to the setting of the SQL_ATTR_ODBC_VERSION environment attribute. For <b>SQLColumns</b>, <b>SQLGetTypeInfo</b>, <b>SQLProcedureColumns</b>, <b>SQLSpecialColumns</b>, and <b>SQLStatistics</b>, if SQL_ATTR_ODBC_VERSION is set to SQL_OV_ODBC3, the functions return SQL_TYPE_DATE, SQL_TYPE_TIME, and SQL_TYPE_TIMESTAMP in the DATA_TYPE field. The COLUMN_SIZE column (in the result set returned by <b>SQLColumns</b>, <b>SQLGetTypeInfo</b>, <b>SQLProcedureColumns</b>, and <b>SQLSpecialColumns</b>) contains the binary precision for the approximate numeric type. The NUM_PREC_RADIX column (in the result set returned by <b>SQLColumns</b>, <b>SQLGetTypeInfo</b>, and <b>SQLProcedureColumns</b>), contains a value of 2. If SQL_ATTR_ODBC_VERSION is set to SQL_OV_ODBC2, the functions return SQL_DATE, SQL_TIME, and SQL_TIMESTAMP in the DATA_TYPE field, the COLUMN_SIZE column contains the decimal precision for the approximate numeric type, and the NUM_PREC_RADIX column contains a value of 10.</p>
<p>
When all data types are requested in a call to <b>SQLGetTypeInfo</b>, the result set returned by the function will contain both SQL_TYPE_DATE, SQL_TYPE_TIME, and SQL_TYPE_TIMESTAMP as defined in ODBC 3.x, and SQL_DATE, SQL_TIME, and SQL_TIMESTAMP as defined in ODBC 2.<i>x</i>.</p>
<p>
Because of how the ODBC 3.x Driver Manager performs mapping of the date, time, and timestamp data types, ODBC 3.x drivers need only recognize <b>#defines</b> of 91, 92, and 93 for the date, time, and timestamp C data types entered in the <i>TargetType</i> arguments of <b>SQLBindCol</b> and <b>SQLGetData</b> or the <i>ValueType</i> argument of <b>SQLBindParameter</b>, and need only recognize <b>#defines</b> of 91, 92, and 93 for the date, time, and timestamp SQL data types entered in the <i>ParameterType</i> argument of <b>SQLBindParameter</b> or the <i>DataType</i> argument of <b>SQLGetTypeInfo</b>. For more information, see “<a href="odch17pr_0zhv.htm">Datetime Data Type Changes</a>” in Chapter 17, “Programming Considerations.”</p>
</font></BODY>
</HTML>
