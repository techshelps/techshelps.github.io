<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving Bookmarks</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbcretrieving_bookmarks"></a>Retrieving Bookmarks</h3>
<p>
If the application will use bookmarks, it must set the SQL_ATTR_USE_BOOKMARKS statement attribute to SQL_UB_VARIABLE before preparing or executing the statement. This is necessary because building and maintaining bookmarks can be an expensive operation, so bookmarks should be enabled only when an application can make good use of them.</p>
<p>
Bookmarks are returned as column 0 of the result set. There are three ways an application can retrieve them:
<ul type=disc>
<li>
Bind column 0 of the result set. <b>SQLFetch</b> or <b>SQLFetchScroll</b> returns the bookmarks for each row in the rowset along with the data for other bound columns.<br><br></li>
<li>
Call <b>SQLSetPos</b> to position to a row in the rowset, then call <b>SQLGetData</b> for column 0. Note that if a driver supports bookmarks, it must always support the ability to call <b>SQLGetData</b> for column 0, even if it does not allow applications to call <b>SQLGetData</b> for other columns before the last bound column.<br><br></li>
<li>
Call <b>SQLBulkOperations</b> with the <i>Operation</i> argument set to SQL_ADD, and column 0 bound. The cursor inserts the row and returns the bookmark for the row in the bound buffer.</li>
</ul>
</font></BODY>
</HTML>
