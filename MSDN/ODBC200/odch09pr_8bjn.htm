<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Binding Parameter Markers</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbcbinding_parameter_markers"></a>Binding Parameter Markers</h3>
<p>
The application binds parameters by calling <b>SQLBindParameter</b>. <b>SQLBindParameter</b> binds one parameter at a time. With it, the application specifies:
<ul type=disc>
<li>
The parameter number. Parameters are numbered in increasing parameter order in the SQL statement, starting with the number 1. While it is legal to specify a parameter number that is higher than there are parameters in the SQL statement, the parameter value will be ignored when the statement is executed.<br><br></li>
<li>
The parameter type (input, input/output, or output). Except for parameters in procedure calls, all parameters are input parameters. For more information, see “<a href="odch09pr_7egj.htm">Procedure Parameters</a>,” later in this chapter.<br><br></li>
<li>
The C data type, address, and byte length of the variable bound to the parameter. The driver must be able to convert the data from the C data type to the SQL data type or an error is returned. For a list of supported conversions, see Appendix D, “<a href="odappdpr_8kab.htm">Data Types</a>.”<br><br></li>
<li>
The SQL data type, precision, and scale of the parameter itself.<br><br></li>
<li>
The address of a length/indicator buffer. It provides the byte length of binary or character data, specifies that the data is NULL, or specifies that the data will be sent with <b>SQLPutData</b>. For more information, see “<a href="odch04pr_7z5f.htm">Using Length/Indicator Values</a>” in Chapter 4, “ODBC Fundamentals.”</li>
</ul>
<p>
For example, the following code binds <i>SalesPerson</i> and <i>CustID</i> to parameters for the SalesPerson and CustID columns. Because <i>SalesPerson</i> contains character data, which is variable length, the code specifies the byte length of <i>SalesPerson</i> (11) and binds <i>SalesPersonLenOrInd</i> to contain the byte length of the data in <i>SalesPerson</i>. This information is not necessary for <i>CustID</i> because it contains integer data, which is of fixed length.</p>
<pre><code>SQLCHAR&nbsp;&nbsp; SalesPerson[11];
SQLINTEGER&nbsp; SalesPersonLenOrInd, CustIDInd;
SQLUINTEGER CustID;

// Bind SalesPerson to the parameter for the SalesPerson column and
// CustID to the parameter for the CustID column.
SQLBindParameter(hstmt1, 1, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_CHAR, 10, 0,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SalesPerson, sizeof(SalesPerson), &amp;SalesPersonLenOrInd);
SQLBindParameter(hstmt1, 2, SQL_PARAM_INPUT, SQL_C_ULONG, SQL_INTEGER, 10, 0,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;CustID, 0, &amp;CustIDInd);

// Set the values of the salesperson and customer ID variables and length/indicators.
strcpy(SalesPerson, "Garcia");
SalesPersonLenOrInd = SQL_NTS;
CustID = 1331;
CustIDInd = 0;

// Execute a statement to get data for all orders made to the specified
// customer by the specified salesperson.
SQLExecDirect(hstmt1,"SELECT * FROM Orders WHERE SalesPerson=? AND CustID=?",SQL_NTS);
</code></pre>
<p>
When <b>SQLBindParameter</b> is called, the driver stores this information in the structure for the statement. When the statement is executed, it uses the information to retrieve the parameter data and send it to the data source.</p>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>In ODBC 1.0, parameters were bound with <b>SQLSetParam</b>. The Driver Manager maps calls between <b>SQLSetParam</b> and <b>SQLBindParameter</b>, depending on the versions of ODBC used by the application and driver.</p>
</font></BODY>
</HTML>
