<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 3: Build and Execute an SQL Statement</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcstep_3__build_and_execute_an_sql_statement"></a>Step 3: Build and Execute an SQL Statement</h1>
<p>
The third step is to build and execute an SQL statement, as shown in the following figure. The methods used to perform this step are likely to vary tremendously. The application might prompt the user to enter an SQL statement, build an SQL statement based on user input, or use a hard-coded SQL statement. For more information, see “<a href="odch08pr_8s1f.htm">Constructing SQL Statements</a>” in Chapter 8, “SQL Statements.”</p>
<p>
<img src="pr13.gif" border=0></p>
<p>
If the SQL statement contains parameters, the application binds them to application variables by calling <b>SQLBindParameter</b> for each parameter. For more information, see “<a href="odch09pr_2tpv.htm">Statement Parameters</a>” in Chapter 9, “Executing Statements.”</p>
<p>
After the SQL statement is built and any parameters are bound, the statement is executed with <b>SQLExecDirect</b>. If the statement will be executed multiple times, it can be prepared with <b>SQLPrepare</b> and executed with <b>SQLExecute</b>. For more information, see “<a href="odch09pr_4mwk.htm">Executing a Statement</a>” in Chapter 9, “Executing Statements.”</p>
<p>
The application might also forgo executing an SQL statement altogether and instead call a function to return a result set containing catalog information, such as the available columns or tables. For more information, see “<a href="odch07pr_6o9t.htm">Uses of Catalog Data</a>” in Chapter 7, “Catalog Functions.”</p>
<p>
The application’s next action depends on the type of SQL statement executed.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=36%><b>Type of SQL statement</b></td>
<td class=label width=64%><b>Proceed to</b></td>
</tr>
<tr valign=top>
<td width=36%><b>SELECT</b> or catalog function</td>
<td width=64%>“<a href="odch05pr_5tyr.htm">Step 4a: Fetch the Results</a>”</td>
</tr>
<tr valign=top>
<td width=36%><b>UPDATE</b>, <b>DELETE</b>, or <b>INSERT</b></td>
<td width=64%>“<a href="odch05pr_7it0.htm">Step 4b: Fetch the Row Count</a>”</td>
</tr>
<tr valign=top>
<td width=36%> All other SQL statements</td>
<td width=64%>“Step 3: Build and Execute an SQL Statement” (this topic) or “<a href="odch05pr_9ycu.htm">Step 5: Commit the Transaction</a>”</td>
</tr>
</table><br>
</font></BODY>
</HTML>
