<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLGetFunctions</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlgetfunctions"></a>SQLGetFunctions</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 1.0<br>
Standards Compliance:ISO 92</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLGetFunctions</b> returns information about whether a driver supports a specific ODBC function. This function is implemented in the Driver Manager; it can also be implemented in drivers. If a driver implements <b>SQLGetFunctions</b>, the Driver Manager calls the function in the driver. Otherwise, it executes the function itself.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLGetFunctions</b>(<br>
SQLHDBC<i>ConnectionHandle</i>,<br>
SQLUSMALLINT<i>FunctionId</i>,<br>
SQLUSMALLINT *<i>SupportedPtr</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>ConnectionHandle</i></p>
<p class=indent>
[Input]<br>
Connection handle.</p>
<p class=dt>
<i>FunctionId</i></p>
<p class=indent>
[Input]<br>
A <b>#define</b> value that identifies the ODBC function of interest; SQL_API_ODBC3_ALL_FUNCTIONS or SQL_API_ALL_FUNCTIONS. SQL_API_ODBC3_ALL_FUNCTIONS is used by an ODBC 3.x application to determine support of ODBC 3.x and earlier functions. SQL_API_ALL_FUNCTIONS is used by an ODBC 2<i>.x</i> application to determine support of ODBC 2<i>.x</i> and earlier functions. </p>
<p class=tl>
For a list of <b>#define</b> values that identify ODBC functions, see the tables in “Comments.”</P><p class=dt>
<i>SupportedPtr</i></p>
<p class=indent>
[Output] <br>
If <i>FunctionId</i> identifies a single ODBC function, <i>SupportedPtr</i> points to a single SQLUSMALLINT value that is SQL_TRUE if the specified function is supported by the driver, and SQL_FALSE if it is not supported.</p>
<p class=tl>
If <i>FunctionId</i> is SQL_API_ODBC3_ALL_FUNCTIONS, <i>SupportedPtr</i> points to a SQLSMALLINT array with a number of elements equal to SQL_API_ODBC3_ALL_FUNCTIONS_SIZE. This array is treated by the Driver Manager as a 4,000-bit bitmap that can be used to determine whether an ODBC 3.x or earlier function is supported. The SQL_FUNC_EXISTS macro is called to determine function support (see “Comments”). An ODBC 3.x application can call <b>SQLGetFunctions</b> with SQL_API_ODBC3_ALL_FUNCTIONS against either an ODBC 3.x or ODBC 2<i>.x</i> driver.</P><p class=tl>
If <i>FunctionId</i> is SQL_API_ALL_FUNCTIONS, <i>SupportedPtr</i> points to an SQLUSMALLINT array of 100 elements. The array is indexed by <b>#define</b> values used by <i>FunctionId</i> to identify each ODBC function; some elements of the array are unused and reserved for future use. An element is SQL_TRUE if it identifies an ODBC 2<i>.x</i> or earlier function supported by the driver. It is SQL_FALSE if it identifies an ODBC function not supported by the driver or does not identify an ODBC function.</P><p class=tl>
The arrays returned in *<i>SupportedPtr </i>use zero-based indexing.</P><p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLGetFunctions</b> returns SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value can be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_DBC and a <i>Handle</i> of <i>ConnectionHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLGetFunctions</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=23%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=51%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=23%>01000</td>
<td width=26%>General warning</td>
<td width=51%>Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=23%>08S01</td>
<td width=26%>Communication link failure</td>
<td width=51%>The communication link between the driver and the data source to which the driver was connected failed before the function completed processing.</td>
</tr>
<tr valign=top>
<td width=23%>HY000</td>
<td width=26%>General error</td>
<td width=51%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=23%>HY001</td>
<td width=26%>Memory allocation <br>
error</td>
<td width=51%>The driver was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=23%>HY010</td>
<td width=26%>Function sequence error</td>
<td width=51%>(DM) <b>SQLGetFunctions</b> was called before <b>SQLConnect</b>, <b>SQLBrowseConnect</b>, or <b>SQLDriverConnect</b>.<p>
(DM) <b>SQLBrowseConnect</b> was called for the <i>ConnectionHandle</i> and returned SQL_NEED_DATA. This function was called before <b>SQLBrowseConnect</b> returned SQL_SUCCESS_WITH_INFO or SQL_SUCCESS.</p>
</td>
</tr>
<tr valign=top>
<td width=23%>HY013</td>
<td width=26%>Memory management error</td>
<td width=51%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=23%>HY095</td>
<td width=26%>Function type out of range</td>
<td width=51%>(DM) An invalid <i>FunctionId</i> value was specified.</td>
</tr>
<tr valign=top>
<td width=23%>HYT01</td>
<td width=26%>Connection timeout expired</td>
<td width=51%>The connection timeout period expired before the data source responded to the request. The connection timeout period is set through <b>SQLSetConnectAttr</b>, SQL_ATTR_CONNECTION_TIMEOUT.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLGetFunctions</b> always returns that <b>SQLGetFunctions</b>, <b>SQLDataSources</b>, and <b>SQLDrivers</b> are supported. It does this because these functions are implemented in the Driver Manager. The Driver Manager will map an ANSI function to the corresponding Unicode function if the Unicode function exists, and will map a Unicode function to the corresponding ANSI function if the ANSI function exists. For information about how applications use <b>SQLGetFunctions</b>, see “<a href="odch04pr_8o6r.htm">Interface Conformance Levels</a>” in Chapter 4, “ODBC Fundamentals.”</p>
<p>
The following is a list of valid values for <i>FunctionId</i> for functions that conform to the ISO 92 standards&nbsp;–&nbsp;compliance level:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td width=49%>SQL_API_SQLALLOCHANDLE</td>
<td width=51%>SQL_API_SQLGETDESCFIELD</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLBINDCOL</td>
<td width=51%>SQL_API_SQLGETDESCREC</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLCANCEL</td>
<td width=51%>SQL_API_SQLGETDIAGFIELD</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLCLOSECURSOR</td>
<td width=51%>SQL_API_SQLGETDIAGREC</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLCOLATTRIBUTE</td>
<td width=51%>SQL_API_SQLGETENVATTR</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLCONNECT</td>
<td width=51%>SQL_API_SQLGETFUNCTIONS</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLCOPYDESC</td>
<td width=51%>SQL_API_SQLGETINFO</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLDATASOURCES</td>
<td width=51%>SQL_API_SQLGETSTMTATTR</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLDESCRIBECOL</td>
<td width=51%>SQL_API_SQLGETTYPEINFO</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLDISCONNECT</td>
<td width=51%>SQL_API_SQLNUMRESULTCOLS</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLDRIVERS</td>
<td width=51%>SQL_API_SQLPARAMDATA</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLENDTRAN</td>
<td width=51%>SQL_API_SQLPREPARE</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLEXECDIRECT</td>
<td width=51%>SQL_API_SQLPUTDATA</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLEXECUTE</td>
<td width=51%>SQL_API_SQLROWCOUNT</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLFETCH</td>
<td width=51%>SQL_API_SQLSETCONNECTATTR</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLFETCHSCROLL</td>
<td width=51%>SQL_API_SQLSETCURSORNAME</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLFREEHANDLE</td>
<td width=51%>SQL_API_SQLSETDESCFIELD</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLFREESTMT</td>
<td width=51%>SQL_API_SQLSETDESCREC</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLGETCONNECTATTR</td>
<td width=51%>SQL_API_SQLSETENVATTR</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLGETCURSORNAME</td>
<td width=51%>SQL_API_SQLSETSTMTATTR</td>
</tr>
<tr valign=top>
<td width=49%>SQL_API_SQLGETDATA</td>
<td width=51%></td>
</tr>
</table><br>
<p>
The following is a list of valid values for <i>FunctionId</i> for functions conforming to the X/Open standards&nbsp;–&nbsp;compliance level:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td width=53%>SQL_API_SQLCOLUMNS</td>
<td width=47%>SQL_API_SQLSTATISTICS</td>
</tr>
<tr valign=top>
<td width=53%>SQL_API_SQLSPECIALCOLUMNS</td>
<td width=47%>SQL_API_SQLTABLES</td>
</tr>
</table><br>
<p>
The following is a list of valid values for <i>FunctionId</i> for functions conforming to the ODBC standards&nbsp;–&nbsp;compliance level:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td width=48%>SQL_API_SQLBINDPARAMETER</td>
<td colspan=2 width=52%>SQL_API_SQLNATIVESQL</td>
</tr>
<tr valign=top>
<td width=48%>SQL_API_SQLBROWSECONNECT</td>
<td colspan=2 width=52%>SQL_API_SQLNUMPARAMS</td>
</tr>
<tr valign=top>
<td width=48%>SQL_API_SQLBULKOPERATIONS <sup>1</sup></td>
<td colspan=2 width=52%>SQL_API_SQLPRIMARYKEYS</td>
</tr>
<tr valign=top>
<td width=48%>SQL_API_SQLCOLUMNPRIVILEGES</td>
<td colspan=2 width=52%>SQL_API_SQLPROCEDURECOLUMNS</td>
</tr>
<tr valign=top>
<td width=48%>SQL_API_SQLDESCRIBEPARAM</td>
<td colspan=2 width=52%>SQL_API_SQLPROCEDURES</td>
</tr>
<tr valign=top>
<td width=48%>SQL_API_SQLDRIVERCONNECT</td>
<td colspan=2 width=52%>SQL_API_SQLSETPOS</td>
</tr>
<tr valign=top>
<td width=48%>SQL_API_SQLFOREIGNKEYS</td>
<td colspan=2 width=52%>SQL_API_SQLTABLEPRIVILEGES</td>
</tr>
<tr valign=top>
<td width=48%>SQL_API_SQLMORERESULTS</td>
<td colspan=2 width=52%></td>
</tr>
<tr valign=top>
<td class=mini colspan=2 width=81%><sup>1&nbsp;&nbsp; </sup>When working with an ODBC 2.<i>x</i> driver, <b>SQLBulkOperations</b> will be returned as supported only if both of the following are true: the ODBC 2.<i>x</i> driver supports <b>SQLSetPos</b>, and the information type SQL_POS_OPERATIONS returns the SQL_POS_ADD bit as set.</td>
</tr>
</table><br>
<h1>SQL_FUNC_EXISTS Macro</h1>
<p>
The SQL_FUNC_EXISTS(<i>SupportedPtr</i>, <i>FunctionID</i>) macro is used to determine support of ODBC 3.x or earlier functions after <b>SQLGetFunctions</b> has been called with a <i>FunctionId</i> argument of SQL_API_ODBC3_ALL_FUNCTIONS. The application calls SQL_FUNC_EXISTS with the <i>SupportedPtr</i> argument set to the <i>SupportedPtr passed in SQLGetFunctions</i>, and with the <i>FunctionID</i> argument set to the <b>#define</b> for the function. SQL_FUNC_EXISTS returns SQL_TRUE if the function is supported, and SQL_FALSE otherwise.</p>
<p class=indent>
<B><b>Note</b></B> When working with an ODBC 2<i>.x</i> driver, the ODBC 3.x Driver Manager will return SQL_TRUE for <b>SQLAllocHandle</b> and <b>SQLFreeHandle</b>, because <b>SQLAllocHandle</b> is mapped to <b>SQLAllocEnv</b>, <b>SQLAllocConnect</b>, or <b>SQLAllocStmt</b>, and <b>SQLFreeHandle</b> is mapped to <b>SQLFreeEnv</b>, <b>SQLFreeConnect</b>, or <b>SQLFreeStmt</b>. <b>SQLAllocHandle</b> or <b>SQLFreeHandle</b> with a <i>HandleType</i> argument of SQL_HANDLE_DESC is not supported, however, even though SQL_TRUE is returned for the functions, because there is no ODBC 2<i>.x</i> function to map to in this case.</p>
<p class=label>
<b>Code Example</b></p>
<p>
The following two examples show how an application uses <b>SQLGetFunctions</b> to determine if a driver supports <b>SQLTables</b>, <b>SQLColumns</b>, and <b>SQLStatistics</b>. If the driver does not support these functions, the application disconnects from the driver. The first example calls <b>SQLGetFunctions</b> once for each function.</p>
<pre><code>SQLUSMALLINT TablesExists, ColumnsExists, StatisticsExists;

SQLGetFunctions(hdbc, SQL_API_SQLTABLES, &amp;TablesExists);
SQLGetFunctions(hdbc, SQL_API_SQLCOLUMNS, &amp;ColumnsExists);
SQLGetFunctions(hdbc, SQL_API_SQLSTATISTICS, &amp;StatisticsExists);

if (TablesExists &amp;&amp; ColumnsExists &amp;&amp; StatisticsExists) {

   /* Continue with application */

}

SQLDisconnect(hdbc);
</code></pre>
<p>
The second example calls <b>SQLGetFunctions</b> a single time and passes it an array in which <b>SQLGetFunctions</b> returns information about all ODBC functions.</p>
<pre><code>#define FUNCTIONS 100

SQLUSMALLINT fExists[FUNCTIONS];

SQLGetFunctions(hdbc, SQL_API_ALL_FUNCTIONS, fExists);

if (fExists[SQL_API_SQLTABLES] &amp;&amp;
  fExists[SQL_API_SQLCOLUMNS] &amp;&amp;
  fExists[SQL_API_SQLSTATISTICS]) {

   /* Continue with application */

}

SQLDisconnect(hdbc);
</code></pre>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>For information about</b></td>
<td class=label width=50%><b>See</b></td>
</tr>
<tr valign=top>
<td width=50%> Returning the setting of a connection attribute</td>
<td width=50%><a href="odch21fpr_0j1u.htm">SQLGetConnectAttr</a></td>
</tr>
<tr valign=top>
<td width=50%>Returning information about a driver or data source</td>
<td width=50%><a href="odch21gpr_5fu7.htm">SQLGetInfo</a></td>
</tr>
<tr valign=top>
<td width=50%>Returning the setting of a statement attribute</td>
<td width=50%><a href="odch21hpr_9uya.htm">SQLGetStmtAttr</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
