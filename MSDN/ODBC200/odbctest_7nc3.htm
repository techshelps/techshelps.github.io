<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AutoTestFunc</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="autotestfunc"></a>AutoTestFunc</h1>
<p class=label>
<b>Description</b></p>
<p>
<b>AutoTestFunc</b> runs one or more test cases in an auto test.</p>
<p class=label>
<b>C Prototype</b></p>
<p>
<b>void EXTFUN AutoTestFunc</b>(<br>
lpSERVERINFO <i>lpServer</i>); /* Input:&nbsp; Test information */</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>lpServer</i></p>
<p class=indent>
The <i>lpServer</i> argument is a SERVERINFO structure containing information that includes the test cases to run, the test source to run them against, and how to run them. The SERVERINFO structure is defined in the AUTOTEST.H file. It has the following members:
<ul type=disc>
<li>
<i>hwnd</i>—The handle of the window to which <b>szLogPrintf</b> and <b>szMessageBox</b> write screen output. <i>hwnd</i> is passed by <b>AutoTestFunc </b>to calls to<b> szMessageBox</b>.<br><br></li>
<li>
<i>szLogFile—</i>The name of the log file to which <b>szLogPrintf</b> writes file output. <i>szLogFile</i> is not used by <b>AutoTestFunc</b>.<br><br></li>
<li>
<i>henv</i>, <i>hdbc</i>, <i>hstmt—</i>If the test source is not "ODBC Test Handles," these are null and the auto test must allocate its own handles. If the test source is "ODBC Test Handles," these are the currently selected environment, connection, and statement handles; if there are no currently selected environment, connection, and statement handles, these are SQL_NULL_HANDLE.<br><br></li>
<li>
<i>szSource—</i>The name of the test source.<br><br></li>
<li>
<i>szValidServer0—</i>The name of the data source associated with the test source. The auto test connects to this data source. <i>szValidServer0</i> is a null pointer if the test source is "ODBC Test Handles."<br><br></li>
<li>
<i>szValidLogin0—</i>The user ID associated with the test source. The auto test uses this to connect to the data source. <i>szValidLogin0</i> is a null pointer if the test source is "ODBC Test Handles."<br><br></li>
<li>
<i>szValidPassword0—</i>The password associated with the test source. The auto test uses this to connect to the data source. <i>szValidPassword0</i> is a null pointer if the test source is "ODBC Test Handles."<p class=atl>
<b>Caution&nbsp;&nbsp;&nbsp;</b>The password is stored in the \ GATOR32.INI file in unencrypted form. Because of this, you may want to create special data sources and passwords for use with ODBC Test or use only the ODBC Test Handles test source.</p></li>
<li>
<i>szKeywords—</i>The keyword-value pairs associated with the test source. The auto test uses these to connect to the data source. <i>szKeywords</i> is a null pointer if the test source is "ODBC Test Handles."<br><br></li>
<li>
<i>rglMask—</i>A bitmask in which each bit represents a test case to be run. The auto test uses the GETBIT macro from the AUTOTEST.H file to determine which bits are set.<br><br></li>
<li>
<i>failed—</i>Included for backward compatibility with ODBC Test 1.0.<br><br></li>
<li>
<i>cErrors—</i>The number of errors that occurred in all test cases run by <b>AutoTestFunc</b>. ODBC Test displays this number after it has called <b>AutoTestFunc</b>.<br><br></li>
<li>
<i>fDebug—</i>TRUE if debugging was specified in the <b>Run Auto Tests</b> dialog box; otherwise, FALSE. What <b>AutoTestFunc</b> does when <i>fDebug</i> is TRUE depends on how it was written.<br><br></li>
<li>
<i>fScreen—</i>TRUE if the <b>Screen</b> box was selected in the <b>Run Auto Tests</b> dialog box; otherwise, FALSE. <i>fScreen</i> is used by the <b>szLogPrintf</b> function in ODBC Test to determine whether to log output to the screen; it is not used by <b>AutoTestFunc</b>.<br><br></li>
<li>
<i>fLog—</i>TRUE if the <b>Log File</b> box was selected in the <b>Run Auto Tests</b> dialog box; otherwise, FALSE. <i>fLog</i> is used by the <b>szLogPrintf</b> function in ODBC Test to determine whether to log output to the log file; it is not used by <b>AutoTestFunc</b>.<br><br></li>
<li>
<i>fIsolate—</i>If the <b>Isolate Tests</b> box was selected in the <b>Run Auto Tests</b> dialog box, this will be TRUE and a single bit will be set in the <i>rglMask</i> member. Otherwise, FALSE.<br><br></li>
<li>
<i>vCursorLib—</i>SQL_CUR_USE_IF_NEEDED, SQL_CUR_USE_ODBC, or SQL_CUR_USE_DRIVER, depending on the setting of the <b>Cursor Library</b> box in the <b>Run Auto Tests</b> dialog box. The auto test can pass this value to <b>SQLSetConnectAttr</b> for the SQL_ATTR_ODBC_CURSORS option.<br><br></li>
<li>
<i>hLoadedInst—</i>The auto-test DLL instance handle.<br><br></li>
<li>
<i>szBuff—</i>Used by <b>szLogPrintf</b> to buffer output until it receives the string " \r\n". <i>szBuff</i> is not used by <b>AutoTestFunc</b>.<br><br></li>
<li>
<i>cBuff—</i>Used by <b>szLogPrintf</b> to count the output in <i>szBuff</i>. <i>cBuff</i> is not used by <b>AutoTestFunc</b>.</li>
</ul>
<p class=label>
<b>Return Value</b></p>
<p>
None.</p>
<p class=label>
<b>Comments</b></p>
<p>
ODBC Test calls this function to run one or more test cases in the auto test. If the <i>szSource</i> member of the SERVERINFO structure specified in the <i>lpServer</i> argument is ODBC Test Handles, <b>AutoTestFunc</b> uses the handles specified in the <i>henv</i>, <i>hdbc</i>, and <i>hstmt</i> members. Otherwise, it connects to the data source specified in the <i>szValidServer0</i> member using the information in the <i>szValidLogin0</i>, <i>szValidPassword0</i>, and <i>szKeywords</i> members.</p>
<p>
<b>AutoTestFunc</b> runs the test cases specified in the <i>rglMask</i> member, using the GETBIT macro to determine which bits are set. It calls <b>szLogPrintf</b> to send output to the screen or log file and stores the total number of errors encountered in the <i>cErrors</i> member.</p>
<p class=label>
<b>Code Example</b></p>
<p>
The following code example shows a simple <b>AutoTestFunc</b> function and supporting function:</p>
<pre><code>void EXTFUN AutoTestFunc(lpSERVERINFO lpServer)
{
   UINT iCase;

   InitTest(lpServer);

   /* Loop through the rglMask bitmask with the */
    /* GETBIT macro to determine the test cases */
   /* to run. NumTests is the count of test */
   /* cases returned by AutoTestName. */

   for (iCase = 1; iCase = NumTests; iCase++)
      if (GETBIT(lpServer-&gt;rglMask, iCase))
         RunTestCase(lpServer, iCase);

   EndTest(lpServer);
}

void INTFUN RunTestCase(lpSERVERINFO lpServer, UINT iCase);
{
   szLogPrintf(lpServer, FALSE, "Running test case %u.\r\n", iCase);

   /* Run the test case specified by iCase. */

   szLogPrintf(lpServer, FALSE, "Test case %u finished.\r\n", iCase);
}
</code></pre>
</font></BODY>
</HTML>
