<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLSetEnvAttr</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqlsetenvattr"></a>SQLSetEnvAttr</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 3.0<br>
Standards Compliance:ISO 92</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLSetEnvAttr</b> sets attributes that govern aspects of environments.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLSetEnvAttr</b>(<br>
SQLHENV<i>EnvironmentHandle</i>,<br>
SQLINTEGER<i>Attribute</i>,<br>
SQLPOINTER<i>ValuePtr</i>,<br>
SQLINTEGER<i>StringLength</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>EnvironmentHandle</i></p>
<p class=indent>
[Input]<br>
Environment handle.</p>
<p class=dt>
<i>Attribute</i></p>
<p class=indent>
[Input]<br>
Attribute to set, listed in “Comments.”</p>
<p class=dt>
<i>ValuePtr</i></p>
<p class=indent>
[Input]<br>
Pointer to the value to be associated with <i>Attribute</i>. Depending on the value of <i>Attribute</i>, <i>ValuePtr</i> will be a 32-bit integer value or point to a null-terminated character string.</p>
<p class=dt>
<i>StringLength</i></p>
<p class=indent>
[Input] If <i>ValuePtr</i> points to a character string or a binary buffer, this argument should be the length of *<i>ValuePtr</i>. If <i>ValuePtr</i> is an integer, <i>StringLength</i> is ignored.</p>
<p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLSetEnvAttr</b> returns SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value can be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_ENV and a <i>Handle</i> of <i>EnvironmentHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLSetEnvAttr</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise. If a driver does not support an environment attribute, the error can be returned only during connect time.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>01S02</td>
<td width=26%>Option value changed</td>
<td width=52%>The driver did not support the value specified in <i>ValuePtr</i> and substituted a similar value. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation <br>
error</td>
<td width=52%>The driver was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=22%>HY009</td>
<td width=26%>Invalid use of null pointer</td>
<td width=52%>The Attribute argument identified an environment attribute that required a string value, and the <i>ValuePtr</i> argument was a null pointer.</td>
</tr>
<tr valign=top>
<td width=22%>HY010</td>
<td width=26%>Function sequence error</td>
<td width=52%>(DM) A connection handle has been allocated on <i>EnvironmentHandle</i>. </td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HY024</td>
<td width=26%>Invalid attribute value</td>
<td width=52%>Given the specified <i>Attribute</i> value, an invalid value was specified in <i>ValuePtr</i>.</td>
</tr>
<tr valign=top>
<td width=22%>HY090</td>
<td width=26%>Invalid string or buffer length</td>
<td width=52%>The <i>StringLength</i> argument was less than 0, but was not SQL_NTS.</td>
</tr>
<tr valign=top>
<td width=22%>HY092</td>
<td width=26%>Invalid attribute/option identifier</td>
<td width=52%>(DM) The value specified for the argument <i>Attribute</i> was not valid for the version of ODBC supported by the driver.</td>
</tr>
<tr valign=top>
<td width=22%>HYC00</td>
<td width=26%>Optional feature not implemented</td>
<td width=52%>The value specified for the argument <i>Attribute</i> was a valid ODBC environment attribute for the version of ODBC supported by the driver, but was not supported by the driver.<p>
(DM) The <i>Attribute</i> argument was SQL_ATTR_OUTPUT_NTS, and <i>ValuePtr</i> was SQL_FALSE.</p>
</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
An application can call <b>SQLSetEnvAttr</b> only if no connection handle is allocated on the environment. All environment attributes successfully set by the application for the environment persist until <b>SQLFreeHandle</b> is called on the environment. More than one environment handle can be allocated simultaneously in ODBC 3.<i>x</i>.</p>
<p>
The format of information set through <i>ValuePtr</i> depends on the specified <i>Attribute</i>. <b>SQLSetEnvAttr</b> will accept attribute information in one of two different formats: a null-terminated character string or a 32-bit integer value. The format of each is noted in the attribute’s description.</p>
<p>
There are no driver-specific environment attributes.</p>
<p>
Connection attributes cannot be set by a call to <b>SQLSetEnvAttr</b>. Attempting to do so will return SQLSTATE HY092 (Invalid attribute/option identifier).</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=38%><b><i>Attribute</i></b></td>
<td class=label width=62%><b><i>ValuePtr</i> contents</b></td>
</tr>
<tr valign=top>
<td width=38%>SQL_ATTR_<br>
CONNECTION_POOLING<br>
(ODBC 3.0)</td>
<td width=62%>A 32-bit SQLUINTEGER value that enables or disables connection pooling at the environment level. The following values are used:<p>
SQL_CP_OFF = Connection pooling is turned off. This is the default.</p>
<p>
SQL_CP_ONE_PER_DRIVER = A single connection pool is supported for each driver. Every connection in a pool is associated with one driver.</p>
<p>
SQL_CP_ONE_PER_HENV = A single connection pool is supported for each environment. Every connection in a pool is associated with one environment.</p>
<p>
Connection pooling is enabled by calling <b>SQLSetEnvAttr</b> to set the SQL_ATTR_CONNECTION_POOLING attribute to SQL_CP_ONE_PER_DRIVER or SQL_CP_ONE_PER_HENV. This call must be made before the application allocates the shared environment for which connection pooling is to be enabled. The environment handle in the call to <b>SQLSetEnvAttr</b> is set to null, which makes SQL_ATTR_CONNECTION_POOLING a process-level attribute. After connection pooling is enabled, the application then allocates an implicit shared environment by calling <b>SQLAllocHandle</b> with the <i>InputHandle</i> argument set to SQL_HANDLE_ENV.</p>
<p>
After connection pooling has been enabled and a shared environment has been selected for an application, SQL_ATTR_CONNECTION_POOLING cannot be reset for that environment, because <b>SQLSetEnvAttr</b> is called with a null environment handle when setting this attribute. If this attribute is set while connection pooling is already enabled on a shared environment, the attribute only affects shared environments that are allocated subsequently.</p>
<p>
For more information, see “<a href="odch06pr_2dev.htm">Connection Pooling</a>” in Chapter 6, “Connecting to a Data Source or Driver.”</p>
</td>
</tr>
<tr valign=top>
<td width=38%>SQL_ATTR_CP_MATCH<br>
(ODBC 3.0)</td>
<td width=62%>A 32-bit SQLUINTEGER value that determines how a connection is chosen from a connection pool. When <b>SQLConnect</b> or <b>SQLDriverConnect</b> is called, the Driver Manager determines which connection is reused from the pool. The Driver Manager attempts to match the connection options in the call and the connection attributes set by the application to the keywords and connection attributes of the connections in the pool. The value of this attribute determines the level of precision of the matching criteria.<p>
The following values are used to set the value of this attribute:</p>
<p>
SQL_CP_STRICT_MATCH = Only connections that exactly match the connection options in the call and the connection attributes set by the application are reused. This is the default.</p>
<p>
SQL_CP_RELAXED_MATCH = Connections with matching connection string keywords can be used. Keywords must match, but not all connection attributes must match.</p>
<p>
For more information on how the Driver Manager performs the match in connecting to a pooled connection, see <a href="odch21cpr_7stw.htm">SQLConnect</a>. For more information on connection pooling, see “<a href="odch06pr_2dev.htm">Connection Pooling</a>” in Chapter 6, “Connecting to a Data Source or Driver.”</p>
</td>
</tr>
<tr valign=top>
<td width=38%>SQL_ATTR_ODBC_VERSION<br>
(ODBC 3.0)</td>
<td width=62%>A 32-bit integer that determines whether certain functionality exhibits ODBC 2<i>.x</i> behavior or ODBC 3.<i>x</i> behavior. The following values are used to set the value of this attribute:<p>
SQL_OV_ODBC3 = The Driver Manager and driver exhibit the following ODBC 3.<i>x</i> behavior:
<ul type=disc>
<li>
The driver returns and expects ODBC 3.<i>x</i> codes for date, time, and timestamp.<br><br></li>
<li>
The driver returns ODBC 3.<i>x</i> SQLSTATE codes when <b>SQLError</b>, <b>SQLGetDiagField</b>, or <b>SQLGetDiagRec</b> are called.<br><br></li>
<li>
The <i>CatalogName</i> argument in a call to <b>SQLTables</b> accepts a search pattern.</li>
</ul>
<p>
SQL_OV_ODBC2 = The Driver Manager and driver exhibit the following ODBC 2<i>.x</i> behavior. This is especially useful for an ODBC 2<i>.x</i> application working with an ODBC 3.<i>x</i> driver.
<ul type=disc>
<li>
The driver returns and expects ODBC 2<i>.x</i> codes for date, time, and timestamp.<br><br></li>
<li>
The driver returns ODBC 2<i>.x</i> SQLSTATE codes when <b>SQLError</b>, <b>SQLGetDiagField</b>, or <b>SQLGetDiagRec</b> are called.<br><br></li>
<li>
The <i>CatalogName</i> argument in a call to <b>SQLTables</b> does not accept a search pattern.</li>
</ul>
<p>
An application must set this environment attribute before calling any function that has an SQLHENV argument, or the call will return SQLSTATE HY010 (Function sequence error). </p>
<p>
For more information, see “<a href="odch06pr_7sj2.htm">Declaring the Application’s ODBC Version</a>” in Chapter 6, “Connecting to a Data Source or Driver” and “<a href="odch17pr_4lgz.htm">Behavioral Changes</a>” in Chapter 17, “Programming Considerations.”
<ul type=disc>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>SQL_ATTR_OUTPUT_NTS<br>
(ODBC 3.0)</td>
<td width=62%>A 32-bit integer that determines how the driver returns string data. If SQL_TRUE, the driver returns string data null-terminated. If SQL_FALSE, the driver does not return string data null-terminated.<p>
This attribute defaults to SQL_TRUE. A call to <b>SQLSetEnvAttr</b> to set it to SQL_TRUE returns SQL_SUCCESS. A call to <b>SQLSetEnvAttr</b> to set it to SQL_FALSE returns SQL_ERROR and SQLSTATE HYC00 (Optional feature not implemented).</p>
</td>
</tr>
</table><br>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Allocating a handle</td>
<td width=52%><a href="odch21bpr_689x.htm">SQLAllocHandle</a></td>
</tr>
<tr valign=top>
<td width=48%>Returning the setting of an environment attribute</td>
<td width=52%><a href="odch21gpr_1tki.htm">SQLGetEnvAttr</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
