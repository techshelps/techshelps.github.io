<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLDrivers</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqldrivers"></a>SQLDrivers</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 2.0<br>
Standards Compliance:ODBC</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLDrivers</b> lists driver descriptions and driver attribute keywords. This function is implemented solely by the Driver Manager.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLDrivers</b>(<br>
SQLHENV<i>EnvironmentHandle</i>,<br>
SQLUSMALLINT<i>Direction</i>,<br>
SQLCHAR *<i>DriverDescription</i>,<br>
SQLSMALLINT<i>BufferLength1</i>,<br>
SQLSMALLINT *<i>DescriptionLengthPtr</i>,<br>
SQLCHAR *<i>DriverAttributes</i>,<br>
SQLSMALLINT<i>BufferLength2</i>,<br>
SQLSMALLINT *<i>AttributesLengthPtr</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>EnvironmentHandle</i></p>
<p class=indent>
[Input]<br>
Environment handle.</p>
<p class=dt>
<i>Direction</i></p>
<p class=indent>
[Input]<br>
Determines whether the Driver Manager fetches the next driver description in the list (SQL_FETCH_NEXT) or whether the search starts from the beginning of the list (SQL_FETCH_FIRST).</p>
<p class=dt>
<i>DriverDescription</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the driver description.</p>
<p class=dt>
<i>BufferLength1</i></p>
<p class=indent>
[Input]<br>
Length of the *<i>DriverDescription</i> buffer, in bytes. </p>
<p class=dt>
<i>DescriptionLengthPtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the total number of bytes (excluding the null-termination byte) available to return in *<i>DriverDescription</i>. If the number of bytes available to return is greater than or equal to <i>BufferLength1</i>, the driver description in *<i>DriverDescription</i> is truncated to <i>BufferLength1</i> minus the length of a null-termination character.</p>
<p class=dt>
<i>DriverAttributes</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the list of driver attribute value pairs (see “Comments”).</p>
<p class=dt>
<i>BufferLength2</i></p>
<p class=indent>
[Input]<br>
Length of the *<i>DriverAttributes</i> buffer, in bytes. If the <i>*DriverDescription</i> value is a Unicode string (when calling <b>SQLDriversW</b>), the <i>BufferLength</i> argument must be an even number.</p>
<p class=dt>
<i>AttributesLengthPtr</i></p>
<p class=indent>
[Output]<br>
Pointer to a buffer in which to return the total number of bytes (excluding the null-termination byte) available to return in *<i>DriverAttributes</i>. If the number of bytes available to return is greater than or equal to <i>BufferLength2</i>, the list of attribute value pairs in *<i>DriverAttributes</i> is truncated to <i>BufferLength2</i> minus the length of the null-termination character.</p>
<p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLDrivers</b> returns either SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value may be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_ENV and a <i>Handle</i> of <i>EnvironmentHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLDrivers</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>(DM) Driver Manager&nbsp;–&nbsp;specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>01004</td>
<td width=26%>String data, right truncated</td>
<td width=52%>(DM) The buffer *<i>DriverDescription</i> was not large enough to return the entire driver description, so the description was truncated. The length of the entire driver description is returned in *<i>DescriptionLengthPtr</i>. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%></td>
<td width=26%></td>
<td width=52%>(DM) The buffer *<i>DriverAttributes</i> was not large enough to return the entire list of attribute value pairs, so the list was truncated. The length of the untruncated list of attribute value pairs is returned in *<i>AttributesLengthPtr</i>. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation <br>
error</td>
<td width=52%>(DM) The Driver Manager was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HY090</td>
<td width=26%>Invalid string or buffer length</td>
<td width=52%>(DM) The value specified for argument <i>BufferLength1</i> was less than 0.<p>
(DM) The value specified for argument <i>BufferLength2</i> was less than 0 or equal to 1.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY103</td>
<td width=26%>Invalid retrieval code</td>
<td width=52%>(DM) The value specified for the argument <i>Direction</i> was not equal to SQL_FETCH_FIRST or SQL_FETCH_NEXT.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLDrivers</b> returns the driver description in the *<i>DriverDescription</i> buffer. It returns additional information about the driver in the *<i>DriverAttributes</i> buffer as a list of keyword-value pairs. All keywords listed in the system information for drivers will be returned for all drivers, except for <b>CreateDSN</b>, which is used to prompt creation of data sources, and therefore is optional. Each pair is terminated with a null byte, and the entire list is terminated with a null byte (that is, two null bytes mark the end of the list). For example, a file-based driver using C syntax might return the following list of attributes (“\0” represents a null character):</p>
<pre><code>FileUsage=1\0FileExtns=*.dbf\0\0
</code></pre>
<p>
If *<i>DriverAttributes</i> is not large enough to hold the entire list, the list is truncated, <b>SQLDrivers</b> returns SQLSTATE 01004 (Data truncated), and the length of the list (excluding the final null-termination byte) is returned in *<i>AttributesLengthPtr</i>.</p>
<p>
Driver attribute keywords are added from the system information when the driver is installed. For more information, see Chapter 18, “<a href="odch18pr_8yur.htm">Installing ODBC Components</a>.”</p>
<p>
An application can call <b>SQLDrivers</b> multiple times to retrieve all driver descriptions. The Driver Manager retrieves this information from the system information. When there are no more driver descriptions, <b>SQLDrivers</b> returns SQL_NO_DATA. If <b>SQLDrivers</b> is called with SQL_FETCH_NEXT immediately after it returns SQL_NO_DATA, it returns the first driver description. For information about how an application uses the information returned by <b>SQLDrivers</b>, see “<a href="odch06pr_4p82.htm">Choosing a Data Source or Driver</a>” in Chapter 6, “Connecting to a Data Source or Driver.”</p>
<p>
If SQL_FETCH_NEXT is passed to <b>SQLDrivers</b> the very first time it is called, <b>SQLDrivers</b> returns the first data source name.</p>
<p>
Because <b>SQLDrivers</b> is implemented in the Driver Manager, it is supported for all drivers regardless of a particular driver’s standards compliance.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>For information about</b></td>
<td class=label width=52%><b>See</b></td>
</tr>
<tr valign=top>
<td width=48%>Discovering and listing values required to connect to a data source</td>
<td width=52%><a href="odch21bpr_15bo.htm">SQLBrowseConnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Connecting to a data source</td>
<td width=52%><a href="odch21cpr_7stw.htm">SQLConnect</a></td>
</tr>
<tr valign=top>
<td width=48%>Returning data source names</td>
<td width=52%><a href="odch21cpr_0d2r.htm">SQLDataSources</a></td>
</tr>
<tr valign=top>
<td width=48%>Connecting to a data source using a connection string or dialog box</td>
<td width=52%><a href="odch21dpr_4ed0.htm">SQLDriverConnect</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
