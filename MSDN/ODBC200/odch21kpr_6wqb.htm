<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLTables</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcsqltables"></a>SQLTables</h1>
<p class=label>
<b>Conformance</b></p>
<p>
Version Introduced:ODBC 1.0<br>
Standards Compliance:X/Open</p>
<p class=label>
<b>Summary</b></p>
<p>
<b>SQLTables</b> returns the list of table, catalog, or schema names, and table types, stored in a specific data source. The driver returns the information as a result set.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLRETURN <b>SQLTables</b>(<br>
SQLHSTMT<i>StatementHandle</i>,<br>
SQLCHAR *<i>CatalogName</i>,<br>
SQLSMALLINT<i>NameLength1</i>,<br>
SQLCHAR *<i>SchemaName</i>,<br>
SQLSMALLINT<i>NameLength2</i>,<br>
SQLCHAR *<i>TableName</i>,<br>
SQLSMALLINT<i>NameLength3</i>,<br>
SQLCHAR *<i>TableType</i>,<br>
SQLSMALLINT<i>NameLength4</i>);</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>StatementHandle</i></p>
<p class=indent>
[Input]<br>
Statement handle for retrieved results.</p>
<p class=dt>
<i>CatalogName</i></p>
<p class=indent>
[Input]<br>
Catalog name. The <i>CatalogName</i> argument accepts search patterns if the SQL_ODBC_VERSION environment attribute is SQL_OV_ODBC3; it does not accept search patterns if SQL_OV_ODBC2 is set. If a driver supports catalogs for some tables but not for others, such as when a driver retrieves data from different DBMSs, an empty string ("") denotes those tables that do not have catalogs.</p>
<p class=tl>
If the SQL_ATTR_METADATA_ID statement attribute is set to SQL_TRUE, <i>CatalogName</i> is treated as an identifier, and its case is not significant. If it is SQL_FALSE, <i>CatalogName</i> is a pattern value argument; it is treated literally, and its case is significant. For more information, see “<a href="odch07pr_841f.htm">Arguments in Catalog Functions</a>” in Chapter 7, “Catalog Functions.”</P><p class=dt>
<i>NameLength1</i></p>
<p class=indent>
[Input]<br>
Length of *<i>CatalogName</i>.</p>
<p class=dt>
<i>SchemaName</i></p>
<p class=indent>
[Input]<br>
String search pattern for schema names. If a driver supports schemas for some tables but not for others, such as when the driver retrieves data from different DBMSs, an empty string ("") denotes those tables that do not have schemas.</p>
<p class=tl>
If the SQL_ATTR_METADATA_ID statement attribute is set to SQL_TRUE, <i>SchemaName</i> is treated as an identifier, and its case is not significant. If it is SQL_FALSE, <i>SchemaName</i> is a pattern value argument; it is treated literally, and its case is significant.</P><p class=dt>
<i>NameLength2</i></p>
<p class=indent>
[Input]<br>
Length of *<i>SchemaName</i>.</p>
<p class=dt>
<i>TableName</i></p>
<p class=indent>
[Input]<br>
String search pattern for table names.</p>
<p class=tl>
If the SQL_ATTR_METADATA_ID statement attribute is set to SQL_TRUE, <i>TableName</i> is treated as an identifier, and its case is not significant. If it is SQL_FALSE, <i>TableName</i> is a pattern value argument; it is treated literally, and its case is significant.</P><p class=dt>
<i>NameLength3</i></p>
<p class=indent>
[Input]<br>
Length of *<i>TableName</i>.</p>
<p class=dt>
<i>TableType</i></p>
<p class=indent>
[Input]<br>
List of table types to match. </p>
<p class=tl>
Note that the SQL_ATTR_METADATA_ID statement attribute has no effect upon the <i>TableType</i> argument. <i>TableType</i> is a value list argument, no matter what the setting of SQL_ATTR_METADATA_ID.</P><p class=dt>
<i>NameLength4</i></p>
<p class=indent>
[Input]<br>
Length of *<i>TableType</i>.</p>
<p class=label>
<b>Returns</b></p>
<p>
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE.</p>
<p class=label>
<b>Diagnostics</b></p>
<p>
When <b>SQLTables</b> returns SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value may be obtained by calling <b>SQLGetDiagRec</b> with a <i>HandleType</i> of SQL_HANDLE_STMT and a <i>Handle</i> of <i>StatementHandle</i>. The following table lists the SQLSTATE values commonly returned by <b>SQLTables</b> and explains each one in the context of this function; the notation “(DM)” precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=22%><b>SQLSTATE</b></td>
<td class=label width=26%><b>Error</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%>01000</td>
<td width=26%>General warning</td>
<td width=52%>Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)</td>
</tr>
<tr valign=top>
<td width=22%>08S01</td>
<td width=26%>Communication link failure</td>
<td width=52%>The communication link between the driver and the data source to which the driver was connected failed before the function completed processing.</td>
</tr>
<tr valign=top>
<td width=22%>24000</td>
<td width=26%>Invalid cursor state</td>
<td width=52%>A cursor was open on the <i>StatementHandle</i> and <b>SQLFetch</b> or <b>SQLFetchScroll</b> had been called. This error is returned by the Driver Manager if <b>SQLFetch</b> or <b>SQLFetchScroll</b> has not returned SQL_NO_DATA, and is returned by the driver if <b>SQLFetch</b> or <b>SQLFetchScroll</b> has returned SQL_NO_DATA.<p>
A cursor was open on the <i>StatementHandle</i> but <b>SQLFetch</b> or <b>SQLFetchScroll</b> had not been called.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>40001</td>
<td width=26%>Serialization failure</td>
<td width=52%>The transaction was rolled back due to a resource deadlock with another transaction.</td>
</tr>
<tr valign=top>
<td width=22%>40003</td>
<td width=26%>Statement completion unknown</td>
<td width=52%>The associated connection failed during the execution of this function and the state of the transaction cannot be determined.</td>
</tr>
<tr valign=top>
<td width=22%>HY000</td>
<td width=26%>General error</td>
<td width=52%>An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by <b>SQLGetDiagRec</b> in the <i>*MessageText</i> buffer describes the error and its cause.</td>
</tr>
<tr valign=top>
<td width=22%>HY001</td>
<td width=26%>Memory allocation <br>
error</td>
<td width=52%>The driver was unable to allocate memory required to support execution or completion of the function.</td>
</tr>
<tr valign=top>
<td width=22%>HY008</td>
<td width=26%>Operation canceled</td>
<td width=52%>Asynchronous processing was enabled for the <i>StatementHandle</i>. The function was called and, before it completed execution, <b>SQLCancel</b> was called on the <i>StatementHandle</i>. Then the function was called again on the <i>StatementHandle</i>.<p>
The function was called and, before it completed execution, <b>SQLCancel</b> was called on the <i>StatementHandle</i> from a different thread in a multithread application.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY009</td>
<td width=26%>Invalid use of null pointer</td>
<td width=52%>(DM) The SQL_ATTR_METADATA_ID statement attribute was set to SQL_TRUE, the <i>CatalogName</i> argument was a null pointer, and the SQL_CATALOG_NAME <i>InfoType</i> returns that catalog names are supported.<p>
(DM) The SQL_ATTR_METADATA_ID statement attribute was set to SQL_TRUE, and the <i>SchemaName</i> or <i>TableName</i> argument was a null pointer.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY010</td>
<td width=26%>Function sequence error</td>
<td width=52%>(DM) An asynchronously executing function (not this one) was called for the <i>StatementHandle</i> and was still executing when this function was called.<p>
(DM) <b>SQLExecute</b>, <b>SQLExecDirect</b>, <b>SQLBulkOperations</b>, or <b>SQLSetPos</b> was called for the <i>StatementHandle</i> and returned SQL_NEED_DATA. This function was called before data was sent for all data-at-execution parameters or columns.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HY013</td>
<td width=26%>Memory management error</td>
<td width=52%>The function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.</td>
</tr>
<tr valign=top>
<td width=22%>HY090</td>
<td width=26%>Invalid string or buffer length</td>
<td width=52%>(DM) The value of one of the length arguments was less than 0, but not equal to SQL_NTS.</td>
</tr>
<tr valign=top>
<td width=22%></td>
<td width=26%></td>
<td width=52%>The value of one of the name length arguments exceeded the maximum length value for the corresponding name.</td>
</tr>
<tr valign=top>
<td width=22%>HYC00</td>
<td width=26%>Optional feature not implemented</td>
<td width=52%>A catalog was specified and the driver or data source does not support catalogs.<p>
A schema was specified and the driver or data source does not support schemas.</p>
</td>
</tr>
<tr valign=top>
<td width=22%></td>
<td width=26%></td>
<td width=52%>A string search pattern was specified for the catalog name, table schema, or table name and the data source does not support search patterns for one or more of those arguments.<p>
The combination of the current settings of the SQL_ATTR_CONCURRENCY and SQL_ATTR_CURSOR_TYPE statement attributes was not supported by the driver or data source. </p>
<p>
The SQL_ATTR_USE_BOOKMARKS statement attribute was set to SQL_UB_VARIABLE, and the SQL_ATTR_CURSOR_TYPE statement attribute was set to a cursor type for which the driver does not support bookmarks.</p>
</td>
</tr>
<tr valign=top>
<td width=22%>HYT00</td>
<td width=26%>Timeout expired</td>
<td width=52%>The query timeout period expired before the data source returned the requested result set. The timeout period is set through <b>SQLSetStmtAttr</b>, SQL_ATTR_QUERY_TIMEOUT.</td>
</tr>
<tr valign=top>
<td width=22%>HYT01</td>
<td width=26%>Connection timeout expired</td>
<td width=52%>The connection timeout period expired before the data source responded to the request. The connection timeout period is set through <b>SQLSetConnectAttr</b>, SQL_ATTR_CONNECTION_TIMEOUT.</td>
</tr>
<tr valign=top>
<td width=22%>IM001</td>
<td width=26%>Driver does not support this function</td>
<td width=52%>(DM) The driver associated with the <i>StatementHandle</i> does not support the function.</td>
</tr>
</table><br>
<p class=label>
<b>Comments</b></p>
<p>
<b>SQLTables</b> lists all tables in the requested range. A user may or may not have SELECT privileges to any of these tables. To check accessibility, an application can:
<ul type=disc>
<li>
Call <b>SQLGetInfo</b> and check the SQL_ACCESSIBLE_TABLES information type.<br><br></li>
<li>
Call <b>SQLTablePrivileges</b> to check the privileges for each table.</li>
</ul>
<p>
Otherwise, the application must be able to handle a situation where the user selects a table for which <b>SELECT</b> privileges are not granted.</p>
<p>
The <i>SchemaName</i> and <i>TableName</i> arguments accept search patterns. The <i>CatalogName</i> argument accepts search patterns if the SQL_ODBC_VERSION environment attribute is SQL_OV_ODBC3; it does not accept search patterns if SQL_OV_ODBC2 is set. If SQL_OV_ODBC3 is set, an ODBC 3.x driver will require that wildcard characters in the <i>CatalogName</i> argument be escaped to be treated literally. For more information about valid search patterns, see “<a href="odch07pr_97n7.htm">Pattern Value Arguments</a>” in Chapter 7, “Catalog Functions.”</p>
<p class=indent>
<B><b>Note</b></B> For more information about the general use, arguments, and returned data of ODBC catalog functions, see Chapter 7, “<a href="odch07pr_09rn.htm">Catalog Functions</a>.”</p>
<p>
To support enumeration of catalogs, schemas, and table types, the following special semantics are defined for the <i>CatalogName</i>, <i>SchemaName</i>, <i>TableName</i>, and <i>TableType</i> arguments of <b>SQLTables</b>:
<ul type=disc>
<li>
If <i>CatalogName</i> is SQL_ALL_CATALOGS and <i>SchemaName</i> and <i>TableName</i> are empty strings, then the result set contains a list of valid catalogs for the data source. (All columns except the TABLE_CAT column contain NULLs.)<br><br></li>
<li>
If <i>SchemaName</i> is SQL_ALL_SCHEMAS and <i>CatalogName</i> and <i>TableName</i> are empty strings, then the result set contains a list of valid schemas for the data source. (All columns except the TABLE_SCHEM column contain NULLs.)<br><br></li>
<li>
If <i>TableType</i> is SQL_ALL_TABLE_TYPES and <i>CatalogName</i>, <i>SchemaName</i>, and <i>TableName</i> are empty strings, then the result set contains a list of valid table types for the data source. (All columns except the TABLE_TYPE column contain NULLs.)</li>
</ul>
<p>
If <i>TableType</i> is not an empty string, it must contain a list of comma-separated values for the types of interest; each value may be enclosed in single quotation marks (') or unquoted. For example, “'TABLE','VIEW'” or “TABLE, VIEW”. An application should always specify the table type in uppercase; the driver should convert the table type to whatever case is needed by the data source. If the data source does not support a specified table type, <b>SQLTables</b> does not return any results for that type.</p>
<p>
<b>SQLTables</b> returns the results as a standard result set, ordered by TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, and TABLE_NAME. For information about how this information might be used, see “<a href="odch07pr_6o9t.htm">Uses of Catalog Data</a>” in Chapter 7, “Catalog Functions.”</p>
<p>
To determine the actual lengths of the TABLE_CAT, TABLE_SCHEM, and TABLE_NAME columns, an application can call <b>SQLGetInfo</b> with the SQL_MAX_CATALOG_NAME_LEN, SQL_MAX_SCHEMA_NAME_LEN, and SQL_MAX_TABLE_NAME_LEN information types.</p>
<p>
The following columns have been renamed for ODBC 3.x. The column name changes do not affect backward compatibility because applications bind by column number.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=48%><b>ODBC 2.0 column</b></td>
<td class=label width=52%><b>ODBC 3.x column</b></td>
</tr>
<tr valign=top>
<td width=48%>TABLE_QUALIFIER</td>
<td width=52%>TABLE_CAT</td>
</tr>
<tr valign=top>
<td width=48%>TABLE_OWNER</td>
<td width=52%>TABLE_SCHEM</td>
</tr>
</table><br>
<p>
The following table lists the columns in the result set. Additional columns beyond column 5 (REMARKS) can be defined by the driver. An application should gain access to driver-specific columns by counting down from the end of the result set rather than specifying an explicit ordinal position. For more information, see “<a href="odch07pr_9g8j.htm">Data Returned by Catalog Functions</a>” in Chapter 7, “Catalog Functions.”</p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=27%><b><br>
Column name</b></td>
<td class=label width=15%><b>Column number</b></td>
<td class=label width=16%><b><br>
Data type</b></td>
<td class=label width=42%><b><br>
Comments</b></td>
</tr>
<tr valign=top>
<td width=27%>TABLE_CAT<br>
(ODBC 1.0)</td>
<td width=15%>1</td>
<td width=16%>Varchar</td>
<td width=42%>Catalog name; NULL if not applicable to the data source. If a driver supports catalogs for some tables but not for others, such as when the driver retrieves data from different DBMSs, it returns an empty string ("") for those tables that do not have catalogs.</td>
</tr>
<tr valign=top>
<td width=27%>TABLE_SCHEM<br>
(ODBC 1.0)</td>
<td width=15%>2</td>
<td width=16%>Varchar</td>
<td width=42%>Schema name; NULL if not applicable to the data source. If a driver supports schemas for some tables but not for others, such as when the driver retrieves data from different DBMSs, it returns an empty string ("") for those tables that do not have schemas.</td>
</tr>
<tr valign=top>
<td width=27%>TABLE_NAME<br>
(ODBC 1.0)</td>
<td width=15%>3</td>
<td width=16%>Varchar</td>
<td width=42%>Table name.</td>
</tr>
<tr valign=top>
<td width=27%>TABLE_TYPE<br>
(ODBC 1.0)</td>
<td width=15%>4</td>
<td width=16%>Varchar</td>
<td width=42%>Table type name; one of the following: “TABLE”, “VIEW”, “SYSTEM TABLE”, “GLOBAL TEMPORARY”, “LOCAL TEMPORARY”, “ALIAS”, “SYNONYM”, or a data source&nbsp;–&nbsp;specific type name.<p>
The meanings of “ALIAS” and “SYNONYM” are driver-specific.</p>
</td>
</tr>
<tr valign=top>
<td width=27%>REMARKS<br>
(ODBC 1.0)</td>
<td width=15%>5</td>
<td width=16%>Varchar</td>
<td width=42%>A description of the table.</td>
</tr>
</table><br>
<p class=label>
<b>Code Example</b></p>
<p>
For a code example of a similar function, see <a href="odch21cpr_8nsj.htm">SQLColumns</a>.</p>
<p class=label>
<b>Related Functions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=52%><b>For information about</b></td>
<td class=label width=48%><b>See</b></td>
</tr>
<tr valign=top>
<td width=52%>Binding a buffer to a column in a result set</td>
<td width=48%><a href="odch21bpr_0ht8.htm">SQLBindCol</a></td>
</tr>
<tr valign=top>
<td width=52%>Canceling statement processing</td>
<td width=48%><a href="odch21bpr_5b58.htm">SQLCancel</a></td>
</tr>
<tr valign=top>
<td width=52%>Returning privileges for a column or columns</td>
<td width=48%><a href="odch21cpr_5wvn.htm">SQLColumnPrivileges</a></td>
</tr>
<tr valign=top>
<td width=52%>Returning the columns in a table or tables</td>
<td width=48%><a href="odch21cpr_8nsj.htm">SQLColumns</a></td>
</tr>
<tr valign=top>
<td width=52%>Fetching a single row or a block of data in a forward-only direction</td>
<td width=48%><a href="odch21epr_4zoo.htm">SQLFetch</a></td>
</tr>
<tr valign=top>
<td width=52%>Fetching a block of data or scrolling through a result set</td>
<td width=48%><a href="odch21epr_5m24.htm">SQLFetchScroll</a></td>
</tr>
<tr valign=top>
<td width=52%>Returning table statistics and indexes</td>
<td width=48%><a href="odch21kpr_73n7.htm">SQLStatistics</a></td>
</tr>
<tr valign=top>
<td width=52%>Returning privileges for a table or tables</td>
<td width=48%><a href="odch21kpr_2xtf.htm">SQLTablePrivileges</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
