<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLSetScrollOptions Mapping</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="odbcsqlsetscrolloptions_mapping"></a>SQLSetScrollOptions Mapping</h2>
<p>
When an application calls <b>SQLSetScrollOptions</b> through an ODBC 3.x driver, and the driver does not support <b>SQLSetScrollOptions</b>, the call to:</p>
<pre><code>SQLSetScrollOptions (StatementHandle, Concurrency, KeysetSize, RowsetSize)
</code></pre>
<p>
will result in:
<ul type=disc>
<li>
A call to:<pre><code>SQLGetInfo (ConnectionHandle, InfoType, InfoValuePtr, BufferLength, StringLengthPtr)
</code></pre>
<p class=tl>
with the <i>InfoType</i> argument set to one of the following values, depending on the value of the <i>KeysetSize</i> argument in <b>SQLSetScrollOptions</b>:</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows width=571>
<tr valign=top>
<td class=label width=49%><b><i>KeysetSize</i> argument</b></td>
<td class=label width=51%><b><i>InfoType</i> argument</b></td>
</tr>
<tr valign=top>
<td width=49%>SQL_SCROLL_FORWARD_ONLY</td>
<td width=51%>SQL_FORWARD_ONLY_CURSOR_<br>
ATTRIBUTES2</td>
</tr>
<tr valign=top>
<td width=49%>SQL_SCROLL_STATIC</td>
<td width=51%>SQL_STATIC_CURSOR_<br>
ATTRIBUTES2</td>
</tr>
<tr valign=top>
<td width=49%>SQL_SCROLL_KEYSET_DRIVEN</td>
<td width=51%>SQL_KEYSET_CURSOR_<br>
ATTRIBUTES2</td>
</tr>
<tr valign=top>
<td width=49%>SQL_SCROLL_DYNAMIC</td>
<td width=51%>SQL_DYNAMIC_CURSOR_<br>
ATTRIBUTES2</td>
</tr>
<tr valign=top>
<td width=49%>A value greater than the <i>RowsetSize</i> argument</td>
<td width=51%>SQL_KEYSET_CURSOR_<br>
ATTRIBUTES2</td>
</tr>
</table><br>
<p class=tl>
If the value of the <i>KeysetSize</i> argument is not listed in the previous table, the call to <b>SQLSetScrollOptions</b> returns SQLSTATE S1107 (Row value out of range), and none of the following steps are performed.</P><p class=tl>
The Driver Manager then verifies whether the appropriate bit is set in the <i>*InfoValuePtr</i> value returned by the call to <b>SQLGetInfo</b>, according to the value of the <i>Concurrency</i> argument in <b>SQLSetScrollOptions</b>:</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows width=571>
<tr valign=top>
<td class=label width=47%><b><i>Concurrency</i> argument</b></td>
<td class=label width=53%><b><i>InfoType</i> setting</b></td>
</tr>
<tr valign=top>
<td width=47%>SQL_CONCUR_READ_ONLY</td>
<td width=53%>SQL_CA2_READ_ONLY_<br>
CONCURRENCY</td>
</tr>
<tr valign=top>
<td width=47%>SQL_CONCUR_LOCK</td>
<td width=53%>SQL_CA2_LOCK_CONCURRENCY</td>
</tr>
<tr valign=top>
<td width=47%>SQL_CONCUR_ROWVER</td>
<td width=53%>SQL_CA2_ROWVER_<br>
CONCURRENCY</td>
</tr>
<tr valign=top>
<td width=47%>SQL_CONCUR_VALUES</td>
<td width=53%>SQL_CA2_VALUES_CONCURRENCY</td>
</tr>
</table><br>
<p class=tl>
If the <i>Concurrency</i> argument is not one of the values in the previous table, the call to <b>SQLSetScrollOptions</b> returns SQLSTATE S1108 (Concurrency option out of range), and none of the following steps are performed. If the appropriate bit (as indicated in the previous table) is not set in <i>*InfoValuePtr</i> to one of the values corresponding to the <i>Concurrency</i> argument, the call to <b>SQLSetScrollOptions</b> returns SQLSTATE S1C00 (Driver not capable) and none of the following steps are performed.</P></li>
<li>
A call to:<pre><code>SQLSetStmtAttr (StatementHandle, SQL_ATTR_CURSOR_TYPE, ValuePtr, 0)
</code></pre>
<p class=tl>
with <i>*ValuePtr</i> set to one of the following values, according to the value of the <i>KeysetSize</i> argument in <b>SQLSetScrollOptions</b>:</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows width=571>
<tr valign=top>
<td class=label width=47%><b><i>KeysetSize</i> argument</b></td>
<td class=label width=53%><b><i>*ValuePtr</i></b></td>
</tr>
<tr valign=top>
<td width=47%>SQL_SCROLL_FORWARD_ONLY</td>
<td width=53%>SQL_CURSOR_FORWARD_ONLY</td>
</tr>
<tr valign=top>
<td width=47%>SQL_SCROLL_STATIC</td>
<td width=53%>SQL_CURSOR_STATIC</td>
</tr>
<tr valign=top>
<td width=47%>SQL_SCROLL_KEYSET_DRIVEN</td>
<td width=53%>SQL_CURSOR_KEYSET_DRIVEN</td>
</tr>
<tr valign=top>
<td width=47%>SQL_SCROLL_DYNAMIC</td>
<td width=53%>SQL_CURSOR_DYNAMIC</td>
</tr>
<tr valign=top>
<td width=47%>A value greater than the <i>RowsetSize</i> argument</td>
<td width=53%>SQL_CURSOR_KEYSET_DRIVEN</td>
</tr>
</table><br>
</li>
<li>
A call to:<pre><code>SQLSetStmtAttr (StatementHandle, SQL_ATTR_CONCURRENCY, ValuePtr, 0)
</code></pre>
<p class=tl>
with <i>*ValuePtr</i> set to the <i>Concurrency</i> argument in <b>SQLSetScrollOptions</b>.</P></li>
<li>
If the <i>KeysetSize</i> argument in the call to <b>SQLSetScrollOptions</b> is positive, a call to:<pre><code>SQLSetStmtAttr (StatementHandle, SQL_ATTR_KEYSET_SIZE, ValuePtr, 0)
</code></pre>
<p class=tl>
with <i>*ValuePtr</i> set to the <i>KeysetSize</i> argument in <b>SQLSetScrollOptions</b>.</P></li>
<li>
A call to:<pre><code>SQLSetStmtAttr (StatementHandle, SQL_ROWSET_SIZE, ValuePtr, 0)
</code></pre>
<p class=tl>
with <i>*ValuePtr</i> set to the <i>RowsetSize</i> argument in <b>SQLSetScrollOptions</b>.</P><p class=atl>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>When the Driver Manager maps <b>SQLSetScrollOptions</b> for an application working with an ODBC 3.x driver that does not support <b>SQLSetScrollOptions</b>, the Driver Manager sets the SQL_ROWSET_SIZE statement option, not the SQL_ATTR_ROW_ARRAY_SIZE statement attribute, to the <i>RowsetSize</i> argument in <b>SQLSetScrollOption</b>. As a result, <b>SQLSetScrollOptions</b> cannot be used by an application when fetching multiple rows by a call to <b>SQLFetch</b> or <b>SQLFetchScroll</b>. It can only be used when fetching multiple rows by a call to <b>SQLExtendedFetch</b>.</p></li>
</ul>
</font></BODY>
</HTML>
