<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Executing Procedures</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="odbcexecuting_procedures"></a>Executing Procedures</h3>
<p>
ODBC defines a standard escape sequence for executing procedures. For the syntax of this sequence and a code example that uses it, see “<a href="odch08pr_7h4j.htm">Procedure Calls</a>” in Chapter 8, “SQL Statements.”</p>
<p>
To execute a procedure, an application:
<ol>
<li>
Sets the values of any parameters. For more information, see “<a href="odch09pr_2tpv.htm">Statement Parameters</a>,” later in this chapter.<br><br></li>
<li>
Calls <b>SQLExecDirect</b> and passes it a string containing the SQL statement that executes the procedure. This statement can use the escape sequence defined by ODBC or DBMS-specific syntax; statements that use DBMS-specific syntax are not interoperable.<br><br></li>
<li>
When <b>SQLExecDirect</b> is called, the driver:<ul type=disc>
<li>
Retrieves the current parameter values and converts them as necessary. For more information, see “<a href="odch09pr_2tpv.htm">Statement Parameters</a>,” later in this chapter.<br><br></li>
<li>
Calls the procedure in the data source and sends it the converted parameter values. How the driver calls the procedure is driver-specific. For example, it might modify the SQL statement to use the data source’s SQL grammar and submit this statement for execution, or it might call the procedure directly using a Remote Procedure Call (RPC) mechanism that is defined in the data stream protocol of the DBMS.<br><br></li>
<li>
Returns the values of any input/output or output parameters or the procedure return value, assuming the procedure succeeds. Note that these values might not be available until after all other results (row counts and result sets) generated by the procedure have been processed. If the procedure fails, the driver returns any errors.</li>
</ul>
</li>
</ol>
</font></BODY>
</HTML>
