<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interval Literals</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcinterval_literals"></a>Interval Literals</h1>
<p>
ODBC requires that all drivers support conversion of the SQL_CHAR or SQL_VARCHAR data type to all C interval data types. If the underlying data source does not support interval data types, however, the driver needs to know the correct format of the value in the SQL_CHAR field in order to support these conversions. Similarly, ODBC requires that any ODBC C type be convertible to SQL_CHAR or SQL_VARCHAR, so a driver needs to know what format an interval stored in the character field should have. This section describes the syntax of interval literals, which the driver writer needs to use to validate the SQL_CHAR fields during conversion either to or from C interval data types. </p>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>The complete BNF for interval literals is shown in Appendix C, “<a href="odappcpr_0mcy.htm">SQL Grammar</a>.”</p>
<p>
To pass interval literals as part of an SQL statement, an escape clause syntax is defined for interval literals. For more information, see “<a href="odch08pr_5wfn.htm">Date, Time, and Timestamp Literals</a>” in Chapter 8, “SQL Statements.”</p>
<p>
An interval literal is of the form:</p>
<pre><code>INTERVAL [&lt;sign&gt;] ‘<i>value’</i> &lt;interval qualifier&gt;
</code></pre>
<p>
where “INTERVAL” indicates that the character literal is an interval. The sign can be either plus or minus; it is outside the interval string and is optional.</p>
<p>
The interval qualifier can either be a single datetime field or be composed of two datetime fields, in the form: &lt;leading field&gt; TO &lt;trailing field&gt;. 
<ul type=disc>
<li>
When the interval is composed of a single field, the single field can be a non-second field that may be accompanied by an optional leading precision in parentheses. The single datetime field can also be a second field that may be accompanied by the optional leading precision, the optional fractional-seconds precision in parentheses, or both. If both a leading precision and a fractional-seconds precision are present for a seconds field, they are separated by commas. If the seconds field has a fractional-seconds precision, it must also have a leading precision.<br><br></li>
<li>
When the interval is composed of leading and trailing fields, the leading field is a non-second field that may be accompanied by the interval leading-field precision in parentheses. The trailing field can be either a non-second field, or a second field that may be accompanied by an interval fractional-seconds precision in parentheses.</li>
</ul>
<p>
The interval string in <i>value</i> is enclosed in single quotation marks. It can be either a year-month literal or a day-time literal. The format of the string in <i>value</i> is determined by the following rules:
<ul type=disc>
<li>
The string contains a decimal value for every field that is implied by the &lt;interval qualifier&gt;.<br><br></li>
<li>
If the interval precision includes the fields YEAR and MONTH, then the values of these fields are separated by a minus sign.<br><br></li>
<li>
If the interval precision includes the fields DAY and HOUR, then the values of these fields are separated by a space.<br><br></li>
<li>
If the interval precision includes the field HOUR and the lower order fields (MINUTE and SECOND), then the values of these fields are separated by a colon (:).<br><br></li>
<li>
If the interval precision includes a SECOND field and the expressed or implied seconds precision is non-zero, then the character immediately before the first digit of the fractional part of the second is a period (.).<br><br></li>
<li>
No field can be more than two digits long, except:<ul type=disc>
<li>
The value of the leading field can be as long as the expressed or implied interval leading precision.<br><br></li>
<li>
The fractional part of the SECOND field can be as long as the expressed or implied seconds precision.<br><br></li>
<li>
The trailing fields follow the usual constraints of the Gregorian calendar (see “<a href="odappdpr_7z1u.htm">Constraints of the Gregorian Calendar</a>” later in this appendix).</li>
</ul>
</li>
</ul>
<p>
The following table lists examples of valid interval literals as included in the ODBC escape clause for intervals. The syntax of the escape clause is as follows:</p>
<p>
<i>{INTERVAL sign interval-string interval-qualifier}</i></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Literal escape clause</b></td>
<td class=label width=50%><b>Interval specified</b></td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '326' YEAR(4)}</td>
<td width=50%>Specifies an interval of 326 years. The interval leading precision is 4.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '326' MONTH(3)}</td>
<td width=50%>Specifies an interval of 326 months. The interval leading precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '3261' DAY(4)}</td>
<td width=50%>Specifies an interval of 3261 days. The interval leading precision is 4.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163' HOUR(3)}</td>
<td width=50%>Specifies an interval of 163 days. The interval leading precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163' MINUTE(3)}</td>
<td width=50%>Specifies an interval of 163 minutes. The interval leading precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '223.16' SECOND(3,2)}</td>
<td width=50%>Specifies an interval of 223.16 seconds. The interval leading precision is 3 and the seconds precision is 2.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163-11' YEAR(3) TO MONTH}</td>
<td width=50%>Specifies an interval of 163 years and 11 months. The interval leading precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163 12' DAY(3) TO HOUR}</td>
<td width=50%>Specifies an interval of 163 days and 12 hours. The interval leading precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163 12:39' DAY(3) TO MINUTE}</td>
<td width=50%>Specifies an interval of 163 days, 12 hours, and 39 minutes. The interval leading precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163 12:39:59.163' DAY(3) TO SECOND(3)}</td>
<td width=50%>Specifies an interval of 163 days, 12 hours, 39 minutes, and 59.163 seconds. The interval leading precision is 3, and the seconds precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163:39' HOUR(3) TO MINUTE}</td>
<td width=50%>Specifies an interval of 163 hours and 39 minutes. The interval leading precision is 3.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163:39:59.163' HOUR(3) TO SECOND(4)}</td>
<td width=50%>Specifies an interval of 163 hours, 39 minutes, and 59.163 seconds. The interval leading precision is 3, and the seconds precision is 4.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163:59.163' MINUTE(3) TO SECOND(5)}</td>
<td width=50%>Specifies an interval of 163 minutes and 59.163 seconds. The interval leading precision is 3, and the seconds precision is 5.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL -'16 23:39:56.23' DAY TO SECOND}</td>
<td width=50%>Specifies an interval of minus 16 days, 23 hours, 39 minutes, and 56.23 seconds. The implied leading precision is 2 and the implied seconds precision is 6.</td>
</tr>
</table><br>
<p>
The following table lists examples of invalid interval literals:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Literal escape clause</b></td>
<td class=label width=50%><b>Reason why invalid</b></td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163' HOUR(2)}</td>
<td width=50%>The interval leading precision is 2, but the value of the leading field is 163.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '223.16' SECOND(2,2)}<p>
{INTERVAL '223.16' SECOND(3,1)}</p>
</td>
<td width=50%>In the first example, the leading precision is too small, and in the second example, the seconds precision is too small.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '223.16' SECOND}<p>
{INTERVAL '223' YEAR}</p>
</td>
<td width=50%>Since the leading precision is unspecified, it defaults to 2, which is too small to hold the specified literal.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '22.1234567' SECOND}</td>
<td width=50%>The seconds precision is unspecified and so defaults to 6. The literal has seven digits after the decimal point.</td>
</tr>
<tr valign=top>
<td width=50%>{INTERVAL '163-13' YEAR(3) TO MONTH}<p>
{INTERVAL '163 65' DAY(3) TO HOUR}</p>
<p>
{INTERVAL '163 62:39' DAY(3) TO MINUTE}</p>
<p>
{INTERVAL '163 12:125:59.163' DAY(3) TO SECOND(3)}</p>
<p>
{INTERVAL '163:144' HOUR(3) TO MINUTE}</p>
<p>
{INTERVAL '163:567:234.163' HOUR(3) TO SECOND(4)}</p>
<p>
{INTERVAL '163:591.163' MINUTE(3) TO SECOND(5)}</p>
</td>
<td width=50%>The trailing field does not follow the rules of the Gregorian Calendar. </td>
</tr>
</table><br>
</font></BODY>
</HTML>
