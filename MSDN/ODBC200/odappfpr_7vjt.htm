<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the ODBC Cursor Library</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="odbcusing_the_odbc_cursor_library"></a>Using the ODBC Cursor Library</h1>
<p>
To use the ODBC cursor library, an application:
<ol>
<li>
Calls <b>SQLSetConnectAttr</b> with an <i>Attribute</i> of SQL_ATTR_ODBC_CURSORS to specify how the cursor library should be used with a particular connection. The cursor library can be always used (SQL_CUR_USE_ODBC), used only if driver does not support scrollable cursors (SQL_CUR_USE_IF_NEEDED), or never used (SQL_CUR_USE_DRIVER).<br><br></li>
<li>
Calls <b>SQLConnect</b>, <b>SQLDriverConnect</b>, or <b>SQLBrowseConnect</b> to connect to the data source.<br><br></li>
<li>
Calls <b>SQLSetStmtAttr</b> to specify the cursor type (SQL_ATTR_CURSOR_TYPE), concurrency (SQL_ATTR_CONCURRENCY), and rowset size (SQL_ATTR_ROW_ARRAY_SIZE). The cursor library supports forward-only and static cursors. Forward-only cursors must be read-only, while static cursors may be read-only or use optimistic concurrency control comparing values.<br><br></li>
<li>
Allocates one or more rowset buffers and calls <b>SQLBindCol</b> one or more times to bind these buffers to result set columns.<br><br></li>
<li>
Generates a result set by executing a <b>SELECT</b> statement or a procedure, or by calling a catalog function. If the application will execute positioned update statements, it should execute a <b>SELECT FOR UPDATE</b> statement to generate the result set.<br><br></li>
<li>
Calls <b>SQLFetch</b> or <b>SQLFetchScroll</b> one or more times to scroll through the result set.</li>
</ol>
<p>
The application can change data values in the rowset buffers. To refresh the rowset buffers with data from the cursor library’s cache, an application calls <b>SQLFetchScroll</b> with the <i>FetchOrientation</i> argument set to SQL_FETCH_RELATIVE and the <i>FetchOffset</i> argument set to 0.</p>
<p>
To retrieve data from an unbound column, the application calls <b>SQLSetPos</b> to position the cursor on the desired row. It then calls <b>SQLGetData</b> to retrieve the data.</p>
<p>
To determine the number of rows that have been retrieved from the data source, the application calls <b>SQLRowCount</b>.</p>
</font></BODY>
</HTML>
