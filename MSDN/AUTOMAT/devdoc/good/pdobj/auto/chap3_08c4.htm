<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Accessing a Remote Object</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_oa96_accessing_a_remote_object"></a>Accessing a Remote Object</h2>
<p>
With Visual Basic, accessing a remote object requires only that the program declare an object variable and assign the return of a <b>New </b>statement to the variable. The following is the syntax for the statements:</p>
<p>
<b>Dim</b> <i>ObjectVar</i> <b>As</b> <i>InterfaceName</i><br>
<b>Set</b> <i>ObjectVar</i> <b>=</b> <b>New </b><i>CoClassName</i></p>
<p>
The <b>Dim</b> statement declares a variable of an interface type. The <b>New </b>keyword creates an instance of an object. Used together, the two declare and create an instance of an ActiveX object. For example:</p>
<pre><code>Dim MyLines As ILines
Set MyLines = New Lines.Lines
</code></pre>
<p>
The <b>Dim </b>statement declares the object variable <code>MyLines</code> of the interface type <b>ILines.</b> The <b>Set </b>statement assigns a new object of the <i>component object class</i> (coclass) Lines to the variable <code>MyLines</code><b>.</b> When you use the <b>Dim </b>statement to set a variable to an interface type, subsequent uses of the variable will execute faster than with the generic Object<b> </b>syntax.</p>
<p>
The <b>New </b>keyword applies only to creating coclasses of interface or dispinterface types. To create other types of objects, the variable must be declared with the <b>Dim </b>statement, and the <b>CreateObject</b> function used as follows:</p>
<p>
<b>Set</b> <i>ObjectVar </i><b>=</b> <b>CreateObject(</b><i>ProgID</i><b>)</b></p>
<p>
<b>CreateObject</b> creates an ActiveX object, based on the specified programmatic identifier (ProgID). The ProgID has the form:</p>
<p>
<i>AppName</i>.<i>ObjectName</i></p>
<p>
The <i>AppName</i> is the name of the application, and the <i>ObjectName</i> identifies the type of object to create. For more information about ProgIDs, see "Registering the Application" in Chapter 2, "<a href="chap2_9nqr.htm">Exposing ActiveX Objects</a>." </p>
<p>
You can use the <b>GetObject </b>function to re-establish the reference to the most recently used object that corresponds to the <i>Filename </i>and <i>AppName.ObjectName</i> specification, as follows:</p>
<p>
<b>Set</b> <i>ObjectVar</i> <b>= GetObject("</b><i>Filename</i><b>", </b><i>ProgID</i><b>)</b></p>
<p>
For example, if the ActiveX client needs an existing instance of an object instead of a new instance, it can use the <b>GetObject </b>function.</p>
<p>
The Hello sample application, included in the Win32 Software Development Kit (SDK), displays a Hello message in response to a mouse click. You can add a simple form that accesses the Hello application's exposed object from another process. </p>
<h5>&nbsp;&nbsp;&nbsp;&nbsp;To add a form</h5>
<ol>
<li>
Start Visual Basic.</li>
<li>
Click <b>Open Project</b> on the <b>File</b> menu.</li>
<li>
In the dialog box, click Vb.mak<b> </b>in the Sample directory.</li>
<li>
In the <b>Forms</b> box, click <b>View Form</b> to see the form, or click <b>View Code</b> to see the Visual Basic code.<pre><code>‘Module-level declarations
Dim HelloObj As IHello

Sub Form_load ( )
Set HelloObj = New Hello.Hello
End Sub

Sub Invoke_SayHello_Method_Click ( )
HelloObj.SayHello
End Sub

Sub Get_HelloMsg_Property_Click ()
Debug.Print HelloObj.HelloMessage
End Sub

Sub Set_HelloMsg_Property_Click ( )
HelloObj.HelloMessage = "Hello Universe"
End Sub

Sub SetVisible_Click ( )
HelloObj.Visible = True
End Sub
</code></pre>
</li>
</ol>
<p>
The <b>Form_Load</b> subroutine creates the Hello Application object. Other subroutines manipulate the Hello Application object through the <b>Visible</b> and HelloMessage<b> </b>properties and the SayHello method.</p>
<p>
To program an object in Visual Basic, you need its class name and the names and parameters of its properties and methods. For the Hello sample application, you need to know the exact names of the SayHello method, and the <b>Visible</b> and HelloMsg<b> </b>properties, along with the types of their arguments. This information is provided in the documentation for many objects, such as those exposed by Microsoft Excel. You can also get the information by viewing the object's type library with an object browser, such as the one included in Visual Basic. A sample browser, Browse, is provided in the Win32 SDK.</p>
<p>&nbsp;</p></body>
</HTML>
