<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SafeArrayCopy</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_oa96_safearraycopy"></a>SafeArrayCopy</h1>
<pre><code><b>HRESULT SafeArrayCopy( 
  SAFEARRAY FAR* </b><i> psa</i><b>,          </b>
<b>  SAFEARRAY FAR* FAR* </b><i> ppsaOut  </i>
<b>);</b>
 </code></pre>
<p>
Creates a copy of an existing safe array.</p>
<h4>Parameters</h4>
<dl>
<dt>
<i>psa</i></dt>
<dd>
Pointer to an array descriptor created by <a href="chap7_1rvp.htm"><b>SafeArrayCreate</b></a>.</dd>
<dt>
<i>ppsaOut</i></dt>
<dd>
Pointer to a location in which to return the new array descriptor.
</dd>
</dl>
<h4>Return Value</h4>
<p>
The return value obtained from the returned HRESULT is one of the following.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Return value</th>
<th align=left width=66%>Meaning</th>
</tr>
<tr valign=top>
<td width=34%>S_OK</td>
<td width=66%>Success.</td>
</tr>
<tr valign=top>
<td width=34%>E_INVALIDARG</td>
<td width=66%>The argument <i>psa</i> was not a valid safe array descriptor.</td>
</tr>
<tr valign=top>
<td width=34%>E_OUTOFMEMORY</td>
<td width=66%>Insufficient memory to create the copy. </td>
</tr>
</table><br>
<h4>Comments</h4>
<p>
<b>SafeArrayCopy</b> calls the string or variant manipulation functions if the array to copy contains either of these data types. If the array being copied contains object references, the reference counts for the objects are incremented.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 3.1 and later. <br>
&nbsp;&nbsp;<b>Windows:</b> Use Windows 95 and later. <br>
&nbsp;&nbsp;<b>Header:</b> Declared in oleauto.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with oleaut32.lib.</p>
<h4>See Also</h4>
<p>
<a href="chap7_7u3y.htm"><b>SysAllocStringLen</b></a>, <a href="chap7_7nuh.htm"><b>VariantCopy</b></a>, <a href="chap7_1xb8.htm"><b>VariantCopyInd</b></a></p>
<p>&nbsp;</p></body>
</HTML>
