<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ICreateTypeInfo::AddVarDesc</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_oa96_icreatetypeinfo_addvardesc"></a>ICreateTypeInfo::AddVarDesc</h3>
<pre><code><b>HRESULT AddVarDesc(
  unsigned int </b><i> index</i><b>,    </b>
<b>  VARDESC FAR* </b><i> pVarDesc  </i>
<b>);</b>
 </code></pre>
<p>
Adds a variable or data member description to the type description.</p>
<h4>Parameters</h4>
<dl>
<dt>
<i>index</i></dt>
<dd>
Index of the variable or data member to be added to the type description.</dd>
<dt>
<i>pVarDesc</i></dt>
<dd>
Pointer to the variable or data member description to be added.
</dd>
</dl>
<h4>Return Value</h4>
<p>
The return value of the returned HRESULT is one of the following:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=47%>Return value</th>
<th align=left width=53%>Meaning</th>
</tr>
<tr valign=top>
<td width=47%>S_OK </td>
<td width=53%>Success.</td>
</tr>
<tr valign=top>
<td width=47%>STG_E_INSUFFICIENTMEMORY</td>
<td width=53%>Out of memory.</td>
</tr>
<tr valign=top>
<td width=47%>E_OUTOFMEMORY</td>
<td width=53%>Out of memory.</td>
</tr>
<tr valign=top>
<td width=47%>E_INVALIDARG</td>
<td width=53%>One or more of the arguments is invalid.</td>
</tr>
<tr valign=top>
<td width=47%>E_ACCESSDENIED</td>
<td width=53%>Cannot write to the destination.</td>
</tr>
<tr valign=top>
<td width=47%>TYPE_E_WRONGTYPEKIND</td>
<td width=53%>Type mismatch.</td>
</tr>
</table><br>
<h4>Comments</h4>
<p>
The index specifies the order of the variables. The first variable has an index of zero. <b>ICreateTypeInfo::AddVarDesc </b>returns an error if the specified index is greater than the number of variables currently in the type information. Calling this function does not pass ownership of the VARDESC structure to <b>ICreateTypeInfo</b>. The instance field (<i>oInst</i>) of the VARDESC structure is ignored. This attribute is set only when <a href="chap10_7b1w.htm"><b>ICreateTypeInfo::LayOut</b></a> is called. Also, the member ID fields within the VARDESCs are ignored unless the TYPEKIND of the class is TKIND_DISPATCH.</p>
<p>
Any HREFTYPE fields in the VARDESC structure must have been produced by the same instance of <b>ITypeInfo</b> for which <b>AddVarDesc </b>is called.</p>
<p>
<b>AddVarDesc</b> ignores the contents of the <i>idldesc</i> field of the ELEMDESC.</p>
<p>&nbsp;</p></body>
</HTML>
