<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SysAllocStringByteLen</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_oa96_sysallocstringbytelen"></a>SysAllocStringByteLen</h1>
<pre><code><b>BSTR SysAllocStringByteLen( 
  char FAR* </b><i> psz</i><b>,    </b>
<b>  unsigned int </b><i> len  </i>
<b>);</b>
 </code></pre>
<p>
Takes an ANSI string as input, and returns a BSTR that contains an ANSI string. Does not perform any ANSI-to-Unicode translation.</p>
<h4>Parameters</h4>
<dl>
<dt>
<i>psz</i></dt>
<dd>
A zero-terminated string to copy, or Null to keep the string uninitialized.</dd>
<dt>
<i>len</i></dt>
<dd>
Number of bytes to copy from <i>psz</i>.<b> </b>A null character is placed afterwards, allocating a total of <i>len</i>+1 bytes.</dd>
</dl>
<p>
Allocates a new string of <i>len </i>bytes, copies <i>len </i>bytes from the passed string into it, and then appends a null character. Valid only for 32-bit systems.</p>
<h4>Return Value</h4>
<p>
Points to a copy of the string, or Null if insufficient memory exists.</p>
<h4>Comments</h4>
<p>
This function is provided to create BSTRs that contain binary data. You can use this type of BSTR only in situations where it will not be translated from ANSI to Unicode, or vice versa. </p>
<p>
For example, do not use these BSTRs between a 16-bit and a 32-bit application running on a 32-bit Windows system. The OLE 16-bit to 32-bit (and 32-bit to 16-bit) interoperability layer will translate the BSTR and corrupt the binary data. The preferred method of passing binary data is to use a SAFEARRAY of VT_UI1, which will not be translated by OLE.</p>
<p>
If <i>psz</i> is Null, a string of the requested length is allocated, but not initialized. The string <i>psz</i> can contain embedded null characters, and does not need to end with a Null. Free the returned string later with <a href="chap7_2g6f.htm"><b>SysFreeString</b></a>.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 3.1 and later. <br>
&nbsp;&nbsp;<b>Windows:</b> Use Windows 95 and later. <br>
&nbsp;&nbsp;<b>Header:</b> Declared in oleauto.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with oleaut32.lib.</p>
<p>&nbsp;</p></body>
</HTML>
