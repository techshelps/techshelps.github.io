<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registering Classes</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_oa96_registering_classes"></a>Registering Classes</h3>
<p>
Objects that can be created with <b>CoCreateInstance</b> must also be registered with the system. For these objects, registration maps a CLSID to the Automation component file (.dll or .exe) in which the object resides. The CLSID also maps an ActiveX object back to its application and ProgID. </p>
<p>
The following figure shows how registration connects ProgIDs, CLSIDs, and ActiveX components.</p>
<p>
<img src="images/oa02_05.gif" border=0></p>
<p>
The type library can be obtained from its CLSID using the following syntax:</p>
<p>
\<b>CLSID</b>\<b>TypeLib =</b> <b>{</b><i>UUID of type library</i><b>}</b></p>
<p>
The following syntax indicates that the server is an ActiveX component:</p>
<p>
<b>\CLSID\Programmable</b> </p>
<p>
The following shows the resulting example code; these COM class registry keys are required:</p>
<pre><code>HKEY_CLASSES_ROOT\CLSID\{F37C8061-4AD5-101B-B826-00DD01103DE1} = Hello 2.0 Application
HKEY_CLASSES_ROOT\CLSID\{F37C8061-4AD5-101B-B826-00DD01103DE1}\ProgID = Hello.Application.2
HKEY_CLASSES_ROOT\CLSID\{F37C8061-4AD5-101B-B826-00DD01103DE1}\VersionIndependentProgID = Hello.Application
HKEY_CLASSES_ROOT\CLSID\{F37C8061-4AD5-101B-B826-00DD01103DE1}\LocalServer32 = hello.exe /Automation
HKEY_CLASSES_ROOT\CLSID\{F37C8061-4AD5-101B-B826-00DD01103DE1}\TypeLib = {F37C8060-4AD5-101B-B826-00DD01103DE1}
HKEY_CLASSES_ROOT\CLSID\{F37C8061-4AD5-101B-B826-00DD01103DE1}\Programmable
 </code></pre>
<p>
The registration file uses the following syntax for each class of each object that the application exposes.</p>
<p>
<b>\CLSID\{</b><i>UUID</i><b>}</b> <b>=</b> <i>human_readable_string</i><br>
<b>\CLSID\{</b><i>UUID</i><b>}\ProgID = </b><i>AppName.ObjectName.VersionNumber</i><br>
<b>\CLSID\{</b><i>UUID</i><b>}\VersionIndependentProgID = </b><i>AppName.ObjectName</i><br>
<b>\CLSID\{</b><i>UUID</i><b>}\LocalServer</b>[<b>32</b>]<b> = </b><i>filepath</i>[<b>/Automation</b>]<br>
<b>\CLSID\{</b><i>UUID</i><b>}\InProcServer</b>[<b>32</b>]<b> =</b> <i>filepath</i>[<b>/Automation</b>]
<dl>
<dt>
<i>human_readable_string</i></dt>
<dd>
A string that describes the object to users. The recommended maximum length is 40 characters.</dd>
<dt>
<i>AppName</i></dt>
<dd>
The name of the application, as specified previously in the application registration string.</dd>
<dt>
<i>ObjectName</i></dt>
<dd>
The name of the object to be registered.</dd>
<dt>
<i>VersionNumber</i></dt>
<dd>
The version number of the object.</dd>
<dt>
<i>UUID</i></dt>
<dd>
The universally unique identifier for the application CLSID. To generate a UUID for your class, run the utility Guidgen.exe.</dd>
<dt>
<i>filepath</i></dt>
<dd>
The full path and name of the file that contains the object. The optional <b>/Automation</b> switch tells the application it was launched for Automation purposes. The switch should be specified for the Application object's class. For more information on <b>/Automation</b>, see <a href="chap2_1ecl.htm#_oa96_initializing_the_active_object">"Initializing the Active Object</a>" later in this chapter.
</dd>
</dl>
<p>
The ProgID and VersionIndependentProgID are used by other programmers to gain access to the objects you expose. These identifiers (IDs) should use consistent naming guidelines across all your applications as follows:
<ul>
<li>
Can contain up to 39 characters.</li>
<li>
Must not contain any punctuation (except for the period).</li>
<li>
Must not start with a digit.</li>
</ul>
<p>
Version-independent names consist of an <i>AppName</i>.<i>ObjectName</i>, without a version number. For example, <code>Word.Document</code> or <code>Excel.Chart</code>.</p>
<p>
Version-dependent names consist of an <i>AppName</i>.<i>ObjectName</i>.<i>VersionNumber</i>, such as <code>Excel.Application.5</code>.
<dl>
<dt>
<b>LocalServer</b>[<b>32</b>]</dt>
<dd>
Indicates that the ActiveX component is an .exe file and runs in a separate process from the ActiveX client. The optional 32 specifies a server intended for use on 32-bit Windows systems.</dd>
<dt>
<b>InProcServer</b>[<b>32</b>]</dt>
<dd>
Indicates that the ActiveX component is a DLL and runs in the same process space as the ActiveX client. The optional 32 specifies a server intended for use on 32-bit Windows systems.
<p>
The <i>filepath</i> you register should give the full path and name. Applications should not rely on the MS-DOS PATH variable to find the object.
</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
