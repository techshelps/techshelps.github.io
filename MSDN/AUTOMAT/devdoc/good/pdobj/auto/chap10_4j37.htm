<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ICreateTypeInfo::AddFuncDesc</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_oa96_icreatetypeinfo_addfuncdesc"></a>ICreateTypeInfo::AddFuncDesc</h3>
<pre><code><b>HRESULT AddFuncDesc(
  unsigned int </b><i> index</i><b>,  </b>
<b>  FUNCDESC FAR* </b><i> pFuncDesc  </i>
<b>);</b>
 </code></pre>
<p>
Adds a function description to the type description.</p>
<h4>Parameters</h4>
<dl>
<dt>
<i>index</i></dt>
<dd>
Index of the new FUNCDESC in the type information.</dd>
<dt>
<i>pFuncDesc</i></dt>
<dd>
Pointer to a FUNCDESC structure that describes the function. The <i>bstrIDLInfo</i> field in the FUNCDESC should be set to Null for future compatibility.
</dd>
</dl>
<h4>Return Value</h4>
<p>
The return value of the returned HRESULT is one of the following:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Return value</th>
<th align=left width=51%>Meaning</th>
</tr>
<tr valign=top>
<td width=49%>S_OK</td>
<td width=51%>Success.</td>
</tr>
<tr valign=top>
<td width=49%>STG_E_INSUFFICIENTMEMORY</td>
<td width=51%>Out of memory.</td>
</tr>
<tr valign=top>
<td width=49%>E_OUTOFMEMORY</td>
<td width=51%>Out of memory.</td>
</tr>
<tr valign=top>
<td width=49%>E_INVALIDARG</td>
<td width=51%>One or more of the arguments is invalid.</td>
</tr>
<tr valign=top>
<td width=49%>E_ACCESSDENIED</td>
<td width=51%>Cannot write to the destination.</td>
</tr>
<tr valign=top>
<td width=49%>TYPE_E_WRONGTYPEKIND</td>
<td width=51%>Type mismatch.</td>
</tr>
</table><br>
<h4>Comments</h4>
<p>
The index specifies the order of the functions within the type information. The first function has an index of zero. If an index is specified that exceeds one less than the number of functions in the type information, an error is returned. Calling this function does not pass ownership of the FUNCDESC structure to <b>ICreateTypeInfo</b>. Therefore, the caller must still de-allocate the FUNCDESC structure.</p>
<p>
The passed-in virtual function table (VTBL) field (<i>oVft</i>) of the FUNCDESC is ignored. This attribute is set when <a href="chap10_7b1w.htm"><b>ICreateTypeInfo::LayOut</b></a> is called.</p>
<p>
The function <b>AddFuncDesc</b> uses the passed-in member identifier (ID) fields within each FUNCDESC for classes with TYPEKIND = TKIND_DISPATCH or TKIND_INTERFACE. If the member IDs are set to MEMBERID_NIL, <b>AddFuncDesc </b>assigns member IDs to the functions. Otherwise, the member ID fields within each FUNCDESC are ignored.</p>
<p>
Any HREFTYPE fields in the FUNCDESC structure must have been produced by the same instance of <b>ITypeInfo</b> for which <b>AddFuncDesc </b>is called.</p>
<p>
The <b>get</b> and <b>put</b> accessor functions for the same property must have the same dispatch identifier (DISPID).</p>
<p>&nbsp;</p></body>
</HTML>
