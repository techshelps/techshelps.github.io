<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NUMPARSE Structure</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_oa96_numparse_structure"></a>NUMPARSE Structure</h2>
<p>
Flags used by both <i>dwInFlags</i> and <i>dwOutFlags</i>:</p>
<pre><code>NUMPRS_LEADING_WHITE
 NUMPRS_TRAILING_WHITE
 NUMPRS_LEADING_PLUS    
 NUMPRS_TRAILING_PLUS
 NUMPRS_LEADING_MINUS
 NUMPRS_TRAILING_MINUS
 NUMPRS_HEX_OCT
 NUMPRS_PARENS
 NUMPRS_DECIMAL
 NUMPRS_THOUSANDS
 NUMPRS_CURRENCY    
 NUMPRS_EXPONENT
 NUMPRS_USE_ALL
 NUMPRS_STD
</code></pre>
<p>
Flags used by <i>dwOutFlags</i> only:</p>
<pre><code>NUMPRS_NEG
 NUMPRS_INEXACT
</code></pre>
<p>
The caller of <a href="chap7_5eya.htm"><b>VarParseNumFromStr</b></a> must initialize two elements of the passed-in NUMPARSE structure: </p>
<pre><code>typedef struct {
    int    cDig;
    unsigned long    dwInFlags;
    unsigned long    dwOutFlags;
    int    cchUsed;
    int    nBaseShift;
    int    nPwr10;
} NUMPARSE;</code></pre>
<p>
The<i> cDig</i> element is set to the size of the <i>rgbDi</i>g array, and <i>dwInFlags</i> is set to parsing options. All other elements may be uninitialized and are set by the function, except on error, as described in the following paragraphs. The <i>cDig</i> element is also modified by the function to reflect the actual number of digits written to the <i>rgbDig</i> array.</p>
<p>
The <i>cchUsed</i> element of the NUMPARSE structure is filled in with the number of characters (from the beginning of the string) that were successfully parsed. This allows the caller to determine if the entire string was part of the number (as required by functions such as <b>VarI2FromStr</b>), or where to continue parsing the string.</p>
<p>
The <i>nBaseShift</i> element gives the number of bits per digit (3 or 4 for octal and hexadecimal numbers, and zero for decimal).</p>
<p>
The following apply only to decimal numbers:
<ul>
<li>
<i>nPwr10</i> sets the decimal point position by giving the power of 10 of the least significant digit.</li>
<li>
If the number is negative, NUMPRS_NEG will be set in <i>dwOutFlags</i>.</li>
<li>
If there are more non-zero decimal digits than will fit into the digit array, the NUMPRS_INEXACT flag will be set.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
