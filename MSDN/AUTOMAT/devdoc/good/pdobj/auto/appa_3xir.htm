<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>National Language Support Functions</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_oa96_national_language_support_functions"></a>National Language Support Functions</h1>
<p>
The National Language Support (NLS) functions provide support for applications that use multiple locales at one time, especially applications that support Automation. <a href="chap2_8cqb.htm">Locale</a> information is passed to allow the application to interpret both the member names and the argument data in the proper locale context. The information in this appendix applies only to 16-bit Windows systems. On 32-bit Windows systems, an NLS API is part of the system software. </p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=19%>Implemented by</th>
<th align=left width=27%>Used by</th>
<th align=left width=24%>Header filename</th>
<th align=left width=30%>Import library name</th>
</tr>
<tr valign=top>
<td width=19%>Ole2nls.dll</td>
<td width=27%>Applications that support multiple national languages</td>
<td width=24%>Olenls.h</td>
<td width=30%>Ole2nls.lib</td>
</tr>
</table><br>
<p>
For Automation, applications need to get locale information and to compare and transform strings into the proper format for each locale.</p>
<p>
A<i> locale</i> is simply user-preference information, represented as a list of values describing the user's language and sublanguage. National language support incorporates several disparate definitions of a locale into one coherent model. This model is designed to be general enough at a low level to support multiple, distinct, high-level functions, such as the ANSI C locale functions.</p>
<p>
A <i>code page</i> is the mapping between character glyphs (shapes) and the 1-byte or 2-byte numeric values that are used to represent them. Microsoft Windows uses one of several code pages, depending on the installed localized version of Windows. For example, the Russian version uses code page 1251 (Cyrillic), while the English U.S. and Western European versions use code page 1252 (Multilingual). For historical reasons, the Windows code page in effect is referred to as the ANSI code page.</p>
<p>
Because only one code page is in effect at a time, it is impossible for a computer running English U.S. Windows to display or print data correctly from the Cyrillic code page. The fonts do not contain the Cyrillic characters. However, it can still manipulate the characters internally, and they will display correctly again if moved back to a machine running Russian Windows.</p>
<p>
All NLS functions use the locale identifier (LCID) to identify which code page a piece of text is assumed to lie in. For example, when returning locale information (such as month names) for Russian, the returned string can be meaningfully displayed in the Cyrillic code page only, because other code pages do not contain the appropriate characters. Similarly, when attempting to change the case of a string with the Russian locale, the case-mapping rules assume the characters are in the Cyrillic code page.</p>
<p>
These functions can be divided into two categories.
<ul>
<li>
String transformation — NLS functions support uppercasing, lowercasing, generating sort keys (all locale-dependent), and getting string type information.</li>
<li>
Locale manipulation — NLS functions return information about installed locales for use in string transformations.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
