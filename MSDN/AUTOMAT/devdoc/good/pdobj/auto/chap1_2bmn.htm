<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Do Clients and Objects Interact?</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_oa96_how_do_clients_and_objects_interact_"></a>How Do Clients and Objects Interact?</h1>
<p>
ActiveX clients can access objects in two different ways:
<ul>
<li>
By using the <b>IDispatch</b> <i>interface</i>.</li>
<li>
By calling one of the member functions directly in the object's <i>virtual function table</i> (VTBL).</li>
</ul>
<p>
An Automation interface is a group of related functions that provide a service. All ActiveX objects must implement the <b>IUnknown</b> interface because it manages all of the other interfaces that are supported by the object. The<b> IDispatch</b> interface, which derives from the <b>IUnknown </b>interface, consists of functions that allow access to the methods and properties of ActiveX objects. </p>
<p>
A <i>custom interface </i>is a COM interface that is not defined as part of OLE. Any user-defined interface is a custom interface.</p>
<p>
The VTBL lists the addresses of all the properties and methods that are members of an object, including the member functions of the interfaces that it supports. The first three members of the VTBL are the members of the <b>IUnknown</b> interface. Subsequent entries are members of the other supported interfaces.</p>
<p>
The following figure shows the VTBL for an object that supports the <b>IUnknown</b> and <b>IDispatch</b> interfaces.</p>
<p>
<img src="images/oa01_04.gif" border=0></p>
<p>
If an object does not support <b>IDispatch</b>, the member entries of the object's custom interfaces immediately follow the members of <b>IUnknown</b>. For example, the following figure shows the VTBL for an object that supports a custom interface named IMyInterface.</p>
<p>
<img src="images/oa01_05.gif" border=0></p>
<p>
When an object for Automation is exposed, you must decide whether to implement an <b>IDispatch</b> interface, a VTBL interface, or both. Microsoft strongly recommends that objects provide a <i>dual interface</i>, which supports both access methods. </p>
<p>
In a dual interface, the first three entries in the VTBL are the members of <b>IUnknown</b>, the next four entries are the members of <b>IDispatch</b>, and the subsequent entries are the addresses of the members of the dual interface. </p>
<p>
The following figure shows the VTBL for an object that supports a dual interface named IMyInterface:</p>
<p>
<img src="images/oa01_06.gif" border=0></p>
<p>
In addition to providing access to objects, Automation also provides information about exposed objects. By using <b>IDispatch</b> or a <i>type library</i>, an ActiveX client or programming tool can determine which interfaces an object supports, as well as the names of its members. Type libraries, which are files or parts of files that describe the type of one or more ActiveX objects, are especially useful because they can be accessed at compile time. For information on type libraries, refer to "<a href="chap1_5mzj.htm">What Is a Type Library?</a>" later in this chapter, and "<a href="chap2_7jxv.htm">Type Libraries</a>" in Chapter 2, "<a href="chap2_9nqr.htm">Exposing ActiveX Objects</a>." </p>
<p>&nbsp;</p></body>
</HTML>
