<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Location of Enhancement Files on the Client</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_bpc_location_of_enhancement_files_on_the_client"></a>Location of Enhancement Files on the Client</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Enhancement files can be stored in either of two folders, the spool folder or the base page folder.</p>

<h4><a name="_bpc_spool_folder"></a>Spool Folder</h4>
<p>
The <i>spool folder</i> is where all enhancement files are received during a broadcast. The spool folder is created during the installation of Broadcast Architecture. The location of this folder is stored on the client in the following registry key:</p>
<p>
<b>HKLM\Software\Microsoft\TV Services\Enhanced Content.</b></p>
<p>
For each interactive show episode for which data is received, the Enhancement control creates a subfolder, called an <i>episode folder, </i>within the spool folder. The control gives the episode folder a unique name, for example, "MyEnhShow.5". The control then saves the enhancement files for that show episode in the episode folder. </p>
<p>
The episode folder can be further divided into subfolders. Files relating to a particular episode's enhancements are named relative to the episode folder. For example, if the Enhancement control receives the transmitted file Images\Logo.jpg, then the control creates a folder called Images within the episode folder, if it does not already exist. The control then writes the file Logo.jpg to that folder.</p>

<h4><a name="_bpc_base_page_folder"></a>Base Page Folder</h4>
<p>
The <i>base page folder</i> is the folder that contains the Hypertext Markup Language (HTML) page that resides at the top level or base of the enhancement pages currently loaded into the user's Web browser. The base page is also known as the preload URL. The location of each enhancement's base page is stored in the Guide database. When WebTV for Windows tunes to an interactive show, it retrieves this information from the database and passes it to the Enhancement control.</p>
<p>
The Enhancement control determines the base page folder, by examining the Uniform Resource Locator (URL) of the base page and extracting the path information. The control then uses that path as the base page folder. If a base page is broadcast along with other enhancements for a show episode, then the base page folder is the same as the episode folder. However, the base page can also reside in some other directory on the broadcast client. </p>
<p>
When the Enhancement control receives a trigger to navigate to a file, the control first looks for that file in the episode folder, or a subfolder of the episode folder if one is specified. If the file is not found there, the control next looks in the base page folder, if that is different from the episode folder. An episode may use a combination of enhancement files from the episode folder, the base page folder, or both.</p>
<p>
If the file the client is searching for is not found in either the episode or base page folder, the Enhancement control displays an error message if the control is created in Internet Explorer (authoring mode), and does nothing if the control is created in WebTV for Windows (normal mode).</p>
<p>&nbsp;</p></body>
</HTML>
