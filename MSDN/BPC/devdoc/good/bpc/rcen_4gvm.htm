<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EnhEvent.Attr</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bpc_enhevent.attr"></a>EnhEvent.Attr</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>Attr </b>property is an array of text of the subevents, or microevents stored within an event. The operation codes of these subevents are stored in the <a href="rcen_6ixx.htm"><b>EnhEvent.Opcode</b></a> array.</p>
<h4>Syntax</h4>
<pre><code><i>object</i><b>.Attr(</b><i>index</i><b>) </b>[<b> = </b><i>sAttr</i><b> </b>]<b> </b>
<b> </b></code></pre>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
Object expression that resolves to an <a href="rcen_0g6s.htm"><b>EnhEvent</b></a><b> </b>object.</dd>
<dt>
<i>index</i></dt>
<dd>
<b>Long </b>that indicates the 0-based index of the microevent. This value must always be less than or equal to <a href="rcen_5yb8.htm"><b>EnhEvent.AttrCount</b></a>. If you set index to a value higher than <b>EnhEvent.AttrCount</b>, <b>Attr </b>returns an error.</dd>
<dt>
<i>sAttr</i></dt>
<dd>
<b>String </b>that receives the microevent string. The content of this string depends on the type of microevent. The type of microevent is stored in <b>EnhEvent.Opcode</b>.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=30%>Microevent Type</th>
<th align=left width=70%><i>sAttr</i> contains</th>
</tr>
<tr valign=top>
<td width=30%>Announcement</td>
<td width=70%>Announcement filename.</td>
</tr>
<tr valign=top>
<td width=30%>Delete Announcement</td>
<td width=70%>Announcement filename.</td>
</tr>
<tr valign=top>
<td width=30%>Download</td>
<td width=70%>Path and filename of the file.</td>
</tr>
<tr valign=top>
<td width=30%>Global</td>
<td width=70%>Assignment of the global variable.</td>
</tr>
<tr valign=top>
<td width=30%>Include</td>
<td width=70%>Stream filename.</td>
</tr>
<tr valign=top>
<td width=30%>Trigger</td>
<td width=70%>Trigger data.</td>
</tr>
<tr valign=top>
<td width=30%>User-defined</td>
<td width=70%>User-defined text.</td>
</tr>
<tr valign=top>
<td width=30%>Group</td>
<td width=70%>Handle and positioning information used to unflatten events converted into low-level syntax. The data is formatted as "<i>HandleAsLong</i>[<b>,head</b>]" where <i>HandleAsLong</i> is the original event's handle expressed as a <b>Long</b>. The optional keyword <b>head</b> identifies the original high-level event.</td>
</tr>
</table><br>


</dd>
</dl>
<h4>Remarks</h4>
<p>
Each event can contain one or more microevents. For example, the event set by the following code has three microevents, downloading File1.htm, triggering File2.htm to be displayed in the Left frame, and a comment.</p>
<pre><code>evs.AddText("0:32.0 {File1.htm trigger(2 &lt;File2.htm&gt;[targ:Left]) userdef ""This is a comment"" };")
 </code></pre>
<p>
You can use <b>Attr</b> to add microevents to an event. Simply set either the text or the operation type for the microevent at the <b>AttrCount</b> index. This is demonstrated in the following example:</p>
<pre><code>index = e.AttrCount
 
'Add a new file download microevent to an event.
'Note that this increments AttrCount.
e.Attr(index) = "File1.htm"
 
'Identify the type of microevent operation
e.Opcode(index) = EVOPdownload
 </code></pre>
<p>
For each microevent that you add, you must also specify an operation type such as a trigger, download, or user comment. To do this, set <b>EnhEvent.Opcode</b> at the same index as the new microevent. This is demonstrated in the preceding example.</p>
<p>
You can only add one microevent at a time, attempting to set microevent values at indices higher than <b>AttrCount</b> results in an CTL_E_INVALID_PROPERTYVAL error. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in stream.idl.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in stream.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Yes.</p>
<h4>See Also</h4>
<p>
<a href="rcen_5yb8.htm"><b>EnhEvent.AttrCount</b></a>, <a href="rcen_6ixx.htm"><b>EnhEvent.Opcode</b></a> </p>
<h4>Examples</h4>
<p>
You could access the text of the three microevents programmatically by using the <b>Attr </b>collection. For example, if you set an event such as the one described in the Remarks section, then the following code</p>
<pre><code>Open "MyFile.txt" for Output As #1
Write #1, "Index,"+Chr$(9)+"Opcode,"+Chr$(9)+"Attr"
 
For item = 0 to (e.AttrCount - 1)
  Select Case e.Opcode(item)
  Case EVOPdownload
    Write #1, item, "Chr$(9)+EVOPdownload", Chr$(9)+e.Attr(item)
  Case EVOPtrigger
    Write #1, item, "Chr$(9)+EVOPtrigger", Chr$(9)+e.Attr(item)
  Case EVOPuserdef
    Write #1, item, "Chr$(9)+EVOPuserdef", Chr$(9)+e.Attr(item)
  End Select
Next item 
 
Close #1
 </code></pre>
<p>
writes the following output to MyFile.txt</p>
<pre><code>"Index,  Opcode,       Attr"
 0,      EVOPuserdef,  "This is a comment"
 1,      EVOPtrigger,  "&lt;File2.htm&gt;[targ:Left]"
 2,      EVOPdownload, "File1.htm"
 </code></pre>
<p>
You can use <b>Attr</b> to set or change microevents. For example, the following code changes the file that is downloaded from File1.htm to File3.htm.</p>
<pre><code>e.Attr(2) = "File3.htm"
 </code></pre>
<p>
To change the type of the event, such as from a file download to a trigger, change the corresponding value of <a href="rcen_6ixx.htm"><b>EnhEvent.Opcode</b></a>. For example, the following code changes the preceding microevent, Attr(2), into an announcement.</p>
<pre><code>e.Attr(2) = "MyAnnc.ann"
e.Opcode(2) = EVOPannounce
 </code></pre>
<p>
If you did not set <b>Opcode </b>to EVOPannounce in the preceding example, the microevent would still be an FTS download and would download the file MyAnnc.ann instead of sending it as an announcement.</p>
<p>&nbsp;</p></body>
</HTML>
