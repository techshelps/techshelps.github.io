<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WebTV for Windows Helper Application</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_bpc_webtv_for_windows_helper_application"></a>WebTV for Windows Helper Application</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Tvwakeup.exe is a helper application for WebTV for Windows. It runs in the background, handling keystrokes and remote control input used to launch WebTV for Windows. In addition, it responds to power management events and can be used to launch <a href="sched_2woj.htm">record reminder helper applications</a>. </p>

<h4><a name="_bpc_tvwakeup_launching_webtv_for_windows_from_the_keyboard_or_a_remote_control"></a>TVWakeup Launching WebTV for Windows from the Keyboard or a Remote Control</h4>
<p>
TVWakeup enables users to start WebTV for Windows from the keyboard or by using a remote control. To do this, TVWakeup runs in the background, listening for specific keys. If these are not handled by an application, TVWakeup handles them. The keystrokes that TVWakeup handles are Guide, Mute, TV, VolumeDown, and VolumeUp. </p>
<p>
You can configure the keystrokes that TVWakeup.exe handles by changing the registry values set under the HKLM\Software\Microsoft\TV Services\Explorer\RemoteKeys\WakeupKeys registry key.</p>

<h4><a name="_bpc_tvwakeup_handling_power_management_events"></a>TVWakeup Handling Power Management Events</h4>
<p>
In addition to handling keyboard and remote control input, the copy of TVWakeup that runs in the background also handles power management events to ensure that television audio does not come on while the system is sleeping.</p>
<p>
To prevent sound from coming on when the system is suspended or user is not present, Tvwakeup.exe mutes the master volume when it receives a QuerySuspend event as part of a WM_POWERBROADCAST message. When Tvwakeup.exe receives a OnSuspendFailed, SuspendCritical, or SuspendResume event, it resets the master volume to its original, pre-suspend, value. </p>
<p>
As a side-effect, any program that needs to play sound while the system is in Resume Automatic state or when the user is not present, must explicitly un-mute the master volume. </p>
<p>
To locate more information about WM_POWERBROADCAST messages and Advanced Configuration and Power Interface (ACPI), see  <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>. </p>

<h4><a name="_bpc_tvwakeup_launching_webtv_for_windows_from_a_record_reminder_task"></a>TVWakeup Launching WebTV for Windows from a Record Reminder Task</h4>
<p>
TVWakeup also serves as a helper application to launch WebTV for Windows when a show reminder runs. It is necessary to use TVWakeup to launch WebTV for Windows because the Task Scheduler will not let the system sleep while any process it has started is still running. To enable the system to go back to sleep after a show has finished recording, the Task Scheduler launches a copy of TVWakeup. TVWakeup starts WebTV for Windows, passes it any command-line parameters that TVWakeup received from the Task Scheduler. The copy of TVWakeup then exits, enabling the system to sleep once the recording is finished.</p>
<p>
You can specify a custom helper application to use for record reminders instead of TVwakeup. To do this, set the path and filename of the helper application in the registry value, HKLM\Software\Microsoft\TVServices\Explorer\"HelperApp". </p>
<p>&nbsp;</p></body>
</HTML>
