<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITelevisionServices::LoadEnhancement</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bpc_itelevisionservices_loadenhancement"></a>ITelevisionServices::LoadEnhancement</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>LoadEnhancement</b> method loads a single enhancement into the Guide database.</p>
<pre><code><b>HRESULT LoadEnhancement(
  Workspace *</b><i>piDAOWorkspace</i><b>, </b>
<b>  BSTR </b><i>bstrEnhancementID</i><b>, </b>
<b>  BSTR </b><i>bstrShowReference</i><b>,</b>
<b>  BSTR </b><i>bstrTitle</i><b>,</b>
<b>  BSTR </b><i>bstrPreloadURL</i><b>, </b>
<b>  BSTR </b><i>bstrAddress</i><b>, </b>
<b>  DATE </b><i>dateExpire</i><b>,</b><i> </i>
<i>  </i><b>DWORD </b><i>dwFlags</i>
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>piDAOWorkspace</i></dt>
<dd>
Pointer to a DAO workspace. This workspace can be either preexisting or newly created.</dd>
<dt>
<i>bstrEnhancementID</i></dt>
<dd>
GUID for the enhancement. If your application specifies the <i>bstrEnhancementID</i> parameter as an empty string (""), <b>LoadEnhancement</b> automatically generates a GUID for the enhancement. Your application should only specify an empty string if it has no need to further reference the enhancement being loaded. </dd>
<dt>
<i>bstrShowReference</i></dt>
<dd>
Show reference of the broadcast to which the enhancement applies. Your application can create a show reference by calling either the <a href="tssr_24md.htm"><b>ITelevisionServices::MakeLocalBroadcastSchedule</b></a> or <a href="tssr_3zvp.htm"><b>ITelevisionServices::MakeRemoteBroadcastSchedule</b></a> method. 
<p>
If the <i>bstrShowReference</i> parameter contains an episode title, the enhancement is treated as an episode enhancement and  set for only the episode or episodes specified. 

<p>
If <i>bstrShowReference</i> contains an empty episode title (""), the enhancement is treated as a channel enhancement. In this case, <b>LoadEnhancement</b> searches the tuning space for the union of the station, network, and channel parameters specified in <i>bstrShowReference</i>. The method then sets an enhancement for all matching channel records. 

<p>
The following is an example of a episode show reference: 

<pre><code>"1997/7/29!26673/7175/9690!0:30!0!0!0!0!9690!9690!4096!7040!''!'MSNBC'!3!54!InterNight".
 </code></pre>

<p>
For further description of show reference syntax, see <a href="show_7h6c.htm">Show Reference Format</a>.
</dd>
<dt>
<i>bstrTitle</i></dt>
<dd>
Title of the enhancement. Microsoft® WebTV® for Windows® displays this value when an episode has more than one enhancement available. When a user clicks the enhancement icon in the TV banner at the top of the screen, WebTV for Windows displays a list of the enhancement titles, from which the user can select the enhancement to display. For example: <b>InterNight Interactive</b></dd>
<dt>
<i>bstrPreloadURL</i></dt>
<dd>
URL of the HTML file that contains the starting enhancement page. If your application does not specify a complete path, such as C:\MyEnhance\, the URL is resolved relative to C:\Program Files\TV Viewer\Layouts. 
<p>
For example, if you specify <code>"TVShow\TVShow.htm" </code>for the <i>bstrPreloadURL</i> parameter,<code> </code>the URL resolves to<code> "C:\Program Files\TV Viewer\Layouts\TVShow\TVShow.htm"</code>.
</dd>
<dt>
<i>bstrAddress</i></dt>
<dd>
String that specifies the address for the network interface card, the multicast address, and multicast port information used to connect to the enhancement stream. This string must have the following format: 
<p>
<b>"</b><i>NIC_address</i><b>\t</b><i>multicast_address</i><b>\t</b><i>multicast_port</i><b>"</b> 

<p>
For example: 

<pre><code>"125.125.125.125\t225.225.225.255\t10024"
 </code></pre>
</dd>
<dt>
<i>dateExpire</i></dt>
<dd>
Date and time at which the enhancement expires. All enhancements should have an expiration date and time. This functionality enables <a href="pgsrv_5ew2.htm">Loadstub</a> to delete obsolete enhancement data from the Guide database.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
<b>DWORD</b> that indicates additional behavior for <b>LoadEnhancement</b>. The following table lists and describes the possible flags this <b>DWORD </b>can contain.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Value</th>
<th align=left width=51%>Meaning</th>
</tr>
<tr valign=top>
<td width=49%>LE_DONTOVERWRITE</td>
<td width=51%>If this flag is set, and the enhancement data already exists in the database, <b>LoadEnhancement</b> does not reload the data. The value of <i>bstrEnhancementID</i> is used to determine whether the data is already loaded in the database.</td>
</tr>
<tr valign=top>
<td width=49%>LE_LOUD</td>
<td width=51%>If this flag is set, <b>LoadEnhancement </b>sends an operating-system broadcast message to inform applications that use this data that the data has changed. Otherwise, <b>LoadEnhancement </b>does not send a message.</td>
</tr>
<tr valign=top>
<td width=49%>LE_UPDATEADDRESSFIELD</td>
<td width=51%>If this flag is set, <b>LoadEnhancement</b> updates the address data for this record in the Guide database.</td>
</tr>
<tr valign=top>
<td width=49%>LE_UPDATEDATEFIELD</td>
<td width=51%>If this flag is set, <b>LoadEnhancement</b> updates the time and date data for this record in the Guide database.</td>
</tr>
<tr valign=top>
<td width=49%>LE_UPDATEFIELDS</td>
<td width=51%>If this flag is set, <b>LoadEnhancement</b> updates the data for this record in the Guide database, replacing the values of all non-NULL parameters.</td>
</tr>
<tr valign=top>
<td width=49%>LE_UPDATEPRELOADURLFIELD</td>
<td width=51%>If this flag is set, <b>LoadEnhancement</b> updates the URL of the starting enhancement page for this record in the Guide database.</td>
</tr>
<tr valign=top>
<td width=49%>LE_UPDATESHOWREFFIELD</td>
<td width=51%>If this flag is set, <b>LoadEnhancement</b> updates the show reference data for this record in the Guide database.</td>
</tr>
<tr valign=top>
<td width=49%>LE_UPDATETITLEFIELD</td>
<td width=51%>If this flag is set, <b>LoadEnhancement</b> updates the title data for this record in the Guide database.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
Note that even when the LE_LOUD flag is set in the <i>dwFlags </i>parameter, WebTV for Windows is notified only if the loaded enhancement matches the next episode listed in the Guide database. For example, if an enhancement for a December show is loaded in October, the enhancement is saved in the database, but WebTV for Windows is not notified. This is because the December episode is not yet listed in the Guide database as occurring next.</p>
<h4>Return Values</h4>
<p>
Returns an <b>HRESULT</b> indicating success or failure. If the method succeeds, it returns S_OK. Otherwise, it returns an error code. For specific error codes, see the Winerror.h and Dbdaoerr.h header files. To locate more information about Winerror.h and Dbdaoerr.h, see <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in tssadmin.odl.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in tssadmin.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Yes.</p>
<h4>See Also</h4>
<p>
<a href="tssr_5a5g.htm"><b>ITelevisionServices::DeleteEnhancementFromID</b></a>, <a href="tssr_70j7.htm"><b>ITelevisionServices::DeleteOldEnhancements</b></a>, <a href="tssr_32w5.htm"><b>ITelevisionServices::LoadEnhancementsFromFile</b></a>, <a href="tssr_5ecz.htm"><b>ITelevisionServices::RemapEnhancements</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
