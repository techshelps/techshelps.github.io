<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tuning to Receive VBI Data</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_bpc_tuning_to_receive_vbi_data"></a>Tuning to Receive VBI Data</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Broadcast Architecture supports receiving data transmitted in the <a href="glos_1a49.htm#_bpc_vertical_blanking_interval_gly"><i>vertical blanking interval (VBI)</i></a> that exists between successive scans of analog television images. Examples of types of data transmitted over the VBI are enhancement files and updates to television listings.</p>
<p>
In order to receive VBI data, the television tuner must be tuned to that channel. In the case where the user is watching television on the same channel on which VBI data is being transmitted, the tuner is already set to the necessary channel. However, if the user is not watching television, you must programmatically set the tuner to the appropriate channel in order to receive the VBI data. </p>
<p>
You can do this by using the <b>BPCVBIControl</b> to silently tune the television tuner to the appropriate channel. Using this control does not start Microsoft® WebTV® for Windows®, nor does it display video on the client. For example, you can use <b>BPCVBIControl</b> to tune to a channel during the middle of the night and receive updated television listings. </p>
<p>
However, if an application is already using the tuner, for example if the user is watching television, the <b>BPCVBIControl</b> returns an error when you attempt to tune to a different channel. The user watching video is always higher priority than VBI data acquisition. </p>
<p>
In this manner, the <b>BPCVBIControl</b> is disabled while any application is using video. Any tuners not used by the video application will stay tuned to the last channel a VBI control requested. If an application needs to tune to a VBI transmission while another application is using video, it must create a new instance of the Video control in order to access the tuner.</p>
<p>
In order to tune the tuner to the VBI data channel, you must create an instance of <b>BPCVBIControl</b> and call the <b>VBITune</b> method. When your application no longer needs to receive VBI data on that channel it should release the <b>BPCVBIControl</b> object. This causes the tuner to receive VBI data on the default channel, if any, defined in the registry. This enables applications such as EPG data loaders to run in the background and acquire their data.</p>
<p>
This is demonstrated in the following code:</p>
<pre><code>Dim vbictrl As BPCVBIControl
Set vbictrl = New BPCVBIControl
 
'Set the tuner to receive VBI data on channel 27
vbictrl.VBITune 0, 2, 27, AMTUNER_SUBCHAN_DEFAULT, _
                                AMTUNER_SUBCHAN_DEFAULT 
 
'Code to receive and process the VBI data.
'Your application can use the VBI Client Interface
'to retrieve data from the VBI of a television signal.
'For more information on this client interface, see the
'Broadcast Architecture Device-Driver Kit (DDK).
 
'Release the tuner to receive VBI data using the default channel
'specified in the system registry.
Set vbictrl = Nothing
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
