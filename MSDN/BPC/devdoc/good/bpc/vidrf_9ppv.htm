<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handling Power Management Events</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_bpc_handling_power_management_events"></a>Handling Power Management Events</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Systems that implement advanced power management or the Advanced Configuration and Power Interface (ACPI) cause Windows 98 to request that the video server and controls suspend operation when the system goes to sleep. Your application should handle the Video control's power management events so it does not attempt to access the Video control or devices while they are unavailable.</p>
<p>
When the video server receives a suspend request from the power management system it releases all devices and destroys the filter graph. Each instance of the Video control sends a <a href="vidrf_5bn6.htm"><b>BPCVid.</b>Power</a> event, specifying PBT_APMQUERYSUSPEND. Applications should not call the Video control or devices until they receive one of the following values in a subsequent Power event: PBT_APMQUERYSUSPENDFAILED, PBT_APMRESUMEAUTOMATIC, or PBT_APMRESUMESUSPEND. At this time, your application can resume use of the Video control and server. Because the filter graph was rebuilt, your application must reenumerate devices and refresh any device information it had stored.</p>
<p>
If the value returned in the Power event is PBT_APMQUERYSUSPENDFAILED the system did not suspend, because another application refused the suspend request.</p>
<p>&nbsp;</p></body>
</HTML>
