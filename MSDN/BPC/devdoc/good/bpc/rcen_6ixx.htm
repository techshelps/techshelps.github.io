<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EnhEvent.Opcode</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bpc_enhevent.opcode"></a>EnhEvent.Opcode</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>Opcode </b>property describes the operation type of a microevent. For example, whether it is a file download or trigger.</p>
<h4>Syntax</h4>
<pre><code><i>object</i><b>.Opcode(</b><i>index</i><b>) </b>[<b> = </b><i>iVal</i><b> </b>]<b> </b>
<b> </b></code></pre>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
Object expression that resolves to an <a href="rcen_0g6s.htm"><b>EnhEvent</b></a><b> </b>object.</dd>
<dt>
<i>index</i></dt>
<dd>
<b>Long </b>that indicates the 0-based index of the microevent. This value must always be less than or equal to <a href="rcen_5yb8.htm"><b>EnhEvent.AttrCount</b></a>. If you set <i>index </i>to a value higher than <b>EnhEvent.AttrCount</b>, <b>Opcode </b>returns -1.</dd>
<dt>
<i>iVal</i></dt>
<dd>
<b>Integer</b> that specifies the operation type. This can be one of the following identifiers:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Opcode</th>
<th align=left width=67%>Description</th>
</tr>
<tr valign=top>
<td width=33%>EVOPannouncement</td>
<td width=67%>The microevent sends an enhancement announcement.</td>
</tr>
<tr valign=top>
<td width=33%>EVOPdelannc</td>
<td width=67%>The microevent is a delete announcement which rescinds a previously transmitted announcement.</td>
</tr>
<tr valign=top>
<td width=33%>EVOPdownload</td>
<td width=67%>The microevent downloads a file.</td>
</tr>
<tr valign=top>
<td width=33%>EVOPglobal</td>
<td width=67%>The microevent sets a global variable. <p>
This functionality is not implemented in the current version of Broadcast Architecture.</p>
</td>
</tr>
<tr valign=top>
<td width=33%>EVOPinclude</td>
<td width=67%>The microevent includes a stream into the current stream.</td>
</tr>
<tr valign=top>
<td width=33%>EVOPtrigger</td>
<td width=67%>The microevent sends a trigger.</td>
</tr>
<tr valign=top>
<td width=33%>EVOPuserdef</td>
<td width=67%>The microevent is user-defined.</td>
</tr>
<tr valign=top>
<td width=33%>EVOPgroup</td>
<td width=67%>The microevent is one of a group of dependent files. </td>
</tr>
</table><br>


</dd>
</dl>
<h4>Remarks</h4>
<p>
The text of the microevents described by <b>Opcode</b> can be accessed using <b>EnhEvent.Attr</b>. For example, <code>e.Opcode(0)</code> returns the operation type of the microevent accessed by <code>e.Attr(0)</code>. Because there is a one-to-one relationship between <b>Opcode</b> and <b>EnhEvent.Attr</b>, <b>EnhEvent.AttrCount</b>, which enumerates the number of microevents, also enumerates the number of property types stored in <b>Opcode</b>. </p>
<p>
You can use <b>Opcode</b> to add microevents to an event. Simply set either the text or the operation type for the microevent at the <b>AttrCount</b> index. This is demonstrated in the following example:</p>
<pre><code>index = e.AttrCount
 
'Add a new file download microevent to an event.
'Note that this increments AttrCount.
e.Opcode(index) = EVOPdownload
 
'Identify the text of the microevent
e.Attr(index) = "File1.htm"
 </code></pre>
<p>
You can only add one microevent at a time, attempting to set microevent values at indices higher than <b>AttrCount</b> results in a CTL_E_INVALIDPROPERTYVAL error. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in stream.idl.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in stream.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Yes.</p>
<h4>See Also</h4>
<p>
<a href="rcen_4gvm.htm"><b>EnhEvent.Attr</b></a>, <a href="rcen_5yb8.htm"><b>EnhEvent.AttrCount</b></a> </p>
<h4>Examples</h4>
<p>
You can use <b>Opcode</b> to either determine or set the type of a microevent. The following example counts the number of trigger microevents in an event.</p>
<pre><code>For item = 0 to (e.AttrCount - 1)
  If e.Opcode(item) = EVOPtrigger Then
    numTrigger = numTrigger +1
  End If
Next item
 </code></pre>
<p>
If you want to set or change the type of a microevent, you typically need to set both the microevent text, available from <b>EnhEvent.Attr</b>, and the <b>Opcode</b> value. The following example changes the third microevent of an event to a announcement.</p>
<pre><code>e.Attr(2) = "MyAnnc.ann"
e.Opcode(2) = EVOPannounce
 </code></pre>
<p>
Note that if you do not set the corresponding <b>Attr </b>property in the preceding example, the syntax of the new trigger microevent is incorrect.</p>
<p>&nbsp;</p></body>
</HTML>
