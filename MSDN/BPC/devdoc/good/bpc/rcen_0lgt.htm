<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Parsing an Enhancement Stream</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_bpc_parsing_an_enhancement_stream"></a>Parsing an Enhancement Stream</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Parsing the enhancement stream determines whether a specific event is an announcement, trigger, or file transfer. This step is not required if you use <a href="rcen_0dx0.htm"><b>ipsend.SendEvent</b></a> to transmit the events.</p>
<p>
If, however, you are using the <a href="rcen_8kdu.htm"><b>ipsend.SendTrigger</b></a>, <a href="rcen_6s1g.htm"><b>ipsend.SendAnnouncement</b></a>, and <a href="rcen_0t45.htm"><b>ipsend.SendFTSFile</b></a> methods to transmit the stream, you must determine the type of each event before you transmit it.</p>
<p>
Your application can parse and transmit individual events as demonstrated in the following function. This example assumes that a global instance of <a href="rcen_9pb8.htm"><b>ipsend</b></a>, <code>isend</code>, already exists and is connected to the outgoing IP stream objects. </p>
<pre><code>Function SendThisEvent(e As IEnhEvent) As String
 
    If e.IsTrigger Then
 
        'Transmit the trigger
        '(For triggers, EnhEvent.Name contains the trigger data.)
        isend.SendTrigger e.Trigger + e.Name
 
    Else
 
        If e.IsAnnounce Then
            'Transmit the announcement
            '(For announcements, EnhEvent.Name contains the name and 
            ' path of the announcement file)
            isend.SendAnnouncement e.Name
        Else 
            'Transmit the file, using FTS
            '(For FTS events, EnhEvent.Name contains the 
            'source file name.)
            isend.SendFTSFile e.Name
        End If 
 
    End If
 
End Function
 </code></pre>
<p>
To use a function such as <code>SendThisEvent </code>in an application, you would create a timer routine that compares the starting time of the next event in an enhancement stream with the time elapsed during the current show. When the time for the event arrives, the timer routine calls <code>SendThisEvent </code>to broadcast the event.</p>
<p>&nbsp;</p></body>
</HTML>
