<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting Available Devices</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bpc_getting_available_devices"></a>Getting Available Devices</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Before your application can enable users to run the Microsoft® ActiveX® control for video (the Video control) in all its possible ways, it needs information on which device to use. In many cases, users must select one or more devices to use. For example, your application could provide a user the option to select a video camera, a VCR, or a television tuner as the input device for video. Your application can thus retrieve the list of available devices before it starts presenting video and audio, and potentially it can present a list box of devices to select from. If video and audio are instrinsic to your application's functionality, your application in most cases should retrieve the list of available devices when it starts. </p>
<p>
Additionally, your application might need to retrieve (and potentially present to the user) a list of available devices whenever some new video or audio capability is required or desirable.</p>
<p>
For your application to retrieve this list, it must first declare and allocate storage for variables of <a href="vidrf_0xwz.htm"><b>BPCDevices</b></a> and <a href="vidrf_163p.htm"><b>BPCDeviceBase</b></a> object types. Your application then assigns the collection of all the available input and output devices to the <b>BPCDevices</b> variable with the <a href="vidrf_36zo.htm"><b>BPCVid</b></a> object's <a href="vidrf_3t0z.htm"><b>Devices</b></a> property. Your application next enters a loop to get each <b>BPCDeviceBase</b> object that represents an available device for video. Your application can use the <b>BPCVid</b> object's <a href="vidrf_3xpw.htm"><b>DeviceCount</b></a> property to determine the number of times to loop. Your application then obtains a string representing the name of each available video device with the <a href="vidrf_6j6t.htm"><b>Name</b></a> property of the <b>BPCDeviceBase</b> object and adds those strings to an array of string elements. When user device selection is required, your application also adds those strings to a list box or combo box on the user interface. </p>
<p>
The best way to add initialization functionality to your application depends on how you develop your application. With the Microsoft® Visual Basic® development system, you implement initialization in the <b>Form_Load</b> procedure. With MFC, you implement initialization in the <b>OnInitDialog</b> method of your dialog class. With a Hypertext Markup Language (HTML) document, you implement initialization in the script that runs when a Web browser loads the page.</p>
<p>
In this release of Broadcast Architecture, hardware configurations only support sending analog video to the digital VGA display surface of the control itself. Therefore, the Video control cannot set an output device; it can only set which input device to receive video from. If a user's computer has an analog television tuner card installed and your application provides a list of available devices, the friendly name of the WDM stream class minidriver for the tuner device is listed as an input source. WDM here stands for (Microsoft®) Windows® Driver Model.</p>
<p>
To locate more information on working with display surfaces, see <a href="abou1_7g11.htm">Further Information on Development Tasks in Broadcast Architecture</a>.</p>
<p>&nbsp;</p></body>
</HTML>
