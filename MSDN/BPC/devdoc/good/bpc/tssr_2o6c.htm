<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IScheduledItems::Add</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bpc_ischeduleditems_add"></a>IScheduledItems::Add</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>Add</b> method schedules one or more show reminders. </p>
<pre><code><b>HRESULT Add(
  BSTR </b><i> Workspace</i><b>,      </b>// in
<b>  BSTR </b><i> ShowReference</i><b>,  </b>// in
<b>  BSTR </b><i> Application</i><b>,    </b>// in
<b>  BSTR </b><i> Directory</i><b>,      </b>// in
<b>  long </b><i> AdvanceMinutes</i><b>, </b>// in
<b>  BSTR </b><i> Parameters</i><b>,     </b>// in
<b>  VARIANT *</b><i> pSafeArray  </i>// out
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Workspace</i></dt>
<dd>
Name of a DAO workspace. This workspace can be either preexisting or newly created.</dd>
<dt>
<i>ShowReference</i></dt>
<dd>
<a href="show_02lv.htm">Show reference</a>. Your application can create a show reference by calling either the <a href="tssr_24md.htm"><b>ITelevisionServices::MakeLocalBroadcastSchedule</b></a><b> </b>or <a href="tssr_3zvp.htm"><b>ITelevisionServices::MakeRemoteBroadcastSchedule</b></a> method. </dd>
<dt>
<i>Application</i></dt>
<dd>
Name and path of the application that displays the reminder to the user when the scheduled show is on. Typically, WebTV for Windows is used to display reminders, and this value is set to C:\Program Files\TV Viewer\Tvx.exe. 
<p>
Your application can get the path to the broadcast client's installation of WebTV for Windows by calling <a href="tssr_1izp.htm"><b>ITelevisionServices::get_DatabaseFile</b></a> and stripping Tss.mdb off the end of the returned string. This path is also stored in this registry entry:

<p>
<b>HKLM\Software\Microsoft\TV Services\ProductDir </b>
</dd>
<dt>
<i>Directory</i></dt>
<dd>
Name of the working directory that contains the reminder application. </dd>
<dt>
<i>AdvanceMinutes</i></dt>
<dd>
Interval, in minutes, before the show's start that the reminder should occur.</dd>
<dt>
<i>Parameters</i></dt>
<dd>
Additional command-line arguments for the application specified by the <i>Application </i>parameter. The format and number of these arguments depend on the application referred to by <i>Application</i>. <i>Parameters </i>is passed to <i>Application </i>as command-line arguments.
<p>
For example, if you are using a custom application to display the reminder to the user, and this application has three styles of reminder dialog boxes, <i>Parameters</i> could be used to specify the reminder style. 

<p>
For a list of the parameters used with the WebTV for Windows reminder application, Tvx.exe, see the description of <i>WebTVforWindowsParameters </i>in <a href="show_7e44.htm">Show Reminder Format</a>.
</dd>
<dt>
<i>pSafeArray</i></dt>
<dd>
Pointer to a <b>VARIANT</b> that receives an <b>IEnumVARIANT</b> interface that enumerates the string indices of the scheduled show reminders. To locate more information on working with <b>IEnumVARIANT</b>, see <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns an <b>HRESULT</b> indicating success or failure. If the method succeeds, it returns S_OK. Otherwise, it returns an error code. For specific error codes, see the Winerror.h and Dbdaoerr.h header files. To locate more information about Winerror.h and Dbdaoerr.h, see <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>.</p>
<h4>Remarks</h4>
<p>
If the time and date specified in the <i>ShowReference</i> parameter are unambiguous, the <b>IScheduledItems::Add</b> method schedules a single show reminder. </p>
<p>
Ambiguous show references can represent multiple or repeating broadcasts. For example, if you want to schedule a reminder for each weekly episode of a show, you can specify the time and channel of that show, leaving the date ambiguous. The show reference then applies to all weekly episodes. In contrast, an unambiguous show reminder specifies the date and thus applies to only a single episode.</p>
<p>
If the specified show reference is ambiguous, <b>Add</b> uses the <a href="tssr_8rlg.htm"><b>ITelevisionServices::ResolveBroadcast</b></a> method to produce a query that matches <i>ShowReference</i>, in other words a query for all episodes that fit the ambiguous date or channel value. For example, if the show reference specified channel 27 at 5 P.M. on Fridays, leaving the date ambiguous, the generated query returns a listing of each episode in the Guide database whose channel and time parameters match those specified. Once the query is run, <b>Add</b> calls the <a href="tssr_4iux.htm"><b>IScheduledItems::AddFromQuery</b></a> method to schedule all of the rows returned by the query.</p>
<p>
Reminders set using <b>Add</b> are not automatically visible in the WebTV for Windows user interface. In order for a TSS-set reminder to be visible in WebTV for Windows, it must meet certain standards. <a href="sched_1kmr.htm">Setting a Reminder That Appears in WebTV for Windows</a> specifies these standards.</p>
<p>
If the reminder to add is a record reminder, your application should use the Task Scheduler component of Window 98 to set the TASK_FLAG_SYSTEM_REQUIRED flag for the reminder. Doing so causes WebTV for Windows to tune to the specified channel even if the system is suspended. Otherwise, if the system is suspended WebTV for Windows does not run the record reminder. </p>
<p>
In addition, if the record reminder has an application associated with it that automates tuning a VCR to a specified channel, this application should be specified in the registry value <b>StartRecordingApp</b>, <b>EndRecordingApp</b>, or both. You specify these values under the following registry key:</p>
<p>
<b>HKLM\Software\Microsoft\TV Services\Explorer\</b></p>
<p>
TASK_FLAG_SYSTEM_REQUIRED should not be set for standard show reminders. Version 1.0 of Broadcast Architecture does not handle show reminders that occur while the operating system is suspended.</p>
<p>
For more information, see <a href="sched_0mcy.htm">Setting a Show Reminder</a> and <a href="sched_0jaq.htm">Setting a Record Reminder</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in tssadmin.odl.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in tssadmin.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Yes.</p>
<h4>See Also</h4>
<p>
<a href="tssr_4iux.htm"><b>IScheduledItems::AddFromQuery</b></a>, <a href="tssr_00v9.htm"><b>IScheduledItems::Remove</b></a>, <a href="tssr_8rlg.htm"><b>ITelevisionServices::ResolveBroadcast</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
