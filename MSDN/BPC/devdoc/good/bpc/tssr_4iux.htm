<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IScheduledItems::AddFromQuery</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bpc_ischeduleditems_addfromquery"></a>IScheduledItems::AddFromQuery</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>AddFromQuery</b> method schedules reminders for all the television shows in the result set of a DAO <b>QueryDef</b> query. </p>
<pre><code><b>HRESULT AddFromQuery(
  BSTR </b><i> Workspace</i><b>,      </b>// in
<b>  BSTR </b><i> QueryName</i><b>,      </b>// in
<b>  BSTR </b><i> Application</i><b>,    </b>// in
<b>  BSTR </b><i> Directory</i><b>,      </b>// in
<b>  long </b><i> AdvanceMinutes</i><b>, </b>// in
<b>  BSTR </b><i> Parameters</i><b>,     </b>// in
<b>  VARIANT *</b><i> pSafeArray  </i>// out
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Workspace</i></dt>
<dd>
Name of the DAO workspace. This workspace can be either preexisting or newly created.</dd>
<dt>
<i>QueryName</i></dt>
<dd>
Name of the <b>QueryDef</b> definition. To create a <b>QueryDef</b> from a show reference, your application uses the <a href="tssr_8rlg.htm"><b>ITelevisionServices::ResolveBroadcast</b></a> method. </dd>
<dt>
<i>Application</i></dt>
<dd>
Name and path of the application that displays the reminder to the user when the scheduled show is on. Typically, WebTV for Windows is used to display reminders, and this value is set to C:\Program Files\TV Viewer\Tvx.exe. 
<p>
Your application can get the path to the broadcast client's installation of WebTV for Windows by calling <a href="tssr_1izp.htm"><b>ITelevisionServices::get_DatabaseFile</b></a> and stripping Tss.mdb off the end of the returned string. This path is also stored in this registry entry:

<p>
<b>HKLM\Software\Microsoft\TV Services\ProductDir</b>
</dd>
<dt>
<i>Directory</i></dt>
<dd>
Name of the working directory that contains the reminder application. </dd>
<dt>
<i>AdvanceMinutes</i></dt>
<dd>
Interval, in minutes, before the show's start that the reminder should occur.</dd>
<dt>
<i>Parameters</i></dt>
<dd>
Additional command-line arguments for the application specified by the <i>Application </i>parameter. The format and number of these arguments depend on the application referred to by <i>Application</i>. <i>Parameters </i>is passed to <i>Application </i>as command-line arguments.
<p>
For example, if you are using a custom application to display the reminder to the user, and this application has three styles of reminder dialog boxes, <i>Parameters</i> could be used to specify the reminder style. 

<p>
For a list of the parameters used with the WebTV for Windows reminder application, Tvx.exe, see the description of <i>WebTVforWindowsParameters </i>in Show Reminder Format.
</dd>
<dt>
<i>pSafeArray</i></dt>
<dd>
Pointer to a <b>VARIANT</b> that receives an <b>IEnumVARIANT</b> interface that enumerates the string indices of the scheduled show reminders. To locate more information on working with <b>IEnumVARIANT</b>, see <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns an <b>HRESULT</b> indicating success or failure. If the method succeeds, it returns S_OK. Otherwise, it returns an error code. For specific error codes, see the Winerror.h and Dbdaoerr.h header files. To locate more information about Winerror.h and Dbdaoerr.h, see <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>.</p>
<h4>Remarks</h4>
<p>
The <b>AddFromQuery</b> method iterates through the result set of the defined query, composing a show reference for each row and scheduling a reminder for that show reference. Typically, you use the queries created by <a href="tssr_8rlg.htm"><b>ITelevisionServices::ResolveBroadcast</b></a><b> </b>as the <i>QueryName</i> parameter for <b>AddFromQuery</b>.</p>
<p>
Reminders set using <b>AddFromQuery</b> are not automatically visible in the WebTV for Windows user interface. In order for a TSS-set reminder to be visible in WebTV for Windows, it must meet certain standards. <a href="sched_1kmr.htm">Setting a Reminder That Appears in WebTV for Windows</a> specifies these standards.</p>
<p>
To locate more information on the <b>SAFEARRAY </b>data type, see <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in tssadmin.odl.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in tssadmin.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Yes.</p>
<h4>See Also</h4>
<p>
<a href="tssr_2o6c.htm"><b>IScheduledItems::Add</b></a>, <a href="tssr_00v9.htm"><b>IScheduledItems::Remove</b></a>, <a href="tssr_8rlg.htm"><b>ITelevisionServices::ResolveBroadcast</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
