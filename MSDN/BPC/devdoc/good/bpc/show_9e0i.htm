<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating an Ambiguous Trigger</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_bpc_creating_an_ambiguous_trigger"></a>Creating an Ambiguous Trigger</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To create an ambiguous trigger, first create a <b>TASK_TRIGGER</b> structure and set the ambiguous time or date members to –1. Then set this structure to a trigger object by calling the <b>ITaskTrigger::SetTrigger</b> method.  </p>
<p>
The following example creates an ambiguous trigger where the starting time, 7 p.m<small>.</small>, is known but the day, month, and year are not. This trigger can be used, for example, to represent multiple episodes of a show that is broadcast every weeknight at 7 p.m<small>.</small>:</p>
<pre><code>ITaskTrigger *pTaskTrig;
TASK_TRIGGER tt;
HRESULT hr;
 
memset(&amp;tt, 0, sizeof(tt));
tt.cbTriggerSize = sizeof(TASK_TRIGGER);
tt.TriggerType = TASK_TIME_TRIGGER_ONCE;
tt.rgFlags = 0;
tt.wStartMinute = 0;
//Set the ambiguous time members
tt.wBeginYear = -1;
tt.wBeginMonth = -1;
tt.wBeginDay = -1;
//set the starting time to 7pm
tt.wStartHour = 19;
 
//Create an instance of a task trigger
if (FAILED(hr = CoCreateInstance(CLSID_TaskTrigger, NULL, CLSCTX_INPROC_SERVER, IID_ITaskTrigger, (LPVOID *) &amp;pTaskTrig)))
  return hr;
 
//Set the ambiguous trigger in the task
if (FAILED(hr = pTaskTrigger-&gt;SetTrigger(&amp;tt)))
{
  pTaskTrigger-&gt;Release();
  return hr;
}
else
{
  //... Additional code that uses the trigger
 
  pTaskTrigger-&gt;Release();
  return NOERROR;
}
 </code></pre>
<p>
You can set any number of the <b>TASK_SCHEDULER </b>structure members to –1. For example, you can make a trigger that is ambiguous only in the day, or the month, or the year. So, if you know that a show was on during January 1998 but don't know what day, you can set the month to 1, the year to 1998, and the day to –1.</p>
<p>
To determine whether a trigger is ambiguous, you can call the <b>ITaskTrigger::GetTrigger</b> method and check whether any of the date or time members in the <b>TASK_TRIGGER</b> structure are set to –1. </p>
<p>
To locate more information about <b>TASK_TRIGGER </b>and the <b>ITaskTrigger</b> interface, see <a href="abou1_66t0.htm">Further Information on Television Services for the Client</a>.</p>
<p>&nbsp;</p></body>
</HTML>
