<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiCollectUserInfo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msicollectuserinfo"></a>MsiCollectUserInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiCollectUserInfo</b> function obtains and stores the user information and product ID from an installation wizard.</p>
<pre><code><b>UINT MsiCollectUserInfo(
</b>  <b>LPCTSTR</b> <i>szProduct</i>    // product code
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code of the product for which the user information is collected.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
Any <a href="msi_4rxv.htm">Action Error</a></dt>
<dd>
An error relating to an action occurred.</dd>
<dt>
Any <a href="msi_5svn.htm">Initialization Error</a></dt>
<dd>
An error relating to initialization occurred.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiCollectUserInfo</b> function is typically called by an application during the first run of the application. The application first calls <a href="msi_6str.htm">MsiGetUserInfo</a>. If that call fails, the application calls <b>MsiCollectUserInfo</b>. <b>MsiCollectUserInfo</b> opens the product's installation package and invokes a wizard sequence that collects user information. Upon completion of the sequence, user information is registered. Since this API requires an authored user interface, the user interface level should be set to full by calling <a href="msi_2j3d.htm">MsiSetInternalUI</a> as INSTALLUILEVEL_FULL..</p>
<p>
The <b>MsiCollectUserInfo</b> invokes a FirstRun action. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_application_only_functions">Application-Only Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
