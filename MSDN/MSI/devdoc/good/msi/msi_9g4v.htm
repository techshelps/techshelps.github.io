<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiGetFeatureInfo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msigetfeatureinfo"></a>MsiGetFeatureInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureInfo</b> function returns descriptive information for a feature.</p>
<pre><code><b>UINT MsiGetFeatureInfo(
  MSIHANDLE</b> <i>hProduct</i><b>,</b>  // product handle obtained from <b>MsiOpenProduct</b>
<b>  LPCTSTR</b> <i>szFeature</i><b>,</b>   // feature name
<b>  DWORD</b> <i>*lpAttributes</i><b>,</b> // attribute flags
<b>  LPTSTR</b> <i>lpTitleBuf</i><b>,</b>   // localized name
<b>  DWORD</b> <i>*pcchTitleBuf</i><b>,</b> // in/out buffer character count
<b>  LPTSTR</b> <i>lpHelpBuf</i><b>,</b>    // description
<b>  DWORD</b> <i>*pcchHelpBuf   </i>// in/out buffer character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hProduct</i></dt>
<dd>
Handle to the product that owns the feature. This handle is obtained from <a href="msi_5f78.htm"><b>MsiOpenProduct</b></a>.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature code for the feature about which information should be returned.</dd>
<dt>
<i>lpAttributes</i></dt>
<dd>
Specifies the attribute flags. Must be one or more of the following.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=81%>Flag</th>
<th align=left width=19%>Value</th>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FAVORLOCAL</td>
<td width=19%>1 &lt;&lt; 0</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FAVORSOURCE</td>
<td width=19%>1 &lt;&lt; 1</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FOLLOWPARENT</td>
<td width=19%>1 &lt;&lt; 2</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FAVORADVERTISE</td>
<td width=19%>1 &lt;&lt; 3</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_DISALLOWADVERTISE</td>
<td width=19%>1 &lt;&lt; 4</td>
</tr>
</table><br>

</dd>
</dl>
<p>
For information on how these flags work together, see the <a href="tref_0a91.htm">Feature table</a>.
<dl>
<dt>
<i>lpTitleBuf</i></dt>
<dd>
Pointer to a buffer to receive the localized descriptive name of the feature.</dd>
<dt>
<i>pcchTitleBuf</i></dt>
<dd>
As input, the size of <i>lpTitleBuf</i>. As output, the number of characters returned in <i>lpTitleBuf.</i></dd>
<dt>
<i>lpHelpBuf</i></dt>
<dd>
Pointer to a buffer to receive the localized descriptive name of the feature.</dd>
<dt>
<i>pcchHelpBuf</i></dt>
<dd>
As input, the size of <i>lpHelpBuf</i>. As output, the number of characters returned in <i>lpHelpBuf.</i>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
The product handle is invalid.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
One of the parameters is invalid.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer is too small to hold the requested data.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function returned successfully.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
The feature is not known.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The buffer sizes for the <b>MsiGetFeatureInfo </b>function should include an extra character for the terminating NULL character upon input. If a buffer is too small, the returned string will be truncated with NULL, and the buffer size will contain the number of characters in the whole string, not including the terminating NULL.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_product_query_functions">Product Query Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
