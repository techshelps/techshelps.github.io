<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiDatabaseGetPrimaryKeys</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msidatabasegetprimarykeys"></a>MsiDatabaseGetPrimaryKeys</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseGetPrimaryKeys</b> function returns a record containing the names of all the primary key columns.</p>
<pre><code><b>UINT MsiDatabaseGetPrimaryKeys(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>   // database handle
  <b>LPCTSTR</b> <i>szTableName</i><b>,</b>   // name of table
  <b>MSIHANDLE</b> <i>*phRecord</i>    // handle for record
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.</dd>
<dt>
<i>szTableName</i></dt>
<dd>
Specifies the name of the table from which to obtain primary key names.</dd>
<dt>
<i>phRecord</i></dt>
<dd>
Pointer to the handle of the record that holds the primary key names.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INVALID_TABLE</dt>
<dd>
An invalid table was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The field count of the returned record is the count of primary key columns returned by the <b>MsiDatabaseGetPrimaryKeys</b> function. The returned record contains the table name in Field (0) and the column names that make up the primary key names in succeeding fields. These primary key names correspond to the column numbers for the fields.</p>
<p>
This function cannot be used with the <a href="tref_2fl1.htm">_Tables table</a> or the <a href="tref_4rj9.htm">_Columns table</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
