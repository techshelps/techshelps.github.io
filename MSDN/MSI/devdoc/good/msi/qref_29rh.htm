<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiDatabaseGenerateTransform</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msidatabasegeneratetransform"></a>MsiDatabaseGenerateTransform</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseGenerateTransform</b> function generates a transform file of differences between two databases. A transform is a way of recording changes to a database without altering the original database.</p>
<pre><code><b>UINT MsiDatabaseGenerateTransform(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>          // database handle
  <b>MSIHANDLE</b> <i>hDatabaseReference</i><b>,</b> // base database to reference changes
  <b>LPCTSTR</b> <i>szTransformFile</i><b>,</b>      // name of generated transform file
  <b>int</b> <i>iReserved1</i><b>,</b><i>      </i>         // reserved argument, not used
  <b>int</b> <i>iReserved2 </i>               // reserved argument, not used
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database that includes the changes.</dd>
<dt>
<i>hDatabaseReference</i></dt>
<dd>
Handle to the database that does not include the changes.</dd>
<dt>
<i>szTransformFile</i></dt>
<dd>
The name of the generated transform file. This is optional.</dd>
<dt>
<i>iReserved1</i></dt>
<dd>
This is a reserved argument and is not used.</dd>
<dt>
<i>iReserved2</i></dt>
<dd>
This is a reserved argument and is not used.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_NO_DATA</dt>
<dd>
The two databases are identical.</dd>
<dt>
ERROR_CREATE_FAILED</dt>
<dd>
The storage for the transform file could not be created.</dd>
<dt>
ERROR_INSTALL_TRANSFORM_FAILURE</dt>
<dd>
The transform could not be generated.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
NOERROR</dt>
<dd>
If szTransformFile is NULL, then this is returned if differences are found.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To generate a difference file between two databases, use the <b>MsiDatabaseGenerateTransform</b> function. A transform contains information regarding insertion and deletion of columns and rows. The validation flags are stored in the summary information stream of the transform file.</p>
<p>
For tables that exist in both databases, the only difference between the two schemas that is allowed is the addition of columns to the end of the reference table. You cannot add primary key columns to a table or change the order or names or column definitions of the existing columns as defined in the base table. In other words, if neither table contains data and columns are removed from the reference table, the resulting table is identical to the base table.</p>
<p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used for these filenames or paths.</p>
<p>
This function does not generate a Summary Information stream. Use MsiCreateTransformSummaryInfo to create the stream for an existing transform.</p>
<p>
If <i>szTransformFile </i>is NULL, you can test whether two databases are identical without creating a transform. If the databases are identical, ERROR_NO_DATA is returned, NOERROR is returned if differences are found.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
