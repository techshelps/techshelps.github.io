<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiDatabaseCommit</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msidatabasecommit"></a>MsiDatabaseCommit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseCommit</b> function commits changes to a database.</p>
<pre><code><b>UINT MsiDatabaseCommit(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i>    // database handle
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The handle is in an invalid state.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDatabaseCommit</b> function finalizes the persistent form of the database. All persistent data is then written to the writable database. No temporary columns or rows are written. The <b>MsiDatabaseCommit</b> function has no effect on a database that is opened as read-only. You can call this function multiple times to save the current state of tables loaded into memory. When the database is finally closed, any changes made after the database is committed are rolled back. This function is normally called prior to shutdown when all database changes have been finalized.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
