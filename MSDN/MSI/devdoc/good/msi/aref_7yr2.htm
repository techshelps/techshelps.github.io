<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DuplicateFiles Action</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_duplicatefiles_action"></a>DuplicateFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DuplicateFiles action allows the author to make one or more duplicate copies of files installed by the <a href="aref_3hym.htm">InstallFiles</a> action. The duplicate files can be copied to the same directory with a different name, or to a different directory with the original name.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_310l.htm">DuplicateFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=38%>DuplicateFile.FileKey</td>
<td width=62%>Primary key, uniquely identifying an entry in the <a href="tref_5un9.htm">MoveFile table</a>.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.Component_</td>
<td width=62%>Foreign key into the Component table.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.File_</td>
<td width=62%>Foreign key into the <a href="tref_4n6t.htm">File table</a>, representing the original file to be duplicated.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.DestName</td>
<td width=62%>Name to be given to the destination file.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.DestFolder</td>
<td width=62%>Property name whose value identifies the destination folder.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The DuplicateFiles action must occur after the <a href="aref_3hym.htm">InstallFiles action</a>.</p>
<h4>Remarks</h4>
<p>
The DuplicateFiles action processes a <a href="tref_310l.htm">DuplicateFile table</a> entry only if the component linked to that entry is being installed locally.</p>
<p>
The string in the DestFolder field is a property name whose value is expected to resolve to a fully qualified path. This property could be any of the directory entries in the <a href="tref_6an9.htm">Directory</a> table, any pre-defined folder property (<a href="pref_4ge1.htm">CommonFilesFolder</a>, for example), or a property set by any entry in the <a href="tref_0w9x.htm">AppSearch</a> table.</p>
<p>
For a particular entry in the <a href="tref_310l.htm">DuplicateFile table</a>, if the DestFolder property does not evaluate to a valid path, DuplicateFiles does nothing for that entry.</p>
<p>
The name to be given to the destination file can be specified in the DestName field. If this field is left blank, the destination file name is the same as the original file name.</p>
<p>
Files installed by the DuplicateFiles action are uninstalled when appropriate by the <a href="aref_3tpq.htm">RemoveDuplicateFiles</a> action.</p>
<p>&nbsp;</p></body>
</HTML>
