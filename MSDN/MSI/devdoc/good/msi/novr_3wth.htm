<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using The Directory Table</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_msi_using_the_directory_table"></a>Using the Directory Table</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <a href="tref_6an9.htm">Directory table</a> indicates the layout of your application. The following is an example of a Directory table.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Directory</th>
<th align=left width=33%>Directory_Parent</th>
<th align=left width=34%>DefaultDir</th>
</tr>
<tr valign=top>
<td width=33%>TARGETDIR</td>
<td width=33%></td>
<td width=34%>SOURCEDIR</td>
</tr>
<tr valign=top>
<td width=33%>EXEDIR</td>
<td width=33%>TARGETDIR</td>
<td width=34%>App</td>
</tr>
<tr valign=top>
<td width=33%>DLLDIR</td>
<td width=33%>EXEDIR</td>
<td width=34%>Bin</td>
</tr>
<tr valign=top>
<td width=33%>DesktopFolder</td>
<td width=33%>TARGETDIR</td>
<td width=34%>Desktop</td>
</tr>
</table><br>
<p>
Each row of the Directory table indicates a directory both at the source and the target. For example, assume the installation package resides at \\applications\source\. Because the Directory_Parent field of the first row is Null, this record indicates the root directories for both the source and the target. For the source, the value of this directory is given by the DefaultDir field. The <a href="pref_6uwp.htm">SOURCEDIR property</a> defaults to the location of the installation package. Thus, unless the SOURCEDIR property is overridden, the root source directory is \\applications\source\.</p>
<p>
The Directory field of the first record indicates the location of the root target directory. In this case, the value of the <a href="pref_73ax.htm">TARGETDIR property</a> indicates this directory. Typically, the value of the TARGETDIR property is set at the command line or through a user interface. In this case, assume the TARGETDIR property is set to C:\Program Files\Target\.</p>
<p>
For the second record, the Directory_Parent field is not Null. Therefore, this record indicates a non-root directory for both the source and the target. For a non-root source directory, the source directory indicated by the record described in the Directory_Parent field is the parent directory. For the second record, the Directory_Parent field is TARGETDIR. As shown earlier, the source directory indicated by the TARGETDIR record resolved to \\applications\source\. Thus, the source directory indicated by the second record is \\applications\source\App\.</p>
<p>
A similar process works for the target directory. The value of the parent directory for the target directory described in the second record is the target directory resolved by the Directory_Parent field. Again, the Directory_Parent field contains the value TARGETDIR. This indicates the first record that resolves to a target directory of C:\Program Files\Target\. The Directory field contains an author-defined property called EXEDIR. If this property is set, then its value gives the full path of the directory. Thus, if this property is set to C:\Data\Common\, the value of the target directory indicated by the second record is C:\Data\Common\. If it is not set, the target directory takes the name given by the DefaultDir field. In this case, the target directory is C:\Program Files\Target\App\.</p>
<p>
The same process works for the third record. If EXEDIR and DLLDIR are not set, the target directory is C:\Program Files\Target\App\Bin, and the source directory is \\applications\source\App\Bin\.</p>
<p>
The fourth record uses the <a href="pref_4g6x.htm">DesktopFolder property</a>. If the location of the user's desktop is C:\Winnt\Profiles\User\Desktop\, the target directory resolves to C:\Winnt\Profiles\User\Desktop\. The source directory resolves to \\applications\source\Desktop\.</p>
<p>
There are two additional syntax features that can be used in the DefaultDir column of the Directory table. For a non-root source directory, a period (.) entered in the DefaultDir column indicates that the directory should be located in its parent directory without a subdirectory. To specify different source and target directory paths, separate the target and source paths in the DefaultDir column with a colon as follows: [targetpath]:[sourcepath]. These features can be used together to add levels to either the source or target paths for a single directory. For example, consider this example of a Directory table.:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Directory</th>
<th align=left width=33%>Directory_Parent</th>
<th align=left width=34%>DefaultDir</th>
</tr>
<tr valign=top>
<td width=33%>TARGETDIR</td>
<td width=33%></td>
<td width=34%>SOURCEDIR</td>
</tr>
<tr valign=top>
<td width=33%>MyAppDir</td>
<td width=33%>TARGETDIR</td>
<td width=34%>MyApp</td>
</tr>
<tr valign=top>
<td width=33%>BinDir</td>
<td width=33%>MyAppDir</td>
<td width=34%>Bin</td>
</tr>
<tr valign=top>
<td width=33%>Binx86Dir</td>
<td width=33%>BinDir</td>
<td width=34%>.:x86</td>
</tr>
<tr valign=top>
<td width=33%>BinAlphaDir</td>
<td width=33%>BinDir</td>
<td width=34%>.:Alpha</td>
</tr>
</table><br>
<p>
The source and target paths resolve for the MyAppDir, BinDir, Binx86Dir, and BinAlphaDir rows as follows. </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=21%>Record</th>
<th align=left width=35%>Target Paths</th>
<th align=left width=44%>Source Paths</th>
</tr>
<tr valign=top>
<td width=21%>MyAppDir:</td>
<td width=35%>[TARGETDIR]MyApp</td>
<td width=44%>[SOURCEDIR]MyApp</td>
</tr>
<tr valign=top>
<td width=21%>BinDir:</td>
<td width=35%>[TARGETDIR]MyApp\Bin</td>
<td width=44%>[SOURCEDIR]MyApp\Bin</td>
</tr>
<tr valign=top>
<td width=21%>Binx86Dir:</td>
<td width=35%>[TARGETDIR]MyApp\Bin</td>
<td width=44%>[SOURCEDIR]MyApp\Bin\x86</td>
</tr>
<tr valign=top>
<td width=21%>BinAlphaDir:</td>
<td width=35%>[TARGETDIR]MyApp\Bin</td>
<td width=44%>[SOURCEDIR]MyApp\Bin\Alpha</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
