<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiDatabaseMerge</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msidatabasemerge"></a>MsiDatabaseMerge</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseMerge</b> function merges two databases together, allowing duplicate rows.</p>
<pre><code><b>UINT MsiDatabaseMerge(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>      // database handle
  <b>MSIHANDLE</b> <i>hDatabaseMerge</i><b>,</b> // database to be merged into <i>hDatabase</i>
  <b>LPCTSTR</b> <i>szTableName</i>       // name of persistent table to receive rows
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the base database.</dd>
<dt>
<i>hDatabaseMerge</i></dt>
<dd>
Handle to the database to merge into the base database.</dd>
<dt>
<i>szTableName</i></dt>
<dd>
Specifies the name of the table to receive merge conflict information.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
Merge conflicts were reported.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_TABLE</dt>
<dd>
An invalid table was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDatabaseMerge</b> function merges two databases. The data in the base database dominates in any merge conflicts. If tables of the same name in both databases do not match in the number of primary keys, column types, number of columns, or column names, or if the tables share the same primary key names but the data in the other columns differs, the <b>MsiDatabaseMerge</b> function fails. If merge conflicts are reported, the <a href="tref_5dk5.htm">Error table</a> that is created contains two columns. The first column specifies the name of the table that has merge conflicts. The second column contains the number of rows in the table that has merge conflicts.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
