<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reinstalling a Feature or Application</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_reinstalling_a_feature_or_application"></a>Reinstalling a Feature or Application</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Microsoft® Windows® installer can repair, replace, and verify files contained in an application.  A partial or complete application reinstallation might be required if any files or registry entries associated with any feature have become corrupted or are missing.  </p>
<p>
The following list contains several means of reinstalling a feature or product.  The first two methods have been automated by the installer.
<ul>
<li>
Repair, replace, or verify files by calling the <a href="msi_4ag5.htm"><b>MsiReinstallFeature</b></a> function. </li>
<li>
Reinstall the entire product by calling the <a href="msi_9n78.htm"><b>MsiReinstallProduct</b></a> function.</li>
<li>
Reinstall, replace, or verify files with an Installer UI control button via the <a href="href_8gdw.htm"><b>Reinstall ControlEvent</b></a>.</li>
<li>
Reinstall, replace, or verify files from a command line by setting the <a href="pref_19x5.htm"><b>REINSTALL</b> property</a> and the <a href="pref_7bll.htm"><b>REINSTALLMODE</b> property</a>.</li>
</ul>
<p>
For more information on reinstalling a feature or application, see <a href="over_5id5.htm">Resiliency</a>. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a product using the installer</h5>
<ol>
<li>
Call <a href="msi_9n78.htm">MsiReinstallProduct</a>.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a feature using the installer</h5>
<ol>
<li>
Call <a href="msi_4ag5.htm">MsiReinstallFeature</a>.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a product or feature with an installer user interface</h5>
<ol>
<li>
Add a button to the specified dialog box by adding an entry to the <a href="tref_6nad.htm">Control table</a>.</li>
<li>
Add a <a href="href_0x6c.htm">ReinstallMode ControlEvent</a> to the ControlEvent table, with the Dialog_ and Control_ fields referencing the button control you created in step 1. In the Argument field, enter a string containing the letters corresponding to the reinstall modes you want (the acceptable values for this field are identical to those accepted for the ReinstallMode property). The value in the Ordering column for this event should be 1.</li>
<li>
Add a <a href="href_8gdw.htm">Reinstall ControlEvent</a> event to the <a href="tref_6k11.htm">ControlEvent table</a>, again referencing the same button control. The Argument field for this event will normally be "ALL", to force reinstallation of all features, but you can place the name of a specific feature here. The value in the Ordering column for this event should be 2.</li>
<li>
Add one more event tied to the same button control, to actually initiate the reinstallation. This can be an EndDialog event (with an argument of Return). More typically, however, a NewDialog event would be used here to jump to an Are you sure you want to reinstall? confirmation dialog box. The value in the Ordering column for this event should be 3.<p>
If desired, several Reinstall buttons can be created for a single dialog box, allowing the user to select the type of reinstallation performed. In this case, each button is authored as outlined in the preceding procedure, with a different <a href="href_0x6c.htm">ReinstallMode ControlEvent</a> parameter for each button.
</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a product or feature from a command line</h5>
<p>
Once a particular product has been installed (with some or all of the product's features), a reinstallation can be performed on the command line.  
<ol>
<li>
From the command prompt, specify the <a href="pref_19x5.htm"><b>REINSTALL</b> property</a>.</li>
<li>
From the command prompt, specify the <a href="pref_7bll.htm"><b>REINSTALLMODE </b>property</a>. <p>
Specifying these properties allows the user to reinstall any or all of the product's features. The type of reinstallation can also be specified. For example, you can specify that only those files that are totally missing should be reinstalled, or that only corrupted files (for example, any executable file whose checksum doesn't match the actual file contents) be replaced. Alternatively, you can specify that the fitness of the current installation be verified, without actually repairing any broken or missing files/registry entries. In this case, for all installed features, the installer reports (typically in a log file) the results of any verification that you specify, such as whether there are any missing or corrupt files, any files of the wrong version, or any missing or incorrect registry entries. At any later time, you can then run the installation again to repair any or all of the detected problems. 
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
