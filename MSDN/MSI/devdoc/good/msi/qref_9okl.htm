<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Database Access Reference</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_database_access_reference"></a>Database Access Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The material in this section is intended for developers who are writing their own setup programs and developers who want to learn more about the Microsoft® Windows® installer database tables. For general information on the installer, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>
You can use the installer access functions to access the database and the installation process. These functions should only be used by custom installation actions and authoring tools. Some of the installer access functions require SQL query strings for querying the database. Queries must adhere to the installer <a href="qref_5j20.htm">SQL syntax</a>.</p>
<p>
This topic lists the installer database access functions by category.</p>

<h4><a name="_msi_general_database_access_functions"></a>General Database Access Functions</h4>
<p>
You can use the following general access functions in your application:</p>
<p>
<a href="qref_3bxw.htm"><b>MsiDatabaseCommit</b></a></p>
<p>
<a href="qref_0w8j.htm"><b>MsiDatabaseGetPrimaryKeys</b></a></p>
<p>
<a href="qref_5244.htm"><b>MsiDatabaseIsTablePersistent</b></a></p>
<p>
<a href="qref_5h9z.htm"><b>MsiDatabaseOpenView</b></a></p>
<p>
<a href="qref_4e1x.htm"><b>MsiGetActiveDatabase</b></a></p>
<p>
<a href="qref_27tx.htm"><b>MsiOpenDatabase</b></a></p>
<p>
<a href="qref_9fvp.htm"><b>MsiViewClose</b></a></p>
<p>
<a href="qref_8hgl.htm"><b>MsiViewExecute</b></a></p>
<p>
<a href="qref_9b54.htm"><b>MsiViewFetch</b></a></p>
<p>
<a href="qref_541e.htm"><b>MsiViewGetError</b></a></p>
<p>
<a href="qref_0gzd.htm"><b>MsiViewModify</b></a></p>

<h4><a name="_msi_database_management_functions"></a>Database Management Functions</h4>
<p>
You can use the following access functions to manage the database:</p>
<p>
<a href="qref_5zlb.htm"><b>MsiCreateTransformSummaryInfo</b></a></p>
<p>
<a href="qref_5tyl.htm"><b>MsiDatabaseApplyTransform</b></a></p>
<p>
<a href="qref_4qyc.htm"><b>MsiDatabaseExport</b></a></p>
<p>
<a href="qref_29rh.htm"><b>MsiDatabaseGenerateTransform</b></a></p>
<p>
<a href="qref_59pw.htm"><b>MsiDatabaseImport</b></a></p>
<p>
<a href="qref_5pd1.htm"><b>MsiDatabaseMerge</b></a></p>
<p>
<a href="qref_3iw5.htm"><b>MsiGetDatabaseState</b></a></p>

<h4><a name="_msi_record_processing_functions"></a>Record Processing Functions</h4>
<p>
You can use the following functions to process database records:</p>
<p>
<a href="qref_3v50.htm"><b>MsiCreateRecord</b></a></p>
<p>
<a href="qref_1l9d.htm"><b>MsiRecordClearData</b></a></p>
<p>
<a href="qref_6bj9.htm"><b>MsiRecordDataSize</b></a></p>
<p>
<a href="qref_8ulw.htm"><b>MsiRecordGetFieldCount</b></a></p>
<p>
<a href="qref_1dma.htm"><b>MsiRecordGetInteger</b></a></p>
<p>
<a href="qref_202v.htm"><b>MsiRecordGetString</b></a></p>
<p>
<a href="qref_1v58.htm"><b>MsiRecordIsNull</b></a></p>
<p>
<a href="qref_1vsd.htm"><b>MsiRecordReadStream</b></a></p>
<p>
<a href="qref_10vm.htm"><b>MsiRecordSetInteger</b></a></p>
<p>
<a href="qref_4wq5.htm"><b>MsiRecordSetStream</b></a></p>
<p>
<a href="qref_5a07.htm"><b>MsiRecordSetString</b></a></p>

<h4><a name="_msi_summary_information_property_functions"></a>Summary Information Property Functions</h4>
<p>
You can use the following functions with the summary information properties:</p>
<p>
<a href="qref_5dpq.htm"><b>MsiGetSummaryInformation</b></a></p>
<p>
<a href="qref_1ypl.htm"><b>MsiSummaryInfoGetProperty</b></a></p>
<p>
<a href="qref_4z5g.htm"><b>MsiSummaryInfoGetPropertyCount</b></a></p>
<p>
<a href="qref_65ys.htm"><b>MsiSummaryInfoPersist</b></a></p>
<p>
<a href="qref_9bax.htm"><b>MsiSummaryInfoSetProperty</b></a></p>

<h4><a name="_msi_installer_state_access_functions"></a>Installer State Access Functions</h4>
<p>
You can use the following functions to change or monitor the installer state:</p>
<p>
<a href="qref_86xx.htm"><b>MsiGetLanguage</b></a></p>
<p>
<a href="qref_7jhg.htm"><b>MsiGetLastErrorRecord</b></a></p>
<p>
<a href="qref_8u05.htm"><b>MsiGetMode</b></a></p>
<p>
<a href="qref_7u2h.htm"><b>MsiGetProperty</b></a></p>
<p>
<a href="qref_56nt.htm"><b>MsiSetProperty</b></a></p>
<p>
<a href="qref_1d9h.htm"><b>MsiSetMode</b></a></p>

<h4><a name="_msi_installer_action_functions"></a>Installer Action Functions</h4>
<p>
You can use the following functions to access the installer actions:</p>
<p>
<a href="qref_9woe.htm"><b>MsiDoAction</b></a></p>
<p>
<a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a></p>
<p>
<a href="qref_163p.htm"><b>MsiProcessMessage</b></a></p>
<p>
<a href="qref_6zad.htm"><b>MsiSequence</b></a></p>

<h4><a name="_msi_installer_location_functions"></a>Installer Location Functions</h4>
<p>
You can use the following functions to access the installer folder location:</p>
<p>
<a href="qref_7g14.htm"><b>MsiGetSourcePath</b></a></p>
<p>
<a href="qref_05bc.htm"><b>MsiGetTargetPath</b></a></p>
<p>
<a href="qref_4wko.htm"><b>MsiSetTargetPath</b></a></p>

<h4><a name="_msi_installer_selection_functions"></a>Installer Selection Functions</h4>
<p>
You can use the following functions to access the installer selection state:</p>
<p>
<a href="qref_47l1.htm"><b>MsiGetComponentState</b></a></p>
<p>
<a href="qref_5ub8.htm"><b>MsiGetFeatureCost</b></a></p>
<p>
<a href="qref_3wmd.htm"><b>MsiGetFeatureState</b></a></p>
<p>
<a href="qref_3k4z.htm"><b>MsiGetFeatureValidStates</b></a></p>
<p>
<a href="qref_3s6d.htm"><b>MsiSetComponentState</b></a></p>
<p>
<a href="qref_9ejp.htm"><b>MsiSetFeatureState</b></a></p>
<p>
<a href="qref_7yr0.htm"><b>MsiSetInstallLevel</b></a></p>
<p>
<a href="qref_6ucl.htm"><b>MsiVerifyDiskSpace</b></a></p>

<h4><a name="_msi_user_interface_functions"></a>User Interface Functions</h4>
<p>
You can use the following functions to preview user interface dialog boxes:</p>
<p>
<a href="qref_4ek7.htm"><b>MsiEnableUIPreview</b></a></p>
<p>
<a href="qref_9s2s.htm"><b>MsiPreviewBillboard</b></a></p>
<p>
<a href="qref_1tpj.htm"><b>MsiPreviewDialog</b></a></p>
<p>
All functions support both ANSI and Unicode calls. To use these functions, include MsiQuery.h and link with Msi.lib.</p>
<h4>Installation Functions</h4>
<p>
In addition to the database access functions listed above, you create an installation package for an application by using the installer functions listed in the <a href="msi_8vqd.htm">Installer Function Reference</a> section.</p>
<p>&nbsp;</p></body>
</HTML>
