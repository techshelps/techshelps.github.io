<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Media Table</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_media_table"></a>Media Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Media table describes the set of disks that make up the source media for the installation.</p>
<p>
The Media table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%>DiskId</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>LastSequence</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>DiskPrompt</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Cabinet</td>
<td width=39%><a href="tref_6b77.htm#_msi_cabinet">Cabinet</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>VolumeLabel</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Source</td>
<td width=39%><a href="tref_6b77.htm#_msi_property">Property</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
DiskId</dt>
<dd>
Determines the sort order for the table.
<p>
Non-negative numbers only. Minimum value is 1.
</dd>
<dt>
LastSequence</dt>
<dd>
File sequence number for the last file for this media.
<p>
Non-negative numbers only.
</dd>
<dt>
DiskPrompt</dt>
<dd>
Disk name, the visible text printed on the disk. This is used to prompt the user when this disk needs to be inserted.</dd>
<dt>
Cabinet</dt>
<dd>
The name of the cabinet if some or all of the files stored on the media are compressed in a cabinet. If cabinets are not being used, this column must be blank (or the entire column can be omitted).</dd>
<dt>
VolumeLabel</dt>
<dd>
The label attributed to the volume. This is the volume label returned by the GetVolumeInformation system API. If the <a href="pref_6uwp.htm">SOURCEDIR property</a> refers to a removable (floppy or CD-ROM) volume, this volume label is used to verify that the proper disk is in the drive before attempting to install files.</dd>
<dt>
Source</dt>
<dd>
The property defining the location of this cabinet file. If the Cabinet field is empty, this value is ignored. If this field is empty, the SOURCEDIR property is used.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Sequence Numbers</b></p>
<p>
The numbers in the LastSequence column specify which of the files in the <a href="tref_4n6t.htm">File table</a> are found on a particular source disk. Each source disk contains all the files whose sequence numbers (as shown in the Sequence column of the File table) are less than or equal to the value in the LastSequence column, and greater than the LastSequence value of the previous disk (or greater than 0, for the first entry in the Media table).</p>
<p>
<b>Cabinet Files</b></p>
<p>
If the Cabinet name is preceded by an at symbol (@), the files referencing this Media table record are packed in a cabinet that is stored within a resource of the launching executable file.</p>
<p>
<b>Determining the SourceMode</b></p>
<p>
The <a href="sref_8gzd.htm">MSI Source Type Summary property</a> determines the source mode for the current install. If this property is set to 2 or 3, a cabinet install is assumed. In this mode, the cabinet files are assumed to exist in the directory indicated by the SOURCEDIR property. If the Source Type value is 0 or 1, all source files are assumed to exist in the tree whose root is indicated by the SOURCEDIR property.</p>
<p>
Note that this only applies to files in the File table that do not have either the Compressed or Uncompressed bits set in the attributes column. These bits override the value of the <a href="sref_8gzd.htm">MSI Source Type Summary property</a> when determining if a particular file is compressed or uncompressed.</p>
<p>&nbsp;</p></body>
</HTML>
