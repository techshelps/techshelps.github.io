<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FormatRecord Method</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_formatrecord_method"></a><a name="helpid_msiengine_formatrecord"></a>FormatRecord Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FormatRecord</b> method of the <a href="vref_6c38.htm">MsiEngine object</a>. This method returns a formatted string from a template and record data.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FormatRecord(</b><i>record</i>)</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>record</i></dt>
<dd>
Required MsiRecord object containing a template and data to be formatted. The template string must be set in field 0 followed by any referenced data parameters.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>FormatRecord</b> method uses the following format process.</p>
<p class=indent1>
Parameters to be formatted are enclosed in square brackets [..]. The square brackets can be iterated because the substitutions are resolved from inside out.</p>
<p class=indent1>
If a part of the string is enclosed in curly braces { } and contains no square brackets, the part is left unchanged, including the curly braces.</p>
<p class=indent1>
If a part of the string is enclosed in curly braces and contains one or more property names, and if all the properties are found, the text (with the resolved substitutions) is displayed without the curly braces. If any of the properties are not found, all the text in the curly braces and the braces themselves are removed.</p>
<p>
<img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To format strings using the FormatRecord method
<ol>
<li>
The numeric parameters are substituted by replacing the marker with the value of the corresponding record field, with missing or Null values producing no text.</li>
<li>
The string that results is processed by replacing the non-record parameters with the corresponding values, as noted in the following descriptions.<ul>
<li>
If a substring of the form "[propertyname]" is encountered, it is replaced by the value of the property.</li>
<li>
If a substring of the form "[%environmentvariable]" is found, the value of the environment variable is substituted. </li>
<li>
If a substring of the form "[#filekey]" is found, it is replaced by the full path of the file, with the value <i>filekey</i> used as a key into the File table. </li>
<li>
If a substring of the form "[$componentkey]" is found, it is replaced by the installation directory of the component, with the value <i>componentkey</i> used as a key into the Component table, taking into account the Component.Action column state. If the component is selected to be installed locally, it is replaced by the target directory. If the component is selected to run from source, it is replaced by the source directory. If the component is not selected, or if the component is missing, it is replaced by a Null string.</li>
<li>
If a substring of the form "[\c]" is found, it is replaced by the character without any further processing. Only the first character after the backslash is kept; everything else is removed. </li>
</ul>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
