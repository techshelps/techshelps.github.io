<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INSTALLUI_HANDLER</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_installui_handler"></a>INSTALLUI_HANDLER</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>INSTALLUI_HANDLER</b> function prototype defines a callback function that the Installer Service calls for progress notification and error messages.</p>
<pre><code><b>INT(WINAPI*INSTALLUI_HANDLER)(
</b>  <b>LPVOID</b> <i>pvContext</i><b>,</b>   // application context
  <b>UINT</b> <i>iMessageType</i><b>,</b>  // message type
  <b>LPCTSTR</b> <i>szMessage</i>   // message
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pvContext</i></dt>
<dd>
Enables the application to determine its context when it is called back.</dd>
<dt>
<i>iMessageType</i></dt>
<dd>
Specifies a combination of one message box style, one message box icon type, one default button, and one installation message type. This parameter must be one of the following.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Message Box StylesFlag</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>MB_ABORTRETRYIGNORE</td>
<td width=56%>The message box contains the <b>Abort</b>, <b>Retry</b>, and <b>Ignore</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_OK</td>
<td width=56%>The message box contains the <b>OK</b> button. This is the default.</td>
</tr>
<tr valign=top>
<td width=44%>MB_OKCANCEL</td>
<td width=56%>The message box contains the <b>OK</b> and <b>Cancel</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_RETRYCANCEL</td>
<td width=56%>The message box contains the <b>Retry</b> and <b>Cancel</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_YESNO</td>
<td width=56%>The message box contains the <b>Yes</b> and <b>No</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_YESNOCANCEL</td>
<td width=56%>The message box contains the <b>Yes</b>, <b>No</b>, and <b>Cancel</b> buttons.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Message Box IconTypesFlag</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>MB_ICONEXCLAMATION, MB_ICONWARNING</td>
<td width=56%>An exclamation point appears in the message box.</td>
</tr>
<tr valign=top>
<td width=44%>MB_ICONINFORMATION, MB_ICONASTERISK</td>
<td width=56%>The information sign appears in the message box.</td>
</tr>
<tr valign=top>
<td width=44%>MB_ICONQUESTION</td>
<td width=56%>A question mark appears in the message box.</td>
</tr>
<tr valign=top>
<td width=44%>MB_ICONSTOP, MB_ICONERROR, MB_ICONHAND</td>
<td width=56%>A stop sign appears in the message box.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Default ButtonsFlag</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON1</td>
<td width=56%>The first button is the default button.</td>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON2</td>
<td width=56%>The second button is the default button.</td>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON3</td>
<td width=56%>The third button is the default button.</td>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON4</td>
<td width=56%>The fourth button is the default button.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=54%>Install Message TypesFlag</th>
<th align=left width=46%>Meaning</th>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_OUTOFMEMORY</td>
<td width=46%>Out-of-memory message</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ERROR</td>
<td width=46%>Formatted error message</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_WARNING</td>
<td width=46%>Formatted warning message</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_USER</td>
<td width=46%>User request message.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_INFO</td>
<td width=46%>Informative message for log</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_DIAGNOSTIC</td>
<td width=46%>Debug notification. This message displays if there is no log.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_COMMONDATA</td>
<td width=46%>Dialog information for UI.  Type of data is specified in the first field, parameters follow in remaining fields. Fields are separated by colons. Types of COMMONDATA messages are:<p>
1:<i>LanguageID</i></p>
<p>
2:<i>Dialog Caption</i></p>
<p>
3:<i>Boolean, 1 to show cancel button, 0 to hide</i></p>
</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ACTIONSTART</td>
<td width=46%>Start of action message. This message includes the action name and description.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ACTIONDATA</td>
<td width=46%>Formatted data associated with the individual action item.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_PROGRESS</td>
<td width=46%>Progress gauge information. This message includes information on units so far and total number of units.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ACTIONDONE</td>
<td width=46%>End of action sequence. Indicates an exit-modeless dialog box.</td>
</tr>
</table><br>


<p>
The following defaults should be used if any of the preceding messages are missing: MB_OK, no icon, and MB_DEFBUTTON1. There is no default installation message type; a message type is always specified.
</dd>
<dt>
<i>szMessage</i></dt>
<dd>
Specifies the message text.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
-1</dt>
<dd>
An error was found in the message handler.</dd>
<dt>
0</dt>
<dd>
No action was taken.
</dd>
</dl>
<p>
The following return values map to the buttons specified by the message box style.</p>
<p>
IDOK<br>
IDCANCEL<br>
IDABORT<br>
IDRETRY<br>
IDIGNORE<br>
IDYES<br>
IDNO</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
