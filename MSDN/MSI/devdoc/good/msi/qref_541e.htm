<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiViewGetError</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msiviewgeterror"></a>MsiViewGetError</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiViewGetError</b> function returns the error that occurred in the <a href="qref_0gzd.htm"><b>MsiViewModify</b></a> function. </p>
<pre><code><b>MSIDBERROR MsiViewGetError(
</b>  <b>MSIHANDLE</b> <i>hView</i><b>,</b>            // view handle
  <b>LPTSTR</b> <i>szColumnNameBuffer</i><b>,</b>  // buffer to hold column name string
  <b>DWORD </b><i>*pcchBuf</i>              // size of buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hView</i></dt>
<dd>
Handle to the view.</dd>
<dt>
<i>szColumnNameBuffer</i></dt>
<dd>
Specifies the buffer to hold the column name string. This parameter is NULL if there are no errors or if the size of the buffer is too small.</dd>
<dt>
<i>pcchBuf</i></dt>
<dd>
Specifies the size of the buffer. This parameter returns the size required for the buffer if an error occurs.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function returns one of the following values.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=55%>Error code</th>
<th align=left width=14%>Error number</th>
<th align=left width=31%>Meaning</th>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_INVALIDARG</td>
<td width=14%>-3</td>
<td width=31%>An argument was invalid.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_MOREDATA</td>
<td width=14%>-2</td>
<td width=31%>The buffer was too small to receive data.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_FUNCTIONERROR</td>
<td width=14%>-1</td>
<td width=31%>The function failed.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_NOERROR</td>
<td width=14%>0</td>
<td width=31%>The function completed successfully with no errors.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_DUPLICATEKEY</td>
<td width=14%>1</td>
<td width=31%>The new record duplicates primary keys of the existing record in a table.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_REQUIRED</td>
<td width=14%>2</td>
<td width=31%>There are no NULL values allowed, or the column is about to be deleted but is referenced by another row. </td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADLINK</td>
<td width=14%>3</td>
<td width=31%>The corresponding record in a foreign table was not found.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_OVERFLOW</td>
<td width=14%>4</td>
<td width=31%>The data is greater than the maximum value allowed.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_UNDERFLOW</td>
<td width=14%>5</td>
<td width=31%>The data is less than the minimum value allowed.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_NOTINSET</td>
<td width=14%>6</td>
<td width=31%>The data is not a member of the values permitted in the set.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADVERSION</td>
<td width=14%>7</td>
<td width=31%>An invalid version string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCASE</td>
<td width=14%>8</td>
<td width=31%>The case was invalid. The case must be all uppercase or all lowercase.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADGUID </td>
<td width=14%>9</td>
<td width=31%>An invalid GUID was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADWILDCARD </td>
<td width=14%>10</td>
<td width=31%>An invalid wildcard file name was supplied, or the use of wildcards was invalid.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADIDENTIFIER </td>
<td width=14%>11</td>
<td width=31%>An invalid identifier was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADLANGUAGE </td>
<td width=14%>12</td>
<td width=31%>Invalid language IDs were supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADFILENAME </td>
<td width=14%>13</td>
<td width=31%>An invalid file name was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADPATH </td>
<td width=14%>14</td>
<td width=31%>An invalid path was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCONDITION </td>
<td width=14%>15</td>
<td width=31%>An invalid conditional statement was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADFORMATTED </td>
<td width=14%>16</td>
<td width=31%>An invalid format string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADTEMPLATE </td>
<td width=14%>17</td>
<td width=31%>An invalid template string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADDEFAULTDIR </td>
<td width=14%>18</td>
<td width=31%>An invalid string was supplied in the DefaultDir column of the <a href="tref_6an9.htm">Directory table</a>.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADREGPATH </td>
<td width=14%>19</td>
<td width=31%>An invalid registry path string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCUSTOMSOURCE</td>
<td width=14%>20</td>
<td width=31%>An invalid string was supplied in the CustomSource column of the <a href="tref_71b9.htm">CustomAction table</a>.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADPROPERTY </td>
<td width=14%>21</td>
<td width=31%>An invalid property string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_MISSINGDATA </td>
<td width=14%>22</td>
<td width=31%>The <a href="tref_8fl1.htm">_Validation table</a> is missing a reference to a column.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCATEGORY </td>
<td width=14%>23</td>
<td width=31%>The category column of the _Validation table for the column is invalid.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCABINET</td>
<td width=14%>24</td>
<td width=31%>An invalid cabinet name was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADKEYTABLE </td>
<td width=14%>25</td>
<td width=31%>The table in the Keytable column of the _Validation table was not found or loaded.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADMAXMINVALUES </td>
<td width=14%>26</td>
<td width=31%>The value in the MaxValue column of the _Validation table is less than the value in the MinValue column.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADSHORTCUT</td>
<td width=14%>27</td>
<td width=31%>An invalid shortcut target name was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_STRINGOVERFLOW</td>
<td width=14%>28</td>
<td width=31%>The string is too long for the length specified by the column definition.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADLOCALIZEATTRIB</td>
<td width=14%>29</td>
<td width=31%>An invalid localization attribute was supplied. (Primary keys cannot be localized.)</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
You should only call the <b>MsiViewGetError</b> function when <b>MsiViewModify</b> returns ERROR_INVALID_DATA, indicating that the data is invalid. Errors are only recorded for MSIMODIFY_VALIDATE, MSIMODIFY_VALIDATE_NEW, and MSIMODIFY_VALIDATEFIELD.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
