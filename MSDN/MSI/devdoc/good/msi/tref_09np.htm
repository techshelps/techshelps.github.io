<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Component Table</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_component_table"></a>Component Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Component table lists components. </p>
<p>
The Component table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%>Component</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=31%>ComponentID</td>
<td width=37%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=31%>Directory_</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=31%>Attributes</td>
<td width=37%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=31%>Condition</td>
<td width=37%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=31%>KeyPath</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Component</dt>
<dd>
Identifies the component record.
<p>
Primary table key.
</dd>
<dt>
ComponentID</dt>
<dd>
A string GUID unique to this component, version, and language.
<p>
Table key.
</dd>
<dt>
Directory_</dt>
<dd>
External key of an entry in the <a href="tref_6an9.htm">Directory table</a>. This is a property name whose value contains the actual path, set either by the <a href="aref_16zy.htm">AppSearch action</a> or with the default setting obtained from the Directory table.
<p>
External key to column one of the Directory table.
</dd>
<dt>
Attributes</dt>
<dd>
Remote execution option.
<p>
The first two bits indicate whether the component can be run from source. The following table lists valid values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>This value</th>
<th align=left width=68%>Indicates that the item </th>
</tr>
<tr valign=top>
<td width=32%>0 (irsLocalOnly)</td>
<td width=68%>Cannot be run from the source.</td>
</tr>
<tr valign=top>
<td width=32%>1 (irsSourceOnly)</td>
<td width=68%>Can run only from the source.</td>
</tr>
<tr valign=top>
<td width=32%>2 (irsOptional)</td>
<td width=68%>Can run either locally or from the source.</td>
</tr>
</table><br>


<p>
The rest of the significant bits are bit flags.

<p>
The 3rd bit is the irsRegistryKeyPath bit. 

<p>
If the third bit is set, the KeyPath column, if not Null, is interpreted as a key into the <a href="tref_3obp.htm">Registry table</a>. If this bit is not set, the KeyPath column, if not Null, is interpreted as a key into the <a href="tref_4n6t.htm">File table</a>.

<p>
The 4th bit is the icaSharedDllRefCount bit. If the 4th bit is set, the installer will always increment the reference count in the shared DLL registry. If the 4th bit is not set, then the installer will only increment the reference count if it already exists.

<p>
The 5th bit is the icaPermanent bit. If the 5th bit is set then the component will not be removed on uninstall.
</dd>
<dt>
Condition</dt>
<dd>
A conditional statement that indicates if a component should be installed. If the condition is Null or evaluates to True, the component is enabled. If the condition evaluates to False, the component is disabled. If a component is disabled, it will not be installed regardless of the Action state associated with the component. For information on the conditional expression syntax, see the <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a> function.</dd>
<dt>
KeyPath</dt>
<dd>
This value points to the component member that will be used for detection. It is also the path that is returned by the <a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a> function. If not Null, KeyPath is either the primary key into the File table or the Registry table based on the irsRegistryKeyPath bit in the Attributes column. In both cases, the entity (file or folder) should belong to this component. If Null, the folder of the Component (Component.Directory_) is used as the key path. Two components can not share the same key path value.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For a discussion of the relationship between components and features, see <a href="tref_0a91.htm">Feature Table</a>.</p>
<p>
The installer keeps track of shared DLLs independently of the shared DLL reference count in the registry. If a reference count for a shared DLL exists in the registry, then the installer will always increment the count when it is installing the file and decrement it when it is uninstalling. However, if the icaSharedDllRefCount bit is not set and the reference count does not already exist, the installer will not create one.</p>
<p>
If the icaSharedDllRefCount bit is not set, another application could remove the component even if it is still needed. To see how this could happen, consider the following scenario:
<ul>
<li>
An application that uses the installer installs a shared component.</li>
<li>
The icaSharedDllRefCount is not set and there is no reference count. Thus the installer does not begin a reference count.</li>
<li>
A legacy application that shares this component and does not use the installer is installed.</li>
<li>
The legacy application creates and increments a reference count for the shared component.</li>
<li>
The legacy application is uninstalled.</li>
<li>
The reference count for the shared component is decremented to zero and the component is removed.</li>
<li>
The application using the installer no longer has access to the component.</li>
</ul>
<p>
To avoid this behavior, set the icaSharedDllRefCount bit.</p>
<p>&nbsp;</p></body>
</HTML>
