<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiGetFeatureValidStates</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msigetfeaturevalidstates"></a>MsiGetFeatureValidStates</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureValidStates</b> function returns a valid installation state.</p>
<pre><code><b>UINT MsiGetFeatureValidStates(
</b>  <b>MSIHANDLE</b> <i>hInstall<b>,</b></i>            // installer handle
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>             // feature name
  <b>DWORD</b> <i>*dwInstallState</i>          // install state
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature name.</dd>
<dt>
<i>dwInstallState</i></dt>
<dd>
Specifies the location to hold the valid installation states. This parameter will be a combination of the following values. For each valid install state, a bit is set of value: (1 &lt;&lt; INSTALLSTATE).
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=54%>Value</th>
<th align=left width=46%>Meaning</th>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_ABSENT</td>
<td width=46%>The feature can be uninstalled.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_ADVERTISED</td>
<td width=46%>The feature can be advertised.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_LOCAL</td>
<td width=46%>The feature can be installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_SOURCE</td>
<td width=46%>The feature can be configured to run from source, CD, or network.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_DEFAULT</td>
<td width=46%>The feature can be configured to use the default location: local or source.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
An invalid handle state was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiGetFeatureValidStates</b> function determines state validity by querying all components that are linked to the specified feature without taking into account the current installed state of any component. If any of these components have a value of IRSOPTIONAL in the RunFromSource column, or if at least one component is marked IRSTLOCALONLY and at least one other component is marked IRSSOURCEONLY, then both INSTALLSTATE_LOCAL and INSTALLSTATE_SOURCE are valid states for the feature. If all components are set to IRSLOCALONLY, INSTALLSTATE_LOCAL is the only valid state. If all components are set to IRSSOURCEONLY, INSTALLSTATE_SOURCE is the only valid state.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
