<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MoveFiles Action</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_movefiles_action"></a>MoveFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MoveFiles action allows the author to locate files that already exist on the user's computer and move or copy those files to a new location. The MoveFiles action moves an entry in the <a href="tref_5un9.htm">MoveFile table</a> only if the component linked to that entry is being installed locally or is being run from source.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_5un9.htm">MoveFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=34%>MoveFile.FileKey</td>
<td width=66%>Primary key, uniquely identifying an entry in the MoveFile table.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.Component_</td>
<td width=66%>Foreign key into the Component table.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.SourceName</td>
<td width=66%>Name of the source file to be moved or copied.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.DestName</td>
<td width=66%>Name to be given to the destination file.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.SourceFolder</td>
<td width=66%>Property name whose value identifies the source folder.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.DestFolder</td>
<td width=66%>Property name whose value identifies the destination folder.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.Options</td>
<td width=66%>Option flags used to define the behavior of the move/copy operation.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The LaunchConditions action must occur after the <a href="aref_9fzi.htm">InstallValidate</a> action and before the <a href="aref_3hym.htm">InstallFiles</a> action.</p>
<h4>Remarks</h4>
<p>
The Options field allows you to specify whether the source file(s) should be moved or copied (that is, whether the source file is to be deleted after it has been copied to a new location). For the exact syntax, see the <a href="tref_5un9.htm">MoveFile table</a>.</p>
<p>
The strings in the SourceFolder and DestFolder fields are property names whose values are expected to resolve to fully qualified paths. These properties could be any of the directory entries in the <a href="tref_6an9.htm">Directory</a> table, any predefined folder property (<a href="pref_048p.htm">FavoritesFolder</a>, for example), or a property set by any entry in the <a href="tref_0w9x.htm">AppSearch</a> table.</p>
<p>
Some properties can contain a full path to a specific file (that is, a full path with the file name appended). For example, AppSearch can be authored to search for a particular file and to set a property to the full path to that file. In a case such as this, the SourceName field in the MoveFile table can be left blank indicating that the value in the SourceFolder property contains a full file path. Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used in these filenames or paths.</p>
<p>
For a particular entry in the MoveFile table, if either the SourceFolder or DestFolder property does not evaluate to a valid path, MoveFiles does nothing for that entry.</p>
<p>
The MoveFiles action attempts to move or copy all files in the source directory that match the name given in the SourceName column. This name can include wildcards (* and ?), which allow a group of files to be moved or copied. For example, you could specify *.xls for the SourceName, and MoveFiles moves or copies every Microsoft® Excel workbook from the source directory to the destination.</p>
<p>
When copying or moving files, the name to be given to the destination file can be specified in the DestName field. If this field is left blank, the destination file name is the same as the source file name.</p>
<p>
The DestName field should normally be left blank if a wildcard is specified in the SourceName field. If you do specify a DestName when using wildcards, the first source file that matches the wildcard criteria is given the specified destination name. (All other moved/copied files have the same name as the source file.)</p>
<p>
Files that are moved or copied by MoveFiles are not deleted when the product is uninstalled.</p>
<p>&nbsp;</p></body>
</HTML>
