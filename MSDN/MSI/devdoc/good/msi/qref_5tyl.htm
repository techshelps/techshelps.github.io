<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiDatabaseApplyTransform</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msidatabaseapplytransform"></a>MsiDatabaseApplyTransform</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseApplyTransform</b> function applies a transform to a database.</p>
<pre><code><b>UINT MsiDatabaseApplyTransform(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>     // database handle
  <b>LPCTSTR</b> <i>szTransformFile</i><b>,</b> // name of transform file
  <b>int</b> <i>iErrorConditions</i>     // error conditions to be suppressed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to database to transform.</dd>
<dt>
<i>szTransformFile</i></dt>
<dd>
Specifies the name of the transform file to apply.</dd>
<dt>
<i>iErrorConditions</i></dt>
<dd>
Error conditions that should be suppressed. This parameter (can or must) be (one, any, one or more) of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Value</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td width=16%>0x0001</td>
<td width=84%>Adding a row that already exists.</td>
</tr>
<tr valign=top>
<td width=16%>0x0002</td>
<td width=84%>Deleting a row that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=16%>0x0004</td>
<td width=84%>Adding a table that already exists.</td>
</tr>
<tr valign=top>
<td width=16%>0x0008</td>
<td width=84%>Deleting a table that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=16%>0x0010</td>
<td width=84%>Updating a row that doesn't exist.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INSTALL_TRANSFORM_FAILURE</dt>
<dd>
The transform could not be applied.</dd>
<dt>
ERROR_OPEN_FAILED</dt>
<dd>
The transform storage file could not be opened.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDatabaseApplyTransform</b> function delays transforming tables until it is necessary. Any tables to be added or dropped are processed immediately. However, changes to the existing table are delayed until the table is loaded or the database is committed.</p>
<p>
An error occurs if <b>MsiDatabaseApplyTransform</b> is called when tables have already been loaded and saved to storage.</p>
<p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used for filenames or paths.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
