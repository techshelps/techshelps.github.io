<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiGetFeatureCost</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msigetfeaturecost"></a>MsiGetFeatureCost</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureCost</b> function returns the disk space required by a feature and its selected children and parent features.</p>
<pre><code><b>UINT MsiGetFeatureCost(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>     // installer handle
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>      // name of feature
  <b>MSICOSTTREE</b> <i>iCostTree</i><b>,</b>  // portion of tree to cost
  <b>INSTALLSTATE</b> <i>iState</i><b>,</b>    // requested state
  <b>INT</b> <i>*piCost</i>             // returned cost
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the name of the feature.</dd>
<dt>
<i>iCostTree</i></dt>
<dd>
Specifies the value the function uses to determine disk space requirements. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_CHILDREN</td>
<td width=52%>The children of the indicated feature are included in the cost.</td>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_PARENTS</td>
<td width=52%>The parent features of the indicated feature are included in the cost.</td>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_PRODUCT</td>
<td width=52%>Unsupported.</td>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_SELFONLY</td>
<td width=52%>The feature only is included in the cost.</td>
</tr>
</table><br>

</dd>
<dt>
<i>iState</i></dt>
<dd>
Specifies the installation state. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_UNKNOWN</td>
<td width=52%>The product or feature is unrecognized.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_ABSENT</td>
<td width=52%>The product or feature is uninstalled.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_LOCAL</td>
<td width=52%>The product or feature is installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_SOURCE</td>
<td width=52%>The product or feature is installed to run from source, CD, or network.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_DEFAULT</td>
<td width=52%>The product or feature will be installed to use the default location: local or source.</td>
</tr>
</table><br>

</dd>
<dt>
<i>piCost</i></dt>
<dd>
Specifies the returned disk space requirements in units of 512 bytes.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
An invalid handle state was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>Remarks</h4>
<p>
With the <b>MsiGetFeatureCost</b> function, the MSICOSTTREE_SELFONLY value indicates the total amount of disk space (in units of 512 bytes) required by the specified feature only. This returned value does not include the children or the parent features of the specified feature. This total cost is made up of the disk costs attributed to every component linked to the feature.</p>
<p>
The MSICOSTTREE_CHILDREN value indicates the total amount of disk space (in units of 512 bytes) required by the specified feature and its children. For each feature, the total cost is made up of the disk costs attributed to every component linked to the feature.</p>
<p>
The MSICOSTTREE_PARENTS value indicates the total amount of disk space (in units of 512 bytes) required by the specified feature and its parent features (up to the root of the <a href="tref_0a91.htm">Feature table</a>). For each feature, the total cost is made up of the disk costs attributed to every component linked to the feature.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
