<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ServiceInstall Table</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_serviceinstall_table"></a>ServiceInstall Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ServiceInstall table is used to install a service.</p>
<p>
The ServiceInstall table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=29%>Type</th>
<th align=left width=23%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%></td>
<td width=29%></td>
<td width=23%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=30%>ServiceInstall</td>
<td width=29%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=23%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>Name</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>DisplayName</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>ServiceType</td>
<td width=29%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>StartType</td>
<td width=29%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>ErrorControl</td>
<td width=29%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>LoadOrderGroup</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Dependencies</td>
<td width=29%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>StartName</td>
<td width=29%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Password</td>
<td width=29%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=29%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
ServiceInstall</dt>
<dd>
This is the primary key for the table.</dd>
<dt>
Name</dt>
<dd>
This column is the string that gives the service name to install. The string has a maximum length of 256 characters. The service control manager database preserves the case of the characters in the service name, but comparisons of service names are case insensitive. Forward-slash (/) and back-slash (\) are invalid service name characters.</dd>
<dt>
DisplayName</dt>
<dd>
This column is the string that user interface programs use to identify the service. The string has a maximum length of 256 characters. The service control manager preserves the case of the display name, but display name comparisons are case insensitive.</dd>
<dt>
ServiceType</dt>
<dd>
This column is a set of bit flags that specify the type of service. One of the following service types must be specified in this column.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Service</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_WIN32_OWN_PROCESS</td>
<td width=22%>0x00000010</td>
<td width=40%>A Microsoft® Win32® service that runs its own process.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_WIN32_SHARE_PROCESS</td>
<td width=22%>0x00000020</td>
<td width=40%>A Win32 service that shares a process.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_INTERACTIVE_PROCESS</td>
<td width=22%>0x00000100</td>
<td width=40%>A Win32 service that interacts with the desktop. This value cannot be used alone and must be added to one of the two previous types.</td>
</tr>
</table><br>


<p>
The following types of service are unsupported.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Service</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_KERNEL_DRIVER</td>
<td width=22%>0x00000001</td>
<td width=40%>A driver service.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_FILE_SYSTEM_DRIVER</td>
<td width=22%>0x00000002</td>
<td width=40%>A file system driver service.</td>
</tr>
</table><br>

</dd>
<dt>
StartType</dt>
<dd>
This column is a set of bit flags that specify when to start the service. One of the following types of service start must be specified in this column.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Service Start</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_AUTO_START </td>
<td width=22%>0x00000002</td>
<td width=40%>A service start during startup of the system.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_DEMAND_START </td>
<td width=22%>0x00000003</td>
<td width=40%>A service start when the service control manager calls the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_startservice">
</object><a href=JavaScript:alink_1.Click()><b>StartService</b></a> function.</td>
</tr>
</table><br>


<p>
The following types of service starts are valid only for driver services.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Driver Service Start</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_BOOT_START </td>
<td width=22%>0x00000000</td>
<td width=40%>A device driver started by the operating system loader.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_SYSTEM_START </td>
<td width=22%>0x00000001</td>
<td width=40%>A device driver started by calling the <b>IoInitSystem</b> function. Use this in the <a href="tref_1691.htm">ServiceControl Table</a>, with the StartServices action put after the InstallServices action, to start a driver service during an install.</td>
</tr>
</table><br>

</dd>
<dt>
ErrorControl</dt>
<dd>
This column specifies the action taken by the startup program if the service fails to start during startup. These values affect the ServiceControl StartService events for installed services. One of the following error control flags must be specified in this column.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Error Control Flag</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Startup Program's Action</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_ERROR_IGNORE </td>
<td width=22%>0x00000000</td>
<td width=40%>Logs the error and continues with the startup operation.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_ERROR_NORMAL </td>
<td width=22%>0x00000001</td>
<td width=40%>Logs the error, displays a message box and continues the startup operation.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_ERROR_CRITICAL </td>
<td width=22%>0x00000003</td>
<td width=40%>Logs the error if it is possible and the system is restarted with the last configuration known to be good. If the last-known-good configuration is being started, the startup operation fails.</td>
</tr>
</table><br>

</dd>
<dt>
LoadOrderGroup</dt>
<dd>
This column contains the string that names the load ordering group of which this service is a member. Specify NULL or an empty string if the service does not belong to a group.</dd>
<dt>
Dependencies</dt>
<dd>
This column is a list of names of services or load ordering groups that the system must start before this service. Separate names in the list by Nulls. If the service has no dependencies, then specify NULL or an empty string. Dependency on a group means that the service can run if at least one member of the group is running after an attempt to start all members of the group. Because services and service groups share the same name space, group names must have the prefix: SC_GROUP_IDENTIFIER.</dd>
<dt>
StartName</dt>
<dd>
The service will be logged on as the name given by the string in this column. If the service type is SERVICE_WIN32_OWN_PROCESS use an account name in the form: DomainName\UserName. If the account belongs to the built-in domain it is permitted to specify .\UserName. The LocalSystem account must be used if the type of service is SERVICE_WIN32_SHARE_PROCESS. The <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createservice">
</object><a href=JavaScript:alink_2.Click()><b>CreateService</b></a> function uses the LocalSystem account if StartName is specified as NULL and most services will therefore leave this column blank.</dd>
<dt>
Password</dt>
<dd>
This string is the password to the account name in the <i>IpServiceStartName</i> parameter. The service has no password if the pointer in <i>IpServiceStartName</i> is NULL or if it points to an empty string. The Startname of LocalSystem is NULL, and therefore the password for <i>lpServiceStartName</i> in this instance is NULL, so most services will leave this column blank.

<p>
<b>Note</b>&nbsp;&nbsp;Services installed with a user name and password cannot be rolled back when deleted.

</dd>
<dt>
Component_</dt>
<dd>
External key to column one of the <a href="tref_09np.htm">Component Table</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table has most of the parameters to the Win32 <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createservice">
</object><a href=JavaScript:alink_3.Click()><b>CreateService</b></a> function. </p>
<p>&nbsp;</p></body>
</HTML>
