<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiSetFeatureState</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msisetfeaturestate"></a>MsiSetFeatureState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetFeatureState</b> function sets a feature to a specified state.</p>
<pre><code><b>UINT MsiSetFeatureState(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>     // installer handle
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>      // name of feature
  <b>INSTALLSTATE</b> <i>iState</i>     // install state
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the name of the feature.</dd>
<dt>
<i>iState</i></dt>
<dd>
Specifies the state to set. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_ABSENT</td>
<td width=52%>The feature was uninstalled.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_LOCAL</td>
<td width=52%>The feature was installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_SOURCE</td>
<td width=52%>The feature will run from source, CD, or network.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
One of the parameters was invalid.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiSetFeatureState</b> function requests a change in the select state of a feature in the <a href="tref_0a91.htm">Feature table</a> and its children. In turn, the Action state of all the components linked to the changed Feature records are also updated appropriately, based on the new feature Select state.</p>
<p>
The <a href="qref_7yr0.htm"><b>MsiSetInstallLevel</b></a> function must be called before calling <b>MsiSetFeatureState</b>.</p>
<p>
When <b>MsiSetFeatureState</b> is called, the installer attempts to set the Action state of each component tied to the specified feature to the specified state. However, there are common situations when the request cannot be fully implemented. For example, suppose a feature is tied to two components, component A and component B, through the <a href="tref_52hx.htm">FeatureComponents table</a>. Also suppose that component A is authored with a RunFromSource option of IRSLOCALONLY and component B is authored with a RunFromSource option of IRSSOURCEONLY. In this case, if <b>MsiSetFeatureState</b> is called with a requested state of either INSTALLSTATE_LOCAL or INSTALLSTATE_SOURCE, the request cannot be fully implemented for both components. However, both components are turned ON, with component A set to Local and component B set to Source.</p>
<p>
If more than one feature is linked to a single component (a common scenario), the final Action state of that component is determined as follows.
<ul>
<li>
If at least one feature requires the component to be installed locally, the feature is installed with a state of Local.</li>
<li>
If at least one feature requires the component to be run from source , the feature is installed with a state of Source.</li>
<li>
If at least one feature requires the removal of the component, the action state is Absent.</li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
