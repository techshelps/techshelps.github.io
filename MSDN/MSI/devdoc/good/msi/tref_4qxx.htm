<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Upgrade Table</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_upgrade_table"></a>Upgrade Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Upgrade table contains information on how the installer should perform an upgrade of a product and how to handle installations when related versions of the product are already installed.</p>
<p>
The Upgrade table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=25%>Column</th>
<th align=left width=42%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=42%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=25%>UpgradeCode</td>
<td width=42%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>ProductVersion</td>
<td width=42%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>Operator</td>
<td width=42%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>Features</td>
<td width=42%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>Property</td>
<td width=42%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
UpgradeCode</dt>
<dd>
This column contains a unique <a href="pref_7mux.htm">UpgradeCode property</a> representing a set of products that are related to the pending product upgrade. Products already installed and having this UpgradeCode may be removed and replaced by the pending upgrade or the current installation may be blocked.</dd>
<dt>
ProductVersion</dt>
<dd>
This is the version of the product that it to be compared to any related products that are already installed. Whether or not this version replaces an installed version of the product depends upon the evaluation of the Operator column.</dd>
<dt>
Operator</dt>
<dd>
This column contains an operator that changes the current installation dependent upon whether another version of the product is already installed. The following table lists the possible operations. To combine these operations, add their values and use the sum in the Operator column. For example, setting the Operator column to 3 specifies that the installation be blocked if a newer upgrade of the product is already installed. The type of the operator should be the same as the Type column of the CustomAction table.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=12%>Value</th>
<th align=left width=88%>Operation</th>
</tr>
<tr valign=top>
<td width=12%>0</td>
<td width=88%>If there is another version of the product already installed, then uninstall it.</td>
</tr>
<tr valign=top>
<td width=12%>1</td>
<td width=88%>If there is another version of the product already installed, then block the installation.</td>
</tr>
<tr valign=top>
<td width=12%>2</td>
<td width=88%>Check if the installed version of the product is greater than the ProductVersion column.</td>
</tr>
<tr valign=top>
<td width=12%>4</td>
<td width=88%>Check if the installed version of the product is less than the ProductVersion column.</td>
</tr>
<tr valign=top>
<td width=12%>8</td>
<td width=88%>Check if the installed version of the product equals the ProductVersion column.</td>
</tr>
<tr valign=top>
<td width=12%>16</td>
<td width=88%>If there is another version of the product already installed, then migrate the product settings from it.</td>
</tr>
</table><br>

</dd>
<dt>
Features</dt>
<dd>
The features listed in this column are removed from the installed product when installing a newer version of the product.</dd>
<dt>
Property</dt>
<dd>
The property in this column is set to the product code if the <a href="aref_4rse.htm">FindRelatedProducts action</a> finds any related products already installed. If more than one product is found, this property is set to a semi-colon delimited list of product codes.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The Upgrade table is used by the <a href="aref_4rse.htm">FindRelatedProducts action</a>, <a href="aref_3u0e.htm">BlockInstall action</a>, <a href="aref_9a5q.htm">MigrateFeatureSettings action</a> and the <a href="aref_0omm.htm">RemoveOldProducts action</a>.</p>
<p>&nbsp;</p></body>
</HTML>
