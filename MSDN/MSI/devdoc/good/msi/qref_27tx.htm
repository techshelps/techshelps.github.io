<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiOpenDatabase</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msiopendatabase"></a>MsiOpenDatabase</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiOpenDatabase</b> function opens a database file for data access.</p>
<pre><code><b>UINT MsiOpenDatabase(
</b>  <b>LPCTSTR</b> <i>szDatabasePath</i><b>,</b>  // path to database
  <b>LPCTSTR</b> <i>szPersist</i><b>,</b>       // output database or predefined
                           // persist mode
  <b>MSIHANDLE</b> <i>*phDatabase</i>    // location to return database handle
<b>); </b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szDatabasePath</i></dt>
<dd>
Specifies the full path or relative path to the database file.</dd>
<dt>
<i>szPersist</i></dt>
<dd>
Specifies the full path to the file or the persistence mode. You can use the <i>szPersist</i> parameter to direct the persistent output to a new file or to specify one of the following predefined persistence modes.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_CREATEDIRECT</td>
<td width=52%>Create a new database, direct mode read/write.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_CREATE</td>
<td width=52%>Create a new database, transact mode read/write.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_DIRECT</td>
<td width=52%>Open a database direct read/write without transaction.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_READONLY</td>
<td width=52%>Open a database read-only, no persistent changes.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_TRANSACT</td>
<td width=52%>Open a database read/write in transaction mode.</td>
</tr>
</table><br>

</dd>
<dt>
<i>phDatabase</i></dt>
<dd>
Pointer to the location of the returned database handle.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_CREATE_FAILED</dt>
<dd>
The database could not be created.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
One of the parameters was invalid.</dd>
<dt>
ERROR_OPEN_FAILED</dt>
<dd>
The database could not be opened as requested.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiOpenDatabase</b> function initiates database access. This function cannot be used for a running installation. The database must be opened in transaction, create, or direct mode for changes to be retained. Create mode creates a new installer database</p>
<p>
<b>Note</b>&nbsp;&nbsp;When a database is opened as the output of another database, the summary information stream of the output database is actually a read-only mirror of the original database, and, thus, cannot be changed. Additionally, it is not persisted with the database. To create or modify the summary information for the output database, it must be closed and reopened.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
