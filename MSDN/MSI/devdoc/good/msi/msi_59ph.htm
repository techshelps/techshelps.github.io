<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsiGetProductCode</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_msigetproductcode"></a>MsiGetProductCode</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetProductCode</b> function returns the product code of an application by using the component code of an installed or advertised component of the application. During initialization, an application must determine under which product code it has been installed or advertised.</p>
<pre><code><b>UINT MsiGetProductCode(
</b>  <b>LPCTSTR</b> <i>szComponent</i><b>,</b>  // component code for application
  <b>LPTSTR</b> <i>lpProductBuf</i>   // buffer to receive GUID
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szComponent</i></dt>
<dd>
This parameter specifies the component code of a component that has been installed or advertised by the application. This will be typically the component code of the component containing the executable file of the application.</dd>
<dt>
<i>lpProductBuf</i></dt>
<dd>
Pointer to a buffer that receives the product code. This buffer must be 39 characters long. The first 38 characters are for the GUID, and the last character is for the terminating NULL character.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The product code could not be determined.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_COMPONENT</dt>
<dd>
The specified component is unknown.
</dd>
</dl>
<h4>Remarks</h4>
<p>
During initialization, an application must determine the product code under which it was installed. An application can be part of different products in different installations. For example, an application can be part of a suite of applications, or it can be installed by itself. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_application_only_functions">Application-Only Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
