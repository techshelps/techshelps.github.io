<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RemoveFiles Action</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_removefiles_action"></a>RemoveFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveFiles action uninstalls files previously installed by the <a href="aref_3hym.htm">InstallFiles</a> action. Each of these files is gated by a link to an entry in the <a href="tref_09np.htm">Component</a> table. Only those files whose components are resolved to the <i>iisAbsent</i> Action state (or the <i>iisSource</i> Action state if the component is currently installed locally) are removed. </p>
<p>
The RemoveFiles action can also remove specific author-specified files that are not installed by the InstallFiles action. These files are specified in the <a href="tref_7gth.htm">RemoveFile</a> table. Each of these files is gated by a link to an entry in the <a href="tref_09np.htm">Component</a> table. Those files whose components are resolved to any active Action state (that is, not in the Off or Null state) are removed (if the file exists in the specified directory). This implies that removal of files specified in the RemoveFile table is attempted when the gating component is first installed, during a reinstall, and again when the gating component is removed.</p>
<p>
The RemoveFiles action can also remove folders. You can indicate that a folder be removed if it is empty by leaving the FileName column of the RemoveFile table null.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_7gth.htm">RemoveFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<p>
While uninstalling previously installed files, the database table fields queried are identical to those queried by the <a href="aref_3hym.htm">InstallFiles</a> action (except that the <a href="tref_4mlh.htm">Media table</a> is not used at all by RemoveFiles). </p>
<p>
While removing files specified in the <a href="tref_7gth.htm">RemoveFile</a> table, the following fields are queried:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>RemoveFile.FileName</td>
<td width=52%>Target file name (localized text).</td>
</tr>
<tr valign=top>
<td width=48%>RemoveFile.DirProperty</td>
<td width=52%>Property name that should resolve to a valid full directory path.</td>
</tr>
<tr valign=top>
<td width=48%>Component.Component</td>
<td width=52%>Unique name for the component item (text, primary key).</td>
</tr>
<tr valign=top>
<td width=48%>Component.Action</td>
<td width=52%>Enum indicating the action to be taken.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9fzi.htm">InstallValidate</a> action must be called before calling RemoveFiles. If an <a href="aref_3hym.htm">InstallFiles</a> action is used, it must appear after RemoveFiles.</p>
<h4>Remarks</h4>
<p>
The <a href="tref_7gth.htm">RemoveFile</a> table can be omitted from the install database if there are no miscellaneous files to remove.</p>
<p>&nbsp;</p></body>
</HTML>
