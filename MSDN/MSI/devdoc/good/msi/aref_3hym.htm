<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>InstallFiles Action</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_installfiles_action"></a>InstallFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallFiles action copies selected files from the source directory to the destination directory.</p>
<p>
The InstallFiles action operates on files specified in the <a href="tref_4n6t.htm">File table</a>. Each of these files is installed based on what is going to happen to its associated component in the <a href="tref_09np.htm">Component table</a>. Only those files whose components are resolved to the <i>iisLocal</i> Action state are eligible to be copied.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4mlh.htm">Media Table</a></p>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%>Media.LastSequence</td>
<td width=65%>Last sequence number on this media record.</td>
</tr>
<tr valign=top>
<td width=35%>Media.DiskPrompt</td>
<td width=65%>Text identifier on media, for user prompting (localized text).</td>
</tr>
<tr valign=top>
<td width=35%>Media.VolumeLabel</td>
<td width=65%>Volume label, used for disk validation.</td>
</tr>
<tr valign=top>
<td width=35%>Media.Cabinet</td>
<td width=65%>For cabinet installs, the name of the cabinet file.</td>
</tr>
<tr valign=top>
<td width=35%>File.FileName</td>
<td width=65%>Target file name (localized text).</td>
</tr>
<tr valign=top>
<td width=35%>File.Version</td>
<td width=65%>File version (non-localized text).</td>
</tr>
<tr valign=top>
<td width=35%>File.State</td>
<td width=65%>Installation status for the file (integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.Attributes</td>
<td width=65%>File and installation attribute flag bits (integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.File</td>
<td width=65%>Unique file token (non-localized text, primary key).</td>
</tr>
<tr valign=top>
<td width=35%>File.FileSize</td>
<td width=65%>Uncompressed file size in bytes (long integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.Language</td>
<td width=65%>File language identifier (integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.Sequence</td>
<td width=65%>Sequence number on media (integer, unique).</td>
</tr>
<tr valign=top>
<td width=35%>Component.Directory_</td>
<td width=65%>Reference to <a href="tref_6an9.htm">Directory table</a> item (non-localized text).</td>
</tr>
<tr valign=top>
<td width=35%>Component.Component</td>
<td width=65%>Unique name for the component item (text, primary key)</td>
</tr>
<tr valign=top>
<td width=35%>Component.Action</td>
<td width=65%>Enum indicating the action to be taken.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The InstallFiles action must occur after the <a href="aref_9fzi.htm">InstallValidate</a> action and before any file-dependent actions.</p>
<h4>Remarks</h4>
<p>
Action states determine what is going to happen to a file during the running of the installation script. However, even if the component is in the <i>iisLocal</i> state, the file is only copied if one of the following is true:
<ul>
<li>
The file is currently not on the local computer.</li>
<li>
The file is on the local computer but it has a lower version number than the file in the <a href="tref_4n6t.htm">File table</a>.</li>
<li>
The file is on the local computer, but there is no associated version number.</li>
</ul>
<p>
The value in the Action state is calculated during the file costing process. For more information, see the <a href="tref_0a91.htm">Feature table</a> and the <a href="vref_84xl.htm"><b>FeatureRequestState</b> property</a>.</p>
<p>
<b>Source Directory Determination</b></p>
<p>
The determination of the source directory for each file to be copied depends on the SourceMode, which is dependent on the value in the Media.Cabinet column. For a full discussion of the SourceMode determination, see the <a href="tref_4mlh.htm">Media table</a>.</p>
<p>
<b>Prompting for Disks</b></p>
<p>
If the source directory for a file to be copied resides on a removable disk (a floppy or CD-ROM), the InstallFiles action validates that the proper source disk is inserted before attempting to copy the file. To do this, InstallFiles searches for a disk of the same removable type that has a volume label that matches the value given in the Media.VolumeLabel field. If a matching mounted volume is found, the file copying process proceeds. However, if no match is found, a dialog appears requesting that the proper disk be inserted. In this case, the dialog uses the disk name found in the Media.DiskPrompt field as part of the prompt.</p>
<p>
<b>Possible Problems</b></p>
<p>
If a file is replacing an older file, an error occurs, and that error is ignored, it is possible that the original file is deleted and not replaced. This is because the installer deletes the old file before making sure the new file is copied correctly.</p>
<p>&nbsp;</p></body>
</HTML>
