<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Switching Between Keyboard Layouts</title>
<style>@import url(../msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="../msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h3>Switching Between Keyboard Layouts</h3>

<p>Switching between keyboard layouts involves changing the
tables that determine which characters result when you press the
keys. The tables exist independently from physical keyboards,
though some keyboards, such as Japanese keyboards, have
additional keys with special functions. On Windows, you don't
have to change your hardware to change your input language. You
can type Japanese text using a standard United States (US)
keyboard, even without the additional keys. The keyboard
templates in <font class="MissingLink" meta="dev0ac">Appendix Q</font> show the characters produced by each of
the keyboard layouts that Windows 95 supports.</p>

<p><b>Language/Layout Pairs</b></p>

<p>Because Windows 95 gives the user the ability to type multiple
languages using multiple keyboard layouts, the system needs to
know which keyboard layout should be active for a particular
language. It does this by keeping track of all languages the user
has installed and which keyboard layout the user has associated
with each language. These associations are called language/layout
pairs, or input languages.</p>

<p>When the user installs Windows 95, the setup program
automatically installs a default language/layout pair that
corresponds to the language edition of the system. For example,
if the user installs the French edition of Windows 95, the setup
program creates a list of languages containing only one entry
(Standard French) and pairs it with the French keyboard. However,
the system allows the user to create alternative pairs as long as
the selected keyboard layout can produce the characters used by
the language. Thus, a user running a custom setup could
conceivably assign the Arabic, Canadian, Turkish, or US keyboard
layout to the French language. The user can add or modify
language/layout pairs at any time using the keyboard icon in
Control Panel. (See Figures 6-1 and 6-2.)</p>

<P><img src="F06FD01.gif" width="404" height="449"></p>

<P><b>Figure 6-1</b> <i>Standard German has been added
to the list of input language choices using the Windows 95
Properties for Keyboard dialog box. The user can change the
keyboard layout associated with the input language at any time by
clicking the Properties button.</i></p>

<P><img src="F06FD02.gif" width="347" height="188"></p>

<P><b>Figure 6-2</b> <i>The Language Properties dialog
box allows the user to change the keyboard layout that is paired
with a given language.</i></p>

<p>Windows 95 tracks language/layout pairs using a new variable
type called an input language handle, often referred to as an
HKL, which is illustrated below.</p>

<P><img src="g06fd01.gif" width="375" height="38"></p>

<p>The low word of the handle is a language ID, and the high word
is a handle to a keyboard layout. You can zero-extend the
language ID to form the corresponding locale ID for tagging text
and calling NLSAPI functions. The API functions that take an HKL
as a parameter are listed in the following table:</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td valign="top"><b><i>Keyboard-Related API Function</i></b></td>
        <td valign="top"><em><strong>Description</strong></em></td>
    </tr>
    <tr>
        <td valign="top">GetKeyboardLayout</td>
        <td valign="top">Returns the active language/layout pair</td>
    </tr>
    <tr>
        <td valign="top">GetKeyboardLayoutList</td>
        <td valign="top">Returns a list of installed
        language/layout pairs</td>
    </tr>
    <tr>
        <td valign="top">GetKeyboardLayoutName</td>
        <td valign="top">Returns the name of the active
        keyboardlayout</td>
    </tr>
    <tr>
        <td valign="top">LoadKeyboardLayout</td>
        <td valign="top">Loads a new keyboard layout into
        thesystem</td>
    </tr>
    <tr>
        <td valign="top">UnloadKeyboardLayout </td>
        <td valign="top">Unloads a keyboard layout; cannot unload
        the system default</td>
    </tr>
    <tr>
        <td valign="top">ActivateKeyboardLayout</td>
        <td valign="top">Changes the active language/layout pair</td>
    </tr>
</table>
</FONT></BODY>
</html>
