<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Formatted Date and Time Strings</title>
<style>@import url(../msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="../msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h2>Formatted Date and Time Strings</h2>

<P><b>Glossary</b></p>

<ul>
    <li><b>Cultural convention:</b> Data or data formats that are
        specific to a language, local dialect, or geographic
        location. Examples are currency symbols, date formats,
        calendars, numeric separators, and sorting orders.</li>
    <li><b>Date picture string/time picture string:</b> A string
        used to represent a date or time format&#151;for example,
        &quot;MMMM dddd yyyy&quot;.</li>
    <li><b>LCTYPE: </b>A constant defined by Windows that
        specifies a particular type of locale information.</li>
</ul>

<p>One of the most useful sets of NLSAPI calls&#151;<i>GetDateFormat,</i>
<i>GetTimeFormat,</i> <i>EnumDateFormats,</i> <i>EnumTimeFormats,</i>
and <i>EnumCalendarInfo</i>&#151;returns formatted date and time
picture strings. <i>EnumDateFormats</i> and <i>EnumTimeFormats,</i>
as their names suggest, enumerate the date and time picture
strings that the system carries for a particular locale. With
these two functions, you can build a list of possible date and
time strings to present to the user, such as the one in Figure
5-1 below.</p>

<P><img src="F05FD01.gif" width="254" height="247"></p>

<P><b>Figure 5-1</b><i> The Date and Time dialog box
from Microsoft Word 6 for Windows.</i></p>

<p>GetDateFormat and <i>GetTimeFormat</i> return a single string
each. When you use <i>GetDateFormat,</i> your application can
request a string containing the correct date in the default
short-date format (DATE_SHORTDATE) or the default long-date
format (DATE_LONGDATE) for a particular locale, as in the
following sample code:</p>

<p><font size="2" face="Courier New">DWORD dwRC = ERROR_SUCCESS<br>
LPTSTR pszDate = (LPTSTR) GlobalAlloc(GPTR, MEMSIZE(nLen + 1));<br>
<br>
if ( !pszDate )<br>
return (GetLastError());<br>
<br>
int nLen = GetDateFormat(GetThreadLocale(), // Use this thread's<br>
// locale.<br>
DATE_LONGDATE, // Flags are passed<br>
// into this function.<br>
NULL, // Use current system<br>
// time.<br>
pszDateFormat, // format selected by<br>
// user<br>
pszDate, // used for formatted<br>
// date<br>
nLen); // used for date buffer<br>
// length<br>
<br>
if ( nLen == 0 )<br>
{<br>
dwRC = GetLastError();<br>
GlobalFree(pszDate);<br>
return (dwRC);<br>
}</font></p>

<p>The short-date and long-date formats correspond to the two
date formats displayed in the system Control Panel shown in <font class="MissingLink" meta="dev5h">Figure
5-6</font>. Similarly, you can call <i>GetTimeFormat</i> to request a
string containing the current time in one of several default
formats. If you want to specify a different date and time, you
can fill in a SYSTEMTIME structure, shown below, and pass it into
a date and time formatting API.</p>

<p><font size="2" face="Courier New">typedef struct _SYSTEMTIME {<br>
WORD wYear;<br>
WORD wMonth;<br>
WORD wDayOfWeek;<br>
WORD wDay;<br>
WORD wHour;<br>
WORD wMinute;<br>
WORD wSecond;<br>
WORD wMilliseconds;<br>
} SYSTEMTIME, *PSYSTEMTIME, *LPSYSTEMTIME</font></p>

<p>Although the system's default date and time formats are the
most commonly used formats for each locale, your application is
not limited to these choices. You can construct a picture string
that can be passed to either <i>GetDateFormat</i> or <i>GetTimeFormat</i>.
For example, on March 15, 1995, the system would interpret the
picture string</p>

<p><i>&quot;'This is 'dddd', day 'dd' of the month of
'MMMM'.'&quot;</i></p>

<p>for an English-speaking locale as</p>

<p><i>This is Wednesday, day 15 of the month of March.</i></p>

<p>For a Spanish-speaking locale, the system would interpret the
picture as</p>

<p><i>This is miercoles, day 15 of the month of marzo.</i></p>

<p>Windows replaces the <i>dddd,</i> <i>dd,</i> and <i>MMMM</i>
combinations with system strings, leaving all letters inside the
single quotes untouched. Of course, you could localize the
picture string into Spanish so that it would make more sense to a
Spanish speaker. Figure 5-2 below summarizes the syntax for
customized date and time picture strings.</p>

<p>If you want to retrieve pieces of a date string, such as the
localized names of the days of the week or months of the year,
you can call the all-purpose function <i>GetLocaleInfo</i>. <i>GetLocaleInfo</i>
takes a DWORD parameter called an LCTYPE, which specifies which
piece of locale-related information the system should return. <i>GetLocaleInfoW</i>
returns a null-terminated Unicode string, and <i>GetLocaleInfoA</i>
returns a null-terminated string in the system's default local
code page. Figure 5-3 below lists the LCTYPES associated with
date and time. You can find descriptions of them in <font class="MissingLink" meta="dev0v">Appendix I</font>.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td valign="top"><b><i>Syntax</i></b></td>
        <td valign="top"><strong><i>Description</i></strong></td>
    </tr>
    <tr>
        <td valign="top">d</td>
        <td valign="top">Numeric representation of the day of the
        month, without leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">dd</td>
        <td valign="top">Numeric representation of the day of the
        month, with leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">ddd</td>
        <td valign="top">Three-letter abbreviation for the day of
        the week (<i>SABBREVDAYNAME</i>)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">dddd</td>
        <td valign="top">Full name of the day of the week (<i>SDAYNAME</i>)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">M</td>
        <td valign="top">Numeric representation of the month,
        without leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">MM</td>
        <td valign="top">Numeric representation of the month,
        with leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">MMM</td>
        <td valign="top">Three-letter abbreviation for the name
        of the month (<i>SABBREVMONTHNAME</i>)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">MMMM</td>
        <td valign="top">Full name of the month (<i>SMONTHNAME</i>)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">y</td>
        <td valign="top">Year represented by only the last two
        digits, without leading zeros if less than 10</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">yy</td>
        <td valign="top">Year represented by only the last two
        digits</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">yyyy</td>
        <td valign="top">Year represented by all four digits</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">gg</td>
        <td valign="top">Period/era string, found in the CALTYPE
        CAL_SERASTRING</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">h</td>
        <td valign="top">Hours without leading zeros (12-hour
        clock)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">hh</td>
        <td valign="top">Hours with leading zeros (12-hour clock)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">H</td>
        <td valign="top">Hours without leading zeros (24-hour
        clock)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">HH</td>
        <td valign="top">Hours with leading zeros (24-hour clock)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">m</td>
        <td valign="top">Minutes without leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">mm</td>
        <td valign="top">Minutes with leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">s</td>
        <td valign="top">Seconds without leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">ss</td>
        <td valign="top">Seconds with leading zeros</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">t</td>
        <td valign="top">One-character time-marker string (for
        example, &quot;a&quot; and &quot;p&quot;)</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">tt</td>
        <td valign="top">Multicharacter time-marker string (for
        example, &quot;AM&quot; and &quot;PM&quot;)</td>
    </tr>
</TBODY></table>

<P><br>
</p>

<P><b>Figure 5-2</b><i> Date and time picture string
elements.</i></p>

<p>Some languages, such as Finnish, German, Polish, and Russian,
have several noun forms. If you plan to use localized names
provided by the system, have a linguist check to make sure you
are using them in the right context. Windows carries both the
nominative and genitive forms of Polish and Russian month names;
the form changes depending on the month name's position in the
string relative to the day name. Windows returns both forms in a
single string separated by a null value. The system carries only
one form of each month name or day name for all other languages.</p>

<table border="0" cellpadding="7" cols="2">
<COLGROUP><COL WIDTH="205pt" VALIGN="TOP"><COL WIDTH="205pt" VALIGN="TOP"></COLGROUP><TBODY>    <tr>
        <td valign="top">LOCALE_ICENTURY</td>
        <td valign="top">LOCALE_SDATE</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_IDATE</td>
        <td valign="top">LOCALE_SDAYNAME1</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_IDAYLZERO</td>
        <td valign="top">LOCALE_SDAYNAME2</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_ILDATE</td>
        <td valign="top">LOCALE_SDAYNAME3</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_IMONLZERO</td>
        <td valign="top">LOCALE_SDAYNAME4</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_ITIME</td>
        <td valign="top">LOCALE_SDAYNAME5</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_ITIMEMARKPOSN</td>
        <td valign="top">LOCALE_SDAYNAME6</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_ITLZERO</td>
        <td valign="top">LOCALE_SDAYNAME7</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_S1159</td>
        <td valign="top">LOCALE_SLONGDATE</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_S2359</td>
        <td valign="top">LOCALE_SMONTHNAME1</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVDAYNAME1</td>
        <td valign="top">LOCALE_SMONTHNAME2</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVDAYNAME2</td>
        <td valign="top">LOCALE_SMONTHNAME3</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVDAYNAME3</td>
        <td valign="top">LOCALE_SMONTHNAME4</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVDAYNAME4</td>
        <td valign="top">LOCALE_SMONTHNAME5</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVDAYNAME5</td>
        <td valign="top">LOCALE_SMONTHNAME6</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVDAYNAME6</td>
        <td valign="top">LOCALE_SMONTHNAME7</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVDAYNAME7</td>
        <td valign="top">LOCALE_SMONTHNAME8</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME1</td>
        <td valign="top">LOCALE_SMONTHNAME9</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME2</td>
        <td valign="top">LOCALE_SMONTHNAME10</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME3</td>
        <td valign="top">LOCALE_SMONTHNAME11</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME4</td>
        <td valign="top">LOCALE_SMONTHNAME12</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME5</td>
        <td valign="top">LOCALE_SMONTHNAME13</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME6</td>
        <td valign="top">LOCALE_SSHORTDATE</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME7</td>
        <td valign="top">LOCALE_STIME</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME8</td>
        <td valign="top">LOCALE_STIMEFORMAT</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME9</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME10</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME11</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME12</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">LOCALE_SABBREVMONTHNAME13</td>
        <td valign="top">&nbsp;</td>
    </tr>
</TBODY></table>

<P><br>
</p>

<P><b>Figure 5-3</b><i> LCTYPEs for date and time. See <font class="MissingLink" meta="dev0v"></i>Appendix
I</font><i> for full descriptions. The 13th month is for lunar
calendars.</i></p>
</FONT></BODY>
</html>
