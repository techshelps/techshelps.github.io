<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Calls to IME Functions</title>
<style>@import url(../msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="../msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h2>Adding Calls to IME Functions</h2>

<p>After you add code to respond to messages, you must add code
to send messages from the application to the IME. These messages
allow your application to request that IMEs handle positioning of
the IME conversion window, enable or disable the display of the
conversion window, use a particular font in the conversion
window, and execute a particular virtual key. To send the IME a
request, call the function <i>SendIMEMessageEx,</i> with <i>wParam</i>
set to one of the constants listed in Figure 7-20. The return
value <i>SendIMEMessageEx</i> will indicate the result of the
subfunction.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td valign="top"><b><i>SendIMEMessageEx Subfunction</i></b></td>
        <td valign="top"><em><strong>Description</strong></em></td>
    </tr>
    <tr>
        <td valign="top">IME_GETCONVERSIONMODE</td>
        <td valign="top">Retrieves the mode of the IME.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_GETOPEN</td>
        <td valign="top">Retrieves the current status of the IME.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_SETCONVERSIONWINDOW</td>
        <td valign="top">Specifies the size and position of the
        bounding rectangle and the display start position of the
        conversion window. The IME displays an undetermined
        string at the position specified by this command.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_GETIMECAPS</td>
        <td valign="top">Checks whether a specific command is
        supported by the currently selected IME.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_SELECT</td>
        <td valign="top">Informs a selection of an IME.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_SENDVKEY</td>
        <td valign="top">Checks whether the IME supports virtual
        keys and if so, executes them. Virtual keys should begin
        with VK_.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_SETCONVERSIONMODE</td>
        <td valign="top">Sets the mode of the IME.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_SETCONVERSIONFONTEX</td>
        <td valign="top">Specifies a font for displaying an
        undetermined string in the conversion window. It differs
        from IME_SETCONVERSIONFONT in that it specifies the font
        using the logical font (LOGFONT) structure instead of a
        handle. The global memory containing the LOGFONT
        structure should be released by the application.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_SETCONVERSIONFONT</td>
        <td valign="top">Specifies a font for displaying an
        undetermined string in the conversion window. To display
        an undetermined string at the default position, use a
        system font. If the display position is the same size or
        shorter than the default position, enable the previously
        specified font. If NULL is specified as the font handle,
        a system font will be used. Windows NT does not support
        this command; it supports only IME_SETCONVERSIONFONTEX.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_SETOPEN</td>
        <td valign="top">Sets the status of the IME either to
        non-zero (to open the IME) or to zero (to close the IME).
        Returns the previous status. An undetermined string must
        not be determined if the IME has been closed.</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_ENTERWORDREGISTERMODE</td>
        <td valign="top">Registers words and their readings as
        sent by applications. Includes parameters that describe
        parts of speech.</td>
    </tr>
</table>

<P><b>Figure 7-20</b> SendIMEMessageEx subfunctions on
Windows NT 3.5 under the Windows NT 3.5 IME model.</p>

<p>You will find that the two subfunctions
IME_SETCONVERSIONWINDOW and IME_SETCONVERSIONFONT are
particularly useful on Windows NT 3.5. Most existing applications
position the conversion window next to the insertion point and
request the IME to display the same font as the one used in the
surrounding document. On Windows 95 these settings are the
default, but on Windows NT 3.5 the default position for the IME
conversion window is at the bottom of the screen, and characters
in the conversion window are displayed in the system font.</p>

<p>The subfunction IME_SETCONVERSIONMODE can be called with one
or more of the flags listed in Figure 7-21 to set the IME's
conversion mode.</p>

<table border="0" cellpadding="7" cols="3">
    <tr>
        <td valign="top"><b><i>Conversion Mode</i></b></td>
        <td valign="top"><em><strong>Description</strong></em></td>
        <td valign="top"><em><strong>Comments</strong></em></td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_ALPHANUMERIC</td>
        <td valign="top">Alphanumeric</td>
        <td valign="top">Cannot be simultaneously specified with
        IME_MODE _KATAKANA or IME_MODE_HIRAGANA</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_KATAKANA</td>
        <td valign="top">Katakana</td>
        <td valign="top">Cannot be simultaneously specified with
        IME_MODE_ALPHANUMERIC or IME_MODE_HIRAGANA</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_HIRAGANA</td>
        <td valign="top">Hiragana</td>
        <td valign="top">Cannot be simultaneously specified with
        IME_MODE_ALPHANUMERIC or IME_MODE_KATAKANA</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_SBCSCHAR</td>
        <td valign="top">Single byte </td>
        <td valign="top">Cannot be simultaneously character
        specified with IME_MODE_DBCSCHAR</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_DBCSCHAR</td>
        <td valign="top">Double byte character</td>
        <td valign="top">Cannot be simultaneously specified with
        IME_MODE_SBCSCHAR</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_ROMAN</td>
        <td valign="top">Roman </td>
        <td valign="top">Cannot be simultaneously character
        specified with IME_MODE_NOROMAN</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_NOROMAN</td>
        <td valign="top">Non Roman </td>
        <td valign="top">Cannot be simultaneously character
        specified with IME_MODE_ROMAN</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_CODEINPUT</td>
        <td valign="top">Code input </td>
        <td valign="top">Cannot be simultaneously specified with
        IME_MODE_NOCODEINPUT</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">IME_MODE_NOCODEINPUT</td>
        <td valign="top">Non-code </td>
        <td valign="top">Cannot be simultaneously input specified
        with IME_MODE_CODEINPUT</td>
    </tr>
</table>

<P><b>Figure 7-21</b> <i>Possible flags for
IME_SETCONVERSIONMODE under the Windows NT 3.5 IME model.</i></p>
</FONT></BODY>
</html>
