<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Functions That Manipulate Input Contexts</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(../msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="../msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<H2 CLASS="h1">Functions That Manipulate Input Contexts</H2>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="149pt" VALIGN="TOP"><COL WIDTH="293pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B><I>IMM Function</I></B></P></TD><TD VALIGN="TOP"><P><B><I>Description</I></B></P></TD></TR><TR><TD VALIGN="TOP"><P>ImmAssociateContext</P></TD><TD VALIGN="TOP"><P>Associates a specified input context with a specified window. Unless the application calls this function, the system will associate the default input context with the window handle. Before the application destroys the customized input context, it must reassign a different input context, typically the system default, to the window.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmCreateContext</P></TD><TD VALIGN="TOP"><P>Allocates memory for and initializes a new input context.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmDestroyContext</P></TD><TD VALIGN="TOP"><P>Releases the specified input context and frees memory associated with it. For every call it makes to <I>ImmCreateContext,</I> an application must call <I>ImmDestroyContext</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmEscape</P></TD><TD VALIGN="TOP"><P>Calls a specified subfunction, usually one that is country-specific. This function allows applications to access features of a particular IME that are not accessible through other IMM API functions. Any applications targeted to run on more than one Far East edition of Windows should not call the country-specific functions.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetCandidateList</P></TD><TD VALIGN="TOP"><P>Retrieves a specified candidate list and copies it to a specified buffer.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetCandidateListCount</P></TD><TD VALIGN="TOP"><P>Returns the number of bytes needed to accommodate all the characters in the candidate list.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetCandidateWindow</P></TD><TD VALIGN="TOP"><P>Retrieves the CANDIDATEFORM structure, which in-cludes information such as the position, rectangular dimensions, and style of the candidate window.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetCompositionFont</P></TD><TD VALIGN="TOP"><P>Retrieves the logical font currently used to display characters in the composition window.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetCompositionString </P></TD><TD VALIGN="TOP"><P>Retrieves information about the string in the composition window. Applications should call this function in response to the message WM_IME_COMPOSITION.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetCompositionWindow</P></TD><TD VALIGN="TOP"><P>Retrieves the COMPOSITIONFORM structure, which includes information such as the position, rectangular dimensions, and direction (horizontal or vertical) of the composition window.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetContext</P></TD><TD VALIGN="TOP"><P>Retrieves the input context associated with a specified window. Applications must call this function before accessing the contents of an input context. </P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetConversionList</P></TD><TD VALIGN="TOP"><P>Retrieves a list of characters or words associated with a single character or word.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetConversionStatus</P></TD><TD VALIGN="TOP"><P>Retrieves the current conversion status. </P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetDefaultIMEWnd</P></TD><TD VALIGN="TOP"><P>Retrieves the default window handle for the IME class. The system will create a default IME window, based on the IME class, for every thread. Applications can send WM_IME_CONTROL messages to this window.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetGuideLine</P></TD><TD VALIGN="TOP"><P>Retrieves error information and other messages. Applications should call this function in response to a WM_IME_NOTIFY message with a <I>wParam</I> value of IMN_GUIDELINE.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetOpenStatus</P></TD><TD VALIGN="TOP"><P>Tells you whether the specified IME is open or closed.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmGetStatusWindowPos</P></TD><TD VALIGN="TOP"><P>Retrieves the position of the status window, defined in screen coordinates.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmNotifyIME</P></TD><TD VALIGN="TOP"><P>Notifies the IME that the status of the input context has changed. For example, the application might have opened or closed the candidate window or selected a character in the candidate list.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmReleaseContext</P></TD><TD VALIGN="TOP"><P>Releases the specified input context and unlocks memory associated with it. For every call it makes to <I>ImmGetContext,</I> an application must call <I>ImmReleaseContext</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmSetCandidateWindow</P></TD><TD VALIGN="TOP"><P>Sets candidate window properties, such as position. Both applications and IMEs can call this function, which generates a WM_IME_NOTIFY message with a <I>wParam</I> value of IMN_SETCANDIDATEPOS.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmSetCompositionFont</P></TD><TD VALIGN="TOP"><P>Sets the logical font used to display characters in the composition window. The IME might change behavior, depending on the font used. For example, if the application specifies a vertical font, the IME might change the way it handles arrow keys. Calling this function generates a WM_IME_NOTIFY message with a <I>wParam</I> value of IMN_SETCOMPOSITIONFONT.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmSetCompositionString</P></TD><TD VALIGN="TOP"><P>Sets the appearance of the string in the composition window.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmSetCompositionWindow</P></TD><TD VALIGN="TOP"><P>Sets composition window properties, such as position. Both applications and IMEs can call this function, which generates a WM_IME_NOTIFY message with a <I>wParam </I>value of IMN_SETCOMPOSITIONWINDOW.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmSetConversionStatus</P></TD><TD VALIGN="TOP"><P>Sets the current conversion status. Both applications and IMEs can call this function, which generates a WM_IME_NOTIFY message with a <I>wParam </I>value of IMN_SETCONVERSIONSTATUS.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmSetOpenStatus</P></TD><TD VALIGN="TOP"><P>Opens or closes the IME. Both applications and IMEs can call this function, which generates a WM_IME_NOTIFY message with a <I>wParam </I>value of IMN_SETOPENSTATUS.</P></TD></TR><TR><TD VALIGN="TOP"><P>ImmSetStatusWindowPos</P></TD><TD VALIGN="TOP"><P>Sets the position of the status window, defined in screen coordinates. Both applications and IMEs can call this function, which generates a WM_IME_NOTIFY message with a <I>wParam</I> value of IMN_SETSTATUSWINDOWPOS.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P></BODY></HTML>
