<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<HEAD><meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Running a Single Binary on Both Windows 95 and Windows NT</title>
<style>@import url(../msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="../msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h3>Running a Single Binary on Both Windows 95 and Windows NT</h3>

<p>As mentioned previously, the Win32 full-text search engine
runs on three different platforms. It uses the following code to
detect which operating system it is running on:</p>

<p><font size="2" face="Courier New">/////////////////////////////////////////////////<br>
// operating system identification<br>
<br>
#define OS_WIN95 0x03<br>
#define OS_WIN32s 0x02<br>
#define OS_NT 0x00<br>
<br>
g_os_version = (GetVersion() &gt;&gt; 30) &amp; 0x0003;</font></p>

<p>If you plan to create a single binary that will run on Windows
NT, Windows 95, and Win32s, make sure that you account for the
slight differences in national language support on each platform.
<font class="MissingLink" meta="dev0x">Appendix K</font> lists which NLSAPI functions each platform supports.
You will have to find alternatives when your application runs on
a version of Windows that doesn't support the API function you
want to use.</p>

<p>For example, Win32s and Windows NT 3.<i>x</i> do not support <i>IsDBCSLeadByteEx</i>.
You can, however, retrieve the lead-byte ranges for a particular
code page by calling <i>GetCPInfo</i>. Windows 95, on the other
hand, doesn't support Unicode-based NLSAPI calls such as <i>LCMapStringW</i>
or <i>GetStringTypeW</i>. If your application is Unicode-based,
you will need to assemble information by converting data with <i>WideCharToMultiByte</i>
and calling the -A version of the appropriate function. If your
data spans multiple Windows code pages, you'll have to break the
data down into segments that span a single code page, call the -A
function on each segment, and merge the results.</p>

<p>&nbsp;</p>
</FONT></BODY>
</html>
