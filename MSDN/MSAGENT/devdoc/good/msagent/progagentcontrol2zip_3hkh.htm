<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Activate Method</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="progagentcontrol2zip_41"></a>Activate Method</h2>
<h4>Description</h4>
<p>
Sets the active client or character. </p>
<h4>Syntax</h4>
<p>
<i>agent</i>.Characters ("<i>CharacterID</i>").Activate [<i>State</i>]</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=22%><b>Part</b></td>
<td width=78%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%><i>State</i></td>
<td width=78%>Optional. You can specify the following values for this parameter:<p>
0&nbsp;&nbsp;&nbsp;&nbsp;Not the active client.</p>
<p>
1&nbsp;&nbsp;&nbsp;&nbsp;The active client. </p>
<p>
2&nbsp;&nbsp;&nbsp;&nbsp;(Default) The topmost character.</p>
</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
When multiple characters are visible, only one of the characters receives speech input at a time. Similarly, when multiple client applications share the same character, only one of the clients receives mouse input (for example, Microsoft Agent control click or drag events). The character set to receive mouse and speech input is the topmost character and the client that receives the input is the active client of that character. (The topmost character's window also appears at the top of the character windows z-order.) Typically, the user determines the topmost character by explicitly selecting the character. However, topmost activation also changes when a character is shown or hidden (the character becomes or is no longer topmost, respectively.) </p>
<p>
You can also use this method to explicitly manage when your client receives input directed to the character such as when your application itself becomes active. For example, setting <b>State</b> to 2 makes the character topmost and your client receives all mouse and speech input events generated from user interaction with the character. Therefore, it also makes your client the input-active client of the character.</p>
<p>
However, you can also set yourself to be the active client for a character without making the character topmost, by setting <b>State</b> to 1. This enables your client to receive input directed to that character when the character becomes topmost. Similarly, you can set your client to not be the active client (not to receive input) when the character becomes topmost, by setting <b>State</b> to 0.</p>
<p>
Avoid calling this method directly after a <b>Show</b> method. <b>Show</b> automatically sets the input-active client. When the character is hidden, the <b>Activate</b> call may fail if it gets processed before the <b>Show</b> method completes.</p>
<p>
If you call this method to a function, it returns a Boolean value that indicates whether the method succeeded. Attempting to call this method with the <b>State</b> parameter set to 2 when the specified character is hidden will fail. Similarly, if you set <b>State</b> to 0 and your application is the only client, this call fails because a character must always have a topmost client.</p>
<pre><code>    Dim Genie as Object

    Sub FormLoad()

    Agent1.Characters.Load "Genie", _
        "C:\Program Files\Microsoft Agent\Characters\Genie.acs"

    Set Genie = Agent1.Characters ("Genie")

    If (Genie. Activate = True) Then
        'I'm active

    Else
        'I must be hidden or something

    End If 
    
    End Sub
</code></pre>
<h4></h4>
<h4>See Also</h4>
<p>
<b>ActivateInput</b> event, <b>DeactivateInput</b> event</p>
<p>
--------------------------------------------------------</p>
<p>&nbsp;</p></body>
</HTML>
