<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Command Event</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="progagentcontrol2zip_22"></a>Command Event</h2>
<h4>Description</h4>
<p>
Occurs when a (client's) command is chosen by the user. </p>
<h4>Syntax</h4>
<p>
<b>Sub</b> <i>agent</i>_<b>Command(ByVal</b> <i>UserInput</i><b>)</b></p>
<p>
</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=13%><b>Value</b></td>
<td width=87%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=13%>UserInput</td>
<td width=87%>Identifies the <b>Command</b> object returned by the server. <p>
The following properties can be accessed from the <b>Command</b> object.</p>
<p>
<b>CharacterID</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string value identifying the name (ID) of the character that received the &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command. </p>
<p>
<b>Name</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string value identifying the name (ID) of the command.</p>
<p>
<b>Confidence</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Long integer value indicating the confidence scoring for the command. </p>
<p>
<b>Voice</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string value identifying the voice text for the command.</p>
<p>
<b>Alt1Name</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string value identifying the name of the next (second) best command.</p>
<p>
<b>Alt1Confidence</b>&nbsp;&nbsp;&nbsp;&nbsp;A Long integer value indicating the confidence scoring for the next (second) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best command.</p>
<p>
<b>Alt1Voice</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string value identifying the voice text for the next best alternative command &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match.</p>
<p>
<b>Alt2Name</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string value identifying the name of third best command match.</p>
<p>
<b>Alt2Confidence</b>&nbsp;&nbsp;&nbsp;&nbsp;A Long integer identifying the confidence scoring for the third best command &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match.</p>
<p>
<b>Alt2Voice</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string value identifying the voice text for the third best command match.</p>
<p>
<b>Count</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Long integer value indicating the number of alternatives returned.</p>
</td>
</tr>
</table><br>
<p>
</p>
<h4>Remarks</h4>
<p>
The server notifies you with this event when your application is input-active and the user chooses a command you defined to appear in the Commands Window or character's pop-up menu. The event passes back the number of possible matching commands in <b>Count</b> as well as the name, confidence scoring, and voice text for those matches.</p>
<p>
If voice input triggers this event, the server returns a string that identifies the best match in the <b>Name</b> parameter, and the second- and third-best match in <b>Alt1Name</b> and <b>Alt2Name</b>. An empty string indicates that the input did not match any command your application defined; for example, it could be one of the server's defined commands. It is also possible that you may get the same command name returned in more than one entry. <b>Confidence</b>, <b>Alt1Confidence</b>, and <b>Alt2Confidence</b> parameters return the relative scores, in the range of -100 to 100, that are returned by the speech recognition engine for each respective match. <b>Voice</b>, <b>Alt1Voice</b>, and <b>Alt2Voice</b> parameters return the voice text that the speech recognition engine matched for each alternative. If <b>Count</b> returns zero (0), the server detected spoken input, but determined that there was no matching command. </p>
<p>
If voice input was not the source for the command, for example, if the user selected the command from the character's pop-up menu, the server returns the name (ID) of the command selected in the <b>Name </b>property. It also returns the value of the <b>Confidence</b> parameter as 100, and the value of the <b>Voice</b> parameters as the empty string (""). <b>Alt1Name</b> and <b>Alt2Name</b> also return empty strings. <b>Alt1Confidence</b> and <b>Alt2Confidence</b> return zero (0), and <b>Alt1Voice </b>and <b>Alt2Voice</b> return empty strings. <b>Count</b> returns 1.</p>
<p>
<b>Note</b>The Microsoft Command and Control speech recognition engine supports returning values in the parameters of this event. If you use Microsoft Agent with another speech engine, check with the supplier to determine whether their engine supports the Microsoft Speech API interface for returning alternatives and confidence scores.</p>
<p>
--------------------------------------------------------</p>
<p>&nbsp;</p></body>
</HTML>
