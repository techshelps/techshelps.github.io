<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Character Object Methods</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="progagentcontrol2zip_40"></a>Character Object Methods</h2>
<p>
The server also exposes methods for each character in a <b>Characters</b> collection. The following methods are supported:</p>
<p>
<b>Activate, GestureAt</b>, <b>Get</b>, <b>Hide</b>, <b>Interrupt</b>, <b>MoveTo</b>, <b>Play</b>, <b>Show</b>, <b>Speak</b>, <b>Stop</b>, <b>StopAll</b>, <b>Wait</b></p>
<p>
To use a method, reference the character in the collection. In VBScript and Visual Basic, you do this by specifying the ID for a character: </p>
<pre><code>    Sub FormLoad

    'Load the genie character into the Characters collection
    Agent1.Characters.Load "Genie", _
        "C:\Program Files\Microsoft Agent\Characters\Genie.acs"

    'Display the character
    Agent1.Characters("Genie").Show
    Agent1.Characters("Genie").Play "Greet"
    Agent1.Characters("Genie").Speak "Hello. "

    End Sub
</code></pre>
<p>
To simplify the syntax of your code, you can define an object variable and set it to reference a character object in the <b>Characters</b> collection; then you can use your variable to reference methods or properties of the character. The following example demonstrates how you can do this using the Visual Basic Set statement:</p>
<pre><code>    'Define a global object variable
    Dim Genie as Object

    Sub FormLoad

    'Load the genie character into the Characters collection
    Agent1.Characters.Load "Genie", _
        "C:\Program Files\Microsoft Agent\Characters\Genie.acs"

    'Create a reference to the character
    Set Genie = Agent1.Characters("Genie")

    'Display the character
    Genie.Show

    'Get the Restpose animation
    Genie.Get "animation", "RestPose"

    'Make the character say Hello
    Genie.Speak "Hello."

    End Sub

</code></pre>
<p>
In Visual Basic 5.0, you can also create your reference by declaring your variable as a <b>Character </b>object: </p>
<pre><code>    Dim Genie as IAgentCtlCharacter

    Sub FormLoad

    'Load the genie character into the Characters collection
    Agent1.Characters.Load "Genie", _
        "C:\Program Files\Microsoft Agent\Characters\Genie.acs"

    'Create a reference to the character
    Set Genie = Agent1.Characters("Genie")

    'Display the character
    Genie.Show

    End Sub
</code></pre>
<p>
Declaring your object of type <b>IAgentCtlCharacter</b> enables early binding on the object, which results in better performance.</p>
<p>
In VBScript, you cannot declare a reference as a particular type. However, you can simply declare the variable reference:</p>
<pre><code>&lt;!</code>—<code>-

    Dim Genie
    
    SUB window_OnLoad
    
    \'Load the character
    AgentCtl.Characters.Load "Genie", _
     "http://agent.microsoft.com/characters/genie/genie.acf"

    'Create an object reference to the character in the collection
    set Genie= AgentCtl.Characters ("Genie")

    'Get the Showing state animation
    Genie.Get "state", "Showing"

</code>    <code>'Display the character</code>
<code>    Genie.Show</code>

<code>    End Sub</code>

<code>--&gt;</code>
<code>    </code>
<code>&lt;/SCRIPT&gt;</code>
</pre>
<p>
Some programming languages do not support collections. However, you can access a <b>Character</b> object's methods with the <b>Character</b> method:</p>
<pre><code>    <i>agent</i>.Characters.Character("<i>CharacterID</i>").<i>method</i>
</code></pre>
<p>
In addition, you can also create a reference to the <b>Character</b> object to make your script code easier to follow:</p>
<pre><code>&lt;SCRIPT LANGUAGE="JScript" FOR="window" EVENT="onLoad()"&gt;
&lt;!--
    
    //Load the character's data
    AgentCtl.Characters.Load ("Genie", _
        "http://agent.microsoft.com/characters/genie/genie.acf");    

    //Create a reference to this object
    Genie = AgentCtl.Characters.Character("Genie");
    
    //Get the Showing state animation
    Genie.Get("state", "Showing");

    //Display the character
    Genie.Show();

--&gt;
&lt;/SCRIPT&gt;

</code></pre>
<p>
--------------------------------------------------------</p>
<p>&nbsp;</p></body>
</HTML>
