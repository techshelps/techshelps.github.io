<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAgentCommands</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="progagentsinterface2zip_12"></a>IAgentCommands</h2>
<p>
The Microsoft Agent server maintains a list of commands that are currently available to the user. This list includes commands that the server defines for general interaction, such as Hide and Microsoft Agent Properties, the list of available (but non-input-active) clients, and the commands defined by the current active client. The first two sets of commands are global commands; that is, they are available at any time, regardless of the input-active client. Client-defined commands are available only when that client is input-active. </p>
<p>
Retrieve an <b>IAgentCommands</b> interface by querying the <b>IAgentCharacter</b> interface for <b>IAgentCommands</b>. Each Microsoft Agent client application can define a collection of commands called a <b>Commands</b> collection. To add a <b>Command</b> to the collection, use the <b>Add</b> or <b>Insert</b> method. Although you can specify a <b>Command's</b> properties using <b>IAgentCommand</b> methods, for optimum code performance, specify all of a <b>Command</b>'s properties in the <b>IAgentCommands::Add</b> or <b>IAgentCommands::Insert</b> methods when initially setting the properties for a new <b>Command</b>. You can use the <b>IAgentCommand</b> methods to query or change the property settings.</p>
<p>
For each <b>Command</b> in the <b>Commands</b> collection, you can determine whether the command appears on the character's pop-up menu, in the Commands Window, in both, or in neither. For example, if you want a command to appear on the pop-up menu for the character, set the command's <b>Caption</b> and <b>Visible</b> properties. To display the command in the <b>Commands</b> Window, set the command's <b>Caption</b> and <b>Voice</b> properties. </p>
<p>
A user can access the individual commands in your Commands collection only when your client application is input-active. Therefore, you will typically want to set the <b>Caption</b> and <b>Voice</b> properties for the <b>Commands</b> collection object as well as for the commands in the collection, because this places an entry for your <b>Commands</b> collection on a character's pop-up menu and in the Commands Window. When the user switches to your client by choosing its entry, the server automatically makes your client input-active and makes the <b>Commands</b> in its collection available. This enables the server to present and accept only the <b>Commands</b> that apply to the current input-active client's context. It also serves to avoid <b>Command</b>-name collisions between clients. </p>
<p>
When a character's pop-up menu is displayed, changes to the properties of a <b>Commands</b> collection or the commands in its collection do not appear until the user redisplays the menu. However, when open, the Commands Window does display changes as they happen.</p>
<p>
<b>IAgentCommands</b> defines an interface that allows applications to add, remove, set, and query properties for a <b>Commands</b> collection. A <b>Commands</b> collection can appear as a command in both the pop-up menu and the Commands Window for a character. To make the <b>Commands</b> collection appear, you must set its <b>Caption</b> property. The following table summarizes how the properties of a <b>Commands</b> collection affect its presentation.</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<td width=16%><b>Caption Property</b></td>
<td width=15%><b>Voice Property </b></td>
<td width=17%><b>Visible Property</b></td>
<td width=23%><b>Appears in <br>
Character's Pop-up Menu</b></td>
<td width=29%><b>Appears in <br>
Commands Window</b></td>
</tr>
<tr valign=top>
<td width=16%>Yes</td>
<td width=15%>Yes</td>
<td width=17%>True</td>
<td width=23%>Yes</td>
<td width=29%>Yes</td>
</tr>
<tr valign=top>
<td width=16%>Yes</td>
<td width=15%>Yes</td>
<td width=17%>False</td>
<td width=23%>No</td>
<td width=29%>Yes</td>
</tr>
<tr valign=top>
<td width=16%>Yes</td>
<td width=15%>No</td>
<td width=17%>True</td>
<td width=23%>Yes</td>
<td width=29%>No</td>
</tr>
<tr valign=top>
<td width=16%>Yes</td>
<td width=15%>No</td>
<td width=17%>False</td>
<td width=23%>No</td>
<td width=29%>No</td>
</tr>
<tr valign=top>
<td width=16%>No</td>
<td width=15%>Yes</td>
<td width=17%>True</td>
<td width=23%>No</td>
<td width=29%>No<sup>*</sup></td>
</tr>
<tr valign=top>
<td width=16%>No</td>
<td width=15%>Yes</td>
<td width=17%>False</td>
<td width=23%>No</td>
<td width=29%>No<sup>*</sup></td>
</tr>
<tr valign=top>
<td width=16%>No</td>
<td width=15%>No</td>
<td width=17%>True</td>
<td width=23%>No</td>
<td width=29%>No</td>
</tr>
<tr valign=top>
<td width=16%>No</td>
<td width=15%>No</td>
<td width=17%>False</td>
<td width=23%>No</td>
<td width=29%>No</td>
</tr>
</table><br>
<p>
<sup>*</sup>The command is still voice-accessible. If the client is input-active and has <b>Commands</b> in its collection, "(command undefined)" appears in the Commands Window.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=31%><b>IAgentCommands Methods</b></td>
<td width=69%>Description</td>
</tr>
<tr valign=top>
<td width=31%><b>GetCommand</b></td>
<td width=69%>Retrieves a <b>Command</b> object from the <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetCount</b></td>
<td width=69%>Returns the value of the number of <b>Commands</b> in a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetCaption</b></td>
<td width=69%>Sets the value of the <b>Caption</b> property for a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetCaption</b></td>
<td width=69%>Returns the value of the <b>Caption</b> property of a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetVoice</b></td>
<td width=69%>Sets the value of the <b>Voice</b> property for a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetVoice</b></td>
<td width=69%>Returns the value of the <b>Voice</b> property of a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetVisible</b></td>
<td width=69%>Sets the value of the <b>Visible</b> property for a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetVisible</b></td>
<td width=69%>Returns the value of the <b>Visible</b> property of a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>Add</b></td>
<td width=69%>Adds a <b>Command</b> object to a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>Insert</b></td>
<td width=69%>Inserts a <b>Command</b> object in a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>Remove</b></td>
<td width=69%>Removes a <b>Command</b> object in a <b>Commands</b> collection.</td>
</tr>
<tr valign=top>
<td width=31%><b>RemoveAll</b></td>
<td width=69%>Removes all <b>Command</b> objects from a <b>Commands</b> collection.</td>
</tr>
</table><br>
<p>
<b>IAgentCommands::Add</b></p>
<pre><code>HRESULT Add(
   BSTR bszCaption,  // Caption setting for Command
   BSTR bszVoice,    // Voice setting for Command
   long bEnabled,    // Enabled setting for Command
   long bVisible,    // Visible setting for Command
   long * pdwID      // address for variable for ID
);
</code></pre>
<p>
Adds a <b>Command</b> to a <b>Commands</b> collection.
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bszCaption</i></p>
<p class=indent1>
A BSTR that specifies the value of the <b>Caption</b> text displayed for a <b>Command</b> in a <b>Commands</b> collection.</p>
<p>
<i>bszVoice</i></p>
<p class=indent1>
A BSTR that specifies the value of the <b>Voice</b> text setting for a <b>Command</b> in a <b>Commands</b> collection.</p>
<p>
<i>bEnabled</i></p>
<p class=indent1>
A Boolean expression that specifies the <b>Enabled</b> setting for a <b>Command</b> in a <b>Commands</b> collection. If the parameter is TRUE, the <b>Command</b> is enabled and can be selected; if FALSE, the <b>Command</b> is disabled.</p>
<p>
<i>bVisible</i></p>
<p class=indent1>
A Boolean expression that specifies the <b>Visible</b> setting for a <b>Command</b> in a <b>Commands</b> collection. If the parameter is TRUE, the <b>Command</b> will be visible in the character's pop-up menu (if the <b>Caption</b> property is also set).</p>
<p>
<i>pdwID </i></p>
<p class=indent1>
Address of a variable that receives the ID for the added <b>Command</b>.</p>
<p>
See also <b>IAgentCommand::SetCaption</b>, <b>IAgentCommand::SetEnabled</b>, <b>IAgentCommand::SetVisible</b>, <b>IAgentCommand::SetVoice</b>, <b>IAgentCommands::Insert</b>, <b>IAgentCommands::Remove</b>, <b>IAgentCommands::RemoveAll</b></p>
<p>
</p>
<p>
<b>IAgentCommands::GetCaption</b></p>
<pre><code>HRESULT GetCaption(
   BSTR * pbszCaption  // address of Caption text for Commands collection
);
</code></pre>
<p>
Retrieves the <b>Caption</b> for a <b>Commands</b> collection.
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pbszCaption</i></p>
<p class=indent1>
The address of a BSTR that receives the value of the <b>Caption</b> text setting displayed for a <b>Commands</b> collection.</p>
<p>
See also <b>IAgentCommands::SetCaption</b>, <b>IAgentCommands::GetVisible</b>, <b>IAgentCommands::GetVoice</b></p>
<p>
</p>
<p>
<b>IAgentCommands::GetCommand</b></p>
<pre><code>HRESULT GetCommand(
   long dwCommandID,         // Command ID
   IUnknown ** ppunkCommand  // address of IUnknown interface
);                    
</code></pre>
<p>
Retrieves a <b>Command</b> object from the <b>Commands</b> collection.
<ul>
<li>
Returns S_OK to indicate the operation was successful. </li>
</ul>
<p>
<i>dwCommandID</i></p>
<p class=indent1>
The ID of a Command object in the <b>Commands</b> collection.</p>
<p>
<i>IUnknown</i></p>
<p class=indent1>
The address of the <b>IUnknown</b> interface for the <b>Command</b> object.</p>
<p>
See also <b>IAgentCommand</b></p>
<p>
</p>
<p>
<b>IAgentCommands::GetCount</b></p>
<pre><code>HRESULT GetCount(
   long * pdwCount  // address of count of commands
);                    
</code></pre>
<p>
Retrieves the number of <b>Command</b> objects in a <b>Commands</b> collection.
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pdwCount</i></p>
<p class=indent1>
Address of a variable that receives the number of <b>Commands</b> in a <b>Commands</b> collection.</p>
<p>
<i>pdwCount</i> includes only the number of <b>Commands</b> you define in your <b>Commands</b> collection. Server or other client entries are not included.</p>
<p>
</p>
<p>
<b>IAgentCommands::GetVisible</b></p>
<pre><code>HRESULT GetVisible(
   long * pbVisible  // address of Visible setting for Commands collection
);
</code></pre>
<p>
Retrieves the value of the <b>Visible</b> property for a <b>Commands</b> collection.
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pbVisible</i></p>
<p class=indent1>
The address of a variable that receives the value of the <b>Visible</b> property for a <b>Commands</b> collection.</p>
<p>
See also <b>IAgentCommands::SetVisible</b>, <b>IAgentCommands::SetCaption</b></p>
<p>
</p>
<p>
<b>IAgentCommands::GetVoice</b></p>
<pre><code>HRESULT GetVoice(
   BSTR * pbszVoice  // address of Voice setting for Commands collection
);
</code></pre>
<p>
Retrieves the value of the <b>Voice</b> property for a <b>Commands</b> collection. 
<ul>
<li>
Returns S_OK to indicate the operation was successful. </li>
</ul>
<p>
<i>pbszVoice</i></p>
<p class=indent1>
The address of a BSTR that receives the value of the <b>Voice</b> text setting for a <b>Commands</b> collection.</p>
<p>
See also <b>IAgentCommands::SetVoice</b>, <b>IAgentCommands::GetCaption</b>, <b>IAgentCommands::GetVisible</b></p>
<p>
</p>
<p>
<b>IAgentCommands::Insert</b></p>
<pre><code>HRESULT Insert(
   BSTR bszCaption,  // Caption setting for Command
   BSTR bszVoice,    // Voice setting for Command
   long bEnabled,    // Enabled setting for Command
   long bVisible,    // Visible setting for Command
   long dwRefID,     // reference Command for insertion
   long dBefore,     // insertion position flag
   long * pdwID      // address for variable for Command ID
);
</code></pre>
<p>
Inserts a <b>Command</b> object in a <b>Commands</b> collection.
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bszCaption</i></p>
<p class=indent1>
A BSTR that specifies the value of the <b>Caption</b> text displayed for the <b>Command</b>.</p>
<p>
<i>bszVoice</i></p>
<p class=indent1>
A BSTR that specifies the value of the <b>Voice</b> text setting for a <b>Command</b>.</p>
<p>
<i>bEnabled</i></p>
<p class=indent1>
A Boolean expression that specifies the <b>Enabled</b> setting for a <b>Command</b>. If the parameter is TRUE, the <b>Command</b> is enabled and can be selected; if FALSE, the <b>Command</b> is disabled.</p>
<p>
<i>bVisible</i></p>
<p class=indent1>
A Boolean expression that specifies the <b>Visible</b> setting for a <b>Command</b>. If the parameter is TRUE, the <b>Command</b> will be visible in the character's pop-up menu (if the <b>Caption</b> property is also set).</p>
<p>
<i>dwRefID</i></p>
<p class=indent1>
The ID of a <b>Command</b> used as a reference for the relative insertion of the new <b>Command</b>.</p>
<p>
<i>dBefore</i></p>
<p class=indent1>
A Boolean expression that specifies where to place the <b>Command</b>. If this parameter is TRUE, the new <b>Command</b> is inserted before the referenced <b>Command</b>; if FALSE, the new <b>Command</b> is placed after the referenced <b>Command</b>.</p>
<p>
<i>pdwID </i></p>
<p class=indent1>
Address of a variable that receives the ID for the inserted <b>Command</b>.</p>
<p>
See also <b>IAgentCommand::Add</b>, <b>IAgentCommands::Remove</b>, <b>IAgentCommands::RemoveAll</b></p>
<p>
</p>
<p>
<b>IAgentCommands::Remove</b></p>
<pre><code>HRESULT Remove(
   long dwID  // Command ID
);
</code></pre>
<p>
Removes the specified <b>Command</b> from a <b>Commands</b> collection. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>dwID</i></p>
<p class=indent1>
The ID of a <b>Command</b> to remove from the <b>Commands</b> collection. </p>
<p>
Removing a <b>Command</b> from a <b>Commands</b> collection also removes it from the pop-up menu and the Commands Window when your application is input-active.</p>
<p>
See also <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b>, <b>IAgentCommands::RemoveAll</b></p>
<p>
</p>
<p>
<b>IAgentCommands::RemoveAll</b></p>
<pre><code>HRESULT Remove();
</code></pre>
<p>
Removes all <b>Commands</b> from a <b>Commands</b> collection. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
Removing all <b>Commands</b> from a <b>Commands</b> collection also removes them from the pop-up menu and the Commands Window when your application is input-active. <b>RemoveAll</b> does not remove server or other client's entries.</p>
<p>
See also <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b>, <b>IAgentCommands::Remove</b></p>
<p>
</p>
<p>
<b>IAgentCommands::SetCaption</b></p>
<pre><code>HRESULT SetCaption(
   BSTR bszCaption  // Caption setting for Commands collection
);
</code></pre>
<p>
Sets the <b>Caption</b> text displayed for a <b>Commands</b> collection. 
<ul>
<li>
Returns S_OK to indicate the operation was successful. </li>
</ul>
<p>
<i>bszCaption</i></p>
<p class=indent1>
A BSTR that specifies the value for the <b>Caption</b> property for a <b>Commands</b> collection.</p>
<p>
A <b>Commands</b> collection with its <b>Caption</b> property set and its <b>Visible</b> property set to TRUE appears in the character's pop-up menu. If its <b>Voice</b> property is also set, it appears in the Commands Window. If you define commands for a <b>Commands</b> collection that have their <b>Caption</b>, <b>Enabled</b>, and <b>Voice</b> properties set, you typically also define <b>Caption</b> and <b>Voice</b> settings for the associated <b>Commands</b> collection. If the <b>Commands</b> collection has no <b>Voice</b> or no <b>Caption</b> setting and is currently input-active, but the <b>Commands</b> in its collection have <b>Caption</b> and <b>Voice</b> settings, the <b>Commands</b> appear in the <b>Commands</b> Window tree view under "(undefined command)" when your client application becomes input-active.</p>
<p>
See also <b>IAgentCommands::GetCaption</b>, <b>IAgentCommands::SetVisible</b>, <b>IAgentCommands::SetVoice</b></p>
<p>
</p>
<p>
<b>IAgentCommands::SetVisible</b></p>
<pre><code>HRESULT SetVisible(
   long bVisible  // the Visible setting for Commands collection
);
</code></pre>
<p>
Sets the value of the <b>Visible</b> property for a <b>Commands</b> collection. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bVisible</i></p>
<p class=indent1>
A Boolean value that determines the <b>Visible</b> property of a <b>Commands</b> collection. TRUE sets the <b>Commands</b> collection's <b>Caption</b> to be visible when the character's pop-up menu is displayed; FALSE does not display it.</p>
<p>
A <b>Commands</b> collection must have its <b>Caption</b> property set and its <b>Visible</b> property set to TRUE to appear on the character's pop-up menu. The <b>Visible</b> property must also be set to TRUE for commands in the collection to appear when your client application is input-active.</p>
<p>
See also <b>IAgentCommands::GetVisible</b>, <b>IAgent::SetCaption</b></p>
<p>
</p>
<p>
<b>IAgentCommands::SetVoice</b></p>
<pre><code>HRESULT SetVoice(
   BSTR bszVoice  // the Voice setting for Command collection
);
</code></pre>
<p>
Sets the <b>Voice</b> text property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bszVoice</i></p>
<p class=indent1>
A BSTR that specifies the value for the <b>Voice</b> text property of a <b>Commands</b> collection.</p>
<p>
A <b>Commands</b> collection must have its <b>Voice</b> text property set to be voice-accessible. It also must have its <b>Caption</b> property set to appear in the Commands Window and its <b>Visible</b> property set to TRUE to appear on the character's pop-up menu.</p>
<p>
The BSTR expression you supply can include square bracket characters ([ ]) to indicate optional words and vertical bar characters (|) to indicate alternative strings. Alternates must be enclosed in parentheses. For example, "(hello [there] | hi)" tells the speech engine to accept "hello," "hello there," or "hi" for the command. Remember to include appropriate spaces between words you include in brackets or parentheses as well as other text. Remember to include appropriate spaces between the text that's in brackets or parentheses and the text that's not in brackets or parentheses.</p>
<p>
You can also use an ellipsis (…) to support <i>word spotting</i>, that is, telling the speech recognition engine to ignore words spoken in this position in the phrase (sometimes called <i>garbage</i> words). When you use ellipses, the speech engine recognizes only specific words in the string regardless of when spoken with adjacent words or phrases. For example, if you set this property to "…check mail…" the speech recognition engine will match phrases like "please check mail" or "check mail please" to this command. Ellipses can be used anywhere within a string. However, be careful using this technique as voice settings with ellipses may increase the potential of unwanted matches. </p>
<p>
When defining the words and grammar for your command, always make sure that you include at least one word that is required; that is, avoid supplying only optional words. In addition, make sure that the word includes only pronounceable words and letters. For numbers, it is better to spell out the word rather than using the numeric representation. Also, omit any punctuation or symbols. For example, instead of "the #1 $10 pizza!", use "the number one ten dollar pizza". Including non-pronounceable characters or symbols for one command may cause the speech engine to fail to compile the grammar for all your commands. Finally, make your voice parameter as distinct as reasonably possible from other voice commands you define. The greater the similarity between the voice grammar for commands, the more likely the speech engine will make a recognition error. You can also use the confidence scores to better distinguish between two commands that may have similar or similar-sounding voice grammar.</p>
<p>
The operation of this property depends on the state of Microsoft Agent server's speech recognition state. For example, if speech recognition is disabled or not installed, this function has no immediate effect. If speech recognition is enabled during a session, however, the command will become accessible when its client application is input-active.</p>
<p>
See also <b>IAgentCommands::GetVoice</b>, <b>IAgentCommands::SetCaption</b>, <b>IAgentCommands::SetVisible</b></p>
<p>&nbsp;</p></body>
</HTML>
