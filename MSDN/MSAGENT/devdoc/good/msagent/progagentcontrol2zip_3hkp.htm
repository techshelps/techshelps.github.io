<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Speak Method</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="progagentcontrol2zip_49"></a>Speak Method</h2>
<h4>Description</h4>
<p>
Speaks the specified text for the specified character. </p>
<h4>Syntax </h4>
<p>
<i>agent</i><b>.Characters ("</b><i>CharacterID</i><b>").Speak</b> [<i>Text</i>] [, <i>Url</i>]</p>
<p>
</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=22%><b>Part</b></td>
<td width=78%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%><i>Text</i></td>
<td width=78%>Optional. A string that specifies what the character says.</td>
</tr>
<tr valign=top>
<td width=22%><i>Url</i></td>
<td width=78%>Optional. A string expression specifying the specification for an audio file. The specification can be a file specification or URL.</td>
</tr>
</table><br>
<p>
</p>
<h4>Remarks</h4>
<p>
Although the <i>Text</i> and <i>Url</i> parameters are optional, one of them must be supplied. To use this method with a character configured to speak only in its word balloon or using a text-to-speech (TTS) engine, simply provide the <i>Text</i> parameter. Include a space between words to define appropriate word breaks in the word balloon, even for languages that do not traditionally include spaces.</p>
<p>
You can also include vertical bar characters (|) in the <i>Text</i> parameter to designate alternative strings, so that the server randomly chooses a different string each time it processes the method.</p>
<p>
Character support of TTS output is defined when the character is compiled using the Microsoft Agent Character Editor. To generate TTS output, a compatible TTS engine must already be installed before calling this method. For further information, see Accessing Speech Support for Microsoft Agent.</p>
<p>
If you use recorded sound-file output for the character, specify the file's location in the <i>Url</i> parameter. However, if you are using the HTTP protocol to access character or animation data, use the <b>Get</b> method to load the animation before calling the <b>Speak</b> method. When doing so, you still use the <i>Text</i> parameter to specify the words that appear in the character's word balloon. However, if you specify a linguistically enhanced sound file (.LWV) for the <i>Url</i> parameter and do not specify text for the word balloon, the <i>Text</i> parameter uses the text stored in the file. </p>
<p>
You can also vary parameters of the speech output with special tags that you include in the <i>Text</i> parameter. For more information, see Speech Output Tags. If you declare an object reference and set it to this method, it returns a <b>Request</b> object. In addition, if the file has not been loaded, the server sets the <b>Request</b> object's <b>Status</b> property to "failed" with an appropriate error code number. </p>
<p>
The <b>Speak</b> method uses the last action played to determine which speaking animation to play. For example, if you preceded the <b>Speak</b> command with a <b>Play</b> "<b>GestureRight</b>", the server will play <b>GestureRight</b> and then the <b>GestureRight</b> speaking animation. </p>
<p>
If you call <b>Speak</b> and the audio channel is busy, the character's audio output will not be heard, but the text will display in the word balloon.</p>
<p>
<b>Note</b>The word balloon's <b>Enabled</b> property must also be <b>True</b> for text to display.<b> </b></p>
<p>
<b>Note</b>If you are using a character that you did not compile, check the balloon <b>FontName</b> and <b>CharSet</b> properties for the character to determine whether they are appropriate for your locale. You may need to set these values before using the <b>Speak</b> method to ensure appropriate text display within the word balloon. </p>
<p>
--------------------------------------------------------</p>
<p>&nbsp;</p></body>
</HTML>
