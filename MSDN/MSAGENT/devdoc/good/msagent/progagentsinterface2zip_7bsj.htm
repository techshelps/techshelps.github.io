<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAgentCommand</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="progagentsinterface2zip_13"></a>IAgentCommand</h2>
<p>
A <b>Command</b> object is an item in a <b>Commands</b> collection. The server provides the user access to your commands your client application becomes input active. To retrieve a <b>Command</b>, call <b>IAgentCommands::GetCommand</b>.</p>
<p>
<b>IAgentCommand</b> defines an interface that allows applications to set and query properties for <b>Command</b> objects that can appear in a character's pop-up menu and in the Commands Window. A <b>Command</b> object is an item in a <b>Commands</b> collection. The server provides the user access to your commands when your client application becomes input active.</p>
<p>
A <b>Command</b> may appear in either or both the character's pop-up menu and the Commands Window. To appear in the pop-up menu, it must have a <b>Caption</b> and have the <b>Visible</b> property set to TRUE. The <b>Visible</b> property for its <b>Commands</b> collection object must also be set to TRUE for the command to appear in the pop-up menu when your client application is input-active. To appear in the Commands Window, a <b>Command</b> must have its <b>Caption</b> and <b>Voice</b> properties set. </p>
<p>
A character's pop-up menu entries do not change while the menu is displayed. If you add or remove Commands or change their properties while the character's popup menu is displayed, the menu displays those changes when redisplayed. However, the Commands Window does display changes as you make them.</p>
<p>
The following table summarizes how the properties of a command affect its presentation.</p>
<table cellspacing=4 cols=6>
<tr valign=top>
<td width=13%><b>Caption Property</b></td>
<td width=14%><b>Voice Property </b></td>
<td width=13%><b>Visible Property</b></td>
<td width=17%><b>Enabled Property</b></td>
<td width=21%><b>Appears in Character's Pop-up Menu</b></td>
<td width=22%><b>Appears in Commands Window</b></td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>Yes</td>
<td width=13%>True</td>
<td width=17%>True</td>
<td width=21%>Normal</td>
<td width=22%>Yes</td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>Yes</td>
<td width=13%>True</td>
<td width=17%>False</td>
<td width=21%>Disabled</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>Yes</td>
<td width=13%>False</td>
<td width=17%>True</td>
<td width=21%>Does not appear</td>
<td width=22%>Yes</td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>Yes</td>
<td width=13%>False</td>
<td width=17%>False</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>No</td>
<td width=13%>True</td>
<td width=17%>True</td>
<td width=21%>Normal</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>No</td>
<td width=13%>True</td>
<td width=17%>False</td>
<td width=21%>Disabled</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>No</td>
<td width=13%>False</td>
<td width=17%>True</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>Yes</td>
<td width=14%>No</td>
<td width=13%>False</td>
<td width=17%>False</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>Yes</td>
<td width=13%>True </td>
<td width=17%>True</td>
<td width=21%>Does not appear</td>
<td width=22%>No<sup>*</sup></td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>Yes</td>
<td width=13%>True</td>
<td width=17%>False</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>Yes</td>
<td width=13%>False</td>
<td width=17%>True</td>
<td width=21%>Does not appear</td>
<td width=22%>No<sup>*</sup></td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>Yes</td>
<td width=13%>False</td>
<td width=17%>False</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>No</td>
<td width=13%>True</td>
<td width=17%>True</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>No</td>
<td width=13%>True</td>
<td width=17%>False</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>No</td>
<td width=13%>False</td>
<td width=17%>True</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
<tr valign=top>
<td width=13%>No</td>
<td width=14%>No</td>
<td width=13%>False</td>
<td width=17%>False</td>
<td width=21%>Does not appear</td>
<td width=22%>No</td>
</tr>
</table><br>
<p>
<sup>*</sup>The command is still voice-accessible.</p>
<p>
Generally, if you define a <b>Command</b> with a <b>Voice</b> setting, you also define <b>Caption</b> and <b>Voice</b> settings for its associated <b>Commands</b> collection. If the <b>Commands</b> collection for a set of commands has no <b>Voice</b> or no <b>Caption</b> setting and is currently input-active, but the <b>Commands</b> have <b>Caption</b> and <b>Voice</b> settings, the <b>Commands</b> appear in the Commands Window tree view under "(undefined command)" when your client application becomes input-active. </p>
<p>
When the server receives input that matches one of the <b>Command</b> objects you defined for your <b>Commands</b> collection, it sends a <b>IAgentNotifySink::Command</b> event, and passes back the ID of the command as an attribute of the <b>IAgentUserInput</b> object. You can then use conditional statements to match and process the command.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=31%><b>IAgentCommand Methods</b></td>
<td width=69%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=31%><b>SetCaption</b></td>
<td width=69%>Sets the value for the <b>Caption</b> for a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetCaption</b></td>
<td width=69%>Returns the value of the <b>Caption</b> property of a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetVoice</b></td>
<td width=69%>Sets the value for the <b>Voice</b> text for a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetVoice</b></td>
<td width=69%>Returns the value of the <b>Caption</b> property of a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetEnabled</b></td>
<td width=69%>Sets the value of the <b>Enabled</b> property for a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetEnabled</b></td>
<td width=69%>Returns the value of the <b>Enabled</b> property of a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetVisible</b></td>
<td width=69%>Sets the value of the <b>Visible</b> property for a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetVisible</b></td>
<td width=69%>Returns the value of the <b>Visible</b> property of a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetConfidenceThreshold </b></td>
<td width=69%>Sets the value of the <b>Confidence</b> property for a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetConfidenceThreshold</b></td>
<td width=69%>Returns the value of the <b>Confidence</b> property of a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>SetConfidenceText</b></td>
<td width=69%>Sets the value of the <b>ConfidenceText</b> property for a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetConfidenceText</b></td>
<td width=69%>Returns the value of the <b>ConfidenceText</b> property of a <b>Command</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>GetID </b></td>
<td width=69%>Returns the ID of a <b>Command</b> object.</td>
</tr>
</table><br>
<p>
<b>IAgentCommand::GetCaption</b></p>
<pre><code>HRESULT GetCaption(
   BSTR * pbszCaption  // address of Caption for Command
);
</code></pre>
<p>
Retrieves the <b>Caption</b> for a <b>Command</b>.
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pbszCaption</i></p>
<p class=indent1>
The address of a BSTR that receives the value of the <b>Caption</b> text displayed for a <b>Command</b>.</p>
<p>
See also <b>IAgentCommand::SetCaption</b>, <b>IAgentCommand::SetEnabled</b>, <b>IAgentCommand::SetVisible</b>, <b>IAgentCommand::SetVoice</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>
</p>
<p>
<b>IAgentCommand::GetConfidenceText</b></p>
<pre><code>HRESULT GetConfidenceText(
   BSTR * pbszTipText  // address of ConfidenceText setting for Command 
);
</code></pre>
<p>
Retrieves the Listening Tip text previously set for a <b>Command</b>.
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pbszTipText</i></p>
<p>
The address of a BSTR that receives the value of the Listening Tip text for a <b>Command</b>.</p>
<p>
See also<b> IAgentCommand::SetConfidenceThreshold</b>, <b>IAgentCommand::GetConfidenceThreshold</b>, <b>IAgentCommand::SetConfidenceText</b>, <b>IAgentUserInput::GetItemConfidence</b></p>
<p>
</p>
<p>
<b>IAgentCommand::GetConfidenceThreshold</b></p>
<pre><code>HRESULT GetConfidenceThreshold(
long * plConfidenceThreshold  // address of ConfidenceThreshold 
);                            // setting for Command
</code></pre>
<p>
Retrieves the value of the <b>ConfidenceThreshold</b> property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>plConfidenceThreshold</i></p>
<p class=indent1>
The address of a variable that receives the value of the <b>ConfidenceThreshold</b> property for a Command.</p>
<p>
See also <b>IAgentCommand::SetConfidenceThreshold</b>, <b>IAgentCommand::SetConfidenceText</b>, <b>IAgentUserInput::GetItemConfidence</b></p>
<p>
</p>
<p>
<b>IAgentCommand::GetEnabled</b></p>
<pre><code>HRESULT GetEnabled(
   long * pbEnabled  // address of Enabled setting for Command
);
</code></pre>
<p>
Retrieves the value of the <b>Enabled</b> property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pbEnabled</i></p>
<p class=indent1>
The address of a variable that receives TRUE if the <b>Command</b> is enabled, or FALSE if it is disabled. A disabled <b>Command</b> cannot be selected.</p>
<p>
See also <b>IAgentCommand::SetCaption</b>, <b>IAgent::SetVisible</b>, <b>IAgentCommand::SetVoice</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>
</p>
<p>
<b>IAgentCommand::GetID</b></p>
<pre><code>HRESULT GetID(
   long * pdwID  // address of ID for Command
);
</code></pre>
<p>
Retrieves the ID for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pdwID</i></p>
<p class=indent1>
The address of a variable that receives the ID of a <b>Command</b>.</p>
<p>
See also <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b>, <b>IAgentCommands::Remove</b></p>
<p>
</p>
<p>
<b>IAgentCommand::GetVisible</b></p>
<pre><code>HRESULT GetVisible(
   long * pbVisible  // address of Visible setting for Command
);
</code></pre>
<p>
Retrieves the value of the <b>Visible</b> property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pbVisible</i></p>
<p class=indent1>
The address of a variable that receives the <b>Visible</b> property for a <b>Command</b>.</p>
<p>
See also <b>IAgentCommand::SetVisible</b>, <b>IAgent::SetCaption</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>
</p>
<p>
<b>IAgentCommand::GetVoice</b></p>
<pre><code>HRESULT GetVoice(
   BSTR * pbszVoice  // address of Voice setting for Command
);
</code></pre>
<p>
Retrieves the value of the <b>Voice</b> text property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>pbszVoice</i></p>
<p class=indent1>
The address of a BSTR that receives the <b>Voice</b> text property for a <b>Command</b>.</p>
<p>
A <b>Command</b> with its <b>Voice</b> property set and its <b>Enabled</b> property set to TRUE will be voice-accessible. If its <b>Caption</b> property is also set it appears in the Commands Window. If its <b>Visible</b> property is set to TRUE, it appears in the character's pop-up menu.</p>
<p>
See also <b>IAgentCommand::SetVoice</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>
</p>
<p>
<b>IAgentCommand::SetCaption</b></p>
<pre><code>HRESULT SetCaption(
   BSTR bszCaption  // Caption setting for Command
);
</code></pre>
<p>
Sets the <b>Caption</b> text displayed for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bszCaption</i></p>
<p class=indent1>
A BSTR that specifies the text for the <b>Caption</b> property for a <b>Command</b>.</p>
<p>
A <b>Command</b> with its <b>Caption</b> property set and its <b>Visible</b> property set to TRUE appears in the character's pop-up menu. If its <b>Voice</b> property is also set, it appears in the Commands Window. To make it accessible, you must also set its <b>Enabled</b> property to TRUE.</p>
<p>
See also <b>IAgentCommand::GetCaption</b>, <b>IAgentCommand::SetEnabled</b>, <b>IAgentCommand::SetVisible</b>, <b>IAgentCommand::SetVoice</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>
</p>
<p>
<b>IAgentCommand::SetConfidenceThreshold</b></p>
<pre><code>HRESULT SetConfidenceThreshold(
   long lConfidence  // Confidence setting for Command
);
</code></pre>
<p>
Sets the value of the <b>Confidence</b> property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>lConfidence</i></p>
<p class=indent1>
The value for the <b>Confidence</b> property of a <b>Command</b>.</p>
<p>
If the confidence value returned of the best match returned in the <b>Command</b> event does not exceed the value set for the <b>ConfidenceThreshold</b> property, the text supplied in <b>SetConfidenceText</b> is displayed in the Listening Tip.</p>
<p>
See also <b>IAgentCommand::GetConfidenceThreshold</b>, <b>IAgentCommand::SetConfidenceText</b>, <b>IAgentUserInput::GetItemConfidence</b></p>
<p>
</p>
<p>
<b>IAgentCommand::SetConfidenceText</b></p>
<pre><code>HRESULT SetConfidenceText(
   BSTR bszTipText  // ConfidenceText setting for Command 
);
</code></pre>
<p>
Sets the value of the Listening Tip text for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bszTipText</i></p>
<p class=indent1>
A BSTR that specifies the text for the <b>ConfidenceText</b> property of a <b>Command</b>.</p>
<p>
If the confidence value returned of the best match returned in the <b>Command</b> event does not exceed the value set for the <b>ConfidenceThreshold</b> property, the text supplied in <i>bszTipText</i> is displayed in the Listening Tip.</p>
<p>
See also <b>IAgentCommand::SetConfidenceThreshold</b>, <b>IAgentCommand::GetConfidenceThreshold</b>, <b>IAgentCommand::GetConfidenceText</b>, <b>IAgentUserInput::GetItemConfidence</b></p>
<p>
</p>
<p>
<b>IAgentCommand::SetEnabled</b></p>
<pre><code>HRESULT SetEnabled(
   long bEnabled  // Enabled setting for Command
);
</code></pre>
<p>
Sets the <b>Enabled</b> property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bEnabled</i></p>
<p class=indent1>
A Boolean value that sets the value of the <b>Enabled</b> setting of a <b>Command</b>. TRUE enables the <b>Command</b>; FALSE disables it. A disabled <b>Command</b> cannot be selected. </p>
<p>
A <b>Command</b> must have its <b>Enabled</b> property set to TRUE to be selectable. It also must have its <b>Caption</b> property set and its <b>Visible</b> property set to TRUE to appear in the character's pop-up menu. To make the <b>Command</b> appear in the <b>Commands</b> Window, you must set its <b>Voice </b>property.</p>
<p>
See also <b>IAgentCommand::GetCaption</b>, <b>IAgentCommand::SetVoice</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>
</p>
<p>
<b>IAgentCommand::SetVisible</b></p>
<pre><code>HRESULT SetVisible(
   long bVisible  // Visible setting for Command
);
</code></pre>
<p>
Sets the value of the <b>Visible</b> property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bVisible</i></p>
<p class=indent1>
A Boolean value that determines the <b>Visible</b> property of a <b>Command</b>. TRUE shows the <b>Command</b>; FALSE hides it.</p>
<p>
A <b>Command</b> must have its <b>Visible</b> property set to TRUE and its <b>Caption</b> property set to appear in the character's pop-up menu.</p>
<p>
See also <b>IAgentCommand::GetVisible</b>, <b>IAgent::SetCaption</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>
</p>
<p>
<b>IAgentCommand::SetVoice</b></p>
<pre><code>HRESULT SetVoice(
   BSTR bszVoice  // voice text setting for Command
);
</code></pre>
<p>
Sets the <b>Voice</b> property for a <b>Command</b>. 
<ul>
<li>
Returns S_OK to indicate the operation was successful.</li>
</ul>
<p>
<i>bszVoice</i></p>
<p class=indent1>
A BSTR that specifies the text for the <b>Voice</b> property of a <b>Command</b>.</p>
<p>
A <b>Command</b> must have its <b>Voice</b> property and <b>Enabled</b> property set to be voice-accessible. It also must have its <b>Caption</b> property set to appear in the Commands Window.</p>
<p>
The BSTR expression you supply can include square bracket characters ([ ]) to indicate optional words and vertical bar characters (|) to indicate alternative strings. Alternates must be enclosed in parentheses. For example, "(hello [there] | hi)" tells the speech engine to accept "hello," "hello there," or "hi" for the command. Remember to include appropriate spaces between the text that's in brackets or parentheses and the text that's not in brackets or parentheses.</p>
<p>
You can also use an ellipsis (…) to support <i>word spotting</i>, that is, telling the speech recognition engine to ignore words spoken in this position in the phrase (sometimes called <i>garbage</i> words). Therefore, the speech engine recognizes only specific words in the string regardless of when spoken with adjacent words or phrases. For example, if you set this property to "…check mail…" the speech recognition engine will match phrases like "please check mail" or "check mail please" to this command. Ellipses can be used anywhere within a string. However, be careful using this technique, because voice settings with ellipses may increase the potential of unwanted matches. </p>
<p>
When defining the words and grammar for your command, always make sure that you include at least one word that is required; that is, avoid supplying only optional words. In addition, make sure that the word includes only pronounceable words and letters. For numbers, it is better to spell out the word rather than using the numeric representation. Also, omit any punctuation or symbols. For example, instead of "the #1 $10 pizza!", use "the number one ten dollar pizza". Including non-pronounceable characters or symbols for one command may cause the speech engine to fail to compile the grammar for all your commands. Finally, make your voice parameter as distinct as reasonably possible from other voice commands you define. The greater the similarity between the voice grammar for commands, the more likely the speech engine will make a recognition error. You can also use the confidence scores to better distinguish between two commands that may have similar or similar-sounding voice grammar.</p>
<p>
The operation of this property depends on the state of Microsoft Agent server's speech recognition state. For example, if speech recognition is disabled or not installed, this function has no immediate effect. If speech recognition is enabled during a session, however, the command will become accessible when its client application is input-active.</p>
<p>
See also <b>IAgentCommand::GetVoice</b>, <b>IAgentCommand::SetCaption</b>, <b>IAgentCommand::SetEnabled</b>, <b>IAgentCommands::Add</b>, <b>IAgentCommands::Insert</b></p>
<p>&nbsp;</p></body>
</HTML>
