<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeyPress Event</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtkeypress"></a>KeyPress Event</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtKeyPress_C;vbevtKeyPressC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtKeyPress_X;vbevtKeyPressX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtKeyPress_A;vbevtKeyPressA">
</object></p>
<p>
Occurs when the user presses and releases an <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defansi">
</object><a href=JavaScript:alink_4.Click()>ANSI</a> key.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub Form_KeyPress(</b><i>keyascii</i> <b>As Integer)</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_KeyPress(</b>[<i>index</i> <b>As Integer</b>,]<i>keyascii</i> <b>As Integer)</b></p>
<p>
The KeyPress event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=20%><b>Part</b></td>
<td class=label width=80%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=20%><i>object</i></td>
<td width=80%>An <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_5.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=20%><i>index</i></td>
<td width=80%>An integer that uniquely identifies a control if it's in a <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcontrolarray">
</object><a href=JavaScript:alink_6.Click()>control array</a>.</td>
</tr>
<tr valign=top>
<td width=20%><i>keyascii</i></td>
<td width=80%>An integer that returns a standard numeric ANSI keycode. <i>Keyascii</i> is passed by reference; changing it sends a different character to the object. Changing <i>keyascii</i> to 0 cancels the keystroke so the object receives no character.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The object with the <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deffocus">
</object><a href=JavaScript:alink_7.Click()>focus</a> receives the event. A form can receive the event only if it has no visible and enabled controls or if the <b>KeyPreview</b> property is set to <b>True</b>. A KeyPress event can involve any printable keyboard character, the CTRL key combined with a character from the standard alphabet or one of a few special characters, and the ENTER or BACKSPACE key. A KeyPress event procedure is useful for intercepting keystrokes entered in a <b>TextBox</b> or <b>ComboBox</b> control. It enables you to immediately test keystrokes for validity or to format characters as they're typed. Changing the value of the <i>keyascii</i> argument changes the character displayed.</p>
<p>
You can convert the <i>keyascii</i> argument into a character by using the expression:</p>
<pre><code>Chr(KeyAscii)
</code></pre>
<p>
You can then perform string operations and translate the character back to an ANSI number that the control can interpret by using the expression:</p>
<pre><code>KeyAscii = Asc(char)
</code></pre>
<p>
Use KeyDown and KeyUp event procedures to handle any keystroke not recognized by KeyPress, such as <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdeffunctionkey">
</object><a href=JavaScript:alink_8.Click()>function keys</a>, <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdefeditkey">
</object><a href=JavaScript:alink_9.Click()>editing keys</a>, navigation keys, and any combinations of these with keyboard modifiers. Unlike the KeyDown and KeyUp events, KeyPress doesn't indicate the physical state of the keyboard; instead, it passes a character.</p>
<p>
KeyPress interprets the uppercase and lowercase of each character as separate key codes and, therefore, as two separate characters. KeyDown and KeyUp interpret the uppercase and lowercase of each character by means of two arguments: <i>keycode</i>, which indicates the physical key (thus returning A and a as the same key), and <i>shift</i>, which indicates the state of <i>shift</i>+<i>key</i> and therefore returns either A or a.</p>
<p>
If the <b>KeyPreview</b> property is set to <b>True</b>, a form receives the event before controls on the form receive the event. Use the <b>KeyPreview</b> property to create global keyboard-handling routines.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The ANSI number for the keyboard combination of CTRL+@ is 0. Because Visual Basic recognizes a <i>keyascii</i> value of 0 as a zero-length string (""), avoid using CTRL+@ in your applications.</p>
</BODY>
</HTML>
