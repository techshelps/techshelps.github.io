<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetData Method (DataObject Object)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbmthgetdatamethod"></a>GetData Method (DataObject Object)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthGetDataMethod_C;vbmthGetDataMethodC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthGetDataMethod_X;vbmthGetDataMethodX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthGetDataMethod_A;vbmthGetDataMethodA">
</object></p>
<p>
Returns data from a <b>DataObject</b> object in the form of a variant.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>.GetData</b> <b>(</b><i>format</i><b>)</b></p>
<p>
The <b>GetData</b> method syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Part</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><i>object</i></td>
<td width=71%>Required. An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=29%><i>format</i> </td>
<td width=71%>A constant or value that specifies the data format, as described in Settings. Parentheses must enclose the constant or value. If <i>format</i> is 0 or omitted, <b>GetData</b> automatically uses the appropriate format.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>format</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>Constant</b></td>
<td class=label width=18%><b>Value</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFText</b></td>
<td width=18%>1</td>
<td width=49%>Text (.txt files)</td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFBitmap</b></td>
<td width=18%>2</td>
<td width=49%><object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbitmap">
</object><a href=JavaScript:alink_5.Click()>Bitmap</a> (.bmp files)</td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFMetafile</b></td>
<td width=18%>3</td>
<td width=49%><object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defmetafile">
</object><a href=JavaScript:alink_6.Click()>metafile</a> (.wmf files)</td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFEMetafile</b></td>
<td width=18%>14</td>
<td width=49%>Enhanced metafile (.emf files)</td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFDIB</b></td>
<td width=18%>8</td>
<td width=49%>Device-independent bitmap (DIB)</td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFPalette</b></td>
<td width=18%>9</td>
<td width=49%>Color palette</td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFFiles</b></td>
<td width=18%>15</td>
<td width=49%>List of files</td>
</tr>
<tr valign=top>
<td width=33%><b>vbCFRTF</b></td>
<td width=18%>-16639</td>
<td width=49%>Rich text format (.rtf files)</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
These constants are listed in the Visual Basic (VB) <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectlibrary">
</object><a href=JavaScript:alink_7.Click()>object library</a> in the <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectbrowser">
</object><a href=JavaScript:alink_8.Click()>Object Browser</a>.</p>
<p>
It's possible for the <b>GetData</b> and <b>SetData</b> methods to use data formats other than those listed in Settings, including user-defined formats registered with Windows via the <code>RegisterClipboardFormat()</code> API function. However, there are a few caveats:
<ul type=disc>
<li>
The <b>SetData</b> method requires the data to be in the form of a byte array when it does not recognize the data format specified.<br><br></li>
<li>
The <b>GetData</b> method always returns data in a byte array when it is in a format that it doesn't recognize, although Visual Basic can transparently convert this returned byte array into other data types, such as strings.<br><br></li>
<li>
The byte array returned by <b>GetData</b> will be larger than the actual data when running on some operating systems, with arbitrary bytes at the end of the array. The reason for this is that Visual Basic does not know the data's format, and knows only the amount of memory that the operating system has allocated for the data. This allocation of memory is often larger than is actually required for the data. Therefore, there may be extraneous bytes near the end of the allocated memory segment. As a result, you must use appropriate functions to interpret the returned data in a meaningful way (such as truncating a string at a particular length with the <b>Left</b> function if the data is in a text format).</li>
</ul>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Not all applications support <b>vbcfBitmap</b> or <b>vbCFPalette</b>, so it is recommended that you use <b>vbCFDIB</b> whenever possible.</p>
</BODY>
</HTML>
