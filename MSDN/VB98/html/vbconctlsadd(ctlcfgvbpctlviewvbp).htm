<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CtlsAdd (CtlCfg.vbp and CtlView.vbp)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconctlsadd(ctlcfgvbpctlviewvbp)"></a>CtlsAdd (CtlCfg.vbp and CtlView.vbp)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCtlsAdd(CtlCfgvbpCtlViewvbp)_C">
</object></p>
<p>
The two sample applications work together to demonstrate dynamic control addition, or the Add Method for the Controls collection. The first sample, CtlCfg.vbp, adds control license keys to the Controls.mdb database using the Licenses.Add method. The second sample, CtlView, uses the information (license keys) stored in the database to dynamically load controls.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=35%><b>File</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>Controls.mdb</td>
<td width=65%>Access database that holds license key information.</td>
</tr>
<tr valign=top>
<td width=35%>CtlCfg.frm</td>
<td width=65%>Control configuration form.</td>
</tr>
<tr valign=top>
<td width=35%>CtlCfg.frx</td>
<td width=65%>Control configuration binary data.</td>
</tr>
<tr valign=top>
<td width=35%>CtlCfg.vbp</td>
<td width=65%>Control configuration project file.</td>
</tr>
<tr valign=top>
<td width=35%>CtlView.frm</td>
<td width=65%>Control view form.</td>
</tr>
<tr valign=top>
<td width=35%>CtlView.frx</td>
<td width=65%>Control view binary data.</td>
</tr>
<tr valign=top>
<td width=35%>CtlView.vbp</td>
<td width=65%>Control view project file.</td>
</tr>
</table><br>
<h3>To Run</h3>
<p>
First open and run the CtlCfg.vbp project. If you have any user controls (that require license keys), you can add the keys to the database using the application.</p>
<p class=label>
<b>To Add A Control's License Key</b>
<ol>
<li>
Open a second instance of Visual Basic.<br><br></li>
<li>
Add a user control (that requires a license key) to the Toolbox using the Components dialog box.<br><br></li>
<li>
Press F2 to display the Object Browser.<br><br></li>
<li>
In the Object Browser, note the Library and Class name of the control. This is the progID of the control.<br><br></li>
<li>
Switch to the CtlCfg application.<br><br></li>
<li>
On the Edit menu, click <b>New Entry</b>.<br><br></li>
<li>
In the new row, fill in the <b>Description</b> column.<br><br></li>
<li>
In the <b>ControlType</b> column, type the progID of the user control.<br><br></li>
<li>
If there is a property of the control you would like to set, type the property name in the <b>PropertyName</b> column. Then type an appropriate value in the <b>PropertyValue</b> column.<br><br></li>
<li>
In the <b>ControlHeight </b>and <b>ControlWidth </b>columns, type in (optional) values.<br><br></li>
<li>
On the <b>File </b>menu, click <b>Save</b>. The control's license (if it has one) will appear in the <b>ControlLicense </b>column.<br><br></li>
<li>
Close the application.</li>
</ol>
<p>
Open and run the CtlView.vbp project. A grid on the form displays the names of controls that can be dynamically added. Click the control name to add it to the form.</p>
</BODY>
</HTML>
