<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LinkPoke Method Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbmthlinkpokex"></a>LinkPoke Method Example</h1>
<p>
This example establishes a DDE link with Microsoft Excel, places some values into cells in the first row of a new worksheet, and charts the values. <b>LinkPoke</b> sends the values to be charted to the Microsoft Excel worksheet. To try this example, Microsoft Excel must be installed and in the path statement of your Autoexec.bat file. Paste the code into the Declarations section of a form that has a <b>TextBox</b> control with the default name Text1, and then press F5 and click the form.</p>
<pre><code>Private Sub Form_Click ()
   Dim Cmd, I, Q, Row, Z   ' Declare variables.
   Q = Chr(34)   ' Define quotation marks.
   ' Create a string containing Microsoft Excel macro commands.
   Cmd = "[ACTIVATE(" &amp; Q &amp;"SHEET1" &amp; Q &amp; ")]"
   Cmd = Cmd &amp; "[SELECT(" &amp; Q &amp; "R1C1:R5C2" &amp; Q &amp; ")]" 
   Cmd = Cmd &amp; "[NEW(2,1)][ARRANGE.ALL()]"
   If Text1.LinkMode = vbNone Then
      Z = Shell("Excel", 4)   ' Start Microsoft Excel.
      Text1.LinkTopic = "Excel|Sheet1"   ' Set link topic.
      Text1.LinkItem = "R1C1"   ' Set link item.
      Text1.LinkMode = vbLinkManual   ' Set link mode.
   End If
   For I = 1 To 5
      Row = I   ' Define row number.
      Text1.LinkItem = "R" &amp; Row &amp; "C1"   ' Set link item.
      Text1.Text = Chr(64 + I)   ' Put value in Text.
      Text1.<span class=cfe><b>LinkPoke</b></span>   ' Poke value to cell.
      Text1.LinkItem = "R" &amp; Row &amp; "C2"   ' Set link item.
      Text1.Text = Row   ' Put value in Text.
      Text1.<span class=cfe><b>LinkPoke</b></span>   ' Poke value to cell.
   Next I
   Text1.LinkExecute Cmd   ' Carry out Microsoft Excel commands.
   On Error Resume Next
   MsgBox "LinkPoke DDE demo with Microsoft Excel finished.", 64
 End
End Sub
</code></pre>
</BODY>
</HTML>
