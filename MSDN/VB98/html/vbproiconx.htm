<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Icon Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbproiconx"></a>Icon Property Example</h1>
<p>
This example creates a blank icon for a form and draws colored dots on the icon as long as the form is minimized. To try this example, paste the code into the Declarations section of a form, and then press F5 and minimize the form.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This example works only with Windows NT 3.5x.</p>
<pre><code>Private Sub Form_Resize ()
   Dim X, Y   ' Declare variables.
   If Form1.WindowState = vbMinimized Then
      Form1.<span class=cfe><b>Icon</b></span> = LoadPicture()   ' Load a blank icon.
      Do While Form1.WindowState = vbMinimized   
  ' While form is minimized,
         Form1.DrawWidth = 10   ' set size of dot.
         ' Choose random color for dot.
         Form1.ForeColor = QBColor(Int(Rnd * 15))
         ' Set random location on icon.
         X = Form1.Width * Rnd
         Y = Form1.Height * Rnd
         PSet (X, Y)   ' Draw dot on icon.
         DoEvents   ' Allow other events.
      Loop
   End If
End Sub
</code></pre>
<p class=indent>
This is the same example, except that it uses the <b>LoadPicture</b> method to set the <b>Icon</b> property. This example works with all versions of Windows:</p>
<pre><code>Private Sub Form_Resize ()
   Dim X, Y   ' Declare variables.
   If Form1.WindowState = vbMinimized Then
      Form1.<span class=cfe><b>Icon</b></span> = LoadPicture("c:\myicon.ico")
  ' An icon named "myicon.ico" must be in the
  ' c:\ directory for this example to work
  ' correctly.
   End If
End Sub</code></pre>
</BODY>
</HTML>
