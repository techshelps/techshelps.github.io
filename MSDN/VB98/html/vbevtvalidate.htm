<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Validate Event (Data Control)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtvalidate"></a>Validate Event (Data Control)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthAddNew;damthClose;damthDelete;damthEdit;damthUpdate;vbevtValidate_C;vbevtValidateC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daevtValidateX;vbevtValidate_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtValidate_A;vbevtValidateA">
</object></p>
<p>
Occurs before a different record becomes the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcurrentrecord">
</object><a href=JavaScript:alink_4.Click()>current record</a>; before the <b>Update</b> method (except when data is saved with the <b>UpdateRecord</b> method); and before a <b>Delete</b>,<b> Unload</b>, or <b>Close</b> operation.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_Validate (</b>[<b> </b><i>index</i><b> As Integer</b>,]<b> </b><i>action</i><b> As Integer</b>,<b> </b><i>save</i><b> As Integer)</b></p>
<p>
The Validate event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=12%><b>Part</b></td>
<td class=label width=88%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=12%><i>object</i></td>
<td width=88%>An <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_5.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=12%><i>index</i></td>
<td width=88%>Identifies the control if it's in a <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcontrolarray">
</object><a href=JavaScript:alink_6.Click()>control array</a>.</td>
</tr>
<tr valign=top>
<td width=12%><i>action</i></td>
<td width=88%>An integer that indicates the operation causing this event to occur, as described in Settings.</td>
</tr>
<tr valign=top>
<td width=12%><i>save</i></td>
<td width=88%>A <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defboolean">
</object><a href=JavaScript:alink_7.Click()>Boolean expression</a> specifying whether bound data has changed, as described in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>action</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=43%><b>Constant</b></td>
<td class=label width=12%><b>Value</b></td>
<td class=label width=45%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionCancel</b></td>
<td width=12%>0</td>
<td width=45%>Cancel the operation when the <b>Sub</b> exits</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionMoveFirst</b></td>
<td width=12%>1</td>
<td width=45%><b>MoveFirst</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionMovePrevious</b></td>
<td width=12%>2</td>
<td width=45%><b>MovePrevious</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionMoveNext</b></td>
<td width=12%>3</td>
<td width=45%><b>MoveNext</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionMoveLast</b></td>
<td width=12%>4</td>
<td width=45%><b>MoveLast</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionAddNew</b></td>
<td width=12%>5</td>
<td width=45%><b>AddNew</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionUpdate</b></td>
<td width=12%>6</td>
<td width=45%><b>Update</b> operation (not <b>UpdateRecord</b>)</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionDelete</b></td>
<td width=12%>7</td>
<td width=45%><b>Delete</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionFind</b></td>
<td width=12%>8</td>
<td width=45%><b>Find</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionBookmark</b></td>
<td width=12%>9</td>
<td width=45%>The <b>Bookmark</b> property has been set</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionClose</b></td>
<td width=12%>10</td>
<td width=45%>The <b>Close</b> method</td>
</tr>
<tr valign=top>
<td width=43%><b>vbDataActionUnload</b></td>
<td width=12%>11</td>
<td width=45%>The form is being unloaded</td>
</tr>
</table><br>
<p>
The settings for <i>save</i> are:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=46%><b>Setting</b></td>
<td class=label width=54%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=46%><b>True</b></td>
<td width=54%>Bound data has changed</td>
</tr>
<tr valign=top>
<td width=46%><b>False</b></td>
<td width=54%>Bound data has not changed</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
These constants are listed in the Visual Basic (VB) <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectlibrary">
</object><a href=JavaScript:alink_8.Click()>object library</a> in the Object Browser.</p>
<p>
The <i>save</i> argument initially indicates whether bound data has changed. This argument can still be <b>False</b> if data in the copy buffer is changed. If <i>save</i> is <b>True</b> when this event exits, the <b>Edit</b> and <b>UpdateRecord</b> methods are invoked. Only data from <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defboundcontrol">
</object><a href=JavaScript:alink_9.Click()>bound controls</a> or from the copy buffer where the <b>DataChanged</b> property is set to <b>True</b> are saved by the <b>UpdateRecord</b> method.</p>
<p>
This event occurs even if no changes have been made to data in bound controls and even if no bound controls exist. You can use this event to change values and update data. You can also choose to save data or stop whatever action is causing the event to occur and substitute a different action.</p>
<p>
You can change the <i>action</i> argument to convert one action into another. You can change the various Move methods and the <b>AddNew</b> method, which can be freely exchanged (any Move into <b>AddNew</b>, any Move into any other Move, or <b>AddNew</b> into any Move). When using <b>AddNew</b>, you can use <b>MoveNext</b> and then execute another <b>AddNew</b> to examine the <b>EditMode</b> property to determine if an <b>Edit</b> or <b>AddNew</b> operation is in progress. Attempting to change <b>AddNew</b> or one of the Moves into any of the other actions is either ignored or produces a trappable error. Any action can be stopped by setting <i>action</i> to 0.</p>
<p>
In your code for this event, you can check the data in each bound control where <b>DataChanged</b> is <b>True</b>. You can then set <b>DataChanged</b> to <b>False</b> to avoid saving that data in the database.</p>
<p>
You can't use any methods (such as <b>MoveNext</b>) on the underlying <b>Recordset</b> object during this event.</p>
</BODY>
</HTML>
