<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PaintPicture Method</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbmthpaintpicture"></a>PaintPicture Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthPaintPicture_C;vbmthPaintPictureC;vbmthPaintPictureMoveC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthPaintPicture_X;vbmthPaintPictureX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthPaintPicture_A;vbmthPaintPictureA">
</object></p>
<p>
Draws the contents of a graphics file (.bmp, .wmf, .emf, .cur, .ico, or .dib) on a <b>Form</b>, <b>PictureBox</b>, or <b>Printer</b>. Doesn't support <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defnamedarguments">
</object><a href=JavaScript:alink_4.Click()>named arguments</a>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>.PaintPicture </b><i>picture</i>, <i>x1</i>, <i>y1</i>, <i>width1</i>, <i>height1</i>, <i>x2</i>, <i>y2</i>, <i>width2</i>, <i>height2</i>, <i>opcode</i></p>
<p>
The <b>PaintPicture</b> method syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=22%><b>Part</b></td>
<td class=label width=78%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=22%><i>object</i></td>
<td width=78%>Optional. An <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_5.Click()>object expression</a> that evaluates to an object in the Applies To list. If <i>object</i> is omitted, the <b>Form</b> object with the <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deffocus">
</object><a href=JavaScript:alink_6.Click()>focus</a> is assumed to be <i>object</i>.</td>
</tr>
<tr valign=top>
<td width=22%><i>Picture</i></td>
<td width=78%>Required. The source of the graphic to be drawn onto <i>object</i>. Must be the <b>Picture</b> property of a <b>Form</b> or <b>PictureBox</b>.</td>
</tr>
<tr valign=top>
<td width=22%><i>x1</i>, <i>y1</i></td>
<td width=78%>Required. Single-precision values indicating the destination coordinates (x-axis and y-axis) on <i>object</i> for <i>picture</i> to be drawn. The <b>ScaleMode</b> property of <i>object</i> determines the unit of measure used.</td>
</tr>
<tr valign=top>
<td width=22%><i>Width1</i></td>
<td width=78%>Optional. Single-precision value indicating the destination width of <i>picture</i>. The <b>ScaleMode</b> property of <i>object</i> determines the unit of measure used. If the destination width is larger or smaller than the source width (<i>width2</i>), <i>picture</i> is stretched or compressed to fit. If omitted, the source width is used.</td>
</tr>
<tr valign=top>
<td width=22%><i>Height1</i></td>
<td width=78%>Optional. Single-precision value indicating the destination height of <i>picture</i>. The <b>ScaleMode</b> property of <i>object</i> determines the unit of measure used. If the destination height is larger or smaller than the source height (<i>height2</i>), <i>picture</i> is stretched or compressed to fit. If omitted, the source height is used.</td>
</tr>
<tr valign=top>
<td width=22%><i>x2</i>, <i>y2</i></td>
<td width=78%>Optional. Single-precision values indicating the coordinates (x-axis and y-axis) of a clipping region within <i>picture</i>. The <b>ScaleMode</b> property of <i>object</i> determines the unit of measure used. If omitted, 0 is assumed.</td>
</tr>
<tr valign=top>
<td width=22%><i>Width2</i></td>
<td width=78%>Optional. Single-precision value indicating the source width of a clipping region within <i>picture</i>. The <b>ScaleMode</b> property of <i>object</i> determines the unit of measure used. If omitted, the entire source width is used.</td>
</tr>
<tr valign=top>
<td width=22%><i>Height2</i></td>
<td width=78%>Optional. Single-precision value indicating the source height of a clipping region within <i>picture</i>. The <b>ScaleMode</b> property of <i>object</i> determines the unit of measure used. If omitted, the entire source height is used.</td>
</tr>
<tr valign=top>
<td width=22%><i>Opcode</i></td>
<td width=78%>Optional. Long value or code that is used only with <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdefbitmap">
</object><a href=JavaScript:alink_7.Click()>bitmaps</a>. It defines a bit-wise operation (such as <b>vbMergeCopy</b> or <b>vbSrcAnd</b>) that is performed on <i>picture</i> as it's drawn on <i>object</i>. For a complete list of bit-wise operator constants, see the RasterOp Constants topic in Visual Basic Help.<p>
There are some limitations in the usage of opcodes.&nbsp; For example, you can't use any opcode other than <b>vbSrcCopy</b> if the source is an icon or metafile, and the opcodes that interact with the pattern (or "brush" in SDK terms) such as MERGECOPY, PATCOPY, PATPAINT, and PATINVERT actually interact with the <b>FillStyle</b> property of the destination.</p>
<p>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;<i>Opcode</i> is used to pass a bitwise operation on a bitmap. Placing a value in this argument when passing other image types will cause an "Invalid procedure call or argument" error. This is by design. To avoid this error, leave the <i>Opcode</i> argument blank for any image other than a bitmap.</p>
</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
You can flip a bitmap horizontally or vertically by using negative values for the destination height (<i>height1</i>) and/or the destination width (<i>width1</i>).</p>
<p>
You can omit as many optional trailing <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defarg">
</object><a href=JavaScript:alink_8.Click()>arguments</a> as you want. If you omit an optional trailing argument or arguments, don't use any commas following the last argument you specify. If you want to specify an optional argument, you must specify all optional arguments that appear in the <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdefsyntax">
</object><a href=JavaScript:alink_9.Click()>syntax</a> before it.</p>
<p>
Note that there is a difference between loading a .Bmp into a <b>PictureBox</b> control, and using the Windows API function BitBlt() to add a picture to it. When you BitBlt an image, the <b>PictureBox</b> control doesn't know to resize like it does if you use the <b>LoadPicture</b> method. Setting the <b>ScaleWidth</b> and <b>ScaleHeight</b> properties to the size of the image also doesn't work. If you want the <b>PictureBox</b> to resize to the new picture after BitBlt'ing, you must do so manually by code, converting units and dealing with borders. Below is a simple example of how to do this:</p>
<pre><code>Sub ResizePictureBoxToImage(pic as PictureBox, twipWd _
  as Integer, twipHt as Integer)
 ' This code assumes that all units are in twips.&nbsp; If 
 ' not, you must convert it to twips before calling 
 ' this routine.&nbsp; This also assumes that the image 
 ' was blt'ed to 0,0.
 Dim BorderHt as Integer, BorderWd as Integer
 BorderWd = Pic.Width - Pic.ScaleWidth
 BorderHt = Pic.Height - Pic.ScaleHeight
 pic.Move pic.Left, pic.Top, twipWd + BorderWd, _
 &nbsp; twipHt + BorderHt
End Sub
</code></pre>
</BODY>
</HTML>
