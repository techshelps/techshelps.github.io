<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveControl Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbproactivecontrolx"></a>ActiveControl Property Example</h1>
<p>
This example displays the text of the active control. To try this example, paste the code into the Declarations section of a form that contains <b>TextBox</b>, <b>Label</b>, and <b>CommandButton</b> controls, and then press F5 and click the form.</p>
<pre><code>Private Sub Form_Click ()
   If TypeOf Screen.<span class=cfe><b>ActiveControl</b></span> Is TextBox Then
      Label1.Caption = Screen.<span class=cfe><b>ActiveControl</b></span>.Text
   Else
      Label1.Caption = "Button: " + Screen.<span class=cfe><b>ActiveControl</b></span>.Caption
   End If
End Sub
</code></pre>
<p>
This example shows how you can use the <b>Clipboard</b> object in cut, copy, paste, and delete operations using buttons on a toolbar. To try this example, put <b>TextBox</b> and <b>CheckBox</b> controls on Form1, and then create a new MDI form. On the MDI form, insert a <b>PictureBox</b> control, and then insert a <b>CommandButton</b> in the <b>PictureBox</b>. Set the <b>Index</b> property of the <b>CommandButton</b> to 0 (creating a control array). Set the <b>MDIChild</b> property of Form1 to <b>True</b>.</p>
<p>
To run the example, copy the code into the Declarations section of the <b>MDIForm</b>, and then press F5. Notice that when the <b>CheckBox</b> has the focus, the buttons don't work, since the <b>CheckBox</b> is now the active control instead of the <b>TextBox</b>.</p>
<pre><code>Private Sub MDIForm_Load ()
   Dim I   ' Declare variable.
   Command1(0).Move 0, 0, 700, 300   ' Position button on toolbar.
   For I = 1 To 3   ' Create other buttons.
      Load Command1(I)   ' Create button.
      Command1(I).Move I * 700, 0, 700, 300&nbsp; ' Place and size button.
      Command1(I).Visible = True   ' Display button.
   Next I
   Command1(0).Caption = "Cut"   ' Set button captions.
   Command1(1).Caption = "Copy"
   Command1(2).Caption = "Paste"
   Command1(3).Caption = "Del"
End Sub

Private Sub Command1_Click (Index As Integer)
   ' ActiveForm refers to the active form in the MDI form.
   If TypeOf ActiveForm.<span class=cfe><b>ActiveControl</b></span> Is TextBox Then
      Select Case Index
         Case 0   ' Cut.
            ' Copy selected text onto Clipboard.
            Clipboard.SetText ActiveForm.<span class=cfe><b>ActiveControl</b></span>.SelText
            ' Delete selected text.
            ActiveForm.<span class=cfe><b>ActiveControl</b></span>.SelText = ""
         Case 1   ' Copy.
            ' Copy selected text onto Clipboard.
            Clipboard.SetText ActiveForm.<span class=cfe><b>ActiveControl</b></span>.SelText
         Case 2   ' Paste.
            ' Put Clipboard text in text box.
            ActiveForm.<span class=cfe><b>ActiveControl</b></span>.SelText = Clipboard.GetText()
         Case 3   ' Delete.
            ' Delete selected text.
            ActiveForm.<span class=cfe><b>ActiveControl</b></span>.SelText = ""
      End Select
   End If
End Sub
</code></pre>
</BODY>
</HTML>
