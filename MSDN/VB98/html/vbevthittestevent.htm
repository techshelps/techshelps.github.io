<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HitTest Event</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevthittestevent"></a>HitTest Event</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtHitTestEvent_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtHitTestEvent_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtHitTestEvent_A">
</object></p>
<p>
Occurs when the user moves the mouse over a UserControl object. Only occurs when the <b>Windowless</b> property of the UserControl is set to True and the <b>BackStyle</b> property is set to Transparent.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub </b><i>object_</i><b>HitTest(</b><i>x</i><b> As Single, </b><i>y</i><b> As Single, </b><i>HitResult</i><b> As Integer)</b></p>
<p>
The HitTest event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Part</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><i>object</i></td>
<td width=71%>A UserControl object.</td>
</tr>
<tr valign=top>
<td width=29%><i>x, y</i></td>
<td width=71%>A number that specifies the current location of the mouse pointer. The x and y values are always expressed in terms of the coordinate system set by the <b>ScaleHeight</b>, <b>ScaleWidth</b>, <b>ScaleLeft</b>, and <b>ScaleTop</b> properties of the object.</td>
</tr>
<tr valign=top>
<td width=29%><i>HitResult</i></td>
<td width=71%>An integer that specifies hit behavior, as described in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>HitResult</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=24%><b>Constant</b></td>
<td class=label width=25%><b>Setting</b></td>
<td class=label width=51%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=24%><b>vbHitResultOutside</b></td>
<td width=25%>0</td>
<td width=51%>The mouse pointer is outside of the visible area of the control. Mouse messages are forwarded.</td>
</tr>
<tr valign=top>
<td width=24%><b>vbHitResultTransparent</b></td>
<td width=25%>1</td>
<td width=51%>The mouse pointer is over a transparent region of the control. Mouse messages can be forwarded. Must be set at run time.</td>
</tr>
<tr valign=top>
<td width=24%><b>vbHitResultClose</b></td>
<td width=25%>2</td>
<td width=51%>The mouse pointer is close to the visible area of the control. The close region must be defined by the developer at design time. Mouse messages can be forwarded. Must be set at run time.</td>
</tr>
<tr valign=top>
<td width=24%><b>vbHitResultHit</b></td>
<td width=25%>3</td>
<td width=51%>The mouse pointer is over the visible area of the control. The control receives mouse messages.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The HitTest event is used to determine whether a UserControl will receive mouse events such as MouseUp, MouseDown, MouseOver, Click, and DblClick. HitTest occurs before any other mouse messages.</p>
<p>
By default, a UserControl will return a HitResult of 0 when the mouse pointer is over a transparent area of the control, or a HitResult of 3 when over the MaskRegion. The MaskRegion is defined by a combination of the <b>MaskPicture</b> and <b>MaskColor</b> properties.</p>
<p>
In the HitTest event you can change the hit testing behavior of your control by assigning a different value to the HitResult. For example, if you have a UserControl with a transparent area in its center, it’s possible that another control may be visible underneath that area. By changing the HitResult to 1 or 2 in the HitTest event, you can allow the control underneath to receive the mouse messages. If there is nothing underneath at run time or if the control underneath declines the hit, your control will get a second or third chance to receive the mouse messages.</p>
<p>
Hit testing is performed in the following order for multiple overlapping controls:
<ul type=disc>
<li>
The topmost control in the ZOrder that returns a HitResult of 3 (vbHitResultHit) will receive mouse messages.<br><br></li>
<li>
If no control in the ZOrder returns a hit, the topmost control that returns a HitResult of 2 (vbHitResultClose) will receive mouse messages.<br><br></li>
<li>
If no control returns a hit, the topmost control that returns a HitResult of 1 (vbHitResultTransparent) will receive mouse messages.<br><br></li>
<li>
If no control returns a hit, the mouse messages are forwarded to the underlying container.</li>
</ul>
<p>
The HitTest event only occurs when the <b>Windowless</b> property of the UserControl has been set to True and the <b>BackStyle</b> property has been set to Transparent. If the <b>Windowless</b> property is False or the <b>BackStyle</b> property equals Opaque, any code in the HitTest event procedure will be ignored.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The order of hit testing described above applies to UserControl objects in a Visual Basic container. Other containers may not perform hit testing in the same order.</p>
</BODY>
</HTML>
