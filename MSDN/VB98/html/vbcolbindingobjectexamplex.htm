<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Binding Object, BindingCollection Object Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbcolbindingobjectexamplex"></a>Binding Object, BindingCollection Object Example</h1>
<p>
The example uses the <b>BindingCollection </b>object to bind a data source to two <b>TextBox</b> controls. The example first opens an ADODB recordset object, then sets the <b>DataSource</b> property of the <b>BindingCollection </b>to the recordset. The code then adds two <b>Binding</b> objects to the collection, thereby binding two <b>TextBox</b> controls to different fields of the recordset.</p>
<p>
To try the example, in the <b>References</b> dialog box set a reference to the <b>Microsoft Data Binding Collection</b>. In the same dialog box, set a reference to the <b>Microsoft ActiveX Data Objects Library</b>. Draw two <b>TextBox </b>controls on a Form, and paste the code into the Declarations section. Press F5, and click the form to advance through the recordset.</p>
<pre><code>Option Explicit
Private colBndNwind As New <span class=cfe><b>BindingCollection</b></span>
Private rsNwind As New ADODB.Recordset
Private cn As New ADODB.Connection

Private Sub Form_Load()

   ' Set the Connection object parameters.&nbsp;&nbsp; 
   With cn
      ' The following connection may or may not work on your computer.
      ' Alter it to find the Nwind.mdb file, which is included with
      ' Visual Basic.
      .Provider = "Microsoft.Jet.OLEDB.3.51"
      .Open "C:\Program Files\DevStudio\VB\Nwind.mdb"
   End With
 &nbsp; 
   ' Open the recordset object. 
   rsNwind.Open "Select * From Products", cn
   
   ' Set the DataSource of the Bindings collection to the recordset.
   Set colBndNwind.DataSource = rsNwind
   
   ' Add to the Bindings collection.
   With colBndNwind
      .Add Text1, "Text", "ProductName", , "product"
      .Add Text2, "Text", "SupplierID", , "ID"
   End With

   ' Print the properties of the objects in the collection.
   Dim bndObj As <span class=cfe><b>Binding</b></span>
   For Each bndObj In colBndNwind
      Debug.Print "DataField", "PropertyName", "Key"
      Debug.Print bndObj.DataField, bndObj.PropertyName, bndObj.Key
      Debug.Print
   Next
End Sub

Private Sub Form_Click()
   ' Move to the next record by clicking the form.
   rsNwind.MoveNext
End Sub
</code></pre>
</BODY>
</HTML>
