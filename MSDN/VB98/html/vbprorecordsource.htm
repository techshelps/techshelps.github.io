<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RecordSource Property</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbprorecordsource"></a>RecordSource Property</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dacolTableDefS;daobjQueryDef;daproIndex;vbproBooksOnlineJumpTopic;vbproRecordSource_C;vbproRecordSourceC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbproRecordSource_X;vbproRecordSourceX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbproRecordSource_A;vbproRecordSourceA">
</object></p>
<p>
Returns or sets the underlying table, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="idh_vbdefsqlstatement">
</object><a href=JavaScript:alink_4.Click()>SQL statement</a>, or stored procedure.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>.RecordSource</b> [<b>=</b> <i>value</i> ]</p>
<p>
The <b>RecordSource</b> property syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Part</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><i>object</i></td>
<td width=71%>An <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_5.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=29%><i>value</i></td>
<td width=71%>A <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defstringexpression">
</object><a href=JavaScript:alink_6.Click()>string expression</a> specifying a name, as described in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>value</i> are:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Setting</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%>A table name</td>
<td width=71%>The name of one of the tables defined in the <b>Database</b> object's <b>TableDefs</b> collection.</td>
</tr>
<tr valign=top>
<td width=29%>An SQL query</td>
<td width=71%>A valid SQL string using syntax appropriate for the data source. </td>
</tr>
<tr valign=top>
<td width=29%>stored procedure</td>
<td width=71%>The name of a stored procedure in the database.<p>
When using DAO, the name of one of the <b>QueryDef</b> objects in the <b>Database</b> object's <b>QueryDefs</b> collection.</p>
</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>RecordSource</b> property specifies the source of the records accessible through <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defboundcontrol">
</object><a href=JavaScript:alink_7.Click()>bound controls</a> on your form.</p>
<p>
If you set the <b>RecordSource</b> property to the name of an existing table in the database, all of the fields in that table are visible to the bound controls attached to the <b>Data</b> control. For table-type recordsets (<b>RecordsetType</b> = <b>vbRSTypeTable</b>), the order of the records retrieved is set by the <b>Index</b> object that you select using the <b>Index</b> property of the <b>Recordset</b>. For dynaset-type and snapshot-type <b>Recordset</b> objects, you can order the records by using a SQL statement with an Order By clause in the <b>RecordSource</b> property of the <b>Data</b> control. Otherwise, the data is returned in no particular order.</p>
<p>
If you set the <b>RecordSource</b> property to the name of an existing <b>QueryDef</b> in the database, all fields returned by the <b>QueryDef</b> are visible to the bound controls attached to the <b>Data</b> control. The order of the records retrieved is set by the <b>QueryDef</b> object's query. For example, the <b>QueryDef</b> may include an ORDER BY clause to change the order of the records returned by the <b>Recordset</b> created by the <b>Data</b> control or a WHERE clause to filter the records. If the <b>QueryDef</b> doesn't specify an order, the data is returned in no particular order.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;At design-time, the <b>QueryDef</b> objects displayed in the Properties window for the <b>RecordSource</b> property are filtered out to display only <b>QueryDef</b> objects that are usable with the <b>Data</b> control. <b>QueryDef</b> objects which have parameters, and <b>QueryDef</b> objects which have the following types are not displayed: <b>dbQAction</b>, <b>dbQCrosstab</b>, <b>dbQSQLPassThrough</b> and <b>dbQSetOperation</b>.</p>
<p>
If you set the <b>RecordSource</b> property to an SQL statement that returns records, all fields returned by the SQL query are visible to the bound controls attached to the <b>Data</b> control. This statement may include an ORDER BY clause to change the order of the records returned by the <b>Recordset</b> created by the <b>Data</b> control or a WHERE clause to filter the records. If the database you specify in the <b>Database</b> and <b>Connect</b> property isn't a Microsoft Jet engine database, and if the <b>dbSQLPassThrough</b> option is set in the <b>Options</b> property, your SQL query must use the syntax required by that database engine.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Whenever your <b>QueryDef</b> or SQL statement returns a value from an expression, the field name of the expression is created automatically by the Microsoft Jet database engine. Generally, the name is Expr1 followed by a three-character number beginning with 000. For example, the first expression would be named: Expr1000.</p>
<p class=indent>
In most cases you'll want to alias expressions so you know the name of the column to bind to the bound control. See the SQL SELECT statement AS clause for more information.</p>
<p>
After changing the value of the <b>RecordSource</b> property at <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defruntime">
</object><a href=JavaScript:alink_8.Click()>run time</a>, you must use the <b>Refresh</b> method to enable the change and rebuild the <b>Recordset</b>.</p>
<p>
At run time, if the <b>Recordset</b> specifies an invalid <b>Table</b> name, <b>QueryDef </b>name, or contains invalid SQL syntax, a trappable error will result. If this error occurs during the initial Form_Load procedure, the error is not trappable.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Make sure each bound control has a valid setting for its <b>DataField</b> property. If you change the setting of a <b>Data</b> control's <b>RecordSource</b> property and then use <b>Refresh</b>, the <b>Recordset</b> identifies the new object. This may invalidate the <b>DataField</b> settings of bound controls and cause a trappable error.</p>
<p class=label>
<b>Data Type</b></p>
<p>
String</p>
</BODY>
</HTML>
