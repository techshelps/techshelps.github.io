<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MTSTransactionMode Property</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbpromtstransactionmodeproperty"></a>MTSTransactionMode Property</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbproMTSTransactionModeProperty_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbproMTSTransactionModeProperty_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbproMTSTransactionModeProperty_A">
</object></p>
<p>
Specifies the transactional behavior of a class. This property is only used by components running in the Microsoft Transaction Server, and has no effect if the component is run outside of the Transaction Server.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i>.<b>MTSTransactionMode</b> [= <i>value</i>]</p>
<p>
The <b>MTSTransactionMode</b> property has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>Part</b></td>
<td class=label width=67%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=33%><i>object</i></td>
<td width=67%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an item in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=33%><i>value</i></td>
<td width=67%>An integer or constant specifying the transactional behavior of a class.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>value</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=35%><b>Constant</b></td>
<td class=label width=12%><b>Value</b></td>
<td class=label width=53%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%><b>NotAnMTSObject</b></td>
<td width=12%>0</td>
<td width=53%>(Default) The component doesn't support Microsoft Transaction Server.</td>
</tr>
<tr valign=top>
<td width=35%><b>NoTransactions</b></td>
<td width=12%>1</td>
<td width=53%>Does not support transactions. This value indicates that the component's objects do not run within the scope of transactions. When a new object is created, its object context is created without a transaction, regardless of whether the client has a transaction.</td>
</tr>
<tr valign=top>
<td width=35%><b>RequiresTransaction</b></td>
<td width=12%>2</td>
<td width=53%>This value indicates that the component's objects must execute within the scope of a transaction. When a new object is created, its object context inherits the transaction from the context of the client. If the client does not have a transaction, MTS automatically creates a new transaction for the object.</td>
</tr>
<tr valign=top>
<td width=35%><b>UsesTransaction</b></td>
<td width=12%>3</td>
<td width=53%>This value indicates that the component's objects can execute within the scope of their client's transactions. When a new object is created, its object context inherits the transaction from the context of the client. If the client does not have a transaction, the new context is also created without one.</td>
</tr>
<tr valign=top>
<td width=35%><b>RequiresNewTransaction</b></td>
<td width=12%>4</td>
<td width=53%>This value indicates that the component's objects must execute within their own transactions. When a new object is created, MTS automatically creates a new transaction for the object, regardless of whether its client has a transaction.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The Microsoft Transaction Server uses the <b>MTSTransactionMode</b> property during object creation to determine whether the object should be created to execute within a transaction, and whether a transaction is required or optional.</p>
<p>
Most MTS components are declared as either <b>UsesTransactions</b> or <b>RequiresTransaction</b>. These values allow an object to execute within the scope of its client's transaction. You can see the difference between these values when an object is created from a context that does not have a transaction. If the component's transaction attribute is <b>UsesTransactions</b>, the new object runs without a transaction. If it is declared as <b>RequiresTransaction</b>, MTS automatically initiates a transaction for the new object.</p>
<p>
Declaring a component as <b>RequiresNewTransaction</b> is similar to using <b>RequiresTransaction</b> in that the component's objects are guaranteed to execute within transactions. However, when you declare the transaction attribute this way, an object never runs inside the scope of its client's transaction. Instead, the system always creates independent transactions for the new objects. For example, you can use this attribute for auditing components that record work done on behalf of another transaction regardless of whether the original transaction commits or aborts.</p>
</BODY>
</HTML>
