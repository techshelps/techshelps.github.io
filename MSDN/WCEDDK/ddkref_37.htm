<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACMDM_FORMAT_DETAILS</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_wceddk_acmdm_format_details"></a>ACMDM_FORMAT_DETAILS</h2>
<p>
The ACMDM_FORMAT_DETAILS message requests an ACM driver to return information about a format associated with a specified format tag.</p>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDriverID</i></dt>
<dd>
Driver instance identifier. This is the value returned by the driver in response to the <b>ACM_Open</b> function.</dd>
<dt>
<i>hDriver</i></dt>
<dd>
Driver handle.</dd>
<dt>
<i>uMsg</i></dt>
<dd>
ACMDM_FORMAT_DETAILS</dd>
<dt>
<i>lParam1</i></dt>
<dd>
Pointer to an ACMFORMATDETAILS structure. ( ACMFORMATDETAILS is defined in Msacm.h and described in the Win32 SDK.)</dd>
<dt>
<i>lParam2</i></dt>
<dd>
Contains one of the following flags, specified by the fdwDetails parameter of the acmFormatDetails function, which is described in the Win32 SDK:
<dl>
<dt>
ACM_FORMATDETAILSF_INDEX</dt>
<dd>
Indicates the dwFormatIndex member of the ACMFORMATDETAILS structure contains a format index. The valid index range is from zero to one less than the cStandardFormats member returned in the ACMFORMATTAGDETAILS structure for the format tag. (See ACMDM_FORMATTAG_DETAILS.)</dd>
<dt>
ACM_FORMATDETAILSF_FORMAT</dt>
<dd>
Indicates the client has filled in the WAVEFORMATEX structure associated with the ACMFORMATDETAILS structure.</dd>
</dl>
</dd>
</dl>
<h4>Return Value</h4>
<p>
The driver should return MMSYSERR_NOERROR if the operation succeeds. Otherwise it should return one of the MMSYSERR error codes defined in Mmsystem.h, or one of the ACMERR error codes defined in Msacm.h. Possible error codes include:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Value</th>
<th align=left width=60%>Description</th>
</tr>
<tr valign=top>
<td width=40%>MMSYSERR_NOTSUPPORTED</td>
<td width=60%>The driver does not support the specified query operation.</td>
</tr>
<tr valign=top>
<td width=40%>ACMERR_NOTPOSSIBLE</td>
<td width=60%>The input parameter values do not represent a valid format or format tag.</td>
</tr>
</table><br>
<h4>Comments</h4>
<p>
The ACM (WAVEAPI.DLL) sends the ACMDM_FORMAT_DETAILS message by calling the ACM driver's <b>ACM_IOControl</b>() entry point via DeviceIoControl(). The ACM sends this message when an application calls the <b>acmFormatDetails</b> function, which is described in the Win32 SDK.</p>
<p>
All ACM drivers must support this message.</p>
<p>
The client can do either of the following:
<ul>
<li>
Specify a format index, in order to obtain a description of the format associated with the index.</li>
<li>
Specify a format description, in order to validate the format and obtain the format's string description.</li>
</ul>
<p>
The client specifies the format tag in the ACMFORMATDETAILS structure's dwFormatTag member. The driver returns information for a particular format belonging to the format tag, as follows:
<ul>
<li>
If the ACM_FORMATDETAILSF_INDEX flag is set, the client has specified an index value in the ACMFORMATDETAILS structure's dwFormatIndex member. The driver fills in the WAVEFORMATEX structure for the format associated with the specified index value. It also fills in the ACMFORMATDETAILS structure's szFormat, fdwSupport, and cbStruct members.</li>
<li>
If the ACM_FORMATDETAILSF_FORMAT flag is set, the client has filled in the WAVEFORMATEX structure. The driver validates the structure contents and, if the contents are valid, fills in the ACMFORMATDETAILS structure's szFormat, fdwSupport, and cbStruct members.</li>
</ul>
<p>
Before calling the driver's <b>ACM_IOControl</b> function, the ACM verifies that:
<ul>
<li>
The ACMFORMATDETAILS structure and its associated WAVEFORMATEX structure are readable and writeable.</li>
<li>
The size of the ACMFORMATDETAILS structure (contained in its cbStruct member) is at least the structure's defined size. (The structure's size can be larger than its defined size, to allow for a longer szFormat member or to allow newer, larger structure definitions to be used within drivers under development.)</li>
<li>
The size of the WAVEFORMATEX structure associated with the ACMFORMATDETAILS structure's pwfx member is at least as large as the generic WAVEFORMATEX structure's defined size. (See The WAVEFORMATEX Structure below.)</li>
<li>
The ACMFORMATDETAILS structure's fdwSupport member contains zero.</li>
<li>
The lParam2 parameter contains a valid flag value.</li>
</ul>
<p>
Before returning, the driver must set the ACMFORMATDETAILS structure's cbStruct member to the actual number of bytes returned. The value returned in cbStruct must not be greater than the value received.</p>
<p>
The WAVEFORMATEX Structure</p>
<p>
The WAVEFORMATEX structure is a generic structure for describing a waveform format. Generally, you will use this structure as a basis for defining structures for your specific format types, as has been done in the IMA ADPCM Audio Codec. (For an example, see IMAADPCMWAVEFORMAT in mmreg.h.) When a client sends an ACMDM_FORMAT_DETAILS message, it specifies the address of a structure that you have defined for the specified format type. This structure is typically larger than the generic WAVEFORMATEX structure.</p>
<p>
For more information about format tags and format structures, see Format Tags and Filter Tags and Defining Format Structures and Filter Structures in the Windows NT DDK.</p>
<p>
Returning a Description String</p>
<p>
The WAVEFORMATEX structure's szFormat member is used for returning a format description string. If an ACM driver returns a zero-length string in szFormat, the ACM creates an internationalized description string for the format. This string includes the format's speed (in Hz), bit depth, and channel setting (mono or stereo), based on the contents of the nSamplesPerSec, wBitsPerSample, and nChannels members of the WAVEFORMATEX structure. If wBitsPerSample contains zero, the ACM does not include the bit depth in the description string. You can provide your own description string and return it in szFormat, but allowing ACM to generate an internationalized string is preferred.</p>
<p>&nbsp;</p></body>
</HTML>
