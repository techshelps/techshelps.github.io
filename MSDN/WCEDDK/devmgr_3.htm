<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Unloading Installable Device Drivers</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_wceddk_unloading_installable_device_drivers"></a>Unloading Installable Device Drivers</h2>
<p>
An installable device driver DLL can be unloaded in two ways, depending on the method by which the DLL was loaded. If the Device Manager loaded the DLL, then the Device Manager will also detect when the installable device driver's peripheral is disconnected from the Windows CE platform (for example, when a PC Card is ejected from its socket). At that time, the Device Manager will remove the driver's entry from the [HKEY_LOCAL_MACHINE\Drivers\Active] key, will call <b>DeregisterDevice</b> to remove the peripheral's device filename from the filesystem, and will call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_FreeLibrary">
</object><a href=JavaScript:alink_1.Click()><b>FreeLibrary</b></a> to unload the DLL itself.</p>
<p>
If the DLL was loaded by an application, then the application should also unload the DLL before it exits by calling <b>DeregisterDevice.</b></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
