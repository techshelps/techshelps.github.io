<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACMDM_STREAM_OPEN</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_wceddk_acmdm_stream_open"></a>ACMDM_STREAM_OPEN</h2>
<p>
The ACMDM_STREAM_OPEN message requests an ACM driver to either open a conversion stream or indicate whether the specified conversion is supported.</p>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDriverID</i></dt>
<dd>
Driver instance identifier. This is the value returned by the driver in response to the <b>ACM_Open</b> function.</dd>
<dt>
<i>hDriver</i></dt>
<dd>
Driver handle.</dd>
<dt>
<i>uMsg</i></dt>
<dd>
ACMDM_STREAM_OPEN</dd>
<dt>
<i>lParam1</i></dt>
<dd>
Pointer to an <b>ACMDRVSTREAMINSTANCE</b> structure.</dd>
<dt>
<i>lParam2</i></dt>
<dd>
Not used.</dd>
</dl>
<h4>Return Value</h4>
<p>
The driver should return MMSYSERR_NOERROR if the operation succeeds. Otherwise it should return one of the MMSYSERR error codes defined in Mmsystem.h, or one of the ACMERR error codes defined in Msacm.h. If a specified conversion is not supported, the driver should return ACMERR_NOTPOSSIBLE.</p>
<h4>Comments</h4>
<p>
The ACM (WAVEAPI.DLL) sends the ACMDM_STREAM_OPEN message by calling the ACM driver's <b>ACM_IOControl</b>() entry point via DeviceIoControl(). The ACM sends this message when an application calls the <b>acmStreamOpen</b> function, which is described in the Win32 SDK.</p>
<p>
All ACM drivers that provide stream conversions must support this message. For more information about stream conversions, see Converting Data Streams in the Windows NT DDK.</p>
<p>
If the client has specified the ACM_STREAMOPENF_QUERY flag (contained in the <b>ACMDRVSTREAMINSTANCE</b> structure's fdwOpen member), then the driver should not open a stream instance. It should return MMSYSERR_NOERROR if the conversion is possible, and MMSYSERR_NOTPOSSIBLE otherwise.</p>
<p>
When a driver receives an ACMDM_STREAM_OPEN message, it should first determine if it can perform the specified conversion. If it can, then it should perform instance initialization operations for the stream, such as determining which conversion routines to use and allocating instance-specific resources.</p>
<p>
Store stream instance data in a local, dynamically allocated structure. Store a pointer to the structure in the <b>ACMDRVSTREAMINSTANCE</b> structure's <i>dwDriver</i> member.</p>
<p>
If the driver supports asynchronous operations, and if the client has specified the ACM_STREAMOPENF_ASYNC flag ( contained in the <b>ACMDRVSTREAMINSTANCE</b> structure's <i>fdwOpen</i> member), then the driver should send the client an MM_ACM_OPEN callback message, by calling the <b>PostThreadMessage</b> function, after the operation completes.</p>
<p>
Before calling the driver's <b>ACM_IOControl</b> function, the ACM verifies that:
<ul>
<li>
The <b>ACMDRVSTREAMINSTANCE</b> structure's fdwOpen member contains valid flag values.</li>
<li>
The source and destination WAVEFORMATEX structures are readable.</li>
<li>
If a WAVEFILTER structure is specified, it is readable and the source and destination format structures contain identical information.</li>
<li>
If the client has specified different source and destination format tags, then the driver has declared itself to be a codec by setting ACMDRIVERDETAILS_SUPPORTF_CODEC in the <b>ACMDRIVERDETAILS</b> structure's <i>fdwSupport</i> member. (See ACMDM_DRIVER_DETAILS.)</li>
<li>
If the client has specified source and destination formats associated with a single format tag, then the driver has declared itself to be a converter by setting ACMDRIVERDETAILS_SUPPORTF_CONVERTER in the <b>ACMDRIVERDETAILS</b> structure's <i>fdwSupport</i> member. (See ACMDM_DRIVER_DETAILS.)</li>
<li>
If the client has specified a filter operation, then the driver has declared itself to be a filter by setting ACMDRIVERDETAILS_SUPPORTF_FILTER in the ACMDRIVERDETAILS structure's fdwSupport member. (See ACMDM_DRIVER_DETAILS.)</li>
</ul>
<p>
If the client has specified the ACM_STREAMOPENF_NONREALTIME flag (contained in the <b>ACMDRVSTREAMINSTANCE</b> structure's fdwOpen member), then the driver can perform the conversion without time constraints. However, if this flag is not specified, and the driver cannot perform the conversion in real time, then it should return ACMERR_NOTPOSSIBLE. For more information, see Real Time Conversions.</p>
<p>&nbsp;</p></body>
</HTML>
