<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GPE::BltPrepare</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_wceddk_gpe.3a3a.bltprepare"></a>GPE::BltPrepare</h2>
<p>
<b>GPE::BltPrepare</b>() is called prior to a sequence of clipped Blt operations and is used to determine which function will be used to perform the individual Blts. </p>
<h4>Syntax</h4>
<p>
<b>SCODE GPE::BltPrepare(GPEBltParms *</b><i>pBltParms</i><b> )</b></p>
<p>
The simplest acceptable action for <b>GPE::BltPrepare</b>() is:</p>
<pre><code>pBltParms-&gt;pBlt = EmulatedBlt;
return S_OK;
</code></pre>
<p>
This will cause the emulated Blt function provided with GPE to be used for the Blt sequence.</p>
<p>
For improved performance, BltPrepare can examine the characteristics of the Blt and the associated surfaces defined in the GPEBltParms to determine whether an accelerated form of the Blt can be used. Operations which are likely to be implemented in hardware can be determined as follows:</p>
<pre><code>if( pBltParms-&gt;pDst-&gt;InVideoMemory() &amp;&amp; pBltParms-&gt;rop4 == 0x0000 )
    - this is a fill of BLACKNESS in video memory
if( pBltParms-&gt;pDst-&gt;InVideoMemory() &amp;&amp; pBltParms-&gt;rop4 == 0xFFFF )
    - this is a fill of WHITENESS in video memory
if( pBltParms-&gt;pDst-&gt;InVideoMemory()
&amp;&amp; pBltParms-&gt;rop4 == 0xF0F0
&amp;&amp; pBltParms-&gt;solidColor != 0xFFFFFFFF )
- this is a fill of a solid color in video memory
if( pBltParms-&gt;pDst-&gt;InVideoMemory()
&amp;&amp; pBltParms-&gt;pSrc-&gt;InVideoMemory()
&amp;&amp; pBltParms-&gt;rop4 == 0xCCCC
&amp;&amp; !pBltParms-&gt;pLookup
&amp;&amp; !pBltParms-&gt;pConvert )
</code></pre>
<p>
- this is a SRCCOPY between two surfaces in video memory with no color translation</p>
<p>
In order to accelerate Blts such as these, BltPrepare places the address of the accelerated function in the pBlt field of GPEBltParms (instead of placing EmulatedBlt there). For operations such as solid color fills, the driver may also prepare the hardware for example placing the solid color into the appropriate register of the hardware so that this need not be repeated in every call to the accelerated Blt handler.</p>
<p>&nbsp;</p></body>
</HTML>
