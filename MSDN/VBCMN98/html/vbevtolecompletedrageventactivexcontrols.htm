<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLECompleteDrag Event (ActiveX Controls)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtolecompletedrageventactivexcontrols"></a>OLECompleteDrag Event (ActiveX Controls)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtOLECompleteDragEventActiveXControls_C;vbevtOLECompleteDragEventActiveXControlsC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtOLECompleteDragEventActiveXControls_X;vbevtOLECompleteDragEventActiveXControlsX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtOLECompleteDragEventActiveXControls_A;vbevtOLECompleteDragEventActiveXControlsA">
</object></p>
<p>
Occurs when a source component is dropped onto a target component, informing the source component that a drag action was either performed or canceled.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_OLECompleteDrag</b>([<i>effect</i> <b>As</b> <b>Long</b>])</p>
<p>
The OLECompleteDrag event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=20%><b>Part</b></td>
<td class=label width=80%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=20%><i>object</i></td>
<td width=80%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=20%><i>effect</i></td>
<td width=80%>A long integer set by the source object identifying the action that has been performed, thus allowing the source to take appropriate action if the component was moved (such as the source deleting data if it is moved from one component to another). The possible values are listed in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>effect</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Constant</b></td>
<td class=label width=12%><b>Value</b></td>
<td class=label width=59%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><b>vbDropEffectNone</b></td>
<td width=12%>0</td>
<td width=59%>Drop target cannot accept the data, or the drop operation was canceled.</td>
</tr>
<tr valign=top>
<td width=29%><b>vbDropEffectCopy</b></td>
<td width=12%>1</td>
<td width=59%>Drop results in a copy of data from the source to the target. The original data is unaltered by the drag operation.</td>
</tr>
<tr valign=top>
<td width=29%><b>vbDropEffectMove</b></td>
<td width=12%>2</td>
<td width=59%>Drop results in data being moved from the drag source to the drop source. The drag source should remove the data from itself after the move. </td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The OLECompleteDrag event is the final event to be called in an OLE drag/drop operation. This event informs the source component of the action that was performed when the object was dropped onto the target component. The target sets this value through the <i>effect</i> parameter of the OLEDragDrop event. Based on this, the source can then determine the appropriate action it needs to take. For example, if the object was moved into the target (<b>vbDropEffectMove</b>), the source needs to delete the object from itself after the move.</p>
<p>
If <b>OLEDragMode</b> is set to <b>Automatic</b>, then Visual Basic handles the default behavior. The event still occurs, however, allowing the user to add to or change the behavior.</p>
<p>
Most components support manual OLE drag and drop events, and some support automatic OLE drag and drop events.</p>
</BODY>
</HTML>
