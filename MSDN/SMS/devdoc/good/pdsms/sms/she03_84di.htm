<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sample Code to Call InstallStatusMIF</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="sms_sample_code_to_call_installstatusmif"></a>Sample Code to Call InstallStatusMIF</h2>
<p>
You must include code in your setup application that calls <b>InstallStatusMIF</b>. Note that your setup application should create one and only one package command status MIF file.</p>
<p>
An example of the required setup code is shown below. This example loads the appropriate library (ISMIF32.DLL or ISMIF16.DLL), retrieves the address of the <b>InstallStatusMIF</b> function, and then calls the function, passing the parameters for the application being installed or removed. The code also reports whether the MIF file was created and, if not, the reason for the failure.</p>
<p>
If successful, this code sample results in a package command status MIF file called OFFICE97.MIF in the Windows directory.</p>
<pre><code>{
HINSTANCE hInstLibrary;
DWORD (WINAPI *InstallStatusMIF)(char*, char*, char*, char*, 
        char*, char*, char*, BOOL);

#ifdef WIN32
   if (hInstLibrary = LoadLibrary("ismif32.dll"))
#elif defined WIN16
   if (hInstLibrary = LoadLibrary("ismif16.dll"))
#endif
 {
   InstallStatusMIF = (DWORD (WINAPI *)(char*,char*,char*, 
         char*,char*,char*,char*,BOOL))GetProcAddress(hInstLibrary, 
         "InstallStatusMIF");
if (InstallStatusMIF)
{
        if (InstallStatusMIF("office97", "Microsoft", "Office 97", 
           "999.999", "ENU", "1234","Completed successfully",
           TRUE) !=0)
{
    MessageBox("File is in your windows directory\Operation 
                      successful");
}
else
{
    MessageBox("Write to MIF file failed");
}
}
else
{
MessageBox("Failed to get procedure address from DLL");
}
FreeLibrary(hInstLibrary);
}
else
{
MessageBox("Load of DLL failed");
}
}
 </code></pre>
<p>
See <a href="she03_8zj9.htm">Sample Package Command Status MIF File</a> for an example of the resulting MIF file.</p>
<p>&nbsp;</p></body>
</HTML>
