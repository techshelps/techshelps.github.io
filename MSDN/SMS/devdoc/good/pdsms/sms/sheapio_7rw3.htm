<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Inventory Rules Folder Tokens</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="sms_inventory_rules_folder_tokens"></a>Inventory Rules Folder Tokens</h2>
<p>
In addition to the <a href="sheapio_4sj7.htm#sms_f_inventory_inventory_this_package">Inventory this package</a> scalar, an <a href="sheapio_0cvm.htm">inventory rules folder</a> contains one or more <a href="sheapio_2sfn.htm">tokens</a> that represent the rule for collecting inventory on the package.</p>
<p>
The inventory rules folder uses expression tokens and control tokens in the same way that filters do—except that each expression token contains a string that specifies attributes that identify the file, and the <b>NOT</b> operator is not supported. In addition, expression tokens for an inventory rules folder use only the <b>szTokenString</b> member of the <a href="sheapi_0awe.htm"><b>TOKEN</b></a> structure. In all other respects, the tokens for an inventory rules folder have the same behavior as tokens in a filter—expression tokens are connected by <b>AND</b> or <b>OR</b> operators, expression tokens can be grouped and ungrouped, and they can be deleted.</p>
<p>
Note that the inventory rules folder must contain at least one expression token. An inventory rules folder that does not contain one or more expression tokens cannot be committed to the site database.</p>
<p>
Each expression token contains a string that begins with the <b>file</b> keyword, the file name, and the file's attributes (note that the file attributes are optional):</p>
<p>
<b>file</b> "f<i>ilename</i>" [<i>fileattributes</i>]</p>
<p>
where
<dl>
<dt>
<i>filename</i></dt>
<dd>
Is a string that specifies the name of the file. This can be a file name with eight characters plus a three-character extension, or a long file name. The <i>filename</i> must be enclosed within quotation marks.
<p>
When your application reads a token from an existing inventory rules folder in the site database, <i>filename</i> specifies only the name of the file—not an explicit path.

<p>
When your application adds a token, an explicit path can be specified (such as C:\GRAPE\FRUIT.EXE). By using an explicit path, the SMS API engine can retrieve a value from the specified file when the <b>retrieve</b> key word is specified for a value. If only the file name is specified, the SMS API engine searches for the file in your application's current directory. When the token is added to the inventory rules folder by using <a href="sheapi_6c6m.htm"><b>SmsAddToken</b></a>, the SMS API engine retrieves the value from the specified file. For example, the following token will retrieve the CHECKSUM value at offset 20 and of length 200:

<pre><code>file "c:\winword\winword.exe" CHECKSUM 20 200 retrieve
</code></pre>

<p>
If your application were to read the same token from the inventory rules folder, the token string would contain the file name only (without the explicit path) and the actual value for the attribute (instead of the <b>retrieve</b> keyword). For example, the CHECKSUM for Microsoft Word version 6.0 would be the following:

<pre><code>file "winword.exe" CHECKSUM 20 200 7232
</code></pre>

<p>
If <i>filename</i> specifies a location that does not contain the file, <b>SmsAddToken</b> will not add the token to the inventory rules folder and will return a status of SMS_PARAMETER_ERROR.
</dd>
<dt>
<i>fileattributes</i></dt>
<dd>
Can be one or more attributes of the file. Each type of attribute begins with a keyword followed by the specific value (or values) for the attribute.
</dd>
</dl>
<p>
For example, the following line would specify a valid string that could be used for <b>szTokenString</b>:</p>
<pre><code>char *pszRule = "file \"winword.exe\" CHECKSUM 20 200 7232";
</code></pre>
<p>
Note that your application is responsible for specifying a string containing a valid format as well as valid attributes for <b>szTokenString</b>. It is recommended that your application use the <b>retrieve</b> keyword so that the SMS API engine can retrieve the attribute value directly from the file, or that you use the FILETOKN.EXE utility provided with SMS to retrieve the attribute value from the file. Because there are numerous methods for calculating a CRC value, it is particularly important that you use the <b>retrieve</b> keyword or FILETOKN.EXE to calculate the CRC value if you are unsure whether your CRC calculation uses the CCITT-CRC algorithm.</p>
<p>
For more information about the file attributes for tokens in an inventory rules folder, see <a href="sheapio_47eb.htm">File Attributes for Inventory Rules Folder Tokens</a>.</p>
<p>&nbsp;</p></body>
</HTML>
