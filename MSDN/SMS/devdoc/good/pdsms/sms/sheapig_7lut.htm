<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SRVINST.EXE</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="sms_srvinst.exe"></a>SRVINST.EXE</h2>
<h4>Overview</h4>
<p>
SRVINST.EXE is a console mode application that can be used for creating server install jobs or Run Command on Workstation jobs and monitoring the status of these jobs. This code demonstrates datasource connection, folder creation, scalar manipulation, and helper functions.</p>
<h4>Running the Program</h4>
<p>
SRVINST.EXE runs as a console application. The program prompts you to enter the information needed to connect to SQL Server and then displays a list of sites to target. It then prompts you to enter the target job platforms, and then lets you select the type of job to create.</p>
<p>
The program will request the following input for a Share Package On Server job:
<dl>
<dt>
<b>Package name</b></dt>
<dd>
User-defined name of the package.</dd>
<dt>
<b>Package comment</b></dt>
<dd>
User-defined text.</dd>
<dt>
<b>Package location (UNC path)</b></dt>
<dd>
The path to the directory where the package files are located.</dd>
<dt>
<b>Package share name</b></dt>
<dd>
The name that the package will be shared as on the server.</dd>
<dt>
<b>Program item description</b></dt>
<dd>
User-defined text.</dd>
<dt>
<b>Program item command line</b></dt>
<dd>
The command to execute on the server.</dd>
<dt>
<b>Program item registry name</b></dt>
<dd>
User-defined registry key for the package.</dd>
</dl>
<p>
</p>
<p>
The program will request the following input for a Run Command On Workstation job:
<dl>
<dt>
<b>Package name</b></dt>
<dd>
User-defined name of the package.</dd>
<dt>
<b>Package comment</b></dt>
<dd>
User-defined text.</dd>
<dt>
<b>Package location (share name)</b></dt>
<dd>
The path to the directory where the client package is located.</dd>
<dt>
<b>WCL Name</b></dt>
<dd>
User-defined name for the workstation command line.</dd>
<dt>
<b>WCL Command</b></dt>
<dd>
The command line to execute.</dd>
</dl>
<p>
</p>
<p>
<b>Note</b>  If you choose to create a Share Package On Server job or a Run Command On Workstation job, then you must first share the directory where the package files are located.</p>
<h4>Functions</h4>
<p>
<a href="sheapi_89mc.htm"><b>SmsDataSourceConnect</b></a><br>
<a href="sheapi_44z8.htm"><b>SmsDataSourceDisconnect</b></a><br>
<a href="sheapi_0bea.htm"><b>SmsOpenContainer</b></a><br>
<a href="sheapi_2vg2.htm"><b>SmsCloseContainer</b></a><br>
<a href="sheapi_9mlu.htm"><b>SmsCreateFolder</b></a><br>
<a href="sheapi_88tu.htm"><b>SmsLinkFolder</b></a><br>
<a href="sheapi_2s36.htm"><b>SmsCommitFolder</b></a><br>
<a href="sheapi_15iq.htm"><b>SmsCloseFolder</b></a><br>
<a href="sheapi_58ky.htm"><b>SmsGetNextFolder</b></a><br>
<a href="sheapi_62sy.htm"><b>SmsSetScalar</b></a><br>
<a href="sheapi_5s11.htm"><b>SmsGetScalarByName</b></a></p>
<h4>Program Flow</h4>
<p>
After logging on to the datasource, a list of sites is displayed and the user is asked to select the site that the job will be run on. This site list is obtained by opening the site container and enumerating the sites found there. The code then queries the user for the platform type and converts the selected platform index to the corresponding platform flag. The user is then asked to choose between a Share Package On Server job or Run Command On Workstation job. The user is asked to enter the necessary scalar values for the job, and the job is created. The code then enters a loop where the status of the job is monitored and displayed periodically until the job completes.</p>
<p>&nbsp;</p></body>
</HTML>
