<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPERTYINFO</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="sms_propertyinfo"></a>PROPERTYINFO</h1>
<p>
The <b>PROPERTYINFO</b> data structure is used to describe the properties that the protocol parser needs to describe the frames.</p>
<pre><code>typedef struct _PROPERTYINFO
{
    HPROPERTY hProperty;
    DWORD Version;
    LPSTR Label;
    LPSTR Comment;
    BYTE DataType;
    BYTE DataQualifier;

    union
    {
        LPVOID lpExtendedInfo; 
        LPRANGE lpRange; 
        LPSET lpSet; 
        DWORD Bitmask; 
        DWORD Value; 
    };

    WORD FormatStringSize;
    LPVOID InstanceData;
} PROPERTYINFO;

typedef PROPERTYINFO *LPPROPERTYINFO;
</code></pre>
<p>
For example, the <b>PROPERTYINFO</b> table for the SMB parser starts like this:</p>
<pre><code>PROPERTYINFO property_table[] =
{

// PROP_SMB_SUMMARY
    {   0,0,
        "Summary",
        "Server Message Block (SMB)",
        PROP_TYPE_SUMMARY,
        PROP_QUAL_NONE,
        NULL,
        128,
        fm_smb_summary },
...

At Register time, the SMB parser then tell the system about the properties like this:
    for (i = 0; i &lt; PROP_LAST_PROPERTY; i++)
    {    
        AddProperty(hSMBProtocol, &amp;property_table[i]);
    }
</code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>hProperty</b></dt>
<dd>
Handle to the property. Assign at AddProperty time.</dd>
<dt>
<b>Version</b></dt>
<dd>
Set to zero. Unused at this time.</dd>
<dt>
<b>Label</b></dt>
<dd>
The name of the property.</dd>
<dt>
<b>Comment</b></dt>
<dd>
The description of property that shows up on the status bar.</dd>
<dt>
<b>DataType</b></dt>
<dd>
The data type of a property, such as Prop, Type or Byte.</dd>
<dt>
<b>DataQualifier</b></dt>
<dd>
The data qualifier of the property, such as Prop, Type, or Array.</dd>
<dt>
<b>lpExtendedInfo</b></dt>
<dd>
Reserved.</dd>
<dt>
<b>lpRange</b></dt>
<dd>
A pointer to a range structure.</dd>
<dt>
<b>lpSet</b></dt>
<dd>
A pointer to a set.</dd>
<dt>
<b>Bitmask</b></dt>
<dd>
A bitmask to apply.</dd>
<dt>
<b>Value</b></dt>
<dd>
Constant value.</dd>
<dt>
<b>FormatStringSize</b></dt>
<dd>
Maximum size to reserve for textual description.</dd>
<dt>
<b>InstanceData</b></dt>
<dd>
Property-specific instance data.
</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
