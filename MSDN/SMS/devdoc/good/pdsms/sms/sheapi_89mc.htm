<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SmsDataSourceConnect</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="sms_smsdatasourceconnect"></a>SmsDataSourceConnect</h1>
<p>
The <b>SmsDataSourceConnect</b> function connects to the site database that your application will access.</p>
<pre><code><b>SMS_STATUS SmsDataSourceConnect(
  DATASOURCE</b><i> *pd</i><b>, </b>// Pointer to DATASOURCE union containing the 
                  // connection information.
<b>  HANDLE</b><i> *phConn  </i>// Pointer to handle to receive connection handle.
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pd</i></dt>
<dd>
Specifies a <a href="sheapi_1485.htm"><b>DATASOURCE</b></a> union that specifies the site database to which your application needs to connect. (<b>DATASOURCE</b> is a union of structures.) Before calling <b>SmsDataSourceConnect</b>, your application must set the appropriate values for the members in this structure. For Microsoft SQL Server, your application must set the server name, login identifier, password, database, public encryption key, and a pointer to a decryption function for the <b>sqlParams</b> structure within the <b>DATASOURCE</b> union. (The decryption function is a callback function that <b>SmsDataSourceConnect</b> uses to decrypt the <b>pszUserName</b> and <b>pszPasswd</b> members so that they can be used as the login identifier and password for connecting to the site database.) If the pointer to the decryption function is set to NULL or the encryption key is NULL, no decryption function is called.
<p>
For an example of encryption and decryption functions and how they are used with <b>SmsDataSourceConnect</b>, see <a href="sheapi_2i5v.htm">Sample Decryption and Encryption Functions</a>.
</dd>
<dt>
<i>phConn</i></dt>
<dd>
Specifies the handle that will receive the handle to the specified database connection. You use the handle to open, access, and close containers for that site database.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The <b>SmsDataSourceConnect</b> function returns a status code SMS_STATUS. If successful, the function returns a status of SMS_OK. Otherwise, it returns one of the following manifest constants:
<dl>
<dt>
SMS_SQL_ERROR</dt>
<dd>
The connect failed because of a SQL Server error.</dd>
<dt>
SMS_INVALID_DATASOURCE</dt>
<dd>
The connect failed because the datasource type could not be registered.</dd>
<dt>
SMS_INVALID_HANDLE</dt>
<dd>
The database connection could not be made because of a memory allocation failure.</dd>
<dt>
SMS_ALREADY_CONNECTED</dt>
<dd>
Your application has an existing connection to the site database. An application can have only one connection to a site database at one time.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>SmsDataSourceConnect</b> assigns a connection handle to the specified handle. Your application uses the handle to open, access, and close containers for that site database.</p>
<p>
Currently, SMS supports one database type: Microsoft SQL Server. However, the SMS API is designed to allow support of other types of databases in the future.</p>
<p>
Note that your application can connect to one site database at a time. In addition, your application can have only one connection to that site database.</p>
<p>
After your application has finished accessing the site database, it should free the connection by calling the <a href="sheapi_44z8.htm"><b>SmsDataSourceDisconnect</b></a> function.</p>
<h4>Example</h4>
<p>
The following example connects to a SQL Server JS1 with a site database SMSBritain using login identifier jonathan and password hermes.</p>
<pre><code>HANDLE hConnect;
DATASOURCE dsParams;

    dsParams.sqlParams.ds          = DB_SQL;
    dsParams.sqlParams.pszServer   = "JS1";
    dsParams.sqlParams.pszUserName = "jonathan";
    dsParams.sqlParams.pszPasswd   = "hermes";
    dsParams.sqlParams.pszDbName   = "SMSBritain";
    dsParams.sqlParams.pFunc       = NULL;
    dsParams.sqlParams.pszKey      = "";

stat = SmsDataSourceConnect( &amp;dsParams, &amp;hConnect );
</code></pre>
<h4>See Also</h4>
<p>
<a href="sheapi_44z8.htm"><b>SmsDataSourceDisconnect</b></a></p>
<p>&nbsp;</p></body>
</HTML>
