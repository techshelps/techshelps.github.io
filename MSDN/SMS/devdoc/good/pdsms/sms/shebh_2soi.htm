<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Your Protocol Parser DLL To the Network Monitor</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="sms_installing_your_protocol_parser_dll_to_the_network_monitor"></a>Installing Your Protocol Parser DLL To the Network Monitor</h2>
<p>
This section uses the Finger protocol to show installation steps.</p>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install a protocol parser DLL to the network monitor</h5>
<ol>
<li>
Edit the PARSER.INI file and add your protocol:<pre><code>;============================================================
;   Network Monitor parser/protocol initialization file.
;============================================================

[PARSERS]
    FRAME.DLL   = 0: FRAME
    MAC.DLL     = 0: ETHERNET, TOKENRING, FDDI, TMAC
    LLC.DLL     = 0: LLC, RPL, SNAP, BPDU
    NETBIOS.DLL = 0: NETBIOS
    SMB.DLL     = 0: SMB
    XNS.DLL     = 0: XNS
    IPX.DLL     = 0: IPX, SAP, RIPX, NMPI, NBIPX, SPX
    TCPIP.DLL   = 0: IP, ARP_RARP, ICMP, UDP, NBT, TCP, DNS, TELNET, ...
    NCP.DLL     = 0: NCP
    ATALK.DLL   = 0: LAP, AARP, DDP, RTMP, NBP, ATP, PAP, ASP, ZIP, ...
    BONE.DLL    = 0: BONE
    MSRPC.DLL   = 0: MSRPC
    BROWSER.DLL = 0: BROWSER
    PPP.DLL     = 0: PPP, LCP
    FINGER.DLL  = 0: FINGER

[FRAME]
    Comment     = "Base frame properties"
    FollowSet   = PPP, ETHERNET, TOKENRING, FDDI
    HelpFile    =

[BROWSER]
    Comment     = "MS Browser"
    FollowSet   = 
    HelpFile    =

[FINGER]
    Comment     = "TCP Finger, port 79"
    FollowSet   = 
    HelpFile    =

...
 </code></pre>
</li>
<li>
Edit \PARSERS\TCPIP.INI under the Network Monitor Installed directory and add Finger to the handoff setup of TCP. See <a href="shebh_09df.htm">Handoffset Parsers</a>.</li>
<li>
Run Network Monitor and load a .CAP file that contains a Finger frame. Verify that the handoff worked correctly.</li>
<li>
Start writing the protocol parser. Remove the code that applies only to RemAPI. Note that the CommandSET defined for RemAPI will not work for Finger. However, the protocol that you are writing a parser for probably has a similar command field, so you may be able to convert this one.<p>
<b>Note</b>  Previous parsers hand off to the Finger parser. However, you may be writing a parser that appears in the follow set of another parser instead. If so, you need to add your protocol to the follow set in the PARSER.INI file of any preceding protocols, and modify the <b>RecognizeFrame</b> in your parser to determine whether the data belongs to your protocol.
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
