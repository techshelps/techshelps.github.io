<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Site Filters (SITE_FILTER)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="sms_site_filter"></a>Site Filters (SITE_FILTER)</h3>
<p>
A site filter specifies the sites that are retrieved for a site container. If no site filter is set on a site container, all sites in the site database (the current site and all sites below it in the site hierarchy) are retrieved for the container. Site filters can only be applied to site containers.</p>
<p>
Using the <a href="sheapi_6c6m.htm"><b>SmsAddToken</b></a> function, your application can add tokens to a site filter. The <b>TOKEN</b> structure that contains the expression token must have the following members:
<dl>
<dt>
<b>szName</b></dt>
<dd>
A string that specifies whether all sites in the site database are retrieved, or a specific site is retrieved.
<p>
"RootSite" specifies that all sites in the site database (the current site and all sites beneath it in the site hierarchy) are retrieved for the site container.

<p>
"SiteByCode" specifies that a specified site is retrieved for the site container. The <b>szValue</b> member contains the site code for the site.
</dd>
<dt>
<b>DwOp</b></dt>
<dd>
A DWORD value that specifies the operator used to evaluate the expression.
<p>
For site filters, this operator can only be QOP_STR_EQ. Note that if RootSite is specified for <b>szName</b>, this member is ignored.
</dd>
<dt>
<b>SzValue</b></dt>
<dd>
If <b>szName</b> is set to RootSite, this value should be NULL. If <b>szName</b> is set to SiteByCode, this value is a string that specifies the three-character site code of the site to retrieve.
<p>
For example, "TIM".

</dd>
</dl>
<p>
For site filters, the tokens can be connected only by using an OP_OR control token—this means that your application must pass OP_OR for the <i>opAndOr</i> parameter when calling the <b>SmsAddToken</b> function. In addition, only tokens that specify SiteByCode for <b>szName</b> can be combined. By combining SiteByCode tokens, your application can populate a site container with only the specified sites. If SiteByCode tokens are combined with a RootSite token, the RootSite token (which specifies all sites in the site database) will override the SiteByCode tokens and all sites will be retrieved.</p>
<p>
For example, your application could create a site filter with two tokens (one for a site with site code JS1 and the other for a site ASH) and set this filter on a site container. When your application populates the site container, the container contains folders that represent the specified sites.</p>
<p>
<b>Note</b>  There are two methods for retrieving all sites in a site database:</p>
<p>
If no site filter is set on a site container, all sites in the site database are retrieved and each site is represented as a top-level site folder. This is a flat list of sites. Note that if a site contains subsites, the subsites are also represented as subfolders of that site (in addition to the subsites' representation as top-level folders).</p>
<p>
If a site filter with RootSite specified for <b>szName</b> is set on a site container, all sites in the site database are retrieved, but the sites are represented in accordance with their hierarchy in the SMS system. This means that only the current site is represented as a top-level folder in the container, and that the subsites directly beneath the current site are represented as subfolders of the current site's folder. If those second-level subsites have their own subsites, third-level subsites are represented as subfolders of the second-level subsites, and so on.</p>
<h4>Example</h4>
<pre><code>// Function to add a token to a Site filter so that
// the filter retrieves the folder for 
// Tim World, which has a site code of TIM.

SMS_STATUS AddTokenToSiteFilter(HANDLE hFilter) 
                         //  Handle to Site filter.
{
SMS_STATUS stat;
TOKEN Token;
// Clear the Token structure.
memset( &amp;Token, 0, sizeof (TOKEN) );

// Set the expression token to 
// szName = "SiteByCode"
// dwOp = QOP_STR_EQ
// szValue = "TIM"

// Set the method of collection.
strcpy( Token.szName, "SiteByCode");
// Set the operator to string equals.
Token.dwOp = QOP_STR_EQ;
// Set the site code to TIM.
strcpy( Token.szValue, "TIM"); 

// Add the token to the filter.
stat = SmsAddToken( hFilter, // Specifies the handle to filter.
                    OP_OR,   // Must use the OR control token to 
                             // add a token to a Site filter.
                    &amp;Token,  // Specifies the structure containing
                             // the expression token.
                    AT_END   // Add the token to the end of 
                             // the filter.
                  );

if (stat == SMS_OK)    
    printf("The token was successfully added to the filter.\n");
else 
    printf("SmsAddToken error: %d\n", stat);

return stat;
}
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
