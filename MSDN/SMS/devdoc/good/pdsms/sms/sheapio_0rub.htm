<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Filters</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="sms_creating_filters"></a>Creating Filters</h2>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a filter</h5>
<ol>
<li>
Use the <a href="sheapi_3gvm.htm"><b>SmsCreateFilter</b></a> function to create a filter for use on the container. After your application uses the <b>SmsCreateFilter</b> function to create a filter, the filter is empty, that is, it has no tokens set. Your application should use the filter functions to set the tokens for the new filter.</li>
<li>
Configure the filter by adding tokens to the filter. There are two types of tokens: expression tokens and control tokens.<p>
An <a href="sheapio_19f7.htm#sms_expression_token"><i>expression token</i></a> defines how to search for objects that have a specified relationship to a specified value for a specified attribute. A <a href="sheapi_0awe.htm"><b>TOKEN</b></a> structure is used to specify the criterion for the expression. Note that each filter type has its own set of attribute types that can be evaluated. For example, a PACKAGE_FILTER evaluates only the package type (example: package type is equal to Workstation), whereas a MACHINE_FILTER evaluates any attribute for any group for a particular architecture (example: Processor Name attribute of the MICROSOFT|PROCESSOR|1.0 group class for the Personal Computer architecture is like 486). In addition, each filter type requires specific members of the <b>TOKEN</b> structure to be assigned. For example, to add an expression token to a PACKAGE_FILTER, the <b>TOKEN</b> structure must specify the <b>szName</b>, <b>DwOp</b>, and <b>szValue</b> members. For a MACHINE_FILTER, the <b>TOKEN</b> structure must specify the <b>szArchitecture</b>, <b>szGroupClass</b>, <b>szAttributeName</b>, <b>DwOp</b>, and <b>szValue</b> members.
<p>
For information about the tokens required for each filter type, see the appropriate topic under <a href="sheapio_7yk3.htm">Filter Types</a>.
<p>
A <a href="sheapio_19f7.htm#sms_control_token"><i>control token</i></a> can be a logical operator or parentheses. A logical operator (<b>AND</b> and <b>OR</b>) defines the relationship between two adjacent expressions. Parentheses enable expressions to be grouped together. A <b>TOKEN</b> structure is used to specify the type of logical operator.
<p>
To add expression tokens to a filter, use the <a href="sheapi_6c6m.htm"><b>SmsAddToken</b></a> function. When an expression token is added to a filter, a control token for a logical operator is also added at the same time.
<p>
To delete, exclude, group, or ungroup tokens within a filter, use the <a href="sheapi_29o3.htm"><b>SmsManipulateTokens</b></a> function.
<p>
To get information about an existing token in a filter, use the <a href="sheapi_8jzi.htm"><b>SmsGetToken</b></a> function.
<p>
To get the count of existing tokens in a filter, use the <a href="sheapi_97g4.htm"><b>SmsGetTokenCount</b></a> function.
</li>
</ol>
<p>
To use the filter, your application must use the <a href="sheapi_3z5e.htm"><b>SmsSetFilter</b></a> function to apply the filter to a container that supports the filter type. After applying the filter to a container, your application must use the <a href="sheapi_4u79.htm"><b>SmsPopulate</b></a> function to query the site database for folders that meet the criteria set by the filters applied to the container.</p>
<p>&nbsp;</p></body>
</HTML>
