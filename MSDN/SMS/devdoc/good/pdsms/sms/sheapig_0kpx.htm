<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TESTALL.EXE</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="sms_testall.exe"></a>TESTALL.EXE</h2>
<h4>Overview</h4>
<p>
This program illustrates the use of the SMS functions to examine a site hierarchy, package container, or job container. For each type of container, the user is prompted for which of the standard sets of filters to apply. The container is then populated, and enumerated to the console.</p>
<h4>Running the Program</h4>
<p>
TESTALL.EXE runs as a console application. The program prompts you to enter the information needed to connect to SQL Server, then prompts you to specify Sites, Jobs, or Packages. </p>
<p>
When viewing a Site hierarchy, the program will display the site/domain/machine/machine group tree for the associated datasource according to the filter conditions that you specify during program execution.</p>
<p>
When viewing a job container, the user can select a Run Command On Workstation job (w), Share Package On Server job (s), Remove Package From Server job (r), or System job (y). Make one selection per line, and type <b>x</b> to specify no more job types. Selections are connected by the <b>OR</b> operator, so it is possible to select multiple job types. It is also possible to select no filters (x), in which case the system displays all job types.</p>
<p>
When viewing a package container, the user can select a workstation package (w), a server package (s), or an inventory package (i). Make one selection per line, and type <b>x</b> to specify no more package types. Selections are connected by the <b>OR</b> operator, so it is possible to select multiple package types. It is also possible to select no filters (x), in which case the system displays all package types.</p>
<p>
For both jobs and packages, the program will enumerate all folders and subfolders in the specified container. For each folder it will then display all scalars. After displaying the appropriate data, the program will allow you to restart (examine a new container) or quit.</p>
<h4>Functions</h4>
<p>
<a href="sheapi_18ky.htm"><b>SmsAPIVer</b></a><br>
<a href="sheapi_89mc.htm"><b>SmsDataSourceConnect</b></a><br>
<a href="sheapi_44z8.htm"><b>SmsDataSourceDisconnect</b></a><br>
<a href="sheapi_0bea.htm"><b>SmsOpenContainer</b></a><br>
<a href="sheapi_2vg2.htm"><b>SmsCloseContainer</b></a><br>
<a href="sheapi_4u79.htm"><b>SmsPopulate</b></a><br>
<a href="sheapi_45pw.htm"><b>SmsGetFolderCount</b></a><br>
<a href="sheapi_58ky.htm"><b>SmsGetNextFolder</b></a><br>
<a href="sheapi_7tb8.htm"><b>SmsGetFolderID</b></a><br>
<a href="sheapi_0tt1.htm"><b>SmsGetFolderType</b></a><br>
<a href="sheapi_9ab8.htm"><b>SmsGetScalarCount</b></a><br>
<a href="sheapi_16ia.htm"><b>SmsGetNextScalar</b></a><br>
<a href="sheapi_3gvm.htm"><b>SmsCreateFilter</b></a><br>
<a href="sheapi_3z5e.htm"><b>SmsSetFilter</b></a><br>
<a href="sheapi_4zsi.htm"><b>SmsCloseFilter</b></a><br>
<a href="sheapi_6c6m.htm"><b>SmsAddToken</b></a><br>
<a href="sheapi_8jzi.htm"><b>SmsGetToken</b></a><br>
<a href="sheapi_97g4.htm"><b>SmsGetTokenCount</b></a></p>
<h4>Program Flow</h4>
<p>
This program illustrates the use of the SMS functions to examine a site hierarchy, package container, or job container. The only difference in code between them is the setting of filters. </p>
<p>
The code connects to the datasource and prompts the user to select the type of container to view. The user then is asked to select and apply valid filters for the container. All folders in the container are then retrieved, and the folder handles are stored in an array. The container is closed after the folder handles have been stored. The folders are then displayed recursively.</p>
<p>
Note that the container is closed before the folders are displayed. This allows the memory used by the folders themselves to be recovered as soon as the folders are closed. Folders all have reference counts and will only be released when this count falls to zero. This technique is also used inside the <b>DisplayFolder</b> function in the sample.</p>
<p>&nbsp;</p></body>
</HTML>
