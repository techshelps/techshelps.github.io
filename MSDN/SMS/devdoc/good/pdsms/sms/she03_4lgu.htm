<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMS Requirements for Unattended Installation and Deinstallation</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="sms_sms_requirements_for_unattended_installation_and_deinstallation"></a>SMS Requirements for Unattended Installation and Deinstallation</h1>
<p>
A software setup or installation program used in the SMS environment must support unattended installation and deinstallation in the following ways:
<dl>
<dt>
<b>Operate in unattended mode</b></dt>
<dd>
It is mandatory that the program not require input from the user during the installation, removal, or maintenance of the application. Any information or options required by the setup program should be supplied by command-line switches to the program, or should be provided in a configuration file that is read by the program at run time or by some other means such as the Windows Registry.
<p>
Your application must not show any dialog boxes or windows during installation/deinstallation or maintenance. This is required for completely unattended installation/deinstallation using the Package Command Manager.
</dd>
<dt>
<b>Do not force restart</b></dt>
<dd>
Because multiple packages can be installed by SMS at one time, no individual package installation should force a restart as part of its installation program. Instead, the PCM has the capability of intercepting restart requests and queuing them up until all packages have been installed, offering the user the opportunity to save any work in progress before the restart.</dd>
<dt>
<b>Pass restart instructions to the PCM</b></dt>
<dd>
To copy system files that may be in use, setup programs typically construct a batch file containing operations that must be performed during a restart, such as running an MS-DOS program by using <b>ExitWindowsExec</b>, and then restarting Windows.
<p>
In order to set up multiple programs before a restart, the PCM prevents the restart, and then performs an <b>ExitWindowsExec</b> when the user elects to do so.

<p>
To coordinate multiple unattended setups, concatenate the batch file of each setup program to the file _MSSETUP.BAT. If _MSSETUP.BAT does not exist, then rename the batch file of the first setup program to _MSSETUP.BAT and concatenate the batch files of additional setup programs to that file. Next, create an _MSRSTRT.EXE program to be executed by the PCM when it calls <b>ExitWindowsExec</b>. This MS-DOS program (_MSRSTRT.EXE) must execute the batch file _MSSETUP.BAT and then delete the batch file and itself. 

<p>
After the installations are complete, if the PCM detects both _MSSETUP.BAT and _MSRSTRT.EXE in the Windows directory, it displays a dialog box prompting the user to exit Windows and restart. This dialog box does not interfere with subsequent installations.

</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
