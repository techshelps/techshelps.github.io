<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SmsPopulate</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="sms_smspopulate"></a>SmsPopulate</h1>
<p>
The <b>SmsPopulate</b> function fills the <a href="sheapio_1jar.htm">container</a> with objects from the site database.</p>
<pre><code><b>SMS_STATUS SmsPopulate(
  HANDLE</b><i> hContainer</i><b>,  </b>// Handle to container.
<b>  DWORD</b><i> dwOptions</i><b>,    </b>// Flags for retrieval mode and notification.
<b>  NOTIFY</b><i> *pNotify     </i>// Pointer to NOTIFY structure for the 
                      // retrieval notification.
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hContainer</i></dt>
<dd>
Specifies the handle to the container to populate.</dd>
<dt>
<i>dwOptions</i></dt>
<dd>
Specifies the flags for the retrieval mode and the type of retrieval notification.
<p>
For <a href="sheapio_5elu.htm">package containers</a> and <a href="sheapio_1gky.htm">job containers</a>, only synchronous mode is supported.

<p>
For containers that contain machine folders (<a href="sheapio_4zhu.htm">site container</a>, <a href="sheapio_3oky.htm">site group container</a>, <a href="sheapio_3mlu.htm">machine container</a>, and <a href="sheapio_8zoy.htm">machine group container</a>), the <b>SmsPopulate</b> function can retrieve folders in one of two modes:

<dl>
<dt>
Synchronous</dt>
<dd>
Your application waits until all <a href="sheapio_5g1f.htm">folders</a> that satisfy the filter criteria are retrieved and then goes on to the next line of code. To retrieve folders in synchronous mode, use POP_SYNC.</dd>
<dt>
Asynchronous</dt>
<dd>
Your application goes immediately to the next line of code while the SMS API engine retrieves all folders that satisfy the filter criteria. You can set additional flags that specify that the SMS API engine should set an event handle or post a message to a window each time a specified number of objects are retrieved. The frequency of retrieval notification, the event handle, and window handle and message are specified by the <a href="sheapi_67eh.htm"><b>NOTIFY</b></a> structure specified by <i>pNotify</i>.

<p>
<b>Important </b>An event is a type of synchronization object provided by the Win32 API. It is the responsibility of your application to create a valid event object and reset the event object by using the synchronization functions of the Win32 API. Given a handle to a valid event object through the <b>NOTIFY</b> structure, the SMS API engine sets the event to the signaled state when the specified number of folders have been retrieved.


<p>
To retrieve folders in asynchronous mode, set the POP_ASYNC flag.

<p>
If the POP_ASYNC and POP_EVENT flags are set for <i>dwOptions</i>, the SMS API engine sets the event specified by the <b>hEvent</b> member of <i>pNotify</i> structure to the signaled state. The SMS API engine sets an event handle to the signaled state each time a specified number of objects are retrieved and when all objects are retrieved. If the POP_ASYNC and POP_WINDOW flags are set for <i>dwOptions</i>, the SMS API engine posts the message specified by the <b>uiMsg</b> member of <b><i>pNotify</i></b> structure to the window specified by the <b>hwnd</b> member. The SMS API engine posts a message to a window each time a specified number of objects are retrieved and when all objects are retrieved.


<p>
<b>Important </b>Asynchronous retrieval can be used only on machine, machine group, site, and site group containers. Although the <b>SmsPopulate</b> function applies to containers, the asynchronous behavior goes into effect only when retrieving machine folders from their parent folders or containers. For machine containers, the asynchronous behavior is in effect when <b>SmsPopulate</b> is called, because machine folders are the top-level folder in the container.

<p>
However, the machine folders in a site container are lower-level folders contained within the domain folders within site folders. When your application uses asynchronous population on a site container, the asynchronous retrieval takes effect when your application accesses the folder containing the machine folders—that is, the domain folder. The site folders and the domain folders are not retrieved asynchronously. This means that your application should wait on an event only after machine retrieval in a domain folder or a machine container has been triggered—the event will never be set to the signaled state if no machines are retrieved, and the wait function (such as <b>WaitForSingleObject</b>) will time out.

<p>
In addition, when using asynchronous retrieval with events or window messages for site containers and site group containers, there are some special issues that need to be addressed (such as triggering machine retrieval in domain folders). For more detailed information, see <a href="sheapio_4g2t.htm">Populating Containers in Asynchronous Mode</a>.


<p>
If only the POP_ASYNC flag is set, <b>SmsPopulate</b> performs no notification.

</dd>
<dt>
POP_SYNC</dt>
<dd>
Retrieve folders in synchronous mode.</dd>
<dt>
POP_ASYNC</dt>
<dd>
Retrieve folders in asynchronous mode.</dd>
<dt>
POP_EVENT</dt>
<dd>
Set an event handle each time the specified number of objects is retrieved and when all objects have been retrieved. In the <b><i>pNotify</i></b> structure, your application should specify a frequency and an event handle that will be set by the SMS API engine .</dd>
<dt>
POP_WINDOW</dt>
<dd>
Post a message to a window each time the specified number of objects is retrieved or when all objects have been retrieved. In the <b><i>pNotify</i></b> structure, your application should specify a frequency, a window handle, and the message to post to the window.
</dd>
</dl>
</dd>
<dt>
<i>pNotify</i></dt>
<dd>
Specifies a pointer to a <a href="sheapi_67eh.htm"><b>NOTIFY</b></a> structure that the SMS API engine uses to report retrieval notification.
<p>
If the POP_SYNC flag is specified for <i>dwOptions</i>, set this value to NULL.

<p>
This structure is only used if POP_ASYNC is specified in <i>dwOptions</i>. The <b>dwFreq</b> member specifies the frequency of retrieval notification. Each time the SMS API engine has retrieved the number of objects specified by <b>dwFreq</b>, it notifies your application by setting an event or by posting a message to a window. In addition, the SMS API engine notifies your application when all objects have been retrieved.

<p>
The type of notification depends on the flags set in the <i>dwOptions</i> parameter. If the POP_ASYNC and POP_EVENT flags are set for <i>dwOptions</i>, the SMS API engine sets the event specified by the <b>hEvent</b> member to the signaled state. If the POP_ASYNC and POP_WINDOW flags are set for <i>dwOptions</i>, the SMS API engine posts the message specified by the <b>uiMsg</b> member to the window specified by the <b>hwnd</b> member.


<p>
<b>Note</b>  Your application is responsible for specifying a valid event handle for the <b>hEvent</b> member of the <b>NOTIFY</b> structure.

</dd>
</dl>
<h4>Return Values</h4>
<p>
The <b>SmsPopulate</b> function returns a status code SMS_STATUS. If successful, the function returns a status of SMS_OK. Otherwise, it returns one of the following manifest constants:
<dl>
<dt>
SMS_INVALID_HANDLE</dt>
<dd>
The specified container handle is not a valid container handle.</dd>
<dt>
SMS_CONTAINER_POPULATED</dt>
<dd>
The specified container is already populated.</dd>
<dt>
SMS_EMPTY</dt>
<dd>
The container was populated but returned no folders—no objects of the type specified were found in the site database.</dd>
<dt>
SMS_ERROR</dt>
<dd>
An unexpected error occurred.
<p>
Note that an insufficient size for the tempdb on the SQL Server containing the site database can cause this error to occur.

<p>
To size the tempdb, you should allocate 2K per machine (that is, 2K for each inventoried object, including objects of all architectures such as Personal Computer, SMSEvent, UserGroups, and so on). The log device should be at least 20 percent of the size of the data device. For example, if you have 50,000 machines in your SMS database, you should allocate at least 100 MB total for the tempdb and at least 20 MB for the tempdb log.
</dd>
<dt>
SMS_INVALID_PARAMETER</dt>
<dd>
Asynchronous population was specified for a container type that does not support asynchronous population. Note that job containers and package containers do not support asynchronous population.
<p>
—or—

<p>
An invalid window handle was specified in the <b>hwnd</b> member of the <b><i>pNotify</i></b> structure.
</dd>
<dt>
SMS_NOT_READY</dt>
<dd>
<b>SmsPopulate</b> was used to retrieve folders in asynchronous mode and an attempt was made to access folders in a container before some or all folders were retrieved from the site database.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>SmsPopulate</b> initiates the retrieval process, which is carried out by the SMS API engine—<b>SmsPopulate</b> does not perform the actual retrieval itself. For asynchronous population, <b>SmsPopulate</b> returns immediately while the SMS API engine retrieves folders from the site database. The SMS API engine uses the information in the <b>NOTIFY</b> structure passed to it by <b>SmsPopulate</b> to post a window message or signal an event each time the specified number of folders is retrieved and when all folders are retrieved.</p>
<p>
<b>SmsPopulate</b> retrieves the objects (which are represented as folders within the container) that satisfy the criteria specified by the filters applied to the container.</p>
<p>
Filters can only be applied to containers. However, a filter may not take effect on the first level of folders within a container. Filters are only applied to folders that accept the filter's filter type.</p>
<p>
For example, if an <a href="sheapio_027m.htm">attribute filter</a> (ATTRIBUTE_FILTER) is applied to a site container, the attribute filter has no effect on the set of domain folders or site folders that are retrieved when the site container is populated. However, the attribute filter will be applied to the machine folders within the domain folders. For each machine folder, the attribute filter determines which group folders are retrieved.</p>
<p>
If your application does not set a filter on the container by using the <a href="sheapi_3z5e.htm"><b>SmsSetFilter</b></a> function, <b>SmsPopulate</b> fills the container with folders that represent all objects (of the type supported by the container) in the site database.</p>
<p>
<b>Note</b>  Folders retrieved by <b>SmsPopulate</b> represent the set of objects in the site database at the time when <b>SmsPopulate</b> is called by your application. Any objects added to the site database after <b>SmsPopulate</b> is called are not reflected in the list of folders within the container. Currently, containers cannot be refreshed. To get the latest information from the site database, your application must open and populate a new container, and then access the information in the new container.</p>
<h4>Example</h4>
<p>
For examples of asynchronous population, see <a href="sheapio_4g2t.htm">Populating Containers in Asynchronous Mode</a>.</p>
<p>&nbsp;</p></body>
</HTML>
