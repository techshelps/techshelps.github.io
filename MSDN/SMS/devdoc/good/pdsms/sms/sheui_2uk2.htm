<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Resource DLLs for the SMS Administrator</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="sms_installing_resource_dlls_for_the_sms_administrator"></a>Installing Resource DLLs for the SMS Administrator</h1>
<p>
To enable the SMS Administrator to use the graphics in a resource-only DLL, you must install the DLL and add keys to the Windows NT Registry of the computer where the SMS Administrator is installed.</p>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install resource-only DLLs for the SMS Administrator</h5>
<ol>
<li>
Install the resource-only DLLs in a directory that is in the path of the computer where the SMS Administrator is installed.</li>
<li>
Add keys that specify the DLLs to the Windows NT Registry of the computer where the SMS Administrator is installed.</li>
<li>
If the SMS Administrator is running, exit and restart it.</li>
</ol>
<p>
These steps are described in detail in the following paragraphs.</p>
<h4>Install the resource-only DLLs in a directory</h4>
<p>
Install the resource-only DLLs in a directory that is in the path of the computer where the SMS Administrator is installed. Optionally, you can place the DLLs in their own directory and specify a fully qualified path when you configure the Windows NT Registry to complete the installation of the DLL.</p>
<p>
<b>Caution</b>  Do not install your resource-only DLLs in a purgeable SMS directory.</p>
<p>
When the SMS setup program is used to upgrade site components, the SMS setup program removes all files from the SMS directories marked with the SM_DIRECTORY_PURGEABLE flag in the SYSTEM.MAP file. Those files are then replaced with files copied from the SMS CD-ROM by SMS Setup. The following directories are purgeable SMS directories:
<ul>
<li>
<i>sms_install_drive</i>:\<i>smsroot</i>\SITE.SRV\<i>platform</i>.BIN</li>
<li>
<i>sms_install_drive</i>:\<i>smsroot</i>\SITE.SRV\CLIENT.SRC</li>
<li>
<i>sms_install_drive</i>:\<i>smsroot</i>\SITE.SRV\MAINCFG.BOX\CLIENT.SRC\<i>platform</i>.BIN</li>
</ul>
<p>
where <i>sms_install_drive</i> is the drive where SMS is installed, <i>smsroot</i> is the name of the directory where the SMS installation directory resides, and <i>platform</i>.BIN is the processor type of the computer—X86.BIN, ALPHA.BIN, or MIPS.BIN.</p>
<p>
Note that you can create subdirectories within purgeable directories. These subdirectories and their contents will not be removed on an upgrade. However, if SMS is removed from the computer the entire SMS root directory is removed.</p>
<h4>Add keys to specify the DLLs to the Windows NT Registry</h4>
<p>
The set of DLLs can be specified by using the following registry keys:
<dl>
<dt>
<b>HKEY_CURRENT_USER\Software\Microsoft\SMS\ResDLLs</b></dt>
<dd>
Specifies the resource-only DLLs to be used only by the current user. The SMS Administrator searches for a resource in the list of DLLs in this key first.</dd>
<dt>
<b>HKEY_LOCAL_MACHINE\Software\Microsoft\SMS\ResDLLs</b></dt>
<dd>
Specifies the resource-only DLLs to be used by any user on that computer. If the resource is not found in the DLLs in <b>HKEY_CURRENT_USER</b>, the SMS Administrator then searches for a resource in the list of DLLs in this key.
</dd>
</dl>
<p>
When the SMS Administrator searches for display graphics in the resource-only DLLs, it searches the DLLs in the following order:
<ol>
<li>
DLLs listed in <b>HKEY_CURRENT_USER</b>. The SMS Administrator uses the reverse of the order listed in the Installed value to search the DLLs.</li>
<li>
DLLs listed in <b>HKEY_LOCAL_MACHINE</b>. The SMS Administrator uses the reverse of the order listed in the Installed value to search the DLLs.</li>
<li>
SMS Administrator's own application resources. Note that some architectures, objects, and groups (such as the Personal Computer architecture, Macintosh workstation computers, and the Processor and Disk groups) have graphics predefined in the SMS Administrator's resources. However, these graphics can be overriden by a resource-only DLL.</li>
</ol>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To add a DLL to the list of DLLs to be searched</h5>
<ol>
<li>
Add a <b>ResDLLs</b> key beneath one of the following keys (if the key does not already exist):<p>
<b>HKEY_LOCAL_MACHINE\Software\Microsoft\SMS</b>
<p>
<b>HKEY_CURRENT_USER\Software\Microsoft\SMS</b>
<p>
Use <b>HKEY_LOCAL_MACHINE</b> if you want the DLL available to all users of the computer. Use <b>HKEY_CURRENT_USER</b> if you want the DLL available to only the current user.
</li>
<li>
In the <b>ResDLLs</b> key, add a value called Installed with a type of REG_MULTI_SZ (if the key does not already exist).</li>
<li>
In the Installed value, add the name of key for the new DLL you want to add, such as DLLName1.</li>
<li>
Add the key for the new DLL beneath the <b>ResDLLs</b> key. For example, if you specified the name of the key to be DLLName1 in the Installed value, you must create a key named DLLName1 beneath the <b>ResDLLs</b> key.</li>
<li>
In the key for the new DLL, add a value with the name PathName, a type of REG_SZ, and a value that specifies the path and file name. For the value, you can specify only the file name or a fully qualified path.</li>
</ol>
<h4>Exit and restart the SMS Administrator</h4>
<p>
If the SMS Administrator is running, exit and restart it.</p>
<p>
This is a sample registry configuration:</p>
<pre><code>HKEY_CURRENT_USER
    Software
        Microsoft
            SMS
                ResDLLs
                    Installed   REG_MULTI_SZ    DLLName1
                                                DLLName2
                                                DLLName3
                    DLLName1    PathName    REG_SZ    myres.dll
                    DLLName2    PathName    REG_SZ    myicons.dll
                    DLLName3    PathName    REG_SZ    oemicons.dll
</code></pre>
<p>
In the preceding example, the SMS Administrator would search for a named graphic in the following order: OEMICONS.DLL, MYICONS.DLL, MYRES.DLL, and finally the SMS application resource.</p>
<p>&nbsp;</p></body>
</HTML>
