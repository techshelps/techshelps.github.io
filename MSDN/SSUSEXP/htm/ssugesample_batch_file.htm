<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sample Batch File</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="ssugesample_batch_file"></a>Sample Batch File</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="ssugeWriting_Batch_Files">
</object><a href=JavaScript:alink_1.Click()>See Also</a></p>
<p>
If you type <b>ss Checkout Help.c Help.H</b>, and one of the two files is already checked out, VSS checks the other file out. The following batch file avoids this situation by checking the status of all the specified files and only checking them out if none of them is checked out.</p>
<p>
The following sample demonstrates many of the features described in the two help topics <a href="ssugeredirect_output.htm">How to Redirect Output</a> and <a href="ssugedisable_input.htm">How to Disable Input</a>, including the use of the following options: 
<ul type=disc>
<li>
<b>-o</b> to disable output<br><br></li>
<li>
<b>-y</b> to specify a username<br><br></li>
<li>
<b>-c</b> to specify a comment</li>
</ul>
<p>
This sample also uses the exit code of the <b>Status</b> command to determine whether files are checked out.</p>
<p class=label>
<b>Sample of a Batch File</b></p>
<pre><code>@echo off
ss status -o- -yThomas %1 %2 %3 %4 %5 %6 %7 %8 %9
if errorlevel 100 goto BAD_FAILURE
if errorlevel 1 goto CHECKED_OUT

rem Exit code 0, no files were checked out
echo No specified files are checked out: checking all out.
ss checkout "-cChecked out automatically" -yThomas %1 %2 %3 %4 %5 %6 %7 %8 %9
goto END

rem Exit code 1, something is checked out
:CHECKED_OUT
echo One or more files is checked out: quitting without checking anything out.
goto END

rem Exit code 100, something went wrong.
:BAD_FAILURE
echo Visual SourceSafe could not run successfully

:END
</code></pre>
</BODY>
</HTML>
