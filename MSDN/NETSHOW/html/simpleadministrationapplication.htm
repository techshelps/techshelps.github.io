<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Simple Administration Application</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h4><a name="simpleadministrationapplication"></a>Simple Administration Application</h4>
<p>
This application uses all of the View controls on one form. It adds three Title Servers to the ServerView control named TitleServer1, TitleServer2, and TitleServer3. Information about the server currently selected in ServerView, is dynamically displayed in the TitleView, ClientView, and TraceView controls.</p>
<h6>Form Layout</h6>
<p>
From the Visual Basic toolbox, place and size the ServerView, ClientView, TitleView and TraceView controls onto a form. Your form should look similar to the following:</p>
<p>
<img src="nst_vbsample1.gif" border=0></p>
<h6>Initializing the Controls</h6>
<p>
Add the following code to the <b>Form_Load</b> event to add the Title Servers to the ServerView control and set the other controls to display data about the first server in the list. Save the name of the first server in the list so you can check to see when it changes.</p>
<pre><code>Dim strSelectedServer As String

Private Sub Form_Load()
 ' Add servers to ServerView tree
 ServerView1.AddServer ("TitleServer1")
 ServerView1.AddServer ("TitleServer2")
 ServerView1.AddServer ("TitleServer3")

 ' Save the default server name
 strSelectedServer = "TitleServer1"

 ' Set other view controls to default to 1st server
 ClientView1.SetServer (strSelectedServer)
 TitleView1.SetServer (strSelectedServer)
 TraceView1.SetServer (strSelectedServer)
 
End Sub</code></pre>
<h6>Selecting a New Server</h6>
<p>
Each time a new selection is made in the ServerView control, an <b>OnSelectionChange</b> event is triggered. This event can be used to change the data displayed in the other controls if a different server is selected. The following code uses the server name we saved in the FORM_LOAD procedure to determine if the server has changed.</p>
<pre><code>Private Sub ServerView1_OnSelectionChanged(ByVal selection As Long, ByVal infotype As NSTAdminCtl.BaseInfoType)

Dim strNewServer As String ' New server selected 
Dim objServer As Object ' Temp object

' 
Set objServer = ServerView1.GetItemObject
strNewServer = objServer.Name

' If the server name has changed,
' set other view controls to new server.
If strNewServer &lt;&gt; strSelectedServer Then
 &nbsp; strSelectedServer = strNewServer
 &nbsp; ClientView1.SetServer (strSelectedServer)
 &nbsp; TitleView1.SetServer (strSelectedServer)
 &nbsp; TraceView1.SetServer (strSelectedServer)
End If

End Sub
</code></pre>
<h6>Running the Application</h6>
<p>
Change the name values being passed in to the <b>AddServer</b> method to valid Title servers. If you connect successfully, your application should look something like this:</p>
<p>
<img src="nst_vbsample2.gif" border=0></p>
<p class=indent>
<b>Tip:</b> &nbsp; You can place each control on a tab of a tabbed dialog control, such as the Microsoft® Tabbed Dialog Control.</p>
<A HREF="legal.htm">&copy; 1996-1998 Microsoft Corporation. All rights reserved.</A></BODY>
</HTML>
