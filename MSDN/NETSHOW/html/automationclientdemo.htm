<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automation Client Demo</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="automationclientdemo"></a>Automation Client Demo</h2>
<p>
The following sample code can be pasted into a Microsoft Visual Basic application. The code is separated into three parts:
<ul type=disc>
<li>
Code to start the Encoder is attached to a button named <b>Start</b>.</li>
<li>
Code to stop the Encoder is attached to a button named <b>Stop</b>.</li>
<li>
Code to generate a report on the property values is attached to a button named <b>DoReport</b>. The report is displayed in a multiline text box named <b>Report</b>.</li>
<li>
A control named <b>Encoding</b> becomes visible to indicate that the server is encoding.</li>
</ul>
<p>
Minimal error checking is included.</p>
<p>
The following tasks must be completed before the client application can run.
<ul type=disc>
<li>
The Encoder must be installed.</li>
<li>
A session must be created and saved to an .asd file named <i>Sample.asd</i>.</li>
</ul>
<p>
Note that the declaration of the Encoder (<b>RTE</b>) object is outside of the private subroutines. The object must be created and started to read the properties.</p>
<pre><code>Dim RTE As Object

Private Sub Start_Click()
  On Error Resume Next
  Set RTE = CreateObject("Asf.NSASFRte")
  If Err.Number Then MsgBox "Object not loaded."
  RTE.LoadASD("c:\Sample.asd")
  If Err.Number Then MsgBox "ASD file not loaded."
  RTE.Start
  Encoding.Visible = True
End Sub

Private Sub Stop_Click()
  On Error Resume Next
  RTE.Stop
  Set RTE = Nothing
  Encoding.Visible = False
End Sub


Private Sub DoReport_Click()
  On Error Resume Next
  If Not RTE.IsStarted Then MsgBox "RTE not running": Exit Sub
  Report.Text = "The Encoder has started."
  Report.Text = Report.Text &amp; vbCrLf &amp; "Description: " &amp; RTE.Description
  Report.Text = Report.Text &amp; vbCrLf &amp; "IP Port: " &amp; RTE.IPPort
  Report.Text = Report.Text &amp; vbCrLf &amp; "AllowScripts: " &amp; RTE.AllowScript
  Report.Text = Report.Text &amp; vbCrLf &amp; "AllowVideo: " &amp; RTE.AllowVideo
  Report.Text = Report.Text &amp; vbCrLf &amp; "AllowAudio: " &amp; RTE.AllowAudio
  Report.Text = Report.Text &amp; vbCrLf &amp; "ImageWidth: " &amp; RTE.ImageWidth
  Report.Text = Report.Text &amp; vbCrLf &amp; "ImageHeight: " &amp; RTE.ImageHeight
  Report.Text = Report.Text &amp; vbCrLf &amp; "FramesPerSecond: " &amp; RTE.FramesPerSecond
  Report.Text = Report.Text &amp; vbCrLf &amp; "SecondsPerIFrame: " &amp; RTE.SecondsPerIFrame
  Report.Text = Report.Text &amp; vbCrLf &amp; "BitsPerPixel: " &amp; RTE.BitsPerPixel
  Report.Text = Report.Text &amp; vbCrLf &amp; "VideoInputFOURCC: " &amp; RTE.VideoInputFOURCC
  Report.Text = Report.Text &amp; vbCrLf &amp; "DelayBuffer: " &amp; RTE.DelayBuffer
  Report.Text = Report.Text &amp; vbCrLf &amp; "AudioFormatTag: " &amp; RTE.AudioFormatTag
  Report.Text = Report.Text &amp; vbCrLf &amp; "AudioSource: " &amp; RTE.AudioSource
  Report.Text = Report.Text &amp; vbCrLf &amp; "VideoCodecFOURCC: " &amp; RTE.VideoCodecFOURCC
  Report.Text = Report.Text &amp; vbCrLf &amp; "Bandwidth: " &amp; RTE.Bandwidth
  Report.Text = Report.Text &amp; vbCrLf &amp; "InputSourceFile: " &amp; RTE.InputSourceFile

  If RTE.IsNetEnabled Then
  Report.Text = Report.Text &amp; vbCrLf &amp; "NetShowServer: " &amp; RTE.NetShowServer
  Report.Text = Report.Text &amp; vbCrLf &amp; "StreamAlias: " &amp; RTE.StreamAlias
  Report.Text = Report.Text &amp; vbCrLf &amp; "NumClients: " &amp; RTE.NumClients
  EndIf

  If RTE.IsRecording Then
  Report.Text = Report.Text &amp; vbCrLf &amp; "RecordDuration: " &amp; RTE.RecordDuration
  Report.Text = Report.Text &amp; vbCrLf &amp; "RecordMaxSize: " &amp; RTE.RecordMaxSize
  Report.Text = Report.Text &amp; vbCrLf &amp; "RecordSize: " &amp; RTE.RecordSize
  Report.Text = Report.Text &amp; vbCrLf &amp; "RecordFileName: " &amp; RTE.RecordFileName
  EndIf

  End Sub
</code></pre>
<A HREF="legal.htm">&copy; 1996-1998 Microsoft Corporation. All rights reserved.</A></BODY>
</HTML>
