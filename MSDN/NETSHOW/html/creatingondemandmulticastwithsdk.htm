<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Multicast with the SDK</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h3><a name="creatingondemandmulticastwithsdk"></a>Creating an On-Demand Multicast with the SDK</h3>
<p>
You can set up and start a multicast using the NetShow SDK instead of the NetShow administrative application. This section outlines the steps needed to set up a basic multicast to distribute content on demand, using only the SDK. The following examples are written from the perspective of doing local administration.</p>

<h4><a name="instantiatestationmanagerobject"></a>Instantiate the Station Manager Object</h4>
<p>
Create an instance of the station manager object. The following code is straight HTML code, so it should not be within a SCRIPT section.</p>
<pre><code>&lt;OBJECT ID="MCM" HEIGHT=1 WIDTH=1
   CLASSID="CLSID:B00464B3-67D4-11D0-A464-00C04FC29CFB"&gt;
&lt;/OBJECT&gt;</code></pre>

<h4><a name="connecttonetshowserver"></a>Connect to the NetShow Server</h4>
<p>
Open a connection to the NetShow server. In this example, the new station manager object is called MCM. It connects to a NetShow server running on the same computer where the script is being run. However, as long as the Station Manager Control is installed locally, you can also connect to a remote computer that is running the NetShow server.</p>
<pre><code>MCM.Connect "LocalHost"</code></pre>

<h4><a name="createnewstation"></a>Create a New Station</h4>
<p>
You create a station for the multicast using the <a href="streamsopen.htm"><b>Open</b></a> method.. In this example the first parameter for the <b>Open</b> method specifies a station named My Station. The second parameter specifies that all administrative clients on the NetShow server will have full read, write, and delete permissions. The <b>Open</b> method returns a <a href="channelformatscollectionobjectreference.htm"><b>Channel</b></a> object, which can be referred to by the variable MyStation.</p>
<pre><code>Set MyStation = MCM.Channels.Open( "My Station", 7 )</code></pre>

<h4><a name="setstationproperties"></a>Set Station Properties</h4>
<p>
Once you have a station to work with, you set the properties you need. The following properties must be set before you can multicast over the station. Many of the optional descriptive properties have not been set in this example, but if you do want to set them, this is where you can do it. </p>
<p>
<b>Note:</b> When you set the IPAddress and<b> <a href="addressport.htm">Port</a> </b>properties, ensure that the values don't duplicate those of an existing station<b>. </b>It can be difficult to track down duplicate multicast servers.</p>
<pre><code>MyStation.MulticastAddress = "238.8.217.46"
MyStation.Port = 13767</code></pre>

<h4><a name="specifydeliveryoptions"></a>Specify Delivery Options</h4>
<p>
You must also specify if the multicast is intended for distribution to other servers, for viewing in a player, or both. In this example, the distribution mode has been set to allow the multicast to be viewed in a player.</p>
<pre><code>MyStation.DeliveryMode = MCM_DM_SESSIONLESS_3PH</code></pre>

<h4><a name="createstationformat"></a>Create a Station Format</h4>
<p>
The station must contain at least one station format to tell players how to render the content in the multicast. The station format is contained in a <b>ChannelFormat</b> object. In this example, the .asf file used as the multicast source is also used to specify the station format:</p>
<pre><code>MyStation.ChannelFormats.Add "c:\ASFRoot\welcome.asf", _
 &nbsp; 3MCM_ASF_CH_FORMAT_FILE</code></pre>

<h4><a name="createnscfile"></a>Create an NSC File</h4>
<p>
When you have your station set up, you need to export it into an .nsc file that is posted for easy access by a client. In this example, the .nsc file is written into the home folder of a Web server on the local computer. The second parameter specifies that an old file with the same name can be overwritten.</p>
<pre><code>MyStation.WriteNSC "c:\inetpub\wwwroot\mynsc.nsc", "True"</code></pre>

<h4><a name="createstream"></a>Create a Stream</h4>
<p>
Now that the station has been created, you create a stream to play within it. Use the <b>Open </b>method to create a stream. In this example, the new stream is given the name "MyStream", with a unicast URL as its source. You must specify the access rights clients can have to the stream. The enumeration for access right is defined as MCM_PA_READ, MCM_PA_WRITE, MCM_PA_DELETE, and MCM_PA_ALL.</p>
<pre><code>Set MyStream = MCM.Streams.Open ("mms://astrid/welcome.asf", "MyStream", MCM_PA_READ)</code></pre>

<h4><a name="activatestream"></a>Activate the Stream</h4>
<p>
Once you have a valid station and stream, you need to associate the stream with the station by activating it. A station can have only one active stream. If you have several streams, you can switch among them while the station multicasts. Clients listening to the station will receive content from the active stream, but cannot select which stream is active. That is up to you. In this case, we have only one stream to set as the active stream.</p>
<pre><code>MyStation.SetActiveStream MyStream</code></pre>

<h4><a name="startmulticast"></a>Start the Multicast</h4>
<p>
All that is left to do is start the stream. In this example, we will start the stream at the beginning by specifying an opening position of zero milliseconds past the start of the file.</p>
<pre><code>MyStream.Start 0</code></pre>

<h4><a name="playingmulticast"></a>Playing the Multicast</h4>
<p>
Now your stream is being multicasted. A client on a subnet that receives the multicast can now connect and play the multicast.</p>
<A HREF="legal.htm">&copy; 1996-1998 Microsoft Corporation. All rights reserved.</A></BODY>
</HTML>
