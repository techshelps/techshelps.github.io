<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Simple NetShow Station Manager Example</TITLE></HEAD>
<BODY>
<H2>Simple Station Manager Example</H2>

<OBJECT ID="NSChannelMgr1" HEIGHT=1 WIDTH=1 
	CLASSID="CLSID:B00464B3-67D4-11D0-A464-00C04FC29CFB">
</OBJECT>
<BR>
<P>This sample connects to a Station Manager Server and displays current station information.
<CENTER>
<BR>
Server Name: <INPUT TYPE=TEXT NAME=MCMServerName VALUE="LocalHost" SIZE=35>
<INPUT TYPE=BUTTON NAME=ConnectToMCMServer VALUE="Connect">
Status: <INPUT TYPE=TEXT NAME=MCMServerStatusBox VALUE='Not Connected' SIZE="15">
<BR><BR>

<P>STATIONS:
<BR>
<TEXTAREA ROWS=6 COLS=100 NAME=ChannelBox></TEXTAREA>
<BR><BR>
<P>STREAMS:
<BR>
<TEXTAREA ROWS=6 COLS=100 NAME=StreamBox></TEXTAREA>
</CENTER>

<SCRIPT LANGUAGE="VBScript">
<!--
Sub ConnectToMCMServer_OnClick
    On Error Resume Next
    ChannelBox.Value = " "
    StreamBox.Value = " "
    MCMServerStatusBox.Value = " "   
    NSChannelMgr1.Connect MCMServerName.VALUE
    If    Err.Number = 0 then
          MCMServerStatusBox.Value = "Connected"
          ChannelCount = CInt(NSChannelMgr1.Channels.Count)
          If    ChannelCount < 1 then ChannelCount = "No"
          ChannelBox.Value = ChannelCount & " existing station(s):" & vbCrLf & vbCrLf
          for    i=0 to NSChannelMgr1.Channels.Count -1
                  ChannelBox.Value = ChannelBox.Value & " Name: " & NSChannelMgr1.Channels(i).Name
                  ChannelBox.Value = ChannelBox.Value & " - Desc: " & NSChannelMgr1.Channels(i).Description
                  ChannelBox.Value = ChannelBox.Value & vbCrLf
          next
          EnumStreams
    Else	
          MsgBox "Connection could not be made " & vbCrLf & "Error = " & Err.Description
          MCMServerStatusBox.Value = "NOT Connected"
    End If
End Sub

Sub NSChannelMgr1_OnStreamStart(Stream)
    EnumStreams
End Sub

Sub NSChannelMgr1_OnStreamStop(Stream, ErrReturn)
    EnumStreams
End Sub

Sub EnumStreams	
    On Error Resume Next
    StreamCount = CInt(NSChannelMgr1.Streams.Count)
    If    StreamCount < 1 then StreamCount = "No"
    StreamBox.Value = StreamCount & " existing stream(s):" & vbCrLf & vbCrLf
    for    i=0 to NSChannelMgr1.Streams.Count -1
            StreamBox.Value = StreamBox.Value & " ID: " & NSChannelMgr1.Streams(i).GetID
            StreamState = CInt(NSChannelMgr1.Streams(i).GetState)
            Select Case StreamState
                       Case 1      StreamState = "Closed"
                       Case 2      StreamState = "Open"
                       Case 3      StreamState = "Streaming"
                       Case Else StreamState = "Unknown"
            End Select
            StreamBox.Value = StreamBox.Value & " - State: " & StreamState
            StreamBox.Value = StreamBox.Value & vbCrLf
    next
End Sub
-->
</SCRIPT>

</FONT>
</BODY>
</HTML>
