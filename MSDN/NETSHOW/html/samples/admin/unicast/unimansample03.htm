<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NetShow Unicast Administartion Utility Sample</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<a href="">[Previous]</a><a href="">[Next]</a></font><BR><BR>
<h2>NetShow Unicast Administration Utility Sample</h2>
<p>
The NetShow Unicast Administration Utility sample illustrate the use of the <b>#import</b> directive to incorporate the NetShow Unicast Manager Admin control (<i>Nsunimgr.ocx</i>) in the development environment of Microsoft Visual C++ 5.0. You can find the sample source code, together with the Visual C++ project files, in the\<i>NetShowRoot</i>\SDK\Samples\Admin\UniConf directory. Here, \<i>NetShowRoot</i> is the root directory where NetShow is installed.</p>
<h3>Working with ActiveX controls in Visual C++ 5.0</h3>
<p>
ActiveX controls are distributed in one or more .OCX files, which also contains the type library for a particularly control. To make an ActiveX control available to a C/C++ application, you must incorporate the control into a C/C++ source file and then create an instance of the control. In Microsoft Visual Studio you can accomplish these by carrying out the following tasks.
<ul type=disc>
<li>
Incorporate the ActiveX control into the source code by inserting at the beginning of a C/C++ source file:<pre><code>#import “anActiveXControl.ocx”
</code></pre>
</li>
<li>
Create an instance of the control using the following API:<pre><code>HRESULT hr = ControlPtr.CreateInstance(L”ProgID”);
</code></pre>
</li>
</ul>
<p>
Here the <i>ControlPtr</i> variable is a pointer to the specified ActiveX control. “ProgID” is the string value of the <i>ProgID</i> of the control. Instead of <i>ProgID</i>, you can also use <i>CLSID</i> of the control. For information on this API, see The C++ References Documentation for <b>_com_ptr_t::CreateInstance(</b><i>CLSD</i>|<i>ProgID</i>, [<i>dwClsContext</i>]<b>)</b>.</p>
<p>
The <b>#import</b> directive is closely related to the <b>#include</b> C-preprocessor macro. It directs the compiler to include, at the point of import, the appropriate type library and to make the type information available for use in the application. The convention above implies that there is a copy of the .OCX file in the local working directory. </p>
<p>
The NetShow setup application installs all the available NetShow controls in the <i>NetShowRoot</i>\Server directory. Here <i>NetShowRoot</i> is the root directory of NetShow. The default setting is <i>C</i>:\<i>Program Files</i>\<i>Microsoft NetShow</i>. But the system administrator can override the default value in the installation process. When in doubt, you can determine the path using the <b>OLE/COM Object Viewer</b> application, which is accessible from Visual Studio for Visual C++.</p>
<p>
You can also examine all the available methods, events and properties from <b>OLE/COM Object Viewer</b>.</p>
<h3>Using the NetShow Unicast Manager Admin Control in Visual C++ 5.0</h3>
<p>
The NetShow Unicast Server Manager Admin control is distributed as the <i>nsunimgr.ocx</i> file. The import statement thus becomes</p>
<pre><code>#import “NetShowRoot\Server\nsunimgr.ocx”
</code></pre>
<p>
If you specify <i>NetShowRoot</i>\<i>Server</i> as one of the working directories for linking with libraries in Visual Studio (You can do so after selecting the <b>Library Files</b> entry in the <b>Show directories for</b> drop-down list from the <b>Directories</b> pane in the <b>Options</b> dialog box activated from the <b>Tools</b> menu), you can use the following syntax:</p>
<pre><code>#import &lt;nsunimgr.ocx&gt;
</code></pre>
<p>
After you build the sample, you can run it by issuing from the MS-DOS console terminal the following command:</p>
<pre><code>Nsumconf serverhost
</code></pre>
<a href="">[Previous]</a><a href="">[Next]</a></font><BR><BR>
<A HREF="legal.htm">&copy; 1996-1998 Microsoft Corporation. All rights reserved.</A></BODY>
</HTML>
