<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Streaming Macromedia Flash Events with NetShow</TITLE></HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=4 BGCOLOR="#FFFFFF" LINK="#000066" VLINK="#666666" TEXT="#000000">

<!-- <H4><FONT FACE="VERDANA">Streaming Macromedia Flash Events</FONT></H4> -->
<HR>
<FONT FACE="VERDANA" SIZE=2>

	<B>GOAL:</B>  Use a NetShow video stream to fire off Macromedia Flash animation events
	in another frame on the page.</P>
	<P>
	To do this, we use the Flash ActiveX control, available from <A HREF="http://active.macromedia.com/flash2" target="top">http://active.macromedia.com/flash2</A>,
	some script to direct the events to the NetShow control, and the NetShow ActiveX control.
	
	<P><B>CODE TO PUT IN YOUR HTML:  </B>We have set up this example using frames.  The right-hand frame 
	called SWFLASH.HTM simply contains the Flash ActiveX control:
	<UL>
	<FONT COLOR="0000FF">
	&lt;OBJECT ID="SWFlash" CLASSID="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" <BR>
		<UL>
		codebase="http://active.macromedia.com/flash2/cabs/swflash.cab#version=2,0,0,11" <BR>
        	width=200 height=150 align=right&gt;<BR>
       	 	&lt;param NAME="Movie" VALUE="stage.swf"&gt;<BR>
        	&lt;param NAME="Play" VALUE="False"&gt;<BR>
        	&lt;param NAME="Loop" VALUE="False"&gt;<BR>
        	&lt;param NAME="Quality" VALUE="High"&gt;<BR>
        	&lt;param NAME="Scale" VALUE="ShowAll"&gt;<BR>
        	&lt;param NAME="SAlign" VALUE="TR"&gt;<BR>
        	&lt;param NAME="BGColor" VALUE="808080"&gt;<BR>
		</UL>
	&lt;/OBJECT&gt;<BR>
	</UL>
	</FONT>
	Note that in this Flash control, we use codebase to automatically install the Flash player
	on computers without Flash, or with older versions of it.</P>
	<P>
	In the left-hand frame called NetShow.htm, we have some JavaScript code and the NetShow
	ActiveX control.  This JavaScript function is used to receive and interpret 
	the events and parameters being sent from the NetShow stream.  
	<font color="#0000FF">NSPlay1</font> refers to the 
	NetShow Player control.  This segment of code should come after the &lt;TITLE&gt;
	tag in your HTML.
	<UL>
	<FONT COLOR="0000FF">
	&lt;script LANGUAGE="JavaScript" FOR="NSPlay1" EVENT="ScriptCommand(ScType, ScCmd)"&gt;<BR>
		<UL>
    		if (ScType == "text") {<BR>
			<UL>
        		if (ScCmd == "start")<BR>
				<UL>
            			parent.swflash.SWFlash.Play();<BR>
				</UL>
        		else if (ScCmd == "pause")<BR>
				<UL>
            			parent.swflash.SWFlash.Stop();<BR>
				</UL>
        		else if (ScCmd == "resume")<BR>
				<UL>
            			parent.swflash.SWFlash.Play();<BR>
				</UL>
        		else if (ScCmd == "stop") {<BR>
				<UL>
            			parent.swflash.SWFlash.Stop();<BR>
            			parent.swflash.SWFlash.Rewind();<BR>
				</UL>
        		}<BR>
			</UL>
    		}<BR>
		</UL>
	&lt;/script&gt;<BR>
	</UL>
	</FONT>
	</P>
	This says that if the NetShow control sends an event (<FONT COLOR="0000FF">scType</FONT>) called <FONT COLOR="FF0000">text</FONT>, to plug the parameter it sends 
	with it (<FONT COLOR="0000FF">ScCmd</FONT>)
	into the function, which triggers
	different actions based on the <FONT COLOR="0000FF">ScCmd</FONT> type being
	sent at that time.  For example, if the event is <FONT COLOR="FF0000">Text</FONT> and the parameter 
	is <FONT COLOR="FF0000">start</FONT> then the subroutine called will execute the 
	command <FONT COLOR="0000FF">parent.swflash.SWFlash.Play()</FONT> which will start the 
	Flash animation playing.
	Remember that this won't work unless your ASF stream contains these events and parameters 
	in them.</P>
	<P>
	Next, you need the NetShow control in the page.  Here's the code we used:
	<UL>
	<FONT COLOR="0000FF">
	&lt;OBJECT ID="NSPlay1" WIDTH=144 HEIGHT=96 CLASSID="CLSID:2179C5D3-EBFF-11CF-B6FD-00AA00B4E220"&gt;<BR>
		<UL>
    		&lt;PARAM NAME="AutoRewind"  VALUE="1"&gt;<BR>
    		&lt;PARAM NAME="ClickToPlay" VALUE="0"&gt;<BR>
    		&lt;PARAM NAME="FileName"    VALUE="sbnflash.asf"&gt;<BR>
    		&lt;PARAM NAME="AllowChangeControlType" VALUE="0"&gt;<BR>
    		&lt;PARAM NAME="AllowChangeDisplaySize" VALUE="0"&gt;<BR>
		&lt;Embed type="video/x-ms-asf-plugin"<BR>
			<UL>
			src="sbnflash.asf"<BR>
			filename="sbnflash.asf"<BR>
			pluginspage="http://www.microsoft.com/netshow/download/player.htm"<BR>
			AutoRewind=1<BR>
			ClickToPlay=0<BR>
			AllowChangeControlType=0<BR>
			AllowChangeDisplaySize=0<BR>
			width=144<BR>
			height=96&gt;<BR>
			</UL>
		&lt;/embed&gt;<BR>
		</UL>
	&lt;/OBJECT&gt;<BR>
	</FONT>
	</UL>
	Next, you'll need to add the events and parameters to the NetShow stream.
	</P>
	<P><B>EVENTS AND PARAMETERS TO PUT IN YOUR NETSHOW STREAM:</B> The preceding subroutine will  
	wait for events and parameters from the NetShow stream to be sent to it before it will 
	do anything.  In this example, here are the events and parameters we used:
	<UL>
	<TABLE BORDER=0 CELLPADDING=5 CELLSPACING=2>
		<TR>
			<TH BGCOLOR=#A6CAF0 ALIGN=LEFT><FONT FACE="Arial" SIZE=2>
				<b>Time</b>
			</FONT></TH>
			<TH BGCOLOR=#A6CAF0 ALIGN=LEFT><FONT FACE="Arial" SIZE=2>
				<b>Event (<FONT COLOR="FF0000">scType</FONT>)</b>
			</FONT></TH>
			<TH BGCOLOR=#A6CAF0 ALIGN=LEFT><FONT FACE="Arial" SIZE=2>
				<b>Parameter (<FONT COLOR="FF0000">scCmd</FONT>)</b>
   			</FONT></TH>
		</TR>
		<TR>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">00:29.0</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">text</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">start</FONT></TD>
		</TR>
		<TR>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">00:40.0</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">text</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">pause</FONT></TD>
		</TR>
		<TR>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">00:56.0</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">text</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">resume</FONT></TD>
		</TR>
		<TR>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">01:05.0</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">text</FONT></TD>
			<TD BGCOLOR=#EEEEEE VALIGN=TOP><FONT FACE="Arial" SIZE=2 COLOR="FF0000">stop</FONT></TD>
		</TR>
	</TABLE>

	</UL>
	</P>
	For more information about using Flash, see the <A HREF="http://flash.macromedia.com" target="top">Macromedia Flash Web site</A>.
	<P>	
	<!--DocFooterStart-->
	<HR WIDTH=100%>
	</FONT>
	<FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
	<CENTER>&#169; 1998 Microsoft Corporation. All rights reserved.</CENTER>
	<P>
	</FONT>
	</P>
</TD>
</TR>

</TABLE>

</BODY>
</HTML>
