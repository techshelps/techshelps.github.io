<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Receive Unicast</TITLE></HEAD>
<BODY>
<H2>Receive File Transfer Unicast</H2>

<OBJECT ID="nsfile1" CLASSID="CLSID:26F24A93-1DA2-11D0-A334-00AA004A5FC5" ALIGN="RIGHT" HEIGHT="10" WIDTH="10">
<PARAM NAME="_Version" VALUE="65536">
<PARAM NAME="_ExtentX" VALUE="2646">
<PARAM NAME="_ExtentY" VALUE="1323">
<PARAM NAME="_StockProps" VALUE="0">
</OBJECT>

<FORM NAME="MyForm">
<INPUT TYPE="BUTTON" NAME="BtnReceiveFile" VALUE="Start Receive">
<INPUT TYPE="BUTTON" NAME="BtnCancelFile" VALUE="Cancel">
<INPUT TYPE="BUTTON" VALUE="About FTS" NAME="BtnAbout">

<P>To receive a unicast file transfer, click the <B>Start Receive</B> button. Cancel with the <B>Cancel</B> button. Start the receive file operation <I>before</I> starting the send file operation.

<P>Total Bytes: <INPUT TYPE="TEXT" NAME="TotalBytes" VALUE="0">  
Packets: <INPUT TYPE="TEXT" NAME="Packets" VALUE="0"> 

<P>Sender IP: <INPUT TYPE="TEXT" NAME="SenderIP">  
Files Received: <INPUT TYPE="TEXT" NAME="NumFiles" VALUE="0" SIZE="5">

<P>Sender Path: <INPUT TYPE="TEXT" NAME="SenderPath" SIZE="35">  
Receiver Path: <INPUT TYPE="TEXT" NAME="ReceiverPath" SIZE="35">
</FORM>

<P>Enter a null string (&quot;&quot;) for the IP Address and an appropriate value for the IP port. The value of 5050 is used for this example. The <B>Type</B> property must be set to 2.


<SCRIPT LANGUAGE="VBScript">
<!--

Sub BtnReceiveFile_OnClick
    nsfile1.Type = 2
    MyForm.TotalBytes.Value = 0
    MyForm.Packets.Value = 0
    MyForm.SenderIP.Value = ""
    MyForm.NumFiles.Value = 0
    MyForm.SenderPath.Value = ""
    MyForm.ReceiverPath.Value = ""
    call nsfile1.FtsRegisterStatusCallback(0, 0, 4096, 1, 0, 0, 0, 0, 0, 0, 0)
    On Error Resume Next
    call nsfile1.FtsStartFileTransferReceive("", 5050, "", "%TEMP%\", 0, 1025)
    If    Err.Number Then MsgBox "Start Error = " & ReturnError(Err.Number)
End Sub

Sub BtnCancelFile_OnClick
    call nsfile1.FtsCancelFileTransferReceive
    MsgBox "Transfer Cancelled. Error = " & ReturnError(nsfile1.Result)
End Sub

Sub nsfile1_FtsOnTransferProgress
    MyForm.TotalBytes.Value = nsfile1.NumTotalDataBytesTransferred
    MyForm.Packets.Value = nsfile1.NumPacketsTransferred
End Sub

Sub nsfile1_FtsOnTransferCompleted
    MsgBox "Transfer Completed. Error = " & ReturnError(nsfile1.Result)
    MyForm.SenderIP.Value = nsfile1.SourceAddress
    MyForm.NumFiles.Value = nsfile1.NumFilesTransferred
    MyForm.SenderPath.Value = nsfile1.SourceFilePath
    MyForm.ReceiverPath.Value = nsfile1.DestinationFilePath
    MyForm.TotalBytes.Value = nsfile1.NumTotalDataBytesTransferred
    MyForm.Packets.Value = nsfile1.NumPacketsTransferred
End Sub

Sub BtnAbout_OnClick
    call nsfile1.AboutBox()
End Sub

Function ReturnError(ByVal ErrNum)
    Select Case ErrNum
          Case 0
                ErrString = "No Error"
          Case 1
                ErrString = "Already Requested"
          Case -2147467260
                ErrString = "Cancelled"
          Case -2147467259
                ErrString = "Failed"
          Case -2147287038
                ErrString = "File Not Found"
          Case -2147024882
                ErrString = "Out Of Memory"
          Case -2147024809
                ErrString = "Invalid Parameter"
          Case -2147023436
                ErrString = "Timed Out"
          Case Else
                ErrString = "Unknown Error " & CStr(Hex(ErrNum))
    End Select
    ReturnError = ErrString
End Function

-->
</SCRIPT>

</BODY>
</HTML>
