<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Receive Multicast with Cancel and Error-Checking</TITLE></HEAD>
<BODY>
<H2>Receive Multicast with Cancel and Error-Checking</H2>
<BR>

<OBJECT ID="nsfile1" CLASSID="CLSID:26F24A93-1DA2-11D0-A334-00AA004A5FC5" ALIGN="RIGHT" HEIGHT="10" WIDTH="10">
<PARAM NAME="_Version" VALUE="65536">
<PARAM NAME="_ExtentX" VALUE="2646">
<PARAM NAME="_ExtentY" VALUE="1323">
<PARAM NAME="_StockProps" VALUE="0">
</OBJECT>

<INPUT TYPE="BUTTON" NAME="BtnReceiveFile" VALUE="Start Receive">
<INPUT TYPE="BUTTON" NAME="BtnCancelFile" VALUE="Cancel">
<INPUT TYPE="BUTTON" VALUE="About FTS" NAME="BtnAbout">

<P>Start the transfer with the <B>Start Receive</B> button. Cancel with the <B>Cancel</B> button. Start the receive file operation <I>before</I> starting the send file operation.
<P>This demo will receive any file and store it in the directory specified by the %TEMP% environment variable. When the transfer is completed, a completion message will be displayed.
<P>A message will be displayed when the transfer starts and when the transfer is completed. An error message will be displayed when the transfer request is made, when the transfer starts and is completed, and if the transfer is cancelled.
<P><B>Note</B> Make sure the IP address and port match the address and port of the server you want to listen to. This sample uses the following parameters:
<UL>
<LI><B>IP Address:</B> 239.230.50.50
<LI><B>IP Port:</B> 5050
</UL>
<P>This demo contains a function (<B>ReturnError</B>) that takes a number corresponding to an <B>HRESULT</B> error code and returns a corresponding error message string.

<SCRIPT LANGUAGE="VBScript">
<!--
Sub BtnReceiveFile_OnClick
    call nsfile1.FtsRegisterStatusCallback(0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 0)
    On Error Resume Next
    call nsfile1.FtsStartFileTransferReceive("239.230.50.50", 5050, "", "%TEMP%\", 0, 1025)
    If    Err.Number Then MsgBox "Start Error = " & ReturnError(Err.Number)
End Sub

Sub BtnCancelFile_OnClick
    call nsfile1.FtsCancelFileTransferReceive
    MsgBox "Transfer Cancelled. Error = " & ReturnError(nsfile1.Result)
End Sub

Sub nsfile1_FtsOnTransferStarted
    MsgBox "Transfer Started. Error = " & ReturnError(nsfile1.Result)
End Sub

Sub nsfile1_FtsOnTransferCompleted
    MsgBox "Transfer Completed. Error = " & ReturnError(nsfile1.Result)
End Sub

Sub BtnAbout_OnClick
    call nsfile1.AboutBox()
End Sub

Function ReturnError(ByVal ErrNum)
    Select Case ErrNum
          Case 0
                 ErrString = "No Error"
          Case1 
                ErrString = "Already Requested"
          Case -2147467260
                ErrString = "Cancelled"
          Case -2147467259
                ErrString = "Failed"
          Case -2147287038
                ErrString = "File Not Found"
          Case -2147024882
                ErrString = "Out Of Memory"
          Case -2147024809
                ErrString = "Invalid Parameter"
          Case -2147023436
                ErrString = "Timed Out"
          Case Else
                ErrString = "Unknown Error " & CStr(Hex(ErrNum))
    End Select
    ReturnError = ErrString
End Function

-->
</SCRIPT>

</BODY>
</HTML>
