<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Full Player Control Example</TITLE></HEAD>
<BODY LANGUAGE="VBScript" OnLoad="SetFileName">
<H2>Full Player Control Example</H2>

<P>This sample shows how to play or receive any file or broadcast.

<OBJECT ID="Timer1"
 CLASSID="clsid:59CCB4A0-727D-11CF-AC36-00AA00A47DD2"
 CODEBASE="http://activex.microsoft.com/controls/iexplorer/ietimer.ocx#Version=4,70,0,1161">
 <PARAM NAME="Interval" VALUE="200">
 <PARAM NAME="Enabled" VALUE="True">
</OBJECT>

<BR>
<CENTER>
<STRONG>File Name: </STRONG>
<INPUT TYPE="TEXT" NAME="FileNameBox" VALUE="C:\Program Files\Microsoft NetShow\SDK\Solutions\Commerce\content\godschild.asf" SIZE=80>
<INPUT TYPE="BUTTON" NAME="AboutBtn" VALUE="About the Control">
</FONT>
<BR>

<OBJECT ID="MediaPlayer1"
  CLASSID="CLSID:22D6f312-B0F6-11D0-94AB-0080C74C7E95">
  <PARAM NAME="ShowControls" VALUE="FALSE">
  <PARAM NAME="VideoBorder3D" VALUE="TRUE">
  <PARAM NAME="VideoBorderWidth" VALUE="10">
  <PARAM NAME="VideoBorderColor" VALUE="222">
  <PARAM NAME="AutoStart" VALUE="FALSE">
</OBJECT>

<BR>
<TABLE BORDER="5" BORDERCOLOR="RED"><TR>
<TD><INPUT TYPE="BUTTON" NAME="PlayBtn" VALUE="Play"></TD>
<TD><INPUT TYPE="BUTTON" NAME="FFBtn" VALUE="FF"></TD>
<TD><INPUT TYPE="BUTTON" NAME="RewBtn" VALUE="Rew"></TD>
<TD><INPUT TYPE="BUTTON" Name="PauseBtn" VALUE="Pause"></TD>
<TD><INPUT TYPE="BUTTON" NAME="StopBtn" VALUE="Stop"></TD>
</TR></TABLE>

<BR>
<TABLE><TR>
<TD><STRONG>Clip Information:</STRONG></TD>
<TD>Title: <INPUT TYPE="TEXT" NAME="TitleBox" SIZE=35></TD>
<TD>Author: <INPUT TYPE="TEXT" NAME="AuthorBox" SIZE=25></TD>
<TD>Copyright: <INPUT TYPE="TEXT" NAME="CopyBox" SIZE=25></TD>
</TR></TABLE>

<BR>
<TABLE><TR>
<TD><STRONG>Player Status: </STRONG></TD>
<TD>Buffering: <INPUT TYPE="TEXT" NAME="BufferBox" SIZE=8></TD>
<TD>Play State: <INPUT TYPE="TEXT" NAME="PlayStateBox" SIZE=15></TD>
<TD>Open State: <INPUT TYPE="TEXT" NAME="OpenStateBox" SIZE=20></TD>
</TR></TABLE>

<BR>
<TABLE><TR>
<TD><STRONG>Packet Statistics: </STRONG></TD>
<TD>Received: <INPUT TYPE="TEXT" NAME="ReceivedBox" SIZE=10></TD>
<TD>Lost: <INPUT TYPE="TEXT" NAME="LostBox" SIZE=10></TD>
<TD>Reception Quality: <INPUT TYPE="TEXT" NAME="QualityBox" SIZE=4></TD>
</TR></TABLE>

</CENTER>

<SCRIPT LANGUAGE="VBScript">
<!--

Sub OnLoad
    SetFileName
End Sub

Sub SetFileName
    MediaPlayer1.FileName= FileNameBox.Value
End Sub 

Sub FileNameBox_OnChange
    MediaPlayer1.FileName= FileNameBox.Value
End Sub 

' Invoke the AboutBox method
Sub AboutBtn_OnClick
    MediaPlayer1.AboutBox
End Sub

' When the Play button is pressed set these properties and invoke the Play method.
' Update the title information display after starting the stream
Sub PlayBtn_OnClick
    MediaPlayer1.Play
End Sub

' When the FF button is pressed, scan forward.
Sub FFBtn_OnClick
    MediaPlayer1.FastForward
End Sub

' When the Rew button is pressed, scan back.
Sub RewBtn_OnClick
    MediaPlayer1.FastReverse
End Sub

' When the Pause button is pressed, pause the ASF stream.
Sub PauseBtn_OnClick
    MediaPlayer1.Pause
End Sub

' When the Stop button is pressed, stop the ASF stream and reset to start of file.
Sub StopBtn_OnClick
    MediaPlayer1.Stop
    MediaPlayer1.CurrentPosition = 0
End Sub

' Display information about the clip
Sub TitleInfo
    TitleBox.Value=MediaPlayer1.GetMediaInfoString(8)
    AuthorBox.Value=MediaPlayer1.GetMediaInfoString(9)
    CopyBox.Value=MediaPlayer1.GetMediaInfoString(10)
End Sub

' This event is sent when buffering starts or stops
Sub MediaPlayer1_Buffering(Start)
    If    Start = TRUE then
          BufferBox.Value="Started"
    Else
          BufferBox.Value="Stopped"
    End If
End Sub

' This event is sent when the open state changes. Display Title info when stream is open
Sub MediaPlayer1_OpenStateChange(OldState, NewState)
    StateVar=CInt(NewState)
    Select Case    StateVar
          Case 0       OpenStateBox.Value="Stream Closed"
          Case 1       OpenStateBox.Value="Loading ASX File"
          Case 2       OpenStateBox.Value="Loading NSC File"
          Case 3       OpenStateBox.Value="Locating"
          Case 4       OpenStateBox.Value="Connecting"
          Case 5       OpenStateBox.Value="Opening ASF File"
          Case 6       OpenStateBox.Value="ASF File Open" : TitleInfo
          Case Else  OpenStateBox.Value="Unknown"
    End Select
End Sub

' This event is sent when the play state changes
Sub MediaPlayer1_PlayStateChange(OldState, NewState)
    StateVar=CInt(NewState)
    Select Case    StateVar
            Case 0 	PlayStateBox.Value="Stopped"
            Case 1 	PlayStateBox.Value="Paused"
            Case 2 	PlayStateBox.Value="Playing"
            Case 3 	PlayStateBox.Value="Waiting"
            Case 4 	PlayStateBox.Value="Scanning Fwd"
            Case 5 	PlayStateBox.Value="Scanning Bckwrd"
            Case 6 	PlayStateBox.Value="Skip Fwd"
            Case 7 	PlayStateBox.Value="Skip Bckwrd"
            Case Else	PlayStateBox.Value="Unknown"
    End Select
End Sub

' This event is sent every 2 seconds
Sub Timer1_timer
    ReceivedBox.Value=MediaPlayer1.ReceivedPackets 
    LostBox.Value=MediaPlayer1.LostPackets
    QualityBox.Value=MediaPlayer1.ReceptionQuality & "%"
End Sub

-->
</SCRIPT>

</BODY>
</HTML>
