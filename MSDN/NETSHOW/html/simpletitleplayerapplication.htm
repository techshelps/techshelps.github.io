<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Simple Title Player Application</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h4><a name="simpletitleplayerapplication"></a>Simple Title Player Application</h4>
<p>
By combining the Media Player Control with the TitleView control, you can easily create an application that allows the user to select a title from the Title server and watch it with the player. This simple sample uses HTML and VBScript to demonstrate one solution for playing the current selection in the TitleView control with the Media Player control.</p>
<h6>Connecting to the Title Server</h6>
<p>
Start the page … Add text box for the server and a button to initiate the set server method.</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt; &lt;TITLE&gt;Simple Title View and Media Player Example&lt;/TITLE&gt; &lt;/HEAD&gt;
&lt;BODY&gt;
&lt;CENTER&gt;Title Server: 
&lt;INPUT TYPE="TEXT" NAME="SrvName" SIZE="25"&gt;
&lt;INPUT TYPE="BUTTON" NAME="SetSrv" VALUE="Set Server"&gt;
&lt;BR&gt;&lt;BR&gt;</code></pre>
<h6>Add the TitleView and MediaPlayer Controls</h6>
<p>
Use &lt;OBJECT&gt; tags to embed the controls in the page. Notice we added a param tag to indicate that the player should not begin playing the title when the file name is set.</p>
<pre><code>&lt;OBJECT ID="TitleView1" WIDTH=155 HEIGHT=240 CLASSID="CLSID:1E1BAAB1-3614-11D1-A5FE-00AA00BF93E3"&gt;
&lt;/OBJECT&gt;

&lt;OBJECT ID="MediaPlayer1" WIDTH=360 HEIGHT=240
  CLASSID="CLSID:22D6f312-B0F6-11D0-94AB-0080C74C7E95"&gt;
  &lt;PARAM NAME="AutoStart" VALUE="FALSE"&gt;
&lt;/OBJECT&gt;</code></pre>
<h6>Add Simple UI for the Player</h6>
<p>
Add the play and stop buttons to manipulate the Player control.</p>
<pre><code>&lt;BR&gt;&lt;BR&gt;
&lt;INPUT TYPE="BUTTON" NAME="PlayBtn"&nbsp; VALUE="&nbsp;&nbsp;&nbsp; &gt; &nbsp;&nbsp;&nbsp; "&gt;
&lt;INPUT TYPE="BUTTON" NAME="StopBtn"&nbsp;&nbsp; VALUE="&nbsp;&nbsp;&nbsp; []&nbsp;&nbsp;&nbsp; "&gt;
&lt;BR&gt;
&lt;/CENTER&gt;
&lt;/BODY&gt;</code></pre>
<h6>Add the Subroutines to handle click events</h6>
<p>
The next step is to add four subroutines; three to process click events for the buttons we added to the page, and one to respond to the <b>OnSelectionChanged</b> event that is triggered when a title is selected from the TitleView control.</p>
<pre><code>&lt;SCRIPT LANGUAGE="VBScript"&gt;
&lt;!--

' Connect to the specified Ttitle Server
Sub SetSrv_OnClick
  TitleView1.SetServer (SrvName.VALUE)
End Sub

' Set the file name based on title selected in TitleView 
Sub TitleView1_OnSelectionChanged( selection )
  If selection &lt;&gt; 0 Then
 &nbsp;&nbsp;&nbsp; strNewTitle = TitleView1.CurrentSelectionName 
 &nbsp;&nbsp;&nbsp; MediaPlayer1.FileName =&nbsp; "nsm://" &amp; SrvName.VALUE &amp; "/" &amp; strNewTitle
  End If
End Sub

' Play button click event.
' Make sure a title has been selected from TitleView&nbsp;&nbsp;&nbsp; 
Sub PlayBtn_OnClick
  If&nbsp; MediaPlayer1.FileName = "" Then
 &nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Select a Title to Play"
  Else
 &nbsp;&nbsp;&nbsp; MediaPlayer1.Play
  End If
End Sub

' *** Stop button click event. ***
Sub StopBtn_OnClick
 &nbsp; MediaPlayer1.Stop
End Sub

--&gt;
&lt;/SCRIPT&gt;
&lt;/HTML&gt;
</code></pre>
<h6>Putting it All Together</h6>
<p>
The preceding HTML and VBScript code fragments can be pasted together to create a working Web page. Bring the page up in your browser and type in the name of a title server on your intranet. After successfully connecting to the server, the available titles should appear in TitleView control. </p>
<A HREF="legal.htm">&copy; 1996-1998 Microsoft Corporation. All rights reserved.</A></BODY>
</HTML>
