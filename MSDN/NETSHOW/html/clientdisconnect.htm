<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Client.Disconnect</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h4><a name="clientdisconnect"></a>Client.Disconnect Method</h4>
<p>
Removes the specified client.</p>
<p class=blue>
<b>Syntax</b></p>
<p>
<i>NSUnicastMgr</i><b>.Client.Disconnect</b></p>
<p class=blue>
<b>Return Values</b></p>
<p>
Returns an ActiveX HRESULT error code.</p>
<p class=blue>
<b>Example</b></p>
<p>
The following example shows how to disconnect clients that are not in a particular IP subnet. It disconnects all the clients that are not on a particular class C subnet (where the first three octets in the address are set, such as: 123.4.140.<i>xxx)</i>.</p>
<pre><code>Sub OutsidersBeGone( subnet )
 &nbsp; For i = 0 to NSUnicastMgr.Clients.Count
 &nbsp;&nbsp;&nbsp;&nbsp; TheClient = NSUnicastMgr.Clients( i )
 &nbsp;&nbsp;&nbsp;&nbsp; ' check if the client is on the same subnet
 &nbsp;&nbsp;&nbsp;&nbsp; If StripSubnet( TheClient.IPAddress ) &lt;&gt; StripSubnet(subnet)) Then
 &nbsp;&nbsp;&nbsp;&nbsp; ' client is on another subnet. Show a descriptive
 &nbsp;&nbsp;&nbsp;&nbsp; ' message about the client
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Client Disconnected:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; vbCrLf &amp; _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ClientID: " &amp; TheClient.ClientID&nbsp; &amp; vbCrLf &amp; _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Address:&nbsp; " &amp; TheClient.IPAddress &amp; vbCrLf &amp;_
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Port:&nbsp;&nbsp;&nbsp;&nbsp; " &amp; TheClient.PortID
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TheClient.Disconnect
 &nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp; Next
End Sub

Function StripSubnet( ip )
' strips the last octet off an IP address
 &nbsp; StripSubnet = Left( ip, ( InstrRev(ip,".", -1, 1 )) - 1 )
End Function
</code></pre>
<A HREF="legal.htm">&copy; 1996-1998 Microsoft Corporation. All rights reserved.</A></BODY>
</HTML>
