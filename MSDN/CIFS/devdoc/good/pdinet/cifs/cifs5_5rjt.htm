<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WRITE: Write Bytes</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_cifs_129"></a><i></i>WRITE: Write Bytes</h2>
<p>
The write message is sent to write bytes into the resource indicated by <i>fid</i> in the SMB header.</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Client Request<br>
==================================</td>
<td width=50%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR WordCount;</td>
<td width=50%>Count of parameter words = 5</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Fid;</td>
<td width=50%>File handle</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Count;</td>
<td width=50%>Number of bytes to be written</td>
</tr>
<tr valign=top>
<td width=50%>ULONG Offset;</td>
<td width=50%>Offset in file to begin write</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Remaining;</td>
<td width=50%>Bytes remaining to satisfy request</td>
</tr>
<tr valign=top>
<td width=50%>USHORT ByteCount;</td>
<td width=50%>Count of data bytes</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR BufferFormat;</td>
<td width=50%>0x01 -- Data block</td>
</tr>
<tr valign=top>
<td width=50%>USHORT DataLength;</td>
<td width=50%>Length of data</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR Data[ Count ];</td>
<td width=50%>The data to write</td>
</tr>
</table><br>
<p>
<i>count</i> specifies the number of bytes to be written.  <i>offset</i> is the offset in the file of the first byte to be written.  Since offset is 32 bits, this request is inappropriate for general use in a very large file.  <i>remaining</i> is advisory:  if the value is not zero, then it is taken as an estimate of the number of bytes that will be written -including those written by this request.  This additional information may be used by the server to optimize cache behavior. </p>
<p>
When <i>fid</i> represents a disk file and the request specifies a byte range beyond the current end of file, the file will be extended.  Any bytes between the previous end of file and the requested offset are initialized to 0.  When a write specifies a length of zero, the file is truncated (or extended) to the length specified by the offset.</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Server Response<br>
==================================</td>
<td width=50%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR WordCount;</td>
<td width=50%>Count of parameter words = 1</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Count;</td>
<td width=50%>Count of bytes actually written</td>
</tr>
<tr valign=top>
<td width=50%>USHORT ByteCount;</td>
<td width=50%>Count of data bytes = 0</td>
</tr>
</table><br>
<p>
<i>count</i> in the response indicates the actual number of bytes written, and for successful writes will always equal the count in the request message.  If the number of bytes written differs from the number requested and no error is indicated, then the server has no resources available with which to satisfy the complete write.</p>
<p>
If a Write sends a message of length greater than the <i>maxbuffersize</i> for the TID specified, the server may abort the connection to the client.</p>
<p>&nbsp;</p></body>
</HTML>
