<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NT_TRANSACT_CREATE: Create or Open File with EAs or SD</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_cifs_73"></a>NT_TRANSACT_CREATE: Create or Open File with EAs or SD</h3>
<p>
This command is used to create or open a file or a directory, when EAs or an SD must be applied to the file.</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=51%>Request Parameter Block Encoding<br>
===================================</td>
<td width=49%>Description<br>
================================</td>
</tr>
<tr valign=top>
<td width=51%>ULONG Flags;</td>
<td width=49%>Creation flags (see below)</td>
</tr>
<tr valign=top>
<td width=51%>ULONG RootDirectoryFid;</td>
<td width=49%>Optional directory for relative open</td>
</tr>
<tr valign=top>
<td width=51%>ACCESS_MASK DesiredAccess;</td>
<td width=49%>Desired access</td>
</tr>
<tr valign=top>
<td width=51%>LARGE_INTEGER AllocationSize;</td>
<td width=49%>The initial allocation size in bytes, if file created</td>
</tr>
<tr valign=top>
<td width=51%>ULONG ExtFileAttributes;</td>
<td width=49%>The extended file attributes</td>
</tr>
<tr valign=top>
<td width=51%>ULONG ShareAccess;</td>
<td width=49%>The share access </td>
</tr>
<tr valign=top>
<td width=51%>ULONG CreateDisposition;</td>
<td width=49%>Action to take if file exists or not </td>
</tr>
<tr valign=top>
<td width=51%>ULONG CreateOptions;</td>
<td width=49%>Options for creating a new file</td>
</tr>
<tr valign=top>
<td width=51%>ULONG SecurityDescriptorLength;</td>
<td width=49%>Length of SD in bytes</td>
</tr>
<tr valign=top>
<td width=51%>ULONG EaLength;</td>
<td width=49%>Length of EA in bytes</td>
</tr>
<tr valign=top>
<td width=51%>ULONG NameLength;</td>
<td width=49%>Length of name in characters</td>
</tr>
<tr valign=top>
<td width=51%>ULONG ImpersonationLevel;</td>
<td width=49%>Security QOS information </td>
</tr>
<tr valign=top>
<td width=51%>UCHAR SecurityFlags;</td>
<td width=49%>Security QOS information </td>
</tr>
<tr valign=top>
<td width=51%>STRING Name[NameLength];</td>
<td width=49%>The name of the file (not NULL terminated)</td>
</tr>
<tr valign=top>
<td width=51%></td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=51%></td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=51%>Data Block Encoding<br>
===================================</td>
<td width=49%>Description<br>
================================</td>
</tr>
<tr valign=top>
<td width=51%>UCHAR SecurityDescriptor[ SecurityDescriptorLength];</td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=51%>UCHAR ExtendedAttributes[EaLength];</td>
<td width=49%></td>
</tr>
</table><br>
<table border=1 cellspacing=4 cols=3 frame=box rules=cols>
<tr valign=top>
<td width=38%>Creation Flag Name<br>
==========================</td>
<td width=12%>Value<br>
======</td>
<td width=50%>Description<br>
==================================</td>
</tr>
<tr valign=top>
<td width=38%>NT_CREATE_REQUEST_OPLOCK</td>
<td width=12%>0x02</td>
<td width=50%>Level I oplock requested</td>
</tr>
<tr valign=top>
<td width=38%>NT_CREATE_REQUEST_OPBATCH</td>
<td width=12%>0x04</td>
<td width=50%>Batch oplock requested</td>
</tr>
<tr valign=top>
<td width=38%>NT_CREATE_OPEN_TARGET_DIR</td>
<td width=12%>0x08</td>
<td width=50%>Target for open is a directory</td>
</tr>
</table><br>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Output Parameter Block Encoding<br>
==================================</td>
<td width=50%>Description<br>
==================================</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR OplockLevel;</td>
<td width=50%>The oplock level granted</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR Reserved;</td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%>USHORT Fid;</td>
<td width=50%>The file ID</td>
</tr>
<tr valign=top>
<td width=50%>ULONG CreateAction;</td>
<td width=50%>The action taken</td>
</tr>
<tr valign=top>
<td width=50%>ULONG EaErrorOffset;</td>
<td width=50%>Offset of the EA error</td>
</tr>
<tr valign=top>
<td width=50%>TIME CreationTime;</td>
<td width=50%>The time the file was created</td>
</tr>
<tr valign=top>
<td width=50%>TIME LastAccessTime;</td>
<td width=50%>The time the file was accessed</td>
</tr>
<tr valign=top>
<td width=50%>TIME LastWriteTime;</td>
<td width=50%>The time the file was last written</td>
</tr>
<tr valign=top>
<td width=50%>TIME ChangeTime;</td>
<td width=50%>The time the file was last changed</td>
</tr>
<tr valign=top>
<td width=50%>ULONG ExtFileAttributes;</td>
<td width=50%>The file attributes</td>
</tr>
<tr valign=top>
<td width=50%>LARGE_INTEGER AllocationSize;</td>
<td width=50%>The number of byes allocated</td>
</tr>
<tr valign=top>
<td width=50%>LARGE_INTEGER EndOfFile;</td>
<td width=50%>The end of file offset</td>
</tr>
<tr valign=top>
<td width=50%>USHORT FileType;</td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%>USHORT DeviceState;</td>
<td width=50%>state of IPC device (e.g. pipe)</td>
</tr>
<tr valign=top>
<td width=50%>BOOLEAN Directory;</td>
<td width=50%>TRUE if this is a directory</td>
</tr>
</table><br>
<p>
See the description of NT_CREATE_ANDX for the definition of the parameters.</p>
<p>&nbsp;</p></body>
</HTML>
