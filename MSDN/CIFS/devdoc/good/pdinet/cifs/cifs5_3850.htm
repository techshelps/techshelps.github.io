<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TRANS2_FIND_NEXT2: Resume Directory Search Using Wildcards</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_cifs_94"></a>TRANS2_FIND_NEXT2: Resume Directory Search Using Wildcards</h3>
<p>
This request resumes a search which was begun with a previous <code>TRANS2_FIND_FIRST2</code> request.</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Client Request<br>
==================================</td>
<td width=50%>Value<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%>WordCount</td>
<td width=50%>15</td>
</tr>
<tr valign=top>
<td width=50%>SetupCount</td>
<td width=50%>1</td>
</tr>
<tr valign=top>
<td width=50%>Setup[0]</td>
<td width=50%>TRANS2_FIND_NEXT2</td>
</tr>
<tr valign=top>
<td width=50%>Parameter Block Encoding<br>
==================================</td>
<td width=50%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Sid;</td>
<td width=50%>Search handle</td>
</tr>
<tr valign=top>
<td width=50%>USHORT SearchCount;</td>
<td width=50%>Maximum number of entries to return</td>
</tr>
<tr valign=top>
<td width=50%>USHORT InformationLevel;</td>
<td width=50%>Levels described in <code>TRANS2_FIND_FIRST2</code> request</td>
</tr>
<tr valign=top>
<td width=50%>ULONG ResumeKey;</td>
<td width=50%>Value returned by previous find2 call</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Flags;</td>
<td width=50%>Additional information: bit set-<br>
0 - close search after this request<br>
1 - close search if end of search reached<br>
2 - return resume keys for each entry found<br>
3 - resume/continue from previous ending place<br>
4 - find with backup intent</td>
</tr>
<tr valign=top>
<td width=50%>STRING FileName;</td>
<td width=50%>Resume file name</td>
</tr>
</table><br>
<p>
<i>sid</i> is the value returned by a previous successful <code>TRANS2_FIND_FIRST2</code> call.  If <i>bit3</i> of <i>flags</i> is set, then <i>FileName</i> may be the NULL string, since the search is continued from the previous <code>TRANS2_FIND</code> request.  Otherwise, <i>FileName</i> must not be more than 256 characters long. </p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Response Field<br>
==================================</td>
<td width=50%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%>USHORT SearchCount;</td>
<td width=50%>Number of entries returned</td>
</tr>
<tr valign=top>
<td width=50%>USHORT EndOfSearch;</td>
<td width=50%>Was last entry returned?</td>
</tr>
<tr valign=top>
<td width=50%>USHORT EaErrorOffset;</td>
<td width=50%>Offset into EA list if EA error</td>
</tr>
<tr valign=top>
<td width=50%>USHORT LastNameOffset;</td>
<td width=50%>Offset into data to file name of last entry, if server needs it to resume search; else 0</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR Data[TotalDataCount]</td>
<td width=50%>Level dependent info about the matches found in the search</td>
</tr>
</table>
<p>&nbsp;</p></body>
</HTML>
