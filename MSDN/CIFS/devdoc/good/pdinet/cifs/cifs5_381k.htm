<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SEEK: Seek in File</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_cifs_78"></a>SEEK: Seek in File</h3>
<p>
The seek message is sent to set the current file pointer for <i>fid</i>.</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Client Request<br>
==================================</td>
<td width=50%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR WordCount;</td>
<td width=50%>Count of parameter words = 4</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Fid;</td>
<td width=50%>File handle</td>
</tr>
<tr valign=top>
<td width=50%>USHORT Mode;</td>
<td width=50%>Seek mode:</td>
</tr>
<tr valign=top>
<td width=50%></td>
<td width=50%>0 = from start of file</td>
</tr>
<tr valign=top>
<td width=50%></td>
<td width=50%>1 = from current position</td>
</tr>
<tr valign=top>
<td width=50%></td>
<td width=50%>2 = from end of file</td>
</tr>
<tr valign=top>
<td width=50%>LONG Offset;</td>
<td width=50%>Relative offset</td>
</tr>
<tr valign=top>
<td width=50%>USHORT ByteCount;</td>
<td width=50%>Count of data bytes = 0</td>
</tr>
</table><br>
<p>
The starting point of the seek is set by <i>mode</i>:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=8%>0</td>
<td width=92%>seek from start of file</td>
</tr>
<tr valign=top>
<td width=8%>1</td>
<td width=92%>seek from current file pointer</td>
</tr>
<tr valign=top>
<td width=8%>2</td>
<td width=92%>seek from end of file</td>
</tr>
</table><br>
<p>
The "current position" reflects the offset plus data length specified in the previous read, write or seek request, and the pointer set by this command will be replaced by the offset specified in the next read, write or seek command.</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Server Response<br>
==================================</td>
<td width=50%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%> UCHAR WordCount;</td>
<td width=50%>Count of parameter words = 2</td>
</tr>
<tr valign=top>
<td width=50%> ULONG Offset;</td>
<td width=50%>Offset from start of file</td>
</tr>
<tr valign=top>
<td width=50%> USHORT ByteCount;</td>
<td width=50%>Count of data bytes = 0</td>
</tr>
</table><br>
<p>
The response returns the new file pointer in <i>offset</i> which is expressed as the offset from the start of the file, and may be beyond the current end of file.  An attempt to seek to before the start of file sets the current file pointer to start of the file.</p>
<p>
This request should generally only be issued by clients wishing to find the size of a file, since all read and write requests include the read or write file position as part of the SMB.  This request is inappropriate for  very large files, as the offsets specified are only 32 bits.  A seek which results in an Offset which can not be expressed in 32 bits returns the least significant.</p>
<h4>Errors</h4>
<p>
ERRDOS/ERRbadfid<br>
ERRDOS/ERRnoaccess<br>
ERRSRV/ERRinvdevice<br>
ERRSRV/ERRinvid<br>
ERRSRV/ERRbaduid</p>
<p>&nbsp;</p></body>
</HTML>
