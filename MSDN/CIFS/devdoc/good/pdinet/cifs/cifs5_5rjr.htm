<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TREE_CONNECT: Tree Connect</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_cifs_127"></a><i></i>TREE_CONNECT: Tree Connect</h2>
<p>
When a client connects to a server resource, an SMB_COM_TREE_CONNECT message is generated to the server. This command is almost exactly like SMB_COM_TREE_CONNECT_ANDX, except that no AndX command may follow; see section 4.1.4.</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=50%>Client Request<br>
==================================</td>
<td width=50%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR WordCount;</td>
<td width=50%>Count of parameter words = 0</td>
</tr>
<tr valign=top>
<td width=50%>USHORT ByteCount;</td>
<td width=50%>Count of data bytes;    min = 4</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR BufferFormat1;</td>
<td width=50%>0x04</td>
</tr>
<tr valign=top>
<td width=50%>STRING Path[];</td>
<td width=50%>Server name and share name</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR BufferFormat2;</td>
<td width=50%>0x04</td>
</tr>
<tr valign=top>
<td width=50%>STRING Password[];</td>
<td width=50%>Password</td>
</tr>
<tr valign=top>
<td width=50%>UCHAR BufferFormat3;</td>
<td width=50%>0x04</td>
</tr>
<tr valign=top>
<td width=50%>STRING Service[];</td>
<td width=50%>Service name</td>
</tr>
</table><br>
<p>
The CIFS server responds with:</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=cols>
<tr valign=top>
<td width=47%>Server Response<br>
================================</td>
<td width=53%>Description<br>
=================================</td>
</tr>
<tr valign=top>
<td width=47%>UCHAR WordCount;</td>
<td width=53%>Count of parameter words = 2</td>
</tr>
<tr valign=top>
<td width=47%>USHORT MaxBufferSize;</td>
<td width=53%>Max size message the server handles</td>
</tr>
<tr valign=top>
<td width=47%>USHORT Tid;</td>
<td width=53%>Tree ID</td>
</tr>
<tr valign=top>
<td width=47%>USHORT ByteCount;</td>
<td width=53%>Count of data bytes = 0</td>
</tr>
</table><br>
<p>
If the negotiated dialect is <code>MICROSOFT NETWORKS 1.03</code> or earlier, MaxBufferSize in the response message indicates the maximum size message that the server can handle.  The client should not generate messages, nor expect to receive responses, larger than this.  This must be constant for a given server.  For newer dialects, this field is ignored.</p>
<p>
<i>tid</i> should be included in any future SMBs referencing this tree connection. </p>
<p>&nbsp;</p></body>
</HTML>
