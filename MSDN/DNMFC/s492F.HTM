<HTML>
<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the MFC Migration Kit book in the MSDN Library">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cleaning Up WindowProc</TITLE><META NAME="MS-HKWD" CONTENT="Cleaning Up WindowProc"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<H4>    Cleaning Up WindowProc</H4><P>Next, you need to clean up WindowProc a bit. Check the variables used in the rest of WindowProc to be sure their declarations are visible to the function. Likewise, check functions called from WindowProc to make sure they're visible.</P>
<P>For SHOWDIB, you need to make several variables visible from within WindowProc, as discussed in <A HREF="S4926.HTM#sec0">Scope Problems</A>. These variables are defined in SHOWDIB.CPP, so you need <B>extern</B> declarations for them in SHOWDIB.H. Then you can add an include statement for SHOWDIB.H to the SHOWDVW.CPP file.</P>
<P>The code you've just moved into the view class calls two macros, StartWait and EndWait (defined in SHOWDIB.H). To make those macros work, you need to add the following declaration in SHOWDVW.CPP:</P>
<P><BR></P><FONT FACE="COURIER" SIZE="3"><P>static HCURSOR    hcurSave;
</PRE></FONT>
<P>This ensures the macros, which use the name hcurSave, will find it already defined within the current file, as it already is in SHOWDIB.CPP and DIB.CPP, where the macros are also used.</P>
</FONT>
</BODY>
</HTML>
