<HTML>
<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the MFC Migration Kit book in the MSDN Library">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Moving Your Code into WindowProc</TITLE><META NAME="MS-HKWD" CONTENT="Moving Your Code into WindowProc"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<H4>    Moving Your Code into WindowProc</H4><P>This is the heart of your conversion to MFC. MFC calls the view's WindowProc before it passes incoming messages to its own "message map" mechanism. This means you can simply copy the typically huge <B>switch</B> statement from your C-language WndProc function into WindowProc. With a little tidying up, as described later, the program should then execute your message handlers as written.</P>
<P>For SHOWDIB, move your message handling code into WindowProc as follows:</P>
<P>    1.    Copy the entire body of your WndProc function, including local variable definitions, and paste it into CShowDibView::WindowProc. </P>
<P>    2.    Add the following include directive to file SHOWDVW.CPP:</P>
<P><BR></P><FONT FACE="COURIER" SIZE="3"><P>#include "showdib.h"<BR></PRE></FONT>
<P>    3.    Delete the entire WndProc function in SHOWDIB.CPP.</P>
<P>
<P>At the bottom of the function, AppWizard has written a call to <B>CView::WindowProc</B>, the base-class version of the function. This allows other objects in the MFC framework to handle messages that you don't handle. Leave that call in place, below all of your added code. The code from the <B>default</B> case on down should look like the following:</P>
<P><BR></P><FONT FACE="COURIER" SIZE="3"><P>LRESULT CShowDibView::WindowProc(UINT message, WPARAM wParam, 
                                 LPARAM lParam)
{
// ...
            break;

        default: 
                ;
        }

    return CView::WindowProc(message, wParam, lParam);
}
</PRE></FONT>
<P>
<P><B>Important</B>  In the MFC version, you don't call <B>DefWindowProc</B> to handle messages not handled by your code. Instead, the call to <B>CView::WindowProc</B> lets MFC take care of unhandled messages in its own way. For more information, see <A HREF="S4939.HTM#sec9">Calls to DefWindowProc and Other Non-MFC Functions</A>.</P>
<P>
<P></P>
<P>
<P><B>Note</B>  If your C code includes WndProc functions for more than one registered window class, you need to work out how the code in those functions fits into MFC. The functions might be for additional document/view types in an MDI application, or for child windows that will now be children of your view. The only ones you really need to convert are those that map to MFC view classes.</P>
<P>
</FONT>
</BODY>
</HTML>
