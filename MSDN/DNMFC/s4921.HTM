<HTML>
<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the MFC Migration Kit book in the MSDN Library">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Merging Resource Files</TITLE><META NAME="MS-HKWD" CONTENT="Merging Resource Files"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<H4>    Merging Resource Files</H4><P>AppWizard creates a .RC file for the new MFC project, containing some valuable resources. But you don't want to abandon your old resources either, so you must consolidate the two files, using the new one as a base. </P>
<P>Copy individual resources from your old .RC file, resource by resource, into the new project's .RC file, as described below. First read the general procedure, then take a look at the specifics for SHOWDIB.</P>
<P><B><FONT FACE="Symbol">Þ</FONT>    To copy resources from one file to another in Visual C++ </B></P>
<P>    1.    Open the new .RC file, then open the old .RC file in its original directory. </P>
<P>When you open an .RC file, Visual C++ (App Studio in versions before 2.0) compiles it and presents a window containing various categories of resources.</P>
<P>    2.    Position the two .RC file windows side by side in Visual C++. </P>
<P>    3.    Copy individual dialog, menu, icon, and other resources from the old file to the new. </P>
<P>
<P><B>Tip</B>  To copy a resource, hold down the CTRL key; then drag the resource from the old file and drop it onto the new file window. Without the CTRL key, you'll move the resource, not copy it.</P>
<P>
<P>
<P>Figure 5 shows two .RC windows open in Visual C++.</P>
<P><img src="PWPCOPY.gif"></P>
<P>
<P>When you save the new file, the MFC project's RESOURCE.H file is updated with IDs for the added resources.</P>
<P>
<P><B>Note</B>  RESOURCE.H is a standard MFC file that contains ID definitions for commands, dialog boxes, and so on. AppWizard and ClassWizard do most of the work of updating this file for you. The documentation describes its use, including advanced options. The best way to examine the symbols defined in your MFC application in Visual C++ 2.0 is to use the Resource Symbols command. In earlier versions, use the Edit Symbols command in App Studio. See your C++ documentation.</P>
<P>
<P>For SHOWDIB, merging resource files involves copying one icon, one menu, and several dialogs:</P>
<UL><LI>    To handle the icon resource, first delete the "IDR_MAINFRAME" icon resource under Icon in the MFC project. Then copy the "SHOWICON" resource under Icon in the C project into the MFC project and rename it to IDR_MAINFRAME. You want the original SHOWDIB icon to replace the default application icon that AppWizard created.</LI><LI>    Handle the menu resource similarly. Delete the default menu resource created by AppWizard ("IDR_MAINFRAME" under Menu) in the MFC project, then copy over the one from the C project ("SHOWDIB" under Menu) and rename it to IDR_MAINFRAME. </LI><LI>    Copy all of the dialog resources (under Dialog in the C project). 
<P>Except for the About dialog box, you'll use all of these as they are. You can either use the original About dialog box from the C project (ID "101") or use the equivalent resource in the new project (ID "IDD_ABOUTBOX"). (If you use the About dialog box supplied by AppWizard, it displays the icon you copied over earlier to IDR_MAINFRAME.) You can edit the AppWizard dialog box as needed.</P></LI></UL><P>
<P>In your application, handle other kinds of resources similarly. In some cases, you want your preexisting resource to replace the default version created by the wizard. Where there is no duplication, you simply want to copy your resources into the new project.</P>
</FONT>
</BODY>
</HTML>
