<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoRecordset::DoFieldExchange</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaorecordset.3a3a.dofieldexchange"></a>CDaoRecordset::DoFieldExchange</h1>
<p>
<b>virtual void DoFieldExchange( CDaoFieldExchange* </b><i>pFX</i><b> );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pFX</i></p>
<p class=indent>
Contains a pointer to a <b>CDaoFieldExchange</b> object. The framework will already have set up this object to specify a context for the field exchange operation.</p>
<p class=label>
<b>Remarks</b></p>
<p>
The framework calls this member function to automatically exchange data between the field data members of your recordset object and the corresponding columns of the current record on the data source. It also binds your parameter data members, if any, to parameter placeholders in the SQL statement string for the recordset’s selection. The exchange of field data, called DAO record field exchange (DFX), works in both directions: from the recordset object’s field data members to the fields of the record on the data source, and from the record on the data source to the recordset object. If you are binding columns dynamically, you are not required to implement <b>DoFieldExchange</b>.</p>
<p>
The only action you must normally take to implement <b>DoFieldExchange</b> for your derived recordset class is to create the class with ClassWizard and specify the names and data types of the field data members. You might also add code to what ClassWizard writes to specify parameter data members. If all fields are to be bound dynamically, this function will be inactive unless you specify parameter data members. For more information, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Recordset.3a_.Binding_Records_Dynamically">
</object><a href=JavaScript:alink_1.Click()>DAO Recordset: Binding Records Dynamically</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
When you declare your derived recordset class with ClassWizard, the wizard writes an override of <b>DoFieldExchange</b> for you, which resembles the following example:</p>
<pre><code>void CCustSet::DoFieldExchange(CDaoFieldExchange* pFX)
{
   //{{AFX_FIELD_MAP(CCustSet)
   pFX-&gt;SetFieldType(CDaoFieldExchange::outputColumn);
   DFX_Text(pFX, "Name", m_strName);
   DFX_Short(pFX, "Age", m_wAge);
   //}}AFX_FIELD_MAP
}
</code></pre>
<p>
For more information about record field exchange, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Record_Field_Exchange_.28.DFX.29">
</object><a href=JavaScript:alink_2.Click()>DAO Record Field Exchange (DFX)</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdaorecordset.htm">CDaoRecordset Overview</a>  |&nbsp; <a href="_mfc_cdaorecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaoexception.htm">CDaoException</a></p>
</font></BODY>
</HTML>
