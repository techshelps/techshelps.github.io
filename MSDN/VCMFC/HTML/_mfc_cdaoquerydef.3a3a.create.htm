<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoQueryDef::Create</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoquerydef.3a3a.create"></a>CDaoQueryDef::Create</h1>
<p>
<b>virtual void Create( LPCTSTR </b><i>lpszName</i><b> = NULL, LPCTSTR </b><i>lpszSQL</i><b> = NULL );<br>
throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszName</i></p>
<p class=indent>
&nbsp;The unique name of the query saved in the database. For details about the string, see the topic "CreateQueryDef Method" in DAO Help. If you accept the default value, an empty string, a temporary querydef is created. Such a query is not saved in the QueryDefs collection.</p>
<p class=dt>
<i>lpszSQL</i></p>
<p class=indent>
The SQL string that defines the query. If you accept the default value of <b>NULL</b>, you must later call <a href="_mfc_cdaoquerydef.3a3a.setsql.htm">SetSQL</a> to set the string. Until then, the query is undefined. You can, however, use the undefined query to open a recordset; see Remarks for details. The SQL statement must be defined before you can append the querydef to the QueryDefs collection.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to create a new saved query or a new temporary query. If you pass a name in <i>lpszName</i>, you can then call <a href="_mfc_cdaoquerydef.3a3a.append.htm">Append</a> to save the querydef in the database’s QueryDefs collection. Otherwise, the object is a temporary querydef and is not saved. In either case, the querydef is in an open state, and you can either use it to create a <a href="_mfc_cdaorecordset.htm">CDaoRecordset</a> object or call the querydef’s <a href="_mfc_cdaoquerydef.3a3a.execute.htm">Execute</a> member function.</p>
<p>
If you do not supply an SQL statement in <i>lpszSQL</i>, you cannot run the query with <b>Execute</b> but you can use it to create a recordset. In that case, MFC uses the recordset’s default SQL statement.</p>
<p>
For information about querydefs, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Querydef">
</object><a href=JavaScript:alink_1.Click()>DAO Querydef</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdaoquerydef.htm">CDaoQueryDef Overview</a>  |&nbsp; <a href="_mfc_cdaoquerydef_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaoquerydef.3a3a.open.htm">CDaoQueryDef::Open</a>, <a href="_mfc_cdaoquerydef.3a3a.cdaoquerydef.htm">CDaoQueryDef::CDaoQueryDef</a>, <a href="_mfc_cdaorecordset.3a3a.getsql.htm">CDaoRecordset::GetSQL</a></p>
</font></BODY>
</HTML>
