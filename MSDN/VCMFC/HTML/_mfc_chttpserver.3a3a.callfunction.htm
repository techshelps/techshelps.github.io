<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHttpServer::CallFunction</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_chttpserver.3a3a.callfunction"></a>CHttpServer::CallFunction</h1>
<p>
<b>virtual int CallFunction( CHttpServerContext* </b><i>pCtxt</i><b>, LPTSTR </b><i>pszQuery</i><b>,  LPTSTR </b><i>pszCommand</i><b> );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
A value of one of the following enum types:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=30%><b>Enum value</b></td>
<td class=label width=70%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=30%><b>callOK</b></td>
<td width=70%>The function call was successful.</td>
</tr>
<tr valign=top>
<td width=30%><b>callParamRequired</b></td>
<td width=70%>A required parameter was missing.</td>
</tr>
<tr valign=top>
<td width=30%><b>callBadParamCount</b></td>
<td width=70%>There were too many or too few parameters.</td>
</tr>
<tr valign=top>
<td width=30%><b>callBadCommand</b></td>
<td width=70%>The command name was not found.</td>
</tr>
<tr valign=top>
<td width=30%><b>callNoStackSpace</b></td>
<td width=70%>No stack space was available.</td>
</tr>
<tr valign=top>
<td width=30%><b>callNoStream</b></td>
<td width=70%>No <a href="_mfc_chtmlstream.htm">CHtmlStream</a> was available.</td>
</tr>
<tr valign=top>
<td width=30%><b>callMissingQuote</b></td>
<td width=70%>A parameter had a bad format.</td>
</tr>
<tr valign=top>
<td width=30%><b>callMissingParams</b></td>
<td width=70%>No parameters were available.</td>
</tr>
<tr valign=top>
<td width=30%><b>callBadParam</b></td>
<td width=70%>A parameter had a bad format (i.e., only one quote).</td>
</tr>
</table><br>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pCtxt</i></p>
<p class=indent>
Pointer to a <a href="_mfc_chttpservercontext.htm">CHttpServerContext</a> object.</p>
<p class=dt>
<i>pszQuery</i></p>
<p class=indent>
A pointer to a query. Specific to the type of command received from the client. See <b>Remarks</b> for more information.</p>
<p class=dt>
<i>pszCommand</i></p>
<p class=indent>
Either a pointer to a query or NULL. Specific to the type of command received from the client. See <b>Remarks</b> for more information.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Called by the framework to find and execute the appropriate function associated with the command in the URL.</p>
<p>
Below is a breakdown between the types of methods received and the parameters:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=17%><b>Method type</b></td>
<td class=label width=48%><b><i>pszQuery</i></b></td>
<td class=label width=35%><b><i>pszCommand</i></b></td>
</tr>
<tr valign=top>
<td width=17%><b>GET</b></td>
<td width=48%>A pointer to the <a href="_mfc_extension_control_block_structure.htm">EXTENSION_CONTROL_BLOCK</a> structure query string.</td>
<td width=35%><b>NULL</b></td>
</tr>
<tr valign=top>
<td width=17%><b>POST</b></td>
<td width=48%>A pointer to a query sent in the body of the command.</td>
<td width=35%>Pointer to the <a href="_mfc_extension_control_block_structure.htm">EXTENSION_CONTROL_BLOCK</a> structure query string.</td>
</tr>
</table><br>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Fill-out forms authors are advised to use only the POST method because of browser inconsistencies, and because GET methods are limited to a 1024-byte buffer. When writing forms for ISAPI, either use only the POST method, or design the ISA so that only the default function handles the form.</p>
<p>
For example, some browsers sending a form via GET with an action of:</p>
<pre><code>TestLet.DLL?Command
</code></pre>
<p>
will truncate <code>Command</code> and send:</p>
<pre><code>TestLet.DLL?name=value
</code></pre>
<p>
instead of the correct command:</p>
<pre><code>TestLet.DLL?Command?name=value
</code></pre>
<p>
By truncating <code>Command</code>, the browser removes the association to the ISA function needed to map the request. Unless the function <code>Command</code> is the default function, the form will not be handled correctly.</p>
<p>
If you want to handle parsing of the <b>EXTENSION_CONTROL_BLOCK</b> structure function <b>lpszQueryString</b> yourself, override <b>CallFunction</b> and do not use the <b>PARSE_MAP</b> macros. See <a href="_mfc_internet_server_api_.28.isapi.29_.parse_maps.htm">Internet Server API (ISAPI) Parse Maps</a> for more information on using the parse map macros.</p>
<p>
<a href="_mfc_chttpserver.htm">CHttpServer Overview</a>  |&nbsp; <a href="_mfc_chttpserver_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_chttpservercontext.htm">CHttpServerContext</a>, <a href="_mfc_internet_server_api_.28.isapi.29_.parse_maps.htm">Internet Server API (ISAPI) Parse Maps</a></p>
</font></BODY>
</HTML>
