<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CInternetSession</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cinternetsession"></a>CInternetSession</h1>
<p>
<img src="cinterns.gif" border=0></p>
<p>
Use class <b>CInternetSession</b> to create and initialize a single or several simultaneous Internet sessions and, if necessary, to describe your connection to a proxy server. If your Internet connection must be maintained for the duration of an application, you can create a <b>CInternetSession</b> member of the class <a href="_mfc_cwinapp.htm">CWinApp</a>.</p>
<p>
Once you have established an Internet session, you can call <a href="_mfc_cinternetsession.3a3a.openurl.htm">OpenURL</a>. <b>CInternetSession</b> then parses the URL for you by calling the global function <a href="_mfc_afxparseurl.htm">AfxParseURL</a>. Regardless of its protocol type, <b>CInternetSession</b> interprets the URL and manages it for you. It can handle requests for local files identified with the URL resource "file://". <b>OpenURL</b> will return a pointer to a <a href="_mfc_cstdiofile.htm">CStdioFile</a> object if the name you pass it is a local file. </p>
<p>
If you open a URL on an Internet server using <b>OpenURL</b>, you can read information from the site. If you want to perform service-specific (for example, HTTP, FTP, or gopher) actions on files located on a server, you must establish the appropriate connection with that server. To open a particular kind of connection directly to a particular service, use one of the following member functions:
<ul type=disc>
<li>
<a href="_mfc_cinternetsession.3a3a.getgopherconnection.htm">GetGopherConnection</a> to open a connection to a gopher service.<br><br></li>
<li>
<a href="_mfc_cinternetsession.3a3a.gethttpconnection.htm">GetHttpConnection</a> to open a connection to an HTTP service.<br><br></li>
<li>
<a href="_mfc_cinternetsession.3a3a.getftpconnection.htm">GetFtpConnection</a> to open a connection to an FTP service.</li>
</ul>
<p>
<a href="_mfc_cinternetsession.3a3a.queryoption.htm">QueryOption</a> and <a href="_mfc_cinternetsession.3a3a.setoption.htm">SetOption</a> allow you to set the query options of your session, such as time-out values, number of retries, and so on. </p>
<p>
<b>CInternetSession</b> member functions <a href="_mfc_cinternetsession.3a3a.setcookie.htm">SetCookie</a>, <a href="_mfc_cinternetsession.3a3a.getcookie.htm">GetCookie</a>, and <a href="_mfc_cinternetsession.3a3a.getcookielength.htm">GetCookieLength</a> provide the means to manage a Win32 cookie database, through which servers and scripts maintain state information about the client workstation.</p>
<p>
During an Internet session, a transaction such as a search or data download can take appreciable time. The user might want to continue working, or might want to have status information about the progress of the transaction. To handle this problem, <b>CInternetSession</b> provides for searches and data transfer to occur asychronously, allowing the user to perform other tasks while waiting for the transfer to complete. If you want to provide the user with status information, or if you want to handle any operations asynchronously, three conditions must be set:
<ul type=disc>
<li>
In the constructor, <i>dwFlags</i> must include <b>INTERNET_FLAG_ASYNC</b>.<br><br></li>
<li>
In the constructor, <i>dwContext</i> must be set to a nonzero value.<br><br></li>
<li>
You must establish a call back function by calling <a href="_mfc_cinternetsession.3a3a.enablestatuscallback.htm">EnableStatusCallback</a></li>
</ul>
<p>
Use the overridable member function <a href="_mfc_cinternetsession.3a3a.onstatuscallback.htm">OnStatusCallback</a> to get status information on asynchronous retrieval. To use this overridable member function, you must derive your own class from <b>CInternetSession</b>.</p>
<p>
For more information about asynchronous operations, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Internet_First_Steps.3a_.WinInet">
</object><a href=JavaScript:alink_1.Click()>Internet First Steps: WinInet</a> in <i>Visual C++ Programmer’s Guide</i>. For general information about using the MFC WinInet classes, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Internet_Programming_with_WinInet">
</object><a href=JavaScript:alink_2.Click()>Internet Programming with WinInet</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;<b>CInternetSession</b> will throw an <a href="_mfc_afxthrownotsupportedexception.htm">AfxThrowNotSupportedException</a> for unsupported service types. Only the following service types are currently supported: FTP, HTTP, gopher, and file.</p>
<p>
<b>#include &lt;afxinet.h&gt;</b></p>
<p>
<a href="_mfc_cinternetsession_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_cobject.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Samples</b>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_FTPTREE">
</object><a href=JavaScript:alink_3.Click()>MFC Sample FTPTREE</a>  |&nbsp; <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_TEAR">
</object><a href=JavaScript:alink_4.Click()>MFC Sample TEAR</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cinternetconnection.htm">CInternetConnection</a>, <a href="_mfc_chttpconnection.htm">CHttpConnection</a>, <a href="_mfc_cftpconnection.htm">CFtpConnection</a>, <a href="_mfc_cgopherconnection.htm">CGopherConnection</a></p>
</font></BODY>
</HTML>
