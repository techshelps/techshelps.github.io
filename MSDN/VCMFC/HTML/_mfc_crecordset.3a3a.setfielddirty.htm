<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CRecordset::SetFieldDirty</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_crecordset.3a3a.setfielddirty"></a><sup></sup>CRecordset::SetFieldDirty</h1>
<p>
<b>void</b> <b>SetFieldDirty(</b> <b>void*</b> <i>pv</i>, <b>BOOL</b> <i>bDirty</i> <b>=</b> <b>TRUE</b> <b>);</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pv</i></p>
<p class=indent>
Contains the address of a field data member in the recordset or <b>NULL</b>. If <b>NULL</b>, all field data members in the recordset are flagged. (C++ <b>NULL</b> is not the same as Null in database terminology, which means “having no value.”)</p>
<p class=dt>
<i>bDirty</i></p>
<p class=indent>
<b>TRUE</b> if the field data member is to be flagged as “dirty” (changed). Otherwise <b>FALSE</b> if the field data member is to be flagged as “clean” (unchanged).</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to flag a field data member of the recordset as changed or as unchanged. Marking fields as unchanged ensures the field is not updated and results in less SQL traffic.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This member function is not applicable on recordsets that are using bulk row fetching. If you have implemented bulk row fetching, then <b>SetFieldDirty</b> will result in a failed assertion. For more information about bulk row fetching, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Fetching_Records_in_Bulk_.28.ODBC.29">
</object><a href=JavaScript:alink_1.Click()>Recordset: Fetching Records in Bulk (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
The framework marks changed field data members to ensure they will be written to the record on the data source by the record field exchange (RFX) mechanism. Changing the value of a field generally sets the field dirty automatically, so you will seldom need to call <b>SetFieldDirty</b> yourself, but you might sometimes want to ensure that columns will be explicitly updated or inserted regardless of what value is in the field data member.</p>
<p class=indent>
<B><b>Important</b></B>&nbsp;&nbsp;&nbsp;Call this member function only after you have called <a href="_mfc_crecordset.3a3a.edit.htm">Edit</a> or <a href="_mfc_crecordset.3a3a.addnew.htm">AddNew</a>.</p>
<p>
Using <b>NULL</b> for the first argument of the function will apply the function only to <b>outputColumns</b>, not <b>params</b>. For instance, the call</p>
<pre><code>SetFieldNull( NULL );
</code></pre>
<p>
will set only <b>outputColumns</b> to <b>NULL</b>. <b>Params</b> will be unaffected.</p>
<p>
To work on <b>params</b>, you must supply the actual address of the individual <b>param</b> you want to work on, such as:</p>
<pre><code>SetFieldNull( &amp;m_strParam );
</code></pre>
<p>
This means you cannot set all <b>params</b> <b>NULL</b>, as you can with <b>outputColumns</b>.</p>
<p>
<a href="_mfc_crecordset.htm">CRecordset Overview</a>  |&nbsp; <a href="_mfc_crecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a> </p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_crecordset.3a3a.isfielddirty.htm">CRecordset::IsFieldDirty</a>, <a href="_mfc_crecordset.3a3a.setfieldnull.htm">CRecordset::SetFieldNull</a>, <a href="_mfc_crecordset.3a3a.edit.htm">CRecordset::Edit</a>, <a href="_mfc_crecordset.3a3a.update.htm">CRecordset::Update</a></p>
</font></BODY>
</HTML>
