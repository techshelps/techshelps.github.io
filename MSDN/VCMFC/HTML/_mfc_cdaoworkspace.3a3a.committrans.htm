<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoWorkspace::CommitTrans</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoworkspace.3a3a.committrans"></a>CDaoWorkspace::CommitTrans</h1>
<p>
<b>void CommitTrans( );<br>
throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to commit a transaction — save a group of edits and updates to one or more databases in the workspace. A transaction consists of a series of changes to the database’s data or its structure, beginning with a call to <a href="_mfc_cdaoworkspace.3a3a.begintrans.htm">BeginTrans</a>. When you complete the transaction, either commit it or roll it back (cancel the changes) with <a href="_mfc_cdaoworkspace.3a3a.rollback.htm">Rollback</a>. By default, without transactions, updates to records are committed immediately. Calling <b>BeginTrans</b> causes commitment of updates to be delayed until you call <b>CommitTrans</b>. </p>
<p class=indent>
<B><b>CAUTION</b></B>&nbsp;&nbsp;&nbsp;Within one workspace, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, <b>CommitTrans</b> commits all pending updates, and <b>Rollback</b> restores all operations on those databases and recordsets.</p>
<p>
When you close a database or workspace with pending transactions, the transactions are all rolled back.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This is not a two-phase commit mechanism. If one update fails to commit, others still will commit.</p>
<p>
For more information about workspaces, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Workspace">
</object><a href=JavaScript:alink_1.Click()>DAO Workspace</a>. For more about transactions, including information about separate transaction spaces, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Workspace.3a_.Managing_Transactions">
</object><a href=JavaScript:alink_2.Click()>DAO Workspace: Managing Transactions</a>. Both articles are in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdaoworkspace.htm">CDaoWorkspace Overview</a>  |&nbsp; <a href="_mfc_cdaoworkspace_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
</font></BODY>
</HTML>
