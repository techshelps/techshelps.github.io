<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Do I Add OLE DB Consumer Support to an MFC Application Without Using the Wizard?</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcfaqhowdoiwriteconsumerwithoutusingwizard"></a>How Do I Add OLE DB Consumer Support To an MFC Application Without Using the Wizard?</h1>
<p>
The following example assumes you are adding OLE DB Consumer support to an existing ATL project. If you want to add OLE DB Consumer support to an MFC application, you should run the MFC AppWizard, which creates all of the support necessary and invokes MFC routines necessary to execute the application.</p>
<p>
To add OLE DB Consumer support without using the ATL Object Wizard:
<ul type=disc>
<li>
In your Stdafx.h file, add the following code below the afx include statement:<pre><code>#include &lt;atlbase.h&gt;
extern CComModule _Module;
#include &lt;atlcom.h&gt;
#include &lt;atldbcli.h&gt;
#include &lt;atldbsch.h&gt; // if you are using schema templates
</code></pre>
</li>
<li>
In your Stdafx.cpp file, add the following code below the stdafx.h include statement:<pre><code>#include &lt;atlimpl.cpp&gt;
CComModule _Module;
</code></pre>
</li>
<li>
Decide what type of accessor and rowset to use.<br><br></li>
<li>
See <a href="vcrefcreatingoledbconsumer.htm">Creating an OLE DB Consumer</a> for more information.</li>
</ul>
</font></BODY>
</HTML>
