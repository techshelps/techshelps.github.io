<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoRecordset::Open</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaorecordset.3a3a.open"></a>CDaoRecordset::Open</h1>
<p>
<b>virtual void Open( int </b><i>nOpenType</i><b> = AFX_DAO_USE_DEFAULT_TYPE, LPCTSTR </b><i>lpszSQL</i><b> = NULL, int </b><i>nOptions </i><b>= 0 );<br>
throw( CDaoException, CMemoryException );</b></p>
<p>
<b>virtual void Open( CDaoTableDef*</b> <i>pTableDef</i><b>,</b> <b>int </b><i>nOpenType</i><b> = dbOpenTable, int </b><i>nOptions </i><b>= 0 );<br>
throw( CDaoException, CMemoryException );</b></p>
<p>
<b>virtual void Open( CDaoQueryDef*</b> <i>pQueryDef</i><b>,</b> <b>int </b><i>nOpenType</i><b> = dbOpenDynaset, int </b><i>nOptions </i><b>= 0 );<br>
throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nOpenType</i></p>
<p class=indent>
One of the following values:
<ul type=disc>
<li>
<b>dbOpenDynaset</b>&nbsp;&nbsp;&nbsp;A dynaset-type recordset with bidirectional scrolling. This is the default.<br><br></li>
<li>
<b>dbOpenTable</b>&nbsp;&nbsp;&nbsp;A table-type recordset with bidirectional scrolling.<br><br></li>
<li>
<b>dbOpenSnapshot</b>&nbsp;&nbsp;&nbsp;A snapshot-type recordset with bidirectional scrolling.</li>
</ul>
<p class=dt>
<i>lpszSQL</i></p>
<p class=indent>
A string pointer containing one of the following:
<ul type=disc>
<li>
A <b>NULL</b> pointer.<br><br></li>
<li>
The name of one or more tabledefs and/or querydefs (comma-separated).<br><br></li>
<li>
An SQL <b>SELECT</b> statement (optionally with an SQL <b>WHERE</b> or <b>ORDER</b> <b>BY</b> clause). <br><br></li>
<li>
A pass-through query.</li>
</ul>
<p class=dt>
<i>nOptions</i></p>
<p class=indent>
One or more of the options listed below. The default value is 0. Possible values are as follows:
<ul type=disc>
<li>
<b>dbAppendOnly</b>&nbsp;&nbsp;&nbsp;You can only append new records (dynaset-type recordset only). This option means literally that records may only be appended. The MFC ODBC database classes have an append-only option that allows records to be retrieved and appended.<br><br></li>
<li>
<b>dbForwardOnly</b>&nbsp;&nbsp;&nbsp;The recordset is a forward-only scrolling snapshot.<br><br></li>
<li>
<b>dbSeeChanges</b>&nbsp;&nbsp;&nbsp;Generate an exception if another user is changing data you are editing. <br><br></li>
<li>
<b>dbDenyWrite</b>&nbsp;&nbsp;&nbsp;Other users cannot modify or add records. <br><br></li>
<li>
<b>dbDenyRead</b>&nbsp;&nbsp;&nbsp;Other users cannot view records (table-type recordset only).<br><br></li>
<li>
<b>dbReadOnly</b>&nbsp;&nbsp;&nbsp;You can only view records; other users can modify them. <br><br></li>
<li>
<b>dbInconsistent</b>&nbsp;&nbsp;&nbsp;Inconsistent updates are allowed (dynaset-type recordset only).<br><br></li>
<li>
<b>dbConsistent</b>&nbsp;&nbsp;&nbsp;Only consistent updates are allowed (dynaset-type recordset only).<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The constants <b>dbConsistent</b> and <b>dbInconsistent</b> are mutually exclusive. You can use one or the other, but not both in a given instance of <b>Open</b>.</p></li>
</ul>
<p class=dt>
<i>pTableDef</i></p>
<p class=indent>
&nbsp;A pointer to a <a href="_mfc_cdaotabledef.htm">CDaoTableDef</a> object. This version is valid only for table-type recordsets. When using this option, the <b>CDaoDatabase</b> pointer used to construct the <b>CDaoRecordset</b> is not used; rather, the database in which the tabledef resides is used.</p>
<p class=dt>
<i>pQueryDef</i></p>
<p class=indent>
A pointer to a <a href="_mfc_cdaoquerydef.htm">CDaoQueryDef</a> object. This version is valid only for dynaset-type and snapshot-type recordsets. When using this option, the <b>CDaoDatabase</b> pointer used to construct the <b>CDaoRecordset</b> is not used; rather, the database in which the querydef resides is used. </p>
<p class=label>
<b>Remarks</b></p>
<p>
You must call this member function to retrieve the records for the recordset. Before calling <b>Open</b>, you must construct the recordset object. There are several ways to do this:
<ul type=disc>
<li>
When you construct the recordset object, pass a pointer to a <b>CDaoDatabase</b> object that is already open.<br><br></li>
<li>
When you construct the recordset object, pass a pointer to a <b>CDaoDatabase</b> object that is not open. The recordset opens a <b>CDaoDatabase</b> object, but will not close it when the recordset object closes.<br><br></li>
<li>
When you construct the recordset object, pass a <b>NULL</b> pointer. The recordset object calls <b>GetDefaultDBName</b> to get the name of the Microsoft Access .MDB file to open. The recordset then opens a <b>CDaoDatabase</b> object and keeps it open as long as the recordset is open. When you call <b>Close</b> on the recordset, the <b>CDaoDatabase</b> object is also closed.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When the recordset opens the <b>CDaoDatabase</b> object, it opens the data source with nonexclusive access.</p></li>
</ul>
<p>
For the version of <b>Open</b> that uses the <i>lpszSQL</i> parameter, once the recordset is open you can retrieve records in one of several ways. The first option is to have DFX functions in your <b>DoFieldExchange</b>. The second option is to use dynamic binding by calling the <b>GetFieldValue</b> member function. These options can be implemented separately or in combination. If they are combined, you will have to pass in the SQL statement yourself on the call to <b>Open</b>. For more information about dynamic binding, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Recordset.3a_.Binding_Records_Dynamically">
</object><a href=JavaScript:alink_1.Click()>DAO Recordset: Binding Records Dynamically</a> in <i>Visual C++ Programmer's Guide</i>.&nbsp; </p>
<p>
When you use the second version of <b>Open</b> where you pass in a <b>CDaoTableDef</b> object, the resulting columns will be available for you to bind via <b>DoFieldExchange</b> and the DFX mechanism, and/or bind dynamically via <b>GetFieldValue</b>. </p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;You can only call <b>Open</b> using a <b>CDaoTableDef</b> object for table-type recordsets.</p>
<p>
When you use the third version of <b>Open</b> where you pass in a <b>CDaoQueryDef</b> object, that query will be executed, and the resulting columns will be available for you to bind via <b>DoFieldExchange</b> and the DFX mechanism, and/or bind dynamically via <b>GetFieldValue</b>. </p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;You can only call <b>Open</b> using a <b>CDaoQueryDef</b> object for dynaset-type and snapshot-type recordsets.</p>
<p>
For the first version of <b>Open</b> that uses the <i>lpszSQL</i> parameter, records are selected based on criteria shown in the following table.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>Value of the <i>lpszSQL</i> parameter</b></td>
<td class=label width=33%><b>Records selected are determined by</b></td>
<td class=label width=36%><b>Example</b></td>
</tr>
<tr valign=top>
<td width=31%><b>NULL</b></td>
<td width=33%>The string returned by <b>GetDefaultSQL</b>.</td>
<td width=36%></td>
</tr>
<tr valign=top>
<td width=31%>A comma-separated list of one or more tabledefs and/or querydef names.</td>
<td width=33%>All columns represented in the <b>DoFieldExchange</b>.</td>
<td width=36%><pre><code>"Customer"</code></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><b>SELECT</b> column-list <b>FROM</b> table-list</td>
<td width=33%>The specified columns from the specified tabledef(s) and/or querydef(s).</td>
<td width=36%><pre><code>"SELECT CustId, CustName
FROM Customer"</code></pre>
</td>
</tr>
</table><br>
<p>
The usual procedure is to pass <b>NULL</b> to <b>Open</b>; in that case, <b>Open</b> calls <b>GetDefaultSQL</b>, an overridable member function that ClassWizard generates when creating a <b>CDaoRecordset</b>-derived class. This value gives the tabledef(s) and/or querydef name(s) you specified in ClassWizard. You can instead specify other information in the <i>lpszSQL</i> parameter.</p>
<p>
Whatever you pass, <b>Open</b> constructs a final SQL string for the query (the string may have SQL <b>WHERE</b> and <b>ORDER</b> <b>BY</b> clauses appended to the <i>lpszSQL</i> string you passed) and then executes the query. You can examine the constructed string by calling <b>GetSQL</b> after calling <b>Open</b>.</p>
<p>
The field data members of your recordset class are bound to the columns of the data selected. If any records are returned, the first record becomes the current record. </p>
<p>
If you want to set options for the recordset, such as a filter or sort, set <b>m_strSort</b> or <b>m_strFilter</b> after you construct the recordset object but before you call <b>Open</b>. If you want to refresh the records in the recordset after the recordset is already open, call <b>Requery</b>.</p>
<p>
If you call <b>Open</b> on a dynaset-type or snapshot-type recordset, or if the data source refers to an SQL statement or a tabledef that represents an attached table, you cannot use <b>dbOpenTable</b> for the type argument; if you do, MFC throws an exception. To determine whether a tabledef object represents an attached table, create a <a href="_mfc_cdaotabledef.htm">CDaoTableDef</a> object and call its <a href="_mfc_cdaotabledef.3a3a.getconnect.htm">GetConnect</a> member function. </p>
<p>
Use the <b>dbSeeChanges</b> flag if you wish to trap changes made by another user or another program on your machine when you are editing or deleting the same record. For example, if two users start editing the same record, the first user to call the <b>Update</b> member function succeeds. When <b>Update</b> is called by the second user, a <b>CDaoException</b> is thrown. Similarly, if the second user tries to call <b>Delete</b> to delete the record, and it has already been changed by the first user, a <b>CDaoException</b> occurs.</p>
<p>
Typically, if the user gets this <b>CDaoException</b> while updating, your code should refresh the contents of the fields and retrieve the newly modified values. If the exception occurs in the process of deleting, your code could display the new record data to the user and a message indicating that the data has recently changed. At this point, your code can request a confirmation that the user still wants to delete the record.</p>
<p class=indent>
<B><b>Tip</b></B>  Use the forward-only scrolling option (<b>dbForwardOnly</b>) to improve performance when your application makes a single pass through a recordset opened from an ODBC data source.</p>
<p>
For more information about opening recordsets, see the articles <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Recordset.3a_.Creating_Recordsets">
</object><a href=JavaScript:alink_2.Click()>DAO Recordset: Creating Recordsets</a> and <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO.3a_.Creating.2c_.Opening.2c_.and_Closing_DAO_Objects">
</object><a href=JavaScript:alink_3.Click()>DAO: Creating, Opening, and Closing DAO Objects</a> in <i>Visual C++ Programmer's Guide</i>. For related information, see the topic "OpenRecordset Method" in DAO Help.</p>
<p>
<a href="_mfc_cdaorecordset.htm">CDaoRecordset Overview</a>  |&nbsp; <a href="_mfc_cdaorecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaorecordset.3a3a.close.htm">CDaoRecordset::Close</a>, <a href="_mfc_cdaorecordset.3a3a.cdaorecordset.htm">CDaoRecordset::CDaoRecordset</a></p>
</font></BODY>
</HTML>
