<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the ATL COM AppWizard</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_atl_using_the_atl_com_appwizard"></a>Using the ATL COM AppWizard</h1>
<p class=label>
<b>To create a project using the ATL COM AppWizard</b>
<ol>
<li>
Open Visual C++. Click <b>New</b> on the <b>File</b> menu and click the <b>Projects</b> tab.<br><br></li>
<li>
Choose <b>ATL COM AppWizard </b>as your application type.<br><br></li>
<li>
Enter a project name.<br><br></li>
<li>
Click <b>OK</b>.<p>
<img src="vc307o1.gif" border=0></P></li>
</ol>
<p>
The ATL COM AppWizard displays a dialog box showing options that apply to your ATL project:
<ul type=disc>
<li>
Choose from one of three server types: <b>Dynamic Link Library (DLL)</b> for an in-process server, <b>Executable (EXE)</b> for a local out-of-process server, or <b>Service (EXE)</b>, which is a Windows NT application that runs in the background when NT starts up. <br><br></li>
<li>
Select the <b>Allow merging of proxy/stub code</b> check box as a convenience when marshaling interfaces is required. This option places the MIDL generated proxy and stub code in the same DLL as the server.<br><br></li>
<li>
Select the <b>Support MFC</b> check box (available for DLL projects only) to use MFC functionality (such as <b>CString</b>) in your server.<br><br></li>
<li>
Select the <b>Support MTS</b> check box to modify the project build settings to support the Microsoft Transaction Server. For more information on adding MTS support to your project, see <a href="vcrefmtssupportinatlprojects.htm">MTS Support in ATL Projects</a>. </li>
</ul>
<p>
Click <b>Finish</b> to generate the project. The AppWizard then displays information about the project that it is creating and then displays the newly created project in the Project Workspace.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When you build your project, you can choose a <b>MinSize</b> or <b>MinDependency</b> configuration. <b>MinSize</b> will generate a smaller component, since shared code will be used from Atl.dll. In this case, you must distribute Atl.dll with your component. <b>MinDependency</b> will generate a larger component, since all necessary code will be linked in with your component.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When building a Release version of a project, you can get the following link error:</p>
<pre><code>LIBCMT.LIB(crt0.obj) : error LNK2001: unresolved external symbol _main</code></pre>
<p class=indent>
This error occurs if you are using CRT functions that require CRT startup code. The Release configurations define <b>_ATL_MIN_CRT</b>, which excludes CRT startup code from your EXE or DLL. To avoid this error, do one of the following:
<ul type=disc>
<li>
Remove <b>_ATL_MIN_CRT</b> from the list of preprocessor defines to allow CRT startup code to be included. On the <b>Project</b> menu, click <b>Settings</b>. In the <b>Settings For:</b> drop-down list, choose <b>Multiple Configurations</b>. In the <b>Select project configuration(s) to modify</b> dialog box that appears, click the check boxes for all Release versions, and then click <b>OK</b>. On the <b>C/C++</b> tab, choose the <b>General</b> category, then remove <b>_ATL_MIN_CRT</b> from the <b>Preprocessor definitions</b> edit box.<br><br></li>
<li>
If possible, remove calls to CRT functions that require CRT startup code and use their Win32 equivalents. For example, use <b>lstrcmp</b> instead of <b>strcmp</b>. Known functions that require CRT startup code are some of the string and floating point functions.</li>
</ul>
</font></BODY>
</HTML>
