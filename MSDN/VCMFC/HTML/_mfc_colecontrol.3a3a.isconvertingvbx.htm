<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COleControl::IsConvertingVBX</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_colecontrol.3a3a.isconvertingvbx"></a><sup></sup>COleControl::IsConvertingVBX</h1>
<p>
<b>BOOL</b> <b>IsConvertingVBX(</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if the control is being converted; otherwise 0.</p>
<p class=label>
<b>Remarks</b></p>
<p>
When converting a form that uses VBX controls to one that uses OLE controls, special loading code for the OLE controls may be required. For example, if you are loading an instance of your OLE control, you might have a call to <a href="_mfc_px_font.htm">PX_Font</a> in your <b>DoPropExchange</b>:</p>
<pre><code>PX_Font(pPx, "Font", m_MyFont, pDefaultFont);
</code></pre>
<p>
However, VBX controls did not have a Font object; each font property was saved individually. In this case, you would use <b>IsConvertingVBX</b> to distinguish between these two cases:</p>
<pre><code>if (IsConvertingVBX()==FALSE)
 &nbsp;&nbsp; PX_Font(pPX, "Font", m_MyFont, pDefaultFont);
else
{
 &nbsp;&nbsp; PX_String(pPX, "FontName", tempString, DefaultName);
 &nbsp;&nbsp; m_MyFont-&gt;put_Name(tempString);
 &nbsp;&nbsp; PX_Bool(pPX, "FontUnderline", tempBool, DefaultValue);
 &nbsp;&nbsp; m_MyFont-&gt;put_Underline(tempBool);
...
}
</code></pre>
<p>
Another case would be if your VBX control saved proprietary binary data (in its <b>VBM_SAVEPROPERTY</b> message handler), and your OLE control saves its binary data in a different format. If you want your OLE control to be backward-compatible with the VBX control, you could read both the old and new formats using the <b>IsConvertingVBX</b> function by distinguishing whether the VBX control or the OLE control was being loaded.</p>
<p>
In your control’s <b>DoPropExchange</b> function, you can check for this condition and if true, execute load code specific to this conversion (such as the previous examples). If the control is not being converted, you can execute normal load code. This ability is only applicable to controls being converted from VBX counterparts.</p>
<p>
<a href="_mfc_colecontrol.htm">COleControl Overview</a>  |&nbsp; <a href="_mfc_colecontrol_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_colecontrol.3a3a.dopropexchange.htm">COleControl::DoPropExchange</a> </p>
</font></BODY>
</HTML>
