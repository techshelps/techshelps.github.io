<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoException</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoexception"></a>CDaoException</h1>
<p>
<img src="cdexcep.gif" border=0></p>
<p>
A <b>CDaoException</b> object represents an exception condition arising from the MFC database classes based on data access objects (DAO). The class includes public data members you can use to determine the cause of the exception. <b>CDaoException</b> objects are constructed and thrown by member functions of the DAO database classes. </p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the “CDao” prefix. You can still access ODBC data sources with the DAO classes. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine. The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly. For information on exceptions thrown by the ODBC classes, see <a href="_mfc_cdbexception.htm">CDBException</a>.</p>
<p>
You can access exception objects within the scope of a <a href="_mfc_catch.htm">CATCH</a> expression. You can also throw <b>CDaoException</b> objects from your own code with the <a href="_mfc_afxthrowdaoexception.htm">AfxThrowDaoException</a> global function. </p>
<p>
In MFC, all DAO errors are expressed as exceptions, of type <b>CDaoException</b>. When you catch an exception of this type, you can use <b>CDaoException</b> member functions to retrieve information from any DAO error objects stored in the database engine’s Errors collection. As each error occurs, one or more error objects are placed in the Errors collection. (Normally the collection contains only one error object; if you are using an ODBC data source, you are more likely to get multiple error objects.) When another DAO operation generates an error, the Errors collection is cleared, and the new error object is placed in the Errors collection. DAO operations that do not generate an error have no effect on the Errors collection.</p>
<p>
For DAO error codes, see the file DAOERR.H. For related information, see the topic "Trappable Data Access Errors" in DAO Help.</p>
<p>
For more information about exception handling in general, or about <b>CDaoException</b> objects, see the articles <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Exceptions">
</object><a href=JavaScript:alink_1.Click()>Exceptions</a> and <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Exceptions.3a_.Database_Exceptions">
</object><a href=JavaScript:alink_2.Click()>Exceptions: Database Exceptions</a> in <i>Visual C++ Programmer's Guide</i>. The second article contains example code that illustrates exception handling in DAO. </p>
<p>
<b>#include &lt;afxdao.h&gt;</b></p>
<p>
<a href="_mfc_cdaoexception_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_cexception.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Sample</b>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_DAOVIEW">
</object><a href=JavaScript:alink_3.Click()>MFC Sample DAOVIEW</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cexception.htm">CException</a></p>
</font></BODY>
</HTML>
