<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDatabase::Open</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdatabase.3a3a.open"></a><sup></sup>CDatabase::Open</h1>
<p>
<b>virtual</b> <b>BOOL</b> <b>Open(</b> <b>LPCTSTR</b> <i>lpszDSN</i><b>,</b> <b>BOOL</b> <i>bExclusive</i> = <b>FALSE,</b> <b>BOOL</b> <i>bReadOnly</i> = <b>FALSE,</b> <b>LPCTSTR</b> <i>lpszConnect</i> = <b>“ODBC;”,</b> <b>BOOL</b> <i>bUseCursorLib</i> <b>=</b> <b>TRUE</b> <b>);</b><br>
<b>throw(</b> <b>CDBException,</b> <b>CMemoryException</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if the connection is successfully made; otherwise 0 if the user chooses Cancel when presented a dialog box asking for more connection information. In all other cases, the framework throws an exception.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszDSN</i></p>
<p class=indent>
Specifies a data source name — a name registered with ODBC through the ODBC Administrator program. If a DSN value is specified in <i>lpszConnect</i> (in the form “DSN=&lt;data-source&gt;”), it must not be specified again in <i>lpszDSN</i>. In this case, <i>lpszDSN</i> should be <b>NULL</b>. Otherwise, you can pass <b>NULL</b> if you want to present the user with a Data Source dialog box in which the user can select a data source. For further information, see Remarks.</p>
<p class=dt>
<i>bExclusive</i></p>
<p class=indent>
Not supported in this version of the class library. Currently, an assertion fails if this parameter is <b>TRUE</b>. The data source is always opened as shared (not exclusive).</p>
<p class=dt>
<i>bReadOnly</i></p>
<p class=indent>
<b>TRUE</b> if you intend the connection to be read-only and to prohibit updates to the data source. All dependent recordsets inherit this attribute. The default value is <b>FALSE</b>.</p>
<p class=dt>
<i>lpszConnect</i></p>
<p class=indent>
Specifies a connect string. The connect string concatenates information, possibly including a data source name, a user ID valid on the data source, a user authentication string (password, if the data source requires one), and other information. The whole connect string must be prefixed by the string “ODBC;” (uppercase or lowercase). The “ODBC;” string is used to indicate that the connection is to an ODBC data source; this is for upward compatibility when future versions of the class library might support non-ODBC data sources.</p>
<p class=dt>
<i>bUseCursorLib</i></p>
<p class=indent>
<b>TRUE</b> if you want the ODBC Cursor Library DLL to be loaded. The cursor library masks some functionality of the underlying ODBC driver, effectively preventing the use of dynasets (if the driver supports them). The only cursors supported if the cursor library is loaded are static snapshots and forward-only cursors. The default value is <b>TRUE</b>. If you plan to create a recordset object directly from <b>CRecordset</b> without deriving from it, you should not load the cursor library.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to initialize a newly constructed <b>CDatabase</b> object. Your database object must be initialized before you can use it to construct a recordset object.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Calling the <a href="_mfc_cdatabase.3a3a.openex.htm">OpenEx</a> member function is the preferred way to connect to a data source and initialize your database object.</p>
<p>
If the parameters in your <b>Open</b> call do not contain enough information to make the connection, the ODBC driver opens a dialog box to obtain the necessary information from the user. When you call <b>Open</b>, your connect string, <i>lpszConnect</i>, is stored privately in the <b>CDatabase</b> object and is available by calling the <a href="_mfc_cdatabase.3a3a.getconnect.htm">GetConnect</a> member function. </p>
<p>
If you wish, you can open your own dialog box before you call <b>Open</b> to get information from the user, such as a password, then add that information to the connect string you pass to <b>Open</b>. Or you might want to save the connect string you pass so you can reuse it the next time your application calls <b>Open</b> on a <b>CDatabase</b> object.</p>
<p>
You can also use the connect string for multiple levels of login authorization (each for a different <b>CDatabase</b> object) or to convey other data source-specific information. For more information about connect strings, see Chapter 5 in the <i>ODBC SDK Programmer’s Reference</i>.</p>
<p>
It is possible for a connection attempt to time out if, for example, the DBMS host is unavailable. If the connection attempt fails, <b>Open</b> throws a <b>CDBException</b>.</p>
<p class=label>
<b>Example</b></p>
<pre><code>// Embed a CDatabase object
// in your document class
CDatabase m_dbCust;

// Connect the object to a
// data source (no password)
// the ODBC connection dialog box
// will always remain hidden
m_dbCust.Open( _T( "MYDATASOURCE" ), FALSE,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FALSE, _T( "ODBC;UID=JOES" ),

// ...Or, query the user for all
// connection information
m_dbCust.Open( NULL );
</code></pre>
<p>
<a href="_mfc_cdatabase.htm">CDatabase Overview</a>  |&nbsp; <a href="_mfc_cdatabase_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdatabase.3a3a.openex.htm">CDatabase::OpenEx</a>, <a href="_mfc_cdatabase.3a3a.cdatabase.htm">CDatabase::CDatabase</a>, <a href="_mfc_cdatabase.3a3a.close.htm">CDatabase::Close</a>, <a href="_mfc_cdbexception.htm">CDBException</a>, <a href="_mfc_crecordset.3a3a.open.htm">CRecordset::Open</a></p>
</font></BODY>
</HTML>
