<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoQueryDefInfo Structure</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoquerydefinfo_structure"></a>CDaoQueryDefInfo Structure</h1>
<p>
The <b>CDaoQueryDefInfo</b> structure has the following form:</p>
<pre><code>struct CDaoQueryDefInfo
{
 &nbsp; CString m_strName;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Primary
 &nbsp; short m_nType;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Primary
 &nbsp; COleDateTime m_dateCreated;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Secondary
 &nbsp; COleDateTime m_dateLastUpdated;&nbsp; // Secondary
 &nbsp; BOOL m_bUpdatable;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Secondary
 &nbsp; BOOL m_bReturnsRecords;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Secondary
 &nbsp; CString m_strSQL;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // All
 &nbsp; CString m_strConnect;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // All
 &nbsp; short m_nODBCTimeout;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // All
};
</code></pre>
<p>
The <b>CDaoQueryDefInfo</b> structure contains information about a querydef object defined for data access objects (DAO). The querydef is an object of class <a href="_mfc_cdaoquerydef.htm">CDaoQueryDef</a>. The references to Primary, Secondary, and All above indicate how the information is returned by the <a href="_mfc_cdaodatabase.3a3a.getquerydefinfo.htm">GetQueryDefInfo</a> member function in class <b>CDaoDatabase</b>.</p>
<p class=label>
<b>Members</b></p>
<p class=dt>
<b>m_strName</b></p>
<p class=indent>
Uniquely names the querydef object. For more information, see the topic "Name Property" in DAO Help. Call <a href="_mfc_cdaoquerydef.3a3a.getname.htm">CDaoQueryDef::GetName</a> to retrieve this property directly.</p>
<p class=dt>
<b>m_nType</b></p>
<p class=indent>
A value that indicates the operational type of a querydef object. The value can be one of the following:
<ul type=disc>
<li>
<b>dbQSelect</b>&nbsp;&nbsp;&nbsp;Select — the query selects records.<br><br></li>
<li>
<b>dbQAction</b>&nbsp;&nbsp;&nbsp;Action — the query moves or changes data but does not return records.<br><br></li>
<li>
<b>dbQCrosstab</b>&nbsp;&nbsp;&nbsp;Crosstab — the query returns data in a spreadsheet-like format.<br><br></li>
<li>
<b>dbQDelete</b>&nbsp;&nbsp;&nbsp;Delete — the query deletes a set of specified rows.<br><br></li>
<li>
<b>dbQUpdate</b>&nbsp;&nbsp;&nbsp;Update — the query changes a set of records.<br><br></li>
<li>
<b>dbQAppend</b>&nbsp;&nbsp;&nbsp;Append — the query adds new records to the end of a table or query.<br><br></li>
<li>
<b>dbQMakeTable</b>&nbsp;&nbsp;&nbsp;Make-table — the query creates a new table from a recordset.<br><br></li>
<li>
<b>dbQDDL</b>&nbsp;&nbsp;&nbsp;Data-definition — the query affects the structure of tables or their parts.<br><br></li>
<li>
<b>dbQSQLPassThrough</b>&nbsp;&nbsp;&nbsp;Pass-through — the SQL statement is passed directly to the database backend, without intermediate processing.<br><br></li>
<li>
<b>dbQSetOperation</b>&nbsp;&nbsp;&nbsp;Union — the query creates a snapshot-type recordset object containing data from all specified records in two or more tables with any duplicate records removed. To include the duplicates, add the keyword <b>ALL</b> in the querydef’s SQL statement.<br><br></li>
<li>
<b>dbQSPTBulk</b>&nbsp;&nbsp;&nbsp;Used with <b>dbQSQLPassThrough</b> to specify a query that does not return records.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;To create an SQL pass-through query, you do not set the <b>dbQSQLPassThrough</b> constant. This is set automatically by the Microsoft Jet database engine when you create a querydef object and set the Connect property.</p><p class=tl>
For more information, see the topic "Type Property" in DAO Help.</P></li>
</ul>
<p class=dt>
<b>m_dateCreated</b></p>
<p class=indent>
The date and time the querydef was created. To directly retrieve the date the querydef was created, call the <a href="_mfc_cdaotabledef.3a3a.getdatecreated.htm">GetDateCreated</a> member function of the <b>CDaoTableDef</b> object associated with the table. See Comments below for more information. Also see the topic "DateCreated, LastUpdated Properties" in DAO Help.</p>
<p class=dt>
<b>m_dateLastUpdated</b></p>
<p class=indent>
The date and time of the most recent change made to the querydef. To directly retrieve the date the table was last updated, call the <a href="_mfc_cdaoquerydef.3a3a.getdatelastupdated.htm">GetDateLastUpdated</a> member function of the querydef. See Comments below for more information. And see the topic "DateCreated, LastUpdated Properties" in DAO Help.</p>
<p class=dt>
<b>m_bUpdatable</b></p>
<p class=indent>
Indicates whether changes can be made to a querydef object. If this property is <b>TRUE</b>, the querydef is updatable; otherwise, it is not. Updatable means the querydef object’s query definition can be changed. The Updatable property of a querydef object is set to <b>TRUE</b> if the query definition can be updated, even if the resulting recordset is not updatable. To retrieve this property directly, call the querydef’s <a href="_mfc_cdaoquerydef.3a3a.canupdate.htm">CanUpdate</a> member function. For more information, see the topic "Updatable Property" in DAO Help.</p>
<p class=dt>
<b>m_bReturnsRecords</b></p>
<p class=indent>
Indicates whether an SQL pass-through query to an external database returns records. If this property is <b>TRUE</b>, the query returns records. To directly retrieve this property, call <a href="_mfc_cdaoquerydef.3a3a.getreturnsrecords.htm">CDaoQueryDef::GetReturnsRecords</a>. Not all SQL pass-through queries to external databases return records. For example, an SQL <b>UPDATE</b> statement updates records without returning records, while an SQL <b>SELECT</b> statement does return records. For more information, see the topic "ReturnsRecords Property" in DAO Help.</p>
<p class=dt>
<b>m_strSQL</b></p>
<p class=indent>
The SQL statement that defines the query executed by a querydef object. The SQL property contains the SQL statement that determines how records are selected, grouped, and ordered when you execute the query. You can use the query to select records to include in a dynaset- or snapshot-type recordset object. You can also define bulk queries to modify data without returning records. You can retrieve the value of this property directly by calling the querydef’s <a href="_mfc_cdaoquerydef.3a3a.getsql.htm">GetSQL</a> member function. For more information, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Queries">
</object><a href=JavaScript:alink_1.Click()>DAO Queries</a> in <i>Visual C++ Programmer’s Guide</i> and the topic "SQL Property" in DAO Help.</p>
<p class=dt>
<b>m_strConnect</b></p>
<p class=indent>
Provides information about the source of a database used in a pass-through query. This information takes the form of a connect string. For more information about connect strings, and for information about retrieving the value of this property directly, see the <a href="_mfc_cdaodatabase.3a3a.getconnect.htm">CDaoDatabase::GetConnect</a> member function.</p>
<p class=dt>
<b>m_nODBCTimeout</b></p>
<p class=indent>
The number of seconds the Microsoft Jet database engine waits before a timeout error occurs when a query is run on an ODBC database. When you’re using an ODBC database, such as Microsoft SQL Server, there may be delays because of network traffic or heavy use of the ODBC server. Rather than waiting indefinitely, you can specify how long the Microsoft Jet engine waits before it produces an error. The default timeout value is 60 seconds. You can retrieve the value of this property directly by calling the querydef’s <a href="_mfc_cdaoquerydef.3a3a.getodbctimeout.htm">GetODBCTimeout</a> member function. For more information, see the topic "ODBCTimeout Property" in DAO Help.</p>
<p class=label>
<b>Comments</b></p>
<p>
Information retrieved by the <a href="_mfc_cdaodatabase.3a3a.getquerydefinfo.htm">CDaoDatabase::GetQueryDefInfo</a> member function is stored in a <b>CDaoQueryDefInfo</b> structure. Call <b>GetQueryDefInfo</b> for the database object in whose QueryDefs collection the querydef object is stored. <b>CDaoQueryDefInfo</b> also defines a <b>Dump</b> member function in debug builds. You can use <b>Dump</b> to dump the contents of a <b>CDaoQueryDefInfo</b> object. Class <b>CDaoDatabase</b> also supplies member functions for directly accessing all of the properties returned in a <b>CDaoQueryDefInfo</b> object, so you will probably seldom need to call <b>GetQueryDefInfo</b>. </p>
<p>
When you append a new field or parameter object to the Fields or Parameters collection of a querydef object, an exception is thrown if the underlying database does not support the data type specified for the new object.</p>
<p>
The date and time settings are derived from the computer on which the querydef was created or last updated. In a multiuser environment, users should get these settings directly from the file server using the <b>net time</b> command to avoid discrepancies in the DateCreated and LastUpdated property settings. For information on using this and other MFC DAO Info structures, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Collections.3a_.Obtaining_Information_About_DAO_Objects">
</object><a href=JavaScript:alink_2.Click()>DAO Collections: Obtaining Information About DAO Objects</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaoquerydef.htm">CDaoQueryDef</a>, <a href="_mfc_cdaodatabase.htm">CDaoDatabase</a></p>
</font></BODY>
</HTML>
