<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Identifying the Elements of the DHTML Control Project</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcconidentifyingelementsofdhtmlcontrolproject"></a>Identifying the Elements of the DHTML Control Project</h1>
<p>
Most DHTML control code is exactly like that created for any ATL control. For a basic understanding of the generic code, work through the <a href="_atl_atl_tutorial.htm">ATL tutorial</a>, and read the sections <a href="_atl_using_the_atl_com_appwizard.htm">Creating an ATL Project</a> and <a href="_atl_fundamentals_of_atl_com_objects.htm">Fundamentals of ATL COM Objects</a>.</p>
<p>
A DHTML control is similar to any ATL control, except:
<ul type=disc>
<li>
In addition to the regular interfaces a control implements, it implements an additional interface that is used to communicate between the C++ code and the HTML user interface (UI). The HTML UI calls into C++ code using this interface.<br><br></li>
<li>
It creates an HTML resource for the control UI. <br><br></li>
<li>
It allows access to the DHTML object model through the member variable <code>m_spBrowser</code>, which is a smart pointer of type <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_iwebbrowser2">
</object><a href=JavaScript:alink_1.Click()>IWebBrowser2</a>. Use this pointer to access any part of the DHTML object model.</li>
</ul>
<p class=label>
<b>Examining the elements of the DHTML control project</b></p>
<p>
The following graphic illustrates the relationship between your DLL, the DHTML control, the web browser, and the HTML resource.</p>
<p>
<img src="vc52en1.gif" border=0></p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The names on this graphic are placeholders. The names of your HTML resource and the interfaces exposed on your control are based on the names you assign them in the ATL Object Wizard. </p>
<p>
In this graphic, the elements are:
<ul type=disc>
<li>
<b>My DLL</b>&nbsp;&nbsp;&nbsp;The DLL created using AppWizard.<br><br></li>
<li>
<b>DHTML Control</b> (<code>m_spBrowser</code>)&nbsp;&nbsp;&nbsp;The DHTML control, created using the ATL Object Wizard. This control accesses the web browser object and its methods through the web browser object's interface, <b>IWebBrowser2</b>. The control itself exposes the following two interfaces, in addition to the other standard interfaces required for a control.<ul type=disc>
<li>
<b>IDHCTL1</b>&nbsp;&nbsp;&nbsp;The interface exposed by the control for use only by the container.<br><br></li>
<li>
<b>IDHCTLUI1</b>&nbsp;&nbsp;&nbsp;The dispatch interface for communicating between the C++ code and the HTML user interface. The web browser uses the control's dispatch interface to display the control. You can call various methods of this dispatch interface from the control's user interface by invoking <code>window.external</code>, followed by the method name on this dispatch interface that you want to invoke. You would access <code>window.external</code> from a SCRIPT tag within the HTML that makes up the UI for this control. For more information about invoking external methods in the resource file, see <a href="vcconcallingccodefromdhtml.htm">Calling C++ Code from DHTML</a>.</li>
</ul>
</li>
<li>
<b>IDR_CTL1</b>&nbsp;&nbsp;&nbsp;The resource ID of the HTML resource. Its file name, in this case, is DHCTL1UI.htm. The DHTML control uses an HTML resource that contains standard HTML tags and external window dispatch commands that you can edit using the Text editor. <br><br></li>
<li>
<b>Web Browser</b>&nbsp;&nbsp;&nbsp;The web browser displays the control's UI, based on the HTML in the HTML resource. A pointer to the web browser's <b>IWebBrowser2</b> interface is available in the DHTML control to allow access to the DHTML object model.<br><br></li>
<li>
The ATL Object Wizard generates a control with default code in both the HTML resource and the .cpp file. You can compile and run the control as it is generated by the wizard, and then view the control in either the web browser or Test Container. The picture below shows the default ATL DHTML control with three buttons displayed in Test Container: </li>
</ul>
<p>
<img src="vc52en2.gif" border=0></p>
<p>
See <a href="vcconcreatingdhtmlcontrol.htm">Creating an ATL DHTML Control</a> to get started building a DHTML control.</p>
<p>
<a href="vcconatlsupportfordhtmlcontrols.htm">ATL Support for DHTML Controls</a></p>
</font></BODY>
</HTML>
