<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Multiple Accessors on a Rowset</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vchowusingmultipleaccessorsonrowset"></a>Using Multiple Accessors on a Rowset</h1>
<p>
This example uses multiple accessors to retrieve one set of data. An application might use multiple accessors to optimize data access. The rowset retrieves one block of data that can be used by multiple accessors. (The accessor is defined in <a href="vcconoledbuserrecords.htm">OLE DB User Records</a>.)</p>
<pre><code>#include &lt;atldbcli.h&gt;

CDataSource connection;
CSession session;
CTable&lt;CAccessor&lt; CMultiArtists&gt; &gt; artists;
 
// Connect the database, session, and accessors
connection.Open(CLSID_MSDASQL, "NWind", "sa", "");
session.Open(connection);
artists.Open(session, "artists");
 
// Retrieve the data
while (artists.MoveNext() == S_OK)
{
   cout &lt;&lt; artists.m_szFirstName;
   cout &lt;&lt; artists.m_szLastName;
   artists.GetData(1);   // Retrieve data for other accessor
   cout &lt;&lt; artists.m_nAge;
}
</code></pre>
<p>
The user record looks like this:</p>
<pre><code>class CMultiArtists
{
public:
// Data Elements
   CHAR m_szFirstName[20];
   CHAR m_szLastName[30];
   short m_nAge;
 
// output binding map
BEGIN_ACCESSOR_MAP(CMultiArtists, 2)
   BEGIN_ACCESSOR(0, true)
    COLUMN_ENTRY(1, m_szFirstName)
    COLUMN_ENTRY(2, m_szLastName)
   END_ACCESSOR(0)
   BEGIN_ACCESSOR(1, false) // not an auto accessor
    COLUMN_ENTRY(3, m_nAge)
   END_ACCESSOR()
END_ACCESSOR_MAP()
};
</code></pre>
<p>
<a href="vcrefcommonoledbconsumerscenarios.htm">Back to Common OLE DB Consumer Scenarios (Examples)</a></p>
</font></BODY>
</HTML>
