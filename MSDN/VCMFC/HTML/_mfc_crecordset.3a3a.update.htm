<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CRecordset::Update</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_crecordset.3a3a.update"></a><sup></sup>CRecordset::Update</h1>
<p>
<b>virtual</b> <b>BOOL</b> <b>Update(</b> <b>);</b><br>
<b>throw(</b> <b>CDBException</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if one record was successfully updated; otherwise 0 if no columns have changed. If no records were updated, or if more than one record was updated, an exception is thrown. An exception is also thrown for any other failure on the data source.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function after a call to the <a href="_mfc_crecordset.3a3a.addnew.htm">AddNew</a> or <a href="_mfc_crecordset.3a3a.edit.htm">Edit</a> member function. This call is required to complete the <b>AddNew</b> or <b>Edit</b> operation.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you have implemented bulk row fetching, you cannot call <b>Update</b>. This will result in a failed assertion. Although class <b>CRecordset</b> does not provide a mechanism for updating bulk rows of data, you can write your own functions by using the ODBC API function <b>SQLSetPos</b>. For an example of how to do this, see the sample <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_DBFETCH">
</object><a href=JavaScript:alink_1.Click()>DBFETCH</a>. For more information about bulk row fetching, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Fetching_Records_in_Bulk_.28.ODBC.29">
</object><a href=JavaScript:alink_2.Click()>Recordset: Fetching Records in Bulk (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
Both <b>AddNew</b> and <b>Edit</b> prepare an edit buffer in which the added or edited data is placed for saving to the data source. <b>Update</b> saves the data. Only those fields marked or detected as changed are updated. </p>
<p>
If the data source supports transactions, you can make the <b>Update</b> call (and its corresponding <b>AddNew</b> or <b>Edit</b> call) part of a transaction. For more information about transactions, see the article <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Transaction_.28.ODBC.29">
</object><a href=JavaScript:alink_3.Click()>Transaction (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;If you call <b>Update</b> without first calling either <b>AddNew</b> or <b>Edit</b>, <b>Update</b> throws a <b>CDBException</b>. If you call <b>AddNew</b> or <b>Edit</b>, you must call <b>Update</b> before you call a <b>Move</b> operation or before you close either the recordset or the data source connection. Otherwise, your changes are lost without notification. </p>
<p>
For details on handling <b>Update</b> failures, see the article <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.How_Recordsets_Update_Records_.28.ODBC.29">
</object><a href=JavaScript:alink_4.Click()>Recordset: How Recordsets Update Records (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p class=label>
<b>Example</b></p>
<p>
See the article <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Transaction.3a_.Performing_a_Transaction_in_a_Recordset_.28.ODBC.29">
</object><a href=JavaScript:alink_5.Click()>Transaction: Performing a Transaction in a Recordset (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
<a href="_mfc_crecordset.htm">CRecordset Overview</a>  |&nbsp; <a href="_mfc_crecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_crecordset.3a3a.edit.htm">CRecordset::Edit</a>, <a href="_mfc_crecordset.3a3a.addnew.htm">CRecordset::AddNew</a>, <a href="_mfc_crecordset.3a3a.setfielddirty.htm">CRecordset::SetFieldDirty</a>, <a href="_mfc_cdbexception.htm">CDBException</a></p>
</font></BODY>
</HTML>
