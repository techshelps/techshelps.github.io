<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Class Factories and Licensing</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_class_factories_and_licensing"></a>Class Factories and Licensing</h1>
<p>
To create an instance of your OLE control, a container application calls a member function of the control's class factory. Because your control is an actual OLE object, the class factory is responsible for creating instances of your control. Every OLE control class must have a class factory.</p>
<p>
Another important feature of OLE controls is their ability to enforce a license. ControlWizard allows you to incorporate licensing during the creation of your control project. For more information on control licensing, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_ActiveX_Controls.3a_.Licensing_An_ActiveX_Control">
</object><a href=JavaScript:alink_1.Click()>ActiveX Controls: Licensing An ActiveX Control</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
The following table lists several macros and functions used to declare and implement your control's class factory and for licensing of your control.</p>
<p class=label>
<b>Class Factories and Licensing</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=39%><a href="_mfc_declare_olecreate_ex.htm">DECLARE_OLECREATE_EX</a></td>
<td width=61%>Declares the class factory for an OLE control or property page.</td>
</tr>
<tr valign=top>
<td width=39%><a href="_mfc_implement_olecreate_ex.htm">IMPLEMENT_OLECREATE_EX</a></td>
<td width=61%>Implements the control's <b>GetClassID</b> function and declares an instance of the class factory.</td>
</tr>
<tr valign=top>
<td width=39%><a href="_mfc_begin_olefactory.htm">BEGIN_OLEFACTORY</a></td>
<td width=61%>Begins the declaration of any licensing functions.</td>
</tr>
<tr valign=top>
<td width=39%><a href="_mfc_end_olefactory.htm">END_OLEFACTORY</a></td>
<td width=61%>Ends the declaration of any licensing functions.</td>
</tr>
<tr valign=top>
<td width=39%><a href="_mfc_afxverifylicfile.htm">AfxVerifyLicFile</a></td>
<td width=61%>Verifies whether a control is licensed for use on a particular computer.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
