<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COleDataSource::OnSetData</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_coledatasource.3a3a.onsetdata"></a><sup></sup>COleDataSource::OnSetData</h1>
<p>
<b>virtual</b> <b>BOOL</b> <b>OnSetData(</b> <b>LPFORMATETC</b> <i>lpFormatEtc</i><b>,</b> <b>LPSTGMEDIUM</b> <i>lpStgMedium</i><b>,</b> <b>BOOL</b> <i>bRelease</i> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if successful; otherwise 0. </p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpFormatEtc</i></p>
<p class=indent>
Points to the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_FORMATETC">
</object><a href=JavaScript:alink_1.Click()>FORMATETC</a> structure specifying the format in which data is being replaced.</p>
<p class=dt>
<i>lpStgMedium</i></p>
<p class=indent>
Points to the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_STGMEDIUM">
</object><a href=JavaScript:alink_2.Click()>STGMEDIUM</a> structure containing the data that will replace the current contents of the <b>COleDataSource</b> object.</p>
<p class=dt>
<i>bRelease</i></p>
<p class=indent>
Indicates who has ownership of the storage medium after completing the function call. The caller decides who is responsible for releasing the resources allocated on behalf of the storage medium. The caller does this by setting <i>bRelease</i>. If <i>bRelease</i> is nonzero, the data source takes ownership, freeing the medium when it has finished using it. When <i>bRelease</i> is 0, the caller retains ownership and the data source can use the storage medium only for the duration of the call.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Called by the framework to set or replace the data in the <b>COleDataSource</b> object in the specified format. The data source does not take ownership of the data until it has successfully obtained it. That is, it does not take ownership if <b>OnSetData</b> returns 0. If the data source takes ownership, it frees the storage medium by calling the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_ReleaseStgMedium">
</object><a href=JavaScript:alink_3.Click()>ReleaseStgMedium</a> function.</p>
<p>
The default implementation does nothing. Override this function to replace the data in the specified format. This is an advanced overridable.</p>
<p>
For more information, see the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_STGMEDIUM">
</object><a href=JavaScript:alink_4.Click()>STGMEDIUM</a> and <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_FORMATETC">
</object><a href=JavaScript:alink_5.Click()>FORMATETC</a> structures and the <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_ReleaseStgMedium">
</object><a href=JavaScript:alink_6.Click()>ReleaseStgMedium</a> and <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_IDataObject_GetData">
</object><a href=JavaScript:alink_7.Click()>IDataObject::GetData</a> functions in the <i>OLE 2 Programmer’s Reference, Volume 1.</i></p>
<p>
<a href="_mfc_coledatasource.htm">COleDataSource Overview</a>  |&nbsp; <a href="_mfc_coledatasource_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_coledatasource.3a3a.delaysetdata.htm">COleDataSource::DelaySetData</a>, <a href="_mfc_coledatasource.3a3a.onrenderdata.htm">COleDataSource::OnRenderData</a>, <a href="_mfc_coledatasource.3a3a.onrenderfiledata.htm">COleDataSource::OnRenderFileData</a>, <a href="_mfc_coledatasource.3a3a.onrenderglobaldata.htm">COleDataSource::OnRenderGlobalData</a>, <a href="_mfc_coleserveritem.3a3a.onsetdata.htm">COleServerItem::OnSetData</a></p>
</font></BODY>
</HTML>
