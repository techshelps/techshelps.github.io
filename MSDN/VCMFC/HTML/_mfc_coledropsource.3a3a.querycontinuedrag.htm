<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COleDropSource::QueryContinueDrag</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_coledropsource.3a3a.querycontinuedrag"></a><sup></sup>COleDropSource::QueryContinueDrag</h1>
<p>
<b>virtual</b> <b>SCODE</b> <b>QueryContinueDrag(</b> <b>BOOL</b> <i>bEscapePressed,</i> <b>DWORD</b> <i>dwKeyState</i> <b>)</b>;</p>
<p class=label>
<b>Return Value</b></p>
<p>
<b>DRAGDROP_S_CANCEL</b> if the ESC key or right button is pressed, or left button is raised before dragging starts. <b>DRAGDROP_S_DROP</b> if a drop operation should occur. Otherwise <b>S_OK</b>.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>bEscapePressed</i></p>
<p class=indent>
States whether the ESC key has been pressed since the last call to <b>COleDropSource::QueryContinueDrag</b>.</p>
<p class=dt>
<i>dwKeyState</i></p>
<p class=indent>
Contains the state of the modifier keys on the keyboard. This is a combination of any number of the following: <b>MK_CONTROL</b>, <b>MK_SHIFT</b>, <b>MK_ALT</b>, <b>MK_LBUTTON</b>, <b>MK_MBUTTON</b>, and <b>MK_RBUTTON</b>.</p>
<p class=label>
<b>Remarks</b></p>
<p>
After dragging has begun, this function is called repeatedly by the framework until the drag operation is either canceled or completed. Override this function if you want to change the point at which dragging is canceled or a drop occurs. </p>
<p>
The default implementation initiates the drop or cancels the drag as follows. It cancels a drag operation when the ESC key or the right mouse button is pressed. It initiates a drop operation when the left mouse button is raised after dragging has started. Otherwise, it returns <b>S_OK</b> and performs no further operations. </p>
<p>
Because this function is called frequently, it should be optimized as much as possible.</p>
<p>
<a href="_mfc_coledropsource.htm">COleDropSource Overview</a>  |&nbsp; <a href="_mfc_coledropsource_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_coledropsource.3a3a.onbegindrag.htm">COleDropSource::OnBeginDrag</a>, <a href="_mfc_coledroptarget.3a3a.ondrop.htm">COleDropTarget::OnDrop</a></p>
</font></BODY>
</HTML>
