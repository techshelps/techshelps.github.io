<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calling C++ Code from DHTML</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcconcallingccodefromdhtml"></a>Calling C++ Code from DHTML</h1>
<p>
A DHTML control can be hosted in a container, such as the Test Container or Internet Explorer. The container hosting the control communicates with the control using the normal control interfaces. DHTML uses the dispatch interface that ends with "UI" to communicate with your C++ code and your HTML resource. In <a href="vcconmodifyingdhtmlcontrol.htm">Modifying the ATL DHTML Control</a>, you can practice adding the methods to be called by these different interfaces.</p>
<p>
To see an example of calling C++ code from DHTML, <a href="vcconcreatingdhtmlcontrol.htm">create a DHTML control</a> using the ATL COM Object Wizard and examine the code in the header file and in the HTML file.</p>
<p class=label>
<b>Declaring WebBrowser methods in the header file</b></p>
<p>
To invoke C++ methods from the DHTML UI, you must add methods to your control's UI interface. For example, the header file created by the ATL Object Wizard contains the C++ method <code>OnClick</code>, which is a member of the UI interface of the wizard-generated control.</p>
<p>
Examine <code>OnClick</code> in the control's .h file:</p>
<pre><code>STDMETHOD(OnClick)(IDispatch* pdispBody, VARIANT varColor)
</code></pre>
<p>
The first parameter, <code>pdispBody</code>, is a pointer to the body object's dispatch interface. The second parameter, <code>varColor</code>, identifies the color to apply to the control.</p>
<p class=label>
<b>Calling C++ code in the HTML file</b></p>
<p>
Once you have declared the WebBrowser methods in the header file, you can invoke the methods from the HTML file. Notice in the HTML file that the ATL Object Wizard inserts three Windows dispatch methods: three <code>OnClick</code> methods that dispatch messages to change the background color of the control. </p>
<p>
Examine one of the methods in the HTML file:</p>
<pre><code>&lt;BUTTON onclick='window.external.OnClick(theBody, "red");'&gt;Red&lt;/BUTTON&gt;
</code></pre>
<p>
In the HTML code above, the window external method, <code>OnClick</code>, is called as part of the button tag. The method has two parameters: <code>theBody</code>, which references the body of the HTML document, and <code>"red"</code>, which indicates that the control's background color will be changed to red when the button is clicked. The <code>Red</code> following the tag is the button's label.</p>
<p>
See <a href="vcconmodifyingdhtmlcontrol.htm">Modifying the ATL DHTML Control</a> for more information about providing your own methods. See <a href="vcconidentifyingelementsofdhtmlcontrolproject.htm">Identifying the Elements of the DHTML Control Project</a> for more information about the HTML file.</p>
<p>
<a href="vcconatlsupportfordhtmlcontrols.htm">ATL Support for DHTML Controls</a></p>
</font></BODY>
</HTML>
