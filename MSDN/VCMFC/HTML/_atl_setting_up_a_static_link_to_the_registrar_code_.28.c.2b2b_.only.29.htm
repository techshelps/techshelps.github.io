<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up a Static Link to the Registrar Code (C++ only)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_atl_setting_up_a_static_link_to_the_registrar_code_.28.c.2b2b_.only.29"></a>Setting Up a Static Link to the Registrar Code (C++ only)</h1>
<p>
C++ clients can create a static link to the Registrar's code. Static linking of the Registrar's parser adds approximately 5K to a release build.</p>
<p>
The simplest way to set up static linking assumes you have specified <a href="_atl_declare_registry_resourceid.htm">DECLARE_REGISTRY_RESOURCEID</a> in your object's declaration. (This is the default specification used by the ATL.) </p>
<p class=label>
<b>To create a static link using DECLARE_REGISTRY_RESOURCEID</b>
<ol>
<li>
Open the <b>Project Settings</b> dialog box, select the <b>C++</b> tab. In the <b>Preprocessor Definitions</b> text box, replace <b>_ATL_DLL</b> with <b>_ATL_STATIC_REGISTRY</b>.<br><br></li>
<li>
Recompile.</li>
</ol>
<p>
If the project has been created using the ATL AppWizard, you only need to select the <b>Win32 Release MinDependency</b> option, which has the correct preprocessor definitions for statically linking to the registrar code.</p>
</font></BODY>
</HTML>
