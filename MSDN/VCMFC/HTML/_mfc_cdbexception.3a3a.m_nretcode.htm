<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDBException::m_nRetCode</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdbexception.3a3a.m_nretcode"></a>CDBException::m_nRetCode</h1>
<p class=label>
<b>Remarks</b></p>
<p>
Contains an ODBC error code of type <b>RETCODE</b> returned by an ODBC application programming interface (API) function. This type includes SQL-prefixed codes defined by ODBC and AFX_SQL-prefixed codes defined by the database classes. For a <b>CDBException</b>, this member will contain one of the following values: 
<ul type=disc>
<li>
<b>AFX_SQL_ERROR_API_CONFORMANCE</b>&nbsp;&nbsp;&nbsp;The driver for a <b>CDatabase::OpenEx</b> or <b>CDatabase::Open</b> call does not conform to required ODBC API Conformance level 1 (<b>SQL_OAC_LEVEL1</b>).<br><br></li>
<li>
<b>AFX_SQL_ERROR_CONNECT_FAIL</b>&nbsp;&nbsp;&nbsp;Connection to the data source failed. You passed a <b>NULL</b> <b>CDatabase</b> pointer to your recordset constructor and the subsequent attempt to create a connection based on <b>GetDefaultConnect</b> failed. <br><br></li>
<li>
<b>AFX_SQL_ERROR_DATA_TRUNCATED</b>&nbsp;&nbsp;&nbsp;You requested more data than you have provided storage for. For information on increasing the provided data storage for <b>CString</b> or <b>CByteArray</b> data types, see the <i>nMaxLength</i> argument for <a href="_mfc_rfx_text.htm">RFX_Text</a> and <a href="_mfc_rfx_binary.htm">RFX_Binary</a> under “Macros and Globals.”<br><br></li>
<li>
<b>AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED</b>&nbsp;&nbsp;&nbsp;A call to <b>CRecordset::Open</b> requesting a dynaset failed. Dynasets are not supported by the driver.<br><br></li>
<li>
<b>AFX_SQL_ERROR_EMPTY_COLUMN_LIST</b>&nbsp;&nbsp;&nbsp;You attempted to open a table (or what you gave could not be identified as a procedure call or <b>SELECT</b> statement) but there are no columns identified in record field exchange (RFX) function calls in your <b>DoFieldExchange</b> override.<br><br></li>
<li>
<b>AFX_SQL_ERROR_FIELD_SCHEMA_MISMATCH</b>&nbsp;&nbsp;&nbsp;The type of an RFX function in your <b>DoFieldExchange</b> override is not compatible with the column data type in the recordset.<br><br></li>
<li>
<b>AFX_SQL_ERROR_ILLEGAL_MODE</b>&nbsp;&nbsp;&nbsp;You called <b>CRecordset::Update</b> without previously calling <b>CRecordset::AddNew</b> or <b>CRecordset::Edit</b>. <br><br></li>
<li>
<b>AFX_SQL_ERROR_LOCK_MODE_NOT_SUPPORTED</b>&nbsp;&nbsp;&nbsp;Your request to lock records for update could not be fulfilled because your ODBC driver does not support locking.<br><br></li>
<li>
<b>AFX_SQL_ERROR_MULTIPLE_ROWS_AFFECTED</b>&nbsp;&nbsp;&nbsp;You called <b>CRecordset::Update</b> or <b>Delete</b> for a table with no unique key and changed multiple records.<br><br></li>
<li>
<b>AFX_SQL_ERROR_NO_CURRENT_RECORD</b>&nbsp;&nbsp;&nbsp;You attempted to edit or delete a previously deleted record. You must scroll to a new current record after a deletion.<br><br></li>
<li>
<b>AFX_SQL_ERROR_NO_POSITIONED_UPDATES</b>&nbsp;&nbsp;&nbsp;Your request for a dynaset could not be fulfilled because your ODBC driver does not support positioned updates.<br><br></li>
<li>
<b>AFX_SQL_ERROR_NO_ROWS_AFFECTED</b>&nbsp;&nbsp;&nbsp;You called <b>CRecordset::Update</b> or <b>Delete</b>, but when the operation began the record could no longer be found.<br><br></li>
<li>
<b>AFX_SQL_ERROR_ODBC_LOAD_FAILED</b>&nbsp;&nbsp;&nbsp;An attempt to load the ODBC.DLL failed; Windows could not find or could not load this DLL. This error is fatal.<br><br></li>
<li>
<b>AFX_SQL_ERROR_ODBC_V2_REQUIRED</b>&nbsp;&nbsp;&nbsp;Your request for a dynaset could not be fulfilled because a Level 2-compliant ODBC driver is required.<br><br></li>
<li>
<b>AFX_SQL_ERROR_RECORDSET_FORWARD_ONLY</b>&nbsp;&nbsp;&nbsp;An attempt to scroll did not succeed because the data source does not support backward scrolling.<br><br></li>
<li>
<b>AFX_SQL_ERROR_SNAPSHOT_NOT_SUPPORTED</b>&nbsp;&nbsp;&nbsp;A call to <b>CRecordset::Open</b> requesting a snapshot failed. Snapshots are not supported by the driver. (This should only occur when the ODBC cursor library — ODBCCURS.DLL — is not present.)<br><br></li>
<li>
<b>AFX_SQL_ERROR_SQL_CONFORMANCE</b>&nbsp;&nbsp;&nbsp;The driver for a <b>CDatabase::OpenEx</b> or <b>CDatabase::Open</b> call does not conform to the required ODBC SQL Conformance level of "Minimum" (<b>SQL_OSC_MINIMUM</b>).<br><br></li>
<li>
<b>AFX_SQL_ERROR_SQL_NO_TOTAL</b>&nbsp;&nbsp;&nbsp;The ODBC driver was unable to specify the total size of a <b>CLongBinary</b> data value. The operation probably failed because a global memory block could not be preallocated.<br><br></li>
<li>
<b>AFX_SQL_ERROR_RECORDSET_READONLY</b>&nbsp;&nbsp;&nbsp;You attempted to update a read-only recordset, or the data source is read-only. No update operations can be performed with the recordset or the <b>CDatabase</b> object it is associated with.<br><br></li>
<li>
<b>SQL_ERROR</b>&nbsp;&nbsp;&nbsp;Function failed. The error message returned by <b>::SQLError</b> is stored in the <b>m_strError</b> data member.<br><br></li>
<li>
<b>SQL_INVALID_HANDLE</b>&nbsp;&nbsp;&nbsp;Function failed due to an invalid environment handle, connection handle, or statement handle. This indicates a programming error. No additional information is available from <b>::SQLError</b>.</li>
</ul>
<p>
The SQL-prefixed codes are defined by ODBC. The AFX-prefixed codes are defined in AFXDB.H, found in MFC\INCLUDE.</p>
<p>
<a href="_mfc_cdbexception.htm">CDBException Overview</a>  |&nbsp; <a href="_mfc_cdbexception_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdatabase.htm">CDatabase</a>, <a href="_mfc_clongbinary.htm">CLongBinary</a>, <a href="_mfc_crecordset.htm">CRecordset</a></p>
</font></BODY>
</HTML>
