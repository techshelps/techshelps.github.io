<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoQueryDef::Execute</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoquerydef.3a3a.execute"></a>CDaoQueryDef::Execute</h1>
<p>
<b>virtual void Execute( int </b><i>nOptions</i><b> = dbFailOnError );<br>
throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nOptions</i></p>
<p class=indent>
&nbsp;An integer that determines the characteristics of the query. For related information, see the topic "Execute Method" in DAO Help. You can use the bitwise-OR operator (<b>|</b>) to combine the following constants for this argument:
<ul type=disc>
<li>
<b>dbDenyWrite</b>&nbsp;&nbsp;&nbsp;Deny write permission to other users.<br><br></li>
<li>
<b>dbInconsistent</b>&nbsp;&nbsp;&nbsp;Inconsistent updates.<br><br></li>
<li>
<b>dbConsistent</b>&nbsp;&nbsp;&nbsp;Consistent updates.<br><br></li>
<li>
<b>dbSQLPassThrough</b>&nbsp;&nbsp;&nbsp;SQL pass-through. Causes the SQL statement to be passed to an ODBC database for processing.<br><br></li>
<li>
<b>dbFailOnError</b>&nbsp;&nbsp;&nbsp;Default value. Roll back updates if an error occurs and report the error to the user.<br><br></li>
<li>
<b>dbSeeChanges</b>&nbsp;&nbsp;&nbsp;Generate a run-time error if another user is changing data you are editing.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;For an explanation of the terms “inconsistent” and “consistent,” see the topic "Execute Method" in DAO Help.</p></li>
</ul>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to run the query defined by the querydef object. Querydef objects used for execution in this manner can only represent one of the following query types:
<ul type=disc>
<li>
Action queries<br><br></li>
<li>
SQL pass-through queries</li>
</ul>
<p>
<b>Execute</b> does not work for queries that return records, such as select queries. <b>Execute</b> is commonly used for bulk operation queries, such as <b>UPDATE</b>, <b>INSERT</b>, or <b>SELECT INTO</b>, or for data definition language (DDL) operations.</p>
<p>
For an explanation of action queries and SQL pass-through queries, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Querydef.3a_.Action_Queries_and_SQL_Pass.2d.Through_Queries">
</object><a href=JavaScript:alink_1.Click()>DAO Querydef: Action Queries and SQL Pass-Through Queries</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;The preferred way to work with ODBC data sources is to attach tables to a Microsoft Jet (.MDB) database. For more information, see the topic "Accessing External Databases with DAO" in DAO Help and the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_External.3a_.Working_with_External_Data_Sources">
</object><a href=JavaScript:alink_2.Click()>DAO External: Working with External Data Sources</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
Call the <a href="_mfc_cdaoquerydef.3a3a.getrecordsaffected.htm">GetRecordsAffected</a> member function of the querydef object to determine the number of records affected by the most recent <b>Execute</b> call. For example, <b>GetRecordsAffected</b> returns information about the number of records deleted, updated, or inserted when executing an action query. The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.</p>
<p>
If you include both <b>dbInconsistent</b> and <b>dbConsistent</b> or if you include neither, the result is the default, <b>dbInconsistent</b>.</p>
<p>
<b>Execute</b> does not return a recordset. Using <b>Execute</b> on a query that selects records causes MFC to throw an exception of type <a href="_mfc_cdaoexception.htm">CDaoException</a>.</p>
<p>
For more information about using the <b>Execute</b> member function for querydef objects, see the article <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Querydef.3a_.Using_Querydefs">
</object><a href=JavaScript:alink_3.Click()>DAO Querydef: Using Querydefs</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdaoquerydef.htm">CDaoQueryDef Overview</a>  |&nbsp; <a href="_mfc_cdaoquerydef_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
</font></BODY>
</HTML>
