<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDC::GetFontData</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdc.3a3a.getfontdata"></a><sup></sup>CDC::GetFontData&nbsp; </h1>
<p>
<b>DWORD</b> <b>GetFontData(</b> <b>DWORD</b> <i>dwTable</i><b>,</b> <b>DWORD</b> <i>dwOffset</i><b>,</b> <b>LPVOID</b> <i>lpData</i><b>,</b> <b>DWORD</b> <i>cbData</i> <b>)</b> <b>const;</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Specifies the number of bytes returned in the buffer pointed to by <i>lpData</i> if the function is successful; otherwise –1.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>dwTable</i></p>
<p class=indent>
Specifies the name of the metric table to be returned. This parameter can be one of the metric tables documented in the TrueType Font Files specification published by Microsoft Corporation. If this parameter is 0, the information is retrieved starting at the beginning of the font file.</p>
<p class=dt>
<i>dwOffset</i></p>
<p class=indent>
Specifies the offset from the beginning of the table at which to begin retrieving information. If this parameter is 0, the information is retrieved starting at the beginning of the table specified by the <i>dwTable</i> parameter. If this value is greater than or equal to the size of the table, <b>GetFontData</b> returns 0.</p>
<p class=dt>
<i>lpData</i></p>
<p class=indent>
Points to a buffer that will receive the font information. If this value is <b>NULL</b>, the function returns the size of the buffer required for the font data specified in the <i>dwTable</i> parameter.</p>
<p class=dt>
<i>cbData</i></p>
<p class=indent>
Specifies the length, in bytes, of the information to be retrieved. If this parameter is 0, <b>GetFontData</b> returns the size of the data specified in the <i>dwTable</i> parameter.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Retrieves font-metric information from a scalable font file. The information to retrieve is identified by specifying an offset into the font file and the length of the information to return. </p>
<p>
An application can sometimes use the <b>GetFontData</b> member function to save a TrueType font with a document. To do this, the application determines whether the font can be embedded and then retrieves the entire font file, specifying 0 for the <i>dwTable</i>, <i>dwOffset</i>, and <i>cbData</i> parameters.</p>
<p>
Applications can determine whether a font can be embedded by checking the <b>otmfsType</b> member of the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_OUTLINETEXTMETRIC_str">
</object><a href=JavaScript:alink_1.Click()>OUTLINETEXTMETRIC</a> structure. If bit 1 of <b>otmfsType</b> is set, embedding is not permitted for the font. If bit 1 is clear, the font can be embedded. If bit 2 is set, the embedding is read only. </p>
<p>
If an application attempts to use this function to retrieve information for a non-TrueType font, the <b>GetFontData</b> member function returns –1.</p>
<p>
<a href="_mfc_cdc.htm">CDC Overview</a>  |&nbsp; <a href="_mfc_cdc_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdc.3a3a.getoutlinetextmetrics.htm">CDC::GetOutlineTextMetrics</a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_GetFontData">
</object><a href=JavaScript:alink_2.Click()>::GetFontData</a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_OUTLINETEXTMETRIC_str">
</object><a href=JavaScript:alink_3.Click()>OUTLINETEXTMETRIC</a></p>
</font></BODY>
</HTML>
