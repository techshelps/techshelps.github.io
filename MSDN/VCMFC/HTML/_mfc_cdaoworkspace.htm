<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoWorkspace</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoworkspace"></a>CDaoWorkspace</h1>
<p>
<img src="cdwkspc.gif" border=0></p>
<p>
A <b>CDaoWorkspace</b> object manages a named, password-protected database session from login to logoff, by a single user. In most cases, you will not need multiple workspaces, and you will not need to create explicit workspace objects; when you open database and recordset objects, they use DAO’s default workspace. However, if needed, you can run multiple sessions at a time by creating additional workspace objects. Each workspace object can contain multiple open database objects in its own Databases collection. In MFC, a workspace is primarily a transaction manager, specifying a set of open databases all in the same “transaction space.”</p>
<p class=indent>
<B><b>Note</b></B>  The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have a “CDao” prefix. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC. The DAO-based classes access data through the Microsoft Jet database engine, including ODBC drivers. They also support Data Definition Language (DDL) operations, such as creating databases and adding tables and fields via the classes, without having to call DAO directly.</p>
<p class=label>
<b>Capabilities</b></p>
<p>
Class <b>CDaoWorkspace</b> provides the following:
<ul type=disc>
<li>
Explicit access, if needed, to a default workspace, created by initializing the database engine. Usually you use DAO’s default workspace implicitly by creating database and recordset objects.<br><br></li>
<li>
A transaction space in which transactions apply to all databases open in the workspace. You can create additional workspaces to manage separate transaction spaces.<br><br></li>
<li>
An interface to many properties of the underlying Microsoft Jet database engine (see the static member functions). Opening or creating a workspace, or calling a static member function before open or create, initializes the database engine.<br><br></li>
<li>
Access to the database engine’s Workspaces collection, which stores all active workspaces that have been appended to it. You can also create and work with workspaces without appending them to the collection.</li>
</ul>
<p class=label>
<b>Security</b></p>
<p>
MFC does not implement the Users and Groups collections in DAO, which are used for security control. If you need those aspects of DAO, you must program them yourself via direct calls to DAO interfaces. For information, see <a href="_mfcnotes_tn054.htm">Technical Note 54</a>.</p>
<p class=label>
<b>Usage</b></p>
<p>
You can use class <b>CDaoWorkspace</b> to:
<ul type=disc>
<li>
Explicitly open the default workspace. <p class=tl>
Usually your use of the default workspace is implicit — when you open new <a href="_mfc_cdaodatabase.htm">CDaoDatabase</a> or <a href="_mfc_cdaorecordset.htm">CDaoRecordset</a> objects. But you might need to access it explicitly — for example, to access database engine properties or the Workspaces collection. See “Implicit Use of the Default Workspace” below.</P></li>
<li>
Create new workspaces. Call <a href="_mfc_cdaoworkspace.3a3a.append.htm">Append</a> if you want to add them to the Workspaces collection. <br><br></li>
<li>
Open an existing workspace in the Workspaces collection.</li>
</ul>
<p>
Creating a new workspace that does not already exist in the Workspaces collection is described under the <a href="_mfc_cdaoworkspace.3a3a.create.htm">Create</a> member function. Workspace objects do not persist in any way between datababase engine sessions. If your application links MFC statically, ending the application uninitializes the database engine. If your application links with MFC dynamically, the database engine is uninitialized when the MFC DLL is unloaded.</p>
<p class=indent>
<B><b>Feature Only in Professional and Enterprise Editions</b></B>&nbsp;&nbsp;&nbsp;Static linking to MFC is supported only in Visual C++ Professional and Enterprise Editions. For more information, see <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vceditions">
</object><a href=JavaScript:alink_1.Click()>Visual C++ Editions</a>.</p>
<p>
Explicitly opening the default workspace, or opening an existing workspace in the Workspaces collection, is described under the <a href="_mfc_cdaoworkspace.3a3a.open.htm">Open</a> member function.</p>
<p>
End a workspace session by closing the workspace with the <a href="_mfc_cdaoworkspace.3a3a.close.htm">Close</a> member function. <b>Close</b> closes any databases you have not closed previously, rolling back any uncommitted transactions. </p>
<p class=label>
<b>Transactions</b></p>
<p>
DAO manages transactions at the workspace level; hence, transactions on a workspace with multiple open databases apply to all of the databases. For example, if two databases have uncommitted updates and you call <a href="_mfc_cdaoworkspace.3a3a.committrans.htm">CommitTrans</a>, all of the updates are committed. If you want to limit transactions to a single database, you need a separate workspace object for it. </p>
<p class=label>
<b>Implicit Use of the Default Workspace</b></p>
<p>
MFC uses DAO’s default workspace implicitly under the following circumstances:
<ul type=disc>
<li>
If you create a new <b>CDaoDatabase</b> object but do not do so through an existing <b>CDaoWorkspace</b> object, MFC creates a temporary workspace object for you, which corresponds to DAO’s default workspace. If you do so for multiple databases, all of the database objects are associated with the default workspace. You can access a database’s workspace through a <b>CDaoDatabase</b> data member.<br><br></li>
<li>
Similarly, if you create a <b>CDaoRecordset</b> object without supplying a pointer to a <b>CDaoDatabase</b> object, MFC creates a temporary database object and, by extension, a temporary workspace object. You can access a recordset’s database, and indirectly its workspace, through a <b>CDaoRecordset</b> data member.</li>
</ul>
<p class=label>
<b>Other Operations</b></p>
<p>
Other database operations are also provided, such as repairing a corrupted database or compacting a database.</p>
<p>
For more about <b>CDaoWorkspace</b>, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Workspace">
</object><a href=JavaScript:alink_2.Click()>DAO Workspace</a>. For information about calling DAO directly and about DAO security, see <a href="_mfcnotes_tn054.htm">Technical Note 54</a>. For more about working with ODBC data sources through DAO, see the article <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_External.3a_.Working_with_External_Data_Sources">
</object><a href=JavaScript:alink_3.Click()>DAO External: Working with External Data Sources</a>. For information about the database engine, see the article <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Workspace.3a_.The_Database_Engine">
</object><a href=JavaScript:alink_4.Click()>DAO Workspace: The Database Engine</a>. All articles are in <i>Visual C++ Programmer's Guide</i>. The MFC Database sample <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_MFC_DAOVIEW">
</object><a href=JavaScript:alink_5.Click()>DAOVIEW</a> illustrates using <b>CDaoWorkspace</b>.</p>
<p>
<b>#include &lt;afxdao.h&gt;</b>&nbsp;&nbsp;&nbsp;</p>
<p>
<a href="_mfc_cdaoworkspace_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_cobject.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Sample</b>&nbsp;&nbsp;&nbsp;<object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_DAOVIEW">
</object><a href=JavaScript:alink_6.Click()>MFC Sample DAOVIEW</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaodatabase.htm">CDaoDatabase</a>, <a href="_mfc_cdaorecordset.htm">CDaoRecordset</a>, <a href="_mfc_cdaotabledef.htm">CDaoTableDef</a>, <a href="_mfc_cdaoquerydef.htm">CDaoQueryDef</a>, <a href="_mfc_cdaoexception.htm">CDaoException</a></p>
</font></BODY>
</HTML>
