<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CToolBarCtrl::SetRows</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_ctoolbarctrl.3a3a.setrows"></a><sup></sup>CToolBarCtrl::SetRows</h1>
<p>
<b>void</b> <b>SetRows(</b> <b>int</b> <i>nRows</i><b>,</b> <b>BOOL</b> <i>bLarger</i><b>,</b> <b>LPRECT</b> <i>lpRect</i> <b>);</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nRows</i></p>
<p class=indent>
Requested number of rows.</p>
<p class=dt>
<i>bLarger</i></p>
<p class=indent>
Tells whether to use more rows or fewer rows if the toolbar cannot be resized to the requested number of rows.</p>
<p class=dt>
<i>lpRect</i></p>
<p class=indent>
Points to the <a href="_mfc_crect.htm">CRect</a> object or <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_RECT_str">
</object><a href=JavaScript:alink_1.Click()>RECT</a> structure that will receive the new bounding rectangle of the toolbar.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this function to ask the toolbar control to resize itself to the requested number of rows.</p>
<p>
If the toolbar cannot resize itself to the requested number or rows, it will resize itself to either the next larger or next smaller valid size, depending on the value of <i>bLarger</i>. If <i>bLarger</i> is <b>TRUE</b>, the new number of rows will be larger than the number requested. If <i>bLarger</i> is <b>FALSE</b>, the new number of rows will be smaller than the number requested.</p>
<p>
A given number of rows is valid for the toolbar if the buttons can be arranged such that all of the rows have the same number of buttons (except perhaps the last row). For example, a toolbar that contains four buttons could not be sized to three rows because the last two rows would have to be shorter. If you attempted to size it to three rows, you would get four rows if <i>bLarger</i> was <b>TRUE</b> and two rows if <i>bLarger</i> was <b>FALSE</b>.</p>
<p>
If there are separators in the toolbar, the rules for when a given number of rows is valid are more complicated. The layout is computed such that button groups (buttons with a separator before the first and the last button in the group) are never broken up on several rows unless the group cannot fit on one row.</p>
<p>
If a group does not fit on one row, the next group will start on the next row even if it would fit on the row where the large group ended. The purpose of this rule is to make the separation between large groups more noticeable. The resulting vertical separators are counted as rows.</p>
<p>
Note also that the <b>SetRows</b> member function will always chose the layout that results in the smallest toolbar size. Creating a toolbar with the <b>TBSTYLE_WRAPABLE</b> style and then resizing the control will simply apply the method outlined above given the width of the control.</p>
<p>
This function can only be called for toolbars that were created with the <b>TBSTYLE_WRAPABLE</b> style.</p>
<p>
<a href="_mfc_ctoolbarctrl.htm">CToolBarCtrl Overview</a>  |&nbsp; <a href="_mfc_ctoolbarctrl_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;Toolbar styles in <a href="_mfc_ctoolbarctrl.3a3a.create.htm">CToolBarCtrl::Create</a>, <a href="_mfc_ctoolbarctrl.3a3a.getrows.htm">CToolBarCtrl::GetRows</a></p>
</font></BODY>
</HTML>
