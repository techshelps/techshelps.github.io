<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoWorkspace::Rollback</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoworkspace.3a3a.rollback"></a>CDaoWorkspace::Rollback</h1>
<p>
<b>void Rollback( );<br>
throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to end the current transaction and restore all databases in the workspace to their condition before the transaction was begun. </p>
<p class=indent>
<B><b>CAUTION</b></B>&nbsp;&nbsp;&nbsp;Within one workspace object, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, <b>Rollback</b> restores all operations on all of those databases and recordsets.</p>
<p>
If you close a workspace object without saving or rolling back any pending transactions, the transactions are automatically rolled back. If you call <a href="_mfc_cdaoworkspace.3a3a.committrans.htm">CommitTrans</a> or <b>Rollback</b> without first calling <a href="_mfc_cdaoworkspace.3a3a.begintrans.htm">BeginTrans</a>, an error occurs.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When you begin a transaction, the database engine records its operations in a file kept in the directory specified by the TEMP environment variable on the workstation. If the transaction log file exhausts the available storage on your TEMP drive, the database engine will cause MFC to throw a <b>CDaoException</b> (DAO error 2004). At this point, if you call <b>CommitTrans</b>, an indeterminate number of operations are committed but the remaining uncompleted operations are lost, and the operation has to be restarted. Calling <b>Rollback</b> releases the transaction log and rolls back all operations in the transaction.</p>
<p>
For more information about workspaces, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Workspace">
</object><a href=JavaScript:alink_1.Click()>DAO Workspace</a>. For more about transactions, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Workspace.3a_.Managing_Transactions">
</object><a href=JavaScript:alink_2.Click()>DAO Workspace: Managing Transactions</a>. Both articles are in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdaoworkspace.htm">CDaoWorkspace Overview</a>  |&nbsp; <a href="_mfc_cdaoworkspace_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaorecordset.htm">CDaoRecordset</a></p>
</font></BODY>
</HTML>
