<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connection Maps</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_connection_maps"></a>Connection Maps</h1>
<p>
OLE controls are able to expose interfaces to other applications. These interfaces only allow access from a container into that control. If an OLE control wants to access external interfaces of other OLE objects, a connection point must be established. This connection point allows a control outgoing access to external dispatch maps, such as event maps or notification functions.</p>
<p>
The Microsoft Foundation Class Library offers a programming model that supports connection points. In this model, "connection maps" are used to designate interfaces (or connection points) for the OLE control. Connection maps contain one macro for each connection point. For more information on connection maps, see the <a href="_mfc_cconnectionpoint.htm">CConnectionPoint</a> class.</p>
<p>
Typically, a control will support just two connection points: one for events and one for property notifications. These are implemented by the <b>COleControl</b> base class and require no additional work by the control writer. Any additional connection points you wish to implement in your class must be added by hand. To support connection maps and points, MFC provides the following macros:</p>
<p class=label>
<b>Connection Map Declaration and Demarcation</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=35%><a href="_mfc_begin_connection_part.htm">BEGIN_CONNECTION_PART</a></td>
<td width=65%>Declares an embedded class that implements an additional connection point (must be used in the class declaration).</td>
</tr>
<tr valign=top>
<td width=35%><a href="_mfc_end_connection_part.htm">END_CONNECTION_PART</a></td>
<td width=65%>Ends the declaration of a connection point (must be used in the class declaration).</td>
</tr>
<tr valign=top>
<td width=35%><a href="_mfc_connection_iid.htm">CONNECTION_IID</a></td>
<td width=65%>Specifies the interface ID of the control's connection point.</td>
</tr>
<tr valign=top>
<td width=35%><a href="_mfc_declare_connection_map.htm">DECLARE_CONNECTION_MAP</a></td>
<td width=65%>Declares that a connection map will be used in a class (must be used in the class declaration).</td>
</tr>
<tr valign=top>
<td width=35%><a href="_mfc_begin_connection_map.htm">BEGIN_CONNECTION_MAP</a></td>
<td width=65%>Begins the definition of a connection map (must be used in the class implementation).</td>
</tr>
<tr valign=top>
<td width=35%><a href="_mfc_end_connection_map.htm">END_CONNECTION_MAP</a></td>
<td width=65%>Ends the definition of a connection map (must be used in the class implementation).</td>
</tr>
<tr valign=top>
<td width=35%><a href="_mfc_connection_part.htm">CONNECTION_PART</a></td>
<td width=65%>Specifies a connection point in the control's connection map.</td>
</tr>
</table><br>
<p>
The following functions assist a sink in establishing and disconnecting a connection using connection points:</p>
<p class=label>
<b>Initialization/Termination of Connection Points</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=35%><a href="_mfc_afxconnectionadvise.htm">AfxConnectionAdvise</a></td>
<td width=65%>Establishes a connection between a source and a sink.</td>
</tr>
<tr valign=top>
<td width=35%><a href="_mfc_afxconnectionunadvise.htm">AfxConnectionUnadvise</a></td>
<td width=65%>Breaks a connection between a source and a sink.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
