<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CCriticalSection</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_ccriticalsection"></a>CCriticalSection</h1>
<p>
<img src="ccritic.gif" border=0></p>
<p>
An object of class <b>CCriticalSection </b>represents a “critical section” — a synchronization object that allows one thread at a time to access a resource or section of code. Critical sections are useful when only one thread at a time can be allowed to modify data or some other controlled resource. For example, adding nodes to a linked list is a process that should only be allowed by one thread at a time. By using a <b>CCriticalSection </b>object to control the linked list, only one thread at a time can gain access to the list.</p>
<p>
Critical sections are used instead of mutexes when speed is critical and the resource will not be used across process boundaries. For more information on using mutexes in MFC, see <a href="_mfc_cmutex.htm">CMutex</a>.</p>
<p>
To use a <b>CCriticalSection</b> object, construct the <b>CCriticalSection</b> object when it is needed. You can then access the critical section when the constructor returns. Call <a href="_mfc_ccriticalsection.3a3a.unlock.htm">Unlock</a> when you are done accessing the critical section.</p>
<p>
To access a resource controlled by a <b>CCriticalSection </b>object in this manner, first create a variable of type <a href="_mfc_csinglelock.htm">CSingleLock</a><b> </b>in your resource’s access member function. Then call the lock object’s <b>Lock</b> member function (for example, <a href="_mfc_csinglelock.3a3a.lock.htm">CSingleLock::Lock</a>). At this point, your thread will either gain access to the resource, wait for the resource to be released and gain access, or wait for the resource to be released and time out, failing to gain access to the resource. In any case, your resource has been accessed in a thread-safe manner. To release the resource, use the lock object’s <b>Unlock</b> member function (for example, <a href="_mfc_csinglelock.3a3a.unlock.htm">CSingleLock::Unlock</a>), or allow the lock object to fall out of scope.</p>
<p>
Alternatively, you can create a <b>CCriticalSection </b>object stand-alone, and access it explicitly before attempting to access the controlled resource. This method, while clearer to someone reading your source code, is more prone to error as you must remember to lock and unlock the critical section before and after access.</p>
<p>
For more information on using <b>CCriticalSection</b> objects, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Multithreading.3a_.How_to_Use_the_Synchronization_Classes">
</object><a href=JavaScript:alink_1.Click()>Multithreading: How to Use the Synchronization Classes</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<b>#include &lt;afxmt.h&gt;</b></p>
<p>
<a href="_mfc_ccriticalsection_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_csyncobject.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Sample</b>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_MTGDI">
</object><a href=JavaScript:alink_2.Click()>MFC Sample MTGDI</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cmutex.htm">CMutex</a></p>
</font></BODY>
</HTML>
