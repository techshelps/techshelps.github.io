<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHttpServerContext::TransmitFile</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcrefchttpservercontexttransmitfile"></a>CHttpServerContext::TransmitFile</h1>
<p>
<b>BOOL TransmitFile( HANDLE </b><i>hFile</i><b>, DWORD </b><i>dwFlags</i><b> = HSE_IO_DISCONNECT_AFTER_SEND, LPVOID </b><i>pstrHeader</i><b> = NULL, DWORD </b><i>dwHeaderLen</i><b> = 0, LPVOID </b><i>pstrTrailer</i><b> = NULL, DWORD </b><i>dwTrailerLen</i><b> = 0 );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
<b>TRUE</b> if the file's data was sent; otherwise, <b>FALSE</b>. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_Win32_GetLastError">
</object><a href=JavaScript:alink_1.Click()>GetLastError</a>. The function returns <b>FALSE</b> if an overlapped I/O operation is not complete before <b>TransmitFile</b> returns. In that case, <b>GetLastError</b> returns <b>ERROR_IO_PENDING</b>.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>hFile</i></p>
<p class=indent>
A handle to the file containing the data to transmit. The file must have been opened with <b>FILE_FLAG_SEQUENTIAL_SCAN</b> and <b>FILE_FLAG_OVERLAPPED</b>.</p>
<p class=dt>
<i>dwFlags</i></p>
<p class=indent>
The attributes associated with the file. By default, <b>HSE_IO_DISCONNECT_AFTER_SEND</b>. See <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_in_serversupportfunction">
</object><a href=JavaScript:alink_2.Click()>ServerSupportFunction</a> in the <i>Platform SDK </i>for a list of possible attributes.</p>
<p class=dt>
<i>pstrHeader</i></p>
<p class=indent>
A pointer to the string containing the header to send before transmitting the file's data. The header conveys to the receiving browser the type of data being sent and how it should be displayed. If <b>NULL</b>, the header is not sent.</p>
<p class=dt>
<i>dwHeaderLen</i></p>
<p class=indent>
The length of the header. By default, 0. If <i>pstrHeader</i> is not <b>NULL</b>, and <i>dwHeaderLen</i> is 0, the function will use the Win32 function <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_lstrlen">
</object><a href=JavaScript:alink_3.Click()>lstrlen</a> to find the length of the trailer. (In this case, <i>pstrTrailer</i> must be a null-terminated string.)</p>
<p class=dt>
<i>pstrTrailer</i></p>
<p class=indent>
A pointer to the string containing the trailer to send after transmitting the file's data. If <b>NULL</b>, the trailer is not sent.</p>
<p class=dt>
<i>dwTrailerLen</i></p>
<p class=indent>
The length of the trailer. By default, 0. If <i>pstrTrailer</i> is not <b>NULL</b>, and <i>dwTrailerLen</i> is 0, the function will use the Win32 function <b>lstrlen</b> to find the length of the trailer. (In this case, <i>pstrTrailer</i> must be a null-terminated string.)</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to transmit a file to a requester. This member function performs the operations of the <b>ServerSupportFunction</b> command flag <b>HSE_REQ_TRANSMIT_FILE</b>. The server performs this operation asynchronously. The server submits this operation to its internal asynchronous I/O queue and returns to the caller. MFC alters the context object to return <b>HSE_STATUS_PENDING</b>, and will use <b>HSE_DONE_WITH_SESSION</b> when the callback indicates completion of the I/O. MFC also sets <a href="_mfc_chttpservercontext.3a3a.m_bsendheaders.htm">m_bSendHeaders</a> in the context object <b>FALSE</b>, because headers are sent automatically.</p>
<p>
See the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vcsmpPINBALLInternetServerExtensionThatProvidesGraphicsRedirection">
</object><a href=JavaScript:alink_4.Click()>PINBALL</a> sample for a demonstration of this member function.</p>
<p>
<a href="_mfc_chttpservercontext.htm">CHttpServerContext Overview</a>  |&nbsp; <a href="_mfc_chttpservercontext_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="_mfc_chttpservercontext.3a3a.serversupportfunction.htm">CHttpServerContext::ServerSupportFunction</a></p>
</font></BODY>
</HTML>
