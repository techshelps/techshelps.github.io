<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COleControl::GetActivationPolicy</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_colecontrol.3a3a.getactivationpolicy"></a>COleControl::GetActivationPolicy</h1>
<p>
<b>virtual DWORD GetActivationPolicy(</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
A combination of flags from the <b>POINTERINACTIVE</b> enumeration. Possible flags are:</p>
<p class=dt>
<b>POINTERINACTIVE_ACTIVATEONENTRY</b></p>
<p class=indent>
The object should be in-place activated when the mouse enters it during a mouse move operation.</p>
<p class=dt>
<b>POINTERINACTIVE_DEACTIVATEONLEAVE</b></p>
<p class=indent>
The object should be deactivated when the mouse leaves the object during a mouse move operation.</p>
<p class=dt>
<b>POINTERINACTIVE_ACTIVATEONDRAG</b></p>
<p class=indent>
The object should be in-place activated when the mouse is dragged over it during a drag and drop operation.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Override this function to alter the default activation behavior of a control that supports the <b>IPointerInactive</b> interface.</p>
<p>
When the <b>IPointerInactive</b> interface is enabled, the container will delegate <b>WM_SETCURSOR</b> and <b>WM_MOUSEMOVE</b> messages to it. <b>COleControl</b>’s implementation of this interface will dispatch these messages through your control’s message map, after adjusting the mouse coordinates appropriately.</p>
<p>
Whenever the container receives a <b>WM_SETCURSOR</b> or <b>WM_MOUSEMOVE</b> message with the mouse pointer over an inactive object supporting <b>IPointerInactive</b>, it should call <b>GetActivationPolicy</b><i> </i>on the interface and return flags from the <b>POINTERINACTIVE</b> enumeration. </p>
<p>
You can process these messages just like ordinary window messages, by adding the corresponding entries to the message map. In your handlers, avoid using the <b>m_hWnd</b> member variable (or any member functions that uses it) without first checking that its value is non-<b>NULL</b>. </p>
<p>
Any object intended to do more than set the mouse cursor and/or fire a mouse move event, such as give special visual feedback, should return the <b>POINTERINACTIVE_ACTIVATEONENTRY</b> flag and draw the feedback only when active. If the object returns this flag, the container should activate it in-place immediately and then forward it the same message that triggered the call to <b>GetActivationPolicy</b>.</p>
<p>
If both the <b>POINTERINACTIVE_ACTIVATEONENTRY</b> and <b>POINTERINACTIVE_DEACTIVATEONLEAVE</b> flags are returned, then the object will only be activated when the mouse is over the object. If only the <b>POINTERINACTIVE_ACTIVATEONENTRY</b> flag is returned, then the object will only be activated once when the mouse first enters the object.</p>
<p>
You may also want an inactive control to be the target of an OLE drag and drop operation. This requires activating the control at the moment the user drags an object over it, so that the control’s window can be registered as a drop target. To cause activation to occur during a drag, return the <b>POINTERINACTIVE_ACTIVATEONDRAG</b> flag:</p>
<pre><code>DWORD CMyCtrl::GetActivationPolicy()
{
 &nbsp;&nbsp; return POINTERINACTIVE_ACTIVATEONDRAG;
}
</code></pre>
<p>
The information communicated by <b>GetActivationPolicy</b> should not be cached by a container. Instead, this method should be called every time the mouse enters an inactive object.</p>
<p>
If an inactive object does not request to be in-place activated when the mouse enters it, its container should dispatch subsequent <b>WM_SETCURSOR</b> messages to this object by calling <a href="_mfc_colecontrol.3a3a.oninactivesetcursor.htm">OnInactiveSetCursor</a> as long as the mouse pointer stays over the object.</p>
<p>
Enabling the <b>IPointerInactive</b> interface typically means that you want the control to be capable of processing mouse messages at all times. To get this behaviour in a container that doesn’t support the <b>IPointerInactive</b> interface, you will need to have your control always activated when visible, which means the control should have the <b>OLEMISC_ACTIVATEWHENVISIBLE</b> flag among its miscellaneous flags. However, to prevent this flag from taking effect in a container that does support <b>IPointerInactive</b>, you can also specify the <b>OLEMISC_IGNOREACTIVATEWHENVISIBLE</b> flag:</p>
<pre><code>static const DWORD BASED_CODE _dwMyOleMisc =
 &nbsp;&nbsp; OLEMISC_ACTIVATEWHENVISIBLE |
 &nbsp;&nbsp; OLEMISC_IGNOREACTIVATEWHENVISIBLE |
 &nbsp;&nbsp; OLEMISC_SETCLIENTSITEFIRST |
 &nbsp;&nbsp; OLEMISC_INSIDEOUT |
 &nbsp;&nbsp; OLEMISC_CANTLINKINSIDE |
 &nbsp;&nbsp; OLEMISC_RECOMPOSEONRESIZE;</code></pre>
<p>
<a href="_mfc_colecontrol.htm">COleControl Overview</a>  |&nbsp; <a href="_mfc_colecontrol_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_colecontrol.3a3a.oninactivesetcursor.htm">COleControl::OnInactiveSetCursor</a>, <a href="_mfc_colecontrol.3a3a.oninactivemousemove.htm">COleControl::OnInactiveMouseMove</a></p>
</font></BODY>
</HTML>
