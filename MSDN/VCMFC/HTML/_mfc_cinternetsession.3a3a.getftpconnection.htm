<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CInternetSession::GetFtpConnection</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cinternetsession.3a3a.getftpconnection"></a>CInternetSession::GetFtpConnection</h1>
<p>
<b>CFtpConnection* GetFtpConnection( LPCTSTR </b><i>pstrServer</i><b>, LPCTSTR </b><i>pstrUserName</i><b> = NULL, LPCTSTR </b><i>pstrPassword</i><b> = NULL, INTERNET_PORT </b><i>nPort</i><b> = INTERNET_INVALID_PORT_NUMBER, BOOL </b><i>bPassive</i><b> = FALSE ); <br>
Throw ( CInternetException );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
A pointer to a <a href="_mfc_cftpconnection.htm">CFtpConnection</a> object. If the call fails, determine the cause of the failure by examining the thrown <a href="_mfc_cinternetexception.htm">CInternetException</a> object.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pstrServer</i></p>
<p class=indent>
A pointer to a string containing the FTP server name.</p>
<p class=dt>
<i>pstrUserName</i></p>
<p class=indent>
Pointer to a null-terminated string that specifies the name of the user to log in. If <b>NULL</b>, the default is anonymous. </p>
<p class=dt>
<i>pstrPassword</i></p>
<p class=indent>
A pointer to a null-terminated string that specifies the password to use to log in. If both <i>pstrPassword</i> and <i>pstrUserName</i> are <b>NULL</b>, the default anonymous password is the user's email name. If <i>pstrPassword</i> is <b>NULL</b> (or an empty string) but <i>pstrUserName</i> is not <b>NULL</b>, a blank password is used. The following table describes the behavior for the four possible settings of <i>pstrUserName</i> and <i>pstrPassword</i>: </p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b><i>pstrUserName</i></b></td>
<td class=label width=24%><b><i>pstrPassword</i></b></td>
<td class=label width=24%><b>Username sent to FTP server</b></td>
<td class=label width=27%><b>Password sent to FTP server</b></td>
</tr>
<tr valign=top>
<td width=25%><b>NULL</b> or “ “</td>
<td width=24%><b>NULL</b> or “ “</td>
<td width=24%>"anonymous"</td>
<td width=27%>User's email name</td>
</tr>
<tr valign=top>
<td width=25%>Non-<b>NULL</b> String</td>
<td width=24%><b>NULL</b> or “ “</td>
<td width=24%><i>pstrUserName</i></td>
<td width=27%>“ “</td>
</tr>
<tr valign=top>
<td width=25%><b>NULL</b> Non-<b>NULL</b> String</td>
<td width=24%><b>ERROR</b></td>
<td width=24%><b>ERROR</b></td>
<td width=27%></td>
</tr>
<tr valign=top>
<td width=25%>Non-<b>NULL</b> String</td>
<td width=24%>Non-<b>NULL</b> String</td>
<td width=24%><i>pstrUserName</i></td>
<td width=27%><i>pstrPassword</i></td>
</tr>
</table><br>
<p class=dt>
<i>nPort</i></p>
<p class=indent>
A number that identifies the TCP/IP port to use on the server.</p>
<p class=dt>
<i>bPassive</i></p>
<p class=indent>
Specifies passive or active mode for this FTP session. If set to <b>TRUE</b>, it sets the Win32 API <i>dwFlag</i> to <b>INTERNET_FLAG_PASSIVE</b>. </p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to establish an FTP connection and get a pointer to a <b>CFtpConnection</b> object.</p>
<p>
<b>GetFtpConnection</b> connects to an FTP server, and creates and returns a pointer to a <b>CFTPConnection</b> object. It does not perform any specific operation on the server. If you intend to read or write to files, for example, you must perform those operations as separate steps. See the classes <a href="_mfc_cftpconnection.htm">CFtpConnection</a> and <a href="_mfc_cftpfilefind.htm">CFtpFileFind</a> for information about searching for files, opening files, and reading or writing to files. See the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Internet_Programming_with_WinInet">
</object><a href=JavaScript:alink_1.Click()>Internet Programming with WinInet</a> in <i>Visual C++ Programmer’s Guide</i> for steps in performing common FTP connection tasks.</p>
<p>
<a href="_mfc_cinternetsession.htm">CInternetSession Overview</a>  |&nbsp; <a href="_mfc_cinternetsession_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cftpconnection.htm">CFtpConnection</a> <a href="_mfc_cinternetsession.3a3a.getgopherconnection.htm">CInternetSession::GetGopherConnection</a>, <a href="_mfc_cinternetsession.3a3a.gethttpconnection.htm">CInternetSession::GetHttpConnection</a>, <a href="_mfc_cinternetsession.3a3a.openurl.htm">CInternetSession::OpenURL</a></p>
</font></BODY>
</HTML>
