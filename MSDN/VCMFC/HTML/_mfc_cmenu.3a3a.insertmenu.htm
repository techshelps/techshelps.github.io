<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CMenu::InsertMenu</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cmenu.3a3a.insertmenu"></a><sup></sup>CMenu::InsertMenu  </h1>
<p>
<b>BOOL</b> <b>InsertMenu(</b> <b>UINT</b> <i>nPosition</i><b>,</b> <b>UINT</b> <i>nFlags</i><b>,</b> <b>UINT</b> <i>nIDNewItem</i> <b>=</b> <b>0,</b> <b>LPCTSTR</b> <i>lpszNewItem</i> <b>=</b> <b>NULL</b> <b>);</b></p>
<p>
<b>BOOL</b> <b>InsertMenu(</b> <b>UINT</b> <i>nPosition</i><b>,</b> <b>UINT</b> <i>nFlags</i><b>,</b> <b>UINT</b> <i>nIDNewItem</i><b>,</b> <b>const</b> <b>CBitmap</b>* <i>pBmp</i> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if the function is successful; otherwise 0.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nPosition</i></p>
<p class=indent>
Specifies the menu item before which the new menu item is to be inserted. The <i>nFlags</i> parameter can be used to interpret <i>nPosition</i> in the following ways:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>nFlags</b></td>
<td class=label width=66%><b>Interpretation of nPosition</b></td>
</tr>
<tr valign=top>
<td width=34%><b>MF_BYCOMMAND</b></td>
<td width=66%>Specifies that the parameter gives the command ID of the existing menu item. This is the default if neither <b>MF_BYCOMMAND</b> nor <b>MF_BYPOSITION</b> is set.</td>
</tr>
<tr valign=top>
<td width=34%><b>MF_BYPOSITION</b></td>
<td width=66%>Specifies that the parameter gives the position of the existing menu item. The first item is at position 0. If <i>nPosition</i> is –1, the new menu item is appended to the end of the menu.</td>
</tr>
</table><br>
<p class=dt>
<i>nFlags</i></p>
<p class=indent>
Specifies how <i>nPosition</i> is interpreted and specifies information about the state of the new menu item when it is added to the menu. For a list of the flags that may be set, see the <a href="_mfc_cmenu.3a3a.appendmenu.htm">AppendMenu</a> member function. To specify more than one value, use the bitwise OR operator to combine them with the <b>MF_BYCOMMAND</b> or <b>MF_BYPOSITION</b> flag.</p>
<p class=dt>
<i>nIDNewItem</i></p>
<p class=indent>
Specifies either the command ID of the new menu item or, if <i>nFlags</i> is set to <b>MF_POPUP</b>, the menu handle (<b>HMENU</b>) of the pop-up menu. The <i>nIDNewItem</i> parameter is ignored (not needed) if <i>nFlags</i> is set to <b>MF_SEPARATOR</b>.</p>
<p class=dt>
<i>lpszNewItem</i></p>
<p class=indent>
Specifies the content of the new menu item. <i>nFlags</i> can be used to interpret <i>lpszNewItem</i> in the following ways:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>nFlags</b></td>
<td class=label width=66%><b>Interpretation of lpszNewItem</b></td>
</tr>
<tr valign=top>
<td width=34%><b>MF_OWNERDRAW</b></td>
<td width=66%>Contains an application-supplied 32-bit value that the application can use to maintain additional data associated with the menu item. This 32-bit value is available to the application in the <b>itemData</b> member of the structure supplied by the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_WM_MEASUREITEM">
</object><a href=JavaScript:alink_1.Click()>WM_MEASUREITEM</a> and <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_WM_DRAWITEM">
</object><a href=JavaScript:alink_2.Click()>WM_DRAWITEM</a> messages. These messages are sent when the menu item is initially displayed or is changed.</td>
</tr>
<tr valign=top>
<td width=34%><b>MF_STRING</b></td>
<td width=66%>Contains a long pointer to a null-terminated string. This is the default interpretation.</td>
</tr>
<tr valign=top>
<td width=34%><b>MF_SEPARATOR</b></td>
<td width=66%>The <i>lpszNewItem</i> parameter is ignored (not needed).</td>
</tr>
</table><br>
<p class=dt>
<i>pBmp</i></p>
<p class=indent>
Points to a <b>CBitmap</b> object that will be used as the menu item.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Inserts a new menu item at the position specified by <i>nPosition</i> and moves other items down the menu. The application can specify the state of the menu item by setting values in <i>nFlags</i>. </p>
<p>
Whenever a menu that resides in a window is changed (whether or not the window is displayed), the application should call <b>CWnd::DrawMenuBar</b>. </p>
<p>
When <i>nIDNewItem</i> specifies a pop-up menu, it becomes part of the menu in which it is inserted. If that menu is destroyed, the inserted menu will also be destroyed. An inserted menu should be detached from a <b>CMenu</b> object to avoid conflict.</p>
<p>
If the active multiple document interface (MDI) child window is maximized and an application inserts a pop-up menu into the MDI application’s menu by calling this function and specifying the <b>MF_BYPOSITION</b> flag, the menu is inserted one position farther left than expected. This happens because the Control menu of the active MDI child window is inserted into the first position of the MDI frame window’s menu bar. To position the menu properly, the application must add 1 to the position value that would otherwise be used. An application can use the <b>WM_MDIGETACTIVE</b> message to determine whether the currently active child window is maximized.</p>
<p>
<a href="_mfc_cmenu.htm">CMenu Overview</a>  |&nbsp; <a href="_mfc_cmenu_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cmenu.3a3a.appendmenu.htm">CMenu::AppendMenu</a>, <a href="_mfc_cwnd.3a3a.drawmenubar.htm">CWnd::DrawMenuBar</a>, <a href="_mfc_cmenu.3a3a.setmenuitembitmaps.htm">CMenu::SetMenuItemBitmaps</a>, <a href="_mfc_cmenu.3a3a.detach.htm">CMenu::Detach</a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_InsertMenu">
</object><a href=JavaScript:alink_3.Click()>::InsertMenu</a></p>
</font></BODY>
</HTML>
