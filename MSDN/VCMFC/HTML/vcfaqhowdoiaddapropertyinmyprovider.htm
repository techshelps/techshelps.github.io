<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Do I Add a Property in My Provider?</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcfaqhowdoiaddapropertyinmyprovider"></a>How Do I Add a Property in My Provider?</h1>
<p>
Find the property group and property ID for the property you want. (See <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="oledbole_db_properties">
</object><a href=JavaScript:alink_1.Click()>OLE DB Properties</a> in the <i>OLE DB Programmer's Reference</i>.) </p>
<p>
In the provider code generated by the Wizard, find the property map corresponding to the property group. (The name of the property group usually corresponds to the name of the object. Command and rowset properties can be found in the command or rowset; data source and initialization properties can be found in the data source object.)</p>
<p>
In the property map, add a <a href="vcrefproperty_info_entry.htm">PROPERTY_INFO_ENTRY</a> macro. <b>PROPERTY_INFO_ENTRY</b> takes four parameters:
<ul type=disc>
<li>
The property ID corresponding to your property. You must remove the first seven characters (<code>"DBPROP_"</code>) from the front of the property name. For example, if you want to add <b>DBPROP_MAXROWS</b>, pass <code>MAXROWS</code> as the first element.<br><br></li>
<li>
The variant type of the property (find in <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="oledbole_db_properties">
</object><a href=JavaScript:alink_2.Click()>OLE DB Properties</a> in the <i>OLE DB Programmer's Reference</i>). Enter the <b>VT_ </b>type (such as&nbsp; <b>VT_BOOL</b> or <b>VT_I2</b>) corresponding to the data type.<br><br></li>
<li>
Flags to indicate whether the property is readable and writeable and the group it belongs to. For example, the following code indicates a read/write property belonging to the rowset group:<pre><code>DBPROPFLAGS_ROWSET | DBPROPFLAGS_READ | DBPROPFLAGS_WRITE 
</code></pre>
</li>
<li>
The base value of the property. This might be <b>VARIANT_FALSE</b> for a boolean type or zero for an integer type, for example. The property will have this value unless someone changes it.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Some properties are connected or "chained" to other properties, such as bookmarks or updating. When a consumer sets one property to true, another property may also be set. The OLE DB Provider templates support this through the method <a href="vcrefcutlpropsonpropertychanged.htm">CUtlProps::OnPropertyChanged</a>. For an example of how to use <b>OnPropertyChanged</b>, see the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vcsmpMyProvASimpleReadOnlyProvider">
</object><a href=JavaScript:alink_3.Click()>MyProv: Sample</a>.</p></li>
</ul>
</font></BODY>
</HTML>
