<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDatabase::BeginTrans</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdatabase.3a3a.begintrans"></a><sup></sup>CDatabase::BeginTrans</h1>
<p>
<b>BOOL</b> <b>BeginTrans(</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if the call was successful and changes are committed only manually; otherwise 0.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to begin a transaction with the connected data source. A transaction consists of one or more calls to the <b>AddNew</b>, <b>Edit</b>, <b>Delete</b>, and <b>Update</b> member functions of a <b>CRecordset</b> object. Before beginning a transaction, the <b>CDatabase</b> object must already have been connected to the data source by calling its <b>OpenEx</b> or <b>Open</b> member function. To end the transaction, call <a href="_mfc_cdatabase.3a3a.committrans.htm">CommitTrans</a> to accept all changes to the data source (and carry them out) or call <a href="_mfc_cdatabase.3a3a.rollback.htm">Rollback</a> to abort the entire transaction. Call <b>BeginTrans</b> after you open any recordsets involved in the transaction and as close to the actual update operations as possible.</p>
<p class=indent>
<B><b>CAUTION</b></B>&nbsp;&nbsp;&nbsp;Depending on your ODBC driver, opening a recordset before calling <b>BeginTrans</b> may cause problems when calling <b>Rollback</b>. You should check the specific driver you are using. For example, when using the Microsoft Access driver included in the Microsoft ODBC Desktop Driver Pack 3.0, you must account for the Jet database engine's requirement that you should not begin a transaction on any database that has an open cursor. In the MFC database classes, an open cursor means an open <b>CRecordset</b> object. For more information, see <a href="_mfcnotes_tn068.htm">Technical Note 68</a>.</p>
<p>
<b>BeginTrans</b> may also lock data records on the server, depending on the requested concurrency and the capabilities of the data source. For information about locking data, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Locking_Records_.28.ODBC.29">
</object><a href=JavaScript:alink_1.Click()>Recordset: Locking Records (ODBC)</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
User-defined transactions are explained in the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Transaction_.28.ODBC.29">
</object><a href=JavaScript:alink_2.Click()>Transaction (ODBC)</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<b>BeginTrans</b> establishes the state to which the sequence of transactions can be rolled back (reversed). To establish a new state for rollbacks, commit any current transaction, then call <b>BeginTrans</b> again. </p>
<p class=indent>
<B><b>! WARNING</b></B>&nbsp;&nbsp;&nbsp;Calling <b>BeginTrans</b> again without calling <b>CommitTrans</b> or <b>Rollback</b> is an error.</p>
<p>
Call the <a href="_mfc_cdatabase.3a3a.cantransact.htm">CanTransact</a> member function to determine whether your driver supports transactions for a given database. You should also call <a href="_mfc_cdatabase.3a3a.getcursorcommitbehavior.htm">GetCursorCommitBehavior</a> and <a href="_mfc_cdatabase.3a3a.getcursorrollbackbehavior.htm">GetCursorRollbackBehavior</a> to determine the support for cursor preservation.</p>
<p>
For more information about transactions, see the article <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Transaction_.28.ODBC.29">
</object><a href=JavaScript:alink_3.Click()>Transaction (ODBC)</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p class=label>
<b>Example</b></p>
<p>
See the article <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Transaction.3a_.Performing_a_Transaction_in_a_Recordset_.28.ODBC.29">
</object><a href=JavaScript:alink_4.Click()>Transaction: Performing a Transaction in a Recordset (ODBC)</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdatabase.htm">CDatabase Overview</a>  |&nbsp; <a href="_mfc_cdatabase_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdatabase.3a3a.committrans.htm">CDatabase::CommitTrans</a>, <a href="_mfc_cdatabase.3a3a.rollback.htm">CDatabase::Rollback</a>, <a href="_mfc_crecordset.3a3a.cantransact.htm">CRecordset::CanTransact</a></p>
</font></BODY>
</HTML>
