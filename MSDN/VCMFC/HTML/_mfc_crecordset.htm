<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CRecordset</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_crecordset"></a><sup></sup>CRecordset</h1>
<p>
<img src="crecdset.gif" border=0></p>
<p>
A <b>CRecordset</b> object represents a set of records selected from a data source. Known as “recordsets,” <b>CRecordset</b> objects are typically used in two forms: dynasets and snapshots. A dynaset stays synchronized with data updates made by other users. A snapshot is a static view of the data. Each form represents a set of records fixed at the time the recordset is opened, but when you scroll to a record in a dynaset, it reflects changes subsequently made to the record, either by other users or by other recordsets in your application.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you are working with the Data Access Objects (DAO) classes rather than the Open Database Connectivity (ODBC) classes, use class <a href="_mfc_cdaorecordset.htm">CDaoRecordset</a> instead. For more information, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Database_Topics_.28.General.29">
</object><a href=JavaScript:alink_1.Click()>Database Topics (General)</a> and the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_and_MFC">
</object><a href=JavaScript:alink_2.Click()>DAO and MFC</a>. Both articles are in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
To work with either kind of recordset, you typically derive an application-specific recordset class from <b>CRecordset</b>. Recordsets select records from a data source, and you can then:
<ul type=disc>
<li>
Scroll through the records. <br><br></li>
<li>
Update the records and specify a locking mode.<br><br></li>
<li>
Filter the recordset to constrain which records it selects from those available on the data source.<br><br></li>
<li>
Sort the recordset.<br><br></li>
<li>
Parameterize the recordset to customize its selection with information not known until run time.</li>
</ul>
<p>
To use your class, open a database and construct a recordset object, passing the constructor a pointer to your <b>CDatabase</b> object. Then call the recordset’s <b>Open</b> member function, where you can specify whether the object is a dynaset or a snapshot. Calling <b>Open</b> selects data from the data source. After the recordset object is opened, use its member functions and data members to scroll through the records and operate on them. The operations available depend on whether the object is a dynaset or a snapshot, whether it is updatable or read-only (this depends on the capability of the Open Database Connectivity (ODBC) data source), and whether you have implemented bulk row fetching. To refresh records that may have been changed or added since the <b>Open</b> call, call the object’s <b>Requery</b> member function. Call the object’s <b>Close</b> member function and destroy the object when you finish with it.</p>
<p>
In a derived <b>CRecordset</b> class, record field exchange (RFX) or bulk record field exchange (Bulk RFX) is used to support reading and updating of record fields.</p>
<p>
For more information about recordsets and record field exchange, see the articles <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Database_Topics_.28.General.29">
</object><a href=JavaScript:alink_3.Click()>Database Topics (General)</a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset_.28.ODBC.29">
</object><a href=JavaScript:alink_4.Click()>Recordset (ODBC)</a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Fetching_Records_in_Bulk_.28.ODBC.29">
</object><a href=JavaScript:alink_5.Click()>Recordset: Fetching Records in Bulk (ODBC)</a>, and <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Record_Field_Exchange_.28.RFX.29">
</object><a href=JavaScript:alink_6.Click()>Record Field Exchange</a>. For a focus on dynasets and snapshots, see the articles <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Dynaset">
</object><a href=JavaScript:alink_7.Click()>Dynaset</a> and <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Snapshot">
</object><a href=JavaScript:alink_8.Click()>Snapshot</a>. All articles are in <i>Visual C++ Programmer’s Guide</i>. </p>
<p>
<b>#include &lt;afxdb.h&gt;</b></p>
<p>
<a href="_mfc_crecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_cobject.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Samples</b>&nbsp;&nbsp;&nbsp;<object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_CATALOG">
</object><a href=JavaScript:alink_9.Click()>MFC Sample CATALOG</a>  |&nbsp; <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_DBFETCH">
</object><a href=JavaScript:alink_10.Click()>MFC Sample DBFETCH</a>  |&nbsp; <object id=alink_11 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_ODBCINFO">
</object><a href=JavaScript:alink_11.Click()>MFC Sample ODBCINFO</a>  |&nbsp; <object id=alink_12 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_WWWQUOTE">
</object><a href=JavaScript:alink_12.Click()>MFC Sample WWWQUOTE</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdatabase.htm">CDatabase</a>, <a href="_mfc_crecordview.htm">CRecordView</a></p>
</font></BODY>
</HTML>
