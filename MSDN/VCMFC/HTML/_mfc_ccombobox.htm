<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CComboBox</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_ccombobox"></a><sup></sup>CComboBox</h1>
<p>
<img src="ccombobx.gif" border=0></p>
<p>
The <b>CComboBox</b> class provides the functionality of a Windows combo box. </p>
<p>
A combo box consists of a list box combined with either a static control or edit control. The list-box portion of the control may be displayed at all times or may only drop down when the user selects the drop-down arrow next to the control.</p>
<p>
The currently selected item (if any) in the list box is displayed in the static or edit control. In addition, if the combo box has the drop-down list style, the user can type the initial character of one of the items in the list, and the list box, if visible, will highlight the next item with that initial character.</p>
<p>
The following table compares the three combo-box <a href="_mfc_combo.2d.box_styles.htm">styles</a>.&nbsp; </p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=22%><b>Style</b></td>
<td class=label width=39%><b>When is list box visible?</b></td>
<td class=label width=39%><b>Static or edit control?</b></td>
</tr>
<tr valign=top>
<td width=22%>Simple</td>
<td width=39%>Always</td>
<td width=39%>Edit</td>
</tr>
<tr valign=top>
<td width=22%>Drop-down</td>
<td width=39%>When dropped down</td>
<td width=39%>Edit</td>
</tr>
<tr valign=top>
<td width=22%>Drop-down list</td>
<td width=39%>When dropped down</td>
<td width=39%>Static</td>
</tr>
</table><br>
<p>
You can create a <b>CComboBox</b> object from either a dialog template or directly in your code. In both cases, first call the constructor <b>CComboBox</b> to construct the <b>CComboBox</b> object; then call the <a href="_mfc_ccombobox.3a3a.create.htm">Create</a> member function to create the control and attach it to the <b>CComboBox</b> object. </p>
<p>
If you want to handle Windows notification messages sent by a combo box to its parent (usually a class derived from <b>CDialog</b>), add a message-map entry and message-handler member function to the parent class for each message.</p>
<p>
Each message-map entry takes the following form:</p>
<p>
<b>ON_</b>Notification<b>(</b> <i>id</i><b>,</b> <i>memberFxn</i> <b>)</b></p>
<p>
where <i>id</i> specifies the child-window ID of the combo-box control sending the notification and <i>memberFxn</i> is the name of the parent member function you have written to handle the notification.</p>
<p>
The parent’s function prototype is as follows:</p>
<p>
<b>afx_msg</b> <b>void</b> <i>memberFxn</i><b>(</b> <b>);</b></p>
<p>
The order in which certain notifications will be sent cannot be predicted. In particular, a <b>CBN_SELCHANGE</b> notification may occur either before or after a <b>CBN_CLOSEUP</b> notification.</p>
<p>
Potential message-map entries are the following:
<ul type=disc>
<li>
<b>ON_CBN_CLOSEUP</b>&nbsp;&nbsp;&nbsp;(Windows 3.1 and later.) The list box of a combo box has closed. This notification message is not sent for a combo box that has the<a href="_mfc_combo.2d.box_styles.htm"> CBS_SIMPLE</a> style.<br><br></li>
<li>
<b>ON_CBN_DBLCLK</b>&nbsp;&nbsp;&nbsp;The user double-clicks a string in the list box of a combo box. This notification message is only sent for a combo box with the <b>CBS_SIMPLE</b> style. For a combo box with the <a href="_mfc_combo.2d.box_styles.htm">CBS_DROPDOWN</a> or <a href="_mfc_combo.2d.box_styles.htm">CBS_DROPDOWNLIST</a> style, a double-click cannot occur because a single click hides the list box.<br><br></li>
<li>
<b>ON_CBN_DROPDOWN</b>&nbsp;&nbsp;&nbsp;The list box of a combo box is about to drop down (be made visible). This notification message can occur only for a combo box with the <b>CBS_DROPDOWN</b> or <b>CBS_DROPDOWNLIST</b> style.<br><br></li>
<li>
<b>ON_CBN_EDITCHANGE</b>&nbsp;&nbsp;&nbsp;The user has taken an action that may have altered the text in the edit-control portion of a combo box. Unlike the <b>CBN_EDITUPDATE</b> message, this message is sent after Windows updates the screen. It is not sent if the combo box has the <b>CBS_DROPDOWNLIST</b> style.<br><br></li>
<li>
<b>ON_CBN_EDITUPDATE</b>&nbsp;&nbsp;&nbsp;The edit-control portion of a combo box is about to display altered text. This notification message is sent after the control has formatted the text but before it displays the text. It is not sent if the combo box has the <b>CBS_DROPDOWNLIST</b> style.<br><br></li>
<li>
<b>ON_CBN_ERRSPACE</b>&nbsp;&nbsp;&nbsp;The combo box cannot allocate enough memory to meet a specific request.<br><br></li>
<li>
<b>ON_CBN_SELENDCANCEL</b>&nbsp;&nbsp;&nbsp;(Windows 3.1 and later.) Indicates the user’s selection should be canceled. The user clicks an item and then clicks another window or control to hide the list box of a combo box. This notification message is sent before the <b>CBN_CLOSEUP</b> notification message to indicate that the user’s selection should be ignored. The <b>CBN_SELENDCANCEL</b> or <b>CBN_SELENDOK</b> notification message is sent even if the <b>CBN_CLOSEUP</b> notification message is not sent (as in the case of a combo box with the <b>CBS_SIMPLE</b> style).<br><br></li>
<li>
<b>ON_CBN_SELENDOK</b>&nbsp;&nbsp;&nbsp;The user selects an item and then either presses the ENTER key or clicks the DOWN ARROW key to hide the list box of a combo box. This notification message is sent before the <b>CBN_CLOSEUP</b> message to indicate that the user’s selection should be considered valid. The <b>CBN_SELENDCANCEL</b> or <b>CBN_SELENDOK</b> notification message is sent even if the <b>CBN_CLOSEUP</b> notification message is not sent (as in the case of a combo box with the <b>CBS_SIMPLE</b> style).<br><br></li>
<li>
<b>ON_CBN_KILLFOCUS</b>&nbsp;&nbsp;&nbsp;The combo box is losing the input focus.<br><br></li>
<li>
<b>ON_CBN_SELCHANGE</b>&nbsp;&nbsp;&nbsp;The selection in the list box of a combo box is about to be changed as a result of the user either clicking in the list box or changing the selection by using the arrow keys. When processing this message, the text in the edit control of the combo box can only be retrieved via <b>GetLBText</b> or another similar function. <b>GetWindowText</b> cannot be used.<br><br></li>
<li>
<b>ON_CBN_SETFOCUS</b>&nbsp;&nbsp;&nbsp;The combo box receives the input focus.</li>
</ul>
<p>
If you create a <b>CComboBox</b> object within a dialog box (through a dialog resource), the <b>CComboBox</b> object is automatically destroyed when the user closes the dialog box. </p>
<p>
If you embed a <b>CComboBox</b> object within another window object, you do not need to destroy it. If you create the <b>CComboBox</b> object on the stack, it is destroyed automatically. If you create the <b>CComboBox</b> object on the heap by using the <b>new</b> function, you must call <b>delete</b> on the object to destroy it when the Windows combo box is destroyed.</p>
<p>
<b>#include &lt;afxwin.h&gt;</b></p>
<p>
<a href="_mfc_ccombobox_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_cwnd.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Sample</b>&nbsp;&nbsp;&nbsp;<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_CTRLBARS">
</object><a href=JavaScript:alink_1.Click()>MFC Sample CTRLBARS</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cwnd.htm">CWnd</a>, <a href="_mfc_cbutton.htm">CButton</a>, <a href="_mfc_cedit.htm">CEdit</a>, <a href="_mfc_clistbox.htm">CListBox</a>, <a href="_mfc_cscrollbar.htm">CScrollBar</a>, <a href="_mfc_cstatic.htm">CStatic</a>, <a href="_mfc_cdialog.htm">CDialog</a></p>
</font></BODY>
</HTML>
