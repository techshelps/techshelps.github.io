<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DECLARE_POLY_AGGREGATABLE</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_atl_declare_poly_aggregatable"></a>DECLARE_POLY_AGGREGATABLE</h1>
<p>
<b>DECLARE_POLY_AGGREGATABLE( </b><i>x</i><b> )</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>x</i></p>
<p class=indent>
[in] The name of the class object you are defining as aggregatable or not aggregatable.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Specifies that an instance of <b>CComPolyObject &lt; </b><i>x</i><b> &gt;</b> is created when your object is created. During creation, the value of the outer unknown is checked. If it is <b>NULL</b>, <b>IUnknown</b> is implemented for a nonaggregated object. If the outer unknown is not <b>NULL</b>, <b>IUnknown</b> is implemented for an aggregated object. </p>
<p>
The advantage of using <b>DECLARE_POLY_AGGREGATABLE</b> is that you avoid having both <b>CComAggObject</b> and <b>CComObject</b> in your module to handle the aggregated and nonaggregated cases. A single <b>CComPolyObject</b> object handles both cases. This means only one copy of the vtable and one copy of the functions exist in your module. If your vtable is large, this can substantially decrease your module size. However, if your vtable is small, using <b>CComPolyObject</b> can result in a slightly larger module size because it is not optimized for an aggregated or nonaggregated object, as are <b>CComAggObject</b> and <b>CComObject</b>.</p>
<p>
The <b>DECLARE_POLY_AGGREGATABLE</b> macro is automatically declared in your object if you use the ATL Object Wizard to create a full control or Internet Explorer control.</p>
<p>
<a href="_atl_atl_macros_and_global_functions.htm">ATL Macros and Global Functions</a></p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="_atl_ccompolyobject.htm">CComPolyObject</a>, <a href="_atl_ccomaggobject.htm">CComAggObject</a>, <a href="_atl_ccomobject.htm">CComObject</a></p>
</font></BODY>
</HTML>
