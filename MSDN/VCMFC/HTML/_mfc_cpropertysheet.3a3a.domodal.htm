<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPropertySheet::DoModal</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cpropertysheet.3a3a.domodal"></a>CPropertySheet::DoModal</h1>
<p>
<b>virtual int</b> <b>DoModal(</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
<b>IDOK</b> or <b>IDCANCEL</b> if the function was successful; otherwise 0 or -1. If the property sheet has been established as a wizard (see <a href="_mfc_cpropertysheet.3a3a.setwizardmode.htm">SetWizardMode</a>), <b>DoModal</b> returns either <b>ID_WIZFINISH</b> or <b>IDCANCEL</b>.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to display a modal property sheet. The return value corresponds to the ID of the control that closed the property sheet. After this function returns, the windows corresponding to the property sheet and all the pages will have been destroyed. The objects themselves will still exist. Typically, you will retrieve data from the <a href="_mfc_cpropertypage.htm">CPropertyPage</a> objects after <b>DoModal</b> returns <b>IDOK</b>.</p>
<p>
To display a modeless property sheet, call <a href="_mfc_cpropertysheet.3a3a.create.htm">Create</a> instead.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The first time a property page is created from its corresponding dialog resource, it may cause a first-chance exception. This is a result of the property page changing the style of the dialog resource to the required style prior to creating the page. Because resources are generally read-only, this causes an exception. The exception is handled by the system, and a copy of the modified resource is made automatically by the system. The first-chance exception can thus be ignored.</p>
<p class=indent>
Since this exception must be handled by the operating system, do not wrap calls to <b>CPropertySheet::DoModal</b> with a C++ <b>try</b>/<b>catch</b> block in which the catch handles all exceptions, for example, <code>catch (...)</code>. This will handle the exception intended for the operating system, causing unpredictable behavior. Using C++ exception handling with specific exception types or using structured exception handling where the Access Violation exception is passed through to the operating system is safe, however.</p>
<p>
<a href="_mfc_cpropertysheet.htm">CPropertySheet Overview</a>  |&nbsp; <a href="_mfc_cpropertysheet_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdialog.3a3a.domodal.htm">CDialog::DoModal</a>, <a href="_mfc_cpropertysheet.3a3a.create.htm">CPropertySheet::Create</a></p>
</font></BODY>
</HTML>
