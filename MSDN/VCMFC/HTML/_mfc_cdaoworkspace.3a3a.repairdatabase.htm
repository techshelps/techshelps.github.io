<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoWorkspace::RepairDatabase</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoworkspace.3a3a.repairdatabase"></a>CDaoWorkspace::RepairDatabase</h1>
<p>
<b>static void PASCAL RepairDatabase( LPCTSTR </b><i>lpszName</i><b> );<br>
throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszName</i></p>
<p class=indent>
The path and filename for an existing Microsoft Jet engine database file. If you omit the path, only the current directory is searched. If your system supports the uniform naming convention (UNC), you can also specify a network path, such as: “\\\\MYSERVER\\MYSHARE\\MYDIR\\MYDB.MDB”. (Double backslashes are required in the path string because “\” is the C++ escape character.)</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function if you need to attempt to repair a corrupted database that accesses the Microsoft Jet database engine. You must close the database specified by <i>lpszName</i> before you repair it. In a multiuser environment, other users cannot have <i>lpszName</i> open while you are repairing it. If <i>lpszName</i> is not closed or is not available for exclusive use, an error occurs.</p>
<p>
This member function attempts to repair a database that was marked as possibly corrupt by an incomplete write operation. This can occur if an application using the Microsoft Jet database engine is closed unexpectedly because of a power outage or computer hardware problem. If you complete the operation and call the <a href="_mfc_cdaodatabase.3a3a.close.htm">Close</a> member function or you quit the application in a usual way, the database will not be marked as possibly corrupt.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;After repairing a database, it is also a good idea to compact it using the <a href="_mfc_cdaoworkspace.3a3a.compactdatabase.htm">CompactDatabase</a> member function to defragment the file and to recover disk space.</p>
<p>
For more information about workspaces, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Workspace">
</object><a href=JavaScript:alink_1.Click()>DAO Workspace</a> in <i>Visual C++ Programmer's Guide</i>. For more information about repairing databases, see the topic "RepairDatabase Method" in DAO Help.</p>
<p>
<a href="_mfc_cdaoworkspace.htm">CDaoWorkspace Overview</a>  |&nbsp; <a href="_mfc_cdaoworkspace_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
</font></BODY>
</HTML>
