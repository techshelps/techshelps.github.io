<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COleDataSource</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_coledatasource"></a>COleDataSource</h1>
<p>
<img src="codatsrc.gif" border=0></p>
<p>
The <b>COleDataSource</b> class acts as a cache into which an application places the data that it will offer during data transfer operations, such as Clipboard or drag-and-drop operations.</p>
<p>
You can create OLE data sources directly. Alternately, the <a href="_mfc_coleclientitem.htm">COleClientItem</a> and <a href="_mfc_coleserveritem.htm">COleServerItem</a> classes create OLE data sources in response to their <b>CopyToClipboard</b> and <b>DoDragDrop</b> member functions. See <a href="_mfc_coleserveritem.3a3a.copytoclipboard.htm">COleServerItem::CopyToClipboard</a> for a brief description. Override the <b>OnGetClipboardData</b> member function of your client item or server item class to add additional Clipboard formats to the data in the OLE data source created for the <b>CopyToClipboard</b> or <b>DoDragDrop</b> member function.</p>
<p>
Whenever you want to prepare data for a transfer, you should create an object of this class and fill it with your data using the most appropriate method for your data. The way it is inserted into a data source is directly affected by whether the data is supplied immediately (immediate rendering) or on demand (delayed rendering). For every Clipboard format in which you are providing data by passing the Clipboard format to be used (and an optional <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_FORMATETC">
</object><a href=JavaScript:alink_1.Click()>FORMATETC</a> structure), call <a href="_mfc_coledatasource.3a3a.delayrenderdata.htm">DelayRenderData</a>.</p>
<p>
For more information about data sources and data transfer, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Data_Objects_and_Data_Sources_.28.OLE.29">
</object><a href=JavaScript:alink_2.Click()>Data Objects and Data Sources (OLE)</a>. In addition, the article <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Clipboard_Topics">
</object><a href=JavaScript:alink_3.Click()>Clipboard Topics</a> describes the OLE Clipboard mechanism. </p>
<p>
<b>#include &lt;afxole.h&gt;</b></p>
<p>
<a href="_mfc_coledatasource_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_ccmdtarget.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Samples</b>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_HIERSVR">
</object><a href=JavaScript:alink_4.Click()>MFC Sample HIERSVR</a>  |&nbsp; <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_OCLIENT">
</object><a href=JavaScript:alink_5.Click()>MFC Sample OCLIENT</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_coledataobject.htm">COleDataObject</a></p>
</font></BODY>
</HTML>
