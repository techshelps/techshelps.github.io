<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COleDateTime::COleDateTime</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_coledatetime.3a3a.coledatetime"></a>COleDateTime::COleDateTime</h1>
<p>
<b>COleDateTime( );</b><br>
<b>COleDateTime( const COleDateTime&amp; </b><i>dateSrc</i><b> );</b><br>
<b>COleDateTime( const VARIANT&amp; </b><i>varSrc</i><b> );</b><br>
<b>COleDateTime( DATE </b><i>dtSrc</i><b> );</b><br>
<b>COleDateTime( time_t </b><i>timeSrc</i><b> );</b><br>
<b>COleDateTime( const SYSTEMTIME&amp; </b><i>systimeSrc</i><b> );</b><br>
<b>COleDateTime( const FILETIME&amp; </b><i>filetimeSrc</i><b> );</b><br>
<b>COleDateTime( int </b><i>nYear</i><b>, int </b><i>nMonth</i><b>, int </b><i>nDay</i><b>, int </b><i>nHour</i><b>, int </b><i>nMin</i><b>, int </b><i>nSec</i><b> );</b><br>
<b>COleDateTime( WORD </b><i>wDosDate</i><b>, WORD </b><i>wDosTime</i><b> );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>dateSrc</i></p>
<p class=indent>
An existing <b>COleDateTime</b> object to be copied into the new <b>COleDateTime</b> object.</p>
<p class=dt>
<i>varSrc</i></p>
<p class=indent>
An existing <b>VARIANT</b> data structure (possibly a <b>COleVariant</b> object) to be converted to a date/time value (<b>VT_DATE</b>) and copied into the new <b>COleDateTime</b> object.</p>
<p class=dt>
<i>dtSrc</i></p>
<p class=indent>
A date/time (<b>DATE</b>) value to be copied into the new <b>COleDateTime</b> object.</p>
<p class=dt>
<i>timeSrc</i></p>
<p class=indent>
A <b>time_t</b> value to be converted to a date/time value and copied into the new <b>COleDateTime</b> object.</p>
<p class=dt>
<i>systimeSrc</i></p>
<p class=indent>
A <b>SYSTEMTIME</b> structure to be converted to a date/time value and copied into the new <b>COleDateTime</b> object.</p>
<p class=dt>
<i>filetimeSrc</i></p>
<p class=indent>
A <b>FILETIME</b> structure to be converted to a date/time value and copied into the new <b>COleDateTime</b> object.</p>
<p class=dt>
<i>nYear</i>, <i>nMonth</i>, <i>nDay</i>, <i>nHour</i>, <i>nMin</i>, <i>nSec</i></p>
<p class=indent>
Indicate the date and time values to be copied into the new <b>COleDateTime</b> object.</p>
<p class=dt>
<i>wDosDate</i>, <i>wDosTime</i></p>
<p class=indent>
MS-DOS date and time values to be converted to a date/time value and copied into the new <b>COleDateTime</b> object.</p>
<p class=label>
<b>Remarks</b></p>
<p>
All of these constructors create new <b>COleDateTime</b> objects initialized to the specified value. The following table shows valid ranges for each date and time component:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>Date/Time Component</b></td>
<td class=label width=67%><b>Valid Range</b></td>
</tr>
<tr valign=top>
<td width=33%>year</td>
<td width=67%>100 – 9999</td>
</tr>
<tr valign=top>
<td width=33%>month</td>
<td width=67%>0 – 12</td>
</tr>
<tr valign=top>
<td width=33%>day</td>
<td width=67%>0 – 31</td>
</tr>
<tr valign=top>
<td width=33%>hour</td>
<td width=67%>0 – 23</td>
</tr>
<tr valign=top>
<td width=33%>minute</td>
<td width=67%>0 – 59</td>
</tr>
<tr valign=top>
<td width=33%>second</td>
<td width=67%>0 – 59</td>
</tr>
</table><br>
<p>
Note that the actual upper bound for the day component varies based on the month and year components. For details, see the <b>SetDate</b> or <b>SetDateTime</b> member functions.</p>
<p>
Following is a brief description of each constructor:
<ul type=disc>
<li>
<b>COleDateTime(</b> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object initialized to 0 (midnight, 30 December 1899).<br><br></li>
<li>
<b>COleDateTime(</b> <i>dateSrc</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object from an existing <b>COleDateTime</b> object.<br><br></li>
<li>
<b>COleDateTime(</b> <i>varSrc</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object. Attempts to convert a <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_oa96_VARIANT_and_VARIANTARG">
</object><a href=JavaScript:alink_1.Click()>VARIANT</a> structure or <a href="_mfc_colevariant.htm">COleVariant</a> object to a date/time (<b>VT_DATE</b>) value. If this conversion is successful, the converted value is copied into the new <b>COleDateTime</b> object. If it is not, the value of the <b>COleDateTime</b> object is set to 0 (midnight, 30 December 1899) and its status to invalid.<br><br></li>
<li>
<b>COleDateTime(</b> <i>dtSrc</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object from a <b>DATE</b> value.<br><br></li>
<li>
<b>COleDateTime(</b> <i>timeSrc</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object from a <b>time_t</b> value.<br><br></li>
<li>
<b>COleDateTime(</b> <i>systimeSrc</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object from a <b>SYSTEMTIME</b> value.<br><br></li>
<li>
<b>COleDateTime(</b> <i>filetimeSrc</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object from a <b>FILETIME</b> value.<br><br></li>
<li>
<b>COleDateTime(</b> <i>nYear</i>, <i>nMonth</i>, <i>nDay</i>, <i>nHour</i>, <i>nMin</i>, <i>nSec</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object from the specified numerical values.<br><br></li>
<li>
<b>COleDateTime(</b> <i>wDosDate</i>, <i>wDosTime</i> <b>)</b>&nbsp;&nbsp;&nbsp;Constructs a <b>COleDateTime</b> object from the specified MS-DOS date and time values.</li>
</ul>
<p>
For more information, see the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_oa96_VARIANT_and_VARIANTARG">
</object><a href=JavaScript:alink_2.Click()>VARIANT</a> entry in the <i>Win32 SDK OLE Programmer's Reference</i>.</p>
<p>
For more information on the <b>time_t</b> data type, see the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_CRT_time">
</object><a href=JavaScript:alink_3.Click()>time</a> function in the <i>Run-Time Library Reference</i>.</p>
<p>
For more information, see the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_SYSTEMTIME_str">
</object><a href=JavaScript:alink_4.Click()>SYSTEMTIME</a> and <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_FILETIME_str">
</object><a href=JavaScript:alink_5.Click()>FILETIME</a> structures in the Win32 SDK documentation.</p>
<p>
For more information on MS-DOS date and time values, see <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_oa96_DosDateTimeToVariantTime">
</object><a href=JavaScript:alink_6.Click()>DosDateTimeToVariantTime</a> in the Win32 SDK documentation.</p>
<p>
For more information about the bounds for <b>COleDateTime</b> values, see the article <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Date_and_Time.3a_.Automation_Support">
</object><a href=JavaScript:alink_7.Click()>Date and Time: Automation Support</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
<a href="_mfc_coledatetime.htm">COleDateTime Overview</a>  |&nbsp; <a href="_mfc_coledatetime_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_coledatetime.3a3a.setdate.htm">COleDateTime::SetDate</a>, <a href="_mfc_coledatetime.3a3a.setdatetime.htm">COleDateTime::SetDateTime</a>, <a href="_mfc_coledatetime.3a3a.settime.htm">COleDateTime::SetTime</a>, <a href="_mfc_coledatetime.3a3a.getstatus.htm">COleDateTime::GetStatus</a>, <a href="_mfc_coledatetime.3a3a.operator_.3d.htm">COleDateTime::operator =</a>, <a href="_mfc_coledatetime.3a3a.m_dt.htm">COleDateTime::m_dt</a>, <a href="_mfc_coledatetime.3a3a.m_status.htm">COleDateTime::m_status</a></p>
</font></BODY>
</HTML>
