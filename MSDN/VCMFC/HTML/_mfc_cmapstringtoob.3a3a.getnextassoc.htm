<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CMapStringToOb::GetNextAssoc</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cmapstringtoob.3a3a.getnextassoc"></a><sup></sup>CMapStringToOb::GetNextAssoc  </h1>
<p>
<b>void</b> <b>GetNextAssoc(</b> <b>POSITION&amp;</b> <i>rNextPosition</i><b>,</b> <b>CString&amp;</b> <i>rKey</i><b>,</b> <b>CObject*&amp;</b> <i>rValue</i> <b>)</b> <b>const;</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>rNextPosition</i></p>
<p class=indent>
Specifies a reference to a <b>POSITION</b> value returned by a previous <b>GetNextAssoc</b> or <b>GetStartPosition</b> call.</p>
<p class=dt>
<i>rKey</i></p>
<p class=indent>
Specifies the returned key of the retrieved element (a string).</p>
<p class=dt>
<i>rValue</i></p>
<p class=indent>
Specifies the returned value of the retrieved element (a <b>CObject</b> pointer). See Remarks for more about this parameter.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Retrieves the map element at <i>rNextPosition</i>, then updates <i>rNextPosition</i> to refer to the next element in the map. This function is most useful for iterating through all the elements in the map. Note that the position sequence is not necessarily the same as the key value sequence. </p>
<p>
If the retrieved element is the last in the map, then the new value of <i>rNextPosition</i> is set to <b>NULL</b>.</p>
<p>
For the <i>rValue</i> parameter, be sure to cast your object type to <b>CObject*&amp;</b>, which is what the compiler requires, as shown in the following example:</p>
<pre><code>CMyObject* ob;
map.GetNextAssoc(pos, key, (CObject*&amp;)ob);
</code></pre>
<p>
This is not true of <b>GetNextAssoc</b> for maps based on templates.</p>
<p class=label>
<b>Example</b></p>
<p>
See <a href="_mfc_coblist.3a3a.coblist.htm">CObList::CObList</a> for a listing of the <code>CAge</code> class used in all collection examples.</p>
<pre><code>// example for CMapStringToOb::GetNextAssoc and CMapStringToOb::GetStartPosition
   CMapStringToOb map;
   POSITION pos;
   CString key;
   CAge* pa;
   
   map.SetAt( "Bart", new CAge( 13 ) );
   map.SetAt( "Lisa", new CAge( 11 ) );
   map.SetAt( "Homer", new CAge( 36 ) );
   map.SetAt( "Marge", new CAge( 35 ) );
   // Iterate through the entire map, dumping both name and age.
   for( pos = map.GetStartPosition(); pos != NULL; )
   {
   map.GetNextAssoc( pos, key, (CObject*&amp;)pa );
#ifdef _DEBUG
      afxDump &lt;&lt; key &lt;&lt; " : " &lt;&lt; pa &lt;&lt; "\n";
#endif
   }
</code></pre>
<p>
The results from this program are as follows:</p>
<pre><code>Lisa : a CAge at $4724 11
Marge : a CAge at $47A8 35
Homer : a CAge at $4766 36
Bart : a CAge at $45D4 13
</code></pre>
<p>
<a href="_mfc_cmapstringtoob.htm">CMapStringToOb Overview</a>  |&nbsp; <a href="_mfc_cmapstringtoob_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cmapstringtoob.3a3a.getstartposition.htm">CMapStringToOb::GetStartPosition</a></p>
</font></BODY>
</HTML>
