<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Changes to Classes and Methods</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcovrchangestoclassesmethods"></a>Changes to ATL Classes</h1>
<h3>New Classes</h3>
<p>
The following classes are new since ATL 2.1:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=31%>Composite Control</td>
<td width=69%><a href="vcrefccomcompositecontrol.htm">CComCompositeControl</a></td>
</tr>
<tr valign=top>
<td width=31%>Connection Points</td>
<td width=69%><a href="vcrefidispeventimpl.htm">IDispEventImpl</a></td>
</tr>
<tr valign=top>
<td width=31%>MMC Snap-In Support</td>
<td width=69%><a href="vcrefcsnapinitemimpl.htm">CSnapInItemImpl</a><p>
<a href="vcrefcsnapinpropertypageimpl.htm">CSnapInPropertyPageImpl</a></p>
</td>
</tr>
<tr valign=top>
<td width=31%>Service Provider Support</td>
<td width=69%><a href="vcrefiserviceproviderimpl.htm">IServiceProviderImpl</a></td>
</tr>
<tr valign=top>
<td width=31%>Windows Support</td>
<td width=69%><a href="vcrefcaxdialogimpl.htm">CAxDialogImpl</a><p>
<a href="vcrefcaxwindow.htm">CAxWindow</a></p>
<p>
<a href="vcrefcsimpledialog.htm">CSimpleDialog</a></p>
<p>
<a href="vcrefcwintraits.htm">CWinTraits</a></p>
<p>
<a href="vcrefcwintraitsor.htm">CWinTraitsOR</a></p>
<p>
<b>CDialogImplBase</b> — see <a href="_atl_cdialogimpl.htm">CDialogImpl</a></p>
</td>
</tr>
</table><br>
<p class=label>
<b>See Also</b></p>
<p>
<a href="_atl_atl_class_overview.htm">ATL Class Overview</a></p>
<h3>Changes to IObjectSafetyImpl</h3>
<p>
See the <b>IObjectSafetyImpl</b> section in <a href="vcovrportingfromatl2.1.htm">Porting from ATL 2.1</a>.</p>
<h3>Classes Moved to Another Header File</h3>
<p>
These classes were moved from Atlctl.h to Atlcom.h, to better group the functionality:</p>
<p>
<a href="_atl_ccomdispatchdriver.htm">CComDispatchDriver</a></p>
<p>
<a href="vcrefidispeventimpl.htm">IDispEventImpl</a></p>
<p>
<a href="_atl_ipersistpropertybagimpl.htm">IPersistPropertyBagImpl</a></p>
<p>
<a href="_atl_ipersiststreaminitimpl.htm">IPersistStreamInitImpl</a></p>
<h3>Changes to CComPtr and CComQIPtr</h3>
<p>
The following methods were added to <a href="_atl_ccomptr.htm">CComPtr</a> and <a href="_atl_ccomqiptr.htm">CComQIPtr</a>, for increased functionality. (The following links go to the <b>CComPtr</b> topics.)
<ul type=disc>
<li>
<a href="vcrefccomptroperator2.htm">operator ==</a><br><br></li>
<li>
<a href="vcrefccomptroperator1.htm">operator &lt;</a><br><br></li>
<li>
<a href="vcrefccomptrisequalobject.htm">IsEqualObject</a><br><br></li>
<li>
<a href="vcrefccomptrattach.htm">Attach</a><br><br></li>
<li>
<a href="vcrefccomptrdetach.htm">Detach</a><br><br></li>
<li>
<a href="vcrefccomptrcopyto.htm">CopyTo</a><br><br></li>
<li>
<a href="vcrefccomptrsetsite.htm">SetSite</a><br><br></li>
<li>
<a href="vcrefccomptradvise.htm">Advise</a><br><br></li>
<li>
<a href="vcrefccomptrcocreateinstance.htm">CoCreateInstance</a><br><br></li>
<li>
<a href="vcrefccomptrqueryinterface.htm">QueryInterface</a></li>
</ul>
<p>
The second template argument to <a href="_atl_ccomqiptr.htm">CComQIPtr</a> now defaults to <b>__uuidof(</b><i>T</i><b>)</b> where <i>T</i> is the first template argument. As a result, in most cases, you no longer must specify the second template parameter. The exception to this rule is for <b>CComQIPtr</b> objects that are of type <b>IUnknown</b>. They must still be declared using the two-template parameter syntax:</p>
<pre><code>CComQIPtr&lt;IUnknown, &amp;IID_IUnknown&gt; spUnk;
</code></pre>
<p>
This limitation is minor, because it is unusual to use a <b>CComQIPtr</b> for holding an <b>IUnknown</b>.</p>
<h3>Changes to CWindow</h3>
<p>
<a href="_atl_cwindow.htm">CWindow</a> has the following new methods:
<ul type=disc>
<li>
<a href="_atl_cwindow.3a3a.sendmessage.htm">CWindow::SendMessage</a><br><br></li>
<li>
<a href="vcrefcwindowresizeclient.htm">CWindow::ResizeClient</a><br><br></li>
<li>
<a href="vcrefcwindowcreate.htm">CWindow::Create</a></li>
</ul>
<h3>Changes to CWindowImpl, CDialogImpl, and CContainedWindow</h3>
<p>
<a href="_atl_cwindowimpl.htm">CWindowImpl</a>, <a href="_atl_cdialogimpl.htm">CDialogImpl</a>, and <a href="_atl_ccontainedwindow.htm">CContainedWindow</a> now do automatic unsubclassing when required.</p>
<p>
These classes also have the following new template arguments:
<ul type=disc>
<li>
Base class (the default is <b>CWindow</b>)<br><br></li>
<li>
Style class (the default is <b>CWinTraits</b>)</li>
</ul>
</font></BODY>
</HTML>
