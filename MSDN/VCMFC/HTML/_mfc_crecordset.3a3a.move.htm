<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CRecordset::Move</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_crecordset.3a3a.move"></a>CRecordset::Move</h1>
<p>
<b>virtual</b> <b>void</b> <b>Move(</b> <b>long</b> <i>nRows</i><b>, WORD</b> <i>wFetchType</i> <b>= SQL_FETCH_RELATIVE );</b><br>
<b>throw(</b> <b>CDBException, CMemoryException</b> <b>);</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nRows</i></p>
<p class=indent>
The number of rows to move forward or backward. Positive values move forward, toward the end of the recordset. Negative values move backward, toward the beginning.</p>
<p class=dt>
<i>wFetchType</i></p>
<p class=indent>
Determines the rowset that <b>Move</b> will fetch. For details, see Remarks.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to move the current record pointer within the recordset, either forward or backward. If you pass a value of 0 for <i>nRows</i>, <b>Move</b> refreshes the current record; <b>Move</b> will end any current <b>AddNew</b> or <b>Edit</b> mode, and will restore the current record's value before <b>AddNew</b> or <b>Edit</b> was called.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When moving through a recordset, deleted records may not be skipped. See the <a href="_mfc_crecordset.3a3a.isdeleted.htm">IsDeleted</a> member function for details.</p>
<p>
<b>Move</b> repositions the recordset by rowsets. Based on the values for <i>nRows</i> and <i>wFetchType</i>, <b>Move</b> fetches the appropriate rowset and then makes the first record in that rowset the current record. If you have not implemented bulk row fetching, then the rowset size is always 1. When fetching a rowset, <b>Move</b> directly calls the <a href="_mfc_crecordset.3a3a.checkrowseterror.htm">CheckRowsetError</a> member function to handle any errors resulting from the fetch.</p>
<p>
Depending on the values you pass, <b>Move</b> is equivalent to other <b>CRecordset</b> member functions. In particular, the value of <i>wFetchType</i> may indicate a member function that is more intuitive and often the preferred method for moving the current record.</p>
<p>
The following table lists the possible values for <i>wFetchType</i>, the rowset that <b>Move</b> will fetch based on <i>wFetchType</i> and <i>nRows</i>, and any equivalent member function corresponding to <i>wFetchType</i>.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>wFetchType</b></td>
<td class=label width=31%><b>Fetched rowset</b></td>
<td class=label width=31%><b>Equivalent member function</b></td>
</tr>
<tr valign=top>
<td width=38%><b>SQL_FETCH_RELATIVE</b> (the default value)</td>
<td width=31%>The rowset starting <i>nRows</i> row(s) from the first row in the current rowset.</td>
<td width=31%></td>
</tr>
<tr valign=top>
<td width=38%><b>SQL_FETCH_NEXT</b></td>
<td width=31%>The next rowset; <i>nRows</i> is ignored.</td>
<td width=31%><a href="_mfc_crecordset.3a3a.movenext.htm">MoveNext</a></td>
</tr>
<tr valign=top>
<td width=38%><b>SQL_FETCH_PRIOR</b></td>
<td width=31%>The previous rowset; <i>nRows</i> is ignored.</td>
<td width=31%><a href="_mfc_crecordset.3a3a.moveprev.htm">MovePrev</a></td>
</tr>
<tr valign=top>
<td width=38%><b>SQL_FETCH_FIRST</b></td>
<td width=31%>The first rowset in the recordset; <i>nRows</i> is ignored.</td>
<td width=31%><a href="_mfc_crecordset.3a3a.movefirst.htm">MoveFirst</a></td>
</tr>
<tr valign=top>
<td width=38%><b>SQL_FETCH_LAST</b></td>
<td width=31%>The last complete rowset in the recordset; <i>nRows</i> is ignored.</td>
<td width=31%><a href="_mfc_crecordset.3a3a.movelast.htm">MoveLast</a></td>
</tr>
<tr valign=top>
<td width=38%><b>SQL_FETCH_ABSOLUTE</b></td>
<td width=31%>If <i>nRows</i> &gt; 0, the rowset starting <i>nRows</i> row(s) from the beginning of the recordset. If <i>nRows</i> &lt; 0, the rowset starting <i>nRows</i> row(s) from the end of the recordset. If <i>nRows</i> = 0, then a beginning-of-file (BOF) condition is returned.</td>
<td width=31%><a href="_mfc_crecordset.3a3a.setabsoluteposition.htm">SetAbsolutePosition</a></td>
</tr>
<tr valign=top>
<td width=38%><b>SQL_FETCH_BOOKMARK</b></td>
<td width=31%>The rowset starting at the row whose bookmark value corresponds to <i>nRows</i>.</td>
<td width=31%><a href="_mfc_crecordset.3a3a.setbookmark.htm">SetBookmark</a></td>
</tr>
</table><br>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;For foward-only recordsets, <b>Move</b> is only valid with a value of <b>SQL_FETCH_NEXT</b> for <i>wFetchType</i>.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;Calling <b>Move</b> throws an exception if the recordset has no records. To determine whether the recordset has any records, call <a href="_mfc_crecordset.3a3a.isbof.htm">IsBOF</a> and <a href="_mfc_crecordset.3a3a.iseof.htm">IsEOF</a>.</p>
<p class=indent>
If you have scrolled past the beginning or end of the recordset (<b>IsBOF</b> or <b>IsEOF</b> returns nonzero), calling a <b>Move</b> function will possibly throw a <b>CDBException</b>. For example, if <b>IsEOF</b> returns nonzero and <b>IsBOF</b> does not, then <b>MoveNext</b> will throw an exception, but <b>MovePrev</b> will not.</p>
<p class=indent>
If you call <b>Move</b> while the current record is being updated or added, the updates are lost without warning.</p>
<p>
For more information about recordset navigation, see the articles <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Scrolling_.28.ODBC.29">
</object><a href=JavaScript:alink_1.Click()>Recordset: Scrolling (ODBC)</a> and <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Bookmarks_and_Absolute_Positions_.28.ODBC.29">
</object><a href=JavaScript:alink_2.Click()>Recordset: Bookmarks and Absolute Positions (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>. For more information about bulk row fetching, see the article <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Fetching_Records_in_Bulk_.28.ODBC.29">
</object><a href=JavaScript:alink_3.Click()>Recordset: Fetching Records in Bulk (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>. For related information, see the ODBC API function <b>SQLExtendedFetch</b> in the <i>ODBC SDK Programmer's Reference</i>.</p>
<p class=label>
<b>Example</b></p>
<pre><code>// rs is a CRecordset or a 
// CRecordset-derived object

// Change the rowset size to 5
rs.SetRowsetSize( 5 );

// Move to the first record
// in the recordset
rs.MoveFirst( );

// Move to the sixth record
rs.Move( 5 );
// Other equivalent ways to
// move to the sixth record:
// rs.Move( 6, SQL_FETCH_ABSOLUTE );
// rs.SetAbsolutePosition( 6 );
// In this case, the sixth record is
// the first record in the next rowset,
// so the following are also equivalent:
// rs.Move( 1, SQL_FETCH_NEXT );
// rs.MoveNext( );
</code></pre>
<p>
<a href="_mfc_crecordset.htm">CRecordset Overview</a>  |&nbsp; <a href="_mfc_crecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_crecordset.3a3a.movenext.htm">CRecordset::MoveNext</a>, <a href="_mfc_crecordset.3a3a.moveprev.htm">CRecordset::MovePrev</a>, <a href="_mfc_crecordset.3a3a.movefirst.htm">CRecordset::MoveFirst</a>, <a href="_mfc_crecordset.3a3a.movelast.htm">CRecordset::MoveLast</a>, <a href="_mfc_crecordset.3a3a.setabsoluteposition.htm">CRecordset::SetAbsolutePosition</a>, <a href="_mfc_crecordset.3a3a.setbookmark.htm">CRecordset::SetBookmark</a>, <a href="_mfc_crecordset.3a3a.isbof.htm">CRecordset::IsBOF</a>, <a href="_mfc_crecordset.3a3a.iseof.htm">CRecordset::IsEOF</a>, <a href="_mfc_crecordset.3a3a.checkrowseterror.htm">CRecordset::CheckRowsetError</a></p>
</font></BODY>
</HTML>
