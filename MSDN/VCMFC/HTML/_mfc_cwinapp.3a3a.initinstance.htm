<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CWinApp::InitInstance</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cwinapp.3a3a.initinstance"></a><sup></sup>CWinApp::InitInstance  </h1>
<p>
<b>virtual</b> <b>BOOL</b> <b>InitInstance(</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if initialization is successful; otherwise 0.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Windows allows several copies of the same program to run at the same time. Application initialization is conceptually divided into two sections: one-time application initialization that is done the first time the program runs, and instance initialization that runs each time a copy of the program runs, including the first time. The framework’s implementation of <b>WinMain</b> calls this function.</p>
<p>
Override <b>InitInstance</b> to initialize each new instance of your application running under Windows. Typically, you override <b>InitInstance</b> to construct your main window object and set the <b>CWinThread::m_pMainWnd</b> data member to point to that window. For more information on overriding this member function, see <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_CWinApp.3a_.The_Application_Class">
</object><a href=JavaScript:alink_1.Click()>CWinApp: The Application Class</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p class=label>
<b>Example</b></p>
<pre><code>// AppWizard implements the InitInstance overridable function 
// according to options you select.&nbsp; For example, the single document
// interface (SDI) option was chosen for the AppWizard code created
// below. You can add other per-instance initializations to the code
// created by AppWizard.

BOOL CMyApp::InitInstance()
{
 &nbsp; // Standard initialization
 &nbsp; // If you are not using these features and wish to reduce the size
 &nbsp; //&nbsp; of your final executable, you should remove from the following
 &nbsp; //&nbsp; the specific initialization routines you do not need.

 &nbsp; SetDialogBkColor();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Set dialog background color to gray
 &nbsp; LoadStdProfileSettings();&nbsp; // Load standard INI file options (including MRU)

 &nbsp; // Register the application's document templates.&nbsp; Document templates
 &nbsp; //&nbsp; serve as the connection between documents, frame windows and views.

 &nbsp; CSingleDocTemplate* pDocTemplate;
 &nbsp; pDocTemplate = new CSingleDocTemplate(
 &nbsp;&nbsp;&nbsp;&nbsp; IDR_MAINFRAME,
 &nbsp;&nbsp;&nbsp;&nbsp; RUNTIME_CLASS(CMyDoc),
 &nbsp;&nbsp;&nbsp;&nbsp; RUNTIME_CLASS(CMainFrame),&nbsp;&nbsp;&nbsp;&nbsp; // main SDI frame window
 &nbsp;&nbsp;&nbsp;&nbsp; RUNTIME_CLASS(CMyView));
 &nbsp; AddDocTemplate(pDocTemplate);

 &nbsp; // create a new (empty) document
 &nbsp; OnFileNew();

 &nbsp; if (m_lpCmdLine[0] != '\0')
 &nbsp; {
 &nbsp;&nbsp;&nbsp;&nbsp; // TODO: add command line processing here
 &nbsp; }

 &nbsp; return TRUE;
}


</code></pre>
<p>
<a href="_mfc_cwinapp.htm">CWinApp Overview</a>  |&nbsp; <a href="_mfc_cwinapp_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
</font></BODY>
</HTML>
