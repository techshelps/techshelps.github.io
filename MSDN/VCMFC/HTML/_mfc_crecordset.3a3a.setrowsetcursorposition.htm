<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CRecordset::SetRowsetCursorPosition</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_crecordset.3a3a.setrowsetcursorposition"></a>CRecordset::SetRowsetCursorPosition</h1>
<p>
<b>void SetRowsetCursorPosition( WORD</b> <i>wRow</i>, <b>WORD </b><i>wLockType</i><b> = SQL_LOCK_NO_CHANGE );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>wRow</i></p>
<p class=indent>
The one-based position of a row in the current rowset. This value can range from 1 to the size of the rowset.</p>
<p class=dt>
<i>wLockType</i></p>
<p class=indent>
Value indicating how to lock the row after it has been refreshed. For details, see Remarks.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to move the cursor to a row within the current rowset. When implementing bulk row fetching, records are retrieved by rowsets, where the first record in the fetched rowset is the current record. In order to make another record within the rowset the current record, call <b>SetRowsetCursorPosition</b>. For example, you can combine <b>SetRowsetCursorPosition</b> with the <a href="_mfc_crecordset.3a3a.getfieldvalue.htm">GetFieldValue</a> member function to dynamically retrieve the data from any record of your recordset.</p>
<p>
To use <b>SetRowsetCursorPosition</b>, you must have implemented bulk row fetching by specifying the <b>CRecordset::useMultiRowFetch</b> option of the <i>dwOptions</i> parameter in the <a href="_mfc_crecordset.3a3a.open.htm">Open</a> member function.</p>
<p>
<b>SetRowsetCursorPosition</b> calls the ODBC API function <b>SQLSetPos</b>. The <i>wLockType</i> parameter specifies the lock state of the row after <b>SQLSetPos</b> has executed. The following table describes the possible values for <i>wLockTyp</i>e.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=42%><b>wLockType</b></td>
<td class=label width=58%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=42%><b>SQL_LOCK_NO_CHANGE</b> (the default value)</td>
<td width=58%>The driver or data source ensures that the row is in the same locked or unlocked state as it was before <b>SetRowsetCursorPosition</b> was called.</td>
</tr>
<tr valign=top>
<td width=42%><b>SQL_LOCK_EXCLUSIVE</b></td>
<td width=58%>The driver or data source locks the row exclusively. Not all data sources support this type of lock.</td>
</tr>
<tr valign=top>
<td width=42%><b>SQL_LOCK_UNLOCK</b></td>
<td width=58%>The driver or data source unlocks the row. Not all data sources support this type of lock.</td>
</tr>
</table><br>
<p>
For more information about <b>SQLSetPos</b>, see the <i>ODBC SDK Programmer's Reference</i>. For more information about bulk row fetching, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Fetching_Records_in_Bulk_.28.ODBC.29">
</object><a href=JavaScript:alink_1.Click()>Recordset: Fetching Records in Bulk (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
<a href="_mfc_crecordset.htm">CRecordset Overview</a>  |&nbsp; <a href="_mfc_crecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_crecordset.3a3a.refreshrowset.htm">CRecordset::RefreshRowset</a>, <a href="_mfc_crecordset.3a3a.setrowsetsize.htm">CRecordset::SetRowsetSize</a></p>
</font></BODY>
</HTML>
