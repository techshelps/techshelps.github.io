<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CAsyncSocket::Receive</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_casyncsocket.3a3a.receive"></a><sup></sup>CAsyncSocket::Receive</h1>
<p>
<b>virtual</b> <b>int</b> <b>Receive(</b> <b>void*</b> <i>lpBuf</i><b>,</b> <b>int</b> <i>nBufLen</i><b>,</b> <b>int</b> <i>nFlags</i> <b>=</b> <b>0</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
If no error occurs, <b>Receive</b> returns the number of bytes received. If the connection has been closed, it returns 0. Otherwise, a value of <b>SOCKET_ERROR</b> is returned, and a specific error code can be retrieved by calling <a href="_mfc_casyncsocket.3a3a.getlasterror.htm">GetLastError</a>. The following errors apply to this member function:
<ul type=disc>
<li>
<b>WSANOTINITIALISED</b>&nbsp;&nbsp;&nbsp;A successful <a href="_mfc_afxsocketinit.htm">AfxSocketInit</a> must occur before using this API.<br><br></li>
<li>
<b>WSAENETDOWN</b>&nbsp;&nbsp;&nbsp;The Windows Sockets implementation detected that the network subsystem failed.<br><br></li>
<li>
<b>WSAENOTCONN</b>&nbsp;&nbsp;&nbsp;The socket is not connected.<br><br></li>
<li>
<b>WSAEINPROGRESS</b>&nbsp;&nbsp;&nbsp;A blocking Windows Sockets operation is in progress.<br><br></li>
<li>
<b>WSAENOTSOCK</b>&nbsp;&nbsp;&nbsp;The descriptor is not a socket.<br><br></li>
<li>
<b>WSAEOPNOTSUPP</b>&nbsp;&nbsp;&nbsp;<b>MSG_OOB</b> was specified, but the socket is not of type <b>SOCK_STREAM</b>.<br><br></li>
<li>
<b>WSAESHUTDOWN</b>&nbsp;&nbsp;&nbsp;The socket has been shut down; it is not possible to call <b>Receive</b> on a socket after <b>ShutDown</b> has been invoked with <i>nHow</i> set to 0 or 2.<br><br></li>
<li>
<b>WSAEWOULDBLOCK</b>&nbsp;&nbsp;&nbsp;The socket is marked as nonblocking and the <b>Receive</b> operation would block.<br><br></li>
<li>
<b>WSAEMSGSIZE</b>&nbsp;&nbsp;&nbsp;The datagram was too large to fit into the specified buffer and was truncated.<br><br></li>
<li>
<b>WSAEINVAL</b>&nbsp;&nbsp;&nbsp;The socket has not been bound with <b>Bind</b>.<br><br></li>
<li>
<b>WSAECONNABORTED</b>&nbsp;&nbsp;&nbsp;The virtual circuit was aborted due to timeout or other failure.<br><br></li>
<li>
<b>WSAECONNRESET</b>&nbsp;&nbsp;&nbsp;The virtual circuit was reset by the remote side.</li>
</ul>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpBuf</i></p>
<p class=indent>
A buffer for the incoming data.</p>
<p class=dt>
<i>nBufLen</i></p>
<p class=indent>
The length of <i>lpBuf</i> in bytes.</p>
<p class=dt>
<i>nFlags</i></p>
<p class=indent>
Specifies the way in which the call is made. The semantics of this function are determined by the socket options and the <i>nFlags</i> parameter. The latter is constructed by combining any of the following values with the C++ <b>OR</b> operator:
<ul type=disc>
<li>
<b>MSG_PEEK</b>&nbsp;&nbsp;&nbsp;Peek at the incoming data. The data is copied into the buffer but is not removed from the input queue.<br><br></li>
<li>
<b>MSG_OOB</b>&nbsp;&nbsp;&nbsp;Process out-of-band data (see <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_Windows_Sockets_Programming_Considerations_2">
</object><a href=JavaScript:alink_1.Click()>Windows Sockets Programming Considerations</a> in the Win32 SDK documentation for a discussion of this topic).</li>
</ul>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to receive data from a socket. This function is used for connected stream or datagram sockets and is used to read incoming data. </p>
<p>
For sockets of type <b>SOCK_STREAM</b>, as much information as is currently available up to the size of the buffer supplied is returned. If the socket has been configured for in-line reception of out-of-band data (socket option <b>SO_OOBINLINE</b>) and out-of-band data is unread, only out-of-band data will be returned. The application can use the <b>IOCtl</b> <b>SIOCATMARK</b> option or <a href="_mfc_casyncsocket.3a3a.onoutofbanddata.htm">OnOutOfBandData</a> to determine whether any more out-of-band data remains to be read. </p>
<p>
For datagram sockets, data is extracted from the first enqueued datagram, up to the size of the buffer supplied. If the datagram is larger than the buffer supplied, the buffer is filled with the first part of the datagram, the excess data is lost, and <b>Receive</b> returns a value of <b>SOCKET_ERROR</b> with the error code set to <b>WSAEMSGSIZE</b>. If no incoming data is available at the socket, a value of <b>SOCKET_ERROR</b> is returned with the error code set to <b>WSAEWOULDBLOCK</b>. The <a href="_mfc_casyncsocket.3a3a.onreceive.htm">OnReceive</a> callback function can be used to determine when more data arrives. </p>
<p>
If the socket is of type <b>SOCK_STREAM</b> and the remote side has shut down the connection gracefully, a <b>Receive</b> will complete immediately with 0 bytes received. If the connection has been reset, a <b>Receive</b> will fail with the error <b>WSAECONNRESET</b>. </p>
<p>
<a href="_mfc_casyncsocket.htm">CAsyncSocket Overview</a>  |&nbsp; <a href="_mfc_casyncsocket_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_casyncsocket.3a3a.asyncselect.htm">CAsyncSocket::AsyncSelect</a>, <a href="_mfc_casyncsocket.3a3a.create.htm">CAsyncSocket::Create</a>, <a href="_mfc_casyncsocket.3a3a.receivefrom.htm">CAsyncSocket::ReceiveFrom</a>, <a href="_mfc_casyncsocket.3a3a.send.htm">CAsyncSocket::Send</a></p>
</font></BODY>
</HTML>
