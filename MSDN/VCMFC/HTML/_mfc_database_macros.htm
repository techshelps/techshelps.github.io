<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Database Macros and Globals</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_database_macros"></a>Database Macros and Globals</h1>
<p>
The macros and globals listed below apply to ODBC-based database applications. They are not used with DAO-based applications.</p>
<p>
Prior to MFC 4.2, the macros <b>AFX_SQL_ASYNC</b> and <b>AFX_SQL_SYNC</b> gave asynchronous operations an opportunity to yield time to other processes. Beginning with MFC 4.2, the implementation of these macros changed because the MFC ODBC classes used only synchronous operations. The macro <b>AFX_ODBC_CALL</b> was new to MFC 4.2.</p>
<p class=label>
<b>Database Macros</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=28%><a href="_mfc_afx_odbc_call.htm">AFX_ODBC_CALL</a></td>
<td width=72%>Use this macro to call an ODBC API function that returns <b>SQL_STILL_EXECUTING</b>. <b>AFX_ODBC_CALL</b> will repeatedly call the function until it no longer returns <b>SQL_STILL_EXECUTING</b>.</td>
</tr>
<tr valign=top>
<td width=28%><a href="_mfc_afx_sql_async.htm">AFX_SQL_ASYNC</a></td>
<td width=72%>Simply calls <b>AFX_ODBC_CALL</b>.</td>
</tr>
<tr valign=top>
<td width=28%><a href="_mfc_afx_sql_sync.htm">AFX_SQL_SYNC</a></td>
<td width=72%>Use this macro to calls an ODBC API function that does not return <b>SQL_STILL_EXECUTING</b>.</td>
</tr>
</table><br>
<p class=label>
<b>Database Globals</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=28%><a href="vcrefafxgethenv.htm">AfxGetHENV</a></td>
<td width=72%>Use this global to retrieve a handle to the ODBC environment currently in use by MFC. You can use this handle in direct ODBC calls.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
