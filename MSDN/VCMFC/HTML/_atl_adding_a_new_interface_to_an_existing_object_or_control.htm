<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a New Interface to an Existing Object or Control</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_atl_adding_a_new_interface_to_an_existing_object_or_control"></a>Adding a New Interface to an Existing Object or Control</h1>
<p>
When you add an interface to your object or control, you create stubbed-out functions for each method in that interface. In your object or control, you can only add interfaces currently found in an existing type library. Also, the class in which you add the interface must implement the BEGIN_COM_MAP macro.</p>
<p>
There are two ways to add a new interface to your control or object: manually and via ClassView.</p>
<p class=label>
<b>To add a new interface manually</b>
<ol>
<li>
Add the definition of your new interface to the IDL file. <br><br></li>
<li>
Derive your object or control from the interface. <br><br></li>
<li>
Create a new <a href="_atl_com_interface_entry.htm">COM_INTERFACE_ENTRY</a> for the interface. <br><br></li>
<li>
Implement methods on the interface. </li>
</ol>
<p class=label>
<b>To use ClassView to add an interface to an existing object or control</b>
<ol>
<li>
Make sure that your workspace is visible by selecting <b>Workspace</b> from the <b>View</b> menu.<br><br></li>
<li>
In the Workspace, select the <b>ClassView</b> tab.<br><br></li>
<li>
Right-click on the class name of a control, for example, a full control or composite control, or any other control class that implements a BEGIN_COM_MAP macro in its header file. You will see a pop-up menu with the <b>Implement Interface...</b> option.<br><br></li>
<li>
Select the <b>Implement Interface...</b> option to display the <b>Implement Interface</b> dialog box.<br><br></li>
<li>
If there is a new interface in your project’s type library, you will see the interface displayed in the <b>Interfaces</b> list.&nbsp; You can also click <b>AddTypelib...</b> and select one or more type libraries from the <b>Browse Type Libraries</b> dialog box.<br><br></li>
<li>
Select interfaces from the available type libraries in the <b>Implement Interface</b> dialog box and click <b>OK</b>. This process adds a TLH file to your project directory for each object in which you selected one or more interfaces.</li>
</ol>
</font></BODY>
</HTML>
