<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Do I Use Multiple Accessors?</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcrefhowdoiusemultipleaccessors"></a>How Do I Use Multiple Accessors?</h1>
<p>
Accessors are normally created using the <b>BEGIN_COLUMN_MAP</b> and <b>END_COLUMN_MAP</b> macros. This ensures that <b>MoveNext</b> will retrieve data for all specified columns automatically. In some instances, you may not want to retrieve all the columns on every move (for example, if one of the columns contains a large graphic). In that case, you can place one particular column in a separate accessor and make that a nonautomatic accessor, as shown below. When you call <b>MoveNext</b>, this code retrieves only the Product ID automatically. If you need the long name, you must call <b>GetData</b> explicitly, passing the accessor number (1, in this case) to retrieve the data.</p>
<pre><code>class CProduct
{
public:
   long      nProductID;
   char      szVeryLongName[2048];

   BEGIN_ACCESSOR_MAP(CProduct, 2)   // Pass number of accessors
      BEGIN_ACCESSOR(0, true)         // true = an auto accessor
         COLUMN_ENTRY(1, nProductID)
      END_ACCESSOR()
      BEGIN_ACCESSOR(1, false)&nbsp;&nbsp;&nbsp;    // false = not an autoaccessor
         COLUMN_ENTRY(2, szVeryLongName)
      END_ACCESSOR()
   END_ACCESSOR_MAP()
};</code></pre>
</font></BODY>
</HTML>
