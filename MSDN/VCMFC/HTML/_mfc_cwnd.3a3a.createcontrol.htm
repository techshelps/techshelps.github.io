<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CWnd::CreateControl</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cwnd.3a3a.createcontrol"></a>CWnd::CreateControl</h1>
<p>
<b>BOOL CWnd::CreateControl( LPCTSTR </b><i>lpszClass</i><b>, LPCTSTR </b><i>lpszWindowName</i><b>, DWORD </b><i>dwStyle</i><b>, const RECT&amp; </b><i>rect</i><b>, CWnd* </b><i>pParentWnd</i><b>, UINT </b><i>nID</i><b>, CFile* </b><i>pPersist</i><b> = NULL, BOOL </b><i>bStorage</i><b> = FALSE, BSTR </b><i>bstrLicKey</i><b> = NULL );</b></p>
<p>
<b>BOOL CWnd::CreateControl( REFCLSID </b><i>clsid</i><b>, LPCTSTR </b><i>lpszWindowName</i><b>, DWORD </b><i>dwStyle</i><b>, const RECT&amp; </b><i>rect</i><b>, CWnd* </b><i>pParentWnd</i><b>, UINT </b><i>nID</i><b>, CFile* </b><i>pPersist</i><b> = NULL, BOOL </b><i>bStorage</i><b> = FALSE, BSTR </b><i>bstrLicKey</i><b> = NULL );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if successful; otherwise 0.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszClass</i></p>
<p class=indent>
This string may contain the OLE "short name" (ProgID) for the class, e.g., "CIRC3.Circ3Ctrl.1". The name needs to match the same name registered by the control. Alternatively, the string may contain the string form of a <b>CLSID</b>, contained in braces, e.g., "{9DBAFCCF-592F-101B-85CE-00608CEC297B}". In either case, <b>CreateControl</b> converts the string to the corresponding class ID.</p>
<p class=dt>
<i>lpszWindowName</i></p>
<p class=indent>
A pointer to the text to be displayed in the control. Sets the value of the control's Caption or Text property (if any). If <b>NULL</b>, the control's Caption or Text property is not changed.</p>
<p class=dt>
<i>dwStyle</i></p>
<p class=indent>
Windows styles. The available styles are listed under Remarks.</p>
<p class=dt>
<i>rect</i></p>
<p class=indent>
Specifies the control’s size and position. It can be either a <a href="_mfc_crect.htm">CRect</a> object or a <a href="_mfc_rect_structure.htm">RECT</a> structure.</p>
<p class=dt>
<i>pParentWnd</i></p>
<p class=indent>
Specifies the control’s parent window. It must not be <b>NULL</b>.</p>
<p class=dt>
<i>nID</i></p>
<p class=indent>
Specifies the control’s ID.</p>
<p class=dt>
<i>pPersist</i></p>
<p class=indent>
A pointer to a <a href="_mfc_cfile.htm">CFile</a> containing the persistent state for the control. The default value is <b>NULL</b>, indicating that the control initializes itself without restoring its state from any persistent storage. If not <b>NULL</b>, it should be a pointer to a <b>CFile</b>-derived object which contains the control’s persistent data, in the form of either a stream or a storage. This data could have been saved in a previous activation of the client. The <b>CFile</b> can contain other data, but must have its read-write pointer set to the first byte of persistent data at the time of the call to <b>CreateControl</b>.</p>
<p class=dt>
<i>bStorage</i></p>
<p class=indent>
Indicates whether the data in <i>pPersist</i> should be interpreted as IStorage or IStream data. If the data in <i>pPersist</i> is a storage, <i>bStorage</i> should be <b>TRUE</b>. If the data in <i>pPersist</i> is a stream, <i>bStorage</i> should be <b>FALSE</b>. The default value is <b>FALSE</b>.</p>
<p class=dt>
<i>bstrLicKe</i>y</p>
<p class=indent>
Optional license key data. This data is needed only for creating controls that require a run-time license key. If the control supports licensing, you must provide a license key for the creation of the control to succeed. The default value is <b>NULL</b>.</p>
<p class=dt>
<i>clsid</i></p>
<p class=indent>
The unique class ID of the control.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Use this member function to create an OLE control that will be represented in the MFC program by a <b>CWnd</b> object. <b>CreateControl</b> is a direct analog of the <a href="_mfc_cwnd.3a3a.create.htm">CWnd::Create</a> function, which creates the window for a <b>CWnd</b>. <b>CreateControl</b> creates an OLE control instead of an ordinary window.</p>
<p>
Only a subset of the Windows <i>dwStyle</i> flags are supported for <b>CreateControl</b>:
<ul type=disc>
<li>
<b>WS_VISIBLE</b>&nbsp;&nbsp;&nbsp;Creates a window that is initially visible. Required if you want the control to be visible immediately, like ordinary windows.<br><br></li>
<li>
<b>WS_DISABLED</b>&nbsp;&nbsp;&nbsp;Creates a window that is initially disabled. A disabled window cannot receive input from the user. Can be set if the control has an Enabled property.<br><br></li>
<li>
<b>WS_BORDER</b>&nbsp;&nbsp;&nbsp;Creates a window with a thin-line border. Can be set if control has a BorderStyle property.<br><br></li>
<li>
<b>WS_GROUP</b>&nbsp;&nbsp;&nbsp;Specifies the first control of a group of controls. The user can change the keyboard focus from one control in the group to the next by using the direction keys. All controls defined with the <b>WS_GROUP</b> style after the first control belong to the same group. The next control with the <b>WS_GROUP</b> style ends the group and starts the next group.<br><br></li>
<li>
<b>WS_TABSTOP</b>&nbsp;&nbsp;&nbsp;Specifies a control that can receive the keyboard focus when the user presses the TAB key. Pressing the TAB key changes the keyboard focus to the next control of the <b>WS_TABSTOP</b> style.</li>
</ul>
<p>
<a href="_mfc_cwnd.htm">CWnd Overview</a>  |&nbsp; <a href="_mfc_cwnd_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;In <i>Visual C++ Programmer’s Guide</i>: <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_ActiveX_Control_Topics">
</object><a href=JavaScript:alink_1.Click()>ActiveX Control Topics</a></p>
</font></BODY>
</HTML>
