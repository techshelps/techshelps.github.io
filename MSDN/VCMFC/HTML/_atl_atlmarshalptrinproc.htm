<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AtlMarshalPtrInProc</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_atl_atlmarshalptrinproc"></a>AtlMarshalPtrInProc</h1>
<p>
<b>HRESULT</b> <b>AtlMarshalPtrInProc( IUnknown*</b> <i>pUnk</i><b>,</b> <b>const</b> <b>IID&amp;</b> <i>iid</i><b>,</b> <b>IStream**</b> <i>ppStream</i><b> );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
A standard <b>HRESULT</b> value.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pUnk</i></p>
<p class=indent>
[in] A pointer to the interface to be marshaled.</p>
<p class=dt>
<i>iid</i></p>
<p class=indent>
[in] The GUID of the interface being marshaled.</p>
<p class=dt>
<i>ppStream</i></p>
<p class=indent>
[out] A pointer to the <b>IStream</b> interface on the new stream object used for marshaling.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Creates a new stream object, writes the CLSID of the proxy to the stream, and marshals the specified interface pointer by writing the data needed to initialize the proxy into the stream. The <b>MSHLFLAGS_TABLESTRONG</b> flag is set so the pointer can be marshaled to multiple streams. The pointer can also be unmarshaled multiple times. </p>
<p>
If marshaling fails, the stream pointer is released.</p>
<p>
<b>AtlMarshalPtrInProc</b> can only be used on a pointer to an in-process object. </p>
<p>
<a href="_atl_atl_macros_and_global_functions.htm">ATL Macros and Global Functions</a></p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="_atl_atlunmarshalptr.htm">AtlUnmarshalPtr</a>, <a href="_atl_atlfreemarshalstream.htm">AtlFreeMarshalStream</a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_MSHLFLAGS">
</object><a href=JavaScript:alink_1.Click()>MSHLFLAGS</a> in the <i>Win32 SDK</i> </p>
</font></BODY>
</HTML>
