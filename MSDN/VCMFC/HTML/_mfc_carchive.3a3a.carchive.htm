<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CArchive::CArchive</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_carchive.3a3a.carchive"></a>CArchive::CArchive</h1>
<p>
<b>CArchive(</b> <b>CFile*</b> <i>pFile</i><b>,</b> <b>UINT</b> <i>nMode</i><b>,</b> <b>int</b> <i>nBufSize</i> <b>=</b> <b>4096,</b> <b>void*</b> <i>lpBuf</i> <b>=</b> <b>NULL</b> <b>);<br>
throw(</b> <b>CMemoryException,</b> <b>CArchiveException,</b> <b>CFileException</b> <b>);</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pFile</i></p>
<p class=indent>
A pointer to the <b>CFile</b> object that is the ultimate source or destination of the persistent data.</p>
<p class=dt>
<i>nMode</i></p>
<p class=indent>
A flag that specifies whether objects will be loaded from or stored to the archive. The <i>nMode</i> parameter must have one of the following values:
<ul type=disc>
<li>
<b>CArchive::load</b>&nbsp;&nbsp;&nbsp;Loads data from the archive. Requires only <b>CFile</b> read permission.<br><br></li>
<li>
<b>CArchive::store</b>&nbsp;&nbsp;&nbsp;Saves data to the archive. Requires <b>CFile</b> write permission.<br><br></li>
<li>
<b>CArchive::bNoFlushOnDelete</b>&nbsp;&nbsp;&nbsp;Prevents the archive from automatically calling <b>Flush</b> when the archive destructor is called. If you set this flag, you are responsible for explicitly calling <b>Close</b> before the destructor is called. If you do not, your data will be corrupted.</li>
</ul>
<p class=dt>
<i>nBufSize</i></p>
<p class=indent>
An integer that specifies the size of the internal file buffer, in bytes. Note that the default buffer size is 4096 bytes. If you routinely archive large objects, you will improve performance if you use a larger buffer size that is a multiple of the file buffer size. </p>
<p class=dt>
<i>lpBuf</i></p>
<p class=indent>
An optional pointer to a user-supplied buffer of size <i>nBufSize</i>. If you do not specify this parameter, the archive allocates a buffer from the local heap and frees it when the object is destroyed. The archive does not free a user-supplied buffer.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Constructs a <b>CArchive</b> object and specifies whether it will be used for loading or storing objects. You cannot change this specification after you have created the archive. </p>
<p>
You may not use <b>CFile</b> operations to alter the state of the file until you have closed the archive. Any such operation will damage the integrity of the archive. You may access the position of the file pointer at any time during serialization by obtaining the archive’s file object from the <a href="_mfc_carchive.3a3a.getfile.htm">GetFile</a> member function and then using the <a href="_mfc_cfile.3a3a.getposition.htm">CFile::GetPosition</a> function. You should call <a href="_mfc_carchive.3a3a.flush.htm">CArchive::Flush</a> before obtaining the position of the file pointer.</p>
<p class=label>
<b>Example</b></p>
<pre><code>extern char* pFileName;
CFile f;
char buf[512];
if( !f.Open( pFileName, CFile::modeCreate | CFile::modeWrite ) ) {
 &nbsp; #ifdef _DEBUG
 &nbsp;&nbsp;&nbsp;&nbsp; afxDump &lt;&lt; "Unable to open file" &lt;&lt; "\n";
 &nbsp;&nbsp;&nbsp;&nbsp; exit( 1 );
 &nbsp; #endif
}
CArchive ar( &amp;f, CArchive::store, 512, buf );</code></pre>
<p>
<a href="_mfc_carchive.htm">CArchive Overview</a>  |&nbsp; <a href="_mfc_carchive_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_carchive.3a3a.close.htm">CArchive::Close</a>, <a href="_mfc_carchive.3a3a.flush.htm">CArchive::Flush</a>, <a href="_mfc_cfile.3a3a.close.htm">CFile::Close</a></p>
</font></BODY>
</HTML>
