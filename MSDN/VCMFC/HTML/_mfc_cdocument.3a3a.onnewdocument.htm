<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDocument::OnNewDocument</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdocument.3a3a.onnewdocument"></a><sup></sup>CDocument::OnNewDocument  </h1>
<p>
<b>virtual</b> <b>BOOL</b> <b>OnNewDocument(</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if the document was successfully initialized; otherwise 0.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Called by the framework as part of the File New command. The default implementation of this function calls the <a href="_mfc_cdocument.3a3a.deletecontents.htm">DeleteContents</a> member function to ensure that the document is empty and then marks the new document as clean. Override this function to initialize the data structure for a new document. You should call the base class version of this function from your override.</p>
<p>
If the user chooses the File New command in an SDI application, the framework uses this function to reinitialize the existing document, rather than creating a new one. If the user chooses File New in a multiple document interface (MDI) application, the framework creates a new document each time and then calls this function to initialize it. You must place your initialization code in this function instead of in the constructor for the File New command to be effective in SDI applications.</p>
<p class=label>
<b>Example</b></p>
<pre><code>// The following examples illustrate alternative methods of
// initializing a document object.

// Method 1: In an MDI application, the simplest place to do 
// initialization is in the document constructor.&nbsp; The framework 
// always creates a new document object for File New or File Open.

CMyDoc::CMyDoc()
{
 &nbsp; // Do initialization of MDI document here.
 &nbsp; // ...
}

// Method 2: In an SDI or MDI application, do all initialization 
// in an override of OnNewDocument, if you are certain that
// the initialization is effectively saved upon File Save
// and fully restored upon File Open, via serialization.

BOOL CMyDoc::OnNewDocument()
{
 &nbsp; if (!CDocument::OnNewDocument())
 &nbsp;&nbsp;&nbsp;&nbsp; return FALSE;

 &nbsp; // Do initialization of new document here.

 &nbsp; return TRUE;
}

// Method 3: If the initialization of your document is not
// effectively saved and restored by serialization (during File Save
// and File Open), then implement the initialization in single
// function (named InitMyDocument in this example).&nbsp; Call the
// shared initialization function from overrides of both
// OnNewDocument and OnOpenDocument.

BOOL CMyDoc::OnNewDocument()
{
 &nbsp; if (!CDocument::OnNewDocument())
 &nbsp;&nbsp;&nbsp;&nbsp; return FALSE;

 &nbsp; InitMyDocument(); // call your shared initialization function

 &nbsp; // If your new document object requires additional initialization
 &nbsp; // not necessary when the document is deserialized via File Open,
 &nbsp; // then perform that additional initialization here.

 &nbsp; return TRUE;
}
</code></pre>
<p>
<a href="_mfc_cdocument.htm">CDocument Overview</a>  |&nbsp; <a href="_mfc_cdocument_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdocument.3a3a.cdocument.htm">CDocument::CDocument</a>, <a href="_mfc_cdocument.3a3a.deletecontents.htm">CDocument::DeleteContents</a>, <a href="_mfc_cdocument.3a3a.onclosedocument.htm">CDocument::OnCloseDocument</a>, <a href="_mfc_cdocument.3a3a.onopendocument.htm">CDocument::OnOpenDocument</a>, <a href="_mfc_cdocument.3a3a.onsavedocument.htm">CDocument::OnSaveDocument</a> </p>
</font></BODY>
</HTML>
