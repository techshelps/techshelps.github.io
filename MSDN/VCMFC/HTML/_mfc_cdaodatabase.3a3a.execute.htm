<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoDatabase::Execute</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaodatabase.3a3a.execute"></a>CDaoDatabase::Execute</h1>
<p>
<b>void Execute( LPCTSTR </b><i>lpszSQL</i><b>, int </b><i>nOptions</i><b> = 0 );</b><br>
<b>throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszSQL</i></p>
<p class=indent>
Pointer to a null-terminated string containing a valid SQL command to execute.</p>
<p class=dt>
<i>nOptions</i></p>
<p class=indent>
An integer that specifies options relating to the integrity of the query. You can use the bitwise-OR operator (<b>|</b>) to combine any of the following constants (provided the combination makes sense — for example, you would not combine <b>dbInconsistent</b> with <b>dbConsistent</b>):
<ul type=disc>
<li>
<b>dbDenyWrite</b>&nbsp;&nbsp;&nbsp;Deny write permission to other users.<br><br></li>
<li>
<b>dbInconsistent</b>&nbsp;&nbsp;&nbsp;(Default) Inconsistent updates.<br><br></li>
<li>
<b>dbConsistent</b>&nbsp;&nbsp;&nbsp;Consistent updates.<br><br></li>
<li>
<b>dbSQLPassThrough</b>&nbsp;&nbsp;&nbsp;SQL pass-through. Causes the SQL statement to be passed to an ODBC data source for processing.<br><br></li>
<li>
<b>dbFailOnError</b>&nbsp;&nbsp;&nbsp;Roll back updates if an error occurs.<br><br></li>
<li>
<b>dbSeeChanges</b>&nbsp;&nbsp;&nbsp;Generate a run-time error if another user is changing data you are editing.</li>
</ul>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If both <b>dbInconsistent</b> and <b>dbConsistent</b> are included or if neither is included, the result is the default. For an explanation of these constants, see the topic "Execute Method" in DAO Help.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to run an action query or execute an SQL statement on the database. <b>Execute</b> works only for action queries or SQL pass-through queries that do not return results. It does not work for select queries, which return records.</p>
<p>
For a definition and information about action queries, see the topics "Action Query" and "Execute Method" in DAO Help.</p>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;Given a syntactically correct SQL statement and proper permissions, the <b>Execute</b> member function will not fail even if not a single row can be modified or deleted. Therefore, always use the <b>dbFailOnError</b> option when using the <b>Execute</b> member function to run an update or delete query. This option causes MFC to throw an exception of type <a href="_mfc_cdaoexception.htm">CDaoException</a> and rolls back all successful changes if any of the records affected are locked and cannot be updated or deleted. Note that you can always call <b>GetRecordsAffected</b> to see how many records were affected.</p>
<p>
Call the <a href="_mfc_cdaodatabase.3a3a.getrecordsaffected.htm">GetRecordsAffected</a> member function of the database object to determine the number of records affected by the most recent <b>Execute</b> call. For example, <b>GetRecordsAffected</b> returns information about the number of records deleted, updated, or inserted when executing an action query. The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.</p>
<p>
<b>Execute</b> does not return a recordset. Using <b>Execute</b> on a query that selects records causes MFC to throw an exception of type <b>CDaoException</b>. (There is no <b>ExecuteSQL</b> member function analogous to <b>CDatabase::ExecuteSQL</b>.)</p>
<p>
For more information about using the <b>Execute</b> member function, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Querydef.3a_.Using_Querydefs">
</object><a href=JavaScript:alink_1.Click()>DAO Querydef: Using Querydefs</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdaodatabase.htm">CDaoDatabase Overview</a>  |&nbsp; <a href="_mfc_cdaodatabase_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
</font></BODY>
</HTML>
