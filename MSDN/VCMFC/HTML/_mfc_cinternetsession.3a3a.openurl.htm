<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CInternetSession::OpenURL</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cinternetsession.3a3a.openurl"></a>CInternetSession::OpenURL</h1>
<p>
<b>CStdioFile* OpenURL( LPCTSTR </b><i>pstrURL</i><b>, DWORD </b><i>dwContext</i><b> = 1, DWORD </b><i>dwFlags</i><b> = INTERNET_FLAG_TRANSFER_ASCII, LPCTSTR </b><i>pstrHeaders</i><b> = NULL, DWORD </b><i>dwHeadersLength</i><b> = 0 );<br>
Throw ( CInternetException );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Returns a file handle for FTP, GOPHER, HTTP, and FILE-type Internet services only. Returns <b>NULL</b> if parsing was unsuccessful.</p>
<p>
The pointer that <b>OpenURL</b> returns depends on <i>pszURL</i>’s type of service. The table below illustrates the possible pointers <b>OpenURL</b> can return.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>URL type</b></td>
<td class=label width=50%><b>Returns</b></td>
</tr>
<tr valign=top>
<td width=50%>file://</td>
<td width=50%><b>CStdioFile*</b></td>
</tr>
<tr valign=top>
<td width=50%>http://</td>
<td width=50%><b>CHttpFile*</b></td>
</tr>
<tr valign=top>
<td width=50%>gopher://</td>
<td width=50%><b>CGopherFile*</b></td>
</tr>
<tr valign=top>
<td width=50%>ftp://</td>
<td width=50%><b>CInternetFile*</b></td>
</tr>
</table><br>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pstrURL</i></p>
<p class=indent>
A pointer to the name of the URL to begin reading. Only URLs beginning with file:, ftp:, gopher:, or http: are supported. <b>ASSERTS</b> if <i>pszURL</i> is <b>NULL</b>. </p>
<p class=dt>
<i>dwContext</i></p>
<p class=indent>
An application-defined value passed with the returned handle in callback.</p>
<p class=dt>
<i>dwFlags</i></p>
<p class=indent>
The flags describing how to handle this connection. See <b>Remarks</b> for more information about the valid flags. The valid flags are: 
<ul type=disc>
<li>
<b>INTERNET_FLAG_TRANSFER_ASCII</b>&nbsp;&nbsp;&nbsp;The default. Transfer the file as ASCII text.<br><br></li>
<li>
<b>INTERNET_FLAG_TRANSFER_BINARY</b>&nbsp;&nbsp;&nbsp;Transfer the file as a binary file.<br><br></li>
<li>
<b>INTERNET_FLAG_RELOAD</b>&nbsp;&nbsp;&nbsp;Get the data from the wire even if it is locally cached.<br><br></li>
<li>
<b>INTERNET_FLAG_DONT_CACHE</b>&nbsp;&nbsp;&nbsp;Do not cache the data, either locally or in any gateways.<br><br></li>
<li>
<b>INTERNET_FLAG_SECURE</b>&nbsp;&nbsp;&nbsp;This flag is applicable to HTTP requests only. It requests secure transactions on the wire with Secure Sockets Layer or PCT.<br><br></li>
<li>
<b>INTERNET_OPEN_FLAG_USE_EXISTING_CONNECT</b>&nbsp;&nbsp;&nbsp;If possible, reuse the existing connections to the server for new requests generated by <b>OpenUrl</b> instead of creating a new session for each connection request.<br><br></li>
<li>
<b>INTERNET_FLAG_PASSIVE</b>&nbsp;&nbsp;&nbsp;Used for an FTP site. Uses passive FTP semantics. Used with <a href="_mfc_cinternetconnection.htm">CInternetConnection</a> of <b>OpenURL</b>.</li>
</ul>
<p class=dt>
<i>pstrHeaders</i></p>
<p class=indent>
A pointer to a string containing the headers to be sent to the HTTP server.</p>
<p class=dt>
<i>dwHeadersLength</i></p>
<p class=indent>
The length, in characters, of the additional headers. If this is -1L and <i>pstrHeaders</i> is non-<b>NULL</b>, then <i>pstrHeaders</i> is assumed to be zero terminated and the length is calculated. </p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to send the specified request to the HTTP server and allow the client to specify additional RFC822, MIME, or HTTP headers to send along with the request.&nbsp; </p>
<p>
The parameter <i>dwFlags</i> must include either <b>INTERNET_FLAG_TRANSFER_ASCII</b> or <b>INTERNET_FLAG_TRANSFER_BINARY</b>, but not both. The remaining flags can be combined with the bitwise <b>OR</b> operator (<b>|</b>).</p>
<p>
<b>OpenURL</b>, which wraps the Win32 function <b>InternetOpenURL</b>, allows only downloading, retrieving, and reading the data from an Internet server. <b>OpenURL</b> allows no file manipulation on a remote location, so it requires no <a href="_mfc_cinternetconnection.htm">CInternetConnection</a> object. </p>
<p>
To use connection-specific (that is, protocol-specific) functions, such as writing to a file, you must open a session, then open a particular kind of connection, then use that connection to open a file in the desired mode. See <b>CInternetConnection</b> for more information about connection-specific functions.</p>
<p>
<a href="_mfc_cinternetsession.htm">CInternetSession Overview</a>  |&nbsp; <a href="_mfc_cinternetsession_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cinternetconnection.htm">CInternetConnection</a>, <a href="_mfc_cgopherconnection.htm">CGopherConnection</a>, <a href="_mfc_cinternetsession.3a3a.getftpconnection.htm">CInternetSession::GetFtpConnection</a>, <a href="_mfc_cinternetsession.3a3a.gethttpconnection.htm">CInternetSession::GetHttpConnection</a> </p>
</font></BODY>
</HTML>
