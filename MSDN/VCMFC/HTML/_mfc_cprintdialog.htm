<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPrintDialog</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cprintdialog"></a>CPrintDialog</h1>
<p>
<img src="cprntdlg.gif" border=0></p>
<p>
The <b>CPrintDialog</b> class encapsulates the services provided by the Windows common dialog box for printing. Common print dialog boxes provide an easy way to implement Print and Print Setup dialog boxes in a manner consistent with Windows standards.</p>
<p>
If you wish, you can rely on the framework to handle many aspects of the printing process for your application. In this case, the framework automatically displays the Windows common dialog box for printing. You can also have the framework handle printing for your application but override the common Print dialog box with your own print dialog box. For more information on using the framework to handle printing tasks, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Printing">
</object><a href=JavaScript:alink_1.Click()>Printing</a> in <i>Visual C++ Programmer’s Guide</i>. </p>
<p>
If you want your application to handle printing without the framework’s involvement, you can use the <b>CPrintDialog</b> class “as is” with the constructor provided, or you can derive your own dialog class from <b>CPrintDialog</b> and write a constructor to suit your needs. In either case, these dialog boxes will behave like standard MFC dialog boxes because they are derived from class <b>CCommonDialog</b>.</p>
<p>
To use a <b>CPrintDialog</b> object, first create the object using the <b>CPrintDialog</b> constructor. Once the dialog box has been constructed, you can set or modify any values in the <a href="_mfc_cprintdialog.3a3a.m_pd.htm">m_pd</a> structure to initialize the values of the dialog box’s controls. The <b>m_pd</b> structure is of type <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_PRINTDLG_str">
</object><a href=JavaScript:alink_2.Click()>PRINTDLG</a>. For more information on this structure, see the Win32 SDK documentation. </p>
<p>
If you do not supply your own handles in <b>m_pd</b> for the <b>hDevMode</b> and <b>hDevNames</b> members, be sure to call the Windows function <b>GlobalFree</b> for these handles when you are done with the dialog box. When using the framework’s Print Setup implementation provided by <b>CWinApp::OnFilePrintSetup</b>, you do not have to free these handles. The handles are maintained by <b>CWinApp</b> and are freed in <b>CWinApp</b>’s destructor. It is only necessary to free these handles when using <b>CPrintDialog</b> stand-alone.</p>
<p>
After initializing the dialog box controls, call the <b>DoModal</b> member function to display the dialog box and allow the user to select print options. <b>DoModal</b> returns whether the user selected the OK (<b>IDOK</b>) or Cancel (<b>IDCANCEL</b>) button.</p>
<p>
If <b>DoModal</b> returns <b>IDOK</b>, you can use one of <b>CPrintDialog</b>’s member functions to retrieve the information input by the user.</p>
<p>
The <b>CPrintDialog::GetDefaults</b> member function is useful for retrieving the current printer defaults without displaying a dialog box. This member function requires no user interaction.</p>
<p>
You can use the Windows <b>CommDlgExtendedError</b> function to determine whether an error occurred during initialization of the dialog box and to learn more about the error. For more information on this function, see the Win32 SDK documentation. </p>
<p>
<b>CPrintDialog</b> relies on the COMMDLG.DLL file that ships with Windows versions 3.1 and later.</p>
<p>
To customize the dialog box, derive a class from <b>CPrintDialog</b>, provide a custom dialog template, and add a message map to process the notification messages from the extended controls. Any unprocessed messages should be passed on to the base class. Customizing the hook function is not required.</p>
<p>
To process the same message differently depending on whether the dialog box is Print or Print Setup, you must derive a class for each dialog box. You must also override the Windows <b>AttachOnSetup</b> function, which handles the creation of a new dialog box when the Print Setup button is selected within a Print dialog box.</p>
<p>
For more information on using <b>CPrintDialog</b>, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Common_Dialog_Classes">
</object><a href=JavaScript:alink_3.Click()>Common Dialog Classes</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
<b>#include &lt;afxdlgs.h&gt;</b></p>
<p>
<a href="_mfc_cprintdialog_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_ccommondialog.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Sample</b>&nbsp;&nbsp;&nbsp; <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_DIBLOOK">
</object><a href=JavaScript:alink_4.Click()>MFC Sample DIBLOOK</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cprintinfo.htm">CPrintInfo</a></p>
</font></BODY>
</HTML>
