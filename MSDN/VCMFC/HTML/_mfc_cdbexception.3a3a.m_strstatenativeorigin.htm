<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDBException::m_strStateNativeOrigin</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdbexception.3a3a.m_strstatenativeorigin"></a><sup></sup>CDBException::m_strStateNativeOrigin</h1>
<p class=label>
<b>Remarks</b></p>
<p>
Contains a string describing the error that caused the exception. The string is of the form “State:%s,Native:%ld,Origin:%s”, where the format codes, in order, are replaced by values that describe:
<ul type=disc>
<li>
The <b>SQLSTATE</b>, a null-terminated string containing a five-character error code returned in the <i>szSqlState</i> parameter of the <b>::SQLError</b> function. <b>SQLSTATE</b> values are listed in Appendix A, “ODBC Error Codes,” in the ODBC SDK <i>Programmer’s Reference</i>. Example: “S0022”.<br><br></li>
<li>
The native error code, specific to the data source, returned in the <i>pfNativeError</i> parameter of the <b>::SQLError</b> function. Example: 207.<br><br></li>
<li>
The error message text returned in the <i>szErrorMsg</i> parameter of the <b>::SQLError</b> function. This message consists of several bracketed names. As an error is passed from its source to the user, each ODBC component (data source, driver, Driver Manager) appends its own name. This information helps to pinpoint the origin of the error. Example: [Microsoft][ODBC SQL Server Driver][SQL Server]</li>
</ul>
<p>
The framework interprets the error string and puts its components into <b>m_strStateNativeOrigin</b>; if <b>m_strStateNativeOrigin</b> contains information for more than one error, the errors are separated by newlines. The framework puts the alphanumeric error text into <b>m_strError</b>.</p>
<p>
For additional information about the codes used to make up this string, see the <b>::SQLError</b> function in the <i>ODBC SDK Programmer’s Reference</i>.</p>
<p class=label>
<b>Example</b></p>
<p>
From ODBC: “State:S0022,Native:207,Origin:[Microsoft][ODBC SQL Server Driver][SQL Server] Invalid column name ‘ColName’”</p>
<p>
In <b>m_strStateNativeOrigin</b>: “State:S0022,Native:207,Origin:[Microsoft][ODBC SQL Server Driver][SQL Server]”</p>
<p>
In <b>m_strError</b>: “Invalid column name ‘ColName’”</p>
<p>
<a href="_mfc_cdbexception.htm">CDBException Overview</a>  |&nbsp; <a href="_mfc_cdbexception_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdbexception.3a3a.m_strerror.htm">CDBException::m_strError</a></p>
</font></BODY>
</HTML>
