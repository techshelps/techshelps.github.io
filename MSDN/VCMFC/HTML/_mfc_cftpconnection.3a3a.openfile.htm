<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CFtpConnection::OpenFile</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cftpconnection.3a3a.openfile"></a>CFtpConnection::OpenFile</h1>
<p>
<b>CInternetFile* OpenFile( LPCTSTR </b><i>pstrFileName</i><b>, DWORD </b><i>dwAccess</i><b> = GENERIC_READ, DWORD </b><i>dwFlags</i><b> = FTP_TRANSFER_TYPE_BINARY, DWORD </b><i>dwContext</i><b> = 1 );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
A pointer to a <a href="_mfc_cinternetfile.htm">CInternetFile</a> object.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pstrFileName</i></p>
<p class=indent>
A pointer to a string containing the name of the file to be opened.</p>
<p class=dt>
<i>dwAccess</i></p>
<p class=indent>
Determines how the file will be accessed. Can be either GENERIC_READ or GENERIC_WRITE, but not both.</p>
<p class=dt>
<i>dwFlags</i></p>
<p class=indent>
Specifies the conditions under which subsequent transfers occur. This can be any of the following FTP_TRANSFER_* constants: 
<ul type=disc>
<li>
FTP_TRANSFER_TYPE_ASCII&nbsp;&nbsp;&nbsp;The file transfers using FTP ASCII (Type A) transfer method. Converts control and formatting information to local equivalents. <br><br></li>
<li>
FTP_TRANSFER_TYPE_BINARY&nbsp;&nbsp;&nbsp;The file transfers data using FTP’s Image (Type I) transfer method. The file transfers data exactly as it exists, with no changes. This is the default transfer method. </li>
</ul>
<p class=dt>
<i>dwContext</i></p>
<p class=indent>
The context identifier for opening the file. See <b>Remarks</b> for more information about <i>dwContext</i>.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to open a file located on an FTP server for reading or writing. <b>OpenFile</b> should be used in the following situations:
<ul type=disc>
<li>
An application has data that needs to be sent and created as a file on the FTP server, but that data is not in a local file. Once <b>OpenFile</b> opens a file, the application uses <a href="_mfc_cinternetfile.3a3a.write.htm">CInternetFile::Write</a> to send the FTP file data to the server. <br><br></li>
<li>
An application must retrieve a file from the server and place it into application-controlled memory, instead of writing it to disk. The application uses <a href="_mfc_cinternetfile.3a3a.read.htm">CInternetFile::Read</a> after using <b>OpenFile</b> to open the file. <br><br></li>
<li>
An application needs a fine level of control over a file transfer. For example, the application may want to display a progress control indicate the progress of the file transfer status while downloading a file. </li>
</ul>
<p>
After calling <b>OpenFile</b> and until calling <a href="_mfc_cftpconnection.3a3a.close.htm">Close</a>, the application can only call <a href="_mfc_cinternetfile.3a3a.read.htm">CInternetFile::Read</a>, <a href="_mfc_cinternetfile.3a3a.write.htm">CInternetFile::Write</a>, <b>Close</b>, or <a href="_mfc_cftpfilefind.3a3a.findfile.htm">CFtpFileFind::FindFile</a>. Calls to other FTP functions for the same FTP session will fail and set the error code to FTP_ETRANSFER_IN_PROGRESS. </p>
<p>
The <i>pstrFileName</i> parameter can be either a partially qualified filename relative to the current directory or fully qualified. A backslash (\) or forward slash (/) can be used as the directory separator for either name. <b>OpenFile</b> translates the directory name separators to the appropriate characters before using it. </p>
<p>
Override the <i>dwContext</i> default to set the context identifier to a value of your choosing. The context identifier is associated with this specific operation of the <b>CFtpConnection</b> object created by its <a href="_mfc_cinternetsession.htm">CInternetSession</a> object. The value is returned to <a href="_mfc_cinternetsession.3a3a.onstatuscallback.htm">CInternetSession::OnStatusCallback</a> to provide status on the operation with which it is identified. See the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Internet_First_Steps.3a_.WinInet">
</object><a href=JavaScript:alink_1.Click()>Internet First Steps: WinInet</a> for more information about the context identifier.</p>
<p>
<a href="_mfc_cftpconnection.htm">CFtpConnection Overview</a>  |&nbsp; <a href="_mfc_cftpconnection_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cinternetconnection.htm">CInternetConnection</a>, <a href="_mfc_cftpconnection.3a3a.getfile.htm">CFtpConnection::GetFile</a>, <a href="_mfc_cgopherconnection.3a3a.openfile.htm">CGopherConnection::OpenFile</a>, <a href="_mfc_cinternetfile.3a3a.write.htm">CInternetFile::Write</a>, <a href="_mfc_cinternetfile.3a3a.read.htm">CInternetFile::Read</a></p>
</font></BODY>
</HTML>
