<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoDatabase::CreateRelation</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaodatabase.3a3a.createrelation"></a>CDaoDatabase::CreateRelation</h1>
<p>
<b>void CreateRelation( LPCTSTR </b><i>lpszName</i><b>, LPCTSTR </b><i>lpszTable</i><b>,</b> <b>LPCTSTR </b><i>lpszForeignTable</i><b>, long </b><i>lAttributes</i><b>, LPCTSTR </b><i>lpszField</i><b>,</b> <b>LPCTSTR </b><i>lpszForeignField</i><b> );<br>
throw( CDaoException, CMemoryException ); </b></p>
<p>
<b>void CreateRelation( CDaoRelationInfo&amp; </b><i>relinfo</i><b> );<br>
throw( CDaoException, CMemoryException ); </b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszName</i></p>
<p class=indent>
The unique name of the relation object. The name must start with a letter and can contain a maximum of 40 characters. It can include numbers and underscore characters but cannot include punctuation or spaces.</p>
<p class=dt>
<i>lpszTable</i></p>
<p class=indent>
The name of the primary table in the relation. If the table does not exist, MFC throws an exception of type <a href="_mfc_cdaoexception.htm">CDaoException</a>.</p>
<p class=dt>
<i>lpszForeignTable</i></p>
<p class=indent>
The name of the foreign table in the relation. If the table does not exist, MFC throws an exception of type <b>CDaoException</b>.</p>
<p class=dt>
<i>lAttributes</i></p>
<p class=indent>
A long value that contains information about the relationship type. You can use this value to enforce referential integrity, among other things. You can use the bitwise-OR operator (<b>|</b>) to combine any of the following values (as long as the combination makes sense):
<ul type=disc>
<li>
<b>dbRelationUnique</b>&nbsp;&nbsp;&nbsp;Relationship is one-to-one.<br><br></li>
<li>
<b>dbRelationDontEnforce</b>&nbsp;&nbsp;&nbsp;Relationship is not enforced (no referential integrity).<br><br></li>
<li>
<b>dbRelationInherited</b>&nbsp;&nbsp;&nbsp;Relationship exists in a noncurrent database that contains the two attached tables.<br><br></li>
<li>
<b>dbRelationUpdateCascade</b>&nbsp;&nbsp;&nbsp;Updates will cascade (for more on cascades, see Remarks).<br><br></li>
<li>
<b>dbRelationDeleteCascade</b>&nbsp;&nbsp;&nbsp;Deletions will cascade.</li>
</ul>
<p class=dt>
<i>lpszField</i></p>
<p class=indent>
A pointer to a null-terminated string containing the name of a field in the primary table (named by <i>lpszTable</i>).</p>
<p class=dt>
<i>lpszForeignField</i></p>
<p class=indent>
A pointer to a null-terminated string containing the name of a field in the foreign table (named by <i>lpszForeignTable</i>).</p>
<p class=dt>
<i>relinfo</i></p>
<p class=indent>
A reference to a <a href="_mfc_cdaorelationinfo_structure.htm">CDaoRelationInfo</a> object that contains information about the relation you want to create.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to establish a relation between one or more fields in a primary table in the database and one or more fields in a foreign table (another table in the database). The relationship cannot involve a query or an attached table from an external database.</p>
<p>
Use the first version of the function when the relation involves one field in each of the two tables. Use the second version when the relation involves multiple fields. The maximum number of fields in a relation is 14.</p>
<p>
This action creates an underlying DAO relation object, but this is an MFC implementation detail since MFC’s encapsulation of relation objects is contained within class <b>CDaoDatabase</b>. MFC does not supply a class for relations.</p>
<p>
If you set the relation object’s attributes to activate cascade operations, the database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables. </p>
<p>
For example, suppose you establish a cascade delete relationship between a Customers table and an Orders table. When you delete records from the Customers table, records in the Orders table related to that customer are also deleted. In addition, if you establish cascade delete relationships between the Orders table and other tables, records from those tables are automatically deleted when you delete records from the Customers table.</p>
<p>
For related information, see the topic "CreateRelation Method" in DAO Help.</p>
<p>
<a href="_mfc_cdaodatabase.htm">CDaoDatabase Overview</a>  |&nbsp; <a href="_mfc_cdaodatabase_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaodatabase.3a3a.deleterelation.htm">CDaoDatabase::DeleteRelation</a></p>
</font></BODY>
</HTML>
