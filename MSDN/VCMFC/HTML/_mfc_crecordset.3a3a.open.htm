<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CRecordset::Open</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_crecordset.3a3a.open"></a>CRecordset::Open</h1>
<p>
<b>virtual</b> <b>BOOL</b> <b>Open(</b> <b>UINT</b> <i>nOpenType</i> <b>=</b> <b>AFX_DB_USE_DEFAULT_TYPE,</b> <b>LPCTSTR</b> <i>lpszSQL</i> <b>=</b> <b>NULL,</b> <b>DWORD</b> <i>dwOptions</i> <b>=</b> <b>none</b> <b>);</b><br>
<b>throw(</b> <b>CDBException</b>, <b>CMemoryException</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if the <b>CRecordset</b> object was successfully opened; otherwise 0 if <a href="_mfc_cdatabase.3a3a.open.htm">CDatabase::Open</a> (if called) returns 0.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nOpenType</i></p>
<p class=indent>
Accept the default value, <b>AFX_DB_USE_DEFAULT_TYPE</b>, or use one of the following values from the <b>enum</b> <b>OpenType</b>:
<ul type=disc>
<li>
<b>CRecordset::dynaset</b>&nbsp;&nbsp;&nbsp;A recordset with bi-directional scrolling. The membership and ordering of the records are determined when the recordset is opened, but changes made by other users to the data values are visible following a fetch operation. Dynasets are also known as keyset-driven recordsets.<br><br></li>
<li>
<b>CRecordset::snapshot</b>&nbsp;&nbsp;&nbsp;A static recordset with bi-directional scrolling. The membership and ordering of the records are determined when the recordset is opened; the data values are determined when the records are fetched. Changes made by other users are not visible until the recordset is closed and then reopened.<br><br></li>
<li>
<b>CRecordset::dynamic</b>&nbsp;&nbsp;&nbsp;A recordset with bi-directional scrolling. Changes made by other users to the membership, ordering, and data values are visible following a fetch operation. Note that many ODBC drivers do not support this type of recordset.<br><br></li>
<li>
<b>CRecordset::forwardOnly</b>&nbsp;&nbsp;&nbsp;A read-only recordset with only forward scrolling.<p class=tl>
For <b>CRecordset</b>, the default value is <b>CRecordset::snapshot</b>. The default-value mechanism allows the Visual C++ wizards to interact with both ODBC <b>CRecordset</b> and DAO <b>CDaoRecordset</b>, which have different defaults.</P><p class=tl>
For more information about these recordset types, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset_.28.ODBC.29">
</object><a href=JavaScript:alink_1.Click()>Recordset (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>. For related information, see the article ”Using Block and Scrollable Cursors" in the <i>ODBC SDK Programmer's Reference</i>.</P><p class=atl>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;If the requested type is not supported, the framework throws an exception.</p></li>
</ul>
<p class=dt>
<i>lpszSQL</i></p>
<p class=indent>
A string pointer containing one of the following:
<ul type=disc>
<li>
A <b>NULL</b> pointer.<br><br></li>
<li>
The name of a table.<br><br></li>
<li>
An SQL <b>SELECT</b> statement (optionally with an SQL <b>WHERE</b> or <b>ORDER BY</b> clause). <br><br></li>
<li>
A <b>CALL</b> statement specifying the name of a predefined query (stored procedure). Be careful that you do not insert whitespace between the curly brace and the <b>CALL</b> keyword.<p class=tl>
For more information about this string, see the table and the discussion of ClassWizard’s role under Remarks.</P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The order of the columns in your result set must match the order of the RFX or Bulk RFX function calls in your <a href="_mfc_crecordset.3a3a.dofieldexchange.htm">DoFieldExchange</a> or <a href="_mfc_crecordset.3a3a.dobulkfieldexchange.htm">DoBulkFieldExchange</a> function override.</p></li>
</ul>
<p class=dt>
<i>dwOptions</i></p>
<p class=indent>
A bitmask which can specify a combination of the values listed below. Some of these are mutually exclusive. The default value is <b>none</b>.
<ul type=disc>
<li>
<b>CRecordset::none</b>&nbsp;&nbsp;&nbsp;No options set. This parameter value is mutually exclusive with all other values. By default, the recordset can be updated with <a href="_mfc_crecordset.3a3a.edit.htm">Edit</a> or <a href="_mfc_crecordset.3a3a.delete.htm">Delete</a> and allows appending new records with <a href="_mfc_crecordset.3a3a.addnew.htm">AddNew</a>. Updatability depends on the data source as well as on the <i>nOpenType</i> option you specify. Optimization for bulk additions is not available. Bulk row fetching will not be implemented. Deleted records will not be skipped during recordset navigation. Bookmarks are not available. Automatic dirty field checking is implemented.<br><br></li>
<li>
<b>CRecordset::appendOnly</b>&nbsp;&nbsp;&nbsp;Do not allow <b>Edit</b> or <b>Delete</b> on the recordset. Allow <b>AddNew</b> only. This option is mutually exclusive with <b>CRecordset::readOnly</b>.<br><br></li>
<li>
<b>CRecordset::readOnly</b>&nbsp;&nbsp;&nbsp;Open the recordset as read-only. This option is mutually exclusive with <b>CRecordset::appendOnly</b>.<br><br></li>
<li>
<b>CRecordset::optimizeBulkAdd</b>&nbsp;&nbsp;&nbsp;Use a prepared SQL statement to optimize adding many records at one time. Applies only if you are not using the ODBC API function <b>SQLSetPos</b> to update the recordset. The first update determines which fields are marked dirty. This option is mutually exclusive with <b>CRecordset::useMultiRowFetch</b>.<br><br></li>
<li>
<b>CRecordset::useMultiRowFetch</b>&nbsp;&nbsp;&nbsp;Implement bulk row fetching to allow multiple rows to be retrieved in a single fetch operation. This is an advanced feature designed to improve performance; however, bulk record field exchange is not supported by ClassWizard. This option is mutually exclusive with <b>CRecordset::optimizeBulkAdd</b>. Note that if you specify <b>CRecordset::useMultiRowFetch</b>, then the option <b>CRecordset::noDirtyFieldCheck</b> will be turned on automatically (double buffering will not be available); on forward-only recordsets, the option <b>CRecordset::useExtendedFetch</b> will be turned on automatically. For more information about bulk row fetching, see the article <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Fetching_Records_in_Bulk_.28.ODBC.29">
</object><a href=JavaScript:alink_2.Click()>Recordset: Fetching Records in Bulk (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.<br><br></li>
<li>
<b>CRecordset::skipDeletedRecords</b>&nbsp;&nbsp;&nbsp;Skip all deleted records when navigating through the recordset. This will slow performance in certain relative fetches. This option is not valid on forward-only recordsets. Note that <b>CRecordset::skipDeletedRecords</b> is similar to <i>driver packing</i>, which means that deleted rows are removed from the recordset. However, if your driver packs records, then it will skip only those records that you delete; it will not skip records deleted by other users while the recordset is open. <b>CRecordset::skipDeletedRecords</b> will skip rows deleted by other users.<br><br></li>
<li>
<b>CRecordset::useBookmarks</b>&nbsp;&nbsp;&nbsp;May use bookmarks on the recordset, if supported. Bookmarks slow data retrieval but improve performance for data navigation. Not valid on forward-only recordsets. For more information, see the article <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Bookmarks_and_Absolute_Positions_.28.ODBC.29">
</object><a href=JavaScript:alink_3.Click()>Recordset: Bookmarks and Absolute Positions (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.<br><br></li>
<li>
<b>CRecordset::noDirtyFieldCheck</b>&nbsp;&nbsp;&nbsp;Turn off automatic dirty field checking (double buffering). This will improve performance; however, you must manually mark fields as dirty by calling the <b>SetFieldDirty</b> and <b>SetFieldNull</b> member functions.Note that double buffering in class <b>CRecordset</b> is similar to double buffering in class <b>CDaoRecordset</b>. However, in <b>CRecordset</b>, you cannot enable double buffering on individual fields; you either enable it for all fields or disable it for all fields. For more information about double buffering, see the DAO article <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Record_Field_Exchange.3a_.Double_Buffering_Records">
</object><a href=JavaScript:alink_4.Click()>DAO Record Field Exchange: Double Buffering Records</a> in <i>Visual C++ Programmer’s Guide</i>. Note that if you specify the option <b>CRecordset::useMultiRowFetch</b>, then <b>CRecordset::noDirtyFieldCheck</b> will be turned on automatically; however, <b>SetFieldDirty</b> and <b>SetFieldNull</b> cannot be used on recordsets that implement bulk row fetching.<br><br></li>
<li>
<b>CRecordset::executeDirect</b>&nbsp;&nbsp;&nbsp;Do not use a prepared SQL statement. For improved performance, specify this option if the <b>Requery</b> member function will never be called.<br><br></li>
<li>
<b>CRecordset::useExtendedFetch</b>&nbsp;&nbsp;&nbsp;Implement <b>SQLExtendedFetch</b> instead of <b>SQLFetch</b>. This is designed for implementing bulk row fetching on forward-only recordsets. If you specify the option <b>CRecordset::useMultiRowFetch</b> on a forward-only recordset, then <b>CRecordset::useExtendedFetch</b> will be turned on automatically.<br><br></li>
<li>
<b>CRecordset::userAllocMultiRowBuffers</b>&nbsp;&nbsp;&nbsp;The user will allocate storage buffers for the data. Use this option in conjunction with <b>CRecordset::useMultiRowFetch</b> if you want to allocate your own storage; otherwise, the framework will automatically allocate the necessary storage. For more information, see the article <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Fetching_Records_in_Bulk_.28.ODBC.29">
</object><a href=JavaScript:alink_5.Click()>Recordset: Fetching Records in Bulk (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>. Note that specifying <b>CRecordset::userAllocMultiRowBuffers</b> without specifying <b>CRecordset::useMultiRowFetch</b> will result in a failed assertion.</li>
</ul>
<p class=label>
<b>Remarks</b></p>
<p>
You must call this member function to run the query defined by the recordset. Before calling <b>Open</b>, you must construct the recordset object. </p>
<p>
This recordset’s connection to the data source depends on how you construct the recordset before calling <b>Open</b>. If you pass a <a href="_mfc_cdatabase.htm">CDatabase</a> object to the recordset constructor that has not been connected to the data source, this member function uses <a href="_mfc_crecordset.3a3a.getdefaultconnect.htm">GetDefaultConnect</a> to attempt to open the database object. If you pass <b>NULL</b> to the recordset constructor, the constructor constructs a <b>CDatabase</b> object for you, and <b>Open</b> attempts to connect the database object. For details on closing the recordset and the connection under these varying circumstances, see <a href="_mfc_crecordset.3a3a.close.htm">Close</a>.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Access to a data source through a <b>CRecordset</b> object is always shared. Unlike the <b>CDaoRecordset</b> class, you cannot use a <b>CRecordset</b> object to open a data source with exclusive access.</p>
<p>
When you call <b>Open</b>, a query, usually an SQL <b>SELECT</b> statement, selects records based on criteria shown in the following table.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>Value of the lpszSQL parameter</b></td>
<td class=label width=39%><b>Records selected are determined by</b></td>
<td class=label width=30%><b>Example</b></td>
</tr>
<tr valign=top>
<td width=31%><b>NULL</b></td>
<td width=39%>The string returned by <b>GetDefaultSQL</b>.</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=31%>SQL table name</td>
<td width=39%>All columns of the table-list in <b>DoFieldExchange</b> or <b>DoBulkFieldExchange</b>.</td>
<td width=30%><pre><code>"Customer"</code></pre>
</td>
</tr>
<tr valign=top>
<td width=31%>Predefined query (stored procedure) name</td>
<td width=39%>The columns the query is defined to return.</td>
<td width=30%><pre><code>"{call OverDueAccts}"</code></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><b>SELECT</b> column-list <b>FROM</b> table-list</td>
<td width=39%>The specified columns from the specified table(s).</td>
<td width=30%><pre><code>"SELECT CustId, CustName FROM 
Customer"</code></pre>
</td>
</tr>
</table><br>
<p class=indent>
<B><b>! Warning</b></B>&nbsp;&nbsp;&nbsp;Be careful that you do not insert extra whitespace in your SQL string. For example, if you insert whitespace between the curly brace and the <b>CALL</b> keyword, MFC will misinterpret the SQL string as a table name and incorporate it into a <b>SELECT</b> statement, which will result in an exception being thrown. Similarly, if your predefined query uses an output parameter, do not insert whitespace between the curly brace and the '?' symbol. Finally, you must not insert whitespace before the curly brace in a <b>CALL</b> statement or before the <b>SELECT</b> keyword in a <b>SELECT</b> statment.</p>
<p>
The usual procedure is to pass <b>NULL</b> to <b>Open</b>; in this case, <b>Open</b> calls <a href="_mfc_crecordset.3a3a.getdefaultsql.htm">GetDefaultSQL</a>. If you are using a derived <b>CRecordset</b> class, <b>GetDefualtSQL</b> gives the table name(s) you specified in ClassWizard. You can instead specify other information in the <i>lpszSQL</i> parameter.</p>
<p>
Whatever you pass, <b>Open</b> constructs a final SQL string for the query (the string may have SQL <b>WHERE</b> and <b>ORDER BY</b> clauses appended to the <i>lpszSQL</i> string you passed) and then executes the query. You can examine the constructed string by calling <a href="_mfc_crecordset.3a3a.getsql.htm">GetSQL</a> after calling <b>Open</b>. For additional details about how the recordset constructs an SQL statement and selects records, see the article <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.How_Recordsets_Select_Records_.28.ODBC.29">
</object><a href=JavaScript:alink_6.Click()>Recordset: How Recordsets Select Records (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p>
The field data members of your recordset class are bound to the columns of the data selected. If any records are returned, the first record becomes the current record.</p>
<p>
If you want to set options for the recordset, such as a filter or sort, specify these after you construct the recordset object but before you call <b>Open</b>. If you want to refresh the records in the recordset after the recordset is already open, call <a href="_mfc_crecordset.3a3a.requery.htm">Requery</a>.</p>
<p>
For more information, including additional examples, see the articles <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset_.28.ODBC.29">
</object><a href=JavaScript:alink_7.Click()>Recordset (ODBC)</a>, <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.How_Recordsets_Select_Records_.28.ODBC.29">
</object><a href=JavaScript:alink_8.Click()>Recordset: How Recordsets Select Records (ODBC)</a>, and <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Recordset.3a_.Creating_and_Closing_Recordsets_.28.ODBC.29">
</object><a href=JavaScript:alink_9.Click()>Recordset: Creating and Closing Recordsets (ODBC)</a> in <i>Visual C++ Programmer’s Guide</i>.</p>
<p class=label>
<b>Example</b></p>
<p>
The following code examples show different forms of the <b>Open</b> call.</p>
<pre><code>// rs is a CRecordset or
// CRecordset-derived object

// Open rs using the default SQL statement,
// implement bookmarks, and turn off
// automatic dirty field checking
rs.Open( CRecordset::snapshot, NULL,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CRecordset::useBookmarks |
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CRecordset::noDirtyFieldCheck );

// Pass a complete SELECT statement
// and open as a dynaset
rs.Open( CRecordset::dynaset,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _T( "Select L_Name from Customer" ) );

// Accept all defaults
rs.Open( );
</code></pre>
<p>
<a href="_mfc_crecordset.htm">CRecordset Overview</a>  |&nbsp; <a href="_mfc_crecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_crecordset.3a3a.crecordset.htm">CRecordset::CRecordset</a>, <a href="_mfc_crecordset.3a3a.close.htm">CRecordset::Close</a>, <a href="_mfc_crecordset.3a3a.getdefaultsql.htm">CRecordset::GetDefaultSQL</a>, <a href="_mfc_crecordset.3a3a.getsql.htm">CRecordset::GetSQL</a>, <a href="_mfc_crecordset.3a3a.m_strfilter.htm">CRecordset::m_strFilter</a>, <a href="_mfc_crecordset.3a3a.m_strsort.htm">CRecordset::m_strSort</a>, <a href="_mfc_crecordset.3a3a.requery.htm">CRecordset::Requery</a></p>
</font></BODY>
</HTML>
