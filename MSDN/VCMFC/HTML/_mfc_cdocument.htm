<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDocument</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdocument"></a>CDocument</h1>
<p>
<img src="cdocumnt.gif" border=0></p>
<p>
The <b>CDocument</b> class provides the basic functionality for user-defined document classes. A document represents the unit of data that the user typically opens with the File Open command and saves with the File Save command.</p>
<p>
<b>CDocument</b> supports standard operations such as creating a document, loading it, and saving it. The framework manipulates documents using the interface defined by <b>CDocument</b>.</p>
<p>
An application can support more than one type of document; for example, an application might support both spreadsheets and text documents. Each type of document has an associated document template; the document template specifies what resources (for example, menu, icon, or accelerator table) are used for that type of document. Each document contains a pointer to its associated <b>CDocTemplate</b> object.</p>
<p>
Users interact with a document through the <a href="_mfc_cview.htm">CView</a> object(s) associated with it. A view renders an image of the document in a frame window and interprets user input as operations on the document. A document can have multiple views associated with it. When the user opens a window on a document, the framework creates a view and attaches it to the document. The document template specifies what type of view and frame window are used to display each type of document. </p>
<p>
Documents are part of the framework’s standard command routing and consequently receive commands from standard user-interface components (such as the File Save menu item). A document receives commands forwarded by the active view. If the document doesn’t handle a given command, it forwards the command to the document template that manages it.</p>
<p>
When a document’s data is modified, each of its views must reflect those modifications. <b>CDocument</b> provides the <a href="_mfc_cdocument.3a3a.updateallviews.htm">UpdateAllViews</a> member function for you to notify the views of such changes, so the views can repaint themselves as necessary. The framework also prompts the user to save a modified file before closing it.</p>
<p>
To implement documents in a typical application, you must do the following:
<ul type=disc>
<li>
Derive a class from <b>CDocument</b> for each type of document.<br><br></li>
<li>
Add member variables to store each document’s data.<br><br></li>
<li>
Implement member functions for reading and modifying the document’s data. The document’s views are the most important users of these member functions.<br><br></li>
<li>
Override the <a href="_mfc_cobject.3a3a.serialize.htm">CObject::Serialize</a>  member function in your document class to write and read the document’s data to and from disk.</li>
</ul>
<p>
<b>CDocument</b> supports sending your document via mail if mail support (MAPI) is present. See the articles <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_MAPI_Topics">
</object><a href=JavaScript:alink_1.Click()>MAPI Topics</a> and <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_MAPI_Support_in_MFC">
</object><a href=JavaScript:alink_2.Click()>MAPI Support in MFC</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
For more information on <b>CDocument</b>, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Serialization_.28.Object_Persistence.29">
</object><a href=JavaScript:alink_3.Click()>Serialization (Object Persistence)</a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Document.2f.View_Architecture_Topics">
</object><a href=JavaScript:alink_4.Click()>Document/View Architecture Topics</a>, and <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Document.2f.View_Creation">
</object><a href=JavaScript:alink_5.Click()>Document/View Creation</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<b>#include &lt;afxwin.h&gt;</b></p>
<p>
<a href="_mfc_cdocument_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_ccmdtarget.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Samples</b>&nbsp;&nbsp;&nbsp;<object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_HELLO">
</object><a href=JavaScript:alink_6.Click()>MFC Sample HELLO</a>  |&nbsp; <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_MDIBIND">
</object><a href=JavaScript:alink_7.Click()>MFCSample MDIBIND</a>  |&nbsp; <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_MDIDOCVW">
</object><a href=JavaScript:alink_8.Click()>MFC Sample MDIDOCVW</a>  |&nbsp; <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_SNAPVW">
</object><a href=JavaScript:alink_9.Click()>MFC Sample SNAPVW</a>  |&nbsp; <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_NPP">
</object><a href=JavaScript:alink_10.Click()>MFC Sample NPP</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_ccmdtarget.htm">CCmdTarget</a>, <a href="_mfc_cview.htm">CView</a>, <a href="_mfc_cdoctemplate.htm">CDocTemplate</a></p>
</font></BODY>
</HTML>
