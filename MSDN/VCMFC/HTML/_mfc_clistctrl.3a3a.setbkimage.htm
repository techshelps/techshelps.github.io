<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CListCtrl::SetBkImage</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_clistctrl.3a3a.setbkimage"></a>CListCtrl::SetBkImage</h1>
<p>
<b>BOOL SetBkImage( LVBKIMAGE* </b><i>plvbkImage </i><b>);</b></p>
<p>
<b>BOOL SetBkImage( HBITMAP </b><i>hbm</i><b>, BOOL </b><i>fTile </i><b>= TRUE, int </b><i>xOffsetPercent </i><b>= 0, int </b><i>yOffsetPercent </i><b>= 0);</b></p>
<p>
<b>BOOL SetBkImage( LPTSTR </b><i>pszUrl</i><b>, BOOL </b><i>fTile </i><b>= TRUE, int </b><i>xOffsetPercent </i><b>= 0, int </b><i>yOffsetPercent </i><b>= 0 );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Returns nonzero if successful, or zero otherwise.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>plvbkImage</i></p>
<p class=indent>
Address of a <b>LVBKIMAGE</b>  structure, containing the new background image information.</p>
<p class=dt>
<i>hbm</i></p>
<p class=indent>
Handle to a bitmap.</p>
<p class=dt>
<i>pszUrl</i></p>
<p class=indent>
A <b>NULL</b>-terminated string that contains the URL of the background image.</p>
<p class=dt>
<i>fTile</i></p>
<p class=indent>
Nonzero if the image is to be tiled in the background of the list view control; otherwise 0.</p>
<p class=dt>
<i>xOffsetPercent</i></p>
<p class=indent>
The offset, in pixels, of the image’s left edge, from origin of the list view control.</p>
<p class=dt>
<i>yOffsetPercent</i></p>
<p class=indent>
<i>&nbsp;</i>The offset, in pixels, of the image’s top edge, from origin of the list view control.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this function to set the background image of a list view control.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Because <b>CListCtrl::SetBkImage</b> makes use of OLE COM functionality, the OLE libraries must be initialized before using <b>SetBkImage</b>. It is best to initialize the COM libraries when the application is initialized and uninitialize the libraries when the application terminates. This is automatically done in MFC applications that make use of ActiveX technology, OLE Automation, OLE Linking/Embedding, or ODBC/DAO operations.</p>
<p>
<a href="_mfc_clistctrl.htm">CListCtrl Overview</a>  |&nbsp; <a href="_mfc_clistctrl_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_clistctrl.3a3a.getbkimage.htm">CListCtrl::GetBkImage</a></p>
</font></BODY>
</HTML>
