<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CWnd::OnMouseWheel</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cwnd.3a3a.onmousewheel"></a>CWnd::OnMouseWheel</h1>
<p>
<b>afx_msg BOOL OnMouseWheel( UINT </b><i>nFlags</i><b>, short </b><i>zDelta</i><b>, CPoint </b><i>pt</i><b> );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if mouse wheel scrolling is enabled; otherwise 0.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nFlags</i></p>
<p class=indent>
Indicates whether various virtual keys are down. This parameter can be any combination of the following values:
<ul type=disc>
<li>
<b>MK_CONTROL</b>&nbsp;&nbsp;&nbsp;Set if the CTRL key is down.<br><br></li>
<li>
<b>MK_LBUTTON</b>&nbsp;&nbsp;&nbsp;Set if the left mouse button is down.<br><br></li>
<li>
<b>MK_MBUTTON</b>&nbsp;&nbsp;&nbsp;Set if the middle mouse button is down.<br><br></li>
<li>
<b>MK_RBUTTON</b>&nbsp;&nbsp;&nbsp;Set if the right mouse button is down.<br><br></li>
<li>
<b>MK_SHIFT</b>&nbsp;&nbsp;&nbsp;Set if the SHIFT key is down.</li>
</ul>
<p class=dt>
<i>zDelta</i></p>
<p class=indent>
Indicates distance rotated. The <i>zDelta</i> value is expressed in multiples or divisions of <b>WHEEL_DELTA</b>, which is 120. A value less than zero indicates rotating back (toward the user) while a value greater than zero indicates rotating forward (away from the user). The user can reverse this response by changing the Wheel setting in the mouse software. See the Remarks for more information about this parameter.</p>
<p class=dt>
<i>pt</i></p>
<p class=indent>
Specifies the x- and y-coordinate of the cursor. These coordinates are always relative to the upper-left corner of the window.</p>
<p class=label>
<b>Remarks</b></p>
<p>
The framework calls this member function as a user rotates the mouse wheel and encounters the wheel's next notch. Unless overridden, <b>OnMouseWheel</b> calls the default of <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_WM_MOUSEWHEEL">
</object><a href=JavaScript:alink_1.Click()>WM_MOUSEWHEEL</a>. Windows automatically routes the message to the control or child window that has the focus. The Win32 function <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_DefWindowProc">
</object><a href=JavaScript:alink_2.Click()>DefWindowProc</a> propagates the message up the parent chain to the window that processes it.</p>
<p>
The <i>zDelta</i> parameter is a multiple of <b>WHEEL_DELTA</b>, which is set at 120. This value is the threshold for an action to be taken, and one such action (for example, scrolling forward one notch) should occur for each delta. </p>
<p>
The delta was set to 120 to allow for future finer-resolution wheels, such as a freely-rotating wheel with no notches. Such a device might send more messages per rotation, but with a smaller value in each message. To support this possibility, either aggregate the incoming delta values until <b>WHEEL_DELTA</b> is reached (so you get the same response for a given delta-rotation), or scroll partial lines in response to the more frequent messages. You could also choose your scroll granularity and accumulate deltas until <b>WHEEL_DELTA</b> is reached. </p>
<p>
Override this member function to provide your own mouse-wheel scrolling behavior. </p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;<b>OnMouseWheel</b> handles messages for Windows NT 4.0. For Windows 95 or Windows NT 3.51 message handling, use <a href="_mfc_cwnd.3a3a.onregisteredmousewheel.htm">OnRegisteredMouseWheel</a>.</p>
<p>
<a href="_mfc_cwnd.htm">CWnd Overview</a>  |&nbsp; <a href="_mfc_cwnd_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_mouse_event">
</object><a href=JavaScript:alink_3.Click()>mouse_event</a></p>
</font></BODY>
</HTML>
