<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CMenu</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cmenu"></a><sup></sup>CMenu</h1>
<p>
<img src="cmenu.gif" border=0></p>
<p>
The <b>CMenu</b> class is an encapsulation of the Windows <b>HMENU</b>. It provides member functions for creating, tracking, updating, and destroying a menu.</p>
<p>
Create a <b>CMenu</b> object on the stack frame as a local, then call <b>CMenu</b>’s member functions to manipulate the new menu as needed. Next, call <a href="_mfc_cwnd.3a3a.setmenu.htm">CWnd::SetMenu</a> to set the menu to a window, followed immediately by a call to the <b>CMenu</b> object’s <a href="_mfc_cmenu.3a3a.detach.htm">Detach</a> member function. The <b>CWnd::SetMenu</b> member function sets the window’s menu to the new menu, causes the window to be redrawn to reflect the menu change, and also passes ownership of the menu to the window. The call to <b>Detach</b> detaches the <b>HMENU</b> from the <b>CMenu</b> object, so that when the local <b>CMenu</b> variable passes out of scope, the <b>CMenu</b> object destructor does not attempt to destroy a menu it no longer owns. The menu itself is automatically destroyed when the window is destroyed.</p>
<p>
You can use the <a href="_mfc_cmenu.3a3a.loadmenuindirect.htm">LoadMenuIndirect</a> member function to create a menu from a template in memory, but a menu created from a resource by a call to <a href="_mfc_cmenu.3a3a.loadmenu.htm">LoadMenu</a> is more easily maintained, and the menu resource itself can be created and modified by the menu editor.</p>
<p>
<b>#include &lt;afxwin.h&gt;</b></p>
<p>
<a href="_mfc_cmenu_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_cobject.htm">Base Class</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>Samples</b>&nbsp;&nbsp;&nbsp;<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_CTRLTEST">
</object><a href=JavaScript:alink_1.Click()>MFC Sample CTRLTEST</a>  |&nbsp; <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sample_mfc_DYNAMENU">
</object><a href=JavaScript:alink_2.Click()>MFC Sample DYNAMENU</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cobject.htm">CObject</a></p>
</font></BODY>
</HTML>
