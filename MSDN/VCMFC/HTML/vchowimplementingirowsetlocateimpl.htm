<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing IRowsetLocate</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vchowimplementingirowsetlocateimpl"></a>Implementing IRowsetLocate</h1>
<p>
After <a href="vchowmodifyinginheritanceofcmyproviderrowset.htm">modifying the inheritance of RMyProviderRowset</a>, you need to implement the <code>IRowsetLocate</code> interface. You can find the interface definition in the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="oledbinterface_summary">
</object><a href=JavaScript:alink_1.Click()>Interface Summary</a> of the <i>OLE DB Programmer's Reference</i> and in the OLEDB.H file in the OLE DB SDK include directory.</p>
<p>
To implement this interface:
<ol>
<li>
Create a new file named RowLoc.h and add the file to the project.<br><br></li>
<li>
In RowLoc.h, create a class definition for <code>IRowsetLocateImpl</code>, derived from <b>IRowset</b>, and implement the class.<br><br></li>
<li>
Copy the methods for the interface from the OLE DB header file OLEDB.H to RowLoc.h. Change the HRESULT return codes to STDMETHOD and put parentheses around the method names, as shown in the following code.<br><br></li>
<li>
Complete the implementation (covered in the next topic).</li>
</ol>
<pre><code>////////////////////////////////////////////////////////////////////////
// RowLoc.h
// class IRowsetLocateImpl

template &lt;class T&gt;
class ATL_NO_VTABLE IRowsetLocateImpl : public IRowsetImpl&lt;T&gt; 
{
public:
   STDMETHOD (Compare)(HCHAPTER hReserved, ULONG cbBookmark1, 
      const BYTE * pBookmark1, ULONG cbBookmark2, const BYTE * 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pBookmark2, DBCOMPARE * pComparison)
   {
      return S_OK;
   }

   STDMETHOD (GetRowsAt)(HWATCHREGION hReserved1, HCHAPTER hReserved2,
      ULONG cbBookmark, const BYTE * pBookmark, LONG lRowsOffset,
      LONG cRows, ULONG * pcRowsObtained, HROW ** prghRows)
   {
      return S_OK;
   }

   STDMETHOD (GetRowsByBookmark)(HCHAPTER hReserved, ULONG cRows,
      const ULONG rgcbBookmarks[], const BYTE * rgpBookmarks[],
      HROW rghRows[], DBROWSTATUS rgRowStatus[])
   {
      return S_OK;
   }

   STDMETHOD (Hash)(HCHAPTER hReserved, ULONG cBookmarks,
      const ULONG rgcbBookmarks[], const BYTE * rgpBookmarks[],
      DWORD rgHashedValues[], DBROWSTATUS rgBookmarkStatus[])
   {
      ATLTRACENOTIMPL("IRowsetLocateImpl::GetRowsByBookmark");
   }
};
</code></pre>
<p>
In the next topic, you will see how to <a href="vchowcompletingimplementationofirowsetlocateimpl.htm">complete the implementation</a> by adding bookmarks.</p>
</font></BODY>
</HTML>
