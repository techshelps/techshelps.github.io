<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoException::CDaoException</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaoexception.3a3a.cdaoexception"></a>CDaoException::CDaoException</h1>
<p>
<b>CDaoException( );</b></p>
<p class=label>
<b>Remarks</b></p>
<p>
Constructs a <b>CDaoException</b> object. Ordinarily, the framework creates exception objects when its code throws an exception. You seldom need to construct an exception object explicitly. If you want to throw a <b>CDaoException</b> from your own code, call the global function <a href="_mfc_afxthrowdaoexception.htm">AfxThrowDaoException</a>.</p>
<p>
However, you might want to explicitly create an exception object if you are making direct calls to DAO via the DAO interface pointers that MFC classes encapsulate. In that case, you might need to retrieve error information from DAO. Suppose an error occurs in DAO when you call a DAO method via, say, the DAODatabases interface to a workspace’s Databases collection. To retrieve the DAO error information:
<ol>
<li>
Construct a <b>CDaoException</b> object.<br><br></li>
<li>
Call the exception object’s <a href="_mfc_cdaoexception.3a3a.geterrorcount.htm">GetErrorCount</a> member function to determine how many error objects are in the database engine’s Errors collection. (Normally only one, unless you are using an ODBC data source.)<br><br></li>
<li>
Call the exception object’s <a href="_mfc_cdaoexception.3a3a.geterrorinfo.htm">GetErrorInfo</a> member function to retrieve one specific error object at a time, by index in the collection, via the exception object. Think of the exception object as a proxy for one DAO error object.<br><br></li>
<li>
Examine the current <a href="_mfc_cdaoerrorinfo_structure.htm">CDaoErrorInfo</a> structure that <b>GetErrorInfo</b> returns in the <a href="_mfc_cdaoexception.3a3a.m_perrorinfo.htm">m_pErrorInfo</a> data member. Its members provide information on the DAO error. <br><br></li>
<li>
In the case of an ODBC data source, repeat steps 3 and 4 as needed, for more error objects.<br><br></li>
<li>
If you constructed the exception object on the heap, delete it with the <b>delete</b> operator when you finish.</li>
</ol>
<p>
For more information about handling errors in the MFC DAO classes, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Exceptions.3a_.Database_Exceptions">
</object><a href=JavaScript:alink_1.Click()>Exceptions: Database Exceptions</a> in <i>Visual C++ Programmer's Guide</i>.</p>
<p>
<a href="_mfc_cdaoexception.htm">CDaoException Overview</a>  |&nbsp; <a href="_mfc_cdaoexception_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
</font></BODY>
</HTML>
