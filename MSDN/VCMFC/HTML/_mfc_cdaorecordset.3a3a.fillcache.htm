<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoRecordset::FillCache</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaorecordset.3a3a.fillcache"></a>CDaoRecordset::FillCache</h1>
<p>
<b>void FillCache( long*</b> <i>pSize</i> <b>= NULL,</b> <b>COleVariant*</b> <i>pBookmark</i> <b>= NULL );</b><br>
<b>throw( CDaoException, CMemoryException );</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pSize</i></p>
<p class=indent>
Specifies the number of rows to fill in the cache. If you omit this parameter, the value is determined by the CacheSize property setting of the underlying DAO object.</p>
<p class=dt>
<i>pBookmark</i></p>
<p class=indent>
A <a href="_mfc_colevariant.htm">COleVariant</a> specifying a bookmark. The cache is filled starting from the record indicated by this bookmark. If you omit this parameter, the cache is filled starting from the record indicated by the CacheStart property of the underlying DAO object.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to cache a specified number of records from the recordset. Caching improves the performance of an application that retrieves, or fetches, data from a remote server. A cache is space in local memory that holds the data most recently fetched from the server on the assumption that the data will probably be requested again while the application is running. When data is requested, the Microsoft Jet database engine checks the cache for the data first rather than fetching it from the server, which takes more time. Using data caching on non-ODBC data sources has no effect as the data is not saved in the cache.</p>
<p>
Rather than waiting for the cache to be filled with records as they are fetched, you can explicitly fill the cache at any time by calling the <b>FillCache</b> member function. This is a faster way to fill the cache because <b>FillCache</b> fetches several records at once instead of one at a time. For example, while each screenful of records is being displayed, you can have your application call <b>FillCache</b> to fetch the next screenful of records.</p>
<p>
Any ODBC database accessed with recordset objects can have a local cache. To create the cache, open a recordset object from the remote data source, and then call the <b>SetCacheSize</b> and <b>SetCacheStart</b> member functions of the recordset. If <i>lSize</i> and <i>lBookmark</i> create a range that is partly or wholly outside the range specified by <b>SetCacheSize</b> and <b>SetCacheStart</b>, the portion of the recordset outside this range is ignored and is not loaded into the cache. If <b>FillCache</b> requests more records than remain in the remote data source, only the remaining records are fetched, and no exception is thrown.</p>
<p>
Records fetched from the cache do not reflect changes made concurrently to the source data by other users.</p>
<p>
<b>FillCache</b> fetches only records not already cached. To force an update of all the cached data, call the <b>SetCacheSize</b> member function with an <i>lSize</i> parameter equal to 0, call <b>SetCacheSize</b> again with the <i>lSize</i> parameter equal to the size of the cache you originally requested, and then call <b>FillCache</b>.</p>
<p>
For more information about caching records, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_External.3a_.Improving_Performance_with_External_Data_Sources">
</object><a href=JavaScript:alink_1.Click()>DAO External: Improving Performance with External Data Sources</a> in <i>Visual C++ Programmer's Guide</i>. For related information, see the topic "FillCache Method" in DAO Help.</p>
<p>
<a href="_mfc_cdaorecordset.htm">CDaoRecordset Overview</a>  |&nbsp; <a href="_mfc_cdaorecordset_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaorecordset.3a3a.getcachesize.htm">CDaoRecordset::GetCacheSize</a>, <a href="_mfc_cdaorecordset.3a3a.getcachestart.htm">CDaoRecordset::GetCacheStart</a>, <a href="_mfc_cdaorecordset.3a3a.setcachesize.htm">CDaoRecordset::SetCacheSize</a>, <a href="_mfc_cdaorecordset.3a3a.setcachestart.htm">CDaoRecordset::SetCacheStart</a></p>
</font></BODY>
</HTML>
