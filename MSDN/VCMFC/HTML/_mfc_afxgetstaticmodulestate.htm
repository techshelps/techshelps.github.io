<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AfxGetStaticModuleState</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_afxgetstaticmodulestate"></a>AfxGetStaticModuleState&nbsp; </h1>
<p>
<b>AFX_MODULE_STATE*</b> <b>AFXAPI</b> <b>AfxGetStaticModuleState(</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
A pointer to an <b>AFX_MODULE_STATE</b> structure.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this function to set the module state before initialization and/or to restore the previous module state after cleanup. The <b>AFX_MODULE_STATE</b> structure contains global data for the module, that is, the portion of the module state that is pushed or popped. </p>
<p>
By default, MFC uses the resource handle of the main application to load the resource template. If you have an exported function in a DLL, such as one that launches a dialog box in the DLL, this template is actually stored in the DLL module. You need to switch the module state for the correct handle to be used. You can do this by adding the following code to the beginning of the function:</p>
<pre><code>AFX_MANAGE_STATE(AfxGetStaticModuleState( ));
</code></pre>
<p>
This swaps the current module state with the state returned from <b>AfxGetStaticModuleState</b> until the end of the current scope.</p>
<p>
For more information on module states and MFC, see "Managing the State Data of MFC Modules" in <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Creating_New_Documents.2c_.Windows.2c_.and_Views">
</object><a href=JavaScript:alink_1.Click()>Creating New Documents, Windows, and Views</a> in <i>Visual C++ Programmer’s Guide</i> and <a href="_mfcnotes_tn058.htm">Technical Note 58</a>.</p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_afx_manage_state.htm">AFX_MANAGE_STATE</a> </p>
</font></BODY>
</HTML>
