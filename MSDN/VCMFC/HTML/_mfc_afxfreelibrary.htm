<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AfxFreeLibrary</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_afxfreelibrary"></a>AfxFreeLibrary</h1>
<p>
<b>BOOL AFXAPI AfxFreeLibrary(</b> <b>HINSTANCE </b><i>hInstLib</i> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
<b>TRUE</b> if the function succeeds; otherwise, <b>FALSE</b>.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>hInstLib</i></p>
<p class=indent>
A handle of the loaded library module. <a href="_mfc_afxloadlibrary.htm">AfxLoadLibrary</a> returns this handle.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Both <b>AfxFreeLibrary</b> and <b>AfxLoadLibrary</b> maintain a reference count for each loaded library module. <b>AfxFreeLibrary</b> decrements the reference count of the loaded dynamic-link library (DLL) module. When the reference count reaches zero, the module is unmapped from the address space of the calling process and the handle is no longer valid. This reference count is incremented each time <b>AfxLoadLibrary</b> is called.</p>
<p>
Before unmapping a library module, the system enables the DLL to detach from the processes using it. Doing so gives the DLL an opportunity to clean up resources allocated on behalf of the current process. After the entry-point function returns, the library module is removed from the address space of the current process.</p>
<p>
Use <b>AfxLoadLibrary</b> to map a DLL module.</p>
<p>
Be sure to use <b>AfxFreeLibrary</b> and <b>AfxLoadLibrary</b> (instead of the Win32 functions <b>FreeLibrary</b> and <b>LoadLibrary</b>) if your application uses multiple threads. Using <b>AfxLoadLibrary</b> and <b>AfxFreeLibrary</b> ensures that the startup and shutdown code that executes when the extension DLL is loaded and unloaded does not corrupt the global MFC state.</p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_afxloadlibrary.htm">AfxLoadLibrary</a></p>
</font></BODY>
</HTML>
