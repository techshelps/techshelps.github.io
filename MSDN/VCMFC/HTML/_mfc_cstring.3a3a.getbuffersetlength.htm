<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CString::GetBufferSetLength</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cstring.3a3a.getbuffersetlength"></a><sup></sup>CString::GetBufferSetLength  </h1>
<p>
<b>LPTSTR</b> <b>GetBufferSetLength(</b> <b>int</b> <i>nNewLength</i> <b>);</b><br>
<b>throw(</b> <b>CMemoryException</b> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
An <b>LPTSTR</b> pointer to the object’s (null-terminated) character buffer.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>nNewLength</i></p>
<p class=indent>
The exact size of the <b>CString</b> character buffer in characters.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Returns a pointer to the internal character buffer for the <b>CString</b> object, truncating or growing its length if necessary to exactly match the length specified in <i>nNewLength</i>. The returned <b>LPTSTR</b> pointer is not <b>const</b> and thus allows direct modification of <b>CString</b> contents.</p>
<p>
If you use the pointer returned by <a href="_mfc_cstring.3a3a.getbuffer.htm">GetBuffer</a> to change the string contents, you must call <b>ReleaseBuffer</b> before using any other <b>CString</b> member functions.</p>
<p>
The address returned by <b>GetBufferSetLength</b> may not be valid after the call to <b>ReleaseBuffer</b> since additional <b>CString</b> operations may cause the <b>CString</b> buffer to be reallocated. The buffer will not be reassigned if you do not change the length of the <b>CString</b>.</p>
<p>
The buffer memory will be freed automatically when the <b>CString</b> object is destroyed.</p>
<p>
Note that if you keep track of the string length yourself, you should not append the terminating null character. You must, however, specify the final string length when you release the buffer with <b>ReleaseBuffer</b>. If you do append a terminating null character when you call <b>ReleaseBuffer</b>, you should pass –1 (the default) for the length. <b>ReleaseBuffer</b> will perform a <b>strlen</b> on the buffer to determine its length.</p>
<p>
For more information about reference counting, see the following articles:
<ul type=disc>
<li>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_Managing_Object_Lifetimes_through_Reference_Counting">
</object><a href=JavaScript:alink_1.Click()>Managing Object Lifetimes through Reference Counting</a> in the <i>Win32 SDK Programmer’s Reference</i><br><br></li>
<li>
<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_Implementing_Reference_Counting">
</object><a href=JavaScript:alink_2.Click()>Implementing Reference Counting</a> in the <i>Win32 SDK Programmer’s Reference</i><br><br></li>
<li>
<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_Rules_for_Managing_Reference_Counts">
</object><a href=JavaScript:alink_3.Click()>Rules for Managing Reference Counts</a> in the <i>Win32 SDK Programmer’s Reference</i></li>
</ul>
<p>
<a href="_mfc_cstring.htm">CString Overview</a>  |&nbsp; <a href="_mfc_cstring_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cstring.3a3a.getbuffer.htm">CString::GetBuffer</a>, <a href="_mfc_cstring.3a3a.releasebuffer.htm">CString::ReleaseBuffer</a></p>
</font></BODY>
</HTML>
