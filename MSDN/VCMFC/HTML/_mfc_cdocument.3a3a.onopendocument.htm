<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDocument::OnOpenDocument</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdocument.3a3a.onopendocument"></a><sup></sup>CDocument::OnOpenDocument  </h1>
<p>
<b>virtual</b> <b>BOOL</b> <b>OnOpenDocument(</b> <b>LPCTSTR</b> <i>lpszPathName</i> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Nonzero if the document was successfully loaded; otherwise 0.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszPathName</i></p>
<p class=indent>
Points to the path of the document to be opened.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Called by the framework as part of the File Open command. The default implementation of this function opens the specified file, calls the <a href="_mfc_cdocument.3a3a.deletecontents.htm">DeleteContents</a> member function to ensure that the document is empty, calls <a href="_mfc_cobject.3a3a.serialize.htm">CObject::Serialize</a> to read the file’s contents, and then marks the document as clean. Override this function if you want to use something other than the archive mechanism or the file mechanism. For example, you might write an application where documents represent records in a database rather than separate files. </p>
<p>
If the user chooses the File Open command in an SDI application, the framework uses this function to reinitialize the existing <b>CDocument</b> object, rather than creating a new one. If the user chooses File Open in an MDI application, the framework constructs a new <b>CDocument</b> object each time and then calls this function to initialize it. You must place your initialization code in this function instead of in the constructor for the File Open command to be effective in SDI applications.</p>
<p class=label>
<b>Example</b></p>
<pre><code>// The following examples illustrate alternative methods of
// initializing a document object.

// Method 1: In an MDI application, the simplest place to do 
// initialization is in the document constructor.&nbsp; The framework 
// always creates a new document object for File New or File Open.

CMyDoc::CMyDoc()
{
 &nbsp; // Do initialization of MDI document here.
 &nbsp; // ...
}

// Method 2: In an SDI or MDI application, do all initialization 
// in an override of OnNewDocument, if you are certain that
// the initialization is effectively saved upon File Save
// and fully restored upon File Open, via serialization.

BOOL CMyDoc::OnNewDocument()
{
 &nbsp; if (!CDocument::OnNewDocument())
 &nbsp;&nbsp;&nbsp;&nbsp; return FALSE;

 &nbsp; // Do initialization of new document here.

 &nbsp; return TRUE;
}

// Method 3: If the initialization of your document is not
// effectively saved and restored by serialization (during File Save
// and File Open), then implement the initialization in single
// function (named InitMyDocument in this example).&nbsp; Call the
// shared initialization function from overrides of both
// OnNewDocument and OnOpenDocument.
 
BOOL CMyDoc::OnNewDocument()
{
 &nbsp; if (!CDocument::OnNewDocument())
 &nbsp;&nbsp;&nbsp;&nbsp; return FALSE;

 &nbsp; InitMyDocument(); // call your shared initialization function

 &nbsp; // If your new document object requires additional initialization
 &nbsp; // not necessary when the document is deserialized via File Open,
 &nbsp; // then perform that additional initialization here.

 &nbsp; return TRUE;
}
</code></pre>
<p>
<a href="_mfc_cdocument.htm">CDocument Overview</a>  |&nbsp; <a href="_mfc_cdocument_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdocument.3a3a.deletecontents.htm">CDocument::DeleteContents</a>, <a href="_mfc_cdocument.3a3a.onclosedocument.htm">CDocument::OnCloseDocument</a>, <a href="_mfc_cdocument.3a3a.onnewdocument.htm">CDocument::OnNewDocument</a>, <a href="_mfc_cdocument.3a3a.onsavedocument.htm">CDocument::OnSaveDocument</a>, <a href="_mfc_cdocument.3a3a.reportsaveloadexception.htm">CDocument::ReportSaveLoadException</a>, <a href="_mfc_cobject.3a3a.serialize.htm">CObject::Serialize</a> </p>
</font></BODY>
</HTML>
