<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDatabase::ExecuteSQL</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdatabase.3a3a.executesql"></a><sup></sup>CDatabase::ExecuteSQL</h1>
<p>
<b>void</b> <b>ExecuteSQL(</b> <b>LPCSTR</b> <i>lpszSQL</i> <b>);</b><br>
<b>throw(</b> <b>CDBException</b> <b>);</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>lpszSQL</i></p>
<p class=indent>
Pointer to a null-terminated string containing a valid SQL command to execute. You can pass a <a href="_mfc_cstring.htm">CString</a>.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function when you need to execute an SQL command directly. Create the command as a null-terminated string. <b>ExecuteSQL</b> does not return data records. If you want to operate on records, use a recordset object instead.</p>
<p>
Most of your commands for a data source are issued through recordset objects, which support commands for selecting data, inserting new records, deleting records, and editing records. However, not all ODBC functionality is directly supported by the database classes, so you may at times need to make a direct SQL call with <b>ExecuteSQL</b>.</p>
<p class=label>
<b>Example</b></p>
<pre><code>CString strCmd = "UPDATE Taxes SET Federal = 36%";

TRY
{
 &nbsp; m_dbCust.ExecuteSQL( strCmd );
}

CATCH(CDBException, e)
{
 &nbsp; // The error code is in e-&gt;m_nRetCode
}

END_CATCH
</code></pre>
<p>
<a href="_mfc_cdatabase.htm">CDatabase Overview</a>  |&nbsp; <a href="_mfc_cdatabase_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdatabase.3a3a.setlogintimeout.htm">CDatabase::SetLoginTimeout</a>, <a href="_mfc_crecordset.htm">CRecordset</a></p>
</font></BODY>
</HTML>
