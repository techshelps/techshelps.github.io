<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CMetaFileDC::CreateEnhanced</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cmetafiledc.3a3a.createenhanced"></a><sup></sup>CMetaFileDC::CreateEnhanced</h1>
<p>
<b>BOOL</b> <b>CreateEnhanced(</b> <b>CDC*</b> <i>pDCRef</i><b>,</b> <b>LPCTSTR</b> <i>lpszFileName</i><b>,</b> <b>LPCRECT</b> <i>lpBounds</i><b>,</b> <b>LPCTSTR</b> <i>lpszDescription</i> <b>);</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
A handle of the device context for the enhanced metafile, if successful; otherwise <b>NULL</b>.</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pDCRef</i></p>
<p class=indent>
Identifies a reference device for the enhanced metafile.</p>
<p class=dt>
<i>lpszFileName</i></p>
<p class=indent>
Points to a null-terminated character string. Specifies the filename for the enhanced metafile to be created. If this parameter is <b>NULL</b>, the enhanced metafile is memory based and its contents lost when the object is destroyed or when the <b>::DeleteEnhMetaFile</b> function is called.</p>
<p class=dt>
<i>lpBounds</i></p>
<p class=indent>
Points to a <a href="_mfc_rect_structure.htm">RECT</a> data structure or a <a href="_mfc_crect.htm">CRect</a> object that specifies the dimensions in <b>HIMETRIC</b> units (in .01-millimeter increments) of the picture to be stored in the enhanced metafile. </p>
<p class=dt>
<i>lpszDescription</i></p>
<p class=indent>
Points to a zero-terminated string that specifies the name of the application that created the picture, as well as the picture’s title.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Creates a device context for an enhanced-format metafile. This DC can be used to store a device-independent picture.</p>
<p>
Windows uses the reference device identified by the <i>pDCRef</i> parameter to record the resolution and units of the device on which a picture originally appeared. If the <i>pDCRef</i> parameter is <b>NULL</b>, it uses the current display device for reference.</p>
<p>
The left and top members of the <b>RECT</b> data structure pointed to by the <i>lpBounds</i> parameter must be smaller than the right and bottom members, respectively. Points along the edges of the rectangle are included in the picture. If <i>lpBounds</i> is <b>NULL</b>, the graphics device interface (GDI) computes the dimensions of the smallest rectangle that can enclose the picture drawn by the application. The <i>lpBounds</i> parameter should be supplied where possible.</p>
<p>
The string pointed to by the <i>lpszDescription</i> parameter must contain a null character between the application name and the picture name and must terminate with two null characters —for example, “XYZ Graphics Editor\0Bald Eagle\0\0,” where \0 represents the null character. If <i>lpszDescription</i> is <b>NULL</b>, there is no corresponding entry in the enhanced-metafile header.</p>
<p>
Applications use the DC created by this function to store a graphics picture in an enhanced metafile. The handle identifying this DC can be passed to any GDI function.</p>
<p>
After an application stores a picture in an enhanced metafile, it can display the picture on any output device by calling the <b>CDC::PlayMetaFile</b> function. When displaying the picture, Windows uses the rectangle pointed to by the <i>lpBounds</i> parameter and the resolution data from the reference device to position and scale the picture. The device context returned by this function contains the same default attributes associated with any new DC.</p>
<p>
Applications must use the <b>::GetWinMetaFileBits</b> function to convert an enhanced metafile to the older Windows metafile format.</p>
<p>
The filename for the enhanced metafile should use the .EMF extension.</p>
<p>
<a href="_mfc_cmetafiledc.htm">CMetaFileDC Overview</a>  |&nbsp; <a href="_mfc_cmetafiledc_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cmetafiledc.3a3a.closeenhanced.htm">CMetaFileDC::CloseEnhanced</a>, <a href="_mfc_cdc.3a3a.playmetafile.htm">CDC::PlayMetaFile</a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_CloseEnhMetaFile">
</object><a href=JavaScript:alink_1.Click()>::CloseEnhMetaFile</a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_DeleteEnhMetaFile">
</object><a href=JavaScript:alink_2.Click()>::DeleteEnhMetaFile</a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_GetEnhMetaFileDescription">
</object><a href=JavaScript:alink_3.Click()>::GetEnhMetaFileDescription</a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_GetEnhMetaFileHeader">
</object><a href=JavaScript:alink_4.Click()>::GetEnhMetaFileHeader</a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_GetWinMetaFileBits">
</object><a href=JavaScript:alink_5.Click()>::GetWinMetaFileBits</a>, <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_WIN32_PlayEnhMetaFile">
</object><a href=JavaScript:alink_6.Click()>::PlayEnhMetaFile</a></p>
</font></BODY>
</HTML>
