<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPageSetupDialog::DoModal</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cpagesetupdialog.3a3a.domodal"></a>CPageSetupDialog::DoModal</h1>
<p>
<b>virtual int DoModal( );</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
<b>IDOK</b> or <b>IDCANCEL</b>. If <b>IDCANCEL</b> is returned, call the Windows <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_Win32_CommDlgExtendedError">
</object><a href=JavaScript:alink_1.Click()>CommDlgExtendedError</a> function to determine whether an error occurred.</p>
<p>
<b>IDOK</b> and <b>IDCANCEL</b> are constants that indicate whether the user selected the OK or Cancel button.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this function to display the Windows common OLE Page Setup dialog box and allow the user to select various print setup options such as the printing margins, size and orientation of the paper, and destination printer. In addition, the user can access the printer setup options such as network location and properties specific to the selected printer.</p>
<p>
If you want to initialize the various Page Setup dialog options by setting members of the <b>m_psd</b> structure, you should do so before calling <b>DoModal</b>, and after the dialog object is constructed. After calling <b>DoModal</b>, call other member functions to retrieve the settings or information input by the user into the dialog box.</p>
<p>
If you want to propagate the current settings entered by the user, make a call to <a href="_mfc_cwinapp.3a3a.selectprinter.htm">CWinApp::SelectPrinter</a>. This function takes the information from the <b>CPageSetupDialog</b> object and initializes and selects a new printer DC with the proper attributes.</p>
<pre><code>AfxGetApp()-&gt;SelectPrinter(dlg.m_psd.hDevNames, dlg.m_psd.hDevMode);
</code></pre>
<p>
<a href="_mfc_cpagesetupdialog.htm">CPageSetupDialog Overview</a>  |&nbsp; <a href="_mfc_cpagesetupdialog_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>  <a href="_mfc_cpagesetupdialog.3a3a.m_psd.htm">CPageSetupDialog::m_psd</a></p>
</font></BODY>
</HTML>
