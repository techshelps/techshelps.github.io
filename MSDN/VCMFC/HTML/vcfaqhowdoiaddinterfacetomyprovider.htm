<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Do I Add an Interface to My Provider?</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="vcfaqhowdoiaddinterfacetomyprovider"></a>How Do I Add an Interface to My Provider?</h1>
<p>
Determine which object you want to add the interface to (usually data source, rowset, command, or session objects created by the ATL Provider Wizard). It is possible that the object you need to add the interface to is one that your provider does not currently support. In that case, run the ATL Object Wizard to create the object (right-click in the Project Workspace window ClassView pane and choose <b>New ATL Object</b>).</p>
<p>
If you created a new class to support the interface, make the object inherit from that class. For example, you might add the class <b>IRowsetIndexImpl</b> to a rowset object:</p>
<pre><code>template &lt;class Creator&gt;
class CAgentRowset : 
public CRowsetImpl&lt; CAgentRowset&lt;Creator&gt;, CAgentMan, Creator&gt;,
   public IRowsetIndexImpl&lt; … &gt; 
</code></pre>
<p>
Add the interface to the <b>COM_MAP</b> in the object using the <b>COM_INTERFACE_ENTRY</b> macro. If there is no map, create one. For example:</p>
<pre><code>BEGIN_COM_MAP(CAgentRowset)
 &nbsp;&nbsp;&nbsp; COM_INTERFACE_ENTRY(IRowsetIndex)
END_COM_MAP()
</code></pre>
<p>
For the rowset object, chain the map of its parent object so that the object can delegate to the parent class. In this example, add the <b>COM_INTERFACE_ENTRY_CHAIN</b> macro to the map:</p>
<pre><code>BEGIN_COM_MAP(CAgentRowset)
 &nbsp;&nbsp;&nbsp; COM_INTERFACE_ENTRY(IRowsetIndex)
 &nbsp;&nbsp;&nbsp; COM_INTERFACE_ENTRY_CHAIN(CRowsetImpl)
END_COM_MAP()
</code></pre>
</font></BODY>
</HTML>
