<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DEVMODE and TEXTMETRIC String Conversion Macros</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_atl_devmode_and_textmetric_string_conversion_macros"></a>DEVMODE and TEXTMETRIC String Conversion Macros</h1>
<p>
These macros create a copy of a <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_DEVMODE_str">
</object><a href=JavaScript:alink_1.Click()>DEVMODE</a> or <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_TEXTMETRIC_str">
</object><a href=JavaScript:alink_2.Click()>TEXTMETRIC</a> structure and convert the strings within the new structure to a new string type. The macros allocate memory on the stack for the new structure and return a pointer to the new structure.</p>
<p>
The syntax is:</p>
<p>
<b>MACRONAME( </b><i>address_of_structure </i><b>)</b></p>
<p>
For example:</p>
<p>
<b>DEVMODEA2W(</b><i>lpa</i><b>)</b></p>
<p>
and</p>
<p>
<b>TEXTMETRICA2W(</b><i>lptma</i><b>)</b></p>
<p>
In the macro names, the string type in the source structure is on the left (for example, <b>A</b>) and the string type in the destination structure is on the right (for example, <b>W</b>). <b>A</b> stands for <b>LPSTR</b>, <b>OLE</b> stands for <b>LPOLESTR</b>, <b>T</b> stands for <b>LPTSTR</b>, and <b>W</b> stands for <b>LPWSTR</b>.</p>
<p>
Thus, <b>DEVMODEA2W</b> copies a <b>DEVMODE</b> structure with <b>LPSTR</b> strings into a <b>DEVMODE</b> structure with <b>LPWSTR</b> strings, <b>TEXTMETRICOLE2T</b> copies a <b>TEXTMETRIC</b> structure with <b>LPOLESTR</b> strings into a <b>TEXTMETRIC</b> structure with <b>LPTSTR</b> strings, and so on.</p>
<p>
The two strings converted in the <b>DEVMODE</b> structure are the device name (<b>dmDeviceName</b>) and the form name (<b>dmFormName</b>). The <b>DEVMODE</b> string conversion macros also update the structure size (<b>dmSize</b>).</p>
<p>
The four strings converted in the <b>TEXTMETRIC</b> structure are the first character (<b>tmFirstChar</b>), the last character (<b>tmLastChar</b>), the default character (<b>tmDefaultChar</b>), and the break character (<b>tmBreakChar</b>). </p>
<p>
The behavior of the <b>DEVMODE</b> and <b>TEXTMETRIC</b> string conversion macros depends on the compiler directive in effect, if any. If the source and destination types are the same, no conversion takes place. Compiler directives change <b>T</b> and <b>OLE</b> as follows:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=44%><b>Compiler directive in effect</b></td>
<td class=label width=33%><b>T becomes</b></td>
<td class=label width=23%><b>OLE becomes</b></td>
</tr>
<tr valign=top>
<td width=44%>none</td>
<td width=33%><b>A</b></td>
<td width=23%><b>W</b></td>
</tr>
<tr valign=top>
<td width=44%><b>_UNICODE</b></td>
<td width=33%><b>W</b></td>
<td width=23%><b>W</b></td>
</tr>
<tr valign=top>
<td width=44%><b>OLE2ANSI</b></td>
<td width=33%><b>A</b></td>
<td width=23%><b>A</b></td>
</tr>
<tr valign=top>
<td width=44%><b>_UNICODE</b> and <b>OLE2ANSI</b></td>
<td width=33%><b>W</b></td>
<td width=23%><b>A</b></td>
</tr>
</table><br>
<p>
The following table lists the <b>DEVMODE</b> and <b>TEXTMETRIC</b> string conversion macros.</p>
<p class=label>
<b>DEVMODE and TEXTMETRIC String Conversion Macros</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=44%><b>DEVMODEA2W</b></td>
<td width=56%><b>TEXTMETRICA2W</b></td>
</tr>
<tr valign=top>
<td width=44%><b>DEVMODEOLE2T</b></td>
<td width=56%><b>TEXTMETRICOLE2T</b></td>
</tr>
<tr valign=top>
<td width=44%><b>DEVMODET2OLE</b></td>
<td width=56%><b>TEXTMETRICT2OLE</b></td>
</tr>
<tr valign=top>
<td width=44%><b>DEVMODEW2A</b></td>
<td width=56%><b>TEXTMETRICW2A</b></td>
</tr>
</table><br>
<p>
<a href="_atl_atl_macros_and_global_functions.htm">ATL Macros and Global Functions</a></p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="_atl_string_conversion_macros.htm">String Conversion Macros</a></p>
</font></BODY>
</HTML>
