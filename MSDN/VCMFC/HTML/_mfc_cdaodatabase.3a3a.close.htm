<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDaoDatabase::Close</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_mfc_cdaodatabase.3a3a.close"></a>CDaoDatabase::Close</h1>
<p>
<b>virtual void Close( );</b></p>
<p class=label>
<b>Remarks</b></p>
<p>
Call this member function to disconnect from a database and close any open recordsets, tabledefs, and querydefs associated with the database. It is good practice to close these objects yourself before you call this member function. Closing a <b>CDaoDatabase</b> object removes it from the Databases collection in the associated <a href="_mfc_cdaoworkspace.htm">workspace</a>. Because <b>Close</b> does not destroy the <b>CDaoDatabase</b> object, you can reuse the object by opening the same database or a different database.</p>
<p class=indent>
<B><b>CAUTION</b></B>&nbsp;&nbsp;&nbsp;Call the <a href="_mfc_cdaorecordset.3a3a.update.htm">Update</a> member function (if there are pending edits) and the <b>Close</b> member function on all open recordset objects before you close a database. If you exit a function that declares <a href="_mfc_cdaorecordset.htm">CDaoRecordset</a> or <b>CDaoDatabase</b> objects on the stack, the database is closed, any unsaved changes are lost, all pending transactions are rolled back, and any pending edits to your data are lost.</p>
<p class=indent>
<B><b>CAUTION</b></B>&nbsp;&nbsp;&nbsp;If you try to close a database object while any recordset objects are open, or if you try to close a workspace object while any database objects belonging to that specific workspace are open, those recordset objects will be closed and any pending updates or edits will be rolled back. If you try to close a workspace object while any database objects belonging to it are open, the operation closes all database objects belonging to that specific workspace object, which may result in unclosed recordset objects being closed. If you do not close your database object, MFC reports an assertion failure in debug builds.</p>
<p>
If the database object is defined outside the scope of a function, and you exit the function without closing it, the database object will remain open until explicitly closed or the module in which it is defined is out of scope.</p>
<p>
For more information about <b>CDaoDatabase</b> objects, see the article <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_DAO_Database">
</object><a href=JavaScript:alink_1.Click()>DAO Database</a> in <i>Visual C++ Programmer's Guide</i>. For related information, see the topic "Close Method" in DAO Help.</p>
<p>
<a href="_mfc_cdaodatabase.htm">CDaoDatabase Overview</a>  |&nbsp; <a href="_mfc_cdaodatabase_class_members.htm">Class Members</a>  |&nbsp; <a href="_mfc_hierarchy_chart.htm">Hierarchy Chart</a></p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_mfc_cdaodatabase.3a3a.open.htm">CDaoDatabase::Open</a>, <a href="_mfc_cdaorecordset.3a3a.close.htm">CDaoRecordset::Close</a>, <a href="_mfc_cdaoworkspace.3a3a.close.htm">CDaoWorkspace::Close</a>, <a href="_mfc_cdaoquerydef.3a3a.close.htm">CDaoQueryDef::Close</a>, <a href="_mfc_cdaotabledef.3a3a.close.htm">CDaoTableDef::Close</a></p>
</font></BODY>
</HTML>
