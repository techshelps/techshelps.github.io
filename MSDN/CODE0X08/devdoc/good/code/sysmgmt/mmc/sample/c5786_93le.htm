<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GENPAGE.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5792"></a>GENPAGE.CPP</h2>
<pre><code>// genpage.cpp : implementation file <br>// <br> <br>#include "stdafx.h" <br>#include "Service.h"  <br>#include "csnapin.h" <br>#include "resource.h" <br>#include "afxdlgs.h" <br>#include "genpage.h" <br>#include "dataobj.h" <br>#include "prsht.h" <br> <br>#ifdef _DEBUG <br>#define new DEBUG_NEW <br>#undef THIS_FILE <br>static char THIS_FILE[] = __FILE__; <br>#endif <br> <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CGeneralPage property page <br> <br>IMPLEMENT_DYNCREATE(CGeneralPage, CPropertyPage) <br> <br>CGeneralPage::CGeneralPage() : CPropertyPage(CGeneralPage::IDD) <br>{ <br> <br>//{{AFX_DATA_INIT(CGeneralPage) <br>m_szName = _T(""); <br>//}}AFX_DATA_INIT <br> <br>    m_hConsoleHandle = NULL; <br>    m_bUpdate = FALSE; <br> <br>} <br> <br>CGeneralPage::~CGeneralPage() <br>{ <br>} <br> <br>void CGeneralPage::DoDataExchange(CDataExchange* pDX) <br>{ <br>CPropertyPage::DoDataExchange(pDX); <br>//{{AFX_DATA_MAP(CGeneralPage) <br>DDX_Control(pDX, IDC_NEW_FOLDER, m_EditCtrl); <br>DDX_Text(pDX, IDC_NEW_FOLDER, m_szName); <br>DDV_MaxChars(pDX, m_szName, 64); <br>//}}AFX_DATA_MAP <br>} <br> <br> <br>BEGIN_MESSAGE_MAP(CGeneralPage, CPropertyPage) <br>//{{AFX_MSG_MAP(CGeneralPage) <br>ON_WM_DESTROY() <br>ON_EN_CHANGE(IDC_NEW_FOLDER, OnEditChange) <br>//}}AFX_MSG_MAP <br>END_MESSAGE_MAP() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CGeneralPage message handlers <br> <br> <br> <br>void CGeneralPage::OnDestroy()  <br>{ <br>    // Note - This needs to be called only once.   <br>    // If called more than once, it will gracefully return an error. <br>    MMCFreeNotifyHandle(m_hConsoleHandle); <br> <br>    CPropertyPage::OnDestroy(); <br> <br>    // Delete the CGeneralPage object <br>    delete this; <br>} <br> <br> <br>void CGeneralPage::OnEditChange()  <br>{ <br>    // Page is dirty, mark it. <br>SetModified(); <br>    m_bUpdate = TRUE; <br>} <br> <br> <br>BOOL CGeneralPage::OnApply()  <br>{ <br>if (m_bUpdate == TRUE) <br>    { <br> <br>USES_CONVERSION; <br>        // Simple string cookie, could be anything! <br>        LPWSTR lpString =  <br>            reinterpret_cast&lt;LPWSTR&gt;( <br>          ::GlobalAlloc(GMEM_SHARE,  <br>                        (sizeof(wchar_t) *  <br>                        (m_szName.GetLength() + 1)) <br>                        )); <br> <br>        wcscpy(lpString, T2COLE(m_szName)); <br> <br>        // Send a property change notify to the console <br>        MMCPropertyChangeNotify(m_hConsoleHandle, reinterpret_cast&lt;long&gt;(lpString)); <br>        m_bUpdate = FALSE; <br>    } <br> <br>return CPropertyPage::OnApply(); <br>} <br>///////////////////////////////////////////////////////////////////////////// <br>// CExtensionPage property page <br> <br>IMPLEMENT_DYNCREATE(CExtensionPage, CPropertyPage) <br> <br>CExtensionPage::CExtensionPage() : CPropertyPage(CExtensionPage::IDD) <br>{ <br>//{{AFX_DATA_INIT(CExtensionPage) <br>m_szText = _T(""); <br>//}}AFX_DATA_INIT <br>} <br> <br>CExtensionPage::~CExtensionPage() <br>{ <br>} <br> <br>void CExtensionPage::DoDataExchange(CDataExchange* pDX) <br>{ <br>CPropertyPage::DoDataExchange(pDX); <br>//{{AFX_DATA_MAP(CExtensionPage) <br>DDX_Control(pDX, IDC_EXT_TEXT, m_hTextCtrl); <br>DDX_Text(pDX, IDC_EXT_TEXT, m_szText); <br>//}}AFX_DATA_MAP <br>} <br> <br> <br>BEGIN_MESSAGE_MAP(CExtensionPage, CPropertyPage) <br>//{{AFX_MSG_MAP(CExtensionPage) <br>//}}AFX_MSG_MAP <br>END_MESSAGE_MAP() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CExtensionPage message handlers <br> <br>BOOL CExtensionPage::OnInitDialog()  <br>{ <br>CPropertyPage::OnInitDialog(); <br> <br>    m_hTextCtrl.SetWindowText(m_szText); <br>return TRUE;  // return TRUE unless you set the focus to a control <br>              // EXCEPTION: OCX Property Pages should return FALSE <br>} <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CStartUpWizard property page <br> <br> <br>// NOTICE: need to override this because CPropertyPage::AssertValid()  <br>// would otherwise assert <br>IMPLEMENT_DYNCREATE(CBaseWizard, CPropertyPage) <br> <br>CBaseWizard::CBaseWizard(UINT id) : CPropertyPage(id) <br>{ <br>    // NOTICE: need to do this because MFC was compiled with NT 4.0 <br>// headers that had a different size <br>    ZeroMemory(&amp;m_psp97, sizeof(PROPSHEETPAGE));  <br> <br>    memcpy(&amp;m_psp97, &amp;m_psp, m_psp.dwSize); <br>    m_psp97.dwSize = sizeof(PROPSHEETPAGE); <br>} <br> <br>void CBaseWizard::OnDestroy()  <br>{ <br>CPropertyPage::OnDestroy(); <br>    delete this; <br>} <br> <br>BEGIN_MESSAGE_MAP(CBaseWizard, CPropertyPage) <br>//{{AFX_MSG_MAP(CStartupWizard1) <br>ON_WM_DESTROY() <br>//}}AFX_MSG_MAP <br>END_MESSAGE_MAP() <br> <br>IMPLEMENT_DYNCREATE(CStartUpWizard, CBaseWizard) <br> <br>CStartUpWizard::CStartUpWizard() : CBaseWizard(CStartUpWizard::IDD) <br>{ <br>//{{AFX_DATA_INIT(CStartUpWizard) <br>// NOTE: the ClassWizard will add member initialization here <br>//}}AFX_DATA_INIT <br>    m_psp97.dwFlags |= PSP_HIDEHEADER; <br>} <br> <br>CStartUpWizard::~CStartUpWizard() <br>{ <br>} <br> <br>void CStartUpWizard::DoDataExchange(CDataExchange* pDX) <br>{ <br>CPropertyPage::DoDataExchange(pDX); <br>//{{AFX_DATA_MAP(CStartUpWizard) <br>// NOTE: the ClassWizard will add DDX and DDV calls here <br>//}}AFX_DATA_MAP <br>} <br> <br> <br>BEGIN_MESSAGE_MAP(CStartUpWizard, CBaseWizard) <br>//{{AFX_MSG_MAP(CStartUpWizard) <br>//}}AFX_MSG_MAP <br>END_MESSAGE_MAP() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CStartUpWizard message handlers <br> <br>BOOL CStartUpWizard::OnInitDialog()  <br>{ <br>CPropertyPage::OnInitDialog(); <br> <br>return TRUE;  // return TRUE unless you set the focus to a control <br>              // EXCEPTION: OCX Property Pages should return FALSE <br>} <br> <br>BOOL CStartUpWizard::OnSetActive()  <br>{ <br>// TODO: Add your specialized code here and/or call the base class <br> <br>// TODO: Add your specialized code here and/or call the base class <br>    HWND hwnd = GetParent()-&gt;m_hWnd; <br>    ::SendMessage(hwnd, PSM_SETWIZBUTTONS, 0, PSWIZB_NEXT); <br> <br>return CPropertyPage::OnSetActive(); <br>} <br>///////////////////////////////////////////////////////////////////////////// <br>// CStartupWizard1 property page <br> <br>IMPLEMENT_DYNCREATE(CStartupWizard1, CBaseWizard) <br> <br>CStartupWizard1::CStartupWizard1() : CBaseWizard(CStartupWizard1::IDD) <br>{ <br>//{{AFX_DATA_INIT(CStartupWizard1) <br>// NOTE: the ClassWizard will add member initialization here <br>//}}AFX_DATA_INIT <br> <br>    m_psp97.dwFlags |= PSP_USEHEADERTITLE | PSP_USEHEADERSUBTITLE; <br>    m_psp97.pszHeaderTitle = _T("This is the title line"); <br>m_psp97.pszHeaderSubTitle = _T("This is the sub-title line"); <br>} <br> <br>CStartupWizard1::~CStartupWizard1() <br>{ <br>} <br> <br>void CStartupWizard1::DoDataExchange(CDataExchange* pDX) <br>{ <br>CPropertyPage::DoDataExchange(pDX); <br>//{{AFX_DATA_MAP(CStartupWizard1) <br>// NOTE: the ClassWizard will add DDX and DDV calls here <br>//}}AFX_DATA_MAP <br>} <br> <br> <br>BEGIN_MESSAGE_MAP(CStartupWizard1, CBaseWizard) <br>//{{AFX_MSG_MAP(CStartupWizard1) <br>//}}AFX_MSG_MAP <br>END_MESSAGE_MAP() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CStartupWizard1 message handlers <br> <br>BOOL CStartupWizard1::OnInitDialog()  <br>{ <br>CPropertyPage::OnInitDialog(); <br> <br>// TODO: Add extra initialization here <br> <br>return TRUE;  // return TRUE unless you set the focus to a control <br>              // EXCEPTION: OCX Property Pages should return FALSE <br>} <br> <br>BOOL CStartupWizard1::OnSetActive()  <br>{ <br>// TODO: Add your specialized code here and/or call the base class <br>    HWND hwnd = GetParent()-&gt;m_hWnd; <br>    ::SendMessage(hwnd, PSM_SETWIZBUTTONS, 0, PSWIZB_FINISH | PSWIZB_BACK); <br> <br>return CPropertyPage::OnSetActive(); <br>} <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
