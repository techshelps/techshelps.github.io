<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>README.TXT</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5878"></a>README.TXT</h2>
<pre><code><br>Sample: newjob <br>============== <br> <br>This sample illustrates the use of the SMS APIs in order to view, <br>create, and delete job folders. <br>There are four types of job folders: <br>        Run command on Workstation job <br>        Share package on Server job <br>        Remove package from Server job <br>        System job <br>All of these except system jobs can be created and deleted. <br> <br> <br>After logging on to a datasource, a job container is opened and populated. <br>No filtering is done since we want to see all the jobs that exist in the <br>system. <br>The program then enters a loop asking whether the user wants to view the <br>next job folder, delete the currently viewed folder, or create a new folder. <br> <br>Both deletion and creation are two-stage processes. Only when the <br>SmsCommitFolder API is called will the folder be either deleted from or <br>inserted into the datasource. <br> <br>Folder creation is handled in the CreateNewFolder function. <br>This creates an empty folder in the context of the parent which in this <br>case is the job container. The function then retrieves a description of <br>the folder via the SmsDescribeFolder API. This returns a FOLDER_INFO <br>structure which describes the folder in terms of its capabilities, see <br>the objectty.h header file (or the help file) for a full description of <br>this structure. <br> <br>Included in FOLDER_INFO is a pointer to an array of SCALAR_INFO structures. <br>Each SCALAR_INFO describes one of the folder's scalars. The information <br>contained here is: <br>        the scalar's name, <br>        its type, <br>        its access mode. <br>CreateNewFolder loops through this array, for each scalar that has modify or <br>create access, it displays the name and asks the user to fill in the value. <br>Only nominal checking is done on the values, a real application would have <br>to go into much greater detail since job creation is a non-trivial task. <br>If there are any errors in the date/time fields they are set to the current <br>date and time. <br> <br>This is a sample of a created workstation install job: <br> <br> <br>JS200009 (Workstation install job) contains 33 scalars <br>                           Job ID: JS200009 <br>                         Job type: microsoft\SMS\workstation_script <br>                      Job comment: a descriptive comment <br>                    Activate time: Thu Jun 22 15:12:00 1995 <br>                        Left icon: Package <br>                      Center icon: Machinegroup <br>                       Right icon: Site <br>                         Priority: 1 <br>                      Repeat mode: 1 <br>                      Cancel mode: 0 <br>                       Job status: 1 <br>                   Sending status: 1 <br>                   Working status: 1 <br>                    Cancel status: 1 <br>                       Package ID: JS200049 <br>                       Job target: 2 <br>                 Distribute phase: 1 <br>                       Send phase: 1 <br>                   Limit to sites: 2 <br>                 Include subsites: 1 <br>                  Site limit name: jonshu2site <br>             Distribution servers: me <br>                         WCL name: Audit software <br>                         Query ID: <br>               Machine group name: My machine group <br>                     Machine path: *|*|* <br>                       Offer time: Thu Jun 22 15:15:00 1995 <br>                   Mandatory time: Thu Jun 22 15:15:00 1995 <br>               Use mandatory time: 0 <br>             Force over slow link: 0 <br>                      Expire time: Thu Jun 22 15:15:00 1995 <br>                  Use expire time: 0 <br>          Run workstation command: 1 <br>============== JS200009 =========== <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
