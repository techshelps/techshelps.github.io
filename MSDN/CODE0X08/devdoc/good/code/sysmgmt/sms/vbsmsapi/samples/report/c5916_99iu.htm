<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GENERIC.BAS</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5916"></a>GENERIC.BAS</h2>
<pre><code>Attribute VB_Name = "GENERIC" <br>Option Explicit <br> <br>'//**************************************************************************** <br>'// <br>'//  Copyright (c) 1995, Microsoft Corporation <br>'// <br>'//  File:  GENERIC.BAS <br>'// <br>'//  History: <br>'// <br>'//      Gary Fuehrer, SEA   5/9/95      Created. <br>'// <br>'//**************************************************************************** <br> <br>Function NewGenericReportWindow%(hConnect&amp;, ByVal FileSpec$, ErrStr$) <br>    Dim i%, Ret&amp;, TempPath$, TempSpec$, frm As Form <br> <br>    'Default return value zero (Failed) <br>    NewGenericReportWindow% = 0 <br> <br>    'Allocate space for returned string <br>    TempSpec$ = String$(256, 0) <br> <br>    'Get a temp file name <br>    TempPath$ = Environ$("TEMP") <br>    Ret&amp; = GetTempFileName(TempPath$, "MDB", 0, TempSpec$) <br>    ErrStr$ = "Could not get a temporary file name for the new report." <br>    If (Ret&amp; = 0) Then Exit Function <br> <br>    'Clean up return string of null terminator <br>    i% = InStr(TempSpec$, Chr$(0)) <br>    If i% = 0 Then i% = Len(TempSpec$) + 1 <br>    TempSpec$ = left$(TempSpec$, i% - 1) <br> <br>    'Create a temporary document file <br>    On Error GoTo NewGenericReportWindowErr <br>    If FileSpec$ &gt; "" Then <br>        'File Open: so copy the file the user selected <br>        ErrStr$ = "Could not create a temporary copy of " + FileSpec$ + ".+" <br>        FileCopy FileSpec$, TempSpec$ <br>    Else <br>        'File New: so create a new empty document HERE <br>        ErrStr$ = "Could not create a temporary file for the new report." <br>    End If <br>    On Error GoTo 0 <br> <br>    'Pass the new document the file name to use <br>    InitReporthConnect&amp; = hConnect&amp; <br>    InitReportFileSpec$ = FileSpec$ <br>    InitReportTempSpec$ = TempSpec$ <br>    If InitReportFileSpec$ &lt;= "" Then InitReportNewNumber% = InitReportNewNumber% + 1 <br> <br>    'Create a new document window <br>    On Error GoTo NewGenericReportWindowErr <br>    ErrStr$ = "Could not create site report document window." <br>    Set frm = New frmGenericReport <br>    Load frm <br>    On Error GoTo 0 <br> <br>    'Register document window with MDI <br>     <br>    i% = RegisterReportWindow%(frm, ErrStr$) <br>    If i% &lt;= 0 Then GoTo NewGenericReportWindowErr <br> <br>    'Show the document window <br>    frm.Show <br>    NewGenericReportWindow% = i% <br>    Exit Function <br> <br>NewGenericReportWindowErr: <br>    On Error Resume Next <br>    If Not frm Is Nothing Then Unload frm <br>    Kill TempSpec$ <br>    Exit Function <br>End Function <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
