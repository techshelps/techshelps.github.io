<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MDIREPRT.BAS</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5923"></a>MDIREPRT.BAS</h2>
<pre><code>Attribute VB_Name = "basMDIReprt" <br>Option Explicit <br> <br>'//**************************************************************************** <br>'// <br>'//  Copyright (c) 1995, Microsoft Corporation <br>'// <br>'//  File:  MDIREPRT.BAS <br>'// <br>'//  History: <br>'// <br>'//      Gary Fuehrer, SEA   5/9/95      Created. <br>'// <br>'//**************************************************************************** <br> <br>'Types of reports that can be created <br>Global Const UNKNOWN_REPORT = 0 <br>Global Const SITE_HIERARCHY_REPORT = 1 <br>Global Const MACHINE_GROUP_REPORT = 2 <br>Global Const MACHINE_REPORT = 3 <br>Global Const GENERIC_REPORT = 4 <br> <br>'Size of one pixel in Twips (Set in MDIReport Form Load) <br>Global X_PIX_SIZE% <br>Global Y_PIX_SIZE% <br> <br>'Got this value from outline control error message 32002 <br>Global Const MAX_OUTLINE_ENTRIES = 6536 <br> <br>'Some constants for crystal reports <br>Global Const CRW_PRINT_TO_WINDOW = 0 <br>Global Const CRW_PRINT_TO_PRINTER = 1 <br>Global Const CRW_PRINT_TO_FILE = 2 <br> <br>'For MDIReport.bas and Report Forms ONLY! <br>Global Const MAX_REPORT_WINDOWS = 16 <br>Global ReportWindow(1 To MAX_REPORT_WINDOWS) As Form <br>Global InitReporthConnect&amp; <br>Global InitReportFileSpec$ <br>Global InitReportTempSpec$ <br>Global InitReportNewNumber% <br> <br>'For all report forms <br>Global gbNeedPrintDialog% <br>Sub FreeReportWindow(frm As Form) <br>    Dim i% <br> <br>    For i% = 1 To MAX_REPORT_WINDOWS <br>        If ReportWindow(i%) Is frm Then <br>            Set ReportWindow(i%) = Nothing <br>            Exit For <br>        End If <br>    Next i% <br>End Sub <br> <br>Sub Main() <br>    'Initialize the application <br>    If Init_SMSAPI() Then <br>        'Put up the main MDI form <br>        frmMDIReport.Show <br>    Else <br>        MsgBox "Error initializing application.  SMS Report can not run.", MB_OK + MB_ICONINFORMATION <br>    End If <br>End Sub <br> <br>Function RegisterReportWindow%(frm As Form, ErrStr$) <br>    Dim i% <br> <br>    'Find a free entry in ReportWindow array <br>    For i% = 1 To MAX_REPORT_WINDOWS <br>        If ReportWindow(i%) Is Nothing Then <br>            Set ReportWindow(i%) = frm <br>            RegisterReportWindow% = i% <br>            Exit Function <br>        End If <br>    Next i% <br> <br>    'Return value 0 (Failed) <br>    RegisterReportWindow% = 0 <br>    ErrStr$ = "Too many windows already open." <br>End Function <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
