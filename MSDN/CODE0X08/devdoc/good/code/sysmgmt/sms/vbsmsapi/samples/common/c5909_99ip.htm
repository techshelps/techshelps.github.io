<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROGRESS.FRM</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5911"></a>PROGRESS.FRM</h2>
<pre><code>VERSION 2.00 <br>Begin Form Progress  <br>   BorderStyle     =   3  'Fixed Double <br>   ClientHeight    =   1380 <br>   ClientLeft      =   1110 <br>   ClientTop       =   1470 <br>   ClientWidth     =   5550 <br>   DrawMode        =   10  'Not Xor Pen <br>   FillColor       =   &amp;H80000008&amp; <br>   Height          =   1785 <br>   Left            =   1050 <br>   LinkTopic       =   "Form2" <br>   ScaleHeight     =   1380 <br>   ScaleWidth      =   5550 <br>   Top             =   1125 <br>   Width           =   5670 <br>   Begin CommandButton Cancel  <br>      Cancel          =   -1  'True <br>      Caption         =   "Cancel" <br>      Height          =   315 <br>      Left            =   2100 <br>      TabIndex        =   1 <br>      Top             =   960 <br>      Width           =   1335 <br>   End <br>   Begin PictureBox PIC_Bar  <br>      BackColor       =   &amp;H00FFFFFF&amp; <br>      DrawMode        =   4  'Not Copy Pen <br>      FillColor       =   &amp;H00FF0000&amp; <br>      FillStyle       =   0  'Solid <br>      ForeColor       =   &amp;H00FF0000&amp; <br>      Height          =   375 <br>      Left            =   360 <br>      ScaleHeight     =   345 <br>      ScaleWidth      =   4845 <br>      TabIndex        =   0 <br>      Top             =   390 <br>      Width           =   4875 <br>      Begin PictureBox PIC_Percent  <br>         AutoRedraw      =   -1  'True <br>         BackColor       =   &amp;H00FFFFFF&amp; <br>         BorderStyle     =   0  'None <br>         DrawMode        =   10  'Not Xor Pen <br>         FillColor       =   &amp;H00FF0000&amp; <br>         ForeColor       =   &amp;H00FF0000&amp; <br>         Height          =   255 <br>         Left            =   2160 <br>         ScaleHeight     =   255 <br>         ScaleWidth      =   615 <br>         TabIndex        =   6 <br>         Top             =   60 <br>         Width           =   615 <br>      End <br>   End <br>   Begin Label Text  <br>      Alignment       =   2  'Center <br>      Height          =   195 <br>      Left            =   0 <br>      TabIndex        =   5 <br>      Top             =   120 <br>      Width           =   5535 <br>   End <br>   Begin Label Value  <br>      Caption         =   " 0" <br>      Height          =   195 <br>      Left            =   1380 <br>      TabIndex        =   4 <br>      Top             =   750 <br>      Visible         =   0   'False <br>      Width           =   2055 <br>   End <br>   Begin Label Max  <br>      Caption         =   " 100" <br>      Height          =   195 <br>      Left            =   3480 <br>      TabIndex        =   3 <br>      Top             =   750 <br>      Visible         =   0   'False <br>      Width           =   2055 <br>   End <br>   Begin Label Min  <br>      Caption         =   " 0" <br>      Height          =   195 <br>      Left            =   0 <br>      TabIndex        =   2 <br>      Top             =   750 <br>      Visible         =   0   'False <br>      Width           =   2055 <br>   End <br>End <br>Option Explicit <br> <br>Dim OldPer, CallingForm As Form <br> <br>'SetWindowPos() declaration <br>Declare Sub SetWindowPos Lib "User" (ByVal hWnd%, ByVal hWndInsertAfter%, ByVal x%, ByVal y%, ByVal cx%, ByVal cy%, ByVal fuFlags%) <br> <br>'SetWindowPos() and WINDOWPOS flags <br>Const SWP_NOSIZE = &amp;H1 <br>Const SWP_NOMOVE = &amp;H2 <br>Const SWP_NOZORDER = &amp;H4 <br>Const SWP_NOREDRAW = &amp;H8 <br>Const SWP_NOACTIVATE = &amp;H10 <br> <br>'SetWindowPos() hwndInsertAfter field values <br>Const HWND_TOP = 0 <br>Const HWND_BOTTOM = 1 <br>Const HWND_TOPMOST = -1 <br>Const HWND_NOTOPMOST = -2 <br> <br>Sub Cancel_Click () <br>   Cancel.Enabled = False <br>   Progress.Hide <br>End Sub <br> <br>Sub Form_Load () <br>   'Identify the calling form <br>   Set CallingForm = Screen.ActiveForm <br>    <br>   'Center form on currently active form <br>   Me.Left = CallingForm.Left + CallingForm.Width / 2 - Me.Width / 2 <br>   If Me.Left &lt; 0 Then Me.Left = 0 <br>   If Me.Left + Me.Width &gt; Screen.Width Then Me.Left = Screen.Width - Me.Width <br>   Me.Top = CallingForm.Top + CallingForm.Height / 4 - Me.Height / 2 <br>   If Me.Top &lt; 0 Then Me.Top = 0 <br>   If Me.Top + Me.Height &gt; Screen.Height Then Me.Top = Screen.Height - Me.Height <br> <br>   'Make form topmost <br>   SetWindowPos Me.hWnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOACTIVATE Or SWP_NOMOVE Or SWP_NOSIZE Or SWP_NOREDRAW <br> <br>   'Size and Center the PIC_Percent in the PIC_Bar <br>   PIC_Percent.Width = PIC_Percent.TextWidth("100%") <br>   PIC_Percent.Height = PIC_Percent.TextHeight("100%") <br>   PIC_Percent.Left = (PIC_Bar.Width - PIC_Percent.Width) / 2 <br>   PIC_Percent.Top = (PIC_Bar.Height - PIC_Percent.Height) / 2 <br> <br>   PIC_Percent.CurrentX = (PIC_Percent.Width - PIC_Percent.TextWidth("0%")) / 2 <br>   PIC_Percent.CurrentY = (PIC_Percent.Height - PIC_Percent.TextHeight("0%")) / 2 <br>   PIC_Percent.Print "0%" <br> <br>   'Enable the Cancel button <br>   Cancel.Enabled = True <br>End Sub <br> <br>Sub Form_Unload (Cancel As Integer) <br>    CallingForm.SetFocus <br>End Sub <br> <br>Sub Max_Change () <br>   Value_Change <br>End Sub <br> <br>Sub Min_Change () <br>   Value_Change <br>End Sub <br> <br>Sub PIC_Bar_Paint () <br>   OldPer = 0 <br>   Value_Change <br>End Sub <br> <br>Sub Value_Change () <br>   Dim Value, Min, Max, Per, Percent$, TempClr&amp;, x1%, x2% <br>    <br>   'Convert label captions into real values <br>   Value = Val(Me.Value) <br>   Min = Val(Me.Min) <br>   Max = Val(Me.Max) <br>    <br>   'Determine Percent complete and convert to a string <br>   If Value &lt; Min Then Value = Min <br>   If Value &gt; Max Then Value = Max <br>   If Min &lt; Max Then <br>      Per = (Value - Min) / (Max - Min) <br>      Percent$ = LTrim$(Str$(CInt(Per * 100))) + "%" <br>   Else <br>      Per = 1 <br>      Percent$ = "100%" <br>   End If <br>    <br>   'Quit early if no change <br>   If CInt(Per * 100) = CInt(OldPer * 100) Then <br>      DoEvents <br>      Exit Sub <br>   End If <br>    <br>   x1% = PIC_Bar.Width * OldPer <br>   x2% = PIC_Bar.Width * Per <br>    <br>   'Update percent text <br>   PIC_Percent.Cls <br>   PIC_Percent.CurrentX = (PIC_Percent.Width - PIC_Percent.TextWidth(Percent$)) / 2 <br>   PIC_Percent.CurrentY = (PIC_Percent.Height - PIC_Percent.TextHeight(Percent$)) / 2 <br>   PIC_Percent.Print Percent$ <br>    <br>   'Invert up to the end of the progress bar <br>   PIC_Percent.Line (-15, 0)-(x2% - PIC_Percent.Left, PIC_Percent.Height), PIC_Percent.FillColor, BF <br> <br>   'Now update the progress bar <br>   If x1% &gt; x2% Then <br>      'Going backwards, so erase the bar <br>      PIC_Bar.DrawMode = WHITENESS <br>      PIC_Bar.Line (x1%, 0)-(x2%, PIC_Bar.Height), , BF <br>      'Fix-up 1 pixel wide line (line drawn below) <br>      x1% = x2% <br>   End If <br>    <br>   'Set the bar if going forward, or fix-up if going backward <br>   PIC_Bar.DrawMode = COPY_PEN <br>   PIC_Bar.Line (x1%, 0)-(x2%, PIC_Bar.Height), , BF <br>    <br>   'Save current percent value and Do Events <br>   OldPer = Per <br>   DoEvents <br>End Sub <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
