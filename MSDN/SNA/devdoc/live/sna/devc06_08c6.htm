<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Integrated Link Service Setup Procedure</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sna_integrated_link_service_setup_procedure_dev"></a>Integrated Link Service Setup Procedure</h2>
<p>
For each link service selected by the operator, SNA Server Setup performs these operations. If you provide a custom IHV link service setup, it must do likewise.
<ol>
<li>
Copy the link service, device driver, and any detection DLL to the target server's \&lt;snaRoot&gt;\SYSTEM directory. These files do not need to be copied to \&lt;snaRoot&gt;\SYSTEM\HWSETUP, as was done in SNA Server 2.<i>x</i>.</li>
<li>
Copy the SNA Explorer configuration DLL (if any) to \&lt;snaRoot&gt;\SYSTEM\HWSETUP\&lt;cpu&gt;. Since the configuration DLL may be run from a management workstation of any CPU type, you should provide multiple flavors of the configuration DLL, even if your link service itself only supports a single CPU type.</li>
<li>
Add a registry entry to register your link service so that SNA Explorer can list your link service in the <b>Insert New Link Service</b> dialog box. This registry entry should be added to the following subkey:<p>
<b>SYSTEM\CurrentControlSet\Services\SnaBase\LinkServicesInstalled</b>
<p>
This is a new subkey for SNA Server 3.0 and later that contains one value for each link service chosen to be copied to the target server's hard disk during SNA setup. The value name and value data are as follows: 
<p>
<i>&lt;value&gt;</i>: REG_SZ: <i>&lt;configDllName&gt;</i>
<p>
where:
<p>
<i>&lt;value&gt;</i> is the friendly name of your link service, for example, "IBM SDLC Link Service".
<p>
<i>&lt;configDllName&gt;</i> is the file name and extension of the configuration DLL, for example, IBMSDCFG.DLL.
</li>
</ol>
<p>
<b>Note</b>  This registry entry is defined in the registry on the target server, not on the management workstation on which SNA Explorer happens to be invoked.</p>
<p>
Setup for SNA Server 3.0 and later asks for a list of link services to install, and copies only those link services to the target server. This speeds up setup and reduces the disk space required for SNA Server. Setup does not define a Windows NT service or other registry entries as was done in SNA Server 2.x; it merely copies files.</p>
<p>
There is an alternate way of calling the Link Service Configuration DLL if the link services from the vendor were not included with the released SNA Server CD-ROM. Depending on the setup tool used by the vendor, the vendor's setup software may not be able to read the registry and locate the directory where link services are installed. To resolve this problem, the SNA Manager scans the <b>LinkServicesInstalled</b> key prior to making the call to the Link Service Configuration DLL. The SNA Manager checks for a % character in the <i>configDllName</i> and if it exists \\ServerName will be prepended and the %s will contain the processor architecture (i386 or Alpha). The following example illustrates this:</p>
<p>
Under the <b>SYSTEM\CurrentControlSet\Services\SnaBase\LinkServicesInstalled</b> key,</p>
<p>
"Our Link Service Friendly Name" with a REG_SZ for the <i>configDllName</i> as follows:</p>
<p>
"share\%s\&lt;RelativePath and DLL Name&gt;"</p>
<p>&nbsp;</p></body>
</HTML>
