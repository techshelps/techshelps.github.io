<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows Considerations</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sna_windows_considerations_lua"></a>Windows Considerations</h2>
<p>
This section summarizes information for developing LUA applications on a Microsoft® Windows® version 3.<i>x</i> system.
<dl>
<dt>
<b>Load-time linking</b></dt>
<dd>
To be dynamically linked to LUA at load time, you must do one of the following at link time:
<ul>
<li>
Insert the following <b>IMPORTS</b> statements in the definition (.DEF) file used to link the application:<p>
(For RUI)
<pre><code>IMPORTS WINRUI.RUI
IMPORTS WINRUI WinRUI
IMPORTS WINRUI.WinRUIStartup
IMPORTS WINRUI.WinRUICleanup
 </code></pre>
<p>
(For SLI)
<pre><code>IMPORTS WINSLI.SLI
IMPORTS WINSLI.WinSLI
IMPORTS WINSLI.WinSLIStartup
IMPORTS WINSLI.WinSLICleanup
 </code></pre>
</li>
<li>
Link the application to WINRUI.LIB (for RUI) or WINSLI.LIB (for SLI), which contain the entry-point linkage information.</li>
</ul>
</dd>
<dt>
<b>Packing</b></dt>
<dd>
VCBs are not packed. As a result, DWORDs and WORDs are on WORD boundaries and BYTEs are on BYTE boundaries. This means, for example, that there is not a 2-byte gap between the primary and secondary return codes. VCBs should be accessed using the structures provided, and compiler options that change this packing method should be avoided.</dd>
<dt>
<b>Registering and deregistering applications</b></dt>
<dd>
All Windows LUA applications must call the Windows SNA extension function <a href="luac05_0bs1.htm"><b>WinRUIStartup</b></a> or <a href="luac05_74pt.htm"><b>WinSLIStartup</b></a> at the beginning of the session to register the application and <a href="luac05_42zl.htm"><b>WinRUICleanup</b></a> or <a href="luac05_0vxd.htm"><b>WinSLICleanup</b></a> at the end of the session to deregister the application.</dd>
<dt>
<b>Run-time linking</b></dt>
<dd>
For an application to be dynamically linked to LUA at run time, it must issue the following calls:
<ul>
<li>
Call the <b>LoadLibrary</b> function to dynamically load the WINRUI.DLL (for RUI) or WINSLI.DLL (for SLI) library module for Windows LUA.</li>
<li>
Call the <b>GetProcAddress</b> function to retrieve the address of each LUA function entry point that will be called in the DLL. For RUI, the function entry points are <a href="luac05_29b5.htm"><b>RUI</b></a>, <a href="luac05_5i8x.htm"><b>WinRUI</b></a>, <a href="luac05_0bs1.htm"><b>WinRUIStartup</b></a>, and <a href="luac05_42zl.htm"><b>WinRUICleanup</b></a>. For SLI, the function entry points are <a href="luac05_30gx.htm"><b>SLI</b></a>, <a href="luac05_69ep.htm"><b>WinSLI</b></a>, <a href="luac05_74pt.htm"><b>WinSLIStartup</b></a>, and <a href="luac05_0vxd.htm"><b>WinSLICleanup</b></a>.</li>
</ul>
</dd>
<dt>
<b>Simultaneous sessions</b></dt>
<dd>
An application can participate in as many as 16 sessions simultaneously in the Windows environment. However, if multiple LUA applications are active at the same time, the total number of sessions cannot exceed 16.
</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
