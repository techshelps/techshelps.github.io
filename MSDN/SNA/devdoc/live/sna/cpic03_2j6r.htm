<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Send_Error</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_send_error_cpic"></a>Send_Error</h1>
<p>
The <b>Send_Error</b> call (function name <b>cmserr</b>) notifies the partner program that the local program has encountered an application-level error.</p>
<pre><code><b>CM_ENTRY Send_Error(
  unsigned char FAR</b><i> *conversation_ID</i><b>,  </b>
<b>  CM_INT32 FAR</b><i> *request_to_send_received</i><b>,  </b>
<b>  CM_INT32 FAR</b><i> *return_code            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>conversation_ID</i></dt>
<dd>
Supplied parameter. Specifies the identifier for the conversation. The value of this parameter was returned by <a href="cpic03_0jhf.htm"><b>Initialize_Conversation</b></a> or <a href="cpic03_70df.htm"><b>Accept_Conversation</b></a>.</dd>
<dt>
<i>request_to_send_received</i></dt>
<dd>
Returned parameter. Specifies the request-to-send-received indicator. Possible values are:
<dl>
<dt>
CM_REQ_TO_SEND_RECEIVED</dt>
<dd>
The partner program issued <a href="cpic03_6crn.htm"><b>Request_To_Send</b></a>, which requests the local program to change the conversation to RECEIVE state.</dd>
<dt>
CM_REQ_TO_SEND_NOT_RECEIVED</dt>
<dd>
The partner program did not issue <b>Request_To_Send</b>. This value is not relevant if <i>return_code</i> is set to CM_PROGRAM_PARAMETER_CHECK or CM_STATE_CHECK.
</dd>
</dl>
</dd>
<dt>
<i>return_code</i></dt>
<dd>
The code returned from this call. The valid return codes are listed below.
</dd>
</dl>
<h4>Return Codes</h4>
<p>
The value of <i>return_code</i> varies depending on the conversation state when the call is issued.</p>
<h4>SEND State</h4>
<p>
If the program issues the call with the conversation in SEND state, the following return codes are possible:
<dl>
<dt>
cm_ok</dt>
<dd>
Primary return code; the call executed successfully.</dd>
<dt>
cm_operation_not_accepted</dt>
<dd>
Primary return code; a previous operation on this conversation is incomplete.</dd>
<dt>
cm_operation_incomplete</dt>
<dd>
Primary return code; the operation has not completed (processing mode is nonblocking only) and is still in progress. The program can issue <a href="cpic03_6un7.htm"><b>Wait_For_Conversation</b></a> to await the completion of the operation, or <a href="cpic03_017n.htm"><b>Cancel_Conversation</b></a> to cancel the operation and conversation. If <a href="cpic03_3kir.htm"><b>Specify_Windows_Handle</b></a> has been called, the application should wait for notification by a Windows message and not call <b>Wait_For_Conversation</b>.</dd>
<dt>
cm_product_specific_error</dt>
<dd>
Primary return code; a product-specific error occurred and has been logged in the product's error log.</dd>
<dt>
cm_conversation_type_mismatch</dt>
<dd>
Primary return code; the partner LU or program does not support the conversation type (basic or mapped) specified in the allocation request.</dd>
<dt>
cm_pip_not_specified_correctly</dt>
<dd>
Primary return code; the allocation request was rejected by a non-CPI-C LU 6.2 TP. The partner program requires one or more PIP data variables, which are not supported by CPI-C.</dd>
<dt>
cm_security_not_valid</dt>
<dd>
Primary return code; the user identifier or password specified in the allocation request was not accepted by the partner LU.</dd>
<dt>
cm_sync level_not_supported_pgm</dt>
<dd>
Primary return code; the partner program does not support the synchronization level specified in the allocation request.</dd>
<dt>
cm_tpn_not_recognized</dt>
<dd>
Primary return code; the partner LU does not recognize the program name specified in the allocation request.</dd>
<dt>
cm_tp_not_available_no_retry</dt>
<dd>
Primary return code; the partner LU cannot start the program specified in the allocation request because of a permanent condition. The reason for the error may be logged on the remote node. Do not retry the allocation until the error has been corrected.</dd>
<dt>
cm_tp_not_available_retry</dt>
<dd>
Primary return code; the partner LU cannot start the program specified in the allocation request because of a temporary condition. The reason for the error may be logged on the remote node. Retry the allocation.</dd>
<dt>
cm_program_error_purging</dt>
<dd>
Primary return code; one of the following occurred:
<ul>
<li>
While in RECEIVE or CONFIRM state, the partner program issued <b>Send_Error</b>. Data sent but not yet received is purged.</li>
<li>
While in SEND_PENDING state with the error direction set to CM_RECEIVE_ERROR, the partner program issued <b>Send_Error</b>. Data was not purged.</li>
</ul>
</dd>
<dt>
cm_resource_failure_no_retry</dt>
<dd>
Primary return code; one of the following occurred:
<ul>
<li>
The conversation was terminated prematurely because of a permanent condition. Do not retry until the error has been corrected.</li>
<li>
The partner program did not deallocate the conversation before terminating normally.</li>
</ul>
</dd>
<dt>
cm_resource_failure_retry</dt>
<dd>
Primary return code; the conversation was terminated prematurely because of a temporary condition, such as modem failure. Retry the conversation.</dd>
<dt>
cm_deallocated_abend</dt>
<dd>
Primary return code; the conversation has been deallocated for one of the following reasons:
<ul>
<li>
The remote program issued <a href="cpic03_5vkz.htm"><b>Deallocate</b></a> with the type parameter<i> </i>set to CM_DEALLOCATE_ABEND, or the remote LU has done so because of a remote program abnormal-ending condition. If the conversation for the remote program was in RECEIVE state when the call was issued, information sent by the local program and not yet received by the remote program is purged.</li>
<li>
The remote TP terminated normally but did not deallocate the conversation before terminating. Node services at the remote LU deallocated the conversation on behalf of the remote TP.</li>
</ul>
</dd>
<dt>
cm_deallocated_abend_svc</dt>
<dd>
Primary return code; the conversation has been deallocated for one of the following reasons:
<ul>
<li>
The partner program issued <b>Deallocate</b> with the type parameter set to ABEND_SVC.</li>
<li>
The partner program did not deallocate the conversation before terminating.</li>
</ul>

<p>
If the conversation is in RECEIVE state for the partner program when this call is issued by the local program, data sent by the local program and not yet received by the partner program is purged.
</dd>
<dt>
cm_deallocated_abend_timer</dt>
<dd>
Primary return code; the conversation has been deallocated because the partner program issued <b>Deallocate</b> with the type parameter set to ABEND_TIMER. If the conversation is in RECEIVE state for the partner program when this call is issued by the local program, data sent by the local program and not yet received by the partner program is purged.</dd>
<dt>
cm_svc_error_purging</dt>
<dd>
Primary return code; while in SEND state, the partner program or partner LU issued <b>Send_Error</b> with the type parameter set to SVC. Data sent to the partner program may have been purged.
</dd>
</dl>
<h4>RECEIVE State</h4>
<p>
If the call is issued in RECEIVE state, the following return codes are possible:
<dl>
<dt>
cm_ok</dt>
<dd>
Primary return code; because incoming information is purged when the <b>Send_Error</b> call is issued in RECEIVE state, cm_ok is generated instead of the following:
<p>
CM_PROGRAM_ERROR_NO_TRUNC

<p>
CM_PROGRAM_ERROR_PURGING

<p>
CM_SVC_ERROR_NO_TRUNC

<p>
CM_SVC_ERROR_PURGING

<p>
CM_PROGRAM_ERROR_TRUNC

<p>
CM_SVC_ERROR_TRUNC (basic conversation only)

<p>
CM_PRODUCT_SPECIFIC_ERROR

<p>
CM_RESOURCE_FAILURE_NO_RETRY

<p>
CM_RESOURCE_FAILURE_RETRY


<p>
For an explanation of these return codes, see <a href="cpicappa_140z.htm">Common Return Codes</a>.
</dd>
<dt>
cm_deallocated_normal</dt>
<dd>
Primary return code; because incoming information is purged when <b>Send_Error</b> is issued in RECEIVE state, cm_deallocated_normal is generated instead of the following:
<p>
CM_CONVERSATION_TYPE_MISMATCH

<p>
CM_PIP_NOT_SPECIFIED_CORRECTLY

<p>
CM_SECURITY_NOT_VALID

<p>
CM_SYNC_LEVEL_NOT_SUPPORTED_PGM

<p>
CM_TPN_NOT_RECOGNIZED

<p>
CM_TP_NOT_AVAILABLE_NO_RETRY

<p>
CM_TP_NOT_AVAILABLE_RETRY

<p>
CM_DEALLOCATED_ABEND

<p>
CM_DEALLOCATED_ABEND_SVC

<p>
CM_DEALLOCATED_ABEND_TIMER

</dd>
</dl>
<h4>SEND_PENDING State</h4>
<p>
If the call is issued in SEND_PENDING state, the following return codes are possible:</p>
<p class=indent1>
cm_ok (Primary return code; the call executed successfully.)</p>
<p class=indent1>
cm_product_specific_error</p>
<p class=indent1>
cm_program_error_purging</p>
<p class=indent1>
cm_resource_failure_no_retry</p>
<p class=indent1>
cm_resource_failure_retry</p>
<p class=indent1>
cm_deallocated_abend</p>
<p class=indent1>
cm_deallocated_abend_svc</p>
<p class=indent1>
cm_deallocated_abend_timer</p>
<p class=indent1>
cm_svc_error_purging</p>
<p>
For an explanation of these return codes, see <a href="cpicappa_140z.htm">Common Return Codes</a>.</p>
<h4>CONFIRM, CONFIRM_SEND, or CONFIRM_DEALLOCATE State</h4>
<p>
If the call is issued in CONFIRM, CONFIRM_SEND, or CONFIRM_DEALLOCATE state, the following return codes are possible:</p>
<p class=indent1>
cm_ok (Primary return code; the call executed successfully.)</p>
<p class=indent1>
cm_product_specific_error</p>
<p class=indent1>
cm_resource_failure_no_retry</p>
<p class=indent1>
cm_resource_failure_retry</p>
<p>
For an explanation of these return codes, see <a href="cpicappa_140z.htm">Common Return Codes</a>.</p>
<h4>Other States</h4>
<p>
Issuing <b>Send_Error</b> with the conversation in RESET or INITIALIZE state is illegal. The following return codes are possible:
<dl>
<dt>
cm_program_parameter_check</dt>
<dd>
Primary return code; the value specified by <i>conversation_ID</i> is invalid.</dd>
<dt>
cm_program_state_check</dt>
<dd>
Primary return code; the conversation state is not SEND, RECEIVE, CONFIRM, CONFIRM_SEND, CONFIRM_DEALLOCATE, or SEND_PENDING.
</dd>
</dl>
<h4>State Changes</h4>
<p>
The conversation can be in any state except INITIALIZE or RESET.</p>
<p>
State changes, summarized in the following table, are based on the value of the <i>return_code</i> parameter.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=66%><i>return_code</i></th>
<th align=left width=34%>New state</th>
</tr>
<tr valign=top>
<td width=66%>cm_ok</td>
<td width=34%>SEND</td>
</tr>
<tr valign=top>
<td width=66%>cm_conversation_type_mismatch</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_pip_not_specified_correctly</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_security_not_valid</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_sync_level_not_supported_pgm</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_tpn_not_recognized</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_tp_not_available_no_retry</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_tp_not_available_retry</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_resource_failure_retry</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_resource_failure_no_retry</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_deallocated_abend</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_deallocated_abend_prog</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_deallocated_abend_svc</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_deallocated_abend_timer</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_deallocated_normal</td>
<td width=34%>RESET</td>
</tr>
<tr valign=top>
<td width=66%>cm_program_error_purging</td>
<td width=34%>RECEIVE</td>
</tr>
<tr valign=top>
<td width=66%>cm_svc_error_purging</td>
<td width=34%>RECEIVE</td>
</tr>
<tr valign=top>
<td width=66%>All others</td>
<td width=34%>No change</td>
</tr>
</table><br>
<p>
Upon successful execution of this call, the conversation is in SEND state for the local program and in RECEIVE state for the partner program.</p>
<p>
In a basic conversation, the local program can use <a href="cpic03_50gz.htm"><b>Set_Log_Data</b></a> to specify that error log data be sent to the partner LU and added to the local error log. If the conversation's log data length characteristic is greater than zero, the LU formats the data and stores it in the send buffer.</p>
<p>
After <b>Send_Error</b> is completed, the log data length is set to zero and the log data to null.</p>
<p>
If the conversation is in RECEIVE state when the program issues <b>Send_Error</b>, incoming data is purged by CPI-C. This data includes:
<ul>
<li>
Data sent by <a href="cpic03_94ir.htm"><b>Send_Data</b></a>.</li>
<li>
Confirmation requests.</li>
<li>
Deallocation requests if the conversation's deallocate type is set to CM_DEALLOCATE_CONFIRM or to CM_DEALLOCATE_SYNC_LEVEL with the synchronization level set to CM_CONFIRM.</li>
</ul>
<p>
CPI-C does not<b> </b>purge an incoming request-to-send indicator.</p>
<p>
If the conversation is in SEND_PENDING state, the local program can issue <a href="cpic03_59cz.htm"><b>Set_Error_Direction</b></a> to specify whether the error being reported resulted from the received data or from the processing of the local program after successfully receiving the data.</p>
<h4>Remarks</h4>
<p>
The local program can use <b>Send_Error</b> for such purposes as informing the partner program of an error encountered in received data, rejecting a confirmation request, or truncating an incomplete logical record it is sending.</p>
<p>
<b>Send_Error</b> flushes the local LU's send buffer and sends the partner program the contents of the send buffer followed by the error notification.</p>
<p>
The error notification is sent to the partner as one of the following <i>return_code</i> values:
<ul>
<li>
<p>
CM_PROGRAM_ERROR_TRUNC
<p>
CM_PROGRAM_ERROR_NO_TRUNC
<p>
CM_PROGRAM_ERROR_PURGING
</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
