<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WinCSVStartup</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_wincsvstartup_appc"></a>WinCSVStartup</h1>
<p>
The <b>WinCSVStartup</b> function allows an application to specify the version of Windows CSV required and to retrieve details of the specific Windows CSV implementation. This function must be called by an application to register itself with a Windows CSV implementation before issuing any further Windows CSV calls.</p>
<p>
<b>int WINAPI WinCSVStartup(<br>
WORD</b><i> wVersionRequired</i><b>,</b> <br>
<b>LPWCSVDATA</b><i> lpwcsvdata<br>
</i><b>);</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>wVersionRequired</i></dt>
<dd>
Specifies the version of Windows CSV support required. The high-order byte specifies the minor version (revision) number; the low-order byte specifies the major version number. The current version of the Windows CSV API is 1.0.</dd>
<dt>
<i>lpwcsvdata</i></dt>
<dd>
A pointer to the CSV data structure. The <b>CSVDATA</b> structure is defined as follows:</dd>
<dt>
</dt>
<dd>

<pre><code>typedef struct tagWCSVDATA {
....WORD wVersion;
    char szDescription[WCSVDESCRIPTION_LEN+1];
}  CSVDATA, FAR * LPWCSVCDATA;
 </code></pre>
</dd>
<dt>
where <b>WCSVDESCRIPTION</b> is defined to be 127 and the structure members are as follows:</dt>
<dd>

<dl>
<dt>
<b>wVersion</b></dt>
<dd>
The version of Windows CSV supported. The high-order byte specifies the minor version (revision) number; the low-order byte specifies the major version number.</dd>
<dt>
<b>szDescription</b></dt>
<dd>
A description string identifying the vendor of the Windows CSV DLL.
</dd>
</dl>

<p>
This <b>lpwcsvdata</b> structure provides information about the underlying Windows CSV DLL implementation. The first <i>wVersion</i> field has the same structure as the <i>wVersionRequired</i> parameter, and the <i>szDescription</i> field contains a string identifying the vendor of the Windows CSV DLL. The description field is only meant to provide a display string for the application and should not be used to programmatically distinguish between Windows CSV implementations.

</dd>
</dl>
<h4>Return Values</h4>
<p>
The return value specifies whether the application was registered successfully and whether the Windows CSV implementation can support the specified version number. If the value is zero, it was registered successfully. Otherwise, the return value is one of the following:
<dl>
<dt>
wcsvsysnotrerady</dt>
<dd>
Indicates that the underlying network subsystem is not ready for network communication.</dd>
<dt>
wcsvvernotsupported</dt>
<dd>
The version of Windows CSV support requested is not provided by this particular Windows CSV implementation.</dd>
<dt>
wcsvinvalid</dt>
<dd>
The Windows CSV version specified by the application is not supported by this DLL.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To support future Windows CSV implementations and applications that may have functionality differences from Windows CSV version 1.0, a negotiation takes place in <b>WinCSVStartup</b>. An application passes to <b>WinCSVStartup</b> the Windows CSV version that it can use. If this version is lower than the lowest version supported by the Windows CSV DLL, the DLL cannot support the application and <b>WinCSVStartup</b> fails. If the version is not lower, however, the call succeeds and returns the highest version of Windows CSV supported by the DLL. If this version is lower than the lowest version supported by the application, the application either fails its initialization or attempts to find another Windows CSV DLL on the system.</p>
<p>
This negotiation allows both a Windows CSV DLL and a Windows CSV application to support a range of Windows CSV versions. An application can successfully use a DLL if there is any overlap in the versions. The following table illustrates how <b>WinCSVStartup</b> works in conjunction with different application and DLL versions.</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<th align=left width=18%>Application versions</th>
<th align=left width=20%><br>
DLL versions</th>
<th align=left width=23%>To WinCSVStartup</th>
<th align=left width=22%>From WinCSVStartup</th>
<th align=left width=17%><br>
Result</th>
</tr>
<tr valign=top>
<td width=18%>1.0</td>
<td width=20%>1.0</td>
<td width=23%>1.0</td>
<td width=22%>1.0</td>
<td width=17%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=18%>1.0, 2.0</td>
<td width=20%>1.0</td>
<td width=23%>2.0</td>
<td width=22%>1.0</td>
<td width=17%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=18%>1.0</td>
<td width=20%>1.0, 2.0</td>
<td width=23%>1.0</td>
<td width=22%>2.0</td>
<td width=17%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=18%>1.0</td>
<td width=20%>2.0, 3.0</td>
<td width=23%>1.0</td>
<td width=22%>WCSVINVALID</td>
<td width=17%>Fail</td>
</tr>
<tr valign=top>
<td width=18%>2.0, 3.0</td>
<td width=20%>1.0</td>
<td width=23%>3.0</td>
<td width=22%>1.0</td>
<td width=17%>App Fails</td>
</tr>
<tr valign=top>
<td width=18%>1.0, 2.0, 3.0</td>
<td width=20%>1.0, 2.0, 3.0</td>
<td width=23%>3.0</td>
<td width=22%>3.0</td>
<td width=17%>Use 3.0</td>
</tr>
</table><br>
<p>
After making its last Windows CSV call, an application should call <a href="appc09c_1mn7.htm"><b>WinCSVCleanup</b></a>.</p>
<p>
Each Windows CSV implementation must make a <b>WinCSVStartup</b> call before issuing any other Windows CSV calls. Consequently, this function can be used for initialization purposes.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
