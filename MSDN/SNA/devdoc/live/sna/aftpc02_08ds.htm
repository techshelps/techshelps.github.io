<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>aftp_dir_open</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_aftp_dir_open_aftp"></a>aftp_dir_open</h1>
<p>
The <b>aftp_dir_open</b> call begins a directory listing and specifies the file search parameters on the AFTP server. The <a href="aftpc02_6cmo.htm"><b>aftp_dir_read</b></a> call is used to read individual directory entries. The <a href="aftpc02_9bzk.htm"><b>aftp_dir_close</b></a> call is used to end the directory listing. A connection to the AFTP server must be established before using this call.</p>
<p>
See <a href="aftpc01_4nw0.htm">AFTP File and Directory Concept</a> for details on how the directory concept is handled for supported operating systems.</p>
<p>
<b>AFTP_ENTRY aftp_dir_open(<br>
IN AFTP_HANDLE_TYPE </b><i>connection_id</i><b>,<br>
IN unsigned char AFTP_PTR </b><i>filespec</i><b>,<br>
IN AFTP_LENGTH_TYPE </b><i>length</i><b>,<br>
IN AFTP_FILE_TYPE_TYPE </b><i>file_type</i><b>,<br>
IN AFTP_INFO_LEVEL_TYPE </b><i>info_level</i><b>,<br>
OUT unsigned char AFTP_PTR </b><i>path</i><b>,<br>
IN AFTP_LENGTH_TYPE </b><i>path_buffer_length</i><b>,<br>
OUT AFTP_LENGTH_TYPE AFTP_PTR </b><i>path_returned_length</i><b>,<br>
OUT AFTP_RETURN_CODE_TYPE AFTP_PTR </b><i>return_code<br>
</i><b>);</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>connection_id</i></dt>
<dd>
An AFTP connection object originally created with <a href="aftpc02_2nao.htm"><b>aftp_create</b></a>.</dd>
<dt>
<i>filespec</i></dt>
<dd>
The search string that the server uses to generate the directory listing. The files in the listing must match the search string. The format of this name can be either the native syntax on the AFTP server or the AFTP common naming convention described in the <i>APPC Application Suite User's Guide</i>. The file specified can be either an absolute or relative path name and can contain wildcard characters.</dd>
<dt>
<i>length</i></dt>
<dd>
The length of the <i>filespec</i> parameter in bytes.</dd>
<dt>
<i>file_type</i></dt>
<dd>
The type of information (directory names or file names) to be returned.
<dl>
<dt>
AFTP_FILE</dt>
<dd>
Only file entries.</dd>
<dt>
AFTP_DIRECTORY</dt>
<dd>
Only directory entries.</dd>
<dt>
AFTP_ALL_FILES</dt>
<dd>
Both file and directory entries.
</dd>
</dl>
</dd>
<dt>
<i>info_level</i></dt>
<dd>
The level and format of information to be returned about each file or directory entry.
<dl>
<dt>
AFTP_NATIVE_NAMES</dt>
<dd>
Native names without attributes.</dd>
<dt>
AFTP_NATIVE_ATTRIBUTES</dt>
<dd>
Native names and native file attributes.
</dd>
</dl>
</dd>
<dt>
<i>path</i></dt>
<dd>
The fully qualified directory name in which of all of the directory entries exist. The actual directory entries will be returned when the <a href="aftpc02_6cmo.htm"><b>aftp_dir_read</b></a> call is used. The path can be used along with the returned directory entry file name to create a fully qualified path name to use on another AFTP file call.
<p>
Use the AFTP_FILE_NAME_SIZE constant to define the length of this buffer. Add 1 to the size if you want to be able to add a null terminator to the text in the buffer.
</dd>
<dt>
<i>path_buffer_length</i></dt>
<dd>
The size in bytes of the buffer pointed to by the <i>path</i> parameter.</dd>
<dt>
<i>path_returned_length</i></dt>
<dd>
The number of bytes returned in the <i>path</i> parameter.</dd>
<dt>
<i>return_code</i></dt>
<dd>
The return code issued for this function. See <a href="aftpc03_5h0w.htm">AFTP Return Codes</a> for the list of possible return codes.
</dd>
</dl>
<h4>Example</h4>
<p>
See <a href="aftpc02_6cmo.htm"><b>aftp_dir_read</b></a> for a complete example showing the related calls <b>aftp_dir_open</b>, <b>aftp_dir_read</b>, and <b>aftp_dir_close</b>.</p>
<h4>Line Flows</h4>
<p>
Sends a request for a directory listing to the AFTP server and waits for a response that includes the fully specified path of the directory listing or an error indicator. If the path of the directory listing is received, the AFTP server sends all of the directory entries as well. When the list is complete, a special end-of-list indicator is sent to the AFTP client.</p>
<p>&nbsp;</p></body>
</HTML>
