<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WinCPICStartup</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_wincpicstartup_cpic"></a>WinCPICStartup</h1>
<p>
The <b>WinCPICStartup</b> function allows an application to specify the version of Windows CPI-C required and to retrieve details of the specific Windows CPI-C implementation. This function must be called by an application to register itself with a Windows CPI-C implementation before issuing any further Windows CPI-C calls.</p>
<p>
<b>INT WINAPI WinCPICStartup(</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=96%><b>&nbsp;&nbsp;&nbsp;&nbsp;WORD </b><i>wVersionRequired</i><b>,</b></td>
<td width=4%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=96%><b> &nbsp;&nbsp; LPWCPICDATA</b> <i>lpwcpicdata</i></td>
<td width=4%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=96%><b> &nbsp; );</b></td>
<td width=4%><pre></pre>
</td>
</tr>
</table><br>
<h4>Parameters</h4>
<dl>
<dt>
<i>wVersionRequired</i></dt>
<dd>
Specifies the version of Windows CPI-C support required. The high-order byte specifies the minor version (revision) number; the low-order byte specifies the major version number.</dd>
<dt>
<i>lpwcpicdata</i></dt>
<dd>
A pointer to the CPI-C data structure. The <b>CPICDATA</b> structure is defined as follows:
<pre><code>typedef struct {
....WORD wVersion;
    char szDescription[WCPICDESCRIPTION_LEN+1];
}  CPICDATA, FAR * LPWCPICDATA;
 </code></pre>

<p>
where WCPIDESCRIPTION is defined to 127 and the structure members are as follows:

<dl>
<dt>
<b>wVersion</b></dt>
<dd>
The version of Windows CPI-C supported. The high-order byte specifies the minor version (revision) number; the low-order byte specifies the major version number.</dd>
<dt>
<b>szDescription</b></dt>
<dd>
The description string describing the CPI-C version supported.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
The return value specifies whether the application was registered successfully and whether the Windows CPI-C implementation can support the specified version number. If the value is zero, it was registered successfully. Otherwise, the return value is one of the following:
<dl>
<dt>
wcpicsysnotrerady</dt>
<dd>
The underlying network subsystem is not ready for network communication.</dd>
<dt>
wcpicvernotsupported</dt>
<dd>
The version of Windows CPI-C support requested is not provided by this particular Windows CPI-C implementation.</dd>
<dt>
wcpicinvalid</dt>
<dd>
The Windows CPI-C version specified by the application is not supported by this DLL.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To support future Windows CPI-C implementations and applications that may have functionality differences from Windows CPI-C version 1.0, a negotiation takes place in <b>WinCPICStartup</b>. An application passes to <b>WinCPICStartup</b> the Windows CPI-C version that it can use. If this version is lower than the lowest version supported by the Windows CPI-C DLL, the DLL cannot support the application and the <b>WinCPICStartup</b> call fails. If the version is not lower, however, the call succeeds and returns the highest version of Windows CPI-C supported by the DLL. If this version is lower than the lowest version supported by the application, the application either fails its initialization or attempts to find another Windows CPI-C DLL on the system.</p>
<p>
This negotiation allows both a Windows CPI-C DLL and a Windows CPI-C application to support a range of Windows CPI-C versions. An application can successfully use a DLL if there is any overlap in the versions. The following table illustrates how <b>WinCPICStartup</b> works in conjunction with different application and DLL versions.</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<th align=left width=17%>Application<br>
versions</th>
<th align=left width=20%><br>
DLL versions</th>
<th align=left width=22%>To <br>
WinCPICStartup</th>
<th align=left width=23%>From <br>
WinCPICStartup</th>
<th align=left width=18%><br>
Result</th>
</tr>
<tr valign=top>
<td width=17%>1.0</td>
<td width=20%>1.0</td>
<td width=22%>1.0</td>
<td width=23%>1.0</td>
<td width=18%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=17%>1.0, 2.0</td>
<td width=20%>1.0</td>
<td width=22%>2.0</td>
<td width=23%>1.0</td>
<td width=18%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=17%>1.0</td>
<td width=20%>1.0, 2.0</td>
<td width=22%>1.0</td>
<td width=23%>2.0</td>
<td width=18%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=17%>1.0</td>
<td width=20%>2.0, 3.0</td>
<td width=22%>1.0</td>
<td width=23%>WCPICINVALID</td>
<td width=18%>Fail</td>
</tr>
<tr valign=top>
<td width=17%>2.0, 3.0</td>
<td width=20%>1.0</td>
<td width=22%>3.0</td>
<td width=23%>1.0</td>
<td width=18%>App Fails</td>
</tr>
<tr valign=top>
<td width=17%>1.0, 2.0, 3.0</td>
<td width=20%>1.0, 2.0, 3.0</td>
<td width=22%>3.0</td>
<td width=23%>3.0</td>
<td width=18%>Use 3.0</td>
</tr>
</table><br>
<p>
Details of the actual Windows CPI-C implementation are described in the <b>WHLLDATA</b> structure defined as follows:</p>
<pre><code>typedef struct tagWCPICDATA { WORD wVersion;
            char szDescription[WHLLDESCRIPTION_LEN+1];
            } WCPICDATA, FAR *LPWCPICDATA;
 </code></pre>
<p>
Having made its last Windows CPI-C call, an application should call the <a href="cpic04_455v.htm"><b>WinCPICCleanup</b></a><b> </b>routine. </p>
<p>
Each Windows CPI-C implementation must make a <b>WinCPICStartup</b> call before issuing any other Windows CPI-C calls.</p>
<p>&nbsp;</p></body>
</HTML>
