<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADO Recordset Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_ado_recordset_object_oledb"></a>ADO Recordset Object</h1>
<p>
The ADO Recordset object represents the entire set of records from a base table. At any time, the Recordset object only refers to a single record within the set as the current record.</p>
<p>
The following Recordset object methods, properties, and collections are supported by the current version of the Microsoft® OLE DB Provider for AS/400 and VSAM:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Name</th>
<th align=left width=68%>Comment</th>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_9vfm.htm"><b>AddNew</b></a> method</td>
<td width=68%>Creates a new record for an updatable Recordset object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_4p2a.htm"><b>CancelBatch</b></a> method</td>
<td width=68%>Cancels a pending batch update.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_9vfn.htm"><b>CancelUpdate</b></a> method</td>
<td width=68%>Cancels any changes made to a current record or to a new record prior to calling the <b>UpdateBatch</b> method.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_2ele.htm"><b>Clone</b></a> method</td>
<td width=68%>Creates a duplicate Recordset object from an existing Recordset object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_1d2a.htm"><b>Close</b></a> method</td>
<td width=68%>Closes an open object and any dependent objects.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_5bvm.htm"><b>Delete</b></a> method</td>
<td width=68%>Deletes the current record in an open Recordset object or an object from a collection.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_11ia.htm"><b>Find</b></a> method</td>
<td width=68%>Finds the next record to match a condition (ADO 1.5).</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_2ndu.htm"><b>GetRows</b></a> method</td>
<td width=68%>Retrieves multiple records of a Recordset into an array.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_2fhe.htm"><b>Move</b></a> method</td>
<td width=68%>Moves the position of the current record in a Recordset object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_58iq.htm"><b>MoveFirst</b></a> method</td>
<td width=68%>Moves to the first record in a specified Recordset.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_76ci.htm"><b>MoveLast</b></a> method</td>
<td width=68%>Moves to the last record in a specified Recordset.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_6oo2.htm"><b>MoveNext</b></a> method</td>
<td width=68%>Moves to the next record in a specified Recordset.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_6swy.htm"><b>MovePrevious</b></a> method</td>
<td width=68%>Moves to the previous record in a specified Recordset.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_7ko2.htm"><b>Open</b></a> method</td>
<td width=68%>Opens a cursor on a Recordset.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_28de.htm"><b>Requery</b></a> method</td>
<td width=68%>Updates the data in a Recordset object by re-executing the query on which the object is based (equivalent to calling the <b>Close</b> and <b>Open</b> methods in succession).</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_98ma.htm"><b>Supports</b></a> method</td>
<td width=68%>Determines whether a specified Recordset object supports a particular type of function.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_6fs2.htm"><b>Update</b></a> method</td>
<td width=68%>Saves any changes you make to the current record of a Recordset object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_23tu.htm"><b>UpdateBatch</b></a> method</td>
<td width=68%>Writes all pending batch updates to disk.</td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%></td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_2ezm.htm"><b>ActiveConnection</b></a> property</td>
<td width=68%>Sets or returns which Connection object the specified Recordset object currently belongs to.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_2fs2.htm"><b>BOF</b></a> property</td>
<td width=68%>Indicates if the current record position is before the first record in a Recordset object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_46le.htm"><b>Bookmark</b></a> property</td>
<td width=68%>Returns a bookmark that uniquely identifies the current record in a Recordset object or sets the current record in a Recordset object identified by a valid bookmark.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_81nm.htm"><b>CacheSize</b></a> property</td>
<td width=68%>Sets or returns the number of records from a Recordset object that are cached locally in memory. </td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_7exu.htm"><b>CursorLocation</b></a> property</td>
<td width=68%>Sets or returns the location of the cursor (whether the cursor is on the client or the server side).</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_55ya.htm"><b>CursorType</b></a> property</td>
<td width=68%>Sets or returns the type of cursor used in a Recordset object. Only the <b>adOpenDynamic CursorType</b> is supported by the current version of the OLE DB Provider for AS/400 and VSAM.</td>
</tr>
<tr valign=top>
<td width=32%><b>EditMode</b> property</td>
<td width=68%>Indicates the editing status of the current record type. </td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_5l9e.htm"><b>EOF</b></a> property</td>
<td width=68%>Indicates if the current record position is after the last record in a Recordset object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_8kbm.htm"><b>Filter</b></a> property</td>
<td width=68%>Indicates a filter for data in a Recordset (revised in ADO 1.5).</td>
</tr>
<tr valign=top>
<td width=32%><b>LockType</b> property</td>
<td width=68%>Sets or returns the types of locks placed on records during editing. All four lock types (<b>adLockReadOnly</b>,<b> adLockOptimistic</b>,<b> adLockPessimistic</b>,<b> </b>and <b>adLockBatchOptimistic</b>) are supported by the OLE DB Provider for AS/400 and VSAM.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_9uxu.htm"><b>Sort</b></a> property</td>
<td width=68%>Indicates the column names and order to sort data in a Recordset object (new property in ADO 1.5).</td>
</tr>
<tr valign=top>
<td width=32%><b>Source</b> property</td>
<td width=68%>Sets or returns the source (table name) for the data in a Recordset.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_7882.htm"><b>State</b></a> property</td>
<td width=68%>Describes the current state of an object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_72oy.htm"><b>Status</b></a> property</td>
<td width=68%>Indicates the status of the current record with respect to batch updates or other bulk operations.</td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%></td>
</tr>
<tr valign=top>
<td width=32%>Fields collection</td>
<td width=68%>Collections of fields on the Recordset.</td>
</tr>
<tr valign=top>
<td width=32%>Properties collection</td>
<td width=68%>Collections of properties on the Recordset.</td>
</tr>
</table><br>
<p>
The syntax supported by the OLE DB Provider for AS/400 and VSAM to open a recordset (table) using the Recordset.<b>Open</b> method is as follows:</p>
<p>
<b>EXEC OPEN <i>TableName</i></b></p>
<p>
where <i>TableName</i> represents one of the following host file naming conventions.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Host file type</th>
<th align=left width=60%>File naming convention</th>
</tr>
<tr valign=top>
<td width=40%>VSAM Data Sets</td>
<td width=60%>DATASETNAME.FILENAME</td>
</tr>
<tr valign=top>
<td width=40%>Partitioned Data Sets</td>
<td width=60%>DATASETNAME.FILENAME(MEMBER)</td>
</tr>
<tr valign=top>
<td width=40%>OS/400 Files</td>
<td width=60%>LIBRARY/FILE</td>
</tr>
<tr valign=top>
<td width=40%>OS/400 Files</td>
<td width=60%>LIBRARY/FILE.NAME</td>
</tr>
<tr valign=top>
<td width=40%>OS/400 File Members</td>
<td width=60%>LIBRARY/FILE(MEMBER) </td>
</tr>
<tr valign=top>
<td width=40%>OS/400 File Members </td>
<td width=60%>LIBRARY/FILE.NAME(MEMBER)</td>
</tr>
</table><br>
<p>
Note that if a member of a library contains a dot in the member name, the member name must be surrounded by double quotes. For example, if the member name is NAMES.DAT the proper syntax for command text  used  for the Recordset.open method is as follows:</p>
<p>
EXEC OPEN LIBRARY/FILE("NAMES.DAT")</p>
<p>
The Recordset <b>Bookmark</b> method is supported for the following AS/400 files:</p>
<p class=indent1>
<font face="Symbol">·</font>KSDS if the file has a unique key</p>
<p class=indent1>
<font face="Symbol">·</font>RRDS</p>
<p>
The Recordset <b>AddNew</b> method can only be used on ESDS files on the AS/400 when you are positioned at the end of the Recordset object (file). With KSDS files on the AS/400, the <b>AddNew </b>method adds new records by key. With RRDS or Alternate Index files on the AS/400, the <b>AddNew </b>method can be used to add records when at the end of the Recordset object or by key. </p>
<p>
In order to use the Recordset <b>Find</b> method or the <b>Filter</b> property, an AS/400 logical file or a mainframe KSDS or RRDS file must be used. If these methods or properties are used on an AS/400 physical file or any other mainframe file type, then the method fails.</p>
<p>
The Recordset <b>Sort</b> property is used with an open Recordset object based on an AS/400 physical file. The <b>Sort</b> property allows the user to indicate which logical view to apply to an AS/400 physical file. The logical view must be a valid index specified in the description of the AS/400 physical file. The logical view is provided by the AS/400 logical file. The OLE DB Provider for AS/400 and VSAM responds to the <b>Sort</b> property request by first closing the open physical file, and then opening the logical file that points back to the data in the physical file.</p>
<p>
The Recordset <b>Sort </b>property is only supported on AS/400 hosts. If the user opens a Recordset object based on an AS/400 logical file, then there is probably no need to use Recordset.<b>Sort</b>. For performance reasons, applications should be written to open the AS/400 logical file first, because the overhead is so much greater when opening a physical file first.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
