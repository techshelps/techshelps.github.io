<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Find Method</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_find_method_oledb"></a>Find Method</h1>
<p>
The <b>Find</b> method on a Recordset object locates or seeks to the next record in a Recordset object that meets a particular condition and makes this the current record. This method can be used to seek to a specific record in a Recordset object based on a where clause (similar to an SQL where clause) defined by the user. </p>
<pre><code><b>recordset.Find</b> <i>Criteria</i>, <i>SkipRecords</i>, <i>SearchDirection</i>, <i>Start</i>
</code></pre>
<h4>Parameters</h4>
<p>
ADO supports four arguments for the <b>Find</b> method, but the last three arguments are optional and have default values as noted following: 
<dl>
<dt>
<i>Criteria</i></dt>
<dd>
This BSTR parameter specifies the criteria used for locating or seeking to a record in a Recordset object.</dd>
<dt>
<i>SkipRecords</i></dt>
<dd>
This optional parameter specifies a Long that indicates the number of records to skip (whether to skip the current record) when locating a record in a Recordset object. The default value for this argument is 0 (don't skip the current record). The first time a <b>Find</b> method is used, this argument is usually set to 0 (the default). On subsequent calls to this method to seek other records that meet this condition, this argument would normally be set to 1, to skip one record forward before finding the next record that matches the search <i>Criteria</i>. A negative value for this parameter is not supported by the OLE DB Provider for AS/400 and VSAM.</dd>
<dt>
<i>SearchDirection</i></dt>
<dd>
This optional parameter is an enumeration that specifies the direction for the search. It can be one of the following enumerated values for <b>SearchDirectionEnum</b>:
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Enumeration</th>
<th align=left width=14%>Value</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=31%><b>adSearchForward</b></td>
<td width=14%>0</td>
<td width=55%>Search forward from the current record.</td>
</tr>
<tr valign=top>
<td width=31%><b>adSearchBackward</b></td>
<td width=14%>1</td>
<td width=55%>Search backward from the current record. This option is not supported by the OLE DB Provider for AS/400 and VSAM.</td>
</tr>
</table><br>


<p>
This optional argument defaults to <b>adSearchForward</b>.
</dd>
<dt>
<i>Start</i></dt>
<dd>
This optional parameter specifies the starting location for a search, which can be a bookmark or an enumeration indicating the current, first, or last record in a Recordset object. This argument is a Variant and can be either a bookmark or one of the following enumerated values for <b>BookmarkEnum</b>:
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Enumeration</th>
<th align=left width=13%>Value</th>
<th align=left width=54%>Description</th>
</tr>
<tr valign=top>
<td width=33%><b>adBookmarkCurrent</b></td>
<td width=13%>0</td>
<td width=54%>The current record.</td>
</tr>
<tr valign=top>
<td width=33%><b>adBookmarkFirst</b></td>
<td width=13%>1</td>
<td width=54%>The first record.</td>
</tr>
<tr valign=top>
<td width=33%><b>adBookmarkLast</b></td>
<td width=13%>2</td>
<td width=54%>The last record.</td>
</tr>
</table><br>


<p>
This optional argument defaults to <b>adBookmarkCurrent</b>.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The first parameter is the only required argument for the <b>Find</b> method. All of the other arguments are optional and have default values. This first argument is a single-condition where clause. The construction of a single-condition where clause consists of a column name (the database field), an operator (greater than or equal, for example), and a literal value. </p>
<p>
Examples of acceptable single-condition where clauses are as follows:
<ul>
<li>
recordset.Find, "Cost &gt; 10000.00"</li>
<li>
recordset.Find, "Cost &lt; 100.00"</li>
<li>
recordset.Find, "Cost = 5000.00"</li>
<li>
recordset.Find, "LastName = 'Jones' "</li>
</ul>
<p>
Note that variables cannot be used as substitutes for literal values. If the file has multiple keys in the index, using the "=" operator will always fail since the values of all keys cannot be specified. </p>
<p>
In order to use the Recordset <b>Find</b> method, an AS/400 logical file or a mainframe KSDS or RRDS file must be used. If this method is used on an AS/400 physical file or any other mainframe file type, then this method fails.</p>
<p>
The <i>Start</i> parameter must not be specified on any mainframe file that is marked as supporting bookmarks. If the <i>Start</i> parameter is specified the <b>Find</b> method will return an error. The error string returned is "The application is using a value of the wrong type for the current operation". This results from a limitation with the current implementation of ADO.</p>
<p>
If the <a href="thorref4_7exu.htm"><b>CursorLocation</b></a> property is set to <b>adUseClient</b> (use the client cursor engine), the <b>Filter</b> method will work if MDAC 2.0 is installed but will not work properly with earlier versions of ADO.</p>
<p>&nbsp;</p></body>
</HTML>
