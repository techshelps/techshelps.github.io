<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Filter Property</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_filter_property_oledb"></a>Filter Property</h1>
<p>
The <b>Filter</b> property on a Recordset object indicates a filter for data in a Recordset. This property sets or returns a Variant value.</p>
<pre><code><b>recordset.Filter</b> <b>=</b> <i>Criteria</i>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Criteria</i></dt>
<dd>
This parameter specifies a Variant and can be either a criteria (a where clause) or one of the following enumerated values for <b>FilterGroupEnum</b>:
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Enumeration</th>
<th align=left width=12%>Value</th>
<th align=left width=50%>Description</th>
</tr>
<tr valign=top>
<td width=38%><b>adFilterNone</b></td>
<td width=12%>0</td>
<td width=50%>No filter. This value removes the current filter and restores all records to view.</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterPendingRecords</b></td>
<td width=12%>1</td>
<td width=50%>Use the pending records. This value allows viewing only those records that have changed but have not yet been sent to the server. This value is only applicable for batch update mode.</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterAffectedRecords</b></td>
<td width=12%>2</td>
<td width=50%>Use only records affected by the last <b>Delete</b>, <b>Resync</b>, <b>UpdateBatch</b>, or <b>CancelBatch</b> call.</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterFetchedRecords</b></td>
<td width=12%>3</td>
<td width=50%>Use the last fetched records. This value allows viewing the records in the current cache returned as a result of the last call to retrieve records (implying a resynchronization).</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterPredicate</b></td>
<td width=12%>4</td>
<td width=50%></td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
When the <b>Filter</b> property is used with a criteria, the where clause is a combination of triplets. Each triplet consists of a column name, an operator, and a literal value. These where clause triplets can be combined with <b>AND</b>s and <b>OR</b>s for more complex logical filters. </p>
<p>
If <i>Criteria </i>is a single-condition where clause, then any operator can be used. The construction of a single-condition where clause consists of a column name (the database field), an operator (greater than or equal, for example), and a literal value.</p>
<p>
Examples of a single-condition where clause is as follows:
<ul>
<li>
recordset.Filter = "LastName = 'Jones' "</li>
<li>
recordset.Filter ="Salary &gt; 30000.0"</li>
</ul>
<p>
The <i>Criteria </i>argument can be a two-condition with the following restrictions:
<ul>
<li>
If the column name (the database field) is the same in both clauses, then the separate where clauses must define a contiguous range.</li>
<li>
If the column names are different, then the operators must be the same. If the operators are "LIKE", then the filtered region may be unexpected.</li>
</ul>
<p>
Examples of acceptable two-condition where clauses are as follows:
<ul>
<li>
recordset.Filter =  "LastName = 'Jones' <b>AND</b> FirstName = 'Tom' "</li>
<li>
recordset.Filter = "Cost = 5000.00 <b>OR</b> Cost &gt; 5000.00 "</li>
</ul>
<p>
The <i>Criteria </i>argument can be three or more conditions with the following restrictions:
<ul>
<li>
The operators must be the same for all conditions. If the operators are "LIKE", then the filtered region may be unexpected.</li>
</ul>
<p>
In all cases, if the "=" operator is used, then the column names specified in the where clause must be keyed columns in the file. </p>
<p>
One restriction on these combinations is that <b>OR</b> clauses can only be used at the highest (major) level of the logical operation. </p>
<p>
Examples of acceptable <i>Criteria</i> meeting these conditions are:
<ul>
<li>
recordset.Filter = "(Title='Manager' <b>AND</b> Salary&gt;30000) <b>OR</b> (Title='Administrator' <b>AND</b> Salary&gt;50000)"</li>
<li>
recordset.Filter ="Salary &gt; 30000.0"</li>
</ul>
<p>
An example of illegal <i>Criteria</i> is:
<ul>
<li>
recordset.Filter = "(Title='Associate' <b>OR</b> Salary &gt;30000) <b>AND</b> (Title='Administrator')"</li>
</ul>
<p>
The operator can also use wildcards (* or %) in character expressions as follows:
<ul>
<li>
recordset.Filter = "Lastname LIKE '*SMITH*'"</li>
</ul>
<p>
In order to use the Recordset <b>Filter</b> property, an AS/400 logical file or a mainframe KSDS or RRDS file must be used. If this property is used on an AS/400 physical file or any other mainframe file type, then this property fails.</p>
<p>
To determine if any records were found meeting the <i>Criteria</i>, the application should check the Recordset <b>EOF</b> property. If <b>EOF</b> is true, then no records were found meeting the where clause specified in the <i>Criteria</i> parameter.</p>
<p>
Under some circumstances, the Recordset <b>Filter</b> property will not work properly. These situations can occur if the Recordset <b>Filter</b> is set and then the resulting data is examined immediately. The Recordset still contains all of the original records. Hence, <b>RecordCount</b> property returns the total number of records in the Recordset. This problem does not occur if other statements such as a MsgBox are executed immediately before setting the <b>Filter</b> property<b>.</b></p>
<p>
If the <a href="thorref4_7exu.htm"><b>CursorLocation</b></a> property is set to <b>adUseClient</b> (use the client cursor engine), the <b>Filter</b> property will work if MDAC 2.0 is installed but will not work properly with earlier versions of ADO.</p>
<p>&nbsp;</p></body>
</HTML>
