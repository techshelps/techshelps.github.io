<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SLI_BIND_ROUTINE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_sli_bind_routine_lua"></a>SLI_BIND_ROUTINE</h1>
<p>
The <b>SLI_BIND_ROUTINE</b> verb notifies the Windows LUA application that a BIND request has come from the host and allows the user-supplied routine to examine the request and formulate a response.</p>
<p>
The following structure describes the <b>LUA_COMMON</b> member of the VCB used by <b>SLI_BIND_ROUTINE</b>.</p>
<pre><code>struct LUA_COMMON {
    unsigned short    lua_verb;
    unsigned short    lua_verb_length;
    unsigned short    lua_prim_rc;
    unsigned long     lua_sec_rc;
    unsigned short    lua_opcode;
    unsigned long     lua_correlator;
    unsigned char     lua_luname[8];
    unsigned short    lua_extension_list_offset;
    unsigned short    lua_cobol_offset;
    unsigned long     lua_sid;
    unsigned short    lua_max_length;
    unsigned short    lua_data_length;
    char FAR *        lua_data_ptr;
    unsigned long     lua_post_handle;
    struct LUA_TH     lua_th;
    struct LUA_RH     lua_rh;
    struct LUA_FLAG1  lua_flag1;
    unsigned char     lua_message_type;
    struct LUA_FLAG2  lua_flag2; 
    unsigned char     lua_resv56[7];
    unsigned char     lua_encr_decr_option;
};
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>lua_verb</b></dt>
<dd>
Supplied parameter. Contains the verb code, LUA_VERB_SLI for SLI verbs.</dd>
<dt>
<b>lua_verb_length</b></dt>
<dd>
Supplied parameter. Specifies the length in bytes of the LUA VCB. It must contain the length of the verb record being issued.</dd>
<dt>
<b>lua_prim_rc</b></dt>
<dd>
Primary return code set by LUA at the completion of the verb. The valid return codes vary depending on the LUA verb issued.</dd>
<dt>
<b>lua_sec_rc</b></dt>
<dd>
Secondary return code set by LUA at the completion of the verb. The valid return codes vary depending on the LUA verb issued.</dd>
<dt>
<b>lua_opcode</b></dt>
<dd>
Supplied parameter. Contains the LUA command code (verb operation code) for the verb to be issued, LUA_OPCODE_SLI_BIND_ROUTINE.</dd>
<dt>
<b>lua_correlator</b></dt>
<dd>
Supplied parameter. Contains a user-supplied value that links the verb with other user-supplied information. LUA does not use or change this information. This parameter is optional.</dd>
<dt>
<b>lua_luname</b></dt>
<dd>
Supplied parameter. Specifies the ASCII name of the local LU used by the Windows LUA session.
<p>
<b>SLI_BIND_ROUTINE</b> only requires this parameter if <b>lua_sid</b> is zero.

<p>
This parameter is eight bytes long, padded on the right with spaces (0x20) if the name is shorter than eight characters.
</dd>
<dt>
<b>lua_extension_list_offset</b></dt>
<dd>
Not used by <b>SLI_BIND_ROUTINE</b> and should be set to zero.</dd>
<dt>
<b>lua_cobol_offset</b></dt>
<dd>
Not used by LUA in Microsoft® SNA Server and should be zero.</dd>
<dt>
<b>lua_sid</b></dt>
<dd>
Supplied parameter. Specifies the session identifier and is returned by <a href="luac04_7bxd.htm"><b>SLI_OPEN</b></a> and <a href="luac03_37z5.htm"><b>RUI_INIT</b></a>. Other verbs use this parameter to identify the session used for the command. If other verbs use the <b>lua_luname</b> parameter to identify sessions, set the <b>lua_sid</b> parameter to zero.</dd>
<dt>
<b>lua_max_length</b></dt>
<dd>
Not used by <b>SLI_BIND_ROUTINE</b> and should be set to zero. </dd>
<dt>
<b>lua_data_length</b></dt>
<dd>
Returned parameter. Specifies the length of the BIND RU data returned in the data buffer. </dd>
<dt>
<b>lua_data_ptr</b></dt>
<dd>
For the <b>SLI_BIND_ROUTINE</b> this parameter contains the address of the BIND RU. </dd>
<dt>
<b>lua_post_handle</b></dt>
<dd>
Supplied parameter. Used under Microsoft® Windows NT® and Microsoft® Windows® 95 if asynchronous notification is to be accomplished by events. This variable contains the handle of the event to be signaled or a window handle.
<p>
For all other environments, this parameter is reserved and should be set to zero.
</dd>
<dt>
<b>ua_th</b></dt>
<dd>
Supplied parameter. Contains the SNA transmission header (TH) of the message received. Various subparameters are returned for read and bid functions.</dd>
<dt>
<b>lua_rh</b></dt>
<dd>
Supplied parameter. Contains the SNA request/response header (RH) of the message sent or received.</dd>
<dt>
<b>lua_flag1</b></dt>
<dd>
Supplied parameter. Contains a data structure containing flags for messages supplied by the application.</dd>
<dt>
<b>lua_message_type</b></dt>
<dd>
Supplied parameter. Specifies the type of SNA data or command sent to the host.</dd>
<dt>
<b>lua_flag2</b></dt>
<dd>
Returned parameter. Contains flags for messages returned by LUA. 
<dl>
<dt>
<b>lua_flag2.async</b></dt>
<dd>
Indicates that the LUA interface verb completed asynchronously if set to 1.</dd>
<dt>
<b>lua_flag2.sscp_exp </b></dt>
<dd>
Indicates SSCP expedited flow if set to 1.</dd>
<dt>
<b>lua_flag2.sscp_norm</b></dt>
<dd>
Indicates SSCP normal flow if set to 1.</dd>
<dt>
<b>lua_flag2.lu_exp</b></dt>
<dd>
Indicates LU expedited flow if set to 1.</dd>
<dt>
<b>lua_flag2.lu_norm</b></dt>
<dd>
Indicates LU normal flow if set to 1.
</dd>
</dl>
</dd>
<dt>
<b>lua_resv56</b></dt>
<dd>
Reserved and should be set to zero.</dd>
<dt>
<b>lua_encr_decr_option</b></dt>
<dd>
Not used by <b>SLI_BIND_ROUTINE</b> and should be set to zero.
</dd>
</dl>
<h4>Return Codes</h4>
<dl>
<dt>
LUA_OK</dt>
<dd>
Primary return code; the verb executed successfully.
<dl>
<dt>
LUA_SEC_OK</dt>
<dd>
Secondary return code; no additional information exists for LUA_OK.
</dd>
</dl>
</dd>
<dt>
LUA_NEGATIVE_RSP</dt>
<dd>
Primary return code; either the LUA sent a negative response to a message received from the primary LU because an error was found in the message, or the application responded negatively to a chain for which the end-of-chain has arrived.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>SLI_BIND_ROUTINE</b> provides a mechanism for the Windows LUA application to examine BIND requests that are received from the host. The Windows LUA uses a user-supplied DLL to notify the Windows LUA application that a BIND request has been received. The user-supplied DLL routine then examines the contents of the BIND and formulates a response for the request.</p>
<p>
The DLL name for the routine is provided as extensions of the <a href="luac04_7bxd.htm"><b>SLI_OPEN</b></a> verb's VCB. The <b>lua_extension_list_offset</b> parameter provides the offset from the start of the VCB to the first name in the extension list.</p>
<p>
The Windows LUA interface assigns storage space where the VCB is structured. The VCB of <b>SLI_BIND_ROUTINE</b> contains <b>lua_th</b> and <b>lua_rh</b>. The address of the BIND RU is specified in <b>lua_data_ptr</b> and the length of the RU is specified in <b>lua_data_length</b>.</p>
<p>
When <b>SLI_BIND_ROUTINE</b> returns to the Windows LUA, processing of <b>SLI_BIND_ROUTINE</b> is completed. The BIND response should overwrite the BIND RU. When the BIND is accepted, the primary return code should be set to LUA_OK. If the BIND is rejected, the primary return code should be set to LUA_NEGATIVE_RSP and the BIND buffer contains the negative sense code. The <b>lua_data_ptr</b> parameter should not be modified.</p>
<p>
If a negative response is returned from <b>SLI_BIND_ROUTINE</b>, <a href="luac04_7bxd.htm"><b>SLI_OPEN</b></a> is canceled. The <b>lua_prim_rc</b> of the <b>SLI_OPEN</b> is set to LUA_SESSION_FAILURE, and the<b> lua_sec_rc</b> is set to LUA_NEG_RSP_FROM_BIND_ROUTINE.</p>
<h4>See Also</h4>
<p>
<a href="luac03_37z5.htm"><b>RUI_INIT</b></a>, <a href="luac03_4joh.htm"><b>RUI_PURGE</b></a>, <a href="luac03_7dwh.htm"><b>RUI_READ</b></a>, <a href="luac03_7uap.htm"><b>RUI_WRITE</b></a>, <a href="luac04_7bxd.htm"><b>SLI_OPEN</b></a>, <a href="luac04_75i9.htm"><b>SLI_PURGE</b></a>, <a href="luac04_2nfl.htm"><b>SLI_RECEIVE</b></a>, <a href="luac04_2lr5.htm"><b>SLI_SEND</b></a></p>
<p>&nbsp;</p></body>
</HTML>
