<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WinRUIStartup</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_winruistartup_lua"></a>WinRUIStartup</h1>
<p>
The <b>WinRUIStartup</b> function allows an application using RUI verbs to specify the version of Windows LUA required and to retrieve details of the specific Windows LUA implementation. This function must be called by an application to register itself with a Windows LUA implementation before issuing any further Windows LUA calls.</p>
<pre><code><b>int WINAPI WinRUIStartup(
  WORD</b><i> wVersionRequired</i><b>,  </b>
<b>  LUADATA FAR</b><i> *lpLuaData  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wVersionRequired</i></dt>
<dd>
Specifies the version of Windows LUA support required. The high-order byte specifies the minor version (revision) number; the low-order byte specifies the major version number.</dd>
<dt>
<i>lpLuaData</i></dt>
<dd>
Pointer to the <b>LUADATA</b> structure containing the returned version number information. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
The return code specifies whether the application was registered successfully and whether the Windows LUA implementation can support the specified version number. If the value is zero, it was registered successfully and the specified version can be supported. Otherwise, the return code is one of the following:
<dl>
<dt>
WLUASYSNOTREADY</dt>
<dd>
The underlying network subsystem is not ready for network communication.</dd>
<dt>
WLUAVERNOTSUPPORTED</dt>
<dd>
The version of Windows LUA support requested is not provided by this particular Windows LUA implementation.</dd>
<dt>
WLUAINVALID</dt>
<dd>
The Windows LUA version specified by the application is not supported by this DLL.</dd>
<dt>
WLUAFAILURE</dt>
<dd>
A failure occurred while the Windows LUA DLL was initializing. This usually occurs because an operating system call failed.</dd>
<dt>
WLUAINITREJECT</dt>
<dd>
<b>WinRUIStartup</b> was called multiple times.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To support future Windows LUA implementations and applications that may have functionality differences, a negotiation takes place in <b>WinRUIStartup</b>. An application passes to <b>WinRUIStartup </b>the Windows LUA version that it can use. If this version is lower than the lowest version supported by the Windows LUA DLL, the DLL cannot support the application and <b>WinRUIStartup</b> fails. If the version is not lower, however, the call succeeds and returns the highest version of Windows LUA supported by the DLL. If this version is lower than the lowest version supported by the application, the application either fails its initialization or attempts to find another Windows LUA DLL on the system.</p>
<p>
This negotiation allows both a Windows LUA DLL and a Windows LUA application to support a range of Windows LUA versions. An application can successfully use a DLL if there is any overlap in the versions. The following table illustrates how <b>WinRUIStartup</b> works in conjunction with different application and DLL versions:</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<th align=left width=18%>App versions</th>
<th align=left width=18%>DLL versions</th>
<th align=left width=27%>To<br>
WinRUIStartup</th>
<th align=left width=22%>From<br>
WinRUIStartup</th>
<th align=left width=15%><br>
Result</th>
</tr>
<tr valign=top>
<td width=18%>1.0</td>
<td width=18%>1.0</td>
<td width=27%>1.0</td>
<td width=22%>1.0</td>
<td width=15%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=18%>1.0, 2.0</td>
<td width=18%>1.0</td>
<td width=27%>2.0</td>
<td width=22%>1.0</td>
<td width=15%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=18%>1.0</td>
<td width=18%>1.0, 2.0</td>
<td width=27%>1.0</td>
<td width=22%>2.0</td>
<td width=15%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=18%>1.0</td>
<td width=18%>2.0, 3.0</td>
<td width=27%>1.0</td>
<td width=22%>WLUAINVALID</td>
<td width=15%>Fail</td>
</tr>
<tr valign=top>
<td width=18%>2.0, 3.0</td>
<td width=18%>1.0</td>
<td width=27%>3.0</td>
<td width=22%>1.0</td>
<td width=15%>App fails</td>
</tr>
<tr valign=top>
<td width=18%>1.0, 2.0, 3.0</td>
<td width=18%>1.0, 2.0, 3.0</td>
<td width=27%>3.0</td>
<td width=22%>3.0</td>
<td width=15%>Use 3.0</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;The application that uses RUI verbs must call <b>WinRUIStartup</b> prior to issuing any other LUA commands. However, <b>WinRUIStartup</b> needs to be called only once per application. If it is called multiple times, the subsequent calls will be rejected.</p>
<p>
Details of the actual LUA implementation are described in the <b>WLUADATA</b> structure, defined as follows:</p>
<pre><code>typedef struct { WORD wVersion;
            char szDescription[WLUADESCRIPTION_LEN+1];
            } LUADATA;
 </code></pre>
<p>
Having made its last Windows LUA call, an application should call the <b>WinRUICleanup</b> routine.</p>
<p>
Each LUA application that uses RUI verbs must make a <b>WinRUIStartup </b>call before issuing any other LUA calls.</p>
<h4>See Also</h4>
<p>
<a href="luac05_42zl.htm"><b>WinRUICleanup</b></a></p>
<p>&nbsp;</p></body>
</HTML>
