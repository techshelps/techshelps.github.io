<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Confirmation Processing</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sna_confirmation_processing_cpic"></a>Confirmation Processing</h2>
<p>
The sequence of events for confirmation processing is as follows:
<ol>
<li>
Establish the synchronization level.</li>
<li>
Send a confirmation request.</li>
<li>
Receive data and confirmation request.</li>
<li>
Respond to the confirmation request.</li>
<li>
Deallocate the conversation.</li>
</ol>
<p>
Using confirmation processing, a TP sends a confirmation request with the data; the partner TP confirms receipt of the data or indicates that an error occurred. Each time the two TPs exchange a confirmation request and response, they are synchronized.</p>
<p>
<b>Note</b>&nbsp;&nbsp;Although the example in this section does not show this, any TP can send or receive data, regardless of whether the TP is the invoking TP or the invokable TP.</p>
<p>
The following example illustrates confirmation processing.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left colspan=2 width=48%>Issued by the invoking TP</th>
<th align=left width=52%>Issued by the invokable TP</th>
</tr>
<tr valign=top>
<td colspan=3 width=100%></td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre><code>Initialize_Conversation</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre><code>Set_Sync_Level
  (<i>sync_level</i>=CM_CONFIRM)</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre><code>Allocate</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre><code>Send_Data</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre><code>Confirm</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre></pre>
</td>
<td width=52%><pre><code>Accept_Conversation</code></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre></pre>
</td>
<td width=52%><pre><code>Receive
    (data_received=
      CM_COMPLETE_DATA_RECEIVED)
    (status_received=
      CM_CONFIRM_RECEIVED)</code></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=48%><pre></pre>
</td>
<td width=52%><pre><code>Confirmed</code></pre>
</td>
</tr>
<tr valign=top>
<td width=47%><pre><code>(<i>return_code</i>=CM_OK)</code></pre>
</td>
<td colspan=2 width=53%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=47%><pre><code>Send_Data</code></pre>
</td>
<td colspan=2 width=53%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=47%><pre><code>Deallocate</code></pre>
</td>
<td colspan=2 width=53%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=47%><pre></pre>
</td>
<td colspan=2 width=53%><pre><code>Receive</code></pre>
</td>
</tr>
<tr valign=top>
<td width=47%><pre></pre>
</td>
<td colspan=2 width=53%><pre><code>(status_received=
      CM_CONFIRM_DEALLOC_RECEIVED)</code></pre>
</td>
</tr>
<tr valign=top>
<td width=47%><pre></pre>
</td>
<td colspan=2 width=53%><pre><code>Confirmed</code></pre>
</td>
</tr>
<tr valign=top>
<td width=47%><pre><code>(return_code=CM_OK)</code></pre>
</td>
<td colspan=2 width=53%><pre></pre>
</td>
</tr>
</table><br>
<h4>Establishing the Synchronization Level</h4>
<p>
The <a href="cpic03_3fvn.htm"><b>Set_Sync_Level</b></a> call lets you override the default synchronization level of the conversation. The synchronization level is one of the conversation's characteristics. There are two possible synchronization levels:
<ul>
<li>
CM_CONFIRM, under which the TPs can request confirmation of receipt of data and respond to such requests.</li>
<li>
CM_NONE, the default, under which confirmation processing does not occur.</li>
</ul>
<p>
The <a href="cpic03_0jhf.htm"><b>Initialize_Conversation</b></a> call sets the default characteristics of a conversation. There are several calls that begin with <b>Set_</b>. These calls let you override the default conversation characteristics.</p>
<h4>Sending a Confirmation Request</h4>
<p>
Issuing the <a href="cpic03_5q8z.htm"><b>Confirm</b></a> call has two effects:
<ul>
<li>
It flushes the local LU's send buffer and sends any data contained in the buffer to the partner TP.</li>
<li>
It sends a confirmation request that the partner TP receives through the <i>status_received</i> parameter of a <a href="cpic03_3vhf.htm"><b>Receive</b></a> call.</li>
</ul>
<p>
After issuing <b>Confirm</b>, the local TP waits for confirmation from the partner TP.</p>
<h4>Receiving a Confirmation Request</h4>
<p>
The <i>status_received</i> parameter of the <a href="cpic03_3vhf.htm"><b>Receive</b></a> call indicates any future action required by the local TP.</p>
<p>
In the example, the first <b>Receive</b> has a <i>status_received</i> of CM_CONFIRM_RECEIVED, indicating that a confirmation is required before the partner TP can continue.</p>
<h4>Responding to a Confirmation Request</h4>
<p>
The partner TP issues the <a href="cpic03_6c6b.htm"><b>Confirmed</b></a> call to confirm receipt of data. This frees the local TP to resume processing.</p>
<h4>Deallocating the Conversation</h4>
<p>
Because the synchronization level of the conversation is set to CM_CONFIRM, <a href="cpic03_5vkz.htm"><b>Deallocate</b></a> sends a confirmation request with the data flushed from the buffer.</p>
<p>
For the second <a href="cpic03_3vhf.htm"><b>Receive</b></a> call, <i>status_received</i> is CM_CONFIRM_DEALLOC_RECEIVED, indicating that the partner TP requires a confirmation, generated by the <a href="cpic03_6c6b.htm"><b>Confirmed</b></a> call, before the conversation can be deallocated.</p>
<p>&nbsp;</p></body>
</HTML>
