<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows INF-Based Setup</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_windows_infminusbased_setup_dev"></a>Windows INF-Based Setup</h1>
<p>
This section describes link service setup using the older Microsoft® Windows NT® Setup Engine, which was designed to maximize versatility and minimize the work required to produce robust, full-featured setup programs. The engine contains most of the functions that a setup program might need and provides a scripting language similar to Basic in which entire setup programs can be written. For more information about this language, see the reference manual <i>Microsoft Windows 3.1 GUI Setup Toolkit</i>, Chapter 3, "The .INF File." </p>
<p>
The Microsoft® SNA Server version 2.11 main setup program used such a script (as did the setup program for older versions of Microsoft® Windows NT®). As part of setting up SNA Server 2.11, the user chooses and installs support for various kinds of link services. Each type of link service comes with its own script, which is called from the main SNA Server setup program as a subroutine to perform all the tasks required for setting up that particular link.</p>
<p>
Installing any link service requires that some common steps be performed; beyond these, the installation process can vary widely among different link types. For example, while the IBM DFT link service setup script needs to install a device driver for the DFT card, the 802.2 link service relies on the existing Token Ring or Ethernet adapter and does not need to install a device driver—but the 802.2 link service setup script does have to install the DLC transport if it is not already installed. Having some degree of commonality allows all link service setup scripts to share the same basic format and keeps the interface to the main SNA Server setup script relatively simple.</p>
<p>
Since each SNA link service is actually part of the machine's "network ensemble," the SNA Server setup script and the link service setup scripts are designed to work with the Windows NT Network Control Panel Applet (NCPA). Adapter cards, device drivers, and link services for SNA communications that have been installed and configured by the SNA Server setup program can be configured from the NCPA as well.</p>
<p>
You are not required to write your entire link service setup program as an .INF script. The actual script might merely launch a custom executable program to perform the installation; in this case the script provides the interface to the main SNA Server setup script. In addition, you can create custom DLLs that contain code and resources for doing certain setup jobs. The Windows NT Setup Engine already has such a DLL (SETUPDLL.DLL in the SYSTEM32 subdirectory of the root directory for Windows NT), which contains many useful setup functions.</p>
<p>
The available documentation for the Setup Engine, the scripting language, and the support DLL is sparse at best. However, much can be learned by examining the existing .INF files both for SNA Server Setup (in the \SYSTEM\HWSETUP and root directories of your SNA Server tree) and for Windows NT itself (in the SYSTEM32 subdirectory of the root directory for Windows NT). Note that the main entry point for an .INF script is the [Shell Commands] section. You can list the contents of the support DLL with the command:</p>
<p>
<b>LINK32 -DUMP -EXPORTS SETUPDLL.DLL</b></p>
<p>
and search the scripts for calls to <b>LoadLibrary</b> and <b>LibraryProcedure</b>.</p>
<p>&nbsp;</p></body>
</HTML>
