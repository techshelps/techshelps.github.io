<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Presentation Header Support in Data Transfers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_sna_presentation_header_support_in_data_transfers_appc"></a>Presentation Header Support in Data Transfers</h3>
<p>
For basic conversations, Sync Point commands are sent by means of presentation headers (PS) across LU 6.2 conversations using the <a href="appc05b_7wbn.htm"><b>SEND_DATA</b></a> or <a href="appc05b_8iub.htm"><b>MC_SEND_DATA</b></a> verb. All presentation headers contain length fields that specify a length of 1, which is usually illegal. To support Sync Point conversations, the following modifications are made to the SNA Server presentation services component:
<ul>
<li>
On basic conversations with a <b>synclevel</b> of AP_SYNCPT, data transferred specifying a general data stream (GDS) variable length of 1 will not be rejected. If the <b>synclevel</b> is not AP_SYNCPT, they will be rejected as before.</li>
<li>
On mapped conversations, PS headers will not be wrapped as mapped conversation application data logical records (with GDS identifier 0x12FF) when they are sent, or have the GDS header stripped off when they are received.</li>
<li>
On mapped conversations, it is the responsibility of the application to provide the compete PS header including the length field. Similarly, the length field will be included in PS header data returned by receive verbs.</li>
</ul>
<p>
To achieve the latter the <a href="appc05b_8iub.htm"><b>MC_SEND_DATA</b></a> verb and the receive verbs (<a href="appc05a_3jvn.htm"><b>MC_RECEIVE_AND_POST</b></a>, <a href="appc05a_5qlf.htm"><b>MC_RECEIVE_AND_WAIT</b></a>, and <a href="appc05a_2dib.htm"><b>MC_RECEIVE_IMMEDIATE</b></a>) require modifications as follows:
<ul>
<li>
A new parameter, <b>data_type</b>, is added to the <b>MC_SEND_DATA</b> verb. When this is set to AP_APPLICATION (the default, 0x00), the data is sent as application data (GDS identifier 0x12FF) as usual. When it is set to AP_PS_HEADER, the data is sent as described above.</li>
<li>
The following two new values are added for the <b>what_rcvd</b> member of the receive verbs to specify that the received data is a PS header:<p class=indent1>
AP_PS_HEADER_COMPLETE</p>
<p class=indent1>
AP_PS_HEADER_INCOMPLETE.</p>
</li>
<li>
If an application issues a receive verb with <b>rtn_status</b> set to AP_YES, SNA Server will return status in combination with AP_PS_HEADER_COMPLETE, with the exception of AP_DEALLOCATE_NORMAL and AP_CONFIRM_DEALLOCATE. This is to prevent the conversation being prematurely disconnected from the LU 6.2 session when a COMMIT PS header arrives with the end of conversation indication.</li>
</ul>
<p>
It is the responsibility of the vendor-supplied Sync Point support component to convert these PS headers into the appropriate Sync Point return codes (for example, TAKE_SYNCPT).</p>
<p>&nbsp;</p></body>
</HTML>
