<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Issuing an APPC Verb</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sna_issuing_an_appc_verb_appc"></a>Issuing an APPC Verb</h2>
<p>
The following procedure is required to issue a blocking APPC verb. In the sample code, the verb issued is <b>MC_SEND_DATA</b>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To issue a blocking APPC verb</h5>
<ol>
<li>
Create a structure variable from the VCB structure that applies to the APPC verb to be issued.<pre><code>#include &lt;winappc.h&gt;
    .
    .
struct mc_send_data  mcsend;
 </code></pre>
<p>
The VCB structures are declared in WINAPPC.H; one of these structures is:
<pre><code>mc_send_data
 </code></pre>
</li>
<li>
Clear (set to zero) the variables within the VCB structure.<pre><code>memset( mcsend, '\0', sizeof( mcsend ) );
 </code></pre>
</li>
<li>
Assign values to the VCB variables that supply information to APPC.<pre><code>mcsend.opcode = AP_M_SEND_DATA;
mcsend.opext = AP_MAPPED_CONVERSATION;
memcpy( mcsend.tp_id, tp_id, sizeof( tp_id ) );
mcsend.conv_id = conv_id;
mcsend.dlen = datalen;
mcsend.dptr = sharebufptr;
 </code></pre>
<p>
The values AP_MAPPED_CONVERSATION and AP_M_SEND_DATA are symbolic constants representing integers. These constants are defined in WINAPPC.H.
</li>
<li>
Invoke the <b>APPC</b> function. The only parameter is a pointer to the address of the structure containing the VCB for the desired verb.<pre><code>APPC ( ( long ) (void FAR * ) &amp;mcsend );
 </code></pre>
<p>
Use <a href="appc06_66sj.htm"><b>WinAsyncAPPC</b></a> if you are running the application under Windows version 3.<i>x</i>.
<p>
To call <b>WinAsyncAPPC</b>:
<pre><code>HANDLE WINAPI WinAsyncAPPC (hWnd, 1pVCB)
 </code></pre>
<p>
When the asynchronous operation is complete, the application's window <i>hWnd</i> receives the message returned by <b>RegisterWindowMessage</b> with "WinAsyncAPPC" as the input string.
</li>
<li>
Use the variables that were returned by APPC.<pre><code>if( mcsend.primary_rc != AP_OK ) 
/* Do error routine */
    .
    .
    .</code></pre>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
