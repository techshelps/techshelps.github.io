<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetAppcConfig</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_getappcconfig_appc"></a>GetAppcConfig</h1>
<p>
The <b>GetAppcConfig</b> function provides an asynchronous entry point for retrieving the remote systems to which a particular local LU can connect.</p>
<p>
<b>HANDLE WINAPI GetAppcConfig(</b><br>
<b>HANDLE</b> <i>hWnd</i><b>,</b><br>
<b>LPSTR</b> <i>pLocalLu</i><b>,</b><br>
<b>LPSTR</b> <i>pMode</i><b>,</b><br>
<b>LPINT</b> <i>pNumRemLu</i><b>,</b><br>
<b>INT</b> <i>iMaxRemLu</i><b>,</b><br>
<b>PSTR</b> <i>pRemLu</i><b>,</b><br>
<b>LPINT</b> <i>pAsyncRetCode<br>
</i><b>);</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>hWnd</i></dt>
<dd>
Supplied parameter. Contains the handle of the window that is to receive an asynchronous completion message when the call has completed. If non-null, the completion message will be posted to this window handle. In this case, <i>pAsyncRetCode</i> (the last parameter) must be null. Asynchronous message completion is the recommended approach for a Windows applications to use this function. </dd>
<dt>
<i>pLocalLu</i></dt>
<dd>
Supplied parameter. Specifies the address of a buffer containing the local LU name for which information is returned. This local LU name must be specified as follows:
<ul>
<li>
Nonpadded</li>
<li>
Null-terminated</li>
<li>
ASCII string</li>
<li>
Maximum length of eight bytes (excluding the terminator)</li>
</ul>

<p>
To request that the user's default local LU be used, the buffer should contain eight spaces followed by a null.
</dd>
<dt>
<i>pMode</i></dt>
<dd>
Supplied parameter. Specifies the address of a buffer containing the mode name for which information is returned. In Microsoft® SNA Server version 3.0 and later this parameter is not used, but for compatibility with earlier versions of SNA Server a mode name must be specified as follows:
<ul>
<li>
Nonpadded</li>
<li>
Null-terminated</li>
<li>
ASCII string</li>
<li>
Maximum length of eight bytes (excluding the terminator)</li>
</ul>
</dd>
<dt>
<i>pNumRemLu</i></dt>
<dd>
Supplied parameter. Specifies the address of an integer variable that when the function completes will contain the number of remote LUs that would have been returned, had the buffer specified by <i>pRemLu</i> been large enough to accommodate all of the remote LUs.</dd>
<dt>
<i>iMaxRemLu</i></dt>
<dd>
Supplied parameter. Specifies the number of remote LU names that can be held by the buffer indicated by <i>pRemLu</i>.</dd>
<dt>
<i>pRemLu</i></dt>
<dd>
Supplied parameter. Specifies the address of the buffer that will hold the remote LU names after the function completes. The information will be returned as an array of strings. Each remote LU name will be stored in the buffer as follows:
<ul>
<li>
Nonpadded</li>
<li>
Null-terminated</li>
<li>
ASCII string</li>
<li>
Maximum length of eight bytes (excluding the terminator)</li>
</ul>

<p>
The strings start every nine bytes in the buffer, and thus (<i>pRemLu</i> + (<i>i</i>–1)*9) gives the start of the <i>i</i>th string. In the case where the buffer is too small to hold all the names, only <i>iMaxRemLu</i> strings will be returned.
</dd>
<dt>
<i>pAsyncRetCode</i></dt>
<dd>
Supplied parameter. Specifies the address of an integer variable used to store the return code from this function, if the supplied address is non-null. The return codes will be the same as those returned by an asynchronous completion message. While the call is completing, the value of the this variable will be APPC_CFG_PENDING. When this asynchronous call is completed, the value of this variable will contain some return code other than APPC_CFG_PENDING.
<p>
This variable is used by polling for completion when asynchronous message completion to a window handle is not used. 

<p>
Note that if <i>pAsyncRetCode</i> is used, <i>hWnd</i> must be null.

</dd>
</dl>
<h4>Return Values</h4>
<p>
The meaning of the immediate return value depends on whether or not the asynchronous request was accepted. To test for acceptance, evaluate the expression:</p>
<p>
(&lt;<i>Returned Handle</i>&gt; &amp; APPC_CFG_SUCCESS)</p>
<p>
If the expression is FALSE, the request was rejected. The return value is then one of the synchronous return codes in the following list. If the expression is TRUE, the request was accepted, and one of the following cases will apply.
<ul>
<li>
If <i>hWnd</i> was non-null, a completion message will arrive in the following form:</li>
</ul>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Message <br>
parameter</th>
<th align=left width=80%><br>
Description</th>
</tr>
<tr valign=top>
<td width=20%><i>hWnd</i></td>
<td width=80%>The handle of the target window. This value is the same as the value passed in <i>hWnd</i> on the initial call.</td>
</tr>
<tr valign=top>
<td width=20%><i>uMsg</i></td>
<td width=80%>Matches the number returned by a call to <b>RegisterWindowMessage</b>, with WinAppcCfg used as the identifying string. This string is available by the <b>#define</b> <b>WIN_APPC_CFG_COMPLETION_MSG</b>.</td>
</tr>
<tr valign=top>
<td width=20%><i>wParam</i></td>
<td width=80%>Matches the <i>HANDLE</i> returned from the initial call. It is used as a correlator.</td>
</tr>
<tr valign=top>
<td width=20%><i>lParam</i></td>
<td width=80%>Contains one of the asynchronous return codes in the following list.</td>
</tr>
</table><br>
<ul>
<li>
If <i>pAsyncRetCode</i> was non-null, then the specified integer variable will be set to APPC_CFG_PENDING. After this function completes asynchronously, its value will change to one of the asynchronous return codes listed below.</li>
</ul>
<h4>Synchronous Return Codes</h4>
<dl>
<dt>
appc_cfg_error_no_appc_init</dt>
<dd>
The Windows APPC library needs to be initialized by a call to <a href="appc06_4u03.htm"><b>WinAPPCStartup</b></a> before calling <b>GetAPPCConfig</b> and this has not been done.</dd>
<dt>
appc_cfg_error_invalid_hwnd</dt>
<dd>
The handle passed in <i>hWnd</i> was non-null, yet not a valid window handle.</dd>
<dt>
appc_cfg_error_bad_pointer</dt>
<dd>
The <i>hWnd</i> parameter was null, indicating that completion was signaled by setting the integer variable pointed to by <i>pAsyncRetCode</i>, but <i>pAsyncRetCode</i> was not a valid pointer.</dd>
<dt>
appc_cfg_error_unclear_completion_mode</dt>
<dd>
Both <i>hWnd</i> and <i>pAsyncCompletion</i> were non-null, so <b>GetAPPCConfig</b> was unable to decide how completion should be signaled.</dd>
<dt>
appc_cfg_error_too_many_requests</dt>
<dd>
Too many <b>GetAPPCConfig</b> calls are already being processed (currently, this indicates 16 requests are outstanding). Try the call again after a delay. For the Microsoft® Windows® version 3.<i>x</i> system, you must yield during this period.</dd>
<dt>
appc_cfg_error_general_failure</dt>
<dd>
An unexpected error occurred, probably of a system nature.
</dd>
</dl>
<h4>Asynchronous Return Codes</h4>
<dl>
<dt>
appc_cfg_success_no_default_remote</dt>
<dd>
The configuration information has been retrieved, and either no default remote LU was defined or it was not accessible by the specified local LU.</dd>
<dt>
appc_cfg_success_default_remote</dt>
<dd>
The configuration information has been retrieved, and there is a default remote LU that is accessible by the specified local LU.</dd>
<dt>
appc_cfg_error_no_default_local_lu</dt>
<dd>
An attempt was made to retrieve remote LUs partnered with the default local LU, but no default local LU was configured.</dd>
<dt>
appc_cfg_error_bad_local_lu</dt>
<dd>
The local LU specified is either not configured, or is not valid for the calling verb.</dd>
<dt>
appc_cfg_error_general_failure</dt>
<dd>
An unexpected error occurred, probably of a system nature.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<a href="appc06_4u03.htm"><b>WinAPPCStartup</b></a> must be called before using <b>GetAPPCConfig</b>.</p>
<p>
Whether an error code represents success or failure can be determined by evaluating either (<i>RetCode&amp;</i> APPC_CFG_SUCCESS) to test for success or (<i>RetCode&amp;</i> APPC_CFG_FAILURE) to test for failure.</p>
<p>
The following code fragment shows how a console application can test completion:</p>
<pre><code>while (*pAsyncRetCode == APPC_CFG_PENDING)
{
    sleep(250);
}
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
