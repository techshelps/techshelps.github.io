<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>routproc</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_routproc_3270"></a>routproc</h1>
<p>
The <b>routproc</b> function is a sample routing procedure. It must be supplied as part of the application. It is called by the DMOD with a message that may or may not be for this application; the DMOD calls routing procedures in turn until one accepts the message.</p>
<h4>Win32</h4>
<p>
<b>DWORD&nbsp;routproc(</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;BUFHDR</b>&nbsp;*<i>msgptr</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>locl</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>retstat</i></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;);</b></td>
<td width=8%><pre></pre>
</td>
</tr>
</table><br>
<h4>MS-DOS, Windows Version 3.x, and OS/2</h4>
<p>
<b>USHORT&nbsp;FAR&nbsp;_loadds&nbsp;routproc(</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;BUFHDR&nbsp;FAR</b>&nbsp;*<i>msgptr</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>locl</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>retstat</i></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;);</b></td>
<td width=8%><pre></pre>
</td>
</tr>
</table><br>
<h4>Parameters</h4>
<dl>
<dt>
<i>msgptr</i></dt>
<dd>
Pointer to the message passed by the DMOD to the routing procedure.</dd>
<dt>
<i>locl</i></dt>
<dd>
Locality from which message was received (if <i>retstat</i> indicates message returned), or locality to which path was lost (if <i>retstat</i> indicates path error).</dd>
<dt>
<i>retstat</i></dt>
<dd>
Reason for call:
<p>
CEDINMSG (1)—message returned.

<p>
CEDINLLN (2)—path error (see Remarks below).

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
TRUE</dt>
<dd>
The routing procedure has accepted the message.</dd>
<dt>
FALSE</dt>
<dd>
The message is not for this routing procedure.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The routing procedure should first call <a href="entrypts_99tc.htm"><b>sbpurcvx</b></a>, which handles any Open response messages, as follows:</p>
<p>
<b>sbpurcvx(</b>&amp;<i>msgptr</i>, <i>locl</i>, <i>retstat</i><b>)</b></p>
<p>
A return code of TRUE from <b>sbpurcvx</b> indicates that <b>sbpurcvx</b> has accepted the message; an Open error response has been received for this application, and resource location is continuing. The routing procedure should not process the message any further and should return TRUE to prevent the DMOD from calling further routing procedures.</p>
<p>
A return code of FALSE from <b>sbpurcvx</b> indicates that the routing procedure should:
<ul>
<li>
If the message is for this application, take responsibility for the message and return TRUE to prevent the DMOD from calling further routing procedures.</li>
<li>
If the message is not for this application, return FALSE so that the DMOD tries further routing procedures.</li>
</ul>
<p>
If a path error is returned, <i>msgptr</i> will not point to a valid message, and no more FMI messages will be returned for the locality value indicated. The application is responsible for ending all sessions using this locality. The routing procedure must return FALSE; this ensures that the lost locality is reported to all other routing procedures.</p>
<p>
If the message is for this application, the routing procedure can either process the message immediately or put the message on an application queue and then post the application using a semaphore. See <a href="3270c2_33w0.htm">Receiving Messages</a> for more information.</p>
<p>&nbsp;</p></body>
</HTML>
