<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>An Example of a Mapped Conversation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_sna_an_example_of_a_mapped_conversation_cpic"></a>An Example of a Mapped Conversation</h3>
<p>
The following example of a mapped conversation shows the CPI-C calls used to start a conversation, exchange data, and end the conversation. Call parameters are in parentheses.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Issued by the invoking TP</th>
<th align=left width=52%>Issued by the invokable TP</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=48%><pre><code>Initialize_Conversation</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre><code>Allocate</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre><code>Send_Data</code></pre>
</td>
<td width=52%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre><code>Deallocate</code></pre>
</td>
<td width=52%><pre><code>Accept_Conversation</code></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre></pre>
</td>
<td width=52%><pre><code>Receive</code></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre></pre>
</td>
<td width=52%><pre><code>    (data_received=</code></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre></pre>
</td>
<td width=52%><pre><code>    CM_COMPLETE_DATA_RECEIVED)</code></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre></pre>
</td>
<td width=52%><pre><code>    (<i>return_code</i>=</code></pre>
</td>
</tr>
<tr valign=top>
<td width=48%><pre></pre>
</td>
<td width=52%><pre><code>    CM_DEALLOCATED_NORMAL)</code></pre>
</td>
</tr>
</table><br>
<p>
The following paragraphs describe the calls that are used in a mapped conversation.</p>
<h4>Calls for Starting a Mapped Conversation</h4>
<p>
To start a conversation, the invoking TP issues the following calls:
<ul>
<li>
<a href="cpic03_0jhf.htm"><b>Initialize_Conversation</b></a>, which requests CPI-C to set the values defining the characteristics of the conversation. The <b>Initialize_Conversation</b> call specifies a symbolic destination name that is associated with an entry in a side information table in memory. The side information specifies partner TP, partner LU, mode, security, and so on.</li>
<li>
<a href="cpic03_2krn.htm"><b>Allocate</b></a>, which requests that CPI-C establish a conversation between the invoking TP and the invokable TP.</li>
</ul>
<p>
The invokable TP issues the <a href="cpic03_70df.htm"><b>Accept_Conversation</b></a> call, which informs CPI-C that it is ready to begin a conversation with the invoking TP.</p>
<h4>Calls for Sending Data in a Mapped Conversation</h4>
<p>
The <a href="cpic03_94ir.htm"><b>Send_Data</b></a> call puts one data record (a record containing application data to be transmitted) in the send buffer of the local LU. Data transmission to the partner TP does not happen until one of the following events occurs:
<ul>
<li>
The send buffer fills up.</li>
<li>
The sending TP makes a call that forces CPI-C to flush the buffer and send data to the partner TP.</li>
</ul>
<p>
In addition to the data record, the send buffer also contains the allocation request (which precedes the data record).</p>
<p>
In the preceding example, <a href="cpic03_5vkz.htm"><b>Deallocate</b></a> flushes the send buffer, sending the allocation request and data to the partner TP. Other calls that flush the buffer are <a href="cpic03_5q8z.htm"><b>Confirm</b></a> and <a href="cpic03_3vab.htm"><b>Flush</b></a>.</p>
<h4>Calls for Receiving Data in a Mapped Conversation</h4>
<p>
The <b>Receive</b> call receives the data record and status information from the partner TP. If no data or status information is currently available, the local TP, by default, waits for data to arrive.</p>
<p>
The <i>data_received</i> parameter of <a href="cpic03_3vhf.htm"><b>Receive</b></a> tells the program whether it received data and if so, whether or not the data is complete.</p>
<h4>Calls for Ending a Mapped Conversation</h4>
<p>
To end a conversation, one of the TPs issues <a href="cpic03_5vkz.htm"><b>Deallocate</b></a>, which causes CPI-C to deallocate the conversation between the two TPs.</p>
<p>&nbsp;</p></body>
</HTML>
