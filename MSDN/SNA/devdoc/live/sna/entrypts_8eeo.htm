<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sbpuinit</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_sbpuinit_3270"></a>sbpuinit</h1>
<p>
The <b>sbpuinit</b> function initializes the DL-BASE.</p>
<h4>Win32</h4>
<p>
<b>USHORT&nbsp;sbpuinit(</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=89%><b>&nbsp;&nbsp;&nbsp;&nbsp;HANDLE</b>&nbsp;*s<i>ema4ptr</i><b>,</b></td>
<td width=11%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=89%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>proctype</i><b>,</b></td>
<td width=11%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=89%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>servtype</i><b>,</b></td>
<td width=11%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=89%><b>&nbsp;&nbsp;&nbsp;&nbsp;UCHAR</b>&nbsp;*<i>uname</i></td>
<td width=11%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=89%><b>&nbsp;&nbsp;&nbsp;);</b></td>
<td width=11%><pre></pre>
</td>
</tr>
</table><br>
<h4>MS-DOS</h4>
<p>
<b>USHORT&nbsp;FAR&nbsp;sbpuinit(</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;HSEM&nbsp;FAR</b>&nbsp;*<i>sema4ptr</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>proctype</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>servtype</i></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;);</b></td>
<td width=8%><pre></pre>
</td>
</tr>
</table><br>
<h4>OS/2</h4>
<p>
<b>USHORT&nbsp;FAR&nbsp;sbpuinit(</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=91%><b>&nbsp;&nbsp;&nbsp;&nbsp;HSEM&nbsp;FAR</b>&nbsp;*<i>sema4ptr</i><b>,</b></td>
<td width=9%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=91%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>proctype</i><b>,</b></td>
<td width=9%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=91%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>servtype</i><b>,</b></td>
<td width=9%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=91%><b>&nbsp;&nbsp;&nbsp;&nbsp;UCHAR</b>&nbsp;*<i>auname</i></td>
<td width=9%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=91%><b>&nbsp;&nbsp;&nbsp;);</b></td>
<td width=9%><pre></pre>
</td>
</tr>
</table><br>
<h4>Windows Version 3.x</h4>
<p>
<b>USHORT&nbsp;FAR&nbsp;sbpuinit(</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>proctype</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;USHORT</b>&nbsp;<i>servtype</i><b>,</b></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;&nbsp;UCHAR&nbsp;FAR</b>&nbsp;*<i>uname</i></td>
<td width=8%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=92%><b>&nbsp;&nbsp;&nbsp;);</b></td>
<td width=8%><pre></pre>
</td>
</tr>
</table><br>
<h4>Parameters</h4>
<dl>
<dt>
<i>sema4ptr</i></dt>
<dd>
Semaphore, created by DMOD, cleared by DMOD when a message is available. For MS-DOS, the application should supply the address of a 4-byte (long) integer. This is for SNA Server internal use—the application should not subsequently attempt to reference the address.</dd>
<dt>
<i>proctype</i></dt>
<dd>
Type of process: CLIENT–2.</dd>
<dt>
<i>servtype</i></dt>
<dd>
Type of service/client: CES3270–2.</dd>
<dt>
<i>uname</i></dt>
<dd>
Pointer to a character buffer of length at least 21 characters; the LAN Manager user name, or other identifying name appropriate to the network operating system, is returned to the application in this buffer. The application does not need to use this parameter, but can use it for display or logging.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
NO_ERROR</dt>
<dd>
Initialization successful.</dd>
</dl>
<p>
Any other return value indicates that the initialization failed. This is usually an operating system return code. The following values are also used:
<dl>
<dt>
DMLTABF  (555)</dt>
<dd>
L table is full.</dd>
<dt>
DMMNWGI  (562)</dt>
<dd>
Failed to get network operating system information.</dd>
<dt>
DMDSTFL  (563)</dt>
<dd>
Service table is full.</dd>
<dt>
DMMPIPF  (567)</dt>
<dd>
Failed to make a named pipe.</dd>
<dt>
DMCOMNM  (582)</dt>
<dd>
No name registered for this application.</dd>
<dt>
DMCOMDUP  (596)</dt>
<dd>
A service is already running with the same name.</dd>
<dt>
DMNOTLOG  (598)</dt>
<dd>
User is not logged on to network operating system.</dd>
<dt>
DMCFGOPN  (616)</dt>
<dd>
Failed to open configuration file.</dd>
<dt>
DMCFGREAD  (618)</dt>
<dd>
Failed to read from configuration file.</dd>
<dt>
DMNONAP  (625)</dt>
<dd>
The NAP is not started.</dd>
<dt>
DMMAXAPP  (953)</dt>
<dd>
Windows only:<br>
Maximum number of concurrent applications exceeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>sbpuinit</b> entry point should always be called before any other DL-BASE/DMOD entry points except <a href="entrypts_7pf4.htm"><b>SNAGetVersion</b></a>. For new emulators, <a href="entrypts_910w.htm"><b>sepdcrec</b></a> should be called after <b>sbpuinit</b>. (Because of the order of calls used in older emulators, a call to <b>sepdcrec</b> before <b>sbpuinit</b> is still supported, but this order is not recommended.)</p>
<p>&nbsp;</p></body>
</HTML>
