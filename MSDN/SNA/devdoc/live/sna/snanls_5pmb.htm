<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SnaNlsMapString</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_snanlsmapstring_nls"></a>SnaNlsMapString</h1>
<p>
The <b>SnaNlsMapString</b> function is called to translate a string from one code page to another. </p>
<p>
<b>int WINAPI SnaNlsMapString(<br>
LPCTSTR </b><i>lpSrcStr</i><b>,</b><br>
<b>LPTSTR </b><i>lpDestStr</i><b>,</b><br>
<b>UINT</b> <i>inCodePage</i><b>,</b><br>
<b>UINT</b> <i>outCodePage</i><b>,</b><br>
<b>int</b> <i>in_length</i><b>,</b><br>
<b>int</b> <i>out_length</i><b>,</b><br>
<b>UINT</b> <i>in_type</i><b>,</b><br>
<b>UINT</b> <i>out_type</i><b>,</b><br>
<b>WORD *</b><i>Options</i><br>
<b>);</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpSrcStr</i></dt>
<dd>
Supplied parameter. The input source string to be translated.</dd>
<dt>
<i>lpDestStr</i></dt>
<dd>
Returned parameter. The translated string which may be NULL if <i>out_length</i> was zero.</dd>
<dt>
<i>inCodePage</i></dt>
<dd>
Supplied parameter. Specifies the code page of the incoming source string; ignored if the input is Unicode.</dd>
<dt>
<i>outCodePage</i></dt>
<dd>
Supplied parameter. Specifies the code page of the output translated string; ignored if the output is Unicode.</dd>
<dt>
<i>in_length</i></dt>
<dd>
Supplied parameter. Specifies the length of the input source string in characters if the input is multibyte or in wide characters if the input is Unicode.</dd>
<dt>
<i>out_length</i></dt>
<dd>
Supplied parameter. Specifies the maximum length available for the output translated string in characters if the output is multibyte or in wide characters if the output is Unicode.</dd>
<dt>
<i>in_type</i></dt>
<dd>
Supplied parameter. Specifies the type of the input source string. Possible values for <i>in_type</i> are SNA_MULTIBYTE for multibyte and SNA_UNICODE for Unicode. </dd>
<dt>
<i>out_type</i></dt>
<dd>
Supplied parameter. Specifies the type of the output translated string. Possible values for <i>out_type</i> are SNA_MULTIBYTE for multibyte and SNA_UNICODE for Unicode. </dd>
<dt>
<i>Options</i></dt>
<dd>
Supplied and returned parameter. As a supplied parameter, this specifies a set of options that may be applied to the translation process, including TrnsDT options and the default character for the translation. On return, this parameter indicates the required buffer length for the output translated string if the function call failed. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
The <b>SnaNlsMapString </b>function returns the number of characters or wide characters written to <i>lpDestStr</i> on success; otherwise 0 is returned on failure. </p>
<p>
On failure, the Win32® <b>GetLastError</b> function should be used to return an error code indicating the cause of the failure. Possible values returned by <b>GetLastError</b> are as follows:
<dl>
<dt>
ERROR_NOT_SUPPORTED</dt>
<dd>
This error is returned for two possible reasons—either the NLS language resource file is not available or the <i>in_type </i>and <i>out_type</i> of the source and destination strings are not of the same type.</dd>
<dt>
ERROR_BUFFER_OVERFLOW</dt>
<dd>
This error is returned if the output buffer is too small. In such cases, the <i>Options</i> parameter returns with the value needed for <i>out_length</i>.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
This error is returned if a bad value was passed in a parameter; for example, if the <i>in_type</i> or <i>out_type</i> parameters contained undefined values.</dd>
<dt>
ERROR_INVALID_DATA</dt>
<dd>
This error is returned if a bad value was passed in the <i>lpSrcStr </i>parameter; for example, if the input string has a lead byte at the end.</dd>
<dt>
ERROR_OUTOFMEMORY</dt>
<dd>
This error is returned if memory could not be allocated for use by the SNANLS DLL.
</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
