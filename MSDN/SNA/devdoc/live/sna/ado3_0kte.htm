<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADO Connection Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_ado_connection_object_oledb"></a>ADO Connection Object</h1>
<p>
The ADO Connection object represents an open connection to an OLE DB data source. The <b>Provider</b> property sets the OLE DB provider to use. The connection can be configured before opening the data source by setting the <b>ConnectionString</b> properties. The version of the ADO implementation in use can be determined from the <b>Version</b> property.</p>
<p>
The physical connection to the data source is established using the <b>Open</b> method and terminated with the <b>Close</b> method. If errors occur, these can be examined with the Errors collection.</p>
<p>
The following Connection object methods, properties, and collections are supported by the current version of the Microsoft® OLE DB Provider for AS/400 and VSAM:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Name</th>
<th align=left width=68%>Comment</th>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_1d2a.htm"><b>Close</b></a> method</td>
<td width=68%>Closes a connection to a data source.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_0jqa.htm"><b>Execute</b></a> method</td>
<td width=68%>Evaluates command text as a table name (only supported <i>Options</i> parameter for this method is <b>adCmdTable</b>).</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_5ujm.htm"><b>Open</b></a> method</td>
<td width=68%>Opens a connection to a data source and may optionally pass <b>ConnectionString</b> parameters with this method. (the only supported <i>Options</i> parameter for this method is <b>adCmdText</b>).</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_3ujm.htm"><b>OpenSchema</b></a></td>
<td width=68%>Obtains database schema information from the OLE DB provider.</td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%></td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_04bm.htm"><b>ConnectionString</b></a> property</td>
<td width=68%>Contains the information used to establish a connection to a data source (see notes following).</td>
</tr>
<tr valign=top>
<td width=32%><b>CursorLocation</b> property</td>
<td width=68%>Sets or returns the location of the cursor (whether the cursor is on the client or the server side).</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_717m.htm"><b>Mode</b></a> property</td>
<td width=68%>Indicates the available permissions for modifying data in a connection.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_2gyq.htm"><b>Provider</b></a> property</td>
<td width=68%>Sets or returns the name of the provider for a connection.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_7882.htm"><b>State</b></a> property</td>
<td width=68%>Describes the current state of an object.</td>
</tr>
<tr valign=top>
<td width=32%><a href="thorref4_6hr6.htm"><b>Version</b></a> property</td>
<td width=68%>Returns the version number of the ADO implementation in use.</td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%></td>
</tr>
<tr valign=top>
<td width=32%>Errors collection</td>
<td width=68%>Collections of Error objects on the connection.</td>
</tr>
<tr valign=top>
<td width=32%>Properties collection</td>
<td width=68%>Collections of properties on the connection.</td>
</tr>
</table><br>
<p>
The information needed to establish a connection to a data source can be set in the <b>ConnectionString</b> property or passed as part of the <b>Open</b> method. In either case, this information must be in a specific format for use with the OLE DB Provider for AS/400 and VSAM. This information can be a data source name (DSN) or a detailed connection string containing a series of <i>argument=value</i> statements separated by semicolons. ADO supports several standard ADO-defined arguments for the <b>ConnectionString</b> property as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Argument</th>
<th align=left width=75%>Description</th>
</tr>
<tr valign=top>
<td width=25%>Data Source</td>
<td width=75%>Specifies the name of the data source for the connection. This argument is the Data Source name stored in the registry under the OLE DB Provider for AS/400 and VSAM.</td>
</tr>
<tr valign=top>
<td width=25%>File Name</td>
<td width=75%>Specifies the name of the provider-specific file containing preset connection information. This argument cannot be used if a <i>Provider</i> argument is passed. This argument is not supported by the OLE DB Provider for AS/400 and VSAM.</td>
</tr>
<tr valign=top>
<td width=25%>Password</td>
<td width=75%>Specifies a valid mainframe or AS/400 password to use when opening the connection. This password is used by Microsoft® SNA Server to validate that the user can log on to the target host system and has appropriate access rights to the file. </td>
</tr>
<tr valign=top>
<td width=25%>Provider</td>
<td width=75%>Specifies the name of the provider to use for the connection. To use the OLE DB Provider for AS/400 and VSAM the Provider string must be set to "SNAOLEDB". </td>
</tr>
<tr valign=top>
<td width=25%>User ID</td>
<td width=75%>Specifies a valid mainframe or AS/400 user name to use when opening the connection. This user name is used by SNA Server to validate that the user can log on to the target host system and has appropriate access rights to the file.</td>
</tr>
</table><br>
<p>
The OLE DB Provider for AS/400 and VSAM also supports a number of provider-specific arguments, some of which will default to values in the registry. These arguments are as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Argument</th>
<th align=left width=75%>Description</th>
</tr>
<tr valign=top>
<td width=25%>CCSID</td>
<td width=75%>The Code Character Set Identifier (CCSID) attribute indicates the character set used on the host. If this argument is omitted, the default value for CCSID is set to the default value in the registry, typically EBCDIC US English (37). </td>
</tr>
<tr valign=top>
<td width=25%>CodePage</td>
<td width=75%>The character code page to use on the PC. If this argument is omitted, the default value for CodePage is set to the default value in the registry, typically US ASCII (437). This value is only used when configured for custom code page conversion.</td>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%></td>
</tr>
<tr valign=top>
<td width=25%>Local LU</td>
<td width=75%>The name of the local LU alias configured in the SNA server.</td>
</tr>
<tr valign=top>
<td width=25%>Mode</td>
<td width=75%>The APPC mode (must be set to a value that matches the host configuration and SNA Server configuration). If this argument is omitted, the default value for Mode is set to the default value in the registry.<p>
Legal values for the APPC mode include QPCSUPP (5250), #NTER (interactive), #NTERSC (interactive), #BATCH (batch), #BATCHSC (batch), and custom modes.</p>
</td>
</tr>
<tr valign=top>
<td width=25%>RDB</td>
<td width=75%>The Remote DataBase name for OS/400. You only need to specify this value if it is different from the remote LU alias configured in the SNA Server.</td>
</tr>
<tr valign=top>
<td width=25%>Remote LU</td>
<td width=75%>The name of the remote LU alias configured in the SNA server.</td>
</tr>
</table><br>
<p>
A sample <b>ConnectionString</b> follows:</p>
<pre><code>Conn.Open "Provider=SNAOLEDB;Data Source=REMLU;User ID=USERNAME;Password=password;Local LU=LOCAL;Remote LU=DATABASE; Mode=QPCSUPP;CCSID=37;CodePage=437"
 </code></pre>
<p>
A sample <b>Open</b> method call with these parameters follows:</p>
<pre><code>RS.Open "library/member",Conn,1,1,1
 </code></pre>
<p>
The last three parameters to the <b>Open</b> method correspond with the <i>CursorType</i> (the <b>adOpenKeyset</b> enum is 1, for example), <i>LockType</i> (the <b>adLockReadOnly</b> enum is 1, for example), and <i>Options</i> (<b>adCmdText </b>is 1, which indicates that the Source name should be evaluated as a table name). The <i>Options</i> parameter must be set to <b>adCmdText </b>(1) when used with the a data source name with OLE DB Provider for AS/400 and VSAM.</p>
<p>
The allowable values for CCSID when using SNANLS (SNA National Language Support) for character code conversions (the default) are as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>EBCDIC character set</th>
<th align=left width=52%>CCSID value</th>
</tr>
<tr valign=top>
<td width=48%>U.S./Canada</td>
<td width=52%>37</td>
</tr>
<tr valign=top>
<td width=48%>Germany</td>
<td width=52%>273</td>
</tr>
<tr valign=top>
<td width=48%>Denmark/Norway</td>
<td width=52%>277</td>
</tr>
<tr valign=top>
<td width=48%>Finland/Sweden</td>
<td width=52%>278</td>
</tr>
<tr valign=top>
<td width=48%>Italy</td>
<td width=52%>280</td>
</tr>
<tr valign=top>
<td width=48%>Latin America/Spain</td>
<td width=52%>284</td>
</tr>
<tr valign=top>
<td width=48%>United Kingdom</td>
<td width=52%>285</td>
</tr>
<tr valign=top>
<td width=48%>France</td>
<td width=52%>297</td>
</tr>
<tr valign=top>
<td width=48%>Arabic</td>
<td width=52%>420</td>
</tr>
<tr valign=top>
<td width=48%>Greek</td>
<td width=52%>423</td>
</tr>
<tr valign=top>
<td width=48%>Hebrew</td>
<td width=52%>424</td>
</tr>
<tr valign=top>
<td width=48%>International</td>
<td width=52%>500</td>
</tr>
<tr valign=top>
<td width=48%>Thai</td>
<td width=52%>838</td>
</tr>
<tr valign=top>
<td width=48%>Multilingual/ROECE (Latin-2)</td>
<td width=52%>870</td>
</tr>
<tr valign=top>
<td width=48%>Icelandic</td>
<td width=52%>871</td>
</tr>
<tr valign=top>
<td width=48%>Greek (Modern)</td>
<td width=52%>875</td>
</tr>
<tr valign=top>
<td width=48%>Cyrillic (Russian)</td>
<td width=52%>880</td>
</tr>
<tr valign=top>
<td width=48%>Turkish</td>
<td width=52%>905</td>
</tr>
<tr valign=top>
<td width=48%>Cyrillic (Serbian, Bulgarian)</td>
<td width=52%>1025</td>
</tr>
<tr valign=top>
<td width=48%>Turkish (Latin-5)</td>
<td width=52%>1026</td>
</tr>
</table><br>
<p>
In addition, the following values for CCSID are supported when using TrnsDT-supplied SNANLS character code conversions:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>EBCDIC character set</th>
<th align=left width=52%>CCSID value</th>
</tr>
<tr valign=top>
<td width=48%>Japanese (Katakana)</td>
<td width=52%>290</td>
</tr>
<tr valign=top>
<td width=48%>Japanese (Extended Katakana)</td>
<td width=52%>930</td>
</tr>
<tr valign=top>
<td width=48%>Japanese (English-lower)</td>
<td width=52%>931</td>
</tr>
<tr valign=top>
<td width=48%>Korean</td>
<td width=52%>933</td>
</tr>
<tr valign=top>
<td width=48%>Chinese (Simplified)</td>
<td width=52%>935</td>
</tr>
<tr valign=top>
<td width=48%>Chinese (Traditional)</td>
<td width=52%>937</td>
</tr>
<tr valign=top>
<td width=48%>Japanese (Extended English)</td>
<td width=52%>939</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;SNANLS conversion will automatically use the "default" code page for the default "locale" configured in the registry. For more information on SNANLS, see the SDK documentation on <a href="snanls_2lmb.htm">SNA National Language Support</a>.</p>
<p>&nbsp;</p></body>
</HTML>
