<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveConnection Property</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_activeconnection_property_oledb"></a>ActiveConnection Property</h1>
<p>
The <b>ActiveConnection</b> property on a Command or Recordset object indicates to which Connection object the specified Command or Recordset object currently belongs. This property sets or returns a String containing the definition for a connection or a Connection object. The default is a Null object reference.</p>
<pre><code><b>command.ActiveConnection</b> <b>=</b> connectionString
activeConnectionString <b>=</b> <b>recordset.ActiveConnection</b>
 </code></pre>
<h4>Remarks</h4>
<p>
The <b>ActiveConnection</b> property is used to determine the Connection object over which the specified Command object will execute or the specified Recordset will be opened.</p>
<p>
For Command objects, the <b>ActiveConnection</b> property is read/write.</p>
<p>
If you attempt to call the <b>Execute</b> method on a Command object before setting the <b>ActiveConnection</b> property to an open Connection object or valid connection string, an error occurs.</p>
<p>
Under Microsoft® Visual Basic®, setting the <b>ActiveConnection</b> property to <b>Nothing</b> disassociates the Command object from the current Connection and causes the OLE DB Provider to release any associated resources on the data source. You can then associate the Command object with the same or another Connection object. Some providers allow you to change the <b>ActiveConnection</b> property setting from one Connection to another, without having to first set the property to <b>Nothing</b>.</p>
<p>
Closing the Connection object with which a Command object is associated sets the <b>ActiveConnection</b> property to <b>Nothing</b>. Setting this property to a closed Connection object generates an error.</p>
<p>
For open Recordset objects or for Recordset objects whose <b>Source</b> property is set to a valid Command object, the <b>ActiveConnection</b> property is read-only. Otherwise, it is read/write.</p>
<p>
You can set the <b>ActiveConnection</b> property to a valid Connection object or to a valid connection string. In this case, the OLE DB Provider creates a new Connection object using this definition and opens the connection. Additionally, the provider may set this property to the new Connection object to give you a way to access the Connection object for extended error information or to execute other commands.</p>
<p>
If the <i>ActiveConnection</i> parameter of the <b>Open</b> method is used to open a Recordset object, the <b>ActiveConnection</b> property will inherit the value of the argument.</p>
<p>
If the <b>Source</b> property of the Recordset object is set to a valid Command object variable, the <b>ActiveConnection</b> property of the Recordset inherits the setting of the Command object's <b>ActiveConnection</b> property.</p>
<p>
The information needed to establish a connection to a data source can be set in the <b>ActiveConnection</b> property of a Recordset object or passed as part of the <b>Open</b> method on a Recordset object in the <i>ActiveConnection</i> parameter. In either case, this information must be in a specific format for use with the Microsoft® OLE DB Provider for AS/400 and VSAM. This information can be a data source name (DSN) or a detailed connection string containing a series of <i>argument=value</i> statements separated by semicolons. ADO supports several standard ADO-defined arguments for the <b>ActiveConnection</b> property as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Argument</th>
<th align=left width=75%>Description</th>
</tr>
<tr valign=top>
<td width=25%>Data Source</td>
<td width=75%>Specifies the name of the data source for the connection. This argument is the Data Source name stored in the registry under the OLE DB Provider for AS/400 and VSAM.</td>
</tr>
<tr valign=top>
<td width=25%>File Name</td>
<td width=75%>Specifies the name of the provider-specific file containing preset connection information. This argument cannot be used if a <i>Provider</i> argument is passed. This argument is not supported by the OLE DB Provider for AS/400 and VSAM.</td>
</tr>
<tr valign=top>
<td width=25%>Password</td>
<td width=75%>Specifies a valid mainframe or AS/400 password to use when opening the connection. This password is used by Microsoft® SNA Server to validate that the user can log on to the target host system and has appropriate access rights to the file. </td>
</tr>
<tr valign=top>
<td width=25%>Provider</td>
<td width=75%>Specifies the name of the provider to use for the connection. To use the OLE DB Provider for AS/400 and VSAM the Provider string must be set to "SNAOLEDB". </td>
</tr>
<tr valign=top>
<td width=25%>User ID</td>
<td width=75%>Specifies a valid mainframe or AS/400 user name to use when opening the connection. This user name is used by SNA Server to validate that the user can log on to the target host system and has appropriate access rights to the file.</td>
</tr>
</table><br>
<p>
The OLE DB Provider for AS/400 and VSAM also supports a number of provider-specific arguments, some of which will default to values in the registry. These arguments are as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Argument</th>
<th align=left width=75%>Description</th>
</tr>
<tr valign=top>
<td width=25%>CCSID</td>
<td width=75%>The Code Character Set Identifier (CCSID) attribute indicates the character set used on the host. If this argument is omitted, the default value for CCSID is set to the default value in the registry, typically EBCDIC US English (37). </td>
</tr>
<tr valign=top>
<td width=25%>CodePage</td>
<td width=75%>The character code page to use on the PC. If this argument is omitted, the default value for CodePage is set to the default value in the registry, typically US ASCII (437). This value is only used when configured for custom code page conversion.</td>
</tr>
<tr valign=top>
<td width=25%>Local LU</td>
<td width=75%>The name of the local LU alias configured in the SNA server.</td>
</tr>
<tr valign=top>
<td width=25%>Mode</td>
<td width=75%>The APPC mode (must be set to a value that matches the host configuration and SNA Server configuration). If this argument is omitted, the default value for Mode is set to the default value in the registry.<p>
Legal values for the APPC mode include QPCSUPP (5250), #NTER (interactive), #NTERSC (interactive), #BATCH (batch), #BATCHSC (batch), and custom modes.</p>
</td>
</tr>
<tr valign=top>
<td width=25%>RDB</td>
<td width=75%>The Remote DataBase name for OS/400. You only need to specify this value if it is different from the remote LU alias configured in the SNA server.</td>
</tr>
<tr valign=top>
<td width=25%>Remote LU</td>
<td width=75%>The name of the remote LU alias configured in the SNA server.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
