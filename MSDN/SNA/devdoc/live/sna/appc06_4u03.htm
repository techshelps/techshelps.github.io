<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WinAPPCStartup</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_winappcstartup_appc"></a>WinAPPCStartup</h1>
<p>
The <b>WinAPPCStartup</b> function allows an application to specify the version of Windows APPC required and to retrieve details of the specific Windows APPC implementation. An application must call this function to register itself with a Windows APPC implementation before issuing any further Windows APPC calls.</p>
<p>
<b>int WINAPI</b><i> </i><b>WinAPPCStartup(<br>
WORD</b><i> wVersionRequired</i><b>,<br>
LPWAPPCDATA</b> <i>lpAPPCData<br>
</i><b>);</b></p>
<pre><code>typedef struct {
    WORD wVersion;
    char szDescription[WAPPCDESCRIPTION_LEN+1];
} WAPPCDATA, FAR * LPWAPPCDATA;

where WAPPCDESCRIPTION_LEN is defined as 127
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wVersionRequired</i></dt>
<dd>
Specifies the version of Windows APPC support required. The high-order byte specifies the minor version (revision) number; the low-order byte specifies the major version number. The current version of the Windows APPC API is 1.0.</dd>
<dt>
<i>lpAPPCData</i></dt>
<dd>
Pointer to a returned structure containing a Windows APPC version number and a description of the Windows APPC implementation.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The return value specifies whether the application was registered successfully and whether the Windows APPC implementation can support the specified version number. If the value is zero, it was registered successfully and the specified version can be supported. Otherwise, the return value is one of the following:
<dl>
<dt>
wappcsysnotready</dt>
<dd>
The underlying network subsystem is not ready for network communication.</dd>
<dt>
wappcvernotsupported</dt>
<dd>
The version of Windows APPC support requested is not provided by this particular Windows APPC implementation.</dd>
<dt>
wappcinvalid</dt>
<dd>
The Windows APPC version specified by the application is not supported by this DLL.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To support future Windows APPC implementations and applications that may have functionality differences from Windows APPC version 1.0, a negotiation takes place in <b>WinAPPCStartup</b>. An application passes to <b>WinAPPCStartup</b> the Windows APPC version that it can use. If this version is lower than the lowest version supported by the Windows APPC DLL, the DLL cannot support the application and <b>WinAPPCStartup</b> fails. If the version is not lower, however, the call succeeds and returns the highest version of Windows APPC supported by the DLL. If this version is lower than the lowest version supported by the application, the application either fails its initialization or attempts to find another Windows APPC DLL on the system.</p>
<p>
This negotiation allows both a Windows APPC DLL and a Windows APPC application to support a range of Windows APPC versions. An application can successfully use a DLL if there is any overlap in the versions. The following table illustrates how <b>WinAPPCStartup</b> works in conjunction with different application and DLL versions.</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<th align=left width=16%>Application versions</th>
<th align=left width=19%>DLL versions</th>
<th align=left width=22%>To WinAPPCStartup</th>
<th align=left width=24%>From WinAPPCStartup</th>
<th align=left width=19%>Result</th>
</tr>
<tr valign=top>
<td width=16%>1.0</td>
<td width=19%>1.0</td>
<td width=22%>1.0</td>
<td width=24%>1.0</td>
<td width=19%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=16%>1.0, 2.0</td>
<td width=19%>1.0</td>
<td width=22%>2.0</td>
<td width=24%>1.0</td>
<td width=19%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=16%>1.0</td>
<td width=19%>1.0, 2.0</td>
<td width=22%>1.0</td>
<td width=24%>2.0</td>
<td width=19%>Use 1.0</td>
</tr>
<tr valign=top>
<td width=16%>1.0</td>
<td width=19%>2.0, 3.0</td>
<td width=22%>1.0</td>
<td width=24%>WAPPCINVALID</td>
<td width=19%>Fail</td>
</tr>
<tr valign=top>
<td width=16%>2.0, 3.0</td>
<td width=19%>1.0</td>
<td width=22%>3.0</td>
<td width=24%>1.0</td>
<td width=19%>App Fails</td>
</tr>
<tr valign=top>
<td width=16%>1.0, 2.0, 3.0</td>
<td width=19%>1.0, 2.0, 3.0</td>
<td width=22%>3.0</td>
<td width=24%>3.0</td>
<td width=19%>Use 3.0</td>
</tr>
<tr valign=top>
<td width=16%>1.0</td>
<td width=19%>1.0</td>
<td width=22%>4.0</td>
<td width=24%>1.0</td>
<td width=19%>App Fails</td>
</tr>
<tr valign=top>
<td width=16%>1.0, 2.0, 3.0, 4.0</td>
<td width=19%>1.0, 2.0, 3.0, 4.0</td>
<td width=22%>4.0</td>
<td width=24%>4.0</td>
<td width=19%>Use 4.0</td>
</tr>
</table><br>
<p>
Details of the actual Windows APPC implementation are described in the <b>WAPPCDATA</b> structure defined as follows that is returned by <b>WinAPPCStartup</b>:</p>
<pre><code>typedef struct tagWAPPCDDATA { WORD wVersion;
char szDescription[WAPPCDESCRIPTION_LEN+1];
} WAPPCDATA, FAR *LPWAPPCDATA;
 </code></pre>
<p>
The structure members are as follows:
<dl>
<dt>
<b>wVersion</b></dt>
<dd>
The highest APPC version number supported by the Windows APPC DLL.</dd>
<dt>
<b>szDescription</b></dt>
<dd>
A descriptive string describing the WinAPPC implementation.
</dd>
</dl>
<p>
After it makes its last Windows APPC call, an application should call the <a href="appc06_57fn.htm"><b>WinAPPCCleanup</b></a> routine.</p>
<p>
Each Windows APPC implementation must make a <b>WinAPPCStartup</b> call before issuing any other Windows APPC calls.</p>
<p>&nbsp;</p></body>
</HTML>
