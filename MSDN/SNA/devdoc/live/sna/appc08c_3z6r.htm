<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GET_CP_CONVERT_TABLE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_get_cp_convert_table_appc"></a>GET_CP_CONVERT_TABLE</h1>
<p>
The <b>GET_CP_CONVERT_TABLE</b> verb creates and returns a 256-byte conversion table to translate character strings from a source code page to a target code page.</p>
<p>
The following structure describes the verb control block used by the <b>GET_CP_CONVERT_TABLE </b> verb.</p>
<pre><code>struct get_cp_convert_table {
    unsigned short       opcode;
    unsigned char        opext;
    unsigned char        reserv2;
    unsigned short       primary_rc;
    unsigned long        secondary_rc;
    unsigned char        reserv3[8];
    unsigned short       source_cp;
    unsigned short       target_cp;
    unsigned char FAR * conv_tbl_addr;
    unsigned char        char_not_fnd;
    unsigned char        substitute_char;
};
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>opcode</b></dt>
<dd>
Supplied parameter. The verb identifying the operation code, SV_GET_CP_CONVERT_TABLE.</dd>
<dt>
<b>opext</b></dt>
<dd>
A reserved field.</dd>
<dt>
<b>reserv2</b></dt>
<dd>
A reserved field.</dd>
<dt>
<b>primary_rc</b></dt>
<dd>
Returned parameter. Specifies the primary return code set by APPC at the completion of the verb. The valid return codes vary depending on the APPC verb issued. See Return Codes for valid error codes for this verb.</dd>
<dt>
<b>secondary_rc</b></dt>
<dd>
Returned parameter. Specifies the secondary return code set by APPC at the completion of the verb. The valid return codes vary depending on the APPC verb issued. See Return Codes for valid error codes for this verb.</dd>
<dt>
<b>reserv3</b></dt>
<dd>
A reserved field.</dd>
<dt>
<b>source_cp</b></dt>
<dd>
Supplied parameter. Specifies the source code page from which characters are converted. The allowed code pages (decimal values) are as follows:
<ul>
<li>
ASCII 437, 850, 860, 863, 865</li>
<li>
EBCDIC 037, 273, 277, 278, 280, 284, 285, 297, 500</li>
</ul>

<p>
User-defined code pages in the range from 65280 through 65535 are also allowed.

<p>
ASCII code pages are sometimes referred to as PC code pages; EBCDIC code pages are sometimes referred to as host code pages.
</dd>
<dt>
<b>target_cp</b></dt>
<dd>
Supplied parameter. Specifies the target code page to which characters are converted. For allowed code pages, see the preceding definition for <b>source_cp</b>.</dd>
<dt>
<b>conv_tbl_addr</b></dt>
<dd>
Supplied parameter. Specifies the address of the buffer to contain the 256-byte conversion table. The buffer must be in a writable segment and long enough to contain the table. </dd>
<dt>
<b>char_not_fnd</b></dt>
<dd>
Supplied parameter. Specifies the action to take if a character in the source code page does not exist in the target code page:
<ul>
<li>
Use SV_ROUND_TRIP to store a unique value in the conversion table for each source code page character.</li>
<li>
Use SV_SUBSTITUTE to store a substitute character (specified by <b>substitute_char</b>) in the conversion table.</li>
</ul>
</dd>
<dt>
<b>substitute_char</b></dt>
<dd>
Supplied parameter. Specifies the character to store in the conversion table when a character from the source code page has no equivalent in the target code page.
</dd>
</dl>
<h4>Return Codes</h4>
<dl>
<dt>
sv_ok</dt>
<dd>
Primary return code; the verb executed successfully.</dd>
<dt>
sv_parameter_check</dt>
<dd>
Primary return code; the verb did not execute because of a parameter error.
<dl>
<dt>
sv_invalid_char_not_found</dt>
<dd>
Secondary return code; the <b>char_not_fnd</b> parameter contained an invalid value.</dd>
<dt>
sv_invalid_data_segment</dt>
<dd>
Secondary return code; the 256-byte area specified for the conversion table extended beyond the segment boundary, or the segment was not writable.</dd>
<dt>
sv_invalid_source_code_page</dt>
<dd>
Secondary return code; the code page specified by <b>source_cp</b> is not supported.</dd>
<dt>
sv_invalid_target_code_page</dt>
<dd>
Secondary return code; the code page specified by <b>target_cp</b> is not supported.
</dd>
</dl>
</dd>
<dt>
sv_comm_subsystem_not_loaded</dt>
<dd>
Primary return code; a required component could not be loaded or terminated while processing the verb. Thus, communication could not take place. Contact the system administrator for corrective action.</dd>
<dt>
sv_invalid_verb</dt>
<dd>
Primary return code; the <b>opcode</b> parameter did not match the operation code of any verb. No verb executed.</dd>
<dt>
sv_invalid_verb_segment</dt>
<dd>
Primary return code; the VCB extended beyond the end of the data segment.</dd>
<dt>
sv_unexpected_dos_error</dt>
<dd>
Primary return code; one of the following conditions occurred:
<ul>
<li>
The Microsoft® Windows NT®, Microsoft® Windows® 95, Windows version 3.<i>x</i>, Microsoft® MS-DOS®, or OS/2 system encountered an error while processing the verb. The operating system return code was returned through the secondary return code. If the problem persists, contact the system administrator for corrective action.</li>
<li>
A CSV was issued from a message loop that was invoked by another application issuing a Windows <b>SendMessage</b> function call, rather than the more common Windows <b>PostMessage</b> function call. Verb processing cannot take place.</li>
<li>
A CSV was issued when <b>SendMessage</b> invoked your application. You can determine whether your application has been invoked with <b>SendMessage</b> by using the <b>InSendMessage</b> Windows API function call.</li>
</ul>
</dd>
</dl>
<h4>Remarks</h4>
<p>
The type A character set consists of:
<ul>
<li>
Uppercase letters.</li>
<li>
Numerals 0 through 9.</li>
<li>
Special characters $, #, @, and space.</li>
</ul>
<p>
This character set is supported by a system-supplied type A conversion table.</p>
<p>
The first character of the source string must be an uppercase letter or the special character $, #, or @. Spaces are allowed only in trailing positions. Lowercase ASCII letters are translated to uppercase EBCDIC letters when the direction is ASCII to EBCDIC.</p>
<p>
The type AE character set consists of:
<ul>
<li>
Uppercase letters.</li>
<li>
Lowercase letters.</li>
<li>
Numerals 0 through 9.</li>
<li>
Special characters $, #, @, period, and space.</li>
</ul>
<p>
This character set is supported by a system-supplied type AE conversion table.</p>
<p>
The first character of the source string can be any character in the character set except the space.</p>
<p>
During conversion, embedded blanks (including blanks in the first position) are converted to 0x00. Although such a conversion will complete, conversion_error is returned as the secondary return code, indicating that the CSV library has completed an irreversible conversion on the supplied data.</p>
<p>
For the Windows NT system, a description of <b>COMTBLG</b> should point to the Windows NT registry under <b>\SnaBase\Parameters\Client</b>. For the OS/2 operating system, the directory and file containing the table must be specified by the environment variable <b>COMTBLG</b>. (If the file is not found, the system returns the sv_table_error parameter check.).</p>
<p>
The SV_ROUND_TRIP value for <b>char_not_fnd </b>is useful only if you build a second conversion table to convert between the same two code pages in the reverse direction. If you specify the SV_ROUND_TRIP value in building both conversion tables, any character translated from one code page to the other and then back will be unchanged.</p>
<p>
When using the SV_SUBSTITUTE value for <b>char_not_fnd</b>, converting the translated character string back to the original code page will not necessarily re-create the original character string.</p>
<p>
Use <b>substitute_char</b> only if <b>char_not_fnd</b> is set to SV_SUBSTITUTE.</p>
<p>
The value stored in the conversion table is the ASCII value associated with the character. If the table is used for conversion from ASCII to EBCDIC, the character that appears in the converted string is the character associated with the numeric EBCDIC value rather than ASCII.</p>
<p>
For example, if you supply the underscore (_) character (ASCII value F6) while creating an ASCII to EBCDIC conversion table, the character that appears in the converted strings will be 6, the character associated with the value F6 in EBCDIC. To use the _ character as the substitute character in an ASCII to EBCDIC conversion table, you should supply the value E1 (the value associated with the _ character in EBCDIC) rather than the actual character.</p>
<p>
A code page is a table that associates specific ASCII or EBCDIC values with specific characters. If a character from the source code page does not exist in the target code page, the translated (target) string differs from the original (source) string.</p>
<p>&nbsp;</p></body>
</HTML>
