<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CNOS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_cnos_appc"></a>CNOS</h1>
<p>
The <b>CNOS</b> (Change Number of Sessions) verb establishes APPC LU 6.2 session limits.</p>
<p>
The following structure describes the verb control block used by the <b>CNOS</b> verb.</p>
<pre><code>typedef struct cnos {
    unsigned short  opcode;
    unsigned char   reserv2[2];
    unsigned short  primary_rc;
    unsigned long   secondary_rc;
    unsigned char   key[8];
    unsigned char   lu_alias[8];
    unsigned char   plu_alias[8];
    unsigned char   fqplu_name[17];
    unsigned char   reserv3;
    unsigned char   mode_name[8];
    unsigned int    mode_name_select:1;
    unsigned int    set_negotiable:1;
    unsigned int    reserv4:6;
    unsigned int    reserv5:8;
    unsigned short  plu_mode_sess_lim;
    unsigned short  min_conwinners_source;
    unsigned short  min_conwinners_target;
    unsigned short  auto_act;
    unsigned int    drain_target:1;
    unsigned int    drain_source:1;
    unsigned int    responsible:1;
    unsigned int    reserv6:5;
    unsigned int    reserv7:8;
} CNOS; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>opcode</b></dt>
<dd>
Supplied parameter. Specifies the verb operation code, AP_CNOS.</dd>
<dt>
<b>primary_rc</b></dt>
<dd>
Returned parameter. Specifies the primary return code set by APPC at the completion of the verb. The valid return codes vary depending on the APPC verb issued. See Return Codes for valid error codes for this verb.</dd>
<dt>
<b>secondary_rc</b></dt>
<dd>
Returned parameter. Specifies the secondary return code set by APPC at the completion of the verb. The valid return codes vary depending on the APPC verb issued. See Return Codes for valid error codes for this verb.</dd>
<dt>
<b>key</b></dt>
<dd>
Supplied parameter. Specifies either the master or service key in ASCII, if the keylock feature has been secured.</dd>
<dt>
<b>lu_alias</b></dt>
<dd>
Supplied parameter. Provides the 8-byte ASCII name used locally for the LU.</dd>
<dt>
<b>plu_alias</b></dt>
<dd>
Supplied parameter. Provides the 8-byte ASCII name used locally for the partner LU.</dd>
<dt>
<b>fqplu_name</b></dt>
<dd>
Supplied parameter. Provides the partner LU name in EBCDIC (type A) when no <b>plu_alias</b> name is defined at the local node and the partner LU is located at a different node.</dd>
<dt>
<b>mode_name</b></dt>
<dd>
Supplied parameter. Specifies the EBCDIC (type A) mode name to be used when the value of <b>mode_name_select</b> is AP_ONE.</dd>
<dt>
<b>mode_name_select</b></dt>
<dd>
Supplied parameter. Specifies the mode name select for which your program is setting or resetting the session limits and contention-winner polarities. Allowed values are AP_ALL or AP_ONE.</dd>
<dt>
<b>set_negotiable</b></dt>
<dd>
Supplied parameter. Specifies whether APPC is to change the current setting for the maximum negotiable session limit. Allowed values are AP_YES and AP_NO.</dd>
<dt>
<b>plu_mode_sess_lim</b></dt>
<dd>
Supplied parameter. Specifies the session limit when the value for <b>set_negotiable</b> is YES. Allowed values are 0 to 32767.</dd>
<dt>
<b>min_conwinners_source</b></dt>
<dd>
Supplied parameter. Specifies the number of sessions of which the LU is guaranteed to be the contention winner. Allowed values are 0 to 32767.</dd>
<dt>
<b>min_conwinners_target</b></dt>
<dd>
Supplied parameter. Specifies the minimum number of sessions of which the target LU is guaranteed to be the contention winner. Allowed values are 0 to 32767.</dd>
<dt>
<b>auto_act</b></dt>
<dd>
Supplied parameter. Specifies the number of the local LU's contention-winner sessions for APPC to activate automatically. Allowed values are 0 to 32767. See the Remarks section of this topic before using this parameter.</dd>
<dt>
<b>drain_targe</b>t</dt>
<dd>
Supplied parameter. Specifies whether the target LU can drain its waiting (outbound) allocation requests. Allowed values are AP_YES and AP_NO.</dd>
<dt>
<b>drain_source</b></dt>
<dd>
Supplied parameter. Specifies whether the source LU can drain its waiting (outbound) allocation requests. Allowed values are AP_YES and AP_NO.</dd>
<dt>
<b>responsible</b></dt>
<dd>
Supplied parameter. Specifies which LU is responsible for deactivating the sessions as a result of resetting the session limit for parallel-session connections. Allowed values are AP_SOURCE and AP_TARGET.
</dd>
</dl>
<h4>Return Codes</h4>
<dl>
<dt>
ap_ok</dt>
<dd>
Primary return code; the verb executed successfully.
<dl>
<dt>
ap_cnos_accepted</dt>
<dd>
Secondary return code; APPC accepts the session limits and responsibility as specified.</dd>
<dt>
ap_cnos_negotiated</dt>
<dd>
Secondary return code; APPC accepts the session limits and responsibility as negotiable by the partner LU. Values that can be negotiated are:
<p>
<b>plu_mode_session_limit</b>

<p>
<b>min_conwinners_source</b>

<p>
<b>min_conwinners_target</b>

<p>
<b>responsible</b>

<p>
<b>drain_target</b>

</dd>
</dl>
</dd>
<dt>
ap_allocation_error</dt>
<dd>
Primary return code; APPC has failed to allocate a conversation. The conversation state is set to RESET.
<p>
This code can be returned through a verb issued after <a href="appc05a_1ckj.htm"><b>ALLOCATE</b></a> or <a href="appc05a_38f7.htm"><b>MC_ALLOCATE</b></a>.

<dl>
<dt>
ap_allocation_failure_no_retry</dt>
<dd>
Secondary return code; the conversation cannot be allocated because of a permanent condition, such as a configuration error or session protocol error. To determine the error, the system administrator should examine the error log file. Do not retry the allocation until the error has been corrected.</dd>
<dt>
ap_allocation_failure_retry</dt>
<dd>
Secondary return code; the conversation could not be allocated because of a temporary condition, such as a link failure. The reason for the failure is logged in the system error log. Retry the allocation.
</dd>
</dl>
</dd>
<dt>
ap_cnos_local_race_reject</dt>
<dd>
Primary return code; APPC is currently processing a <b>CNOS</b> verb issued by a local LU.</dd>
<dt>
ap_cnos_partner_lu_reject</dt>
<dd>
Primary return code; the partner LU rejected a <b>CNOS</b> request from the local LU.
<dl>
<dt>
ap_cnos_mode_closed</dt>
<dd>
Secondary return code; the local LU cannot negotiate a nonzero session limit because the local maximum session limit at the partner LU is zero.</dd>
<dt>
ap_cnos_mode_name_reject</dt>
<dd>
Secondary return code; the partner LU does not recognize the specified mode name.</dd>
<dt>
ap_cnos_command_race_reject</dt>
<dd>
Secondary return code; the local LU is currently processing a <b>CNOS</b> verb issued by the partner LU.
</dd>
</dl>
</dd>
<dt>
ap_comm_subsystem_abended</dt>
<dd>
Primary return code; indicates one of the following conditions:
<ul>
<li>
The node used by this conversation encountered an ABEND.</li>
<li>
The connection between the TP and the PU 2.1 node has been broken (a local area network error).</li>
<li>
The SnaBase at the TP's computer encountered an ABEND.</li>
</ul>

<p>
The system administrator should examine the error log to determine the reason for the ABEND.
</dd>
<dt>
ap_comm_subsystem_not_loaded</dt>
<dd>
Primary return code; a required component could not be loaded or terminated while processing the verb. Thus, communication could not take place. Contact the system administrator for corrective action.
<p>
When this return code is used with <a href="appc05a_1ckj.htm"><b>ALLOCATE</b></a> or <a href="appc05a_38f7.htm"><b>MC_ALLOCATE</b></a>, it can indicate that no communications subsystem could be found to support the local LU. (For example, the local LU alias specified with <a href="appc04_0fs3.htm"><b>TP_STARTED</b></a> is incorrect or has not been configured.) Note that if <b>lu_alias</b> or <b>mode_name</b> is fewer than eight characters, you must ensure that these fields are filled with spaces to the right. This error is returned if these parameters are not filled with spaces, since there is no node available that can satisfy the <b>ALLOCATE</b> or <b>MC_ALLOCATE</b> request.

<p>
When <b>ALLOCATE</b> or <b>MC_ALLOCATE</b> produces this return code for an SNA Server system, there are two secondary return codes as follows:

<dl>
<dt>
0xF0000001</dt>
<dd>
Secondary return code; no nodes have been started.</dd>
<dt>
0xF0000002</dt>
<dd>
Secondary return code; at least one node has been started, but the local LU (when <b>TP_STARTED</b> is issued) is not configured on any active nodes. The problem could be either of the following:
<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;The node with the local LU is not started.</td>
</tr>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;The local LU is not configured.</td>
</tr>
</table><br>

</dd>
</dl>
</dd>
<dt>
ap_invalid_key</dt>
<dd>
Primary return code; the supplied key was incorrect.</dd>
<dt>
ap_invalid_verb_segment</dt>
<dd>
Primary return code; the VCB extended beyond the end of the data segment.</dd>
<dt>
ap_parameter_check</dt>
<dd>
Primary return code; the verb did not execute because of a parameter error.
<dl>
<dt>
ap_all_mode_must_reset</dt>
<dd>
Secondary return code; APPC does not permit a nonzero session limit when the <b>mode_name_select</b> parameter indicates AP_ALL.</dd>
<dt>
ap_autoact_exceeds_sesslim</dt>
<dd>
Secondary return code; on the <b>CNOS</b> verb, the value for <b>auto_act</b> is greater than the value for <b>plu_mode_sess_lim</b>.</dd>
<dt>
ap_bad_lu_alias</dt>
<dd>
Secondary return code; APPC cannot find the specified <b>lu_alias </b>among those defined.</dd>
<dt>
ap_bad_partner_lu_alias</dt>
<dd>
Secondary return code; APPC did not recognize the supplied <b>plu_alias</b>.</dd>
<dt>
ap_bad_snasvcmg_limits</dt>
<dd>
Secondary return code; your program specified invalid settings for <b>plu_mode_sess_lim</b>, <b>min_conwinners_source</b>, or <b>min_conwinners_target</b> when <b>mode_name</b> was supplied.</dd>
<dt>
ap_change_src_drains</dt>
<dd>
Secondary return code; APPC does not permit <b>mode_name_select</b> (ONE) and <b>drain_source</b> (YES) when <b>drain_source</b> (NO) is currently in effect for the specified mode.</dd>
<dt>
ap_cnos_implicit_parallel</dt>
<dd>
Secondary return code; APPC does not permit a program to change the session limit for a mode other than the SNASVCMG mode for the implicit partner template when the template specifies parallel sessions. (The term "template" is used because many of the actual values are yet to be filled in.)</dd>
<dt>
ap_cpsvcmg_mode_not_allowed</dt>
<dd>
Secondary return code; the mode named CPSVCMG cannot be specified as the <b>mode_name</b> on the deactivate session verb.</dd>
<dt>
ap_exceeds_max_allowed</dt>
<dd>
Secondary return code; your program issued a <b>CNOS</b> verb, specifying a <b>plu_mode_sess_lim</b> number and <b>set_negotiable</b> (AP_NO).</dd>
<dt>
ap_min_gt_total</dt>
<dd>
Secondary return code; the sum of <b>min_conwinners_source</b> and <b>min_conwinners_target</b> specifies a number greater than <b>plu_mode_sess_lim</b>.</dd>
<dt>
ap_mode_closed</dt>
<dd>
Secondary return code; the local LU cannot negotiate a nonzero session limit because the local maximum session limit at the partner LU is zero.</dd>
<dt>
ap_reset_sna_drains</dt>
<dd>
Secondary return code; SNASVCMG does not support the drain parameter values.</dd>
<dt>
ap_single_not_src_resp</dt>
<dd>
Secondary return code; for a single-session <b>CNOS</b> verb, APPC permits only the local (source) LU to be responsible for deactivating sessions.
</dd>
</dl>
</dd>
<dt>
ap_stack_too_small</dt>
<dd>
Primary return code; the stack size of the application is too small to execute the verb. Increase the stack size of your application.</dd>
<dt>
ap_state_check</dt>
<dd>
Primary return code; the verb did not execute because it was issued in an invalid state.
<dl>
<dt>
ap_cant_raise_limits</dt>
<dd>
Secondary return code; APPC does not permit setting session limits to a nonzero value unless the limits currently are zero.</dd>
<dt>
ap_lu_detached</dt>
<dd>
Secondary return code; a command has reset the definition of the local LU before <b>CNOS</b> tried to specify the LU.</dd>
<dt>
ap_snasvcmg_reset_not_allowed</dt>
<dd>
Secondary return code; your local program attempted to issue the <b>CNOS</b> verb for the mode named SNASVCMG, specifying a session limit of zero.
</dd>
</dl>
</dd>
<dt>
ap_unexpected_dos_error</dt>
<dd>
Primary return code; the operating system has returned an error to APPC while processing an APPC verb from the local TP. The operating system return code is returned through the <b>secondary_rc</b>. It appears in Intel byte-swapped order. If the problem persists, consult the system administrator.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>CNOS</b> identifies an LU by alias alone. If the same local LU alias is used multiple times in a domain (for backup or other purposes) and that LU alias is specified through <b>CNOS</b>, the verb can flow to a different LU than the one intended.</p>
<p>
If <b>CNOS</b> is not issued to set the mode session limit before a program issues its first APPC <a href="appc05a_1ckj.htm"><b>ALLOCATE</b></a>, <a href="appc05a_38f7.htm"><b>MC_ALLOCATE</b></a>, <a href="appc05b_16ub.htm"><b>SEND_CONVERSATION</b></a>, or <a href="appc05b_7qoz.htm"><b>MC_SEND_CONVERSATION</b></a>, or Common Programming Interface for Communications (CPI-C) <a href="cpic03_2krn.htm"><b>Allocate</b></a> call for a given partner LU and mode, APPC will internally generate a session limit using the value from the mode definition.</p>
<p>
When setting the limits for a parallel-session connection, the two LUs negotiate the mode session limits, drain settings, and responsibility values. APPC updates these parameters in <b>CNOS</b> to reflect the settings agreed to by both LUs during negotiation. Your program can issue <a href="appc03_3ko3.htm"><b>DISPLAY</b></a> to obtain the negotiated values for the mode session limit.</p>
<p>
No <b>CNOS</b> negotiation occurs when setting the limits for a single session (that is, the two LUs do not negotiate drain settings or responsibility values). Therefore, coordinate the mode definition parameter settings between partner LUs using a single-session connection by defining a single session mode at each node.</p>
<p>
As part of setting up the initial limits, <b>CNOS</b> also sets the guaranteed (that is, the minimum) number of contention-winner and contention-loser sessions and sets the automatic activation count for the source LU's contention-winner sessions. The action of <b>CNOS</b> normally affects only the group of sessions with the specified mode name between the source LU and the target LU. Alternatively, one <b>CNOS</b> can reset the session limits of all modes for a partner LU.</p>
<p>
APPC enforces the new mode session limit and the contention-winner polarities until one side or the other changes them by issuing a subsequent <b>CNOS</b> verb. The <b>CNOS</b> transaction is invisible at the target LU's API, regardless of which LU is the target. The results of the <b>CNOS</b> transaction can be obtained using <b>DISPLAY</b>.</p>
<p>&nbsp;</p></body>
</HTML>
