<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Clients Running Windows NT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sna_clients_running_windows_nt_cpic"></a>Clients Running Windows NT</h2>
<p>
On clients running Microsoft® Windows NT®, invokable TPs are configured through the Windows NT registry.</p>
<p>
<b>Note</b>&nbsp;&nbsp;With Windows NT, the recommended method for setting registry variables for autostarted invokable TPs is to use the sample TP configuration program, TPSETUP. Compile INSTALL.C, the source code for TPSETUP, for the Windows NT environment. When you write an installation program for autostarted invokable TPs, it is recommended that you add code similar to TPSETUP to the installation program. For information about TPSETUP, see <a href="cpicappb_97z7.htm">Sample CPI-C TPs in the SDK</a>.</p>
<p>
For clients running Windows NT, it is recommended that autostarted invokable TPs be written as Windows NT services. Be sure to include code like that in TPSETUP in the program that installs your TPs. Among other things, TPSETUP shows how to use the <b>CreateService</b> function when installing a TP. For important information about how services work under Windows NT, see the documentation for Windows NT and for Win32®.</p>
<p>
The following table lists the registry entries used for the types of invokable TPs that can be run on Windows NT-based clients:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=22%>Type of TP</th>
<th align=left width=30%>Location in registry</th>
<th align=left width=48%>Possible registry entries</th>
</tr>
<tr valign=top>
<td width=22%>Autostarted invokable TP running as a service on a Windows NT-based client</td>
<td width=30%><b>HKEY_LOCAL_MACHINE<br>
  SYSTEM<br>
    CurrentControlSet<br>
      Services<br>
        <i>TPName</i></b><p>
(and subkeys)</p>
</td>
<td width=48%>Registry entries created by the <b>CreateService</b> call, including entries that specify the path, display name, and other characteristics of the service.<p>
—plus—</p>
<p class=indent1>
<b>Linkage</b><br>
<b>OtherDependencies:</b>REG_MULTI_SZ:SnaBase</p>
<p class=indent1>
<b>Parameters</b><br>
<b>SNAServiceType:</b>REG_DWORD:0x5<br>
<b>LocalLU:</b>REG_SZ:<i>LUalias</i><br>
<b>Parameters:</b>REG_SZ:<i>ParameterList</i><br>
<b>Timeout:</b>REG_DWORD:<i>number</i><br>
<b>AcceptNames:</b>REG_SZ:<i>TPNameList</i><br>
<b>ConversationSecurity:</b>REG_SZ:{ YES | NO }<br>
<b>AlreadyVerified:</b>REG_SZ:{ YES | NO }2<br>
<b><i>Username1</i>:</b>REG_SZ:<i>Password1</i>2<br>
...<br>
<b><i>UsernameX</i>:</b>REG_SZ:<i>PasswordX</i>2</p>
<p class=indent1>
</p>
</td>
</tr>
<tr valign=top>
<td width=22%>Autostarted invokable TP running as an application1 on a Windows NT-based client</td>
<td width=30%><b>HKEY_LOCAL_MACHINE<br>
  SYSTEM<br>
    CurrentControlSet<br>
      Services<br>
        SnaBase<br>
          Parameters<br>
            TPs<br>
              <i>TPName</i></b><br>
                Parameters</td>
<td width=48%><b>SNAServiceType:</b>REG_DWORD:{ 0x5 | 0x6 }<br>
<b>PathName:</b>REG_EXPAND_SZ:<i>path</i><br>
<b>LocalLU:</b>REG_SZ:<i>LUalias</i><br>
<b>Parameters:</b>REG_SZ:<i>ParameterList</i><br>
<b>TimeOut:</b>REG_DWORD:<i>number<br>
</i><b>AcceptNames:</b>REG_SZ:<i>TPNameList</i><br>
<b>ConversationSecurity:</b>REG_SZ:{ YES | NO }<br>
<b>AlreadyVerified:</b>REG_SZ:{ YES | NO }2<br>
<b><i>Username1</i>:</b>REG_SZ:<i>Password1</i>2<br>
...<br>
<b><i>UsernameX</i>:</b>REG_SZ:<i>PasswordX</i>2<p>
</p>
</td>
</tr>
<tr valign=top>
<td width=22%>Operator-started invokable TP running as a service on a Windows NT-based client</td>
<td width=30%><b>HKEY_LOCAL_MACHINE<br>
  SYSTEM<br>
    CurrentControlSet<br>
      Services<br>
        <i>TPName</i></b><p>
(and subkeys)</p>
</td>
<td width=48%>Registry entries created by the <b>CreateService</b> call, including entries that specify the path, display name, and other characteristics of the service.<p>
—plus—</p>
<p class=indent1>
<b>Linkage</b><br>
<b>OtherDependencies:</b>REG_MULTI_SZ:SnaBase</p>
<p class=indent1>
<b>Parameters</b><br>
<b>SNAServiceType:</b>REG_DWORD:0x1A<br>
<b>LocalLU:</b>REG_SZ:<i>LUalias</i><br>
<b>Timeout:</b>REG_DWORD:<i>number</i><br>
<b>ConversationSecurity:</b>REG_SZ:{ YES | NO }<br>
<b>AlreadyVerified:</b>REG_SZ:{ YES | NO }2<br>
<b><i>Username1</i>:</b>REG_SZ:<i>Password1</i>2<br>
...<br>
<b><i>UsernameX</i>:</b>REG_SZ:<i>PasswordX</i>2</p>
<p class=indent1>
</p>
</td>
</tr>
<tr valign=top>
<td width=22%>Operator-started invokable TP running as an application on a Windows NT-based client </td>
<td width=30%><b>HKEY_LOCAL_MACHINE<br>
  SYSTEM<br>
    CurrentControlSet<br>
      Services<br>
        SnaBase<br>
          Parameters<br>
            TPs<br>
              <i>TPName</i></b><br>
                Parameters</td>
<td width=48%><b>SNAServiceType:</b>REG_DWORD:0x1A<br>
<b>LocalLU:</b>REG_SZ:<i>LUalias</i><br>
<b>TimeOut:</b>REG_DWORD:<i>number<br>
</i><b>ConversationSecurity:</b>REG_SZ:{ YES | NO }<br>
<b>AlreadyVerified:</b>REG_SZ:{ YES | NO }2<br>
<b><i>Username1</i>:</b>REG_SZ:<i>Password1</i>2<br>
...<br>
<b><i>UsernameX</i>:</b>REG_SZ:<i>PasswordX</i>2</td>
</tr>
</table><br>
<p>
<b>Notes:</b></p>
<p>
1  Before an autostarted TP can be started as an application on a Windows NT-based client, the TPSTART program must be started. For more information, see Sample CPI-C TPs in the SDK.</p>
<p>
2..<b>AlreadyVerified</b> and Username/Password entries are used only if <b>ConversationSecurity</b> is set to YES.</p>
<p>&nbsp;</p></body>
</HTML>
