<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Components of an Integrated Link Service Configuration DLL</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_sna_components_of_an_integrated_link_service_configuration_dll_dev"></a>Components of an Integrated Link Service Configuration DLL</h3>
<p>
The link service configuration DLL must export the following functions:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=35%>Exported function</th>
<th align=left width=65%>Purpose</th>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_8cs6.htm"><b>CommandLineAdd</b></a></td>
<td width=65%>Called from <b>LinkCfg</b> or <b>SnaCfg</b> to parse command-line input.</td>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_5sfq.htm"><b>ConfigAdd</b></a></td>
<td width=65%>Called from <b>LinkCfg</b> or <b>SnaCfg</b> to add the link service from binary configuration information output from <b>CommandLineAdd</b> or from the configuration file.</td>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_8792.htm"><b>ConfigureLinkService</b></a></td>
<td width=65%>Called from SNA Manager to add or modify a link service.</td>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_3vhy.htm"><b>ConfigureLinkServiceEx</b></a></td>
<td width=65%>Called from SNA Manager to add or modify a link service, returning a configuration buffer to be added to the configuration file.</td>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_9dbq.htm"><b>DisplayHelpInfo</b></a></td>
<td width=65%>Return a buffer containing command-line syntax for this type of link service.</td>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_9zna.htm"><b>FormatSnaCfgOutput</b></a></td>
<td width=65%>Format binary configuration information for output to either a command window or a redirected text file. This can be used to build an <b>SnaCfg</b> command file.</td>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_2jli.htm"><b>RemoveLinkService</b></a></td>
<td width=65%>Called from SNA Manager to remove a link service.</td>
</tr>
<tr valign=top>
<td width=35%><a href="setutils_26ye.htm"><b>RemoveAllLinkServices</b></a></td>
<td width=65%>Called from Setup to remove all instances of this link service.</td>
</tr>
</table><br>
<p>
The sample linkcfg.cpp DLL is written in C++ using the Microsoft Foundation Classes (MFC) and uses a single property sheet with two property pages as follows:
<ul>
<li>
The card configuraton property page implementation is in the cardcfg.cpp and cardcfg.h files. This property page is concerned with configuring various hardware properties (interrupt, DMA channel, and I/O address, for example) of the link service hardware.</li>
<li>
The connection mode property sheet implementation is in the mode.cpp and mode.h files. This property page is concerned with configuring mode information (link service name, link service title, SDLC line type, for example) for the link service.</li>
</ul>
<p>
The two property pages are linked to the link service property sheet in linkcfg.cpp within the <b>ConfigureLS</b> routine. This function is called by the exported <b>ConfigureLinkService</b> and <b>ConfigureLinkServiceEx</b> routines in linkcfg.cpp. An actual link service configuration DLL developed from these sources may require more property pages depending on the information needed to configure the actual link service DLL.</p>
<p>
The registry.h include file used by linkcfg.cpp contains a global definition of the registry entries required for the sample generic SDLC link service. The values in this structure will be modified to contain the actual information specified by the user. This structure is added to the registry when a new link service is configured, and this structure is removed when a link service is deleted. The registry values that a developer must modify include the Link Registry Base entry (LINKSERVICE is used in the sample include file), the name of the device driver root (GenSdlc is used in the sample include file and source code), and various software and service registry settings appropriate for the target link service.</p>
<p>
Several of the exported link service DLL functions use a configuration buffer, the <b>CONFIG_BUFFER</b> structure defined in linkcfg.h. The format of any <b>CONFIG_BUFFER</b> used by developers must match the structure format of this sample file for the first three parameters. Other parameters may differ for a developer's version of the <b>CONFIG_BUFFER</b> structure based on the target link service. </p>
<p>
The sample link service configuration DLL calls a set of general utility functions that are not specific to any target link service. These utility functions are included in a lnktools library (lnktool.cpp) that is linked in as an OBJ file. This lnktools library includes the following utility functions that are useful in developing link service configuration DLLs:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Utility function</th>
<th align=left width=55%>Purpose</th>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_7rqu.htm"><b>AddPerfmonCounters</b></a></td>
<td width=55%>Add perfmon counters for this link service.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_0p12.htm"><b>bCreateService</b></a></td>
<td width=55%>Create a service on a computer.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_45va.htm"><b>bDeleteService</b></a></td>
<td width=55%>Delete a service on a computer.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_367q.htm"><b>bStopService</b></a></td>
<td width=55%>Stop a service running on a computer.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_62ie.htm"><b>CheckForExistingLinkService</b></a></td>
<td width=55%>Check to see if a link service of this type exists with this title.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_2aly.htm"><b>ConvertHexStringToDWORD</b></a></td>
<td width=55%>Convert a hexadecimal string to a DWORD value.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_1oza.htm"><b>ExtractNextParameter</b></a></td>
<td width=55%>Get the next parameter from a buffer.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_2fcm.htm"><b>fAddRegistryEntry</b></a></td>
<td width=55%>Add a new registry value to the registry.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_8ppy.htm"><b>fCanWeAdministerRemoteBox</b></a></td>
<td width=55%>Determine if the user has administrative privileges on the remote computer.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_9n3q.htm"><b>fConnectRegistry</b></a></td>
<td width=55%>Connect to a remote computer's registry and return a handle to the remote registry.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_3igm.htm"><b>fDisconnectRegistry</b></a></td>
<td width=55%>Disconnect from a remote computer's registry.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_9ik6.htm"><b>fFindAndReplaceString</b></a></td>
<td width=55%>Find and replace a substring within a string.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_1vp2.htm"><b>fFindString</b></a></td>
<td width=55%>Determine if a string exists within a string buffer.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_5lfa.htm"><b>fFindStringInMultiSZ</b></a></td>
<td width=55%>Find a string in a REG_MULTI_SZ string list and return entire string.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_0api.htm"><b>fQueryRegistryValue</b></a></td>
<td width=55%>Query a value from the registry.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_7gl2.htm"><b>fRegistryKeyExists</b></a></td>
<td width=55%>Test whether a registry key exists.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_9oza.htm"><b>fRemoveRegistryEntry</b></a></td>
<td width=55%>Remove a registry key.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_5dpy.htm"><b>fRemoveRegistryValue</b></a></td>
<td width=55%>Remove a registry value.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_76wm.htm"><b>fStringCompare</b></a></td>
<td width=55%>Determine if two strings compare.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_4ks6.htm"><b>LoadStringResource</b></a></td>
<td width=55%>Load a string from the string resource.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_09py.htm"><b>ParseNextField</b></a></td>
<td width=55%>Return the next field from a string.</td>
</tr>
<tr valign=top>
<td width=45%><a href="setutils_6api.htm"><b>RemovePerfmonCounters</b></a></td>
<td width=55%>Remove perfmon counters for this link service.</td>
</tr>
<tr valign=top>
<td width=45%><b>ReturnString</b></td>
<td width=55%>Return a pointer to a string resource string.</td>
</tr>
</table><br>
<p>
The sample source code for a generic SDLC link service configuration DLL (linkcfg) includes several functions that may be useful as sample code when developing link service configuration DLLs for other hardware. The following functions are included in the linkcfg.cpp source code that may be of use as examples:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=47%>Utility function</th>
<th align=left width=53%>Purpose</th>
</tr>
<tr valign=top>
<td width=47%><b>bDetectNetworkCard</b></td>
<td width=53%>Detect the remote network card and return the card settings buffer for the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>bLastGenericDFTLinkService</b></td>
<td width=53%>Check for the last generic SDLC link service for the sample generic SDLC link service. This routine is used to determine if the GENSDLC Device Driver (if one existed) can be removed.</td>
</tr>
<tr valign=top>
<td width=47%><b>ConfigureLS</b></td>
<td width=53%>The common link service configuration function used by the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>fAddAllRegistryValues</b></td>
<td width=53%>Add all registry values for the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>fAddClassAndBindformRegistries</b></td>
<td width=53%>Add the "class" and "bindform" registry entries for the sample generic SDLC link service. The bindform and class registry entries can only exist for the first link service of this type.</td>
</tr>
<tr valign=top>
<td width=47%><b>fEnumerateEventLogSources</b></td>
<td width=53%>Enumerate the Event Log sources registry value for the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>fRemoveAllRegistryValues</b></td>
<td width=53%>Remove all registry values for the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>fReplaceAllRegistryValues</b></td>
<td width=53%>Replace all user-provided information in the registry data for the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>fReplaceRegistryData</b></td>
<td width=53%>Replace global registry data for the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>fReplaceRegistryKeyName</b></td>
<td width=53%>Replace global registry structure strings for the registry key name for the sample generic SDLC link service.</td>
</tr>
<tr valign=top>
<td width=47%><b>fSetupGlobalValues</b></td>
<td width=53%>Create or update all user-provided information in the registry data structure for the sample generic SDLC link service. </td>
</tr>
<tr valign=top>
<td width=47%><b>InitializeGlobalStructure</b></td>
<td width=53%>Initialize link service data contained in the global data structure for the sample generic SDLC link service.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
