<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Send_Data</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_send_data_cpic"></a>Send_Data</h1>
<p>
The <b>Send_Data</b> call (function name <b>cmsend</b>) puts data in the local LU's send buffer for transmission to the partner program.</p>
<pre><code><b>CM_ENTRY Send_Data(
  unsigned char FAR</b><i> *conversation_ID</i><b>,  </b>
<b>  unsigned char FAR</b><i> *buffer</i><b>,           </b>
<b>  CM_INT32 FAR</b><i> *send_length</i><b>,           </b>
<b>  CM_INT32 FAR</b><i> *request_to_send_received</i><b>,  </b>
<b>  CM_INT32 FAR</b><i> *return_code            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>conversation_ID</i></dt>
<dd>
Supplied parameter. Specifies the identifier for the conversation. The value of this parameter was returned by <a href="cpic03_0jhf.htm"><b>Initialize_Conversation</b></a> or <a href="cpic03_70df.htm"><b>Accept_Conversation</b></a>.</dd>
<dt>
<i>buffer</i></dt>
<dd>
Supplied parameter. Specifies the address of the buffer containing the data to be put in the local LU's send buffer.</dd>
<dt>
<i>send_length</i></dt>
<dd>
Supplied parameter. Specifies the number of bytes of data to be put in the local LU's send buffer. The range is from 0 through 32767.
<p>
For a mapped conversation, if <i>send_length</i> is set to zero, a null data record is sent to the partner program.

<p>
For a basic conversation, if <i>send_length</i> is set to zero, no data is sent. The <i>buffer</i> parameter is not relevant. However, the other parameters are processed.
</dd>
<dt>
<i>request_to_send_received</i></dt>
<dd>
Returned parameter. Is the request-to-send-received indicator. Possible values are:
<dl>
<dt>
CM_REQ_TO_SEND_RECEIVED</dt>
<dd>
The partner program issued the <a href="cpic03_6crn.htm"><b>Request_To_Send</b></a> call, which requests the local program to change the conversation to RECEIVE state.</dd>
<dt>
CM_REQ_TO_SEND_NOT_RECEIVED</dt>
<dd>
The partner program did not issue the <b>Request_To_Send</b> call. This value is not relevant if <i>return_code</i> is set to CM_PROGRAM_PARAMETER_CHECK or CM_PROGRAM_STATE_CHECK.
</dd>
</dl>
</dd>
<dt>
<i>return_code</i></dt>
<dd>
The code returned from this call. The valid return codes are listed below.
</dd>
</dl>
<h4>Return Codes</h4>
<dl>
<dt>
cm_ok</dt>
<dd>
Primary return code; the call executed successfully.</dd>
<dt>
cm_operation_not_accepted</dt>
<dd>
Primary return code; a previous operation on this conversation is incomplete.</dd>
<dt>
cm_operation_incomplete</dt>
<dd>
Primary return code; the operation has not completed (processing mode is nonblocking only) and is still in progress. The program can issue <a href="cpic03_6un7.htm"><b>Wait_For_Conversation</b></a> to await the completion of the operation, or <a href="cpic03_017n.htm"><b>Cancel_Conversation</b></a> to cancel the operation and conversation. If <a href="cpic03_3kir.htm"><b>Specify_Windows_Handle</b></a> has been called, the application should wait for notification by a Windows message and not call <b>Wait_For_Conversation</b>.</dd>
<dt>
cm_program_parameter_check</dt>
<dd>
Primary return code; one of the following occurred:
<ul>
<li>
The value specified by <i>conversation_ID</i> is invalid.</li>
<li>
The value specified by <i>send_length</i> is out of range (greater than 32767).</li>
<li>
This is a basic conversation and the first two bytes of <i>buffer </i>contain an invalid logical record length (0x0000, 0x0001, 0x8000, or 0x8001).</li>
</ul>
</dd>
<dt>
cm_program_state_check</dt>
<dd>
Primary return code; one of the following occurred:
<ul>
<li>
The conversation state is not SEND or SEND_PENDING.</li>
<li>
The basic conversation is in SEND state and <i>send_type</i> is set to CM_SEND_AND_CONFIRM, CM_SEND_AND_DEALLOCATE, or CM_SEND_AND_PREP_TO_RECEIVE. However, the data does not end on a logical record boundary. This condition is allowed only when <i>deallocate_type</i> is set to CM_DEALLOCATE_ABEND and the <i>send_type</i> is set to CM_SEND_AND_DEALLOCATE.</li>
</ul>
</dd>
<dt>
cm_product_specific_error</dt>
<dd>
Primary return code; a product-specific error occurred and has been logged in the product's error log.</dd>
<dt>
cm_conversation_type_mismatch</dt>
<dd>
Primary return code; the partner LU or program does not support the conversation type (basic or mapped) specified in the allocation request.</dd>
<dt>
cm_pip_not_specified_correctly</dt>
<dd>
Primary return code; the allocation request was rejected by a non-CPI-C LU 6.2 TP. The partner program requires one or more PIP data variables, which are not supported by CPI-C.</dd>
<dt>
cm_security_not_valid</dt>
<dd>
Primary return code; the user identifier or password specified in the allocation request was not accepted by the partner LU.</dd>
<dt>
cm_sync_level_not_supported_pgm</dt>
<dd>
Primary return code; the partner program does not support the synchronization level specified in the allocation request.</dd>
<dt>
cm_tpn_not_recognized</dt>
<dd>
Primary return code; the partner LU does not recognize the program name specified in the allocation request.</dd>
<dt>
cm_tp_not_available_no_retry</dt>
<dd>
Primary return code; the partner LU cannot start the program specified in the allocation request because of a permanent condition. The reason for the error may be logged on the remote node. Do not retry the allocation until the error has been corrected.</dd>
<dt>
cm_tp_not_available_retry</dt>
<dd>
Primary return code; the partner LU cannot start the program specified in the allocation request because of a temporary condition. The reason for the error may be logged on the remote node. Retry the allocation.</dd>
<dt>
cm_program_error_purging</dt>
<dd>
Primary return code; one of the following occurred:
<ul>
<li>
While in RECEIVE or CONFIRM state, the partner program issued <a href="cpic03_2j6r.htm"><b>Send_Error</b></a>. Data sent but not yet received is purged.</li>
<li>
While in SEND_PENDING state with the error direction set to CM_RECEIVE_ERROR, the partner program issued <b>Send_Error</b>. Data was not purged.</li>
</ul>
</dd>
<dt>
cm_resource_failure_no_retry</dt>
<dd>
Primary return code; one of the following occurred:
<ul>
<li>
The conversation was terminated prematurely because of a permanent condition. Do not retry until the error has been corrected.</li>
<li>
The partner program did not deallocate the conversation before terminating normally.</li>
</ul>
</dd>
<dt>
cm_resource_failure_retry</dt>
<dd>
Primary return code; the conversation was terminated prematurely because of a temporary condition, such as modem failure. Retry the conversation.</dd>
<dt>
cm_deallocated_abend</dt>
<dd>
Primary return code; the conversation has been deallocated for one of the following reasons:
<ul>
<li>
The remote program issued <a href="cpic03_5vkz.htm"><b>Deallocate</b></a> with the type parameter set to CM_DEALLOCATE_ABEND, or the remote LU did so because of a remote program abnormal-ending condition. If the conversation for the remote program was in RECEIVE state when the call was issued, information sent by the local program and not yet received by the remote program is purged.</li>
<li>
The remote TP terminated normally but did not deallocate the conversation before terminating. Node services at the remote LU deallocated the conversation on behalf of the remote TP.</li>
</ul>
</dd>
<dt>
cm_deallocated_abend_svc</dt>
<dd>
Primary return code; the conversation has been deallocated for one of the following reasons:
<ul>
<li>
The partner program issued <b>Deallocate</b> with the type parameter set to ABEND_SVC.</li>
<li>
The partner program did not deallocate the conversation before terminating.</li>
</ul>

<p>
If the conversation is in RECEIVE state for the partner program when this call is issued by the local program, data sent by the local program and not yet received by the partner program is purged.
</dd>
<dt>
cm_deallocated_abend_timer</dt>
<dd>
Primary return code; the conversation has been deallocated because the partner program issued <b>Deallocate</b> with the type parameter set to ABEND_TIMER. If the conversation is in RECEIVE state for the partner program when this call is issued by the local program, data sent by the local program and not yet received by the partner program is purged.</dd>
<dt>
cm_svc_error_purging</dt>
<dd>
Primary return code; while in SEND state, the partner program or partner LU issued <a href="cpic03_2j6r.htm"><b>Send_Error</b></a> with the type parameter set to SVC. Data sent to the partner program may have been purged.
</dd>
</dl>
<h4>State Changes</h4>
<p>
The conversation must be in SEND or SEND_PENDING state when the program issues this call.</p>
<p>
The following tables summarize state changes that are possible when <i>return_code</i> is set to cm_ok.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=47%><i>send_type</i></th>
<th align=left width=28%>Old state</th>
<th align=left width=25%>New state</th>
</tr>
<tr valign=top>
<td width=47%>CM_BUFFER_DATA</td>
<td width=28%>SEND</td>
<td width=25%>No change</td>
</tr>
<tr valign=top>
<td width=47%></td>
<td width=28%>SEND_PENDING</td>
<td width=25%>SEND</td>
</tr>
<tr valign=top>
<td width=47%>CM_SEND_AND_FLUSH</td>
<td width=28%>SEND</td>
<td width=25%>No change</td>
</tr>
<tr valign=top>
<td width=47%></td>
<td width=28%>SEND_PENDING</td>
<td width=25%>SEND</td>
</tr>
<tr valign=top>
<td width=47%>CM_SEND_AND_CONFIRM</td>
<td width=28%>SEND</td>
<td width=25%>No change</td>
</tr>
<tr valign=top>
<td width=47%></td>
<td width=28%>SEND_PENDING</td>
<td width=25%>SEND</td>
</tr>
<tr valign=top>
<td width=47%>CM_SEND_AND_PREP_TO_<br>
RECEIVE</td>
<td width=28%></td>
<td width=25%>RECEIVE</td>
</tr>
<tr valign=top>
<td width=47%>CM_SEND_AND_DEALLOCATE</td>
<td width=28%></td>
<td width=25%>RESET</td>
</tr>
</table><br>
<p>
For a <i>return_code</i> value of cm_program_error_purging or cm_svc_error_purging, the conversation changes to RECEIVE state. For other non-Cm_ok values, the conversation changes to RESET state.</p>
<h4>Remarks</h4>
<p>
The data collected in the local LU's send buffer is transmitted to the partner LU and partner program when one of the following occurs:
<ul>
<li>
The send buffer fills up.</li>
<li>
The local program issues a <a href="cpic03_3vab.htm"><b>Flush</b></a>, <a href="cpic03_5q8z.htm"><b>Confirm</b></a>, or <a href="cpic03_5vkz.htm"><b>Deallocate</b></a> call or other call that flushes the LU's send buffer. (Some send types, set by <a href="cpic03_2zkz.htm"><b>Set_Send_Type</b></a>, include flush functionality.)</li>
</ul>
<p>
The data to be sent can be either:
<ul>
<li>
A complete data record on a mapped conversation. A complete data record is a string of the length specified by the <i>send_length</i> parameter.</li>
<li>
A complete logical record or portion thereof on a basic conversation. A complete logical record is determined by the LL value. (One logical record can end and a new one begin in the middle of the string of data to be sent.)</li>
</ul>
<p>
The LU does not automatically perform any conversion between ASCII and EBCDIC on the string of data to be sent. If necessary, the program can use the CSV <a href="appc08c_2vvn.htm"><b>CONVERT</b></a> to translate a string from one character set to the other. </p>
<p>&nbsp;</p></body>
</HTML>
