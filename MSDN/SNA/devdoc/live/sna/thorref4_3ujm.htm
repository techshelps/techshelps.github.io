<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenSchema Method</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_openschema_method_oledb"></a>OpenSchema Method</h1>
<p>
The <b>OpenSchema</b> method on a Connection object obtains database schema information from the provider.</p>
<pre><code><b>recordset = connection.OpenSchema </b>( <i>QueryType</i>, <i>Criteria</i>, <i>SchemaID</i> )
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>QueryType</i></dt>
<dd>
This parameter specifies a <b>SchemaEnum</b> value that indicates the type of schema query to run. The <b>SchemaEnum</b> values supported by the OLE DB Provider for AS/400 and VSAM can be one of the following constants:
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=40%>Enumeration</th>
<th align=left width=13%>Value</th>
<th align=left width=47%>Description</th>
</tr>
<tr valign=top>
<td width=40%><b>adSchemaColumns</b></td>
<td width=13%>4</td>
<td width=47%>This value indicates that the <i>QueryType</i> is requesting column information for tables on the server (not supported when connecting to mainframes )..</td>
</tr>
<tr valign=top>
<td width=40%><b>adSchemaIndexes</b></td>
<td width=13%>12</td>
<td width=47%>This value indicates that the <i>QueryType</i> is requesting index information about the tables on the server (not supported when connecting to mainframes ).</td>
</tr>
<tr valign=top>
<td width=40%><b>adSchemaTables</b></td>
<td width=13%>20</td>
<td width=47%>This value indicates that the <i>QueryType</i> is requesting information about the tables on the server.</td>
</tr>
<tr valign=top>
<td width=40%><b>adSchemaProviderTypes</b></td>
<td width=13%>22</td>
<td width=47%>This value indicates that the <i>QueryType</i> is requesting provider type information.</td>
</tr>
</table><br>

</dd>
<dt>
<i>Criteria</i></dt>
<dd>
This optional parameter specifies an array of query constraints for each <i>QueryType</i> option, as listed below. The values supported by the OLE DB Provider for AS/400 and VSAM can be one of the following constants depending on the <i>QueryType</i>:
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=42%>QueryType / Enumeration</th>
<th align=left width=12%>Value</th>
<th align=left width=46%>Description</th>
</tr>
<tr valign=top>
<td colspan=3 width=100%></td>
</tr>
<tr valign=top>
<td width=42%><b>adSchemaColumns</b></td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_CATALOG</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_SCHEMA</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_NAME</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>COLUMN_NAME</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%></td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%><b>adSchemaIndexes</b></td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_CATALOG</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_SCHEMA</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>INDEX_NAME</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TYPE</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_NAME</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%></td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%><b>adSchemaTables</b></td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_CATALOG</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_SCHEMA</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_NAME</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>TABLE_TYPE</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%></td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%><b>adSchemaProviderTypes</b></td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>DATA_TYPE</td>
<td width=12%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=42%>BEST_MATCH</td>
<td width=12%></td>
<td width=46%></td>
</tr>
</table><br>

</dd>
<dt>
<i>SchemaID</i></dt>
<dd>
This optional parameter specifies the GUID for a provider-schema schema query not defined by the OLE DB specification. This parameter is required if the <i>QueryType</i> parameter is set to <b>adSchemaProviderSpecific</b>; otherwise, it is not used. This parameter is not supported by the OLE DB Provider for AS/400 and VSAM.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns a Recordset object that contains schema information requested.</p>
<h4>Remarks</h4>
<p>
The <b>OpenSchema</b> method on a Connection object is used to return information about the data source, such as information about the tables on the server and the columns in the tables.</p>
<p>
The <i>Criteria</i> argument is an array of values that can be used to limit the results of a schema query. Each schema query supports a different set of parameters. The actual schemas are defined by the OLE DB specification under the <b>IDBSchemaRowset</b> interface. The schema queries supported in ADO 1.5 by the OLE DB Provider for AS/400 and VSAM are listed above.</p>
<p>
Providers are not required to support all of the OLE DB standard schema <i>QueryType</i> values. Specifically, only <b>adSchemaTables</b>, <b>adSchemaColumns</b>, and <b>adSchemaProviderTypes</b> are required by the OLE DB specification. However, the provider is not required to support the <i>Criteria</i> constraints listed above for those schema queries. Support for other schema <i>QueryType </i>values is optional.</p>
<p>
The schema information specified in OLE DB is based on the assumption that providers support the concepts of a catalog and a schema. The ANSI SQL 92 specification defines them as follows:
<ul>
<li>
A catalog contains one or more schemas, but always contains a schema named INFORMATION_SCHEMA which contains the views and domains of the information schema. In Microsoft® SQL Server and Microsoft® Access terms, a catalog is a database; in ODBC 2.<i>x</i> terms, a catalog is a qualifier.</li>
<li>
A schema is a collection of database objects that are owned or have been created by a particular user. In Microsoft SQL Server and ODBC 2.<i>x</i> terms, a schema is an owner; there is no equivalent to a schema in a Microsoft Access database.</li>
</ul>
<p>
Schema information in ADO and OLE DB is retrieved using predefined schema rowsets. The following section lists the contents of each schema rowset supported by the OLE DB Provider for AS/400 and VSAM.</p>
<p>&nbsp;</p></body>
</HTML>
