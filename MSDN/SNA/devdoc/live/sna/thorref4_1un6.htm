<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CommandText Property</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_commandtext_property_oledb"></a>CommandText Property</h1>
<p>
The <b>CommandText</b> property on a Command object contains the text of a command that you want to issue against a provider. This property sets or returns a String value containing a provider command, such as an AS/400 Command Language (CL) command for execution by the remote OS/400 DDM target server. The default value for the <b>CommandText</b> property is a zero-length string.</p>
<pre><code>previousCommandtext = <b>command.CommandText</b>
<b>command.CommandText</b> <b>=</b> "EXEC COMMAND <i>DDMCmd"</i>
<i> </i></code></pre>
<h4>Remarks</h4>
<p>
The <b>CommandText</b> property is used to set or return the text of a Command object. The text can be an AS/400 CL command for execution by the remote OS/400 DDM target server or a request to open a table on a host (a remote DDM Server). </p>
<p>
If the <b>Prepared</b> property of the Command object is set to <b>True</b> and the Command object is bound to an open connection when you set the <b>CommandText</b> property, ADO prepares the query when you call the <b>Execute</b> or <b>Open</b> methods.</p>
<p>
Depending on the <b>CommandType</b> property setting, ADO may alter the <b>CommandText</b> property. The <b>CommandText</b> property can be read at any time to see the actual command text that ADO will use during execution.</p>
<p>
The <b>CommandText</b> property defines the text version of a command. The syntax for the string in the <b>CommandText</b> property is as follows:</p>
<p>
<b>EXEC COMMAND <i>DDMCmd</i> </b></p>
<p>
where <i>DDMCmd</i> represents a valid AS/400 CL command. The <b>CommandType</b> property specifies the type of command described in the <b>CommandText</b> property prior to execution in order to optimize performance. The <b>CommandType</b> property must be set to <b>adCmdText</b> for use with the OLE DB Provider for AS/400 and VSAM.</p>
<p>
The Command object can also be used to open a data file after a Connection object has been opened and the <b>ActiveConnection</b> property has been set to this open connection. The <b>CommandText</b> property defines the data file to open. The syntax for the <b>CommandText</b> property string in this case is as follows:</p>
<p>
<b>EXEC OPEN <i>DataSetName</i></b></p>
<p>
where <i>DataSetName </i>represents a valid data file or library member on the host. The <b>CommandType</b> property must be set to <b>adCmdText</b> for use with the OLE DB Provider for AS/400 and VSAM. If you open a host data file from a Command object, then the data file is opened as read-only. This results from the limitation that no argument or option is passed by ADO that supplies a parameter describing whether the data set should be opened as read-only or updatable.</p>
<p>&nbsp;</p></body>
</HTML>
