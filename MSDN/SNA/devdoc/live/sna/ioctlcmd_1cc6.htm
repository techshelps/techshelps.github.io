<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Function 0x42: Set Link Characteristics</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sna_function_0x42colon_set_link_characteristics_dev"></a>Function 0x42: Set Link Characteristics</h1>
<p>
This function sets the link protocol parameters required by the driver.</p>
<h4>Parameters</h4>
<dl>
<dt>
<i>Frame Size</i> (packet format WORD)</dt>
<dd>
Indicates to the driver the minimum amount of contiguous receiver buffering that must be available for any individual frame.</dd>
<dt>
<i>Data Rate</i> (packet format DWORD)</dt>
<dd>
Line speed in bits per second. If <i>Link Options</i> bit 3 is not set, this field is ignored.</dd>
<dt>
<i>Station Address 1</i> (packet format BYTE)</dt>
<dt>
<i>Station Address 2</i> (packet format BYTE)</dt>
<dd>
Station addresses that the user wishes to receive on if selective reception is to be used (typically for multidropped secondaries). Only frames of data beginning with either of these values will be passed to the user — others are ignored or discarded.
<p>
If the SNALink wishes to listen on only one station address, <i>Station Address 2</i> should be set to zero.

<p>
A value of zero in both fields indicates that all error-free received frames are to be passed to the SNALink, regardless of the contents of their first address byte.
</dd>
<dt>
<i>Link Options</i> (packet format BYTE)</dt>
<dd>
<i>Link Options</i> is a bitmap. The default is all values set to zero. The bits are used as shown in the following table. Note that not all of these options are supported by the standard SNA Server synchronous card drivers.
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=22%>Bit 7</td>
<td width=78%>1 = Four wire (constant RTS/CTS).<br>
0 = Two wire (switched RTS/CTS). </td>
</tr>
<tr valign=top>
<td width=22%>Bit 6</td>
<td width=78%>1 = NRZI encoding.<br>
0 = NRZ encoding.</td>
</tr>
<tr valign=top>
<td width=22%>Bit 5</td>
<td width=78%>1 = HDLC level 1 conventions.<br>
0 = SDLC level 1 conventions.</td>
</tr>
<tr valign=top>
<td width=22%>Bit 4</td>
<td width=78%>1 = Full-duplex (simultaneous 2-way) data.<br>
0 = Half-duplex (alternating 1-way) data.</td>
</tr>
<tr valign=top>
<td width=22%>Bit 3 </td>
<td width=78%>1 = Generate internal clocking. <br>
0 = Take external clocking. </td>
</tr>
<tr valign=top>
<td width=22%>Bit 2</td>
<td width=78%>1 = Use DMA if available.<br>
0 = Do not use DMA on this link. </td>
</tr>
<tr valign=top>
<td width=22%>Bit 1</td>
<td width=78%>1 = Reset all statistics to zero.<br>
0 = Leave accumulated statistics as is.</td>
</tr>
<tr valign=top>
<td width=22%>Bit 0</td>
<td width=78%>Reserved.</td>
</tr>
</table><br>

</dd>
<dt>
Reserved (packet format BYTE).</dt>
<dd>
</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=41%>IoStatus.Status</th>
<th align=left width=34%>IoStatus.Information</th>
<th align=left width=25%>Description</th>
</tr>
<tr valign=top>
<td width=41%>STATUS_INVALID_PARAMETER</td>
<td width=34%>IO_ERR_LINKCHARBUF_<br>
WRONG_SIZE</td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=41%>STATUS_INVALID_PARAMETER</td>
<td width=34%>IO_ERR_FRAME_BUF_<br>
TOO_SMALL</td>
<td width=25%>Buffer must be at least 268 bytes.</td>
</tr>
<tr valign=top>
<td width=41%>STATUS_INVALID_PARAMETER</td>
<td width=34%>IO_ERR_FRAME_BUF_<br>
TOO_BIG</td>
<td width=25%>Buffer maximum size is 2048 bytes.</td>
</tr>
<tr valign=top>
<td width=41%>STATUS_INVALID_PARAMETER</td>
<td width=34%>IO_ERR_NO_CLOCKS</td>
<td width=25%>No internal clocking available</td>
</tr>
<tr valign=top>
<td width=41%>STATUS_DATA_ERROR</td>
<td width=34%>IO_ERR_HARDWARE_<br>
8273CMD_TIMEOUT</td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=41%>STATUS_SUCCESS</td>
<td width=34%>IO_ERR_NO_DMA_FDX</td>
<td width=25%>DMA requested, but can't be used</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The driver should always start the receiver after processing this request. If either the transmitter or receiver is active when this request is issued, the driver stops the current frame before resetting the link characteristics, then restarts the previous operation.</p>
<p>
Link Service DLLs that support the synchronous dumb card interface use the following registry entries to the control this feature.</p>
<p>
<b>SYSTEM\CurrentControlSet\Services\&lt;linkService&gt;\Parameters</b></p>
<p>
where &lt;linkService&gt; is the name of the link service.</p>
<p>
Under this node, the following entries and values must be entered or modified:</p>
<p>
A node called <b>ExtraParameters </b>must be created or modified with the following registry entries and values:
<dl>
<dt>
<b>InternalClock</b></dt>
<dd>
The value of this entry should be defined and set to a REG_DWORD of any value to enable the internal clock.</dd>
<dt>
<b>InternalClockRate</b></dt>
<dd>
The value of this entry should be set to a REG_DWORD equal to the number of bits per second.
</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
