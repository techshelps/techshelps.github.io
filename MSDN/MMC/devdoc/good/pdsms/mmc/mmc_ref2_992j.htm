<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MMCPropPageCallback</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_slate_mmcproppagecallback"></a>MMCPropPageCallback</h1>
<p>
[This is preliminary documentation and subject to change.] </p>
<p>
Sets the correct module state during page creation. </p>
<pre><code><b>STDAPI MMCPropertyPageCallback
  void * </b><i>vpsp</i><b>,  </b>// Pointer to PROPSHEET structure 
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>vpsp</i></dt>
<dd>
Pointer to the Windows PROPSHEETPAGE structure. Note that by default, MFC installs its own callback in the <i>pfnCallback</i> member of the structure. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The module state was successfully set.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For each page derived from <b>CPropertyPage</b>, call this function with a pointer to the page's callback, following these guidelines: 
<ul>
<li>
All pages for this sheet must use the same callback pointer.</li>
<li>
If you replace MFC's callback with your own, your callback must call MFC's callback. </li>
<li>
You must call this function with each <b>CPropertyPage </b>derived class.</li>
</ul>
<p>
MFC must have correct module state set from exported functions or COM interfaces. This includes calls made from the operating system to the module. For exported functions or COM interfaces this is done with an AFX_MANAGE_STATE (<b>AfxGetStaticModuleState</b>). For the operating system call, MFC does this automatically. Since the property sheet is not an MFC <b>CPropertySheet</b>, the operating system call, due to the callback, is in the wrong module state. MFC will make changes in the future to use the module state contained in the <b>CCmdTarget</b> class, but until then, you hook the window create and make sure the module state is correctly set during the page creation, which is what the <b>MMCPropPageCallback</b> does. Once this is done, the only AFX_MANAGE_STATE calls that need to be made are those exposed by COM interfaces (<b>IExtendPropertySheet::CreatePropertyPages</b>). To determine whether the application has the correct module state, look at <b>CWinApp</b> and note the name.</p>
<h4>See Also</h4>
<p>
<a href="mmc_ref2_4r6t.htm"><b>PROPSHEETPAGE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
