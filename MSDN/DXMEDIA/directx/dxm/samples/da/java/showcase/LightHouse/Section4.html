<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DirectX Media SDK DirectAnimation Tutorial</TITLE>
<LINK REL=STYLESHEET HREF="/directx/dxm/webcd/da/tutorial.css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="noindex">
</HEAD>
<BODY BGCOLOR="WHITE" LINK="#0033CC" TOPMARGIN=0 LEFTMARGIN=20>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->

<DIV CLASS="flush">
<TABLE WIDTH="100%" BORDER=0 BGCOLOR="#000000">
<TR ALIGN=RIGHT><TD VALIGN=TOP><FONT CLASS=desc1 SIZE=2>
<A HREF="Section3.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_prev.gif"
 WIDTH=71 HEIGHT=16 BORDER=0 ALT="Previous Topic">
</A><A HREF="/directx/dxm/webcd/da/tutorial_main.htm" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/d_home.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Tutorial Home Page"></A>
<A HREF="Section5.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_next.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Next Topic">
</A></FONT></TD><TD WIDTH=30></TD></TR></TABLE></DIV>
<FONT CLASS=title><CENTER>Section4: Including 3D Geometries</CENTER></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Now we want to create a weather vane, sailboat, and seagull which will look
 like they are part of the 2D scene we created with our cellImages.  In this
 part of the tutorial, the process of creating the weather vane will be
 explained. The sailboat and seagull, although more complex, are created in
 similar fashion.
<BR>
 Here we have a class called weatherVane with a static method called getGeo,
 which returns a GeometryBvr.  This kind of class can be refered to as a
 DirectAnimation module because it describes a set of media, in this case
 geometries, and behaviors built around that media, that form a more complex
 DirectAnimation behavior, in this case a GeometryBvr.</FONT></TD></TR></TABLE>
<FONT CLASS=code>public class weatherVane extends Statics  {<BR>
<DIV STYLE="margin-left: 0.125in">public static GeometryBvr getGeo(NumberBvr windAngle,<BR>
</DIV><DIV STYLE="margin-left: 0.25in">NumberBvr windDistance, URL importBase)  {<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Here we import pieces of geometry such as scoops and arrows, which will
 be used to construct the weather vane.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.25in">GeometryBvr nsewGeo  = importGeometry(buildURL(importBase, "nsew.x"));<BR>
GeometryBvr arrowGeo = importGeometry(buildURL(importBase, "arrow.x"));<BR>
GeometryBvr scoopGeo = importGeometry(buildURL(importBase, "scoops.x"));<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> The arrows are going to rotate based on the wind angle.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.25in">GeometryBvr arrow = arrowGeo.transform(rotate(yVector3, windAngle));<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> The scoops will spin based on the wind speed.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.25in">GeometryBvr scoops =<BR>
</DIV><DIV STYLE="margin-left: 0.375in">scoopGeo.transform(<BR>
</DIV><DIV STYLE="margin-left: 0.5in">compose(rotate(yVector3, mul(toBvr(8),windDistance)),<BR>
</DIV><DIV STYLE="margin-left: 0.625in">scale3(toBvr(1.25))));<BR>
</DIV><DIV STYLE="margin-left: 0.3125in"></DIV>
</FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Combine these to form the complete weather vane (our first
 DirectAnimation module).</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.25in">return union(arrow, union(scoops, union(nsewGeo, directionalLight)));<BR>
</DIV><DIV STYLE="margin-left: 0.125in">}<BR>
</DIV>}<BR>
</FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Back in the lhouseModel class, use the getGeo() model to construct
 the vane, and transform it to match the perspective of the scene.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.25in">GeometryBvr vane =<BR>
</DIV><DIV STYLE="margin-left: 0.375in">weatherVane.getGeo(windAngle,windDistance, geoBase).transform(<BR>
</DIV><DIV STYLE="margin-left: 0.5in">compose(translate(toBvr(-1.1),toBvr(-0.5),toBvr(0)),<BR>
</DIV><DIV STYLE="margin-left: 0.625in">compose(rotate(xVector3, toBvr(Math.PI/12)),<BR>
</DIV><DIV STYLE="margin-left: 0.75in">compose(rotate(yVector3, toBvr(Math.PI/4)),<BR>
</DIV><DIV STYLE="margin-left: 0.875in">scale3(toBvr(0.6))))));<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> In order to use the geometry in the scene, convert the geometry
 to an image.  Here, define a helper method that takes any geometry,
 and the upper right corner of the scene.  It then return a rendered and
 scaled image.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.125in">private ImageBvr geometryImage(GeometryBvr geo, Point2Bvr UR)  {<BR>
</DIV><DIV STYLE="margin-left: 0.25in">CameraBvr camera =<BR>
</DIV><DIV STYLE="margin-left: 0.375in">perspectiveCamera(toBvr(1),toBvr(0))<BR>
</DIV><DIV STYLE="margin-left: 0.5in">.transform(translate(toBvr(0), toBvr(0), toBvr(2)));<BR>
<BR>
</DIV><DIV STYLE="margin-left: 0.25in">NumberBvr scaleFactor = (NumberBvr)<BR>
</DIV><DIV STYLE="margin-left: 0.375in">cond(lte(UR.getX(), UR.getY()), UR.getX(), UR.getY());<BR>
</DIV><DIV STYLE="margin-left: 0.5in"><BR>
</DIV><DIV STYLE="margin-left: 0.25in">return geo.render(camera).transform(scale2(mul(toBvr(2.8), scaleFactor)));<BR>
</DIV><DIV STYLE="margin-left: 0.125in">}<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Overlay all of the rendered geometry images over the image composed of
 all the sprites.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.25in">ImageBvr composite =<BR>
</DIV><DIV STYLE="margin-left: 0.375in">overlay(geometryImage(gull, imageUR),<BR>
</DIV><DIV STYLE="margin-left: 0.5in">overlay(geometryImage(sailBoat.getGeo(windSpeed, geoBase), imageUR),<BR>
</DIV><DIV STYLE="margin-left: 0.625in">overlay(geometryImage(vane, imageUR), allSprites.getImageBvr())));<BR>
</DIV><BR>
<BR></FONT>
<FONT CLASS=link><A CLASS=cpslug HREF="http://www.microsoft.com/misc/cpyright.htm"  TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A></FONT>

<BR>
<BR>
<DIV CLASS="flush">
<TABLE WIDTH="100%" BORDER=0 BGCOLOR="#000000">
<TR ALIGN=RIGHT><TD VALIGN=TOP><FONT CLASS=desc1 SIZE=2>
<A HREF="Section3.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_prev.gif"
 WIDTH=71 HEIGHT=16 BORDER=0 ALT="Previous Topic">
</A><A HREF="/directx/dxm/webcd/da/tutorial_main.htm" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/d_home.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Tutorial Home Page"></A>
<A HREF="Section5.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_next.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Next Topic">
</A></FONT></TD></TR><TR><TD WIDTH=30></TD></TR></TABLE></DIV>

</BODY>
</HTML>
