<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DirectX Media SDK DirectAnimation Tutorial</TITLE>
<LINK REL=STYLESHEET HREF="/directx/dxm/webcd/da/tutorial.css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="noindex">
</HEAD>
<BODY BGCOLOR="WHITE" LINK="#0033CC" TOPMARGIN=0 LEFTMARGIN=20>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->

<DIV CLASS="flush">
<TABLE WIDTH="100%" BORDER=0 BGCOLOR="#000000">
<TR ALIGN=RIGHT><TD VALIGN=TOP><FONT CLASS=desc1 SIZE=2>
<A HREF="Section9.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_prev.gif"
 WIDTH=71 HEIGHT=16 BORDER=0 ALT="Previous Topic">
</A><A HREF="/directx/dxm/webcd/da/tutorial_main.htm" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/d_home.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Tutorial Home Page"></A>
<A HREF="Section11.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_next.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Next Topic">
</A></FONT></TD><TD WIDTH=30></TD></TR></TABLE></DIV>
<FONT CLASS=title><CENTER>The Notification Object upon Puzzle Events</CENTER></FONT>
<BR>
<FONT CLASS=code>
</FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> This object accepts a user event, and if it's a legal move
 (cell that is adjacent to the empty location), then the cell
 is transitioned and success sound is emitted, else illegal move
 sound is emitted.</FONT></TD></TR></TABLE>
<FONT CLASS=code>class ImagePicker extends Statics implements UntilNotifier {<BR>
<DIV STYLE="margin-left: 0.125in">public ImagePicker(int row,<BR>
</DIV><DIV STYLE="margin-left: 1.3125in">int col,<BR>
DXMEvent ev,<BR>
PuzzleLogic puzz) {<BR>
</DIV><DIV STYLE="margin-left: 0.5in">_row = row;<BR>
_col = col;<BR>
_ev = ev;<BR>
_puzz = puzz;<BR>
</DIV><DIV STYLE="margin-left: 0.125in">}<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> invoked through the untilNotify construct</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.125in">public Behavior notify(Object eventData,<BR>
</DIV><DIV STYLE="margin-left: 1.5625in">Behavior currentRunningBvr,<BR>
BvrsToRun lst) {<BR>
</DIV><DIV STYLE="margin-left: 0.375in"><BR>
</DIV><DIV STYLE="margin-left: 0.25in">Behavior xf = currentRunningBvr;<BR>
int r = _puzz._emptyRow;<BR>
int c = _puzz._emptyCol;<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> check to see if this is a legal move</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.25in">if (((Math.abs(_row - r) == 1) && _col == c) ||<BR>
</DIV><DIV STYLE="margin-left: 0.5in">((Math.abs(_col - c) == 1) && _row == r)) {<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> find cell positions before and after the move</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">Point2Bvr start = point2(toBvr(_col * _puzz._inc),<BR>
</DIV><DIV STYLE="margin-left: 2.0625in">toBvr(_row * _puzz._inc));<BR>
</DIV><DIV STYLE="margin-left: 0.375in">Point2Bvr finish = point2(toBvr(c * _puzz._inc),<BR>
</DIV><DIV STYLE="margin-left: 2.125in">toBvr(r * _puzz._inc));<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Build up a transform to move from orig to final in 0.5 second</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">double transitionTime = 0.5;<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> the vector from start to finish</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">Vector2Bvr delta = sub(finish, start);<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> pos begins at start and transitions to finish in transitionTime seconds</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">Point2Bvr pos = add(start, delta.mul(div(localTime, toBvr(transitionTime))));<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> extract a translation from moving position</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">Transform2Bvr movingXf = translate(sub(pos, origin2));<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Use this transform, and after the elapsed time freeze
 in place using a snapshot event.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">xf = untilEx(movingXf,<BR>
</DIV><DIV STYLE="margin-left: 0.5in">timer(toBvr(transitionTime)).snapshotEvent(movingXf));</DIV>
</FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> an alternative is: ,translate(finish.getX(), finish.getY()));</FONT></TD></TR></TABLE>
<FONT CLASS=code></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Set the new location of the empty cell</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">_puzz._emptyCol = _col;<BR>
_puzz._emptyRow = _row;<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Set what position this cell is at now</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">_col = c;<BR>
_row = r;<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> emit success sound</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">_puzz.setHitSound(true);<BR>
<BR>
</DIV><DIV STYLE="margin-left: 0.25in">} else {<BR>
</DIV></FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> emit illegal move sound</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">_puzz.setHitSound(false);<BR>
</DIV><DIV STYLE="margin-left: 0.25in">}</DIV>
</FONT>
<BR>
<TABLE><TR><TD WIDTH=500><FONT CLASS=desc1> Return this new transform, waiting again for the pick event.</FONT></TD></TR></TABLE>
<FONT CLASS=code><DIV STYLE="margin-left: 0.375in">return untilNotify(xf, _ev, this);<BR>
</DIV><DIV STYLE="margin-left: 0.125in">}<BR>
</DIV><BR>
<DIV STYLE="margin-left: 0.125in">int _row;<BR>
int _col;<BR>
DXMEvent _ev;<BR>
PuzzleLogic _puzz;<BR>
</DIV>}<BR>
<BR></FONT>
<FONT CLASS=link><A CLASS=cpslug HREF="http://www.microsoft.com/misc/cpyright.htm"  TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A></FONT>
<BR>
<BR>
<DIV CLASS="flush">
<TABLE WIDTH="100%" BORDER=0 BGCOLOR="#000000">
<TR ALIGN=RIGHT><TD VALIGN=TOP><FONT CLASS=desc1 SIZE=2>
<A HREF="Section9.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_prev.gif"
 WIDTH=71 HEIGHT=16 BORDER=0 ALT="Previous Topic">
</A><A HREF="/directx/dxm/webcd/da/tutorial_main.htm" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/d_home.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Tutorial Home Page"></A>
<A HREF="Section11.html" TARGET="_top">
<IMG SRC="/directx/dxm/media/image/u_next.gif" WIDTH=48 HEIGHT=16 BORDER=0 ALT="Next Topic">
</A></FONT></TD></TR><TR><TD WIDTH=30></TD></TR></TABLE></DIV>

</BODY>
</HTML>
