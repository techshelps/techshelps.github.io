<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DirectAnimation SDK, JScript sample</TITLE>
<SCRIPT LANGUAGE="JScript">
<!--
if (window.top.frames.length!=0 && window.top.frames[0].ShowNoButtons!=null)
    window.top.frames[0].ShowNoButtons();
//-->
</SCRIPT>
<!--STRIP_END-->
</HEAD>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->

<BODY BGCOLOR="#AAAAAA">

<OBJECT ID="DAControl" 
  STYLE="position:absolute; filter:glow(strength=0, color=#0000FF); top:50; left:20%; width:500; height:200" 
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>

<DIV STYLE="position:absolute; left=20%; top:250; width:500">
<FONT FACE="verdana">
This vector graphics example shows a time varying glow being applied to the control
elements.  The control makes use of a montage (animated layering similar to z-Depth 
on style sheets) to allow the oval to pass over and under the text.
</FONT>
</DIV>

<SCRIPT LANGUAGE="JScript">
<!--
  // Get the DirectAnimation library from the control
	m = DAControl.MeterLibrary;

  // Create some text
  textImg = m.StringImage("DirectAnimation", m.Font("Verdana", 24, m.Black));

  // Create a time varying number
  glow = m.Sequence(m.Interpolate(0,5,1), m.Interpolate(5,0,1)).RepeatForever();
  
  // Use it to animate the strength property with an update rate of every .08 seconds
  DAControl.AddBehaviorToRun(
    glow.AnimateProperty("DAControl.filters[0].strength", "JScript", false, .08));

  // Create two arcs
  halfArc1 = m.ArcDegrees(90,270,.065,.02).Draw(m.DefaultLineStyle.Width(3).Color(m.Yellow));
  halfArc2 = halfArc1.Transform(m.Compose2(m.Translate2(0,.003), m.Rotate2Degrees(180)));
  halfArc1 = halfArc1.Transform(m.Translate2(0,.003));

  // Create a 3D rotation and get the depth of a point rotating along this path
  xf = m.Rotate3Rate(m.yVector3, 2);
  depth = m.Vector3(.06,0,0).Transform(xf).Z;

  // Create a blue polygon
  slidePath = m.Polyline(new Array(-.03,-.002, -.026,.001, .03,.001, .026,-.002));
  slideImg = slidePath.Fill(m.DefaultLineStyle, m.SolidColorImage(m.Blue));

  // Create an animated montage that uses three layers with an animated depth.
  textMntg = m.ImageMontage(m.Overlay(textImg, slideImg), 0);
  arc1Mntg = m.ImageMontageAnim(halfArc1.Transform(xf.ParallelTransform2()), depth);
  arc2Mntg = m.ImageMontageAnim(halfArc2.Transform(xf.ParallelTransform2()), m.Neg(depth));
  finalImg = m.UnionMontage(m.UnionMontage(textMntg, arc1Mntg), arc2Mntg).Render();
  DAControl.Image = finalImg.Transform(m.Scale2Uniform(1.75));
  DAControl.Start();
//-->
</SCRIPT>
</BODY>
</HTML>


