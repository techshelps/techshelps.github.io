<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Porting Code from ActiveMovie</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="Porting Code from ActiveMovie">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="h1_porting"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- Porting Code from ActiveMovie"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- Porting Code from ActiveMovie"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0000.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0002.htm">What's New in the DirectShow SDK?</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0004.htm">What Background Do You Need?</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>Porting Code from ActiveMovie</H2>
<BR CLEAR=ALL>
<P>This article describes the steps you must take to port your Microsoft&#174; ActiveMovie&#153; 1.0 code to Microsoft DirectShow&#153;. 

<P><B>Contents of this article:</B>
<UL><LI><A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0003.htm#porting_AM1">Recompiling ActiveMovie 1.0 Code with DirectShow</A>
<LI><A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0003.htm#improved_AM1">Interfaces and Services Improved Since ActiveMovie 1.0</A>

</UL>
<A NAME="porting_AM1"></A><P><B>Recompiling ActiveMovie 1.0 Code with DirectShow</B>
<P>If you are recompiling your ActiveMovie 1.0 code with the DirectShow header files and libraries, you must make the following changes:
<OL><LI>The name of the <B>IFilter</B> interface has been changed to <A HREF="/directx/dxm/help/ds/dssd0121.htm#IBaseFilter">IBaseFilter</A>. You need to change the name to compile with DirectShow libraries and headers.


ActiveMovie 1.0 binaries will continue to work because the IID (Interface Identifier) GUID


 for the interface is still the same.
<LI>The constructor of the <A HREF="/directx/dxm/help/ds/dssd0209.htm#+">CBasePropertyPage::CBasePropertyPage</A> function


 has one less parameter. Once again, if you are recompiling your code with the DirectShow base class libraries, you will have to modify the parameters for the <A HREF="/directx/dxm/help/ds/dssd0209.htm#CBasePropertyPage">CBasePropertyPage</A> constructor.


 <P>The old prototype for the constructor was:
<PRE><FONT FACE="Courier" SIZE="2">
CBasePropertyPage(TCHAR *pName,       // Debug only name
                      LPUNKNOWN pUnk,         // COM Delegator
                      HRESULT *phr,                 // Return code
                      int DialogId,                      // Resource ID
                      int TitleId);                        // To get title
</FONT></PRE>
<P>The new prototype is: 
<PRE><FONT FACE="Courier" SIZE="2">
CBasePropertyPage(TCHAR *pName,       // Debug only name
                      LPUNKNOWN pUnk,         // COM Delegator
                      int DialogId,                      // Resource ID
                      int TitleId);                        // To get title
</FONT></PRE>
</OL>
<A NAME="improved_AM1"></A><P><B>Interfaces and Services Improved Since ActiveMovie 1.0</B>
<P>Some interfaces and services in ActiveMovie 1.0 have been improved in DirectShow. You should use the following improved interfaces and services:
<OL><LI>A new interface, <A HREF="/directx/dxm/help/ds/dssd0149.htm#IFilterMapper2">IFilterMapper2</A>, has been introduced to support the concept of filter categories and registering filters in correct categories. <A HREF="/directx/dxm/help/ds/dssd0148.htm#IFilterMapper">IFilterMapper</A> will still work for filters that were shipped with ActiveMovie 1.0 and are now part of the standard filters in the Filter Graph Editor.


 <B>IFilterMapper</B> might not do the right thing for filters that are in the new categories. For example, you might end up with filters that you can't instantiate.
<LI>The <A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieSetupRegisterFilter2">AMovieSetupRegisterFilter2</A> function has been added to use <B>IFilterMapper2</B>. <A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieSetupRegisterFilter">AMovieSetupRegisterFilter</A> will still work and will use <A HREF="/directx/dxm/help/ds/dssd0148.htm#IFilterMapper">IFilterMapper</A>.
</OL>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
