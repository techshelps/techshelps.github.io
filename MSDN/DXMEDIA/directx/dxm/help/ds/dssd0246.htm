<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPullPin Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="CPullPin Class">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="CPullPin"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CPullPin Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CPullPin Class"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0188.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0245.htm">CPosPassThru Class</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0247.htm">CQueue Class</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>CPullPin Class</H2>
<BR CLEAR=ALL>
<P><IMG SRC="/directx/dxm/help/ds/art/pulpin01.gif" WIDTH="205" HEIGHT="56" ALT="CPullPin class hierarchy">

<P>The <B>CPullPin</B> class is provided to allow a filter downstream from the source to create a thread and pull a media stream from an asynchronous source filter that supports the <A HREF="/directx/dxm/help/ds/dssd0119.htm">IAsyncReader</A> interface. Typically this class is implemented on the input pin of a parser filter, since the Microsoft&#174; DirectShow&#153; asynchronous reader filter just reads a media stream from a file and provides no parsing.

<A NAME="Protected_Data_Membe"></A><P><B>Protected Data Members</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="CPullPin::m_pAlloc">m_pAlloc</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Pointer to the <A HREF="/directx/dxm/help/ds/dssd0165.htm">IMemAllocator</A> interface used by the connection. 
</FONT></TD></TR></TABLE>
<A NAME="Member_Functions"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#Active">Active</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Instructs the pin to start pulling data from the asynchronous reader.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#AlignDown">AlignDown</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Aligns a <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONGLONG">LONGLONG</A> value down to the next <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONG">LONG</A> boundary.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#AlignUp">AlignUp</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Aligns a <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONGLONG">LONGLONG</A> value up to the next <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONG">LONG</A> boundary.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#Connect">Connect</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Initiates a connection from this pin to the asynchronous reader.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#+">CPullPin</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#Disconnect">Disconnect</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Breaks a connection to the asynchronous reader.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#Duration">Duration</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the total duration of the media stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#GetReader">GetReader</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the asynchronous reader interface. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#Inactive">Inactive</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Instructs the pin to stop pulling data from the asynchronous reader.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#Seek">Seek</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the start and stop times of the media stream.
</FONT></TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P><B>Overridable Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#BeginFlush">BeginFlush</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Flushes this pin and all downstream pins.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#DecideAllocator">DecideAllocator</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Proposes an allocator for use by the asynchronous reader.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#EndFlush">EndFlush</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Signals end of flushing operation.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#EndOfStream">EndOfStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends end-of-stream notification downstream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#OnError">OnError</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Handles run-time errors that caused pulling to stop.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0246.htm#Receive">Receive</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Handles the arrival of data from the asynchronous reader.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="Active">CPullPin::Active</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Instructs the pin to start pulling data from the asynchronous reader.

<P><B>HRESULT</B> <B>Active</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.


<H5>Remarks</H5>
<P>The reader interface must be retrieved and the allocator decided before calling this 
member function. This is handled by the <A HREF="/directx/dxm/help/ds/dssd0246.htm#Connect">CPullPin::Connect</A> member function.
<H3><HR COLOR="#0000FF"><A NAME="AlignDown">CPullPin::AlignDown</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Aligns a <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONGLONG">LONGLONG</A> value down to the next <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONG">LONG</A> boundary.

<P><B>LONGLONG</B> <B>AlignDown</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>ll</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>lAlign</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>ll</I>
 </DT><DD>Element to be aligned.
</DD><DT><I>lAlign</I>
 </DT><DD>Alignment boundary.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <I>ll</I> value aligned to <I>lAlign</I>.


<H5>Remarks</H5>
<P>Aligning downward is a truncation operation.
<H3><HR COLOR="#0000FF"><A NAME="AlignUp">CPullPin::AlignUp</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Aligns a <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONGLONG">LONGLONG</A> value up to the next <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONG">LONG</A> boundary.

<P><B>LONGLONG</B> <B>AlignUp</B><B>(</B><BR>&nbsp;&nbsp;<B>LONGLONG</B> <I>ll</I><B>,</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>lAlign</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ll</I>
 </DT><DD>Element to be aligned.
</DD><DT><I>lAlign</I>
 </DT><DD>Alignment boundary.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.


<H3><HR COLOR="#0000FF"><A NAME="BeginFlush">CPullPin::BeginFlush</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Override to flush this pin and all downstream pins.

<P><B>virtual</B> <B>HRESULT</B> <B>BeginFlush</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This member function is called by the <A HREF="/directx/dxm/help/ds/dssd0246.htm#Seek">CPullPin::Seek</A> member function before
pausing the thread prior to a seeking operation. You must implement this member function to 
call the <A HREF="/directx/dxm/help/ds/dssd0170.htm#BeginFlush">IPin::BeginFlush</A> method on the connected downstream pin. 
<H3><HR COLOR="#0000FF"><A NAME="Connect">CPullPin::Connect</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Initiates a connection from this pin to the asynchronous reader.

<P><B>HRESULT</B> <B>Connect</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown*</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>IMemAllocator*</B> <I>pAlloc</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bSync</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pUnk</I>
 </DT><DD>Object to query for existence of asynchronous reader (<A HREF="/directx/dxm/help/ds/dssd0119.htm">IAsyncReader</A>).
</DD><DT><I>pAlloc</I>
 </DT><DD>Optional allocator to propose as preferred allocator if necessary.
</DD><DT><I>bSync</I>
 </DT><DD>Set TRUE if the reader uses synchronous rather than asynchronous reads.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successfully connected to the <A HREF="/directx/dxm/help/ds/dssd0119.htm">IAsyncReader</A> interface
from the object specified by <I>pUnk</I>.

<H3><HR COLOR="#0000FF"><A NAME="+">CPullPin::CPullPin</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Constructs a <A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin</A> object.

<P><B>CPullPin</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>No return value.
<H3><HR COLOR="#0000FF"><A NAME="DecideAllocator">CPullPin::DecideAllocator</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Negotiates an allocator to use with the asynchronous reader.

<P><B>virtual</B> <B>HRESULT</B> <B>DecideAllocator</B><B>(</B><BR>&nbsp;&nbsp;<B>IMemAllocator*</B> <I>pAlloc</I><B>,</B><BR>&nbsp;&nbsp;<B>ALLOCATOR_PROPERTIES</B> <B>*</B> <I>pProps</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pAlloc</I>
 </DT><DD>Allocator to propose as the preferred allocator (optional). Pass NULL if you aren't proposing an allocator.
</DD><DT><I>pProps</I>
 </DT><DD>Size, count, and alignment of the allocator (optional). Pass 0 if not requesting the allocator properties. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful, VFW_E_BADALIGN if <I>eProps</I> contains an invalid alignment property, E_OUTOFMEMORY if there is not enough memory available to create an allocator, and E_NOINTERFACE if the created <A HREF="/directx/dxm/help/ds/dssd0165.htm">IMemAllocator</A> interface is invalid.

<H5>Remarks</H5>
<P>This member function calls the <A HREF="/directx/dxm/help/ds/dssd0119.htm#RequestAllocator">IAsyncReader::RequestAllocator</A> method to negotiate an allocator. 
<H3><HR COLOR="#0000FF"><A NAME="Disconnect">CPullPin::Disconnect</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Breaks a connection to the asynchronous reader.

<P><B>HRESULT</B> <B>Disconnect</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns NOERROR if there is no connection.

<H5>Remarks</H5>
<P>This member function disconnects any connection to an 
asynchronous file reader made in the <A HREF="/directx/dxm/help/ds/dssd0246.htm#Connect">CPullPin::Connect</A> method.
<H3><HR COLOR="#0000FF"><A NAME="Duration">CPullPin::Duration</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Retrieves the total duration of the media stream.

<P><B>HRESULT</B> <B>Duration</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME*</B> <I>ptDuration</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ptDuration</I>
 </DT><DD>Duration measured in bytes multiplied by UNIT (10,000,000).
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H3><HR COLOR="#0000FF"><A NAME="EndFlush">CPullPin::EndFlush</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Override to signal the end of a flushing operation.

<P><B>virtual</B> <B>HRESULT</B> <B>EndFlush</B><B>(</B><B>void</B><B>)</B> <B>PURE;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This member function is called by the <A HREF="/directx/dxm/help/ds/dssd0246.htm#Seek">CPullPin::Seek</A> member function after
pausing the thread prior to a seeking operation. You must implement this member function to 
call the <A HREF="/directx/dxm/help/ds/dssd0170.htm#EndFlush">IPin::EndFlush</A> method on the connected downstream pin. 

<H3><HR COLOR="#0000FF"><A NAME="EndOfStream">CPullPin::EndOfStream</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Override to send an end-of-stream notification downstream. 

<P><B>virtual</B> <B>HRESULT</B> <B>EndOfStream</B><B>(</B><B>void</B><B>)</B> <B>PURE;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This member function is called during processing of received samples when the end of the 
stream is reached. You must implement this member function to 
call the <A HREF="/directx/dxm/help/ds/dssd0170.htm#EndOfStream">IPin::EndOfStream</A> method on the connected downstream pin. 
<H3><HR COLOR="#0000FF"><A NAME="GetReader">CPullPin::GetReader</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Returns the asynchronous reader.

<P><B>IAsyncReader*</B> <B>GetReader</B><B>(</B><B>void</B><B>)</B><B>;</B> <BR><H5>Return Values</H5>
<P>Returns a reference-counted <A HREF="/directx/dxm/help/ds/dssd0119.htm">IAsyncReader</A> interface.

<H3><HR COLOR="#0000FF"><A NAME="Inactive">CPullPin::Inactive</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Instructs the pin to stop pulling data from the asynchronous reader.

<P><B>HRESULT</B> <B>Inactive</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This member function calls the <A HREF="/directx/dxm/help/ds/dssd0119.htm#BeginFlush">IAsyncReader::BeginFlush</A> method,
ends the thread, calls the <A HREF="/directx/dxm/help/ds/dssd0119.htm#EndFlush">IAsyncReader::EndFlush</A> method and then 
decommits the allocator. 
<H3><HR COLOR="#0000FF"><A NAME="OnError">CPullPin::OnError</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Override to handle run-time errors that caused pulling to stop.

<P><B>virtual</B> <B>void</B> <B>OnError</B><B>(</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <I>hr</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B><BR><H5>Parameters</H5>
<DL><DT><I>hr</I>
 </DT><DD><A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value of the trapped error.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>These errors are returned from the upstream filter (the asynchronous reader), which will have
already reported errors to the filter graph manager. This member function must be implemented
since it is called by several <A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin</A> member functions when trapping errors. 

<H3><HR COLOR="#0000FF"><A NAME="Receive">CPullPin::Receive</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Override this member function to handle the arrival of data from the asynchronous reader.

<P><B>virtual</B> <B>HRESULT</B> <B>Receive</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaSample</B> <B>*</B> <I>pSample</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B><BR><H5>Parameters</H5>
<DL><DT><I>pSample</I>
</DT><DD>[in] Pointer to a media sample.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value. Returning a value other than S_OK will stop the data.

<H5>Remarks</H5>
<P> You must implement this member function in your derived class.
This member function is called whenever a new sample arrives while processing the sample stream. 
It should be written in the same manner as the <A HREF="/directx/dxm/help/ds/dssd0166.htm#Receive">IMemInputPin::Receive</A> method on an input pin. 
<H3><HR COLOR="#0000FF"><A NAME="Seek">CPullPin::Seek</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0246.htm">CPullPin Class</A>
<P>Sets the start and stop times of the media stream.

<P><B>HRESULT</B> <B>Seek</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStart</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStop</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>tStart</I>
 </DT><DD>Start time (defaults to zero).
</DD><DT><I>tStop</I>
 </DT><DD>Stop time (defaults to the value of <A HREF="/directx/dxm/help/ds/dssd0246.htm#Duration">CPullPin::Duration</A>).
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>If the filter graph is running (active), the media rendering will start 
immediately at the new position defined by <I>tStart</I>. 
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
