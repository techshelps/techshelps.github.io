<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAMVfwCaptureDialogs Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IAMVfwCaptureDialogs Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="IAMVfwCaptureDialogs"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMVfwCaptureDialogs Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMVfwCaptureDialogs Interface"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0091.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0114.htm">IAMTVTuner Interface</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0116.htm">IAMVfwCompressDialogs Interface</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>IAMVfwCaptureDialogs Interface</H2>
<BR CLEAR=ALL>
<P>The <B>IAMVfwCaptureDialogs</B> interface enables an application to display one of the three dialog boxes (Source, Format, or Display) provided by Microsoft&#174; Video for Windows&#174; capture drivers.


<A NAME="When_to_Implement"></A><P><B>When to Implement</B>
<P>The Video for Windows <A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0356.htm#VFW_Video_Capture">VFW Video Capture</A> filter implements this interface. It isn't expected that anything else will implement this interface.

<A NAME="When_to_Use"></A><P><B>When to Use</B>
<P>Any application that enables the user to change settings in a Video for Windows capture driver-supplied dialog box should use this interface. 

<A NAME="Methods_in_Vtable_Or"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#AddRef">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#Release">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMVfwCaptureDialogs methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0115.htm#HasDialog">HasDialog</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Determines if the specified dialog box exists in the driver.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0115.htm#ShowDialog">ShowDialog</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Displays the specified dialog box.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0115.htm#SendDriverMessage">SendDriverMessage</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends a driver-specific message.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="HasDialog">IAMVfwCaptureDialogs::HasDialog</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0115.htm">IAMVfwCaptureDialogs Interface</A>
<P>Determines if the specified dialog box exists in the driver.
<P><B>HRESULT</B> <B>HasDialog</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iDialog</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>iDialog </I>
 </DT><DD>[in] Desired dialog box. This is a member of the <A HREF="/directx/dxm/help/ds/dssd0299.htm#VfwCaptureDialogs">VfwCaptureDialogs</A> enumerated data type.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if the driver contains the dialog box or S_FALSE otherwise.
 
<H5>Remarks</H5>
<P>This method calls the Video for Windows <A HREF="/directx/dxm/help/ds/dssd0404.htm#videoDialog">videoDialog</A> function to query for the existence of the appropriate dialog box.
 

<H3><HR COLOR="#0000FF"><A NAME="SendDriverMessage">IAMVfwCaptureDialogs::SendDriverMessage</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0115.htm">IAMVfwCaptureDialogs Interface</A>
<P>Sends a driver-specific message.
<P><B>HRESULT</B> <B>SendDriverMessage</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iDialog</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>uMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dw1</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dw2</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>iDialog</I>
 </DT><DD>[in] Handle of the driver dialog box. This is a member of the <A HREF="/directx/dxm/help/ds/dssd0299.htm#VfwCaptureDialogs">VfwCaptureDialogs</A> enumerated data type.
</DD><DT><I>uMsg</I>
 </DT><DD>[in] Message to send to the driver.
</DD><DT><I>dw1</I>
 </DT><DD>[in] Message data.
</DD><DT><I>dw2</I>
 </DT><DD>[in] Message data.
</DD></DL>
<H5>Return Values</H5>
<P>Return value varies depending on the implementation within each driver.

<H5>Remarks</H5>
<P>You should never need to use this method. This method can send any private message to the capture driver. Behavior might be undetermined in response to arbitrary messages; use this method at your own risk.

<P>This method calls the Video for Windows <A HREF="/directx/dxm/help/ds/dssd0404.htm#videoMessage">videoMessage</A> function to send the driver message.
 
<H3><HR COLOR="#0000FF"><A NAME="ShowDialog">IAMVfwCaptureDialogs::ShowDialog</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0115.htm">IAMVfwCaptureDialogs Interface</A>
<P>Displays the specified dialog box.
<P><B>HRESULT</B> <B>ShowDialog</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>iDialog</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>hwnd</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>iDialog</I>
 </DT><DD>[in] Dialog box to display. This is a member of the <A HREF="/directx/dxm/help/ds/dssd0299.htm#VfwCaptureDialogs">VfwCaptureDialogs</A> enumerated data type.

</DD><DT><I>hwnd</I>
 </DT><DD>[in] Handle of the dialog box's parent window.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>You can't use this method when the driver is streaming or displaying another dialog box. While the driver displays the dialog box you can't stream (pause or run) the filter.

<P><B>IAMVfwCaptureDialogs::ShowDialog</B> calls the Video for Windows&#174; <A HREF="/directx/dxm/help/ds/dssd0404.htm#videoDialog">videoDialog</A> function to display the appropriate dialog box.
<p>Asking this method to bring up a VfwCaptureDialog_Format dialog box will return the VFW_E_CANNOT_CONNECT error code if a capture filter is already connected in a graph and the existing graph cannot accept the new format. Capture applications must rebuild the part of the filter graph that is downstream of the capture filter if this error occurs. See the <A HREF="/directx/dxm/help/ds/dssd0368.htm#AMCap">AMCAP</A> sample code for an example of how to do this.

 

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
