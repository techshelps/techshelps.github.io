<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDirectDrawMediaStream Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IDirectDrawMediaStream Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="IDirectDrawMediaStream"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IDirectDrawMediaStream Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IDirectDrawMediaStream Interface"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0375.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0378.htm">IStreamSample Interface</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0380.htm">IDirectDrawStreamSample Interface</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>IDirectDrawMediaStream Interface</H2>
<BR CLEAR=ALL>
<P>The <B>IDirectDrawMediaStream</B> interface controls media streams that appear on Microsoft DirectDraw&#174; surfaces. To stream to a DirectDraw surface, DirectDraw must support the video stream format.

<P>For sample code that implements the multimedia streaming interfaces see <A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0390.htm#mm_code">Multimedia Streaming Sample Code</A>.

<A NAME="When_to_Implement"></A><P><B>When to Implement</B>
<P>This interface isn't intended for implementation by application developers. It is exposed on <A HREF="/directx/dxm/help/ds/dssd0404.htm#DirectDraw">DirectDraw</A> media streams that can be added to a DirectShow multimedia stream.

<A NAME="When_to_Use"></A><P><B>When to Use</B>
<P>Use this interface when you want to output a video stream to a DirectDraw surface.

<A NAME="Methods_in_Vtable_Or"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#AddRef">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#Release">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IDirectDrawMediaStream methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description

</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0379.htm#GetFormat">GetFormat</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the current media stream's format and, optionally, its desired format.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0379.htm#SetFormat">SetFormat</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the current media stream's format. If the stream already has allocated samples and the sample format doesn't match the specified format, this method fails.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0379.htm#GetDirectDraw">GetDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a pointer to the DirectDraw object used by the current media stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0379.htm#SetDirectDraw">SetDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the current media stream's DirectDraw object. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0379.htm#CreateSample">CreateSample</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a stream sample using the specified DirectDraw surface object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0379.htm#GetTimePerFrame">GetTimePerFrame</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the average frames per second from a video stream.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="CreateSample">IDirectDrawMediaStream::CreateSample</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0379.htm">IDirectDrawMediaStream Interface</A>
<P>Creates a stream sample using the specified DirectDraw surface object.
<P><B>HRESULT</B> <B>CreateSample</B><B>(</B><BR>&nbsp;&nbsp;<B>IDirectDrawSurface*</B> <I>pSurface</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>RECT</B> <I>*pRect</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>IDirectDrawStreamSample**</B> <I>ppSample</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pSurface</I>
 </DT><DD>[in] Pointer to an existing DirectDraw surface. 
</DD><DT><I>pRect</I>
 </DT><DD>[in] Pointer to the clipping rectangle you want to use with the specified surface. Set this parameter to NULL if you want to use the entire surface.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flag that specifies whether the render should be progressive. To perform a progressive render, set this value to DDSFF_PROGRESSIVERENDER. If you don't set this flag, sample updates will copy the sample data to the surface.
</DD><DT><I>ppSample</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="/directx/dxm/help/ds/dssd0380.htm">IDirectDrawStreamSample</A> interface that will point to the newly created sample.
</DD></DL>
<H5>Return Values</H5>
<P>Returns one of the following values.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDPIXELFORMAT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The specified pixel format is incompatible with the stream format.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDRECT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The specified clipping rectangle is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDSURFACETYPE
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The specified surface is incompatible with the stream format.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One or more of the required parameters is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_E_SAMPLEALLOC
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The stream already has allocated samples and the surface doesn't match the sample format.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>This method creates a sample from the current stream and attaches the sample to this surface.

<P>If the stream doesn't have an allocated surface and the specified surface doesn't match the stream's format, this method calls the <A HREF="/directx/dxm/help/ds/dssd0379.htm#SetFormat">IDirectDrawMediaStream::SetFormat</A> method on the stream so the two will match.
<P>To perform a progressive render, create a single sample and repeatedly use that sample for successive frames of video. Video decompressors use this technique to do partial updates to the previous frame.



<P>Note, the <I>pRect</I> parameter should match the format of the stream (see <A HREF="/directx/dxm/help/ds/dssd0379.htm#GetFormat">IDirectDrawMediaStream::GetFormat</A>). If the wrong clip rectangle is set or no clip rectangle is set, and the surface size does not match the movie size, the movie may not play. If a primary surface is used it is advisable to use a clipping rectangle because the primary surface size may change if the user changes their display settings.

<H3><HR COLOR="#0000FF"><A NAME="GetDirectDraw">IDirectDrawMediaStream::GetDirectDraw</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0379.htm">IDirectDrawMediaStream Interface</A>
<P>Retrieves a pointer to the DirectDraw object used by the current media stream.
<P><B>HRESULT</B> <B>GetDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>IDirectDraw**</B> <I>ppDirectDraw</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>ppDirectDraw</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface that will contain the current media stream's associated DirectDraw object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if the parameter is invalid.

<H5>Remarks</H5>
<P>If you haven't initialized the stream yet, the retrieved pointer will be NULL and the method will return S_OK. If you have initialized the stream, this method increments the retrieved pointer's reference count.
<H3><HR COLOR="#0000FF"><A NAME="GetFormat">IDirectDrawMediaStream::GetFormat</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0379.htm">IDirectDrawMediaStream Interface</A>
<P>Retrieves the current media stream's format and, optionally, its desired format.
<P><B>HRESULT</B> <B>GetFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>DDSURFACEDESC</B> <I>*pDDSDCurrent</I><B>,</B><BR>&nbsp;&nbsp;<B>IDirectDrawPalette</B> <I>**ppDirectDrawPalette</I><B>,</B><BR>&nbsp;&nbsp;<B>DDSURFACEDESC</B> <I>*pDDSDDesired</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD*</B> <I>pdwFlags</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pDDSDCurrent</I>
 </DT><DD>[out] Pointer to a DirectDraw surface description that will contain the current media stream's format.
</DD><DT><I>ppDirectDrawPalette</I>
 </DT><DD>[out] Address of a pointer to an <B>IDirectDrawPalette</B> interface if one exists.
</DD><DT><I>pDDSDDesired</I>
 </DT><DD>[out] Pointer to a DirectDraw surface description that will contain the current media stream's desired format.
</DD><DT><I>pdwFlags</I>
 </DT><DD>[out] Pointer to the flags set in a <A HREF="/directx/dxm/help/ds/dssd0404.htm#DDSURFACEDESC">DDSURFACEDESC</A> structure. Fields of interest include.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSD_HEIGHT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates that the height member of the structure is valid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSD_WIDTH
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates that the width member of the structure is valid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSD_PIXELFORMAT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates that the pixel format member of the structure is valid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSD_CAPS
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates that the surface capability member of the structure is valid.
</FONT></TD></TR></TABLE>
</DD></DL>
<H5>Return Values</H5>
<P>Returns one of the following values.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDPARAMS
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One of the DirectDraw surface parameters is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One or more of the required parameters is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>After you call this method, you can either conform to the current format or attempt to change the format by calling the <A HREF="/directx/dxm/help/ds/dssd0379.htm#SetFormat">IDirectDrawMediaStream::SetFormat</A> method.
<P>All of this method's parameters are optional; set any of them to NULL to indicate that you don't want to retrieve that information.
<P>To perform a progressive render, create a single sample and repeatedly use that sample for successive frames of video. Video decompressors use this technique to do partial updates to the previous frame.
<P>You must initialize the <B>dwSize</B> member of the <A HREF="/directx/dxm/help/ds/dssd0404.htm#DDSURFACEDESC">DDSURFACEDESC</A> structure before calling this method.

<P>The DDSD_CAPS flag will return one of the values listed in the <A HREF="/directx/dxm/help/ds/dssd0404.htm#DDSCAPS">DDSCAPS</A> structure or DDSCAPS_DATAEXCHANGE, which is defined as DDSCAPS_SYSTEMMEMORY|DDSCAPS_VIDEOMEMORY in Ddrawex.h.
<H3><HR COLOR="#0000FF"><A NAME="GetTimePerFrame">IDirectDrawMediaStream::GetTimePerFrame</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0379.htm">IDirectDrawMediaStream Interface</A>
<P>Retrieves the average frames per second from a video stream.
<P><B>HRESULT</B> <B>GetTimePerFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>STREAM_TIME</B> <I>*pFrameTime</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pFrameTime</I>
 </DT><DD>[out] <A HREF="/directx/dxm/help/ds/dssd0387.htm#STREAM_TIME">STREAM_TIME</A> value that indicates the average time per frame in 100-nanosecond units.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if the pointer is invalid.

<H3><HR COLOR="#0000FF"><A NAME="SetDirectDraw">IDirectDrawMediaStream::SetDirectDraw</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0379.htm">IDirectDrawMediaStream Interface</A>
<P>Sets the current media stream's DirectDraw object.
<P><B>HRESULT</B> <B>SetDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>IDirectDraw*</B> <I>pDirectDraw</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pDirectDraw</I>
 </DT><DD>[in] Address of a pointer to an <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface that contains the media stream's new DirectDraw object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful.

<H5>Remarks</H5>
<P>This method fails if the current stream already has allocated samples and its DirectDraw object differs from the specified one. It will always succeed if the specified DirectDraw object matches the stream's current object.
<P>If this stream has no allocated samples, you can set <I>pDirectDraw</I> to NULL. This forces the stream to release its reference to the current DirectDraw object.
<H3><HR COLOR="#0000FF"><A NAME="SetFormat">IDirectDrawMediaStream::SetFormat</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0379.htm">IDirectDrawMediaStream Interface</A>
<P>Sets the format of the current media stream.
<P><B>HRESULT</B> <B>SetFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>DDSURFACEDESC</B> <I>*pDDSurfaceDesc</I><B>,</B><BR>&nbsp;&nbsp;<B>IDirectDrawPalette</B> <I>*pDirectDrawPalette</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pDDSurfaceDesc</I>
 </DT><DD>[in] Pointer to a DirectDraw surface description that contains the new format.
</DD><DT><I>pDirectDrawPalette</I>
 </DT><DD>[in] Optional parameter that is a pointer to an IDirectDrawPalette interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns one of the following values.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDSURFACETYPE
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The specified format is incompatible with the current stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_E_SAMPLEALLOC
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Can't change the format because one or more stream samples are already allocated for this stream.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P> If the stream already has allocated samples and the sample format doesn't match the specified format, this method fails. This method always succeeds if the specified format matches the current format.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
