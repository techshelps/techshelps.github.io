<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMediaControl Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IMediaControl Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="IMediaControl"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaControl Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaControl Interface"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0091.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0153.htm">IKsPropertySet Interface</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0155.htm">IMediaEvent Interface</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>IMediaControl Interface</H2>
<BR CLEAR=ALL>
<P>The filter graph exposes the <B>IMediaControl</B> interface to allow applications to
control the streaming of media through the filters in the graph. The interface provides methods
for running, pausing, and stopping the streaming of data. It also provides
applications with a simple method of building graphs to play back media files.


<A NAME="When_to_Implement"></A><P><B>When to Implement</B>
<P>This interface is implemented by the filter graph manager. Implement this only if
you are writing a plug-in distributor that needs to export the control methods. The <A HREF="/directx/dxm/help/ds/dssd0234.htm#CMediaControl">CMediaControl</A> base class implements this interface and handles the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> interface.

<A NAME="When_to_Use"></A><P><B>When to Use</B>
<P>Use this interface from any application that wants to control the playing
of media through Microsoft&#174; DirectShow&#153; filter graphs. Applications can also use it to
enumerate the filters in the filter graph and all the filters in the registry,
to add a source filter to the filter graph, and to instruct the filter graph
manager to build a filter graph capable of rendering the media type in a file.

<A NAME="Methods_in_Vtable_Or"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#AddRef">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#Release">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IDispatch methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__GetTypeIn">GetTypeInfoCount</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Determines whether there is type information available for this dispinterface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__GetTypeIn">GetTypeInfo</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the type information for this dispinterface if
 <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__GetTypeIn">GetTypeInfoCount</A> returned
successfully.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__GetIDsOfN">GetIDsOfNames</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Converts text names of properties and methods (including arguments) to
their corresponding DISPIDs.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__Invoke">Invoke</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Calls a method or accesses a property in this dispinterface if given a DISPID
and any other necessary parameters.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IMediaControl methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#Run">Run</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Switches the entire filter graph into running mode.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#Pause">Pause</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Pauses all filters in the filter graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#Stop">Stop</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Switches all filters in the filter graph to a stopped state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#StopWhenReady">StopWhenReady</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Waits for an operation such as Pause to complete,
 allowing filters to queue up data, then
 stops the filter graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">GetState</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the state of the filter graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#RenderFile">RenderFile</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds and connects filters needed to play the specified file.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#AddSourceFilter">AddSourceFilter</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds to the graph the source filter that can read the given file name,
and returns an <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> interface pointer representing the filter object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#get_FilterCollection">get_FilterCollection</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0147.htm">IFilterInfo</A> interfaces representing the
filters in the graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0154.htm#get_RegFilterCollection">get_RegFilterCollection</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0176.htm">IRegFilterInfo</A> interfaces representing the
filters available in the registry.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="AddSourceFilter">IMediaControl::AddSourceFilter</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Adds to the graph the source filter that can read the given file name,
and returns an <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> interface pointer representing the filter.

<P><B>HRESULT</B> <B>AddSourceFilter</B><B>(</B><BR>&nbsp;&nbsp;<B>BSTR</B> <I>strFilename</I><B>,</B><BR>&nbsp;&nbsp;<B>IDispatch</B> <I>**ppUnk</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>strFilename</I>
 </DT><DD>[in] Name of the file containing the source video.
</DD><DT><I>ppUnk</I>
</DT><DD>[out] Pointer to the <A HREF="/directx/dxm/help/ds/dssd0147.htm">IFilterInfo</A> interface on the filter.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method is primarily for use by Automation clients because it returns an
<A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> interface pointer. C and C++ applications should call the
<A HREF="/directx/dxm/help/ds/dssd0151.htm#AddSourceFilter">IGraphBuilder::AddSourceFilter</A> method to perform this operation for maximum
efficiency.
<H3><HR COLOR="#0000FF"><A NAME="get_FilterCollection">IMediaControl::get_FilterCollection</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0147.htm">IFilterInfo</A> interfaces representing the
filters in the graph and returns <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> for an object
that supports the <A HREF="/directx/dxm/help/ds/dssd0096.htm">IAMCollection</A> interface.

<P><B>HRESULT</B> <B>get_FilterCollection</B><B>(</B><BR>&nbsp;&nbsp;<B>IDispatch</B> <I>**ppUnk</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppUnk</I>
 </DT><DD>[out, retval] The <A HREF="/directx/dxm/help/ds/dssd0096.htm">IAMCollection</A> interface on a collection of 
 <A HREF="/directx/dxm/help/ds/dssd0147.htm">IFilterInfo</A> objects.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method is primarily for use by Automation clients because it returns an
<A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> interface pointer. C and C++ applications should call the
<A HREF="/directx/dxm/help/ds/dssd0145.htm#EnumFilters">IFilterGraph::EnumFilters</A> method to perform this operation for maximum
efficiency.
<H3><HR COLOR="#0000FF"><A NAME="get_RegFilterCollection">IMediaControl::get_RegFilterCollection</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0176.htm">IRegFilterInfo</A> interfaces representing the
filters available in the registry.

<P><B>HRESULT</B> <B>get_RegFilterCollection</B><B>(</B><BR>&nbsp;&nbsp;<B>IDispatch</B> <I>**ppUnk</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppUnk</I>
 </DT><DD>[out, retval] <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> interface of the <A HREF="/directx/dxm/help/ds/dssd0096.htm">IAMCollection</A> object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method is primarily for use by Automation clients because it returns an
<A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch">IDispatch</A> interface pointer. C and C++ applications should call the
<A HREF="/directx/dxm/help/ds/dssd0148.htm#EnumMatchingFilters">IFilterMapper::EnumMatchingFilters</A> method to perform this operation for maximum
efficiency.

<H3><HR COLOR="#0000FF"><A NAME="GetState">IMediaControl::GetState</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Retrieves the state of the filter graph.

<P><B>HRESULT</B> <B>GetState</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>msTimeout</I><B>,</B><BR>&nbsp;&nbsp;<B>OAFilterState*</B> <I>pfs</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR>
<H5>Parameters</H5>
<DL><DT><I>msTimeout</I>
 </DT><DD>[in] Duration of the time-out, in milliseconds. 
</DD><DT><I>pfs</I>
 </DT><DD>[out] Holds the returned state of the filter graph.
</DD></DL>
<H5>Return Values</H5>
<P>Returns <A HREF="/directx/dxm/help/ds/dssd0308.htm#VFW_S_STATE_INTERMED">VFW_S_STATE_INTERMEDIATE</A> if the state transition is not complete, or S_OK if it completed successfully. It can also return VFW_S_CANT_CUE if the state is paused, but the source filter does not push data during the paused state (only pushes during the run state). An example of this is a live video capture filter. 

<H5>Remarks</H5>
<P>Not all state transitions are synchronous. For example, even though the <A HREF="/directx/dxm/help/ds/dssd0154.htm#Pause">IMediaControl::Pause</A> method returns immediately, the filter graph typically does not complete the transition into paused mode until data is ready at the renderer. This method will not return S_OK until the state transition has been completed.

<P>If you specify a nonzero time-out, the method waits up to that number of milliseconds for the filter graph to leave the intermediate state. If the time-out expires before the state transition is complete, the return code will be <A HREF="/directx/dxm/help/ds/dssd0308.htm#VFW_S_STATE_INTERMED">VFW_S_STATE_INTERMEDIATE</A>, and the returned state will be the state into which the graph is transitioning (either the <A HREF="/directx/dxm/help/ds/dssd0299.htm#State_Stopped">State_Stopped</A>, <A HREF="/directx/dxm/help/ds/dssd0299.htm#State_Paused">State_Paused</A>, or <A HREF="/directx/dxm/help/ds/dssd0299.htm#State_Running">State_Running</A> members of the <A HREF="/directx/dxm/help/ds/dssd0299.htm#FILTER_STATE">FILTER_STATE</A> structure).

<P>This method will return an error if there is a call on another thread to change the state while this method is blocked.

<P>Avoid specifying a time-out of INFINITE. Threads cannot process messages while waiting in 
<B>GetState</B>. If you call <B>GetState</B> from the thread that processes Windows&#174; messages, specify only small wait times on the call in order to remain responsive to user input. This is most important when streaming data from a source such as the Internet, because state transitions can take significantly
more time to complete.

<P>If you want to pause a filter graph completely before stopping it, call <A HREF="/directx/dxm/help/ds/dssd0154.htm#Pause">IMediaControl::Pause</A>, and then <A HREF="/directx/dxm/help/ds/dssd0154.htm#StopWhenReady">IMediaControl::StopWhenReady</A> (instead of calling <B>GetState</B> with an INFINITE time-out, and then <A HREF="/directx/dxm/help/ds/dssd0154.htm#Stop">IMediaControl::Stop</A>).

<P>Although <I>pfs</I> is declared as a pointer to an OAFilterState value in 
<B>IMediaControl::GetState</B>, DirectShow implements it as a pointer to a <A HREF="/directx/dxm/help/ds/dssd0299.htm#FILTER_STATE">FILTER_STATE</A> value in <A HREF="/directx/dxm/help/ds/dssd0202.htm#GetState">CBaseFilter::GetState</A> and its derivatives. Since both OAFilterState and 
<B>FILTER_STATE</B> resolve to <A HREF="/directx/dxm/help/ds/dssd0404.htm#LONG">LONG</A> values, this does not cause an error.

<H3><HR COLOR="#0000FF"><A NAME="Pause">IMediaControl::Pause</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Pauses all the filters in the filter graph.

<P><B>HRESULT</B> <B>Pause</B><B>(</B> <B>)</B><B>;</B><BR>
<H5>Return Values</H5>
<P>Returns S_OK if the graph is actually paused.
<p>Returns S_FALSE if the graph is in paused state but some filters have not completed the transition to pause. Call <A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">GetState</A> to wait for the transition to the paused state to complete or to check if the transition has completed. If the method returns S_FALSE, subsequent calls to <A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">GetState</A> will return a value of  <A HREF="/directx/dxm/help/ds/dssd0299.htm#State_Paused">State_Paused</A> when the graph is paused. If the transition to the paused state is not complete <A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">GetState</A> can return a return code of VFW_S_STATE_INTERMEDIATE.
<p>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> error code if the graph could not transition to paused state and is now stopped.



<H5>Remarks</H5>
<P>In the paused state, filters process data but do not render it. Data is pushed down the filter
graph and is processed by transform filters as far as buffering permits. No data is rendered (except
that media types capable of being rendered statically, such as video, have a static, poster frame
rendered in paused mode). Therefore, putting a filter graph into a paused state cues the graph
for immediate rendering when put into a running state.
<H3><HR COLOR="#0000FF"><A NAME="RenderFile">IMediaControl::RenderFile</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Adds and connects filters needed to play the specified file.

<P><B>HRESULT</B> <B>RenderFile</B><B>(</B><BR>&nbsp;&nbsp;<B>BSTR</B> <I>strFilename</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>strFilename</I>
 </DT><DD>Name of the file to render.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.


<H5>Remarks</H5>
<P>This method allows an application to pass the name of a media file that it wants rendered
to the filter graph manager. The filter graph manager will build a graph of the
filters needed to play back this file. This method is Automation-compatible and is
equivalent to <A HREF="/directx/dxm/help/ds/dssd0151.htm#RenderFile">IGraphBuilder::RenderFile</A>, which should be used by C and C++ applications.

<H3><HR COLOR="#0000FF"><A NAME="Run">IMediaControl::Run</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Switches the entire filter graph into a running state.

<P><B>HRESULT</B> <B>Run</B><B>(</B> <B>)</B><B>;</B><BR>
<H5>Return Values</H5>
<P>Returns S_OK if the graph is actually running.
<p>Returns S_FALSE if the graph is preparing to run (the graph will run automatically when it's ready). Call <A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">GetState</A> to wait for the transition to the running state to complete or to check if the transition has completed. If the method returns S_FALSE, subsequent calls to <A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">GetState</A> will return a value of <A HREF="/directx/dxm/help/ds/dssd0299.htm#State_Running">State_Running</A> when the graph is actually running. If the transition to the running state is not complete <A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">GetState</A> can return a return code of VFW_S_STATE_INTERMEDIATE.
<p>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> error code if the graph could not run and is now stopped. 



<H5>Remarks</H5>
<P>In a running state, data is pushed down the filter graph and rendered.
The graph remains in a running state until it is stopped by the <A HREF="/directx/dxm/help/ds/dssd0154.htm#Pause">IMediaControl::Pause</A> or <A HREF="/directx/dxm/help/ds/dssd0154.htm#Stop">IMediaControl::Stop</A> method. The graph remains in a running state even after notifying the
application of completion (that is, the <A HREF="/directx/dxm/help/ds/dssd0306.htm#EC_COMPLETE">EC_COMPLETE</A> notification is sent to the application).
This allows the application to determine whether to pause or stop after completion.

<P>If the filter graph is in the stopped state, this method first pauses the graph before running.

<P>If an error value is returned, some filters within the graph might have successfully entered
the running state. In a multistream graph, entire streams might be playing successfully.
The application must determine whether to stop running or not.
<H3><HR COLOR="#0000FF"><A NAME="Stop">IMediaControl::Stop</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Switches all filters in the filter graph to a stopped state.

<P><B>HRESULT</B> <B>Stop</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.


<H5>Remarks</H5>
<P>In this mode, filters release resources and no data is processed.
If the filters are in a running state, this method pauses them before stopping them. This allows
video renderers to make a copy of the current frame for poster frame display while stopped.
<H3><HR COLOR="#0000FF"><A NAME="StopWhenReady">IMediaControl::StopWhenReady</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0154.htm">IMediaControl Interface</A>
<P>Waits for an operation such as Pause to complete, allowing filters to queue up data, then
stops the filter graph.

<P><B>HRESULT</B> <B>StopWhenReady</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.


<H5>Remarks</H5>
<P>Changing the current position when stopped will not normally repaint the
video window with the new position. Applications will need to enter Pause mode to do this.
Calling <B>StopWhenReady</B> instead of simply calling <A HREF="/directx/dxm/help/ds/dssd0154.htm#Stop">Stop</A> 
after this pause ensures that the graph is fully paused, and that data has arrived at the video 
renderer and has been displayed before the graph is stopped.

<P>This method is run asynchronously so that the application regains control immediately and can
respond to user input. Use this method rather than calling <A HREF="/directx/dxm/help/ds/dssd0154.htm#GetState">IMediaControl::GetState</A> with an INFINITE time-out, 
followed by <A HREF="/directx/dxm/help/ds/dssd0154.htm#Stop">IMediaControl::Stop</A>.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
