<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CCmdQueue Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="CCmdQueue Class">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="CCmdQueue"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CCmdQueue Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CCmdQueue Class"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0188.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0216.htm">CBasicAudio Class</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0218.htm">CCritSec Class</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>CCmdQueue Class</H2>
<BR CLEAR=ALL>
<P><IMG SRC="/directx/dxm/help/ds/art/cutil12.gif" WIDTH="0" HEIGHT="0" ALT="CCmdQueue class hierarchy">

<P>The <B>CCmdQueue</B> class is a base class that provides a queue of <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A>
objects and member functions to add, remove, check status, and invoke the queued
commands. A <B>CCmdQueue</B> object is a part of an object that
implements <A HREF="/directx/dxm/help/ds/dssd0174.htm">IQueueCommand</A> methods. The filter graph manager implements
<B>IQueueCommand</B> methods so that applications can queue commands to the filter graph.
Filters that implement the <B>IQueueCommand</B> interface directly use this class. 
If you want to use <B>CDeferredCommand</B> objects, your queue must be derived from this class.




<P>There are two modes of synchronization: coarse and accurate. In
coarse mode, the application waits until a specified time arrives and then executes the command.
In accurate mode, the application waits until processing begins on the sample that
appears at the time, and then executes the command. The filter determines which one 
it will implement. The filter graph manager always implements coarse mode for commands 
that are queued at the filter graph manager.

<P>If you want coarse synchronization, you probably want to wait until there is a
command due, and then execute it. You can do this by calling
<A HREF="/directx/dxm/help/ds/dssd0217.htm#GetDueCommand">CCmdQueue::GetDueCommand</A>. If you have several things to wait for, get the
event handle from <A HREF="/directx/dxm/help/ds/dssd0217.htm#GetDueHandle">CCmdQueue::GetDueHandle</A> and then call
<B>CCmdQueue::GetDueCommand</B> when this is signaled.
Stream time will advance only between calls to the <A HREF="/directx/dxm/help/ds/dssd0217.htm#Run">CCmdQueue::Run</A> and
<A HREF="/directx/dxm/help/ds/dssd0217.htm#EndRun">CCmdQueue::EndRun</A> member functions. There is no guarantee that
if the handle is set, there will be a command ready. Each time the
event is signaled, call the <B>CCmdQueue::GetDueCommand</B> member function 
(probably with a time-out of zero); this may
 
return E_ABORT.

<P>If you want accurate synchronization, call the <A HREF="/directx/dxm/help/ds/dssd0217.htm#getCommandDueFor">CCmdQueue::GetCommandDueFor</A> 
member function and pass the samples you are about to process as a parameter. This returns the 
following:

<UL><LI>A stream-time command due at or before that stream time.
<LI>A presentation-time command due at or before the presentation of the stream time.
Do this only between the <A HREF="/directx/dxm/help/ds/dssd0217.htm#Run">CCmdQueue::Run</A> and <A HREF="/directx/dxm/help/ds/dssd0217.htm#EndRun">CCmdQueue::EndRun</A> member
functions, because outside of this, the mapping from stream time to presentation
time is not known.
<LI>Any presentation-time command due now.
</UL>
<P>If you want accurate synchronization for samples that
might be processed during paused mode, you must use
stream-time commands.

<P>In all cases, commands remain queued until called or canceled. The 
setting and resetting of the event handle is managed entirely by this 
queue object.

<A NAME="Protected_Data_Membe"></A><P><B>Protected Data Members</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_bRunning">m_bRunning</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Flag for running state; set TRUE when running.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_dwAdvise">m_dwAdvise</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Advise identifier from the reference clock (zero if no outstanding advise).
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_evDue">m_evDue</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the time when any commands are due.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_listPresentation">m_listPresentation</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Stores commands queued in presentation time.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_listStream">m_listStream</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Stores commands queued in stream time.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_Lock">m_Lock</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Protects access to lists.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_pClock">m_pClock</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Current reference clock.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_StreamTimeOffset">m_StreamTimeOffset</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Contains the stream time offset when <A HREF="/directx/dxm/help/ds/dssd0217.htm#m_bRunning">m_bRunning</A> is true.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_tCurrentAdvise">m_tCurrentAdvise</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Advise time is for this presentation time.
</FONT></TD></TR></TABLE>
<A NAME="Member_Functions"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#+">CCmdQueue</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#CheckTime">CheckTime</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Determines if a given time is due.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#GetDueHandle">GetDueHandle</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the event handle that will be signaled.
</FONT></TD></TR></TABLE>
<A NAME="Overridable_Member_F"></A><P><B>Overridable Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#EndRun">EndRun</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Switches to stopped or paused mode.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#getCommandDueFor">GetCommandDueFor</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns a pointer to a command that will be due for a given time.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#GetDueCommand">GetDueCommand</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns a pointer to the next command that is due.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#Insert">Insert</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds the <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object to the queue.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#New">New</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Initializes a command to be run and returns a new <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#Remove">Remove</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Removes the <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object from the queue.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#Run">Run</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Switches to running mode.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#SetSyncSource">SetSyncSource</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the clock used for timing.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0217.htm#SetTimeAdvise">SetTimeAdvise</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates an advise for the earliest time required.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="+">CCmdQueue::CCmdQueue</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Constructs a <A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue</A> object.

<P><B>CCmdQueue</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>No return value.
<H3><HR COLOR="#0000FF"><A NAME="CheckTime">CCmdQueue::CheckTime</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Determines if a specified time is due.

<P><B>BOOL</B> <B>CheckTime</B><B>(</B><BR>&nbsp;&nbsp;<B>CRefTime</B> <I>time</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>time</I>
 </DT><DD>Time to check.
</DD><DT><I>bStream</I>
 </DT><DD>TRUE if the <I>time</I> parameter is a stream-time value; FALSE if <I>time</I> is a 
presentation-time value.
</DD></DL>
<H5>Return Values</H5>
<P>Returns TRUE if the specified time has not yet passed.

<H3><HR COLOR="#0000FF"><A NAME="EndRun">CCmdQueue::EndRun</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Switches to the stopped or paused mode.

<P><B>virtual</B> <B>HRESULT</B> <B>EndRun</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation. The <B>HRESULT</B> indicates the error and can be one of the following standard constants, or other values not listed:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_FAIL </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Failure.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Null pointer argument.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_INVALIDARG </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Invalid argument.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK or NOERROR </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>Time mapping between stream time and presentation time is not known after this 
member function has been called. Call the <A HREF="/directx/dxm/help/ds/dssd0217.htm#Run">CCmdQueue::Run</A> member function to 
carry out this mapping.
<H3><HR COLOR="#0000FF"><A NAME="getCommandDueFor">CCmdQueue::GetCommandDueFor</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Returns a deferred command that is scheduled at a specified time.

<P><B>virtual</B> <B>HRESULT</B> <B>GetCommandDueFor</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStream</I><B>,</B><BR>&nbsp;&nbsp;<B>CDeferredCommand</B> <I>**ppCmd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>tStream</I>
</DT><DD>Time for which the command is scheduled.
</DD><DT><I>ppCmd</I>
</DT><DD>Deferred command to be carried out at the time specified in the <I>tStream</I> parameter.
</DD></DL>
<H5>Return Values</H5>
<P>Returns <A HREF="/directx/dxm/help/ds/dssd0308.htm#VFW_E_NOT_FOUND">VFW_E_NOT_FOUND</A> if no commands are due; otherwise, returns S_OK.


<H5>Remarks</H5>
<P>This member function takes a stream time and returns the deferred
command scheduled at that time. The actual stream-time offset
is calculated when the command queue is run. Commands remain queued
until run or canceled. This member function will not block.
<H3><HR COLOR="#0000FF"><A NAME="GetDueCommand">CCmdQueue::GetDueCommand</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Returns a pointer to the next command that is due.

<P><B>virtual</B> <B>HRESULT</B> <B>GetDueCommand</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand</B> <B>**</B> <I>ppCmd</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>msTimeout</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppCmd</I>
</DT><DD>Pointer to the deferred command.
</DD><DT><I>msTimeout</I>
</DT><DD>Amount of time to wait before carrying out the time-out.
</DD></DL>
<H5>Return Values</H5>
<P>Returns E_ABORT if a time-out occurs. Returns S_OK if successful; otherwise,
returns an error.
Returns an object that has been incremented using <A HREF="/directx/dxm/help/ds/dssd0181.htm#AddRef">IUnknown::AddRef</A>.


<H5>Remarks</H5>
<P>This member function blocks until a pending command is due. The member function 
blocks for the amount of time, in milliseconds, specified in the <I>msTimeout</I> parameter.
Stream-time commands become due only between the <A HREF="/directx/dxm/help/ds/dssd0217.htm#Run">CCmdQueue::Run</A> and
<A HREF="/directx/dxm/help/ds/dssd0217.htm#EndRun">CCmdQueue::EndRun</A> member functions. The command remains queued until 
run or canceled.
<H3><HR COLOR="#0000FF"><A NAME="GetDueHandle">CCmdQueue::GetDueHandle</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Returns the event handle to be signaled.

<P><B>HANDLE</B> <B>GetDueHandle</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the event handle.


<H5>Remarks</H5>
<P>Return the event handle whenever there are deferred commands that are due for execution
(when <A HREF="/directx/dxm/help/ds/dssd0217.htm#GetDueCommand">CCmdQueue::GetDueCommand</A> will not block).
<H3><HR COLOR="#0000FF"><A NAME="Insert">CCmdQueue::Insert</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>The <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object calls this member function to add itself
to the queue.

<P><B>virtual</B> <B>HRESULT</B> <B>Insert</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand*</B> <I>pCmd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pCmd</I>
 </DT><DD>Pointer to the <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object to add to the queue.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK in the default implementation.


<H3><HR COLOR="#0000FF"><A NAME="New">CCmdQueue::New</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Initializes a command to be run and returns a new <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object.

<P><B>virtual</B> <B>HRESULT</B> <B>New</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand</B> <I>**ppCmd</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>time</I><B>,</B><BR>&nbsp;&nbsp;<B>GUID*</B> <I>iid</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dispidMethod</I><B>,</B><BR>&nbsp;&nbsp;<B>short</B> <I>wFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>cArgs</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT*</B> <I>pDispParams</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT*</B> <I>pvarResult</I><B>,</B><BR>&nbsp;&nbsp;<B>short*</B> <I>puArgErr</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppCmd</I>
 </DT><DD><A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object by which an application can cancel the command, 
set a new presentation time for it, or retrieve estimate information.
</DD><DT><I>pUnk</I>
 </DT><DD>Pointer to the object that will run the command. 
</DD><DT><I>time</I>
 </DT><DD>Time at which to run the queued command or commands.
</DD><DT><I>iid</I>
 </DT><DD>Globally unique identifier (<A HREF="/directx/dxm/help/ds/dssd0412.htm#GUID">GUID</A>) of the interface to call.
</DD><DT><I>dispidMethod</I>
 </DT><DD>Method on the interface to be called.
</DD><DT><I>wFlags</I>
 </DT><DD>Flags describing the context of the call. This parameter supports the same flags as the 
OLE <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__Invoke">IDispatch::Invoke</A> method.
</DD><DT><I>cArgs</I>
 </DT><DD>Number of arguments passed. 
</DD><DT><I>pDispParams</I>
 </DT><DD>Pointer to the list of variant types associated with the dispatch parameters.
</DD><DT><I>pvarResult</I>
 </DT><DD>Pointer to the list where results, if any, are to be returned. 
</DD><DT><I>puArgErr</I>
 </DT><DD>Index within the <I>pDispParams</I> parameter list where the last error occurred.
</DD><DT><I>bStream</I>
 </DT><DD>TRUE if the <I>time</I> parameter is a stream-time value; FALSE if <I>time</I> is 
a presentation-time value.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful. Returns E_OUTOFMEMORY if <I>ppCmd</I> returns from creating the new <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object with a value of NULL. Otherwise, returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> that indicates an error from attempting to create a new <B>CDeferredCommand</B> object. If there is an error, no object has been queued.

<H5>Remarks</H5>
<P>The new <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object will be initialized with
the parameters and will be added to the queue during construction. This method is similar to the 
OLE <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__Invoke">IDispatch::Invoke</A> method.

<P>Values for the <I>wFlags</I> parameter include the following:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_METHOD
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The member is being run as a method. If a property has the
same name, both this and the DISPATCH_PROPERTYGET flag may
 
be set.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_PROPERTYGET
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The member is being retrieved as a property or data member.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_PROPERTYPUT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The member is being changed as a property or data member.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_PROPERTYPUTREF
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The member is being changed via a reference assignment, rather than a value assignment. 
This value is valid only when the property accepts a reference to an object.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="Remove">CCmdQueue::Remove</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>The <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object calls this member function to remove itself
from the queue.

<P><B>virtual</B> <B>HRESULT</B> <B>Remove</B><B>(</B><BR>&nbsp;&nbsp;<B>CDeferredCommand*</B> <I>pCmd</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pCmd</I>
 </DT><DD>Pointer to the <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object to remove from the queue.
</DD></DL>
<H5>Return Values</H5>
<P>Returns VFW_E_NOT_FOUND if the object is not found in the queue. Otherwise, returns S_OK.


<H3><HR COLOR="#0000FF"><A NAME="Run">CCmdQueue::Run</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Switches to running mode so that commands that are deferred by the stream time can be run.

<P><B>virtual</B> <B>HRESULT</B> <B>Run</B><B>(</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>tStreamTimeOffset</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>tStreamTimeOffset</I>
</DT><DD>Offset time.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK in the default implementation.


<H5>Remarks</H5>
<P>During running mode, stream-time-to-presentation-time mapping is known.
<H3><HR COLOR="#0000FF"><A NAME="SetSyncSource">CCmdQueue::SetSyncSource</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Sets the clock used for timing.

<P><B>virtual</B> <B>HRESULT</B> <B>SetSyncSource</B><B>(</B><BR>&nbsp;&nbsp;<B>IReferenceClock*</B> <I>pIrc</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pIrc</I>
</DT><DD>Pointer to the <A HREF="/directx/dxm/help/ds/dssd0175.htm">IReferenceClock</A> interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK in the default implementation.


<H3><HR COLOR="#0000FF"><A NAME="SetTimeAdvise">CCmdQueue::SetTimeAdvise</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue Class</A>
<P>Sets up a timer event with the reference clock.

<P><B>void</B> <B>SetTimeAdvise</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>This member function calls the <A HREF="/directx/dxm/help/ds/dssd0175.htm#AdviseTime">IReferenceClock::AdviseTime</A>
method to set up a notification for the earliest time required in the
queue. Presentation-time commands that are deferred are always checked. If the
filter graph is in running mode, deferred commands using stream time are
also checked.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
