<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDeferredCommand Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="CDeferredCommand Class">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="CDeferredCommand"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CDeferredCommand Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CDeferredCommand Class"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0188.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0218.htm">CCritSec Class</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0220.htm">CDisp Class</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>CDeferredCommand Class</H2>
<BR CLEAR=ALL>
<P><IMG SRC="/directx/dxm/help/ds/art/cutil13.gif" WIDTH="259" HEIGHT="143" ALT="CDeferredCommand class hierarchy">

<P>Deferred commands are queued by calls to methods on the <A HREF="/directx/dxm/help/ds/dssd0174.htm">IQueueCommand</A>
interface and are exposed by the filter graph manager and by some filters. A successful
call to one of these methods returns an <A HREF="/directx/dxm/help/ds/dssd0130.htm">IDeferredCommand</A> interface
representing the queued command.

<P>A <B>CDeferredCommand</B> object represents a single deferred command and exposes
the <A HREF="/directx/dxm/help/ds/dssd0130.htm">IDeferredCommand</A> interface as well as other methods that permit time
checks and actual execution. A <B>CDeferredCommand</B> object contains a reference to the
<A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue</A> object on which it is queued.

<P>Reference counts control the lifetime of the <B>CDeferredCommand</B> class. When
calling the <A HREF="/directx/dxm/help/ds/dssd0219.htm#Invoke">CDeferredCommand::Invoke</A> member function, the calling application
gets an interface pointer that is reference-counted, and the <A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue</A> object also
holds a reference count on the deferred command. Calling the <A HREF="/directx/dxm/help/ds/dssd0130.htm#Cancel">IDeferredCommand::Cancel</A>
member function takes the deferred command off the command queue and thus reduces the
reference count by one. Once taken off the queue, the command cannot be put back on the queue.

<A NAME="Protected_Data_Membe"></A><P><B>Protected Data Members</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_bStream">m_bStream</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Flag for stream time or presentation time.
to be passed to the invoked method.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_Dispatch">m_Dispatch</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Accesses the <A HREF="/directx/dxm/help/ds/dssd0404.htm#ITypeInfo">ITypeInfo</A> interface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_dispidMethod">m_dispidMethod</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Method on the interface to run.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_DispParams">m_DispParams</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0222.htm">CDispParams</A> object containing the <A HREF="/directx/dxm/help/ds/dssd0404.htm#DISPPARAMS">DISPPARAMS</A> parameter list 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_hrResult">m_hrResult</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Stores the returned <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_iid">m_iid</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Globally unique identifier (<A HREF="/directx/dxm/help/ds/dssd0412.htm#GUID">GUID</A>) of the interface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_pQueue">m_pQueue</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Pointer to the <A HREF="/directx/dxm/help/ds/dssd0217.htm">CCmdQueue</A> object that exposes the <A HREF="/directx/dxm/help/ds/dssd0174.htm">IQueueCommand</A> interface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_pUnk">m_pUnk</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A> pointer to the interface on which the command will be run.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_pvarResult">m_pvarResult</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Resulting information, if any, from the invoked method.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_time">m_time</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Time at which the command will be run.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="m_wFlags">m_wFlags</A></B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Flags specifying the context of the invocation.
</FONT></TD></TR></TABLE>
<A NAME="Member_Functions"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#+">CDeferredCommand</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#GetFlags">GetFlags</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the context flags associated with the deferred command.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#GetIID">GetIID</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the interface identifier (IID) of the interface on which the method will be run.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#GetMethod">GetMethod</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the dispatch identifier of the method to be run.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#GetParams">GetParams</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the <A HREF="/directx/dxm/help/ds/dssd0404.htm#DISPPARAMS">DISPPARAMS</A> argument list to the method.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#GetResult">GetResult</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the resulting argument list, if one exists.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#GetTime">GetTime</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the time when the method will be run.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#Invoke">Invoke</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Provides access to methods and properties exposed by an object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#IsStreamTime">IsStreamTime</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifies whether the command is to be run at stream time or presentation time.
</FONT></TD></TR></TABLE>
<A NAME="Implemented_IDeferre"></A><P><B>Implemented IDeferredCommand Methods</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#Cancel">Cancel</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Cancels a previously queued <A HREF="/directx/dxm/help/ds/dssd0219.htm#Invoke">CDeferredCommand::Invoke</A> request.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#Confidence">Confidence</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Not currently implemented.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#Postpone">Postpone</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifies a new presentation time for a previously queued command.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#GetHResult">GetHResult</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns the <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value of the invoked method.
</FONT></TD></TR></TABLE>
<A NAME="Implemented_INonDele"></A><P><B>Implemented INonDelegatingUnknown Methods</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0219.htm#NonDelegatingQueryInterface">NonDelegatingQueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns a specified reference-counted interface.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="Cancel">CDeferredCommand::Cancel</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Cancels a previously queued <A HREF="/directx/dxm/help/ds/dssd0219.htm#Invoke">CDeferredCommand::Invoke</A> request.

<P><B>HRESULT</B> <B>Cancel</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns VFW_E_ALREADY_CANCELLED if <A HREF="/directx/dxm/help/ds/dssd0219.htm#m_pQueue">m_pQueue</A> is NULL. Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> from <A HREF="/directx/dxm/help/ds/dssd0217.htm#Remove">CCmdQueue::Remove</A> if the call generates an error. Returns S_OK if successful.


<H5>Remarks</H5>
<P>This member function implements the <A HREF="/directx/dxm/help/ds/dssd0130.htm#Cancel">IDeferredCommand::Cancel</A> method.
<H3><HR COLOR="#0000FF"><A NAME="+">CDeferredCommand::CDeferredCommand</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Constructs a <A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand</A> object.

<P><B>CDeferredCommand</B><B>(</B><BR>&nbsp;&nbsp;<B>CCmdQueue</B> <B>*</B> <I>pQ</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnk</I><B>,</B><BR>&nbsp;&nbsp;<B>HRESULT</B> <B>*</B> <I>phr</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>pUnkExecutor</I><B>,</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>time</I><B>,</B><BR>&nbsp;&nbsp;<B>GUID*</B> <I>iid</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>dispidMethod</I><B>,</B><BR>&nbsp;&nbsp;<B>short</B> <I>wFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>cArgs</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT*</B> <I>pDispParams</I><B>,</B><BR>&nbsp;&nbsp;<B>VARIANT*</B> <I>pvarResult</I><B>,</B><BR>&nbsp;&nbsp;<B>short*</B> <I>puArgErr</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pQ</I>
 </DT><DD>Object that exposes the <A HREF="/directx/dxm/help/ds/dssd0174.htm">IQueueCommand</A> interface.
</DD><DT><I>pUnk</I>
 </DT><DD>Outer <A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A> interface for aggregation.
</DD><DT><I>phr</I>
 </DT><DD>Returning <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.
</DD><DT><I>pUnkExecutor</I>
 </DT><DD>Object that will carry out this command.
</DD><DT><I>time</I>
 </DT><DD>Time at which the command will be run.
</DD><DT><I>iid</I>
 </DT><DD>Globally unique identifier (<A HREF="/directx/dxm/help/ds/dssd0412.htm#GUID">GUID</A>) of the interface that contains the method.
</DD><DT><I>dispidMethod</I>
 </DT><DD>Method on the interface to call.
</DD><DT><I>wFlags</I>
 </DT><DD>Context of the invocation.
</DD><DT><I>cArgs</I>
 </DT><DD>Number of arguments passed.
</DD><DT><I>pDispParams</I>
 </DT><DD>List of argument variant types.
</DD><DT><I>pvarResult</I>
 </DT><DD>Returned variant type list, if any.
</DD><DT><I>puArgErr</I>
 </DT><DD>Last argument in the <I>pDispParams</I> parameter list with an error.
</DD><DT><I>bStream</I>
 </DT><DD>TRUE if the deferred command time is in stream time; FALSE if in presentation time.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.
<H3><HR COLOR="#0000FF"><A NAME="Confidence">CDeferredCommand::Confidence</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>This method is not currently implemented.

<P><B>HRESULT</B> <B>Confidence</B><B>(</B><BR>&nbsp;&nbsp;<B>LONG</B> <I>*pConfidence</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pConfidence</I>
 </DT><DD>Confidence level.
</DD></DL>
<H5>Return Values</H5>
<P>Returns E_NOTIMPL.


<H5>Remarks</H5>
<P>See <A HREF="/directx/dxm/help/ds/dssd0130.htm#Confidence">IDeferredCommand::Confidence</A> for information about implementing this method.
<H3><HR COLOR="#0000FF"><A NAME="GetFlags">CDeferredCommand::GetFlags</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Returns the context flags associated with the deferred command.

<P><B>short</B> <B>GetFlags</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>The value retrieved will be one of the following.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_METHOD
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Run the member as a method. If a property has the same name,
both this and the DISPATCH_PROPERTYGET flag may
 
be set.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_PROPERTYGET
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The member is being retrieved as a property or data member.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_PROPERTYPUT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The member is being changed as a property or data member.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DISPATCH_PROPERTYPUTREF
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The member is being changed via a reference assignment,
rather than a value assignment. This flag is valid only when the property accepts 
a reference to an object.
</FONT></TD></TR></TABLE>

<H3><HR COLOR="#0000FF"><A NAME="GetHResult">CDeferredCommand::GetHResult</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Returns the <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value from the invoked command.

<P><B>HRESULT</B> <B>GetHResult</B><B>(</B><BR>&nbsp;&nbsp;<B>HRESULT*</B> <I>phrResult</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>phrResult</I>
 </DT><DD>HRESULT value.
</DD></DL>
<H5>Return Values</H5>
<P>Returns E_ABORT if <A HREF="/directx/dxm/help/ds/dssd0219.htm#m_pQueue">m_pQueue</A> is NULL. Otherwise, returns S_OK.


<H5>Remarks</H5>
<P>This member function implements the <A HREF="/directx/dxm/help/ds/dssd0130.htm#GetHResult">IDeferredCommand::GetHResult</A> method.
<H3><HR COLOR="#0000FF"><A NAME="GetIID">CDeferredCommand::GetIID</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Retrieves the interface identifier (IID) of the interface on which the
method will be run.


<P><B>REFIID</B> <B>GetIID</B><B>(</B> <B>)</B><B>;</B><BR><H3><HR COLOR="#0000FF"><A NAME="GetMethod">CDeferredCommand::GetMethod</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Retrieves the dispatch identifier of the method to be run.


<P><B>long</B> <B>GetMethod</B><B>(</B> <B>)</B><B>;</B><BR><H3><HR COLOR="#0000FF"><A NAME="GetParams">CDeferredCommand::GetParams</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Retrieves the <A HREF="/directx/dxm/help/ds/dssd0404.htm#DISPPARAMS">DISPPARAMS</A> argument list to the method.


<P><B>DISPPARAMS*</B> <B>GetParams</B><B>(</B> <B>)</B><B>;</B><BR><H3><HR COLOR="#0000FF"><A NAME="GetResult">CDeferredCommand::GetResult</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Retrieves the resulting argument list, if one exists.


<P><B>VARIANT*</B> <B>GetResult</B><B>(</B> <B>)</B><B>;</B><BR><H3><HR COLOR="#0000FF"><A NAME="GetTime">CDeferredCommand::GetTime</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Returns the time at which the method will be run.

<P><B>CRefTime</B> <B>GetTime</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns a <A HREF="/directx/dxm/help/ds/dssd0248.htm">CRefTime</A> object containing a reference time.


<H3><HR COLOR="#0000FF"><A NAME="Invoke">CDeferredCommand::Invoke</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Provides access to methods and properties exposed by an object.

<P><B>HRESULT</B> <B>Invoke</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns VFW_E_ALREADY_CANCELLED if <A HREF="/directx/dxm/help/ds/dssd0219.htm#m_pQueue">m_pQueue</A> is NULL. Otherwise, returns the <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> resulting from a call to <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDispatch__GetTypeIn">IDispatch::GetTypeInfo</A> or <A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">IUnknown::QueryInterface</A>.


<H3><HR COLOR="#0000FF"><A NAME="IsStreamTime">CDeferredCommand::IsStreamTime</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Specifies whether the command is to be run at stream time or presentation time.

<P><B>BOOL</B> <B>IsStreamTime</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns TRUE if set to stream time; otherwise, returns FALSE.


<H3><HR COLOR="#0000FF"><A NAME="NonDelegatingQueryInterface">CDeferredCommand::NonDelegatingQueryInterface</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Returns a specified reference-counted interface.

<P><B>HRESULT</B> <B>NonDelegatingQueryInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <I>**ppv</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>riid</I>
 </DT><DD>Reference identifier.
</DD><DT><I>ppv</I>
 </DT><DD>Pointer to the interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns E_POINTER if <I>ppv</I> is invalid. Returns NOERROR if the query is successful or E_NOINTERFACE if it is not. 

<H5>Remarks</H5>
<P>Returns pointers to the <A HREF="/directx/dxm/help/ds/dssd0130.htm">IDeferredCommand</A> and <A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A> interfaces by default. Override this method to publish any additional interfaces implemented by the derived class.

<P>This member function implements the 
<A HREF="/directx/dxm/help/ds/dssd0276.htm#INonDelegatingUnknow">INonDelegatingUnknown::NonDelegatingQueryInterface</A> method.
<H3><HR COLOR="#0000FF"><A NAME="Postpone">CDeferredCommand::Postpone</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0219.htm">CDeferredCommand Class</A>
<P>Specifies a new presentation time for a previously queued command.

<P><B>HRESULT</B> <B>Postpone</B><B>(</B><BR>&nbsp;&nbsp;<B>REFTIME</B> <I>newtime</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>newtime</I>
 </DT><DD>New presentation time.
</DD></DL>
<H5>Return Values</H5>
<P>Returns VFW_E_TIME_ALREADY_PASSED if <I>newtime</I> is already passed. Otherwise, returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> resulting from a call to <A HREF="/directx/dxm/help/ds/dssd0217.htm#Remove">CCmdQueue::Remove</A> (when extracting from the list) or <A HREF="/directx/dxm/help/ds/dssd0217.htm#Insert">CCmdQueue::Insert</A> (when reinserting with the changed time).

<H5>Remarks</H5>
<P>This member function implements the <A HREF="/directx/dxm/help/ds/dssd0130.htm#Postpone">IDeferredCommand::Postpone</A> method.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
