<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMediaControl Object</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IMediaControl Object">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="IMediaControl_Object"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaControl Object"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IMediaControl Object"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0017.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0021.htm">IFilterInfo Object</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0023.htm">IMediaEvent Object</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>IMediaControl Object</H2>
<BR CLEAR=ALL>
<P>The filter graph exposes the <A HREF="/directx/dxm/help/ds/dssd0154.htm#IMediaControl">IMediaControl</A> object to allow applications to 
control the streaming of media through the filters in the graph. The interface provides methods 
for running, pausing, and stopping the streaming of data. It also provides 
applications with a simple method that builds graphs to play back media files. 
 
<A NAME="Properties"></A><P><B>Properties</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_FilterCollection">FilterCollection</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0021.htm">IFilterInfo</A> objects representing the 
current filters in the graph. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_RegFilterCollection">RegFilterCollection</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0027.htm">IRegFilterInfo</A> objects representing the 
filters available in the registry. 
</FONT></TD></TR></TABLE>
<A NAME="Methods"></A><P><B>Methods</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_AddSourceFilter">AddSourceFilter</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds to the graph the source filter that can read the given file name. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_GetState">GetState</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the state of the filter graph. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_Pause">Pause</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Pauses all filters in the filter graph. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_RenderFile">RenderFile</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds and connects all filters needed to play the specified file. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_Run">Run</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Switches the entire filter graph into run mode. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_Stop">Stop</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Switches all filters in the filter graph to a stopped state. 
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_AddSourceFilter">AddSourceFilter Method (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Adds the source filter that can read the given file name to the graph 
and returns the created <A HREF="/directx/dxm/help/ds/dssd0021.htm">IFilterInfo</A> object. 
 
<P><I>objMediaControl</I><B>.AddSourceFilter</B> <I>string</I><B>,</B> <I>objFilterInfo</I> <BR>
<H5>Parts</H5>
<DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
</DD><DT><I>string</I> 
 </DT><DD>Name of the file containing the source media. 
</DD><DT><I>objFilterInfo</I> 
 </DT><DD><A HREF="/directx/dxm/help/ds/dssd0021.htm">IFilterInfo</A> object; the source filter created for the specified source file. 
</DD></DL>
<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_FilterCollection">FilterCollection Property (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0021.htm">IFilterInfo</A> objects representing the 
filters in the graph. Returns an <A HREF="/directx/dxm/help/ds/dssd0018.htm">IAMCollection</A> object. 
 
<P><B>Set</B> <I>objCollection</I> <B>=</B> <I>objMediaControl</I><B>.FilterCollection<BR>
</B><H5>Parts</H5>
<DL><DT><I>objCollection</I> 
 </DT><DD><A HREF="/directx/dxm/help/ds/dssd0018.htm">IAMCollection</A> object that represents the collection of filters currently present in the filter graph. 
</DD><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
 
</DD></DL>
<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_GetState">GetState Method (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Returns a <A HREF="/directx/dxm/help/ds/dssd0404.htm#Long">Long</A> integer indicating the current state value.
 
<P><I>objMediaControl</I><B>.GetState</B> <I>msTimeout</I><B>,</B> <I>State</I><BR>
<H5>Parts</H5>
<DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
</DD><DT><I>msTimeout</I> 
 </DT><DD>Duration of the time-out, in milliseconds.
</DD><DT><I>State</I>
 </DT><DD><A HREF="/directx/dxm/help/ds/dssd0404.htm#Long">Long</A> value that will contain the current state. This argument will be one of the following:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value</B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">State_Paused
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The media source is paused.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">State_Running
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The media source is running.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">State_Stopped
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The media source is stopped.
</FONT></TD></TR></TABLE>
</DD></DL>
<H5>Return Values</H5>
<P>Returns run-time error 567 if the state transition is not complete, or 0 if it completed successfully.

<H5>Remarks</H5>
<P>Not all state transitions are synchronous. For example, even though the <A HREF="/directx/dxm/help/ds/dssd0022.htm#IMediaControl_Pause">Pause</A> method returns immediately, the graph typically does not complete the transition into paused mode until data is ready at the renderer. This method will not return zero until the state transition has been completed.

<P>If you specify a nonzero time-out, the method waits up to that number of milliseconds for the graph to leave the intermediate state. If the time-out expires before the state transition is complete, the return code will be 567, and the returned state will be the state into which the graph is transitioning (either State_Stopped, State_Paused, or State_Running).


<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_RegFilterCollection">RegFilterCollection Property (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Retrieves a collection of <A HREF="/directx/dxm/help/ds/dssd0027.htm">IRegFilterInfo</A> objects representing the 
filters available in the registry. 
 
<P><B>Set</B> <I>objCollection</I> <B>=</B> <I>objMediaControl</I><B>.RegFilterCollection<BR>
</B><H5>Parts</H5>
<DL><DT><I>objCollection</I> 
 </DT><DD><A HREF="/directx/dxm/help/ds/dssd0018.htm">IAMCollection</A> object that contains <A HREF="/directx/dxm/help/ds/dssd0027.htm">IRegFilterInfo</A> objects. 
</DD><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an <A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0018.htm">IAMCollection</A> object.
 
 
 

<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_Pause">Pause Method (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Pauses all the filters in the filter graph. 
 
<P><I>objMediaControl</I><B>.Pause</B> <BR>
<H5>Parts</H5>
<DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
</DD></DL>
<H5>Remarks</H5>
<P>In the paused state, filters process data but do not render it. Data is pushed down the filter 
graph and is processed by transform filters as far as buffering permits. No data is rendered (except 
that media types capable of being rendered statically, such as video, have a static, poster frame 
rendered in paused mode). Therefore, putting a filter graph into a paused state cues the graph 
for immediate rendering when put into a running state. 
<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_RenderFile">RenderFile Method (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Adds and connects filters needed to play the specified file. 
 
<P><I>objMediaControl</I><B>.RenderFile</B> <I>string</I><BR>
<H5>Parts</H5>
<DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
</DD><DT><I>string</I> 
 </DT><DD>Name of the file to render. 
</DD></DL>
<H5>Remarks</H5>
<P>This method allows an application to pass the name of a media file that it wants rendered 
to the filter graph manager. The filter graph manager will build a graph of the 
filters that are needed to play back this file. 
<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_Run">Run Method (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Switches the entire filter graph into a running state. 
 
<P><I>objMediaControl</I><B>.Run</B> <BR>
<H5>Parts</H5>
<DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
</DD></DL>
<H5>Remarks</H5>
<P>If the filter graph is in the stopped state, this method first pauses the graph before running. 
 
<P>If an error value is returned, some filters within the graph might have 
successfully entered the running state. In a multistream graph, entire streams 
might be playing successfully. The application must determine whether 
to stop execution or not. 
<H3><HR COLOR="#0000FF"><A NAME="IMediaControl_Stop">Stop Method (IMediaControl Object)</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl Object</A>
<P>Switches all filters in the filter graph to a stopped state. 
 
<P><I>objMediaControl</I><B>.Stop</B> <BR>
<H5>Parts</H5>
<DL><DT><I>objMediaControl</I> 
 </DT><DD>Object expression that evaluates to an 
<A HREF="/directx/dxm/help/ds/dssd0022.htm">IMediaControl</A> object. 
</DD></DL>
<H5>Remarks</H5>
<P>In this mode, filters release resources and no data is processed. 
If the filters are in a running state, this method pauses them before stopping 
them. This allows video renderers to make a copy of the current frame for poster 
frame display while stopped. 
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
