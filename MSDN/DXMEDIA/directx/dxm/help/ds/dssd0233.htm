<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CLoadDirectDraw Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="CLoadDirectDraw Class">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="CLoadDirectDraw"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CLoadDirectDraw Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- CLoadDirectDraw Class"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0188.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0232.htm">CImageSample Class</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0234.htm">CMediaControl Class</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>CLoadDirectDraw Class</H2>
<BR CLEAR=ALL>
<P><IMG SRC="/directx/dxm/help/ds/art/vctl05.gif" WIDTH="179" HEIGHT="25" ALT="CLoadDirectDraw class hierarchy">

<P>DirectShow&#153; must work on multiple platforms; in particular, it also runs on Microsoft&#174; Windows NT&#174; 3.51, which does not have DirectDraw&#174; capabilities. The filters therefore cannot link statically to the DirectDraw library. To make the platform dependencies easier to handle, this class manages loading and unloading the library and creating the initial <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface.

<A NAME="Member_Functions"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0233.htm#+">CLoadDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0233.htm#GetDirectDraw">GetDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a pointer to the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0233.htm#IsDirectDrawLoaded">IsDirectDrawLoaded</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Verifies that DirectDraw is loaded.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0233.htm#IsDirectDrawVersion1">IsDirectDrawVersion1</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Checks the version of DirectDraw installed on the current system.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0233.htm#LoadDirectDraw">LoadDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Loads and initializes the DirectDraw library.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0233.htm#ReleaseDirectDraw">ReleaseDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Releases the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="+">CLoadDirectDraw::CLoadDirectDraw</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw Class</A>
<P>Constructs a <A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw</A> object.

<P><B>CLoadDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>No return value.
<H3><HR COLOR="#0000FF"><A NAME="GetDirectDraw">CLoadDirectDraw::GetDirectDraw</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw Class</A>
<P>Retrieves the DirectDraw interface.

<P><B>LPDIRECTDRAW</B> <B>GetDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns a pointer to the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface.

<H5>Remarks</H5>
<P>Call <A HREF="/directx/dxm/help/ds/dssd0233.htm#LoadDirectDraw">CLoadDirectDraw::LoadDirectDraw</A> before calling this member function and call the <A HREF="/directx/dxm/help/ds/dssd0233.htm#ReleaseDirectDraw">CLoadDirectDraw::ReleaseDirectDraw</A> member function to release the interface when you are done.
<H3><HR COLOR="#0000FF"><A NAME="IsDirectDrawLoaded">CLoadDirectDraw::IsDirectDrawLoaded</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw Class</A>
<P>Verifies that this object loaded DirectDraw.

<P><B>HRESULT</B> <B>IsDirectDrawLoaded</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns S_OK if loaded; otherwise, returns S_FALSE.

<H3><HR COLOR="#0000FF"><A NAME="IsDirectDrawVersion1">CLoadDirectDraw::IsDirectDrawVersion1</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw Class</A>
<P>Checks the version of DirectDraw installed on the current system.

<P><B>BOOL</B> <B>IsDirectDrawVersion1</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns TRUE if the installed version of DirectDraw doesn't support the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw2">IDirectDraw2</A> interface, or FALSE if the <A HREF="/directx/dxm/help/ds/dssd0190.htm#m_pDirectDraw">m_pDirectDraw</A> data member is NULL or the installed version of DirectDraw supports <B>IDirectDraw2</B>.

<H5>Remarks</H5>
<P>The video renderer must know what the installed version of DirectDraw is to perform certain tasks, such as full-screen playback, which the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw2">IDirectDraw2</A> interface supports.
<H3><HR COLOR="#0000FF"><A NAME="LoadDirectDraw">CLoadDirectDraw::LoadDirectDraw</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw Class</A>
<P>Loads and initializes the DirectDraw library in the specified area.

<P><B>HRESULT</B> <B>LoadDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>LPSTR</B> <I>szDevice</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>szDevice</I>
 </DT><DD>This parameter is optional; if omitted, this method loads DirectDraw to the base drawing area.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if DirectDraw loaded correctly or E_NOINTERFACE otherwise.

<H5>Remarks</H5>
<P>DirectDraw is not always available, so applications can't statically link to the library. Therefore, this member function loads the library, gets the function entry point addresses, and calls them to create the driver objects. Call this member function before calling <A HREF="/directx/dxm/help/ds/dssd0233.htm#GetDirectDraw">CLoadDirectDraw::GetDirectDraw</A> to retrieve the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface.
<H3><HR COLOR="#0000FF"><A NAME="ReleaseDirectDraw">CLoadDirectDraw::ReleaseDirectDraw</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0233.htm">CLoadDirectDraw Class</A>
<P>Releases the <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface.

<P><B>void</B> <B>ReleaseDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>This member function is called to release any <A HREF="/directx/dxm/help/ds/dssd0404.htm#IDirectDraw">IDirectDraw</A> interface previously loaded. Call this only when all reference counts have been released.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
