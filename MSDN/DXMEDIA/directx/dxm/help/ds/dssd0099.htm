<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAMDevMemoryAllocator Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IAMDevMemoryAllocator Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="IAMDevMemoryAllocator"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMDevMemoryAllocator Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMDevMemoryAllocator Interface"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0091.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0128.htm">IAMCutListElement Interface</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0100.htm">IAMDevMemoryControl Interface</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>IAMDevMemoryAllocator Interface</H2>
<BR CLEAR=ALL>
<P>The <B>IAMDevMemoryAllocator</B> interface enables the creation of third-party memory allocators by using an on-board memory manager object. Many <A HREF="/directx/dxm/help/ds/dssd0408.htm#codec">codec</A> hardware manufacturers put on-board mapped memory for the codecs to improve the efficiency of buffer manipulation. This interface allocates that memory and provides the <A HREF="/directx/dxm/help/ds/dssd0099.htm#GetDevMemoryObject">GetDevMemoryObject</A> method to retrieve a device memory control object, which supports the <A HREF="/directx/dxm/help/ds/dssd0100.htm">IAMDevMemoryControl</A> interface. Devices that share the same device ID can use the memory.

<P>The global memory manager object exposes this interface to allocate memory from memory that is on a particular device.


<A NAME="When_to_Implement"></A><P><B>When to Implement

</B>
<P>Implement this interface when your pin must support the creation of on-board memory allocators. Source filters that are aware of on-board memory and need to create their own allocators should query for this interface, request an amount of memory and then create an allocator (aggregating the device memory control object). Source filters that don't need to create their own allocator could just use the allocator of the downstream pin (which also aggregates the device memory control object). The hardware-based filter can confirm the usage of its on-board memory by calling methods on the aggregated allocator.


<A NAME="When_to_Use"></A><P><B>When to Use
</B>
<P>Use this interface when applications need to control the memory of codecs with on-board memory.


<A NAME="Methods_in_Vtable_Or"></A><P><B>Methods in Vtable Order

</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#AddRef">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#Release">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMDevMemoryAllocator methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0099.htm#GetInfo">GetInfo</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves information about the memory capabilities.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0099.htm#CheckMemory">CheckMemory</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Tests whether a memory pointer was allocated by the specific instance (device)


 of the allocator.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0099.htm#Alloc">Alloc</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Allocates a memory buffer.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0099.htm#Free">Free</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Frees the previously allocated memory.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0099.htm#GetDevMemoryObject">GetDevMemoryObject</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves an <A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A> interface pointer to a device memory control object that can be aggregated with a custom allocator.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="Alloc">IAMDevMemoryAllocator::Alloc</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0099.htm">IAMDevMemoryAllocator Interface</A>
<P>Allocates a memory buffer.
<P><B>HRESULT</B> <B>Alloc</B><B>(</B><BR>&nbsp;&nbsp;<B>BYTE</B> <I>**ppBuffer</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwcbBuffer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppBuffer</I>
 </DT><DD>[out] Address of a pointer to the allocated memory buffer.
</DD><DT><I>pdwcbBuffer</I>
 </DT><DD>[in, out] For input, the number of bytes to allocate. For output, the number of actual bytes allocated.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if the desired quantity of memory was allocated, S_FALSE if memory was unavailable.

<H5>Remarks</H5>
<P>Call this method to allocate a block of memory from the available pool.

<H5>See Also</H5>
<P><A HREF="/directx/dxm/help/ds/dssd0099.htm#Free">IAMDevMemoryAllocator::Free</A><H3><HR COLOR="#0000FF"><A NAME="CheckMemory">IAMDevMemoryAllocator::CheckMemory</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0099.htm">IAMDevMemoryAllocator Interface</A>
<P>Tests whether a memory pointer was allocated by the specific instance (device) of the allocator.
<P><B>HRESULT</B> <B>CheckMemory</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>BYTE</B> <I>*pBuffer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pBuffer</I>
 </DT><DD>[in] Pointer to the allocated memory buffer's address.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if the on-board allocator allocated the memory, or S_FALSE if not. Memory that is on the particular device but not allocated will also return S_FALSE.

<H5>Remarks</H5>
<P>The hardware filter typically uses this method to test whether the pointer actually points to on-board memory.

<H3><HR COLOR="#0000FF"><A NAME="Free">IAMDevMemoryAllocator::Free</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0099.htm">IAMDevMemoryAllocator Interface</A>
<P>Frees the previously allocated memory.
<P><B>HRESULT</B> <B>Free</B><B>(</B><BR>&nbsp;&nbsp;<B>BYTE</B> <I>*pBuffer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pBuffer</I>
 </DT><DD>[in] Pointer to the allocated memory.
</DD></DL>
<H5>Return Values</H5>
<P>Returns E_INVALIDARG if the specified allocator didn't allocate the memory (that is, <A HREF="/directx/dxm/help/ds/dssd0099.htm#CheckMemory">CheckMemory</A> fails).

<H5>Remarks</H5>
<P>This method frees a block of memory from the pool.

<H3><HR COLOR="#0000FF"><A NAME="GetDevMemoryObject">IAMDevMemoryAllocator::GetDevMemoryObject</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0099.htm">IAMDevMemoryAllocator Interface</A>
<P>Retrieves an <A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A> interface pointer to a device memory control object that can be aggregated with a custom allocator.
<P><B>HRESULT</B> <B>GetDevMemoryObject</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>**ppUnkInnner</I><B>,</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>*pUnkOuter</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppUnkInnner</I>



 </DT><DD>[out] Address of a pointer to the newly created control object's own <A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A>. This inner <B>IUnknown</B> interface should be released when the outer object is destroyed. The custom allocator should call the <A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">QueryInterface</A> method on this pointer to obtain the <A HREF="/directx/dxm/help/ds/dssd0100.htm">IAMDevMemoryControl</A> interface.
</DD><DT><I>pUnkOuter</I>
 </DT><DD>[in] Pointer to the custom allocator's own <A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A> interface. This interface aggregates the device memory control object inside the custom allocator.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.

<H5>Remarks</H5>
<P>The device memory control object is necessary to aggregate with the custom allocator, because renderers that require the use of on-board memory will query for <A HREF="/directx/dxm/help/ds/dssd0100.htm">IAMDevMemoryControl</A> when they receive a new allocator, to verify that the memory is from the same device. This occurs because the hardware filter will receive an <A HREF="/directx/dxm/help/ds/dssd0165.htm">IMemAllocator</A> object, which might or might not use the on-board memory. To decide if it is a compatible allocator, the object would query for the <B>IAMDevMemoryControl</B> interface to access specific methods. The <B>IAMDevMemoryControl</B> creates an aggregated object that implements the methods of <B>IAMDevMemoryControl</B> (these are often hardware-specific).

<P>See COM documentation for rules on how the outer object implements aggregation.

<H3><HR COLOR="#0000FF"><A NAME="GetInfo">IAMDevMemoryAllocator::GetInfo</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0099.htm">IAMDevMemoryAllocator Interface</A>
<P>Retrieves information about the memory capabilities.
<P><B>HRESULT</B> <B>GetInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwcbTotalFree</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwcbLargestFree</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwcbTotalMemory</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>*pdwcbMinimumChunk</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pdwcbTotalFree</I>
 </DT><DD>[out] Total free memory size.
</DD><DT><I>pdwcbLargestFree</I>
 </DT><DD>[out] Retrieves the largest free memory size.
</DD><DT><I>pdwcbTotalMemory</I>
 </DT><DD>[out] Retrieves the total memory size.
</DD><DT><I>pdwcbMinimumChunk</I>
 </DT><DD>[out] Retrieves the minimum chunk size, giving granularity and alignment rules.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface.

<H5>Remarks</H5>
<P>Use this method to find out the total amount of memory available. This method returns values for the entire on-board memory that is available on that device. If multiple filters (devices) share the memory, it will return the amount available to that specific device, which might be a portion of the total amount of on-board memory. This amount will be implementation-specific. For example, the on-board memory manager on the codec might be able to access all 32 megabytes (MB) of memory on the card. However, individual pin implementations of <A HREF="/directx/dxm/help/ds/dssd0099.htm">IAMDevMemoryAllocator</A> only report a portion of this memory.

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
