<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DLL and Setup Functions</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="DLL and Setup Functions">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="DLLFunction"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- DLL and Setup Functions"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- DLL and Setup Functions"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0266.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0272.htm">CPosPassThru Helper Function</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0274.htm">Error Message Function</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>DLL and Setup Functions</H2>
<BR CLEAR=ALL>
<P>The Combase.h header file provides the following function for creating a run-time dynamic link with a specific dynamic-link library (DLL). For more information, read the <I>Run-Time Dynamic Linking</I> section in the Platform SDK. 

<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Function </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0273.htm#LoadOLEAut32">LoadOLEAut32</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Loads the Automation DLL (OleAut32.dll).
</FONT></TD></TR></TABLE>
<P>The Dllsetup.h header file provides the following functions for registering and unregistering DirectShow filters. You'll typically call <A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer2">AMovieDllRegisterServer2</A> to register your filter. The other functions are either helper functions or provide backwards compatibility.

<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Function </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer">AMovieDllRegisterServer</A> 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers filters. ActiveMovie 1.0 only.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer2">AMovieDllRegisterServer2</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers and unregisters filters.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllUnregisterServer">AMovieDllUnregisterServer</A> 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Unregisters filters. ActiveMovie 1.0 only.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieSetupRegisterFilter">AMovieSetupRegisterFilter</A> 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers a filter's merit, pins, and media types in the registry using the filter mapper. ActiveMovie 1.0 only.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieSetupRegisterFilter2">AMovieSetupRegisterFilter2</A> 

 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers a filter's merit, pins, and media types in the registry using <B>IFilterMapper2</B>.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="LoadOLEAut32">LoadOLEAut32</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0273.htm">DLL and Setup Functions</A>
<P>Loads the Automation dynamic-link library (OleAut32.dll).
<P><B>HINSTANCE</B> <B>LoadOLEAut32</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns a handle to an Automation DLL instance.

<H5>Remarks</H5>
<P>When the <A HREF="/directx/dxm/help/ds/dssd0206.htm">CBaseObject</A> destructor destroys the object that loaded OleAut32.dll, it will unload the library if it is still loaded.
<H3><HR COLOR="#0000FF"><A NAME="AMovieDllRegisterServer">AMovieDllRegisterServer</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0273.htm">DLL and Setup Functions</A>
<P>Registers filters. ActiveMovie 1.0 only.
<P><B>HRESULT</B> <B>AMovieDllRegisterServer</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>Use <A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer2">AMovieDllRegisterServer2</A> rather than this function to set up (register) your filters unless you need compatibility with ActiveMovie 1.0 filters. See <A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0056.htm">Register DirectShow Objects</A> and the sample filters included with the DirectShow SDK for more information about <B>AMovieDllRegisterServer2</B>. 
<H3><HR COLOR="#0000FF"><A NAME="AMovieDllRegisterServer2">AMovieDllRegisterServer2</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0273.htm">DLL and Setup Functions</A>
<P>Registers and unregisters filters.
<P><B>HRESULT</B> <B>AMovieDllRegisterServer2</B><B>(</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bRegister</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>bRegister</I>
 </DT><DD>TRUE indicates register the filter, FALSE indicates unregister it.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.



<H5>Remarks</H5>
<P>Use this function to set up your filters. See <A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0056.htm">Register DirectShow Objects</A> and the sample filters included with the DirectShow SDK for more information. 



<P><P><B>Note:</B>  The filter registration process is changing to allow filters to register by category. For example, capture filters and compression filters are enumerated together in their respective categories. The following functions demonstrate how filter registration and unregistration by category might work. The <A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0368.htm#AMCap">AMCap</A> sample demonstrates this procedure. The following function uses the <A HREF="/directx/dxm/help/ds/dssd0149.htm">IFilterMapper2</A> interface. <PRE><FONT FACE="Courier" SIZE="2">
// Register Sample Compressor Filter
STDAPI
DllRegisterServer( void )
{
 HRESULT hr = AMovieDllRegisterServer2( TRUE );
 if( FAILED(hr) )
     return hr;

 const WCHAR *wszUniq = L"Sample Compressor Filter" ;

 IFilterMapper2 *pFm2 = 0;

 hr = CoCreateInstance( CLSID_FilterMapper2
                         , NULL
                         , CLSCTX_INPROC_SERVER
                         , IID_IFilterMapper2
                         , (void **)&amp;pFm2       );
    
 if(FAILED(hr))
     return hr;

 hr = pFm2-&gt;RegisterFilter(
      CLSID_SampleCompressorFilter,
      wszUniq,
      0,
      &amp;CLSID_VideoCompressorCategory,
      wszUniq,
      MERIT_DO_NOT_USE,
      NULL,
      0);

 pFm2-&gt;Release();
 
 return hr;
}

// Unregister Sample Compressor Filter
STDAPI
DllUnregisterServer( void )
{

HRESULT hr = AMovieDllRegisterServer2( FALSE );
if( FAILED(hr) )
    return hr;

const WCHAR *wszUniq = L"Sample Compressor Filter" ;

IFilterMapper2 *pFm2 = 0;

hr = CoCreateInstance( CLSID_FilterMapper2
                        , NULL
                        , CLSCTX_INPROC_SERVER
                        , IID_IFilterMapper2
                        , (void **)&amp;pFm2       );
    
if(FAILED(hr))
    return hr;

hr = pFm2-&gt;UnregisterFilter(
     &amp;CLSID_VideoCompressorCategory,
     wszUniq,
     CLSID_SampleCompressorFilter);

pFm2-&gt;Release();
 
return hr;
}
</FONT></PRE>
<H3><HR COLOR="#0000FF"><A NAME="AMovieDllUnregisterServer">AMovieDllUnregisterServer</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0273.htm">DLL and Setup Functions</A>
<P>Unregisters filters. ActiveMovie 1.0 only.
<P><B>HRESULT</B> <B>AMovieDllUnregisterServer</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>Use <A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer2">AMovieDllRegisterServer2</A> rather than this function to uninstall (unregister) your filters unless you need compatibility with ActiveMovie 1.0 filters. See <A CLASS=TCTOP HREF="/directx/dxm/help/ds/dssd0056.htm">Register DirectShow Objects</A> and the sample filters included with the DirectShow SDK for more information about <B>AMovieDllRegisterServer2</B>. 
<H3><HR COLOR="#0000FF"><A NAME="AMovieSetupRegisterFilter">AMovieSetupRegisterFilter</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0273.htm">DLL and Setup Functions</A>
<P>Registers a filter's merit, pins, and media types in the registry using the filter mapper. ActiveMovie 1.0 only.
<P><B>HRESULT</B> <B>AMovieSetupRegisterFilter</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>AMOVIESETUP_FILTER</B> <B>*const</B> <I>psetupdata</I><B>,</B><BR>&nbsp;&nbsp;<B>IFilterMapper</B> <I>*pIFM</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bRegister</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>psetupdata</I>
 </DT><DD>Pointer to the <A HREF="/directx/dxm/help/ds/dssd0298.htm#AMOVIESETUP_FILTER">AMOVIESETUP_FILTER</A> data.
</DD><DT><I>pIFM</I>
 </DT><DD>Pointer to <A HREF="/directx/dxm/help/ds/dssd0148.htm">IFilterMapper</A> interface.
</DD><DT><I>bRegister</I>
 </DT><DD>TRUE indicates register the filter, FALSE indicates unregister it.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P>The <A HREF="/directx/dxm/help/ds/dssd0202.htm">CBaseFilter</A> base class uses this helper function to register a filter if the 1.0 ActiveMovie runtime is installed. It is provided for compatibility with ActiveMovie version 1.0 only. 

<P>Typically a filter will use <A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer">AMovieDllRegisterServer</A> and will not call this function directly.
<H3><HR COLOR="#0000FF"><A NAME="AMovieSetupRegisterFilter2">AMovieSetupRegisterFilter2</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0273.htm">DLL and Setup Functions</A>
<P>Registers a filter's merit, pins, and media types in the registry using <B>IFilterMapper2</B>.
<P><B>HRESULT</B> <B>AMovieSetupRegisterFilter2</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>AMOVIESETUP_FILTER</B> <B>*const</B> <I>psetupdata</I><B>,</B><BR>&nbsp;&nbsp;<B>IFilterMapper2</B> <I>*pIFM2</I><B>,</B><BR>&nbsp;&nbsp;<B>BOOL</B> <I>bRegister</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>psetupdata</I>
 </DT><DD>Pointer to the <A HREF="/directx/dxm/help/ds/dssd0298.htm#AMOVIESETUP_FILTER">AMOVIESETUP_FILTER</A> data.
</DD><DT><I>pIFM</I>
 </DT><DD>Pointer to <B>IFilterMapper2</B> interface.
</DD><DT><I>bRegister</I>
 </DT><DD>TRUE indicates register the filter, FALSE indicates unregister it.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value.

<H5>Remarks</H5>
<P><A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer2">AMovieDllRegisterServer2</A> uses this helper function to register a filter after the COM server has been registered.

<P>Typically a filter will use <A HREF="/directx/dxm/help/ds/dssd0273.htm#AMovieDllRegisterServer2">AMovieDllRegisterServer2</A> and will not call this function directly.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
