<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAMMediaStream Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IAMMediaStream Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="IAMMediaStream"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMMediaStream Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMMediaStream Interface"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0375.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0385.htm">IAMMultiMediaStream Interface</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0387.htm">Multimedia Streaming Data Types</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>IAMMediaStream Interface</H2>
<BR CLEAR=ALL>
<P>The <B>IAMMediaStream</B> interface handles the internal connections between DirectShow filters and filter graphs in applications that use multimedia streaming. This enables applications to automatically negotiate the transfer and conversion of data from the source to the application without having to write code to handle the connection, transfer of data, data conversion, and actual data rendering or file storage. This provides a uniform and predictable method of data access and control.

<A NAME="When_to_Implement"></A><P><B>When to Implement</B>
<P>This interface isn't intended for implementation by application developers.

<A NAME="When_to_Use"></A><P><B>When to Use</B>
<P>This interface isn't intended for use by application developers.

<A NAME="Methods_in_Vtable_Or"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#AddRef">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#Release">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMMediaStream methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description

</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0386.htm#Initialize">Initialize</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates and initializes a new media stream with the specified stream type and purpose ID.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0386.htm#SetState">SetState</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the filter state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0386.htm#JoinAMMultiMediaStream">JoinAMMultiMediaStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The <A HREF="/directx/dxm/help/ds/dssd0385.htm#AddMediaStream">IAMMultiMediaStream::AddMediaStream</A> method calls this method, which adds the specified media stream to the current multimedia stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0386.htm#JoinFilter">JoinFilter</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects a media stream to a media stream filter in the underlying filter graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0386.htm#JoinFilterGraph">JoinFilterGraph</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects a media stream filter to a filter graph.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="Initialize">IAMMediaStream::Initialize</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0386.htm">IAMMediaStream Interface</A>
<P>Creates and initializes a new media stream with the specified stream type and purpose ID.
<P><B>HRESULT</B> <B>Initialize</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>*pSourceObject</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>REFMSPID</B> <I>PurposeID</I><B>,</B><BR>&nbsp;&nbsp;<B>STREAM_TYPE</B> <I>StreamType</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pSourceObject</I>
 </DT><DD>[in] Pointer to an <A HREF="/directx/dxm/help/ds/dssd0181.htm">IUnknown</A> source object.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags. Must be zero.
</DD><DT><I>PurposeID</I>
 </DT><DD>[in] Purpose ID for the new media stream.
</DD><DT><I>StreamType</I>
 </DT><DD>[in] A <A HREF="/directx/dxm/help/ds/dssd0387.htm#STREAM_TYPE">STREAM_TYPE</A> enumeration value that specifies the new media stream's media type.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are invalid.

<H3><HR COLOR="#0000FF"><A NAME="JoinAMMultiMediaStream">IAMMediaStream::JoinAMMultiMediaStream</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0386.htm">IAMMediaStream Interface</A>
<P>The <A HREF="/directx/dxm/help/ds/dssd0385.htm#AddMediaStream">IAMMultiMediaStream::AddMediaStream</A> method calls this method, which adds the specified media stream to the current multimedia stream.
<P><B>HRESULT</B> <B>JoinAMMultiMediaStream</B><B>(</B><BR>&nbsp;&nbsp;<B>IAMMultiMediaStream*</B> <I>pAMMultiMediaStream</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pAMMultiMediaStream</I>
 </DT><DD>[in] Specifies the <A HREF="/directx/dxm/help/ds/dssd0385.htm">IAMMultiMediaStream</A> object to add the current media stream to. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or MS_E_SAMPLEALLOC if the media stream already has allocated stream samples.

<H5>Remarks</H5>
<P>Don't increment the reference count of the supplied multimedia stream because it is already accounted for when created.

<P>Applications should not call this method.
<H3><HR COLOR="#0000FF"><A NAME="JoinFilter">IAMMediaStream::JoinFilter</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0386.htm">IAMMediaStream Interface</A>
<P>Connects a media stream to a media stream filter in the underlying filter graph.
<P><B>HRESULT</B> <B>JoinFilter</B><B>(</B> <B>)</B><BR><H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are NULL.

<H5>Remarks</H5>
<P>Don't increment the reference count for the specified media stream filter.

<P>Applications should not call this method.
<H3><HR COLOR="#0000FF"><A NAME="JoinFilterGraph">IAMMediaStream::JoinFilterGraph</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0386.htm">IAMMediaStream Interface</A>
<P>Connects a media stream filter to a filter graph.
<P><B>HRESULT</B> <B>JoinFilterGraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IFilterGraph*</B> <I>pGraph</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pGraph</I>
 </DT><DD>[in] Indicates the current media stream filter to add to the specified filter graph.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are NULL.

<H5>Remarks</H5>
<P>Don't increment the reference count of the specified filter graph.

<P>Applications should not call this method.

<H3><HR COLOR="#0000FF"><A NAME="SetState">IAMMediaStream::SetState</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0386.htm">IAMMediaStream Interface</A>
<P>Sets the filter state.
<P><B>HRESULT</B> <B>SetState</B><B>(</B><BR>&nbsp;&nbsp;<B>FILTER_STATE</B> <I>State</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>State</I>
 </DT><DD>[in] Sets the filter's state, as specified by the <A HREF="/directx/dxm/help/ds/dssd0299.htm#FILTER_STATE">FILTER_STATE</A> enumerated type.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_INVALIDARG if the <I>State</I> parameter is invalid..

<H5>Remarks</H5>
<P>Applications should not call this method.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
