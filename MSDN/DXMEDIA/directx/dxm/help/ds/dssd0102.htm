<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAMDroppedFrames Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IAMDroppedFrames Interface">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="IAMDroppedFrames"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/ds/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMDroppedFrames Interface"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/ds/art/hdrdshow.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectShow Animated Header -- IAMDroppedFrames Interface"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/ds/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectShow SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/ds/dssd0091.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0101.htm">IAMDirectSound Interface</A>
<IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/ds/dssd0103.htm">IAMExtDevice Interface</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>IAMDroppedFrames Interface</H2>
<BR CLEAR=ALL>
<P>The <B>IAMDroppedFrames</B> interface provides information to an application from a capture filter about frames that the filter dropped (that is, did not send), the frame rate achieved (the length of time the graph ran divided by the number of frames not dropped), and the data rate achieved (the length of time the graph ran divided by the average frame size). A high number of dropped frames can detract from the smoothness of the video clip.

<p>If your application uses the <A HREF="/directx/dxm/help/ds/dssd0109.htm">IAMStreamControl</A>
interface or <A HREF="/directx/dxm/help/ds/dssd0124.htm#ControlStream">ICaptureGraphBuilder::ControlStream</A> to turn a pin off, a video capture driver may still be counting dropped and non-dropped frames, whose counts probably don't interest you. If your application is interested in the number of dropped and non-dropped frames only while the pin is ON, you can ask for the dropped and non-dropped counts by calling <A HREF="/directx/dxm/help/ds/dssd0102.htm#GetNumDropped">IAMDroppedFrames::GetNumDropped</A> and <A HREF="/directx/dxm/help/ds/dssd0102.htm#GetNumNotDropped">IAMDroppedFrames::GetNumNotDropped</A> immediately after turning on a pin with <A HREF="/directx/dxm/help/ds/dssd0109.htm#StartAt">IAMStreamControl::StartAt</A> or <A HREF="/directx/dxm/help/ds/dssd0124.htm#ControlStream">ICaptureGraphBuilder::ControlStream</A>, and then subtract those numbers from the numbers returned from subsequent calls to <B>GetNumDropped</B> or <B>GetNumNotDropped</B> to find out just the number dropped while the pin was on (which is probably the figure you are interested in). If your call to <A HREF="/directx/dxm/help/ds/dssd0109.htm#StartAt">IAMStreamControl::StartAt</A> or <A HREF="/directx/dxm/help/ds/dssd0124.htm#ControlStream">ICaptureGraphBuilder::ControlStream</A> is not a call to turn the pin on immediately, but instead turns the pin on at some specified time in the future, then you should wait until you get the notification (EC_STREAM_CONTROL_STARTED) before calling <B>GetNumDropped</B> and <B>GetNumNotDropped</B> initially. See the documentation on <A HREF="/directx/dxm/help/ds/dssd0109.htm">IAMStreamControl</A> for more information on this.  See the CAPTURE sample for an example of a capture application that uses both interfaces correctly.


<A NAME="When_to_Implement"></A><P><B>When to Implement</B>
<P>A capture filter's video output pin should always implement this interface.

<P>When a capture filter runs, it sends frame numbers beginning with the sequence 0, 1, 2, 3 (numbers will be missing if frames were dropped). The time stamp of each frame sent corresponds to the filter graph clock's time when the image was digitized. The end time is the start time plus the video frame's duration.

<P>Set the media time of each sample by using <A HREF="/directx/dxm/help/ds/dssd0237.htm#SetMediaTime">CMediaSample::SetMediaTime</A> and using frame numbers for the start and end times. For example, the start-time and end-time sequence might appear as follows: (0,1) (1,2) (2,3).
A downstream filter can easily tell that a frame was dropped by checking for gaps in the frame number sequence rather than by looking for gaps in the regular time stamps. The following start-time and end-time sequence reveals that frame number 3 was dropped: (1,2) (2,3) (4,5) (5,6).

<P>Every time a capture filter goes from <A HREF="/directx/dxm/help/ds/dssd0299.htm#State_Stopped">State_Stopped</A> to <A HREF="/directx/dxm/help/ds/dssd0299.htm#State_Paused">State_Paused</A>, it should reset all counts to zero.

<P>If your filter runs, pauses, and then runs again, you must continue to deliver frames as if it never paused. The first frame after the second run can't be time stamped earlier than the last frame sent before the pause. That is, your filter must always increment the media time of each sample sent. Never send the same frame number twice, and never go back in time. 



<A NAME="When_to_Use"></A><P><B>When to Use</B>
<P>Applications should use this interface all the time when capturing to update the current capture status. After capturing is done, applications should use this interface to determine the final capture results.
<p>If you are using a WDM video capture filter, you can only query an output pin for this interface if the capture filter is connected to another filter in the graph.
<A NAME="Methods_in_Vtable_Or"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#QueryInterface">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#AddRef">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0181.htm#Release">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMDroppedFrames methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0102.htm#GetNumDropped">GetNumDropped</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"> Retrieves the total number of frames that the pin dropped since it last started streaming.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0102.htm#GetNumNotDropped">GetNumNotDropped</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"> Retrieves the total number of frames that the pin delivered downstream (did not drop).
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0102.htm#GetDroppedInfo">GetDroppedInfo</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves an array of frame numbers that were dropped.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="/directx/dxm/help/ds/dssd0102.htm#GetAverageFrameSize">GetAverageFrameSize</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the average size of frames that were not dropped.
</FONT></TD></TR></TABLE>
<H3><HR COLOR="#0000FF"><A NAME="GetAverageFrameSize">IAMDroppedFrames::GetAverageFrameSize</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0102.htm">IAMDroppedFrames Interface</A>
<P>Retrieves the average size of frames that the pin dropped.
<P><B>HRESULT</B> <B>GetAverageFrameSize</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plAverageSize</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>plAverageSize</I>
 </DT><DD>[out, retval] Average size of frames sent out the pin since the pin started streaming, in bytes.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<H3><HR COLOR="#0000FF"><A NAME="GetDroppedInfo">IAMDroppedFrames::GetDroppedInfo</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0102.htm">IAMDroppedFrames Interface</A>
<P>Retrieves an array of frame numbers that the pin dropped.
<P><B>HRESULT</B> <B>GetDroppedInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>lSize</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plArray</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plNumCopied</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lSize</I>
 </DT><DD>[in] Requested number of elements in the array.
</DD><DT><I>plArray</I>
 </DT><DD>[out] Pointer to the array.
</DD><DT><I>plNumCopied</I>
 </DT><DD>[out, retval] Pointer to the number of array elements filled in. This number can
differ from <I>lSize</I> because the filter determines an arbitrary number of elements to save and it might not save this information for as many frames as you requested. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>The filter will fill the array with the frame numbers of up to the first <I>lSize</I> number of frames dropped, and it will set <I>plNumCopied</I> accordingly.
 

<H3><HR COLOR="#0000FF"><A NAME="GetNumDropped">IAMDroppedFrames::GetNumDropped</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0102.htm">IAMDroppedFrames Interface</A>
<P>Retrieves the total number of frames that the pin dropped since it last started streaming.
<P><B>HRESULT</B> <B>GetNumDropped</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plDropped</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>plDropped</I>
 </DT><DD>[out] Pointer to the total number of dropped frames.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<H3><HR COLOR="#0000FF"><A NAME="GetNumNotDropped">IAMDroppedFrames::GetNumNotDropped</A></H3>
<A HREF="/directx/dxm/help/ds/dssd0102.htm">IAMDroppedFrames Interface</A>
<P>Retrieves the total number of frames that the pin delivered downstream (did not drop).
<P><B>HRESULT</B> <B>GetNumNotDropped</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>plNotDropped</I> <B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>plNotDropped</I>
 </DT><DD>[out] Pointer to the total number of frames that weren't dropped.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="/directx/dxm/help/ds/dssd0308.htm#HRESULT">HRESULT</A> value that depends on the implementation of the interface. 

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/ds/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
