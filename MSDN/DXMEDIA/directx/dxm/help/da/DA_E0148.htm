<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ModelMakerApplet Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="ModelMakerApplet Class">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="ModelMakerApplet_Class"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/da/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectAnimation Animated Header --ModelMakerApplet Class"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217">
<IMG SRC="/directx/dxm/help/da/art/hdrdanim.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectAnimation Animated Header --ModelMakerApplet Class"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/da/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/da/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectAnimation SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/da/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/da/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/da/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/da/DA_E0118.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/da/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/da/DA_E0147.htm">ModifiableBehavior Class</A>
<IMG SRC="/directx/dxm/help/da/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/da/DA_E0149.htm">MontageBvr Class</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2>ModelMakerApplet Class</H2>
<BR CLEAR=ALL>
<PRE><FONT FACE="Courier" SIZE="2">public abstract ModelMakerApplet extends java.lang.Object {

    // Constructor
    public ModelMakerApplet();

    // Methods
    public ImageBvr createBackgroundImage();
    public IDABehavior grabBackgroundImageComPtr();
    public IDABehavior grabImageComPtr();
    public IDABehavior grabSoundComPtr();
    public IDAView grabViewComPtr();
    public ErrorAndWarningReceiver registerErrorAndWarningReceiver(ErrorAndWarningReceiver w);
    public synchronized void setModel(Model model);
}
</FONT></PRE>
<P>The <B>ModelMakerApplet</B> class is used for constructing models in Java and using them in windowless controls. It is similar to <A HREF="/directx/dxm/help/da/DA_E0132.htm">DXMApplet</A> except that it exposes some COM interfaces and doesn't do any ticking (this is performed by the DirectAnimation control called <A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0117.htm">DAViewer</A>). Here is the basic syntax for using <B>ModelMakerApplet</B>:

<PRE><FONT FACE="Courier" SIZE="2">
public class MyTest extends ModelMakerApplet{
    public MyTest() { 
     setModel(new testModel());
   }
}
</FONT></PRE>
<P>The <A HREF="/directx/dxm/help/da/DA_E0148.htm#grabBack_modelm">grabBackgroundImageComPtr</A>, <A HREF="/directx/dxm/help/da/DA_E0148.htm#grabImage_modelm">grabImageComPtr</A>, <A HREF="/directx/dxm/help/da/DA_E0148.htm#grabSound_modelm">grabSoundComPtr</A>, and <A HREF="/directx/dxm/help/da/DA_E0148.htm#grabView_modelm">grabViewComPtr</A> methods are used on the HTML page, and can be called either from VBScript or JScript. Here is an example of an HTML page that calls these methods, using VBScript:

<PRE><FONT FACE="Courier" SIZE="2">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;myTest Windowless Control&lt;/TITLE&gt;
&lt;/HEAD&gt;

&lt;body&gt;

&lt;DIV ID=LAYOUT STYLE="position:absolute; left:0; top:0; width:600; height:400"&gt;

&lt;DIV ID=text STYLE="position:absolute; left:0; top:0; width:450; height:280"&gt;
&lt;FONT SIZE=4 FACE="Verdana,Tahoma,Arial"&gt;       
This is standard HTML arranged using DIV tags and atop it we're going
to place our DirectX Animation windowless control.  
&lt;/FONT&gt;&lt;/DIV&gt;
&lt;/DIV&gt;


&lt;DIV ID=controlDiv&gt;
&lt;OBJECT ID="DAViewer"
        STYLE="position:absolute; left:50; top:10;width:200;height:300" 
        CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D"&gt;
&lt;/OBJECT&gt;
&lt;/DIV&gt;

&lt;/DIV&gt;

' The width and height parameters are placeholders. They need to be there to specify the applet and must be set to 1.

&lt;applet code=myTest.class codebase=. width=1 height=1 id=javaApp&gt;
&lt;/applet&gt;

&lt;script language="VBScript"&gt;
   sub window_onLoad
       set a = document.javaApp

       ' Get model components out of the Java applet and give it to the
       ' control. 
       DAViewer.View            = a.grabViewComPtr
       DAViewer.Image           = a.grabImageComPtr
       DAViewer.BackgroundImage = a.grabBackgroundImageComPtr
       DAViewer.Sound           = a.grabSoundComPtr

       ' Start the control viewing
       DAViewer.Start 

   end sub
&lt;/script&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

</FONT></PRE>
<UL><LI><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#Constructor_modelm">ModelMakerApplet Constructor</A>
<LI><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#ModelMakerApplet_Methods">ModelMakerApplet Methods</A>
</UL>
<H3><HR COLOR="#0000FF"><A NAME="Constructor_modelm">ModelMakerApplet Constructor</A></H3>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>Creates an <A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet</A> object.

<P><B>public</B> <B>ModelMakerApplet</B><B>(</B> <B>)</B><B>;</B><BR>
<HR COLOR="#0000FF">
<BR CLEAR=ALL><H3><A NAME="ModelMakerApplet_Methods">ModelMakerApplet Methods</A></H3>
<P><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#createBack_modelm"><IMG SRC="/directx/dxm/help/da/art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">createBackgroundImage</A><BR>
<P><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#grabBack_modelm"><IMG SRC="/directx/dxm/help/da/art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabBackgroundImageComPtr</A><BR>
<P><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#grabImage_modelm"><IMG SRC="/directx/dxm/help/da/art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabImageComPtr</A><BR>
<P><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#grabSound_modelm"><IMG SRC="/directx/dxm/help/da/art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabSoundComPtr</A><BR>
<P><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#grabView_modelm"><IMG SRC="/directx/dxm/help/da/art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">grabViewComPtr</A><BR>
<P><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#regError_modelm"><IMG SRC="/directx/dxm/help/da/art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">registerErrorAndWarningReceiver</A><BR>
<P><A CLASS=tctop HREF="/directx/dxm/help/da/DA_E0148.htm#setModel_modelm"><IMG SRC="/directx/dxm/help/da/art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">setModel</A><BR>
<H4><HR COLOR="#0000FF"><A NAME="createBack_modelm">createBackgroundImage</A></H4>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>This method is used so that models constructed in Java, intended for windowless controls, will have a background image if they appear in a browser that does not support this feature. The model will then be displayed in its own window, as if it were in a standard DirectAnimation applet. Just as these models need a background image to be explicitly inserted, so do windowless applets if they are to degrade gracefully to a windowed display. 

<P><B>public</B> <B>ImageBvr</B> <B>createBackgroundImage</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the <A HREF="/directx/dxm/help/da/DA_E0141.htm">ImageBvr</A> object.


<H5>Remarks</H5>
<P>This method should be called within <A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet</A> and not during the <A HREF="/directx/dxm/help/da/DA_E0146.htm#createModel_model">createModel</A> implementation. Here is an example:

<PRE><FONT FACE="Courier" SIZE="2">
public class myTest extends ModelMakerApplet {

  public ImageBvr createBackgroundImage() {
      return Statics.solidColorImage(Statics.black);
  }
      setModel(new testModel());
}
</FONT></PRE>
<H4><HR COLOR="#0000FF"><A NAME="grabBack_modelm">grabBackgroundImageComPtr</A></H4>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>Retrieves the background image component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDABehavior</B> <B>grabBackgroundImageComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than an <A HREF="/directx/dxm/help/da/DA_E0141.htm">ImageBvr</A>.)


<H4><HR COLOR="#0000FF"><A NAME="grabImage_modelm">grabImageComPtr</A></H4>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>Retrieves the image component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDABehavior</B> <B>grabImageComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than an <A HREF="/directx/dxm/help/da/DA_E0141.htm">ImageBvr</A>.)


<H4><HR COLOR="#0000FF"><A NAME="grabSound_modelm">grabSoundComPtr</A></H4>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>Retrieves the sound component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDABehavior</B> <B>grabSoundComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than a <A HREF="/directx/dxm/help/da/DA_E0159.htm">SoundBvr</A>.)


<H4><HR COLOR="#0000FF"><A NAME="grabView_modelm">grabViewComPtr</A></H4>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>Returns the viewer component of the model. This method is called from a script on the HTML page.

<P><B>public</B> <B>IDAView</B> <B>grabViewComPtr</B><B>(</B> <B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the COM pointer to the IDABehavior interface (rather than a <A HREF="/directx/dxm/help/da/DA_E0213.htm">Viewer</A>.)


<H4><HR COLOR="#0000FF"><A NAME="regError_modelm">registerErrorAndWarningReceiver</A></H4>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>Allows the application to register an object that will have its methods invoked upon asynchronous errors encountered when DirectAnimation media is controlling the frame loop or when recoverable errors occur when sampling and displaying the model.

<P><B>public</B> <B>ErrorAndWarningReceiver</B> <B>registerErrorAndWarningReceiver</B><B>(</B><BR>&nbsp;&nbsp;<B>ErrorAndWarningReceiver</B> <I>w</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>w</I>
 </DT><DD>The <A HREF="/directx/dxm/help/da/DA_E0137.htm">ErrorAndWarningReceiver</A> object to be registered.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="/directx/dxm/help/da/DA_E0137.htm">ErrorAndWarningReceiver</A> object.


<H4><HR COLOR="#0000FF"><A NAME="setModel_modelm">setModel</A></H4>
<A HREF="/directx/dxm/help/da/DA_E0148.htm">ModelMakerApplet Class</A>
<P>Sets the model that will be used.

<P><B>public</B> <B>synchronized</B> <B>void</B> <B>setModel</B><B>(</B><BR>&nbsp;&nbsp;<B>Model</B> <I>model</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>model</I>
 </DT><DD>The model to be set.
</DD></DL>
<H5>Remarks</H5>
<P>This method must be called before the model is started. Calling it after the model has started causes an exception.

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/da/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
