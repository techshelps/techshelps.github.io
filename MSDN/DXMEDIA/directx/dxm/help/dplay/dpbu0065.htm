<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDirectPlay3::SetSessionDesc</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<META NAME="MS-HKWD" CONTENT="IDirectPlay3::SetSessionDesc">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<A NAME="pagetop"></A><A NAME="SetSessionDesc"></A>

<OBJECT ID="DAControl" 
  STYLE="position:absolute; left:0; top:11;width:702;height:90"
  CLASSID="CLSID:B6FFC24C-7E13-11D0-9B47-00C04FC2F51D">
</OBJECT>
<!--STYLE="width:702;height:110"-->
<SCRIPT LANGUAGE="JScript">
<!--
  // The DirectAnimation library
  m = DAControl.PixelLibrary;

  /* -- Insert your code here --*/ 

  mediaBase = "art\\";
  glowBase = m.importImage(mediaBase + "glow.gif");
  xImage = m.importImage(mediaBase + "newtransx.gif");
  xImage = xImage.Transform(m.Translate2(-303,0));
  //header1 = m.importImage(mediaBase + "header1.gif");
  //header1 = header1.Transform(m.Translate2(-301,0));

  //header2 = m.importImage(mediaBase + "hdrd3drm.gif");
  //header2 = header2.Transform(m.Translate2(-143,0));

  //header3 = m.importImage(mediaBase + "header3.gif");
  //header3 = header3.Transform(m.Translate2(157,-18));

  //background = m.Overlay(header1, m.Overlay( header2, header3));

  glowPath1 = m.Polyline( new Array( 295,26, 305,26, 305,50, 310,57, 519,57, 
    536,40, 536,17, 675,17, 675,23 ) );

  glowPath2 = m.PolyLine( new Array( 44,41, 44,25, 52,16, 84,16, 106,16 ) );

  glowPath3 = m.PolyLine( new Array( 57,55, 69,55, 78,65, 92,65, 99,58,
    99,82, 95,85, 95,93, 132,93, 132,78,
    303,78, 315,66, 549,66, 549,17, 675,17,
    675,23 ) );

  glowPath4 = m.PolyLine( new Array( 29,55, 19,55, 19,31, 38,30, 38,21,
    46,16, 106,16 ) );

  glowPath5 = m.PolyLine( new Array( 45,62, 45,81, 37,81, 41,85, 46,85,   
  51,91, 68,91, 66,81, 90,81, 90,65, 94,65, 105,47 ) );

  glow1 = glowBase.Transform( moveGlow( glowPath1, 5 ) );
  glow2 = glowBase.Transform( moveGlow( glowPath2, 2 ) );
  glow3 = glowBase.Transform( moveGlow( glowPath3, 8 ) );
  glow4 = glowBase.Transform( moveGlow( glowPath4, 2.5 ) );
  glow5 = glowBase.Transform( moveGlow( glowPath5, 2 ) );

  finalImg = m.Overlay(xImage, m.Overlay( glow5, m.Overlay( glow4, 
    m.Overlay( glow3, m.Overlay( glow2, glow1)))));


  // set the model, an image, as the model to be displayed
  DAControl.Image = finalImg;//m.Overlay(finalImg, background);
  // set the background in case of a non-windowless browser (like IE3)
  DAControl.BackgroundImage = m.SolidColorImage(m.Blue);     
     
  // start the animation       
  DAControl.Start()


  function moveGlow(path, speed)  {
    imDimX = 702;
    imDimY = 120;

    coordsXf = m.Translate2(-imDimX/2, -imDimY/2);
    path = path.Transform(coordsXf);
    return xf = m.FollowPath(path, speed).Repeat(1);
  }

//-->
</SCRIPT>
<TABLE BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="*">
<TR>
<TD ROWSPAN="3" VALIGN="TOP" WIDTH="*">
<IMG SRC="/directx/dxm/help/dplay/art/header1.gif" WIDTH="107" HEIGHT="110" BORDER=0 ALT="DirectPlay Animated Header -- IDirectPlay3::SetSessionDesc"></TD>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="217"><IMG SRC="/directx/dxm/help/dplay/art/hdrdplay.gif" WIDTH="210" HEIGHT="110" BORDER=0 ALT="DirectPlay Animated Header -- IDirectPlay3::SetSessionDesc"></TD><TD VALIGN="TOP" WIDTH="383"><IMG SRC="/directx/dxm/help/dplay/art/header3.gif" WIDTH="383" HEIGHT="95" BORDER=0 ALT="*">
</TD>
<TD VALIGN="TOP" WIDTH="100%">
<IMG SRC="/directx/dxm/help/d3drm/art/spacer1.gif" WIDTH="100%" HEIGHT="94" BORDER=0 ALT="Microsoft DirectPlay SDK">
</TD>
</TR><TR><TD VALIGN="TOP"><PRE><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><IMG SRC="/directx/dxm/help/dplay/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/dplay/index.htm">Index</A>  <IMG SRC="/directx/dxm/help/dplay/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black;font-weight:bold" HREF="/directx/dxm/help/dplay/dpbu0009.htm">Topic Contents</A>
</FONT></PRE></TD></TR>
<TR><TD COLSPAN="2" VALIGN="TOP"><PRE><FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><IMG SRC="/directx/dxm/help/dplay/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="/directx/dxm/help/dplay/dpbu0064.htm">IDirectPlay3::SetPlayerName</A>
<IMG SRC="/directx/dxm/help/dplay/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="/directx/dxm/help/dplay/dpbu0066.htm">IDirectPlay3::StartSession</A>
</FONT></PRE></TD></TR></TABLE><BR CLEAR=ALL>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><BLOCKQUOTE STYLE="margin:15pt">
<H2><HR COLOR="#0000FF">IDirectPlay3::SetSessionDesc</H2>
<BR CLEAR=ALL>
<A HREF="/directx/dxm/help/dplay/dpbu0022.htm">IDirectPlay3 Interface</A>
<P>Changes the properties of the current session. Only the host of the session can change the session properties. If a nonhost attempts to call it, the method returns DPERR_ACCESSDENIED.
<P>The updated session description will be propagated to all the other computers in the session. Each player will receive a <A HREF="/directx/dxm/help/dplay/dpbu0106.htm">DPMSG_SETSESSIONDESC</A> system message.
<P>You can't use <B>SetSessionDesc</B> in a lobby session.

<P><B>HRESULT</B> <B>SetSessionDesc</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDPSESSIONDESC2</B> <I>lpSessDesc</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpSessDesc</I>
</DT><DD>Pointer to the <A HREF="/directx/dxm/help/dplay/dpbu0091.htm">DPSESSIONDESC2</A> structure containing the new settings.
</DD><DT><I>dwFlags</I>
</DT><DD>No flags are currently used by this method.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DP_OK if successful, or one of the following error values otherwise:
<DL>
<DT><A HREF="/directx/dxm/help/dplay/dpbu0119.htm#DPERR_ACCESSDENIED">DPERR_ACCESSDENIED</A>
</DT><DT><A HREF="/directx/dxm/help/dplay/dpbu0119.htm#DPERR_INVALIDPARAMS">DPERR_INVALIDPARAMS</A>
</DT><DT><A HREF="/directx/dxm/help/dplay/dpbu0119.htm#DPERR_NOSESSIONS">DPERR_NOSESSIONS</A>
</DT></DL>
<P>This method returns <A HREF="/directx/dxm/help/dplay/dpbu0119.htm#DPERR_ACCESSDENIED">DPERR_ACCESSDENIED</A> if this computer does not have permission to change the session. Only the host can change the session properties. It returns <A HREF="/directx/dxm/help/dplay/dpbu0119.htm#DPERR_INVALIDPARAMS">DPERR_INVALIDPARAMS</A> if the application attempts to change a property in the session description that cannot be changed or tries to give a property an invalid value. 

<H5>Remarks</H5>
<P>Changing the session description will cause a <A CLASS=tctop HREF="/directx/dxm/help/dplay/dpbu0006.htm#dplay_Using_System_Messages">DPSYS_SETSESSIONDESC</A> system message to be generated on all the other computers in the session.

<P>The following members and flags of the <A HREF="/directx/dxm/help/dplay/dpbu0091.htm">DPSESSIONDESC2</A> structure can be changed using <B>IDirectPlay3::SetSessionDesc</B>:
<DL>
<DT><I>dwFlags</I>
</DT><DD><A HREF="/directx/dxm/help/dplay/dpbu0091.htm#DPSESSION_JOINDISABL">DPSESSION_JOINDISABLED</A>
</DD><DD><A HREF="/directx/dxm/help/dplay/dpbu0091.htm#DPSESSION_NEWPLAYERS">DPSESSION_NEWPLAYERSDISABLED</A>
</DD><DD><A HREF="/directx/dxm/help/dplay/dpbu0091.htm#DPSESSION_NODATAMESS">DPSESSION_NODATAMESSAGES</A>
</DD><DD><A HREF="/directx/dxm/help/dplay/dpbu0091.htm#DPSESSION_PRIVATE">DPSESSION_PRIVATE</A>
</DD><DT><I>dwMaxPlayers</I>
 </DT><DD>If you set the maximum players to a value less than the current number of players, the method returns <A HREF="/directx/dxm/help/dplay/dpbu0119.htm#DPERR_INVALIDPARAMS">DPERR_INVALIDPARAMS</A>.
</DD><DT><I>lpszSessionName</I> / <I>lpszSessionNameA</I>
</DT><DT><I>lpszPassword</I> / <I>lpszPasswordA</I>
</DT><DT><I>dwUser1</I>
</DT><DT><I>dwUser2</I>
</DT><DT><I>dwUser3</I>
</DT><DT><I>dwUser4</I>


</DT></DL>
<P>If the following members and flags of the <A HREF="/directx/dxm/help/dplay/dpbu0091.htm">DPSESSIONDESC2</A> structure are changed, an error will occur (for example, if the <A HREF="/directx/dxm/help/dplay/dpbu0091.htm#DPSESSION_KEEPALIVE">DPSESSION_KEEPALIVE</A> flag is currently set and you try to set this bit, you will not get an error, but if you try to clear this bit, you will get an error and <B>IDirectPlay3::SetSessionDesc</B> will fail):
<DL>
<DT><I>dwSize</I>
</DT><DT><I>dwFlags</I>
</DT><DD><A HREF="/directx/dxm/help/dplay/dpbu0091.htm#DPSESSION_NOMESSAGEI">DPSESSION_NOMESSAGEID</A>
</DD><DD><A HREF="/directx/dxm/help/dplay/dpbu0091.htm#DPSESSION_KEEPALIVE">DPSESSION_KEEPALIVE</A>
</DD></DL>
<P>The following members of the <A HREF="/directx/dxm/help/dplay/dpbu0091.htm">DPSESSIONDESC2</A> structure are ignored (that is, it does not matter what you pass in these members&#151;DirectPlay will always use the values passed when <A HREF="/directx/dxm/help/dplay/dpbu0055.htm">IDirectPlay3::Open</A> was called):
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>guidInstance</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>guidApplication</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>dwCurrentPlayers</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>dwReserved1</I>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><I>dwReserved2</I>
</FONT></TD></TR></TABLE>
<H5>See Also</H5>
<P><A HREF="/directx/dxm/help/dplay/dpbu0091.htm">DPSESSIONDESC2</A>, <A HREF="/directx/dxm/help/dplay/dpbu0052.htm">IDirectPlay3::GetSessionDesc</A>
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="../cpyright.htm" TARGET="_top">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="1"><A HREF="#pagetop"><IMG SRC="/directx/dxm/help/dplay/art/yelbtn.gif" WIDTH="11" HEIGHT="11" ALIGN="MIDDLE" BORDER=0 ALT="*">Top of Page</A></FONT>
</BLOCKQUOTE><P>
</FONT><P>
</BODY></HTML>
