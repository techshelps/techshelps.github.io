<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Queue</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_creating_a_queue_activex"></a>Creating a Queue</h2>
<p>
All queues, either public or private, are created by calling the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object's <a href="mqactx_6605.htm"><b>Create</b></a> method. For a description of public and private queues, see <a href="msmq_guide_1j1v.htm">Message Queues</a>.</p>
<p>
The only queue property required to create the queue is <a href="mqactx_823p.htm"><b>PathName</b></a>. This property tells 1) MSMQ where to store the queue's messages, 2) whether the queue is public or private, and 3) the name of the queue. Once the queue is created, the <b>MSMQQueueInfo</b> object's returned <b>FormatName</b> property is used to open the queue. For a description of MSMQ pathnames and queue format names, see <a href="msmq_guide_0mg5.htm">Referencing a Queue</a>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a queue</h5>
<ol>
<li>
Determine which computer will hold the messages for the queue. The computer's machine name is part of the queue's MSMQ pathname (<a href="mqactx_823p.htm"><b>PathName</b></a>). For private queues, the local computer must be specified.</li>
<li>
Determine whether the queue should be public or private. This tells MSMQ where to register the queue: public queues are registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> and private queues are registered on the local computer (private queues can only be registered on the local computer). This information is part of the queue's MSMQ pathname (<a href="mqactx_823p.htm"><b>PathName</b></a>).</li>
<li>
Determine the name for the queue. The queue's name is part of the queue's MSMQ pathname (<a href="mqactx_823p.htm"><b>PathName</b></a>).<p>
<b>Note</b>&nbsp;&nbsp;The MSMQ pathname must be unique in the MSMQ enterprise. This applies to public and private queues.
</li>
<li>
Determine which queue properties must be set. If a queue property is not specified before calling <a href="mqactx_6605.htm"><b>Create</b></a>, its default value is used. For a complete list of the queue properties that can be set when a queue is created, see the following Queue Properties section.</li>
<li>
Set the queue properties. The only property required to create a queue is <a href="mqactx_823p.htm"><b>PathName</b></a>; all other queue properties are optional. The <b>PathName</b> property specifies where the queue's messages are stored, if the queue is public or private, and the local name of the queue. To modify properties after the queue is created, see <a href="mqactx_3lut.htm"><b>Update</b></a>.<pre><code>qinfo.PathName = "machinename\localname"         
or
qinfo.PathName = "machinename\PRIVATE$\localname"
 </code></pre>
<p>
Where <i>qinfo</i> is an <b>MSMQQueueInfo</b> object.
</li>
<li>
Call <a href="mqactx_6605.htm"><b>Create</b></a>.<pre><code>qinfo.Create
 </code></pre>
</li>
</ol>
<h4>Examples</h4>
<p>
The following two examples show functions used to create a public queue and a private queue. In these examples, two queue properties are specified: <b>PathName</b> and <b>Label</b>.</p>
<p>
<b>Note</b>&nbsp;&nbsp;In these examples, "." is used to indicate the local machine in <b>PathName</b>. For MSMQ servers and independent clients, the local machine is the local computer. However, for MSMQ dependent clients, the local machine is the client's MSMQ server.</p>
<p>
<b>For a public queue</b></p>
<pre><code>Function CreatePublicQueue() As MSMQQueueInfo
   Dim qinfo As New MSMQQueueInfo
   qinfo.PathName = ".\MyQueue" 'Created on local computer.
   qinfo.Label = "Public Queue"
   On Error GoTo ErrorHandler
   qinfo.Create
   Set CreatePublicQueue = qinfo
   Exit Function
ErrorHandler:
   MsgBox "Couldn't create queue. Error: " + Str$(Err.Number)
   MsgBox "Reason:  " + Err.Description
   Set CreatePublicQueue = Nothing
End Function

Sub Test()
    Dim qinfo As MSMQQueueInfo
    Set qinfo = CreatePublicQueue
    If Not qinfo Is Nothing Then
       MsgBox "Queue's format name is: " = qinfo.FormatName
    End If
End Sub
 </code></pre>
<p>
<b>For a private queue</b></p>
<pre><code>Function CreatePrivateQueue() As MSMQQueueInfo
   Dim qinfo As New MSMQQueueInfo
   qinfo.PathName = ".\Private$\MyQueue"        'On local computer.
   qinfo.Label = "Private Queue"
   On Error GoTo ErrorHandler
   qinfo.Create
   Set CreatePrivateQueue = qinfo
   Exit Function
ErrorHandler:
   MsgBox "Couldn't create queue. Error: " + Str$(Err.Number)
   MsgBox "Reason:  " + Err.Description
   Set CreatePrivateQueue = Nothing
End Function

Sub Test()
    Dim qinfo As MSMQQueueInfo
    Set qinfo = CreatePrivateQueue
    If Not qinfo Is Nothing Then
       MsgBox "Queue's format name is: " = qinfo.FormatName
    End If
End Sub
 </code></pre>
<h4>Queue Properties</h4>
<p>
The following optional queue properties can be set by the application when creating the queue:</p>
<p>
<a href="mqactx_8a5h.htm"><b>Authenticate</b></a> </p>
<p>
<a href="mqactx_6kft.htm"><b>BasePriority</b></a> </p>
<p>
<a href="mqactx_99nw.htm"><b>Journal</b></a> </p>
<p>
<a href="mqactx_57c1.htm"><b>JournalQuota</b></a> </p>
<p>
<a href="mqactx_30do.htm"><b>Label</b></a> </p>
<p>
<a href="mqactx_3iuk.htm"><b>PrivLevel</b></a> </p>
<p>
<a href="mqactx_4ijl.htm"><b>Quota</b></a> </p>
<p>
<a href="mqactx_63vo.htm"><b>ServiceTypeGuid</b></a> </p>
<p>
The following properties are set by MSMQ when it creates the queue. To read these properties, the application must explicitly call the <b>MSMQQueueInfo</b> object's <a href="mqactx_9h9k.htm"><b>Refresh</b></a> method before they can be read.</p>
<p>
<a href="mqactx_7rqd.htm"><b>CreateTime</b></a> (public queues only)</p>
<p>
<a href="mqactx_2k2t.htm"><b>FormatName</b></a> (public and private queues)</p>
<p>
<a href="mqactx_91yk.htm"><b>IsTransactional</b></a> (public and private queues)</p>
<p>
<a href="mqactx_3uhx.htm"><b>ModifyTime</b></a> (public queues only)</p>
<p>
<a href="mqactx_8ht0.htm"><b>QueueGuid</b></a> (public queues only)</p>
<p>&nbsp;</p></body>
</HTML>
