<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Refresh</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_refresh"></a>Refresh<br>
<a href="mqactx_01nz.htm">MSMQQueueInfo</a></h1>
<p>
The <b>Refresh</b> method refreshes the property values of the <b>MSMQQueueInfo</b> object. These values are retrieved from <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> (public queues) or from the local computer (private queues).</p>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Refresh</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>The queue information (<b>MSMQQueueInfo</b>) object that defines the queue.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
All queue properties can be retrieved. However, you can only retrieve the properties of private queues if they are located on your local computer.</p>
<p>
<b>Refresh</b> is typically used when more than one user is using the queue. For example, if user 1 locates the queue and then user 2 modifies the queue's properties, user 1 needs to call <b>Refresh</b> to sync up with user 2's changes.</p>
<p>
After a queue is created, the properties of the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object are not updated until <b>Refresh</b> is explicitly called, or the queue is closed and reopened. For example, even though MSMQ sets <a href="mqactx_7rqd.htm"><b>CreateTime</b></a>, <a href="mqactx_3uhx.htm"><b>ModifyTime</b></a>, or <a href="mqactx_8ht0.htm"><b>QueueGuid</b></a> when it creates the queue, the application must call <b>Refresh</b> to update the properties of the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object before it can read those properties.</p>
<p>
For a complete discussion on retrieving queue's properties, see <a href="actvxuse_0x2r.htm">Retrieving a Queue's Properties Using ActiveX Components</a>.</p>
<p>
<b>Refresh</b> uses the <a href="mqfunc_8b03.htm"><b>MQGetQueueProperties</b></a> function.</p>
<h4>Example</h4>
<p>
This example creates a public queue, and then uses Refresh to update the MSMQQueueInfo so it can display the queue's identifier (QueueGuid). To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form that has a single text box, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
   
Private Sub Form_Click()

  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\RefreshTest"
  qinfo.Label = "Test Queue"
  qinfo.Create
   
  qinfo.Refresh          'Required to update QueueGuid
  Text1.Text = "quidQueue = " + CStr(qinfo.QueueGuid)
 
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a>, <a href="mqactx_8ht0.htm"><b>QueueGuid</b></a></p>
<p>&nbsp;</p></body>
</HTML>
