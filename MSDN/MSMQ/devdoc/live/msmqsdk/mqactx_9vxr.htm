<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ResponseQueueInfo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_responsequeueinfo"></a>ResponseQueueInfo<br>
<a href="mqactx_54px.htm">MSMQMessage</a></h1>
<p>
The <b>ResponseQueueInfo</b> property specifies a queue for receiving response messages from the target application.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a></td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>read/write</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>set object1</i>.<b>ResponseQueueInfo = </b><i>object2</i>
<i> </i></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object1</i></td>
<td width=64%>Message (<b>MSMQMessage</b>) object that represents the message.</td>
</tr>
<tr valign=top>
<td width=36%><i>object2</i></td>
<td width=64%>Queue information (<b>MSMQQueueInfo</b>) object that represents the response queue.</td>
</tr>
</table><br>
<h4>Settings</h4>
<p>
<b>MSMQQueueInfo</b> object.</p>
<h4>Remarks</h4>
<p>
<b>ResponseQueueInfo</b> is used to send the format name of another queue to the receiving application. Typically, this is done so that the receiving application can send response messages back to the sending application. For information on response queues, see <a href="msmq_guide_8ib7.htm">Response Queues</a>. </p>
<p>
<b>Note</b>&nbsp;&nbsp;The <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object of a private queue (which would be inaccessible otherwise) can also be sent using <b>queuinfoResponse</b>.</p>
<p>
Messages returned to the queue are application defined. The application must define what is in the messages as well as what is to be done when a message is received.</p>
<p>
For a complete example of sending a message that requests a response plus sending the response, see <a href="actvxuse_02ig.htm">Sending Messages that Request a Response</a>.</p>
<h4>Example</h4>
<p>
This example locates a response and destination queue (creating them if needed), sends a message to the destination queue, and retrieves the message and sends a response message back to the response queue. To coordinate between the two messages, the correlation identifier of the response message (<a href="mqactx_69ic.htm"><b>CorrelationId</b></a>) is set to the message identifier of the original message.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim query As New MSMQQuery
Dim qinfos As MSMQQueueInfos
Dim qinfoResp, As MSMQQueueInfo
Dim qinfoDest As MSMQQueueInfo
Dim qRead As New MSMQQueue
Dim qResp As MSMQQueue
Dim msgSent As New MSMQMessage
Dim msgRead As MSMQMessage
Dim msgResp As New MSMQMessage

Private Sub Form_Click()
   
   '**********************************
   ' Locate response queue (create one
   ' if one doesn't exist).
   '**********************************
   Set qinfos = query.LookupQueue(Label:="Response Queue")
   qinfos.Reset
   Set qinfoResp = qinfos.Next
   If qinfoResp Is Nothing Then
      Set qinfoResp = New MSMQQueueInfo
      qinfoResp.PathName = ".\RespQueue"
      qinfoResp.Label = "Response Queue"
      qinfoResp.Create
   End If
   '**********************************
   ' Locate destination queue
   '(create one if one doesn't exist).
   '**********************************
   Set qinfos = query.LookupQueue(Label:="Destination Queue")
   qinfos.Reset
   Set qinfoDest = qinfos.Next
   If qinfoDest Is Nothing Then
      Set qinfoDest = New MSMQQueueInfo
      qinfoDest.PathName = ".\DestQueue"
      qinfoDest.Label = "Destination Queue"
      qinfoDest.Create
   End If
   
   '************************
   ' Open destination queue.
   '************************
   Set q = qinfoDest.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
   
   '**************
   ' Send Message.
   '**************
   msgSent.Label = "Test Message"
   msgSent.Body = "This message tests the response queue."
   Set msgSent.ResponseQueueInfo = qinfoResp
   msgSent.Send q
  
   MsgBox "The message was sent to the following queue: " + qinfoDest.QueueGuid + ". Check the MSMQ Explorer to see the message in the queue."
   q.Close
  
   '************************************
   ' Read the message in the destination
   ' queue and send response message if
   ' one is requested.
   '************************************
   Set q = qinfoDest.Open(MQ_RECEIVE_ACCESS, MQ_DENY_NONE)
   Set msgRead = q.Receive
   
   Set qResp = msgRead.ResponseQueueInfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
   msgResp.Label = "Response Message"
   msgResp.Body = "This is a response message"
   msgResp.CorrelationId = msgRead.Id
   msgResp.Send qResp
   MsgBox "The response message was sent to the following queue: " + msgRead.ResponseQueueInfo.QueueGuid
   
    
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_9mp1.htm"><b>Close</b></a>, <a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_69ic.htm"><b>CorrelationId</b></a>, <a href="mqactx_0ftw.htm"><b>Id</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_85np.htm"><b>LookupQueue</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_1q7t.htm"><b>MSMQQuery</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_2ypf.htm"><b>MSMQQueueInfos</b></a>, <a href="mqactx_9h84.htm"><b>Next</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a>, <a href="mqactx_80dh.htm"><b>Receive</b></a>, <a href="mqactx_4jhw.htm"><b>Reset</b></a>, <a href="mqactx_7k2s.htm"><b>Send</b></a></p>
<p>&nbsp;</p></body>
</HTML>
