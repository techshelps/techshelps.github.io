<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MQGetMachineProperties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_mqgetmachineproperties"></a>MQGetMachineProperties</h1>
<p>
The <b>MQGetMachineProperties</b> function retrieves information about a Queue Manager computer.</p>
<pre><code><b>HRESULT APIENTRY MQGetMachineProperties(
  LPCWSTR</b><i> lpwcsMachineName</i><b>,  </b>
<b>  GUID</b><i> pguidMachineID</i><b>,       </b>
<b>  MQQMPROPS</b><i> pQMProps         </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpwcsMachineName</i></dt>
<dd>
[in] The name of the Queue Manager computer you want to access. If this parameter is used, set <i>pguidMachineID</i> to NULL.</dd>
<dt>
<i>pguidMachineID</i></dt>
<dd>
[in] The identifier of the Queue Manager computer you want to access. If this parameter is used, set <i>lpwcsMachineName</i> to NULL.</dd>
<dt>
<i>pQMProps</i></dt>
<dd>
[in, out] Pointer to a Queue Manager properties structure (<a href="mqstruc_78j7.htm"><b>MQQMPROPS</b></a>) specifying which properties to retrieve.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MQ_OK</dt>
<dd>
Indicates success.</dd>
<dt>
MQ_ERROR_ACCESS_DENIED</dt>
<dd>
Access to the specified computer is denied. Verify the access rights for the operation.</dd>
<dt>
MQ_ERROR_INVALID_PARAMETER</dt>
<dd>
Both name (<i>lpwcsMachineName) </i>and computer (<i>pguidMachineID</i>) identifiers were specified.</dd>
<dt>
MQ_ERROR_ILLEGAL_MQQMPROPS</dt>
<dd>
Either <i>pQMprops </i>was NULL or no properties were specified.</dd>
<dt>
MQ_ERROR_ILLEGAL_PROPERTY_VT</dt>
<dd>
An invalid type indicator was supplied for one of the property values in <i>pQMProps</i>. </dd>
<dt>
MQ_ERROR_MACHINE_NOT_FOUND</dt>
<dd>
The specified computer could not be found in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>.</dd>
<dt>
MQ_ERROR_NO_DS</dt>
<dd>
Cannot access Active Directory.</dd>
<dt>
MQ_INFORMATION_UNSUPPORTED_PROPERTY</dt>
<dd>
An unsupported property identifier was specified in <i>pQMProps</i>. </dd>
<dt>
MQ_INFORMATION_DUPLICATE_PROPERTY</dt>
<dd>
A duplicate property identifier was specified in <i>pQMProps</i>. The second entry is ignored.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If <i>lpwcsMachineName</i> and <i>pguidMachineID</i> are set to NULL, the properties of the local computer are retrieved<b>.</b></p>
<p>
Valid Queue Manager properties are:
<ul>
<li>
<a href="mqprop_09wu.htm">PROPID_QM_CONNECTION</a></li>
<li>
<a href="mqprop_5vcb.htm">PROPID_QM_ENCRYPTION_PK</a></li>
<li>
<a href="mqprop_7les.htm">PROPID_QM_MACHINE_ID</a></li>
<li>
<a href="mqprop_5jmt.htm">PROPID_QM_PATHNAME</a></li>
<li>
<a href="mqprop_8qas.htm">PROPID_QM_SITE_ID</a></li>
</ul>
<p>
If a property specified by <i>pQMProps</i> is set to VT_NULL, MSMQ allocates the memory needed to store the property value when <b>MQGetMachineProperties</b> is called. However, when the returned property type replaces the VT_NULL value, the application must still free the memory allocated for the property value by calling <a href="mqfunc_02gp.htm"><b>MQFreeMemory</b></a>.</p>
<p>
Machine properties cannot be retrieved if there is no connection to <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>. This restriction applies to <a href="msmqglos_3wv8.htm#_mq_dependent_client_gly">dependent client</a> computers, <a href="msmqglos_3wvd.htm#_mq_independent_client_gly">independent client</a> computers that are working offline, and MSMQ routing servers (FRS). (For information on offline operations, see <a href="msmq_guide_72es.htm">MSMQ Offline Support</a>.)</p>
<h4>Examples</h4>
<p>
For an example of using <b>MQGetMachineProperties</b>, see:
<ul>
<li>
<a href="msmquse_13l5.htm">Reading Messages in a Dead Letter Queue</a></li>
<li>
<a href="msmquse_75nt.htm">Reading Messages in a Machine Journal</a></li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqprop_09wu.htm">PROPID_QM_CONNECTION</a>, <a href="mqprop_5vcb.htm">PROPID_QM_ENCRYPTION_PK</a>, <a href="mqprop_7les.htm">PROPID_QM_MACHINE_ID</a>, <a href="mqprop_5jmt.htm">PROPID_QM_PATHNAME</a>, <a href="mqprop_8qas.htm">PROPID_QM_SITE_ID</a>, <a href="mqfunc_02gp.htm"><b>MQFreeMemory</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
