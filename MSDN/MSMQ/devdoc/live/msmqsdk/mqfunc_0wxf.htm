<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MQSetQueueProperties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_mqsetqueueproperties"></a>MQSetQueueProperties</h1>
<p>
The <b>MQSetQueueProperties</b> function sets the properties of a specific queue.</p>
<pre><code><b>HRESULT APIENTRY MQSetQueueProperties(
  LPCWSTR</b><i> lpwcsFormatName</i><b>,  </b>
<b>  MQQUEUEPROPS </b><i>*pQueueProps  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpwcsFormatName</i></dt>
<dd>
[in] Pointer to the <a href="msmq_guide_1sbp.htm">format name</a> string of the queue whose properties will be set. Use a public or private format name to specify the queue. You cannot specify a queue using a direct format name.</dd>
<dt>
<i>pQueueProps</i></dt>
<dd>
[in] Pointer to the <a href="mqstruc_2ygj.htm"><b>MQQUEUEPROPS</b></a> structure that specifies the properties to be set.
<p>
On input, the <b>cProp</b> member of <b>MQQUEUEPROPS</b> specifies the number of properties to be set, the <b>aPropID </b>array specifies their property identifiers, and the <b>aPropVar</b> array indicates the new values of the specified properties.

<p>
On output, the optional <b>aStatus</b> array, if it was included in <b>MQQUEUEPROPS</b>, indicates the status of the properties.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MQ_OK</dt>
<dd>
Indicates success.</dd>
<dt>
MQ_ERROR_ACCESS_DENIED</dt>
<dd>
The process does not have the sufficient access rights to set the properties of the queue. For a complete list of queue access rights, see <a href="msmq_guide_8i0c.htm">Access Control</a>.
<p>
To change access rights, call <a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a>.
</dd>
<dt>
MQ_ERROR_ILLEGAL_FORMATNAME</dt>
<dd>
The <i>lpwcsFormatName</i> parameter<i> </i>specified an illegal format name.</dd>
<dt>
MQ_ERROR_ILLEGAL_PROPERTY_VALUE</dt>
<dd>
An illegal property value is specified.</dd>
<dt>
MQ_ERROR_NO_DS</dt>
<dd>
Cannot access <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>.</dd>
<dt>
MQ_ERROR_PROPERTY</dt>
<dd>
One or more properties resulted in error.</dd>
<dt>
MQ_ERROR_SERVICE_NOT_AVAILABLE</dt>
<dd>
Cannot connect to the Queue Manager.</dd>
<dt>
MQ_ERROR_UNSUPPORTED_FORMATNAME_OPERATION</dt>
<dd>
The <i>lpwcsFormatName</i> parameter specified a direct format name. You cannot set properties for a queue that is being accessed directly.</dd>
<dt>
MQ_ERROR_WRITE_NOT_ALLOWED</dt>
<dd>
Cannot set the properties for a queue in Active Directory.</dd>
<dt>
MQ_INFORMATION_PROPERTY</dt>
<dd>
One or more of the properties resulted in a warning even though the function completed.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If the format name of the queue is unknown, see <a href="msmq_guide_1sbp.htm">Format Name</a> to find ways to obtain a new format name.</p>
<p>
The following queue properties cannot be set by <b>MQSetQueueProperties</b>.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Property Name</th>
<th align=left width=52%>Reason</th>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_55h5.htm">PROPID_Q_BASEPRIORITY</a></td>
<td width=52%>For public queues only. Cannot be set for private queues.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_0ecl.htm">PROPID_Q_CREATE_TIME</a></td>
<td width=52%>Set by MSMQ.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_80th.htm">PROPID_Q_INSTANCE</a></td>
<td width=52%>Set by MSMQ.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_9bc5.htm">PROPID_Q_MODIFY_TIME</a></td>
<td width=52%>Set by MSMQ.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_0pt1.htm">PROPID_Q_PATHNAME</a></td>
<td width=52%>Can only be set when the queue is created.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_1r8u.htm">PROPID_Q_TRANSACTION</a></td>
<td width=52%>Can only be set when the queue is created.</td>
</tr>
</table><br>
<p>
For a list of the queue properties you can set, see <a href="msmquse_6ooj.htm">Setting a Queue's Properties Using API Functions</a>.</p>
<p>
When setting the properties of a public queue, some clients may still see the old settings registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> after the properties have been changed. Changes to Active Directory (such as setting properties) are propagated from domain controller to domain controller, which can cause delays in the availability of new information. Consequently, clients using a specific domain controller may still see the old property settings, even though the settings of the properties were changed by <b>MQSetQueueProperties</b>. Propagation delays, including communication network delays such as down links, are controlled by the MSMQ Administrator.</p>
<p>
A public queue's properties cannot be set if there is no connection to Active Directory. This restriction applies to <a href="msmqglos_3wv8.htm#_mq_dependent_client_gly">dependent client</a> computers, <a href="msmqglos_3wvd.htm#_mq_independent_client_gly">independent client</a> computers that are working offline, and MSMQ routing servers (FRS), (For information on offline operations, see <a href="msmq_guide_72es.htm">MSMQ Offline Support</a>.).</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_8b03.htm"><b>MQGetQueueProperties</b></a>, <a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a>, <a href="mqprop_55h5.htm">PROPID_Q_BASEPRIORITY</a>, <a href="mqprop_0ecl.htm">PROPID_Q_CREATE_TIME</a>, <a href="mqprop_80th.htm">PROPID_Q_INSTANCE</a>, <a href="mqprop_9bc5.htm">PROPID_Q_MODIFY_TIME</a>, <a href="mqprop_0pt1.htm">PROPID_Q_PATHNAME</a>, <a href="mqprop_1r8u.htm">PROPID_Q_TRANSACTION</a> </p>
<p>&nbsp;</p></body>
</HTML>
