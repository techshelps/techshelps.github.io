<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Private Messages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_private_messages"></a>Private Messages</h2>
<p>
MSMQ provides a secured channel for sending private, encrypted messages throughout your MSMQ enterprise. MSMQ ensures that the body of private messages are kept encrypted from the moment they leave the source Queue Manager to the moment they reach their target Queue Manager.</p>
<ul>
<li>
Private messages can also be sent to <a href="msmqglos_3wva.htm#_mq_foreign_queue_gly">foreign queues</a> via an <a href="msmqglos_3wvh.htm#_mq_msmq_connector_server_gly">MSMQ Connector Server</a>. For information on sending private messages to foreign queues, see <a href="msmq_guide_3r8z.htm">Passing Private Messages</a>.</li>
<li>
With encryption and decryption provided by MSMQ Queue Managers, applications do not have to encrypt messages when they are sent or decrypt messages when they are received. When a private message is sent, the source Queue Manager encrypts the body of the message, and sends the message on to the target Queue Manager. When the target Queue Manager receives the message, it decodes the body of the message and passes the clear message on to the queue. The receiving application can then read the message from the queue without ever knowing it was encrypted.</li>
<li>
Even though the receiving application sees the message as clear text, it can look at the message's privacy level to determine whether the message was sent encrypted, or look at the encryption algorithm used when the message was sent.</li>
<li>
To send a private message, the sending application sets the privacy level of the message and the encryption algorithm. The default encryption algorithm is RC2 (message encryption is based on public-key encryption using the Microsoft® Cryptographic API with an underlying RSA provider).</li>
<li>
In addition to setting the privacy level of a message, the privacy level of a queue can also be set so that the queue only accepts private messages.</li>
<li>
For a complete example of sending a private message (including setting the privacy level of a queue), see:<ul>
<li>
<a href="msmquse_552h.htm">Sending Private Messages</a> (using API functions)</li>
<li>
<a href="actvxuse_6ke0.htm">Sending Private Messages</a> (using ActiveX components)</li>
</ul>
</li>
<li>
For a description of the properties used to set the privacy level of a message, see:<ul>
<li>
<a href="mqprop_1y5o.htm">PROPID_M_PRIV_LEVEL</a> </li>
<li>
<a href="mqprop_73on.htm">PROPID_M_ENCRYPTION_ALG</a></li>
<li>
<a href="mqactx_3iuk.htm"><b>PrivLevel</b></a> </li>
<li>
<a href="mqactx_1r71.htm"><b>EncryptAlgorithm</b></a> </li>
</ul>
</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
