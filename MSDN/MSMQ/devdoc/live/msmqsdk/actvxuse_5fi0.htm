<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Transactions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_using_transactions_activex"></a>Using Transactions</h2>
<p>
When an MSMQ application performs a transaction, it must work with all the transactional services (Microsoft® Distributed Transaction Coordinator [MS DTC] and all resource managers) needed to complete the transaction. This includes all the resource mangers associated with the transaction, including MSMQ and MS DTC as the transaction manager.</p>
<p>
From a system perspective, the process for performing a transaction starts with the transaction application asking MS DTC or MSMQ for a new transaction object. Once a transaction object is available, the application can then make any number of transactional calls, as well as any number of non-transactional calls, to all the resource managers needed by the application.</p>
<p>
It is the application's responsibility to check the return values of all the functions called. If all calls succeed, the application can call the <a href="mqactx_3df8.htm"><b>Commit</b></a> method of the transaction object. This does not mean the transaction is committed; it only means that the application is ready to commit.</p>
<p>
MS DTC now starts a two-phase commit procedure, asking each participating resource manager to prepare itself and to inform MS DTC if it is ready to commit. If all the resource managers commit, MS DTC commits the transaction. If even one resource manager does not commit, the transaction is aborted.</p>
<p>
All this activity by MS DTC is invisible to the transaction application. The application only sees the return value of the <b>Commit </b>function it calls. When a successful <b>Commit</b> is returned to the application, the transaction is completed.</p>
<p>
<b>Note</b>&nbsp;&nbsp;When a transaction is completed, it does not mean the work is completed. When the transaction manager commits the transaction, it only means that each resource manager guarantees that it will do its part of the transaction at some later time.</p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
