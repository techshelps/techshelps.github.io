<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_TIME_TO_REACH_QUEUE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_time_to_reach_queue"></a>PROPID_M_TIME_TO_REACH_QUEUE</h1>
<p>
The PROPID_M_TIME_TO_REACH_QUEUE property specifies a time limit (in seconds) for the message to reach the queue.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_UI4</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
ulVal</dd>
<dt>
Property Values</dt>
<dd>
Integer value (the default is LONG_LIVED).
</dd>
</dl>
<h4>Remarks</h4>
<p>
PROPID_M_TIME_TO_REACH_QUEUE sets the message's <i>time-to-reach-queue</i> timer. For a discussion of message timers, see <a href="msmq_guide_206r.htm">Message Timers</a>. If the <i>time-to-reach-queue</i> timer expires before the message reaches its destination, MSMQ discards the message, sending it to the dead letter queue if the message's <a href="mqprop_20q4.htm">PROPID_M_JOURNAL</a> property is set to MQMSG_DEADLETTER.</p>
<p>
MSMQ can also send a return negative acknowledgment message back to the sending application if the message does not arrive and the message's <a href="mqprop_9411.htm">PROPID_M_ACKNOWLEDGE</a> property is set accordingly.</p>
<p>
To set the <i>time-to-reach-queue</i> timer, pass PROPID_M_TIME_TO_REACH_QUEUE to <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>.</p>
<p>
The default value LONG_LIVED is an enterprise-wide setting that can be adjusted by the MSMQ administrator. Typically, LONG_LIVED is set to 90 days. Although this timer can be set to INFINITE, MSMQ automatically uses the LONG_LIVED value in its place.</p>
<p>
To find out how much time remains in the <i>time-to-reach-queue</i> timer, pass PROPID_M_TIME_TO_REACH_QUEUE to <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a> and look at the returned value. A value of 0 indicates the timer has expired.</p>
<p>
If the <i>time-to-be-received</i> and <i>time-to-reach-queue</i> timers are both specified, the <i>time-to-be-received</i> timer takes precedence over the <i>time-to-reach-queue</i> timer.</p>
<p>
No matter what value PROPID_M_TIME_TO_REACH_QUEUE is set to (even if set to 0), MSMQ always gives each message one chance to reach its destination if the queue is waiting for the message. If the queue is local, the message always reaches the queue.</p>
<p>
MSMQ uses the <i>time-to-reach-queue</i> timer of the first message when several messages are sent in a transaction. For information on transactions, see <a href="msmq_guide_5g4z.htm">MSMQ Transactions</a>.</p>
<p>
When MSMQ creates an acknowledgment message, it always sets the message's <i>time-to-reach-queue</i> timer to LONG_LIVED.</p>
<p>
When a message is sent from an independent client computer, the <i>time-to-reach-queue</i> timer starts ticking as soon as the send operation succeeds, even if the client computer is offline.</p>
<p>
</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>, <a href="mqprop_9411.htm">PROPID_M_ACKNOWLEDGE</a>, <a href="mqprop_20q4.htm">PROPID_M_JOURNAL</a>, <a href="mqprop_531g.htm">PROPID_M_TIME_TO_BE_RECEIVED</a></p>
<p>&nbsp;</p></body>
</HTML>
