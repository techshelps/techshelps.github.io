<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_BODY</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_body"></a>PROPID_M_BODY</h1>
<p>
The PROPID_M_BODY property contains the body of the message.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_VECTOR | VT_UI1</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
caub</dd>
<dt>
Property Values</dt>
<dd>
Body of the message.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Each MSMQ message can have no more than 4 MB of data.</p>
<p>
The body of a message can consist of any type of information. It is the sending and receiving application's responsibility to understand the type of information that is in the body. For example, the sending application could send a binary file with any internal structure, and it would be the receiving application's responsibility to know how to decipher what was sent.</p>
<p>
It is recommended that the sending application set <a href="mqprop_4bj9.htm">PROPID_M_BODY_TYPE</a> whenever sending messages. If PROPID_M_BODY_TYPE is not set, the application reading the message should assume the message is an array of bytes.The MSMQ Microsoft® ActiveX® implementation does this automatically.</p>
<p>
<b>Note</b>&nbsp;&nbsp;The MSMQ ActiveX implementation supports the following specific types: VT_I2. VT_UI2, VT_I4, VT_UI4, VT_R4, VT_R8, VT_CY, VT_DATE, VT_BOOL, VT_I1, VT_UI1, VT_BSTR, VT_ARRAY, VT_STREAMED_OBJECT, VT_STORED_OBJECT, where the last two indicate serialized objects that support IPersistStream and lPersistStorage. There are many persistent objects, such as all Microsoft® Office documents, that can be sent as MSMQ messages.</p>
<p>
The receiving application can find the size of the message and its type by passing <a href="mqprop_7b6t.htm">PROPID_M_BODY_SIZE</a> and<b> </b><a href="mqprop_4bj9.htm">PROPID_M_BODY_TYPE</a> to <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>.</p>
<p>
When reading acknowledgment messages from an <a href="msmqglos_3wv5.htm#_mq_administration_queue_gly">administration queue</a>, PROPID_M_BODY only returns the original message's body if the acknowledgment message is a negative acknowledgment. Positive acknowledgment messages do not contain the body of the original message. For information on acknowledgment messages, see <a href="msmq_guide_76wj.htm">Acknowledgment Messages</a>.</p>
<h4>Example</h4>
<p>
This example shows how PROPID_M_BODY is specified in the MQMSGPROPS structure:</p>
<pre><code>MsgProps.aPropID[i] = PROPID_M_BODY;                      //PropId
MsgProps.aPropVar[i].vt = VT_VECTOR|VT_UI1;               //Type
MsgProps.aPropVar[i].caub.pElems = "Hash hash";           //Value
MsgProps.aPropVar[i].caub.cElems = strlen ("Hash hash")+1;
</code></pre>
<p>
For an example of using PROID_M_BODY, see:
<ul>
<li>
<a href="msmquse_552h.htm">Sending Private Messages</a> </li>
<li>
<a href="msmquse_8k89.htm">Reading Messages Using a Cursor</a> </li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>, <a href="mqprop_7b6t.htm">PROPID_M_BODY_SIZE</a>, <a href="mqprop_4bj9.htm">PROPID_M_BODY_TYPE</a> </p>
<p>&nbsp;</p></body>
</HTML>
