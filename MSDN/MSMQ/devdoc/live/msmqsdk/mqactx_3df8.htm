<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Commit</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_commit"></a>Commit<br>
<a href="mqactx_9c8e.htm">MSMQTransaction</a></h1>
<p>
The <b>Commit</b> method commits the operations requested by the transaction.</p>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Commit </b><i>(</i>[<i>fRetaining</i>][<i>, grfTC</i>][<i>, grfRM</i>]<i>)</i>
<i> </i></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Transaction (<b>MSMQTransaction</b>) object that identifies the transaction.</td>
</tr>
<tr valign=top>
<td width=36%><i>fRetaining</i></td>
<td width=64%>Optional. Reserved by Microsoft DTC.</td>
</tr>
<tr valign=top>
<td width=36%><i>grfTC</i></td>
<td width=64%>Optional. Specifies if the commit is synchronous (default) or asynchronous.<p>
XACTTC_ASYNC: When specified, the call to commit returns as soon as the two-phase commit protocol is initiated.</p>
<p>
XACTTC_SYNCPHASEONE: When specified, the call to commit returns after phase one of the two-phase commit protocol.</p>
</td>
</tr>
<tr valign=top>
<td width=36%><i>grfRM</i></td>
<td width=64%>Optional. Reserved by Microsoft DTC. </td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
Calling <b>Commit</b> does not mean that the operations requested are performed. It only means that MSMQ guarantees that the operations will be performed as an atomic unit. (<b>Commit</b> is a wrapper for lTransaction::Commit. For information on lTransaction::Commit, see the Microsoft Platform SDK.)</p>
<p>
An application must call <b>Commit</b> for the messages to be sent. If <b>Commit </b>is not called, the transaction will be terminated when the application exits.</p>
<p>
For information on Microsoft® DTC, refer to the <i>Guide to Microsoft Distributed Transaction Coordinator</i> in the Microsoft Platform SDK.</p>
<h4>Example</h4>
<p>
This example starts a transaction, sends two messages, and terminates the transaction.</p>
<pre><code>Dim xdispenser as New MSMQCoordinatedTransactionDispenser
Dim xact as MSMQTransaction

Dim qSend as MSMQQueue                
Dim msg1 as New MSMQMessage
Dim msg2 as New MSMQMessage

'Begins transaction, opening an existing transaction queue.
Set xact = xdispenser.BeginTransaction
Set qSend = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)

'Sends message 1.
msg1.Label = "MyTransaction first message"
msg1.Body = "Message 1 Body"
msg1.Send qSend, xact                    'Associates send with xact.

'Sends message 2.
msg2.Label = "MyTransaction second message"
msg2.Body = "Message 2 Body"
msg2.Send qSend, xact                    'Associates send with xact.

'Commits transaction.
xact.Commit                              'Commits transaction.
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<p>&nbsp;</p></body>
</HTML>
