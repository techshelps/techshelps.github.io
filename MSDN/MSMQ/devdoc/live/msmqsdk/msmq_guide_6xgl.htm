<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening Queues Offline</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_opening_queues_offline"></a>Opening Queues Offline</h2>
<p>
When sending messages, queues can be opened offline using a <a href="msmq_guide_1sbp.htm#_mq_public_format_names">public</a>, <a href="msmq_guide_1sbp.htm#_mq_private_format_names">private</a>, or <a href="msmq_guide_1sbp.htm#_mq_direct_format_names">direct</a> format name. Once the queue is open, all messages sent to the queue are stored locally by the client computer's Queue Manager and then passed to the destination queue when the client computer is reconnected to the network.</p>
<p>
When reading messages, the queue must be local, and it must be opened using a <a href="msmqglos_3wvk.htm#_mq_public_format_name_gly">public format name</a>.</p>
<h4>Public Format Names</h4>
<p>
When opening a queue to send messages, the identifier of the queue must be known by the application before the computer is disconnected from the network. In this case, the client computer accesses <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> after the computer is reconnected to the network. Active Directory resolves the queue identifier and then passes the messages to the appropriate queue.</p>
<p>
When opening a queue to read messages, the local queue is accessed the same way any other local queue is accessed.</p>
<p>
Here is the syntax of a public format name:</p>
<pre><code>"PUBLIC=<a href="msmqglos_3wvl.htm#_mq_queueguid_gly">QueueGUID</a>"
 </code></pre>
<h4>Private Format Names</h4>
<p>
To use a <a href="msmq_guide_1sbp.htm#_mq_private_format_names">private format name</a>, the identifier of the client computer and the queue's number must be known.</p>
<p>
Here is the general format of a private format name:</p>
<pre><code>"PRIVATE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>\<a href="msmqglos_3wvl.htm#_mq_queuenumber_gly">QueueNumber</a>"
 </code></pre>
<h4>Direct Format Names</h4>
<p>
To use a <a href="msmqglos_3wv8.htm#_mq_direct_format_name_gly">direct format name</a>, the target computer's network address and the queue's name must be known.</p>
<p>
Here is the general format of a direct format name (public and private queues can be accessed directly):</p>
<pre><code>DIRECT=<a href="msmqglos_3wv5.htm#_mq_addressspecification_gly">AddressSpecification</a>\<u>QueueName</u>            (For public queues.)
DIRECT=<a href="msmqglos_3wv5.htm#_mq_addressspecification_gly">AddressSpecification</a>\PRIVATE$\QueueName   (For private queues.)
 </code></pre>
<p>
When using a direct format name, the messages are sent directly to the target computer as soon as the client computer is brought back online.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>For information on…</th>
<th align=left width=52%>See…</th>
</tr>
<tr valign=top>
<td width=48%>Public, private, and direct format names</td>
<td width=52%><a href="msmq_guide_1sbp.htm">Format Name</a></td>
</tr>
<tr valign=top>
<td width=48%>Opening queues using API calls</td>
<td width=52%><a href="mqfunc_42hx.htm"><b>MQOpenQueue</b></a> </td>
</tr>
<tr valign=top>
<td width=48%>Opening queues using ActiveX components</td>
<td width=52%><b>MSMQQueueInfo</b>.<a href="mqactx_61bi.htm"><b>Open</b></a></td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
