<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_ADMIN_QUEUE_LEN</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_admin_queue_len"></a>PROPID_M_ADMIN_QUEUE_LEN</h1>
<p>
The PROPID_M_ADMIN_QUEUE_LEN property indicates the length (in Unicode characters) of the <a href="msmqglos_3wv5.htm#_mq_administration_queue_gly">administration queue's</a> format name buffer.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_UI4</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
ulVal</dd>
<dt>
Property Values</dt>
<dd>
Length (in Unicode characters) of the administration queue's format name buffer.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The PROPID_M_ADMIN_QUEUE_LEN property is only used by the receiving application when looking for the administration queue used by the sending application.</p>
<p>
To find out which queue is being used as the administration queue, pass <a href="mqprop_0yp1.htm">PROPID_M_ADMIN_QUEUE</a> and PROPID_M_ADMIN_QUEUE_LEN to <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a> and examine the returned values.</p>
<p>
On input, PROPID_M_ADMIN_QUEUE_LEN specifies the length of the format name buffer (in Unicode characters) allocated by the receiving application. The buffer should be large enough to hold the format name string including the null-terminating character.</p>
<p>
On return, this property holds the length (in Unicode characters) of the <a href="mqprop_0yp1.htm">PROPID_M_ADMIN_QUEUE</a> format name string including the null-terminating character.</p>
<p>
<b>MQReceiveMessage</b> fails if the buffer is not large enough to hold the format name, and PROPID_M_ADMIN_QUEUE_LEN is set to the required buffer length of the format name string.</p>
<p>
To see how PROPID_M_ADMIN_QUEUE_LEN is used when reading an acknowledgment message, see <a href="msmquse_9fu1.htm">Sending Messages that Request Acknowledgments</a>.</p>
<h4>Example</h4>
<p>
The following example allocates a buffer of size 60 for the format name of the administration queue, then sets the PROPID_M_ADMIN_QUEUE and PROPID_M_ADMIN_QUEUE_LEN properties.</p>
<pre><code>MQMSGPROPS MsgProps;
PROPVARIANT aVariant[10];
MSGPROPID aPropId[10];
DWORD PropIdCount = 0;

HRESULT hr;
QUEUEHANDLE hQueue;

//
// Prepare the PROPVARIANT array.
// 

#define ADMIN_QUEUE_BUFF_LEN    60
WCHAR szwAdminQueueFormatName[ADMIN_QUEUE_BUFF_LEN];

//
// Set the PROPID_M_ADMIN_QUEUE property.
//
aPropId[PropIdCount] = PROPID_M_ADMIN_QUEUE;               //PropId
aVariant[PropIdCount].vt = VT_LPWSTR;                      //Type
aVariant[PropIdCount].pwszVal = szwAdminQueueFormatName;   //allocated buffer
PropIdCount++;

//
// Set the PROPID_M_ADMIN_QUEUE_LEN property.
//
aPropId[PropIdCount] = PROPID_M_ADMIN_QUEUE_LEN;       //PropId
aVariant[PropIdCount].vt = VT_UI4;                     //Type
aVariant[PropIdCount].ulVal = ADMIN_QUEUE_BUFF_LEN;    //Value
PropIdCount++;

//
// Set the MQMSGPROPS structure.
//
MsgProps.cProp = PropIdCount;       //Number of properties.
MsgProps.aPropID = aPropId;         //Id of properties.
MsgProps.aPropVar = aVariant;       //Value of properties.
MsgProps.aStatus  = NULL;           //No Error report.
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqprop_9411.htm">PROPID_M_ACKNOWLEDGE</a>, <a href="mqprop_0yp1.htm">PROPID_M_ADMIN_QUEUE</a> </p>
<p>&nbsp;</p></body>
</HTML>
