<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Format Name</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mq_format_name"></a>Format Name</h3>
<p>
Format names are used to specify a queue when making calls to several API functions.</p>
<p>
<b>Note</b>&nbsp;&nbsp;For ActiveX applications, the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object used to represent the created queue includes a <a href="mqactx_2k2t.htm"><b>FormatName</b></a> property that is returned when the queue is created. The object's property can be used as it is, or it can be modified by the application.</p>
<p>
The API function calls that require a format name include the following:
<ul>
<li>
<a href="mqfunc_3pd1.htm"><b>MQDeleteQueue</b></a> </li>
<li>
<a href="mqfunc_8b03.htm"><b>MQGetQueueProperties</b></a> </li>
<li>
<a href="mqfunc_2w6x.htm"><b>MQGetQueueSecurity</b></a> </li>
<li>
<a href="mqfunc_42hx.htm"><b>MQOpenQueue</b></a> </li>
<li>
<a href="mqfunc_0wxf.htm"><b>MQSetQueueProperties</b></a> </li>
<li>
<a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a> </li>
</ul>
<p>
Unlike most of the characteristics of a queue, the format name is not an MSMQ queue property. It is simply a unique name for the queue that is generated by MSMQ when the queue is created or generated later by the application. MSMQ never stores the format name of a queue for later reference.</p>
<p>
Format names can be obtained by any of the following methods.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Method</th>
<th align=left width=63%>Details</th>
</tr>
<tr valign=top>
<td width=37%>When creating a queue.</td>
<td width=63%>MSMQ returns a format name when it creates a queue. <p>
ActiveX applications can obtain the queue's format name from the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object used to create the queue.</p>
</td>
</tr>
<tr valign=top>
<td width=37%>When locating a queue.</td>
<td width=63%>The application can retrieve the queue's MSMQ pathname or queue identifier (GUID) and translate it into a format name for the queue. See <a href="mqfunc_95t1.htm"><b>MQPathNameToFormatName</b></a> and <a href="mqfunc_925h.htm"><b>MQInstanceToFormatName</b></a> respectivley.<p>
ActiveX applications can obtain the queue's format name from the collection of <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> objects referenced by the <a href="mqactx_2ypf.htm"><b>MSMQQueueInfos</b></a> object returned by a query.</p>
</td>
</tr>
<tr valign=top>
<td width=37%>When the queue's handle is returned.</td>
<td width=63%>The application can translate the queue handle returned by <a href="mqfunc_42hx.htm"><b>MQOpenQueue</b></a> to a format name using <a href="mqfunc_5zj9.htm"><b>MQHandleToFormatName</b></a>.<p>
ActiveX applications can obtain the queue's format name from the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object's <a href="mqactx_2k2t.htm"><b>FormatName</b></a> property.</p>
</td>
</tr>
<tr valign=top>
<td width=37%>When reading application-generated messages from a message queue. </td>
<td width=63%>The receiving application can retrieve the format name of the <a href="msmqglos_3wvm.htm#_mq_response_queue_gly">response queue</a> and the format name of <a href="msmqglos_3wv5.htm#_mq_administration_queue_gly">administration queue</a> by retrieving the following message properties.<p>
The format name of the response queue is found in <a href="mqprop_204l.htm">PROPID_M_RESP_QUEUE</a>.</p>
<p>
The format name of the administration queue is found in <a href="mqprop_0yp1.htm">PROPID_M_ADMIN_QUEUE</a>.</p>
</td>
</tr>
<tr valign=top>
<td width=37%>When reading MSMQ-generated acknowledgment messages from an administration queue.</td>
<td width=63%>When reading the acknowledgment messages in the <a href="msmqglos_3wv5.htm#_mq_administration_queue_gly">administration queue</a>, the format name of the original message's destination queue can also be retrieved if <a href="mqprop_1let.htm">PROPID_M_DEST_QUEUE</a> was set by the sending application.</td>
</tr>
</table><br>
<p>
The data type holding the format name is a null-terminated Unicode string with one of the following general formats:</p>
<pre><code>PUBLIC=<a href="msmqglos_3wvl.htm#_mq_queueguid_gly">QueueGUID</a>                             *Public queues.
PUBLIC=<a href="msmqglos_3wvl.htm#_mq_queueguid_gly">QueueGUID</a>;<a href="msmqglos_3wve.htm#_mq_journal_gly">JOURNAL</a>                     *Public queue journals.
PRIVATE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>\<a href="msmqglos_3wvl.htm#_mq_queuenumber_gly">QueueNumber</a>              *Private queues.
PRIVATE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>\<a href="msmqglos_3wvl.htm#_mq_queuenumber_gly">QueueNumber</a>;<a href="msmqglos_3wve.htm#_mq_journal_gly">JOURNAL</a>      *Private queue journals.
DIRECT=<a href="msmqglos_3wv5.htm#_mq_addressspecification_gly">AddressSpecification</a>\<a href="msmqglos_3wvl.htm#_mq_queuename_gly">QueueName</a>        *Direct format for public
                                              queues.
DIRECT=<a href="msmqglos_3wv5.htm#_mq_addressspecification_gly">AddressSpecification</a>\<a href="msmqglos_3wvk.htm#_mq_private$_gly">PRIVATE$</a>\<a href="msmqglos_3wvl.htm#_mq_queuename_gly">QueueName</a>     *Direct format for 
                                                    private queue.
MACHINE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>;<a href="msmqglos_3wve.htm#_mq_journal_gly">JOURNAL</a>                  *Machine journal.
MACHINE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>;<a href="msmqglos_3wv8.htm#_mq_deadletter_gly">DEADLETTER</a>                 *Dead letter queue.
MACHINE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>;<a href="msmqglos_3wv8.htm#_mq_deadxact_gly">DEADXACT</a>                 *Transaction dead letter
                                              queue.
CONNECTOR=<a href="msmqglos_3wva.htm#_mq_foreigncnguid_gly">ForeignCNGUID</a>                      *Foreign queues.
CONNECTOR=<a href="msmqglos_3wva.htm#_mq_foreigncnguid_gly">ForeignCNGUID</a>:<a href="msmqglos_3wvs.htm#_mq_xactonly_gly">XACTONLY</a>             *Transaction foreign
                                              queues.
 </code></pre>
<p>
For information on public, private, and direct format names, see:
<ul>
<li>
<a href="#_mq_public_format_names">Public Format Names</a> </li>
<li>
<a href="#_mq_private_format_names">Private Format Names</a> </li>
<li>
<a href="#_mq_direct_format_names">Direct Format Names</a> </li>
</ul>
<p>
For information on MSMQ pathnames and queue handles, see:
<ul>
<li>
<a href="msmq_guide_8f1h.htm">MSMQ Pathname</a> </li>
<li>
<a href="msmq_guide_99et.htm">Queue Handle</a> </li>
</ul>
<p>
For information on journals and dead letter queues, see:
<ul>
<li>
<a href="msmq_guide_9s4z.htm">Journal Queues</a> </li>
<li>
<a href="msmq_guide_0s37.htm">Dead Letter Queues</a> </li>
</ul>

<h4><a name="_mq_public_format_names"></a>Public Format Names</h4>
<p>
Public format names are used to specify queues registered in the MSMQ information store. A queue's public format name contains the string "Public=" followed by the queue identifier generated by MSMQ when the queue was created.</p>
<p>
The following is the general format for public format names:</p>
<pre><code>"PUBLIC=<a href="msmqglos_3wvl.htm#_mq_queueguid_gly">QueueGUID</a>"
 </code></pre>
<p>
Example:</p>
<pre><code>Lpwstr Sz = L"PUBLIC=308FB580-1EB2-11CA-923B-08002B1075A7";
 </code></pre>
<p>
When this format is used, MSMQ looks in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> to determine what computer is currently hosting the queue, what protocol the host computer uses, and any other information it needs to get to the queue.</p>
<p>
<b>Note</b>&nbsp;&nbsp;A public format name is strictly equivalent to the queue's identifier except that it is formatted as a string rather than as binary data. See <a href="mqprop_80th.htm">PROPID_Q_INSTANCE</a> for API calls or <a href="mqactx_8ht0.htm"><b>QueueGuid</b></a> for ActiveX component calls. </p>
<p>
The queue's location (the specific computer where the queue's messages are stored) is not part of the format name. This allows message operations to succeed regardless of the queue location; a public queue can be relocated to another computer and the format name remains valid. This is not true of a direct format name where the queue is bound to a specific location.</p>
<p>
For information on other types of format names, see:
<ul>
<li>
<a href="#_mq_private_format_names">Private Format Names</a> </li>
<li>
<a href="#_mq_direct_format_names">Direct Format Names</a></li>
</ul>

<h4><a name="_mq_private_format_names"></a>Private Format Names</h4>
<p>
Private format names are used to specify queues that are created and managed locally by the Queue Manager on the local computer. Unlike public queues, they are not registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> and their scope is restricted to the local computer.</p>
<p>
The private format name of the queue includes the string "Private=" followed by the machine identifier of the computer where the queue is located and a hexadecimal number that identifies the queue.</p>
<p>
The following is the general format of a private format name:</p>
<pre><code>"PRIVATE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>\<a href="msmqglos_3wvl.htm#_mq_queuenumber_gly">QueueNumber</a>"
 </code></pre>
<p>
Example:</p>
<pre><code>Lpwstr Sz = L"PRIVATE=ae0c5671-f190-12ce-ae10-00dd0114290f\0000000d";
 </code></pre>
<p>
When MSMQ detects this type of format name, it does not refer to Active Directory for information about the queue. However, it does use Active Directory to look up information on the computer for routing purposes.</p>
<p>
For information on other types of format names, see:
<ul>
<li>
<a href="#_mq_public_format_names">Public Format Names</a> </li>
<li>
<a href="#_mq_direct_format_names">Direct Format Names</a></li>
</ul>

<h4><a name="_mq_direct_format_names"></a>Direct Format Names</h4>
<p>
Direct format names are used to open a queue that is not in your enterprise, or when you want to make sure MSMQ sends messages to the queue in one step. Direct format names have two parts: the address specification of the computer where the queue is located followed by the local name of the queue (the name specified in the queue's MSMQ pathname when the queue was created).</p>
<p>
The address specification of the computer can be specified using two forms:
<ul>
<li>
As the network address of the target computer (including the network protocol). MSMQ supports two network protocols: TCP and SPX. </li>
<li>
As any string that is supported natively by the underlying operating system to identify the target computer (OS is used as the protocol to indicate that the computer's native protocol should be used).</li>
</ul>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=16%>Protocol</th>
<th align=left width=37%>Description</th>
<th align=left width=47%>Network Address</th>
</tr>
<tr valign=top>
<td width=16%>TCP</td>
<td width=37%>Connection-oriented TCP over IP.</td>
<td width=47%>Internet address notation (IP address).</td>
</tr>
<tr valign=top>
<td width=16%>SPX</td>
<td width=37%>Connection-oriented SPX over IPX.</td>
<td width=47%>Network number and host number (separated by the ":" character).</td>
</tr>
<tr valign=top>
<td width=16%>OS</td>
<td width=37%>Connection using native machine-naming convention.</td>
<td width=47%>Any machine name supported by the underlying operating system. For Windows NT version 4.0, it is either UNC or DNS (see the following examples).</td>
</tr>
</table><br>
<p>
The following is the general format of a direct format name (public and private queues can be accessed directly):</p>
<pre><code>DIRECT=<a href="msmqglos_3wv5.htm#_mq_addressspecification_gly">AddressSpecification</a>\<a href="msmqglos_3wvl.htm#_mq_queuename_gly">QueueName</a>            (For public queues.)
DIRECT=<a href="msmqglos_3wv5.htm#_mq_addressspecification_gly">AddressSpecification</a>\<a href="msmqglos_3wvk.htm#_mq_private$_gly">PRIVATE$</a>\<a href="msmqglos_3wvl.htm#_mq_queuename_gly">QueueName</a>   (For private queues.)
 </code></pre>
<p>
Public queue examples:</p>
<pre><code>Lpwstr Sz = L"DIRECT=SPX: 00000012:00a0234f7500\MyQueue";
Lpwstr Sz = L"DIRECT=TCP:157.18.3.1\MyQueue";
Lpwstr Sz = L"DIRECT=OS:elvisp.ms.com\MyQueue";
Lpwstr Sz = L"DIRECT=OS:elvisp\MqQueue";
 </code></pre>
<p>
Private queue examples:</p>
<pre><code>Lpwstr Sz = L"DIRECT=SPX: 00000012:00a0234f7500\PRIVATE$\MyQueue";
Lpwstr Sz = L"DIRECT=TCP:157.18.3.1\PRIVATE$\MyQueue";
Lpwstr Sz = L"DIRECT=OS:elvisp.ms.com\PRIVATE$\MyQueue";
Lpwstr Sz = L"DIRECT=OS:elvisp\PRIVATE$\MqQueue";
 </code></pre>
<p>
When MSMQ sees a direct format name, it uses the information provided in the format name to locate the queue, not information in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>.</p>
<p>
In addition, you cannot use a direct format name to access a journal queue or dead letter queue.</p>
<p>
For information on other types of format names, see:
<ul>
<li>
<a href="#_mq_public_format_names">Public Format Names</a> </li>
<li>
<a href="#_mq_private_format_names">Private Format Names</a></li>
</ul>
<p>&nbsp;</p></body>
</HTML>
