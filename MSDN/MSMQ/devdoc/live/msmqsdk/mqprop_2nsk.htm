<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_SENDER_CERT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_sender_cert"></a>PROPID_M_SENDER_CERT</h1>
<p>
The PROPID_M_SENDER_CERT property specifies the <a href="msmqglos_3wv9.htm#_mq_external_certificate_gly">external certificate</a> used to authenticate messages.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_VECTOR | VT_UI1 </dd>
<dt>
PROPVARIANT Field</dt>
<dd>
caub</dd>
<dt>
Property Values</dt>
<dd>
Security certificate (the default is the internal certificate provided by MSMQ).
</dd>
</dl>
<h4>Remarks</h4>
<p>
The sending application must obtain an external certificate from a <a href="msmqglos_3wv7.htm#_mq_certification_authority_gly">certification authority</a> or use the <a href="msmqglos_3wvd.htm#_mq_internal_certificate_gly">internal certificate</a> provided by MSMQ.</p>
<p>
There are two ways to specify the security information provided by an external certificate.
<ul>
<li>
If the sending application uses the certificate only once, place the complete certificate in PROPID_M_SENDER_CERT and attach the property to the message.</li>
<li>
If the sending application uses the same certificate over and over, call <a href="mqfunc_031w.htm"><b>MQGetSecurityContext</b></a> to retrieve the security information from the certificate, place it in <a href="mqprop_27lg.htm">PROPID_M_SECURITY_CONTEXT</a>, and attach the property to the message.</li>
</ul>
<p>
When PROPID_M_SENDER_CERT is used, any certificate information in PROPID_M_SECURITY_CONTEXT is ignored, but the user information is still valid. Either property can be used when authenticating messages with an external certificate.</p>
<p>
When an external certificate is specified, the receiving application can use the information in the certificate to verify who sent the message. When the internal certificate is specified, the information in this property is not useful to the receiving application.</p>
<p>
For information on using an external certificate, see <a href="msmquse_8ztx.htm">Authenticating Messages Using an External Certificate</a>.</p>
<p>
For information on using an internal certificate, see <a href="msmquse_22n9.htm">Authenticating Messages Using an Internal Certificate</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_031w.htm"><b>MQGetSecurityContext</b></a>, <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqprop_27lg.htm">PROPID_M_SECURITY_CONTEXT</a>,<a href="mqprop_4vn2.htm"> PROPID_M_SENDER_CERT_LEN</a> </p>
<p>&nbsp;</p></body>
</HTML>
