<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PrivLevel</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_privlevel"></a>PrivLevel<br>
<a href="mqactx_01nz.htm">MSMQQueueInfo</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="mqactx_54px.htm">MSMQMessage</a></h1>
<p>
Optional. The <b>PrivLevel</b> property specifies the privacy level of a queue or message.</p>
<p>
For queues, this property specifies whether the queue accepts private (encrypted) messages, non-private messages, or both.</p>
<p>
For messages, this property specifies whether the message is private (encrypted).</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><b>Long</b></td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>read/write</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>PrivLevel</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>For queues, the queue information (<b>MSMQQueueInfo</b>) object that defines the queue.<p>
For messages, the message (<b>MSMQMessage</b>) object that defines the message.</p>
</td>
</tr>
</table><br>
<h4>Settings</h4>
<p>
For queues, set <b>PrivLevel </b>to one of the following values:
<dl>
<dt>
MQ_PRIV_LEVEL_NONE</dt>
<dd>
The queue accepts only non-private (clear) messages.</dd>
<dt>
MQ_PRIV_LEVEL_BODY</dt>
<dd>
The queue accepts only private (encrypted) messages.</dd>
<dt>
MQ_PRIV_LEVEL_OPTIONAL</dt>
<dd>
The default. The queue does not force privacy. It accepts private (encrypted) messages and non-private (clear) messages.
</dd>
</dl>
<p>
For messages, set <b>PrivLevel </b>to one of the following values:
<dl>
<dt>
MQMSG_PRIV_LEVEL_NONE</dt>
<dd>
The default. The message is a non-private (clear) message.</dd>
<dt>
MQMSG_PRIV_LEVEL_BODY</dt>
<dd>
The message is a private (encrypted) message.
</dd>
</dl>
<h4>Remarks</h4>
<dl>
<dt>
Queue Privacy Level</dt>
<dd>
The application can set the privacy level of queues and messages. If the privacy level of the message does not correspond to the privacy level of the queue, the message is rejected by the queue, and, if the sending application requested a negative acknowledgment message when it sent the message, MQMSG_CLASS_BAD_ENCRYPTION is returned to the sending application to indicate the message was rejected.
<p>
To specify the privacy level when creating the queue, set <b>PrivLevel</b> and call the <b>MSMQQueueInfo</b> object's <a href="mqactx_6605.htm"><b>Create</b></a> method.

<p>
To reset the privacy level of a queue after the queue is created, set <b>PrivLevel</b> to a new level, and if the queue is open, call the <b>MSMQQueueInfo</b> object's <a href="mqactx_3lut.htm"><b>Update</b></a><b> </b>method. If the queue is not open, do not call <b>Update</b> because the queue's properties are updated automatically when the queue is opened.

<p>
To find out the privacy level of a queue, call the <b>MSMQQueueInfo</b> object's <a href="mqactx_9h9k.htm"><b>Refresh</b></a><b> </b>method.
</dd>
<dt>
Message Privacy Level</dt>
<dd>
MSMQ can send private messages throughout the MSMQ enterprise. When sending a private message, the source Queue manager encrypts the body of the message and the target queue manager decrypts the message body. For a discussion of private messages, see <a href="msmq_guide_8cab.htm">Private Messages</a>.
<p>
When encrypting and decrypting messages, MSMQ uses the algorithm specified in <a href="mqactx_1r71.htm"><b>EncryptAlgorithm</b></a>.

</dd>
</dl>
<p>
For a complete example of sending a private message (including setting the privacy level of a queue), see <a href="actvxuse_6ke0.htm">Sending Private Messages</a>.</p>
<h4>Example: Setting the privacy level of a queue</h4>
<p>
This example creates a private queue on the local computer, setting the queue's privacy level to MQ_PRIV_LEVEL_OPTIONAL. To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
   
Private Sub Form_Click()
    
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\PRIVATE$\PrivacyLevelTest"
  qinfo.Label = "Test Queue"
  qinfo.PrivLevel = MQ_PRIV_LEVEL_OPTIONAL
  qinfo.Create
   
  MsgBox "Queue's Format name is: " + qinfo.FormatName

End Sub
 </code></pre>
<h4>Example: Setting the privacy level of a message</h4>
<p>
This example opens a queue that can only accept private messages, and then sends a private message to the queue.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
Dim q As MSMQQueue
Dim msg As New MSMQMessage

Private Sub Form_Click()
  '**********************
  ' Create queue
  '**********************
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\PrivacyTest"
  qinfo.Label = "Test Queue"
  qinfo.PrivLevel = MQ_PRIV_LEVEL_BODY
  qinfo.Create
  '*********************
  ' Open queue.
  '*********************
  Set q = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
  '*********************
  ' Send message.
  '*********************
  msg.Label = "Test Message"
  msg.Body = "This is a private message."
  msg.PrivLevel = MQMSG_PRIV_LEVEL_BODY
  
  msg.Send q
      
  q.Close
    
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a>, <a href="mqactx_9h9k.htm"><b>Refresh</b></a>, <a href="mqactx_7k2s.htm"><b>Send</b></a>, <a href="mqactx_3lut.htm"><b>Update</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
