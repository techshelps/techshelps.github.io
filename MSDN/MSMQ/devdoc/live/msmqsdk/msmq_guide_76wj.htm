<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Acknowledgment Messages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mq_acknowledgment_messages"></a>Acknowledgment Messages</h3>
<p>
An acknowledgment message indicates a positive or negative acknowledgment. The following table lists the message properties that have special meaning when attached to an acknowledgment message.</p>
<p>
<b>Note</b>&nbsp;&nbsp;<a href="msmqglos_3wv7.htm#_mq_connector_application_gly">Connector applications</a> must set these properties when sending positive (including read receipt messages) and negative acknowledgment messages back to the sending application.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=50%>Message Property <br>
(ActiveX property)</th>
<th align=left width=50%>Setting</th>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_9411.htm">PROPID_M_ACKNOWLEDGE</a><br>
(<a href="mqactx_7fvv.htm"><b>Ack</b></a>)</td>
<td width=50%>None.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_0yp1.htm">PROPID_M_ADMIN_QUEUE</a><br>
(<a href="mqactx_0j5b.htm"><b>AdminQueueInfo</b></a>)</td>
<td width=50%>Null.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_4gpv.htm">PROPID_M_APPSPECIFIC</a><br>
(<a href="mqactx_2y3n.htm"><b>AppSpecific</b></a>)</td>
<td width=50%>Same as original message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_6wzd.htm">PROPID_M_BODY</a><br>
(<a href="mqactx_2wl5.htm"><b>Body</b></a>)</td>
<td width=50%>For positive acknowledgment messages, the body of the acknowledgment message is empty. You must refer to the original message to see the message body.<p>
For negative acknowledgment messages (with the exception of private, encrypted messages) the body of the acknowledgment message contains the message body of the original message.</p>
</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_53qr.htm">PROPID_M_CLASS</a><br>
(<a href="mqactx_8egj.htm"><b>Class</b></a>)</td>
<td width=50%>Specifies the appropriate positive or negative acknowledgment class.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_0hwk.htm">PROPID_M_CORRELATIONID</a><br>
(<a href="mqactx_69ic.htm"><b>CorrelationId</b></a>)</td>
<td width=50%>Specifies the original application message identifier (the <a href="mqprop_0vxg.htm">PROPID_M_MSGID</a> of the original message). If the correlation identifier of the original message contained an application-defined identifier, that information is not included in the acknowledgment message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_28e1.htm">PROPID_M_DELIVERY</a><br>
(<a href="mqactx_64ft.htm"><b>Delivery</b></a>)</td>
<td width=50%>Same as original message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_8h4e.htm">PROPID_M_EXTENSION</a></td>
<td width=50%>Same as original message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_20q4.htm">PROPID_M_JOURNAL</a><br>
(<a href="mqactx_99nw.htm"><b>Journal</b></a>)</td>
<td width=50%>Same as original message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_9pnw.htm">PROPID_M_LABEL</a><br>
(<a href="mqactx_30do.htm"><b>Label</b></a>)</td>
<td width=50%>Same as original message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_0vxg.htm">PROPID_M_MSGID</a><br>
(<a href="mqactx_0ftw.htm"><b>id</b></a>)</td>
<td width=50%>Message identifier for the acknowledgment message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_7abd.htm">PROPID_M_PRIORITY</a><br>
(<a href="mqactx_16d5.htm"><b>Priority</b></a>)</td>
<td width=50%>Same as original message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_204l.htm">PROPID_M_RESP_QUEUE</a><br>
(<a href="mqactx_9vxr.htm"><b>ResponseQueueInfo</b></a>)</td>
<td width=50%>Target queue of the original message.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_531g.htm">PROPID_M_TIME_TO_BE_RECEIVED</a><br>
(<a href="mqactx_2o2t.htm"><b>MaxTimeToReceive</b></a>)</td>
<td width=50%>Set to maximum time allowed by MSMQ.</td>
</tr>
<tr valign=top>
<td width=50%><a href="mqprop_8ahx.htm">PROPID_M_TIME_TO_REACH_QUEUE</a><br>
(<a href="mqactx_0ysl.htm"><b>MaxTimeToReachQueue</b></a>)</td>
<td width=50%>Set to maximum time allowed by MSMQ.</td>
</tr>
</table><br>
<h4>Positive Acknowledgment Classes</h4>
<p>
MSMQ generates the following classes of positive acknowledgment messages:
<ul>
<li>
MQMSG_CLASS_ACK_REACH_QUEUE. This class indicates the original message reached its destination queue.</li>
<li>
MQMSG_CLASS_ACK_RECEIVE. This class indicates the original message was retrieved by the receiving application.</li>
</ul>
<h4>Negative Arrival Acknowledgment Classes</h4>
<p>
MSMQ generates the following classes of negative acknowledgment messages if the message fails to arrive at the queue:
<ul>
<li>
MQMSG_CLASS_NACK_ACCESS_DENIED. This class indicates the sender does not have send access rights to the destination queue.</li>
<li>
MQMSG_CLASS_NACK_BAD_DST_Q. This class indicates the destination queue is not available to the sender.</li>
<li>
MQMSG_CLASS_NACK_BAD_ENCRYPTION. This class indicates the destination Queue Manager could not decrypt a private message.</li>
<li>
MQMSG_CLASS_NACK_BAD_SIGNATURE. This class indicates that MSMQ could not authenticate the original message. The original message's digital signature is not valid.</li>
<li>
MQMSG_CLASS_NACK_COULD_NOT_ENCRYPT. This class indicates the source Queue Manager could not encrypt a private message.</li>
<li>
MQMSG_CLASS_NACK_HOP_COUNT_EXCEEDED. This class indicates the message hop count was exceeded. The maximum hop count is set by MSMQ (hop count = 15) and cannot be changed.</li>
<li>
MQMSG_CLASS_NACK_Q_EXCEED_QUOTA. This class indicates the message was not delivered because the destination queue is full.</li>
<li>
MQMSG_CLASS_NACK_REACH_QUEUE_TIMEOUT. This class indicates that the message did not reach the destination queue. It can be generated by either the <i>time-to-reach-queue</i> timer or <i>time-to-be-received</i> timer.</li>
<li>
MQMSG_CLASS_NACK_PURGED. This class indicates the message was purged before reaching the destination queue.</li>
<li>
MQMSG_CLASS_NACK_NOT_TRANSACTIONAL_Q. This class indicates a transaction message was sent to a non-transaction queue.</li>
<li>
MQMSG_CLASS_NACK_NOT_TRANSACTIONAL_MSG. This class indicates a non-transaction message was sent to a transaction queue.</li>
</ul>
<h4>Negative Read Acknowledgment Classes</h4>
<p>
MSMQ generates the following classes of negative acknowledgment messages if the original message in the queue could not be read:
<ul>
<li>
MQMSG_CLASS_NACK_Q_DELETED. This class indicates the queue was deleted before the message could be read from the queue.</li>
<li>
MQMSG_CLASS_NACK_Q_PURGED. This class indicates that the queue was purged and the message no longer exists.</li>
<li>
MQMSG_CLASS_NACK_RECEIVE_TIMEOUT. This class indicates that the message was not retrieved from the queue before its <i>time-to-be-received</i> timer expired.</li>
</ul>
<p>
For an example of returning acknowledgment messages, see:
<ul>
<li>
<a href="msmquse_9fu1.htm">Sending Messages that Request Acknowledgments</a> (using API functions)</li>
<li>
<a href="actvxuse_5k1k.htm">Sending Messages that Request Acknowledgments</a> (using ActiveX components)</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
