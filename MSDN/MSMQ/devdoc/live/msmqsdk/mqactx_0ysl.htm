<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MaxTimeToReachQueue</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_maxtimetoreachqueue"></a>MaxTimeToReachQueue<br>
<a href="mqactx_54px.htm">MSMQMessage</a></h1>
<p>
The<b> MaxTimeToReachQueue</b> property specifies a time limit (in seconds) for the message to reach the queue.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><b>Long</b></td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>read/write</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>MaxTimeToReachQueue</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Message (<b>MSMQMessage</b>) object that represents the message.</td>
</tr>
</table><br>
<h4>Settings</h4>
<p>
Integer value (the default is LONG_LIVED).</p>
<h4>Remarks</h4>
<p>
<b>MaxTimeToReachQueue</b> sets the message's <i>time-to-reach-queue</i> timer. For a discussion of message timers, see <a href="msmq_guide_206r.htm">Message Timers</a>. If the <i>time-to-reach-queue</i> timer expires before the message reaches its destination, MSMQ discards the message, sending it to the dead letter queue if the message's <a href="mqactx_99nw.htm"><b>Journal</b></a> property is set to MQMSG_DEADLETTER.</p>
<p>
MSMQ can also send a return negative acknowledgment message back to the sending application if the message does not arrive and the message's <a href="mqactx_7fvv.htm"><b>Ack</b></a> property is set accordingly.</p>
<p>
The default value LONG_LIVED is an enterprise-wide setting that can be adjusted by the MSMQ Administrator. Typically, LONG_LIVED is set to 90 days. Although this timer can be set to INFINITE, MSMQ automatically uses the LONG_LIVED value in its place.</p>
<p>
Once a message arrives at the queue, <b>MaxTimeToReachQueue</b> can be used to find out how much time remains in the time-to-reach-queue timer. A value of 0 indicates the timer has expired.</p>
<p>
MSMQ uses two message timers: time-to-reach-queue and time-to-be-received. If the time-to-be-received timer is set to a value less than the time-to-reach-queue timer, the time-to-be-received timer takes precedence over the time-to-reach-queue timer.</p>
<p>
No matter what value <b>MaxTimeToReachQueue</b> is set to (even if set to 0), MSMQ always gives each message one chance to reach its destination if the queue is waiting for the message. If the queue is local, the message always reaches the queue.</p>
<p>
MSMQ automatically uses the <i>time-to-reach-queue</i> timer of the first message when several messages are sent in a transaction. For information on transactions, see <a href="msmq_guide_5g4z.htm">MSMQ Transactions</a>.</p>
<p>
When MSMQ creates an acknowledgment message, it always sets the message's <i>time-to-reach-queue</i> timer to LONG_LIVED.</p>
<p>
When a message is sent from an independent client computer, the <i>time-to-reach-queue</i> timer starts ticking as soon as the send operation succeeds, even if the client computer is offline.</p>
<h4>Example</h4>
<p>
This example first creates and opens a queue for sending messages, sets the time-to-reach-queue timer for a message and sends it off to the queue, and then reads the message in the queue and displays the time remaining in the timer.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
Dim q As MSMQQueue
Dim msgSent As New MSMQMessage
Dim msgReceived As MSMQMessage

Private Sub Form_Click()
   '***************************
   ' Create queue (no error
   ' handling if queue exists).
   '***************************
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\TimerTest"
  qinfo.Label = "Test Queue"
  qinfo.Create
   '**************
   ' Open queue.
   '**************
  Set q = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
   '**************
   ' Send Message.
   '**************
  msgSent.Label = "Test Message"
  msgSent.Body = "This message tests MaxTimeToReachQueue."
  msgSent.MaxTimeToReachQueue = 120
  msgSent.Send q
  
  MsgBox "The message was sent. Check the MSMQ Explorer to see the messages in the queue."
  q.Close
  
  MsgBox "Click OK to continue"
  
   '**************
   ' Read Message.
   '**************
  Set q = qinfo.Open(MQ_PEEK_ACCESS, MQ_DENY_NONE)
  Set msgReceived = q.Peek
  MsgBox "MaxTimeToReachQueue = " + CStr(msgReceived.MaxTimeToReachQueue)
 
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_9mp1.htm"><b>Close</b></a>, <a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a>, <a href="mqactx_7k2s.htm"><b>Send</b></a></p>
<p>&nbsp;</p></body>
</HTML>
