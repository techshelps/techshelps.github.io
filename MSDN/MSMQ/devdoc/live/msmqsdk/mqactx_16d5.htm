<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Priority</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_priority"></a>Priority<br>
<a href="mqactx_54px.htm">MSMQMessage</a></h1>
<p>
The <b>Priority</b> property specifies the message's priority. A low number indicates a low priority.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><b>Long</b></td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>read/write</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Priority</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Message (<b>MSMQMessage</b>) object that represents the message.</td>
</tr>
</table><br>
<h4>Settings</h4>
<p>
Set <b>Priority</b> to an integer value between 7 and 0 (the default is 3).</p>
<h4>Remarks</h4>
<p>
Message priority affects how MSMQ handles the message while it is in route, as well as where the message is placed in the queue. Higher priority messages are given preference during routing and inserted toward the front of the queue. Messages with the same priority are placed in the queue according to their arrival time.</p>
<p>
MSMQ automatically sets the priority level of transactional messages to 0: <b>Priority</b> is ignored by the transaction. For information on transactions, see <a href="msmq_guide_5g4z.htm">MSMQ Transactions</a>.</p>
<p>
If the message is sent to a public queue, a second priority (the queue's <a href="mqactx_6kft.htm"><b>BasePriority</b></a> property) is added to <b>Priority</b> for routing purposes. However, the queue's base priority has no effect on how messages are placed in the queue.</p>
<h4>Example</h4>
<p>
This example first creates and opens a queue for sending messages, and then sets the priority level of two message and sends them off to the queue.</p>
<p>
To try this example using Microsoft® Visual Basic® (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
Dim q As MSMQQueue
Dim msg1 As New MSMQMessage
Dim msg2 As New MSMQMessage

Private Sub Form_Click()
   '*************************
   ' Create queue (no error
   ' handling if queue exists.
   '**************************
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\PriorityTest"
  qinfo.Label = "Test Queue"
  qinfo.Create
   '**************
   ' Open queue.
   '**************
  Set q = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
   '**************
   ' Send Messages.
   '**************
  msg1.Label = "Test Message1"
  msg1.Body = "This is a test message with a string Body."
  msg1.Priority = 0
  
  msg2.Label = "Test Message2"
  msg2.Body = "This is a test message with a string Body."
  msg2.Priority = 7
  
  msg1.Send q
  msg2.Send q
  
  MsgBox "Both messages were sent. Check the MSMQ Explorer to see the messages in the queue."
  
 q.Close

End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_9mp1.htm"><b>Close</b></a>, <a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a>, <a href="mqactx_7k2s.htm"><b>Send</b></a></p>
<p>&nbsp;</p></body>
</HTML>
