<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DestinationQueueLabels</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_destinationqueuelabels"></a>DestinationQueueLabels<br>
<a href="mqactx_1a5o.htm">MSMQMailEMail</a></h1>
<p>
The <b>DestinationQueueLabels</b> property provides the label of each destination queue needed to send the MSMQ mail message. These labels are taken from the recipient addresses defined by the e-mail object.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%>Collection of Strings</td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>Read-only</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>DestinationQueueLabels</b>
 </code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>An e-mail (<a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>) object that defines an e-mail message.</td>
</tr>
</table><br>
<h4>Returned Value</h4>
<p>
String representation of each queue label needed to send message.</p>
<h4>Remarks</h4>
<p>
Typically, a query is used to locate the destination queues of an e-mail. When running a query, make sure the queue type is added to the search criteria as well as the destination queue label. All application input queues, MAPI user input queues, and Exchange service input queues use the following MSMQ-defined queue type: MSMQMAIL_SERVICE_MAIL.</p>
<p>
When sending mail to several Microsoft Exchange users via the MSMQ Exchange Connector, only one label is stored in the destination queue collection. Only one label is needed because the Exchange Connector has only one input queue.</p>
<h4>Example</h4>
<p>
This example sends mail to each destination queue.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, enter a valid user address for each recipient, run the example, and click the form.</p>
<pre><code>Dim email As New MSMQMailEMail
Dim msg As New MSMQMessage


Private Sub Form_Click()

   '*********************
   '*  Define e-mail
   '*********************

   'Set e-mail type to text message.
   email.ContentType = MSMQMAIL_EMAIL_TEXTMESSAGE

   'Add recipient.
   email.Recipients.Add "User1", "User1Address", MSMQMAIL_RECIPIENT_TO
   email.Recipients.Add "User2", "User2Address", MSMQMAIL_RECIPIENT_CC
   
   'Set who sent the e-mail.
   email.Sender.Name = "Our name"
   email.Sender.Address = "Our queue label"

   'Set subject of mail.
   email.Subject = "Test form."
   
   'Set message text
   email.TextMessageData.Text = "This is a test message."


   '******************
   '* Compose message
   '******************
   msg.Body = email.ComposeBody
   
   '******************
   '* Send Message
   '******************
   
   Dim qLabel As Variant
      
   For Each qLabel In email.DestinationQueueLabels
       Dim query As MSMQQuery
       Dim qinfos As MSMQQueueInfos
       Dim qinfo As MSMQQueueInfo
       
       Set query = New MSMQQuery
       Set qinfos = query.LookupQueue(Label:=qLabel, ServiceTypeGuid:=MSMQMAIL_SERVICE_MAIL)
       
       qinfos.Reset
       Set qinfo = qinfos.Next
       
       If Not (qinfo Is Nothing) Then
          Dim qdestination As MSMQQueue
          Set qdestination = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
          msg.Send qdestination
       End If
   
   Next qLabel

End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in mqmailoa.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_7fxg.htm"><b>Add</b></a>, <a href="mqactx_9cqb.htm"><b>Address</b></a>, <a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_1y0p.htm"><b>ComposeBody</b></a>, <a href="mqactx_1q05.htm"><b>ContentType</b></a>, <a href="mqactx_85np.htm"><b>LookupQueue</b></a>, <a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_1q7t.htm"><b>MSMQQuery</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_2ypf.htm"><b>MSMQQueueInfos</b></a>, <a href="mqactx_9411.htm"><b>Name</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_7r3n.htm"><b>Recipients</b></a>, <a href="mqactx_7k2s.htm"><b>Send</b></a>, <a href="mqactx_6h4i.htm"><b>Sender</b></a>, <a href="mqactx_78ac.htm"><b>Subject</b></a>, <a href="mqactx_36us.htm"><b>Text</b></a>, <a href="mqactx_5469.htm"><b>TextMessageData</b></a></p>
<p>&nbsp;</p></body>
</HTML>
