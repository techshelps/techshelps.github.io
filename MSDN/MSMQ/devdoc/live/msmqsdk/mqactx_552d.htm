<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Delete</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_delete"></a>Delete<br>
<a href="mqactx_01nz.htm">MSMQQueueInfo</a></h1>
<p>
The <b>Delete</b> method deletes an existing queue (it does not delete the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object used to create the queue).</p>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Delete</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>The queue information<b> </b>(<a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>) object that defines the queue.</td>
</tr>
</table><br>
<h4>Return Codes</h4>
<p>
For information on return codes, see <a href="mqfunc_9pgz.htm">MSMQ Error and Information Codes</a>. </p>
<h4>Remarks</h4>
<p>
Deleting the queue does not delete the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object, only the existing queue. You can still create a new queue based on the current properties of the <b>MSMQQueueInfo</b> object.</p>
<p>
When deleting a public queue, some clients may still see the queue registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> after the queue was deleted. Changes to Active Directory (such as deleting a public queue) are propagated from domain controller to domain controller, which can cause delays in the availability of new information. Consequently, clients using a specific domain controller may still try to send messages to the queue, even though it was deleted. Propagation delays, including communication network delays such as down links, are controlled by the MSMQ Administrator.</p>
<h4>Example</h4>
<p>
This example assumes at least one queue whose label is "Test Queue" already exists. It runs a query for the test queues, asking if you want to delete each queue it finds.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim query As New MSMQQuery
Dim qinfos As MSMQQueueInfos
Dim qinfo As MSMQQueueInfo
Dim Response As String


Private Sub Form_Click()

   Set qinfos = query.LookupQueue(Label:="Test Queue")
   qinfos.Reset
   Set qinfo = qinfos.Next

   While Not qinfo Is Nothing
      Response = MsgBox("Delete queue: " + qinfo.Label, vbYesNo)
      
      If Response = vbYes Then
         qinfo.Delete
      End If
      
      Set qinfo = qinfos.Next
   Wend
   
End Sub 
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_85np.htm"><b>LookupQueue</b></a>, <a href="mqactx_1q7t.htm"><b>MSMQQuery</b></a>, <a href="mqactx_2ypf.htm"><b>MSMQQueueInfos</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_9h84.htm"><b>Next</b></a>, <a href="mqactx_4jhw.htm"><b>Reset</b></a></p>
<p>&nbsp;</p></body>
</HTML>
