<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Data</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_data"></a>Data<br>
<a href="mqactx_8ns1.htm">MSMQMailTnefData</a></h1>
<p>
The <b>Data</b> property specifies the data of a <a href="msmqglos_3wvo.htm#_mq_tnef_gly">TNEF</a> e-mail.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><b>Variant</b> (variant type is an array of bytes)</td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>Read-write</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object1.object2</i>.<b>Data</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object1</i></td>
<td width=64%>E-mail (<a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>) object that defines the e-mail message.</td>
</tr>
<tr valign=top>
<td width=36%><i>object2</i></td>
<td width=64%>TNEF data (<b>MSMQMailTnefData</b>) object that represents the text message.</td>
</tr>
</table><br>
<h4>Settings</h4>
<p>
A variant that contains the <a href="msmqglos_3wvo.htm#_mq_tnef_gly">TNEF</a> data of the e-mail. The data in the variant should be an array of bytes representing the TNEF data.</p>
<p>
TNEF is a MAPI internal format that encapsulates the MAPI properties and is used by the MSMQ Mail services (the MSMQ Exchange Connector and the MSMQ MAPI Transport) to send mail to recipients who are defined as <a href="msmqglos_3wvm.htm#_mq_rich_text_recipient_gly">rich-text recipients</a>. These recipients have selected the check box labeled "Send to this recipient in Microsoft Exchange rich text format" in their Exchange/MAPI address.</p>
<h4>Example</h4>
<p>
This example defines an e-mail object as a TNEF message, setting the TNEF message body to a predefined variant value that should be filled by MAPI or taken from another TNEF message. The e-mail object is then used to compose the body of a mail message, and a message box displays the size of the TNEF data (the data itself is binary and is not supposed to be readable).</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim email As New MSMQMailEMail
Dim msg As New MSMQMessage

Private Sub Form_Click()

   '***********************
   '*  Define e-mail object
   '***********************
   
   'Set e-mail type to TNEF message
   email.ContentType = MSMQMAIL_EMAIL_TNEF
   
   'Add Recipients
   email.Recipients.Add "Connector Recipient Name", "ExchangeUser@ServerInputQueueLabel", MSMQMAIL_RECIPIENT_TO
   email.Recipients.Add "MAPI Recipient Name", "MAPIUserInputQueueLabel", MSMQMAIL_RECIPIENT_CC

'Set the TNEF information of the e-mail.
   email.TnefData.Data = tnefdata
   
   '**********************
   '* Compose message Body
   '**********************
   msg.Body = email.ComposeBody

   '****************************
   '* Display size of TNEF data.
   '****************************
   MsgBox "The size of the TNEF data is:" + (UBound(email.TnefData.Data) - LBound(email.TnefData.Data) + 1)

End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in mqmailoa.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_7fxg.htm"><b>Add</b></a>, <a href="mqactx_9cqb.htm"><b>Address</b></a>, <a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_1y0p.htm"><b>ComposeBody</b></a>, <a href="mqactx_1q05.htm"><b>ContentType</b></a>, <a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_9411.htm"><b>Name</b></a>, <a href="mqactx_7r3n.htm"><b>Recipients</b></a>, <a href="mqactx_6h4i.htm"><b>Sender</b></a>, <a href="mqactx_78ac.htm"><b>Subject</b></a>, <a href="mqactx_5469.htm"><b>TextMessageData</b></a></p>
<p>&nbsp;</p></body>
</HTML>
