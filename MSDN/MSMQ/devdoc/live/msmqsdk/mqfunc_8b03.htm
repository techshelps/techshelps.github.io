<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MQGetQueueProperties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_mqgetqueueproperties"></a>MQGetQueueProperties</h1>
<p>
The <b>MQGetQueueProperties</b> function retrieves the specified set of properties for a specific queue.</p>
<pre><code><b>HRESULT APIENTRY MQGetQueueProperties(
  LPCWSTR</b><i> lpwcsFormatName</i><b>,  </b>
<b>  MQQUEUEPROPS </b><i>*pQueueProps </i> 
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpwcsFormatName</i></dt>
<dd>
[in] Pointer to the format name string of the queue whose properties will be retrieved. The queue must be specified using a public or private format name. You cannot specify a queue using a direct format name.</dd>
<dt>
<i>pQueueProps</i></dt>
<dd>
[in, out] Pointer to the <a href="mqstruc_2ygj.htm"><b>MQQUEUEPROPS</b></a> structure where the properties are specified.
<p>
On input, the <b>cProp</b> member of <b>MQQUEUEPROPS</b> specifies the number of properties to be retrieved, and the <b>aPropID </b>array specifies the specific properties.

<p>
On output, the <b>aPropVar</b> array indicates the current values of the requested properties, and the optional <b>aStatus</b> array indicates their status (to use the property status array, include <b>aStatus</b> in <b>MQQUEUEPROPS</b> declaration).

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MQ_OK</dt>
<dd>
Indicates success.</dd>
<dt>
MQ_ERROR_ACCESS_DENIED</dt>
<dd>
The process does not have the correct access rights to get the queue's properties. For a complete list of queue access rights, see <a href="msmq_guide_8i0c.htm">Access Control</a>.
<p>
To change access rights, call <a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a>.
</dd>
<dt>
MQ_ERROR_ILLEGAL_FORMATNAME</dt>
<dd>
The <i>lpwcsFormatName </i>parameter specified an illegal format name.</dd>
<dt>
MQ_ERROR_ILLEGAL_PROPERTY_VT </dt>
<dd>
The variant type of a property does not match the expected variant type. For example, for <a href="mqprop_5011.htm">PROPID_Q_TYPE</a>, the expected variant types are VT_NULL or VT_CLSID. For <a href="mqprop_0pt1.htm">PROPID_Q_PATHNAME</a> and <a href="mqprop_7830.htm">PROPID_Q_LABEL</a>, the expected variant type is VT_NULL.</dd>
<dt>
MQ_ERROR_NO_DS</dt>
<dd>
Cannot access <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>.</dd>
<dt>
MQ_ERROR_PROPERTY</dt>
<dd>
One or more properties resulted in an error.</dd>
<dt>
MQ_ERROR_SERVICE_NOT_AVAILABLE</dt>
<dd>
Cannot connect to the Queue Manager.</dd>
<dt>
MQ_ERROR_UNSUPPORTED_FORMATNAME_OPERATION</dt>
<dd>
The <i>lpwcsFormatName </i>parameter specified a direct format name. You cannot get properties from a queue by accessing it directly.</dd>
<dt>
MQ_INFORMATION_DUPLICATE_PROPERTY</dt>
<dd>
The same property appears more than once in the <b>aPropID </b>array. This information is returned on the second appearance of the property.</dd>
<dt>
MQ_INFORMATION_PROPERTY</dt>
<dd>
One or more of the properties resulted in a warning code even though the function was completed.</dd>
<dt>
MQ_INFORMATION_UNSUPPORTED_PROPERTY</dt>
<dd>
Not a valid property identifier. The property is ignored.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The properties of a public queue can be retrieved at any time; however, you can only retrieve the properties of a private queue if it is located on your local computer.</p>
<p>
If the format name of the queue is unknown, see <a href="msmq_guide_1sbp.htm">Format Name</a> to find ways to obtain a new format name.</p>
<p>
To retrieve the queue's pathname (<a href="mqprop_0pt1.htm">PROPID_Q_PATHNAME</a>) or label (<a href="mqprop_7830.htm">PROPID_Q_LABEL</a>), the corresponding property's variant type must be initially set to VT_NULL so that MSMQ knows to allocate memory for the returned value. After using the retrieved value, the application must then call <a href="mqfunc_02gp.htm"><b>MQFreeMemory</b></a><b> </b>to free the memory allocated by MSMQ.</p>
<p>
To retrieve the queue's identifier (<a href="mqprop_80th.htm">PROPID_Q_INSTANCE</a>) or type (<a href="mqprop_5011.htm">PROPID_Q_TYPE</a>), a buffer of type CLSID must be declared to hold the returned GUID.</p>
<p>
A public queue's properties cannot be retrieved if there is no connection to <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>. This restriction applies to <a href="msmqglos_3wv8.htm#_mq_dependent_client_gly">dependent client</a> computers, <a href="msmqglos_3wvd.htm#_mq_independent_client_gly">independent client</a> computers (working offline), and MSMQ routing servers (FRS).</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>For information on…</th>
<th align=left width=52%>See…</th>
</tr>
<tr valign=top>
<td width=48%>Offline operations</td>
<td width=52%><a href="msmq_guide_72es.htm">MSMQ Offline Support</a></td>
</tr>
<tr valign=top>
<td width=48%>A complete set of examples</td>
<td width=52%><a href="msmquse_13e1.htm">Retrieving a Queue's Properties</a></td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_02gp.htm"><b>MQFreeMemory</b></a>, <a href="mqprop_7830.htm">PROPID_Q_LABEL</a>, <a href="mqprop_0pt1.htm">PROPID_Q_PATHNAME</a> </p>
<p>&nbsp;</p></body>
</HTML>
