<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending MSMQ Mail Message to a MAPI Client</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mq_sending_msmq_mail_message_to_a_mapi_client"></a>Sending MSMQ Mail Message to a MAPI Client</h3>
<p>
MSMQ mail messages sent to a MAPI client are sent to the client's MAPI user input queue and routed through the MAPI Transport Provider where they are translated. Then they are sent to the Inbox of the appropriate MAPI client. See the following illustration.</p>
<p>
<img src="images/mapi2.gif" border=0></p>
<p>
When an MSMQ message is sent to a MAPI client, the MAPI Transport Provider performs the following functions:
<ul>
<li>
Creates a MAPI <a href="msmqglos_3wvp.htm#_mq_user_input_queue_gly">user input queue</a> for the MAPI user. This queue is created just once by the MSMQ MAPI Transport Provider. However, the MAPI user input queue is not used when sending information in the other direction (when MAPI clients send e-mail to an MSMQ application).</li>
<li>
Translates the MSMQ <a href="msmqglos_3wvh.htm#_mq_mail_message_gly">mail message</a> into an <a href="msmqglos_3wv9.htm#_mq_e_mail_message_gly">e-mail form</a>.</li>
<li>
Sends the e-mail form to the Inbox for the MAPI application.</li>
</ul>
<p>
The MSMQ application must know the MAPI address of the client where it sends the messages. </p>
<p>
Additional information about MAPI tasks can be found in the following:
<ul>
<li>
To create an address for the MAPI client, see <a href="mqmapimn_410y.htm#_mq_creating_mapi_addresses">Creating MAPI Addresses</a>.</li>
<li>
To see how e-mail forms are sent to MSMQ applications, see <a href="mqmapimn_2fce.htm">Sending E-mail to an MSMQ Application</a>.</li>
<li>
To set up the MAPI Transport Provider, see <a href="mqmapimn_410y.htm">Setting Up the MSMQ MAPI Transport Provider</a>.</li>
<li>
To install the MSMQ Mail SDK, see <a href="mqmapimn_9dd7.htm">MSMQ Mail SDK</a>.</li>
<li>
To use the API functions and ActiveX components provided by the MSMQ Mail SDK, see the reference page for each item. They can be located by name or in <a href="mqfunc_8tpv.htm">MSMQ Mail Functions</a> and <a href="mqactx_46wj.htm">MSMQ Mail ActiveX Components</a>.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
