<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FormatName</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_formatname"></a>FormatName<br>
<a href="mqactx_01nz.htm">MSMQQueueInfo</a></h1>
<p>
The <b>FormatName</b> property specifies the format name of the queue. This property must be set before the queue is opened.</p>
<p>
When creating a queue, if a format name is not provided by the application, MSMQ generates one from the queue's MSMQ pathname (<a href="mqactx_823p.htm"><b>PathName</b></a>). After the queue is created, you can use the name generated by MSMQ or specify a different one.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><b>String</b></td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>read/write</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>FormatName</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>The queue (<b>MSMQQueueInfo</b>) object in question.</td>
</tr>
</table><br>
<h4>Settings</h4>
<p>
String. Possible strings are:</p>
<pre><code>PUBLIC=<a href="msmqglos_3wvl.htm#_mq_queueguid_gly">QueueGUID</a>
DIRECT=Protocol:MachineAddress\QueueName
DIRECT=OS:MachineName\QueueName
PRIVATE=<a href="msmqglos_3wvh.htm#_mq_machineguid_gly">MachineGUID</a>\<a href="msmqglos_3wvl.htm#_mq_queuenumber_gly">QueueNumber</a>
 </code></pre>
<h4>Remarks</h4>
<p>
The <b>FormatName</b> property must be specified to open the queue. MSMQ uses the queue's format name to identify which queue to open and how to access the opened queue. A queue's format name cannot be changed while the queue is open.</p>
<p>
For information on how MSMQ uses format names, see <a href="msmq_guide_1sbp.htm">Format Name</a>.</p>
<h4>Example</h4>
<p>
This example creates a private queue on the local computer, and then opens the queue with the format name provided by MSMQ. To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
Dim q As MSMQQueue

Private Sub Form_Click()
    
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\PRIVATE$\FormatNameTest"
  qinfo.Label = "Test Queue"
  qinfo.Create
  
  MsgBox "Queue format name is: " + qinfo.FormatName
   
  Set q = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
  
  On Error GoTo ErrorHandler

End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_7bqm.htm"><b>IsOpen</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
