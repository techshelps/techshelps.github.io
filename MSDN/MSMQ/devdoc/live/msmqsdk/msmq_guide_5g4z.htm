<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSMQ Transactions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_msmq_transactions"></a>MSMQ Transactions</h1>
<p>
The following illustration shows how transactions are used by the sending and receiving applications. In this model, MSMQ uses two transactions: one to send messages to the queue and the other to retrieve messages from the queue.</p>
<p>
<img src="images/guide3.gif" border=0></p>
<p>
In this model, the sending transaction can commit to sending the messages to the queue, and the receiving application can commit to retrieving the messages; MSMQ provides its own confirmation process to notify the sending application that either the messages were retrieved from the queue or why the receiving application failed to retrieve them.</p>
<p>
<b>Note</b>&nbsp;&nbsp;A single transaction can contain both transaction send and receive calls.</p>
<p>
MSMQ provides several ways to send and receive messages through transactions. Transactions can be called either explicitly by providing pointers to a transaction object, or implicitly, directing MSMQ to find the appropriate transaction object.</p>
<p>
Transactions that can be explicitly called include MSMQ internal transactions and the Microsoft® Distributed Transaction Coordinator (MS DTC) external transactions. For information on these transactions, see:
<ul>
<li>
<a href="msmq_guide_5q0j.htm">MSMQ Internal Transactions</a> </li>
<li>
<a href="msmq_guide_0ltf.htm">MS DTC External Transactions</a> </li>
</ul>
<p>
Transactions that can be implicitly called include the current Microsoft® Transaction Server™ (MTS) and current XA transactions. The current MTS or XA transaction is only used if it is available. In these cases, MSMQ decides (with the help of MTS or MS DTC) whether the call will truly be part of a transaction. For information on these transactions, see:
<ul>
<li>
<a href="msmq_guide_6mwj.htm">MTS Transactions</a> </li>
<li>
<a href="msmq_guide_0ulv.htm">XA-Compliant Transactions</a> </li>
</ul>
<p>&nbsp;</p></body>
</HTML>
