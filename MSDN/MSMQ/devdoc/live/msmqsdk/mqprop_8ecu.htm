<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_RESP_QUEUE_LEN</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_resp_queue_len"></a>PROPID_M_RESP_QUEUE_LEN</h1>
<p>
The PROPID_M_RESP_QUEUE_LEN property indicates the length (in Unicode characters) of the response queue buffer.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_UI4</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
ulVal</dd>
<dt>
Property Values</dt>
<dd>
Length (in Unicode characters) of the response queue buffer.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The PROPID_M_RESP_QUEUE_LEN property is used only by the receiving application when checking if a response message is expected or when the sending application has passed the format name of a private queue to the receiving application.</p>
<p>
To find the format name of the response queue or private queue, pass <a href="mqprop_204l.htm">PROPID_M_RESP_QUEUE</a> and PROPID_M_RESP_QUEUE_LEN to <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>.</p>
<p>
On input, PROPID_M_RESP_QUEUE_LEN specifies the length of the format name buffer (in Unicode characters) allocated by the receiving application. The buffer should be large enough to hold the format name string including the null-terminating character.</p>
<p>
On return, this property holds the length (in Unicode characters) of the PROPID_M_RESP_QUEUE format name string including the null-terminating character.</p>
<p>
<b>MQReceiveMessage</b> succeeds if the buffer is large enough to hold the format name of the <a href="msmqglos_3wvm.htm#_mq_response_queue_gly">response queue</a>. <b>MQReceiveMessage</b> fails if the buffer is not large enough to hold the format name and PROPID_M_RESP_QUEUE_LEN is set to the required buffer length of the if format name string.</p>
<h4>Example</h4>
<p>
The following example allocates a buffer of size 60 characters for the format name of the response queue and then sets the PROPID_M_RESP_QUEUE and PROPID_M_RESP_QUEUE_LEN properties.</p>
<pre><code>MQMSGPROPS MsgProps;
PROPVARIANT aVariant[10];
MSGPROPID aPropId[10];
DWORD PropIdCount = 0;

HRESULT hr;
QUEUEHANDLE hQueue;

//
// Prepare the PROPVARIANT array.
// 

#define RESP_QUEUE_BUFF_LEN     = 60
WCHAR szwRespQueueFormatName[RESP_QUEUE_BUFF_LEN];

//
// Set the PROPID_M_RESP_QUEUE property.
//
aPropId[PropIdCount] = PROPID_M_RESP_QUEUE;     //Property identifier.
aVariant[PropIdCount].vt = VT_LPWSTR;           //Property type.
aVariant[PropIdCount].pwszVal = szwRespQueueFormatName;   //Allocated buffer.
PropIdCount++;

//
// Set the PROPID_M_RESP_QUEUE_LEN property.
//
aPropId[PropIdCount] = PROPID_M_RESP_QUEUE_LEN; //Property identifier.
aVariant[PropIdCount].vt = VT_UI4;              //Property type.
aVariant[PropIdCount].ulVal = RESP_QUEUE_BUFF_LEN;   //Property value.
PropIdCount++;

//
// Set the MQMSGPROPS structure.
//
MsgProps.cProp = PropIdCount;       //Number of properties.
MsgProps.aPropID = aPropId;         //Id of properties.
MsgProps.aPropVar = aVariant;       //Value of properties.
MsgProps.aStatus  = NULL;           //No Error report.
 
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqprop_204l.htm">PROPID_M_RESP_QUEUE</a> </p>
<p>&nbsp;</p></body>
</HTML>
