<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_RESP_QUEUE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_resp_queue"></a>PROPID_M_RESP_QUEUE</h1>
<p>
The PROPID_M_RESP_QUEUE property specifies the queue where application-generated response messages are returned.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_LPWSTR</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
pwszVal</dd>
<dt>
Property Values</dt>
<dd>
Format name of the response queue (the default is none).
</dd>
</dl>
<h4>Remarks</h4>
<p>
PROPID_M_RESP_QUEUE is used to send the format name of another queue to the receiving application. Typically, this is done so that the receiving application can send response messages back to the sending application. For information on response queues, see <a href="msmq_guide_8ib7.htm">Response Queues</a>. </p>
<p>
<b>Note</b>&nbsp;&nbsp;The format name of a private queue (which would be inaccessible otherwise) can also be sent using PROPID_M_RESP_QUEUE.</p>
<p>
Messages returned to the queue are application defined. The application must define what is in the messages, as well as what is to be done when a message is received.</p>
<p>
To request a response message, pass PROPID_M_RESP_QUEUE to <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>, specifying the queue that will receive the response message.</p>
<p>
To check if a response message is required, pass PROPID_M_RESP_QUEUE and <a href="mqprop_8ecu.htm">PROPID_M_RESP_QUEUE_LEN</a> to <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>. If the returned value of PROPID_M_RESP_QUEUE is not NULL, send the response message to the returned queue. If the returned value is NULL a response is not needed.</p>
<p>
PROPID_M_RESP_QUEUE can also be used to send the format name of a private queue to another application. This is typically done when the sending application wants to make a private queue available to other applications.</p>
<h4>Example</h4>
<p>
The following example sets PROPID_M_RESP_QUEUE as part of preparing MQMSGPROPS.</p>
<pre><code>MQMSGPROPS MsgProps;
PROPVARIANT aVariant[10];
MSGPROPID aPropId[10];
DWORD PropIdCount = 0;

HRESULT hr;

QUEUEHANDLE hQueue;

//
// Set the PROPID_M_RESP_QUEUE property.
//
aPropId[PropIdCount] = PROPID_M_RESP_QUEUE;   //Property identifier.
aVariant[PropIdCount].vt = VT_LPWSTR;         //property type.
aVariant[PropIdCount].pwszVal = szwRESPFormatName;  //An already obtained format name of the response queue.

PropIdCount++;

//
// Set other message properties such as PROPID_M_BODY, PROPID_M_LABEL.
//



//
// Set the MQMSGPROPS structure
//
MsgProps.cProp = PropIdCount;       //Number of properties.
MsgProps.aPropID = aPropId;         //Id of properties.
MsgProps.aPropVar = aVariant;       //Value of properties.
MsgProps.aStatus  = NULL;           //No Error report.
 


//
// Send message.
//
hr = MQSendMessage(
     hQueue,                  // handle to the Queue.
     &amp;MsgProps,               // Message properties to be sent.
     MQ_NO_TRANSACTION        // No transaction
     );

if (FAILED(hr))
   {
    //
    // Handle error condition
    //
    }
 
</code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>, <a href="mqprop_8ecu.htm">PROPID_M_RESP_QUEUE_LEN</a> </p>
<p>&nbsp;</p></body>
</HTML>
