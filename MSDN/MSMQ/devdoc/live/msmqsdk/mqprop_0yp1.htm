<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_ADMIN_QUEUE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_admin_queue"></a>PROPID_M_ADMIN_QUEUE</h1>
<p>
The PROPID_M_ADMIN_QUEUE property specifies the <a href="msmqglos_3wv5.htm#_mq_administration_queue_gly">administration queue</a> used for MSMQ-generated acknowledgment messages.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_LPWSTR</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
pwszVal</dd>
<dt>
Property Values</dt>
<dd>
Format name of administration queue.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The administration queue can be any non-transaction queue. The acknowledgment messages sent to the queue can indicate if the original message reached its destination queue or is read from the queue. Acknowledgment messages are generated and sent by MSMQ. For more information,<b> </b>see <a href="msmq_guide_804z.htm">Administration Queues</a>.</p>
<p>
To request acknowledgment messages, pass <a href="mqprop_9411.htm">PROPID_M_ACKNOWLEDGE</a> and PROPID_M_ADMIN_QUEUE to <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>.</p>
<p>
To find out which queue is being used as the <a href="msmqglos_3wv5.htm#_mq_administration_queue_gly">administration queue</a>, pass PROPID_M_ADMIN_QUEUE and <a href="mqprop_601a.htm">PROPID_M_ADMIN_QUEUE_LEN</a> to <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a> and examine the returned values.</p>
<p>
To see how PROPID_M_ADMIN_QUEUE is used when sending messages, see <a href="msmquse_9fu1.htm">Sending Messages that Request Acknowledgments</a>.</p>
<h4>Example</h4>
<p>
The following example sets PROPID_M_ACKNOWLEDGE and PROPID_M_ADMIN_QUEUE as part of preparing MQMSGPROPS.</p>
<pre><code>MQMSGPROPS MsgProps;
PROPVARIANT aVariant[10];
MSGPROPID aPropId[10];
DWORD PropIdCount = 0;

HRESULT hr;

QUEUEHANDLE hQueue;

//
// Set PROPID_M_ACKNOWLEDGE.
//
aPropId[PropIdCount] = PROPID_M_ACKNOWLEDGE;           //PropId
aVariant[PropIdCount].vt = VT_UI1;                     //Type
aVariant[PropIdCount].bVal = MQMSG_ACKNOWLEDGMENT_FULL_RECEIVE; //Value

PropIdCount++;

//
// Set the PROPID_M_ADMIN_QUEUE property.
//
aPropId[PropIdCount] = PROPID_M_ADMIN_QUEUE;         //PropId
aVariant[PropIdCount].vt = VT_LPWSTR;                //Type
aVariant[PropIdCount].pwszVal = szwAdminFormatName;  //An already obtained format name of the admin queue.

PropIdCount++;

//
// Set other message properties such as PROPID_M_BODY, PROPID_M_LABEL.
//



//
// Set the MQMSGPROPS structure
//
MsgProps.cProp = PropIdCount;       //Number of properties.
MsgProps.aPropID = aPropId;         //Ids of properties.
MsgProps.aPropVar = aVariant;       //Values of properties.
MsgProps.aStatus  = NULL;           //No Error report.
 


//
// Send message.
//
hr = MQSendMessage(
     hQueue,                  // handle to the Queue.
     &amp;MsgProps,               // Message properties to be sent.
     MQ_NO_TRANSACTION        // No transaction
     );

if (FAILED(hr))
   {
    //
    // Handle error condition
    //
    }
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>, <a href="mqprop_9411.htm">PROPID_M_ACKNOWLEDGE</a>, <a href="mqprop_601a.htm">PROPID_M_ADMIN_QUEUE_LEN</a> </p>
<p>&nbsp;</p></body>
</HTML>
