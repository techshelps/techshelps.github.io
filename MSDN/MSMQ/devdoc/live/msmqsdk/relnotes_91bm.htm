<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Upgrading from Beta2</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_upgrading_from_beta2"></a>Upgrading from Beta2</h2>
<p>
The following modifications were made to the ActiveX object model between Beta2 and Beta2E preliminary releases. These changes are relevant to Beta2 clients who are upgrading directly from Beta2 to MSMQ 1.0.</p>
<h4>MSMQQueue</h4>
<ul>
<li>
New <a href="mqactx_5i0k.htm"><b>PeekCurrent</b></a> method: This new method reads the message at the current cursor position.</li>
<li>
lReceiveTimeout is no longer a property: This property is now a parameter for <a href="mqactx_0otn.htm"><b>Peek</b></a>, <a href="mqactx_4igk.htm"><b>PeekNext</b></a>, <a href="mqactx_5i0k.htm"><b>PeekCurrent</b></a>, <a href="mqactx_80dh.htm"><b>Receive</b></a>, <a href="mqactx_699w.htm"><b>ReceiveCurrent</b></a>, and <a href="mqactx_10ha.htm"><b>EnableNotification</b></a>.</li>
<li>
New <a href="mqactx_699w.htm"><b>ReceiveCurrent</b></a> method: This replaces ReceiveNext, which has been removed.</li>
<li>
<b>ReceiveCurrent</b>, <b>PeekCurrent</b>, and <b>PeekNext</b> all use the implied cursor. <b>Peek</b> and <b>Receive</b> do not.</li>
<li>
<b>EnableNotification</b> has new MQMSG enumeration parameters: MQMSG_FIRST, MQMSG_CURRENT or MQMSG_NEXT.<ul>
<li>
MQMSG_FIRST: This user-defined event handler is invoked whenever there is a message in queue or a time-out occurs. The cursor is not used.</li>
<li>
MQMSG_CURRENT: This user-defined event handler is invoked whenever there is a message at the current cursor position or a time-out occurs.</li>
<li>
MQMSG_NEXT: This user-defined event handler is invoked whenever there is a message at the (new) cursor position or a time-out occurs. The cursor is advanced. </li>
</ul>
</li>
<li>
<b>DisableNotification</b> has been removed.</li>
<li>
Synchronous read methods <b>Peek</b>, <b>PeekNext</b>, <b>PeekCurrent</b>, <b>Receive</b>, and <b>ReceiveCurrent</b> no longer use the MQ_ERROR_IO_TIMEOUT error. Instead, a NULL message object is returned if a time-out occurs. Use the following idiom to test for the end of the queue: "not msg is nothing". </li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;Asynchronous read methods still can use the MQ_ERROR_IO_TIMEOUT error (the MSMQEvent.ArrivedError event handler is invoked).</p>
<h4>MSMQQuery</h4>
<ul>
<li>
<a href="mqactx_85np.htm"><b>LookupQueue</b></a> takes additional optional restriction parameters:<br>
CreateTime (RelCreateTime) and ModifyTime (RelModifyTime). </li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;The default REL_EQ relational operator is not very useful for these two parameters.</p>
<h4>MSMQMessage</h4>
<ul>
<li>
The body property can now be any intrinsic <b>Variant</b>, including date, currency, and numbers (in addition to strings, byte arrays, and persistent objects).</li>
<li>
New properties <a href="mqactx_1l7p.htm">SentTime</a> and <a href="mqactx_665h.htm">ArrivedTime</a> are <b>Variant</b> dates instead of lSentTime and lArrivedTime, which have been removed.</li>
<li>
New <a href="mqactx_7ab8.htm"><b>AttachCurrentSecurityContext</b></a> method replaces lSecurityContext property.</li>
</ul>
<h4>MSMQQueueInfo</h4>
<ul>
<li>
New properties: <a href="mqactx_7rqd.htm"><b>CreateTime</b></a> and <a href="mqactx_3uhx.htm"><b>ModifyTime</b></a> are <b>Variant</b> dates. Use these properties instead of lCreateTime, strCreateTime, lModifyTime and strModifyTime, which have been removed.</li>
<li>
New <a href="mqactx_6605.htm"><b>Create</b></a> optional parameter: <i>IsWorldReadable</i>. The default is False. The default MSMQ security is used where all users can send to the queue, but only the owner can read from the queue. When True, any user can read from the queue.</li>
<li>
New Boolean read-only property: <a href="mqactx_4iqt.htm">IsWorldReadable</a>. True indicates that everyone can read from the queue. False indicates that only the owner can read messages from the queue. </li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;The IsWorldReadable property is not cached because other applications can dynamically change the state of the queue.</p>
<h4>MSMQCoordinatedTransactionDispenser</h4>
<ul>
<li>
This is simply a renaming of the old MSMQTransactionDispenser. This object dispenses MS DTC transactions.</li>
</ul>
<h4>MSMQTransactionDispenser</h4>
<ul>
<li>
A new object that dispenses MSMQ-only transactions. </li>
</ul>
<h4>MSMQTransaction</h4>
<ul>
<li>
A new read-only property: Transaction. It exposes the actual ITransaction* magic cookie internally used by the <a href="mqactx_2k6m.htm">BeginTransaction</a> method from either of the dispenser objects. This property can be used to pass to other components such as Microsoft SQL Server. </li>
</ul>
<h4>Transactions with Microsoft Transaction Server (MTS)</h4>
<p>
When sending messages to a transactional queue, the <a href="mqactx_54px.htm"><b>MSMQMessage</b></a> object's <a href="mqactx_7k2s.htm"><b>Send</b></a> method takes an optional <a href="mqactx_9c8e.htm"><b>MSMQTransaction</b></a> object parameter. The parameter can be one of the following:
<ul>
<li>
An actual <b>MSMQTransaction</b> object, as obtained from <b>BeginTransaction</b>.</li>
<li>
If no parameter is supplied, any current MTS transactions will be used.</li>
<li>
MQ_NO_TRANSACTION: This is an error if the target queue is transactional. Otherwise, it overrides the default MTS transaction.</li>
<li>
MQ_XA_TRANSACTION: Uses current default XA transaction, if any.</li>
<li>
MQ_MTS_TRANSACTION: Explicitly uses the current MTS transaction.</li>
<li>
MQ_SINGLE_MESSAGE: Uses internal MSMQ transaction semantics for the message.</li>
</ul>
<h4>MSMQApplication Object</h4>
<ul>
<li>
New object: "application object." A single instance of this class is automatically created by MSMQ. Its methods are all in the global name space (that is, they do not require object qualification). </li>
<li>
Its only current method, <a href="mqactx_989x.htm"><b>MachineIdOfMachineName</b></a>, is used to construct the format name of a computer journal queue so that it can be opened.</li>
</ul>
<h4>MSMQMailTnefData Object</h4>
<ul>
<li>
New object that defines a TNEF message. The <a href="mqactx_8ns1.htm"><b>MSMQMailTnefData</b></a> object has a single <a href="mqactx_2xnl.htm"><b>Data</b></a> property and no methods.</li>
</ul>
<h4>MSMQMailDeliveryReportData Object</h4>
<ul>
<li>
New object that defines an application-generated delivery report: The <a href="mqactx_7zs1.htm"><b>MSMQMailDeliveryReportData</b></a> object has the following properties.<pre><code>MSMQMailDeliveryReportData.<a href="mqactx_1mcz.htm">DeliveredRecipients</a>
MSMQMailDeliveryReportData.<a href="mqactx_5xys.htm">OriginalSubject</a>
MSMQMailDeliveryReportData.<a href="mqactx_855x.htm">OriginalSubmissionTime</a>
 </code></pre>
</li>
</ul>
<h4>MSMQMailNonDeliveryReportData Object</h4>
<ul>
<li>
New object that defines a non-delivery report: The <a href="mqactx_4msh.htm"><b>MSMQMailNonDeliveryReportData</b></a> object has the following properties.<pre><code>MSMQMailDeliveryReportData.<a href="mqactx_1xtf.htm">NonDeliveredRecipients</a>
MSMQMailDeliveryReportData.<a href="mqactx_5d4c.htm">OriginalEMail</a>
 </code></pre>
</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
