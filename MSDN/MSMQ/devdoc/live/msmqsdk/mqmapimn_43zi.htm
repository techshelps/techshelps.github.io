<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Header Section</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mq_header_section"></a>Header Section</h3>
<p>
The header section is composed of several headers with each header on a separate line (each line is terminated by a CR/LF pair). Each header is composed of a header name followed by a colon and a header value (for example, <i>Subject</i>: <i>message subject</i>).</p>
<p>
The following table describes the headers that are used.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Header Name</th>
<th align=left width=66%>Description</th>
</tr>
<tr valign=top>
<td width=34%>MIME-Version</td>
<td width=66%>Describes the MIME version used. It should contain the value 1.0.<p>
Example: <i>MIME-Version: 1.0</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>Date</td>
<td width=66%>Indicates the time the message was submitted by the sender. It is formatted as {<i>sender-local-date</i>} {<i>sender-local-time</i>} {<i>sender-local-time-zone</i>}.<p>
Example: <i>Date: 21 Jul 1996 20:12:06-0300</i></p>
<p>
Month names: <i>Jan</i>, <i>Feb</i>, <i>Mar</i>, <i>Apr</i>, <i>May</i>, <i>Jun</i>, <i>Jul</i>, <i>Aug</i>, <i>Sep</i>, <i>Oct</i>, <i>Nov</i>, and <i>Dec</i></p>
<p>
Time zones should be numeric and prefixed with a "–" (minus sign) or a "+" (plus sign); that is, no named time zones.</p>
</td>
</tr>
<tr valign=top>
<td width=34%>From</td>
<td width=66%>Indicates the sender of the message. <p>
For applications using the Exchange Connector, this header is formatted as {sender-friendly-name&lt;user-email-alias@server-input-queue-label&gt;}; where the user e-mail alias is the user's alias in the Microsoft Exchange system (corresponds to the PR_ACCOUNT property of the user) and server-input-queue-label is the label of the Exchange Connector's input queue.</p>
<p>
Example: <i>From: Jane Doe &lt;janedoe@Exchangeserverinputqueue&gt;</i></p>
<p>
For applications using the MAPI Transport Provider, it is formatted as {<i>sender-friendly-name</i> &lt;<i>sender-queue-label</i>&gt;}. Where the <i>sender-queue-label</i> is the MSMQ queue label associated with the sender.</p>
<p>
Example: <i>From: John Doe &lt;johndoe&gt;</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>Subject</td>
<td width=66%>Indicates the subject of the message. The subject text is not formatted.<p>
Example: <i>Subject: message subject</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>To</td>
<td width=66%>Lists each message recipient separated by a comma. Each recipient is formatted as <i>{recipient-friendly-name &lt;recipient-address&gt;}</i>. <p>
For the MSMQ MAPI Transport Provider, the recipient address is the label of the MAPI <a href="msmqglos_3wvp.htm#_mq_user_input_queue_gly">user input queue</a> associated with the recipient.</p>
<p>
Example: <i>To: John Doe&lt;johndoe&gt;</i></p>
<p>
For the MSMQ Exchange Connector, the recipient name includes the user name plus the label of the Exchange Connector's <a href="msmqglos_3wvn.htm#_mq_server_input_queue_gly">server input queue</a>.</p>
<p>
Example: <i>To: Jane Doe&lt;janedoe@ServerInputQueueLabel&gt;</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>Cc</td>
<td width=66%>Optional. Lists the copied message recipients separated by a comma. Each recipient is formatted as <i>{recipient-friendly-name &lt;recipient-address&gt;}</i>. <p>
For the MSMQ MAPI Transport Provider, the recipient address is the label of the MAPI <a href="msmqglos_3wvp.htm#_mq_user_input_queue_gly">user input queue</a> associated with the recipient.</p>
<p>
Example: <i>To: John Doe&lt;johndoe&gt;</i></p>
<p>
For the MSMQ Exchange Connector, the recipient name includes the user name plus the label of the Exchange Connector's <a href="msmqglos_3wvn.htm#_mq_server_input_queue_gly">server input queue</a>.</p>
<p>
Example: <i>To: Jane Doe&lt;janedoe@ServerInputQueueLabel&gt;</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>Bcc</td>
<td width=66%>Optional. Lists the hidden copied message recipients separated by a comma. Each recipient is formatted as <i>{recipient-friendly-name &lt;recipient-address&gt;}</i>. <p>
For the MSMQ MAPI Transport Provider, the recipient address can be the MSMQ queue label associated with the recipient.</p>
<p>
Example: <i>Bcc: John Doe&lt;johndoe&gt;</i></p>
<p>
For MSMQ Exchange Connector, the recipient name includes the user name plus the MSMQ queue label of the connector's queue.</p>
<p>
Example: <i>Bcc: Jane Doe&lt;janedoe@ExchangeConnectorQueueLabel&gt;</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>Content-Type</td>
<td width=66%>Optional. Describes the content of the body section of the message. It can have one of the following values (the default is "text/plain; charset=us-ascii"):<p>
<i>text/plain; charset=us-ascii</i></p>
<p>
This means that this is a regular message, and the body section contains the message text.</p>
<p>
Example: <i>Content-Type: text/plain; charset=us-ascii</i></p>
<p>
<i>application/x-ms-tnef</i></p>
<p>
This means that this is a TNEF message and the body section contains the TNEF data of the message.</p>
<p>
Example: <i>Content-Type: application/x-ms-tnef</i></p>
<p>
<i>multipart/form-data; boundary=boundary-string</i></p>
<p>
This means that the form and body section have multiple parts, and each part describes a single form field (name, value, and so on). The boundary-string separates multiple parts in the body section (see <a href="mqmapimn_3yr2.htm">Body Section</a>).</p>
<p>
Example: <i>Content-Type: multipart/form-data;<br>
                boundary=xyz12sssdeeggg</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>Content-Transfer-Encoding</td>
<td width=66%>Describes the encoding of the body section (if it contains binary data). The only legal header value is binary (that is, no encoding of binary data).<p>
Example: <i>Content-Transfer-Encoding: binary</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>X-Form-Name</td>
<td width=66%>Name of the form whose fields are described in the body section. This header is not necessary on text messages, only on form messages.<p>
The name here corresponds to the name defined by the Exchange Form Designer (see the <b>Item Type</b> field in the <b>General</b> tab of the <b>Form Properties</b> dialog box) and the PR_MESSAGE_CLASS property of the form.</p>
<p>
Example:</p>
<p>
<i>X-Form: IPM.ORGANIZATION.SAMPLE</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>X-Delivery-Report-Requested</td>
<td width=66%>Specifies whether the receiving application should return a <a href="msmqglos_3wv8.htm#_mq_delivery_report_gly">delivery report</a> when the message is received. Valid values are True or False.<p>
Example: </p>
<p>
<i>X-Delivery-Report-Requested: True</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>X-Non-Delivery-Report-Requested</td>
<td width=66%>Specifies whether a <a href="msmqglos_3wvi.htm#_mq_non_delivery_report_gly">non-delivery report</a> should be sent back. Valid values are True or False.<p>
Example:</p>
<p>
<i>X-Non-Delivery-Report-Requested: True</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>X-Report-Date</td>
<td width=66%>Indicates the time the report was submitted.<p>
This header is only set for delivery or non-delivery report messages.</p>
<p>
It is formatted as the <i>Date</i> header mentioned previously.</p>
<p>
Example:</p>
<p>
<i>X-Report-Date: 22 Jul 1996 21:12:06 –0300</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>X-Report-To</td>
<td width=66%>Specifies the recipient of the delivery or non-delivery report.<p>
This header is set only on delivery or non-delivery report messages.</p>
<p>
It is formatted as the <i>To</i> header above but contains only one recipient.</p>
<p>
Example:</p>
<p>
<i>X-Report-To: John Doe&lt;johndoe&gt;</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>X-Report-Delivered-To<p>
X-Report-Delivered-Cc</p>
<p>
X-Report-Delivered-Bcc</p>
</td>
<td width=66%>Specifies recipients who received a previously sent mail.<p>
These headers are only set on delivery report messages.</p>
<p>
X-Report-Delivered-To specifies the delivered recipients from the To list of the original e-mail.</p>
<p>
X-Report-Delivered-Cc specifies the delivered recipients from the Cc list of the original e-mail.</p>
<p>
X-Report-Delivered-Bcc specifies the delivered recipients from the Bcc list of the original e-mail.</p>
<p>
They are formatted as the <i>To</i> header above, but contain the delivery time as well. The delivery time is formatted as the <i>Date </i>header above and appears between round brackets after the recipient's address.</p>
<p>
Example: <i>X-Report-Delivered-To: John Doe&lt;johndoe&gt;(22 Jul 1996 21:11:06 –</i><i>0300), Jane Doe&lt;</i>mailto:janedoe@ExchangeConnectorQueueLabel<i>  &gt;(21 Jul 1996 20:06:06 –</i><i>0300)</i></p>
</td>
</tr>
<tr valign=top>
<td width=34%>X-Report-Not-Delivered-To<p>
X-Report- Not-Delivered-Cc</p>
<p>
X-Report- Not-Delivered-Bcc</p>
</td>
<td width=66%>Specifies recipients who did not receive a previously sent mail.<p>
These headers are set only on non-delivery report messages.</p>
<p>
X-Report-Not-Delivered-To specifies the non-delivered recipients from the To list of the original e-mail.</p>
<p>
X-Report-Not-Delivered-Cc specifies the non-delivered recipients from the Cc list of the original e-mail.</p>
<p>
X-Report-Not-Delivered-Bcc specifies the non-delivered recipients from the Bcc list of the original e-mail.</p>
<p>
They are formatted as the X-Report-Delivered-To header above but contain the non-delivery reason instead of the delivery time.</p>
<p>
The non-delivery reason is not formatted and appears between round brackets after the recipient's address.</p>
<p>
Example: <i>X-Report-Not-Delivered-To: John Doe&lt;johndoe&gt;(Communication failure), Jane Doe&lt;</i>mailto:janedoe@ExchangeConnectorQueueLabel<i> &gt;(Recipient is not known at this address)</i></p>
</td>
</tr>
</table><br>
<p>
For samples of the MSMQ mail format, see <a href="mqmapimn_7lb9.htm">Sample Form Message</a> and <a href="mqmapimn_0bhh.htm">Sample Text Message</a>.</p>
<p>&nbsp;</p></body>
</HTML>
