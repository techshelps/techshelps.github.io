<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Moving Messages from MSMQ to Another Message Queue System</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mq_moving_messages_from_msmq_to_another_message_queue_system"></a>Moving Messages from MSMQ to Another Message Queue System</h3>
<p>
To move messages to another message queue system, the connector application must read all the messages that arrive in the <a href="msmqglos_3wv7.htm#_mq_connector_queue_gly">connector queues</a>. All transactional messages sent to foreign queues are stored in the transactional connector queue. All non-transaction messages are stored in the non-transactional connector queue. Non-transactional and transactional messages must be read from the appropriate connector queue.</p>
<p>
<b>Note</b>&nbsp;&nbsp;For foreign message properties not supported by MSMQ, use <a href="mqprop_8h4e.htm">PROPID_M_EXTENSION</a> and <a href="mqprop_1goe.htm">PROPID_M_EXTENSION_LEN</a>.</p>
<p>
To open these queues, the connector application must use a specific format name.</p>
<p>
The following example shows two <a href="mqfunc_42hx.htm"><b>MQOpenQueue</b></a> calls: the first one opens the connector's non-transaction queue, and the second opens the transaction queue.</p>
<pre><code>MQOpenQueue("CONNECTOR=<a href="msmqglos_3wva.htm#_mq_foreigncnguid_gly">ForeignCNGUID</a>",     //Special format name.
    MQ_RECEIVE,                            //Receive access.
    TRUE,                                  //Read Exclusive.
    &amp;qh                                    //Returned queue handle.
    )
 
 
MQOpenQueue("CONNECTOR=<a href="msmqglos_3wva.htm#_mq_foreigncnguid_gly">ForeignCNGUID</a>;<a href="msmqglos_3wvs.htm#_mq_xactonly_gly">XACTONLY</a>",  //Format name.
    MQ_RECEIVE,                                  //Receive access.
    TRUE,                                        //Read Exclusive.
    &amp;qh                                          //Returned handle.
    )
 </code></pre>
<p>
An application can find the ForeignCNGUID from the Foreign CN name by calling <a href="mqfunc_2ysz.htm"><b>MQGetMachineProperties</b></a> and retrieve <a href="mqprop_09wu.htm">PROPID_QM_CONNECTION</a>. </p>
<p>&nbsp;</p></body>
</HTML>
