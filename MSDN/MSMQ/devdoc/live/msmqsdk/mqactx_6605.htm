<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Create</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_create"></a>Create<br>
<a href="mqactx_01nz.htm">MSMQQueueInfo</a></h1>
<p>
The <b>Create</b> method produces a queue based on the queue properties of the <b>MSMQQueueInfo</b> object. </p>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Create</b> ([<i>IsTransactional</i>][, <i>IsWorldReadable</i>]<i>)</i>
 </code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Queue information (<b>MSMQQueueInfo</b>) object that defines queue.</td>
</tr>
<tr valign=top>
<td width=36%><i>IsTransactional</i></td>
<td width=64%>Optional (default is FALSE). BOOLEAN. When TRUE, indicates that the queue is a transaction queue. All messages sent to a transaction queue or read from a transaction queue must be done as part of a transaction.</td>
</tr>
<tr valign=top>
<td width=36%><i>IsWorldReadable</i></td>
<td width=64%>Optional (default is FALSE). BOOLEAN. When TRUE, anyone can read the messages in the queue and its <a href="msmqglos_3wvl.htm#_mq_queue_journal_gly">queue journal</a>. When FALSE, only the owner can read the messages.</td>
</tr>
</table><br>
<h4>Return Codes</h4>
<p>
For information on return codes, see <a href="mqfunc_9pgz.htm">MSMQ Error and Information Codes</a>. </p>
<h4>Remarks</h4>
<p>
You must always specify the queue's MSMQ pathname (<a href="mqactx_823p.htm"><b>PathName</b></a>) before calling <b>Create</b>. The <b>PathName</b> property tells MSMQ where to store the queue's messages, if the queue is public or private, and the name of the queue.</p>
<p>
Public queues are registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>, and private queues are registered on the local computer. All queues exist until deleted explicitly.</p>
<p>
Private queues can only be created on the local computer. The applications responsibility is to ensure that no other private queues with the same name exists on the local computer (if a queue with the same name already exists, MSMQ returns an MQ_ERROR_QUEUE_EXISTS error when <b>Create</b> is called).</p>
<p>
Setting other queue properties is optional. If a queue property is not set before <b>Create</b> is called, its default value is used when the queue is created. For a list of the queue properties that can be set by an application, see <a href="actvxuse_3u7s.htm">Creating a Queue</a>.</p>
<p>
To attach a journal to the queue, set <a href="mqactx_99nw.htm"><b>Journal</b></a> and <a href="mqactx_57c1.htm"><b>JournalQuota</b></a>. The journal keeps a copy of all messages retrieved from the queue. For information about journals, see <a href="msmq_guide_9s4z.htm">Journal Queues</a>.</p>
<p>
To create a transactional queue, set the <i>IsTransactional</i> parameter to TRUE.</p>
<p>
Typically queues are not created from <b>MSMQQueueInfo</b> objects found in a query because the queue already exists. However, you can create a new queue from an <b>MSMQQueueInfo</b> object found in a query if you delete the existing queue and then change the <a href="mqactx_823p.htm"><b>PathName</b></a> or <a href="mqactx_2k2t.htm"><b>FormatName</b></a> property of the queue.</p>
<p>
After the queue is created, the <b>MSMQQueueInfo</b> object can be opened multiple times. For example, the same <b>MSMQQueueInfo</b> object can be opened for sending messages to the queue and for reading the messages in the queue.</p>
<p>
Access control can be changed by setting <i>isWorldReadable</i>. If this parameter is not set, its default value specifies MSMQ default security. Following are the default values for the security descriptor.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Default Value</th>
<th align=left width=64%>Meaning</th>
</tr>
<tr valign=top>
<td width=36%>Owner </td>
<td width=64%>The process user.</td>
</tr>
<tr valign=top>
<td width=36%>Group </td>
<td width=64%>The process group.</td>
</tr>
<tr valign=top>
<td width=36%>DACL </td>
<td width=64%>Full control for the creator of the queue. All other processes can get queue properties, get queue security, and send messages to the queue.</td>
</tr>
<tr valign=top>
<td width=36%>SACL</td>
<td width=64%>None.</td>
</tr>
</table><br>
<p>
For information on access control, see <a href="msmq_guide_8i0c.htm">Access Control</a>. </p>
<p>
Foreign public queues (queues located outside the enterprise) are created in the same way as an MSMQ public queue. For foreign queues, the <a href="mqactx_823p.htm"><b>PathName</b></a> property specifies the name of the foreign computer as it is defined in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>. For information on foreign computers, see <a href="msmq_guide_7k8i.htm">MSMQ Connector Server</a>.</p>
<p>
When creating a public queue, some clients may not be able to see the new queue registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> even though the queue exists. Changes to Active Directory (such as creating a public queue) are propagated from domain controller to domain controller, which can cause delays in the availability of new information. Consequently, clients using a specific domain controller may not be able to open the queue, even though it exists. Propagation delays, including communication network delays such as down links, are controlled by the MSMQ Administrator.</p>
<h4>Example</h4>
<p>
This example creates a private queue on the local computer, then displays the queue's format name (the queue's format name is used to open the queue). To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
   
Private Sub Form_Click()
    
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\PRIVATE$\CreateTest"
  qinfo.Label = "Test Queue"
  qinfo.Create 
   
  MsgBox "The queue's format name is: " + qinfo.FormatName
  
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_91yk.htm"><b>IsTransactional</b></a>, <a href="mqactx_2k2t.htm"><b>FormatName</b></a>, <a href="mqactx_99nw.htm"><b>Journal</b></a>, <a href="mqactx_57c1.htm"><b>JournalQuota</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
