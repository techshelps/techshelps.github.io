<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Closing a Queue</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_closing_a_queue_api"></a>Closing a Queue</h2>
<p>
A queue is closed when its handle is no longer needed and its resources may be freed. When a queue is closed, its handle becomes invalid and all the messages waiting in the queue remain in the queue. This includes any messages sent to the queue by the application closing the queue.</p>
<p>
Closing a queue is done with a single call to <a href="mqfunc_19np.htm"><b>MQCloseQueue</b></a>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To close a queue</h5>
<ol>
<li>
Call <a href="mqfunc_19np.htm"><b>MQCloseQueue</b></a> to close the queue. Use the queue handle returned by <a href="mqfunc_42hx.htm"><b>MQOpenQueue</b></a>.<pre><code>hr  = MQCloseQueue(hQueue);   //handle obtained from MQOpenQueue.
    
if (FAILED(hr))
{
 ///////////////////////////////////
 // Error handler for MQCloseQueue .
 ///////////////////////////////////
}
 </code></pre>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
