<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_add"></a>Add<br>
<a href="mqactx_62t0.htm">MSMQMailFormFieldList</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="mqactx_4vck.htm">MSMQMailRecipientList</a></h1>
<p>
The <b>Add</b> method adds a recipient to the recipient list (<a href="mqactx_4vck.htm"><b>MSMQMailRecipientList</b></a>) or a field to a form field list (<a href="mqactx_62t0.htm"><b>MSMQMailFormFieldList</b></a>).</p>
<h4>Syntax for Adding Recipient</h4>
<pre><code><i>object1.object2</i>.<b>Add</b> <i>Name</i>, <i>Address</i>, <i>Type</i>[, <i>DeliveryTime</i>][, <i>NonDeliveryReason</i>][, <i>Key</i>]
 </code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=30%>Syntax Element</th>
<th align=left width=70%>Description</th>
</tr>
<tr valign=top>
<td width=30%><i>object1</i></td>
<td width=70%>E-mail message (<a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>) object that defines the e-mail message.</td>
</tr>
<tr valign=top>
<td width=30%><i>object2</i></td>
<td width=70%>Recipient list (<a href="mqactx_4vck.htm"><b>MSMQMailRecipientList</b></a>) object that represents the list of recipients.</td>
</tr>
<tr valign=top>
<td width=30%><i>Name</i></td>
<td width=70%>String representation of recipient.</td>
</tr>
<tr valign=top>
<td width=30%><i>Address</i></td>
<td width=70%>String representation of the e-mail recipient's address. Use one of the following formats (see Remarks for examples).<p>
When the e-mail is being sent to another MSMQ application, the recipient's address is the label (<a href="mqactx_30do.htm"><b>Label</b></a>) of the <a href="msmqglos_3wv5.htm#_mq_application_input_queue_gly">application input queue</a>.</p>
<p>
<i>Address:="MSMQQueueLabel"</i> </p>
<p>
When the e-mail is being sent to a Microsoft Exchange user via the MSMQ Exchange Connector, the address includes the e-mail alias of the Exchange user plus the label of the Exchange Connector's <a href="msmqglos_3wvn.htm#_mq_server_input_queue_gly"><i>server input queue</i></a>.</p>
<p>
<i>Address:="UserName@ServerInputQueueLabel"</i></p>
<p>
When e-mail is being sent to the MAPI Transport Provider, the address is the label of the MAPI <a href="msmqglos_3wvp.htm#_mq_user_input_queue_gly">user input queue</a>.</p>
<p>
<i>Address:="UserInputQueueLabel"</i></p>
</td>
</tr>
<tr valign=top>
<td width=30%><i>Type</i></td>
<td width=70%>The <i>Type</i> parameter can have any one of the following values:<p>
MSMQMAIL_RECIPIENT_TO: Default. The recipient is the primary recipient of the e-mail.</p>
<p>
MSMQMAIL_RECIPIENT_CC: The e-mail is copied to the recipient.</p>
<p>
MSMQMAIL_RECIPIENT_BCC: The e-mail is blind copied to the recipient.</p>
</td>
</tr>
<tr valign=top>
<td width=30%><i>DeliveryTime</i></td>
<td width=70%>Optional. <i>DeliveryTime</i> is only used when adding a recipient to the <a href="mqactx_1mcz.htm"><b>DeliveredRecipients</b></a><b> </b>property of the <a href="mqactx_7zs1.htm"><b>MSMQMailDeliveryReportData</b></a><b> </b>object. This property specifies when the original e-mail was delivered to the recipient.</td>
</tr>
<tr valign=top>
<td width=30%><i>NonDeliveryReason</i></td>
<td width=70%>Optional. <i>NonDeliveryReason</i> is only used when adding a recipient to the <a href="mqactx_1xtf.htm"><b>NonDeliveredRecipients</b></a> property of the <a href="mqactx_4msh.htm"><b>MSMQMailNonDeliveryReportData</b></a> object. This property specifies the reason why the original e-mail was not delivered to the recipient.</td>
</tr>
<tr valign=top>
<td width=30%><i>Key</i></td>
<td width=70%>Optional. Key (<b>Variant</b> type) used when removing the recipient from the recipient list (see <i>IndexKey</i> parameter of <a href="mqactx_7tyd.htm"><b>Remove</b></a>).</td>
</tr>
</table><br>
<h4>Syntax for Adding Field</h4>
<pre><code><i>object1.object2</i>.<i>object3</i>.<b>Add</b> <i>Name</i>, <i>Value</i>[, <i>Key</i>]
 </code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=28%>Syntax Element</th>
<th align=left width=72%>Description</th>
</tr>
<tr valign=top>
<td width=28%><i>object1</i></td>
<td width=72%>E-mail message (<a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>) object that defines the e-mail message.</td>
</tr>
<tr valign=top>
<td width=28%><i>object2</i></td>
<td width=72%>Form field data (MSMQMailFormData) object that defines the form.</td>
</tr>
<tr valign=top>
<td width=28%><i>object3</i></td>
<td width=72%>Form field list (<a href="mqactx_62t0.htm"><b>MSMQMailFormFieldList</b></a>) object that represents the list of fields in the form.</td>
</tr>
<tr valign=top>
<td width=28%><i>Name</i></td>
<td width=72%>String representation of the name of the field. This name should correspond to the name of the field's <i>Reference Name</i> as specified in the Exchange Form Designer. The <i>Reference Name</i> can be found on the <i>General</i> page of the <i>Field Properties</i> dialog of the Exchange Form Designer.<p>
If the correct <i>Reference Name</i> is not used, Microsoft Exchange may not display the field correctly.</p>
</td>
</tr>
<tr valign=top>
<td width=28%><i>Value</i></td>
<td width=72%>String, Integer, Boolean, Double, or Currency value of field.</td>
</tr>
<tr valign=top>
<td width=28%><i>Key</i></td>
<td width=72%>Optional. Key used when removing the field from the form field list (see <i>IndexKey</i> parameter of <a href="mqactx_7tyd.htm"><b>Remove</b></a>).</td>
</tr>
</table><br>
<h4>Remarks</h4>
<dl>
<dt>
Recipient List</dt>
<dd>
The format of <i>Address</i> varies depending on the MSMQ Mail Service used or if the destination is another MSMQ application.</dd>
<dt>
Form Field List</dt>
<dd>
Fields can be one of the following types: String, Integer, Boolean, Double, or Currency value of field.
</dd>
</dl>
<h4>Recipient List Example</h4>
<p>
This example defines an e-mail message with two recipients and then displays the name and address of each recipient. The addresses of the recipients indicate that the mail will be sent to the Exchange Connector (first recipient) and the MAPI Transport Provider (second recipient).</p>
<p>
<b>Note</b>&nbsp;&nbsp;For examples of setting the <i>NonDeliveryReason</i> and <i>DeliveryTime</i> parameters, see the examples in <a href="mqactx_773i.htm"><b>NonDeliveryReason</b></a> and <a href="mqactx_17l1.htm"><b>DeliveryTime</b></a> properties respectively.</p>
<p>
To try this example using Microsoft® Visual Basic® (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Private Sub Form_Click()

Dim email As New MSMQMailEMail

'Set e-mail type to text message
 email.ContentType= MSMQMAIL_EMAIL_TEXTMESSAGE

'**********************************
'* Add Exchange Connector recipient
'* as primary recipient.
'**********************************
email.Recipients.Add "Exchange_User", "ExchangeUser@ServerInputQueueLabel", MSMQMAIL_RECIPIENT_TO

'*********************
'* Add MAPI recipient
'* as CC recipient.
'*********************
email.Recipients.Add "MAPI_User", "MAPIUserInputQueueLabel", MSMQMAIL_RECIPIENT_CC


'Set who sent the e-mail.
email.Sender.Name = "Our name"
email.Sender.Address = "Our queue label"

'Set the subject of the e-mail.
email.Subject = "Test mail."

'Set the Body of the e-mail.
email.TextMessageData.Text = "This is the Body of the message."


'*********************
'* Display Recipients.
'*********************

Dim recipient As MSMQMailRecipient

For Each recipient In email.Recipients
    MsgBox "Mail was sent to " + recipient.Name + " at " + recipient.Address
Next recipient


End Sub 
 </code></pre>
<h4>Field List Example</h4>
<p>
This example defines an e-mail message with three fields (String, Boolean, and Date) and then displays the value given to each field.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim email As New MSMQMailEMail

Private Sub Form_Click()

   '*********************
   '*  Define e-mail
   '*********************
   
   'Set e-mail type to form message.
   email.ContentType = MSMQMAIL_EMAIL_FORM
   
   'Add primary recipient.
   email.Recipients.Add "Exchange_User", "ExchangeUser@ServerInputQueueLabel", MSMQMAIL_RECIPIENT_TO
   
   'Set who sent the e-mail.
   email.Sender.Name = "Our name"
   email.Sender.Address = "Our queue label"
   
   'Set the subject of the mail.
   email.Subject = "Test form."
   
   '**********************
   '* Define the form.
   '**********************
   
   'Set the form name.
   email.formdata.Name = "Test Form"
   
   'Set form field list.
    email.formdata.FormFields.Add "StringField", "Test Field"
    email.formdata.FormFields.Add "BooleanField", True
    email.formdata.FormFields.Add "DateField", "DateString"
   
   
   '*********************
   '* Display fields.
   '*********************
   
   Dim formfield As MSMQMailFormField
   
   For Each formfield In email.formdata.FormFields
    MsgBox "Form: " + formfield.Name + " = " +    CStr(formfield.Value)
   
   Next formfield
   
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in mqmailoa.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_9cqb.htm"><b>Address</b></a>, <a href="mqactx_1q05.htm"><b>ContentType</b></a>, <a href="mqactx_68yp.htm"><b>FormData</b></a>, <a href="mqactx_7h83.htm"><b>FormFields</b></a>, <a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>, <a href="mqactx_5s38.htm"><b>MSMQMailRecipient</b></a>, <a href="mqactx_9411.htm"><b>Name</b></a>, <a href="mqactx_7r3n.htm"><b>Recipients</b></a>, <a href="mqactx_6h4i.htm"><b>Sender</b></a>, <a href="mqactx_78ac.htm"><b>Subject</b></a>, <a href="mqactx_36us.htm"><b>Text</b></a>, <a href="mqactx_5469.htm"><b>TextMessageData</b></a></p>
<p>&nbsp;</p></body>
</HTML>
