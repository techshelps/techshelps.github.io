<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Peek</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_peek"></a>Peek<br>
<a href="mqactx_1qcl.htm">MSMQQueue</a></h1>
<p>
The <b>Peek</b> method returns the first message in the queue, or waits for a message to arrive if the queue is empty. It does not remove the message from the queue. </p>
<h4>Syntax</h4>
<pre><code><i>set object2 = object1</i>.<b>Peek </b>([<i>ReceiveTimeout</i>][,<i> WantDestinationQueue</i>][<i>, WantBody</i>])
 </code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object1</i></td>
<td width=64%>Queue (<a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>) object that represents the queue where the message resides.</td>
</tr>
<tr valign=top>
<td width=36%><i>object2</i></td>
<td width=64%>Message (<a href="mqactx_54px.htm"><b>MSMQMessage</b></a>) object that represents the message read from the queue.</td>
</tr>
<tr valign=top>
<td width=36%><i>ReceiveTimeout</i></td>
<td width=64%>Optional. Specifies how long (in milliseconds) MSMQ waits for a message to arrive.</td>
</tr>
<tr valign=top>
<td width=36%><i>WantDestinationQueue</i></td>
<td width=64%>Optional (default is FALSE). If TRUE, <a href="mqactx_23jj.htm"><b>DestinationQueueInfo</b></a> is updated when the message is read from the queue. Setting this property to TRUE may slow down the operation of the application.</td>
</tr>
<tr valign=top>
<td width=36%><i>WantBody</i></td>
<td width=64%>Optional (default is TRUE). If the Body of the message is not needed, set this property to FALSE to optimize the speed of the application.</td>
</tr>
</table><br>
<h4>Return Values</h4>
<p>
MSMQMessage object.</p>
<h4>Remarks</h4>
<p>
The <b>Peek</b> method always looks at the first message in the queue. It is completely independent of the implied cursor used by <a href="mqactx_5i0k.htm">PeekCurrent</a>, <a href="mqactx_4igk.htm">PeekNext</a>, and <a href="mqactx_699w.htm">ReceiveCurrent</a>.</p>
<p>
Applications can peek at messages in queues opened with peek or receive access (see <a href="mqactx_61bi.htm"><b>Open</b></a>).</p>
<p>
The <i>ReceiveTimeout</i> parameter can be used to control how long MSMQ waits for a message to arrive when the queue is empty.</p>
<p>
The <i>WantDestinationQueue</i> and <i>WantBody</i> parameters can be used to optimize the speed of the application.</p>
<h4>Example</h4>
<p>
This example sends a message to the destination queue to make sure at least one message is there, and then reads the first message in the queue. If another message is already in the queue, the message returned by Peek may not be the message sent by the example.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Option Explicit

Dim query As New MSMQQuery
Dim qinfoDest As MSMQQueueInfo
Dim qDest As MSMQQueue
Dim msgSent As New MSMQMessage
Dim msgDest As MSMQMessage

Private Sub Form_Click()
            
   '***************************
   ' Locate destination queue
   '(create one if one doesn't
   ' exist).
   '***************************
   Set qinfos = query.LookupQueue(Label:="Destination Queue")
   qinfos.Reset
   Set qinfoDest = qinfos.Next
   If qinfoDest Is Nothing Then
      Set qinfoDest = New MSMQQueueInfo
      qinfoDest.PathName = ".\DestQueue"
      qinfoDest.Label = "Destination Queue"
      qinfoDest.Create
   End If
   
   '**************
   ' Open destination queue.
   '**************
   Set qDest = qinfoDest.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
   
   '**************
   ' Send Message.
   '**************
   msgSent.Label = "Test Message"
   msgSent.Body = "This message is used to test reading messages."
   
   msgSent.Send qDest
   qDest.Close
  
   '**********************
   ' PEEK at first message
   ' in the queue.
   '**********************
   
   Set qDest = qinfoDest.Open(MQ_PEEK_ACCESS, MQ_DENY_NONE)
      
   On Error GoTo Handler
   Set msgDest = qDest.Peek(ReceiveTimeout:=100)
   MsgBox "The first message in the queue is: " + msgDest.Label
   Exit Sub
   
   '***************
   ' Error Handler
   '***************
   
Handler:
   'Test for errors.

End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_9mp1.htm"><b>Close</b></a>, <a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_85np.htm"><b>LookupQueue</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_1q7t.htm"><b>MSMQQuery</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_2ypf.htm"><b>MSMQQueueInfos</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a>, <a href="mqactx_4jhw.htm"><b>Reset</b></a>, <a href="mqactx_7k2s.htm"><b>Send</b></a></p>
<p>&nbsp;</p></body>
</HTML>
