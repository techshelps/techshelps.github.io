<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Remove</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_remove"></a>Remove<br>
<a href="mqactx_62t0.htm">MSMQMailFormFieldList</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="mqactx_4vck.htm">MSMQMailRecipientList</a></h1>
<p>
The <b>Remove</b> method removes a specific recipient from the recipient list (<a href="mqactx_4vck.htm"><b>MSMQMailRecipientList</b></a>) or a field from the form field list (<a href="mqactx_62t0.htm"><b>MSMQMailFormFieldList</b></a>).</p>
<h4>Syntax for Removing a Recipient</h4>
<pre><code><i>object1.object2</i>.<b>Remove </b><i>IndexKey</i>
<i> </i></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object1</i></td>
<td width=64%>E-mail message (<a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>) object that defines the e-mail message.</td>
</tr>
<tr valign=top>
<td width=36%><i>object2</i></td>
<td width=64%>Recipient (<b>MSMQMailRecipientList</b>) list object.</td>
</tr>
<tr valign=top>
<td width=36%><i>IndexKey</i></td>
<td width=64%>Index of the <a href="mqactx_2obx.htm"><b>Item</b></a> array, or the key specified when the recipient was added to the list (see <i>Key</i> parameter of <a href="mqactx_7fxg.htm"><b>Add</b></a>).</td>
</tr>
</table><br>
<h4>Syntax for Removing a Field</h4>
<pre><code><i>object1.object2.object3</i>.<b>Remove </b><i>IndexKey</i>
<i> </i></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object1</i></td>
<td width=64%>E-mail message (<a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>) object that defines the e-mail message.</td>
</tr>
<tr valign=top>
<td width=36%><i>object2</i></td>
<td width=64%>Form field data (MSMQMailFormData) object that defines the form.</td>
</tr>
<tr valign=top>
<td width=36%><i>object3</i></td>
<td width=64%>Form field (<a href="mqactx_62t0.htm"><b>MSMQMailFormFieldList</b></a>) list object.</td>
</tr>
<tr valign=top>
<td width=36%><i>IndexKey</i></td>
<td width=64%>Index of the <a href="mqactx_2obx.htm"><b>Item</b></a> array, or the key specified when the recipient or field was added to the list (see <i>Key</i> parameter of <a href="mqactx_7fxg.htm"><b>Add</b></a>).</td>
</tr>
</table><br>
<h4>Example of Removing a Recipient</h4>
<p>
This example creates an e-mail object with a primary, copy, and blind copy recipient, setting the index key on the blind-copy recipient. It then displays the names of the recipients, removes the blind-copy recipient using its index key, and displays the names of the recipients remaining in the form.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim email As New MSMQMailEMail

Private Sub Form_Click()

   'Set e-mail type to text message
   email.ContentType = MSMQMAIL_EMAIL_TEXTMESSAGE
   
   '**********************************
   '* Add primary recipient.
   '**********************************
   email.Recipients.Add "Exchange_User", "ExchangeUser@ServerInputQueueLabel", MSMQMAIL_RECIPIENT_TO
   
   '*********************
   '* Add CC recipient.
   '*********************
   email.Recipients.Add "MAPI_User1", "MAPIUserInputQueueLabel", MSMQMAIL_RECIPIENT_CC
   
   '*********************
   '* Add BC recipient.
   '*********************
   email.Recipients.Add "MAPI_User2", "MAPIUserInputQueueLabel", MSMQMAIL_RECIPIENT_BCC, "BC"
   
   
   'Set who sent the e-mail.
   email.Sender.Name = "Our name"
   email.Sender.Address = "Our queue label"
   
   'Set the subject of the e-mail.
   email.Subject = "Test mail."
   
   'Set the Body of the e-mail.
   email.TextMessageData.Text = "This is the Body of the message."
   
   
   '*******************************
   '* Remove blind-copy Recipients.
   '*******************************
   
   Dim recipient As MSMQMailRecipient
   
   Debug.Print "**Old Recipient List**"
   For Each recipient In email.Recipients
       Debug.Print recipient.Name
   Next recipient
   
   email.Recipients.Remove "BC"
   
   Debug.Print "**New Recipient List**"
   For Each recipient In email.Recipients
          Debug.Print recipient.Name
   Next recipient

End Sub 
 </code></pre>
<h4>Example of Removing a Field</h4>
<p>
This example creates an e-mail form with three fields, setting the index key of the date field. It then displays the names and values of all fields, removes the date field using its index key, and displays the names of the fields remaining in the form.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim email As New MSMQMailEMail

Private Sub Form_Click()


   '*********************
   '*  Define e-mail
   '*********************
   
   'Set e-mail type to form message.
   email.ContentType = MSMQMAIL_EMAIL_FORM
   
   'Add primary recipient.
   email.Recipients.Add "Exchange_User", "ExchangeUser@ServerInputQueueLabel", MSMQMAIL_RECIPIENT_TO
   
   'Set who sent the e-mail.
   email.Sender.Name = "Our name"
   email.Sender.Address = "Our queue label"
   
   'Set subject of mail.
   email.Subject = "Test form."

  'Set form name.
  email.formdata.Name = "Test Form"

 'Set form field list.
   email.formdata.FormFields.Add "StringField", "Test Field"
   email.formdata.FormFields.Add "BooleanField", True
   email.formdata.FormFields.Add "DateField", "DateString", "SentDate"
   
   '**********************
   '* Remove Date field.
   '**********************
   
   Dim formfield As MSMQMailFormField
   
   Debug.Print "**Old Field List**"
   For Each formfield In email.formdata.FormFields
       Debug.Print formfield.Name + ": " + CStr(formfield.Value)
   Next formfield
   
   email.formdata.FormFields.Remove "SentDate"
   
   Debug.Print "**New Field List**"
   For Each formfield In email.formdata.FormFields
       Debug.Print formfield.Name + ": " + CStr(formfield.Value)
   Next formfield
   
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in mqmailoa.dll.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also </h4>
<p>
<a href="mqactx_7fxg.htm"><b>Add</b></a>, <a href="mqactx_9cqb.htm"><b>Address</b></a>, <a href="mqactx_1q05.htm"><b>ContentType</b></a>, <a href="mqactx_68yp.htm"><b>FormData</b></a>, <a href="mqactx_7h83.htm"><b>FormFields</b></a>, <a href="mqactx_1a5o.htm"><b>MSMQMailEMail</b></a>, <a href="mqactx_7nfo.htm"><b>MSMQMailFormField</b></a>, <a href="mqactx_5s38.htm"><b>MSMQMailRecipient</b></a>, <a href="mqactx_9411.htm"><b>Name</b></a>, <a href="mqactx_7r3n.htm"><b>Recipients</b></a>, <a href="mqactx_6h4i.htm"><b>Sender</b></a>, <a href="mqactx_78ac.htm"><b>Subject</b></a>, <a href="mqactx_36us.htm"><b>Text</b></a>, <a href="mqactx_5469.htm"><b>TextMessageData</b></a>, <a href="mqactx_9ulh.htm"><b>Value</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
