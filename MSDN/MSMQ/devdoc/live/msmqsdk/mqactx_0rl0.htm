<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Arrived</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_arrived"></a>Arrived<br>
<a href="mqactx_27p0.htm">MSMQEvent</a></h1>
<p>
The <b>Arrived </b>event is fired when <a href="mqactx_10ha.htm"><b>EnableNotification</b></a> has been called and some message is found in the queue.</p>
<h4>Syntax</h4>
<pre><i><code>object_Arrived(byval Queue as Object)
 </code></i></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Instance of event (<b>MSMQEvent</b>) object used for the event handler.</td>
</tr>
<tr valign=top>
<td width=36%><i>Queue</i></td>
<td width=64%>Queue (<a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>) object that represents an open instance of the queue where the message arrived.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>Arrived </b>event is fired by an instance of the <b>MSMQEvent </b>object. Every queue that has called <b>EnableNotification</b> triggers an instance of the <b>MSMQEvent</b> object when a message arrives in the queue (this includes existing messages in the queue when <b>EnableNotification</b> is first called).</p>
<p>
There is no association between an <b>Arrived</b> event and a specific message. The arrived event only means that some message arrived in the queue.</p>
<p>
Although an <b>Arrived</b> event is fired for each message, there is no guarantee that the message that triggered the event will still be there when the event handler tries to use the message. Queues are dynamic, and another application may have already removed the message that triggered the <b>Arrived</b> event.</p>
<p>
<b>EnableNotification</b> must be explicitly reset after each <b>Arrived</b> event is fired.</p>
<h4>Example</h4>
<p>
This example assumes that queues q1 and q2 are open and that they are not being shared by another application. <a href="mqactx_10ha.htm"><b>EnableNotification</b></a> is called, and then the label of the first message in the queue (if messages are already in the queue), or the first message sent to the queue, is displayed.</p>
<pre><code>Dim WithEvents qevents as MSMQEvent
Dim q1 as MSMQQueue
Dim q2 as MSMQQueue
 
Sub Enable
    'Assuming q1 and q2 are open.
    q1.EnableNotification
    q2.EnableNotification
End Sub
 
Sub event_Arrived (byval q as Object)
    'Generic event handler
    Dim qArrive as MSMQQueue
    Set qArrive = q                'Cast Object reference to MSMQQueue

    'This example assumes the message has not been removed 
    'by another application.
    msgbox "Message in following queue: " + qArrive.QueueInfo.Label
    qArrive.EnableNotification Event       'Reenables notification.
End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_10ha.htm"><b>EnableNotification</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
