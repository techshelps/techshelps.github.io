<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MQDeleteQueue</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_mqdeletequeue"></a>MQDeleteQueue</h1>
<p>
The <b>MQDeleteQueue</b> function deletes a queue from <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> (in the case of public queues) or from the local computer (in the case of private queues).</p>
<pre><code><b>HRESULT APIENTRY MQDeleteQueue(
  LPCWSTR</b><i> lpwcsFormatName  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpwcsFormatName</i></dt>
<dd>
[in] Pointer to the queue's format name buffer. This buffer contains the format name string of the queue to be deleted.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MQ_OK</dt>
<dd>
Indicates success.</dd>
<dt>
MQ_ERROR_ACCESS_DENIED</dt>
<dd>
The process does not have the access rights to delete this queue. To change access rights, call <a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a>.</dd>
<dt>
MQ_ERROR_ILLEGAL_FORMATNAME</dt>
<dd>
The specified format name in <i>lpwcsFormatName</i> is illegal.</dd>
<dt>
MQ_ERROR_NO_DS</dt>
<dd>
Cannot access <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>.</dd>
<dt>
MQ_ERROR_SERVICE_NOT_AVAILABLE</dt>
<dd>
Cannot connect to the Queue Manager.</dd>
<dt>
MQ_ERROR_UNSUPPORTED_FORMATNAME_OPERATION</dt>
<dd>
Cannot delete a queue using a direct format name.</dd>
<dt>
MQ_ERROR_WRITE_NOT_ALLOWED</dt>
<dd>
Cannot delete a queue from <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The format name of the queue (specified by<i> lpwcsFormatName)</i> cannot be a direct format name.</p>
<p>
When deleting a public queue, some clients may still see the queue registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> after the queue has been deleted. A change to Active Directory (such as deleting a public queue) is propagated from domain controller to domain controller, which can cause delays in the availability of new information. Consequently, clients using a specific domain controller may still try to send messages to the queue, even though it was deleted. Propagation delays, including communication network delays such as down links, are controlled by the MSMQ Administrator.</p>
<p>
Public queues cannot be deleted if there is no connection to Active Directory. This restriction applies to <a href="msmqglos_3wv8.htm#_mq_dependent_client_gly">dependent client</a> computers, <a href="msmqglos_3wvd.htm#_mq_independent_client_gly">independent client</a> computers that are working offline, and MSMQ routing servers (FRS). (For information on offline operations, see <a href="msmq_guide_72es.htm">MSMQ Offline Support</a>.)</p>
<h4>Examples</h4>
<p>
For an example of using <b>MQDeleteQueue</b>, see <a href="msmquse_3lyh.htm">Deleting a Queue</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_19np.htm"><b>MQCloseQueue</b></a>, <a href="mqfunc_8dut.htm"><b>MQCreateQueue</b></a>, <a href="mqfunc_42hx.htm"><b>MQOpenQueue</b></a>, <a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
