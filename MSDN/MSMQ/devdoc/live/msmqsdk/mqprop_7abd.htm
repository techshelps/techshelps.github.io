<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_M_PRIORITY</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_m_priority"></a>PROPID_M_PRIORITY</h1>
<p>
The PROPID_M_PRIORITY property specifies the message's priority. A low number means low priority.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_UI1 (or VT_NULL)</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
bVal</dd>
<dt>
Property Values</dt>
<dd>
An integer value between 7 and 0 (the default is 3).
</dd>
</dl>
<h4>Remarks</h4>
<p>
Message priority effects how MSMQ handles the message while it is in route, as well as where the message is placed in the queue. Higher priority messages are given preference during routing, and inserted toward the front of the queue. Messages with the same priority are placed in the queue according to their arrival time.</p>
<p>
MSMQ automatically sets the priority level of transactional messages to 0: PROPID_M_PRIORITY is ignored by the transaction. For information on transactions, see <a href="msmq_guide_5g4z.htm">MSMQ Transactions</a>.</p>
<p>
To set the priority of a message, pass PROPID_M_PRIORITY to <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>.</p>
<p>
To determine the priority of a message in the queue, pass PROPID_M_PRIORITY to <a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a> and examine its returned value. When passing PROPID_M_PRIORITY to <b>MQReceiveMessage</b>, the corresponding VT field in the <b>aPropVar</b> array can be set to VT_NULL.</p>
<p>
If the message is sent to a public queue, a second priority (the queue's <a href="mqprop_55h5.htm">PROPID_Q_BASEPRIORITY</a> property) is added to PROPID_M_PRIORITY for routing purposes. However, the queue's base priority has no effect on how messages are placed in the queue.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_2cdh.htm"><b>MQReceiveMessage</b></a>, <a href="mqprop_55h5.htm">PROPID_Q_BASEPRIORITY</a> </p>
<p>&nbsp;</p></body>
</HTML>
