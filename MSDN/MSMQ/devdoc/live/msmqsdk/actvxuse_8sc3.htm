<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting a Queue's Properties Using ActiveX Components</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_setting_a_queue_s_properties_using_activex_components"></a>Setting a Queue's Properties Using ActiveX Components</h2>
<p>
The properties of a queue can be dynamically set by calling the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object's <a href="mqactx_3lut.htm"><b>Update</b></a> method. <b>Update</b> can only be called on queues that exist. It cannot be called on an <b>MSMQQueueInfo</b> object before the queue is created or after the queue is deleted.</p>
<p>
When <b>Update</b> is called, <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> (public queues) and the local computer (private queues) are updated with the current settings of the <b>MSMQQueueInfo</b> object's properties.</p>
<p>
<b>Note</b>&nbsp;&nbsp;Properties for private queues can only be updated if the queue is located on the local computer.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set a queue's properties</h5>
<ol>
<li>
Determine whether the application has the access rights needed to set the queue's properties. If the application does not have MQSEC_SET_QUEUE_PROPERTIES access rights, an MQ_ERROR_ACCESS_DENIED error is returned to <a href="mqactx_3lut.htm"><b>Update</b></a>. For a complete list of queue access rights, see <a href="msmq_guide_8i0c.htm">Access Control</a>.</li>
<li>
Set the queue properties that need to be changed to a new value.</li>
<li>
Call <b>Update</b>.</li>
</ol>
<h4>Example</h4>
<p>
This example creates a public queue and then uses <b>Update</b> to change the queue's label. To try this example using Microsoft® Visual Basic® (version 5.0), paste the code into the Declaration section of a form that has a single text box, run the example, and click the form.</p>
<pre><code>Dim qinfo As New MSMQQueueInfo

Private Sub Form_Click()
    
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\UpdateTest1"
  qinfo.Label = "Test Queue"
  qinfo.Create
  MsgBox "The queue's label is: " + qinfo.Label
  
  qinfo.Label = "New Queue Label"
  qinfo.Update
  MsgBox "The queue's new label is: " + qinfo.Label

End Sub
 </code></pre>
<h4>Queue properties</h4>
<p>
The following queue properties can be set by calling <a href="mqactx_3lut.htm"><b>Update</b></a>:</p>
<p>
<a href="mqactx_8a5h.htm"><b>Authenticate</b></a> </p>
<p>
<a href="mqactx_6kft.htm"><b>BasePriority</b></a> </p>
<p>
<a href="mqactx_99nw.htm"><b>Journal</b></a> </p>
<p>
<a href="mqactx_57c1.htm"><b>JournalQuota</b></a> </p>
<p>
<a href="mqactx_30do.htm"><b>Label</b></a> </p>
<p>
<a href="mqactx_3iuk.htm"><b>PrivLevel</b></a> </p>
<p>
<a href="mqactx_4ijl.htm"><b>Quota</b></a> </p>
<p>
<a href="mqactx_63vo.htm"><b>ServiceTypeGuid</b></a> </p>
<p>
The following properties cannot be set by <b>Update</b>:</p>
<p>
<a href="mqactx_7rqd.htm"><b>CreateTime</b></a> (set by MSMQ)</p>
<p>
<a href="mqactx_91yk.htm"><b>IsTransactional</b></a> (set when queue is created)</p>
<p>
<a href="mqactx_3uhx.htm"><b>ModifyTime</b></a> (set by MSMQ)</p>
<p>
<a href="mqactx_823p.htm"><b>PathName</b></a> (set when queue is created)</p>
<p>
<a href="mqactx_8ht0.htm"><b>QueueGuid</b></a> (set by MSMQ)</p>
<p>&nbsp;</p></body>
</HTML>
