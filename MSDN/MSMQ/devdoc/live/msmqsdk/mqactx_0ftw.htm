<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Id</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_id"></a>Id<br>
<a href="mqactx_54px.htm">MSMQMessage</a></h1>
<p>
Read-only. The <b>Id</b> property identifies the message using an MSMQ-generated message identifier.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><b>Variant</b> (array of bytes)</td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>read-only</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Id</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Message (<b>MSMQMessage</b>) object from queue.</td>
</tr>
</table><br>
<h4>Return Values</h4>
<p>
20-byte message identifier (array of bytes).</p>
<h4>Remarks</h4>
<p>
MSMQ generates a 20-byte message identifier and attaches it to the message when the message is sent. The identifier is an array of bytes that can be read by either the sending or receiving application.</p>
<p>
MSMQ generates message identifiers for all messages, including acknowledgment messages generated by MSMQ and MSMQ Connector applications. When an acknowledgment message is created, the identifier of the original message can be found in the acknowledgment message's <a href="mqactx_69ic.htm"><b>CorrelationId</b></a> property.</p>
<h4>Example</h4>
<p>
This example locates a destination queue (creating one if one does not exist), sends two messages to the queue, and then reads the message and displays the message identifier.</p>
<p>
To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim query As New MSMQQuery
Dim qinfos As MSMQQueueInfos
Dim qinfoDest As MSMQQueueInfo
Dim q As MSMQQueue
Dim msgSent1 As New MSMQMessage
Dim msgSent2 As New MSMQMessage
Dim msgRead As MSMQMessage
Dim strID As String             'String representation of ID.

Private Sub Form_Click()
   
   
   '**********************************
   ' Locate destination queue
   '(create one if one doesn't exist).
   '**********************************
   
   Set qinfos = query.LookupQueue(Label:="Destination Queue")
   qinfos.Reset
   Set qinfoDest = qinfos.Next
   If qinfoDest Is Nothing Then
      Set qinfoDest = New MSMQQueueInfo
      qinfoDest.PathName = ".\DestQueue"
      qinfoDest.Label = "Destination Queue"
      qinfoDest.Create
   End If
   
   '************************
   ' Open destination queue.
   '************************
   Set q = qinfoDest.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
   
   '**************
   ' Send Messages.
   '**************
   msgSent1.Label = "Test Message"
   msgSent1.Body = "This message tests the message identifier."
   msgSent1.Send q
   For counter = LBound(msgSent.Id) To UBound(msgSent.Id)
          strID = strID &amp; Hex(msgSent.Id(Counter))
   Next counter
   MsgBox "Message (" + StrID + ") was sent to the queue."
   strID = ""
   
   msgSent2.Label = "Test Message"
   msgSent2.Body = "This message tests the message identifier."
   msgSent2.Send q
   For counter = LBound(msgSent2.Id) To UBound(msgSent2.Id)
          strID = strID &amp; Hex(msgSent2.Id(Counter))
   Next counter

   MsgBox "Message (" + strID + ") was sent to the queue."
   strID = ""
   q.Close
  
   '************************************
   ' Read the message in the destination
   ' queue and display its identifier.
   '************************************
   
   Set q = qinfoDest.Open(MQ_RECEIVE_ACCESS, MQ_DENY_NONE)
   Set msgRead = q.Receive (ReceiveTimeout:=0)
   
   While Not msgRead Is Nothing
      For Counter = LBound(msgRead.Id) To UBound(msgRead.Id)
          strID = strID &amp; Hex(msgRead.Id(Counter))
      Next Counter
      MsgBox "The message " + strID + " was removed from the queue."
      strID = ""
      Set msgRead = q.Receive
  Wend
  
End Sub
   </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_9mp1.htm"><b>Close</b></a>, <a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_1q7t.htm"><b>MSMQQuery</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_2ypf.htm"><b>MSMQQueueInfos</b></a>, <a href="mqactx_9h84.htm"><b>Next</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a>, <a href="mqactx_80dh.htm"><b>Receive</b></a>, <a href="mqactx_4jhw.htm"><b>Reset</b></a>, <a href="mqactx_7k2s.htm"><b>Send</b></a></p>
<p>&nbsp;</p></body>
</HTML>
