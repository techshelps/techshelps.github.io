<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Update</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_update"></a>Update<br>
<a href="mqactx_01nz.htm">MSMQQueueInfo</a></h1>
<p>
The <b>Update</b> method updates <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> (public queues) or the local computer (private queues) with the current property values of the <b>MSMQQueueInfo</b> object.</p>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Update</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>The queue information (<b>MSMQQueueInfo</b>) object that defines the public queue.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>Update</b> method can only update existing queues. It cannot be called on an <b>MSMQQueueInfo</b> object before the queue is created or after the queue is deleted.</p>
<p>
<a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> (public queues) and the local computer (private queues) are not updated when an <b>MSMQQueueInfo</b> property is set. They are only updated when a queue is created, when the queue is opened, and whenever <b>Update</b> is explicitly called.</p>
<p>
<b>Update</b> can be used on <b>MSMQQueueInfo</b> objects that define public queues or local private queues. Properties for remote private queues are stored on the computer where the queue exists, and, therefore, cannot be updated.</p>
<p>
The following queue properties may not be available to <b>Update</b>.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Property Name</th>
<th align=left width=52%>Reason</th>
</tr>
<tr valign=top>
<td width=48%><a href="mqactx_6kft.htm"><b>BasePriority</b></a></td>
<td width=52%>For public queues only. Cannot be set for private queues.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqactx_7rqd.htm"><b>CreateTime</b></a></td>
<td width=52%>Set by MSMQ.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqactx_8ht0.htm"><b>QueueGuid</b></a></td>
<td width=52%>Set by MSMQ.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqactx_3uhx.htm"><b>ModifyTime</b></a></td>
<td width=52%>Set by MSMQ.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqactx_823p.htm"><b>PathName</b></a></td>
<td width=52%>Can only be set when the queue is created.</td>
</tr>
</table><br>
<p>
For a complete description of setting queue properties, including a list of the properties that can be set, see <a href="actvxuse_8sc3.htm">Setting a Queue's Properties Using ActiveX Components</a>.</p>
<p>
When setting the properties of a public queue, some clients may still see the old settings registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> after the properties are changed. Changes to Active Directory (such as setting properties) are propagated from domain controller to domain controller, which can cause delays in the availability of new information. Consequently, clients using a specific domain controller may still see the old property settings, even though the settings of the properties were changed by <b>Update</b>. Propagation delays, including communication network delays such as down links, are controlled by the MSMQ Administrator.</p>
<h4>Example</h4>
<p>
This example creates a public queue and then uses <b>Update</b> to change the queue's label. To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form that has a single text box, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo

Private Sub Form_Click()
    
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\UpdateTest"
  qinfo.Label = "Test Queue"
  qinfo.Create
  MsgBox "The queue's label is: " + qinfo.Label
  
  qinfo.Label = "New Queue Label"
  qinfo.Update
  MsgBox "The queue's label is: " + qinfo.Label

End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_30do.htm"><b>Label</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a></p>
<p>&nbsp;</p></body>
</HTML>
