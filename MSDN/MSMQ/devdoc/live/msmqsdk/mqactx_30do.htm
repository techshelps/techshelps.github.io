<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Label</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_label"></a>Label<br>
<a href="mqactx_01nz.htm">MSMQQueueInfo</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="mqactx_54px.htm">MSMQMessage</a></h1>
<p>
Optional. The <b>Label</b> property specifies a description of the queue or message.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>Type:</td>
<td width=64%><b>String</b></td>
</tr>
<tr valign=top>
<td width=36%>Run time:</td>
<td width=64%>read/write</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>Label</b>
<b> </b></code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Either the queue information (<b>MSMQQueueInfo</b>) object that defines the queue, or the message (<b>MSMQMessage</b>) object that defines the message.</td>
</tr>
</table><br>
<h4>Settings</h4>
<dl>
<dt>
Queue label</dt>
<dd>
Application-defined string (default is ""). The maximum length of the string is MQ_MAX_Q_LABEL_LEN (124 Unicode characters). </dd>
<dt>
Message label</dt>
<dd>
Application-defined string describing the message. The maximum length of a message label is 250 Unicode characters (including end-of-line character).
</dd>
</dl>
<h4>Remarks</h4>
<dl>
<dt>
Queue label</dt>
<dd>
For public queues, the queue's label can be used as the search criteria for a query. By setting the label of several queues to the same string, the application can later run a query on the queue label and return all the queues with the same label. (A query can also be used to retrieve the label of a public queue.) For information on running a query, see <a href="actvxuse_48fs.htm">Locating a Public Queue</a>.
<p>
To specify the label of a queue, set <b>Label</b> and call the <b>MSMQQueueInfo</b> object's <a href="mqactx_6605.htm"><b>Create</b></a> method.

<p>
To reset the label of a queue after the queue is created, set <b>Label</b> to a new label and, if the queue is open, call the <b>MSMQQueueInfo</b> object's <a href="mqactx_3lut.htm"><b>Update</b></a><b> </b>method. If the queue is not open, do not call <b>Update</b> because the queue's properties are updated automatically when the queue is opened.

<p>
To find the label of a queue, call the <b>MSMQQueueInfo</b> object's <a href="mqactx_9h9k.htm"><b>Refresh</b></a><b> </b>method.
</dd>
<dt>
Message label</dt>
<dd>
Message labels can be used by administration tools for display purposes. For example, a printing application could put the source application and document name in the label of each message it sends to the printer queue.
<p>
For an example of how MSMQ sends the messages to a queue, see <a href="actvxuse_7g3c.htm">Sending Messages To a Queue</a>.

</dd>
</dl>
<h4>Example: Setting a queue label</h4>
<p>
This example creates a private queue on the local computer, setting the queue's label to "Test Queue". To try this example using Microsoft Visual Basic (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
   
Private Sub Form_Click()
    
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\PRIVATE$\myqueue"
  qinfo.Label = "Test Queue"
  qinfo.Create
   
  MsgBox "Queue's Format name is: " + qinfo.FormatName

End Sub
 </code></pre>
<h4>Example: Setting a message label</h4>
<p>
This example creates a queue, opens the queue for sending messages, sets the label of a message, and sends the message to the queue.</p>
<p>
To try this example using Microsoft® Visual Basic® (version 5.0), paste the code into the Code window of a form, run the example, and click the form.</p>
<pre><code>Dim qinfo As MSMQQueueInfo
Dim q As MSMQQueue
Dim msg As New MSMQMessage

Private Sub Form_Click()
   '*************************
   ' Create queue (no error
   ' handling if queue exists.
   '**************************
  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\LabelTest"
  qinfo.Label = "Test Queue"
  qinfo.Create
   '**************
   ' Open queue.
   '**************
  Set q = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
   '**************
   ' Send Message.
   '**************
  msg.Label = "Test Message"
  msg.Body = "This is a test message with a string Body."
  msg.Send q
 
 
 q.Close

End Sub
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqactx_2wl5.htm"><b>Body</b></a>, <a href="mqactx_9mp1.htm"><b>Close</b></a>, <a href="mqactx_6605.htm"><b>Create</b></a>, <a href="mqactx_2k2t.htm"><b>FormatName</b></a>, <a href="mqactx_54px.htm"><b>MSMQMessage</b></a>, <a href="mqactx_1qcl.htm"><b>MSMQQueue</b></a>, <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a>, <a href="mqactx_61bi.htm"><b>Open</b></a>, <a href="mqactx_823p.htm"><b>PathName</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
