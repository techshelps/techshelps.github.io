<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Auditing</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_auditing"></a>Auditing</h2>
<p>
MSMQ allows you to audit access operations for your MSMQ enterprise, sites, connected networks (CNs), computers, and queues.</p>
<p>
For the most part, auditing is set up and maintained by the MSMQ Explorer (for a complete description of auditing, see the <i>Microsoft Message Queue Server Administrator's Guide</i>). However, it is possible to audit queue operations by modifying the system access control list (SACL) of the queue's security descriptor.</p>
<p>
The following queue operations can be audited:
<ul>
<li>
MQSEC_DELETE_MESSAGE. When combined with MQSEC_PEEK_MESSAGE, the user can retrieve messages from the queue. MSMQ does not explicitly delete messages that are in queues. When a receive operation is requested, MSMQ peeks at the message and deletes it from the queue.</li>
<li>
MQSEC_DELETE_JOURNAL_MESSAGE. When combined with MQSEC_PEEK_MESSAGE, the user can retrieve messages from a journal queue. MSMQ does not explicitly delete messages that are in queues. When a receive operation is requested, MSMQ peeks at the message and deletes it from the queue.</li>
<li>
MQSEC_PEEK_MESSAGE. The user can look (peek) at messages from a queue. Messages cannot be removed.</li>
<li>
MQSEC_GET_QUEUE_PROPERTIES. The user can retrieve the queue's properties.</li>
<li>
MQSEC_SET_QUEUE_PROPERTIES. The user can set the queue's properties.</li>
<li>
MQSEC_DELETE_QUEUE. The user can delete the queue (equivalent to DELETE: as defined in the Win32 header files).</li>
<li>
MQSEC_GET_QUEUE_PERMISSIONS. The user can retrieve the queue's security descriptor (equivalent to READ_CONTROL: as defined by the Win32 header files).</li>
<li>
MQSEC_CHANGE_QUEUE_PERMISSIONS. The user can modify the discretionary access control list (DACL) of the queue's security descriptor (equivalent to WRITE_DAC: as defined by the Win32 header files).</li>
<li>
MQSEC_TAKE_QUEUE_OWNERSHIP: The user can change the queue's owner in the queue's security descriptor (equivalent to WRITE_OWNER: as defined by the Win32 header files).</li>
</ul>
<p>
Audit log messages are written in the event log on the server that performs the actual operation, not necessarily the server that owns the object. For example, audits for opening a queue are logged on the computer where the queue resides. However, other operations (such as setting queue properties) are logged on the machine that performed the operation. As a result, the audit messages for a queue can be logged on servers throughout your MSMQ enterprise.</p>
<p>
<b>Note</b>&nbsp;&nbsp;The send operation cannot be audited.</p>
<p>
For applications using MSMQ API functions, call <a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a> to modify the queue's security descriptor.</p>
<p>&nbsp;</p></body>
</HTML>
