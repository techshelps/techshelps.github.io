<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPID_Q_TYPE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_propid_q_type"></a>PROPID_Q_TYPE</h1>
<p>
Optional. The PROPID_Q_TYPE property specifies the type of service provided by the queue. The queue's type allows applications to categorize their queues according to how they are used.
<dl>
<dt>
Type Indicator</dt>
<dd>
VT_CLSID</dd>
<dt>
PROPVARIANT Field</dt>
<dd>
*puuid</dd>
<dt>
Property Values</dt>
<dd>
GUID value. The default is NULL_GUID. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The queue's service type can be used to identify the queue.</p>
<p>
It is recommended that the service type of the queue be specified when the queue is created. In most cases, the service type of the queue can be defined by the application. However, some queues used by MSMQ require a specific MSMQ-defined service type. For example, input queues used by the <a href="mqmapimn_1h9v.htm">MSMQ mail services</a> have a specific MSMQ-defined MAPI service type.</p>
<p>
<b>Note</b>&nbsp;&nbsp;To generate a GUID, run the Uuidgen.exe program provided by Microsoft Developer Network. (For information about Uuidgen.exe, see the Microsoft Platform SDK.)</p>
<p>
The queue's service type can also be used to locate public queues registered in <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a> (see <a href="mqfunc_1gha.htm"><b>MQLocateBegin</b></a> and <a href="mqfunc_416c.htm"><b>MQLocateNext</b></a>).</p>
<p>
To set the queue's initial service type, specify PROPID_Q_TYPE in the<b> MQQUEUEPROPS</b> structure and call <a href="mqfunc_8dut.htm"><b>MQCreateQueue</b></a>.</p>
<p>
To change the queue's service type, specify PROPID_Q_TYPE in the<b> MQQUEUEPROPS</b> structure and call <a href="mqfunc_0wxf.htm"><b>MQSetQueueProperties</b></a> with a new GUID.</p>
<p>
To retrieve the service type of a queue, specify PROPID_Q_TYPE in the <b>MQQUEUEPROPS</b> structure and call <a href="mqfunc_8b03.htm"><b>MQGetQueueProperties</b></a> and examine its returned value.</p>
<p>
<b>Note</b>&nbsp;&nbsp;The returned queue identifier is a binary GUID. To convert the returned GUID to a string, use <b>UUIDToString()</b>. This function is described in the Platform SDK. When using this function, include the rpc.h header file in your source code.</p>
<h4>Example</h4>
<p>
This example shows how PROPID_Q_INSTANCE is specified in the <b>MQQUEUEPROPS</b> structure for both setting and retrieving the queue type. Note that when you are retrieving the queue type, a buffer of type CLSID must be declared to receive the returned GUID.</p>
<pre><code>//To set the queue type
aPropID[i] = PROPID_Q_TYPE;                 // Property identifier
aVariant[i].vt = VT_CLSID;                  // Type indicator
aVariant[i].puuid = &amp;PRINTER_SERVICE_TYPE;  // Service type of queue

//To retrieve the queue type
CLSID TypeBuffer;
aPropID[i] = PROPID_Q_TYPE;        // Property identifier
aVariant[i].vt = VT_CLSID;         // Type indicator
aVariant[i].puuid = &amp;TypeBuffer
i++
 </code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>For complete examples of…</th>
<th align=left width=52%>See…</th>
</tr>
<tr valign=top>
<td width=48%>Creating a public or private queue</td>
<td width=52%><a href="msmquse_02g9.htm">Creating a Queue</a></td>
</tr>
<tr valign=top>
<td width=48%>Locating a public queue by its service type</td>
<td width=52%><a href="msmquse_4wo9.htm">Locating a Public Queue</a></td>
</tr>
<tr valign=top>
<td width=48%>Retrieving the queue's service type </td>
<td width=52%><a href="msmquse_2aud.htm">Retrieving PROPID_Q_TYPE</a></td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mq.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqrt.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<h4>See Also</h4>
<p>
<a href="mqfunc_8dut.htm"><b>MQCreateQueue</b></a>, <a href="mqfunc_8b03.htm"><b>MQGetQueueProperties</b></a>, <a href="mqfunc_1gha.htm"><b>MQLocateBegin</b></a>, <a href="mqfunc_416c.htm"><b>MQLocateNext</b></a>, <a href="mqfunc_0wxf.htm"><b>MQSetQueueProperties</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
