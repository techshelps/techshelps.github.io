<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending Messages to a Queue</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_sending_messages_to_a_queue_api"></a>Sending Messages to a Queue</h2>
<p>
Sending messages is typically a two-function operation: a single call to <a href="mqfunc_42hx.htm"><b>MQOpenQueue</b></a> to open the queue and then one or more calls to <a href="mqfunc_8ip1.htm"><b>MQSendMessage</b></a>. After the queue is opened, the application can send any number of messages to the queue.</p>
<p>
For examples of sending different types of messages, see:
<ul>
<li>
<a href="msmquse_9fu1.htm">Sending Messages That Request Acknowledgments</a> </li>
<li>
<a href="msmquse_8w2x.htm">Sending Messages That Request a Response</a> </li>
<li>
<a href="msmquse_552h.htm">Sending Private Messages</a> </li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;Transaction messages can only be sent to transaction queues, and non-transaction messages can only be sent to non-transaction queues.</p>
<p>
Message are defined by a set of properties specified in an <a href="mqstruc_559v.htm"><b>MQMSGPROPS</b></a> structure. This structure provides the number of properties that will be sent with the message, identifiers for each property, and the value of each property.</p>
<h4>Message Properties</h4>
<p>
The following are general message properties that can be set by the application (length properties that are associated with another property are not included):</p>
<p>
<a href="mqprop_9411.htm">PROPID_M_ACKNOWLEDGE</a> </p>
<p>
<a href="mqprop_0yp1.htm">PROPID_M_ADMIN_QUEUE</a> </p>
<p>
<a href="mqprop_4gpv.htm">PROPID_M_APPSPECIFIC</a> </p>
<p>
<a href="mqprop_6wzd.htm">PROPID_M_BODY</a> </p>
<p>
<a href="mqprop_4bj9.htm">PROPID_M_BODY_TYPE</a> </p>
<p>
<a href="mqprop_8pd1.htm">PROPID_M_CONNECTOR_TYPE</a> </p>
<p>
<a href="mqprop_0hwk.htm">PROPID_M_CORRELATIONID</a> </p>
<p>
<a href="mqprop_28e1.htm">PROPID_M_DELIVERY</a> </p>
<p>
<a href="mqprop_8h4e.htm">PROPID_M_EXTENSION</a> </p>
<p>
<a href="mqprop_20q4.htm">PROPID_M_JOURNAL</a> </p>
<p>
<a href="mqprop_9pnw.htm">PROPID_M_LABEL</a> </p>
<p>
<a href="mqprop_7abd.htm">PROPID_M_PRIORITY</a> </p>
<p>
<a href="mqprop_204l.htm">PROPID_M_RESP_QUEUE</a> </p>
<p>
<a href="mqprop_531g.htm">PROPID_M_TIME_TO_BE_RECEIVED</a> </p>
<p>
<a href="mqprop_8ahx.htm">PROPID_M_TIME_TO_REACH_QUEUE</a> </p>
<p>
<a href="mqprop_1w2t.htm">PROPID_M_TRACE</a> </p>
<p>
<a href="mqprop_30dh.htm">PROPID_M_XACT_STATUS_QUEUE</a> </p>
<h4>Security Message Properties</h4>
<p>
Security message properties are used for authenticating and encrypting messages. The following security message properties can be set by the application:</p>
<p>
<a href="mqprop_1gz0.htm">PROPID_M_AUTH_LEVEL</a> </p>
<p>
<a href="mqprop_554p.htm">PROPID_M_DEST_SYMM_KEY</a> </p>
<p>
<a href="mqprop_73on.htm">PROPID_M_ENCRYPTION_ALG</a> </p>
<p>
<a href="mqprop_4dpj.htm">PROPID_M_HASH_ALG</a> </p>
<p>
<a href="mqprop_1y5o.htm">PROPID_M_PRIV_LEVEL</a> </p>
<p>
<a href="mqprop_9tt1.htm">PROPID_M_PROV_NAME</a> </p>
<p>
<a href="mqprop_5nfp.htm">PROPID_M_PROV_TYPE</a> </p>
<p>
<a href="mqprop_27lg.htm">PROPID_M_SECURITY_CONTEXT</a> </p>
<p>
<a href="mqprop_2nsk.htm">PROPID_M_SENDER_CERT</a> </p>
<h4>MSMQ-Generated Messages Properties</h4>
<p>
The following message properties are set by MSMQ and should not be specified by the sending application. They are attached to the message when it is sent.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Message Property</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_7orp.htm">PROPID_M_ARRIVEDTIME</a></td>
<td width=52%>Indicates when the message arrived at its target queue.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_4a78.htm">PROPID_M_AUTHENTICATED</a></td>
<td width=52%>Indicates if the message was authenticated.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_53qr.htm">PROPID_M_CLASS</a></td>
<td width=52%>Indicates the type of message (such as normal, acknowledgment, or report).</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_1let.htm">PROPID_M_DEST_QUEUE</a> </td>
<td width=52%>Indicates the destination of the message.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_0vxg.htm">PROPID_M_MSGID</a></td>
<td width=52%>Indicates the message's MSMQ-generated identifier.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_0p7o.htm">PROPID_M_SENDERID</a></td>
<td width=52%>Indicates the identifier of the sending application.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_676t.htm">PROPID_M_SENDERID_TYPE</a></td>
<td width=52%>Indicates the type of identifier found by MSMQ.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_7p5x.htm">PROPID_M_SENTTIME</a></td>
<td width=52%>Indicates when the message was sent.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_1hwl.htm">PROPID_M_SIGNATURE</a></td>
<td width=52%>Indicates the digital signature of the message.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_3qxw.htm">PROPID_M_SRC_MACHINE_ID</a></td>
<td width=52%>Indicates the machine identifier of the computer from where the message was sent.</td>
</tr>
<tr valign=top>
<td width=48%><a href="mqprop_0u26.htm">PROPID_M_VERSION</a></td>
<td width=52%>Indicates what version of MSMQ the sending application is running.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
