<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving a Queue's Properties Using ActiveX Components</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_retrieving_a_queue_s_properties_using_activex_components"></a>Retrieving a Queue's Properties Using ActiveX Components</h2>
<p>
After a queue is created, the <a href="mqactx_01nz.htm"><b>MSMQQueueInfo</b></a> object's properties can be reset at any time by calling the object's <a href="mqactx_9h9k.htm"><b>Refresh</b></a> method.</p>
<p>
<b>Refresh</b> has two uses. It is required before an application can read any queue property that is set by MSMQ (MSMQ-generated properties such as <a href="mqactx_8ht0.htm"><b>QueueGuid</b></a> cannot be used until <b>Refresh</b> is called). Second, it can be used to refresh the properties of the <b>MSMQQueueInfo</b> object when another application resets a queue's properties. When <b>Refresh</b> is called, it updates all of the queue's properties, not just those set by the application. However, you can only refresh the properties of private queues if the queue is located on your local computer. To see a list of queue properties, scroll to the bottom of this topic.</p>
<p>
<b>Note</b>&nbsp;&nbsp;Properties of public queues can also be retrieved by doing a query on <a href="msmqglos_3wv5.htm#_mq_active_directory_gly">Active Directory</a>. For details, see <a href="actvxuse_48fs.htm">Locating a Public Queue</a>. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To retrieve a queue's properties</h5>
<ol>
<li>
Determine whether the sending application has the access rights to look at the queue's properties. If the application does not have MQSEC_GET_QUEUE_PROPERTIES access rights, an MQ_ERROR_ACCESS_DENIED error is returned to <a href="mqactx_9h9k.htm"><b>Refresh</b></a>. For a complete list of queue access rights, see <a href="msmq_guide_8i0c.htm">Access Control</a>.</li>
<li>
Call <b>Refresh</b>.</li>
</ol>
<h4>Example</h4>
<p>
This example creates a public queue and uses <b>Refresh</b> to update the <b>MSMQQueueInfo</b> so it can display the queue's identifier (<b>QueueGuid</b>). To try this example using Microsoft® Visual Basic® (version 5.0), paste the code into the Declaration section of a form that has a single text box, run the example, and click the form.</p>
<pre><code>Dim qinfo As New MSMQQueueInfo
   
Private Sub Form_Click()

  Set qinfo = New MSMQQueueInfo
  qinfo.PathName = ".\RefreshTest"
  qinfo.Label = "Test Queue"
  qinfo.Create
   
  qinfo.Refresh          'Required to update QueueGuid
  Text1.Text = "quidQueue = " + CStr(qinfo.QueueGuid)
 
End Sub
 </code></pre>
<h4>Queue Properties</h4>
<p>
The following queue properties can be retrieved:</p>
<p>
<a href="mqactx_8a5h.htm"><b>Authenticate</b></a> </p>
<p>
<a href="mqactx_6kft.htm"><b>BasePriority</b></a> </p>
<p>
<a href="mqactx_99nw.htm"><b>Journal</b></a> </p>
<p>
<a href="mqactx_57c1.htm"><b>JournalQuota</b></a> </p>
<p>
<a href="mqactx_30do.htm"><b>Label</b></a> </p>
<p>
<a href="mqactx_3iuk.htm"><b>PrivLevel</b></a> </p>
<p>
<a href="mqactx_4ijl.htm"><b>Quota</b></a> </p>
<p>
<a href="mqactx_63vo.htm"><b>ServiceTypeGuid</b></a> </p>
<p>
The following queue properties are set by MSMQ when it creates the queue. To read these properties, the application must explicitly call <a href="mqactx_9h9k.htm"><b>Refresh</b></a> before they can be read.</p>
<p>
<a href="mqactx_7rqd.htm"><b>CreateTime</b></a> (public queues only)</p>
<p>
<a href="mqactx_2k2t.htm"><b>FormatName</b></a> (public and private queues)</p>
<p>
<a href="mqactx_91yk.htm"><b>IsTransactional</b></a> (public and private queues)</p>
<p>
<a href="mqactx_3uhx.htm"><b>ModifyTime</b></a> (public queues only)</p>
<p>
<a href="mqactx_8ht0.htm"><b>QueueGuid</b></a> (public queues only)</p>
<p>&nbsp;</p></body>
</HTML>
