<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Access Control</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mq_access_control"></a>Access Control</h2>
<p>
Operations on queues can be restricted to a specific user or group of users. When a queue is created, a security descriptor is included in the call to specify who has access rights to the queue's operations.</p>
<p>
Queue operations that can be set include creating, deleting, and opening a queue (for sending messages to and reading messages from the queue). Operations also include getting and setting a queue's properties and security descriptor.</p>
<p>
For applications using API functions, the security descriptor is specified by the <i>lpSecurityDescriptor</i> parameter of <a href="mqfunc_8dut.htm"><b>MQCreateQueue</b></a>. For applications using ActiveX components, the default security descriptor is automatically attached to the queue when it is created and can only be changed using API functions.</p>
<p>
Before MSMQ performs any operation on a queue, it checks the queue's security descriptor to determine if the user has sufficient access rights to perform the requested operation. To do this, MSMQ checks whether the operation is restricted. If the operation is restricted, MSMQ then checks the identity of the user to see if the restriction applies to that user. If it does, the operation is not allowed to continue.</p>
<p>
With the exception of putting a new message in a queue, MSMQ can verify the identity of the user by the access token attached to the process. Access tokens are produced by the system. When a user logs on, the system verifies the user's password by comparing it with information stored in the system's security database. If the password is valid, the system produces an access token and attaches it to each process started by the user.</p>
<p>
However, MSMQ cannot use this access to put a new message in the queue. Instead, it uses a security identifier (SID) that MSMQ attached to the message when it was sent. Similar to the access token, the user's SID is created by the application. For a description of access tokens and SIDs, see the Security section in the Microsoft Platform SDK.</p>
<p>
Applications can retrieve or modify the security descriptor of a queue if they have sufficient access rights. See <a href="mqfunc_2w6x.htm"><b>MQGetQueueSecurity</b></a> and <a href="mqfunc_4rg9.htm"><b>MQSetQueueSecurity</b></a>.</p>
<p>&nbsp;</p></body>
</HTML>
