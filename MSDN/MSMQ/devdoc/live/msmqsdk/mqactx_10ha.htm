<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EnableNotification</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mq_enablenotification"></a>EnableNotification<br>
<a href="mqactx_1qcl.htm">MSMQQueue</a></h1>
<p>
The <b>EnableNotification</b> method starts event notification for asynchronously reading messages in the queue. Once this method is called, applications can asynchronously <a href="msmqglos_3wvk.htm#_mq_peek_gly">peek</a> at messages or <a href="msmqglos_3wvm.htm#_mq_retrieve_gly">retrieve</a> them from the queue in a user-defined event handler.</p>
<h4>Syntax</h4>
<pre><code><i>object</i>.<b>EnableNotification </b>(<i>Event</i>[<i>, Cursor</i>][<i>,ReceiveTimeout</i>])
 </code></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Syntax Element</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><i>object</i></td>
<td width=64%>Queue (<b>MSMQQueue</b>) object that represents the open instance of the queue.</td>
</tr>
<tr valign=top>
<td width=36%><i>Event</i></td>
<td width=64%>References an <a href="mqactx_27p0.htm"><b>MSMQEvent</b></a> object.</td>
</tr>
<tr valign=top>
<td width=36%><i>Cursor</i></td>
<td width=64%>Optional. Specifies the action of the cursor.<p>
MQMSG_FIRST: Default. Notification starts when a message is in the queue.</p>
<p>
MQMSG_CURRENT: Notification starts when a message is at the current location of the cursor.</p>
<p>
MQMSG_NEXT: The cursor is moved, then notification starts when a message is at the new cursor location.</p>
</td>
</tr>
<tr valign=top>
<td width=36%><i>ReceiveTimeout</i></td>
<td width=64%>Optional. Specifies how long (in milliseconds) MSMQ waits for a message to arrive.</td>
</tr>
</table><br>
<h4>Return Codes</h4>
<p>
For information on return codes, see <a href="mqfunc_9pgz.htm">MSMQ Error and Information Codes</a>. </p>
<h4>Remarks</h4>
<p>
When <b>EnableNotification</b> is called, events are triggered when a message is found at the position specified by <i>Cursor</i>. When the default setting is used, events are triggered when a message is in the queue.</p>
<p>
<b>EnableNotification</b> fires a single <a href="mqactx_0rl0.htm"><b>Arrived</b></a> event when it finds a message. To read more messages, <b>EnableNotification</b> must be explicitly called again from within the event handler.</p>
<p>
The <b>Arrived</b> event is triggered on the <a href="mqactx_27p0.htm"><b>MSMQEvent</b></a> object passed in<i> Event.</i> The <b>MSMQEvent_Arrived</b> event handler (typically implemented by the user) is passed a reference to the queue where the message arrived.</p>
<p>
<b>Note</b>&nbsp;&nbsp;In Microsoft® Visual Basic®, the application's event handler can still be invoked even if the form it is on has been unloaded by the application. When the event handler is fired, Visual Basic reloads the form automatically if any of its members (for example, a message box on the form) are referred to.</p>
<p>
When an <b>Arrived</b> event is triggered, there is no guarantee that the message that triggered the event will still be available when the application tries to use the message. All queues are dynamic, and other clients may remove the arrived message before it can be used. It is up to the application to determine if the message is there before attempting to peek at the message or retrieve it. (If the queue is not being shared, it is safe to assume that the message is still there.)</p>
<p>
Invoking <b>EnableNotification</b> with <i>ReceiveTimeout</i> set to 0 is similar to synchronously calling <a href="mqactx_0otn.htm"><b>Peek</b></a>.</p>
<p>
Receive errors (such as time-out errors) trigger an <a href="mqactx_21te.htm"><b>ArrivedError</b></a> event on the associated <b>MSMQEvent </b>object.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 SP3 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mqoai.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mqoa.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined only as Unicode.</p>
<p>&nbsp;</p></body>
</HTML>
