<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>optimize</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_optimize"></a>optimize</h1>
<p>
<b>optimize&nbsp;("</b><i>optimization-options</i>"<b>)</b>
<dl>
<dt>
<i>optimization-options</i></dt>
<dd>
Specifies the method of marshalling data. Use either "s" for mixed-mode marshalling or "i" for interpreted marshalling.
</dd>
</dl>
<h4>Examples</h4>
<pre><code>optimize ("s") HRESULT FasterProcedure(...); 
optimize ("i") HRESULT SmallerProcedure(...); 
{ 
}; 
 </code></pre>
<h4>Remarks</h4>
<p>
The keyword <b>optimize</b> is used to fine-tune the level of gradation for marshalling data.</p>
<p>
This version of RPC provides two methods for marshalling data: mixed-mode ("s") and interpreted ("i"). These methods correspond to the <b>/Os</b> and <b>/Oi</b> command-line switches. The interpreted method marshals data completely offline. While this can reduce the size of the stub considerably, performance can be affected.</p>
<p>
If performance is a concern, the mixed-mode method can be the best approach. Mixed-mode allows the MIDL compiler to make the determination between which data will be marshalled inline and which will be marshalled by a call to an offline dynamic-link library. If many procedures use the same data types, a single procedure can be called repeatedly to marshal the data. In this way, data that is most suited to inline marshalling is processed inline while other data can be more efficiently marshalled offline.</p>
<p>
Note that the <b>optimize</b> attribute can be used as an interface attribute or as an operation attribute. If it is used as an interface attribute, it sets the default for the entire interface, overriding command-line switches. If, however, it is used as an operation attribute, it affects only that operation, overriding command-line switches and the interface default.</p>
<h4>See Also</h4>
<p>
<a href="mi-laref_1e5o.htm"><b>ACF</b></a>, <a href="mi-cmdln_08bt.htm"><b>/Oi</b></a>, <a href="mi-cmdln_08c3.htm"><b>/Os</b></a></p>
<p>&nbsp;</p></body>
</HTML>
