<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>message</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_message"></a>message</h1>
<p>
<b>[message</b>,&nbsp;<i>optional-attribute-list</i><b>]&nbsp;void</b><i>&nbsp;function-name(</i><br>
<b>&nbsp;&nbsp;&nbsp;&nbsp;[in</b>,&nbsp;<i>optional-parameter-attributes</i><b>]&nbsp;</b><i>param-name,.&nbsp;.&nbsp;.);</i>
<dl>
<dt>
<i>optional-attribute-list</i></dt>
<dd>
Other attributes that apply to the function. Only the <b>local</b>, <b>nocode</b>, <b>code,</b> and <b>optimize</b> attributes may be used with the <b>message </b>attribute.
</dd>
</dl>
<h4>Example</h4>
<pre><code>[message] void DisplayString(
[in, string] char * p1);
 
[message] void VarDataArray(
                [in, size_is(iSize)] ARRAY_TYPE lpMyArray,
                [in] int iSize,
                [in] unsigned long ulChksum);
 </code></pre>
<h4>Remarks</h4>
<p>
The <b>message</b> attribute indicates that the remote procedure call is to be treated as a "message" from the client to the server. As such, the call is delivered asynchronously over the <a href="mi-laref_7tm9.htm"><b>ncadg_mq</b></a> message-queuing transport. You can indicate synchronous-mode messaging by specifying the <b>ncadg_mq</b> transport protocol without using the <b>message</b> attribute. </p>
<p>
By specifying asynchronous-mode messaging, the <b>message</b> attribute allows the client to make the remote procedure call and return immediately, even when the server application is not responding. If the target server is not available, the call will be stored until the server becomes available. </p>
<p>
In addition, asynchronous-mode messaging lets you control message-queue properties of the receive queue for the server. See <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_rpcbindingsetoption">
</object><a href=JavaScript:alink_1.Click()><b>RpcBindingSetOption</b></a> for more information on selecting quality of service, call priority, and call lifetime for the server process. </p>
<p>
The following restrictions also apply to the <b>message</b> attribute:
<ul>
<li>
Microsoft Message Queuing must be implemented in the client and server systems and the systems must be visible to each other as determined by the scope of the message queue installation.</li>
<li>
The binding must use well-known endpoints and the <b>ncadg_mq</b> transport protocol.</li>
<li>
The function cannot contain output parameters or a return type other than <b>void</b>. Note that the latter restriction makes the <b>message</b> attribute unsuitable for COM (<b>object</b>) interface methods, at this time. The next release of MIDL will permit <b>message</b> functions to return error_status_t or HRESULT.</li>
<li>
Any interface that contains at least one <b>message </b>call must be registered by calling<b> <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_rpcserverregisterif">
</object><a href=JavaScript:alink_2.Click()>RpcServerRegisterIf</a></b> or <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_rpcserverregisterifex">
</object><a href=JavaScript:alink_3.Click()><b>RpcServerRegisterIfEx</b></a><b> </b><i>before</i> calling <b>RpcServerUseProtseqEpEx(ncadg_mq)</b>. Otherwise, calls that were waiting on the queue for the server will be read before the interface is registered, and the calls will fail.</li>
</ul>
<h4>See Also</h4>
<p>
<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_rpc_message_queuing">
</object><a href=JavaScript:alink_4.Click()><b>RPC Message Queuing</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_rpcbindingsetoption">
</object><a href=JavaScript:alink_5.Click()><b>RpcBindingSetOption</b></a>, <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_rpcbindinginqoption">
</object><a href=JavaScript:alink_6.Click()><b>RpcBindingInqOption</b></a>, <a href="mi-laref_7tm9.htm"><b>ncadg_mq</b></a></p>
<p>&nbsp;</p></body>
</HTML>
