<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dual</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_dual"></a>dual</h1>
<p>
<b>[uuid</b>, <b>oleautomation</b>, <b>dual</b> [, <i>optional-attribute-list</i>]<b>] <br>
interface </b><i>interfacename<br>
</i><b>{. . .};</b></p>
<h4>Example</h4>
<pre><code>[uuid(. . .), oleautomation, dual]
    interface IHello : Idispatch
    {
     //diverse and sundry properties and methods defined here
    };
 </code></pre>
<h4>Remarks</h4>
<p>
The <b>dual </b>attribute identifies an interface that exposes properties and methods through <b>IDispatch</b> and directly through the VTBL. The interface must be compatible with OLE Automation and be derived from <b>IDispatch</b>. The attribute is not allowed on dispinterfaces.</p>
<p>
The <b>dual</b> attribute creates an interface that is both a <b>Dispatch</b> interface and a Component Object Model (COM) interface. The first seven entries of the VTBL for a dual interface are the seven members of <b>IDispatch</b>, and the remaining entries are OLE COM entries for direct access to members of the dual interface. All the parameters and return types specified for members of a dual interface must be OLE Automation-compatible types.</p>
<p>
All members of a dual interface must pass an HRESULT as the function return value. Members, such as property accessor functions, that need to return other values, such as should specify the last parameter as [<b>out, <a href="mi-laref_3kx8.htm">retval</a></b>], indicating an output parameter that returns the value of the function. In addition, members that need to support multiple locales should pass an <a href="mi-laref_0ap0.htm"><b>lcid</b></a> parameter.</p>
<p>
A dual interface provides for both the speed of direct VTBL binding and the flexibility of <b>IDispatch</b> binding. For this reason, dual interfaces are recommended whenever possible.</p>
<p>
<b>Note</b>&nbsp;&nbsp;If your application accesses object data by casting the <b>this</b> pointer within the interface call, you should check the VTBL pointers in the object against your own VTBL pointers to ensure that you are connected to the appropriate proxy.</p>
<p>
Specifying <b>dual</b> on an interface implies that the interface is compatible with OLE Automation, and therefore causes both the TYPEFLAG_FDUAL and TYPEFLAG_FOLEAUTOMATION flags to be set.</p>
<h4>Flags</h4>
<p>
TYPEFLAG_FDUAL, TYPEFLAG_FOLEAUTOMATION</p>
<h4>See Also</h4>
<p>
<a href="mi-laref_1hut.htm"><b>interface</b></a>, <a href="mi-laref_9yjy.htm"><b>oleautomation</b></a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_oa96_odl_file_syntax">
</object><a href=JavaScript:alink_1.Click()>ODL File Syntax</a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_oa96_odl_file_example">
</object><a href=JavaScript:alink_2.Click()>ODL File Example</a>, <a href="mi-files_7jl8.htm">Generating a Type Library With MIDL</a></p>
<p>&nbsp;</p></body>
</HTML>
