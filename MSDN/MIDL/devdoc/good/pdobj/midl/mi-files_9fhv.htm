<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Targetting Stubs for Specific 32-Bit Platforms</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_targetting_stubs_for_specific_32_bit_platforms"></a>Targeting Stubs for Specific 32-Bit Platforms</h1>
<p>
Some of the features of Microsoft RPC and the MIDL 3.0 compiler are platform-specific and are intended for implementation in distributed applications that run only on Windows NT 4.0 or a later version. Some features are supported in Windows NT 3.51 and Windows 95, as well as in later versions, but are not supported on older 32-bit, or 16-bit platforms. </p>
<p>
As a safeguard, the MIDL 3.0 compiler generates macros that facilitate compatibility checking during the C compilation phase. If the interface uses features supported only on Windows NT 4.0, MIDL generates a TARGET_IS_NT40_OR_LATER macro. If supported features require Windows NT 3.51 or Windows 95, MIDL generates a TARGET_IS_NT351_OR_WIN95_OR_LATER macro. These macros, defined in rpcndr.h, depend on the environment variables WINVER and _WIN32_WINNT and are evaluated by the C/C++ compiler. </p>
<p>
If, at compile time, you get an error message indicating that you need a specific platform to run this stub, first check to make sure you have not used a feature not available on this platform. For example, the <b>pipe</b> type constructor, the /<b>Oif</b> compiler option, and the <b>user_marshal</b> and <b>wire_marshal</b> attributes are only available on Windows NT 4.0. Stubs using these features will not run on earlier systems. The /<b>Oic</b> compiler switch is available on NT. 3.51 and Windows 95, but is not available in earlier versions.</p>
<p>
Also, the technology needed to use OLE and OLE Automation data types (for example, BSTR or STGMEDIUM) in remote operations is present only on NT 4.0. Therefore, you cannot develop a custom interface that uses these data types in a remote procedure call to run on earlier platforms. </p>
<p>
If you know that your target platform is correct for the features you are using, you need to explicitly set the environment variables in your makefile.</p>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build for Windows NT 3.51 or Windows 95</h5>
<p>
Add this line to your makefile:</p>
<pre><code>CFLAGS = $(CFLAGS) -DWINVER=0x400 <b> </b>
 </code></pre>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build for Windows NT 4.0</h5>
<p>
Add this line to your makefile:</p>
<pre><code>CFLAGS = $(CFLAGS) -D_WIN32_WINNT=0x400
 </code></pre>
<p>
Note that this target control is not in effect when you are building for MS-DOS, 16-bit Windows, or Macintosh platforms. </p>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build for Windows NT 3.5</h5>
<p>
A specific compiler-linker preprocessor definition exists that turns off functions added after the Windows NT 3.5 release. This macro is declared in RPCPROXY.H. To specify that the target platform is Windows NT 3.5, add the following compiler-linker command to your makefile:</p>
<pre><code>CL -DNT35_STRICT

 -DNT35_STRICT
        Specifies that the target platform is Windows NT 3.5. This switch disables the new functions added after the Windows NT 3.5 release.
 </code></pre>
<h4>See Also</h4>
<p>
<a href="mi-cmdln_08bt.htm">/Oi</a>, <a href="mi-laref_3b39.htm">pipe</a>, <a href="mi-laref_1p2k.htm">wire_marshal</a>, <a href="mi-laref_96ss.htm">user_marshal</a>, <a href="mi-files_5wz7.htm">Marshaling OLE Data Types</a></p>
<p>&nbsp;</p></body>
</HTML>
