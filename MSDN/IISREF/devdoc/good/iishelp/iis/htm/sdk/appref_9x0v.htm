<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HSE_TF_INFO</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_in_hse_tf_info"></a>HSE_TF_INFO</h1>
<p>
This structure is used by to communicate information needed to use the Win32® <b>TransmitFile</b> function. It is supplied by the ISAPI extension when the HSE_REQ_TRANSMIT_FILE parameter is specified for the <i>dwHSERReques</i>t parameter of the <a href="appref_4gtq.htm"><b>ServerSupportFunction</b></a>.</p>
<pre><code>typedef struct _HSE_TF_INFO  {
    PFN_HSE_IO_COMPLETION   pfnHseIO;
    PVOID  pContext;   //open files with FILE_FLAG_SEQUENTIAL_SCAN
    HANDLE hFile; 
    LPCSTR pszStatusCode; // HTTP Status Code  eg: "200 OK"
    DWORD  BytesToWrite; // value of "0" means send entire file
    DWORD  Offset;       // offset value within file to start from
    PVOID  pHead;        // pointer to Headers to be sent before file
    DWORD  HeadLength;   // header length
    PVOID  pTail;        // pointer to Tail to be sent after file data
    DWORD  TailLength;   // tail length
    DWORD  dwFlags;      // includes HSE_IO_DISCONNET_AFTER_SEND, ...
} HSE_TF_INFO, * LPHSE_TF_INFO;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>pfnHseIO</b></dt>
<dd>
Points to the callback function that will be called on asynchronous I/O completion. These values, if non-null, will override values set by calling <b>ServerSupportFunction</b> with the HSE_REQ_IO_COMPLETION value set.</dd>
<dt>
<b>pContext</b></dt>
<dd>
Points to a Context structure that will be used in the asynchronous I/O callback. </dd>
<dt>
<b>hFile</b></dt>
<dd>
HTTP header and status code. These fields are used only if HSE_IO_SEND_HEADERS is present in <b>dwFlags</b>. The file should be opened using the Win32® <b>CreateFile</b> function with the FILE_FLAG_SEQUENTIAL_SCAN and FILE_FLAG_OVERLAPPED values turned on.</dd>
<dt>
<b>pszStatusCode</b></dt>
<dd>
The HTTP status code.</dd>
<dt>
<b>BytesToWrite</b></dt>
<dd>
If the value is set to 0, the entire file will be sent. </dd>
<dt>
<b>Offset</b></dt>
<dd>
The location in the file to start reading.</dd>
<dt>
<b>pHead</b></dt>
<dd>
An optional pointer to the headers which are to be sent before the file.</dd>
<dt>
<b>HeadLength</b></dt>
<dd>
The length of the headers.</dd>
<dt>
<b>pTail</b></dt>
<dd>
An optional pointer to a tail to be sent after the file.</dd>
<dt>
<b>TailLength</b></dt>
<dd>
The length of the tail.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
Flags that indicate the action to be taken by the server. Can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>HSE_IO_ASYNC</td>
<td width=52%>This flag must be set if ServerSupportFunction has been called with the HSE_REQ_TRANSMIT_FILE option.</td>
</tr>
<tr valign=top>
<td width=48%>HSE_IO_DISCONNECT_AFTER_SEND </td>
<td width=52%>Enables the server to optimally reuse its internal buffers and sockets for future connections. Using this flag improves the responsiveness by using system features optimally. However, the extension will not be able to do any further data transmission if this flag is selected, because the session to the client will be released.</td>
</tr>
<tr valign=top>
<td width=48%>HSE_IO_SEND_HEADERS </td>
<td width=52%>Specifies that custom header information should be transmitted to the client. The ISAPI extension can store the status code in the <b>pszStatusCode</b> member of the <b>HSE_TF_INFO</b> structure. When the header flag is turned on, IIS will automatically construct an appropriate HTTP header and send it to the client along with the file contents. If this flag is used for header transmission, the ISAPI extension should not send its own header using the HSE_REQ_SEND_RESPONSE_HEADERS or HSE_REQ_SEND_RESPONSE_HEADERS_EX values in <b>ServerSupportFunction</b>.</td>
</tr>
</table><br>

</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
