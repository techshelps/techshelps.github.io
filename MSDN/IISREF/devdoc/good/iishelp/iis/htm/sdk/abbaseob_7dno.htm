<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>METADATA_RECORD</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_metadata_record"></a>METADATA_RECORD</h1>
<p>
The <b>METADATA_RECORD</b> structure contains information about a metabase entry. It is used as an input parameter by the <b>SetData</b> method and as an input/output parameter by methods that retrieve data from the metabase, such as <b>GetData</b>, <b>EnumData</b>, or <b>GetAllData</b>.</p>
<pre><code>typedef struct  _METADATA_RECORD { 
    DWORD dwMDIdentifier; 
    DWORD dwMDAttributes; 
    DWORD dwMDUserType; 
    DWORD dwMDDataType; 
    DWORD dwMDDataLen; 
    unsigned char *pbMDData; 
    DWORD dwMDDataTag; 
}  METADATA_RECORD; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>dwMDIdentifier</b></dt>
<dd>
A DWORD that uniquely identifies the metabase entry, for example, MD_SERVER_STATE.</dd>
<dt>
<b>dwMDAttributes</b></dt>
<dd>
Flags that specify how to set or get data from the metabase. This member can be set to one or more of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Flag</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>METADATA_INHERIT</td>
<td width=52%><b>Set:</b> The data can be inherited. <p>
<b>Get:</b> Return inheritable data.</p>
</td>
</tr>
<tr valign=top>
<td width=48%>METADATA_INSERT_PATH</td>
<td width=52%>For a string data item: <p>
<b>Set:</b> Indicates the string contains MD_INSERT_PATH_STRINGW.</p>
<p>
<b>Get:</b> Replace MD_INSERT_PATH_STRINGW with the path of the data item relative to the handle</p>
</td>
</tr>
<tr valign=top>
<td width=48%>METADATA_ISINHERITED</td>
<td width=52%><b>Set: </b>Not valid.<p>
<b>Get: </b>Mark data items that were inherited.</p>
</td>
</tr>
<tr valign=top>
<td width=48%>METADATA_NO_ATTRIBUTES</td>
<td width=52%><b>Set:</b> The data does not have any attributes.<p>
<b>Get:</b> Not applicable. Data is returned regardless of this flag setting.</p>
</td>
</tr>
<tr valign=top>
<td width=48%>METADATA_PARTIAL_PATH</td>
<td width=52%><b>Set: </b>Not valid.<p>
<b>Get:</b> Return ERROR_SUCCESS and any inherited data even if the entire path is not present. This flag is only valid if METADATA_INHERIT is also set. </p>
</td>
</tr>
<tr valign=top>
<td width=48%>METADATA_REFERENCE</td>
<td width=52%><b>Set:</b> The data was retrieved by reference. <p>
<b>Get:</b> Not valid</p>
</td>
</tr>
<tr valign=top>
<td width=48%>METADATA_SECURE</td>
<td width=52%><b>Set:</b> Store and transport the data in a secure fashion. <p>
<b>Get:</b> Not valid.</p>
</td>
</tr>
<tr valign=top>
<td width=48%>METADATA_VOLATILE</td>
<td width=52%><b>Set:</b> Do not save the data in long term storage.<p>
<b>Get:</b> Not valid.</p>
</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwMDUserType</b></dt>
<dd>
A DWORD that specifies the user type of the data. When you use the <b>SetData</b> method to create a new data item, specify a user type above 2,000. User types 2,000 and below are reserved. When retrieving or updating data, this specifies the user type assigned to the data item. 
<p>
IIS currently uses these user types: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>User type</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%>ASP_MD_UT_APP</td>
<td width=64%>The entry contains information specific to ASP application configuration.</td>
</tr>
<tr valign=top>
<td width=36%>IIS_MD_UT_FILE</td>
<td width=64%>The entry contains information about a file, such as access permissions, or log on methods.</td>
</tr>
<tr valign=top>
<td width=36%>IIS_MD_UT_SERVER</td>
<td width=64%>The entry contains information specific to the server, such as ports in use and IP addresses.</td>
</tr>
<tr valign=top>
<td width=36%>IIS_MD_UT_WAM</td>
<td width=64%>The entry contains information specific to web application management.</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwMDDataType</b></dt>
<dd>
Identifies the type of data in the metabase entry. This parameter can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Data type</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>ALL_METADATA</td>
<td width=52%><b>Set:</b> Not valid<p>
<b>Get:</b> Return data regardless of type.</p>
</td>
</tr>
<tr valign=top>
<td width=48%>BINARY_METADATA</td>
<td width=52%>Binary data in any form.</td>
</tr>
<tr valign=top>
<td width=48%>DWORD_METADATA</td>
<td width=52%>An unsigned 32-bit number.</td>
</tr>
<tr valign=top>
<td width=48%>EXPANDSZ_METADATA</td>
<td width=52%>A null-terminated string that contains unexpanded environment variables, such as %PATH%. The environment variables are not expanded by the IIS Admin Base Object.</td>
</tr>
<tr valign=top>
<td width=48%>MULTISZ_METADATA</td>
<td width=52%>An array of null-terminated strings, terminated by two null characters.</td>
</tr>
<tr valign=top>
<td width=48%>STRING_METADATA</td>
<td width=52%>A null-terminated string.</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwMDDataLen</b></dt>
<dd>
A DWORD that specifies the length of the data in bytes. If the data is a string, this value includes the ending null character. For multisz data, this includes an additional null character after the final string. For example, the length of a multisz string containing two strings would be (wcslen(stringA) + 1) * sizeof(WCHAR) + (wcslen(stringB) + 1) * sizeof(WCHAR) + 1 * sizeof(WCHAR)
<p>
In-process clients need to specify <b>dwMDDataLen</b> only when setting binary and multisz values in the metabase. Remote applications must specify <b>dwMDDataLen</b> for all data types.
</dd>
<dt>
<b>pbMDData</b></dt>
<dd>
When setting a value in the metabase, points to a buffer that contains the data. When retrieving data from the metabase, points to a buffer to receive the data. </dd>
<dt>
<b>dwMDDataTag</b></dt>
<dd>
Reserved.
</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
