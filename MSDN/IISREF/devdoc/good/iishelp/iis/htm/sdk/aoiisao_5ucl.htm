<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Restore</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_restore"></a>Restore</h1>
<p>
You can use the <b>Restore</b> method of the <a href="aoiisao_2xpu.htm"><b>IIsComputer</b></a> object to restore the metabase from a backup. The restore operation stops all services dependent on IISADMIN, including all servers, until the restore has completed, then restarts all services. Because of this, if you are restoring the metabase using an ASP script, you must specify a machine name different from the one on which your script is executing. You may not use LocalHost as the machine name. You should be careful to plan for this service interruption when restoring the metabase from a backup. </p>
<h4>Syntax</h4>
<pre><code><b>IIsComputer</b>.<b>Restore</b> <i>BackupLocation</i>, <i>BackupVersion</i>, <i>BackupFlags</i> 
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>BackupLocation</i></dt>
<dd>
A string of up to 100 characters that specifies the backup location. If an empty string is specified, the backup will be retrieved from the default location. </dd>
<dt>
<i>BackupVersion</i></dt>
<dd>
Specifies the version number of the backup to be restored from the backup location, or may be the following constant. 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=52%>MD_BACKUP_HIGHEST_VERSION</td>
<td width=48%>Restore from the highest existing backup version in the specified backup location.</td>
</tr>
</table><br>

</dd>
<dt>
<i>BackupFlags</i></dt>
<dd>
Reserved. Must be zero.</dd>
</dl>
<h4>Code Example</h4>
<pre><code>&lt;% 
Dim ComputerObj, ComputerName 
' Restore metabase on a different computer 
ComputerName = "MyOtherComputer"
' You can use LocalHost if running under Windows Scripting Host 
Set ComputerObj = GetObject("IIS://" &amp; ComputerName) 
' Restore the highest number version in MyBackups 
ComputerObj.Restore "MyBackups", MD_BACKUP_HIGHEST_VERSION, 0 
%&gt; 
 </code></pre>
<h4>Remarks</h4>
<p>
You can use the <b>Restore</b> method with the LocalHost computer object in scripts running in a command window using Cscript.exe. See <a href="/iishelp/iis/htm/asp/wsho0lnp.htm"><b>Windows Scripting Host Programmer's Reference</b></a>. </p>
<h4>See Also</h4>
<p>
<a href="aoiisao_32cw.htm"><b>Backup</b></a>, <a href="aoiisao_1v8z.htm"><b>EnumBackups</b></a>, <a href="aoiisao_79rk.htm"><b>DeleteBackup</b></a></p>
<p>&nbsp;</p></body>
</HTML>
