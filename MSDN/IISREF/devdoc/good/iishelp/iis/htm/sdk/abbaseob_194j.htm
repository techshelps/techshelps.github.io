<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMSAdminBase::ChangePermissions</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_imsadminbase_changepermissions"></a>IMSAdminBase::ChangePermissions</h1>
<p>
The <b>IMSAdminBase;:ChangePermissions</b> method changes permissions on an open handle. If the handle was opened with write permission and you change it to read only, this method will cause any callback methods registered to be called.</p>
<pre><code><b>HRESULT ChangePermissions(
  METADATA_HANDLE</b><i> hMDHandle</i><b>,  </b>//metabase handle
<b>  DWORD</b><i> dwMDTimeOut</i><b>,          </b>//time, in milliseconds, for the 
                            <b> </b> // method to wait before failing
<b>  DWORD</b><i> dwMDAccessRequested </i><b> </b><i> </i>//specifies the new permissions for 
                            <b> </b> // the handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hMDHandle</i></dt>
<dd>
Specifies a handle to the metabase, as returned by the <b>IMSAdminBase::OpenKey</b> method.</dd>
<dt>
<i>dwMDTimeOut</i></dt>
<dd>
Specifies the time, in milliseconds, for the method to wait for the operation to succeed. </dd>
<dt>
<i>dwMDAccessRequested</i></dt>
<dd>
Specifies the new permissions for the handle. It must be at least one of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%>Value</th>
<th align=left width=48%>Description</th>
</tr>
<tr valign=top>
<td width=52%>METADATA_PERMISSION_READ</td>
<td width=48%>Open the key for reading. </td>
</tr>
<tr valign=top>
<td width=52%>METADATA_PERMISSION_WRITE</td>
<td width=48%>Open the key for writing.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns an HRESULT that contains one of the following values:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>ERROR_INVALID_HANDLE</td>
<td width=50%>The metabase handle is invalid.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_PATH_BUSY</td>
<td width=50%>The path specified cannot be used at this time.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_SUCCESS</td>
<td width=50%>The method succeeded</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
When you use this method to add permissions, success or failure follows the same rules as apply in <b>IMSAdminBase::OpenKey</b>. Timeout values should be short for this call; it is quite possible for two threads with read permission on the same data to attempt to update to write permission at the same time. Both will block until one read handle is closed.</p>
<p>&nbsp;</p></body>
</HTML>
