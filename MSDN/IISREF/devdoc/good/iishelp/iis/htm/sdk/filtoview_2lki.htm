<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a Filter</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_in_adding_a_filter"></a>Adding a Filter</h2>
<p>
You can install multiple filters in IIS. The notification order is based on the priority you specified in the filter. If you have set two filters to the same priority for a particular event, the order the filters were loaded into memory determines which filter is notified first. You can configure the <a href="aoiisao_4h6b.htm"><b>IISFilters</b></a> object in the metabase to determine the load order. </p>
<p>
In previous versions of IIS, all filters were notified of events they had registered for, regardless of which IIS service was involved. In IIS 4.0 and later versions, filters can be set either globally or they can be configured to only receive notifications for events that take place within a particular service. For example, you can configure a filter to apply only to FTP events, or only to Web events. </p>
<p>
Filters can be added to a Web Site either programmatically or with the Internet Service Manager snap-in to the Microsoft Management Console. Information on adding a filter with the Internet Service Manager is available in the <a href="../../../iis/htm/core/iiwarndg.htm">Installing and ISAPI filter</a> topic.</p>
<p>
The following script demonstrates adding a filter to a Web Site with a script. </p>
<pre><code>&lt;%
Dim CurrServer
Set CurrServer = GetObject("IIS:/LocalHost/W3svc/Filters")
CurrServer.Create("IIsFilter", "MyFilter") 
CurrServer.SetInfo

%&gt;</code></pre>
<p>
A more complete example is provided in the \Inetpub\iissamples\sdk\admin sub-directory.</p>
<p>&nbsp;</p></body>
</HTML>
