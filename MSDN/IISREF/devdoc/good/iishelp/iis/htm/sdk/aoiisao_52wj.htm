<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetDataPaths</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_getdatapaths"></a>GetDataPaths</h1>
<p>
The <b>GetDataPaths</b> method can be used with any of the IIS Admin Objects to find the paths to metabase keys where a specified property is located. This method can be used to find occurrences of a property that may be blocking inherited values from subordinate keys. The path search will start at the key associated with the object you use this method with and will return the starting path if the property is located at that key. For example, if you use this method with the <b>IIsWebServer</b> object for the third Web server, the search path would start at IIS://LocalHost/W3Svc/3 and would return the paths IIS://LocalHost/W3Svc/3, IIS://LocalHost/W3Svc/3/ROOT/VDir1, and IIS://LocalHost/W3Svc/3/ROOT/VDir1/Dir1/File1 if those were the keys where the property was found. </p>
<p>
A parameter to the method enables you to specify whether to search for the paths of an inheritable property or for the paths of a property regardless of whether or not it is inheritable. You can use this method to determine if a property is inheritable as well as where occurrences of it are located. </p>
<h4>Syntax</h4>
<pre><code><i>PathList = object.</i><b>GetDataPaths</b>(<i>Property</i>, <i>AttributeFlag</i>)
 </code></pre>
<h4>Parts</h4>
<dl>
<dt>
<i>PathList</i></dt>
<dd>
Receives the list of paths to occurrences of the specified property. </dd>
<dt>
<i>object</i></dt>
<dd>
An IIS Admin Object. Usually the result of a previous <b>GetObject</b> operation.</dd>
<dt>
<i>Property</i></dt>
<dd>
The name of the property whose paths are to be located. </dd>
<dt>
<i>AttributeFlag</i></dt>
<dd>
One of the following flags:
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=52%>IIS_ANY_PROPERTY</td>
<td width=48%>Retrieve paths regardless of whether or not the property is inheritable. </td>
</tr>
<tr valign=top>
<td width=52%>IIS_INHERITABLE_ONLY</td>
<td width=48%>Retrieve paths only if the property is inheritable. Return MD_ERROR_DATA_NOT_FOUND if property is not inheritable. </td>
</tr>
</table><br>


</dd>
</dl>
<h4>Remarks</h4>
<p>
You can use the <b>For each Path in PathList...Next</b> statement to retrieve individual paths from <i>PathList</i>. </p>
<h4>Code Example</h4>
<pre><code>&lt;% 
Const IIS_ANY_PROPERTY = 0 
Const IIS_INHERITABLE_ONLY = 1 
Const MD_ERROR_DATA_NOT_FOUND = &amp;H800CC801 
Dim WebSvrObj, PathList, vProperty 
On Error Resume Next 
' Get the object for the first Web server 
Set WebSvrObj = GetObject("IIS://LocalHost/W3SVC/1") 
' Get the paths where a property is located 
vProperty = "AccessFlags" 
PathList = WebSvrObj.GetDataPaths(vProperty, IIS_INHERITABLE_ONLY) 
If Err.Number = 0 Then 
    Response.Write "Paths for property " &amp; vProperty &amp; "&lt;BR&gt;" 
    For each Path in PathList 
        Response.Write Path &amp; "&lt;BR&gt;" 
    Next 
ElseIf Err.Number = MD_ERROR_DATA_NOT_FOUND Then 
    Response.Write "Property is not inheritable.&lt;BR&gt;" 
ElseIf Err.Number = &amp;H80005006 Then 
    Response.Write "Property does not exist.&lt;BR&gt;" 
Else 
    Response.Write "Error " &amp; Err.Number &amp; "  " &amp; Err.Description 
End If
%&gt; 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
