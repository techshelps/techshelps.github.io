<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMSAdminBase::SaveData</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_imsadminbase_savedata"></a>IMSAdminBase::SaveData</h1>
<p>
The <b>IMSAdminBase::SaveData</b> method explicitly saves the metabase data to disk. The metabase data is saved in the metabase storage file, by default named metabase.bin in the INETSRV directory in which you installed IIS, or to the file specified in the Windows NT® registry key LOCAL_MACHINE\\SOFTWARE\\Microsoft\\INetMgr\\Parameters if the file has been relocated as discussed in the <a href="aaadmin_5lrt.htm"><b>Security</b></a> topic of the <a href="aaadmin_7h9h.htm"><b>IIS Metabase</b></a> section. </p>
<p>
You must not have a handle open with write permission when you call this method, or the method will fail. The process waits for a few seconds for handles to close, so other processes with write handles open should not normally interfere with the save operation.</p>
<h4>Syntax</h4>
<pre><b><code>HRESULT SaveData( void );</code></b></pre>
<h4>Return Values</h4>
<p>
Returns an HRESULT that contains one of the following values:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>ERROR_PATH_BUSY</td>
<td width=50%>The path specified cannot be used at this time.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_SUCCESS</td>
<td width=50%>The method succeeded.</td>
</tr>
<tr valign=top>
<td width=50%>File system error codes</td>
<td width=50%>See winerror.h for information about specific error codes.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
All data in the metabase is saved, including data written by other applications.</p>
<p>
This method will fail and return ERROR_PATH_BUSY if there are any open write handles to the metabase.</p>
<p>
Metabase data is saved when IIS shuts down, so you usually do not need to call this method. However, for critical data it is recommended that you call it whenever appropriate for your application.</p>
<p>&nbsp;</p></body>
</HTML>
