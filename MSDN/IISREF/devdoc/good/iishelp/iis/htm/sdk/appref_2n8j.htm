<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HttpExtensionProc</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_in_httpextensionproc"></a>HttpExtensionProc</h1>
<p>
The <b>HttpExtensionProc</b> function is the main entry point for an ISAPI extension called by IIS. It exposes methods to which IIS uses to access the functionality exposed by the extension.</p>
<pre><code><b>DWORD WINAPI HttpExtensionProc(
  LPEXTENSION_CONTROL_BLOCK</b><i> lpECB  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpECB</i></dt>
<dd>
Points to the <a href="appref_3z1n.htm"><b>EXTENSION_CONTROL_BLOCK</b></a> structure.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns a DWORD containing HSE_STATUS codes. Possible return values are: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>HSE_STATUS_SUCCESS</td>
<td width=52%>The extension has finished processing and the server should disconnect and free up allocated resources.</td>
</tr>
<tr valign=top>
<td width=48%>HSE_STATUS_SUCCESS_AND_KEEP_CONN</td>
<td width=52%>The extension has finished processing and the server should wait for the next HTTP request if the client supports persistent connections. The extension should only return this if it was able to send the correct Content-Length header to the client. The server is not required to keep the session open.</td>
</tr>
<tr valign=top>
<td width=48%>HSE_STATUS_PENDING</td>
<td width=52%>The extension has queued the request for processing and will notify the server when it has finished. See HSE_REQ_DONE_WITH_SESSION under <a href="appref_4gtq.htm"><b>ServerSupportFunction</b></a>. <p>
If the ISAPI extension is using HSE_STATUS_PENDING, then responses can be sent from work done in another thread after returning the status pending. </p>
</td>
</tr>
<tr valign=top>
<td width=48%>HSE_STATUS_ERROR</td>
<td width=52%>The extension has encountered an error while processing the request and the server can disconnect and free up allocated resources.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
This entry point is similar to a <b>main</b>() function in a C++ program. The code in this entry point uses callback functions in the <a href="appref_3z1n.htm"><b>EXTENSION_CONTROL_BLOCK</b></a> to read client data and decide on the action to take. Before returning to the server, a properly formatted response must be sent to the client through either <a href="appref_7vjo.htm"><b>WriteClient</b></a> or <a href="appref_4gtq.htm"><b>ServerSupportFunction</b></a>. Return codes are defined in httpext.h.</p>
<p>&nbsp;</p></body>
</HTML>
