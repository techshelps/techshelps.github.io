<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMSAdminBase::Restore</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_imsadminbase_restore"></a>IMSAdminBase::Restore</h1>
<p>
The <b>IMSAdminBase::Restore</b> method restores the metabase from a backup. The restore operation stops all services dependent on IISADMIN, including all servers, until the restore has completed, then restarts all services. You should be careful to plan for this service interruption when restoring the metabase from a backup. </p>
<pre><code><b>HRESULT Restore( 
  LPCWSTR </b><i>pszMDBackupLocation</i><b>, </b>
<b>  DWORD </b><i>dwMDVersion</i><b>, </b>
<b>  DWORD </b><i>dwMDFlags</i><b> </b>
<b>); </b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pszMDBackupLocation</i></dt>
<dd>
A string of up to MD_BACKUP_MAX_LEN unicode characters that identifies the backup location containing the backup to be restored. </dd>
<dt>
<i>dwMDVersion</i></dt>
<dd>
Specifies the version number of the backup to be restored from the backup location, or may be the following constant: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=52%>MD_BACKUP_HIGHEST_VERSION</td>
<td width=48%>Restore from the highest existing backup version in the specified backup location.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwMDFlags</i></dt>
<dd>
Reserved. Must be zero. </dd>
</dl>
<h4>Return Values</h4>
<p>
Returns an HRESULT that contains one of the values listed in the table below. Other errors may also be returned that are passed through from the file system, or from a crypto api when secure metabase data is being saved, or from registry operations. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>E_INVALIDARG</td>
<td width=52%>An argument was invalid</td>
</tr>
<tr valign=top>
<td width=48%>ERROR_INVALID_DATA</td>
<td width=52%>The data is invalid.</td>
</tr>
<tr valign=top>
<td width=48%>ERROR_NOT_ENOUGH_MEMORY</td>
<td width=52%>Insufficient memory to perform the operation.</td>
</tr>
<tr valign=top>
<td width=48%>ERROR_SUCCESS</td>
<td width=52%>The method succeeded.</td>
</tr>
<tr valign=top>
<td width=48%>MD_ERROR_INVALID_VERSION</td>
<td width=52%>The specified version is invalid.</td>
</tr>
<tr valign=top>
<td width=48%>MD_WARNING_INVALID_DATA</td>
<td width=52%>Invalid metabase data.</td>
</tr>
<tr valign=top>
<td width=48%>MD_WARNING_PATH_NOT_FOUND</td>
<td width=52%>Specified path not found.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
