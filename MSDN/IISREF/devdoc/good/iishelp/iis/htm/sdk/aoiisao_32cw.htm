<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Backup</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_backup"></a>Backup</h1>
<p>
You can use the <b>Backup</b> method of the <a href="aoiisao_2xpu.htm"><b>IIsComputer</b></a> object to backup the metabase to a backup location you specify by providing a backup location name of up to 100 characters in length. Multiple metabase backups can be stored in a backup location. </p>
<h4>Syntax</h4>
<pre><code><b>IIsComputer</b>.<b>Backup</b> <i>BackupLocation</i>, <i>BackupVersion</i>, <i>BackupFlags</i> 
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>BackupLocation</i></dt>
<dd>
A string of up to 100 characters that specifies the backup location. The storage mechanism will be determined by IIS. If an empty string is specified, the backup will be stored in the default location. </dd>
<dt>
<i>BackupVersion</i></dt>
<dd>
Specifies the version number to be assigned to the backup. Must be less than or equal to MD_BACKUP_MAX_VERSION. Can be set to one of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=52%>MD_BACKUP_HIGHEST_VERSION</td>
<td width=48%>Overwrite the highest existing backup version in the specified backup location. </td>
</tr>
<tr valign=top>
<td width=52%>MD_BACKUP_NEXT_VERSION</td>
<td width=48%>Use the next backup version number available in the specified backup location. </td>
</tr>
</table><br>

</dd>
<dt>
<i>BackupFlags</i></dt>
<dd>
One or more of the following flags.
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=52%>MD_BACKUP_FORCE_BACKUP</td>
<td width=48%>Force the backup even if the SaveData operation specified by MD_BACKUP_SAVE_FIRST fails. </td>
</tr>
<tr valign=top>
<td width=52%>MD_BACKUP_OVERWRITE</td>
<td width=48%>Back up even if a backup of the same name and version exists in the specified backup location, overwriting if necessary. </td>
</tr>
<tr valign=top>
<td width=52%>MD_BACKUP_SAVE_FIRST</td>
<td width=48%>Perform a SaveData operation before the backup. </td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
IIS determines the backup storage mechanism, so the backup location name you provide does not necessarily translate to a particular directory, file, or database storage mechanism. As implemented in this release, metabase backups are stored as files in the SYSTEM32\INETSRV\METABACK directory. This mechanism may change in future releases. </p>
<h4>Code Example</h4>
<pre><code>&lt;% 
Dim ComputerObj, iFlags 
Set ComputerObj = GetObject("IIS://LocalHost") 
' Backup to next available version number 
' Set flags to save the metabase first and 
' force the backup even if save fails 
iFlags = (MD_BACKUP_SAVE_FIRST or MD_BACKUP_FORCE_BACKUP) 
ComputerObj.Backup "MyBackups", MD_BACKUP_NEXT_VERSION, iFlags 
%&gt; 
 </code></pre>
<h4>See Also</h4>
<p>
<a href="aoiisao_79rk.htm"><b>DeleteBackup</b></a>, <a href="aoiisao_1v8z.htm"><b>EnumBackups</b></a>, <a href="aoiisao_5ucl.htm"><b>Restore</b></a></p>
<p>&nbsp;</p></body>
</HTML>
