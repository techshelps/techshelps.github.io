<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMSAdminBase::SetData</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_imsadminbase_setdata"></a>IMSAdminBase::SetData</h1>
<p>
The <b>IMSAdminBase::SetData</b> method sets a data item. If data with that identifier does not already exist, this method creates and inserts a data item into the list of data items of that type. If data with that identifier already exists, this method sets the new data value. Duplicate data identifers are not allowed even if the entries are of different user types or data types.</p>
<pre><code><b>HRESULT SetData(
  METADATA_HANDLE</b><i> hMDHandle</i><b>,   </b>//metadata handle
<b>  LPCWSTR</b><i> pszMDPath</i><b>,           </b>//path of the key relative to 
                               // <i>hMDHandle</i>
<b>  PMETADATA_RECORD</b><i> pmdrMDData  </i>//pointer to data
<b>); </b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hMDHandle</i></dt>
<dd>
Specifies a handle with write permissions as returned by the <b>IMSAdminBase::OpenKey</b> method. METADATA_MASTER_ROOT_HANDLE is not valid for this operation. </dd>
<dt>
<i>pszMDPath</i></dt>
<dd>
Specifies a string that contains the path of the key that receives the entry, relative to the path of <i>hMDHandle</i>. For example, if the handle references the /LM key, you could specify the Web services subkey using the path /W3SVC.</dd>
<dt>
<i>pmdrMDData</i></dt>
<dd>
Points to a <b>METADATA_RECORD</b> structure that contains the data to set. All the structure members must be filled except <b>dwMDDataTag</b>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns an HRESULT that contains one of the following values:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>ERROR_ACCESS_DENIED</td>
<td width=50%>Access is denied. Either the open handle does not have read or write permission as needed, or the user does not have sufficient permissions to perform the operation.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_INVALID_PARAMETER</td>
<td width=50%>The parameter is incorrect.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_NOT_ENOUGH_MEMORY</td>
<td width=50%>There is not enough memory to complete the operation.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_PATH_NOT_FOUND</td>
<td width=50%>The specified path is not found.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_SUCCESS</td>
<td width=50%>The method succeeded.</td>
</tr>
<tr valign=top>
<td width=50%>MD_ERROR_CANNOT_REMOVE_SECURE_ATTRIBUTE</td>
<td width=50%>Cannot set data to be not secure when a secure value exists.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
