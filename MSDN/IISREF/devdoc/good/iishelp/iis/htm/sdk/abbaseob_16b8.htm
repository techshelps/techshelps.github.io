<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the IIS Admin Base Object</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_k2_using_the_iis_admin_base_object"></a>Using the IIS Admin Base Object</h2>
<p>
When IIS starts, it loads the metabase into memory, where it is available until IIS shuts down. The IIS Admin Base Object enables you to manage data in the metabase through the structures and methods of the <b>IMSAdminBase</b> interface. </p>
<p>
You use handles to access keys in the metabase as described in <a href="abbaseob_3j8z.htm"><b>Handles to Keys</b></a>. The METADATA_MASTER_ROOT_HANDLE is provided by IIS and connects to the root key of the metabase. You use this handle with the <b>OpenKey</b> method to open handles to specific keys, and to specify read or write permissions you need for the key. You can also use an existing open handle from an <b>OpenKey</b> call to open additional handles to other keys.</p>
<p>
Once you have a handle to a key, you can use the IIS Admin Base Object methods to manipulate that key's data entries. You can also access subkeys of the currently open key by specifying additional path information. </p>
<p>
With a valid handle, you can use the <b>GetData</b> method to retrieve a data entry, or the <b>SetData</b> method to add an entry to the metabase. The <b>GetAllData</b> method enables your application to retrieve all or a subset of the values associated with a key with a single method call. The <b>EnumData</b> method enables your application to enumerate all or a subset of the values associated with a key. When a data entry is no longer needed, you can remove it from the metabase by calling the <b>DeleteData</b> method.</p>
<p>
In addition to manipulating data entries, you can add, delete, or move keys from one path to another in the metabase. Use the <b>AddKey </b>method to add keys and the <b>DeleteKey</b> method to delete keys in the metabase. Use the <b>CopyKey</b> method to copy or move a key and all of its subkeys and data items. </p>
<p>
Your program can also incorporate event sinks for notification when metabase data is changed by other processes, and when IIS shuts down. </p>
<p>
This section contains:
<ul>
<li>
<a href="abbaseob_57mp.htm"><b>Setting and Retrieving Data</b></a> </li>
<li>
<a href="abbaseob_1w0x.htm"><b>Enumerating Keys and Data</b></a> </li>
<li>
<a href="abbaseob_25m3.htm"><b>Registering an Event Sink</b></a> </li>
</ul>
<p>&nbsp;</p></body>
</HTML>
