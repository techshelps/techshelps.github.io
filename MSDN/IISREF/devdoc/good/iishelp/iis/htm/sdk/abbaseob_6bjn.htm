<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMSAdminBase::EnumBackups</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_imsadminbase_enumbackups"></a>IMSAdminBase::EnumBackups</h1>
<p>
The <b>IMSAdminBase::EnumBackups</b> method enumerates the metabase backups in a specified backup location, or in all backup locations. Repeated calls to this method, increasing <i>dwMDEnumIndex</i> from 0, will return information for each metabase backup in the backup location until HRESULT_FROM_WIN32 (ERROR_NO_MORE_ITEMS) is returned. </p>
<pre><code><b>HRESULT EnumBackups( 
  LPWSTR </b><i>pszMDBackupLocation</i><b>, </b>
<b>  DWORD __RPC_FAR *</b><i>pdwMDVersion</i><b>, </b>
<b>  PFILETIME </b><i>pftMDBackupTime</i><b>, </b>
<b>  DWORD </b><i>dwMDEnumIndex</i><b> </b>
<b>); </b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pszMDBackupLocation</i></dt>
<dd>
On input, a buffer of length MD_BACKUP_MAX_LEN times sizeof(WChar) containing an empty string or a string of up to MD_BACKUP_MAX_LEN unicode characters that identifies the backup location. If an empty string is input, the method will enumerate backups in all backup locations, returning the backup location in this parameter. If a backup location is specified on input, only backups in the specified backup location will be enumerated.  </dd>
<dt>
<i>pdwMDVersion</i></dt>
<dd>
Receives the version number of the backup. </dd>
<dt>
<i>pftMDBackupTime</i></dt>
</dl>
<p>
Receives the date and time of the backup, in Universal Time Coordinate (UTC), formerly GMT. 
<dl>
<dt>
<i>dwMDEnumIndex</i></dt>
<dd>
Specifies the index number of the backup to be enumerated.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns an HRESULT that contains one of the following values, or any errors from the file system converted to HRESULT.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>ERROR_INVALID_NAME</td>
<td width=52%>Specified name is invalid.</td>
</tr>
<tr valign=top>
<td width=48%>ERROR_NO_MORE_ITEMS</td>
<td width=52%>No more items to enumerate.</td>
</tr>
<tr valign=top>
<td width=48%>ERROR_NOT_ENOUGH_MEMORY</td>
<td width=52%>Insufficient memory to perform the operation.</td>
</tr>
<tr valign=top>
<td width=48%>ERROR_SUCCESS</td>
<td width=52%>The method succeeded.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
