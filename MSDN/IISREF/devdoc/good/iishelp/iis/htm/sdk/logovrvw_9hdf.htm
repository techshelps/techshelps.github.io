<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Logging Properties</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_setting_logging_properties"></a>Setting Logging Properties</h1>
<p>
When IIS processes an HTTP request to a server it also makes an instance of the <b>IInetLogInformation</b> interface available to the server's logging module. <b>IInetLogInformation</b> is COM compliant which means it inherits the <b>IUnknown</b> interface. Logging modules can access <b>IInetLogInformation</b> methods by obtaining a pointer via the <b>IUnknown::QueryInterface</b> method.</p>
<p>
The logging module determines which methods to query for by examining the MD_LOGEXT_FIELD_MASK identifier in the metabase. MD_LOGEXT_FIELD_MASK is a DWORD of flag bits that specify individual methods of the <b>IInetLogInformation</b> interface. For example, the constant MD_EXTLOG_BYTES_SENT has been defined as value 0x00001000 for the DWORD. If this constant is specified in the metabase, the logging module will query IInetLogInformation for the GetBytesSent method, which returns the number of bytes sent as a result of the HTTP request.</p>
<p>
The flags in the MD_LOGEXT_FIELD_MASK identifier can be set with the Internet Service Manager. This process is described in <a href="../../../iis/htm/core/iilogsa.htm"><b>Logging Web Site Activity</b></a> topic of the Server Administration section. The flags can also be set by a script that sets the value of an appropriate automation property. For example, the MD_EXTLOG_BYTES_SENT flag corresponds to the <a href="arproprf_6p6c.htm"><b>LogExtFileBytesSent</b></a> automation property. The following script uses this automation property to set the MD_EXTLOG_BYTES_SENT flag in the metabase to True.</p>
<pre><code>&lt;%
Dim CurrServer
Set CurrServer = GetObject("IIS:/LocalHost/W3svc/1")
CurrServer.LogExtFileBytesSent = True
CurrServer.SetInfo</code></pre>
<p>
%&gt;</p>
<p>
A sample script that you can use to enumerate and change logging properties is provided in the <a href="nonssamp_8jzn.htm"><b>Developer Samples</b></a> section of the documentation. For more information on using automation properties to administer IIS see <a href="aaadmin_6jzi.htm"><b>IIS Administration</b></a>. </p>
<p>&nbsp;</p></body>
</HTML>
