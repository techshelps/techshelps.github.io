<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMSAdminBase::CopyKey</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_k2_imsadminbase_copykey"></a>IMSAdminBase::CopyKey</h1>
<p>
The <b>IMSAdminBase::CopyKey</b> method copies or moves a key, including its subkeys and data, to a specified destination. The copied or moved key becomes a subkey of the destination key.</p>
<pre><code><b>HRESULT CopyKey(
  METADATA_HANDLE</b><i> hMDSourceHandle</i><b>, </b>//metabase handle to the source key 
<b>  LPCWSTR</b><i> pszMDSourcePath</i><b>,         </b>//path of the source, relative to 
                                   // <i>hMDSourceHandle </i>
<b>  METADATA_HANDLE</b><i> hMDDestHandle</i><b>,   </b>//metabase handle to the destination 
<b>  LPCWSTR</b><i> pszMDDestPath</i><b>,           </b>//path of the destination, relative to 
                                   // <i>hMDDestHandle </i>
<b>  BOOL</b><i> bMDOverwriteFlag</i><b>,           </b>//whether to overwrite or merge data with 
                                   // an existing version of the key 
<b>  BOOL</b><i> bMDCopyFlag                 </i>//whether to copy or move the key 
<b>); </b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hMDSourceHandle</i></dt>
<dd>
Specifies the handle of the key to be copied or moved. If the key is to be copied (<i>bMDCopyFlag</i> is set to TRUE) <i>hMDSourceHandle</i> must have read permissions. If the key is to be moved (<i>bMDCopyFlag</i> is set to FALSE), <i>hMDSourceHandle </i>must have read/write permissions. </dd>
<dt>
<i>pszMDSourcePath</i></dt>
<dd>
Points to a string that contains the path of the key to be copied or moved relative to the path of <i>hMDSourceHandle</i>. For example, if the handle references the /LM key, you could specify the Web services subkey using the path /W3SVC.</dd>
<dt>
<i>hMDDestHandle</i></dt>
<dd>
Specifies a handle with write permissions that specifies the destination of the moved or copied key.</dd>
<dt>
<i>pszMDDestPath</i></dt>
<dd>
Points to a string that contains the path of the new or moved key, relative to <i>hMDDestHandle</i>. </dd>
<dt>
<i>bMDOverwriteFlag</i></dt>
<dd>
Determines the behavior if the destination key already exists. If set to TRUE, the existing key and all of its data and descendants are deleted prior to copying or moving the source. If FALSE, the existing key, data, and descendants remain, and the source<i> </i>is merged with that data. In cases of data conflicts, the source<i> </i>data overwrites the destination data.</dd>
<dt>
<i>bMDCopyFlag</i></dt>
<dd>
Specifies whether to copy or move the specified key. If <i>bMDCopyFlag</i> is TRUE, the key is copied. If it is FALSE, the key is moved, and the source key is deleted from its original location.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns an HRESULT that contains one of the following values:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>ERROR_ACCESS_DENIED</td>
<td width=50%>Access is denied. Either the open handle does not have read or write permission as needed, or the user does not have sufficient permissions to perform the operation.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_DUP_NAME</td>
<td width=50%>A key of that name already exists in the metabase.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_INVALID_PARAMETER</td>
<td width=50%>The parameter is incorrect.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_NOT_ENOUGH_MEMORY</td>
<td width=50%>Not enough memory is available to process this command.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_PATH_NOT_FOUND</td>
<td width=50%>The specified path was not found in the metabase.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_SUCCESS</td>
<td width=50%>The method succeeded.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
