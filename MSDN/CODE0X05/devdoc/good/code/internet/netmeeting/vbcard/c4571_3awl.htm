<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VBCARD.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4575"></a>VBCARD.FRM</h2>
<pre><code>VERSION 5.00 <br>Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "COMDLG32.OCX" <br>Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.2#0"; "COMCTL32.OCX" <br>Object = "{53D22821-D7E8-11CF-AD0A-0080C7137C82}#1.0#0"; "xmsconf.ocx" <br>Begin VB.Form VbCard  <br>   BorderStyle     =   3  'Fixed Dialog <br>   Caption         =   "Conference Card" <br>   ClientHeight    =   4125 <br>   ClientLeft      =   1515 <br>   ClientTop       =   3375 <br>   ClientWidth     =   6375 <br>   Icon            =   "VbCard.frx":0000 <br>   LinkTopic       =   "Form1" <br>   MaxButton       =   0   'False <br>   MinButton       =   0   'False <br>   PaletteMode     =   1  'UseZOrder <br>   ScaleHeight     =   4125 <br>   ScaleWidth      =   6375 <br>   ShowInTaskbar   =   0   'False <br>   Begin ComctlLib.Toolbar Toolbar1  <br>      Align           =   1  'Align Top <br>      Height          =   390 <br>      Left            =   0 <br>      TabIndex        =   5 <br>      Top             =   0 <br>      Width           =   6375 <br>      _ExtentX        =   11245 <br>      _ExtentY        =   688 <br>      ImageList       =   "ImageList1" <br>      _Version        =   327680 <br>      BeginProperty Buttons {0713E452-850A-101B-AFC0-4210102A8DA7}  <br>         NumButtons      =   8 <br>         BeginProperty Button1 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            Style           =   3 <br>         EndProperty <br>         BeginProperty Button2 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "hangup" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            ImageIndex      =   1 <br>         EndProperty <br>         BeginProperty Button3 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            Style           =   3 <br>         EndProperty <br>         BeginProperty Button4 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "sendfile" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            ImageIndex      =   2 <br>         EndProperty <br>         BeginProperty Button5 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "whiteboard" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            ImageIndex      =   3 <br>         EndProperty <br>         BeginProperty Button6 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "chat" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            ImageIndex      =   4 <br>         EndProperty <br>         BeginProperty Button7 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            Style           =   3 <br>         EndProperty <br>         BeginProperty Button8 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>            Enabled         =   0   'False <br>            Caption         =   "" <br>            Key             =   "sendcard" <br>            Description     =   "" <br>            Object.ToolTipText     =   "" <br>            Object.Tag             =   "" <br>            ImageIndex      =   5 <br>         EndProperty <br>      EndProperty <br>      MouseIcon       =   "VbCard.frx":0442 <br>   End <br>   Begin VB.ComboBox UserName  <br>      Height          =   315 <br>      Left            =   120 <br>      TabIndex        =   4 <br>      Top             =   480 <br>      Width           =   5415 <br>   End <br>   Begin VB.CommandButton StartConf  <br>      Caption         =   "Call" <br>      Height          =   615 <br>      Left            =   5640 <br>      TabIndex        =   2 <br>      Top             =   480 <br>      Width           =   615 <br>   End <br>   Begin VB.TextBox State  <br>      BackColor       =   &amp;H8000000F&amp; <br>      Height          =   300 <br>      Left            =   120 <br>      TabIndex        =   1 <br>      Top             =   3720 <br>      Width           =   3015 <br>   End <br>   Begin MSComDlg.CommonDialog CommonDialog1  <br>      Left            =   3480 <br>      Top             =   720 <br>      _ExtentX        =   847 <br>      _ExtentY        =   847 <br>      _Version        =   327680 <br>      DialogTitle     =   "Send File" <br>      Filter          =   "All Files (*.*)|*.*" <br>      Flags           =   5 <br>   End <br>   Begin ComctlLib.ListView MemberList  <br>      Height          =   2415 <br>      Left            =   120 <br>      TabIndex        =   3 <br>      Top             =   1200 <br>      Width           =   3855 <br>      _ExtentX        =   6800 <br>      _ExtentY        =   4260 <br>      View            =   3 <br>      LabelWrap       =   -1  'True <br>      HideSelection   =   -1  'True <br>      _Version        =   327680 <br>      ForeColor       =   -2147483640 <br>      BackColor       =   -2147483643 <br>      Appearance      =   1 <br>      MouseIcon       =   "VbCard.frx":045E <br>      NumItems        =   2 <br>      BeginProperty ColumnHeader(1) {0713E8C7-850A-101B-AFC0-4210102A8DA7}  <br>         Key             =   "" <br>         Object.Tag             =   "" <br>         Text            =   "Name" <br>         Object.Width           =   2540 <br>      EndProperty <br>      BeginProperty ColumnHeader(2) {0713E8C7-850A-101B-AFC0-4210102A8DA7}  <br>         Key             =   "" <br>         Object.Tag             =   "" <br>         Text            =   "Connection" <br>         Object.Width           =   2540 <br>      EndProperty <br>   End <br>   Begin ComctlLib.ProgressBar Progress  <br>      Height          =   300 <br>      Left            =   3240 <br>      TabIndex        =   0 <br>      Top             =   3720 <br>      Width           =   3015 <br>      _ExtentX        =   5318 <br>      _ExtentY        =   529 <br>      _Version        =   327680 <br>      Appearance      =   1 <br>      MouseIcon       =   "VbCard.frx":047A <br>   End <br>   Begin VB.Image Unknown  <br>      Height          =   2355 <br>      Left            =   4680 <br>      Picture         =   "VbCard.frx":0496 <br>      Top             =   1200 <br>      Visible         =   0   'False <br>      Width           =   2100 <br>   End <br>   Begin ActiveXConferenceCtl.ActiveXConference ConfMgr  <br>      Left            =   2880 <br>      Top             =   720 <br>   End <br>   Begin VB.Image Photo  <br>      BorderStyle     =   1  'Fixed Single <br>      Height          =   2415 <br>      Left            =   4080 <br>      Top             =   1200 <br>      Width           =   2175 <br>   End <br>   Begin ComctlLib.ImageList ImageList1  <br>      Left            =   3960 <br>      Top             =   720 <br>      _ExtentX        =   1005 <br>      _ExtentY        =   1005 <br>      BackColor       =   -2147483643 <br>      ImageWidth      =   16 <br>      ImageHeight     =   16 <br>      MaskColor       =   12632256 <br>      _Version        =   327680 <br>      BeginProperty Images {0713E8C2-850A-101B-AFC0-4210102A8DA7}  <br>         NumListImages   =   5 <br>         BeginProperty ListImage1 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "VbCard.frx":3140 <br>            Key             =   "" <br>         EndProperty <br>         BeginProperty ListImage2 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "VbCard.frx":3252 <br>            Key             =   "" <br>         EndProperty <br>         BeginProperty ListImage3 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "VbCard.frx":3364 <br>            Key             =   "" <br>         EndProperty <br>         BeginProperty ListImage4 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "VbCard.frx":3476 <br>            Key             =   "" <br>         EndProperty <br>         BeginProperty ListImage5 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "VbCard.frx":3588 <br>            Key             =   "" <br>         EndProperty <br>      EndProperty <br>   End <br>   Begin VB.Menu mnuConference  <br>      Caption         =   "&amp;Conference" <br>      Begin VB.Menu mnuStart  <br>         Caption         =   "&amp;Start..." <br>      End <br>      Begin VB.Menu mnuLeave  <br>         Caption         =   "&amp;Leave" <br>         Enabled         =   0   'False <br>      End <br>      Begin VB.Menu mnuConfSep1  <br>         Caption         =   "-" <br>      End <br>      Begin VB.Menu mnuOptions  <br>         Caption         =   "&amp;Options..." <br>      End <br>      Begin VB.Menu mnuConfSep2  <br>         Caption         =   "-" <br>      End <br>      Begin VB.Menu mnuExit  <br>         Caption         =   "&amp;Exit" <br>      End <br>   End <br>   Begin VB.Menu mnuTools  <br>      Caption         =   "&amp;Tools" <br>      Begin VB.Menu mnuSendFile  <br>         Caption         =   "Send &amp;File..." <br>         Enabled         =   0   'False <br>      End <br>      Begin VB.Menu mnuWhiteboard  <br>         Caption         =   "&amp;Whiteboard" <br>         Enabled         =   0   'False <br>      End <br>      Begin VB.Menu mnuChat  <br>         Caption         =   "&amp;Chat" <br>         Enabled         =   0   'False <br>      End <br>      Begin VB.Menu mnuStartRemote  <br>         Caption         =   "Start &amp;Remote" <br>         Enabled         =   0   'False <br>      End <br>      Begin VB.Menu mnuToolsSep1  <br>         Caption         =   "-" <br>      End <br>      Begin VB.Menu mnuSendCard  <br>         Caption         =   "&amp;Send Card" <br>         Enabled         =   0   'False <br>      End <br>      Begin VB.Menu mnuShowCard  <br>         Caption         =   "S&amp;how Card" <br>         Enabled         =   0   'False <br>      End <br>   End <br>   Begin VB.Menu mnuHelp  <br>      Caption         =   "&amp;Help" <br>      Enabled         =   0   'False <br>   End <br>End <br>Attribute VB_Name = "VbCard" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>'**************************************************************************** <br>' <br>'  Module:     VBCARD.EXE <br>'  File:       VbCard.frm <br>'  Content:    Implementation of the main form <br>' <br>'  Copyright (c) Microsoft Corporation 1995-1997 <br>' <br>' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>' ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>' THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>' PARTICULAR PURPOSE. <br>'**************************************************************************** <br> <br>Option Explicit <br> <br>Const AppID As String = _ <br>    "{54A4A060-CF42-11cf-8796-444553540000}" <br>Const AppName As String = "HotTalk" <br> <br>Dim Conference As IConferenceX <br> <br>Private Sub ConfMgr_ConferenceCreated( _ <br>    ByVal pcnf As IConferenceX) <br>     <br>    Set Conference = pcnf <br>    Conference.Advise <br>End Sub <br> <br>Private Sub ConfMgr_DataReceived( _ <br>    ByVal pDataExchange As IConfDataExchangeX, _ <br>    ByVal pMember As IConfMemberX, _ <br>    ByVal pDataTransfer As IConfDataTransferX, _ <br>    ByVal hr As Long) <br>     <br>    If pDataTransfer.BytesTransferred = BIZCARD_DATA_SIZE Then <br>        ReceiveBizCard pMember.Name, pDataTransfer <br>    Else <br>        ReceiveImage pMember.Name, pDataTransfer <br>    End If <br>End Sub <br> <br>Private Sub ConfMgr_DataSent( _ <br>    ByVal pDataExchange As IConfDataExchangeX, _ <br>    ByVal pMember As IConfMemberX, _ <br>    ByVal pDataTransfer As IConfDataTransferX, _ <br>    ByVal hr As Long) <br>     <br>    If pDataTransfer.BytesTransferred = BIZCARD_DATA_SIZE Then <br>        State = "Bizcard sent" <br>    Else <br>        State = "Picture sent" <br>    End If <br>End Sub <br> <br>Private Sub ConfMgr_FileReceived( _ <br>    ByVal pFileExchange As IConfFileExchangeX, _ <br>    ByVal pMember As IConfMemberX, _ <br>    ByVal pFileTransfer As IConfFileTransferX, _ <br>    ByVal hr As Long) <br>     <br>    FileRxTx pMember, pFileTransfer, False <br>End Sub <br> <br>Private Sub ConfMgr_FileSent( _ <br>    ByVal pFileExchange As IConfFileExchangeX, _ <br>    ByVal pMember As IConfMemberX, _ <br>    ByVal pFileTransfer As IConfFileTransferX, _ <br>    ByVal hr As Long) <br>     <br>    FileRxTx pMember, pFileTransfer, True <br>End Sub <br> <br>Private Sub ConfMgr_MemberChanged( _ <br>    ByVal pConference As IConferenceX, _ <br>    ByVal pMember As IConfMemberX, _ <br>    ByVal lNotify As Long) <br>    <br>    Select Case lNotify <br>        Case CNF_MEMB_ADDED <br>            'member is now added in UpdateMemberList <br>            'callee doesn't get added notifications on startup <br>            'AddMember pMember <br>        Case CNF_MEMB_REMOVED <br>            DeleteMember pMember <br>    End Select <br>     <br>    UpdateMemberList <br>End Sub <br> <br>Private Sub ConfMgr_StateChanged( _ <br>    ByVal pConference As IConferenceX, _ <br>    ByVal lConfState As Long, _ <br>    ByVal hr As Long) <br>     <br>    Select Case lConfState <br>        Case CNF_STATE_IDLE <br>            State.text = "Conference is idle." <br>        Case CNF_STATE_INIT <br>            State.text = "Conference is initialized." <br>        Case CNF_STATE_START <br>            State.text = "Conference has started." <br>            OnConferenceRunning <br>        Case CNF_STATE_STOP <br>            State.text = "Conference has stopped." <br>            OnConferenceStopped <br>        Case CNF_STATE_OFFERED <br>            State.text = "Conference has been offered." <br>    End Select <br>End Sub <br> <br>Private Sub Form_Load() <br>    Dim Conferences As IConferences <br>     <br>    Set Conference = Nothing <br>     <br>    InitChannels <br>     <br>    InitMemberArray <br>     <br>    UpdateMemberList <br>    UpdateButtons False <br>     <br>    ReadBizCard AppName, "Self", MyCard <br>     <br>    ConfMgr.Initialize AppID <br>    ConfMgr.Advise <br>     <br>    On Error Resume Next <br>    Set Conferences = ConfMgr.Conferences <br>    If Not (Conferences Is Nothing) Then <br>        ' get the first conference <br>        Set Conference = Conferences(0) <br>         <br>        If Not (Conference Is Nothing) Then <br>            Conference.Advise <br>            OnConferenceRunning <br>        End If <br>    End If <br>End Sub <br> <br>Private Sub Form_Unload(Cancel As Integer) <br>    OnConferenceStopped <br>    ConfMgr.Unadvise <br>     <br>    WriteBizCard AppName, "Self", MyCard <br>End Sub <br> <br>Private Sub MemberList_ItemClick(ByVal Item As ListItem) <br>    UpdateActiveIndex Item.text <br>End Sub <br> <br>Private Sub mnuChat_Click() <br>    LaunchChat <br>End Sub <br> <br>Private Sub mnuExit_Click() <br>    Unload VbCard <br>End Sub <br> <br>Private Sub mnuOptions_Click() <br>    Options.Show 1 <br>End Sub <br> <br>Private Sub mnuSendFile_Click() <br>    SendFile <br>End Sub <br> <br>Private Sub mnuStart_Click() <br>    Start <br>End Sub <br> <br>Private Sub mnuLeave_Click() <br>    Leave <br>End Sub <br> <br>Private Sub mnuWhiteboard_Click() <br>    LaunchWhiteboard <br>End Sub <br> <br>Private Sub mnuSendCard_Click() <br>    SendCard <br>End Sub <br> <br>Private Sub mnuShowCard_Click() <br>    ShowCard <br>End Sub <br> <br>Private Sub Photo_DblClick() <br>    ShowCard <br>End Sub <br> <br>Private Sub StartConf_Click() <br>    Start <br>End Sub <br> <br>Private Sub Toolbar1_ButtonClick(ByVal Button As Button) <br>    Select Case Button.Key <br>        Case "hangup" <br>            Leave <br>        Case "sendfile" <br>            SendFile <br>        Case "whiteboard" <br>            LaunchWhiteboard <br>        Case "chat" <br>            LaunchChat <br>        Case "sendcard" <br>            SendCard <br>    End Select <br> <br>End Sub <br> <br>Private Sub UpdateButtons(State As Boolean) <br>    Toolbar1.Buttons("hangup").Enabled = State <br>    Toolbar1.Buttons("sendfile").Enabled = State <br>    Toolbar1.Buttons("whiteboard").Enabled = State <br>    Toolbar1.Buttons("chat").Enabled = State <br>    Toolbar1.Buttons("sendcard").Enabled = State <br>    mnuLeave.Enabled = State <br>    mnuSendFile.Enabled = State <br>    mnuWhiteboard.Enabled = State <br>    mnuChat.Enabled = State <br>    mnuStartRemote.Enabled = State <br>    mnuSendCard.Enabled = State <br>    mnuShowCard.Enabled = State <br>End Sub <br> <br>Private Sub Start() <br>    Dim User As IConfUserX <br>     <br>    On Error Resume Next <br>    If Conference Is Nothing Then <br>        Set Conference = ConfMgr.CreateConference("MyConf", CNF_CAPS_DATA) <br>        If Conference Is Nothing Then <br>            ErrorMsg "failed to create conference" <br>            Exit Sub <br>        End If <br>         <br>        Conference.Advise <br>    End If <br>         <br>    Set User = ConfMgr.CreateUser(UserName.text, CNF_USER_MACHINENAME) <br>    If User Is Nothing Then <br>        ErrorMsg "failed to create user" <br>    Else <br>        If Not Conference.Invite(User) Then <br>            ErrorMsg "failed to invite user" <br>        End If <br>    End If <br>     <br>    UpdateButtons True <br>End Sub <br> <br>Private Sub Leave() <br>    On Error Resume Next <br>    If Not (Conference Is Nothing) Then <br>        Conference.Leave <br>    End If <br>    UpdateButtons False <br>End Sub <br> <br>Private Sub SendFile() <br>    Dim FileXfer As IConfFileTransferX <br>     <br>    On Error Resume Next <br>    CommonDialog1.ShowOpen <br>    If Err &lt;&gt; cdlCancel Then <br>        If FileChannel Is Nothing Then <br>            MsgBox "No File Exchange channel" <br>        Else <br>            Set FileXfer = FileChannel.SendFile(Nothing, Nothing, _ <br>                CommonDialog1.FileName, CNFF_SFOPT_NONE) <br>            If FileXfer Is Nothing Then <br>                ErrorMsg "Failed to send file" <br>            End If <br>        End If <br>    End If <br>End Sub <br> <br>Private Sub LaunchChat() <br>    MsgBox "Launch Chat" <br>End Sub <br> <br>Private Sub LaunchWhiteboard() <br>    MsgBox "Launch Whiteboard" <br>End Sub <br> <br>Private Sub FileRxTx( _ <br>    ByVal pMember As IConfMemberX, _ <br>    ByVal pFileTransfer As IConfFileTransferX, _ <br>    fSend As Boolean) <br>     <br>    Dim MemberName As String <br>     <br>    If pMember Is Nothing Then <br>        MemberName = "somebody" <br>    Else <br>        MemberName = pMember.Name <br>    End If <br>     <br>    Select Case pFileTransfer.State <br>        Case CNF_FILE_IDLE <br>        Case CNF_FILE_INITIALIZING <br>        Case CNF_FILE_PROGRESS <br>        Case CNF_FILE_COMPLETE <br>            If pFileTransfer.TotalSize = pFileTransfer.BytesTransferred Then <br>                If fSend Then <br>                    MsgBox pFileTransfer.Name &amp; " was sent to " &amp; MemberName <br>                Else <br>                    MsgBox pFileTransfer.Name &amp; " was received from " &amp; MemberName <br>                End If <br>            Else <br>                MsgBox "File transfer canceled" <br>            End If <br>    End Select <br>         <br>    Progress.Max = pFileTransfer.TotalSize <br>    Progress.Value = pFileTransfer.BytesTransferred <br>End Sub <br> <br> <br>Private Sub OnConferenceStopped() <br>    If Not (Conference Is Nothing) Then <br>        Conference.Unadvise <br>        Set Conference = Nothing <br>    End If <br>     <br>    CloseChannels <br>     <br>    UpdateMemberList <br>    UpdateButtons False <br>End Sub <br> <br>Private Sub OnConferenceRunning() <br>    OpenChannels Conference <br>    UpdateMemberList <br>    UpdateButtons True <br>End Sub <br> <br>Private Sub ErrorMsg(text As String) <br>    MsgBox "Error " &amp; Err.Number &amp; ": " &amp; text <br>End Sub <br> <br>Private Sub UpdateMemberList() <br>    Dim Members As IConfMembers <br>    Dim Member As IConfMemberX <br>    Dim itmX As ListItem <br> <br>    MemberList.ListItems.Clear <br> <br>    On Error Resume Next <br>    If Not (Conference Is Nothing) Then <br>        Set Members = Conference.Members <br>        If Not (Members Is Nothing) Then <br>            For Each Member In Members <br>                Set itmX = MemberList.ListItems.Add(, , Member.Name) <br>                itmX.SubItems(1) = ConfCapsToString(Member.ConferenceCapabilities) <br>                AddMember Member    'NOP if already added <br>            Next <br>        End If <br>    End If <br>     <br>    If MemberList.ListItems.Count &gt; 0 Then <br>        MemberList.ListItems(1).Selected = True <br>        UpdateActiveIndex MemberList.ListItems(1).text <br>    Else <br>        UpdateActiveIndex "" <br>    End If <br>End Sub <br> <br>Private Sub SendCard() <br>    Dim Buffer1() As Byte <br>    Dim Buffer2() As Byte <br>    Dim Size As Integer <br> <br>    If Not (DataChannel Is Nothing) Then <br>        Size = PictureToBytes(MyCard.PhotoFile, Buffer2) <br>        If Not Size = 0 Then <br>            BizCardToBytes MyCard, Buffer1, Size <br> <br>            On Error Resume Next <br>            If Not DataChannel.SendData(Nothing, Nothing, Buffer1, CNFF_SDOPT_NONE) Then <br>                MsgBox "Unable to send bizcard" <br>            Else <br>                If Not DataChannel.SendData(Nothing, Nothing, Buffer2, CNFF_SDOPT_NONE) Then <br>                    MsgBox "Unable to send picture" <br>                End If <br>            End If <br>        Else <br>            MsgBox "Unable to send picture" <br>        End If <br>    End If <br>End Sub <br> <br>Private Sub ShowCard() <br>    BizCard.Show 1 <br>End Sub <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
