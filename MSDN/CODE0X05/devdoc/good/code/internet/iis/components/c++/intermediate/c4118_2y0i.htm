<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CONTEXT.H</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4122"></a>CONTEXT.H</h2>
<pre><code>/*++ <br> <br>Copyright(c)    1997    Microsoft Corporation <br> <br>Module  Name : <br> <br>context.h <br> <br>Abstract: <br>A class to retrieve and release ASP intrinsics.  This class encapsulates the new way <br>of getting access to ASP instinsic objects.  It does away with the need for OnStartPage <br>and OnEndPage methods, and, by doing so, gives Application scope objects access to the <br>intrinsics.  The intrincis should never be retained across calls, as the context may <br>change between calls. <br> <br>Author: <br> <br>Neil Allain     August-1997  <br> <br>Revision History: <br> <br>--*/ <br>#pragma once <br>#ifndef _CONTEXT_H_ <br>#define _CONTEXT_H_ <br> <br>class CContext <br>{ <br>public: <br>enum { <br>get_Server= 0x0001, <br>get_Response= 0x0002, <br>get_Request= 0x0004, <br>get_Session= 0x0008, <br>get_Application= 0x0010, <br>        get_All         = 0xFFFF <br>}; <br> <br>HRESULT            Init( DWORD ); <br> <br>IRequest*Request(){ _ASSERT(m_piRequest!=NULL); return m_piRequest; } <br>IResponse*Response(){ _ASSERT(m_piResponse!=NULL); return m_piResponse; } <br>ISessionObject*Session(){ _ASSERT(m_piSession!=NULL); return m_piSession; } <br>IServer*Server(){ _ASSERT(m_piServer!=NULL); return m_piServer; } <br>IApplicationObject*Application(){ _ASSERT(m_piApplication!=NULL); return m_piApplication; } <br> <br>static HRESULTGetServerObject( IGetContextProperties*, BSTR, const IID&amp;, void** ); <br> <br>private: <br>CComPtr&lt;IRequest&gt;m_piRequest;//Request Object <br>CComPtr&lt;IResponse&gt;m_piResponse;//Response Object <br>CComPtr&lt;ISessionObject&gt;m_piSession;//Session Object <br>CComPtr&lt;IServer&gt;m_piServer;//Server Object <br>CComPtr&lt;IApplicationObject&gt; m_piApplication;//Application Object <br>}; <br> <br> <br>#endif// !_CONTEXT_H_ </code></pre>
<p>&nbsp;</p></body>
</HTML>
