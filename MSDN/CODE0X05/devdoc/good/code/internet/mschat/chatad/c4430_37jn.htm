<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADMIN.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4433"></a>ADMIN.FRM</h2>
<pre><code>VERSION 4.00 <br>'**************************************************************************** <br>' <br>'  Module:     CHATAD.EXE <br>'  File:       Admin.frm <br>' <br>'  Copyright (c) Microsoft Corporation 1996-1997 <br>' <br>' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>' ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>' THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>' PARTICULAR PURPOSE. <br>'**************************************************************************** <br>Begin VB.Form Main  <br>   BackColor       =   &amp;H00FFFFC0&amp; <br>   Caption         =   "MS Chat Monitoring Tool" <br>   ClientHeight    =   8415 <br>   ClientLeft      =   1125 <br>   ClientTop       =   1845 <br>   ClientWidth     =   11655 <br>   Height          =   8820 <br>   Left            =   1065 <br>   LinkTopic       =   "Main" <br>   ScaleHeight     =   8415 <br>   ScaleWidth      =   11655 <br>   Top             =   1500 <br>   Width           =   11775 <br>   Begin VB.CommandButton cmdClearErr  <br>      Caption         =   "Clear Err." <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   47 <br>      Top             =   8040 <br>      Width           =   855 <br>   End <br>   Begin VB.Frame Frame5  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Enter/Exit Room" <br>      Height          =   735 <br>      Left            =   6600 <br>      TabIndex        =   46 <br>      Top             =   6120 <br>      Width           =   4935 <br>      Begin VB.CommandButton cmdExitRoom  <br>         Caption         =   "Exit Room" <br>         Height          =   255 <br>         Left            =   3360 <br>         TabIndex        =   2 <br>         Top             =   360 <br>         Width           =   1455 <br>      End <br>      Begin VB.CommandButton cmdCancelEntering  <br>         Caption         =   "Cancel Entering" <br>         Height          =   255 <br>         Left            =   1680 <br>         TabIndex        =   1 <br>         Top             =   360 <br>         Width           =   1575 <br>      End <br>      Begin VB.CommandButton cmdEnterRoom  <br>         Caption         =   "Enter Room" <br>         Default         =   -1  'True <br>         Height          =   255 <br>         Left            =   120 <br>         TabIndex        =   0 <br>         Top             =   360 <br>         Width           =   1455 <br>      End <br>   End <br>   Begin VB.Frame Frame4  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Ignore Participant" <br>      Height          =   975 <br>      Left            =   6600 <br>      TabIndex        =   44 <br>      Top             =   4920 <br>      Width           =   4935 <br>      Begin VB.CommandButton cmdDoNotIgnore  <br>         Caption         =   "Don't Ignore" <br>         Height          =   255 <br>         Left            =   2520 <br>         TabIndex        =   22 <br>         Top             =   600 <br>         Width           =   2175 <br>      End <br>      Begin VB.CommandButton cmdIgnore  <br>         Caption         =   "Ignore" <br>         Height          =   255 <br>         Left            =   240 <br>         TabIndex        =   21 <br>         Top             =   600 <br>         Width           =   2175 <br>      End <br>      Begin VB.Label Label5  <br>         BackColor       =   &amp;H00FFFFC0&amp; <br>         Caption         =   "Ignore or not the selected member." <br>         Height          =   255 <br>         Left            =   1320 <br>         TabIndex        =   45 <br>         Top             =   240 <br>         Width           =   2535 <br>      End <br>   End <br>   Begin VB.Frame Frame3  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Participant Privileges" <br>      Height          =   1095 <br>      Left            =   6600 <br>      TabIndex        =   42 <br>      Top             =   3600 <br>      Width           =   4935 <br>      Begin VB.CommandButton cmdMakeHost  <br>         Caption         =   "Make Host" <br>         Height          =   255 <br>         Left            =   3360 <br>         TabIndex        =   20 <br>         Top             =   720 <br>         Width           =   1455 <br>      End <br>      Begin VB.CommandButton cmdMakeParticipant  <br>         Caption         =   "Make Participant" <br>         Height          =   255 <br>         Left            =   1800 <br>         TabIndex        =   19 <br>         Top             =   720 <br>         Width           =   1455 <br>      End <br>      Begin VB.CommandButton cmdMakeSpectator  <br>         Caption         =   "Make Spectator" <br>         Height          =   255 <br>         Left            =   120 <br>         TabIndex        =   18 <br>         Top             =   720 <br>         Width           =   1575 <br>      End <br>      Begin VB.Label Label4  <br>         BackColor       =   &amp;H00FFFFC0&amp; <br>         Caption         =   "Change the status of the selected member." <br>         Height          =   255 <br>         Left            =   1080 <br>         TabIndex        =   43 <br>         Top             =   360 <br>         Width           =   3255 <br>      End <br>   End <br>   Begin VB.Frame Frame1  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Participant Real Name" <br>      Height          =   2295 <br>      Left            =   6600 <br>      TabIndex        =   36 <br>      Top             =   1080 <br>      Width           =   4935 <br>      Begin VB.CommandButton cmdGetRealName  <br>         Caption         =   "Get Real Name" <br>         Height          =   975 <br>         Left            =   4080 <br>         TabIndex        =   17 <br>         Top             =   480 <br>         Width           =   735 <br>      End <br>      Begin VB.Frame Frame2  <br>         BackColor       =   &amp;H00FFFFC0&amp; <br>         Caption         =   "Get Real Name from" <br>         Height          =   1095 <br>         Left            =   120 <br>         TabIndex        =   37 <br>         Top             =   360 <br>         Width           =   3735 <br>         Begin VB.TextBox txtAlias  <br>            Enabled         =   0   'False <br>            Height          =   285 <br>            Left            =   1320 <br>            TabIndex        =   16 <br>            Top             =   720 <br>            Width           =   2295 <br>         End <br>         Begin VB.OptionButton optAlias  <br>            BackColor       =   &amp;H00FFFFC0&amp; <br>            Caption         =   "This Alias" <br>            Height          =   255 <br>            Left            =   120 <br>            TabIndex        =   15 <br>            Top             =   720 <br>            Width           =   1095 <br>         End <br>         Begin VB.OptionButton optSelection  <br>            BackColor       =   &amp;H00FFFFC0&amp; <br>            Caption         =   "Selected member" <br>            Height          =   255 <br>            Left            =   120 <br>            TabIndex        =   14 <br>            Top             =   360 <br>            Value           =   -1  'True <br>            Width           =   1815 <br>         End <br>      End <br>      Begin VB.Label lblAsyncRealName  <br>         Height          =   255 <br>         Left            =   1680 <br>         TabIndex        =   41 <br>         Top             =   1920 <br>         Width           =   3135 <br>      End <br>      Begin VB.Label lblAsyncAlias  <br>         Height          =   255 <br>         Left            =   120 <br>         TabIndex        =   40 <br>         Top             =   1920 <br>         Width           =   1335 <br>      End <br>      Begin VB.Label Label2  <br>         BackColor       =   &amp;H00FFFFC0&amp; <br>         Caption         =   "Real Name:" <br>         Height          =   255 <br>         Left            =   1680 <br>         TabIndex        =   39 <br>         Top             =   1680 <br>         Width           =   1215 <br>      End <br>      Begin VB.Label Label1  <br>         BackColor       =   &amp;H00FFFFC0&amp; <br>         Caption         =   "Alias:" <br>         Height          =   255 <br>         Left            =   120 <br>         TabIndex        =   38 <br>         Top             =   1680 <br>         Width           =   735 <br>      End <br>   End <br>   Begin VB.CommandButton cmdKickBan  <br>      Caption         =   "Kick, Ban and Re-instate Participant" <br>      Height          =   255 <br>      Left            =   6600 <br>      TabIndex        =   6 <br>      Top             =   7560 <br>      Width           =   3255 <br>   End <br>   Begin VB.CommandButton cmdChangeControlUI  <br>      Caption         =   "Change Control UI" <br>      Height          =   255 <br>      Left            =   9840 <br>      TabIndex        =   5 <br>      Top             =   7080 <br>      Width           =   1695 <br>   End <br>   Begin VB.CommandButton cmdSetMaxMembers  <br>      Caption         =   "Set MaxMembers" <br>      Height          =   255 <br>      Left            =   3240 <br>      TabIndex        =   12 <br>      Top             =   1800 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton cmdGetMaxMembers  <br>      Caption         =   "Get MaxMembers" <br>      Height          =   255 <br>      Left            =   4800 <br>      TabIndex        =   13 <br>      Top             =   1800 <br>      Width           =   1455 <br>   End <br>   Begin VB.TextBox txtMaxMembers  <br>      Height          =   285 <br>      Left            =   1680 <br>      TabIndex        =   11 <br>      Top             =   1800 <br>      Width           =   975 <br>   End <br>   Begin VB.TextBox txtError  <br>      BackColor       =   &amp;H000080FF&amp; <br>      Height          =   285 <br>      Left            =   1080 <br>      TabIndex        =   31 <br>      Top             =   8040 <br>      Width           =   10455 <br>   End <br>   Begin VB.TextBox txtState  <br>      BackColor       =   &amp;H000000C0&amp; <br>      Height          =   285 <br>      Left            =   10440 <br>      TabIndex        =   30 <br>      Text            =   "Disconnected" <br>      Top             =   360 <br>      Width           =   1095 <br>   End <br>   Begin VB.CommandButton cmdGetMemberCount  <br>      Caption         =   "Get MemberCount" <br>      Height          =   255 <br>      Left            =   4800 <br>      TabIndex        =   10 <br>      Top             =   1440 <br>      Width           =   1455 <br>   End <br>   Begin VB.TextBox txtMemberCount  <br>      Height          =   285 <br>      Left            =   1680 <br>      TabIndex        =   9 <br>      Top             =   1440 <br>      Width           =   975 <br>   End <br>   Begin VB.CommandButton cmdWhisperNoWhisper  <br>      Caption         =   "No/Whisper" <br>      Height          =   255 <br>      Left            =   6600 <br>      TabIndex        =   3 <br>      Top             =   7080 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton cmdSetTopic  <br>      Caption         =   "Set Topic" <br>      Height          =   255 <br>      Left            =   4800 <br>      TabIndex        =   8 <br>      Top             =   1080 <br>      Width           =   1455 <br>   End <br>   Begin VB.TextBox txtTopic  <br>      Height          =   285 <br>      Left            =   1680 <br>      TabIndex        =   7 <br>      Top             =   1080 <br>      Width           =   3015 <br>   End <br>   Begin VB.CommandButton cmdClearHistory  <br>      Caption         =   "Clear History" <br>      Height          =   255 <br>      Left            =   8280 <br>      TabIndex        =   4 <br>      Top             =   7080 <br>      Width           =   1335 <br>   End <br>   Begin VB.CommandButton cmdExit  <br>      Caption         =   "Exit" <br>      Height          =   255 <br>      Left            =   10080 <br>      TabIndex        =   23 <br>      Top             =   7560 <br>      Width           =   1455 <br>   End <br>   Begin MSChatObjectsCtl.MSChat MSChat1  <br>      Height          =   5775 <br>      Left            =   120 <br>      TabIndex        =   48 <br>      Top             =   2160 <br>      Width           =   6375 <br>      _ExtentX        =   11245 <br>      _ExtentY        =   10186 <br>      BorderStyle     =   0 <br>      UIOption        =   4095 <br>      BackColor       =   192 <br>   End <br>   Begin VB.Label lblRoomPath  <br>      Height          =   255 <br>      Left            =   4800 <br>      TabIndex        =   35 <br>      Top             =   360 <br>      Width           =   5175 <br>   End <br>   Begin VB.Label lblUserName  <br>      Height          =   255 <br>      Left            =   2520 <br>      TabIndex        =   34 <br>      Top             =   360 <br>      Width           =   1815 <br>   End <br>   Begin VB.Label lblAlias  <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   33 <br>      Top             =   360 <br>      Width           =   1935 <br>   End <br>   Begin VB.Label lblMaxMembers  <br>      Alignment       =   1  'Right Justify <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "MaxMembers" <br>      Height          =   255 <br>      Left            =   480 <br>      TabIndex        =   32 <br>      Top             =   1800 <br>      Width           =   975 <br>   End <br>   Begin VB.Label Label18  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "State" <br>      Height          =   255 <br>      Left            =   10440 <br>      TabIndex        =   29 <br>      Top             =   120 <br>      Width           =   615 <br>   End <br>   Begin VB.Label Label15  <br>      Alignment       =   1  'Right Justify <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Member Count" <br>      Height          =   255 <br>      Left            =   360 <br>      TabIndex        =   28 <br>      Top             =   1440 <br>      Width           =   1095 <br>   End <br>   Begin VB.Label Label13  <br>      Alignment       =   1  'Right Justify <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Chat Room Topic" <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   27 <br>      Top             =   1080 <br>      Width           =   1335 <br>   End <br>   Begin VB.Label Label10  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Name" <br>      Height          =   255 <br>      Left            =   2520 <br>      TabIndex        =   26 <br>      Top             =   120 <br>      Width           =   1815 <br>   End <br>   Begin VB.Label Label8  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Room Path" <br>      Height          =   255 <br>      Left            =   4800 <br>      TabIndex        =   25 <br>      Top             =   120 <br>      Width           =   5175 <br>   End <br>   Begin VB.Label Label7  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Alias " <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   24 <br>      Top             =   120 <br>      Width           =   1935 <br>   End <br>End <br>Attribute VB_Name = "Main" <br>Attribute VB_Creatable = False <br>Attribute VB_Exposed = False <br> <br>Option Explicit <br> <br>Const MASK_PRIVILEGES = 1 <br>Const MASK_NOWHISPER = 2 <br>Const MASK_IGNORED = 4 <br> <br>Const STAT_HOST = 1 <br>Const STAT_PARTICIPANT = 2 <br>Const STAT_SPECTATOR = 4 <br>Const STAT_NOWHISPER = 8 <br>Const STAT_IGNORED = 16 <br> <br>Const CAP_NOWHISPER = "Deny Whispers" <br>Const CAP_WHISPER = "Accept Whispers" <br> <br> <br>Sub SetState(NewState As Integer) <br>    Select Case NewState <br>    Case 1: <br>        cmdEnterRoom.Enabled = True <br>        cmdCancelEntering.Enabled = False <br>        cmdExitRoom.Enabled = False <br>        txtState.Text = "Disconnected" <br>        txtState.BackColor = &amp;HC0&amp; <br>        MSChat1.BackColor = &amp;HC0&amp; <br>    Case 2: <br>        cmdEnterRoom.Enabled = False <br>        cmdCancelEntering.Enabled = True <br>        cmdExitRoom.Enabled = False <br>        txtState.Text = "Connecting..." <br>        txtState.BackColor = &amp;H80FF&amp; <br>        MSChat1.BackColor = &amp;H80FF&amp; <br>    Case 3: <br>        cmdEnterRoom.Enabled = False <br>        cmdCancelEntering.Enabled = False <br>        cmdExitRoom.Enabled = True <br>        txtState.Text = "Connected" <br>        txtState.BackColor = &amp;HC000&amp; <br>        MSChat1.BackColor = &amp;HC000&amp; <br>    End Select <br>End Sub <br> <br> <br> <br> <br> <br> <br> <br>Private Sub cmdChangeControlUI_Click() <br>    UISettings.Show <br>End Sub <br> <br>Private Sub cmdClearErr_Click() <br>    txtError.Text = "" <br>End Sub <br> <br> <br> <br> <br> <br>Private Sub cmdGetMaxMembers_Click() <br>    On Error Resume Next <br>    txtMaxMembers.Text = CStr(MSChat1.MaxMembers) <br>End Sub <br> <br>Private Sub cmdGetRealName_Click() <br>    On Error Resume Next <br>     <br>    Dim txtReal As String <br>     <br>    lblAsyncAlias.Caption = "" <br>    lblAsyncRealName.Caption = "" <br>     <br>    If (optSelection.Value) Then <br>        MSChat1.GetParticipantRealName -1, "", False, txtReal <br>    Else <br>        MSChat1.GetParticipantRealName 0, txtAlias.Text, False, txtReal <br>    End If <br>End Sub <br> <br> <br> <br>Private Sub cmdGetMemberCount_Click() <br>    On Error Resume Next <br>    txtMemberCount.Text = CStr(MSChat1.MemberCount) <br>End Sub <br> <br>Private Sub cmdKickBan_Click() <br>    KickBan.Show <br>End Sub <br> <br> <br>Private Sub cmdMakeHost_Click() <br>    On Error Resume Next <br>    MSChat1.SetParticipantStatus -1, MASK_PRIVILEGES, STAT_HOST <br>End Sub <br> <br>Private Sub cmdMakeParticipant_Click() <br>    On Error Resume Next <br>    MSChat1.SetParticipantStatus -1, MASK_PRIVILEGES, STAT_PARTICIPANT <br>End Sub <br> <br>Private Sub cmdMakeSpectator_Click() <br>    On Error Resume Next <br>    MSChat1.SetParticipantStatus -1, MASK_PRIVILEGES, STAT_SPECTATOR <br>End Sub <br> <br>Private Sub cmdSetMaxMembers_Click() <br>    On Error Resume Next <br>    MSChat1.MaxMembers = CLng(txtMaxMembers.Text) <br>End Sub <br> <br> <br> <br>Private Sub Form_Unload(Cancel As Integer) <br>    Unload UISettings <br>    Unload EnterOptions <br>    Unload KickBan <br>End Sub <br> <br>Private Sub MSChat1_OnParticipantRealName(ByVal Alias As String, ByVal RealName As String) <br>    On Error Resume Next <br>    lblAsyncAlias.Caption = Alias <br>    lblAsyncRealName.Caption = RealName <br>End Sub <br> <br>Private Sub MSChat1_OnRoomTopicChanged(ByVal NewRoomTopic As String) <br>    On Error Resume Next <br>    txtTopic.Text = NewRoomTopic <br>End Sub <br> <br> <br>Private Sub MSChat1_OnStateChanged(ByVal NewState As Integer) <br>    SetState NewState <br>End Sub <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>Private Sub cmdCancelEntering_Click() <br>    On Error Resume Next <br>    MSChat1.CancelEntering <br>End Sub <br> <br>Private Sub cmdClearHistory_Click() <br>    On Error Resume Next <br>    MSChat1.ClearHistory <br>End Sub <br> <br> <br>Private Sub cmdDoNotIgnore_Click() <br>    On Error Resume Next <br>    MSChat1.SetParticipantStatus -1, MASK_IGNORED, 0 <br>End Sub <br> <br>Private Sub cmdEnterRoom_Click() <br>    EnterOptions.Show <br>End Sub <br> <br> <br> <br>Private Sub cmdExit_Click() <br>    End <br>End Sub <br> <br> <br>Private Sub cmdExitRoom_Click() <br>    On Error Resume Next <br>    MSChat1.ExitRoom <br>End Sub <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>Private Sub cmdIgnore_Click() <br>    On Error Resume Next <br>    MSChat1.SetParticipantStatus -1, MASK_IGNORED, STAT_IGNORED <br>End Sub <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>Private Sub cmdSetTopic_Click() <br>    On Error Resume Next <br>    MSChat1.RoomTopic = txtTopic.Text <br>End Sub <br> <br> <br> <br> <br> <br> <br>Private Sub cmdWhisperNoWhisper_Click() <br>    On Error Resume Next <br>    If (cmdWhisperNoWhisper.Caption = CAP_NOWHISPER) Then <br>        MSChat1.SetParticipantStatus MSChat1.ThisParticipantID, MASK_NOWHISPER, STAT_NOWHISPER <br>        cmdWhisperNoWhisper.Caption = CAP_WHISPER <br>    Else <br>        MSChat1.SetParticipantStatus MSChat1.ThisParticipantID, MASK_NOWHISPER, 0 <br>        cmdWhisperNoWhisper.Caption = CAP_NOWHISPER <br>    End If <br>End Sub <br>Private Sub Form_Load() <br>    cmdWhisperNoWhisper.Caption = CAP_NOWHISPER <br>End Sub <br> <br> <br> <br> <br>Private Sub MSChat1_OnEndEnumeration() <br>     <br>    On Error Resume Next <br>    txtTopic.Text = MSChat1.RoomTopic <br>    lblUserName.Caption = MSChat1.ThisParticipantName <br>    lblRoomPath.Caption = MSChat1.RoomPath <br>     <br>    cmdGetMemberCount_Click <br>    cmdGetMaxMembers_Click <br>End Sub <br> <br> <br>Private Sub MSChat1_OnError(ByVal ErrorCode As Integer, ByVal Description As String) <br>    On Error Resume Next <br>    txtError.Text = "MSChat1 error " + CStr(ErrorCode) + ", Desc: " + Description <br>End Sub <br> <br> <br> <br> <br> <br> <br> <br>Private Sub optAlias_Click() <br>    txtAlias.Enabled = True <br>End Sub <br> <br>Private Sub optSelection_Click() <br>    txtAlias.Enabled = False <br>End Sub <br> <br> <br> <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
