<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TRNSCRPT.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4452"></a>TRNSCRPT.FRM</h2>
<pre><code>VERSION 4.00 <br>'**************************************************************************** <br>' <br>'  Module:     Trnscrpt.EXE <br>'  File:       Trnscrpt.frm <br>' <br>'  Copyright (c) Microsoft Corporation 1996-1997 <br>' <br>' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>' ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>' THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>' PARTICULAR PURPOSE. <br>'**************************************************************************** <br>Begin VB.Form Form1  <br>   Caption         =   "Chat Transcripter" <br>   ClientHeight    =   6696 <br>   ClientLeft      =   1356 <br>   ClientTop       =   1488 <br>   ClientWidth     =   7380 <br>   FillColor       =   &amp;H00FF0000&amp; <br>   BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>      Name            =   "MS Sans Serif" <br>      Size            =   9.6 <br>      Charset         =   0 <br>      Weight          =   400 <br>      Underline       =   0   'False <br>      Italic          =   0   'False <br>      Strikethrough   =   0   'False <br>   EndProperty <br>   ForeColor       =   &amp;H000000FF&amp; <br>   Height          =   7020 <br>   Left            =   1308 <br>   LinkTopic       =   "Form1" <br>   ScaleHeight     =   6696 <br>   ScaleWidth      =   7380 <br>   Top             =   1212 <br>   Width           =   7476 <br>   Begin VB.Frame Frame3  <br>      Caption         =   "Chat Transcripter Session" <br>      Height          =   3252 <br>      Left            =   120 <br>      TabIndex        =   14 <br>      Top             =   3240 <br>      Width           =   7092 <br>      Begin VB.Timer Timer2  <br>         Enabled         =   0   'False <br>         Interval        =   1000 <br>         Left            =   4440 <br>         Top             =   240 <br>      End <br>      Begin VB.Timer Timer1  <br>         Interval        =   1000 <br>         Left            =   5880 <br>         Top             =   240 <br>      End <br>      Begin MSChatObjectsCtl.MSChat MSChat1  <br>         Height          =   2892 <br>         Left            =   120 <br>         TabIndex        =   15 <br>         Top             =   240 <br>         Width           =   6852 <br>         _ExtentX        =   12086 <br>         _ExtentY        =   5101 <br>         UIOption        =   3980 <br>         BackColor       =   255 <br>      End <br>   End <br>   Begin VB.Frame Frame2  <br>      Caption         =   "Chat Transcripter Commands" <br>      Height          =   732 <br>      Left            =   120 <br>      TabIndex        =   11 <br>      Top             =   2400 <br>      Width           =   7092 <br>      Begin VB.CommandButton CurTranscript  <br>         Caption         =   "View Current Transcript" <br>         Height          =   372 <br>         Left            =   3960 <br>         TabIndex        =   13 <br>         Top             =   240 <br>         Width           =   3012 <br>      End <br>      Begin VB.CommandButton TranscriptCmd  <br>         Caption         =   "Start Transcribing" <br>         Height          =   372 <br>         Left            =   120 <br>         TabIndex        =   12 <br>         Top             =   240 <br>         Width           =   3732 <br>      End <br>   End <br>   Begin VB.Frame Frame1  <br>      Caption         =   "Chat Transcripter Options" <br>      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>         Name            =   "Times New Roman" <br>         Size            =   10.2 <br>         Charset         =   0 <br>         Weight          =   700 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   2292 <br>      Left            =   120 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   7092 <br>      Begin VB.TextBox Peak  <br>         BackColor       =   &amp;H00FF80FF&amp; <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Arial" <br>            Size            =   7.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   288 <br>         Left            =   3480 <br>         TabIndex        =   28 <br>         Top             =   1838 <br>         Visible         =   0   'False <br>         Width           =   852 <br>      End <br>      Begin VB.TextBox Total  <br>         BackColor       =   &amp;H00FF80FF&amp; <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Arial" <br>            Size            =   7.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         ForeColor       =   &amp;H00FF0000&amp; <br>         Height          =   288 <br>         Left            =   3480 <br>         TabIndex        =   26 <br>         Top             =   1560 <br>         Visible         =   0   'False <br>         Width           =   852 <br>      End <br>      Begin VB.TextBox Current  <br>         BackColor       =   &amp;H00FF80FF&amp; <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Arial" <br>            Size            =   7.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         ForeColor       =   &amp;H0000FF00&amp; <br>         Height          =   288 <br>         Left            =   3480 <br>         TabIndex        =   24 <br>         Top             =   1320 <br>         Visible         =   0   'False <br>         Width           =   852 <br>      End <br>      Begin VB.TextBox HostKey  <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.2 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   336 <br>         Left            =   5640 <br>         TabIndex        =   22 <br>         Top             =   840 <br>         Width           =   1212 <br>      End <br>      Begin VB.CheckBox MembStatus  <br>         Caption         =   "Allow Participation" <br>         Height          =   240 <br>         Left            =   4680 <br>         TabIndex        =   19 <br>         Top             =   1320 <br>         Width           =   2052 <br>      End <br>      Begin VB.TextBox Interval  <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.2 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   336 <br>         Left            =   2040 <br>         TabIndex        =   18 <br>         Text            =   "1" <br>         Top             =   1320 <br>         Width           =   372 <br>      End <br>      Begin VB.CheckBox TextSpacing  <br>         Caption         =   "Text Spacing" <br>         Height          =   252 <br>         Left            =   4680 <br>         TabIndex        =   16 <br>         Top             =   1580 <br>         Value           =   1  'Checked <br>         Width           =   1692 <br>      End <br>      Begin VB.CheckBox Reconnect  <br>         Caption         =   "AutoReconnect" <br>         Height          =   252 <br>         Left            =   4680 <br>         TabIndex        =   10 <br>         Top             =   1860 <br>         Width           =   1692 <br>      End <br>      Begin VB.TextBox ChatRoom  <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.2 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   336 <br>         Left            =   1560 <br>         TabIndex        =   9 <br>         Text            =   "//ChatSrv1/#ChatRoom" <br>         Top             =   360 <br>         Width           =   2292 <br>      End <br>      Begin VB.CommandButton Browse  <br>         Caption         =   "..." <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   372 <br>         Left            =   3960 <br>         TabIndex        =   8 <br>         Top             =   840 <br>         Width           =   372 <br>      End <br>      Begin VB.TextBox TranscriptFile  <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.2 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   336 <br>         Left            =   1560 <br>         TabIndex        =   7 <br>         Top             =   840 <br>         Width           =   2292 <br>      End <br>      Begin VB.TextBox Alias  <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.2 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   336 <br>         Left            =   5640 <br>         TabIndex        =   6 <br>         Text            =   "Transcripter" <br>         Top             =   360 <br>         Width           =   1212 <br>      End <br>      Begin VB.TextBox Retries  <br>         Enabled         =   0   'False <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.2 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   336 <br>         Left            =   2040 <br>         TabIndex        =   5 <br>         Text            =   "2" <br>         Top             =   1800 <br>         Width           =   372 <br>      End <br>      Begin VB.Label Label10  <br>         BackColor       =   &amp;H00FF80FF&amp; <br>         BorderStyle     =   1  'Fixed Single <br>         Caption         =   "Peak" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Arial" <br>            Size            =   12 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   288 <br>         Left            =   2640 <br>         TabIndex        =   27 <br>         Top             =   1838 <br>         Visible         =   0   'False <br>         Width           =   852 <br>      End <br>      Begin VB.Label Label9  <br>         BackColor       =   &amp;H00FF80FF&amp; <br>         BorderStyle     =   1  'Fixed Single <br>         Caption         =   "Total" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Arial" <br>            Size            =   12 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         ForeColor       =   &amp;H00FF0000&amp; <br>         Height          =   288 <br>         Left            =   2640 <br>         TabIndex        =   25 <br>         Top             =   1560 <br>         Visible         =   0   'False <br>         Width           =   852 <br>      End <br>      Begin VB.Label Label8  <br>         BackColor       =   &amp;H00FF80FF&amp; <br>         BorderStyle     =   1  'Fixed Single <br>         Caption         =   "Current" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Arial" <br>            Size            =   12 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         ForeColor       =   &amp;H0000FF00&amp; <br>         Height          =   288 <br>         Left            =   2640 <br>         TabIndex        =   23 <br>         Top             =   1320 <br>         Visible         =   0   'False <br>         Width           =   852 <br>      End <br>      Begin VB.Label Label7  <br>         Caption         =   "Host Key" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   252 <br>         Left            =   4680 <br>         TabIndex        =   21 <br>         Top             =   860 <br>         Width           =   1452 <br>      End <br>      Begin VB.Label Label6  <br>         Alignment       =   2  'Center <br>         Caption         =   "(Minutes)" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   7.8 <br>            Charset         =   0 <br>            Weight          =   400 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   204 <br>         Left            =   480 <br>         TabIndex        =   20 <br>         Top             =   1560 <br>         Width           =   732 <br>      End <br>      Begin VB.Label Label5  <br>         Caption         =   "Log Interval" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   252 <br>         Left            =   240 <br>         TabIndex        =   17 <br>         Top             =   1360 <br>         Width           =   1212 <br>      End <br>      Begin MSComDlg.CommonDialog CommonDialog1  <br>         Left            =   3960 <br>         Top             =   360 <br>         _Version        =   65536 <br>         _ExtentX        =   677 <br>         _ExtentY        =   677 <br>         _StockProps     =   0 <br>         DefaultExt      =   ".txt" <br>         DialogTitle     =   "ChatTranscript File" <br>         Filter          =   "Text (*.txt)|*.txt|All (*.*)|*.*" <br>         FilterIndex     =   1 <br>         InitDir         =   "." <br>      End <br>      Begin VB.Label Label4  <br>         Caption         =   "Number of Retries" <br>         Enabled         =   0   'False <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   252 <br>         Left            =   240 <br>         TabIndex        =   4 <br>         Top             =   1800 <br>         Width           =   1812 <br>      End <br>      Begin VB.Label Label3  <br>         Caption         =   "Alias" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   252 <br>         Left            =   4680 <br>         TabIndex        =   3 <br>         Top             =   400 <br>         Width           =   492 <br>      End <br>      Begin VB.Label Label2  <br>         Caption         =   "Log File" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   252 <br>         Left            =   240 <br>         TabIndex        =   2 <br>         Top             =   880 <br>         Width           =   1452 <br>      End <br>      Begin VB.Label Label1  <br>         Caption         =   "Chat Room" <br>         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}  <br>            Name            =   "Times New Roman" <br>            Size            =   10.8 <br>            Charset         =   0 <br>            Weight          =   700 <br>            Underline       =   0   'False <br>            Italic          =   0   'False <br>            Strikethrough   =   0   'False <br>         EndProperty <br>         Height          =   252 <br>         Left            =   240 <br>         TabIndex        =   1 <br>         Top             =   400 <br>         Width           =   1212 <br>      End <br>   End <br>End <br>Attribute VB_Name = "Form1" <br>Attribute VB_Creatable = False <br>Attribute VB_Exposed = False <br> <br>Const INSERT_BLANK = &amp;H100&amp; <br>Const ALLOW_RESIZING = &amp;H400&amp; <br>Const SENSITIVE_URLS = &amp;H800&amp; <br> <br>Const SEND_BUTTON = &amp;H1&amp; <br>Const WHISPER_BUTTON = &amp;H2&amp; <br>Const SEND_TEXTBOX = &amp;H10&amp; <br> <br>Const INFORM_JOIN = &amp;H20&amp; <br>Const INFORM_LEAVE = &amp;H40&amp; <br> <br>Const MASK_PRIVILEGES = &amp;H1&amp; <br>Const STAT_PARTICIPANT = &amp;H2&amp; <br>Const STAT_SPECTATOR = &amp;H4&amp; <br> <br>Public TimerTicks As Integer <br>Public CurTicks As Integer <br>Public CancelFlag As Boolean <br> <br>Public CurTry As Integer <br>Public TotalCount As Integer <br>Public MaxCount As Integer <br>Sub Enable_ChatOptions(ByVal flag As Boolean) <br>ChatRoom.Enabled = flag <br>TranscriptFile.Enabled = flag <br>Alias.Enabled = flag <br>Browse.Enabled = flag <br>HostKey.Enabled = flag <br>Label1.Enabled = flag <br>Label2.Enabled = flag <br>Label3.Enabled = flag <br>Label7.Enabled = flag <br>Timer1.Enabled = Not flag <br> <br>If (HostKey.Text = "") Then <br>    current.Visible = False <br>    total.Visible = False <br>    Peak.Visible = False <br>    Label8.Visible = False <br>    Label9.Visible = False <br>    Label10.Visible = False <br>Else <br>    current.Visible = Not flag <br>    total.Visible = Not flag <br>    Peak.Visible = Not flag <br>    Label8.Visible = Not flag <br>    Label9.Visible = Not flag <br>    Label10.Visible = Not flag <br>End If <br> <br>End Sub <br> <br>Sub Set_FileName() <br>strFileName = ChatRoom.Text <br>Do <br>    nPos = InStr(strFileName, "/") <br>    If (nPos &gt; 0) Then <br>        strTemp = Mid(strFileName, nPos + 1) <br>        strFileName = strTemp <br>    End If <br>Loop Until nPos = 0 <br>TranscriptFile.Text = strFileName + ".txt" <br>If (HostKey.Text = "") Then <br>Else <br>TranscriptFile.Text = "Host_" + TranscriptFile.Text <br>End If <br>End Sub <br> <br>Sub Update_File(ByVal Stats As Boolean) <br>'MsgBox "Update File Called", , "testing" <br>On Error GoTo ErrorHandler <br>CurHistory = MSChat1.History <br>If ((CurHistory &lt;&gt; "") Or (Stats)) Then <br>    CurTranscript.Enabled = False <br>    Open TranscriptFile.Text For Append Access Write As #1 <br>     <br>    Print #1, CurHistory <br>    MSChat1.ClearHistory <br>      <br>    If (Stats And (HostKey.Text &lt;&gt; "")) Then <br>        TempStr = ":::::::::::::::::::::::::::::::::::::::::" <br>        Print #1, TempStr, TempStr, TempStr, TempStr <br>        Print #1, "    Chat Room:", ChatRoom.Text; <br>        Print #1, "      ClosingTime :", Time$ <br>        Print #1, " " <br>        Print #1, "Total number of participants : "; <br>        Print #1, TotalCount <br>        Print #1, "Peak participation during session: "; <br>        Print #1, MaxCount <br>        Print #1, " " <br>        Print #1, TempStr, TempStr, TempStr, TempStr <br>'        Print #1, "Current number of participants : " <br>'        Print #1, current.Text <br>    End If <br>        <br>    Close #1 <br>    CurTranscript.Enabled = True <br>End If <br> <br>Exit Sub        ' Exit to avoid handler. <br>ErrorHandler:   ' Error-handling routine. <br>    Select Case Err.Number  ' Evaluate error number. <br>        Case 75 <br>            Msg = "Error Saving Transcript File! Make Sure you have access privelages to the file" <br>            MsgBox Msg, , TranscriptFile.Text <br>            Err.Clear   ' Clear Err object fields <br>        Case Else <br>            ' Tell user what happened. Then clear the Err object. <br>            Msg = "There was an error attempting to open the OLE object!" <br>            MsgBox Msg, , Err.Number <br>            Err.Clear   ' Clear Err object fields <br>     <br>            ' Handle other situations here... <br>    End Select <br>    CurTranscript.Enabled = True <br> <br>End Sub <br> <br>Private Sub Browse_Click() <br>Rem CommonDialog1.DefaultExt = ".txt" <br>Rem CommonDialog1.Filter = "Text (*.txt)|*.txt|All (*.*)|*.*" <br>Rem CommonDialog1.FilterIndex = 1 <br>Rem CommonDialog1.DialogTitle = "ChatTranscript File" <br>Rem CommonDialog1.DefaultExt = ".txt" <br>Rem CommonDialog1.DefaultExt = ".txt" <br>CommonDialog1.filename = TranscriptFile.Text <br>CommonDialog1.Flags = &amp;H800&amp; Or &amp;H8000&amp; Or &amp;H2&amp; Or &amp;H200000 Or &amp;H4&amp; <br>CommonDialog1.InitDir = "." <br>'CommonDialog1.Action = 2 <br>CommonDialog1.ShowSave <br>TranscriptFile.Text = CommonDialog1.filename <br>End Sub <br> <br> <br>Private Sub ChatRoom_Change() <br>'Call Set_FileName <br>End Sub <br> <br> <br> <br>Private Sub ChatRoom_LostFocus() <br>Call Set_FileName <br>End Sub <br> <br> <br>Private Sub CurTranscript_Click() <br>    On Error GoTo ErrorHandler   ' Defer error trapping. <br>    Open TranscriptFile.Text For Input Access Read Shared As 2 <br>    FileStr = Input(LOF(2), 2) <br>    Close #2 <br>    Load Form2 <br>    Form2.RichTextBox1.TextRTF = FileStr <br>    Form2.Visible = True <br>'    Else <br>'        Msg = "Unable to Access Transcript File" <br>'       MsgBox Msg, , TranscriptFile.Text <br>'  End If <br>    'Form2.RichTextBox1.LoadFile TranscriptFile.Text, rtfText <br>    Exit Sub        ' Exit to avoid handler. <br>ErrorHandler:   ' Error-handling routine. <br>    Select Case Err.Number  ' Evaluate error number. <br>        Case 53 <br>            Msg = "Transcript File Doesn't exist" <br>            MsgBox Msg, , TranscriptFile.Text <br>            Err.Clear   ' Clear Err object fields <br>            <br>        Case 75 <br>            Msg = "Error Reading Transcript File! Make Sure the file exists" <br>            MsgBox Msg, , TranscriptFile.Text <br>            Err.Clear   ' Clear Err object fields <br>        Case Else <br>            ' Tell user what happened. Then clear the Err object. <br>            Msg = "There was an error attempting to open the OLE object!" <br>            MsgBox Msg, , Err.Number <br>            Err.Clear   ' Clear Err object fields <br>     <br>            ' Handle other situations here... <br>    End Select <br>     <br>End Sub <br> <br>Private Sub Form_Load() <br> <br>Call Set_FileName <br> <br>TimerTicks = Interval.Text <br>CurTicks = 0 <br> <br>CurTry = 0 <br> <br>End Sub <br> <br> <br> <br>Private Sub HostKey_LostFocus() <br>    If (Alias.Text = "Transcripter") Then <br>        Alias.Text = "THost" <br>    End If <br>     <br>    If (InStr(TranscriptFile.Text, "Host_") = 0) Then <br>            TranscriptFile.Text = "Host_" + TranscriptFile.Text <br>    End If <br> <br>End Sub <br> <br> <br>Private Sub Interval_Change() <br>    iVal = 1 <br>    On Error Resume Next <br>    iVal = CInt(Interval.Text) <br>    Interval.Text = iVal <br>    TimerTicks = iVal <br>'    Timer1.Interval = 1000 * 60 * iVal ' Set interval. <br>End Sub <br> <br>Private Sub MembStatus_Click() <br>On Error Resume Next <br>If (MembStatus.Value = 0) Then <br>'    If (MSChat1.State = 3) Then <br>'        MSChat1.SetParticipantStatus MSChat1.ThisParticipantID, MASK_PRIVILEGES, STAT_SPECTATOR <br>'    End If <br>    MSChat1.UIOption = MSChat1.UIOption And Not (SEND_TEXTBOX Or SEND_BUTTON Or WHISPER_BUTTON) <br>Else <br>'    If (MSChat1.State = 3) Then <br>'        MSChat1.SetParticipantStatus MSChat1.ThisParticipantID, MASK_PRIVILEGES, STAT_PARTICIPANT <br>'    End If <br>    MSChat1.UIOption = MSChat1.UIOption Or (SEND_TEXTBOX Or SEND_BUTTON Or WHISPER_BUTTON) <br>End If <br>  <br> <br>End Sub <br> <br>Private Sub MSChat1_OnBeginEnumeration() <br>    TotalCount = 0 <br>    MaxCount = TotalCount <br>End Sub <br> <br>Private Sub MSChat1_OnEnterParticipant(ByVal ParticipantID As Long, ByVal Alias As String, ByVal Status As Integer) <br>    current.Text = MSChat1.MemberCount <br>    TotalCount = TotalCount + 1 <br>    total.Text = TotalCount <br>    If (MaxCount &lt; MSChat1.MemberCount) Then <br>        MaxCount = MSChat1.MemberCount <br>        Peak.Text = MaxCount <br>    End If <br>End Sub <br> <br>Private Sub MSChat1_OnExitParticipant(ByVal ParticipantID As Long) <br>    current.Text = MSChat1.MemberCount <br>End Sub <br> <br> <br>Private Sub MSChat1_OnHistoryFull(ByVal Percent As Integer) <br>Call Update_File(False) <br>End Sub <br> <br>Private Sub MSChat1_OnStateChanged(ByVal NewState As Integer) <br>    If (NewState = 1) Then <br>        Update_File (True) <br>         <br>        If ((CancelFlag = True) Or (Reconnect.Value = 0) Or ((Reconnect.Value = 1) And (CurTry &gt;= Retries.Text))) Then <br>            TranscriptCmd.Caption = "Start Transcribing" <br>            TranscriptCmd.Enabled = True <br>            MSChat1.BackColor = 255 <br>            CurTry = 0 <br>            Call Enable_ChatOptions(True) <br>        Else <br>            TranscriptCmd.Caption = "ReStarting Transcribing" <br>            TranscriptCmd.Enabled = False <br>            CurTry = CurTry + 1 <br>            MSChat1.BackColor = &amp;HFF0000 <br>            Timer2.Interval = 30000 <br>            Timer2.Enabled = True <br>        End If <br>    Else <br>        If (NewState = 2) Then <br>            TranscriptCmd.Caption = "Cancel Entering" <br>            MSChat1.BackColor = 33023 <br>        Else <br>            On Error Resume Next <br>            If (NewState = 3) Then <br>                TranscriptCmd.Caption = "Stop Transcribing" <br>                MSChat1.BackColor = 49152 <br>                CurTry = 0 <br>                TranscriptCmd.Enabled = True <br>            End If <br>        End If <br>    End If <br>End Sub <br> <br> <br> <br> <br> <br>Private Sub Reconnect_Click() <br>If Reconnect.Value = 0 Then <br>    Retries.Enabled = False <br>    Label4.Enabled = False <br>Else <br>    Retries.Enabled = True <br>    Label4.Enabled = True <br>End If <br>End Sub <br> <br>Private Sub TextSpacing_Click() <br>If TextSpacing.Value = 0 Then <br>    MSChat1.UIOption = MSChat1.UIOption And Not INSERT_BLANK <br>Else <br>    MSChat1.UIOption = MSChat1.UIOption Or INSERT_BLANK <br>End If <br>End Sub <br> <br>Private Sub Timer1_Timer() <br>CurTicks = CurTicks + 1 <br>If (CurTicks &gt;= TimerTicks) Then <br>    CurTicks = 0 <br>    Call Update_File(False) <br>End If <br>End Sub <br> <br>Private Sub Timer2_Timer() <br>If (MSChat1.State = 1) Then <br>    Call TranscriptCmd_Click <br>End If <br>End Sub <br> <br>Private Sub TranscriptCmd_Click() <br> <br>If (MSChat1.State = 1) Then <br>    Rem make sure the file is writable. <br>    On Error GoTo ErrorHandler <br>    Open TranscriptFile.Text For Append Access Write As #1 <br>    Close #1 <br>    Timer1.Interval = 60000  ' Set interval to be 1 minute. <br>    Timer2.Enabled = False <br>     <br>    CancelFlag = False <br>    MSChat1.EnterRoom ChatRoom.Text, HostKey.Text, Alias.Text, "ANON;ALL", 1, 1 <br>    Call Enable_ChatOptions(False) <br>Else <br>    CancelFlag = True <br>    If (MSChat1.State = 2) Then <br>        TranscriptCmd.Enabled = False <br>        MSChat1.CancelEntering <br>        MSChat1.ClearHistory <br>    Else <br>        If (MSChat1.State = 3) Then <br>            TranscriptCmd.Enabled = False <br>            MSChat1.ExitRoom <br>            MSChat1.ClearHistory <br>        End If <br>    End If <br>     <br>    Call Enable_ChatOptions(True) <br>End If <br> <br> <br>Exit Sub        ' Exit to avoid handler. <br>ErrorHandler:   ' Error-handling routine. <br>    Select Case Err.Number  ' Evaluate error number. <br>        Case 75 <br>            Msg = "Error Saving Transcript File! Make Sure you have access privelages to the file" <br>            MsgBox Msg, , TranscriptFile.Text <br>            Err.Clear   ' Clear Err object fields <br>        Case Else <br>            ' Tell user what happened. Then clear the Err object. <br>            Msg = "There was an error attempting to open the OLE object!" <br>            MsgBox Msg, , Err.Number <br>            Err.Clear   ' Clear Err object fields <br>     <br>            ' Handle other situations here... <br>    End Select <br> <br>End Sub <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
