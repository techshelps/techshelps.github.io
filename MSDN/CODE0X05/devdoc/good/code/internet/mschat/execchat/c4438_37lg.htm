<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ECENTER.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4444"></a>ECENTER.FRM</h2>
<pre><code>VERSION 4.00 <br>'**************************************************************************** <br>' <br>'  Module:     ExecChat.Exe <br>'  File:       ECenter.frm <br>' <br>'  Copyright (c) Microsoft Corporation 1996-1997 <br>' <br>' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>' ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>' THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>' PARTICULAR PURPOSE. <br>'**************************************************************************** <br>Begin VB.Form EnterOptions  <br>   BackColor       =   &amp;H00FFFFC0&amp; <br>   BorderStyle     =   3  'Fixed Dialog <br>   Caption         =   "Enter Room Options" <br>   ClientHeight    =   2325 <br>   ClientLeft      =   1890 <br>   ClientTop       =   1980 <br>   ClientWidth     =   6945 <br>   Height          =   2730 <br>   Left            =   1830 <br>   LinkTopic       =   "EnterOptions" <br>   MaxButton       =   0   'False <br>   MinButton       =   0   'False <br>   ScaleHeight     =   2325 <br>   ScaleWidth      =   6945 <br>   ShowInTaskbar   =   0   'False <br>   Top             =   1635 <br>   Width           =   7065 <br>   Begin VB.CheckBox chkMicOnly  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "MIC only room?" <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   8 <br>      Top             =   1800 <br>      Width           =   1455 <br>   End <br>   Begin VB.TextBox txtRoomPath  <br>      Height          =   285 <br>      Left            =   120 <br>      TabIndex        =   2 <br>      Top             =   1200 <br>      Width           =   4095 <br>   End <br>   Begin VB.TextBox txtAlias  <br>      Height          =   285 <br>      Left            =   120 <br>      TabIndex        =   0 <br>      Top             =   360 <br>      Width           =   4095 <br>   End <br>   Begin VB.CommandButton cmdOK  <br>      Caption         =   "OK" <br>      Default         =   -1  'True <br>      Height          =   375 <br>      Left            =   4440 <br>      TabIndex        =   3 <br>      Top             =   1800 <br>      Width           =   1095 <br>   End <br>   Begin VB.CommandButton cmdCancel  <br>      Caption         =   "Cancel" <br>      Height          =   375 <br>      Left            =   5640 <br>      TabIndex        =   4 <br>      Top             =   1800 <br>      Width           =   1095 <br>   End <br>   Begin VB.TextBox txtRoomPwd  <br>      Height          =   285 <br>      Left            =   4800 <br>      TabIndex        =   1 <br>      Top             =   360 <br>      Width           =   1935 <br>   End <br>   Begin VB.Label Label7  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Type your alias:" <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   7 <br>      Top             =   120 <br>      Width           =   3975 <br>   End <br>   Begin VB.Label Label8  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Type the chat room path:" <br>      Height          =   255 <br>      Index           =   0 <br>      Left            =   120 <br>      TabIndex        =   6 <br>      Top             =   960 <br>      Width           =   3975 <br>   End <br>   Begin VB.Label lblRoomPwd  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Type the optional host key:" <br>      Height          =   255 <br>      Left            =   4800 <br>      TabIndex        =   5 <br>      Top             =   120 <br>      Width           =   1935 <br>   End <br>End <br>Attribute VB_Name = "EnterOptions" <br>Attribute VB_Creatable = False <br>Attribute VB_Exposed = False <br>Option Explicit <br> <br>' Channel creation modes <br>Const OCX_CHANNEL_CREATE_JOIN = 1 <br> <br>Const OCX_CHANNEL_FLAG_LOCAL = 2     ' channel not exposed to other servers on net <br>Const OCX_CHANNEL_FLAG_FEED = 4      ' news feeds, stock quotes.. <br>Const OCX_CHANNEL_FLAG_MICONLY = 8   ' NO IRC - NO NO NO IRC <br>Const OCX_CHANNEL_FLAG_AUTHONLY = 16 ' permit authenticated members only <br>Const OCX_CHANNEL_FLAG_AUTHTALK = 32 ' permit only authenticated members to talk <br> <br>Const OCX_CHANNEL_PUBLIC = 1         ' open to anybody and anything <br>Const OCX_CHANNEL_TOPICOP = 2        ' topic can be changed only by Host <br>Const OCX_CHANNEL_NOREMOTE = 4       ' only allow users who logged into THIS server..to enter chat <br>Const OCX_CHANNEL_NOWHISPER = 8      ' no whispers or \msg allowed <br>Const OCX_CHANNEL_AUDITORIUM = 16    ' auditorium chat room <br>Const OCX_CHANNEL_MODERATED = 32     ' join as spectator by default <br> <br> <br>Dim nFlags As Integer <br>Dim nType As Integer <br> <br>Private Sub cmdCancel_Click() <br>    Hide <br>End Sub <br> <br> <br>Private Sub cmdOK_Click() <br>         <br>    On Error Resume Next <br>     <br>    Dim nFlags As Integer <br>     <br>    If (chkMicOnly.Value = 1) Then <br>        nFlags = 9  'Mic only room <br>    Else <br>        nFlags = 1  'Mic and Irc room <br>    End If <br>     <br>    ExecC.MSChat.EnterRoom txtRoomPath.Text, txtRoomPwd.Text, txtAlias.Text, "NTLM;ANON", nFlags, 0 <br>     <br>    If (Err.Number = 0) Then <br>        ExecC.lblAlias.Caption = txtAlias.Text <br>        ExecC.StatusBar.Panels(3).Text = txtRoomPath.Text <br>        If (ExecC.optHost.Value) Then <br>            WriteLogFile "Entering room " + txtRoomPath.Text + " as host." <br>        Else <br>            If (ExecC.optModerator.Value) Then <br>                WriteLogFile "Entering room " + txtRoomPath.Text + " as moderator." <br>            Else <br>                WriteLogFile "Entering room " + txtRoomPath.Text + " as guest." <br>            End If <br>        End If <br>        WriteLogFile "Alias: " + txtAlias.Text <br>    End If <br>     <br>    Hide <br>End Sub <br> <br> <br>Private Sub Form_Load() <br>     <br>    txtRoomPath.Text = VBGetPrivateProfileString("Common Default Entries", "RoomPath", "//Comicsrv1.microsoft.com/#ExecChat", App.Path + "\ExecChat.ini") <br>    txtRoomPwd.Text = VBGetPrivateProfileString("Common Default Entries", "HostKey", "", App.Path + "\ExecChat.ini") <br>     <br>    If (ExecC.optHost.Value) Then <br>        txtAlias.Text = VBGetPrivateProfileString("Host Default Entries", "HostAlias", "Host", App.Path + "\ExecChat.ini") <br>    End If <br>    If (ExecC.optModerator.Value) Then <br>        txtAlias.Text = VBGetPrivateProfileString("Moderator Default Entries", "ModeratorAlias", "Moderator", App.Path + "\ExecChat.ini") <br>    End If <br>    If (ExecC.optGuest.Value) Then <br>        txtAlias.Text = VBGetPrivateProfileString("Guest Default Entries", "GuestAlias", "Guest", App.Path + "\ExecChat.ini") <br>    End If <br>     <br>    If (InStr(txtRoomPath.Text, "/#") Or InStr(txtRoomPath.Text, "\#")) Then <br>        chkMicOnly.Value = 0 <br>    Else <br>        chkMicOnly.Value = 1 <br>    End If <br>End Sub <br> <br>Private Sub txtRoomPath_Change() <br>    If (InStr(txtRoomPath.Text, "/#") Or InStr(txtRoomPath.Text, "\#")) Then <br>        chkMicOnly.Value = 0 <br>    Else <br>        chkMicOnly.Value = 1 <br>    End If <br>End Sub <br> <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
