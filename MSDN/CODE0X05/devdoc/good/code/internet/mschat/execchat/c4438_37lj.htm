<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WHISPTOH.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4447"></a>WHISPTOH.FRM</h2>
<pre><code>VERSION 4.00 <br>'**************************************************************************** <br>' <br>'  Module:     ExecChat.EXE <br>'  File:       WhispToH.frm <br>' <br>'  Copyright (c) Microsoft Corporation 1996-1997 <br>' <br>' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>' ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>' THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>' PARTICULAR PURPOSE. <br>'**************************************************************************** <br>Begin VB.Form WhispToHosts  <br>   BackColor       =   &amp;H00FFFFC0&amp; <br>   Caption         =   "Whisper to Hosts" <br>   ClientHeight    =   3855 <br>   ClientLeft      =   2055 <br>   ClientTop       =   2010 <br>   ClientWidth     =   7125 <br>   Height          =   4260 <br>   Left            =   1995 <br>   LinkTopic       =   "Form1" <br>   ScaleHeight     =   3855 <br>   ScaleWidth      =   7125 <br>   Top             =   1665 <br>   Width           =   7245 <br>   Begin VB.TextBox txtMessage  <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   0 <br>         weight          =   400 <br>         size            =   9.75 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   2895 <br>      Left            =   2640 <br>      MultiLine       =   -1  'True <br>      ScrollBars      =   2  'Vertical <br>      TabIndex        =   0 <br>      Top             =   360 <br>      Width           =   4335 <br>   End <br>   Begin VB.CommandButton Cancel  <br>      Caption         =   "Cancel" <br>      Height          =   375 <br>      Left            =   6120 <br>      TabIndex        =   3 <br>      Top             =   3360 <br>      Width           =   855 <br>   End <br>   Begin VB.CommandButton cmdOK  <br>      Caption         =   "OK" <br>      Height          =   375 <br>      Left            =   5040 <br>      TabIndex        =   2 <br>      Top             =   3360 <br>      Width           =   855 <br>   End <br>   Begin VB.ListBox lstHosts  <br>      Height          =   3375 <br>      Left            =   120 <br>      MultiSelect     =   2  'Extended <br>      TabIndex        =   1 <br>      Top             =   360 <br>      Width           =   2295 <br>   End <br>   Begin VB.Label Label2  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Message To Whisper:" <br>      Height          =   210 <br>      Left            =   2640 <br>      TabIndex        =   5 <br>      Top             =   120 <br>      Width           =   1695 <br>   End <br>   Begin VB.Label Label1  <br>      BackColor       =   &amp;H00FFFFC0&amp; <br>      Caption         =   "Host List:" <br>      Height          =   205 <br>      Left            =   120 <br>      TabIndex        =   4 <br>      Top             =   120 <br>      Width           =   735 <br>   End <br>End <br>Attribute VB_Name = "WhispToHosts" <br>Attribute VB_Creatable = False <br>Attribute VB_Exposed = False <br>Option Explicit <br>Private Sub Cancel_Click() <br>    txtMessage.Text = "" <br>    Hide <br>End Sub <br> <br> <br>Private Sub cmdOK_Click() <br>    On Error Resume Next <br>     <br>    ' get the selected hosts and construct an array of longs <br>    Dim rglHostIDs(0 To 15) As Long <br>    Dim nCnt As Integer <br>    Dim nArrayIndex As Integer <br>     <br>    nArrayIndex = 0 <br>    For nCnt = 0 To lstHosts.ListCount - 1 <br>        If lstHosts.Selected(nCnt) Then <br>            If nArrayIndex &gt; 15 Then <br>                MsgBox "Too many hosts are selected. You are limited to 10 hosts.", vbOKOnly, "Executive Chat Monitoring Tool" <br>                Exit For <br>            End If <br>            If (lstHosts.ItemData(nCnt) &lt;&gt; ExecC.MSChat.ThisParticipantID) Then <br>                rglHostIDs(nArrayIndex) = lstHosts.ItemData(nCnt) <br>                nArrayIndex = nArrayIndex + 1 <br>            End If <br>        End If <br>    Next nCnt <br>     <br>    If (ExecC.MSChat.State = 3 And nArrayIndex &gt; 0 And txtMessage.Text &lt;&gt; "") Then <br>        ExecC.MSChat.SendMessage rglHostIDs, nArrayIndex, Trim(txtMessage.Text) <br>    End If <br>     <br>    txtMessage.Text = "" <br>    Hide <br>End Sub <br> <br> <br> <br>Private Sub Form_Activate() <br>    On Error Resume Next <br>    txtMessage.SetFocus <br>End Sub <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
