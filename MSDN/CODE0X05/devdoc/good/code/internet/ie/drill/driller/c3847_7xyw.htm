<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CUSTSITE.H</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context3848"></a>CUSTSITE.H</h2>
<pre><code><br>//=--------------------------------------------------------------------------= <br>//  (C) Copyright 1996-1997 Microsoft Corporation. All Rights Reserved. <br>//=--------------------------------------------------------------------------= <br>#ifndef __CUSTOMSITEH__ <br>#define __CUSTOMSITEH__ <br> <br>#include "idispimp.h" <br>#include &lt;mshtmhst.h&gt; <br> <br>//  <br>// NOTE:  <br>// Some of the code in this file is MFC implementation specific. <br>// Changes in future versions of MFC implementation may require <br>// the code to be changed. Please check the readme of this <br>// sample for more information  <br>//  <br> <br>class CCustomControlSite:public COleControlSite <br>{ <br>public: <br>CCustomControlSite(COleControlContainer *pCnt):COleControlSite(pCnt){} <br> <br>protected: <br> <br>DECLARE_INTERFACE_MAP(); <br>BEGIN_INTERFACE_PART(DocHostUIHandler, IDocHostUIHandler) <br>STDMETHOD(ShowContextMenu)(/* [in] */ DWORD dwID, <br>            /* [in] */ POINT __RPC_FAR *ppt, <br>            /* [in] */ IUnknown __RPC_FAR *pcmdtReserved, <br>            /* [in] */ IDispatch __RPC_FAR *pdispReserved); <br>STDMETHOD(GetHostInfo)(  <br>            /* [out][in] */ DOCHOSTUIINFO __RPC_FAR *pInfo); <br>STDMETHOD(ShowUI)(  <br>            /* [in] */ DWORD dwID, <br>            /* [in] */ IOleInPlaceActiveObject __RPC_FAR *pActiveObject, <br>            /* [in] */ IOleCommandTarget __RPC_FAR *pCommandTarget, <br>            /* [in] */ IOleInPlaceFrame __RPC_FAR *pFrame, <br>            /* [in] */ IOleInPlaceUIWindow __RPC_FAR *pDoc); <br>STDMETHOD(HideUI)(void); <br>STDMETHOD(UpdateUI)(void); <br>STDMETHOD(EnableModeless)(/* [in] */ BOOL fEnable); <br>STDMETHOD(OnDocWindowActivate)(/* [in] */ BOOL fEnable); <br>STDMETHOD(OnFrameWindowActivate)(/* [in] */ BOOL fEnable); <br>STDMETHOD(ResizeBorder)(  <br>            /* [in] */ LPCRECT prcBorder, <br>            /* [in] */ IOleInPlaceUIWindow __RPC_FAR *pUIWindow, <br>            /* [in] */ BOOL fRameWindow); <br>STDMETHOD(TranslateAccelerator)(  <br>            /* [in] */ LPMSG lpMsg, <br>            /* [in] */ const GUID __RPC_FAR *pguidCmdGroup, <br>            /* [in] */ DWORD nCmdID); <br>STDMETHOD(GetOptionKeyPath)(  <br>            /* [out] */ LPOLESTR __RPC_FAR *pchKey, <br>            /* [in] */ DWORD dw); <br>STDMETHOD(GetDropTarget)( <br>            /* [in] */ IDropTarget __RPC_FAR *pDropTarget, <br>            /* [out] */ IDropTarget __RPC_FAR *__RPC_FAR *ppDropTarget); <br>    STDMETHOD(GetExternal)(  <br>            /* [out] */ IDispatch __RPC_FAR *__RPC_FAR *ppDispatch); <br>    STDMETHOD(TranslateUrl)(  <br>            /* [in] */ DWORD dwTranslate, <br>            /* [in] */ OLECHAR __RPC_FAR *pchURLIn, <br>            /* [out] */ OLECHAR __RPC_FAR *__RPC_FAR *ppchURLOut); <br>    STDMETHOD(FilterDataObject)(  <br>            /* [in] */ IDataObject __RPC_FAR *pDO, <br>            /* [out] */ IDataObject __RPC_FAR *__RPC_FAR *ppDORet); <br>END_INTERFACE_PART(DocHostUIHandler) <br>}; <br> <br> <br>class CCustomOccManager :public COccManager <br>{ <br>public: <br>CCustomOccManager(){} <br>COleControlSite* CreateSite(COleControlContainer* pCtrlCont) <br>{ <br>CCustomControlSite *pSite = new CCustomControlSite(pCtrlCont); <br>return pSite; <br>} <br>}; <br> <br> <br> <br> <br>#endif </code></pre>
<p>&nbsp;</p></body>
</HTML>
