<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INETALL.H</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4011"></a>INETALL.H</h2>
<pre><code>/////////////////////////////////////////////////////// <br>/* <br> *  inetall.h <br> * <br> *  Written by Wei Hua <br> *  of Microsoft Developer Support <br> * <br> *  Copyright (C) 1997 Microsoft Corporation. All rights reserved <br> * <br> *  Header file for inetal.cpp.   <br> */ <br>////////////////////////////////////////////////////// <br> <br>   <br>//dialog box control id for rc file <br>/////////////////////////////////////////////////////// <br>#define IDC_STATIC -1 <br>#define IDD_INETALL_DIALOG              102 <br>#define IDR_MAINFRAME                   128 <br>#define IDB_BMERR                       130 <br>#define IDB_BMDIR                       131 <br>#define IDB_BMFILE                      132 <br>#define IDC_HTTP                        1000 <br>#define IDC_FTP                         1001 <br>#define IDC_FILE                        1002 <br>#define IDC_URL                         1006 <br>#define IDC_USERNAME                    1007 <br>#define IDC_PASSWORD                    1008 <br>#define IDC_HTML                        1009 <br>#define IDC_GETDATA                     1010 <br>#define IDC_TREE1                       1012 <br>#define IDC_CERN                        1013 <br> <br>/////////////////////////////////////////////////////// <br>#define MAX_STRING_SIZE1024 <br>#define SERVICE_TYPE_HTTP1 <br>#define SERVICE_TYPE_FTP2 <br>#define SERVICE_TYPE_FILE3 <br> <br>HINSTANCE g_hInst;//Application Instance <br>HWND g_hDlg;//main dialogbox window handle <br>TCHAR szFullUrl[MAX_STRING_SIZE];  <br> <br>//ItemAttrib, and CMyItemArray: data structures for enumerating <br>//FTP URL and FILE URL <br>typedef struct _tagItemAttrib  <br>{ <br>TCHARszObjectPath[MAX_STRING_SIZE]; <br>intnObjectType; //0 file object, 1 directory object <br>} ItemAttrib, *PItemAttrib; <br> <br>//Implements only the minimal functions needed for maintaining items  <br>//info in the tree control.  <br>class CMyItemArray  <br>{ <br>public: <br>CMyItemArray();// standard constructor <br>~CMyItemArray(); <br> <br>int Add(ItemAttrib&amp; item); //return Item index <br>void RemoveAll(); <br>ItemAttrib GetAt(int nIndex); <br>int GetSize(); <br> <br>private: <br>PItemAttrib m_pItemlist; <br>int m_nCount; <br>}; <br> <br>typedef struct _tagINETALLBAG <br>{ <br>HIMAGELISThImgList; <br>HWNDhTreeViewCtrl;  <br>HTREEITEMm_curItem; <br> <br>HWNDhCheckBoxCern; <br>BOOLm_cern; <br> <br>DWORDm_dwServiceType; <br> <br>HWNDhwndUrl; <br>TCHARm_url[MAX_STRING_SIZE]; <br>HWNDhwndPassword; <br>TCHARm_password[MAX_STRING_SIZE]; <br>HWNDhwndUsername; <br>TCHARm_username[MAX_STRING_SIZE]; <br> <br>HWNDhwndHTML; <br>LPTSTRm_phtml; <br>DWORDm_dwSizeHtml; <br>CMyItemArraym_itemArray; <br> <br>BOOLm_bRedrawTree; <br>//TRUE delete all items in the tree control and add new items. <br>//FALSE add new items as the sub items to the hCurItem <br> <br>} INETALLBAG, *PINETALLBAG; <br> <br>INETALLBAG g_Inet; <br> <br>//Update UI or Collect input from UI <br>//bDirection FALSE g_Inet to UI <br>//bDirection TRUE UI to g_Inet <br>//Helper function similar to MFC UpdateData <br>BOOL UpdateUI(BOOL bDirection);  <br> <br>//Enumerate strURL, and populate g_Inet.m_itemArray <br>BOOL FillFtpOrFileObjArray(HINTERNET InternetSession, LPTSTR strURL); <br> <br>//Draw the TreeView control using g_Inet.m_itemArray <br>void FillTreeControl(); <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
