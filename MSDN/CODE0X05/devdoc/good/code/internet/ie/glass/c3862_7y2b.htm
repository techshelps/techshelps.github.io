<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPGLASS.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context3863"></a>CPGLASS.H</h2>
<pre><code>////////////////////////////////////////////////////////////////////////////// // CProxy_GlassEvents template &lt;class T&gt; class CProxy_GlassEvents : public IConnectionPointImpl&lt;T, &amp;DIID__GlassEvents, CComDynamicUnkArray&gt; { public: //methods: //_GlassEvents : IDispatch public: void OnMouseDown( short Button, short Shift, long x, long y) { VARIANTARG* pvars = new VARIANTARG[4]; for (int i = 0; i &lt; 4; i++) VariantInit(&amp;pvars[i]); T* pT = (T*)this; pT-&gt;Lock(); IUnknown** pp = m_vec.begin(); while (pp &lt; m_vec.end()) { if (*pp != NULL) { pvars[3].vt = VT_I2; pvars[3].iVal= Button; pvars[2].vt = VT_I2; pvars[2].iVal= Shift; pvars[1].vt = VT_I4; pvars[1].lVal= x; pvars[0].vt = VT_I4; pvars[0].lVal= y; DISPPARAMS disp = { pvars, NULL, 4, 0 }; IDispatch* pDispatch = reinterpret_cast&lt;IDispatch*&gt;(*pp); pDispatch-&gt;Invoke(DISPID_MOUSEDOWN, IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_METHOD, &amp;disp, NULL, NULL, NULL); } pp++; } pT-&gt;Unlock(); delete[] pvars; } void OnMouseMove( short Button, short Shift, long x, long y) { VARIANTARG* pvars = new VARIANTARG[4]; for (int i = 0; i &lt; 4; i++) VariantInit(&amp;pvars[i]); T* pT = (T*)this; pT-&gt;Lock(); IUnknown** pp = m_vec.begin(); while (pp &lt; m_vec.end()) { if (*pp != NULL) { pvars[3].vt = VT_I2; pvars[3].iVal= Button; pvars[2].vt = VT_I2; pvars[2].iVal= Shift; pvars[1].vt = VT_I4; pvars[1].lVal= x; pvars[0].vt = VT_I4; pvars[0].lVal= y; DISPPARAMS disp = { pvars, NULL, 4, 0 }; IDispatch* pDispatch = reinterpret_cast&lt;IDispatch*&gt;(*pp); pDispatch-&gt;Invoke(DISPID_MOUSEMOVE, IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_METHOD, &amp;disp, NULL, NULL, NULL); } pp++; } pT-&gt;Unlock(); delete[] pvars; } void OnMouseUp( short Button, short Shift, long x, long y) { VARIANTARG* pvars = new VARIANTARG[4]; for (int i = 0; i &lt; 4; i++) VariantInit(&amp;pvars[i]); T* pT = (T*)this; pT-&gt;Lock(); IUnknown** pp = m_vec.begin(); while (pp &lt; m_vec.end()) { if (*pp != NULL) { pvars[3].vt = VT_I2; pvars[3].iVal= Button; pvars[2].vt = VT_I2; pvars[2].iVal= Shift; pvars[1].vt = VT_I4; pvars[1].lVal= x; pvars[0].vt = VT_I4; pvars[0].lVal= y; DISPPARAMS disp = { pvars, NULL, 4, 0 }; IDispatch* pDispatch = reinterpret_cast&lt;IDispatch*&gt;(*pp); pDispatch-&gt;Invoke(DISPID_MOUSEUP, IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_METHOD, &amp;disp, NULL, NULL, NULL); } pp++; } pT-&gt;Unlock(); delete[] pvars; }  };   </code></pre>
<p>&nbsp;</p></body>
</HTML>
