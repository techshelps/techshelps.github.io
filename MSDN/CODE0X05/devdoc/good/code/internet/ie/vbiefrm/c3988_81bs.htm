<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LINKVIEW.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context3988"></a>LINKVIEW.FRM</h2>
<pre><code>VERSION 5.00 <br>Object = "{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}#1.1#0"; "SHDOCVW.DLL" <br>Begin VB.Form LinkView  <br>   Caption         =   "Form1" <br>   ClientHeight    =   6480 <br>   ClientLeft      =   60 <br>   ClientTop       =   345 <br>   ClientWidth     =   7590 <br>   LinkTopic       =   "Form1" <br>   ScaleHeight     =   6480 <br>   ScaleWidth      =   7590 <br>   StartUpPosition =   3  'Windows Default <br>   Begin SHDocVwCtl.WebBrowser WebBrowser1  <br>      Height          =   3495 <br>      Left            =   120 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   7215 <br>      ExtentX         =   6165 <br>      ExtentY         =   12726 <br>      ViewMode        =   1 <br>      Offline         =   0 <br>      Silent          =   0 <br>      RegisterAsBrowser=   0 <br>      RegisterAsDropTarget=   1 <br>      AutoArrange     =   -1  'True <br>      NoClientEdge    =   0   'False <br>      AlignLeft       =   0   'False <br>      ViewID          =   "{0057D0E0-3573-11CF-AE69-08002B2E1262}" <br>      Location        =   "" <br>   End <br>   Begin VB.TextBox editNavURL  <br>      Height          =   375 <br>      Left            =   1800 <br>      TabIndex        =   1 <br>      Top             =   5940 <br>      Width           =   5655 <br>   End <br>   Begin VB.CommandButton btnNavigate  <br>      Caption         =   "Navigate" <br>      Default         =   -1  'True <br>      Height          =   375 <br>      Left            =   120 <br>      TabIndex        =   2 <br>      Top             =   5940 <br>      Width           =   1455 <br>   End <br>   Begin VB.TextBox editID  <br>      Height          =   375 <br>      Left            =   3480 <br>      TabIndex        =   10 <br>      TabStop         =   0   'False <br>      Top             =   5400 <br>      Width           =   3975 <br>   End <br>   Begin VB.TextBox editElement  <br>      Height          =   375 <br>      Left            =   1920 <br>      TabIndex        =   8 <br>      TabStop         =   0   'False <br>      Top             =   5400 <br>      Width           =   855 <br>   End <br>   Begin VB.ListBox listLinks  <br>      Height          =   1425 <br>      Left            =   1800 <br>      TabIndex        =   6 <br>      TabStop         =   0   'False <br>      Top             =   3840 <br>      Width           =   5655 <br>   End <br>   Begin VB.CommandButton btnGoBack  <br>      Caption         =   "Go Back" <br>      Enabled         =   0   'False <br>      Height          =   375 <br>      Left            =   120 <br>      TabIndex        =   4 <br>      Top             =   4320 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton btnGoForward  <br>      Caption         =   "Go Forward" <br>      Enabled         =   0   'False <br>      Height          =   375 <br>      Left            =   120 <br>      TabIndex        =   5 <br>      Top             =   3840 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton btnGetLinks  <br>      Caption         =   "Get Links" <br>      Height          =   375 <br>      Left            =   120 <br>      TabIndex        =   3 <br>      Top             =   4950 <br>      Width           =   1455 <br>   End <br>   Begin VB.Label Label2  <br>      Caption         =   "href:" <br>      Height          =   285 <br>      Left            =   3000 <br>      TabIndex        =   9 <br>      Top             =   5490 <br>      Width           =   375 <br>   End <br>   Begin VB.Label Label1  <br>      Caption         =   "onMouseOver Element:" <br>      Height          =   285 <br>      Left            =   120 <br>      TabIndex        =   7 <br>      Top             =   5490 <br>      Width           =   1815 <br>   End <br>End <br>Attribute VB_Name = "LinkView" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>Dim WithEvents DocEvents As HTMLDocument <br>Attribute DocEvents.VB_VarHelpID = -1 <br> <br>Private Sub Form_Load() <br>    WebBrowser1.navigate ("http://www.microsoft.com") <br>End Sub <br> <br>Private Sub WebBrowser1_BeforeNavigate2(ByVal pDisp As Object, URL As Variant, Flags As Variant, TargetFrameName As Variant, PostData As Variant, Headers As Variant, Cancel As Boolean) <br>    Set DocEvents = Nothing <br>    listLinks.Clear <br>    editElement = "" <br>    editID = "" <br>End Sub <br> <br>Private Sub btnNavigate_Click() <br>    WebBrowser1.navigate (editNavURL) <br>End Sub <br>    <br>Private Sub btnGoForward_Click() <br>    WebBrowser1.GoForward <br>End Sub <br> <br>Private Sub btnGoBack_Click() <br>    WebBrowser1.GoBack <br>End Sub <br> <br>Private Sub WebBrowser1_CommandStateChange(ByVal Command As Long, ByVal Enable As Boolean) <br>    Select Case Command <br>        Case CSC_NAVIGATEBACK <br>            btnGoBack.Enabled = Enable <br>        Case CSC_NAVIGATEFORWARD <br>            btnGoForward.Enabled = Enable <br>    End Select <br>End Sub <br> <br>Private Sub DocEvents_onmouseover() <br>    ' the element may not have an href <br>    On Error Resume Next <br>     <br>    Dim curWnd As HTMLWindow2 <br>    Dim curElement As IHTMLElement <br>     <br>    Set curWnd = WebBrowser1.document.parentWindow <br>    Set curElement = curWnd.event.srcElement <br>     <br>    editElement = "" <br>    editID = "" <br>     <br>    editElement = curElement.tagName <br>    editID = curElement.href <br>End Sub <br> <br>Private Sub DocEvents_onmouseout() <br>    editElement = "" <br>    editID = "" <br>End Sub <br> <br>Private Sub btnGetLinks_Click() <br>    On Error Resume Next <br>    <br>    Dim theControl As WebBrowser <br>    Set theControl = WebBrowser1 <br>     <br>    Dim HTMLDoc As HTMLDocument <br>    Set HTMLDoc = WebBrowser1.document <br>      <br>    listLinks.Clear <br>    Call RecurseFrames(HTMLDoc) <br>End Sub <br> <br>Private Sub RecurseFrames(HTMLDoc As HTMLDocument) <br>    On Error GoTo handleError <br>     <br>    If HTMLDoc Is Nothing Then <br>        ' Not an HTLM document <br>        Exit Sub <br>    End If <br>     <br>    Dim BODYElement As IHTMLElement <br>    Set BODYElement = HTMLDoc.body <br>     <br>    If BODYElement.tagName = "BODY" Then <br>        Dim ELEMENTCo As IHTMLElementCollection <br>        Set ELEMENTCo = HTMLDoc.links <br>         <br>        Dim Element As HTMLAnchorElement <br>         <br>        For Each Element In ELEMENTCo <br>            listLinks.AddItem (Element.href) <br>        Next <br>    End If <br>     <br>    Dim HTMLFrames As IHTMLFramesCollection2 <br>    Set HTMLFrames = HTMLDoc.frames <br>     <br>    Dim HTMLWnd As HTMLWindow2 <br>     <br>    For countFrames = 0 To HTMLFrames.length - 1 <br>        Set HTMLWnd = HTMLFrames(countFrames) <br>        Call RecurseFrames(HTMLWnd.document) <br>    Next <br>     <br>    Exit Sub <br>handleError: <br>        MsgBox (Err.Description) <br>End Sub <br> <br>Private Sub WebBrowser1_DocumentComplete(ByVal pDisp As Object, URL As Variant) <br>    'may be word or some other server <br>    On Error Resume Next <br>     <br>    If pDisp Is WebBrowser1.Object Then <br>        Set DocEvents = WebBrowser1.document <br>    End If <br>End Sub <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
