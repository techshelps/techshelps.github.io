<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>README.TXT</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4265"></a>README.TXT</h2>
<pre><code>Demonstration of issuing Microsoft Index Server queries <br> <br> <br>SUMMARY <br>======= <br> <br>QSAMPLE is a command line utility that issues Microsoft Index Server queries. <br>It uses the helper functions CCreateICommand and CITextToFullTree to <br>simplify the code needed to create a query. <br> <br> <br>MORE INFORMATION <br>================ <br> <br>usage: QSAMPLE query [/c:catalog] [/m:machine] <br>    query        a Microsoft Index Server query <br>    /c:catalog   name of the catalog, default is SYSTEM <br>    /m:machine   name of the machine, default is local machine <br>    /d           displays the DBCOMMANDTREE, default is off <br> <br>The syntax for the "query" parameter is described in the Microsoft Index <br>Server documentation.  Typically this is a single word.  To include a <br>space in a query, enclose the query in quotes. <br> <br>The "catalog" parameter is the name of the catalog to be queried.  The <br>default is "SYSTEM", which is the default catalog installed with Windows <br>NT 5.0.  Additional catalogs can be created with the Microsoft Index Server <br>MMC snapin. <br> <br>The "machine" parameter is the name of the machine on which the query <br>will be executed.  The default is ".", which is the local machine.  Machine <br>names should not be preceeded with two backslashes. <br> <br>The "/d" parameter displays the DBCOMMANDTREE built to execute the query. <br> <br>For each file that matches the query, the file's size and path <br>are printed. <br> <br>The query results are not sorted. <br> <br>How this example differs from the ADVQUERY sample: <br> <br>  QSAMPLE uses Index Server's helper functions CICreateCommand and <br>  CITextToFullTree as opposed to creating an ICommand via ole and <br>  the command tree from scratch. <br> <br>Examples: <br> <br>    qsample foo <br>    Finds all files in the SYSTEM catalog on the local machine containing <br>    the word "foo" <br> <br>    qsample "foo bar" <br>    Finds all files in the SYSTEM catalog on the local machine containing <br>    the phrase "foo bar" <br> <br>    qsample "foo and bar" <br>    Finds all files in the SYSTEM catalog on the local machine containing <br>    both "foo" and "bar" <br> <br>    qsample "foo or bar" <br>    Finds all files in the SYSTEM catalog on the local machine containing <br>    either "foo" or "bar" <br> <br>    qsample foo /m:SERVERNAME <br>    Finds all files in the SYSTEM catalog on machine "servername" containing <br>    the word foo <br> <br>    qsample "@size &gt; 1000000" <br>    Finds all files in the SYSTEM catalog on the local machine larger than <br>    one million bytes. <br> <br>    qsample "@size &gt; 1000000 and #filename *.gif" /c:WEB /m:SERVERNAME <br>    Finds all files with the .gif extension larger than one million bytes <br>    in the WEB catalog on machine SERVERNAME <br> <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
