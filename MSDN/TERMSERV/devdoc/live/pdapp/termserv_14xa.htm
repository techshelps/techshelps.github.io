<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Storing User-Specific Information</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_storing_user_specific_information"></a>Storing User-Specific Information</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
In a Windows®-based Terminal Server environment, applications should store user-specific information in user-specific locations, separately from global information that applies to all users. This rule applies to information stored in the registry, as well as information stored in files. In general, do not assume that one computer is equivalent to one user. </p>
<p>
Store user-specific registry information under the HKEY_CURRENT_USER registry key. Terminal Server loads the current user's personal registry hive into HKEY_CURRENT_USER when the user logs on. Of course, the Terminal Server manages the registry to ensure that each of the logged on clients detects the correct user hive under HKEY_CURRENT_USER. </p>
<p>
In contrast, all users share the HKEY_LOCAL_MACHINE hive. Use HKEY_LOCAL_MACHINE to store computer-specific information, not user-specific information. </p>
<p>
Store user preference files or other user-specific files in the user's home directory or in a user-specified directory. This consideration applies to temporary files used to store interim information (such as cached data) or to pass data on to another application. User-specific temporary files must also be stored on a per-user basis. </p>
<p>
You can use the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_shgetspecialfolderlocation">
</object><a href=JavaScript:alink_1.Click()><b>SHGetSpecialFolderLocation</b></a> function with the CSIDL_PERSONAL flag to get the location of the user's personal files directory. You can also use the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getwindowsdirectory">
</object><a href=JavaScript:alink_2.Click()><b>GetWindowsDirectory</b></a> function to retrieve the path of the Windows directory. In a Terminal Server environment, the Windows directory is guaranteed to be private for each user. Do not store user-specific files under the system directory (for example, WINNT) or program directory (for example, Program Files). </p>
<p>&nbsp;</p></body>
</HTML>
