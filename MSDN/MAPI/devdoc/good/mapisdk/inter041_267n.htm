<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITnef::AddProps</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_itnef_addprops"></a>ITnef::AddProps</h2>
<p>
The <b>ITnef::AddProps</b> method allows the calling service provider or gateway to add properties to the encapsulation of a message or an attachment. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter041_0ai6.htm"><b>ITnef : IUnknown</b></a>.</p>
<pre><code><b>HRESULT AddProps(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  ULONG</b><i> ulElemID</i><b>,</b>             
<b>  LPVOID</b><i> lpvData</i><b>,</b>             
<b>  LPSPropTagArray</b><i> lpPropList  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how properties are included in or excluded from encapsulation. The following flags can be set:
<dl>
<dt>
TNEF_PROP_ATTACHMENTS_ONLY</dt>
<dd>
Encodes only the properties in the <i>lpPropList </i>parameter that are part of attachments within the message.</dd>
<dt>
TNEF_PROP_CONTAINED</dt>
<dd>
Encodes only properties from the attachment specified by the <i>ulElemID</i> parameter. If the <i>lpvData</i> parameter is non-null, the data pointed to is written into the attachment's encapsulation in the file indicated by the <a href="propa_88px.htm">PR_ATTACH_TRANSPORT_NAME</a> property.</dd>
<dt>
TNEF_PROP_CONTAINED_TNEF</dt>
<dd>
Encodes only properties from the message or attachment specified by <i>ulElemID</i>. If this flag is set, the value in <i>lpvData</i> must be an ISTREAMTNEF pointer.</dd>
<dt>
TNEF_PROP_EXCLUDE</dt>
<dd>
Encodes all properties not specified in <i>lpPropList</i>. </dd>
<dt>
TNEF_PROP_INCLUDE</dt>
<dd>
Encodes all properties specified in <i>lpPropList</i>. </dd>
<dt>
TNEF_PROP_MESSAGE_ONLY</dt>
<dd>
Encodes only those properties specified in <i>lpPropList </i>that are part of the message itself.</dd>
</dl>
</dd>
<dt>
<i>ulElemID</i></dt>
<dd>
[in] An attachment's <a href="propa_0p4d.htm">PR_ATTACH_NUM</a> property, which holds a number that uniquely identifies the attachment within its parent message. The <i>ulElemID</i> parameter is used when special handling is requested for an attachment. The <i>ulElemID </i>parameter should be zero unless the TNEF_PROP_CONTAINED or TNEF_PROP_CONTAINED_TNEF flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>lpvData</i></dt>
<dd>
[in] Pointer to attachment data used to replace the data of the attachment specified in <i>ulElemID</i>. The <i>lpvData</i> parameter should be NULL unless TNEF_PROP_CONTAINED or TNEF_PROP_CONTAINED_TNEF is set in <i>ulFlags</i>.</dd>
<dt>
<i>lpPropList</i></dt>
<dd>
[in] Pointer to the list of properties to include in or exclude from encapsulation.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Transport providers, message store providers, and gateways call the <b>ITnef::AddProps</b> method to list properties to be included in or excluded from the TNEF encapsulation of a message or an attachment. Using successive calls, the provider or gateway can specify a list of properties to add and encode or to exclude from being encoded. Providers and gateways can also use <b>AddProps</b> to provide information on any special handling attachments should be given.</p>
<p>
<b>AddProps</b> is only supported for TNEF objects opened with the TNEF_ENCODE flag for the <a href="function_28ml.htm"><b>OpenTnefStream</b></a> or <a href="function_3qk8.htm"><b>OpenTnefStreamEx</b></a> function.</p>
<p>
Note that no actual TNEF encoding happens for <b>AddProps </b>until the <a href="inter041_3nvs.htm"><b>ITnef::Finish</b></a> method is called. This functionality means that pointers passed into <b>AddProps</b> must remain valid until after the call to <b>Finish</b> is made. At that point, all objects and data passed in with <b>AddProps</b> calls can be released or freed.</p>
<h4>See Also</h4>
<p>
<a href="inter041_3nvs.htm"><b>ITnef::Finish</b></a>, <a href="function_28ml.htm"><b>OpenTnefStream</b></a>, <a href="function_3qk8.htm"><b>OpenTnefStreamEx</b></a>, <a href="propa_88px.htm">PR_ATTACH_TRANSPORT_NAME</a></p>
<p>&nbsp;</p></body>
</HTML>
