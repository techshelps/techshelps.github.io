<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITnef::OpenTaggedBody</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_itnef_opentaggedbody"></a>ITnef::OpenTaggedBody</h2>
<p>
The <b>ITnef::OpenTaggedBody</b> method opens a stream interface on the text of an encapsulated message.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter041_0ai6.htm"><b>ITnef : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OpenTaggedBody(
  LPMESSAGE</b><i> lpMessage</i><b>,</b>   
<b>  ULONG</b><i> ulFlags</i><b>,</b>         
<b>  LPSTREAM FAR *</b><i> lppStream  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpMessage</i></dt>
<dd>
[in] Pointer to the message the stream is associated with. This message is not required to be the same message passed in the call to the <a href="function_28ml.htm"><b>OpenTnefStream</b></a> or <a href="function_3qk8.htm"><b>OpenTnefStreamEx</b></a> function.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the stream interface is opened. The following flags can be set:
<dl>
<dt>
MAPI_CREATE</dt>
<dd>
If a property does not exist in the current message, it should be created. If the property does exist, the current data in the property should be replaced with the data from the TNEF stream. When an implementation sets the MAPI_CREATE flag, it should also set the MAPI_MODIFY flag.</dd>
<dt>
MAPI_MODIFY</dt>
<dd>
Requests read/write access. The default interface is read-only. MAPI_MODIFY must be set whenever MAPI_CREATE is set.</dd>
</dl>
</dd>
<dt>
<i>lppStream</i></dt>
<dd>
[out] Pointer to the pointer to a stream object that contains the text from the <a href="propa_9lvd.htm">PR_BODY</a> property of the passed-in encapsulated message and that supports the <b>IStream</b> interface.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Transport providers, message store providers, and gateways call the <b>ITnef::OpenTaggedBody</b> method to open a stream interface on the text of an encapsulated message — that is, on a TNEF object. </p>
<p>
As part of its processing, <b>OpenTaggedBody</b> either inserts or parses attachment tags that indicate the position of any attachments or OLE objects within the message text. The attachment tags are in the following format:</p>
<p>
<b>[[</b> <i>attachment name </i><b>:</b> <i>n </i><b>in</b> <i>attachment container name </i><b>]]</b></p>
<p>
where <i>attachment name</i> describes the attachment object; <i>n</i> is a number identifying the attachment that is part of a sequence, incrementing from the value passed in the <i>lpKey</i> parameter of the <a href="function_28ml.htm"><b>OpenTnefStream</b></a> or <a href="function_3qk8.htm"><b>OpenTnefStreamEx</b></a> function; and <i>attachment container name</i> describes the physical component where the attachment object resides.</p>
<p>
<b>OpenTaggedBody</b> reads out message text and inserts an attachment tag wherever an attachment object originally appeared in the text. The original message text is not changed.</p>
<p>
When a message that has tags is passed to a stream, the tags are stripped out and the attachment objects are relocated in the position of the tags in the stream.</p>
<h4>See Also</h4>
<p>
<a href="function_28ml.htm"><b>OpenTnefStream</b></a>, <a href="function_3qk8.htm"><b>OpenTnefStreamEx</b></a>, <a href="propa_9lvd.htm">PR_BODY</a></p>
<p>&nbsp;</p></body>
</HTML>
