<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening an Address Book Container</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_opening_an_address_book_container"></a>Opening an Address Book Container</h2>
<p>
After opening the MAPI integrated address book, open one or more address book containers to access the recipients within them. </p>
<p>
To open the top-level container of the address book, call <a href="inter006_4cc9.htm"><b>IAddrBook::OpenEntry</b></a> with a NULL entry identifier. </p>
<p>
Address book containers can be implemented with read-only or read/write access. Read-only containers are used only for browsing. Read/write containers can be modified, allowing clients to create new entries and delete and modify existing entries. All personal address book (PAB) containers are implemented as read/write containers. </p>
<p>
To open any lower level container, call <b>OpenEntry</b> and specify the entry identifier of the container to be opened.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open the container designated as the PAB</h5>
<ol>
<li>
Call<b> <a href="inter006_89wi.htm">IAddrBook::GetPAB</a></b> to retrieve the PAB's entry identifier.</li>
<li>
Pass this entry identifier to <a href="inter006_4cc9.htm"><b>IAddrBook::OpenEntry</b></a>.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open a container that is not the PAB</h5>
<ol>
<li>
Call <a href="inter006_4cc9.htm"><b>IAddrBook::OpenEntry</b></a> with a NULL entry identifier to open the address book's root container.</li>
<li>
Call the root container's <a href="inter011_1sh1.htm"><b>IMAPIContainer::GetHierarchyTable</b></a> method to retrieve its hierarchy table — a list of all of the top-level containers in the address book.</li>
<li>
If the container to be opened is of a specific type:<ul>
<li>
Create an <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> structure with <a href="propa_7s6d.htm">PR_DISPLAY_TYPE</a> for the property tag, the container's type for the property value, and RELOP_EQ for the relation. PR_DISPLAY_TYPE can be set to many values, among them:</li>
</ul>
</li>
</ol>
<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;DT_GLOBAL to limit the hierarchy table to containers that belong in the global address list.</td>
</tr>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;DT_LOCAL to limit the table to containers belonging to a local address book.</td>
</tr>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;DT_MODIFIABLE to limit the table to containers that can be modified.</td>
</tr>
</table><br>
<ul>
<li>
Create an <a href="structyp_23i1.htm"><b>SPropTagArray</b></a> structure that includes PR_ENTRYID, PR_DISPLAY_TYPE, and any other columns of interest. </li>
<li>
Call <a href="function_0dgz.htm"><b>HrQueryAllRows</b></a>, passing your property restriction and property tag array. <b>HrQueryAllRows</b> will return zero or more rows, one row for every container that belongs to the specified type. Be prepared to handle the return of any number of rows.</li>
<li>
Call <a href="inter006_4cc9.htm"><b>IAddrBook::OpenEntry</b></a> with the entry identifier from the <a href="propa_8cv8.htm">PR_ENTRYID</a> column of the row that represents the container of interest.</li>
</ul>
<ol start=4>
<li>
If the container to be opened belongs to a specific address book provider:<ul>
<li>
Create an <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> structure with <a href="propa_3n8z.htm">PR_AB_PROVIDERS</a> for the property tag, a provider-specific value for the property value, and RELOP_EQ for the relation. Typically the provider-specific value is a globally unique identifier or GUID. You will find this value published in one of the address book provider's header files. </li>
<li>
Create an <a href="structyp_23i1.htm"><b>SPropTagArray</b></a> structure that includes PR_ENTRYID, PR_AB_PROVIDER, and any other columns of interest. </li>
<li>
Call <a href="function_0dgz.htm"><b>HrQueryAllRows</b></a>, passing your property restriction and property tag array. <b>HrQueryAllRows</b> will return zero rows if the specified address book provider is not in the profile. It can return one or more rows for the provider's top-level containers, depending on how the provider is organized.</li>
<li>
Call <a href="inter006_4cc9.htm"><b>IAddrBook::OpenEntry</b></a> with the entry identifier from the <a href="propa_8cv8.htm">PR_ENTRYID</a> column of the row that represents the container of interest. If the container that you are interested in is not a top-level container, find the top-level container and traverse the hierarchy. </li>
</ul>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
