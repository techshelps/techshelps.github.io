<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPITable::SeekRow</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapitable_seekrow"></a>IMAPITable::SeekRow</h2>
<p>
The <b>IMAPITable::SeekRow</b> method moves the cursor to a specific position in the table.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>.</p>
<pre><code><b>HRESULT SeekRow(
  BOOKMARK</b><i> bkOrigin</i><b>,</b>        
<b>  LONG</b><i> lRowCount</i><b>,</b>           
<b>  LONG FAR *</b><i> lplRowsSought  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>bkOrigin</i></dt>
<dd>
[in] Bookmark identifying the starting position for the seek operation. A bookmark can be created using the <a href="inter026_0v3f.htm"><b>IMAPITable::CreateBookmark</b></a> method, or one of the following predefined values can be passed:
<dl>
<dt>
BOOKMARK_BEGINNING</dt>
<dd>
Starts the seek operation from the beginning of the table. </dd>
<dt>
BOOKMARK_CURRENT</dt>
<dd>
Starts the seek operation from the row in the table where the cursor is located. </dd>
<dt>
BOOKMARK_END</dt>
<dd>
Starts the seek operation from the end of the table. </dd>
</dl>
</dd>
<dt>
<i>lRowCount</i></dt>
<dd>
[in] Signed count of the number of rows to move, starting from the bookmark identified by the <i>bkOrigin</i> parameter. </dd>
<dt>
<i>lplRowsSought</i></dt>
<dd>
[in-out] If <i>lplRowsSought</i> is a valid pointer on input, on output it points to the number of rows that were processed in the seek operation. If <i>lplRowsSought</i> is NULL on input — indicating that the caller is not interested in the number of rows processed — nothing is returned on output. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The seek operation was successful.</dd>
<dt>
MAPI_E_BUSY</dt>
<dd>
Another operation is in progress that prevents the row seeking operation from starting. Either the operation in progress should be allowed to complete or it should be stopped.</dd>
<dt>
MAPI_E_INVALID_BOOKMARK</dt>
<dd>
The bookmark specified in the <i>bkOrigin</i> parameter is invalid because it has been removed or because it is beyond the last row requested.</dd>
<dt>
MAPI_W_POSITION_CHANGED</dt>
<dd>
The call succeeded, but the bookmark specified in the <i>bkOrigin</i> parameter is no longer set at the same row as when it was last used. If the bookmark has not been used, it is no longer in the same position as when it was created. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPITable::SeekRow</b> method establishes a new BOOKMARK_CURRENT position for the cursor. The <i>lRowCount </i>parameter indicates the number of rows that the cursor moves and the direction of movement.</p>
<p>
If the resulting position is beyond the last row of the table, the cursor is positioned after the last row. If the resulting position is before the first row of the table, the cursor is placed at the beginning of the first row. </p>
<h4>Notes to Implementers</h4>
<p>
If the row pointed to by <i>bkOrigin</i> no longer exists in the table and you cannot establish a new position for the bookmark, return MAPI_E_INVALID_BOOKMARK. If the row pointed to by <i>bkOrigin</i> no longer exists and you can establish a new position for the bookmark, return MAPI_W_POSITION_CHANGED. </p>
<p>
A bookmark pointing to a row that is collapsed out of the table view can still be used. If the caller attempts to move the cursor to such a bookmark, move the cursor to the next visible row and return MAPI_W_POSITION_CHANGED. </p>
<p>
You can move bookmarks for positions collapsed out of view either at the time of use or at the time the row is collapsed. If a bookmark is moved at the time the row is collapsed, keep a bit in the bookmark that indicates whether the bookmark has moved since its last use or, if it has never been used, since its creation.</p>
<h4>Notes to Callers</h4>
<p>
To indicate a backward move for <b>SeekRow</b>, pass a negative value in <i>lRowCount</i>. To search to the beginning of the table, pass zero in <i>lRowCount</i> and the value BOOKMARK_BEGINNING in <i>bkOrigin</i>. </p>
<p>
If there are large numbers of rows in the table, the <b>SeekRow</b> operation can be slow. Performance can also be impacted if you require a row count to be returned in the contents of the <i>lplRowsSought</i> parameter.</p>
<p>
<b>SeekRow</b> returns the number of rows actually searched through, positive or negative, in the variable pointed to by <i>lplRowsSought</i>. In normal operation, it should return the same value for <i>lplRowsSought </i>as passed in for <i>lRowCount</i>, unless the search reached the beginning or end of the table. </p>
<p>
Do not set <i>lRowCount</i> to a number greater than 50. To seek through a larger number of rows, use the <a href="inter026_7kjc.htm"><b>IMAPITable::SeekRowApprox</b></a> method.</p>
<h4>See Also</h4>
<p>
<a href="inter026_0v3f.htm"><b>IMAPITable::CreateBookmark</b></a>, <a href="inter026_2lkn.htm"><b>IMAPITable::FindRow</b></a>, <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>, <a href="inter026_7kjc.htm"><b>IMAPITable::SeekRowApprox</b></a></p>
<p>&nbsp;</p></body>
</HTML>
