<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing Advanced Searching</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_implementing_advanced_searching"></a>Implementing Advanced Searching</h2>
<p>
Some address book containers support an advanced searching capability that allows clients to search on properties other than PR_DISPLAY_NAME. To support advanced searches, your provider must implement a special container that is accessible through the <a href="propb_7eso.htm">PR_SEARCH</a> property of your other containers. PR_SEARCH contains a container object that provides access to a display table that describes the dialog box used to enter and edit the advanced search criteria. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To support advanced searching</h5>
<ol>
<li>
Define a property for each of your search criteria.</li>
<li>
In the section of code in your container's <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method that handles the PR_SEARCH property:<ol type=a>
<li>
Check that the client is requesting the <b>IMAPIContainer</b> interface. If an inappropriate interface is being requested, fail and return MAPI_E_INTERFACE_NOT_SUPPORTED.</li>
<li>
Create a new search object that supports the <b>IMAPIContainer</b> interface. </li>
</ol>
</li>
<li>
At this point, a call will be made to your search container's <b>IMAPIProp::OpenProperty</b> method to retrieve its <a href="propa_692d.htm">PR_DETAILS_TABLE</a> property. Your provider must supply a display table, typically through a call to <a href="function_5wpx.htm"><b>BuildDisplayTable</b></a>, that describes the container's advanced search dialog box.</li>
<li>
MAPI displays the search dialog box, allowing the user to enter the appropriate criteria. When the user has finished, MAPI calls the container's <b>IMAPIProp::SetProps</b> method to store the search criteria. </li>
<li>
A call will be made to request your search container's contents table. Populate the contents table with all of the entries in the container that match the criteria.</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
