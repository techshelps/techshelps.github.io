<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Loading a Message Into a Form</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_loading_a_message_into_a_form"></a>Loading a Message Into a Form</h2>
<p>
To load an existing message into a form using a form server, use one of the following strategies.
<ul>
<li>
Call <a href="inter023_2vzh.htm"><b>IMAPISession::PrepareForm</b></a> to create a token and then <a href="inter023_2rql.htm"><b>IMAPISession::ShowForm</b></a> to display the form. </li>
<li>
Call <a href="inter019_8ju5.htm"><b>IMAPIFormMgr::LoadForm</b></a>. </li>
</ul>
<p>
Using the <b>PrepareForm</b> and <b>ShowForm</b> strategy is comparatively easy, but it results in forms that are modal with respect to your client. This is because the call to <b>ShowForm</b> does not return until the form has exited. If you need to handle forms asynchronously, do not use this strategy.  </p>
<p>
Using the <b>LoadForm</b> strategy is more difficult because the method requires several parameters. These parameters instruct the form manager to launch the proper form server in the proper context and display the proper message. If the form server is already running, the form manager loads the message into the form server without launching a new instance of the form server.</p>
<p>
To specify which form server to launch, pass the message class handled by the target server in the contents of the <i>lpszMessageClass</i> parameter. The appropriate message class can be determined by retrieving the <a href="propa_0ecz.htm">PR_MESSAGE_CLASS</a> property of the message to be loaded. Sometimes there is no form server for the specified message class, only a form server that handles messages belonging to the message's superclass. If you prefer that the message be loaded only by a form server specifically meant to handle messages of that class, set the MAPIFORM_EXACTMATCH flag in the <b>LoadForm</b> call. For more information, see <a href="extend_5gab.htm">Message Classes</a>.</p>
<p>
<b>LoadForm</b> also requires a pointer to your viewer's message site and view context and the value for the target message's <a href="propb_3c1f.htm">PR_MSG_STATUS</a> and <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> properties.</p>
<p>&nbsp;</p></body>
</HTML>
