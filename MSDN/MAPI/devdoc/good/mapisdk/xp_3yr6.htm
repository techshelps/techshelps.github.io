<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Initializing the Transport Provider</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_initializing_the_transport_provider"></a>Initializing the Transport Provider</h2>
<p>
The transport-spooler interface defines calls the MAPI spooler makes to a transport provider. Transport providers implement these routines in a DLL. The first direct entry point in the DLL used by the MAPI spooler must be the transport provider initialization function <a href="function_0wc4.htm"><b>XPProviderInit</b></a>.</p>
<p>
MAPI uses the operating system routine <b>GetProcAddress</b> to get the address of the provider's initialization routine and then calls that routine. The name of the initialization routine is <b>XPProviderInit</b> for transport providers. It is different for other types of MAPI service providers so that one DLL can contain any combination of provider types, but only one provider of a particular type. However, one provider of a given type can implement multiple services of its type. For example, one transport provider can implement message transport functionality to multiple message services.</p>
<p>
The MAPISPI.H header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it. By naming the initialization routines in your C and C++ files with the same names used by <b>GetProcAddress</b> and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine. See the sample transport provider source code for examples. For more information about this sample, see <a href="start_7tpu.htm">Sample Transport Provider</a>.</p>
<p>
If a provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the <b>Release</b> method of the provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION. This way MAPI and the provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then provider loading fails with a MAPI_E_VERSION return value. </p>
<p>
The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider. The MAPI spooler calls the <a href="inter043_2r72.htm"><b>IXPProvider::TransportLogon</b></a> method of the <a href="inter043_3zji.htm"><b>IXPProvider</b></a> object returned from <b>XPProviderInit</b>. This is the call where credentials, if used, are checked and dialog boxes can be allowed.</p>
<p>
If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object. The first provider object should be used to log on to the second transport session. A transport provider should be programmed to support multiple transport sessions in a single provider object. A second provider object should only be created if different MAPI sessions are used in the same process.</p>
<p>&nbsp;</p></body>
</HTML>
