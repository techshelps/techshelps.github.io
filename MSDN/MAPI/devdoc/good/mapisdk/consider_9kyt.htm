<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Profile with Custom Code</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_creating_a_profile_with_custom_code"></a>Creating a Profile with Custom Code</h3>
<p>
If you choose to write code to create a profile, make sure that you understand how to order profile entries and the type and amount of information that is needed for each entry. The implications of ordering entries in a profile is explained in <a href="extend_4fxv.htm">Profiles</a>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a profile with C or C++ code</h5>
<ol>
<li>
Read the header file for each message service. Understand what properties you will need to configure and what values you will use.</li>
<li>
Call the <a href="function_9jg3.htm"><b>MAPIAdminProfiles</b></a> function to retrieve an <b>IProfAdmin</b> interface pointer.</li>
<li>
Call <a href="inter035_49gl.htm"><b>IProfAdmin::CreateProfile</b></a> to create your profile. If you want to create a profile with the message services listed in the <b>[Default Services]</b> section of the MAPISVC.INF file, set the MAPI_DEFAULT_SERVICE flag. If you want to allow the user to enter configuration information, set the MAPI_DIALOG flag. Make sure that you set this flag if not all of the necessary information is available through the MAPISVC.INF file. <b>CreateProfile</b> calls the entry point function for each message service to be added to the profile with MSG_SERVICE_CREATE set as the <i>ulContext </i>parameter. </li>
<li>
Call <a href="inter035_1h6b.htm"><b>IProfAdmin::AdminServices</b></a> to obtain a message service administration object. </li>
<li>
Use the message service administration object to add message services to the profile. For each message service that you want to add:<ol type=a>
<li>
Call the <a href="inter030_60th.htm"><b>IMsgServiceAdmin::CreateMsgService</b></a> method to create the new message service.</li>
<li>
Call <a href="inter030_4cv9.htm"><b>IMsgServiceAdmin::ConfigureMsgService</b></a>, passing the <b>MAPIUID</b> structure of the service you just created and a property value array with its configuration properties.</li>
</ol>
</li>
<li>
To retrieve the identifier of a newly added service, its <a href="propb_357o.htm">PR_SERVICE_UID</a> property, call <a href="inter030_4did.htm"><b>IMsgServiceAdmin::GetMsgServiceTable</b></a> to access the message service table and search for the row that represents the message service. The last row in the table will represent the most recently added message service. </li>
</ol>
<p>
</p>
<p>
To make a new profile temporary, call the <a href="inter035_3eqt.htm"><b>IProfAdmin::DeleteProfile</b></a> method immediately after you log on. <b>DeleteProfile</b> will mark the new profile as deleted while making it usable for the duration of the session. Because it will not be included in the session's profile table, other clients will be unable to use it. </p>
<p>&nbsp;</p></body>
</HTML>
