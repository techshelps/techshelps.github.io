<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tips for Better Table Performance</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_tips_for_better_table_performance"></a>Tips for Better Table Performance</h2>
<p>
Because many of the table operations can be time-consuming and there is no way to indicate progress, it is helpful to use the following techniques for improving performance:
<ul>
<li>
Make <a href="inter026_44ry.htm"><b>IMAPITable</b></a> calls in the correct order.<p>
Clients and service providers can work with tables in a variety of ways. They can open the table and retrieve the data for all of the rows using the default column set and sort order. Alternatively, they can modify this default view of the table by changing the column set, changing the sort order, or establishing a restriction to narrow the table's scope. Table users that intend to perform one or more of these operations before retrieving any data should perform them in the following order:
<ol>
<li>
Define a column set with<a href="inter026_7x83.htm"> <b>IMAPITable::SetColumns</b></a>.</li>
<li>
Establish a restriction with <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a>.</li>
<li>
Define a sort order with <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a>.</li>
</ol>
<p>
Performing these tasks in this order limits the number of rows and columns that will be sorted, thereby improving performance. 
</li>
<li>
Delay an operation using the TBL_BATCH flag if possible.<p>
Setting the TBL_BATCH flag on a method allows the table implementer to collect several calls before acting on any one of them. Rather than make potentially many calls to a remote server, a table implementer can make one, performing all the operations at one time. The results of the operations are not evaluated until they are needed. For example, when a client calls <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a> to specify a restriction with the TBL_BATCH flag set, the restriction need not go into effect until the client calls <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> to retrieve the data. This allows the table implementer to combine the work of two calls into one. 
<p>
Table users that take advantage of the TBL_BATCH flag should be aware that error handling under these conditions can be more complex. Because handling the errors from a delayed operation is similar to handling the errors when the MAPI_DEFERRED_ERRORS flag is set, see <a href="extend_0nhv.htm">Deferring Errors</a> for more information.
</li>
<li>
Keep a cache of commonly used properties.<p>
Service providers implementing tables can lessen the time it takes to create a view by caching copies of commonly used object properties. Keeping a copy of these properties in memory saves having to retrieve them from the object each time the view must be rebuilt. 
<p>

</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
