<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PR_ATTACH_METHOD</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_pr_attach_method"></a>PR_ATTACH_METHOD</h2>
<p>
The PR_ATTACH_METHOD property contains a MAPI-defined constant representing the way the contents of an attachment can be accessed. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file: </td>
<td width=57%>MAPITAGS.H </td>
</tr>
<tr valign=top>
<td width=43%>Must be exposed by: </td>
<td width=57%>Attachment subobjects </td>
</tr>
<tr valign=top>
<td width=43%>Identifier: </td>
<td width=57%>0x3705 </td>
</tr>
<tr valign=top>
<td width=43%>Property type: </td>
<td width=57%>PT_LONG </td>
</tr>
<tr valign=top>
<td width=43%>Property tag: </td>
<td width=57%>0x37050003 </td>
</tr>
</table><br>
<h4>Remarks </h4>
<p>
The PR_ATTACH_METHOD property can have exactly one of the following values: 
<dl>
<dt>
NO_ATTACHMENT </dt>
<dd>
The attachment has just been created. </dd>
<dt>
ATTACH_BY_VALUE </dt>
<dd>
The <a href="propa_6eni.htm">PR_ATTACH_DATA_BIN</a> property contains the attachment data. </dd>
<dt>
ATTACH_BY_REFERENCE </dt>
<dd>
The <a href="propa_0011.htm">PR_ATTACH_PATHNAME</a> or <a href="propa_23dx.htm">PR_ATTACH_LONG_PATHNAME</a> property contains a fully qualified path identifying the attachment to recipients with access to a common file server. </dd>
<dt>
ATTACH_BY_REF_RESOLVE </dt>
<dd>
The <a href="propa_0011.htm">PR_ATTACH_PATHNAME</a> or <a href="propa_23dx.htm">PR_ATTACH_LONG_PATHNAME</a> property contains a fully qualified path identifying the attachment. </dd>
<dt>
ATTACH_BY_REF_ONLY </dt>
<dd>
The PR_ATTACH_PATHNAME or PR_ATTACH_LONG_PATHNAME property contains a fully qualified path identifying the attachment. </dd>
<dt>
ATTACH_EMBEDDED_MSG </dt>
<dd>
The <a href="propa_7je2.htm">PR_ATTACH_DATA_OBJ</a> property contains an embedded object that supports the <b>IMessage</b> interface. </dd>
<dt>
ATTACH_OLE </dt>
<dd>
The attachment is an embedded OLE object. 
</dd>
</dl>
<p>
When created, all attachment objects have an initial PR_ATTACH_METHOD value of NO_ATTACHMENT. </p>
<p>
Client applications and service providers are only required to support the attachment method represented by the ATTACH_BY_VALUE value. The other attachment methods are optional. The message store does not enforce any consistency between the value of PR_ATTACH_METHOD and the values of the other attachment properties. </p>
<p>
Universal naming convention (UNC) names are recommended for fully qualified paths, which should be used with ATTACH_BY_REFERENCE and ATTACH_BY_REF_ONLY. With ATTACH_BY_REF_RESOLVE, an absolute path is faster, because the MAPI spooler converts the attachment to ATTACH_BY_VALUE. </p>
<p>
If ATTACH_BY_REFERENCE is set, PR_ATTACH_DATA_BIN must be empty. An outbound gateway can turn an ATTACH_BY_REFERENCE attachment into an ATTACH_BY_VALUE attachment by copying the attachment data into the PR_ATTACH_DATA_BIN property. </p>
<p>
If ATTACH_BY_REF_RESOLVE is set, PR_ATTACH_DATA_BIN must be empty. When the message that contains the ATTACH_BY_REF_RESOLVE attachment is sent, the MAPI spooler copies the attachment data into an ATTACH_BY_VALUE attachment. This resolution process places the attachment data in <a href="propa_6eni.htm">PR_ATTACH_DATA_BIN</a>. </p>
<p>
If ATTACH_BY_REF_ONLY is set, PR_ATTACH_DATA_BIN must be empty, and the messaging system never resolves the attachment reference. Use this value when you want to send the link but not the data. </p>
<p>
When the OLE object is in OLE 2.0 <b>IStorage</b> format, the data are accessible through PR_ATTACH_DATA_OBJ. When the OLE object is in OLE 1.0 <b>OLESTREAM</b> format, the data are accessible through <a href="propa_6eni.htm">PR_ATTACH_DATA_BIN</a> as an <b>IStream</b>. The type of the OLE encoding can be determined by the <a href="propa_173b.htm">PR_ATTACH_TAG</a> value. </p>
<p>
For more information on OLE interfaces and formats, see the <i>OLE Programmer's Reference</i>. </p>
<h4>See Also </h4>
<p>
<a href="groups_6reb.htm">Attachment Properties</a>, <a href="propb_01t7.htm">PR_STORE_SUPPORT_MASK</a> </p>
<p>&nbsp;</p></body>
</HTML>
