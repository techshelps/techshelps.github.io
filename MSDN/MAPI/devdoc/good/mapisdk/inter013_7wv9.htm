<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFolder::CreateMessage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapifolder_createmessage"></a>IMAPIFolder::CreateMessage</h2>
<p>
The <b>IMAPIFolder::CreateMessage</b> method creates a new message.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT CreateMessage(
  LPCIID</b><i> lpInterface</i><b>,</b>         
<b>  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMESSAGE FAR *</b><i> lppMessage  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpInterface</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) representing the interface to be used to access the new message. Valid interface identifiers include IID_IUnknown, IID_IMAPIProp, IID_IMAPIContainer, and IID_IMAPIFolder. Passing NULL results in the message store provider returning the standard message interface, <a href="inter029_525s.htm"><b>IMessage</b></a>. </dd>
<dt>
</dt>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the message is created. The following flags can be set:
<dl>
<dt>
MAPI_ASSOCIATED</dt>
<dd>
The message to be created should be included in the associated contents table rather than the standard contents table. Associated messages typically contain invisible data, such as view descriptors.</dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
<b>CreateMessage</b> is allowed to succeed even if the create operation has not fully completed. This implies that the new message might not be immediately accessible to the caller.</dd>
</dl>
</dd>
<dt>
<i>lppMessage</i></dt>
<dd>
[out] Pointer to a pointer to the newly created message.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The message was successfully created.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIFolder::CreateMessage</b> method creates a new message with generic or associated content and assigns an entry identifier. The entry identifier is made up of a part that represents the message store provider and a part that represents the individual message. </p>
<h4>Notes to Implementers</h4>
<p>
You can choose whether to set all of the required message properties in <b>CreateMessage</b> or in the message's <b>IMAPIProp::SaveChanges</b> method. You do not need to make these properties available until a successful save has occurred.</p>
<p>
For more information on working with associated information, see <a href="storearc_8n1v.htm">Folder Associated Information Tables</a> and <a href="tables_9i9f.htm">Contents Tables</a>. </p>
<h4>Notes to Callers</h4>
<p>
Some message store providers allow the entry identifier of the new message to be available immediately after <b>CreateMessage</b> returns; others delay its availability until the message has been saved. Because not all message store providers generate an entry identifier for a new message until you have called the message's <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method, you may not be able to access the entry identifier when <b>CreateMessage</b> returns. Also, the new message may not be included in the folder's contents table until the save occurs.</p>
<p>
Expect the entry identifier assigned to the new message to be unique not only within the current message store, but most likely across all of the message stores that are open concurrently. One exception to this general rule occurs when multiple entries for a message store appear in the profile, causing the message store to be opened multiple times and entry identifiers to be duplicated. </p>
<p>
To create an outgoing message, call the Outbox folder's <b>IMAPIFolder::CreateMessage</b> method. </p>
<p>
If you delete a folder containing a new message before the message is saved, the results are undefined.</p>
<h4>See Also</h4>
<p>
<a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
