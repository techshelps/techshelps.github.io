<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistMessage::SaveCompleted</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_ipersistmessage_savecompleted"></a>IPersistMessage::SaveCompleted</h2>
<p>
The <b>IPersistMessage::SaveCompleted</b> method notifies the form that a save operation has been completed. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter034_24ry.htm"><b>IPersistMessage : IUnknown</b></a>.</p>
<pre><code><b>HRESULT SaveCompleted(
  LPMESSAGE</b><i> pMessage  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pMessage</i></dt>
<dd>
[in] Pointer to the newly saved message.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The notification was successful.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
The <i>pMessage</i> parameter is NULL and the form is either in the Hands Off From Normal or Hands Off After Save state.</dd>
<dt>
E_UNEXPECTED</dt>
<dd>
The form is not in one of the following states:
<ul>
<li>
<a href="glossary_4s2w.htm#_mapi1book_gly_hands_off_state">Hands Off From Normal</a> </li>
<li>
<a href="glossary_4s2w.htm#_mapi1book_gly_hands_off_state">Hands Off After Save</a> </li>
<li>
<a href="glossary_4s32.htm#_mapi1book_gly_no_scribble_state">No Scribble</a> </li>
</ul>
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IPersistMessage::SaveCompleted</b> method is called by a form viewer to notify the form that all pending changes have been saved. <b>SaveCompleted</b> should only be called when the form is in one of the following states:
<ul>
<li>
Hands Off From Normal</li>
<li>
Hands Off After Save</li>
<li>
No Scribble</li>
</ul>
<h4>Notes to Implementers</h4>
<p>
There are several possible actions that the <b>SaveCompleted</b> method can perform, depending on what the message pointer parameter contains, and what state the message is in. However, when an action is successful, always save the current state of the message pointed to by the <i>pMessage</i> parameter and transition the form to its <a href="glossary_4s32.htm#_mapi1book_gly_normal_state">Normal state</a>. </p>
<p>
The following table describes the variables that affect the actions you should take in your implementation of <b>SaveCompleted</b>:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Condition</th>
<th align=left width=54%>Action</th>
</tr>
<tr valign=top>
<td width=46%>The <i>pMessage</i> parameter is NULL and the <i>fSameAsLoad</i> parameter to <b>Save</b> was set to TRUE.</td>
<td width=54%>Call the <a href="inter027_46ck.htm"><b>IMAPIViewAdviseSink::OnSaved</b></a> method of all registered viewers, mark the form as clean, and return S_OK.</td>
</tr>
<tr valign=top>
<td width=46%>The <i>pMessage</i> parameter is NULL and the <i>fSameAsLoad</i> parameter to <b>Save</b> was set to FALSE.</td>
<td width=54%>Return S_OK.</td>
</tr>
<tr valign=top>
<td width=46%>The form is in the Hands Off From Normal state.</td>
<td width=54%>Release the current message and replace it with the message pointed to by <i>pMessage</i>. Call the replacement message's <b>IUnknown::AddRef </b>method and return S_OK.</td>
</tr>
<tr valign=top>
<td width=46%>The form is in the Hands Off After Save state.</td>
<td width=54%>Call the <b>IMAPIViewAdviseSink::OnSaved</b> method of all registered viewers, mark the form as clean, and return S_OK.</td>
</tr>
<tr valign=top>
<td width=46%>The form is in the No Scribble state.</td>
<td width=54%>Release the current message and replace it with the message pointed to by <i>pMessage</i>. Call the replacement message's <b>IUnknown::AddRef </b>method. Call the <b>IMAPIViewAdviseSink::OnSaved</b> method of all registered viewers, mark the form as clean, and return S_OK.</td>
</tr>
<tr valign=top>
<td width=46%>The form is in one of the Hands Off states and the <i>pMessage</i> parameter is set to NULL.</td>
<td width=54%>Return E_INVALIDARG.</td>
</tr>
<tr valign=top>
<td width=46%>The form is in a state other than one of the Hands Off states or the No Scribble state.</td>
<td width=54%>Return E_UNEXPECTED.</td>
</tr>
</table><br>
<p>
For more information on saving storage objects, see the documentation for one of the following methods in the <i>OLE Programmer's Reference</i>:</p>
<p class=indent1>
<b>IPersistFile::SaveCompleted</b></p>
<p class=indent1>
<b>IPersistStorage::SaveCompleted</b></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
