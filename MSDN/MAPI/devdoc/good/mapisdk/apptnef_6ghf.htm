<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TNEF Correlation in X.400 Gateways and Transports</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_tnef_correlation_in_x.400_gateways_and_transports"></a>TNEF Correlation in X.400 Gateways and Transports</h2>
<p>
Gateways and transports that connect to X.400-based systems, use the value of the IM_THIS_IPM X.400 attribute and the <b>attMessageID</b> TNEF attribute to implement TNEF correlation.</p>
<p>
The value of the IM_THIS_IPM attribute of the outbound message is copied to <b>attMessageID</b> in the TNEF stream. The IM_THIS_IPM X.400 attribute is typically a string, while the <b>attMessageID</b> TNEF attribute is a string of hexadecimal digits representing a binary value. Therefore, each character in the IM_THIS_IPM X.400 attribute, including the terminating null character, must be converted to a 2-character hexadecimal string representing the ASCII value of that character. For instance, if the IM_THIS_IPM X.400 attribute is the following string:</p>
<p>
3030322D3030312D305337533A3A3936303631312D313533373030</p>
<p>
then the value of <b>attMessageID</b> would be the following sequence of hexadecimal digits:</p>
<p>
33 30 33 30 33 32 32 44</p>
<p>
33 30 33 30 33 31 32 44</p>
<p>
33 30 35 33 33 37 35 33</p>
<p>
33 41 33 41 33 39 33 36</p>
<p>
33 30 33 36 33 31 33 31</p>
<p>
32 44 33 31 33 35 33 33</p>
<p>
33 37 33 30 33 30 00</p>
<p>
This technique is used by the Microsoft Exchange Server X.400 Connector. This technique should be used by any X.400 gateways and transports that connect to Microsoft Exchange Server in order to maximize interoperability.</p>
<p>
For greatest compatibility with future as well as present Microsoft software, the IM_THIS_IPM X.400 attribute should also be copied to the PR_TNEF_CORRELATION_KEY property. However, since PR_TNEF_CORRELATION_KEY is a binary property, no translation into a hexadecimal string is necessary.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
