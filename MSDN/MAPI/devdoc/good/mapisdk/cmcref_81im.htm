<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>cmc_act_on</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_cmc_act_on"></a>cmc_act_on</h2>
<p>
The <b>cmc_act_on</b> function performs the specified operation on a message. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>XCMC.H</td>
</tr>
</table><br>
<pre><code><b>CMC_return_code cmc_act_on (
  CMC_session_id</b><i> session</i><b>,</b>                      
<b>  CMC_message_reference *</b><i> message_reference</i><b>,</b>   
<b>  CMC_enum</b><i> operation</i><b>,</b>                          
<b>  CMC_flags</b><i> act_on_flags</i><b>,</b>                      
<b>  CMC_ui_id</b><i> ui_id</i><b>,</b>                             
<b>  CMC_extension FAR *</b><i> act_on_extensions        </i>
<b>)</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>session</i> </dt>
<dd>
[in] Session handle that represents a MAPI session. The value in the <i>session</i> parameter must be a valid session handle, not zero. </dd>
<dt>
<i>message_reference </i></dt>
<dd>
[in] Pointer to a message reference that identifies the message to be acted upon. A null pointer or a pointer to a message reference of length zero is invalid for any operation requiring a message reference. If the message reference is invalid, the <b>cmc_act_on </b>function returns CMC_E_INVALID_MESSAGE_REFERENCE. </dd>
<dt>
<i>operation </i></dt>
<dd>
[in] An enumeration variable that identifies the operation to perform on the message. Possible values are: 
<dl>
<dt>
CMC_ACT_ON_DELETE</dt>
<dd>
Marks the specified message for deletion from the mailbox. This operation requires a valid <i>message_reference</i> parameter.</dd>
<dt>
CMC_ACT_ON_EXTENDED</dt>
<dd>
The operation to be performed is specified in the <i>act_on_extensions</i> parameter.</dd>
</dl>
</dd>
<dt>
<i>act_on_flags </i></dt>
<dd>
[in] Bitmask of option flags. The following flag can be set: 
<dl>
<dt>
CMC_ERROR_UI_ALLOWED</dt>
<dd>
Displays a dialog box on encountering recoverable errors. If this flag is not set, <b>cmc_act_on</b> does not display a dialog box and returns an error value instead.</dd>
</dl>
</dd>
<dt>
<i>ui_id </i></dt>
<dd>
[in] A handle that <b>cmc_act_on</b> uses to present a dialog box for resolving processing questions. </dd>
<dt>
<i>act_on_extensions </i></dt>
<dd>
[in, out] Pointer to an array of <a href="cmcref_1woe.htm"><b>CMC_extension</b></a> structures containing function extensions. On input, this array contains MAPI extensions to the standard <b>cmc_act_on</b> function. A value of NULL for the <i>act_on_extensions </i>parameter indicates the caller has no extensions for <b>cmc_act_on</b> and is expecting no extensions. You can use the <a href="cmcref_1z8l.htm">CMC_X_COM_SAVE_MESSAGE</a> extension to save a message to the receive folder.
<p>
On output, <b>cmc_act_on</b> writes to the array new information about its processing. It writes NULL if it generates no output extensions. 

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
CMC_E_FAILURE</dt>
<dd>
There was a general failure that does not fit the description of any other return value.</dd>
<dt>
CMC_E_INSUFFICIENT_MEMORY</dt>
<dd>
Insufficient memory was available to complete the requested operation.</dd>
<dt>
CMC_E_INVALID_ENUM</dt>
<dd>
A <b>CMC_enum</b> value was invalid.</dd>
<dt>
CMC_E_INVALID_FLAG</dt>
<dd>
A flag set using a flags parameter was invalid.</dd>
<dt>
CMC_E_INVALID_MESSAGE_REFERENCE</dt>
<dd>
The specified message reference is invalid or no longer valid (for example, it has been deleted).</dd>
<dt>
CMC_E_INVALID_PARAMETER</dt>
<dd>
A function parameter was invalid. </dd>
<dt>
CMC_E_INVALID_SESSION_ID</dt>
<dd>
The specified session handle is invalid or no longer valid — for example, after logging off.</dd>
<dt>
CMC_E_INVALID_UI_ID</dt>
<dd>
The specified user interface identifier is invalid or no longer valid.</dd>
<dt>
CMC_E_MESSAGE_IN_USE</dt>
<dd>
The requested action could not be completed because the message was in use.</dd>
<dt>
CMC_E_UNSUPPORTED_ACTION</dt>
<dd>
The requested action is not supported by the current implementation.</dd>
<dt>
CMC_E_UNSUPPORTED_FLAG</dt>
<dd>
The flag requested is not supported.</dd>
<dt>
CMC_E_UNSUPPORTED_FUNCTION_EXT</dt>
<dd>
The function extension requested is not supported.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="cmcref_1woe.htm"><b>CMC_extension</b></a>, <a href="cmcref_1z8l.htm">CMC_X_COM_SAVE_MESSAGE</a> </p>
<p>&nbsp;</p></body>
</HTML>
