<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing the IUnknown Interface</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_implementing_the_iunknown_interface"></a>Implementing the IUnknown Interface</h2>
<p>
The methods of the <b>IUnknown</b> interface, implemented in every MAPI object, support interobject communication and object management. <b>IUnknown</b> has three methods: <b>QueryInterface</b>, <b>AddRef</b>, and <b>Release</b>. <b>QueryInterface</b> enables one object to determine if another object supports a particular interface. With <b>QueryInterface</b>, two objects with no prior knowledge of each other's functionality can interact. If the object implementing <b>QueryInterface</b> does support the interface in question, it returns a pointer to the implementation of the interface. If the object does not support the requested interface, it returns the MAPI_E_INTERFACE_NOT_SUPPORTED value.</p>
<p>
When <b>QueryInterface</b> returns a requested interface pointer, it must also increase what is known as the new object's reference count. An object's reference count is a numeric value used to manage the object's lifespan. When the reference count is greater than one, the object's memory cannot be freed because it is actively being used. It is only when the reference count drops to zero that the object can be released safely. </p>
<p>
The other two <b>IUnknown</b> methods, <b>AddRef</b> and <b>Release</b>, manage the reference count. <b>AddRef</b> increments the reference count while <b>Release</b> decrements it. All methods or API functions that return interface pointers, such as <b>QueryInterface</b>, must call <b>AddRef</b> to increment the reference count. All implementations of methods that receive interface pointers must call <b>Release</b> to decrement the count when the pointer is no longer needed. <b>Release</b> checks for an existing reference count, freeing the memory associated with the interface only if the count is 0. </p>
<p>
<b>Note</b>  Because <b>AddRef</b> and <b>Release</b> are not required to return accurate values, callers of these methods must not use the return values to determine if an object is still valid or has been destroyed. </p>
<p>&nbsp;</p></body>
</HTML>
