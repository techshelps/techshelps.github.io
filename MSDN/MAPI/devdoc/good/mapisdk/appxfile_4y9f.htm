<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPISVC.INF Service Provider Sections</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_mapisvc.inf_service_provider_sections"></a>MAPISVC.INF Service Provider Sections</h2>
<p>
MAPISVC.INF includes one service provider section for each of the entries listed in the <b>Providers</b> entry in the preceding message services section. <b>Service</b> provider sections are similar to message service sections in that both types of sections contain entries in this format: </p>
<p>
<b>property tag </b>= property value</p>
<p>
However, service provider sections and message service sections differ in that such property entries are the only type of entry included in service provider sections. There can be no additional or linked sections for service providers; all service provider information must be contained within the one section. </p>
<p>
Some of the properties set in message service sections are also set in service provider sections because these properties make sense for both. The PR_DISPLAY_NAME property is an example. Both service providers and message services have a name that is used for display in the configuration user interface. Depending on the service provider, that name may or may not be the same. Other properties are specific to service providers. </p>
<p>
Typical service provider sections include the following entries, all of which are required:</p>
<p>
<b>PR_DISPLAY_NAME</b> = <i>string<br>
</i><b>PR_PROVIDER_DISPLAY</b> = <i>string<br>
</i><b>PR_PROVIDER_DLL_NAME</b> = <i>name of DLL file<br>
</i><b>PR_RESOURCE_TYPE</b> = <i>long<br>
</i><b>PR_RESOURCE_FLAGS</b> = <i>bitmask</i></p>
<p>
The <a href="propb_5yud.htm">PR_PROVIDER_DLL_NAME</a> entry is similar to PR_SERVICE_DLL_NAME; it indicates the filename for the DLL that contains the service provider. Message service code may be stored with one of its service providers in the same DLL file or exist as a separate DLL. Note that no suffix is included in the entry regardless of the target platform; MAPI takes care of adding a suffix if necessary. </p>
<p>
<a href="propb_0oh1.htm">PR_RESOURCE_TYPE</a> entry represents the type of service provider; service providers set it to the appropriate predefined constant. Valid values include MAPI_STORE_PROVIDER, MAPI_TRANSPORT_PROVIDER, and MAPI_AB_PROVIDER.</p>
<p>
Another property entry that applies to both message services and service providers, the <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> entry indicates options. The settings for this property entry can differ depending on the service provider. For example, some message store providers might set PR_RESOURCE_FLAGS to STATUS_NO_DEFAULT_STORE if they can never operate as the default message store.</p>
<p>
Three examples of service provider sections follow. The <b>[AB Provider]</b> section is the service provider section for the Default Address Book service. The <b>[MsgService Prov1]</b> and <b>[MsgService Prov2]</b> sections belong to My Own Service; the first is an address-book provider section and the second is a message-store provider section. </p>
<pre><code>[AB Provider] 
PR_DISPLAY_NAME=Default Address Book 
PR_PROVIDER_DISPLAY=Default Address Book 
PR_PROVIDER_DLL_NAME=AB.DLL 
PR_RESOURCE_TYPE=MAPI_AB_PROVIDER 
6600001e=C:\WINNT35\System32\DEFAB.TXT 
 
[MsgService Prov1] 
PR_DISPLAY_NAME=My Own Service 
PR_PROVIDER_DISPLAY=My Own Address Book 
PR_PROVIDER_DLL_NAME=MYXXX.DLL 
PR_RESOURCE_TYPE=MAPI_AB_PROVIDER 
 
[MsgService Prov2] 
PR_DISPLAY_NAME=My Folders 
PR_PROVIDER_DISPLAY=My Own Message Store 
PR_RESOURCE_TYPE=MAPI_STORE_PROVIDER 
PR_PROVIDER_DLL_NAME=MYZZZ.DLL 
PR_RESOURCE_FLAGS=STATUS_NO_DEFAULT_STORE 
66060003=00000000 
66030003=00000000 
34140102=78b2fa70aff711cd9bc800aa002fc45a 
66090003=06000000 
660A0003=03000000 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
