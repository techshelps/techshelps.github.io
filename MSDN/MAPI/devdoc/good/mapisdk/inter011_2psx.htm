<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIContainer::SetSearchCriteria</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapicontainer_setsearchcriteria"></a>IMAPIContainer::SetSearchCriteria</h2>
<p>
The <b>IMAPIContainer::SetSearchCriteria</b> method establishes search criteria for the container.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter011_7u0g.htm"><b>IMAPIContainer : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT SetSearchCriteria(
  LPSRestriction</b><i> lpRestriction</i><b>,</b>   
<b>  LPENTRYLIST</b><i> lpContainerList</i><b>,</b>   
<b>  ULONG</b><i> ulSearchFlags            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpRestriction</i></dt>
<dd>
[in] Pointer to an <a href="structyp_45ny.htm"><b>SRestriction</b></a> structure defining the search criteria. If NULL is passed in the <i>lpRestriction</i> parameter, then the search criteria used most recently for this container are used again. NULL should not be passed in <i>lpRestriction</i> for the container's first search.</dd>
<dt>
<i>lpContainerList</i></dt>
<dd>
[in] Pointer to an array of entry identifiers representing containers to be included in the search. If a client passes NULL in the <i>lpContainerList </i>parameter, then the entry identifiers used most recently to search this container are used for the new search. A client should not pass NULL in <i>lpContainerList</i> for the first search within a container.</dd>
<dt>
<i>ulSearchFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the search is performed. The following flags can be set:
<dl>
<dt>
BACKGROUND_SEARCH</dt>
<dd>
The search should run at normal priority relative to other searches. This flag cannot be set at the same time as the FOREGROUND_SEARCH flag.</dd>
<dt>
FOREGROUND_SEARCH</dt>
<dd>
The search should run at high priority relative to other searches. This flag cannot be set at the same time as the BACKGROUND_SEARCH flag.</dd>
<dt>
RECURSIVE_SEARCH</dt>
<dd>
The search should include the containers specified in the <i>lpContainerList</i> parameter and all of their child containers. This flag cannot be set at the same time as the SHALLOW_SEARCH flag.</dd>
<dt>
RESTART_SEARCH</dt>
<dd>
The search should be initiated, if this is the first call to <b>SetSearchCriteria</b>, or restarted, if the search is inactive. This flag cannot be set at the same time as the STOP_SEARCH flag.</dd>
<dt>
SHALLOW_SEARCH</dt>
<dd>
The search should only look in the containers specified in the <i>lpContainerList</i> parameter for matching entries. This flag cannot be set at the same time as the RECURSIVE_SEARCH flag.</dd>
<dt>
STOP_SEARCH</dt>
<dd>
The search should be aborted. This flag cannot be set at the same time as the RESTART_SEARCH flag.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The search criteria was successfully set.</dd>
<dt>
MAPI_E_TOO_COMPLEX</dt>
<dd>
The service provider does not support the search criteria specified. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIContainer::SetSearchCriteria</b> method establishes search criteria for a container that supports searches, typically a search-results folder. A search-results folder contains links to the messages that meet the search criteria; the actual messages are still stored in their original locations. The only unique data contained in a search-results folder is its contents table. The contents table of a search-results folder has the merged contents of the message store after the search restriction has been applied. </p>
<p>
A search operation only works on this merged contents table; it does not search through other search-results folders. The search results only return the messages that match the search criteria; the folder hierarchy is not returned.</p>
<p>
Control is returned to the client when the search has finished.</p>
<h4>Notes to Implementers</h4>
<p>
Address book containers establish search critieria by applying restrictions to their contents tables. For more information about search criteria and address book containers, see <a href="ab_5qzr.htm">Implementing Advanced Searching</a>.</p>
<p>
You should support open, copy, move, and delete operations on the messages within search-results folders, not on the search-results folder itself. Do not allow messages to be created within or copied into a search-results folder. </p>
<h4>Notes to Callers</h4>
<p>
To search for message recipients, set <i>lpRestriction</i> to point to a subobject restriction with the <b>ulSubObject</b> member in the <a href="structyp_3lim.htm"><b>SSubRestriction</b></a> structure set to <a href="propa_1zw3.htm">PR_MESSAGE_RECIPIENTS</a>. To search for attachments, set the <b>ulSubObject</b> member to <a href="propa_2c1f.htm">PR_MESSAGE_ATTACHMENTS</a>. Set the <b>lpRes</b> member to point to a property restriction describing the search criteria for the recipients or attachments.</p>
<p>
For example, to look for file attachments with the extension .MSS, set <b>ulSubObject</b> to PR_MESSAGE_ATTACHMENTS and <b>lpRes</b> to a property restriction that matches PR_ATTACH_EXTENSION with MSS. </p>
<p>
Setting the FOREGROUND_SEARCH flag in the <i>ulSearchFlags</i> parameter might cause a performance degradation. </p>
<p>
You can use <b>SetSearchCriteria</b> to change the search criteria of a search already in progress. You can specify new restrictions, new lists of folders to search, and a new search priority, such as upgrading a search to a higher priority. Changes in search priority do not cause an existing search to restart, but other changes to search criteria can.</p>
<p>
When you are through using a search-results folder, you can either delete the folder or let it remain open for later use. If you do delete the search-results folder, only message links are deleted. The actual messages remain in their parent folders. </p>
<p>
For more information on search-results folders, see <a href="extend_6b8z.htm">Search-Results Folders</a>. </p>
<h4>See Also</h4>
<p>
<a href="inter011_0sx1.htm"><b>IMAPIContainer::GetContentsTable</b></a>, <a href="inter011_02yh.htm"><b>IMAPIContainer::OpenEntry</b></a>, <a href="inter013_9tpu.htm"><b>IMAPIFolder::CreateFolder</b></a>, <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a>, <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a>, <a href="structyp_45ny.htm"><b>SRestriction</b></a>, <a href="structyp_3lim.htm"><b>SSubRestriction</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
