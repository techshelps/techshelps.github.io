<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>One-Off Addresses</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_one_off_addresses"></a>One-Off Addresses</h2>
<p>
<a href="glossary_4s33.htm#_mapi1book_gly_one_off_address">One-off addresses</a> are used to send messages to one-off recipients, recipients that do not have a corresponding entry in any of the session's address book containers. Clients can create one-off addresses when they add new entries to the address book or new recipients to the recipient list of an outgoing message. One-off addresses can be added to any container that is modifiable.</p>
<p>
To create a one-off address, clients use a special template containing edit controls for entering all of the information that makes up a one-off address. One-off addresses, like addresses of other types, use a predefined format. The one-off address format is defined by MAPI as follows:</p>
<pre><code>Display name[Address type:E-mail address]
 </code></pre>
<p>
There are six components to this format and some rules about quoting characters. The components are described in the following table.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=20%>Component</th>
<th align=left width=18%>Usage</th>
<th align=left width=62%>Description</th>
</tr>
<tr valign=top>
<td width=20%>Display name</td>
<td class=indent1 width=18%>Optional</td>
<td width=62%>If not present, <b>IAddrBook::ResolveName</b> uses the visible part of the e-mail address as the display name. May include blanks.</td>
</tr>
<tr valign=top>
<td width=20%>[</td>
<td class=indent1 width=18%>Required</td>
<td width=62%>Delineates the start of the type and address information.</td>
</tr>
<tr valign=top>
<td width=20%>]</td>
<td class=indent1 width=18%>Required</td>
<td width=62%>Delineates the end of the type and address information. If anything other than white space follows this character, the entry is not treated as a custom recipient.</td>
</tr>
<tr valign=top>
<td width=20%>Address type</td>
<td class=indent1 width=18%>Required</td>
<td width=62%>Type of address; maps to a specific address format. See the appendix, <a href="addrtyps_0mur.htm">Address Types</a>.</td>
</tr>
<tr valign=top>
<td width=20%>:</td>
<td class=indent1 width=18%>Required</td>
<td width=62%>Separates the address type from the e-mail address.</td>
</tr>
<tr valign=top>
<td width=20%>E-mail address</td>
<td class=indent1 width=18%>Required</td>
<td width=62%>Address of the recipient. May include blanks.</td>
</tr>
</table><br>
<p>
MAPI uses particular sets of quoting characters to allow addresses to contain special characters such as comma (,), left bracket ([), and colon (:) and some untypeable characters such as the carriage return or line feed or any other hexadecimal equivalent. The quoting character is the backslash (\). Therefore, if clients or providers must insert a backslash in an address, they must preceed it with the quoting character ("\\").</p>
<p>
Clients and service providers can use this quoting technique in any of the nonfixed, typeable fields. For example, the following entry translates to Bill Lee as the display name, MSPEER as the address type, and \\billll\in as the e-mail address:</p>
<pre><code>Bill Lee[MSPEER:\\\\billl\in]
 </code></pre>
<p>
To insert special nontypeable characters, clients and service providers use a quoting character followed by an x and two hexadecimal digits to represent their hexadecimal equivalent. For example, if an address has a nontypeable character that equates to a carriage return, (\0d) in hexadecimal, a client would enter them as:</p>
<pre><code>Fax Recipient[fax:recipient\x0dbuilding\x0doffice\x0d555-1212\x0d]
 </code></pre>
<p>
<a href="inter006_64v9.htm"><b>IAddrBook::ResolveName</b></a> also automatically parses most SMTP addresses, looking for addresses with the following format:</p>
<pre><code>XXX@YYY.ZZZ 
 </code></pre>
<p>
Although not all of the possible RFC822 formats are handled, this automatic parsing is adequate for most users. <b>ResolveName</b> includes this functionality to allow users to enter SMTP addresses directly into a message and have that message go to the Internet user. The XXX, YYY, and ZZZ components of the address can be one or more characters. The at sign (@) cannot be included in either the XXX, YYY, or ZZZ address components and the YYY component also cannot include the period. Because the following characters are special characters in SMTP addresses, MAPI automatically converts a display name containing these characters into a one-off address: 
<ul>
<li>
&gt;&gt;</li>
<li>
@</li>
<li>
&lt;&gt;</li>
<li>
.</li>
</ul>
<p>
Every one-off address is assigned a corresponding <a href="glossary_4s33.htm#_mapi1book_gly_one_off_entry_identifier">one-off entry identifier</a>. To make this assignment, clients call <a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a><b> </b>and transport providers call <a href="inter025_37mu.htm"><b>IMAPISupport::CreateOneOff</b></a>. When processing incoming messages, transport providers create one-off entry identifiers for gateway addresses and for addresses that cannot be handled by the transport's associated address book providers. Transport providers check the type of each address in a message to determine if it can be handled by an address book provider associated with the transport. If it cannot, transport providers call <b>IMAPISupport::CreateOneOff</b> to associate the address with a one-off entry identifier.</p>
<p>
One-off entry identifiers include the following information in the following order:
<ol>
<li>
<b>MAPIUID</b></li>
<li>
Version</li>
<li>
Flags</li>
<li>
Display name</li>
<li>
Address type</li>
<li>
E-mail address</li>
</ol>
<p>
In the calls to <a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a> and <a href="inter025_37mu.htm"><b>IMAPISupport::CreateOneOff</b></a>, clients and transport providers can set a flag that indicates whether or not the recipient represented by the one-off address can process formatted text or embedded OLE objects. To indicate that a recipient can handle formatted text and OLE objects, clients and transport providers set the MAPI_SEND_NO_RICH_INFO flag in the <i>ulFlags</i> parameter. MAPI then sets the one-off recipient's <a href="propb_7wmn.htm">PR_SEND_RICH_INFO</a> property to FALSE. When this flag is not set, MAPI sets PR_SEND_RICH_INFO to TRUE unless the one-off address is interpreted as an SMTP address. In this one case, PR_SEND_RICH_INFO defaults to FALSE.</p>
<p>&nbsp;</p></body>
</HTML>
