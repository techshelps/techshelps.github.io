<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Attachments</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_attachments"></a>Attachments</h1>
<p>
Some message store providers allow clients to associate added information in the form of files, OLE objects, messages, or binary data with messages. This added information is called a message's attachment. Because attachments are created, maintained, and accessed only through their messages, they are considered message subobjects. Rather than having an entry identifier for access, attachments have a sequential number known as an attachment number. This number uniquely identifies the attachment within its message, but not necessarily within the message store. Two different messages can have different attachments with the same attachment number. Attachment numbers are only valid as long as the message is open and are stored in the <a href="propa_0p4d.htm">PR_ATTACH_NUM</a> property. </p>
<p>
To access summary information about all of a message's attachments, clients retrieve its attachment table. The attachment table includes information that clients can use to access an attachment directly, such as its attachment number and record key. Clients can retrieve an attachment table by:
<ul>
<li>
Calling <a href="inter029_24it.htm"><b>IMessage::GetAttachmentTable</b></a>.</li>
<li>
Calling <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a>.</li>
</ul>
<p>
Message store providers are expected to support both of these approaches. The<b> OpenProperty</b> approach requires that the caller specify IID_IMAPITable as the interface identifier and <a href="propa_2c1f.htm">PR_MESSAGE_ATTACHMENTS</a> as the property tag. PR_MESSAGE_ATTACHMENTS is a table object property that represents a message's attachment table. Message store providers are required to set PR_MESSAGE_ATTACHMENTS for each message and include it in the array of property tags returned from the <a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a> method.</p>
<p>
PR_MESSAGE_ATTACHMENTS can be used:
<ul>
<li>
With<b> <a href="inter022_15vd.htm">IMAPIProp::OpenProperty</a></b> to access an attachment or recipient table.</li>
<li>
With <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a> or <a href="inter022_406r.htm"><b>IMAPIProp::CopyProps</b></a> to exclude or include attachments when copying.</li>
<li>
In a subobject restriction to indicate that the child restriction should apply to attachments.</li>
</ul>
<p>
For more information, see <a href="tables_35pv.htm">Attachment Tables</a>.</p>
<p>&nbsp;</p></body>
</HTML>
