<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>One-Off Entry Identifiers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_one_off_entry_identifiers"></a>One-Off Entry Identifiers</h2>
<p>
One-off entry identifiers are created by MAPI in the <a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a> method and by components that do not have access to the MAPI subsystem, such as gateway components. The one-off entry identifier uses a specific format, defined as follows.</p>
<p>
<img src="images/amapi_69.gif" border=0></p>
<p>
The first field is a special <a href="structyp_3p9g.htm"><b>MAPIUID</b></a><b> </b>structure that identifies the entry identifier as representing a custom recipient. This <b>MAPIUID</b> structure must be set to the constant MAPI_ONE_OFF_UID. MAPI_ONE_OFF_UID is defined in the header file MAPIDEFS.H. </p>
<p>
The version and flags fields are 16-bit words in Intel byte order. The version field must be set to zero. The flags field can be set to the following values:</p>
<p class=indent1>
MAPI_ONE_OFF_NO_RICH_INFO</p>
<p class=indent1>
MAPI_ONE_OFF_UNICODE</p>
<p>
The MAPI_ONE_OFF_NO_RICH_INFO flag is set if a recipient should not receive message content in the Transport Neutral Encapsulation Format (TNEF). <b>IAddrBook::CreateOneOff </b>sets this flag when it is passed the MAPI_SEND_NO_RICH_INFO flag. </p>
<p>
The MAPI_ONE_OFF_UNICODE flag is set if the display name and e-mail address are Unicode strings. <b>IAddrBook::CreateOneOff </b>sets this flag when it is passed the MAPI_UNICODE flag. When the MAPI_UNICODE flag is not passed to <b>CreateOneOff</b>, MAPI assumes that the display name and e-mail address strings are in the workstation's current ANSI character set. ANSI strings generally do not work well in messages that are sent between platforms using different character sets because the code page is not encoded in the entry identifier. To protect against this potential incompatibility, many address types are limited to only those characters that are common across multiple character sets. However, to ensure character set and platform compatibility, clients should use Unicode for the character strings in their messages.</p>
<p>
The display name is a null-terminated string that corresponds to the recipient's <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> property and to the <i>lpszName</i> parameter passed to<b> IAddrBook::CreateOneOff</b>. The character set is Unicode if the MAPI_ONE_OFF_UNICODE flag is set and ANSI if it is clear.</p>
<p>
The address type is a null-terminated string that corresponds to the recipient's <a href="propa_4gkl.htm">PR_ADDRTYPE</a> property and to the <i>lpszAdrType</i> parameter passed to <b>IAddrBook::CreateOneOff</b>.</p>
<p>
The e-mail address is a null-terminated string that corresponds to the recipient's <a href="propa_2t9v.htm">PR_EMAIL_ADDRESS</a> property and to the <i>lpszAddress</i> parameter passed to <b>IAddrBook::CreateOneOff</b>.</p>
<p>
<b>Note</b>  There is no padding in one-off entry identifier structures; the bytes are packed exactly as indicated above and the entry identifier length should not include any bytes beyond the terminating null character of the e-mail address.</p>
<p>
Clients and address book providers that manually construct one-off entry identifiers might also need to generate values for the <a href="propb_6lkp.htm">PR_RECORD_KEY</a> and <a href="propb_960p.htm">PR_SEARCH_KEY</a> properties. The record key is identical to the entry identifier. The search key should be formed by concatenating the following fields in the following order:
<ol>
<li>
The address type, converted to uppercase characters</li>
<li>
A colon (:)</li>
<li>
The e-mail address, converted to uppercase characters</li>
<li>
A terminating null character</li>
</ol>
<p>
No character set conversion must be done when generating the search key.</p>
<p>&nbsp;</p></body>
</HTML>
