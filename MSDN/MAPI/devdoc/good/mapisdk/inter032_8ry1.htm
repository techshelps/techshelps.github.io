<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMSLogon::OpenEntry</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imslogon_openentry"></a>IMSLogon::OpenEntry</h2>
<p>
The <b>IMSLogon::OpenEntry</b> method opens a folder or message object and returns a pointer to the object to provide further access. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter032_5032.htm"><b>IMSLogon : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OpenEntry(
  ULONG</b><i> cbEntryID</i><b>,</b>       
<b>  LPENTRYID</b><i> lpEntryID</i><b>,</b>   
<b>  LPCIID</b><i> lpInterface</i><b>,</b>    
<b>  ULONG</b><i> ulOpenFlags</i><b>,</b>     
<b>  ULONG FAR *</b><i> lpulObjType</i><b>,</b>   
<b>  LPUNKNOWN FAR *</b><i> lppUnk </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cbEntryID</i></dt>
<dd>
[in] Size, in bytes, of the entry identifier pointed to by the <i>lpEntryID</i> parameter.</dd>
<dt>
<i>lpEntryID</i></dt>
<dd>
[in] Pointer to the address of the entry identifier of the folder or message object to open. </dd>
<dt>
<i>lpInterface</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) for the object. Passing NULL indicates the object is cast to the standard interface for such an object. The <i>lpInterface </i>parameter can also be set to an identifier for an appropriate interface for the object. </dd>
<dt>
<i>ulOpenFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the object is opened. The following flags can be set:
<dl>
<dt>
MAPI_BEST_ACCESS</dt>
<dd>
The object should be opened with the maximum permissions allowed for the user and the maximum client application access. For example, if the client has read/write access, the object is opened with read/write access; if the client has read-only access, the object is opened with read-only access. The client can retrieve the access level by getting the <a href="propa_4w8c.htm">PR_ACCESS_LEVEL</a> property.</dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
The call is allowed to succeed even if the underlying object is not accessible to the calling application. If the object is not accessible, some subsequent call to the object might return an error.</dd>
<dt>
MAPI_MODIFY</dt>
<dd>
Requests read/write access. By default, objects are created with read-only access, and clients should not work on the assumption that read/write access has been granted. </dd>
</dl>
</dd>
<dt>
<i>lpulObjType</i></dt>
<dd>
[out] Pointer to the type of the opened object.</dd>
<dt>
<i>lppUnk</i></dt>
<dd>
[out] Pointer to the pointer to the opened object.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
MAPI calls the <b>IMSLogon::OpenEntry</b> method to open a folder or a message in a message store. MAPI passes in the entry identifier of the object to open; the message store provider should return a pointer providing further access to the object in the <i>lppUnk</i> parameter. </p>
<p>
Before MAPI calls <b>IMSLogon::OpenEntry</b>, it first determines that the given message or folder entry identifier matches one registered by this message store provider. For more information on how store providers register entry identifiers, see <a href="inter025_91no.htm"><b>IMAPISupport::SetProviderUID</b></a>.</p>
<p>
<b>IMSLogon::OpenEntry</b> is identical to the <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a> method of the message store object but is called by MAPI when processing an <b>IMAPISession::OpenEntry</b> method call instead of being called by a client. Objects opened using <b>IMSLogon::OpenEntry</b> should be treated exactly the same as objects opened with the message store object; in particular, objects opened using this call should be invalidated when the message store object is released.</p>
<h4>See Also</h4>
<p>
<a href="inter025_91no.htm"><b>IMAPISupport::SetProviderUID</b></a>, <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a></p>
<p>&nbsp;</p></body>
</HTML>
