<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MapiFile (VB)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_mapifile_vb_"></a>MapiFile (VB)</h2>
<p>
The Visual Basic <b>MapiFile</b> type contains file attachment information. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIVB32.BAS</td>
</tr>
</table><br>
<pre><code>Type MapiFile
     Reserved as Long
     Flags as Long
     Position as Long
     PathName as String
     FileName as String
     FileType as String
End Type  
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>Reserved</b></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<b>Flags</b></dt>
<dd>
Bitmask of flags. The following flags can be set: 
<dl>
<dt>
MAPI_OLE</dt>
<dd>
The attachment is an OLE object file attachment. If MAPI_OLE_STATIC is also set, the object is static. If neither flag is set, the attachment is simply a data file.</dd>
<dt>
MAPI_OLE_STATIC</dt>
<dd>
The attachment is a static OLE object file attachment.</dd>
</dl>
</dd>
<dt>
<b>Position</b></dt>
<dd>
An integer used to determine where the attachment should be placed in the message text. Attachments replace the character found at a certain position in the message text; in other words, attachments replace the <b>MapiMessage</b> member <b>NoteText[Position]</b>. Applications cannot place two attachments in the same location within a message, and attachments cannot be placed beyond the end of the message text. <b>MAPIReadMail</b> does not return an attachment with the value of <b>Position</b> equal to –1 unless the MAPI_BODY_AS_FILE flag is set.</dd>
<dt>
<b>PathName</b></dt>
<dd>
The full path of the attached file. The file should be closed before this call is made.</dd>
<dt>
<b>FileName</b></dt>
<dd>
The filename seen by the recipient. This name can differ from the filename in the <b>PathName</b> member if temporary files are being used. If the <b>FileName</b> member is empty, the filename from <b>PathName</b> is used. If the attachment is an OLE object, <b>FileName</b> contains the class name of the object, such as "Microsoft Excel Worksheet."</dd>
<dt>
<b>FileType</b></dt>
<dd>
A reserved descriptor that indicates to the recipient the type of the attached file. An empty string indicates an unknown or operating system–determined file type. With this release, you must use an empty string, "", for this parameter. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
Simple MAPI for Visual Basic supports the following kinds of attachments:
<ul>
<li>
Data files</li>
<li>
Embedded OLE objects</li>
<li>
Static OLE objects</li>
</ul>
<p>
The <b>Flags</b> member determines the kind of attachment. OLE object files are file representations of OLE object streams. You can re-create an OLE object from the file by calling the OLE function <b>OleLoadFromStream</b> with an OLESTREAM object that reads the file contents. If an OLE file attachment is included in an outbound message, the OLE object stream should be written directly to the file used as the attachment. </p>
<p>&nbsp;</p></body>
</HTML>
