<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handling MAPI Forms</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_handling_mapi_forms"></a>Handling MAPI Forms</h1>
<p>
A MAPI form is a viewer for a message of a particular class. Clients that allow their users to work with messages belonging to a variety of message classes must be written to handle a variety of MAPI forms. To handle multiple forms, clients implement a component known as a form viewer which contains three objects:
<ul>
<li>
Message site object, which supports the <a href="inter020_5elq.htm"><b>IMAPIMessageSite : IUnknown</b></a> interface</li>
<li>
View advise sink, which supports the <a href="inter027_652m.htm"><b>IMAPIViewAdviseSink : IUnknown</b></a> interface</li>
<li>
View context object, which supports the <a href="inter028_4zla.htm"><b>IMAPIViewContext : IUnknown</b></a> interface</li>
</ul>
<p>
Each of these objects is used by a component called the form server which implements each form, handling its storage and the notifications generated by clients handling the view. One other component, the form library provider, implements a form manager. The form manager administers the form libraries, which store form server executable files. This administration includes loading the appropriate form server and handling the initial communication between the server and the client.</p>
<p>
The following diagram shows the relationship between a client and the other parts of the MAPI form architecture:</p>
<p>
<img src="images/forms01.gif" border=0></p>
<p>
If your client plans to handle MAPI forms, you will use the form manager's <a href="inter019_3ju6.htm"><b>IMAPIFormMgr</b></a> interface to perform five basic tasks:
<ul>
<li>
Launch the appropriate MAPI form server when a message is opened or composed.</li>
<li>
Display form servers' icons in the contents tables of folders.</li>
<li>
Send and receive form notifications. See <a href="consider_8tpv.htm">Sending and Receiving Form Notifications</a>.</li>
<li>
Allow users to install or remove form servers from form libraries. See <a href="consider_8qux.htm">Maintaining a Form Library</a>.</li>
<li>
Allow users to associate form servers with particular folders.</li>
</ul>
<p>
To access the form manager, call the <a href="function_7liq.htm"><b>MAPIOpenFormMgr</b></a> function once during initialization. </p>
<p>
For more information about MAPI forms, see <a href="formsarc_26yb.htm">Forms </a> and <a href="formsvr_8ws3.htm">Developing MAPI Form Servers</a>.</p>
<p>&nbsp;</p></body>
</HTML>
