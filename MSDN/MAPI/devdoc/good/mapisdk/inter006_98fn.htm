<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAddrBook::PrepareRecips</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iaddrbook_preparerecips"></a>IAddrBook::PrepareRecips</h2>
<p>
The <b>IAddrBook::PrepareRecips</b> method prepares a recipient list for later use by the messaging system. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter006_23e8.htm"><b>IAddrBook : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT PrepareRecips(
  ULONG</b><i> ulFlags</i><b>,</b>                     
<b>  LPSPropTagArray</b><i> lpSPropTagArray</i><b>,</b>   
<b>  LPADRLIST</b><i> lpRecipList              </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lpSPropTagArray</i></dt>
<dd>
[in] Pointer to an <a href="structyp_23i1.htm"><b>SPropTagArray</b></a> structure containing an array of property tags indicating properties that require updating, if any. The <i>lpSPropTagArray</i> parameter can be NULL.</dd>
<dt>
<i>lpRecipList</i></dt>
<dd>
[in] Pointer to an <a href="structyp_87n8.htm"><b>ADRLIST</b></a> structure holding the list of recipients.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The recipient list was successfully prepared.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Clients and service providers call the <b>IAddrBook::PrepareRecips</b> method to:
<ul>
<li>
Ensure that all recipients in the <i>lpRecipList</i> parameter have long-term entry identifiers.</li>
<li>
Ensure that each recipient in the <i>lpRecipList</i> parameter has the properties listed in the <i>lpSPropTagArray</i> parameter and that these properties appear at the beginning of the recipient list.</li>
</ul>
<p>
MAPI converts each recipient's short-term entry identifiers to long-term entry identifiers. If necessary, recipients' long-term entry identifiers are retrieved from the appropriate address book provider along with any additional properties requested.</p>
<p>
Within an individual recipient entry, the requested properties are ordered first, followed by any additional properties that were already present for the entry. If one or more of the requested properties, the properties included in the <i>lpSPropTagArray</i>, are not handled by the appropriate address book provider, their property types will be set to PT_ERROR and their property values either to MAPI_E_NOT_FOUND or to another value giving a more specific reason why the properties are not available. Each <a href="structyp_9sbp.htm"><b>SPropValue</b></a> structure included in the <i>lpSPropTagArray</i> parameter must be separately allocated using the <a href="function_8z3m.htm"><b>MAPIAllocateBuffer</b></a> and <a href="function_11wl.htm"><b>MAPIAllocateMore</b></a> functions such that it can be freed individually. </p>
<p>
For information on PT_ERROR, see <a href="appprop_3n3n.htm">List of Property Types</a>.</p>
<h4>See Also</h4>
<p>
<a href="structyp_87n8.htm"><b>ADRLIST</b></a>, <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a>, <a href="inter029_8vw3.htm"><b>IMessage::ModifyRecipients</b></a>, <a href="propa_8cv8.htm">PR_ENTRYID</a>, <a href="structyp_9sbp.htm"><b>SPropValue</b></a>, <a href="structyp_2378.htm"><b>SRowSet</b></a></p>
<p>&nbsp;</p></body>
</HTML>
