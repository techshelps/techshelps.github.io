<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OPTIONCALLBACK</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_optioncallback"></a>OPTIONCALLBACK</h2>
<p>
The <b>OPTIONCALLBACK</b> function prototype defines a callback function that MAPI calls to retrieve a wrapped <a href="inter022_00tq.htm"><b>IMAPIProp</b></a> interface that manages a transport provider's properties. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPISPI.H </td>
</tr>
<tr valign=top>
<td width=48%>Defined function implemented by: </td>
<td width=52%>Transport providers </td>
</tr>
<tr valign=top>
<td width=48%>Defined function called by: </td>
<td width=52%>MAPI </td>
</tr>
</table><br>
<pre><code><b>SCODE OPTIONCALLBACK(
  HINSTANCE</b><i> hInst</i><b>,</b>                     
<b>  LPMALLOC</b><i> lpMalloc</i><b>,</b>                   
<b>  ULONG</b><i> ulFlags</i><b>,</b>                       
<b>  ULONG</b><i> cbOptionData</i><b>,</b>                  
<b>  LPBYTE</b><i> lpbOptionData</i><b>,</b>                
<b>  LPMAPISUP</b><i> lpMAPISup</i><b>,</b>                 
<b>  LPMAPIPROP</b><i> lpDataSource</i><b>,</b>             
<b>  LPMAPIPROP FAR *</b><i> lppWrappedSource</i><b>,</b>   
<b>  LPMAPIERROR FAR *</b><i> lppMAPIError       </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInst</i></dt>
<dd>
[in] The <i>hinstance</i> value for this transport provider's dynamic-link library (DLL) as returned from the <b>LoadLibrary</b> function call made by MAPI.</dd>
<dt>
<i>lpMalloc</i></dt>
<dd>
[in] Pointer to a memory allocator object exposing the OLE <b>IMalloc</b> interface. The transport provider may need to use this allocation method when working with certain interfaces such as <b>IStream</b>. </dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls what options are processed. The following flags can be set:
<dl>
<dt>
OPTION_TYPE_MESSAGE</dt>
<dd>
Message options.</dd>
<dt>
OPTION_TYPE_RECIPIENT</dt>
<dd>
Recipient options.</dd>
</dl>
</dd>
<dt>
<i>cbOptionData</i></dt>
<dd>
[in] Size, in bytes, of the data pointed to by the <i>lpbOptionData </i>parameter.</dd>
<dt>
<i>lpbOptionData</i></dt>
<dd>
[in] Pointer to an <a href="structyp_7gtd.htm"><b>OPTIONDATA</b></a> structure containing option data for the recipient or message. This <b>OPTIONDATA</b> structure was passed in the call to the <a href="inter042_8gvn.htm"><b>IXPLogon::RegisterOptions</b></a> method that registered the options.</dd>
<dt>
<i>lpMAPISup</i></dt>
<dd>
[in] Pointer to a MAPI support object the provider can use to call the methods of the <a href="inter025_8uge.htm"><b>IMAPISupport : IUnknown</b></a> interface. </dd>
<dt>
<i>lpDataSource</i></dt>
<dd>
[in] Pointer to an <a href="inter022_00tq.htm"><b>IMAPIProp : IUnknown</b></a> interface that MAPI wraps for the transport provider's use. </dd>
<dt>
<i>lppWrappedSource</i></dt>
<dd>
[out] Pointer to a pointer to the wrapped <b>IMAPIProp</b> interface returned by the transport provider.</dd>
<dt>
<i>lppMAPIError</i></dt>
<dd>
[out] Pointer to a pointer to the returned <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a> structure, if any, containing version, component, and context information for the error.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
MAPI calls the transport provider's <b>OPTIONCALLBACK</b> function if a transport provider has previously registered message options with the <a href="inter042_8gvn.htm"><b>IXPLogon::RegisterOptions</b></a> method. Transport providers that do not define message or recipient options do not need to implement this callback function.</p>
<p>
MAPI passes a wrapped <a href="inter022_00tq.htm"><b>IMAPIProp : IUnknown</b></a> interface in the <i>lpDataSource</i> parameter. The transport provider should build a display table, set any properties, and then pass that display table back to MAPI in a wrapped <b>IMAPIProp</b> interface in the <i>lppWrappedSource</i> parameter. MAPI uses this <b>IMAPIProp</b> interface to display properties in the message or recipient options dialog box that is displayed to users. When users make selections in the dialog box resulting in a call to the <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method for the PR_DETAILS_TABLE property, the transport provider gets the call and should display the display table. The transport provider must call the <a href="inter022_6cxf.htm"><b>IMAPIProp::SetProps</b></a> method followed by the <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method on any changes the user made to the display table. </p>
<p>
For more information on how to create display tables, see <a href="tables_6rw3.htm">Display Tables</a>. </p>
<p>&nbsp;</p></body>
</HTML>
