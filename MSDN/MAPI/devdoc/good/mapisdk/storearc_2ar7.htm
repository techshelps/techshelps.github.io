<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting Searches in Message Store Providers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_supporting_searches_in_message_store_providers"></a>Supporting Searches in Message Store Providers</h2>
<p>
Client applications frequently have some user interface components devoted to searching for messages within a message store. Search criteria are specified within the <a href="inter011_7u0g.htm"><b>IMAPIContainer</b></a> interface by means of the <a href="inter011_2psx.htm"><b>IMAPIContainer::SetSearchCriteria</b></a> and <a href="inter011_357l.htm"><b>IMAPIContainer::GetSearchCriteria</b></a> methods.</p>
<p>
Clients use the message store object's <a href="propa_3gro.htm">PR_FINDER_ENTRYID</a> property to identify the root folder in the message store that contains folders for search results. The search-results folder is often a folder at the top level of the message store that is not part of the IPM folder tree and is therefore hidden.</p>
<p>
Whether your message store provider uses a permanent search-results folder or creates one when a client opens the entry identifier stored in the PR_FINDER_ENTRYID property is an implementation detail. It is somewhat easier for your message store provider to use a permanent folder that is created when the message store is created, because doing so avoids the complication of checking the entry identifier whenever any folder is opened to see whether to create a search-results folder. However, not all message store providers can do that; notably, read-only message stores or stores that provide a MAPI interface to a legacy database often are not allowed or are unable to create a permanent search-results folder in the underlying storage mechanism.</p>
<p>&nbsp;</p></body>
</HTML>
