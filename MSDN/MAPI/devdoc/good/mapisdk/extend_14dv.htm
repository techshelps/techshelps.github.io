<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Address Book Identifiers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_address_book_identifiers"></a>Address Book Identifiers</h2>
<p>
All address book providers assign entry identifiers using the <a href="propa_8cv8.htm">PR_ENTRYID</a> property to their messaging user and distribution list objects. Client applications use these entry identifiers to open and access the objects to which they are assigned. </p>
<p>
The address book makes use of three other types of identifiers to represent objects:
<ul>
<li>
One-off entry identifiers</li>
<li>
One-off template entry identifiers</li>
<li>
Template identifiers</li>
</ul>
<p>
Because of the variety of entry identifiers and the similarity with which they are named, it is easy to become confused about how each type is used and created. </p>
<p>
A one-off entry identifier is an entry identifier that is used to open and access the type of recipient known as a one-off, or custom recipient. One-offs are recipients that do not belong to any of the address book providers in the profile. The entry identifiers assigned to one-offs use a format reserved for one-off recipients. Because one-off entry identifiers are used to open and access objects, they are stored in the PR_ENTRYID property.</p>
<p>
One-offs and one-off entry identifiers are created:
<ul>
<li>
When users of a client application elect to add a recipient that does not represent any entry in the address book to a message's recipient list.</li>
<li>
When users of a client application elect to add a recipient that does not represent any entry in the address book to a modifiable address book container.</li>
<li>
When a transport provider receives a message with an address that cannot be handled by its related address book provider.</li>
<li>
When a transport provider receives a message with an address that belongs to a gateway.</li>
</ul>
<p>
In the first two situations, the client calls <a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a> to associate a one-off entry identifier with the newly created one-off recipient. In the second two situations, the transport provider calls <a href="inter025_37mu.htm"><b>IMAPISupport::CreateOneOff</b></a> to associate a one-off entry identifier with the foreign address.</p>
<p>
A one-off template entry identifier is a short-term entry identifier that is used to open and access a template for creating one-offs. Address book providers and MAPI supply templates for entering the information that is required to create a recipient of a particular type. Information about these templates, including their entry identifiers, is published in the one-off table. One-off tables are displayed when MAPI calls either the <a href="inter004_3x0l.htm"><b>IABLogon::GetOneOffTable</b></a> method or an address book container's <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a><b> </b>method to request the <a href="propa_6h83.htm">PR_CREATE_TEMPLATES</a> property or when a provider calls <a href="inter025_6odh.htm"><b>IMAPISupport::GetOneOffTable</b></a>.</p>
<p>
To create a new one-off, a user selects one of the templates listed in the one-off table. The client passes the PR_ENTRYID column from the selected row, which is the one-off template entry identifier of the selected template, to<b> <a href="inter006_7b7d.htm">IAddrBook::NewEntry</a></b> in the <i>lpEIDNewEntryTpl</i> parameter. MAPI uses the one-off template entry identifier to display the template and allow the user to enter the information needed to create the recipient. </p>
<p>
A template identifier is an entry identifier that some address book providers assign to their recipients in addition to the entry identifier that is kept in the PR_ENTRYID property. Providers set a recipient's <a href="propb_8810.htm">PR_TEMPLATEID</a> property to store its template identifier. Some address book providers assign the same value for a recipient's template identifier and entry identifier properties.</p>
<p>
Template identifiers are used only by address book providers and by MAPI to bind recipient data in one provider, referred to as the host provider, to code for the recipient in another provider, referred to as the foreign provider. The host provider supplies the storage for the recipient; the foreign provider supplies the logic. The binding process enables a host provider to update the data of a recipient that it stores using the code of a foreign provider.</p>
<p>
When the host provider is ready to modify its recipient, it passes the PR_TEMPLATEID property in a call to the <a href="inter025_8aec.htm"><b>IMAPISupport::OpenTemplateID</b></a> method to initiate the binding process. MAPI continues the process by transferring the template identifier to the appropriate foreign provider through a call to its <a href="inter004_5j1g.htm"><b>IABLogon::OpenTemplateID</b></a> method. The foreign provider returns a pointer to its <b>IMAPIProp</b> implementation for the recipient, which the host provider can use in place of its own implementation. </p>
<p>&nbsp;</p></body>
</HTML>
