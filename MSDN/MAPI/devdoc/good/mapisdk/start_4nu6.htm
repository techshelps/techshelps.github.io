<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Document Routing to an Application</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_adding_document_routing_to_an_application"></a>Adding Document Routing to an Application</h1>
<p>
Document routing — adding a <b>Route</b> command or another form of document routing support to a <b>File</b> menu in a document-based application — can be used for many purposes, but all involve defining a list of people who are to read and act on information in the document in a specific order.</p>
<p>
The following discussion assumes you want to base your routing application on an existing document-based application. If you prefer to base it on a messaging client, see also <a href="start_24hf.htm">Creating a New Interpersonal (IPM) Message Class</a>.</p>
<h4>Design Tasks</h4>
<ol>
<li>
Decide whether to use Simple MAPI, CMC, MAPI, or the Active Messaging Library. See <a href="intro_3lph.htm">Selecting a Client Interface</a>.<p>
If your application requires routing across messaging domain boundaries, you must use MAPI or the Active Messaging Library and store the routing information in named properties on the message. See <a href="extend_2goj.htm">Sending Across Messaging Domains</a>. If you use the Active Messaging Library, the routing information must be stored in the message's Fields collection using five special property sets. See <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_olemsg_customizing_a_folder_or_message">
</object><a href=JavaScript:alink_1.Click()>Customizing a Folder or Message</a> and <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_olemsg_fields_collection_object">
</object><a href=JavaScript:alink_2.Click()>Fields Collection Object</a>.
<p>
If you choose to use Simple MAPI or CMC, the routing information can be stored in a file attached to your message. For Simple MAPI, see <a href="smapi_55yh.htm">Handling Attachments with Simple MAPI</a>. For CMC, see <a href="cmc_29ib.htm">Handling Attachments with CMC</a>.
</li>
<li>
Design the message properties and the commands — called "verbs" in MAPI — specific to your routing functionality. </li>
</ol>
<h4>Implementation Tasks</h4>
<ol>
<li>
Choose the message class name. It should begin with IPM. See <a href="extend_5gab.htm">Message Classes</a>.</li>
<li>
Use the MAPI address book dialog box to let the user add names to the routing list. See the <a href="inter006_2fn7.htm"><b>IAddrBook::Address</b></a> method and <a href="structyp_9ze5.htm"><b>ADRPARM</b></a> and <a href="structyp_87n8.htm"><b>ADRLIST</b></a> structures. </li>
<li>
Store the routing list in the message, an attached file, or the document itself, as appropriate.</li>
<li>
Support your routing verbs with message — or document — properties that refer to entries in the routing list.</li>
</ol>
<h4>About Sample Source Code</h4>
<p>
See the following topics:</p>
<p class=indent1>
<a href="start_3bzo.htm">Sample Routing Client</a></p>
<p class=indent1>
<a href="start_5epa.htm">Sample Timecard Application</a></p>
<p>&nbsp;</p></body>
</HTML>
