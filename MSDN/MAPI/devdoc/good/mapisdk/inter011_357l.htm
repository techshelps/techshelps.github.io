<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIContainer::GetSearchCriteria</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapicontainer_getsearchcriteria"></a>IMAPIContainer::GetSearchCriteria</h2>
<p>
The <b>IMAPIContainer::GetSearchCriteria</b> method obtains the search criteria for the container.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter011_7u0g.htm"><b>IMAPIContainer : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT GetSearchCriteria(
  ULONG</b><i> ulFlags</i><b>,</b>                        
<b>  LPSRestriction FAR *</b><i> lppRestriction</i><b>,</b>   
<b>  LPENTRYLIST FAR *</b><i> lppContainerList</i><b>,</b>   
<b>  ULONG FAR *</b><i> lpulSearchState           </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the type of the passed-in strings. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The passed-in strings are in Unicode format. If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lppRestriction</i></dt>
<dd>
[out] Pointer to a pointer to an <a href="structyp_45ny.htm"><b>SRestriction</b></a> structure defining the search criteria. If a client application passes NULL in the <i>lppRestriction</i> parameter, <b>GetSearchCriteria</b> does not return an <b>SRestriction</b> structure.</dd>
<dt>
<i>lppContainerList</i></dt>
<dd>
[out] Pointer to a pointer to an array of entry identifiers representing containers to be included in the search. If a client passes NULL in the <i>lppContainerList </i>parameter, <b>GetSearchCriteria</b> does not return an array of entry identifiers.</dd>
<dt>
<i>lpulSearchState</i></dt>
<dd>
[out] Pointer to a bitmask of flags used to indicate the current state of the search. If a client passes NULL in the <i>lpulSearchState </i>parameter, <b>GetSearchCriteria</b> does not return any flags. The following flags can be set for <i>lpulSearchState:</i>
<dl>
<dt>
SEARCH_FOREGROUND</dt>
<dd>
The search is running at high priority relative to other searches. If this flag is not set, the search is running at normal priority relative to other searches.</dd>
<dt>
SEARCH_REBUILD</dt>
<dd>
The search is in the CPU-intensive mode of its operation, attempting to locate messages that match the criteria. If this flag is not set, the CPU-intensive part of the search's operation is over. This flag only has meaning if the search is active — that is, if the SEARCH_RUNNING flag is set.</dd>
<dt>
SEARCH_RECURSIVE</dt>
<dd>
The search is looking in specified containers and all of their child containers for matching entries. If this flag is not set, only the containers explicitly included in the last call to the <a href="inter011_2psx.htm"><b>IMAPIContainer::SetSearchCriteria</b></a> method are being searched.</dd>
<dt>
SEARCH_RUNNING</dt>
<dd>
The search is active and the container's contents table is being updated to reflect changes in the message store or address book. If this flag is not set, the search is inactive and the contents table is static.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The search criteria was successfully obtained.</dd>
<dt>
MAPI_E_BAD_CHARWIDTH</dt>
<dd>
Either the MAPI_UNICODE flag was set and the implementation does not support Unicode, or MAPI_UNICODE was not set and the implementation only supports Unicode.</dd>
<dt>
MAPI_E_NOT_INITIALIZED</dt>
<dd>
Search criteria were never established for the container. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIContainer::GetSearchCriteria</b> method obtains the search criteria for a container that supports searches, typically a search-results folder. Search criteria are created by calling a container's <a href="inter011_2psx.htm"><b>IMAPIContainer::SetSearchCriteria</b></a> method. </p>
<h4>Notes to Implementers</h4>
<p>
Address book containers only need to support <b>GetSearchCriteria</b> if they provide the advanced search capabilities associated with the <a href="propb_7eso.htm">PR_SEARCH</a> property. For more information on implementing the advanced search feature for address book containers, see <a href="ab_5qzr.htm">Implementing Advanced Searching</a>.</p>
<h4>Notes to Callers</h4>
<p>
When you are finished with the data structures pointed to by the <i>lppRestriction </i>and <i>lppContainerList</i> parameters, call <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a><b> </b>to release the structures — one call to release each structure.</p>
<h4>See Also</h4>
<p>
<a href="inter011_2psx.htm"><b>IMAPIContainer::SetSearchCriteria</b></a>, <a href="inter013_9tpu.htm"><b>IMAPIFolder::CreateFolder</b></a>, <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a>, <a href="propb_7eso.htm">PR_SEARCH</a></p>
<p>&nbsp;</p></body>
</HTML>
