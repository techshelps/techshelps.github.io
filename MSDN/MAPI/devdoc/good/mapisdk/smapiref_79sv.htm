<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPIReadMail (VB)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_mapireadmail_vb_"></a>MAPIReadMail (VB)</h2>
<p>
The Visual Basic <b>MAPIReadMail</b> function retrieves a message for reading. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIVB32.BAS</td>
</tr>
</table><br>
<p>
<b>MAPIReadMail</b>(</p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;</b><i>Session</i> as<b> Long,<br>
</b>&nbsp;&nbsp;&nbsp;&nbsp;<i>UIParam</i> as <b>Long</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>MessageID</i> as <b>String</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Flags</i> as <b>Long</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Reserved</i> as <b>Long,<br>
&nbsp;&nbsp;&nbsp;&nbsp;</b><i>Message</i> as <b>MapiMessage,<br>
&nbsp;&nbsp;&nbsp;&nbsp;</b><i>Originator</i> as <b>MapiRecip,<br>
&nbsp;&nbsp;&nbsp;&nbsp;</b><i>Recips()</i> as <b>MapiRecip,<br>
&nbsp;&nbsp;&nbsp;&nbsp;</b><i>Files()</i> as <b>MapiFile</b>) as <b>Long</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>Session</i></dt>
<dd>
[in] Handle to a Simple MAPI session. The value of the <i>Session</i> parameter must represent a valid session; it cannot be zero.</dd>
<dt>
<i>UIParam</i></dt>
<dd>
[in] Parent window handle or zero, indicating that if a dialog box is displayed, it is application modal. If no dialog box is displayed during the call, the <i>UIParam</i> parameter is ignored.</dd>
<dt>
<i>MessageID</i></dt>
<dd>
[in] The message identifier of the message to be read. The <i>MessageID</i> parameter is a variable-length string that is obtained from the <a href="smapiref_4fvj.htm"><b>MAPIFindNext</b></a> and <a href="smapiref_2uan.htm"><b>MAPISaveMail</b></a> functions.</dd>
<dt>
<i>Flags</i></dt>
<dd>
[in] Bitmask of flags. The following flags can be set:
<dl>
<dt>
MAPI_BODY_AS_FILE</dt>
<dd>
<b>MAPIReadMail</b> should write the message text to a temporary file and add it as the first attachment in the attachment list. </dd>
<dt>
MAPI_ENVELOPE_ONLY</dt>
<dd>
<b>MAPIReadMail</b> should read the message header only. File attachments are not copied to temporary files, and neither temporary file names nor message text are written. Setting this flag makes <b>MAPIReadMail</b> processing faster.</dd>
<dt>
MAPI_PEEK</dt>
<dd>
<b>MAPIReadMail</b> does not mark the message as read. Marking a message as read affects its appearance in the user interface and generates a read receipt. If the messaging system does not support this flag, <b>MAPIReadMail</b> always marks the message as read. If <b>MAPIReadMail</b> encounters an error, it leaves the message unread. </dd>
<dt>
MAPI_SUPPRESS_ATTACH</dt>
<dd>
<b>MAPIReadMail</b> should not copy file attachments but should write message text into the <a href="smapiref_1iov.htm"><b>MapiMessage</b></a> type. <b>MAPIReadMail</b> ignores this flag if the calling application has set the MAPI_ENVELOPE_ONLY flag. Setting this flag makes <b>MAPIReadMail</b> processing faster.</dd>
</dl>
</dd>
<dt>
<i>Reserved</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>Message</i></dt>
<dd>
[out] A type set by <b>MAPIReadMail</b> to a message containing the message contents.</dd>
<dt>
<i>Originator</i></dt>
<dd>
[out] The originator of the message.</dd>
<dt>
<i>Recips</i></dt>
<dd>
[out] Array of recipients. This array is redimensioned as necessary to accommodate the number of recipients chosen by the user. </dd>
<dt>
<i>Files</i></dt>
<dd>
[out] Array of attachment files written when the message is read. When <b>MAPIReadMail</b> is called, all message attachments are written to temporary files. It is the caller's responsibility to delete these files when they are no longer needed. When MAPI_ENVELOPE_ONLY or MAPI_SUPPRESS_ATTACH is set, no temporary files are written and no temporary names are filled into the file attachment descriptors. This array is redimensioned as necessary to accommodate the number of files attached by the user. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MAPI_E_ATTACHMENT_WRITE_FAILURE</dt>
<dd>
An attachment could not be written to a temporary file. Check directory permissions.</dd>
<dt>
MAPI_E_DISK_FULL</dt>
<dd>
The disk was full.</dd>
<dt>
MAPI_E_FAILURE</dt>
<dd>
One or more unspecified errors occurred while reading the message.</dd>
<dt>
MAPI_E_INSUFFICIENT_MEMORY</dt>
<dd>
There was insufficient memory to read the message.</dd>
<dt>
MAPI_E_INVALID_MESSAGE</dt>
<dd>
An invalid message identifier was passed in the <i>MessageID</i> parameter. </dd>
<dt>
MAPI_E_INVALID_SESSION</dt>
<dd>
An invalid session handle was passed in the <i>Session</i> parameter. No message was retrieved.</dd>
<dt>
MAPI_E_TOO_MANY_FILES</dt>
<dd>
There were too many file attachments in the message. The message could not be read.</dd>
<dt>
MAPI_E_TOO_MANY_RECIPIENTS</dt>
<dd>
There were too many recipients of the message. The message could not be read.</dd>
<dt>
SUCCESS_SUCCESS</dt>
<dd>
The call succeeded and the message was read.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MAPIReadMail</b> function returns one message, breaking the message content into the same parameters and types used in the <b>MAPISendMail</b> function. <b>MAPIReadMail</b> fills a block of memory with the <a href="smapiref_1iov.htm"><b>MapiMessage</b></a> type containing message elements. File attachments are saved to temporary files, and the names are returned to the caller in the message type. Recipients, attachments, and contents are copied from the message before <b>MAPIReadMail</b> returns to the caller, so later changes to the files do not affect the contents of the message. </p>
<p>
A flag is provided to specify that only envelope informationis to be returned from the call. Another flag in the <a href="smapiref_1iov.htm"><b>MapiMessage</b></a> type specifies whether the message is marked as sent or unsent. </p>
<p>
All strings are null-terminated and must be specified in the current character set or code page of the client application's operating system process. In Microsoft Windows, the character set is ANSI.</p>
<p>
The sender, recipients, and file attachments are written into the appropriate parameters of the Visual Basic call. The <i>Recips</i> and <i>Files</i> parameters should be dynamically allocated arrays of their respective types.</p>
<p>
The declaration of this function for the 32-bit Visual Basic runtime is:</p>
<p>
<b>MAPIReadMail(</b></p>
<p>
<i>Session </i>As Long, <br>
<i>UIParam </i>As Long, <br>
<i>MessageID </i>As String, <br>
<i>Flags </i>As Long, <br>
<i>Reserved </i>As Long, <br>
<i>message </i>As MAPIMessage, <br>
<i>Orig </i>As MapiRecip, <br>
<i>RecipsOut</i>() As MapiRecip, <br>
<i>FilesOut</i>() As MapiFile) <b>As Long</b></p>
<p>&nbsp;</p></body>
</HTML>
