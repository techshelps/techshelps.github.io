<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMsgStore::GetOutgoingQueue</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imsgstore_getoutgoingqueue"></a>IMsgStore::GetOutgoingQueue</h2>
<p>
The <b>IMsgStore::GetOutgoingQueue</b> method provides access to the outgoing queue table — a table with information about all of the messages in the message store's outgoing queue. This method is called only by the MAPI spooler.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter031_1jg0.htm"><b>IMsgStore : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT GetOutgoingQueue(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the outgoing queue table.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The outgoing queue table was successfully returned.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMsgStore::GetOutgoingQueue</b> method provides the MAPI spooler with access to the table showing the message store's queue of outgoing messages. Typically, messages are placed in the outgoing queue table after their <a href="inter029_65ut.htm"><b>IMessage::SubmitMessage</b></a><b> </b>method is called. However, because the order of submission affects the order of preprocessing and submission to the transport provider, some messages that have been marked for sending might not appear in the outgoing queue table immediately. </p>
<h4>Notes to Implementers</h4>
<p>
For a list of the properties that must be included as columns in your outgoing queue table, see <a href="tables_3qur.htm">Outgoing Queue Tables</a>. </p>
<p>
Because the MAPI spooler is designed to accept messages from a message store in ascending order of submission time, either allow the MAPI spooler to sort the outgoing queue table to match this order or establish it as the default sort order.</p>
<p>
You must support notifications for the outgoing message queue table, ensuring that the MAPI spooler is notified when the contents of the queue change. </p>
<h4>See Also</h4>
<p>
<a href="inter029_65ut.htm"><b>IMessage::SubmitMessage</b></a></p>
<p>&nbsp;</p></body>
</HTML>
