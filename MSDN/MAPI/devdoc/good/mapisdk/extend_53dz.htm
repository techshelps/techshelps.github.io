<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Strategies for Error Handling</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_strategies_for_error_handling"></a>Strategies for Error Handling</h2>
<p>
Because interface methods are virtual, it is not possible to know, as a caller, the full set of values that can be returned from any one call. One implementation of a method might return five values; another might return eight. The reference entries in the <i>MAPI Programmer's Reference</i> list a few values that can be returned for each method; these are the values that your client or service provider can check for and handle because they have special meanings. Other values can be returned, but since they are not meaningful, special code to handle those is not necessary. A simple check for success or failure is adequate. </p>
<p>
A few of the interface methods return warnings. If a method that your client or service provider calls can return a warning, use the <b>HR_FAILED</b> macro to test the return value rather than a check for zero or nonzero. Warnings, although nonzero, differ from error codes in that they do not have the high bit set. If your client or service provider does not use the macro, it is likely that a warning might be mistaken for a failure.</p>
<p>
Although most interface methods and functions return HRESULT values, some functions, primarily those defined for Simple MAPI, return unsigned long values. Also, some methods used in the MAPI environment come from OLE and return OLE error values rather than MAPI error values. Keep in mind the following guidelines when making calls:
<ul>
<li>
Never rely on or use the return values from <b>IUnknown::AddRef</b> or <b>IUnknown::Release</b>. These return values are for diagnostic purposes only. </li>
<li>
<b>IUnknown::QueryInterface</b> always returns generic OLE errors where the facility is FACILITY_NULL or FACILITY_RPC, rather than MAPI errors. </li>
<li>
All other interface methods return MAPI interface errors with a facility of FACILITY_ITF, or FACILITY_RPC or FACILITY_NULL errors.</li>
<li>
Simple MAPI calls return Simple MAPI errors rather than SCODE or HRESULT values.</li>
<li>
CMC calls have their own defined set of error codes. CMC codes are unsigned long values.</li>
<li>
No MAPI call ever returns a Simple MAPI error value.</li>
</ul>
<p>
If your service provider works with clients that use both the Simple MAPI and MAPI client interfaces, be aware that although the underlying values for some of the errors are different, the constants defined for them are quite similar. For example, when a call is made to an unsupported feature in Simple MAPI, the error MAPI_E_NOT_SUPPORTED is returned. When the same type of call is made to a MAPI method, one of four possible errors can be returned: </p>
<p>
MAPI_E_NO_SUPPORT</p>
<p>
MAPI_E_INTERFACE_NOT_SUPPORTED</p>
<p>
MAPI_E_INVALID_PARAMETER</p>
<p>
MAPI_E_VERSION. </p>
<p>
For this reason, avoid including the Simple MAPI header file, MAPI.H, in your client or service provider. The table below points out these similarities and differences. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Simple MAPI return value</th>
<th align=left width=54%>MAPI return value</th>
</tr>
<tr valign=top>
<td width=46%>MAPI_E_NOT_SUPPORTED</td>
<td width=54%>MAPI_E_NO_SUPPORT<br>
MAPI_E_INTERFACE_NOT_SUPPORTED<br>
MAPI_E_INVALID_PARAMETER<br>
MAPI_E_VERSION</td>
</tr>
<tr valign=top>
<td width=46%>MAPI_E_DISK_FULL</td>
<td width=54%>MAPI_E_NOT_ENOUGH_DISK</td>
</tr>
<tr valign=top>
<td width=46%>MAPI_E_NETWORK_FAILURE</td>
<td width=54%>MAPI_E_NETWORK_ERROR</td>
</tr>
<tr valign=top>
<td width=46%>MAPI_E_USER_ABORT</td>
<td width=54%>MAPI_E_USER_CANCEL</td>
</tr>
<tr valign=top>
<td width=46%>MAPI_E_ACCESS_DENIED</td>
<td width=54%>MAPI_E_NO_ACCESS</td>
</tr>
<tr valign=top>
<td width=46%>MAPI_E_AMBIGUOUS_RECIPIENT</td>
<td width=54%>MAPI_E_AMBIGUOUS_RECIP</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
