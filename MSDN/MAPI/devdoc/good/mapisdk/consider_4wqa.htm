<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening a Folder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_opening_a_folder"></a>Opening a Folder</h2>
<p>
Before any folder can be opened, its entry identifier must be available. For most folders, this means retrieving their <a href="propa_8cv8.htm">PR_ENTRYID</a> properties. For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method. These entry identifiers are always long-term and are named as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Folder</th>
<th align=left width=64%>Entry identifier property</th>
</tr>
<tr valign=top>
<td width=36%>Outbox folder</td>
<td class=indent1 width=64%><a href="propa_9q90.htm">PR_IPM_OUTBOX_ENTRYID</a> (IPM message class only)</td>
</tr>
<tr valign=top>
<td width=36%>Deleted Items folder</td>
<td class=indent1 width=64%><a href="propa_3qxw.htm">PR_IPM_WASTEBASKET_ENTRYID</a> </td>
</tr>
<tr valign=top>
<td width=36%>Sent Items folder</td>
<td class=indent1 width=64%><a href="propa_1e78.htm">PR_IPM_SENTMAIL_ENTRYID</a></td>
</tr>
<tr valign=top>
<td width=36%>IPM root folder</td>
<td class=indent1 width=64%><a href="propa_7tb8.htm">PR_IPM_SUBTREE_ENTRYID</a> </td>
</tr>
<tr valign=top>
<td width=36%>Search-results root folder</td>
<td class=indent1 width=64%><a href="propa_3gro.htm">PR_FINDER_ENTRYID</a></td>
</tr>
<tr valign=top>
<td width=36%>Common views root folder</td>
<td class=indent1 width=64%><a href="propa_4ias.htm">PR_COMMON_VIEWS_ENTRYID</a> </td>
</tr>
<tr valign=top>
<td width=36%>Personal views root folder</td>
<td class=indent1 width=64%><a href="propb_4lk4.htm">PR_VIEWS_ENTRYID</a></td>
</tr>
</table><br>
<p>
Before you try to retrieve one of these special entry identifiers, retrieve the <a href="propb_0zzf.htm">PR_VALID_FOLDER_MASK</a> property of the message store. PR_VALID_FOLDER_MASK is a bitmask that identifies which of the special entry identifiers exist. There is one bit for each of the special folders. If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier. For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER_IPM_WASTEBASKET_VALID bit will be set in PR_VALID_FOLDER_MASK. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open the folder where all incoming messages of a particular class are placed</h5>
<ol>
<li>
Call <a href="inter031_7acy.htm"><b>IMsgStore::GetReceiveFolder</b></a> to retrieve its entry identifier, setting the <i>lpszMessageClass</i> parameter to point to a character string identifying the message class. <p>
For example, if you want to open the Inbox for your IPM subtree, point <i>lpszMessageClass</i> to IPM. If you want to open the receive folder for IPC messages, set it to point to IPC. If there is no registered receive folder for the message class, <b>GetReceiveFolder</b> chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in. See <a href="extend_8ygj.htm">Receive Folders</a> for more information. 
<p>
Note that the <a href="propa_9q90.htm">PR_IPM_OUTBOX_ENTRYID</a> property is used to open the Outbox folder only for IPM messages. If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder. Both incoming and outgoing IPC messages are placed in the receive folder.
</li>
<li>
Call one of four <b>OpenEntry</b> methods to open the folder and return an interface pointer that you can use to access it. You can call any one of the following methods to open a folder:<p>
<a href="inter023_146x.htm"><b>IMAPISession::OpenEntry</b></a>
<p>
<a href="inter032_8ry1.htm"><b>IMSLogon::OpenEntry</b></a>
<p>
<a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a>
<p>
<a href="inter011_02yh.htm"><b>IMAPIContainer::OpenEntry</b></a>
<p>
The specific method that you choose depends on the folder to be opened and the objects that are available at the time. Because the <b>IMAPISession</b> method can open any folder for any message store in the current profile, call this <b>OpenEntry</b> when you do not know anything about the folder to be opened. 
<p>
If you know which message store owns the folder and you have a pointer to the message store, call <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a>. For example, use the <b>IMsgStore</b> method to open a receive folder. If you have a pointer to the message store provider's logon object, call <a href="inter032_8ry1.htm"><b>IMSLogon::OpenEntry</b></a>. Because these calls go directly to the message store provider rather than through MAPI, processing is faster. 
<p>
If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's <a href="inter011_02yh.htm"><b>IMAPIContainer::OpenEntry</b></a> method. The <b>IMAPIContainer</b> method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.
</li>
<li>
If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI_BEST_ACCESS or MAPI_MODIFY flag in the <b>OpenEntry</b> call. <p>
These flags are suggestions to the message store provider to grant the highest level of access, for MAPI_BEST_ACCESS, or read/write access, for MAPI_MODIFY, when opening the folder. Because these flags are only suggestions, the folder may or may not be opened with the access level you expect. By retrieving the <a href="propa_63eb.htm">PR_ACCESS</a> property, you can determine the range of operations that can be performed on the open folder. However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming. An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
