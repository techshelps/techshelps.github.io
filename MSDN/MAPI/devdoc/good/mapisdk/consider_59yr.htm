<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Administering Profiles and Message Services</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_administering_profiles_and_message_services"></a>Administering Profiles and Message Services</h1>
<p>
Profile and message service administration can involve creating new profiles, deleting old profiles, and modifying the contents of existing profiles by changing the message services and service providers contained within them. Not all clients support profile and message service administration as standard features. Some clients have nothing more to do with profiles than allow their users to select one at logon time. </p>
<p>
If you support profile or message service administration, chances are you will use the following interfaces that are implemented by MAPI:
<ul>
<li>
<a href="inter030_7bxq.htm"><b>IMsgServiceAdmin</b></a> to administer a message service in a profile, accessable through either <a href="inter023_6uk3.htm"><b>IMAPISession::AdminServices</b></a><b> </b>or <a href="inter035_1h6b.htm"><b>IProfAdmin::AdminServices</b></a>. Messaging clients typically call <b>IMAPISession</b> while configuration clients, or clients that do not send or receive messages, call <b>IProfAdmin</b>. Whenever possible, call the <b>IProfAdmin</b> method because it does not cause the message service to be started.<p>
For more information about using the <b>IMsgServiceAdmin</b> interface, see the following topics:
<p>
<a href="consider_27qd.htm">Configuring a Message Service</a>
<p>
<a href="consider_7fz9.htm">Copying a Message Service</a>
<p>
<a href="consider_1aqt.htm">Deleting a Message Service</a>
</li>
<li>
<a href="inter035_46y6.htm"><b>IProfAdmin</b></a> to administer a profile, accessable through the <a href="function_9jg3.htm"><b>MAPIAdminProfiles</b></a> function. <p>
For more information about using the <b>IProfAdmin</b> interface, see the following topics:
<p>
<a href="consider_9kyt.htm">Creating a Profile with Custom Code</a>
<p>
<a href="consider_3xt1.htm">Copying a Profile</a>
<p>
<a href="consider_52sl.htm">Deleting a Profile</a>
<p>
<a href="consider_9hd1.htm">Finding a Profile Name</a>
<p>
<a href="consider_3so5.htm">Setting a Default Profile</a>
</li>
<li>
<a href="inter036_11v4.htm"><b>IProfSect</b></a> to maintain the properties in a profile section, accessable through the <a href="inter023_4ofi.htm"><b>IMAPISession::OpenProfileSection</b></a> or <a href="inter038_5oku.htm"><b>IProviderAdmin::OpenProfileSection</b></a> method. <p>
For more information about profile sections, see <a href="extend_4fxv.htm">Profiles</a>.
</li>
<li>
<a href="inter038_7vla.htm"><b>IProviderAdmin</b></a> to administer the service providers in a message service, accessable through <a href="inter030_2yur.htm"><b>IMsgServiceAdmin::AdminProviders</b></a>.<p>
For more information about using the <b>IProviderAdmin</b> interface, see <a href="consider_97dx.htm">Adding or Deleting Providers in a Message Service</a>.
</li>
</ul>
<p>
Be careful in your support of profile and message service administration. There are no safeguards to protect against adversely modifying a profile that is in use. MAPI can prevent you from deleting a profile in use, but cannot prevent you from deleting every message service in it. If you delete every message service in a profile, all of the service providers in these services will stop thereby causing unpredictable results to occur.</p>
<p>
<b>Note</b>  If your client must run unattended, perhaps as a background application or a Windows NT service, some special cautions apply. For more information, see <a href="consider_7sdw.htm">Writing an Automated Client</a> and <a href="intro_2qnn.htm">Windows NT Service Client Applications</a>.</p>
<p>&nbsp;</p></body>
</HTML>
