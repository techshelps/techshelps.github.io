<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIContainer::GetHierarchyTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapicontainer_gethierarchytable"></a>IMAPIContainer::GetHierarchyTable</h2>
<p>
The <b>IMAPIContainer::GetHierarchyTable</b> method returns a pointer to the container's hierarchy table.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter011_7u0g.htm"><b>IMAPIContainer : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT GetHierarchyTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how information is returned in the table. The following flags can be set:
<dl>
<dt>
CONVENIENT_DEPTH</dt>
<dd>
Fills the hierarchy table with containers from multiple levels. If CONVENIENT_DEPTH is not set, the hierarchy table contains only the container's immediate child containers.</dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
<b>GetHierarchyTable</b> can return successfully, possibly before the table is made accessible to the caller. If the table is not accessible, making a subsequent table call can result in an error.</dd>
<dt>
MAPI_UNICODE</dt>
<dd>
Requests that the columns containing string data be returned in Unicode format. If the MAPI_UNICODE flag is not set, the strings should be returned in ANSI format. </dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the hierarchy table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The hierarchy table was successfully retrieved.</dd>
<dt>
MAPI_E_BAD_CHARWIDTH</dt>
<dd>
Either the MAPI_UNICODE flag was set and the implementation does not support Unicode, or MAPI_UNICODE was not set and the implementation only supports Unicode.</dd>
<dt>
MAPI_E_NO_SUPPORT</dt>
<dd>
The container has no child containers and cannot provide a hierarchy table.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIContainer::GetHierarchyTable</b> method returns a pointer to the hierarchy table of a container. A hierarchy table holds summary information about the child containers within the container. Folder hierarchy tables hold information about child folders; address book hierarchy tables hold information about child address book containers and distribution lists.</p>
<p>
It is possible for some containers to have no child containers. These containers return MAPI_E_NO_SUPPORT from their implementations of <b>GetHierarchyTable</b>.</p>
<p>
When the CONVENIENT_DEPTH flag is set, each row in the hierarchy table also includes the <a href="propa_8xk8.htm">PR_DEPTH</a> property as a column. PR_DEPTH indicates the level of each container relative to the container implementing the table. The implementing container's immediate child containers are at depth zero, child containers within the zero depth containers are at depth one, and so on. The values of PR_DEPTH increase sequentially as the hierarchy of levels deepens.</p>
<p>
For a complete list of required and optional columns in hierarchy tables, see <a href="tables_5c1f.htm">Hierarchy Tables</a>.</p>
<h4>Notes to Implementers</h4>
<p>
If you support a hierarchy table for your container, you must also:
<ul>
<li>
Support a call to the container's <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method to open the <a href="propa_13sp.htm">PR_CONTAINER_HIERARCHY</a> property.</li>
<li>
Return PR_CONTAINER_HIERARCHY from a call to the container's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> or <a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a> method.</li>
</ul>
<h4>Notes to Callers</h4>
<p>
String and binary contents table columns can be truncated. Typically, providers return 255 characters. Because you cannot know ahead of time whether or not a table includes truncated columns, assume that a column is truncated if the length of the column is either 255 or 510 bytes. You can always retrieve the full value of a truncated column if necessary from the object directly by using its entry identifier to open it and then calling the <b>IMAPIProp::GetProps</b> method.</p>
<p>
Depending on the provider's implementation, restrictions and sorting operations can apply to an entire string or to the truncated version of that string.</p>
<h4>See Also</h4>
<p>
<a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a>, <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a>, <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>, <a href="propa_13sp.htm">PR_CONTAINER_HIERARCHY</a></p>
<p>&nbsp;</p></body>
</HTML>
