<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMsgStore::FinishedMsg</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imsgstore_finishedmsg"></a>IMsgStore::FinishedMsg</h2>
<p>
The <b>IMsgStore::FinishedMsg</b> method enables the message store provider to perform processing on a sent message. This method is called only by the MAPI spooler.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter031_1jg0.htm"><b>IMsgStore : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT FinishedMsg(
  ULONG</b><i> ulFlags</i><b>,</b>       
<b>  ULONG</b><i> cbEntryID</i><b>,</b>     
<b>  LPENTRYID</b><i> lpEntryID  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>cbEntryID</i></dt>
<dd>
[in] Count of bytes in the entry identifier pointed to by the <i>lpEntryID</i> parameter.</dd>
<dt>
<i>lpEntryID</i></dt>
<dd>
[in] Pointer to the entry identifier of the message to be processed.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Processing on the sent message was successful.</dd>
<dt>
MAPI_E_NO_SUPPORT</dt>
<dd>
The message store provider does not support sent message processing. This error value is returned if the caller is not the MAPI spooler.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMsgStore::FinishedMsg</b> method performs processing on a sent message. This processing can involve deleting the message, moving it to a different folder, or both actions. The type of processing depends on whether or not the <a href="propa_57zo.htm">PR_DELETE_AFTER_SUBMIT</a> and <a href="propb_4s2s.htm">PR_SENTMAIL_ENTRYID</a> properties are set. </p>
<h4>Notes to Implementers</h4>
<p>
In your implementation of <b>FinishedMsg</b>, unlock the message identified by <i>lpEntryID</i> and perform the appropriate processing. The target message will always be locked; the MAPI spooler never passes the entry identifier for an unlocked message to <b>FinishedMsg</b>.</p>
<p>
It is possible that neither of these properties are set, both are set, or one or the other is set. The following table describes the action you should take based on the settings:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>If neither property is set:</td>
<td width=52%>Leave the message in the folder from which it was sent (typically the Outbox).</td>
</tr>
<tr valign=top>
<td width=48%>If both properties are set: </td>
<td width=52%>Move the message to the indicated folder, if desired, and then delete it.</td>
</tr>
<tr valign=top>
<td width=48%>If PR_SENTMAIL_ENTRYID is set:</td>
<td width=52%>Move the message to the indicated folder.</td>
</tr>
<tr valign=top>
<td width=48%>If PR_DELETE_AFTER_SUBMIT is set:</td>
<td width=52%>Delete the message.</td>
</tr>
</table><br>
<p>
After you have taken whatever action is appropriate, call <a href="inter025_19d8.htm"><b>IMAPISupport::DoSentMail</b></a>.</p>
<h4>See Also</h4>
<p>
<a href="inter025_19d8.htm"><b>IMAPISupport::DoSentMail</b></a></p>
<p>&nbsp;</p></body>
</HTML>
