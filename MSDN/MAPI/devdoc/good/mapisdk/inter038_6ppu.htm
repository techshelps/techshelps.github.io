<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IProviderAdmin::CreateProvider</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iprovideradmin_createprovider"></a>IProviderAdmin::CreateProvider</h2>
<p>
The <b>IProviderAdmin::CreateProvider</b> method adds a service provider to the message service. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter038_7vla.htm"><b>IProviderAdmin : IUnknown</b></a>.</p>
<pre><code><b>HRESULT CreateProvider(
  LPTSTR</b><i> lpszProvider</i><b>,</b>   
<b>  ULONG</b><i> cValues</i><b>,</b>         
<b>  LPSPropValue</b><i> lpProps</i><b>,</b>  
<b>  ULONG</b><i> ulUIParam</i><b>,</b>       
<b>  ULONG</b><i> ulFlags</i><b>,</b>         
<b>  MAPIUID FAR *</b><i> lpUID    </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszProvider</i></dt>
<dd>
[in] Pointer to the name of the provider to add.</dd>
<dt>
<i>cValues</i></dt>
<dd>
[in] Count of property values pointed to by the <i>lpProps</i> parameter.</dd>
<dt>
<i>lpProps</i></dt>
<dd>
[in] Pointer to an property value array describing<b> </b>the properties of the provider to add.</dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for any dialog boxes or windows this method displays. The <i>ulUIParam </i>parameter is used if the MAPI_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the provider addition. The following flags can be set:
<dl>
<dt>
MAPI_DIALOG</dt>
<dd>
Allows the display of a dialog box to prompt for configuration information.</dd>
<dt>
MAPI_UNICODE</dt>
<dd>
The provider name and string properties are in Unicode format. If the MAPI_UNICODE flag is not set, these strings are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lpUID</i></dt>
<dd>
[out] Pointer to the <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> structure holding the unique identifier representing the provider to add.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The provider was successfully added to the message service.</dd>
<dt>
MAPI_E_USER_CANCEL</dt>
<dd>
The user canceled the operation, typically by clicking the <b>Cancel</b> button in a dialog box.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IProviderAdmin::CreateProvider</b> method adds a service provider to the message service. The <i>lpszProvider</i> parameter must point to the name of a provider that belongs to the message service. <b>CreateProvider</b> does not verify that the name matches the name of a provider in the service; if the passed name doesn't match a service name, the call succeeds, but the results are unpredictable. Most message services do not allow providers to be added or deleted while the profile is in use. </p>
<p>
After all of the available information about the service provider has been added to the profile from the MAPISVC.INF file, <b>CreateProvider</b> calls the message service's entry point function with the <i>ulContext</i> parameter set to MSG_SERVICE_PROVIDER_CREATE. If MAPI_DIALOG is set in the <b>CreateProvider </b>method's <i>ulFlags</i> parameter, then the values in the <i>ulUIParam</i> and <i>ulFlags</i> parameters are also passed to the entry point function. These additional parameters allow the service provider to display its property sheet so that the user can enter configuration settings.</p>
<h4>See Also</h4>
<p>
<a href="structyp_3p9g.htm"><b>MAPIUID</b></a>, <a href="function_7nnd.htm"><b>MSGSERVICEENTRY</b></a>, <a href="structyp_9sbp.htm"><b>SPropValue</b></a></p>
<p>&nbsp;</p></body>
</HTML>
