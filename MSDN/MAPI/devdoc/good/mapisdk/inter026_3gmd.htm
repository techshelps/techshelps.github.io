<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPITable::SortTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapitable_sorttable"></a>IMAPITable::SortTable</h2>
<p>
The <b>IMAPITable::SortTable</b> method orders the rows of the table based on sort criteria.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>.</p>
<pre><code><b>HRESULT SortTable(
  LPSSortOrderSet</b><i> lpSortCriteria</i><b>,</b>   
<b>  ULONG</b><i> ulFlags                     </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpSortCriteria</i></dt>
<dd>
[in] Pointer to an <a href="structyp_7y2c.htm"><b>SSortOrderSet</b></a> structure containing the sort criteria to apply. Passing an <b>SSortOrderSet</b> structure containing zero columns indicates that the table does not need to be sorted in any particular order.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the timing of the <b>IMAPITable::SortTable</b> operation. The following flags can be set:
<dl>
<dt>
TBL_ASYNC</dt>
<dd>
Starts the operation asynchronously and returns before the operation completes.</dd>
<dt>
TBL_BATCH</dt>
<dd>
Defers the completion of the sort until the data in the table is required.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The sort operation was successful.</dd>
<dt>
MAPI_E_BUSY</dt>
<dd>
Another operation is in progress that prevents the sort operation from starting. Either the operation in progress should be allowed to complete or it should be stopped.</dd>
<dt>
MAPI_E_NO_SUPPORT</dt>
<dd>
The table does not support the type of sorting requested.</dd>
<dt>
MAPI_E_TOO_COMPLEX</dt>
<dd>
The table cannot perform the operation because the particular sort criteria pointed to by the <i>lpSortCriteria</i> parameter is too complicated. <b>SortTable</b> can return MAPI_E_TOO_COMPLEX when:
<ul>
<li>
A sort operation is requested for a property column that the implementation cannot sort.</li>
<li>
The implementation does not support the sort order requested in the <b>ulOrder </b>member of the <b>SSortOrderSet</b> structure.</li>
<li>
The number of columns to be sorted, as specified in the <b>cSorts </b>member in <b>SSortOrderSet</b>, is larger than the implementation can handle.</li>
<li>
A sort operation is requested, as indicated by a property tag in <b>SSortOrderSet</b>, based on a property that is not in the available or active set and the implementation does not support sorting on properties not in the available set.</li>
<li>
One property is specified multiple times in a sort order set, as indicated by multiple instances of the same property tag, and the implementation cannot perform such a sort operation.</li>
<li>
A sort operation based on multivalued property columns is requested using MVI_FLAG and the implementation does not support sorting on multivalued properties. </li>
<li>
A property tag for a property in <b>SSortOrderSet </b>specifies a property or type that the implementation does not support.</li>
<li>
A sort operation other than one that proceeds through the table from the <a href="propb_8uni.htm">PR_RENDERING_POSITION</a> property forward is specified only for an attachment table that supports this type of sorting.</li>
</ul>
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPITable::SortTable</b> method orders the rows in a table view. Whereas some tables support both standard and categorized sorting on a variety of sort key columns, other tables are more limited in their support. Address book providers commonly do not support table sorting. Message store providers commonly support sorting to the extent that they retain the sort order of folders that results when a full table — that is, a table with no restrictions — is sorted. </p>
<p>
Some tables allow sorting to be done on any table column. Other tables do not; columns not included in the table view are unaffected by a <b>SortOrder </b>call. Some tables require that sort keys be built only with columns in the table's current column set. </p>
<p>
A table will return either MAPI_E_NO_SUPPORT or MAPI_E_TOO_COMPLEX from <b>SortTable</b> when it cannot complete a sort operation for whatever reason.</p>
<p>
When there are zero columns in the <a href="structyp_7y2c.htm"><b>SSortOrderSet</b></a> structure pointed to by the <i>lpSortCriteria</i> parameter, the table returns the current column set. The current sort order can be retrieved by calling the table's <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> method.</p>
<p>
All bookmarks for a table are invalidated and should be deleted when a call to <b>SortTable</b> is made, and the BOOKMARK_CURRENT bookmark, indicating the current cursor position, should be set to the beginning of the table.</p>
<p>
If sorting on a column containing a multivalued property without the MVI_FLAG flag set, the column's values are treated as a totally ordered tuple. A comparison of two multivalued columns compares the column elements in order, reporting the relation of the columns at the first inequality, and returns equality only if the columns compared contain the same values in the same order. If one column has fewer values than the other, the reported relation is that of a null value to the other value.</p>
<h4>Notes to Callers</h4>
<p>
<b>SortTable </b>operates synchronously unless you set one of the flags. If you set the TBL_BATCH flag, <b>SortTable</b> postpones the sort operation unless you request the data. If the TBL_ASYNC flag is set, <b>SortTable </b>operates asynchronously, potentially returning before the completion of the operation.</p>
<p>
Call the <a href="inter026_2a5w.htm"><b>IMAPITable::Abort</b></a> method to stop an asynchronous operation in progress if your sort must be done immediately. If <b>SortTable</b> cannot proceed because one or more asynchronous operations on the table are in progress, it returns MAPI_E_BUSY.</p>
<p>
For best performance, call <b>SetColumns</b> to customize the table's column set and <b>Restrict</b> to limit the number of rows in the table before calling <b>SortTable</b> to perform the sort. </p>
<p>
Whenever <b>SortTable</b> fails, the sort order that was in effect before the failure is still in effect. </p>
<h4>See Also</h4>
<p>
<a href="inter026_2a5w.htm"><b>IMAPITable::Abort</b></a>, <a href="inter026_5tkk.htm"><b>IMAPITable::GetRowCount</b></a>, <a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a>, <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a>, <a href="inter026_7x83.htm"><b>IMAPITable::SetColumns</b></a>, <a href="structyp_7y2c.htm"><b>SSortOrderSet</b></a></p>
<p>&nbsp;</p></body>
</HTML>
