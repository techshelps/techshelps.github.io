<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Structure of Message Store Providers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_structure_of_message_store_providers"></a>Structure of Message Store Providers</h2>
<p>
A message store provider, when it is running in memory, is an <a href="inter033_42pa.htm"><b>IMSProvider : IUnknown</b></a> object. The <b>IMSProvider</b> interface allows client applications and the MAPI spooler to log on to and off of the message store. The objects that client applications and the MAPI spooler use to access folders and messages in the message store are an <a href="inter032_5032.htm"><b>IMSLogon</b></a> object and an <a href="inter031_1jg0.htm"><b>IMsgStore</b></a> object. These objects are typically created when the message store is first logged on to, although the message store DLL's <a href="function_7zxw.htm"><b>MSProviderInit</b></a> entry point could also create them.</p>
<p>
Because the <b>IMSLogon</b> and <b>IMsgStore</b> interfaces share some methods, it may be easier to create one class object that inherits from both of these interfaces. You can also implement these interfaces in separate objects, and write helper functions internal to your DLL that implement the shared methods which can then be called from the methods in the <b>IMSLogon</b> and <b>IMsgStore</b> interfaces.</p>
<p>
The following illustration shows a high-level outline of the object hierarchy within a running message store.</p>
<p>
<img src="images/storeobj.gif" border=0></p>
<p>&nbsp;</p></body>
</HTML>
