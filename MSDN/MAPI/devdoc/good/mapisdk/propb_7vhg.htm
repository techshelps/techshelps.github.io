<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PR_RTF_COMPRESSED</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_pr_rtf_compressed"></a>PR_RTF_COMPRESSED</h2>
<p>
The PR_RTF_COMPRESSED property contains the Rich Text Format version of the message text, usually in compressed form. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file:</td>
<td width=57%>MAPITAGS.H</td>
</tr>
<tr valign=top>
<td width=43%>May be exposed by:</td>
<td width=57%>Message objects</td>
</tr>
<tr valign=top>
<td width=43%>Identifier:</td>
<td width=57%>0x1009</td>
</tr>
<tr valign=top>
<td width=43%>Property type:</td>
<td width=57%>PT_BINARY</td>
</tr>
<tr valign=top>
<td width=43%>Property tag:</td>
<td width=57%>0x10090102</td>
</tr>
</table><br>
<h4>Remarks </h4>
<p>
The PR_RTF_COMPRESSED property contains the same message text as the <a href="propa_9lvd.htm">PR_BODY</a> property but in Rich Text Format (RTF). </p>
<p>
Message text in RTF is normally stored in compressed form. However, some systems do not compress formatted text. To accommodate them, MAPI provides the dwMagicUncompressedRTF value for a stream header to identify uncompressed RTF, and the STORE_UNCOMPRESSED_RTF flag in <a href="propb_01t7.htm">PR_STORE_SUPPORT_MASK</a> for the message store to indicate it can store uncompressed RTF. </p>
<p>
To obtain the contents of PR_RTF_COMPRESSED, call <b>OpenProperty</b>, then call <a href="function_8lv1.htm"><b>WrapCompressedRTFStream</b></a> with the MAPI_READ flag. To write into PR_RTF_COMPRESSED, open it with the MAPI_MODIFY and MAPI_CREATE flags. This ensures that the new data completely replace any old data and that the writes are performed using the minimum number of store updates. </p>
<p>
Message stores that support RTF ignore any changes to white space in the message text. When PR_BODY is stored for the first time, the message store also generates and stores PR_RTF_COMPRESSED. If the <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method is subsequently called and PR_BODY has been modified, the message store calls the <a href="function_4yg3.htm"><b>RTFSync</b></a> function to ensure synchronization with the RTF version. If only white space has been changed, the properties are left unchanged. This preserves any nontrivial RTF formatting when the message travels through non-RTF-aware clients and messaging systems. </p>
<h4>See Also</h4>
<p>
<a href="groups_31df.htm">Rich Text Properties</a> </p>
<p>&nbsp;</p></body>
</HTML>
