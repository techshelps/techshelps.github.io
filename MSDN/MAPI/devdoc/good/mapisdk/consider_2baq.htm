<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Transport Order</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_setting_transport_order"></a>Setting Transport Order</h2>
<p>
The MAPI spooler assigns responsibility for outgoing messages based on the address types and identifiers that transport providers declare they can handle. Transport providers publish a list of supported address types and identifiers — stored in <b>MAPIUID </b>structures — when MAPI calls their <a href="inter042_0xbn.htm"><b>IXPLogon::AddressTypes</b></a> method, directly after logon. A recipient's address type is stored in its <a href="propa_4gkl.htm">PR_ADDRTYPE</a> property. </p>
<p>
Registering for an address type indicates to MAPI that the transport provider can deliver to recipients with their PR_ADDRTYPE property set to the registered address type. Similarly, registering for a <b>MAPIUID</b> indicates that the transport provider can deliver to recipients that are represented by entry identifiers with the registered <b>MAPIUID</b>.</p>
<p>
Most transport providers register for one or more address types; few register by <b>MAPIUID</b>. Transport providers that are tightly coupled with an address book provider and understand its entry identifier format can register to handle messages by <b>MAPIUID</b>, thereby improving performance. These tightly coupled transport providers can extract the recipient's e-mail address and other necessary information from the entry identifier without having to open it with an <b>IMAPISupport::OpenEntry</b> call.</p>
<p>
MAPI maintains an order for transport providers, used when multiple transport providers have registered for the same address type or <b>MAPIUID</b>. You can override this order by:
<ul>
<li>
Calling <a href="inter030_0ysy.htm"><b>IMsgServiceAdmin::MsgServiceTransportOrder</b></a> and passing an ordered list of the <b>MAPIUID</b>s of all of the active transport providers pointed to by the <i>lpUIDList</i> parameter.</li>
<li>
Using the <b>Delivery</b> property page of the Control Panel applet.</li>
</ul>
<p>
To retrieve a list of all of the address types that can be handled by one of the active transport providers, call <a href="inter023_7t0z.htm"><b>IMAPISession::EnumAdrTypes</b></a>. <b>EnumAdrTypes</b> returns an array of strings that describes address types supported by the transport providers that are active in the current session.</p>
<p>&nbsp;</p></body>
</HTML>
