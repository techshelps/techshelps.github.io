<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PR_TNEF_CORRELATION_KEY</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_pr_tnef_correlation_key"></a>PR_TNEF_CORRELATION_KEY</h2>
<p>
The PR_TNEF_CORRELATION_KEY property contains a value used to correlate a TNEF attachment with a message.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file:</td>
<td width=57%>MAPITAGS.H</td>
</tr>
<tr valign=top>
<td width=43%>May be exposed by:</td>
<td width=57%>TNEF attachment subobjects</td>
</tr>
<tr valign=top>
<td width=43%>Identifier:</td>
<td width=57%>0x007F</td>
</tr>
<tr valign=top>
<td width=43%>Property type:</td>
<td width=57%>PT_BINARY</td>
</tr>
<tr valign=top>
<td width=43%>Property tag:</td>
<td width=57%>0x007F0102</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
It is recommended that TNEF attachment subobjects expose the PR_TNEF_CORRELATION_KEY property. This property determines whether or not an inbound TNEF file belongs to the message it is attached to. It is used primarily by transport providers and gateways.</p>
<p>
On an outbound message, the transport provider should compute a binary value unique to that message, or use an existing value that satisfies the uniqueness requirement, such as a message identifier. The transport provider should store this value in PR_TNEF_CORRELATION_KEY and then call the <a href="inter041_267n.htm"><b>ITnef::AddProps</b></a> method to encapsulate it. The same value should also be stored in the transport envelope in a place defined by the provider, such as the message header.</p>
<p>
On an inbound message, the transport provider should call the <a href="inter041_44c3.htm"><b>ITnef::ExtractProps</b></a> method to decapsulate the TNEF attachment and then compare PR_TNEF_CORRELATION_KEY with the value stored in the transport envelope. If the values match, TNEF should be processed normally, that is, all the properties extracted from the TNEF attachment should be used. If the values do not match, all the properties from the TNEF attachment should be ignored. If PR_TNEF_CORRELATION_KEY is not set, the TNEF file should be considered to belong to this message, and the other properties extracted from it should be used.</p>
<h4>See Also</h4>
<p>
<a href="groups_6reb.htm">Attachment Properties</a> </p>
<p>&nbsp;</p></body>
</HTML>
