<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>cmc_logoff</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_cmc_logoff"></a>cmc_logoff</h2>
<p>
The <b>cmc_logoff</b> function logs a client application off a message service.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>XCMC.H</td>
</tr>
</table><br>
<pre><code><b>CMC_return_code cmc_logoff (
  CMC_session_id</b><i> session</i><b>,</b>                
<b>  CMC_ui_id</b><i> ui_id</i><b>,</b>                       
<b>  CMC_flags</b><i> logoff_flags</i><b>,</b>                
<b>  CMC_extension FAR *</b><i> logoff_extensions  </i>
<b>)</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>session</i></dt>
<dd>
[in] Opaque session handle that represents a MAPI session object indicating a session with a message service. If the session handle is invalid, the <b>cmc_logoff</b> function returns <small>cmc_e_invalid_session_id</small>. After <b>cmc_logoff</b> returns, the session handle is invalid. </dd>
<dt>
<i>ui_id </i></dt>
<dd>
[in] Handle of a dialog box for <b>cmc_logoff</b> to present to help resolve processing questions.</dd>
<dt>
<i>logoff_flags</i></dt>
<dd>
[in] Bitmask of flags. The following flags can be set:
<dl>
<dt>
CMC_ERROR_UI_ALLOWED</dt>
<dd>
Displays a dialog box on encountering recoverable errors. If this flag is not set, <b>cmc_logoff</b> does not display a dialog box and returns an error value instead.</dd>
<dt>
CMC_LOGOFF_UI_ALLOWED</dt>
<dd>
Indicates <b>cmc_logoff</b> can display a dialog box for other purposes than displaying error messages while logging the user off from the session.</dd>
</dl>
</dd>
<dt>
<i>logoff_extensions </i></dt>
<dd>
[in, out] Pointer to an array of <a href="cmcref_1woe.htm"><b>CMC_extension</b></a> structures containing function extensions. On input, this array contains MAPI extensions to the standard <b>cmc_logoff</b> function. A value of NULL for the <i>logoff_extensions </i>parameter indicates that the client application has no extensions for <b>cmc_logoff</b> and is expecting no extensions. 
<p>
On output, <b>cmc_logoff</b> writes to the array new information about the logoff operation. It writes NULL if it generates no output extensions.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
CMC_E_FAILURE</dt>
<dd>
There was a general failure that does not fit the description of any other return value.</dd>
<dt>
CMC_E_INSUFFICIENT_MEMORY</dt>
<dd>
Insufficient memory was available to complete the requested operation.</dd>
<dt>
CMC_E_INVALID_FLAG</dt>
<dd>
A flag set using a flags parameter was invalid.</dd>
<dt>
CMC_E_INVALID_PARAMETER</dt>
<dd>
A function parameter was invalid. </dd>
<dt>
CMC_E_INVALID_SESSION_ID</dt>
<dd>
The specified session handle is invalid or no longer valid — for example, after logging off.</dd>
<dt>
CMC_E_INVALID_UI_ID</dt>
<dd>
The specified user-interface identifier is invalid or no longer valid.</dd>
<dt>
CMC_E_UNSUPPORTED_FLAG</dt>
<dd>
The flag requested is not supported.</dd>
<dt>
CMC_E_UNSUPPORTED_FUNCTION_EXT</dt>
<dd>
The function extension requested is not supported.</dd>
<dt>
CMC_E_USER_NOT_LOGGED_ON</dt>
<dd>
The user was not logged on and the CMC_LOGON_UI_ALLOWED flag was not set.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="cmcref_1woe.htm"><b>CMC_extension</b></a></p>
<p>&nbsp;</p></body>
</HTML>
