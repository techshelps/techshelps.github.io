<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPISendMail (VB)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_mapisendmail_vb_"></a>MAPISendMail (VB)</h2>
<p>
The Visual Basic <b>MAPISendMail</b> function sends a standard message.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIVB32.BAS</td>
</tr>
</table><br>
<p>
<b>MAPISendMail</b>(</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Session</i> as <b>Long,</b>.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>UIParam</i> as <b>Long</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Message</i> as <b>MapiMessage</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Recips</i> as <b>MapiRecip</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Files</i> as <b>MapiFile</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Flags</i> as <b>Long,</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Reserved</i> as <b>Long</b>) as <b>Long</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>Session</i></dt>
<dd>
[in] Session handle that represents a Simple MAPI session or zero. If the value of the <i>Session</i> parameter is zero, MAPI logs on the user and creates a session that exists only for the duration of the call. This temporary session can be an existing shared session or a new one. If necessary, a logon dialog box is displayed. </dd>
<dt>
<i>UIParam</i></dt>
<dd>
The parent window handle for the dialog box. A value of zero indicates that any dialog box displayed is application modal.</dd>
<dt>
<i>Message</i></dt>
<dd>
[in] The message to be sent. An empty string indicates no text. Each paragraph should be terminated with either a carriage return (0x0d), a line feed (0x0a), or a carriage return–line feed pair (0x0d0a). The implementation wraps lines as appropriate. Implementations can place limits on the size of the text. The MAPI_E_TEXT_TOO_LARGE value is returned if this limit is exceeded. Client applications can set MAPI_RECEIPT_REQUESTED in the <b>Flags</b> member in the <a href="smapiref_1iov.htm"><b>MapiMessage</b></a> type pointed to by the <i>Message</i> parameter to prompt for a read report.</dd>
<dt>
<i>Recips</i></dt>
<dd>
[in] The first element of an array of recipients. When the the value of the <b>RecipCount</b> member in the <a href="smapiref_7q3j.htm"><b>MapiRecip</b></a> type pointed to by the <i>Message</i> parameter is zero, the <i>Recips</i> parameter is ignored. The <i>Recips</i> parameter can include either an entry identifier, the recipient's name, an address, or a name and address pair. Depending on the type and amount of information passed, <b>MAPISendMail</b> will perform varied levels of name resolution. If an entry identifier in the <b>EntryID</b> member for a particular recipient is specified, <b>MAPISendMail</b> performs no lookup and ignores the name and address. If only a name is specified, <b>MAPISendMail</b> resolves the name to a valid address using name resolution rules defined by Simple MAPI. If only an address is specified, <b>MAPISendMail</b> uses this address for both message delivery and for displaying the recipient name; no name resolution occurs. If both a name and address are specified, again <b>MAPISendMail</b> does not resolve the name. The specified name is used as the display name and not for resolution. </dd>
<dt>
<i>Files</i></dt>
<dd>
[in] The first element of an array of attachment files written when the message is read. The number of attachments per message might be limited in some systems. If the limit is exceeded, the MAPI_E_TOO_MANY_FILES value is returned. When the value of the <b>FileCount</b> member in the <a href="smapiref_1iov.htm"><b>MapiMessage</b></a> type pointed to by the <i>Message</i> parameter is zero, the <i>Files</i> parameter is ignored. Attachment files are read and attached to the message before the call returns. Do not attempt to display attachments outside the range of the message text.</dd>
<dt>
<i>Flags</i></dt>
<dd>
[in] Bitmask of option flags. The following flags can be set:
<dl>
<dt>
MAPI_DIALOG</dt>
<dd>
A dialog box should be displayed to prompt the user for recipients and other sending options. Set the MAPI_LOGON_UI flag if <b>MAPISendMail</b> should display a dialog box to prompt the user to log on. When this flag is not set, <b>MAPISendMail</b> does not display a dialog box and returns a message if the user is not logged on.</dd>
<dt>
MAPI_LOGON_UI</dt>
<dd>
A dialog box should be displayed to prompt the user to log on if required. When the MAPI_LOGON_UI flag is not set, the client application does not display a logon dialog box and returns an error value if the user is not logged on. <b>MAPISaveMail</b> ignores this flag if the <i>MessageID</i> parameter is empty.</dd>
<dt>
MAPI_NEW_SESSION</dt>
<dd>
An attempt should be made to create a new session rather than acquire the environment's shared session. If the MAPI_NEW_SESSION flag is not set, <b>MAPISendMail</b> uses an existing shared session.</dd>
</dl>
</dd>
<dt>
<i>Reserved</i></dt>
<dd>
Reserved; must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MAPI_E_AMBIGUOUS_RECIPIENT</dt>
<dd>
A recipient matched more than one of the recipient descriptor structures and MAPI_DIALOG was not set. No message was sent.</dd>
<dt>
MAPI_E_ATTACHMENT_NOT_FOUND</dt>
<dd>
The specified attachment was not found. No message was sent.</dd>
<dt>
MAPI_E_ATTACHMENT_OPEN_FAILURE</dt>
<dd>
The specified attachment could not be opened. No message was sent.</dd>
<dt>
MAPI_E_FAILURE</dt>
<dd>
One or more unspecified errors occurred. No message was sent.</dd>
<dt>
MAPI_E_INSUFFICIENT_MEMORY</dt>
<dd>
There was insufficient memory to proceed. No message was sent.</dd>
<dt>
MAPI_E_LOGIN_FAILURE</dt>
<dd>
There was no default logon, and the user failed to log on successfully when the logon dialog box was displayed. No message was sent.</dd>
<dt>
MAPI_E_TEXT_TOO_LARGE</dt>
<dd>
The text in the message was too large. No message was sent.</dd>
<dt>
MAPI_E_TOO_MANY_FILES</dt>
<dd>
There were too many file attachments. No message was sent.</dd>
<dt>
MAPI_E_TOO_MANY_RECIPIENTS</dt>
<dd>
There were too many recipients. No message was sent.</dd>
<dt>
MAPI_E_UNKNOWN_RECIPIENT</dt>
<dd>
A recipient did not appear in the address list. No message was sent.</dd>
<dt>
MAPI_E_USER_ABORT</dt>
<dd>
The user canceled the process. No message was sent.</dd>
<dt>
SUCCESS_SUCCESS</dt>
<dd>
The call succeeded and the message was sent.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MAPISendMail</b> function sends a standard message, with or without any user interaction. If recipient names, file attachments, or message text is provided, <b>MAPISendMail</b> can send the files or note without prompting users. If the optional parameters are specified and a dialog box is requested by use of the MAPI_DIALOG flag, the parameters provide the initial values for the dialog box.</p>
<p>
File attachments are copied to the message before <b>MAPISendMail</b> returns; therefore, later changes to the files do not affect the contents of the message. The files must be closed when they are copied.</p>
<p>
<b>MAPISendMail</b> takes the recipients and file attachments from the <i>Recips</i> and <i>Files</i> parameters, which should each be the first element of dynamically allocated arrays of their respective types. These arrays are not redimensioned.</p>
<p>
All strings must be specified in the current character set or code page of the client application's operating system process. </p>
<p>
The declaration of this function for the 32-bit Visual Basic runtime is:</p>
<p>
<b>MAPISendMail(</b></p>
<p>
ByVal <i>Session</i>&amp;, <br>
ByVal <i>UIParam</i>&amp;, <br>
<i>message</i> As MAPIMessage, <br>
<i>Recipient</i>() As MapiRecip, <br>
<i>File</i>() As MapiFile, <br>
ByVal <i>Flags</i>&amp;, <br>
ByVal <i>Reserved</i>&amp;) <b>As Long</b></p>
<p>&nbsp;</p></body>
</HTML>
