<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISupport::OpenAddressBook</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisupport_openaddressbook"></a>IMAPISupport::OpenAddressBook</h2>
<p>
The <b>IMAPISupport::OpenAddressBook</b> method provides access to the address book.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter025_8uge.htm"><b>IMAPISupport : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OpenAddressBook(
  LPCIID</b><i> lpInterface</i><b>,</b>         
<b>  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPADRBOOK FAR *</b><i> lppAdrBook  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpInterface</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) representing the interface to be used to access the address book. Valid values are NULL, indicating the standard address book interface — <a href="inter006_23e8.htm"><b>IAddrBook</b></a> — and IID_IAddrBook.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lppAdrBook</i></dt>
<dd>
[out] Pointer to a pointer to the address book.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Access to the address book was provided.</dd>
<dt>
MAPI_W_ERRORS_RETURNED</dt>
<dd>
The call succeeded, but one or more address book providers could not be loaded. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISupport::OpenAddressBook</b> method is implemented for all service provider support objects. Service providers, typically tightly coupled message store and transport providers, call <b>OpenAddressBook</b> to get access to the address book. The returned <b>IAddrBook</b> pointer can be used for a variety of address book tasks, including opening address book containers, finding messaging users, and displaying address dialog boxes. </p>
<h4>Notes to Callers</h4>
<p>
<b>OpenAddressBook</b> can return MAPI_W_ERRORS_RETURNED if it cannot load one or more of the address book providers in the current profile. This value is a warning and you should treat the call as successful. Even if all of the address book providers failed to load, <b>OpenAddressBook</b> still succeeds, returning MAPI_W_ERRORS_RETURNED and an <b>IAddrBook</b> pointer in the <i>lppAdrBook</i> parameter. Because <b>OpenAddressBook</b> always returns a valid <b>IAddrBook</b> pointer, you must release it when you are finished using it.</p>
<p>
If one or more address book providers failed to load, call <a href="inter025_7q5u.htm"><b>IMAPISupport::GetLastError</b></a> to obtain a <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a> structure containing information about the providers that did not load. </p>
<h4>See Also</h4>
<p>
<a href="inter006_23e8.htm"><b>IAddrBook : IMAPIProp</b></a>, <a href="inter023_01ij.htm"><b>IMAPISession::OpenAddressBook</b></a></p>
<p>&nbsp;</p></body>
</HTML>
