<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISession::SetDefaultStore</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisession_setdefaultstore"></a>IMAPISession::SetDefaultStore</h2>
<p>
The <b>IMAPISession::SetDefaultStore</b> method establishes a message store as the default message store for the session.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter023_64ry.htm"><b>IMAPISession : IUnknown</b></a>.</p>
<pre><code><b>HRESULT SetDefaultStore(
  ULONG</b><i> ulFlags</i><b>,</b>       
<b>  ULONG</b><i> cbEntryID</i><b>,</b>     
<b>  LPENTRYID</b><i> lpEntryID  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the setting of the default message store. These flags are mutually exclusive; only one of the following flags can be set:
<dl>
<dt>
MAPI_DEFAULT_STORE</dt>
<dd>
Establishes the message store as the session default. Updates the message store's status table row by setting the STATUS_DEFAULT_STORE flag in the <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> column.</dd>
<dt>
MAPI_PRIMARY_STORE</dt>
<dd>
Establishes the message store as the store to be used at logon. If the message store is not the default store, clients should make it the default. Updates the message store's status table row by setting the STATUS_PRIMARY_STORE flag in the <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> column.</dd>
</dl>

<p>
MAPI_SECONDARY_STORE

<p>
Establishes the message store as the store to be used at logon if the primary message store is not available. If a client cannot open the primary store, it should open the secondary store and set it as the default. Updates the message store's status table row by setting the STATUS_SECONDARY_STORE flag in the <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> column.

<dl>
<dt>
MAPI_SIMPLE_STORE_PERMANENT</dt>
<dd>
Establishes the message store as the session default for Simple MAPI and CMC clients and sets the STATUS_SIMPLE_STORE flag in the message store's <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> property in its status table row, message store table row, and in the session profile.</dd>
<dt>
MAPI_SIMPLE_STORE_TEMPORARY</dt>
<dd>
Establishes the message store as the session default for Simple MAPI and CMC clients and sets the STATUS_SIMPLE_STORE flag in the message store's <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> property in its status table row and message store table row. The profile is not modified. </dd>
</dl>
</dd>
<dt>
<i>cbEntryID</i></dt>
<dd>
[in] Count of bytes in the entry identifier pointed to by the <i>lpEntryID </i>parameter.</dd>
<dt>
<i>lpEntryID</i></dt>
<dd>
[in] Pointer to the entry identifier of the message store intended as the default. If a client passes NULL in <i>lpEntryID</i>, no message store is selected as the default.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISession::SetDefaultStore</b> method establishes a message store as one of the following:
<ul>
<li>
Default message store for the session</li>
<li>
Primary message store for the session</li>
<li>
Secondary message store for the session</li>
<li>
Temporary or permanent message store that can be used with Simple MAPI</li>
</ul>
<p>
To establish a message store as the default, the message store must have the following flags set in its <a href="propb_01t7.htm">PR_STORE_SUPPORT_MASK</a> property:</p>
<p class=indent1>
STORE_SUBMIT_OK</p>
<p class=indent1>
STORE_CREATE_OK</p>
<p class=indent1>
STORE_MODIFY_OK</p>
<h4>Notes to Callers</h4>
<p>
You can determine the default message store for the session by retrieving the status table and searching for the setting of the STATUS_DEFAULT_STORE flag in the <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> column. The row with this setting represents the message store designated as the session default.</p>
<p>
When either the MAPI_DEFAULT_STORE or the MAPI_SIMPLE_STORE_PERMANENT flag is set, MAPI updates the profile, message store table, and status table. </p>
<p>
Whenever a change is made to the message store default setting, the following notifications are generated: 
<ul>
<li>
An <code>fnevTableModified</code> event notification is issued for each of the affected rows in both the message store and status table.</li>
<li>
An internal notification is issued to the MAPI spooler. Operations already in progress are completed without change; new operations involving the default message store, such as message downloading, are processed for the new default store.</li>
</ul>
<h4>See Also</h4>
<p>
<a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a>, <a href="propb_01t7.htm">PR_STORE_SUPPORT_MASK</a>, <a href="structyp_65o0.htm"><b>TABLE_NOTIFICATION</b></a></p>
<p>&nbsp;</p></body>
</HTML>
