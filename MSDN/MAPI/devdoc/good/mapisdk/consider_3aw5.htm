<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying a Folder Contents Table</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_displaying_a_folder_contents_table"></a>Displaying a Folder Contents Table</h2>
<p>
The contents table of a folder contains summary information about all of its messages. Summary information about new incoming messages appears in the contents table of the receive folder for the message class. To make this information available to users, retrieve the table and display the columns and rows as appropriate. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display a folder contents table</h5>
<ol>
<li>
Call <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a>, passing the entry identifier of the folder containing the table.</li>
<li>
Call the folder's <a href="inter011_0sx1.htm"><b>IMAPIContainer::GetContentsTable</b></a> method to open its contents table.</li>
<li>
Limit your view of the contents table if desired by calling the table's <a href="inter026_7x83.htm"><b>IMAPITable::SetColumns</b></a> method to specify particular columns.</li>
<li>
Limit your view of the contents table if desired by calling the table's <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a> method to filter particular rows. If, for example, you want to show only messages with a specific message class that have yet to be read:<ol type=a>
<li>
Create a property restriction in an <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> structure that matches the <a href="propa_0ecz.htm">PR_MESSAGE_CLASS</a> property with the desired message class. </li>
<li>
Create a bitmask restriction in an <a href="structyp_6zvy.htm"><b>SBitmaskRestriction</b></a> structure that uses <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> as the property tag and the MSGFLAG_UNREAD value as the mask.</li>
<li>
Create a restriction in an <a href="structyp_0v1q.htm"><b>SAndRestriction</b></a> structure that joins the property and bitmask restrictions.</li>
</ol>
</li>
<li>
Sort the contents table if desired by calling the table's <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a> method.</li>
<li>
Call <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> to retrieve all of the rows from the contents table for processing. </li>
</ol>
<p>
Transport providers set the <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property of incoming messages to MSGFLAG_FROMME if they were sent by the currently logged on user. If this flag is set and you are displaying the contents table of the Sent Items folder, show names of recipients rather than names of senders. Messages that have been saved during the composition process and not yet sent should also be displayed with recipient names rather than sender names.</p>
<p>&nbsp;</p></body>
</HTML>
