<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting RTF Text for Message Store Providers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_supporting_rtf_text_for_message_store_providers"></a>Supporting RTF Text for Message Store Providers</h2>
<p>
Some client applications allow users to use Rich Text Format (RTF) text in their messages. If your message store provider needs to support RTF text in messages, it needs to handle the <a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a> property in addition to the <a href="propa_9lvd.htm">PR_BODY</a> property. Primarily, this means storing both properties, and making sure that PR_BODY contains a plain text version of the text in PR_RTF_COMPRESSED. The <a href="function_4yg3.htm"><b>RTFSync</b></a> function is useful for this.</p>
<p>
There are two flags that can be set in the message store object's <a href="propb_01t7.htm">PR_STORE_SUPPORT_MASK</a> property which tell clients what they can expect from the message store provider with respect to the PR_BODY and PR_RTF_COMPRESSED properties on messages within the message store. The STORE_RTF_OK flag indicates that the store can generate the value of the PR_BODY property from the PR_RTF_COMPRESSED property dynamically, which relieves clients from the burden of synchronizing them explicitly. The STORE_UNCOMPRESSED_RTF flag indicates that the message store provider can support uncompressed data in PR_RTF_COMPRESSED.</p>
<p>
Message store providers that do not support RTF text need to delete the <a href="propb_26ar.htm">PR_RTF_IN_SYNC</a> property when the PR_BODY property changes in order to interoperate properly with client applications that do support RTF text.</p>
<p>&nbsp;</p></body>
</HTML>
