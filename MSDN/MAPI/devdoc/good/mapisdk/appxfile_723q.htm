<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>File Format of MAPISVC.INF</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_file_format_of_mapisvc.inf"></a>File Format of MAPISVC.INF</h1>
<p>
The MAPISVC.INF file acts as the central database for MAPI message service configuration information. MAPISVC.INF contains information about each of the message services installed on the workstation, information about the service providers that belong to each message service, and information about the MAPI subsystem. MAPISVC.INF is the primary source of information for profiles. That is, when a new profile is being built or an existing one modified, relevant information for each message service or service provider is copied from MAPISVC.INF. </p>
<p>
MAPISVC.INF is divided into linked hierarchical sections:
<ol>
<li>
Section containing information that applies to all profiles. This section has three parts:<ul>
<li>
<b>[Services]</b> section, providing links to each of the subsequent message service sections.</li>
<li>
<b>[Help File Mappings]</b> section, containing information about .HLP files provided by message services. </li>
<li>
<b>[Default Services]</b> section, listing message services that make up a default installation. </li>
</ul>
</li>
<li>
Section containing information that applies to individual message services. Entries in these sections provide links to subsequent service provider sections.</li>
<li>
Section containing information that applies to individual service providers in a message service.</li>
</ol>
<p>
The following illustration shows the organization of a typical MAPISVC.INF file. There are three message services: AB, MsgService, and MS. The name on the right hand side of the equal sign for each message service is the service's display name. Each message service has its own section elsewhere in the file that is linked to one or more service provider sections. There is one service provider section for every service provider that belongs to the message service. The AB and MS message services are single provider services whereas three service providers belong to the MsgService service.</p>
<p>
<img src="images/amapi_30.gif" border=0></p>
<p>
MAPI provides a skeletal version of the MAPISVC.INF file that contains the entries for the MAPI subsystem. Each message service implementer adds entries that are appropriate both for their service and the service providers that belong to their service. Some of the entries are required while others are optional. For example, MAPI requires that you specify the name and path of each of the service providers in your message service. Without this information, they cannot be loaded.</p>
<p>
You can add required and optional information in either the section for your message service and/or to the service provider sections. Where you put the information describing your message service depends on the number of service providers in the service. Because this information applies to each service provider in the service, you must make it accessible to all providers. Store it either in the message service section, the preferred option, or in all of the service provider sections. Storing information once avoid unnecessary replication and the need to keep multiple copies synchronized.</p>
<p>
If your message service is a single provider service, store all of the message service information in the section for the service provider rather than in the section for the service. Accessing the service provider section is faster and more direct than accessing the message service section. </p>
<p>
Store only public configuration data in the MAPISVC.INF file. Information that is private or requires extra protection, such as passwords or other credentials, should not be included in this file. Instead, opt either not to store information of this type at all or keep it in the profile as secure properties. Secure properties have built-in protection features such as encryption. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To update MAPISVC.INF</h5>
<ol>
<li>
Create a temporary file containing the information to be placed in MAPISVC.INF. </li>
<li>
Call the MERGEINI utility as follows, where TMP.INI is the name of the temporary file:</li>
</ol>
<pre><code>MERGEINI C:\MAPI\TMP.INI -m -q
</code></pre>
<p>&nbsp;</p></body>
</HTML>
