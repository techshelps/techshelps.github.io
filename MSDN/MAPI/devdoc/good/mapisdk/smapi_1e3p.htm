<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>About MapiMessage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_about_mapimessage"></a>About MapiMessage</h2>
<p>
The <b>lpszMessageType</b> member of the <a href="smapiref_6n1b.htm"><b>MapiMessage</b></a> structure indicates the type of the message. The most common type is the interpersonal message, or IPM. A NULL value for <b>lpszMessageType</b> or a pointer to an empty string indicates an interpersonal message. Client applications can use this member to define their own message types. Be aware that not all messaging systems support message types other than IPM. Those messaging systems will ignore <b>lpszMessageType</b>.</p>
<p>
The <b>lpszMessageType</b> member is also used to indicate when a message is a nondelivery report (NDR). The messaging system formats the nondelivery for a message type as REPORT. plus the message type plus .NDR. For example, if your client uses a message type of mytype, the nondelivery report for such a message will have REPORT.mytype.NDR as its <b>lpszMessageType</b> string. For clients that deal with multiple types of messages, your client can compare the last four characters of the <b>lpszMessageType</b> string against .NDR to determine whether the message is a nondelivery report. Naturally, you should not choose a string that ends in .NDR as an internal message type.</p>
<p>
<b>Note</b>  While nondelivery reports generated by MAPI follow this convention, nondelivery reports generated by transport providers for external mail delivery systems might not.</p>
<p>
The <b>flFlags</b> member can be used to request a receipt and to detect the read or unread and sent or unsent status of a message. When sending a message, you can set the MAPI_RECEIPT_REQUESTED flag to request a receipt. When reading a message, you can test for the MAPI_UNREAD flag to determine whether the message has not yet been read. Similarly, you can test for the MAPI_SENT flag to determine whether the message has been sent. When saving a previously unsaved message, you should set the MAPI_UNREAD and MAPI_SENT flags as appropriate for the message.</p>
<p>&nbsp;</p></body>
</HTML>
