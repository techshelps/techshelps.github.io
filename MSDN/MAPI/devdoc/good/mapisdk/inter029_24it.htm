<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMessage::GetAttachmentTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imessage_getattachmenttable"></a>IMessage::GetAttachmentTable</h2>
<p>
The <b>IMessage::GetAttachmentTable</b> method returns the message's attachment table.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter029_525s.htm"><b>IMessage : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT GetAttachmentTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that relate to the creation of the table. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The string columns are in Unicode format. If the MAPI_UNICODE flag is not set, the string columns are in ANSI format.</dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
Allows <b>GetAttachmentTable</b> to return successfully, possibly before the table is fully accessible to the calling client. If the table is not accessible, making a subsequent call to it can result in an error.</dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the attachment table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The attachment table was successfully retrieved.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMessage::GetAttachmentTable</b> method returns a pointer to the message's attachment table, which includes information about all of the attachments in the message. Clients can get access to an attachment only through the attachment table. By retrieving an attachment's number — its <a href="propa_0p4d.htm">PR_ATTACH_NUM</a> property — a client can use several of the <b>IMessage</b> methods to work with the attachment.</p>
<p>
There is one row for each attachment. For a complete list of the columns in an attachment table, see <a href="tables_35pv.htm">Attachment Tables</a>.</p>
<p>
An attachment usually does not appear in the attachment table until both the attachment and the message have been saved with a call to <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a>. Attachment tables are dynamic. If a client creates a new attachment, deletes an existing attachment, or changes one or more properties once the <b>SaveChanges</b> calls have been made on the attachment on the message, the attachment table will be updated to reflect the new information.</p>
<p>
Some attachment tables support a wide variety of restrictions; others do not. Support for restrictions depends on the message store provider's implementation. </p>
<p>
When initially opened, attachment tables are not necessarily sorted in any particular order. </p>
<p>
Setting the MAPI_UNICODE flag in the <i>ulFlags </i>parameter affects the following calls to the attachment table: 
<ul>
<li>
<a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a> to retrieve the column set.</li>
<li>
<a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> to retrieve rows.</li>
<li>
<a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> to retrieve the sort order.</li>
</ul>
<p>
Setting the Unicode flag requests that the information for any string columns returned from these calls be in Unicode format. However, because not all message store providers support Unicode, setting this flag is only a request.</p>
<h4>See Also</h4>
<p>
<a href="inter029_5nhk.htm"><b>IMessage::CreateAttach</b></a>, <a href="inter029_63vs.htm"><b>IMessage::DeleteAttach</b></a>, <a href="inter029_7qco.htm"><b>IMessage::OpenAttach</b></a></p>
<p>&nbsp;</p></body>
</HTML>
