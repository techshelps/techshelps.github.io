<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFolder::EmptyFolder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapifolder_emptyfolder"></a>IMAPIFolder::EmptyFolder</h2>
<p>
The <b>IMAPIFolder::EmptyFolder</b> method deletes all messages and subfolders from a folder without deleting the folder itself.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT EmptyFolder(
  ULONG</b><i> ulUIParam</i><b>,</b>             
<b>  LPMAPIPROGRESS</b><i> lpProgress</i><b>,</b>   
<b>  ULONG</b><i> ulFlags                </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the progress indicator. The <i>ulUIParam</i> parameter is ignored unless the FOLDER_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>lpProgress</i></dt>
<dd>
[in] Pointer to a progress object for displaying a progress indicator. If NULL is passed in <i>lpProgress</i>, the message store provider displays a progress indicator using the MAPI progress object implementation. The <i>lpProgress</i> parameter is ignored unless the FOLDER_DIALOG flag is set in <i>ulFlags</i>.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the folder is emptied. The following flags can be set:
<dl>
<dt>
DEL_ASSOCIATED</dt>
<dd>
Deletes all subfolders, including subfolders containing messages with associated content. The DEL_ASSOCIATED flag only has meaning for the top-level folder the call acts on.</dd>
<dt>
FOLDER_DIALOG</dt>
<dd>
Displays a progress indicator while the operation proceeds.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The folder was successfully emptied.</dd>
<dt>
MAPI_W_PARTIAL_COMPLETION</dt>
<dd>
The call succeeded, but the folder was not completely emptied. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIFolder::EmptyFolder</b> method deletes all of a folder's contents without deleting the folder itself. </p>
<p>
During an <b>EmptyFolder</b> call, submitted messages are not deleted.</p>
<p>
A folder's associated information includes messages that are used to describe views and form definitions. </p>
<h4>Notes to Implementers</h4>
<p>
Do not call <a href="inter031_5gac.htm"><b>IMsgStore::AbortSubmit</b></a> for messages in the folder that have been submitted. Submitted messages are not deleted.</p>
<h4>Notes to Callers</h4>
<p>
Expect these return values under the following conditions:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Condition</th>
<th align=left width=52%>Return value</th>
</tr>
<tr valign=top>
<td width=48%><b>EmptyFolder</b> has successfully emptied the folder.</td>
<td width=52%>S_OK</td>
</tr>
<tr valign=top>
<td width=48%><b>EmptyFolder</b> was unable to completely empty the folder.</td>
<td width=52%>MAPI_W_PARTIAL_COMPLETION </td>
</tr>
<tr valign=top>
<td width=48%><b>EmptyFolder</b> was unable to complete.</td>
<td width=52%>Any error value</td>
</tr>
</table><br>
<p>
When <b>EmptyFolder</b> is unable to complete, do not assume that no work was done. <b>EmptyFolder</b> might have been able to delete some of the folder's contents before encountering the error. </p>
<p>&nbsp;</p></body>
</HTML>
