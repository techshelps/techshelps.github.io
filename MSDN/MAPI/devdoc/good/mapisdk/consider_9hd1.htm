<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Finding a Profile Name</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_finding_a_profile_name"></a>Finding a Profile Name</h2>
<p>
Clients sometimes need to find the name of the profile currently being used for the session, the name of the default profile, or the name of an alternate profile installed on the workstation. </p>
<p>
There are a few ways to retrieve the name of a profile during the course of a session. If you need to find the name of a profile that is not necessarily the one being used for the session, use the first procedure. If you need to find the name of the default profile, use the second procedure. If you need to find the name of the current profile for the session, use one of the last two procedures. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To find the name of any profile</h5>
<ol>
<li>
Call <a href="function_9jg3.htm"><b>MAPIAdminProfiles</b></a> to retrieve an <b>IProfAdmin</b> interface pointer.</li>
<li>
Call <a href="inter035_4dph.htm"><b>IProfAdmin::GetProfileTable</b></a> to access the profile table. </li>
<li>
Call the profile table's <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> method to retrieve all of the rows in the table and examine each one to determine if it represents your target profile.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To find the name of the default profile</h5>
<ol>
<li>
Call <a href="function_9jg3.htm"><b>MAPIAdminProfiles</b></a>.</li>
<li>
Call <a href="inter035_4dph.htm"><b>IProfAdmin::GetProfileTable</b></a> to access the profile table. </li>
<li>
Build a property restriction with an <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> structure to match <a href="propa_3fmt.htm">PR_DEFAULT_PROFILE</a> with the value TRUE.</li>
<li>
Call <a href="inter026_2lkn.htm"><b>IMAPITable::FindRow</b></a> to locate the row in the profile table that represents the default profile. The <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> column contains the name of the default profile.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To find the name of the current profile</h5>
<ul>
<li>
Assuming that you have the <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> structure representing one of the current profile's sections, pass it in the <i>lpUID</i> parameter to <a href="inter023_4ofi.htm"><b>IMAPISession::OpenProfileSection</b></a>. Retrieve the profile section's <a href="propb_48it.htm">PR_PROFILE_NAME</a> property using its <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method.</li>
</ul>
<p>
-Or-
<ul>
<li>
Call <a href="inter023_04md.htm"><b>IMAPISession::GetStatusTable</b></a> to access the status table and find the row that has its <a href="propb_0oh1.htm">PR_RESOURCE_TYPE</a> column set to MAPI_SUBSYSTEM. The <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> column for this row is the profile name.<p>
Do not use the status table during start up because it blocks an application until the MAPI spooler has finished initializing all of the transport providers. This can degrade your performance.
</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
