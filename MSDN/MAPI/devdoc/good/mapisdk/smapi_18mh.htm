<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Requesting a Logon User Interface with Simple MAPI</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_requesting_a_logon_user_interface_with_simple_mapi"></a>Requesting a Logon User Interface with Simple MAPI</h2>
<p>
A client application can log on either by displaying a logon dialog box to provide user interaction or by providing necessary credentials (profile name and password if necessary) programmatically. If you require user interaction, you can use the common dialog box provided by Simple MAPI or create your own. However, it is recommended that you use the standard MAPI dialog boxes whenever possible to promote a consistent look and ease of use.</p>
<p>
The presence or absence of the MAPI_LOGON_UI value in the <i>flFlags </i>parameter of the <a href="smapiref_68tq.htm"><b>MAPILogon</b></a> function controls the logon dialog box display. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To force the dialog box to be displayed</h5>
<p class=indent1>
Set MAPI_LOGON_UI in the <i>flFlags</i> parameter and set the <i>lpszProfileName</i> and <i>lpszPassword</i> parameters to NULL as follows:</p>
<pre><code>flFlags |= MAPI_LOGON_UI;
MAPILogon ((ULONG) hWnd, NULL, NULL, flFlags, 0, &amp;lhSession);
 </code></pre>
<p>
If you provide a value for <i>lpszProfileName</i> (and <i>lpszPassword</i> if necessary), <b>MAPILogon</b> attempts to establish a session without a user interface. Only if this attempt fails will <b>MAPILogon</b> display the logon dialog box for the user to enter new credentials.</p>
<p>&nbsp;</p></body>
</HTML>
