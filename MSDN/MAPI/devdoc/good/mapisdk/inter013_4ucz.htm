<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFolder::GetMessageStatus</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapifolder_getmessagestatus"></a>IMAPIFolder::GetMessageStatus</h2>
<p>
The <b>IMAPIFolder::GetMessageStatus</b> method obtains the status associated with a message in a particular folder — for example, whether that message is marked for deletion.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT GetMessageStatus(
  ULONG</b><i> cbEntryID</i><b>,</b>               
<b>  LPENTRYID</b><i> lpEntryID</i><b>,</b>           
<b>  ULONG</b><i> ulFlags</i><b>,</b>                 
<b>  ULONG FAR *</b><i> lpulMessageStatus  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cbEntryID</i></dt>
<dd>
[in] Count of bytes in the entry identifier pointed to by the <i>lpEntryID</i> parameter.</dd>
<dt>
<i>lpEntryID</i></dt>
<dd>
[in] Pointer to the entry identifier for the message whose status is obtained.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lpulMessageStatus</i></dt>
<dd>
[out] Pointer to a pointer to a bitmask of flags indicating the message's status. Bits 0 through 15 are reserved and must be zero; bits 16 through 31 are available for implementation-specific use. 
<p>
The following flags can be set:

<dl>
<dt>
MSGSTATUS_DELMARKED</dt>
<dd>
The message has been marked for deletion.</dd>
<dt>
MSGSTATUS_HIDDEN</dt>
<dd>
The message is not to be displayed. </dd>
<dt>
MSGSTATUS_HIGHLIGHTED</dt>
<dd>
The message is to be displayed highlighted.</dd>
<dt>
MSGSTATUS_REMOTE_DELETE</dt>
<dd>
The message has been marked for deletion at the remote message store without downloading to the local client.</dd>
<dt>
MSGSTATUS_REMOTE_DOWNLOAD</dt>
<dd>
The message has been marked for downloading from the remote message store to the local client.</dd>
<dt>
MSGSTATUS_TAGGED</dt>
<dd>
The message has been tagged for a client-defined purpose.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The message status was successfully retrieved. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIFolder::GetMessageStatus</b> method returns the status of a message. Message status is stored in the message's <a href="propb_3c1f.htm">PR_MSG_STATUS</a> property. </p>
<h4>Notes to Implementers</h4>
<p>
How the message status bits are set, cleared, and used depends entirely on your implementation, except that bits 0 through 15 are reserved and must be zero. If you store messages in the IPM subtree, MAPI reserves bits 16 through 31 for use by IPM clients. If you store messages in other subtrees, you can use bits 16 through 31 for your own purposes.</p>
<h4>See Also</h4>
<p>
<a href="inter013_6pmb.htm"><b>IMAPIFolder::SetMessageStatus</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
