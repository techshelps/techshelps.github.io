<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>cmc_logon</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_cmc_logon"></a>cmc_logon</h2>
<p>
The <b>cmc_logon</b> function logs a client application on to a service provider. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>XCMC.H</td>
</tr>
</table><br>
<pre><code><b>CMC_return_code cmc_logon (
  CMC_string</b><i> service</i><b>,</b>                   
<b>  CMC_string</b><i> user</i><b>,</b>                      
<b>  CMC_string</b><i> password</i><b>,</b>                  
<b>  CMC_object_identifier</b><i> character_set</i><b>,</b>   
<b>  CMC_ui_id</b><i> ui_id</i><b>,</b>                      
<b>  CMC_uint16</b><i> caller_CMC_version</i><b>,</b>        
<b>  CMC_flags</b><i> logon_flags</i><b>,</b>                
<b>  CMC_session_id FAR *</b><i> session</i><b>,</b>         
<b>  CMC_extension FAR *</b><i> logon_extensions  </i>
<b>)</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>service </i></dt>
<dd>
[in] Pointer to the location of the service provider for the CMC implementation. Passing NULL for the <i>service </i>parameter indicates either that the client application is requesting logon to a service provider that does not require a service name, or that the client is requesting the CMC implementation's logon dialog box. </dd>
<dt>
<i>user </i></dt>
<dd>
[in] Pointer to a MAPI profile name identifying the client application. Passing NULL for the <i>user </i>parameter indicates either that the client is requesting logon to a service provider that does not require a user name, or that the client is requesting the CMC implementation's dialog box to prompt for a name. </dd>
<dt>
<i>password </i></dt>
<dd>
[in] Pointer to a MAPI profile password required for access to the CMC implementation. Passing NULL for the <i>service </i>parameter indicates either that the client is requesting logon to a service provider that does not require a password, or that the client is requesting the CMC implementation's dialog box to prompt for a password. </dd>
<dt>
<i>character_set </i></dt>
<dd>
[in] Pointer to an object identifier for the character set used by the client application. The client application can call the <a href="cmcref_2nu6.htm"><b>cmc_query_configuration</b></a> function to retrieve the available values. The CMC implementation requires a non-null value for the <i>character_set</i> parameter. </dd>
<dt>
<i>ui_id </i></dt>
<dd>
[in] Handle of a dialog box for the <b>cmc_logon</b> function to present to help resolve processing questions or prompt for logon.</dd>
<dt>
<i>caller_CMC_ version </i></dt>
<dd>
[in] The client application's CMC version number, multiplied by 100. For example, version 1 is specified as the integer 100.</dd>
<dt>
<i>logon_flags </i></dt>
<dd>
[in] Bitmask of flags. The following flags can be set:
<dl>
<dt>
CMC_COUNTED_STRING_TYPE</dt>
<dd>
The string type the calling application or provider uses for CMC interactions is a CMC_counted_string. If this flag is not set, the function treats all strings as null-terminated strings.</dd>
<dt>
CMC_ERROR_UI_ALLOWED</dt>
<dd>
Displays a dialog box on encountering recoverable errors. If this flag is not set, <b>cmc_logon</b> does not display a dialog box and returns an error value instead.</dd>
<dt>
CMC_LOGON_UI_ALLOWED</dt>
<dd>
Displays a dialog box to prompt for logon if required. If this flag is not set, <b>cmc_logon</b> does not display a dialog box and returns an error value if the user does not supply enough information.</dd>
</dl>
</dd>
<dt>
<i>session</i></dt>
<dd>
[out] Pointer to the location to which <b>cmc_logon</b> writes an opaque session handle. This identifier represents a MAPI session object indicating a session with a message service.</dd>
<dt>
<i>logon_extensions </i></dt>
<dd>
[in, out] Pointer to an array of <a href="cmcref_1woe.htm"><b>CMC_extension</b></a> structures specifying function extensions. On input, this array contains MAPI extensions to the standard <b>cmc_logon</b> function. A value of NULL for the <i>logon_extensions </i>parameter indicates that the client application has no extensions for <b>cmc_logon</b> and is expecting no extensions. 
<p>
On output, <b>cmc_logon</b> writes to the array new information about the logon operation. It writes NULL if it generates no output extensions. 

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
CMC_E_COUNTED_STRING_UNSUPPORTED</dt>
<dd>
This implementation does not support the counted-string type.</dd>
<dt>
CMC_E_FAILURE</dt>
<dd>
There was a general failure that does not fit the description of any other return value.</dd>
<dt>
CMC_E_INSUFFICIENT_MEMORY</dt>
<dd>
Insufficient memory was available to complete the requested operation.</dd>
<dt>
CMC_E_INVALID_FLAG</dt>
<dd>
A flag set using a flags parameter was invalid.</dd>
<dt>
CMC_E_INVALID_PARAMETER</dt>
<dd>
A function parameter was invalid. </dd>
<dt>
CMC_E_INVALID_UI_ID</dt>
<dd>
The specified user-interface identifier is invalid or no longer valid.</dd>
<dt>
CMC_E_LOGON_FAILURE</dt>
<dd>
The service, user name, or password specified was invalid, so logon cannot be completed.</dd>
<dt>
CMC_E_PASSWORD_REQUIRED</dt>
<dd>
A password is required on this message service.</dd>
<dt>
CMC_E_SERVICE_UNAVAILABLE</dt>
<dd>
The service requested was unavailable.</dd>
<dt>
CMC_E_UNSUPPORTED_CHARACTER_SET</dt>
<dd>
The current implementation does not support the character set requested.</dd>
<dt>
CMC_E_UNSUPPORTED_FLAG</dt>
<dd>
The current implementation does not support the flag requested.</dd>
<dt>
CMC_E_UNSUPPORTED_FUNCTION_EXT</dt>
<dd>
The current implementation does not support the function extension requested.</dd>
<dt>
CMC_E_UNSUPPORTED_VERSION</dt>
<dd>
The current implementation cannot support the version specified in the call.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>cmc_logon</b> function can, at the client application's option, either prompt the user for information through a dialog box or proceed without any user interaction. It writes a session handle that the client application can use in subsequent calls to the CMC implementation.</p>
<h4>See Also</h4>
<p>
<a href="cmcref_1woe.htm"><b>CMC_extension</b></a>,<b> <a href="cmcref_2nu6.htm">cmc_query_configuration</a></b></p>
<p>&nbsp;</p></body>
</HTML>
