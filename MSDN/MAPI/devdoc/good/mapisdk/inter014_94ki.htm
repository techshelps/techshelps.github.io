<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIForm::DoVerb</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapiform_doverb"></a>IMAPIForm::DoVerb</h2>
<p>
The <b>IMAPIForm::DoVerb</b> method requests that the form perform whatever tasks it associates with a specific verb.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter014_0dym.htm"><b>IMAPIForm : IUnknown</b></a>.</p>
<pre><code><b>HRESULT DoVerb(
  LONG</b><i> iVerb</i><b>,</b>                        
<b>  LPMAPIVIEWCONTEXT</b><i> lpViewContext</i><b>,</b>   
<b>  ULONG</b><i> hwndParent</i><b>,</b>                  
<b>  LPCRECT</b><i> lprcPosRect                </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>iVerb</i></dt>
<dd>
[in] Number associated with one of the form's verbs.</dd>
<dt>
<i>lpViewContext</i></dt>
<dd>
[in] Pointer to a view context object. The <i>lpViewContext</i> parameter can be NULL.</dd>
<dt>
<i>hwndParent</i></dt>
<dd>
[in] Handle of the parent window for any dialog boxes or windows this method displays. The <i>hwndParent</i> parameter should be NULL if the dialog box or window is not modal.</dd>
<dt>
<i>lprcPosRect</i></dt>
<dd>
[in] Pointer to a Win32 <b>RECT</b> structure containing the form's window size and position.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
The verb was successfully invoked.</dd>
<dt>
OLEOBJ_S_CANNOT_DOVERB_NOW</dt>
<dd>
The verb represented by the <i>iVerb</i> parameter is valid, but the form cannot perform the operations associated with it at the present time. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
Form viewers call the<i> </i><b>IMAPIForm::DoVerb</b><i> </i>method<i> </i>to request that the form perform the tasks that it associates with each of the verbs that the form supports. </p>
<p>
Each of the supported verbs is identified by a numeric value, passed to <b>DoVerb</b> in the <i>iVerb</i> parameter. Typical implementations of <b>DoVerb</b> contain a <b>switch</b> statement that tests the values that are valid for the <i>iVerb</i> parameter for the form.</p>
<h4>Notes to Implementers</h4>
<p>
If the form viewer specifies a view context in the <i>lpViewContext</i> parameter, use it in your <b>DoVerb</b> implementation rather than the view context passed in an earlier call to the <a href="inter014_01ro.htm"><b>IMAPIForm::SetViewContext</b></a> method. Make whatever changes that are necessary to your internal data structures and do not save the view context.</p>
<p>
Perform the following tasks in your <b>DoVerb</b> implementation:
<ul>
<li>
Execute whatever code is necessary for the particular verb associated with the <i>iVerb</i> parameter.</li>
<li>
If necessary, restore the original view context.</li>
<li>
If an unknown verb number was passed in, return MAPI_E_NO_SUPPORT. Otherwise, return a result based on the success or failure of whatever verb was executed.</li>
<li>
Shut the form down. It is always your responsibility to shut down after completing a <b>DoVerb</b> call. </li>
</ul>
<p>
Some verbs, such as Print, should be modal with respect to the <b>DoVerb</b> call — that is, the indicated operation must be finished before the <b>DoVerb</b> call returns. </p>
<p>
To obtain the <b>RECT</b> structure used by a form's window, call the Win32 function <b>GetWindowRect</b>.</p>
<p>
Do not save the handle in the <i>hwndParent</i> parameter because although it usually remains valid until the completion of <b>DoVerb</b>, it can be destroyed immediately upon the call's return.</p>
<h4>Notes to Callers</h4>
<p>
You can make nonmodal verbs act as modal verbs by pointing <i>lpViewContext</i> to a view context implementation that returns the VCSTATUS_MODAL flag from its <b>GetViewStatus</b> method.</p>
<p>
For more information about verbs in MAPI, see <a href="formsarc_51tf.htm">Form Verbs</a>. For more information about how verbs are handled in OLE, see the <i>OLE Programmer's Reference</i>.</p>
<h4>See Also</h4>
<p>
<a href="inter014_01ro.htm"><b>IMAPIForm::SetViewContext</b></a>, <a href="inter028_916b.htm"><b>IMAPIViewContext::GetViewStatus</b></a></p>
<p>&nbsp;</p></body>
</HTML>
