<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPISendDocuments (VB)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_mapisenddocuments_vb_"></a>MAPISendDocuments (VB)</h2>
<p>
The Visual Basic <b>MAPISendDocuments</b> function sends a standard message with one or more attached files and a cover note. The cover note is a dialog box that allows the user to enter a list of recipients and an optional message.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIVB32.BAS</td>
</tr>
</table><br>
<p>
<b>MAPISendDocuments</b>(</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;<i>UIParam</i> as <b>Long</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>DelimChar</i> as <b>String</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>FullPaths</i> as <b>String</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>FileNames</i> as <b>String</b>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Reserved</i> as <b>Long</b>) as <b>Long</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>UIParam</i></dt>
<dd>
[in] Parent window handle or zero, indicating that if a dialog box is displayed, it is application modal. If no dialog box is displayed during the call, the <i>UIParam</i> parameter is ignored.</dd>
<dt>
<i>DelimChar</i></dt>
<dd>
[in] String containing the character used to delimit the names in the <i>FullPaths</i> and <i>FileNames</i> parameters. This character should not be used in filenames on your operating system.</dd>
<dt>
<i>FullPaths</i></dt>
<dd>
[in] String containing the list of full paths, including drive letters, for the attached files. The list is formed by concatenating correctly formed file paths separated by the character specified in the <i>DelimChar</i> parameter. An example of a valid list is:
<pre><code>C:\TMP\TEMP1.DOC;C:\TMP\TEMP2.DOC 
 </code></pre>

<p>
The files specified in <i>FullPaths</i> are added to the message as file attachments. If <i>FullPaths</i> contains an empty string, the Send Note dialog box is displayed with no attached files.
</dd>
<dt>
<i>FileNames</i></dt>
<dd>
[in] String containing the list of the original filenames as they should be displayed in the message. When multiple names are specified, the list is formed by concatenating the filenames separated by the character specified in the <i>DelimChar</i> parameter. An example is:
<pre><code>MEMO.DOC;EXPENSES.DOC 
 </code></pre>

<p>
If there is no value for the <i>FileNames</i> parameter or if it is empty, <b>MAPISendDocuments</b> sets the filenames set to the filename values indicated by the <i>FullPaths</i> parameter.
</dd>
<dt>
<i>Reserved</i></dt>
<dd>
Reserved; must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MAPI_E_ATTACHMENT_NOT_FOUND</dt>
<dd>
An attachment could not be located in the specified path. Either the drive letter was invalid, the path was not found on that drive, or the file was not found in that path.</dd>
<dt>
MAPI_E_ATTACHMENT_OPEN_FAILURE</dt>
<dd>
One or more files in the <i>FullPaths</i> parameter could not be located. No message was sent. </dd>
<dt>
MAPI_E_ATTACHMENT_WRITE_FAILURE</dt>
<dd>
An attachment could not be written to a temporary file. Check directory permissions.</dd>
<dt>
MAPI_E_FAILURE</dt>
<dd>
One or more unspecified errors occurred while sending the message. It is not known if the message was sent.</dd>
<dt>
MAPI_E_INSUFFICIENT_MEMORY</dt>
<dd>
There was insufficient memory to proceed.</dd>
<dt>
MAPI_E_LOGIN_FAILURE</dt>
<dd>
There was no default logon, and the user failed to log on successfully when the logon dialog box was displayed. No message was sent.</dd>
<dt>
MAPI_E_USER_ABORT</dt>
<dd>
The user canceled the process. No message was sent.</dd>
<dt>
SUCCESS_SUCCESS</dt>
<dd>
The call succeeded and the message was sent.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Calling the <b>MAPISendDocuments</b> function displays a Send Note dialog box, which prompts the user to send a message with data file attachments. Attachments can include the active document or all the currently open documents in the Windows-based application that called <b>MAPISendDocuments</b>. This function is used primarily for calls from a macro or scripting language, often found in applications such as spreadsheet or word-processing programs.</p>
<p>
There is no default identification when <b>MAPISendDocuments</b> is called; a standard logon dialog box appears. After the user provides a mailbox name and password, the Send Note dialog box appears.</p>
<p>
The user's default messaging options are used as the default dialog box values. The caller is responsible for deleting temporary files created when using <b>MAPISendDocuments</b>. </p>
<p>
The declaration of this function for the 32-bit Visual Basic runtime is:</p>
<p>
<b>MAPISendDocuments(</b></p>
<p>
ByVal <i>UIParam</i>&amp;, <br>
ByVal <i>DelimStr</i>$, <br>
ByVal <i>FilePaths</i>$, <br>
ByVal <i>FileNames</i>$, <br>
ByVal <i>Reserved</i>&amp;) <b>As Long</b></p>
<p>&nbsp;</p></body>
</HTML>
