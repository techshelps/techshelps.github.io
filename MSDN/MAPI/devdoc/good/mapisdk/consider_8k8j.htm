<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying Form Icons</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_displaying_form_icons"></a>Displaying Form Icons</h2>
<p>
When displaying a list of messages in a folder, it is helpful to your users if you distinguish messages with custom <a href="glossary_4s31.htm#_mapi1book_gly_message_class">message classes</a> from the standard IPM.Note messages. Custom message classes correspond to form servers, and form servers provide icons to represent themselves. You can display these icons in the list of messages to alert users to each message's message class before the user opens the messages. Typically, the icon in the form's <a href="propb_9tta.htm">PR_MINI_ICON</a> property is the one that should be displayed in the list of messages. Forms also have a <a href="propa_7wdq.htm">PR_ICON</a> property that can be displayed when the form is minimized in a property sheet.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To get an icon for a message class without activating the form server for that message class</h5>
<ol>
<li>
Call the <a href="inter019_1b5e.htm"><b>IMAPIFormMgr::OpenFormContainer</b></a> method to get a pointer to an <a href="inter016_1eem.htm"><b>IMAPIFormContainer</b></a> interface.</li>
<li>
Call the <a href="inter016_24hf.htm"><b>IMAPIFormContainer::ResolveMessageClass</b></a> method to get a pointer to an <a href="inter018_5igg.htm"><b>IMAPIFormInfo</b></a> interface.</li>
<li>
Call the <a href="inter018_2et5.htm"><b>IMAPIFormInfo::MakeIconFromBinary</b></a> method to get an icon handle.</li>
</ol>
<p>
The icon can then be displayed using standard Win32 or Win16 APIs.</p>
<p>
<b>Warning</b>  Once you have the icon for a message class, make every effort to cache that icon. Not caching icons severely affects the performance of client applications. When caching icons, be careful of the relationships between message classes and their subclasses. For example, if the IPM.Note.Meeting.Cancel message class happens to resolve back to IPM.Note, do not assume that all subclasses of IPM.Note should use the icon for IPM.Note.</p>
<p>&nbsp;</p></body>
</HTML>
