<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PR_MESSAGE_CLASS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_pr_message_class"></a>PR_MESSAGE_CLASS</h2>
<p>
The PR_MESSAGE_CLASS property contains a text string that identifies the sender-defined message class, such as IPM.Note. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file:</td>
<td width=57%>MAPITAGS.H</td>
</tr>
<tr valign=top>
<td width=43%>Must be exposed by:</td>
<td width=57%>Message objects</td>
</tr>
<tr valign=top>
<td width=43%>Must be a column in:</td>
<td width=57%>Folder contents tables</td>
</tr>
<tr valign=top>
<td width=43%>Identifier:</td>
<td width=57%>0x001A</td>
</tr>
<tr valign=top>
<td width=43%>Property type:</td>
<td width=57%>PT_TSTRING</td>
</tr>
<tr valign=top>
<td width=43%>Property tag:</td>
<td width=57%>0x001A001E (0x001A001F for Unicode)</td>
</tr>
</table><br>
<h4>Remarks </h4>
<p>
The message class specifies the type of the message. It determines the set of properties defined for the message, the kind of information the message conveys, and how to handle the message. </p>
<p>
The PR_MESSAGE_CLASS property contains ASCII strings concatenated with periods. Each string represents a level of subclassing. For example, IPM.Note is a subclass of IPM and a superclass of IPM.Note.Private. </p>
<p>
PR_MESSAGE_CLASS must consist of the ASCII characters 32 through 127 and must not end with a period (ASCII 46). Sort and compare operations must treat it as a case-insensitive string. The maximum possible length is 255 characters, but in order to allow MAPI room to append qualifiers it is recommended that the original length be kept under 128 characters. Note that these lengths are given in characters; on platforms such as Unicode and DBCS (Double-Byte Character Set) the actual byte count could be higher. </p>
<p>
Every message is required to furnish the PR_MESSAGE_CLASS property. Normally the client application creating a new message sets PR_MESSAGE_CLASS as soon as <a href="inter013_7wv9.htm"><b>IMAPIFolder::CreateMessage</b></a> returns successfully. But if the property has not been set when the client calls <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a>, the message store should set it to IPM. </p>
<p>
The PR_MESSAGE_CLASS values defined by MAPI are: </p>
<pre><code>IPM.Note for a standard interpersonal message 
REPORT.&lt;subject message class&gt;.DR for a delivery report 
REPORT.&lt;subject message class&gt;.NDR for a nondelivery report 
REPORT.&lt;subject message class&gt;.IPNRN for a read report 
REPORT.&lt;subject message class&gt;.IPNNRN for a nonread report 
 </code></pre>
<p>
IPM and IPC are intended to be superclasses only, and a message should have at least one subclass qualifier appended before being stored or submitted. For more information on message class usage, see <a href="extend_5gab.htm">Message Classes</a>. For lists of required and optional properties for message classes, see the subtopics of <a href="extend_3vlf.htm">About Message Properties</a>.</p>
<p>
A custom message class can define properties in a reserved range for use with that message class only. For more information, see <a href="property_25bn.htm">About Property Identifiers</a>. </p>
<p>
Message classes control which receive folder an incoming message is stored in. For more information, see the <a href="inter031_2u05.htm"><b>IMsgStore::GetReceiveFolderTable</b></a> method. </p>
<p>
For more information on using message classes with forms and form servers, see <a href="formsvr_0t9v.htm">Choosing a Message Class</a>.  </p>
<h4>See Also</h4>
<p>
<a href="groups_3veb.htm">Message Properties</a> </p>
<p>&nbsp;</p></body>
</HTML>
