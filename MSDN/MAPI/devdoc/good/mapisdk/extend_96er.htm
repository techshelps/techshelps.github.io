<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending Messages: Transport Provider Tasks</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_sending_messages_transport_provider_tasks"></a>Sending Messages: Transport Provider Tasks</h2>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To transmit a message, transport providers</h5>
<ul>
<li>
Set the message's <a href="propb_92pl.htm">PR_RESPONSIBILITY</a> property to TRUE after the transport provider has either sent the message or attempted to send the message. If an attempt to send a message fails, transport providers should call <a href="inter025_7chf.htm"><b>IMAPISupport::StatusRecips</b></a> to generate a nondelivery report. If the message is sent successfully and the <a href="propb_5hyc.htm">PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED</a> property is set to TRUE, create an <a href="structyp_87n8.htm"><b>ADRLIST</b></a> structure containing the successful recipients, setting the <a href="propa_6011.htm">PR_DELIVER_TIME</a> property for each, and call <b>StatusRecips</b> to generate a delivery report.<p>
For more information about creating delivery and nondelivery reports, see the following topics:
<p>
<a href="extend_344z.htm">Report Messages</a>
<p>
<a href="extend_2e9f.htm">Required Report Message Properties</a>
<p>
<a href="extend_0beb.htm">Optional Report Message Properties</a>
<p>
<a href="xp_6837.htm">Sending Message Delivery Reports with Transport Providers</a>
</li>
<li>
Set the message's PR_SENDER group of properties to the identity of the user that has logged on. This group includes:<p>
<a href="propb_1pno.htm">PR_SENDER_ENTRYID</a>
<p>
<a href="propb_9orp.htm">PR_SENDER_NAME</a>
<p>
<a href="propb_6055.htm">PR_SENDER_SEARCH_KEY</a>
<p>
<a href="propb_9751.htm">PR_SENDER_ADDRTYPE</a>
<p>
<a href="propb_94qb.htm">PR_SENDER_EMAIL_ADDRESS</a>
</li>
<li>
Set the message's PR_SENT_REPRESENTING properties, if possible, to either the identity of the user that has logged on or to a valid delegate identity. The PR_SENT_REPRESENTING properties are used to implement the sending of messages by one user on behalf of another user. Transport providers that do not support these properties should ignore them on outbound messages.</li>
<li>
Set the message's <a href="propa_7pr9.htm">PR_CLIENT_SUBMIT_TIME</a> property to indicate when the client called <a href="inter029_65ut.htm"><b>IMessage::SubmitMessage</b></a>.</li>
<li>
Set the message's <a href="propb_4z6t.htm">PR_PROVIDER_SUBMIT_TIME</a> property to indicate the date and time that the message store provider marked the message as having been sent. </li>
</ul>
<p>
When a message is sent to a variety of recipients with several messaging systems, each transmitted copy will have a different sender identity. </p>
<p>
The transport provider or tightly coupled message store and transport is also responsible for setting originator and reply-to information. Originator information is stored in the PR_ORIGINATOR properties and reply-to information is stored in the PR_REPLY properties. The client can set these properties; however, the transport provider is allowed to ignore and overwrite the client's settings. </p>
<p>&nbsp;</p></body>
</HTML>
