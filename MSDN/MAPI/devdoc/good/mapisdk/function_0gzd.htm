<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WIZARDENTRY</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_wizardentry"></a>WIZARDENTRY</h2>
<p>
The <b>WIZARDENTRY</b> function prototype defines a service provider entry point function which the Profile Wizard calls to retrieve enough information to display the provider's configuration property sheets. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIWZ.H </td>
</tr>
<tr valign=top>
<td width=48%>Defined function implemented by: </td>
<td width=52%>Service providers </td>
</tr>
<tr valign=top>
<td width=48%>Defined function called by: </td>
<td width=52%>MAPI Profile Wizard </td>
</tr>
</table><br>
<pre><code><b>ULONG WIZARDENTRY(
  HINSTANCE</b><i> hProviderDLLInstance</i><b>,</b>   
<b>  LPTSTR FAR *</b><i> lpcsResourceName</i><b>,</b>   
<b>  DLGPROC FAR *</b><i> lppDlgProc</i><b>,</b>        
<b>  LPMAPIPROP</b><i> lpMAPIProp</i><b>,</b>           
 
<b>   );</b>    </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>hProviderDLLInstance </i></dt>
<dd>
[in] Instance handle of the service provider's DLL. </dd>
<dt>
<i>lpcsResourceName </i></dt>
<dd>
[out] Pointer to a string containing the full name of the dialog resource that should be displayed by the Profile Wizard during configuration. The maximum size of the string, including the NULL terminator, is 32 characters. </dd>
<dt>
<i>lppDlgProc </i></dt>
<dd>
[out] Pointer to a standard Windows dialog box procedure that will be called by the Profile Wizard to notify the provider of various events. </dd>
<dt>
<i>lpMapiProp </i></dt>
<dd>
[in] Pointer to a property interface implementation that provides access to the configuration properties. </dd>
<dt>
<i>lpMapiSupportObject </i></dt>
<dd>
[in] Pointer to the MAPI support object applicable to this session. 
</dd>
</dl>
<h4>Return Values </h4>
<dl>
<dt>
S_OK </dt>
<dd>
The service provider's <b>WIZARDENTRY</b> function was called successfully. </dd>
<dt>
MAPI_E_CALL_FAILED </dt>
<dd>
An error of unexpected or unknown origin prevented the operation from completing. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The Profile Wizard calls the <b>WIZARDENTRY</b> based function when it is ready to display the service provider's configuration user interface. When the Profile Wizard is finished configuring all providers, it writes the configuration properties to the profile by calling <a href="inter030_4cv9.htm"><b>IMsgServiceAdmin::ConfigureMsgService</b></a>. </p>
<h4>Notes to Implementers </h4>
<p>
The name of the <b>WIZARDENTRY</b> – based function must be placed in the WIZARD_ENTRY_NAME entry in MAPISVC.INF. </p>
<p>
The resource name is that of the dialog resource that will be rendered in the pane of the Profile Wizard. The resource that is passed back needs to contain all the pages — in a single dialog resource — that should be displayed by the Profile Wizard. When the Profile Wizard receives this resource, it ignores the dialog style, but not the control styles, and creates all the controls as children of the Profile Wizard page. All controls are initially hidden. Providers should ensure that the coordinates for their controls are zero or zero-based, and that they do not exceed a maximum width of 200 dialog units and a maximum height of 150 dialog units. Control identifiers below 400 are reserved for the Profile Wizard. The Profile Wizard displays the provider's title in bold text above the provider's user interface. </p>
<p>
The property interface pointer supplied in the <i>lpMapiProp</i> parameter should be retained by the provider for future reference. The Profile Wizard deals with only the most basic set of properties, and the provider can use the property interface implementation to include additional properties. During configuration, providers should add their configuration properties to the object implementing the property interface. After all providers have been configured, the Profile Wizard adds these properties to the profile. </p>
<p>
For more information on using this function, see <a href="provider_2gxa.htm">Supporting Message Service Configuration</a>. </p>
<h4>See Also</h4>
<p>
<a href="groups_6tmb.htm">Profile Wizard Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
