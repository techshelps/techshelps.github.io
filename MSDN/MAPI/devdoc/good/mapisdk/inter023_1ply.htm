<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISession::Logoff</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisession_logoff"></a>IMAPISession::Logoff</h2>
<p>
The <b>IMAPISession::Logoff</b> method ends a MAPI session.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter023_64ry.htm"><b>IMAPISession : IUnknown</b></a>.</p>
<pre><code><b>HRESULT Logoff(
  ULONG</b><i> ulUIParam</i><b>,</b>  
<b>  ULONG</b><i> ulFlags</i><b>,</b>    
<b>  ULONG</b><i> ulReserved  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for any dialog boxes or windows to be displayed if possible. This parameter is ignored if the MAPI_LOGOFF_UI flag is not set.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that control the logoff operation. The following flags can be set:
<dl>
<dt>
MAPI_LOGOFF_SHARED</dt>
<dd>
If this session is shared, all clients logged on using the shared session should be notified of the logoff in progress. The clients should log off. Any client using the shared session can set this flag. MAPI_LOGOFF_SHARED is ignored if the current session is not shared.</dd>
<dt>
MAPI_LOGOFF_UI</dt>
<dd>
<b>Logoff</b> can display a dialog box during the operation, possibly prompting the user for confirmation. </dd>
</dl>
</dd>
<dt>
<i>ulReserved</i></dt>
<dd>
Reserved; must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The logoff operation was successful.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISession::Logoff</b> method ends a MAPI session. When <b>Logoff</b> returns, none of the methods except for <b>Release</b> can be called. <b>IMAPISession::Logoff</b> is similar in functionality to the Simple MAPI function <a href="smapiref_9oiu.htm"><b>MAPILogoff</b></a>. </p>
<h4>Notes to Callers</h4>
<p>
When <b>Logoff </b>returns, release the session object by calling its <b>IUnknown::Release</b> method. </p>
<p>
For more information about ending a session, see <a href="consider_97la.htm">Ending a MAPI Session</a>.</p>
<h4>See Also</h4>
<p>
<a href="smapiref_9oiu.htm"><b>MAPILogoff</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
