<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IXPLogon::RegisterOptions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_ixplogon_registeroptions"></a>IXPLogon::RegisterOptions</h2>
<p>
The <b>IXPLogon::RegisterOptions</b> method returns the options that are supported by the transport provider for an address type to the MAPI spooler.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter042_2u9a.htm"><b>IXPLogon : IUnknown</b></a>.</p>
<pre><code><b>HRESULT RegisterOptions(
  ULONG FAR *</b><i> lpulFlags</i><b>,</b>         
<b>  ULONG FAR *</b><i> lpcOptions</i><b>,</b>        
<b>  LPOPTIONDATA FAR *</b><i> lppOptions  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpulFlags</i></dt>
<dd>
[out] Bitmask of flags that controls the type of the returned strings. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The returned strings are in Unicode format. If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lpcOptions</i></dt>
<dd>
[out] Pointer to the number of options contained in the structure returned in the <i>lppOptions</i> parameter.</dd>
<dt>
<i>lppOptions</i></dt>
<dd>
[out] Pointer to a pointer to the returned <a href="structyp_7gtd.htm"><b>OPTIONDATA</b></a> structure. The <b>OPTIONDATA</b> structure contains information for a particular messaging address type.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<p>
If anything other than S_OK is returned, the provider is logged off.</p>
<h4>Remarks</h4>
<p>
The MAPI spooler calls the <b>IXPLogon::RegisterOptions</b> method to get the options for messages and recipients supported by a transport provider for a particular messaging address type. These options are then registered with MAPI so they can be displayed in options dialog boxes.</p>
<p>
<b>RegisterOptions</b> returns in the <i>lppOptions </i>parameter pointers to one or two <a href="structyp_7gtd.htm"><b>OPTIONDATA</b></a><b> </b>structures for each supported messaging address type, depending on whether the provider is registered for both recipient and message options, recipient options only, or message options only. If a provider is registered for both option types, <b>RegisterOptions</b> writes one structure containing option information for recipients and one containing option information for messages. For each structure, the <b>ulFlags</b> member indicates whether the options apply to a recipient or a message. </p>
<p>
For an example of the use of <b>OPTIONDATA</b>, consider a transport provider that handles recipients for both Microsoft® Mail Server and Microsoft® Mail Server for the Macintosh. If the provider is registered for both recipient and message options, it provides two pairs of <b>OPTIONDATA </b>structures, one pair for each platform. The MAPI spooler can use these structures to determine what options are valid for each platform and to allow users to change settings for those options.</p>
<p>
MAPI also uses the options registered on the <b>RegisterOptions</b> call to resolve message and recipient options. MAPI does so by using a callback function that the transport provider supplies; this callback function, declared with the <a href="function_5s8b.htm"><b>OPTIONCALLBACK</b></a> function prototype defined in MAPIDEFS.H, receives a wrapped <a href="inter022_00tq.htm"><b>IMAPIProp</b></a> interface that manages the provider's message and recipient properties.</p>
<p>
The transport provider is responsible for memory allocated for any <b>OPTIONDATA</b> structures during this call. The provider should free the memory upon logoff.</p>
<h4>See Also</h4>
<p>
<a href="#_mapi1book_ixplogon_registeroptions"><b>IXPLogon::RegisterOptions</b></a>,<a href="function_5s8b.htm"> <b>OPTIONCALLBACK</b></a>, <a href="structyp_7gtd.htm"><b>OPTIONDATA</b></a></p>
<p>&nbsp;</p></body>
</HTML>
