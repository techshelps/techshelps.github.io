<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Deleting a Message</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_deleting_a_message"></a>Deleting a Message</h2>
<p>
A client can delete a message when it is open and the user is reading it, or when it is closed and the user is viewing the contents table. To protect a user from inadvertently removing a message, MAPI defines message deletion as a two step process:
<ol>
<li>
Mark a message for deletion by moving it to the folder that has been designated as the Deleted Items folder — the folder whose entry identifier is stored in the <a href="propa_3qxw.htm">PR_IPM_WASTEBASKET_ENTRYID</a> property. </li>
<li>
Remove the message by calling the <a href="inter013_1ttf.htm"><b>IMAPIFolder::DeleteMessages</b></a> method.</li>
</ol>
<p>
When a user chooses to delete a message in a folder other than the Deleted Items folder, mark it for deletion. Only when a user selects messages from within the Deleted Items folder should the messages be physically removed from the workstation. You can prompt the user to verify that the user really intended to perform the deletion.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To delete a message</h5>
<ol>
<li>
Confirm with the user that the impending deletion is intentional.</li>
<li>
Determine the parent of the folder to be deleted. If it is the Deleted Items folder or a subfolder within the Deleted Items folder, call <a href="inter013_1ttf.htm"><b>DeleteMessages</b></a> to remove the message.</li>
<li>
If the folder is not contained within the Deleted Items folder, call <a href="inter013_596b.htm"><b>CopyMessages</b></a> with the MESSAGE_MOVE flag set to relocate the message to the Deleted Items folder.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
