<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recipients</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_recipients"></a>Recipients</h1>
<p>
Every message to be transmitted has one or more recipients, or a set of properties that describe where the message is to be delivered. Because recipients are only used in the context of a message, they are considered subobjects of a message rather than separate MAPI objects. Clients and providers work with recipients using the <a href="inter029_525s.htm"><b>IMessage</b></a> interface.</p>
<p>
Clients access a message's recipients through its recipient table. Every message has a recipient table that contains summary information about each of its recipients. The columns included in the table depend on the state of the message. When a message is under composition, its recipients may only have three columns in the table:
<ul>
<li>
Display name, or <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a></li>
<li>
Recipient type, or <a href="propb_0n6t.htm">PR_RECIPIENT_TYPE</a></li>
<li>
Row identifier, or <a href="propb_017o.htm">PR_ROWID</a></li>
</ul>
<p>
After the message has undergone the name resolution process, each recipient will also have an entry identifier, or <a href="propa_8cv8.htm">PR_ENTRYID</a> column. And when the message has been submitted, the rows in the recipient table will add two more columns:
<ul>
<li>
Address type, or <a href="propa_4gkl.htm">PR_ADDRTYPE</a></li>
<li>
Transport responsibility, or <a href="propb_92pl.htm">PR_RESPONSIBILITY</a></li>
</ul>
<p>
Clients can retrieve a message's recipient table by calling its <a href="inter029_9zhh.htm"><b>IMessage::GetRecipientTable</b></a> method or its <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method. Message store providers are expected to support both of these approaches. The<b> OpenProperty</b> approach requires that the client specify IID_IMAPITable as the interface identifier and PR_MESSAGE_RECIPIENTS as the property tag. <a href="propa_1zw3.htm">PR_MESSAGE_RECIPIENTS</a> is a table object property that represents a message's recipient table. Message store providers are required to set PR_MESSAGE_RECIPIENTS for each message and include it in the array of property tags returned from the <a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a> method.</p>
<p>
For more information about working with a recipient table, see <a href="tables_1d4j.htm">Recipient Tables</a>.</p>
<p>
In addition to being used to access a recipient table, PR_MESSAGE_RECIPIENTS can be used:
<ul>
<li>
With <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a> or <a href="inter022_406r.htm"><b>IMAPIProp::CopyProps</b></a> to exclude or include recipients when copying.</li>
<li>
In a subobject restriction to indicate that the child restiction should apply to recipients.</li>
</ul>
<p>
Clients can add recipients to a message by copying entries from the MAPI address book or by creating new entries. These new entries, called one-offs, can exist temporarily or be saved permanently in a modifiable container such as the personal address book (PAB). Whereas recipients that are taken from the address book have entry identifiers associated with their address book provider, one-off recipients have entry identifiers that are formatted by MAPI. Transport providers and clients associate one-off entry identifiers with various types of addresses. </p>
<p>
Transport providers call <a href="inter025_37mu.htm"><b>IMAPISupport::CreateOneOff</b></a> to create a one-off entry identifier for an address on an outgoing message when:
<ul>
<li>
The address belongs to a gateway.</li>
<li>
The address cannot be handled by an address book provider in the current profile.</li>
</ul>
<p>
Clients call <a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a> to create a one-off entry identifier for an address on an incoming message when:
<ul>
<li>
The address is formatted as a one-off address.</li>
<li>
The address is formatted as an Internet address.</li>
</ul>
<p>
For more information about one-off entry identifiers and addresses, see <a href="extend_9ks3.htm">One-Off Entry Identifiers</a> and <a href="extend_6j03.htm">One-Off Addresses</a>.</p>
<p>
The properties of a recipient are a combination of address book properties and properties specific to recipients. All recipients have the base address properties, assigned by address book providers. When an entry is used as a recipient for an outgoing message, the base address properties are copied to the <b>ADRLIST</b> structure that holds the properties for all of a message's recipients. For more information about the base address properties, see <a href="groups_5qnn.htm">Base Address Properties</a>.</p>
<p>
Two properties that are set specifically for recipients are <a href="propb_0n6t.htm">PR_RECIPIENT_TYPE</a> and PR_RESPONSIBILITY. PR_RECIPIENT_TYPE indicates whether a recipient is a primary, carbon copy, blind carbon copy, or a resend recipient. The first three types are assigned to recipients on messages that are being sent for the first time. </p>
<p>
If a recipient does not receive the message and an attempt is made to resend it, the recipient is copied and its type is set to MAPI_P1 to indicate that it is a resend recipient. If only some of the recipients receive a message, their PR_RECIPIENT_TYPE properties are marked with the addition of the MAPI_SUBMITTED flag when the message is resent. Clients are required to handle primary recipients, or recipients with their PR_RECIPIENT_TYPE set to MAPI_TO. All other types are optional.</p>
<p>
<a href="propb_92pl.htm">PR_RESPONSIBILITY</a> is set to indicate to the transport provider whether or not it should handle sending to the recipient. When an outgoing message is first sent, all of the recipients set PR_RESPONSIBILITY to FALSE. As a transport provider claims responsibility for sending to one or more of the recipients, their PR_RESPONSIBILITY properties are set to TRUE. </p>
<p>&nbsp;</p></body>
</HTML>
