<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Forcing a Notification</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_forcing_a_notification"></a>Forcing a Notification</h2>
<p>
When service providers use the <a href="inter025_8uge.htm"><b>IMAPISupport</b></a> methods for notification, MAPI delivers notifications using a hidden window and its corresponding window procedure. For each process to receive a notification, MAPI posts a special message to the hidden window. This message is named with the constant <b>szMAPINotificationMsg</b> which is defined in MAPIDEFS.H. </p>
<p>
You receive these notifications when the hidden window's window procedure processes the <b>szMAPINotificationMsg</b> message. To guarantee that notifications are delivered, it is necessary to wait for and dispatch this <b>szMAPINotificationMsg</b> message. Implementing the logic to achieve this can be done fairly simply, but MAPI provides an entry point into the MAPI(32) DLL called <a href="function_93eb.htm"><b>HrDispatchNotifications</b></a> to make processing even simpler. Call <b>HrDispatchNotifications</b> as follows to receive notifications in your client:</p>
<pre><code>HRESULT hr = HrDispatchNotifications(0);
 </code></pre>
<p>
Because the <b>HrDispatchNotifications</b> entry point was added as of MAPI version 1.0a, you might want to implement special logic if your client code predates this version. This special logic would bind dynamically to <b>HrDispatchNotifications</b> entry point if it is available and use the following code if it is not available:</p>
<pre><code>#include &lt;mapiwin.h&gt;
HRESULT (STDAPICALLTYPE FAR *pDispatchFn)(ULONG ulFlags);
HINSTANCE hInst;
HRESULT hr;

hInst = GetModuleHandle("MAPI"szMAPIDLLSuffix".DLL");
pDispatchFn = GetProcAddress(hInst, "HrDispatchNotifications");
if (pDispatchFn)
    hr = (*pDispatchFn)(0);
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
