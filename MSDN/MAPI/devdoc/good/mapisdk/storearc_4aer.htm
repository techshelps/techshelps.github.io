<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Exposing Folders in Message Stores</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_exposing_folders_in_message_stores"></a>Exposing Folders in Message Stores</h3>
<p>
Every message store provider must present a top-level <a href="inter013_9ohe.htm"><b>IMAPIFolder</b></a> object to client applications. The top-level folder corresponds to the entire message store; it provides access to the folders that users see as the contents of the message store. In addition, the top-level folder is often used as the default receive folder for IPC messages and as the folder from which read reports are sent. Message store providers must also present an IPM subtree — a set of folders used to contain IPM messages — to client applications.</p>
<p>
Client applications can open the top-level folder by calling <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a> with 0 and NULL for the <i>cbEntryId</i> and <i>lpEntryId</i> parameters. In most cases, however, client applications open the set of folders containing IPM messages. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To get a list of folders in the message store's IPM folder tree</h5>
<ol>
<li>
Use your MAPI session to call the <a href="inter023_59id.htm"><b>IMAPISession::OpenMsgStore</b></a> method.</li>
<li>
Use the resulting message database pointer to call the <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method for the <a href="propa_7tb8.htm">PR_IPM_SUBTREE_ENTRYID</a> property.</li>
<li>
Call the <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a> method with the entry identifier to get an <b>IMAPIFolder</b> pointer.</li>
<li>
Call the <a href="inter011_1sh1.htm"><b>IMAPIContainer::GetHierarchyTable</b></a> method to get a table of the contents of the folder.</li>
<li>
Call the <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> method to list the folders in the top-level folder.</li>
</ol>
<p>
MAPI clients use these folders to access other folder objects and message objects in the message store. <b>IMAPIFolder</b>, and its parent interface <a href="inter011_7u0g.htm"><b>IMAPIContainer</b></a>, contain the methods your message store provider must implement to populate folders with message objects and respond to clients' requests to operate on messages.</p>
<p>&nbsp;</p></body>
</HTML>
