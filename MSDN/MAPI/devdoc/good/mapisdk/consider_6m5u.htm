<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing a Progress Indicator</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_implementing_a_progress_indicator"></a>Implementing a Progress Indicator</h2>
<p>
Many of the operations initiated by clients take a significant amount of time. One of the input parameters to these potentially lengthy operations is a pointer to a progress object — an object that implements the <a href="inter021_7icu.htm"><b>IMAPIProgress</b></a> interface. Progress objects control the appearance and display of progress indicators and are implemented by clients and by MAPI. You can choose whether or not to implement a progress object; the MAPI implementation is available for service providers to use if you elect not to supply an implementation.</p>
<p>
Progress objects work with the following pieces of data:
<ul>
<li>
A global minimum value which, when your <a href="inter021_5esz.htm"><b>IMAPIProgress::Progress</b></a> method is called, should be less than or equal to the value of the <i>ulValue</i> parameter. At the beginning of the operation, <i>ulValue</i> will be equal to this minimum value. </li>
<li>
A global maximum value which, when your <b>IMAPIProgress::Progress</b> method is called, should be greater than or equal to the <i>ulValue </i>parameter. At the end of the operation, <i>ulValue</i> will be equal to this maximum value. </li>
<li>
A flags value which indicates whether the progress corresponds to a top or lower level item.</li>
<li>
A value that indicates the current level of progress for the operation.</li>
<li>
The number of the currently processed item relative to the total.</li>
<li>
The total number of items to be processed during the operation.</li>
</ul>
<p>
</p>
<p>
The minimum and maximum values represent the beginning and end of the operation in numeric form. Use 0 for the initial minimum value and 1000 for the initial maximum value, passing these values to service providers in the <a href="inter021_935a.htm"><b>IMAPIProgress::GetMin</b></a> and <a href="inter021_92rc.htm"><b>IMAPIProgress::GetMax</b></a><b> </b>methods. Service providers reset these values when they call <a href="inter021_1wfn.htm"><b>IMAPIProgress::SetLimits</b></a>. </p>
<p>
The flags value is used by service providers to determine how they should set the other values. Initialize the flags value to MAPI_TOP_LEVEL and return this value in your implementation of <b>GetFlags</b> until the service provider resets it by calling <b>SetLimits</b>. </p>
<p>
In your implementation of the <b>SetLimits</b> method, save local copies of each of the parameters: <i>lpulMin</i>, <i>lpulMax</i>, and <i>lpulFlags</i>. These values should be readily available when a service provider calls your <b>GetMin</b>, <b>GetMax</b>, or <b>GetFlags</b> methods. </p>
<p>
To update the display of the progress indicator, service providers call your <b>IMAPIProgress::Progress</b> method. There are three parameters to this method: a value, a count, and a total. Use the first parameter, <i>ulValue</i>, to display the progress indicator. The <i>ulValue</i> parameter is the progress indicator and will be equal to global <i>ulMin</i> only at the very beginning of the operation and equal to global <i>ulMax</i> only at the completion of the operation.</p>
<p>
Use the second and third parameters, <i>ulCount</i> and <i>ulTotal</i>, if available, to display an optional message such as "5 items completed out of 10." If the second and third parameters are set to 0, you can choose whether or not to visually change the progress indicator. Some service providers set these parameters to zeroes to indicate that they are processing a subobject whose progress is monitored relative to a parent object. In this situation, it makes sense to change the display only when the parent object reports progress. Some service providers pass zeroes for these parameters every time. </p>
<p>&nbsp;</p></body>
</HTML>
