<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAddrBook::OpenEntry</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iaddrbook_openentry"></a>IAddrBook::OpenEntry</h2>
<p>
The <b>IAddrBook::OpenEntry</b> method opens an address book entry and returns a pointer to an interface that can be used to access the entry.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter006_23e8.htm"><b>IAddrBook : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT OpenEntry(
  ULONG</b><i> cbEntryID</i><b>,</b>       
<b>  LPENTRYID</b><i> lpEntryID</i><b>,</b>   
<b>  LPCIID</b><i> lpInterface</i><b>,</b>    
<b>  ULONG</b><i> ulFlags</i><b>,</b>         
<b>  ULONG FAR *</b><i> lpulObjType</i><b>,</b>   
<b>  LPUNKNOWN FAR *</b><i> lppUnk </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cbEntryID</i></dt>
<dd>
[in] Count of bytes in the entry identifier pointed to by the <i>lpEntryID </i>parameter.</dd>
<dt>
<i>lpEntryID</i></dt>
<dd>
[in] Pointer to the entry identifier representing the address book entry to open.</dd>
<dt>
<i>lpInterface</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) of the interface to be used to access the open entry. Passing NULL results in the object's standard interface being returned. For messaging users, the standard interface is <a href="inter009_3sc0.htm"><b>IMailUser</b></a>. For distribution lists, it is <a href="inter008_5tf6.htm"><b>IDistList</b></a> and for containers, it is <a href="inter003_4gxe.htm"><b>IABContainer</b></a>. Callers can set <i>lpInterface</i> to the appropriate standard interface or an interface in the inheritance hierarchy.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the entry is opened. The following flags can be set:
<dl>
<dt>
MAPI_BEST_ACCESS</dt>
<dd>
Requests that the entry be opened with the maximum allowable network and client permissions. For example, if the client has read/write access, the address book provider should attempt to open the entry with read/write access. 
<p>
The client can retrieve the access level that was granted by calling the open entry's <b>IMAPIProp::GetProps</b> method and retrieving the <a href="propa_4w8c.htm">PR_ACCESS_LEVEL</a> property.
</dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
Allows the call to succeed potentially before the entry is fully open and accessible, implying that subsequent calls to the entry might return an error.</dd>
<dt>
MAPI_MODIFY</dt>
<dd>
Requests that the entry be opened with read/write access. Because by default, entries are opened with read-only access, clients should not assume that read/write access has been granted regardless of whether MAPI_MODIFY is set.</dd>
</dl>
</dd>
<dt>
<i>lpulObjType</i></dt>
<dd>
[out] Pointer to the type of the opened entry.</dd>
<dt>
<i>lppUnk</i></dt>
<dd>
[out] Pointer to a pointer to the opened entry. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The entry was successfully opened.</dd>
<dt>
MAPI_E_NO_ACCESS</dt>
<dd>
An attempt was made to open an entry for which the user has insufficient permissions.</dd>
<dt>
MAPI_E_NOT_FOUND</dt>
<dd>
The entry represented by <i>lpEntryID</i> does not exist.</dd>
<dt>
MAPI_E_UNKNOWN_ENTRYID</dt>
<dd>
The entry identifier specified in <i>lpEntryID</i> is not recognized. This value is typically returned if the address book provider responsible for the corresponding entry is not open.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Clients and service providers call the <b>IAddrBook::OpenEntry</b> method to open an address book entry. MAPI forwards the call to the appropriate address book provider, based on the <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> structure included in the entry identifier passed in the <i>lpEntryID</i> parameter. The address book provider opens the entry as read-only unless the MAPI_MODIFY or MAPI_BEST_ACCESS flag in the <i>ulFlags</i> parameter is set. However, these flags are suggestions. If the address book provider does not allow modification for the entry requested, then it returns MAPI_E_NO_ACCESS. </p>
<p>
The <i>lpInterface</i> parameter indicates which interface should be used to access the opened entry. Passing NULL in <i>lpInterface</i> indicates the standard MAPI interface for that type of entry should be used. Because the address book provider might return a different interface than the one suggested by the <i>lpInterface</i> parameter, the caller should check the value returned in the <i>lpulObjType</i> parameter to determine that the object type returned is what was expected. If the object type is not of the type expected, the caller can cast the <i>lppUnk</i> parameter to a type that is more appropriate.</p>
<p>&nbsp;</p></body>
</HTML>
