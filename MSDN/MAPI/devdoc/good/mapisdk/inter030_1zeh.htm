<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMsgServiceAdmin::SetPrimaryIdentity</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imsgserviceadmin_setprimaryidentity"></a>IMsgServiceAdmin::SetPrimaryIdentity</h2>
<p>
The <b>IMsgServiceAdmin::SetPrimaryIdentity</b> method designates a message service to be the supplier of the primary identity for the profile.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter030_7bxq.htm"><b>IMsgServiceAdmin : IUnknown</b></a>.</p>
<pre><code><b>HRESULT SetPrimaryIdentity(
  LPMAPIUID</b><i> lpUID</i><b>,</b>   
<b>  ULONG</b><i> ulFlags      </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpUID</i></dt>
<dd>
[in] Pointer to the <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> structure holding the unique identifier for the message service to supply the primary identity, or NULL, indicating that <b>SetPrimaryIdentity</b> should clear the current identity.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The message service was successfully assigned the supplier of the primary identity.</dd>
<dt>
MAPI_E_NO_ACCESS</dt>
<dd>
<b>SetPrimaryIdentity</b> attempted to designate a message service that has the SERVICE_NO_PRIMARY_IDENTITY flag set in its <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a> property.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMsgServiceAdmin::SetPrimaryIdentity</b> method establishes a message service as the supplier of the primary identity for the profile. The primary identity is typically the user logged on to the message service. It is represented by three properties:</p>
<p class=indent1>
<a href="propa_4sl5.htm">PR_IDENTITY_DISPLAY</a></p>
<p class=indent1>
<a href="propa_3q1w.htm">PR_IDENTITY_ENTRYID</a></p>
<p class=indent1>
<a href="propa_0r7d.htm">PR_IDENTITY_SEARCH_KEY</a></p>
<p>
Every service provider in the designated message service sets these three properties to the display name, entry identifier, and search key of the messaging user that is supplying the primary identity. Clients can retrieve the primary identity's entry identifier by calling <a href="inter023_7x89.htm"><b>IMAPISession::QueryIdentity</b></a>. </p>
<p>
Another property, <a href="propb_4u5v.htm">PR_RESOURCE_FLAGS</a>, is set to STATUS_PRIMARY_IDENTITY for every provider that is a member of the message service supplying the primary identity and to SERVICE_PRIMARY_IDENTITY for the message service. When a service provider cannot supply the primary identity for its message service, it sets PR_RESOURCE_FLAGS to STATUS_NO_PRIMARY_IDENTITY. <b>SetPrimaryIdentity</b> sets the PR_RESOURCE_FLAGS property of each message service that is not supplying the primary identity to SERVICE_NO_PRIMARY_IDENTITY.</p>
<p>
Each message service provider that MAPI has information about can establish an identity for each of its users when a client logs on to the service. However, because MAPI supports connections to multiple service providers for each MAPI session, there is no firm definition of a particular user's identity for the MAPI session as a whole; a user's identity depends on which service is involved. Clients can call <b>SetPrimaryIdentity</b> to designate one of the many identities established for a user by message services as the primary identity for that user. </p>
<h4>See Also</h4>
<p>
<a href="inter023_7x89.htm"><b>IMAPISession::QueryIdentity</b></a>, <a href="structyp_3p9g.htm"><b>MAPIUID</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
