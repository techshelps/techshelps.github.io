<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISupport::GetOneOffTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisupport_getoneofftable"></a>IMAPISupport::GetOneOffTable</h2>
<p>
The <b>IMAPISupport::GetOneOffTable</b> method returns a pointer to the MAPI one-off table — a list of templates supported by all address book providers for creating new recipients.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter025_8uge.htm"><b>IMAPISupport : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetOneOffTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the type of the string columns. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The string columns are in Unicode format. If the MAPI_UNICODE flag is not set, the string columns are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the one-off table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The one-off table was successfully retrieved.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISupport::GetOneOffTable </b>method is implemented for address book provider support objects. Address book providers call <b>GetOneOffTable</b> to retrieve the complete list of templates for creating new recipients. Included in this table are templates supported by all of the address book providers active in the session as well as templates supported by MAPI.</p>
<p>
The newly created recipients can be used to address a message or added to an address book container.</p>
<p>
For a list of the properties that make up the required column set in one-off tables, see <a href="tables_81pv.htm">One-Off Tables</a>.</p>
<p>
Setting the MAPI_UNICODE flag in the <i>ulFlags </i>parameter affects the format of the columns returned from the following <b>IMAPITable</b> methods:</p>
<p class=indent1>
<a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a></p>
<p class=indent1>
<a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a></p>
<p>
This flag also controls the property types in the sort order returned by the <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> method.</p>
<h4>Notes to Callers</h4>
<p>
If registered for notification of changes to this one-off table, you will also receive notifications of changes made to other providers' one-off tables. Based on these notifications, you can support new address types that are added during the current session.</p>
<h4>See Also</h4>
<p>
<a href="inter003_8b21.htm"><b>IABContainer::CreateEntry</b></a>, <a href="inter025_8q2h.htm"><b>IMAPISupport::NewEntry</b></a>, <a href="propa_6h83.htm">PR_CREATE_TEMPLATES</a></p>
<p>&nbsp;</p></body>
</HTML>
