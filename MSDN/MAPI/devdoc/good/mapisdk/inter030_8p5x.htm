<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMsgServiceAdmin::GetProviderTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imsgserviceadmin_getprovidertable"></a>IMsgServiceAdmin::GetProviderTable</h2>
<p>
The <b>IMsgServiceAdmin::GetProviderTable</b> method provides access to the provider table — a listing of the service providers in the profile.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter030_7bxq.htm"><b>IMsgServiceAdmin : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetProviderTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the type of the string columns returned in the table. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The string columns are in Unicode format. If the MAPI_UNICODE flag is not set, the string columns are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the provider table.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The provider table was successfully returned.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMsgServiceAdmin::GetProviderTable</b> method provides access to the MAPI provider table, a table that lists all of the address book, message store, transport, and message hook providers currently installed in the profile. </p>
<p>
Unlike the provider table returned through <a href="inter038_5alh.htm"><b>IProviderAdmin::GetProviderTable</b></a>, the provider table returned through <b>IMsgServiceAdmin::GetProviderTable</b> cannot include additional rows that represent information associated with one or more service providers in the profile. </p>
<p>
Providers that have been deleted, or are in use but have been marked for deletion, are not included in the provider table. Provider tables are static, meaning that subsequent additions to or deletions from the profile are not reflected in the table. </p>
<p>
If the profile has no providers, <b>GetProviderTable</b> returns a table with zero rows and the S_OK return value. </p>
<p>
Setting the MAPI_UNICODE flag in the <i>ulFlags </i>parameter affects the format of the columns returned from the following <b>IMAPITable</b> methods:</p>
<p class=indent1>
<a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a> </p>
<p class=indent1>
<a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> </p>
<p>
This flag also controls the property types in the sort order returned by the <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> method.</p>
<p>
For a complete list of the columns in the provider table, see <a href="tables_6vs5.htm">Provider Table</a>. </p>
<h4>Notes to Callers</h4>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To retrieve the rows of a provider table in transport order</h5>
<ol>
<li>
Call <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a> to impose a property restriction that matches the <a href="propb_0oh1.htm">PR_RESOURCE_TYPE</a> property with MAPI_TRANSPORT_PROVIDER.</li>
<li>
Call <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a> to sort the table by the <a href="propb_80mk.htm">PR_PROVIDER_ORDINAL</a> column. </li>
<li>
Call <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> to get the rows of the table. </li>
</ol>
<p>
An alternative to these calls is to make a single call to the <a href="function_0dgz.htm"><b>HrQueryAllRows</b></a> function with all of the appropriate data structures passed in. </p>
<p>
If you retrieve the PR_SERVICE_UID columns in each of the rows, you can use this array of <b>MAPIUID</b> structures to set the transport order in a call to <a href="inter030_0ysy.htm"><b>IMsgServiceAdmin::MsgServiceTransportOrder</b></a>.</p>
<p>
Setting the MAPI_UNICODE flag in the <i>ulFlags </i>parameter does the following: 
<ul>
<li>
Sets the string type to Unicode for data returned for the initial active columns of the provider table by the <a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a> method. The initial active columns for a provider table are those columns the <b>QueryColumns</b> method returns before the provider that contains the table calls the <a href="inter026_7x83.htm"><b>IMAPITable::SetColumns</b></a> method. </li>
<li>
Sets the string type to Unicode for data returned for the initial active rows of the provider table by <b>QueryRows</b>. The initial active rows for a provider table are those rows <b>QueryRows</b> returns before the provider that contains the table calls <b>SetColumns</b>. </li>
<li>
Controls the property types of the sort order returned by the <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> method before the client that contains the provider table calls the <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a> method.</li>
</ul>
<h4>See Also</h4>
<p>
<a href="inter030_4did.htm"><b>IMsgServiceAdmin::GetMsgServiceTable</b></a>, <a href="inter030_0ysy.htm"><b>IMsgServiceAdmin::MsgServiceTransportOrder</b></a>, <a href="inter038_5alh.htm"><b>IProviderAdmin::GetProviderTable</b></a></p>
<p>&nbsp;</p></body>
</HTML>
