<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAddrBook::CreateOneOff</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iaddrbook_createoneoff"></a>IAddrBook::CreateOneOff</h2>
<p>
The <b>IAddrBook::CreateOneOff</b> method creates an entry identifier for a one-off address.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter006_23e8.htm"><b>IAddrBook : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT CreateOneOff(
  LPTSTR</b><i> lpszName</i><b>,</b>           
<b>  LPTSTR</b><i> lpszAdrType</i><b>,</b>        
<b>  LPTSTR</b><i> lpszAddress</i><b>,</b>        
<b>  ULONG</b><i> ulFlags</i><b>,</b>             
<b>  ULONG FAR *</b><i> lpcbEntryID</i><b>,</b>   
<b>  LPENTRYID FAR *</b><i> lppEntryID  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszName</i></dt>
<dd>
[in] Pointer to the display name of the recipient — the <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> property. The <i>lpszName</i> parameter can be NULL.</dd>
<dt>
<i>lpszAdrType</i></dt>
<dd>
[in] Pointer to the address type of the recipient, such as FAX or SMTP. The <i>lpszAdrType</i> parameter cannot be NULL. </dd>
<dt>
<i>lpszAddress</i></dt>
<dd>
[in] Pointer to the address of the recipient. The <i>lpszAddress</i> parameter cannot be NULL. </dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that that affects the one-off recipient. The following flags can be set:
<dl>
<dt>
MAPI_SEND_NO_RICH_INFO</dt>
<dd>
The recipient cannot handle formatted message content. If MAPI_SEND_NO_RICH_INFO is set, MAPI sets the recipient's <a href="propb_7wmn.htm">PR_SEND_RICH_INFO</a> property to FALSE. If MAPI_SEND_NO_RICH_INFO is not set, MAPI sets this property to TRUE unless the recipient's messaging address pointed to by <i>lpszAddress</i> is interpreted to be an Internet address. In this case, MAPI sets PR_SEND_RICH_INFO to FALSE.</dd>
<dt>
MAPI_UNICODE</dt>
<dd>
The display name, address type, and address are in Unicode format. If the MAPI_UNICODE flag is not set, these strings are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lpcbEntryID</i></dt>
<dd>
[out] Pointer to the count of bytes in the entry identifier pointed to by the <i>lppEntryID</i> parameter.</dd>
<dt>
<i>lppEntryID</i></dt>
<dd>
[out] Pointer to a pointer to the entry identifier for the one-off recipient.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The one-off entry identifier was created successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Clients call the <b>IAddrBook::CreateOneOff</b> method to create an entry identifier for a one-off recipient — a recipient that does not belong to any of the containers from any of the currently loaded address book providers. One-off recipients can have any type of address that is supported by one of the active address book providers for the session. </p>
<p>
One-off recipients are typically created with a template for their particular address type. The address book provider that supports the address type supplies the template. A user of a client application enters the relevant information into the template.</p>
<p>
MAPI supports Unicode character strings for the display name, address type, and address parameters to <b>CreateOneOff</b> on Windows NT platforms only.</p>
<p>
The MAPI_SEND_NO_RICH_INFO flag controls whether or not formatted text in Rich Text Format (RTF) is sent along with each message. The Transport Neutral Encapsulation Format (TNEF) — a format used for transmitting formatted text — is sent by most transport providers, regardless of how the recipient sets its PR_SEND_RICH_INFO property. This is not an issue for messaging clients that work with interpersonal messages, but because TNEF is typically used to send custom properties for custom message classes, not supporting it can be a problem for form-based clients or clients that require custom MAPI properties. For more information, see <a href="extend_2g4m.htm">Sending Messages with TNEF</a>.</p>
<h4>See Also</h4>
<p>
<a href="inter025_37mu.htm"><b>IMAPISupport::CreateOneOff</b></a></p>
<p>&nbsp;</p></body>
</HTML>
