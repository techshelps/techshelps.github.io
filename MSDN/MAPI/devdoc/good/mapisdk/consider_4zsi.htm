<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening a View Descriptor</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_opening_a_view_descriptor"></a>Opening a View Descriptor</h2>
<p>
Many folders can be opened with a normal view, a default view, or any number of personalized views. A view describes how to display the contents of a folder. The normal view is used when there is no alternative view and when you are opening the folder for the first time. When an alternative view does exist, you must use it to open the folder. </p>
<p>
A view is described in a message known as a view descriptor. View descriptors are typically created as associated messages and can appear in either the common or personal view folders or in any IPM folder.</p>
<h5>To open a view descriptor</h5>
<ol>
<li>
Call <a href="inter011_0sx1.htm"><b>IMAPIContainer::GetContentsTable</b></a><b> </b>to retrieve the associated contents table for the folder.</li>
<li>
Create a restriction that locates only messages with the message class reserved for view descriptors and call <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a> to limit the table and <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> to retrieve the appropriate rows. <p>
– Or –
<p>
Call the folder's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method to retrieve its <a href="propa_80pw.htm">PR_DEFAULT_VIEW_ENTRYID</a> property. PR_DEFAULT_VIEW_ENTRYID contains the entry identifier for the message containing the default view descriptor for a folder. This call will succeed if the folder supports the use of the MAPI_ASSOCIATED flag on calls to <a href="inter013_7wv9.htm"><b>IMAPIFolder::CreateMessage</b></a> and <a href="inter011_0sx1.htm"><b>IMAPIContainer::GetContentsTable</b></a>. 
</li>
<li>
Call <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a> with the entry identifier of the view descriptor to open it. </li>
</ol>
<p>&nbsp;</p></body>
</HTML>
