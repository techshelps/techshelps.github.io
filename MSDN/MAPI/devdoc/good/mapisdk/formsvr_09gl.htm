<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Integrating MAPI Form Server Code with Windows Code</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_integrating_mapi_form_server_code_with_windows_code"></a>Integrating MAPI Form Server Code with Windows Code</h2>
<p>
Recall that your form server is a Win32 or Win16 program. As such, there are some tasks related to loading your form server into memory and exiting cleanly. Like all Windows programs, the entry point for your form server is the <b>WinMain</b> function. This function is the appropriate place to perform the following tasks:
<ul>
<li>
Creating and registering a window class so that your form server can interact with other OLE components.</li>
<li>
Creating and registering a window class or classes for your form objects' user interfaces.</li>
<li>
Calling the <a href="function_6ycl.htm"><b>MAPIInitialize</b></a> function. <b>MAPIInitialize</b> handles the required OLE initialization for you as well. This must be done once per instance of your form server.</li>
<li>
Registering a global atom with a string representation of the form server's class identifier (CLSID). This atom should exist for the lifetime of the form server.</li>
<li>
Calling the OLE function <b>CoRegisterClassObject</b> to register your form server's class factory with OLE.</li>
<li>
Creating a main window to receive messages. This window probably does not need to be visible since the user will be interacting with the specific windows associated with individual form objects. However, during development, the main window can be a convenient place for debugging output or control of your form server.</li>
<li>
Creating a message loop which runs for the lifetime of the form server, translating and dispatching windows messages to active form objects.</li>
</ul>
<p>
When your form server exits, it should perform the following tasks:
<ul>
<li>
Call the OLE function <b>CoRevokeClassObject</b> to revoke your message class's OLE registration.</li>
<li>
Call <a href="function_6pk5.htm"><b>MAPIUninitialize</b></a> to properly close the form server's connection to MAPI.</li>
<li>
Delete the global atom containing the string representation of the class identifier.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
