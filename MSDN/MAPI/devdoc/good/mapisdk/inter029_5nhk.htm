<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMessage::CreateAttach</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imessage_createattach"></a>IMessage::CreateAttach</h2>
<p>
The <b>IMessage::CreateAttach</b> method creates a new attachment.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter029_525s.htm"><b>IMessage : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT<i> </i>CreateAttach(
  LPCIID</b><i> lpInterface</i><b>,</b>              
<b>  ULONG</b><i> ulFlags</i><b>,</b>                   
<b>  ULONG FAR *</b><i> lpulAttachmentNum</i><b>,</b>   
<b>  LPATTACH FAR *</b><i> lppAttach         </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpInterface</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) representing the interface to be used to access the message. Passing NULL results in the message's standard interface, or <b>IMessage</b>, being returned. </dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the attachment is created. The following flag can be set:
<dl>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
Allows <b>CreateAttach</b> to return successfully, possibly before the attachment is fully accessible to the calling client. If the attachment is not accessible, making a subsequent call to it can result in an error.</dd>
</dl>
</dd>
<dt>
<i>lpulAttachmentNum</i></dt>
<dd>
[out] Pointer to an index number identifying the newly created attachment. This number is valid only when the message is open and is the basis for the attachment's <a href="propa_0p4d.htm">PR_ATTACH_NUM</a> property.</dd>
<dt>
<i>lppAttach</i></dt>
<dd>
[out] Pointer to a pointer to the open attachment object.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The attachment was successfully created.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMessage::CreateAttach</b> method creates a new attachment within a message. The new attachment and any properties that are set for it are not available until a client has called the attachment's <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a><b> </b>method and the message's <b>IMAPIProp::SaveChanges </b>method. Both the attachment and its message have to be saved before the attachment is included in the message's attachment table. </p>
<p>
The attachment number pointed to by <i>lpulAttachmentNum</i> is unique and valid only within the context of the message. That is, two attachments in two different messages can have the same number while two attachments in the same message cannot.</p>
<p>&nbsp;</p></body>
</HTML>
