<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ValidateParms</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_validateparms"></a>ValidateParms</h2>
<p>
The <b>ValidateParms</b> macro calls an internal function to check the parameters client applications have passed to service providers. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIVAL.H </td>
</tr>
<tr valign=top>
<td width=48%>Implemented by: </td>
<td width=52%>MAPI </td>
</tr>
<tr valign=top>
<td width=48%>Called by: </td>
<td width=52%>Service providers </td>
</tr>
</table><br>
<pre><code><b>HRESULT ValidateParms(
  METHODS</b><i> eMethod</i><b>,</b>   
<b>  LPVOID</b><i> First       </i>
<b>);</b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>eMethod </i></dt>
<dd>
[in] Specifies, by enumeration, the method to validate. </dd>
<dt>
<i>First </i></dt>
<dd>
[in] Pointer to the first argument on the stack. 
</dd>
</dl>
<h4>Return Values </h4>
<dl>
<dt>
S_OK </dt>
<dd>
All of the parameters are valid. </dd>
<dt>
MAPI_E_CALL_FAILED </dt>
<dd>
One or more of the parameters are not valid. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
Parameters passed between MAPI and service providers are assumed to be correct and undergo only debug validation with the <a href="function_5zxv.htm"><b>CheckParms</b></a> macro. Providers should check all parameters passed in by client applications, but clients should assume that MAPI and provider parameters are correct. Use the <b>HR_FAILED</b> macro to test return values. </p>
<p>
<b>ValidateParms</b> is called differently depending on whether the calling code is C or C++. C++ passes an implicit parameter known as <i>this </i>to each method call, which becomes explicit in C and is the address of the object. The first parameter, <i>eMethod</i>, is an enumerator made from the interface and method being validated and tells what parameters to expect to find on the stack. The second parameter is different for C and C++. In C++ it is called <i>First</i>, and it is the first parameter to the method being validated. The second parameter for the C language, <i>ppThis</i>, is the address of the first parameter to the method which is always an object pointer. In both cases, the second parameter gives the address of the beginning of the method's parameter list, and based on <i>eMethod</i>, moves down the stack and validates the parameters. </p>
<p>
Providers implementing common interfaces such as <b>IMAPITable</b> and <b>IMAPIProp</b> should always check parameters using the <b>ValidateParms</b> function in order to ensure consistency across all providers. Additional parameter validation functions have been defined for some complex parameter types to be used instead as appropriate. See the reference topics for the following functions: </p>
<p class=indent1>
<a href="function_1ino.htm"><b>FBadColumnSet</b></a></p>
<p class=indent1>
<a href="function_1838.htm"><b>FBadEntryList</b></a></p>
<p class=indent1>
<a href="function_70s0.htm"><b>FBadProp</b></a></p>
<p class=indent1>
<a href="function_1x9j.htm"><b>FBadPropTag</b></a></p>
<p class=indent1>
<a href="function_6sha.htm"><b>FBadRestriction</b></a></p>
<p class=indent1>
<a href="function_4vxg.htm"><b>FBadRglpNameID</b></a></p>
<p class=indent1>
<a href="function_2ozb.htm"><b>FBadRglpszW</b></a></p>
<p class=indent1>
<a href="function_7b93.htm"><b>FBadRow</b></a></p>
<p class=indent1>
<a href="function_53ck.htm"><b>FBadRowSet</b></a></p>
<p class=indent1>
<a href="function_6i7o.htm"><b>FBadSortOrderSet</b></a></p>
<p>
Inherited methods use the same parameter validation as the interface from which they inherit. For example, the parameter checking for <b>IMessage</b> and <b>IMAPIProp</b> should be the same. </p>
<p>
For more information on parameter validation, see <a href="extend_72pf.htm">Validating Parameters to Interface Methods</a>. </p>
<h4>See Also </h4>
<p>
<a href="groups_04oj.htm">Parameter Validation Macros</a>, <a href="function_4ss3.htm"><b>UlValidateParms</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
