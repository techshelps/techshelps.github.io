<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sharing Simple MAPI Sessions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_sharing_simple_mapi_sessions"></a>Sharing Simple MAPI Sessions</h2>
<p>
Workgroup applications should all be able to work from the same profile without presenting logon or profile-selection dialog boxes when each application begins. A MAPI shared session is established once but can be used by other clients. Only one shared session can exist on a given computer at a time. The shared session can be used with any profile. If your client application must use a non-shareable session — that is, your client needs to be guaranteed that no other clients will use its session — then it must use the <a href="smapiref_68tq.htm"><b>MAPILogon</b></a> function in the MAPI API, which has a broader range of functionality than the Simple MAPI logon function.</p>
<p>
By default, Simple MAPI attempts to use the shared session if it exists. If no shared session exists, Simple MAPI will create a new shared session when you call <b>MAPILogon</b>. If you log on with the MAPI_NEW_SESSION flag set, then Simple MAPI will create a new shared session regardless of whether one already exists.</p>
<p>
The session handles returned to clients using a shared session are not the same. Each client, regardless of whether it is using a unique session or a shared session, has its own unique handle. Session handles are not valid across tasks, even when those handles represent the same shared session.</p>
<p>&nbsp;</p></body>
</HTML>
