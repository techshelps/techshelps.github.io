<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing the InboundMsgHook and OutboundMsgHook Methods for Hook Providers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_implementing_the_inboundmsghook_and_outboundmsghook_methods_for_hook_providers"></a>Implementing the InboundMsgHook and OutboundMsgHook Methods for Hook Providers</h3>
<p>
You have considerable latitude in how you implement the specifics of the <a href="inter039_0mcr.htm"><b>InboundMsgHook</b></a> and <a href="inter039_6yi3.htm"><b>OutboundMsgHook</b></a> methods. In general, these methods compare one or more properties of the input message against the rules the hook provider implements. Based on these comparisons, the message can be modified, moved to a different message store, moved to a different folder by returning a different folder entry identifier, or marked for deletion by the MAPI spooler by returning a null folder entry identifier.</p>
<p>
In addition, these methods return one or both of the flags HOOK_CANCEL and HOOK_DELETE to indicate how the MAPI spooler should react to the <b>InboundMsgHook</b> method's actions. The HOOK_CANCEL flag indicates that no other hook providers should be called for the message. The HOOK_DELETE flag indicates that the MAPI spooler should delete the message; the hook provider should never use calls to the message store provider to delete the message directly but should set the HOOK_DELETE flag and allow the MAPI spooler to delete the message.</p>
<p>
Hook providers can create additional messages based on the input message if desired. However, if the hook provider intends for an additional message to be submitted for sending, the message must be created using the default message store provider object provided by the MAPI spooler. </p>
<p>
The <b>InboundMsgHook</b> and <b>OutboundMsgHook</b> methods are nearly identical as far as interaction with message objects and message stores. The only architectural difference is that the MAPI spooler calls them at different times. Many hook provider implementations can share substantial portions of code between these methods because they are so similar in function.</p>
<p>
See <a href="inter039_0mcr.htm"><b>InboundMsgHook</b></a> and <a href="inter039_6yi3.htm"><b>OutboundMsgHook</b></a> for details on how to treat the flags and folder entry identifier parameters.</p>
<p>&nbsp;</p></body>
</HTML>
