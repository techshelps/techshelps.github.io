<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying and Editing Addresses with Simple MAPI</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_displaying_and_editing_addresses_with_simple_mapi"></a>Displaying and Editing Addresses with Simple MAPI</h2>
<p>
The <a href="smapiref_13tr.htm"><b>MapiRecipDesc</b></a> structure, which describes a recipient, contains both the recipient's address and the recipient's "friendly name." The address, contained in the <b>lpszAddress</b> member, contains the address that the messaging system uses to deliver the message. This can take a number of forms depending on what type of address it is. All addresses are of the form [<i>AddressType</i>][<i>E-mail Address</i>]. For example, an internet address could be SMTP:jdoe@microsoft.com, while a fax gateway address could be FAX:206-555-1212.</p>
<p>
The friendly name, stored in the <b>lpszName</b> member, typically contains the recipient's actual name or some variation of it. Whenever possible, the messaging system places a value in this member when a message is retrieved from a message store. However, not all addresses can be assigned a friendly name. For example, a fax gateway address might not correspond to a specific person, so the address book might not contain a name associated with that address. Similarly, the nature of internet addresses is such that the messaging system might not be able to determine a friendly name for messages that come into the system through an internet gateway; the address book cannot contain entries for every valid internet address, and the format of internet addresses does not mandate that a friendly name be attached to them.</p>
<p>
You should display friendly names to the user when these names are available. When they are not, it is acceptable to display the actual address instead. When forwarding or replying to a message, you should never allow the user to edit the friendly name or address fields of a <b>MapiRecipDesc</b> structure that the messaging system has returned with a message. Both friendly names and addresses should be treated as indivisible entities.</p>
<p>
When displaying a message to the user, make a distinction between different types of recipients that might be present in the message's <b>lpOriginator</b> and <b>lpRecips</b> members. The <b>lpOriginator</b> member contains the address and friendly name of the individual who sent the message. Display this recipient (note that the originator of a message is still called a recipient because both originators and actual recipients are described by <b>MapiRecipDesc</b> structures) so that the user is aware of this recipient's role.</p>
<p>
Recipients stored in the <b>lpRecips</b> member can have one of four different roles. The <b>ulRecipClass</b> member of the <a href="smapiref_13tr.htm"><b>MapiRecipDesc</b></a> structure stores this information.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=19%>Role</th>
<th align=left width=81%>Description</th>
</tr>
<tr valign=top>
<td width=19%>MAPI_TO</td>
<td width=81%>The recipient is a primary recipient of the original message.</td>
</tr>
<tr valign=top>
<td width=19%>MAPI_CC</td>
<td width=81%>The recipient received a carbon copy of the original message.</td>
</tr>
<tr valign=top>
<td width=19%>MAPI_BCC</td>
<td width=81%>The recipient received a blind carbon copy of the original message.</td>
</tr>
<tr valign=top>
<td width=19%>MAPI_ORIG</td>
<td width=81%>The recipient sent the message.</td>
</tr>
</table><br>
<p>
In practice, MAPI_BCC and MAPI_ORIG are less common than the others. MAPI_BCC should only occur if the user reading the message is the one who received a blind carbon copy. The semantics of MAPI_BCC are such that no one besides the originator and a MAPI_BCC recipient should ever know that the recipient received the message. MAPI_ORIG should only occur if the user sent a message to himself or herself.</p>
<p>&nbsp;</p></body>
</HTML>
