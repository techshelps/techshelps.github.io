<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting Formatted Text in Outgoing Messages: Client Responsibilities</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_supporting_formatted_text_in_outgoing_messages_client_responsibilities"></a>Supporting Formatted Text in Outgoing Messages: Client Responsibilities </h2>
<p>
Clients set either the <a href="propa_9lvd.htm">PR_BODY</a> property, the <a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a> property, or both properties for an outgoing message. Clients that support only plain text set only the PR_BODY property. Rich Text Format (RTF)-aware clients might set both properties or only PR_RTF_COMPRESSED, depending on the message store provider being used. </p>
<p>
It is important for a client to check its message store's <a href="propb_01t7.htm">PR_STORE_SUPPORT_MASK</a> property to determine whether the store supports RTF. If the message store is not RTF-aware, an RTF-aware client sets both the <a href="propa_9lvd.htm">PR_BODY</a> and <a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a> properties for each outgoing message. </p>
<p>
If the message store is RTF-aware, only the PR_RTF_COMPRESSED property needs to be set. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set PR_RTF_COMPRESSED and ensure that the synchronization process occurs as necessary, RTF-aware clients</h5>
<ol>
<li>
Call the <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method to open the PR_RTF_COMPRESSED property, setting both the MAPI_CREATE and MAPI_MODIFY flags. MAPI_CREATE ensures that any new data replaces any old data and MAPI_MODIFY enables you to make those replacements.</li>
<li>
Call the <a href="function_8lv1.htm"><b>WrapCompressedRTFStream</b></a> function, passing STORE_UNCOMPRESSED_RTF if the message store sets the STORE_UNCOMPRESSED_RTF bit in its PR_STORE_SUPPORT_MASK property, to get an uncompressed version of the PR_RTF_COMPRESSED stream returned from <b>OpenProperty</b>.</li>
<li>
Write the message text data to the uncompressed stream returned from <b>WrapCompressedRTFStream</b>.</li>
<li>
Commit and release both the uncompressed and compressed streams.</li>
</ol>
<p>
At this point, if the message store provider supports RTF, you have done all that is required. You can depend on the message store provider to handle the synchronization process and the creation of the PR_BODY property, if necessary. However, if the message store provider does not support RTF, you must call the <a href="function_4yg3.htm"><b>RTFSync</b></a> function to synchronize the text with the formatting, setting the RTF_SYNC_RTF_CHANGED flag.</p>
<p>&nbsp;</p></body>
</HTML>
