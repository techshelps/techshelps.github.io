<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAddrBook::RecipOptions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iaddrbook_recipoptions"></a>IAddrBook::RecipOptions</h2>
<p>
The <b>IAddrBook::RecipOptions</b> method displays a dialog box showing the recipient option properties.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter006_23e8.htm"><b>IAddrBook : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT RecipOptions(
  ULONG</b><i> ulUIParam</i><b>,</b>   
<b>  ULONG</b><i> ulFlags</i><b>,</b>     
<b>  LPADRENTRY</b><i> lpRecip </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the dialog box.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lpRecip</i></dt>
<dd>
[in] Pointer to the <a href="structyp_6m49.htm"><b>ADRENTRY</b></a> structure that describes the recipient whose options are to be displayed.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The options for the specified recipient were successfully displayed.</dd>
<dt>
MAPI_W_ERRORS_RETURNED</dt>
<dd>
There are no recipient options for this recipient. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. For more information on using the <b>HR_FAILED</b> macro, see <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Clients and service providers call the <b>IAddrBook::RecipOptions</b> method to display a dialog box to allow a user to set properties that control the sending and receiving of messages for a particular recipient and address type.</p>
<p>
To locate the appropriate properties to be displayed, MAPI first scans through the <a href="structyp_9sbp.htm"><b>SPropValue</b></a> structure array in the <a href="structyp_6m49.htm"><b>ADRENTRY</b></a> structure to find the <a href="propa_8cv8.htm">PR_ENTRYID</a> and <a href="propa_4gkl.htm">PR_ADDRTYPE</a> properties. MAPI then determines the transport provider, if any, that has registered options for the particular address type. If there is an appropriate transport provider, MAPI calls the provider's function that is based on the <a href="function_5s8b.htm"><b>OPTIONCALLBACK</b></a> prototype to retrieve the properties. </p>
<p>
To retrieve the set of default recipient options without presenting a dialog box to the user, clients or service providers should call the <a href="inter006_4igk.htm"><b>IAddrBook::QueryDefaultRecipOpt</b></a><b> </b>method. </p>
<p>
If any recipient options are changed on a <b>RecipOptions </b>call, MAPI frees the old <a href="structyp_9sbp.htm"><b>SPropValue</b></a> structures for those options within the recipient's <b>ADRENTRY</b> structure and allocates new ones.</p>
<p>
If there are no recipient options available for the address type indicated in the <i>lpRecip</i> parameter, the warning MAPI_W_ERRORS_RETURNED is returned, indicating there was an error returned for the <b>RecipOptions </b>call. Calling the <a href="inter022_1hv6.htm"><b>IMAPIProp::GetLastError</b></a> method returns a text string describing the warning. </p>
<p>
Transport providers can also register message options that apply to all recipients. For more information on registering options, see <a href="xp_48ab.htm">Implementing Message and Recipient Options with Transport Providers</a>.</p>
<h4>See Also</h4>
<p>
<a href="structyp_6m49.htm"><b>ADRENTRY</b></a>, <a href="inter006_4igk.htm"><b>IAddrBook::QueryDefaultRecipOpt</b></a>, <a href="inter023_9ier.htm"><b>IMAPISession::MessageOptions</b></a>, <a href="inter023_8rck.htm"><b>IMAPISession::QueryDefaultMessageOpt</b></a>, <a href="structyp_9sbp.htm"><b>SPropValue</b></a></p>
<p>&nbsp;</p></body>
</HTML>
