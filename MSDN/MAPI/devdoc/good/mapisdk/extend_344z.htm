<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Report Messages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_report_messages"></a>Report Messages</h2>
<p>
Report messages present status information about a message to its sender. There are two general types of report messages:
<ul>
<li>
Read status reports</li>
<li>
Delivery status reports</li>
</ul>
<p>
Read status reports are initiated by message store providers through a call to the <a href="inter025_4xro.htm"><b>IMAPISupport::ReadReceipt</b></a> method and sent to the recipient represented by the entry identifier in the <a href="propb_8azo.htm">PR_REPORT_ENTRYID</a> property. Read status reports are not generated automatically; clients that want to receive them must explicitly request them.</p>
<p>
A read report indicates that the read flag of a message has been set, which can occur when the message is opened, printed, moved, or copied. Whether or not a message store provider generates a read report in response to a move or copy operation depends on where the message is going. If it is being moved or copied to another message store, a read report will most likely always be sent. If it is being moved or copied within the current message store, a read report might or might not be sent. </p>
<p>
A nonread report indicates that the read flag of a message is not set and that the message was not opened either before being placed in the Deleted Items folder or before the expiration of a time limit. Clients can call the <a href="inter029_4x47.htm"><b>IMessage::SetReadFlag</b></a> or <a href="inter013_1msz.htm"><b>IMAPIFolder::SetReadFlags</b></a> method to set or clear a message's read flag.</p>
<p>
Delivery status is reflected in a delivery report, sent when a message has reached its intended recipient, and in a nondelivery report, sent when a message could not reach a recipient. Delivery status reports are sent to the recipient represented by the entry identifier in <a href="propb_8azo.htm">PR_REPORT_ENTRYID</a> or to the sender if this property is not present. </p>
<p>
Delivery reports are sent by request only and do not include the original message. Nondelivery reports are sent automatically unless a request is made to suppress them. Nondelivery reports include the original message as an attachment to enable the report's recipient to attempt a resend in case whatever blocked the delivery is no longer a problem. The attached message resembles the original as it existed when the <a href="inter029_65ut.htm"><b>IMessage::SubmitMessage</b></a> method was called to send it initially. </p>
<p>
One or more delivery status reports are generated by transport providers when they call the <a href="inter025_7chf.htm"><b>IMAPISupport::StatusRecips</b></a> method. Transport providers compose a list of recipients for a message. Whether or not a recipient receives a report and the type of report that is generated depends on the following:
<ul>
<li>
Delivery reports go to recipients that have set the <a href="propb_5hyc.htm">PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED</a> property to TRUE before the message has been placed in the message store.</li>
<li>
Nondelivery reports go to recipients that have not set the <a href="propb_0a3o.htm">PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED</a> property to FALSE. </li>
</ul>
<p>
Almost all of the information necessary to display a nondelivery report is contained in the recipient table of the attached message. A few properties are from the report itself. For delivery reports, the necessary information is contained in the recipient table of the report and in a few report properties. </p>
<p>
Reports are messages with distinct message classes, based on the class of the sent message. Most service providers use a naming convention whereby the message class is made up of several parts separated by periods. The first part is "Report" and the last part is a constant that represents the report type. The middle part is reserved for the class of the sent message. For example, because a delivery report uses the constant DR, the message class for a delivery report about an IPM.Note message would be Report.IPM.Note.DR.</p>
<p>
The constants that represent the types of reports are:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Report type</th>
<th align=left width=52%>Constant used in message class</th>
</tr>
<tr valign=top>
<td width=48%>Read</td>
<td width=52%>IPNRN</td>
</tr>
<tr valign=top>
<td width=48%>Nonread</td>
<td width=52%>IPNNRN</td>
</tr>
<tr valign=top>
<td width=48%>Delivery</td>
<td width=52%>DR</td>
</tr>
<tr valign=top>
<td width=48%>Nondelivery</td>
<td width=52%>NDR</td>
</tr>
</table><br>
<p>
Interactive clients can display report messages using standard forms provided by MAPI or custom forms that have been registered for the report's message class with the form manager. Clients receiving a nondelivery report for an IPM.Note message, for example, can display the standard MAPI form that presents a list of the failed recipients and a suggested reason for the failure and allows the user to resend the message if desired. </p>
<p>&nbsp;</p></body>
</HTML>
