<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMsgServiceAdmin::CopyMsgService</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imsgserviceadmin_copymsgservice"></a>IMsgServiceAdmin::CopyMsgService</h2>
<p>
The <b>IMsgServiceAdmin::CopyMsgService</b> method copies a message service into a profile. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter030_7bxq.htm"><b>IMsgServiceAdmin : IUnknown</b></a>.</p>
<pre><code><b>HRESULT CopyMsgService(
  LPMAPIUID</b><i> lpUID</i><b>,</b>         
<b>  LPTSTR</b><i> lpszDisplayName</i><b>,</b>   
<b>  LPCIID</b><i> lpInterfaceToCopy</i><b>,</b>   
<b>  LPCIID</b><i> lpInterfaceDst</i><b>,</b>   
<b>  LPVOID</b><i> lpObjectDst</i><b>,</b>      
<b>  ULONG</b><i> ulUIParam</i><b>,</b>         
<b>  ULONG</b><i> ulFlags            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpUID</i></dt>
<dd>
[in] Pointer to the <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> structure holding the unique identifier of the message service to copy.</dd>
<dt>
<i>lpszDisplayName</i></dt>
<dd>
[in] Pointer to the display name of the message service to copy. </dd>
<dt>
<i>lpInterfaceToCopy</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) representing the interface to be used to access the profile section of the message service to copy. Passing NULL results in the standard profile section interface, <b>IProfSect</b>, being used.</dd>
<dt>
<i>lpInterfaceDst</i></dt>
<dd>
[in] Pointer to the IID representing the interface to be used to access the object pointed to by the <i>lpObjectDst</i> parameter. Passing NULL results in  the session interface, <a href="inter023_64ry.htm"><b>IMAPISession</b></a>, being used. The <i>lpInterfaceDst </i>parameter can also be set to IID_IMsgServiceAdmin.</dd>
<dt>
<i>lpObjectDst</i></dt>
<dd>
[in] Pointer to a pointer to a session or message service administration object. The type of object should correspond to the interface identifier passed in <i>lpInterfaceDst</i>. Valid object pointers are LPMAPISESSION and LPSERVICEADMIN.</dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for any dialog boxes or windows this method displays.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the message service is copied. The following flags can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The display name of the message service is in Unicode format. If the MAPI_UNICODE flag is not set, the display name is in ANSI format.</dd>
<dt>
SERVICE_UI_ALWAYS</dt>
<dd>
Requests that the message service always display a configuration property sheet. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The message service was successfully copied.</dd>
<dt>
MAPI_E_NO_ACCESS</dt>
<dd>
The message service is already in the profile and does not allow multiple instances of itself.</dd>
<dt>
MAPI_E_NOT_FOUND</dt>
<dd>
The <b>MAPIUID</b> pointed to by <i>lpUID</i> does not refer to an existing message service.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMsgServiceAdmin::CopyMsgService</b> method copies a message service into a profile, either the active profile or another profile. The profile containing the message service to be copied and the destination do not have to be the same profile, but they can be. </p>
<p>
The message service's entry point function is not called for a copy operation. The copied message service has the same configuration settings as its original. To change these settings, a client should call the <a href="inter030_4cv9.htm"><b>IMsgServiceAdmin::ConfigureMsgService</b></a> method.</p>
<h4>See Also</h4>
<p>
<a href="inter030_4cv9.htm"><b>IMsgServiceAdmin::ConfigureMsgService</b></a>, <a href="structyp_3p9g.htm"><b>MAPIUID</b></a></p>
<p>&nbsp;</p></body>
</HTML>
