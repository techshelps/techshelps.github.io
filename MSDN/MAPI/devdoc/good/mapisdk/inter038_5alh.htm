<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IProviderAdmin::GetProviderTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iprovideradmin_getprovidertable"></a>IProviderAdmin::GetProviderTable</h2>
<p>
The <b>IProviderAdmin::GetProviderTable</b> method provides access to the message service's provider table — a listing of the service providers in the message service.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter038_7vla.htm"><b>IProviderAdmin : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetProviderTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the type of the strings returned in the provider table's columns. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The string columns are in Unicode format. If the MAPI_UNICODE flag is not set, the columns are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the provider table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The provider table was successfully returned.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IProviderAdmin::GetProviderTable</b> method retrieves a pointer to the message service's provider table — a table maintained by MAPI that contains information about each service provider in the message service.</p>
<p>
Unlike the provider table returned through <a href="inter030_8p5x.htm"><b>IMsgServiceAdmin::GetProviderTable</b></a>, the provider table returned through <b>IProviderAdmin::GetProviderTable</b> may include additional rows that represent information associated with one or more of the service providers in the message service. This extra information is added to the profile with the "Sections" keyword of MAPISVC.INF. When a provider has extra profile sections, it stores the <b>MAPIUID</b>s for these sections in the <a href="propb_9ucz.htm">PR_SERVICE_EXTRA_UIDS</a> property. PR_SERVICE_EXTRA_UIDS is saved in the message service profile section. </p>
<p>
Providers that have been deleted, or are in use but have been marked for deletion, are not included in the provider table. Provider tables are static, meaning that subsequent additions to or deletions from the message service are not reflected in the table. </p>
<p>
If the message service has no providers, <b>GetProviderTable</b> returns a table with zero rows and the S_OK return value. </p>
<p>
Setting the MAPI_UNICODE flag in the <i>ulFlags </i>parameter affects the format of the columns returned from the following <b>IMAPITable</b> methods:</p>
<p class=indent1>
<a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a> </p>
<p class=indent1>
<a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> </p>
<p>
This flag also controls the property types in the sort order returned by the <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> method.</p>
<p>
For a complete list of the columns in the provider table, see <a href="tables_6vs5.htm">Provider Table</a>. </p>
<h4>Notes to Callers</h4>
<p>
To retrieve the rows of a provider table in transport order, sort the table by the <a href="propb_80mk.htm">PR_PROVIDER_ORDINAL</a> column. </p>
<p>
To retrieve only those rows that represent service providers without including any extra rows, limit your retrieval to the rows that do have a value of PT_ERROR in their <a href="propb_0oh1.htm">PR_RESOURCE_TYPE</a> column.</p>
<h4>See Also</h4>
<p>
<a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a>, <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>, <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a>, <a href="inter026_7x83.htm"><b>IMAPITable::SetColumns</b></a>, <a href="inter030_8p5x.htm"><b>IMsgServiceAdmin::GetProviderTable</b></a></p>
<p>&nbsp;</p></body>
</HTML>
