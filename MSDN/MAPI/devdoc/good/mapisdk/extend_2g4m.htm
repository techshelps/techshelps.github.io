<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending Messages with TNEF</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_sending_messages_with_tnef"></a>Sending Messages with TNEF</h2>
<p>
Many transport providers automatically send all outgoing messages with the Transport Neutral Encapsulation Format, or TNEF. TNEF is used to transmit the formatted text that many clients and message store providers support in their messages, attachments of various types, and custom properties for custom message classes. Although the default mode for most transport providers is to send outgoing messages with TNEF, some transport providers do not support it. The lack of support for TNEF is not an issue for standard messaging clients that send and receive IPM messages. However, for form-based clients or clients that require custom properties, the use of TNEF is essential. Designers of clients that rely on forms or custom properties must be aware of the capabilities of the transport providers that they use.</p>
<p>
Message recipients can control whether or not a transport provider transmits messages with TNEF by setting the <a href="propb_7wmn.htm">PR_SEND_RICH_INFO</a> property. When a recipient's PR_SEND_RICH_INFO property is set to TRUE, a transport provider that supports TNEF transmits it with the message. When the property is set to FALSE, the formatting is discarded. When PR_SEND_RICH_INFO does not exist, it is up to the transport provider to choose a default course of action. </p>
<p>
When clients and service providers create a custom recipient, they can affect the value of its PR_SEND_RICH_INFO property by passing the MAPI_SEND_NO_RICH_INFO flag in the <i>ulFlags</i> parameter to the <a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a> or <a href="inter025_37mu.htm"><b>IMAPISupport::CreateOneOff</b></a><b> </b>call. Passing MAPI_SEND_NO_RICH_INFO causes MAPI to set the custom recipient's PR_SEND_RICH_INFO property to FALSE; in most cases not passing the flag causes MAPI to set the property to TRUE. The one exception is if the custom recipient's address is interpreted to be an Internet address. In this one situation, MAPI sets PR_SEND_RICH_INFO to FALSE.</p>
<p>&nbsp;</p></body>
</HTML>
