<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PR_MESSAGE_ATTACHMENTS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_pr_message_attachments"></a>PR_MESSAGE_ATTACHMENTS</h2>
<p>
The PR_MESSAGE_ATTACHMENTS property contains a table of restrictions that can be applied to a contents table to find all messages that contain attachment subobjects meeting the restrictions. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file:</td>
<td width=57%>MAPITAGS.H</td>
</tr>
<tr valign=top>
<td width=43%>May be exposed by:</td>
<td width=57%>Message objects</td>
</tr>
<tr valign=top>
<td width=43%>Identifier:</td>
<td width=57%>0x0E13</td>
</tr>
<tr valign=top>
<td width=43%>Property type:</td>
<td width=57%>PT_OBJECT</td>
</tr>
<tr valign=top>
<td width=43%>Property tag:</td>
<td width=57%>0x0E13000D</td>
</tr>
</table><br>
<h4>Remarks </h4>
<p>
The PR_MESSAGE_ATTACHMENTS property can be excluded in <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a> operations or included in <a href="inter022_406r.htm"><b>IMAPIProp::CopyProps</b></a> operations. As a property of type PT_OBJECT, it cannot be successfully retrieved by the <b>IMAPIProp::GetProps</b> method; its contents should be accessed by the <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method, requesting the IID_IMAPITable interface identifier. Service providers must report it to the <a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a> method if it is set, but may optionally report it or not if it is not set. </p>
<p>
To retrieve table contents, a client application should call the <a href="inter029_24it.htm"><b>IMessage::GetAttachmentTable</b></a> method. For more information, see <a href="tables_35pv.htm">Attachment Tables</a>. </p>
<p>
PR_MESSAGE_ATTACHMENTS can be used for subobject restriction by specifying it in the <a href="structyp_3lim.htm"><b>SSubRestriction</b></a> structure. This allows the client to limit the view of a container to messages with attachments meeting given criteria. A message qualifies for viewing if at least one row in its attachments table, that is, one attachment, satisfies the subobject restriction. </p>
<h4>Note</h4>
<p>
Using subobject restriction results in the equivalent of an <a href="inter023_146x.htm"><b>IMAPISession::OpenEntry</b></a> call on every message in the table. Depending on the client application and the number of messages to be searched, it can affect performance.</p>
<p>
The PR_MESSAGE_ATTACHMENTS and PR_MESSAGE_RECIPIENTS properties are similar in usage. Several MAPI properties provide access to tables: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Property </th>
<th align=left width=47%>Table </th>
</tr>
<tr valign=top>
<td width=53%><a href="propa_4df7.htm">PR_CONTAINER_CONTENTS</a> </td>
<td width=47%>Contents table </td>
</tr>
<tr valign=top>
<td width=53%><a href="propa_13sp.htm">PR_CONTAINER_HIERARCHY</a> </td>
<td width=47%>Hierarchy table </td>
</tr>
<tr valign=top>
<td width=53%><a href="propa_8v03.htm">PR_FOLDER_ASSOCIATED_CONTENTS</a> </td>
<td width=47%>Associated contents table </td>
</tr>
<tr valign=top>
<td width=53%>PR_MESSAGE_ATTACHMENTS </td>
<td width=47%>Attachment table </td>
</tr>
<tr valign=top>
<td width=53%><a href="propa_1zw3.htm">PR_MESSAGE_RECIPIENTS</a> </td>
<td width=47%>Recipient table </td>
</tr>
</table><br>
<h4>See Also</h4>
<p>
<a href="groups_50z7.htm">Table Access Properties</a> </p>
<p>&nbsp;</p></body>
</HTML>
