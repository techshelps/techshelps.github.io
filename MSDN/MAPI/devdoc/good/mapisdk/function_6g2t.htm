<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ChangeIdleRoutine</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_changeidleroutine"></a>ChangeIdleRoutine</h2>
<p>
The <b>ChangeIdleRoutine</b> function changes some or all of the characteristics of a <a href="function_9eg5.htm"><b>FNIDLE</b></a> – based idle routine. </p>
<p>
<b>Note</b>  This function may not be supported in future versions of MAPI.</p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIUTIL.H </td>
</tr>
<tr valign=top>
<td width=48%>Implemented by: </td>
<td width=52%>MAPI </td>
</tr>
<tr valign=top>
<td width=48%>Called by: </td>
<td width=52%>Client applications and service providers </td>
</tr>
</table><br>
<pre><code><b>VOID ChangeIdleRoutine(
  FTG</b><i> ftg</i><b>,</b>              
<b>  PFNIDLE</b><i> pfnIdle</i><b>,</b>      
<b>  LPVOID</b><i> pvIdleParam</i><b>,</b>   
<b>  short</b><i> priIdle</i><b>,</b>        
<b>  ULONG</b><i> csecIdle</i><b>,</b>       
<b>  USHORT</b><i> iroIdle</i><b>,</b>       
<b>  USHORT</b><i> ircIdle        </i>
<b>);</b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>ftg </i></dt>
<dd>
[in] Function tag that identifies the idle routine. </dd>
<dt>
<i>pfnIdle </i></dt>
<dd>
[in] Pointer to the idle routine. </dd>
<dt>
<i>pvIdleParam </i></dt>
<dd>
[in] Pointer to a new block of memory that the calling implementation allocates for the idle routine. </dd>
<dt>
<i>priIdle </i></dt>
<dd>
[in] Value representing a new priority for the idle routine. Possible priorities for implementation-defined routines are greater than or less than zero, but not zero. A value of zero is reserved for a user event such as a mouse click or a WM_PAINT message. 
<p>
Values greater than zero represent priorities for background tasks that have a higher priority than user events and are dispatched as part of the standard Windows message pump loop. Values less than zero represent priorities for idle tasks that only run during message-pump idle time. Examples of priorities are: 1 for foreground submission, –1 for power-edit character insertion, and –3 for downloading new messages. 
</dd>
<dt>
<i>csecIdle </i></dt>
<dd>
[in] A new time, in hundredths of a second, to apply to the idle routine. The meaning of the initial time value varies, depending on what is passed in the <i>iroIdle </i>parameter. It can be: 
<ul>
<li>
The minimum period of user inaction that must elapse before the MAPI idle engine calls the idle routine for the first time, if the FIROWAIT flag is set in <i>iroIdle</i>. After this time passes, the idle engine can call the idle routine as often as necessary. </li>
<li>
The minimum interval between calls to the idle routine, if the FIROINTERVAL flag is set in <i>iroIdle</i>. </li>
</ul>
</dd>
<dt>
<i>iroIdle </i></dt>
<dd>
[in] Bitmask of flags indicating new options for calling the idle routine. Exactly one of the following flags must be set: 
<dl>
<dt>
FIROINTERVAL </dt>
<dd>
The time specified by the <i>csecIdle</i> parameter is the minimum interval between successive calls to the idle routine. </dd>
<dt>
FIROONCEONLY </dt>
<dd>
Obsolete. Do not use. </dd>
<dt>
FIROPERBLOCK </dt>
<dd>
Obsolete. Do not use. </dd>
<dt>
FIROWAIT </dt>
<dd>
The time specified by the <i>csecIdle</i> parameter is the minimum period of user inaction that must elapse before the MAPI idle engine calls the idle routine for the first time. After this time passes, the idle engine can call the idle routine as often as necessary. </dd>
</dl>
</dd>
<dt>
<i>ircIdle </i></dt>
<dd>
[in] Bitmask of flags used to indicate the changes to be made to the idle routine. The following flags can be set in any combination: 
<dl>
<dt>
FIRCCSEC </dt>
<dd>
A change to the time associated with the idle routine, that is, a change indicated by the value passed in the <i>csecIdle </i>parameter. </dd>
<dt>
FIRCIRO </dt>
<dd>
A change to the options for the idle routine, that is, a change indicated by the value passed in the <i>iroIdle</i> parameter. </dd>
<dt>
FIRCPFN </dt>
<dd>
A change to the idle routine pointer, that is, a change indicated by the value passed in the <i>pfnIdle</i> parameter. </dd>
<dt>
FIRCPRI </dt>
<dd>
A change to the priority of the idle routine, that is, a change indicated by the value passed in the <i>priIdle</i> parameter. </dd>
<dt>
FIRCPV </dt>
<dd>
A change to the memory block of the idle routine, that is, a change indicated by the value passed in the <i>pvIdleParam</i> parameter. 
</dd>
</dl>
</dd>
</dl>
<h4>Remarks </h4>
<p>
The following functions deal with the MAPI idle engine and with idle routines based on the <a href="function_9eg5.htm"><b>FNIDLE</b></a> function prototype: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Idle routine function </th>
<th align=left width=63%>Usage </th>
</tr>
<tr valign=top>
<td width=37%><b>ChangeIdleRoutine </b></td>
<td width=63%>Changes the characteristics of a registered idle routine. </td>
</tr>
<tr valign=top>
<td width=37%><a href="function_18th.htm"><b>DeregisterIdleRoutine</b></a><b> </b></td>
<td width=63%>Removes a registered idle routine from the MAPI system. </td>
</tr>
<tr valign=top>
<td width=37%><a href="function_4twl.htm"><b>EnableIdleRoutine</b></a><b> </b></td>
<td width=63%>Disables or re-enables a registered idle routine without removing it from the MAPI system. </td>
</tr>
<tr valign=top>
<td width=37%><a href="function_8f6t.htm"><b>FtgRegisterIdleRoutine</b></a><b> </b></td>
<td width=63%>Adds an idle routine to the MAPI system, with or without enabling it. </td>
</tr>
<tr valign=top>
<td width=37%><a href="function_2ijp.htm"><b>MAPIDeInitIdle</b></a><b><u> </u></b></td>
<td width=63%>Shuts down the MAPI idle engine for the calling application. </td>
</tr>
<tr valign=top>
<td width=37%><a href="function_546d.htm"><b>MAPIInitIdle</b></a><b><u> </u></b></td>
<td width=63%>Initializes the MAPI idle engine for the calling application. </td>
</tr>
</table><br>
<p>
<b>ChangeIdleRoutine</b>, <b>DeregisterIdleRoutine</b>, and <b>EnableIdleRoutine</b> take as an input parameter the function tag returned by <b>FtgRegisterIdleRoutine</b>. </p>
<p>
When all foreground tasks for the platform become idle, the MAPI idle engine calls the highest priority idle routine that is ready to execute. There is no guarantee of calling order among idle routines of the same priority. </p>
<h4>See Also</h4>
<p>
<a href="groups_3hbn.htm">Idle Routine Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
