<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HrValidateIPMSubtree</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_hrvalidateipmsubtree"></a>HrValidateIPMSubtree</h2>
<p>
The <b>HrValidateIPMSubtree</b> function adds standard interpersonal message (IPM) folders to a message store. </p>
<p>
<b>Note</b>  This function may not be supported in future versions of MAPI.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIUTIL.H </td>
</tr>
<tr valign=top>
<td width=48%>Implemented by: </td>
<td width=52%>MAPI </td>
</tr>
<tr valign=top>
<td width=48%>Called by: </td>
<td width=52%>Client applications </td>
</tr>
</table><br>
<pre><code><b>HrValidateIPMSubtree(
  LPMDB</b><i> lpMDB</i><b>,</b>                   
<b>  ULONG</b><i> ulFlags</i><b>,</b>                 
<b>  ULONG FAR *</b><i> lpcValues</i><b>,</b>         
<b>  LPSPropValue FAR *</b><i> lppProps</i><b>,</b>   
<b>  LPMAPIERROR FAR *</b><i> lppMapiError  </i>
<b>);</b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>lpMDB </i></dt>
<dd>
[in] Pointer to the message store object to which to add the folders. </dd>
<dt>
<i>ulFlags </i></dt>
<dd>
[in] Bitmask of flags used to control how the folders are created. The following flags can be set: 
<dl>
<dt>
MAPI_FORCE_CREATE </dt>
<dd>
The folders should be verified before creation, even if message store properties indicate that they are valid. A client application typically sets this flag when an error indicates that the structure of an existing folder has been damaged. </dd>
<dt>
MAPI_FULL_IPM_TREE </dt>
<dd>
The full set of IPM folders should be created in the message store's root folder. The folder titles in the hierarchy are: 
<p>
Folder Views <br>
    Common Views <br>
    Search Root* <br>
    IPM Subtree* <br>
        Inbox <br>
        Outbox <br>
        Deleted Items* <br>
        Sent Items 

<p>
where the three folders marked with * are the minimum set created even when the MAPI_FULL_IPM_TREE flag has not been set. A client application typically sets this flag when the message store in which the folders are to be created is the default store. 
</dd>
</dl>
</dd>
<dt>
<i>lpcValues </i></dt>
<dd>
[in, out] Pointer to the number of <a href="structyp_9sbp.htm"><b>SPropValue</b></a> structures in the array returned in the <i>lppProps </i>parameter. The value of the <i>lpcValues</i> parameter can be zero if <i>lppProps</i> is NULL. </dd>
<dt>
<i>lppProps </i></dt>
<dd>
[in, out] Pointer to a pointer to an array of <b>SPropValue</b> structures containing property values for the <a href="propb_0zzf.htm">PR_VALID_FOLDER_MASK</a> property and for the appropriate folder entry identifier properties. If <b>HrValidateIPMSubtree</b> creates an Inbox in the message store, the <b>SPropValue</b> array includes an Inbox entry identifier with a special property tag coded as <code>PROP_TAG(PT_BINARY, PROP_ID_NULL)</code>. The <i>lppProps</i> parameter can be NULL, indicating that the calling implementation does not require that an <b>SPropValue</b> array be returned. </dd>
<dt>
<i>lppMapiError </i></dt>
<dd>
[out] Pointer to a pointer to a <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a> structure containing version, component, and context information for an error. The <i>lppMAPIError </i>parameter is set to NULL if no <b>MAPIERROR</b> structure is returned. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
MAPI uses the <b>HrValidateIPMSubtree</b> function internally to construct the standard IPM subtree in a message store when the store is first opened, or when a store is made the default store. This function can also be used by client applications to validate or repair standard message folders. </p>
<p>
<b>HrValidateIPMSubtree</b> always creates the Search Root and IPM Subtree folders in the store's root folder and the Deleted Items folder in the IPM Subtree folder. The IPM Subtree folder is the root of the IPM hierarchy in that message store. The Search Root folder can be used as the root of a subtree for search-results folders. </p>
<p>
IPM clients should display their folder view starting at the IPM subtree root folder and showing child folders beneath it. Information in the root folder of a message store should not appear in a client's user interface. This functionality means that if a client must hide information, the information can be put in the IPM subtree root directory, where it is not visible to the user. In contrast, non-IPM applications that require messages and folders to be invisible to the user, for example in a server-based message store, can put them outside the IPM hierarchy. </p>
<p>
<b>HrValidateIPMSubtree</b> sets the <a href="propb_0zzf.htm">PR_VALID_FOLDER_MASK</a> property to indicate whether each IPM folder it creates has a valid entry identifier. The following entry identifier properties of the message store are set to the entry identifiers of the corresponding folders and returned in the <i>lppProps</i> parameter along with PR_VALID_FOLDER_MASK: </p>
<p>
<a href="propa_4ias.htm">PR_COMMON_VIEWS_ENTRYID</a> <br>
<a href="propa_3gro.htm">PR_FINDER_ENTRYID</a> <br>
<a href="propa_9q90.htm">PR_IPM_OUTBOX_ENTRYID</a> <br>
<a href="propa_1e78.htm">PR_IPM_SENTMAIL_ENTRYID</a> <br>
<a href="propa_7tb8.htm">PR_IPM_SUBTREE_ENTRYID</a> <br>
<a href="propa_3qxw.htm">PR_IPM_WASTEBASKET_ENTRYID</a> <br>
<a href="propb_4lk4.htm">PR_VIEWS_ENTRYID</a> <br>
A placeholder <a href="structyp_4w4n.htm">PROP_TAG</a> for the IPM Inbox (PT_BINARY, PROP_ID_NULL). </p>
<h4>See Also </h4>
<p>
<a href="inter023_59id.htm"><b>IMAPISession::OpenMsgStore</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
