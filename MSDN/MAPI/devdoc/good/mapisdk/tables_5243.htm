<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Types of Restrictions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_types_of_restrictions"></a>Types of Restrictions</h3>
<p>
There are many types of restrictions, some that focus on specific columns. All table implementations are expected to support restrictions on the columns in the current column set. However, to add value, table implementers can also support restrictions based on object properties that are not currently in the table view.</p>
<p>
Some restrictions can be combined using a restriction that performs a logical <b>AND</b>, <b>OR</b>, or <b>NOT</b> operation. For example, most property restrictions must be joined with exist restrictions using <b>AND</b> restrictions. There are a few exceptions, such as when the property used in the property restriction is the <a href="propa_1gtu.htm">PR_ANR</a> property or when it is a required column in a table. A client building restrictions to limit its view should use exist restrictions with its property restrictions because MAPI does not specify how service providers should evaluate property restrictions when a property does not exist. It is reasonable and recommended that service providers fail the restriction, but there are no requirements. </p>
<p>
A restriction is defined using the <a href="structyp_45ny.htm"><b>SRestriction</b></a> data structure which contains a union of more specialized restriction structures and an indicator of the type of structure included in the union. </p>
<p>
Each of the specialized restriction structures in the union represents a different type of restriction. The types of restrictions and their associated data structures are:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=22%>Type of restriction</th>
<th align=left width=35%>Associated data structure</th>
<th align=left width=43%>Description</th>
</tr>
<tr valign=top>
<td width=22%>Compare property</td>
<td class=indent1 width=35%><a href="structyp_8j3i.htm"><b>SComparePropsRestriction</b></a></td>
<td width=43%>Compares two properties of the same type.</td>
</tr>
<tr valign=top>
<td width=22%><b>AND</b></td>
<td class=indent1 width=35%><a href="structyp_0v1q.htm"><b>SAndRestriction</b></a></td>
<td width=43%>Performs a logical <b>AND</b> operation on two or more restrictions.</td>
</tr>
<tr valign=top>
<td width=22%><b>OR</b></td>
<td class=indent1 width=35%><a href="structyp_51nz.htm"><b>SOrRestriction</b></a></td>
<td width=43%>Performs a logical <b>OR</b> operation on two or more restrictions.</td>
</tr>
<tr valign=top>
<td width=22%><b>NOT</b></td>
<td class=indent1 width=35%><a href="structyp_9xv2.htm"><b>SNotRestriction</b></a></td>
<td width=43%>Performs a logical <b>NOT</b> operation on two or more restrictions.</td>
</tr>
<tr valign=top>
<td width=22%>Content</td>
<td class=indent1 width=35%><a href="structyp_2ege.htm"><b>SContentRestriction</b></a></td>
<td width=43%>Locates specified data.</td>
</tr>
<tr valign=top>
<td width=22%>Property</td>
<td class=indent1 width=35%><a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a></td>
<td width=43%>Specifies a particular property value as criteria for matching. Can be used, for example, to search for a particular type of attachment.</td>
</tr>
<tr valign=top>
<td width=22%>Bitmask</td>
<td class=indent1 width=35%><a href="structyp_6zvy.htm"><b>SBitMaskRestriction</b></a></td>
<td width=43%>Applies a bitmask to a PT_LONG property, typically to determine if particular flags are set.</td>
</tr>
<tr valign=top>
<td width=22%>Size</td>
<td class=indent1 width=35%><a href="structyp_5v3i.htm"><b>SSizeRestriction</b></a></td>
<td width=43%>Tests the size of a property using standard relational operators.</td>
</tr>
<tr valign=top>
<td width=22%>Exist</td>
<td class=indent1 width=35%><a href="structyp_7qy6.htm"><b>SExistRestriction</b></a></td>
<td width=43%>Tests whether or not an object has a value for a property. </td>
</tr>
<tr valign=top>
<td width=22%>Subobject</td>
<td class=indent1 width=35%><a href="structyp_3lim.htm"><b>SSubRestriction</b></a></td>
<td width=43%>Used for searching through subobjects, or objects that cannot be accessed with an entry identifier (recipients and attachments). Can be used, for example, to look for messages for a particular recipient.</td>
</tr>
<tr valign=top>
<td width=22%>Comment</td>
<td class=indent1 width=35%><a href="structyp_37e6.htm"><b>SCommentRestriction</b></a></td>
<td width=43%>Associates an object with a set of named properties.</td>
</tr>
</table><br>
<p>
Some restrictions use regular expressions, and MAPI supports a limited form of regular expression notation in the style that is used in the <b>grep</b> utility. For a discussion of MAPI's use of regular expressions, see <a href="apprgexp_2mb7.htm">Regular Expressions</a>.</p>
<p>
The comment restriction is used by clients that save restrictions on disk to keep application-specific information with the restriction. For example, a client saving the name of a named property used in a property restriction can do so with a comment restriction. Saving the name is not possible in a property restriction; the <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> data structure holds only the property tag. Comment restrictions are ignored by <b>Restrict</b> in that they have no effect on the rows returned by <b>QueryRows</b> after a <b>Restrict</b> call has been made. </p>
<p>&nbsp;</p></body>
</HTML>
