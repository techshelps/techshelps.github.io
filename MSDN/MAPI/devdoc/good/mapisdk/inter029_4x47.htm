<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMessage::SetReadFlag</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imessage_setreadflag"></a>IMessage::SetReadFlag</h2>
<p>
The <b>IMessage::SetReadFlag</b> method sets or clears the MSGFLAG_READ flag in the <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property of the message and manages the sending of read reports.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter029_525s.htm"><b>IMessage : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT SetReadFlag(
  ULONG</b><i> ulFlags  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the setting of a message's read flag — that is, the message's MSGFLAG_READ flag in its <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property — and the processing of read reports. The following flags can be set:
<dl>
<dt>
CLEAR_READ_FLAG</dt>
<dd>
The MSGFLAG_READ flag should be cleared in PR_MESSAGE_FLAGS and no read report should be sent. </dd>
<dt>
CLEAR_NRN_PENDING</dt>
<dd>
The MSGFLAG_NRN_PENDING flag should be cleared in PR_MESSAGE_FLAGS and a nonread report should not be sent.</dd>
<dt>
CLEAR_RN_PENDING</dt>
<dd>
The MSGFLAG_RN_PENDING flag should be cleared in PR_MESSAGE_FLAGS and no read report should be sent.</dd>
<dt>
GENERATE_RECEIPT_ONLY</dt>
<dd>
A read report should be sent if one is pending, but there should be no change in the state of the MSGFLAG_READ flag.</dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
Allows <b>SetReadFlag</b> to return successfully, possibly before the operation has completed. </dd>
<dt>
SUPPRESS_RECEIPT</dt>
<dd>
A pending read report should be canceled if a read report had been requested and this call changes the state of the message from unread to read. If this call does not change the state of the message, the message store provider can ignore this flag. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The message's read flag has been successfully set or cleared.</dd>
<dt>
MAPI_E_NO_SUPPRESS</dt>
<dd>
The message store provider does not support the suppression of read reports.</dd>
<dt>
MAPI_E_INVALID_PARAMETER</dt>
<dd>
One of the following combinations of flags is set in the <i>ulFlags</i> parameter:
<ul>
<li>
SUPPRESS_RECEIPT | CLEAR_READ_FLAG </li>
<li>
SUPPRESS_RECEIPT | CLEAR_READ_FLAG | GENERATE_RECEIPT_ONLY</li>
<li>
CLEAR_READ_FLAG | GENERATE_RECEIPT_ONLY</li>
</ul>
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMessage::SetReadFlag</b> method sets or clears the message's MSGFLAG_READ flag in the <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property and calls <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> to save the message. Setting the MSGFLAG_READ flag marks a message as having been read, which does not necessarily indicate that the intended recipient has actually read the message.</p>
<p>
<b>SetReadFlags</b> also manages the sending of read reports. A read report is sent only if the sender has requested one. </p>
<p>
The read flag cannot be altered for:
<ul>
<li>
Messages that do not exist.</li>
<li>
Messages that have been moved elsewhere.</li>
<li>
Messages that are open with read/write access.</li>
<li>
Messages that are currently submitted.</li>
</ul>
<h4>Notes to Implementers</h4>
<p>
If none of the flags are set in the <i>ulFlags</i> parameter, the following rules apply:
<ul>
<li>
If MSGFLAG_READ is already set, do nothing.</li>
<li>
If MSGFLAG_READ is not set, set it immediately and send any pending read reports if the <a href="propb_07qc.htm">PR_READ_RECEIPT_REQUESTED</a> property is set.</li>
</ul>
<p>
If both the SUPPRESS_RECEIPT and GENERATE_RECEIPT_ONLY flags are set, the PR_READ_RECEIPT_REQUESTED bit, if set, should be cleared and a read report should not be sent.</p>
<p>
When the SUPPRESS_RECEIPT flag is set:
<ul>
<li>
If MSGFLAG_READ is already set, do nothing. </li>
<li>
If MSGFLAG_READ is not set, set it and cancel any pending read reports.</li>
</ul>
<p>
When the CLEAR_READ_FLAG flag is set, clear the MSGFLAG_READ flag in each message's <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property and do not send any read reports. </p>
<p>
When the GENERATE_RECEIPT_ONLY flag is set, send any pending read reports. Do not set or clear MSGFLAG_READ.</p>
<p>
When both the SUPPRESS_RECEIPT and GENERATE_RECEIPT_ONLY flags are set, set the PR_READ_RECEIPT_REQUESTED property to FALSE if it is set and do not send a read report.</p>
<p>
You can optimize report behavior by suppressing the generation of read reports under certain conditions. However, if you do not support the suppression of reports and a client calls <b>SetReadFlag</b> with the SUPPRESS_RECEIPT flag set, return MAPI_E_NO_SUPPRESS.</p>
<h4>See Also</h4>
<p>
<a href="inter011_02yh.htm"><b>IMAPIContainer::OpenEntry</b></a>, <a href="inter013_1msz.htm"><b>IMAPIFolder::SetReadFlags</b></a>, <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a>, <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a>, <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a></p>
<p>&nbsp;</p></body>
</HTML>
