<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADRPARM</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_adrparm"></a>ADRPARM</h2>
<p>
The <b>ADRPARM</b> structure describes the display and behavior of the common address dialog box. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIDEFS.H</td>
</tr>
</table><br>
<pre><code>typedef struct _ADRPARM 
{ 
     ULONG            cbABContEntryID; 
     LPENTRYID        lpABContEntryID; 
     ULONG            ulFlags; 
     LPVOID           lpReserved; 
     ULONG            ulHelpContext; 
     LPTSTR           lpszHelpFileName; 
     LPFNABSDI        lpfnABSDI; 
     LPFNDISMISS      lpfnDismiss; 
     LPVOID           lpvDismissContext; 
     LPTSTR           lpszCaption; 
     LPTSTR           lpszNewEntryTitle; 
     LPTSTR           lpszDestWellsTitle; 
     ULONG            cDestFields; 
     ULONG            nDestFieldFocus; 
     LPTSTR FAR      *lppszDestTitles; 
     ULONG FAR       *lpulDestComps; 
     LPSRestriction   lpContRestriction; 
     LPSRestriction   lpHierRestriction; 
} ADRPARM, FAR *LPADRPARM; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbABContEntryID</b></dt>
<dd>
Count of bytes in the entry identifier pointed to by <b>lpABContEntryID</b>.</dd>
<dt>
<b>lpABContEntryID</b></dt>
<dd>
Pointer to the entry identifier of the container that initially supplies the list of recipient addresses that are displayed in the address dialog box.</dd>
<dt>
<b>ulFlags</b></dt>
<dd>
Bitmask of flags associated with various address dialog box options. The following flags can be set: 
<dl>
<dt>
AB_RESOLVE</dt>
<dd>
Causes all names to be resolved after the address dialog box is closed. If there are ambiguous entries resulting from the name resolution process, a dialog box is displayed to prompt the user for help in resolving them. Setting this flag guarantees that all of the names returned by <a href="inter006_2fn7.htm"><b>IAddrBook::Address</b></a> are resolved.</dd>
<dt>
AB_SELECTONLY</dt>
<dd>
Disables the creation of one-off addresses for a recipient list. This flag is used only if the dialog box is modal, as indicated by the DIALOG_MODAL flag being set.</dd>
<dt>
ADDRESS_ONE</dt>
<dd>
The user can select exactly one recipient instead of multiple recipients from a list. This flag is valid only when <b>cDestFields</b> is zero and the dialog box is modal, as indicated by the DIALOG_MODAL flag being set.</dd>
<dt>
DIALOG_MODAL</dt>
<dd>
Causes the modal version of the common address dialog box to be displayed. Either this flag or DIALOG_SDI should be set; they cannot both be set. </dd>
<dt>
DIALOG_OPTIONS</dt>
<dd>
Causes the <b>Send Options</b> button to be displayed on the dialog box. This flag is used only if the dialog box is modal, as indicated by the DIALOG_MODAL flag being set.</dd>
<dt>
DIALOG_SDI</dt>
<dd>
Causes the modeless version of the common address dialog box to be displayed. Either this flag or DIALOG_MODAL should be set; they cannot both be set. </dd>
</dl>
</dd>
<dt>
<b>lpReserved</b></dt>
<dd>
Reserved, must be zero.</dd>
<dt>
<b>ulHelpContext</b></dt>
<dd>
Specifies the context within Help that will first be shown when the user clicks the <b>Help</b> button in the address dialog box.</dd>
<dt>
<b>lpszHelpFileName</b></dt>
<dd>
Pointer to the name of a Help file that will be associated with the address dialog box. The <b>lpszHelpFileName</b> member is used in conjunction with <b>ulHelpContext</b> to call the Windows <b>WinHelp </b>function.</dd>
<dt>
<b>lpfnABSDI</b></dt>
<dd>
Pointer to a MAPI function based on the <a href="function_3y09.htm"><b>ACCELERATEABSDI</b></a> prototype or NULL. This member applies to the modeless version of the dialog box only, as indicated by the DIALOG_SDI flag being set.
<p>
Clients building an <b>ADRPARM</b> structure to pass to <a href="inter006_2fn7.htm"><b>IAddrBook::Address</b></a><b> </b>must always set the <b>lpfnABSDI</b> member to NULL. If the DIALOG_SDI flag is set, MAPI will then set it to a valid function before returning. Clients call this function from within their message loop to ensure that accelerators in the address book dialog box work. When the dialog box is dismissed and MAPI calls the function pointed to by the <b>lpfnDismiss</b> member, clients should unhook the <b>ACCELERATEABSDI</b> function from their message loop. 
</dd>
<dt>
<b>lpfnDismiss</b></dt>
<dd>
Pointer to a function based on the <a href="function_3j1v.htm"><b>DISMISSMODELESS</b></a> prototype or NULL. This member applies only to the modeless version of the dialog box only, as indicated by the DIALOG_SDI flag being set. MAPI calls the <b>DISMISSMODELESS</b> function when the user dismisses the modeless address dialog box, informing a client calling <b>IAddrBook::Address</b> that the dialog box is no longer active.</dd>
<dt>
<b>lpvDismissContext</b></dt>
<dd>
Pointer to context information to be passed to the <b>DISMISSMODELESS</b> function pointed to by the <b>lpfnDismiss</b> member. This member applies only to the modeless version of the dialog box, as indicated by the DIALOG_SDI flag being set.</dd>
<dt>
<b>lpszCaption</b></dt>
<dd>
Pointer to text to be used as the title for the common address dialog box.</dd>
<dt>
<b>lpszNewEntryTitle</b></dt>
<dd>
Pointer to text to be used as the button label for the button that invokes either the <b>New Entry</b> dialog box or another dialog box.</dd>
<dt>
<b>lpszDestWellsTitle</b></dt>
<dd>
Pointer to text to be used as a title for the recipient edit box controls that can appear in the modal version of the common address dialog box. This member is not used for modeless dialog boxes. </dd>
<dt>
<b>cDestFields</b></dt>
<dd>
Count of recipient edit box controls in the modal version of the address dialog box, or zero if the dialog box is modeless. The address dialog box is open for browsing only when:
<ul>
<li>
The cDestFields member is set to zero.</li>
<li>
The DIALOG_BOX flag is set.</li>
<li>
The ADDRESS_ONE flag is not set.</li>
</ul>

<p>
Setting <b>cDestFields</b> to 0XFFFFFFFF implies that MAPI should create the default number of recipient edit box controls. In this case, the <b>lppszDestTitles</b> and <b>lpulDestComps</b> members must be NULL.  
</dd>
<dt>
<b>nDestFieldFocus</b></dt>
<dd>
Indicates the particular edit box control that should have the initial focus when the modal version of the dialog box appears. This value must be between 0 and the value of <b>cDestFields</b> minus 1.</dd>
<dt>
<b>lppszDestTitles</b></dt>
<dd>
Pointer to an array of labels for buttons associated with each of the edit box controls that are displayed in the modal version of the address dialog box. The value of the <b>cDestFields </b>member indicates the number of labels included in the array. If the <b>lppszDestTitles</b> member is NULL, the <b>Address </b>method chooses default titles. </dd>
<dt>
<b>lpulDestComps</b></dt>
<dd>
Pointer to an array of recipient type values, such as MAPI_TO, MAPI_CC, and MAPI_BCC, that is associated with each edit box control. The value of the <b>CDestFields</b> member indicates the number of recipient types included in the array. The values pointed to by <b>lpulDestComps</b> can be used to set the <a href="propb_0n6t.htm">PR_RECIPIENT_TYPE</a> property of each recipient. If the <b>lpulDestComps</b> member is NULL, the <b>Address </b>method chooses default recipient types. </dd>
<dt>
<b>lpContRestriction</b></dt>
<dd>
Pointer to an <a href="structyp_45ny.htm"><b>SRestriction</b></a> structure that limits the type of address entries that can be displayed in the dialog box.</dd>
<dt>
<b>lpHierRestriction</b></dt>
<dd>
Pointer to an <b>SRestriction</b> structure that limits the address book containers that can supply address entries to be displayed in the dialog box. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>ADRPARM</b> structures are used by clients and service providers to control the appearance and behavior of the MAPI common address dialog boxes. There are two varieties of the address dialog box: modeless and modal. Some of the members in the <b>ADRPARM</b> structure apply to both versions of the dialog box, but some only apply to one of the two versions. The following table relates the members of an <b>ADRPARM</b> structure to their use with the common address dialog boxes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=58%>ADRPARM member</th>
<th align=left width=42%>Type of dialog box</th>
</tr>
<tr valign=top>
<td width=58%><b>cbABContEntryID </b>and<b> lpABContEntryID</b></td>
<td width=42%>Modal and modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>ulFlags</b></td>
<td width=42%>Modal and modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>lpReserved</b></td>
<td width=42%>Modal and modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>ulHelpContext </b>and<b> lpszHelpFileName</b></td>
<td width=42%>Modal and modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>lpfnABSDI</b></td>
<td width=42%>Modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>lpfnDismiss </b>and<b> lpvDismissContext</b></td>
<td width=42%>Modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>lpszCaption</b></td>
<td width=42%>Modal and modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>lpszNewEntryTitle</b></td>
<td width=42%>Modal</td>
</tr>
<tr valign=top>
<td width=58%><b>lpszDestWellsTitle</b>, <b>cDestFields</b>, <b>nDestFieldFocus</b>,<b> lppszDestTitles</b>,<b> </b>and<b> lpulDestComps</b></td>
<td width=42%>Modal</td>
</tr>
<tr valign=top>
<td width=58%><b>lpContRestriction</b></td>
<td width=42%>Modal and modeless</td>
</tr>
<tr valign=top>
<td width=58%><b>lpHierRestriction</b></td>
<td width=42%>Modal and modeless</td>
</tr>
</table><br>
<p>
The modeless dialog box is a read-only display of entries from one or more address book containers. The dialog box can display all entries from the selected containers or be limited to only those entries and containers that match criteria established by a restriction. The contents restriction pointed to by <b>lpContRestriction</b> can limit the types of entries displayed and the hierarchy restriction pointed to by <b>lpHierRestriction</b> can limit the containers providing the entries. To inform the caller when the dialog box has been dismissed, MAPI invokes a function provided by the caller that conforms to the <a href="function_3j1v.htm"><b>DISMISSMODELESS</b></a> prototype. Another function, one that conforms to the <a href="function_3y09.htm"><b>ACCELERATEABSDI</b></a> prototype, is provided by MAPI and invoked by the caller in the Windows message loop to facilitate the working of accelerator keys. The modeless version of the MAPI address dialog box can be displayed when clients call <a href="inter006_2fn7.htm"><b>IAddrBook::Address</b></a><b> </b>or when service providers call <a href="inter025_2m2b.htm"><b>IMAPISupport::Address</b></a>. </p>
<p>
The following illustration shows the modeless address dialog box.</p>
<p>
<img src="images/addrbook.gif" border=0></p>
<p>
The modal dialog box is a read/write display of entries from one or more containers. Its contents can be affected in the same way as can the modeless version — by restrictions set in the <b>lpContRestriction</b> and <b>lpHierRestriction</b> members. In addition to the list box displaying container entries, the modal dialog box can contain between one and three edit box controls for holding entries selected by the user. Each edit control is associated with a particular recipient type — or <a href="propb_0n6t.htm">PR_RECIPIENT_TYPE</a> property — such as MAPI_TO. The modal address dialog box can be displayed by either of the <b>Address</b> methods or when clients call <a href="inter006_5er7.htm"><b>IAddrBook::Details</b></a> and service providers call <a href="inter025_5l6b.htm"><b>IMAPISupport::Details</b></a>. </p>
<p>
The following illustration shows the modal address dialog box.</p>
<p>
<img src="images/newab.gif" border=0></p>
<p>
This illustration includes two edit box controls because the <b>cDestFields</b> member of the <b>ADRPARM</b> structure controlling the display of this dialog box is set to 2. The first control has initial focus because the <b>nDestFieldFocus</b> member is set to 0. </p>
<p>
The <b>lpszNewEntryTitle</b> member points to text for a button label that, when selected, causes an additional dialog box to be displayed. Typically, as is shown in the illustration of the modal dialog box, the button is labeled <b>New</b> and the dialog box that is displayed lists all of the types of addresses that can be created by any of the address book providers in the profile. Clients cause this <b>New Entry</b> dialog box to be displayed by calling  <a href="inter006_7b7d.htm"><b>IAddrBook::NewEntry</b></a> and passing zero for the <i>cbEidNewEntryTpl</i> parameter and NULL for the <i>lpEidNewEntryTpl</i> parameter when the user selects the button. The information included in this dialog box comes from the MAPI one-off table.</p>
<p>
The following illustration shows the appearance of the <b>New Entry</b> dialog box.</p>
<p>
<img src="images/newenty2.gif" border=0></p>
<p>
Every entry in this dialog box is associated with a template for entering the data required to create an address of the particular type. Most address book providers supply one template for every type of address entry they can create. When a user makes a selection from this dialog box, MAPI displays the corresponding template.</p>
<p>
The most significant four bits of the <b>ADRPARM </b>structure's <b>ulFlags</b> member contain a version number identifying the version of the <b>ADRPARM</b> structure. The current version is 0 (zero) — or ADRPARM_HELP_CTX. The current implementation of MAPI will fail for any version of the structure other than zero. </p>
<p>
Future versions of the structure may be completely different; they may or may not support the version-zero structure. The following macros are provided for extracting the version number from the <b>ulFlags</b> member and for combining it with the defined flags:</p>
<p class=indent1>
<b>GET_ADRPARM_VERSION</b>(<i>ulFlags</i>) </p>
<p class=indent1>
<b>SET_ADRPARM_VERSION</b>(<i>ulFlags</i>,<i> ulVersion</i>)  </p>
<p class=indent1>
<b>ADRPARM_HELP_CTX</b> </p>
<h4>See Also</h4>
<p>
<a href="groups_4ucz.htm">Address Structures</a>, <a href="function_3y09.htm"><b>ACCELERATEABSDI</b></a>, <a href="function_3j1v.htm"><b>DISMISSMODELESS</b></a>, <a href="inter006_2fn7.htm"><b>IAddrBook::Address</b></a>, <a href="inter025_2m2b.htm"><b>IMAPISupport::Address</b></a>, <a href="structyp_45ny.htm"><b>SRestriction</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
