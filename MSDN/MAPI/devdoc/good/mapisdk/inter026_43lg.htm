<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPITable::Restrict</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapitable_restrict"></a>IMAPITable::Restrict</h2>
<p>
The <b>IMAPITable::Restrict</b> method applies a filter to a table, reducing the row set to only those rows matching the specified criteria.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>.</p>
<pre><code><b>HRESULT Restrict(
  LPSRestriction</b><i> lpRestriction</i><b>,</b>   
<b>  ULONG</b><i> ulFlags                   </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpRestriction</i></dt>
<dd>
[in] Pointer to an <a href="structyp_45ny.htm"><b>SRestriction</b></a> structure defining the conditions of the filter. Passing NULL in the <i>lpRestriction</i> parameter removes the current filter.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the timing of the restriction operation. The following flags can be set:
<dl>
<dt>
TBL_ASYNC</dt>
<dd>
Starts the operation asynchronously and returns before the operation completes.</dd>
<dt>
TBL_BATCH</dt>
<dd>
Defers evaluation of the filter until the data in the table is required.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The filter was successfully applied.</dd>
<dt>
MAPI_E_BUSY</dt>
<dd>
Another operation is in progress that prevents the restriction operation from starting. Either the operation in progress should be allowed to complete or it should be stopped.</dd>
<dt>
MAPI_E_TOO_COMPLEX</dt>
<dd>
The table cannot perform the operation because the particular filter pointed to by the <i>lpRestriction</i> parameter is too complicated. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPITable::Restrict</b> method establishes a restriction, or filter, on a table. If there is a previous restriction, it is discarded and the new one applied. Applying a restriction has no affect on the underlying data of a table; it simply alters the view by limiting the rows that can be retrieved to rows containing data that satisfy the restriction.</p>
<p>
There are several different types of restrictions, each described with a different structure. The <a href="structyp_45ny.htm"><b>SRestriction</b></a> structure contains two members: a value that indicates the type of restriction and the specific structure applicable for that type. </p>
<p>
Notifications for table rows that are hidden from view by calls to <b>Restrict</b> are never generated.</p>
<p>
A property restriction on a multivalued property works like a restriction on a single-valued property. A multivalued property to be used in a property restriction must have the MVI_FLAG flag set. If it doesn't have this flag set, it is treated as a totally ordered tuple. A comparison of two multivalued columns compares the column elements in order, reporting the relation of the columns at the first inequality. Equality is returned only if the columns compared contain the same values in the same order. If one column has fewer values than the other, the reported relation is that of a null value to the other value.</p>
<p>
For more information about restrictions, see <a href="tables_0qyb.htm">About Restrictions</a>.</p>
<h4>Notes to Callers</h4>
<p>
To discard the current restriction without creating a new one, pass NULL in <i>lpRestriction</i>.</p>
<p>
If another asynchronous table call is in progress, causing <b>Restrict</b> to return MAPI_E_BUSY, you can call <a href="inter026_2a5w.htm"><b>IMAPITable::Abort</b></a> to stop the call. </p>
<p>
<b>Restrict </b>operates synchronously unless you set one of the flags. If you set the TBL_BATCH flag, <b>Restrict</b> postpones the evaluation of the restriction unless you request the data. If the TBL_ASYNC flag is set, <b>Restrict </b>operates asynchronously, potentially returning before the completion of the operation.</p>
<p>
All bookmarks for a table are discarded when a call to <b>Restrict </b>is made, and BOOKMARK_CURRENT, the current cursor position, is set to the beginning of the table.</p>
<p>
If you attempt to impose a property restriction on a property that is not in the table's column set, the results are undefined. Whenever you are unsure as to whether a property is supported in a table, combine the property restriction with an exists restriction. The exists restriction checks for the existence of the property before attempting to impose the property restriction. </p>
<p>
Do not expect to receive a table notification on a row that has been filtered from a table due to a restriction.</p>
<h4>See Also</h4>
<p>
<a href="inter026_2a5w.htm"><b>IMAPITable::Abort</b></a>, <a href="inter026_2lkn.htm"><b>IMAPITable::FindRow</b></a>, <a href="inter026_5tkk.htm"><b>IMAPITable::GetRowCount</b></a>, <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>, <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a></p>
<p>&nbsp;</p></body>
</HTML>
