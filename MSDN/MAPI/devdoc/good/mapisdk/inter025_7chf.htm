<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISupport::StatusRecips</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisupport_statusrecips"></a>IMAPISupport::StatusRecips</h2>
<p>
The <b>IMAPISupport::StatusRecips</b> method generates delivery and nondelivery reports.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter025_8uge.htm"><b>IMAPISupport : IUnknown</b></a>.</p>
<pre><code><b>HRESULT StatusRecips(
  LPMESSAGE</b><i> lpMessage</i><b>,</b>   
<b>  LPADRLIST</b><i> lpRecipList  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpMessage</i></dt>
<dd>
[in] Pointer to the message for which the report should be generated.</dd>
<dt>
<i>lpRecipList</i></dt>
<dd>
[in] Pointer to an <a href="structyp_87n8.htm"><b>ADRLIST</b></a> structure describing the recipients of the message pointed to by <i>lpMessage</i>.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The report was successfully generated.</dd>
<dt>
MAPI_W_ERRORS_RETURNED</dt>
<dd>
The call succeeded overall, but there are no recipient options for this type of recipient. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISupport::StatusRecips</b> method is implemented for transport provider support objects. Transport providers call <b>StatusRecips</b> to request that MAPI send a delivery or nondelivery report to a set of one or more of the recipients of a message. </p>
<h4>Notes to Callers</h4>
<p>
You can call <b>StatusRecips </b>multiple times during the processing of a message. However, if you call <b>StatusRecips </b>for an open message, do your best to collect all delivery and nondelivery information for the message recipients and call <b>StatusRecips</b> for that recipient list. A single point of collection is important because multiple <b>StatusRecips </b>calls for one recipient can result in multiple identical reports being sent.</p>
<p>
Store properties relating to message delivery or nondelivery in the <a href="structyp_87n8.htm"><b>ADRLIST</b></a> structure indicated by the <i>lpRecipList</i> parameter. For a complete list of required and optional properties for delivery reports and nondelivery reports, see <a href="extend_2e9f.htm">Required Report Message Properties</a> and <a href="extend_0beb.htm">Optional Report Message Properties</a>. </p>
<p>
Allocate memory for the <b>ADRLIST </b>structure in <i>lpRecipList </i>using the <a href="function_8z3m.htm"><b>MAPIAllocateBuffer</b></a> and <a href="function_11wl.htm"><b>MAPIAllocateMore</b></a> functions. MAPI releases the memory by calling the <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a> function only if <b>IMAPISupport::StatusRecips</b> succeeds.</p>
<p>
For an overview of delivery and nondelivery reports, see <a href="extend_344z.htm">Report Messages</a>.</p>
<h4>See Also</h4>
<p>
<a href="structyp_87n8.htm"><b>ADRLIST</b></a>, <a href="inter025_2m2b.htm"><b>IMAPISupport::Address</b></a>, <a href="inter025_5b7d.htm"><b>IMAPISupport::SpoolerNotify</b></a>, <a href="inter042_576t.htm"><b>IXPLogon::EndMessage</b></a>, <a href="function_8z3m.htm"><b>MAPIAllocateBuffer</b></a>, <a href="function_11wl.htm"><b>MAPIAllocateMore</b></a>, <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a></p>
<p>&nbsp;</p></body>
</HTML>
