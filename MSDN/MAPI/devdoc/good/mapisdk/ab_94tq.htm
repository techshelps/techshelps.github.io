<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing an Address Book Provider Entry Point Function</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_implementing_an_address_book_provider_entry_point_function"></a>Implementing an Address Book Provider Entry Point Function</h2>
<p>
When a client application calls <a href="function_8to8.htm"><b>MAPILogonEx</b></a><b> </b>to begin a session using a profile that contains your address book provider, MAPI loads your provider and all others that are part of the profile. MAPI learns of the name of your provider's entry point function by looking in the profile. Remember that this function is not the same as a DLL entry point function; see the documentation for <b>DllEntryPoint</b> in the Win32 documentation. </p>
<p>
There are several entries, some of which must appear in the MAPISVC.INF configuration file, that are included in the profile section of every address book provider. The following table lists these profile section entries and whether or not the MAPISVC.INF file must include them.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=60%>Profile section entry</th>
<th align=left width=40%>MAPISVC.INF requirement</th>
</tr>
<tr valign=top>
<td width=60%>PR_DISPLAY_NAME=<i>string</i></td>
<td width=40%>Optional</td>
</tr>
<tr valign=top>
<td width=60%>PR_PROVIDER_DISPLAY=<i>string</i></td>
<td width=40%>Required</td>
</tr>
<tr valign=top>
<td width=60%>PR_PROVIDER_DLL_NAME=<i>DLL filename</i></td>
<td width=40%>Required</td>
</tr>
<tr valign=top>
<td width=60%>PR_RESOURCE_TYPE=<i>long</i></td>
<td width=40%>Required</td>
</tr>
<tr valign=top>
<td width=60%>PR_RESOURCE_FLAGS=<i>bitmask</i></td>
<td width=40%>Optional</td>
</tr>
</table><br>
<p>
Your address book provider can place this information into a profile directly by calling its profile section's <b>IMAPIProp::SetProps</b> method or indirectly by modifying MAPISVC.INF. Profiles are built using the relevant information in MAPISVC.INF for the selected service providers or message services. For more information about the organization and contents of MAPISVC.INF, see <a href="appxfile_723q.htm">File Format of MAPISVC.INF</a>.</p>
<p>
The name of your address book provider's DLL entry point function must be <a href="function_1sqc.htm"><b>ABProviderInit</b></a> and it must conform to the <b>ABProviderInit</b> prototype. Perform the following tasks in your provider's DLL entry point function:
<ul>
<li>
Check the version of the service provider interface (SPI) to make sure MAPI is using a version that is compatible with the version that your address book provider is using.</li>
<li>
Instantiate an address book provider object.</li>
</ul>
<p>
Do not call either <b>MAPIInitialize</b> or <b>MAPIUninitialize</b> in this function. </p>
<p>
The DLL entry point function instantiates a provider object and returns to MAPI a pointer to that object. </p>
<p>&nbsp;</p></body>
</HTML>
