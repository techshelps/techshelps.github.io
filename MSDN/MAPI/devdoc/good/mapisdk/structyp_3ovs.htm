<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DTBLCOMBOBOX</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_dtblcombobox"></a>DTBLCOMBOBOX</h2>
<p>
The <b>DTBLCOMBOBOX</b> structure describes a combo box control to be used in a dialog box built from a display table.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIDEFS.H</td>
</tr>
<tr valign=top>
<td width=48%>Related macro:</td>
<td width=52%><a href="structyp_76t4.htm"><b>SizedDtblComboBox</b></a></td>
</tr>
</table><br>
<pre><code>typedef struct _DTBLCOMBOBOX 
{ 
     ULONG ulbLpszCharsAllowed; 
     ULONG ulFlags; 
     ULONG ulNumCharsAllowed; 
     ULONG ulPRPropertyName; 
     ULONG ulPRTableName; 
} DTBLCOMBOBOX, FAR *LPDTBLCOMBOBOX; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>ulbLpszCharsAllowed</b></dt>
<dd>
An offset from the beginning of the <b>DTBLCOMBOBOX</b> structure to a character string filter that describes restrictions, if any, to the characters that can be entered into the combo box's edit control. 
<p>
The filter is not interpreted as a regular expression and the same filter is applied to every character entered.The format of the filter is as follows:

<p>
<b>*</b>Any character is allowed (for example, "<b>*</b>").

<p>
<b>[  ]</b>Defines a set of characters (for example, "<b>[</b>0123456789<b>]</b>").

<p>
<b>-</b>Indicates a range of characters (for example, "[a-z]").

<p>
<b>~</b>Indicates that these characters are not allowed. (for example, "[~0-9]").

<p>
<b>\</b>Used to quote any of the above symbols (for example, "[<b>\</b>-<b>\</b>\<b>\</b>[<b>\</b>]]" means -, \, [, and ] characters are allowed).

<p>
<b>ulFlags</b>

<p>
Bitmask of flags used to designate the format of the character string filter. The following flag can be set:

<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The filter is in Unicode format. If the MAPI_UNICODE flag is not set, the filter is in ANSI format.</dd>
</dl>
</dd>
<dt>
<b>ulNumCharsAllowed</b></dt>
<dd>
Maximum number of characters that can be entered in the combo box's edit box.</dd>
<dt>
<b>ulPRPropertyName</b></dt>
<dd>
Property tag for a property of type PT_TSTRING. </dd>
<dt>
<b>ulPRTableName</b></dt>
<dd>
Property tag for a property of type PT_OBJECT on which an <b>IMAPITable</b> interface can be opened using an <b>OpenProperty</b> call. The table must have one column with a property that is the same type as the property identified by the <b>ulPRPropName </b>member. The rows of the table are used to populate the list box. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
A <b>DTBLCOMBOBOX</b> structure describes a combo box — a control that consists of a list box and a selection field. The list box presents the information from which a user can select, and the selection field displays the current selection. The selection field is an edit control that can also be used to enter text not already in the list. </p>
<p>
The following dialog box includes an example of a combo box.</p>
<p>
<img src="images/combobox.gif" border=0></p>
<p>
The two property tag members work together to coordinate the list box display with the edit control. When MAPI first displays the combo box, it calls the <b>OpenProperty</b> method of the <b>IMAPIProp</b> implementation that is associated with the display table to retrieve the table represented by the <b>ulPRTableName</b> member. This table has one column — a column that contains values for the property represented by the <b>ulPRPropertyName</b> member. Therefore, this column must be of the same type as the <b>ulPRPropertyName</b> property and both columns must be character strings. </p>
<p>
The values for the column are displayed in the list box portion of the combo box. Therefore, PR_NULL is not a valid property tag for <b>ulPRPropertyName</b>. When a user either selects one of the rows or enters new data into the edit box, the <b>ulPRPropertyName</b> property is set to the selected or entered value. </p>
<p>
To display an initial value for the edit control, MAPI calls <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> to retrieve the property values for the display table. If one of the retrieved properties matches the property represented by the <b>ulPRPropertyName</b> member, its value becomes the initial value. </p>
<p>
For an overview of display tables, see <a href="tables_6rw3.htm">Display Tables</a>. For information about implementing a display table, see <a href="provider_155x.htm">Implementing a Display Table</a>.</p>
<h4>See Also</h4>
<p>
<a href="groups_6vqr.htm">Display Table Structures</a>, <a href="structyp_9sh8.htm"><b>DTCTL</b></a>,<b> </b><a href="propa_2w9x.htm">PR_CONTROL_TYPE</a>  </p>
<p>&nbsp;</p></body>
</HTML>
