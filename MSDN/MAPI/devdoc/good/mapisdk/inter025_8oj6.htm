<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISupport::CopyFolder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisupport_copyfolder"></a>IMAPISupport::CopyFolder</h2>
<p>
The <b>IMAPISupport::CopyFolder</b> method copies or moves a folder from its current parent folder to another parent folder.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter025_8uge.htm"><b>IMAPISupport : IUnknown</b></a>.</p>
<pre><code><b>HRESULT CopyFolder(
  LPCIID</b><i> lpSrcInterface</i><b>,</b>   
<b>  LPVOID</b><i> lpSrcFolder</i><b>,</b>      
<b>  ULONG</b><i> cbEntryID</i><b>,</b>         
<b>  LPENTRYID</b><i> lpEntryID</i><b>,</b>     
<b>  LPCIID</b><i> lpInterface</i><b>,</b>      
<b>  LPVOID</b><i> lpDestFolder</i><b>,</b>     
<b>  LPSTR</b><i> lpszNewFolderName</i><b>,</b>   
<b>  ULONG</b><i> ulUIParam</i><b>,</b>         
<b>  LPMAPIPROGRESS</b><i> lpProgress</i><b>,</b>   
<b>  ULONG</b><i> ulFlags            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpSrcInterface</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) representing the interface to be used to access the parent folder of the folder to be copied or moved.</dd>
<dt>
<i>lpSrcFolder</i></dt>
<dd>
[in] Pointer to the parent folder of the folder to be copied or moved. </dd>
<dt>
<i>cbEntryID</i></dt>
<dd>
[in] Count of bytes in the entry identifier pointed to by <i>lpEntryID</i>.</dd>
<dt>
<i>lpEntryID</i></dt>
<dd>
[in] Pointer to the entry identifier of the folder to be copied or moved. </dd>
<dt>
<i>lpInterface</i></dt>
<dd>
Reserved; must be NULL.</dd>
<dt>
<i>lpDestFolder</i></dt>
<dd>
[in] Pointer to the folder that is to receive the folder to be copied or moved.</dd>
<dt>
<i>lpszNewFolderName</i></dt>
<dd>
[in] Pointer to the name of the copied or moved folder or NULL, indicating that the copied or moved folder should have the same name as the source folder, the folder pointed to by <i>lpEntryID</i>.</dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the window for the progress indicator dialog box and related windows. The <i>ulUIParam </i>parameter is ignored unless the FOLDER_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>lpProgress</i></dt>
<dd>
[in] Pointer to a progress object for displaying a progress indicator. If NULL is passed in <i>lpProgress</i>, the message store provider displays a progress indicator using the MAPI progress object implementation. The <i>lpProgress</i> parameter is ignored unless the FOLDER_DIALOG flag is set in <i>ulFlags</i>.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the copy or move operation is accomplished. The following flags can be set:
<dl>
<dt>
COPY_SUBFOLDERS</dt>
</dl>
</dd>
</dl>
<p>
All of the folder's subfolders should be copied or moved. When COPY_SUBFOLDERS is not set for a copy operation, only the folder identified by <i>lpEntryID</i> is copied. With a move operation, the COPY_SUBFOLDERS behavior is the default regardless of whether the flag is set.
<dl>
<dt>
FOLDER_DIALOG</dt>
<dd>
Requests the display of a progress indicator.</dd>
<dt>
FOLDER_MOVE</dt>
<dd>
The folder should be moved rather than copied. If FOLDER_MOVE is not set, the folder is copied.</dd>
<dt>
MAPI_UNICODE</dt>
<dd>
The name of the folder is in Unicode format. If the MAPI_UNICODE flag is not set, the name of the folder is in ANSI format.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The folder has been successfully copied or moved.</dd>
<dt>
MAPI_E_COLLISION</dt>
</dl>
<p>
The name of the folder being moved or copied is the same as that of a subfolder in the destination folder. The message store provider requires that folder names be unique. The operation stops without completing.
<dl>
<dt>
MAPI_W_PARTIAL_COMPLETION</dt>
</dl>
<p>
The call succeeded, but not all entries were successfully copied. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.</p>
<h4>Remarks</h4>
<p>
The <b>IMAPISupport::CopyFolder</b> method is implemented for message store provider support objects. Message store providers can call <b>CopyFolder</b> in their implementation of<b> <a href="inter013_0mcy.htm">IMAPIFolder::CopyFolder</a></b> to copy or move a single folder from one parent folder to another.</p>
<p>
<b>CopyFolder</b> adds the copied or moved folder as a subfolder of the destination folder. </p>
<h4>Notes to Callers</h4>
<p>
<b>CopyFolder</b> allows simultaneous renaming and moving of folders and the copying or moving of subfolders of the affected folder. To copy or move all subfolders nested within the copied or moved folder, pass the COPY_SUBFOLDERS flag in <i>ulFlags</i>. </p>
<p>
Expect these return values under the following conditions:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Condition</th>
<th align=left width=52%>Return value</th>
</tr>
<tr valign=top>
<td width=48%><b>CopyFolder</b> has successfully copied or moved the folder and all of its subfolders, if applicable.</td>
<td width=52%>S_OK</td>
</tr>
<tr valign=top>
<td width=48%><b>CopyFolder</b> was unable to successfully copy or move all of the folders.</td>
<td width=52%>MAPI_W_PARTIAL_COMPLETION</td>
</tr>
<tr valign=top>
<td width=48%><b>CopyFolder </b>was unable to complete.</td>
<td width=52%>Any error value</td>
</tr>
</table><br>
<p>
If <b>CopyFolder</b> returns an error value, do not proceed on the assumption that no work was done. One or more folders could have been copied or moved before <b>CopyFolder</b> experienced the failure.</p>
<p>&nbsp;</p></body>
</HTML>
