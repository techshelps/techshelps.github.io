<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIProgress::GetFlags</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapiprogress_getflags"></a>IMAPIProgress::GetFlags</h2>
<p>
The <b>IMAPIProgress::GetFlags</b> method returns flag settings from the progress object for the level of operation on which progress information is calculated.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter021_7icu.htm"><b>IMAPIProgress : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetFlags(
  ULONG FAR *</b><i> lpulFlags  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpulFlags</i></dt>
<dd>
[out] Bitmask of flags that controls the level of operation on which progress information is calculated. The following flag can be returned:
<dl>
<dt>
MAPI_TOP_LEVEL</dt>
<dd>
Progress is being calculated for the top-level object — the object that is called by the client to begin the operation. For example, the top-level object in a folder copy operation is the folder being copied. 
<p>
When MAPI_TOP_LEVEL is not set, progress is being calculated for a lower level object, or subobject. In the folder copy operation, a lower level object would be one of the subfolders in the folder being copied. 

</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The flags value was returned successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
MAPI allows service providers to differentiate between top-level objects and subobjects with the MAPI_TOP_LEVEL flag so that all objects involved in an operation can use the same <b>IMAPIProgress</b> implementation to show progress, thereby causing the indicator display to proceed smoothly in a single positive direction. Whether or not the MAPI_TOP_LEVEL flag is set determines how service providers set the other parameters in subsequent calls to the progress object. </p>
<p>
The value returned by <b>GetFlags</b> is set initially by the implementer and subsequently by the service provider through a call to <a href="inter021_1wfn.htm"><b>IMAPIProgress:SetLimits</b></a>. </p>
<h4>Notes to Implementers</h4>
<p>
Always initialize the flag to MAPI_TOP_LEVEL and then rely on service providers to clear it when appropriate. Service providers can clear and reset the flag by calling <b>IMAPIProgress::SetLimits</b>. For more information about implementing <b>GetFlags</b> and the other <b>IMAPIProgress</b> methods, see <a href="consider_6m5u.htm">Implementing a Progress Indicator</a>.</p>
<h4>Notes to Callers</h4>
<p>
When displaying a progress indicator, make your first call a call to <b>IMAPIProgress::GetFlags</b>. The value returned should be MAPI_TOP_LEVEL because all implementations initialize the contents of <i>lpulFlags</i> to this value. For more information about the sequence of calls to a progress object, see <a href="provider_319s.htm">Displaying Progress Step by Step</a>.</p>
<h4>See Also</h4>
<p>
<a href="inter021_1wfn.htm"><b>IMAPIProgress::SetLimits</b></a></p>
<p>&nbsp;</p></body>
</HTML>
