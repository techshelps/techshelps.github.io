<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Permissions for Objects and Properties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_permissions_for_objects_and_properties"></a>Permissions for Objects and Properties</h1>
<p>
Access permission, or the set of permissable operations, can be a characteristic of MAPI objects and of individual properties supported by those objects. Object access is determined by an object's parent. For a message, its folder determines access permissions. For a messaging user or distribution list, its address book container makes this determination. When an object such as a message resides in two folders, the permissions for the two copies of the object can be different. </p>
<p>
Clients using these objects can request the highest level of access permitted for the object by setting the MAPI_BEST_ACCESS flag on the <a href="inter023_146x.htm"><b>IMAPISession::OpenEntry</b></a> call. Depending on the service provider implementing the object, the client may or may not be granted the level of access necessary. Clients can determine the level of access that they were granted by calling the object's <b>GetProps</b> method to retrieve the <a href="propa_63eb.htm">PR_ACCESS</a> property. However, because the service provider must dynamically generate the value for this property, it is recommended that clients retrieve it only when necessary. </p>
<p>
To determine whether a container such as a folder, address book container, or distribution list allows modification, call its <b>GetProps</b> method to retrieve the <a href="propa_4w8c.htm">PR_ACCESS_LEVEL</a> property. Container level access affects clients in terms of how they display their user interfaces. It also impacts the implementers of objects within containers in terms of their user interface display and their general implementation. </p>
<p>
Access to a particular property is determined by the property schema set up by MAPI for the object that owns the property. Property schemas specify the set of required and optional properties for an object and their access permission. Unlike object access which is determined by the object's parent, property access is global. Every object, regardless of the access requirements of the object's parent, has the same permissions for the property as determined by the schema.</p>
<p>
When a property is read-only, it will always be available with a <b>GetProps</b> or <b>OpenProperty</b> call. However, depending on the implementation of the object supporting the property, there are two possible outcomes for the <b>SetProps</b> method for modifying a property and the <b>DeleteProps</b> method for removing it:
<ul>
<li>
Fail and return MAPI_E_NO_ACCESS</li>
<li>
Succeed with no action taken</li>
</ul>
<p>
Property and object access can also be retrieved or set using one of the interfaces that inherits from <b>IMAPIProp</b>, <a href="inter037_5prk.htm"><b>IPropData</b></a>. MAPI provides an implementation of <b>IPropData</b> that is based on data in memory. Service providers can use <b>IPropData</b> to implement <b>IMAPIProp</b> in certain circumstances, such as for their status object or if they are using a database that does not have built-in transactions. <b>IPropData</b> works exclusively in memory, making it unnecessary to lock and unlock data. </p>
<p>&nbsp;</p></body>
</HTML>
