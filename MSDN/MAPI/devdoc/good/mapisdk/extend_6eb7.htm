<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Character Sets</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_character_sets"></a>Character Sets</h1>
<p>
MAPI-compliant client applications and service providers can use ANSI characters (single byte) or Unicode characters (double byte). OEM character sets are not supported; an OEM string passed to a MAPI method or function will cause that method or function to fail. Client applications that work with filenames in the OEM character set must be careful to convert them to ANSI before passing them to a MAPI method or function.</p>
<p>
Supporting the Unicode character set is optional, both for clients and service providers. All service providers should write their code so that they can compile the same regardless of whether or not they support Unicode. Clients compile conditionally, depending on their level of support, but service providers do not. They should not have to be recompiled when the character set changes. Nothing in service provider code should be conditional. </p>
<p>
When clients or service providers that support Unicode make a method call that includes character strings as input or output parameters, they set the MAPI_UNICODE flag. Setting this flag indicates to the implementation that all incoming strings are Unicode strings. On output, setting this flag requests that all strings passed back from the implementation should be Unicode strings if possible. Method implementers that support Unicode will comply with the request; method implementers that do not provide Unicode support will not comply. String properties that are not in Unicode format are of type PT_STRING8.</p>
<p>
MAPI defines the <b>fMapiUnicode</b> constant in the header file MAPIDEFS.H to represent the default character set. If a client or service provider supports Unicode, <b>fMapiUnicode</b> is set to MAPI_UNICODE. Clients and service providers that do not support Unicode set <b>fMapiUnicode</b> to zero. </p>
<p>
Service providers that do not support Unicode should:
<ul>
<li>
Refuse to perform conversions between character sets.</li>
<li>
Never pass the MAPI_UNICODE flag in method calls.</li>
<li>
Return MAPI_E_BAD_CHARWIDTH when the MAPI_UNICODE flag is passed in.</li>
<li>
Declare ANSI string properties explicitly. </li>
</ul>
<p>
Service providers can also return MAPI_E_BAD_CHARWIDTH when they only support Unicode and clients do not pass the MAPI_UNICODE flag. </p>
<p>
<b>Note</b>  The current version of MAPI supports Unicode on the Windows NT platform in the following methods:</p>
<p class=indent1>
<a href="inter006_2fn7.htm"><b>IAddrBook::Address</b></a></p>
<p class=indent1>
<a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a></p>
<p class=indent1>
<a href="inter006_5er7.htm"><b>IAddrBook::Details</b></a></p>
<p class=indent1>
<a href="inter006_64v9.htm"><b>IAddrBook::ResolveName</b></a></p>
<p class=indent1>
<a href="inter022_1hv6.htm"><b>IMAPIProp::GetLastError</b></a> (<b>IAddrBook</b> implementation only)</p>
<p>
For these methods, callers can expect any returned strings to be Unicode strings. Character strings returned from MAPI implementations of any other method will be ANSI character strings.</p>
<p>&nbsp;</p></body>
</HTML>
