<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Rendering an Attachment in Plain Text</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_rendering_an_attachment_in_plain_text"></a>Rendering an Attachment in Plain Text</h2>
<p>
To render an attachment in a message with plain text, retrieve the attachment's <a href="propb_8uni.htm">PR_RENDERING_POSITION</a> property and apply it to the data in the <a href="propa_66sn.htm">PR_ATTACH_RENDERING</a> property. There are two ways to retrieve PR_RENDERING_POSITION:
<ul>
<li>
Open the attachment by calling the message's <a href="inter029_7qco.htm"><b>IMessage::OpenAttach</b></a> method and then ask for the PR_RENDERING_POSITION property by calling the attachment's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method. </li>
<li>
Call the message's <a href="inter029_24it.htm"><b>IMessage::GetAttachmentTable</b></a> method to access its attachment table and retrieve the column that holds the PR_RENDERING_POSITION property. This way is always preferable.</li>
</ul>
<p>
Keep in mind that many RTF-aware message stores do not calculate PR_RENDERING_POSITION until a client requests the PR_BODY property of a message. Until that time, PR_RENDERING_POSITION usually represents an approximate value. Message store providers are allowed to supply clients with an approximate value to enhance performance. </p>
<p>
The rendering for a file or binary attachment is stored in its PR_ATTACH_RENDERING property. You have the choice of retrieving PR_ATTACH_RENDERING in the same ways as you retrieved PR_RENDERING_POSITION: directly from the attachment or from the attachment table. For PR_ATTACH_RENDERING, the first strategy, although more time-consuming, is safer. Because some message store providers truncate their table columns to 255 bytes, or in a few cases 510 bytes, it is difficult to be sure that the PR_ATTACH_RENDERING column contains the complete rendering. When retrieving the property directly from the attachment, it will always be complete. </p>
<p>
Neither OLE nor message attachments set PR_ATTACH_RENDERING. Instead, rendering information for OLE 1 attachments is stored in the message text stream. For OLE 2 attachments, it is stored in a special child stream of the storage object. Rendering information for message attachments is available through the form manager. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To retrieve the rendering for a message attachment</h5>
<ol>
<li>
Use the message class of the message to access the form manager.</li>
<li>
Access the form manager's <a href="propb_9tta.htm">PR_MINI_ICON</a> property.</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
