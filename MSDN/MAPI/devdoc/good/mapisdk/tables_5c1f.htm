<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Hierarchy Tables</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_hierarchy_tables"></a>Hierarchy Tables</h1>
<p>
A hierarchy table contains information about the folders in a message store or the containers in an address book container. Each row of a hierarchy table contains a set of columns with information about one folder or address book container. Hierarchy tables are used primarily by clients and implemented by message store providers to show a tree of folders and subfolders and implemented by address book providers to show a tree of containers within the address book. Containers that cannot hold subcontainers, as indicated by the absence of the AB_SUBCONTAINERS flag in their <a href="propa_3m7n.htm">PR_CONTAINER_FLAGS</a> property, do not implement a hierarchy table.</p>
<p>
A hierarchy table can be accessed by calling:
<ul>
<li>
<a href="inter011_1sh1.htm"><b>IMAPIContainer::GetHierarchyTable</b></a>.<p>
– Or –
</li>
<li>
<a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> passing <a href="propa_13sp.htm">PR_CONTAINER_HIERARCHY</a> as the property tag and IID_IMAPITable as the interface identifier.</li>
</ul>
<p>
Containers and folders must support both techniques for retrieving table properties. It is unacceptable for service providers to support only one way for accessing these tables because clients expect to have the choice. </p>
<p>
The call to <b>IMAPIProp::OpenProperty</b> involves accessing the hierarchy table by opening its corresponding property, PR_CONTAINER_HIERARCHY. Although PR_CONTAINER_HIERARCHY cannot be retrieved through a folder or container's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method, it is included in the property tag array that is returned by the <a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a> method.</p>
<p>
PR_CONTAINER_HIERARCHY can also be used to include or exclude a hierarchy table from a copy operation. If a client specifies PR_CONTAINER_HIERARCHY in the <i>lpExcludeProps </i>parameter for <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a><b> </b>in a copy operation, the new folder or container will not support the hierarchy table of the original folder or container.</p>
<p>
The following properties make up the required column set in a hierarchy table:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="propa_1m5w.htm">PR_COMMENT</a></td>
<td width=52%><a href="propa_8xk8.htm">PR_DEPTH</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propa_1yjp.htm">PR_DISPLAY_NAME</a></td>
<td width=52%><a href="propa_7s6d.htm">PR_DISPLAY_TYPE</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propa_8cv8.htm">PR_ENTRYID</a></td>
<td width=52%><a href="propa_65h5.htm">PR_INSTANCE_KEY</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_0okl.htm">PR_OBJECT_TYPE</a></td>
<td width=52%><a href="propb_1ir7.htm">PR_STATUS</a></td>
</tr>
</table><br>
<p>
<a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> contains the name for the container or folder that should appear in the display of the hierarchy.</p>
<p>
<a href="propa_8cv8.htm">PR_ENTRYID</a> is the entry identifier associated with this container or folder. It is expected to be a long-term entry identifier. Clients and MAPI can pass this entry identifier to <b>OpenEntry</b> to open the container or folder and view its contents by calling <a href="inter011_0sx1.htm"><b>IMAPIContainer::GetContentsTable</b></a>. </p>
<p>
<a href="propa_8xk8.htm">PR_DEPTH</a> is a numeric value that indicates the level of indentation for this container or folder with zero being the top level. The deeper in the hierarchy a a container or folder resides, the higher the value for its PR_DEPTH property. Clients use the PR_DEPTH property to display a hierarchy table appropriately so that users can clearly see parent and child relationships. Container or folder depth is always relative to the container or folder implementing the hierarchy table. </p>
<p>
<a href="propb_0okl.htm">PR_OBJECT_TYPE</a> is always set to MAPI_ABCONT for address book hierarchy tables and MAPI_FOLDER for folder hierarchy tables. </p>
<p>
<a href="propa_7s6d.htm">PR_DISPLAY_TYPE</a> is a numeric value that relates to how a container or folder is displayed in the hierarchy table. It is mainly used for display purposes, to differentiate visually between types of containers or folders. Many message store and address book providers use icons for the different display types. It is up to the provider to supply these icons; MAPI does not supply defaults.</p>
<p>
MAPI defines many values for PR_DISPLAY_TYPE, some that are valid for folders and others that are used with the hierarchy tables of address book containers. Typically, a folder's PR_DISPLAY_TYPE is set to DT_FOLDER to indicate a default folder icon, DT_FOLDER_LINK to indicate an icon that represents a link to another folder, or DT_FOLDER_SPECIAL to indicate an icon that is application-specific. DT_FOLDER_LINK is used with search-results folders.</p>
<p>
In addition to these required columns, address book hierarchy tables must include the PR_CONTAINER_FLAGS property. <a href="propa_3m7n.htm">PR_CONTAINER_FLAGS</a> indicates various attributes about a container in the hierarchy and is used to distinguish one container from another. </p>
<p>
An optional property for address book hierarchy tables is the <a href="propa_1mw4.htm">PR_AB_PROVIDER_ID</a> property.</p>
<p>
Message-store hierarchy tables include these properties in their required column set:</p>
<p class=indent1>
<a href="propa_0vhh.htm">PR_FOLDER_TYPE</a></p>
<p class=indent1>
<a href="propb_1z77.htm">PR_SUBFOLDERS</a></p>
<p class=indent1>
<a href="propa_6644.htm">PR_CONTENT_COUNT</a></p>
<p class=indent1>
<a href="propa_9up0.htm">PR_CONTENT_UNREAD</a></p>
<p>
Address book providers must support the following <b>IMAPITable</b> methods in their hierarchy table implementations because they are required by the MAPI integrated address book:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="inter026_98c3.htm"><b>QueryColumns</b></a></td>
<td width=52%><a href="inter026_53n2.htm"><b>QueryPosition</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="inter026_8xx3.htm"><b>SeekRow</b></a></td>
<td width=52%><a href="inter026_7kjc.htm"><b>SeekRowApprox</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="inter026_2lkn.htm"><b>FindRow</b></a></td>
<td width=52%><a href="inter026_43lg.htm"><b>Restrict</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="inter026_0v3f.htm"><b>CreateBookmark</b></a></td>
<td width=52%><a href="inter026_7t63.htm"><b>FreeBookmark</b></a><b> </b></td>
</tr>
<tr valign=top>
<td width=48%><a href="inter026_7wkz.htm"><b>QueryRows</b></a></td>
<td width=52%></td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
