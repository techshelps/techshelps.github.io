<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IProfAdmin::CreateProfile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iprofadmin_createprofile"></a>IProfAdmin::CreateProfile</h2>
<p>
The <b>IProfAdmin::CreateProfile</b> method creates a new profile.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter035_46y6.htm"><b>IProfAdmin : IUnknown</b></a>.</p>
<pre><code><b>HRESULT CreateProfile(
  LPTSTR</b><i> lpszProfileName</i><b>,</b>   
<b>  LPTSTR</b><i> lpszPassword</i><b>,</b>   
<b>  ULONG</b><i> ulUIParam</i><b>,</b>       
<b>  ULONG</b><i> ulFlags          </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszProfileName</i></dt>
<dd>
[in] Pointer to the name of the new profile.</dd>
<dt>
<i>lpszPassword</i></dt>
<dd>
[in] Pointer to the password of the new profile. </dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for any dialog boxes or windows this method displays.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the profile is created. The following flags can be set:
<dl>
<dt>
MAPI_DEFAULT_SERVICES</dt>
<dd>
MAPI should populate the new profile with the message services that are included in the <b>[Default Services]</b> section of the MAPISVC.INF file.</dd>
<dt>
MAPI_DIALOG</dt>
<dd>
The configuration property sheets of each of the providers in the message services to be added can be displayed. </dd>
<dt>
MAPI_UNICODE</dt>
<dd>
The profile name and password are in Unicode format. If the MAPI_UNICODE flag is not set, these strings are in ANSI format.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The new profile was created.</dd>
<dt>
MAPI_E_NO_ACCESS</dt>
<dd>
The specified new profile already exists.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IProfAdmin::CreateProfile</b> method creates a new profile. </p>
<h4>Notes to Callers</h4>
<p>
You can call <b>CreateProfile</b> at application installation time or at any time during a session. When called at installation time, many of the configuration settings come from the MAPISVC.INF configuration file. When called during an active session, the settings come from the user who is prompted through a series of property sheets.</p>
<p>
If the MAPI_DEFAULT_SERVICES flag is set in the <i>ulFlags</i> parameter, <b>CreateProfile</b> calls the message service entry point function for each message service in the <b>[Default Services]</b> section in the MAPISVC.INF file. Each message service entry point function is called with the <i>ulContext</i> parameter set to MSG_SERVICE_CREATE. </p>
<p>
If both the MAPI_DIALOG and MAPI_DEFAULT_SERVICES flags are set, then the values in the <i>ulUIParam</i> and <i>ulFlags</i> parameters are also passed to the message service entry point function. The message service entry point functions are only called after all available information from the MAPISVC.INF file has been added to the profile. </p>
<p>
The name of the new profile and its password can be up to 64 characters in length and can include the following characters: 
<ul>
<li>
All alphanumeric characters, including accent characters and the underscore character.</li>
<li>
Embedded spaces, but not leading or trailing spaces.</li>
</ul>
<p>
Profile passwords are not supported on all operating system platforms; on platforms that do not support profile passwords, <i>lpszPassword</i> can be NULL or a pointer to a zero-length string. Currently, Windows NT Server and Windows 95 do not support passwords; Windows version 3.1 does.</p>
<h4>See Also</h4>
<p>
<a href="inter030_4cv9.htm"><b>IMsgServiceAdmin::ConfigureMsgService</b></a>, <a href="inter030_60th.htm"><b>IMsgServiceAdmin::CreateMsgService</b></a>, <a href="function_7nnd.htm"><b>MSGSERVICEENTRY</b></a></p>
<p>&nbsp;</p></body>
</HTML>
