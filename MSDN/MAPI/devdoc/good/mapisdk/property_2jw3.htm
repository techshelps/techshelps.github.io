<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Named Properties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_named_properties"></a>Named Properties</h1>
<p>
MAPI provides a facility for assigning names to properties, for mapping these names to unique identifiers, and for making this mapping persistent. Persistent name to identifier mapping ensures that property names remain valid across sessions. </p>
<p>
To define a named property, a client or service provider makes up a name and stores it in a <a href="structyp_1iqs.htm"><b>MAPINAMEID</b></a> structure. Because names are made up of a 32-bit globally unique identifier, or GUID, and either a Unicode character string or numeric value, creators of named properties can create meaningful names without fear of duplication. Names are unique and they can be used without regard to the value of their identifiers.</p>
<p>
To support named properties, a service provider implements two <b>IMAPIProp</b> methods — <a href="inter022_49f7.htm"><b>GetIDsFromNames</b></a> and <a href="inter022_7ib7.htm"><b>GetNamesFromIDs</b></a> — to translate between names and identifiers and allows its <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a><b> </b>and <a href="inter022_6cxf.htm"><b>IMAPIProp::SetProps</b></a> methods to retrieve and modify properties with identifiers in the named property range. The range for named property identifiers is between 0x8000 and 0xFFFE. </p>
<p>
Any object that implements the <b>IMAPIProp</b> interface can support named properties. Address book providers that allow entries from other providers to be copied into their containers and message store providers that can be used to create arbitrary message types are required to supply this support. It is an option for all other service providers. Providers that do not support named properties return MAPI_E_NO_SUPPORT from the <b>GetIDsFromNames</b> and <b>GetNamesFromIDs</b> methods and refuse to set any properties with identifiers of 0x8000 or greater, returning MAPI_E_UNEXPECTED in the <b>SPropProblem</b> array.</p>
<p>
Creating names for properties is one way for clients to define new properties for existing or custom message classes. Service providers can use named properties to expose unique features of their messaging systems. Yet another use for named properties is to provide an alternate way of referring to properties with identifiers below 0x8000. </p>
<p>
For example, a client could use code similar to the following code to retrieve the names for all of an object's named properties:</p>
<pre><code>LPSPropTagArray FAR *    lppPropTags = NULL;
LPGUID                   lpPropSetGuid = NULL;
ULONG FAR *              lpcPropNames;
LPMAPINAMEID FAR * FAR * lpppPropNames;

lpMAPIProp-&gt;GetNamesFromIDs (lppPropTags,
                             lpPropSetGuid,
                             0,
                             lpcPropNames,
                             lpppPropNames);
 </code></pre>
<p>
To request all names from the PS_PUBLIC_STRINGS property set, a client would replace the NULL in the property set parameter to PS_PUBLIC_STRINGS as follows: </p>
<pre><code>LPSPropTagArray FAR *    lppPropTags = NULL;
LPGUID                   lpPropSetGuid = &amp;PS_PUBLIC_STRINGS;
ULONG FAR *              lpcPropNames;
LPMAPINAMEID FAR * FAR * lpppPropNames;

lpMAPIProp-&gt;GetNamesFromIDs (lppPropTags,
                             lpPropSetGuid,
                             0,
                             lpcPropNames,
                             lpppPropNames);
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
