<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Remote Transport Architecture</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_remote_transport_architecture"></a>Remote Transport Architecture</h2>
<p>
Your remote transport needs to translate user requests for message data into intelligently managed connections to the messaging server without requiring the user to manage the individual connections. This is accomplished through the MAPI remote architecture as shown in the following illustration.</p>
<p>
<img src="images/xprem01.gif" border=0></p>
<p>
Client applications which are remote-enabled (remote viewers) communicate with the MAPI spooler and remote transport providers as usual for nonremote tasks such as logging on or flushing queues. In addition, the client application uses the remote transport's <a href="inter013_9ohe.htm"><b>IMAPIFolder</b></a> interface to perform remote tasks such as downloading message headers.</p>
<p>
The remote viewer is a client application designed to work with remote transport providers. Remote viewer applications can check the MAPI status table for remote transport providers, those that have set the STATUS_REMOTE_ACCESS bit in their status table row, and adjust their user interface appropriately. Remote viewers are expected to utilize a special folder that contains header information about messages in the user's Inbox. The header information is stored locally and can be used to selectively mark messages for download or deletion.</p>
<p>
A remote transport provider is similar to a message store because it implements the <b>IMAPIFolder</b> interface; however, the folder so implemented is not identical to the generalized hierarchical folders that message stores implement. For a remote transport provider, the folder is an intermediary between the client application and the remotely accessed message store. The message headers and message identifiers in the folder do not necessarily correspond to messages that are stored locally on the user's computer or stored in any immediately accessible way.</p>
<p>
The folder is expected not to have subfolders, although the presence of subfolders should not cause client application problems since they should not be displayed. Opening the folder does not cause the folder's contents to be downloaded. At the user's request, message headers can be downloaded and looked at off-line or at a later time. Remote transport providers should provide some sort of local cache or storage facility for downloaded message headers so that the folder can be populated with cached message headers when it is opened without connecting to the remote message store.</p>
<p>&nbsp;</p></body>
</HTML>
