<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Managing Memory for ADRLIST and SRowSet Structures</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_managing_memory_for_adrlist_and_srowset_structures"></a>Managing Memory for ADRLIST and SRowSet Structures</h2>
<p>
The requirement to allocate all memory for a buffer whenever possible with a single <a href="function_8z3m.htm"><b>MAPIAllocateBuffer</b></a> call does not apply when using the address list, or <a href="structyp_87n8.htm"><b>ADRLIST</b></a>, and row set, or <a href="structyp_2378.htm"><b>SRowSet</b></a>, structures. These two structures are exceptions to the standard rules for allocating and releasing memory. They contain multiple levels of structures and are designed to enable individual members to be added or removed. Therefore, each property must be a separate allocation. Where most structures are freed with one call to <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a>, each individual entry in an <b>ADRLIST</b> or <b>SRowSet </b>structure must be freed with its own call to <b>MAPIFreeBuffer</b> or a single call to either <a href="function_3wkz.htm"><b>FreeProws</b></a> or <a href="function_1z5g.htm"><b>FreePadrlist</b></a>. <b>FreeProws</b> and <b>FreePadrlist</b> are functions provided by MAPI for simplifying the freeing of these data structures. <b>FreePadrlist</b> frees the memory for the <b>ADRLIST</b> structure plus all associated memory for the structure members; <b>FreeProws</b> does the same for the <b>SRowSet</b> structure.</p>
<p>
The following diagram shows the layout of an <b>ADRLIST</b> data structure, indicating the separate memory allocations required. The gray boxes show memory that can be allocated and released with one call. </p>
<p>
<img src="images/amapi_52.gif" border=0></p>
<p>&nbsp;</p></body>
</HTML>
