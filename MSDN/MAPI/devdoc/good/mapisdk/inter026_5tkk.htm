<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPITable::GetRowCount</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapitable_getrowcount"></a>IMAPITable::GetRowCount</h2>
<p>
The <b>IMAPITable::GetRowCount</b> method returns the total number of rows in the table. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetRowCount(
  ULONG</b><i> ulFlags</i><b>,</b>         
<b>  ULONG FAR *</b><i> lpulCount  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lpulCount</i></dt>
<dd>
[out] Pointer to the number of rows in the table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The row count was successfully returned.</dd>
<dt>
MAPI_E_BUSY</dt>
<dd>
Another operation is in progress that prevents the row count retrieval operation from starting. Either the operation in progress should be allowed to complete or it should be stopped.</dd>
<dt>
MAPI_E_NO_SUPPORT</dt>
<dd>
The table cannot calculate the number of rows.</dd>
<dt>
MAPI_W_APPROX_COUNT</dt>
<dd>
The call succeeded, but an approximate row count was returned because the exact row count could not be determined possibly due to memory constraints. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPITable::GetRowCount</b> method retrieves the total number of rows in a table. </p>
<h4>Notes to Implementers</h4>
<p>
If you cannot determine the table's exact row count, return MAPI_W_APPROX_COUNT and an approximate row count in the contents of the <i>lpulCount</i> parameter.</p>
<h4>Notes to Callers</h4>
<p>
Use <b>GetRowCount</b> to find out how many rows a table holds before making a call to the <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a><b> </b>method to retrieve the data. If there are less than twenty rows in the table, it is safe to call <b>QueryRows</b> to retrieve the whole table. If there are more than twenty rows in the table, consider making multiple calls to <b>QueryRows</b> and limit the number of rows retrieved in each call.</p>
<p>
Some tables do not support <b>GetRowCount </b>and return MAPI_E_NO_SUPPORT. If <b>GetRowCount </b>is not supported, an alternative might be to call <a href="inter026_53n2.htm"><b>IMAPITable::QueryPosition</b></a>. With the results from <b>QueryPosition</b>, you can determine the relationship between the current row and last row. </p>
<p>
When <b>GetRowCount</b> returns MAPI_E_BUSY because it is temporarily unable to retrieve a row count, call the <a href="inter026_7vla.htm"><b>IMAPITable::WaitForCompletion</b></a> method. When <b>WaitForCompletion</b> returns, retry the call to <b>GetRowCount</b>. Another way to detect whether an asynchronous operation is in progress is to call the <a href="inter026_9nlf.htm"><b>IMAPITable::GetStatus</b></a> method and check the contents of the <i>lpulTableState</i> parameter. </p>
<h4>See Also</h4>
<p>
<a href="inter026_9nlf.htm"><b>IMAPITable::GetStatus</b></a>, <a href="inter026_53n2.htm"><b>IMAPITable::QueryPosition</b></a>, <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>, <a href="inter026_7vla.htm"><b>IMAPITable::WaitForCompletion</b></a></p>
<p>&nbsp;</p></body>
</HTML>
