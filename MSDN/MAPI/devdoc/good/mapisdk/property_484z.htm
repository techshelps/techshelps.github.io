<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>About Property Types</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_about_property_types"></a>About Property Types</h1>
<p>
Property types are constants defined by MAPI in the MAPIDEFS.H header file that indicate the underlying data type of a property value. All properties, whether they are defined by MAPI, by client applications, or by service providers, use one of these types. </p>
<p>
Property types follow a similar naming convention to the one used for property tags. Many property types have both a single value and multivalue version. Single valued properties contain one value of its type such as a single integer or character string. The constant used to represent a single value property has two parts: the prefix PT_ and a string describing the actual type, such as LONG or STRING8. </p>
<p>
Multivalued properties contain more than one value of its type. Unlike OLE variant arrays, every value in a multivalued property is of the same type. The constant used to represent multivalued properties is created by combining the MV_FLAG flag with the corresponding single value constant representing the base type. There are three parts: the prefix PT_ followed by MV_ followed by a string that describes the type. For example, the type for a property containing multiple integers is PT_MV_LONG and for multiple character strings is PT_MV_STRING8.</p>
<p>
The following illustration shows the structure of an <a href="structyp_9sbp.htm"><b>SPropValue</b></a> structure to describe a multivalued integer, a property of type PT_MV_LONG. The <b>Value</b> member is expanded to include a count of the number of integer values in the property and a pointer to an array of those values.</p>
<p>
<img src="images/amapi_12.gif" border=0></p>
<p>
Although support for multivalued properties is optional, MAPI recommends that clients and service providers support both types of properties because doing so enables greater interaction between MAPI-compliant components.</p>
<p>
The following illustration lists all of the different property type constants, showing where they are stored in an <b>SPropValue</b> structure. The size of the <b>Value</b> member is dependent on the particular type. Notice that not all of the single-valued types have multivalued equivalents.</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;<img src="images/amapi_11.gif" border=0></p>
<p>
Clients and service providers working with a property need to follow two steps:
<ol>
<li>
Determine if the property is available or unavailable.</li>
<li>
If available, retrieve the property's value.</li>
</ol>
<p>
Sometimes a client or service provider need only check for the existence of a property; other times it is necessary to check for a specific value. For example, transport providers have three different courses of action for processing the <a href="propb_7wmn.htm">PR_SEND_RICH_INFO</a> property, a Boolean value that indicates whether or not a message should be transmitted with formatted text. If PR_SEND_RICH_INFO is set to TRUE, the transport provider transmits the formatted text. If it is set to FALSE, the formatted text is discarded before transmission. If PR_SEND_RICH_INFO is unavailable, the transport provider follows its default course of action, whatever that is for the particular provider.</p>
<p>
MAPI defines a special property type, PT_UNSPECIFIED, that a client or service provider can use to retrieve a property when the property type is unknown.To retrieve a property without advance knowledge of its type, a client or service provider calls an object's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a><b> </b>method<b> </b>and<b> </b>passes a property tag made up of the property's identifier and the PT_UNSPECIFIED property type. <b>GetProps</b> returns an <a href="structyp_9sbp.htm"><b>SPropValue</b></a> structure for the property, replacing PT_UNSPECIFIED with the appropriate type. Service providers implementing <b>GetProps</b> are required to support PT_UNSPECIFIED. </p>
<p>
Some MAPI objects support properties that are themselves objects. Object properties have the type PT_OBJECT. Instead of using <b>IMAPIProp::GetProps</b> to access these properties, clients and service providers typically access them by calling either:
<ul>
<li>
The <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method, specifying the appropriate interface for access.<p>
– Or –
</li>
<li>
A method on the object supporting the property. </li>
</ul>
<p>
Because<b> </b>accessing the value of an object property involves using one of the interfaces for the object, <b>GetProps</b> is inappropriate. With <b>GetProps</b>, the caller accesses a property's value through an <b>SPropValue</b> structure. With <b>IMAPIProp::OpenProperty</b>, the caller retrieves a pointer to an interface that can access the object. <b>OpenProperty</b> can always be used to retrieve an object property. The other option, calling a method on the object, is not available with every object property.</p>
<p>
For example, every folder supports two tables, a hierarchy table and a contents table. These tables are properties of the folder; their property tags are <a href="propa_13sp.htm">PR_CONTAINER_HIERARCHY</a> and <a href="propa_4df7.htm">PR_CONTAINER_CONTENTS</a>. Tables are objects that require the <b>IMAPITable</b> interface for access. A client can call the folder's <a href="inter011_1sh1.htm"><b>IMAPIContainer::GetHierarchyTable</b></a> method to access the hierarchy table, the folder's <a href="inter011_0sx1.htm"><b>IMAPIContainer::GetContentsTable</b></a> method to access the contents table, or the folder's <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method to access either table. To call <b>OpenProperty</b>, a client passes the property tag for the property as the first parameter and an interface identifier for the interface to be used for access as the second parameter. These parameters would be PR_CONTAINER_HIERARCHY or PR_CONTAINER_CONTENTS and IID_IMAPITable.</p>
<p>
For a complete list of the single-valued and multivalued property types, see <a href="appprop_3n3n.htm">List of Property Types</a>. </p>
<p>&nbsp;</p></body>
</HTML>
