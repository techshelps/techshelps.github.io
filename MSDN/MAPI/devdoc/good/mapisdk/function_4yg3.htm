<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RTFSync</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_rtfsync"></a>RTFSync</h2>
<p>
The <b>RTFSync</b> function ensures that the Rich Text Format (RTF) message text matches the plain text version. It is necessary to call this function before reading the RTF version and after modifying the RTF version. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIUTIL.H </td>
</tr>
<tr valign=top>
<td width=48%>Implemented by: </td>
<td width=52%>MAPI </td>
</tr>
<tr valign=top>
<td width=48%>Called by: </td>
<td width=52%>RTF-aware client applications and message store providers </td>
</tr>
</table><br>
<pre><code><b>HRESULT RTFSync(
  LPMESSAGE</b><i> lpMessage</i><b>,</b>          
<b>  ULONG</b><i> ulFlags</i><b>,</b>                
<b>  BOOL FAR *</b><i> lpfMessageUpdated  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpMessage</i></dt>
<dd>
[in] Pointer to the message to be updated.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags used to indicate the RTF or plain text version of the message has changed. The following flags can be set:
<dl>
<dt>
RTF_SYNC_BODY_CHANGED</dt>
<dd>
The plain text version of the message has changed.</dd>
<dt>
RTF_SYNC_RTF_CHANGED</dt>
<dd>
The RTF version of the message has changed.</dd>
</dl>

<p>
All other bits in the <i>ulFlags</i> parameter are reserved for future use.
</dd>
<dt>
<i>lpfMessageUpdated</i></dt>
<dd>
[out] Pointer to a variable indicating whether there is an updated message. TRUE if there is an updated message, FALSE otherwise. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
If the <a href="propb_26ar.htm">PR_RTF_IN_SYNC</a> property is missing or is FALSE, before reading the <a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a> property the <b>RTFSync</b> function should be called with the RTF_SYNC_BODY_CHANGED flag set. </p>
<p>
If the STORE_RTF_OK flag is not set in the <a href="propb_01t7.htm">PR_STORE_SUPPORT_MASK</a> property, this function should be called with the RTF_SYNC_RTF_CHANGED flag set after modifying PR_RTF_COMPRESSED. </p>
<p>
If both PR_BODY and PR_RTF_COMPRESSED have been changed, the <b>RTFSync</b> function should be called with both flags set. </p>
<p>
If the value of the <i>lpfMessageUpdated</i> parameter is set to TRUE, then the <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method should be called for the message. If <b>SaveChanges</b> is not called, the modifications will not be saved in the message. </p>
<p>
Message store providers can use <b>RTFSync</b> to keep the <a href="propa_9lvd.htm">PR_BODY</a> and <a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a> properties synchronized. </p>
<p>
For more information, see <a href="storearc_2o6r.htm">Supporting RTF Text for Message Store Providers</a>. </p>
<h4>See Also </h4>
<p>
<a href="groups_0jn7.htm">RTF Synchronization Functions</a>, <a href="function_8lv1.htm"><b>WrapCompressedRTFStream</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
