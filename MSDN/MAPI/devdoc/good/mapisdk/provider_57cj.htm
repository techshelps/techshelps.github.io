<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registering Service Provider Unique Identifiers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_registering_service_provider_unique_identifiers"></a>Registering Service Provider Unique Identifiers</h3>
<p>
Address book, message store, and transport providers use a unique identifier known as a <b>MAPIUID</b> to register to service objects of various types. A <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> is a 16-byte identifier that contains a globally unique identifier, or <b>GUID</b>. You can create a <b>MAPIUID</b> by:
<ul>
<li>
Defining a constant.</li>
<li>
Invoking the Microsoft utility UUIDGEN.EXE. </li>
</ul>
<p>
For example, an address book provider might include the following constant in a header file to define a <b>MAPIUID</b>:</p>
<pre><code>#define AB_UID_PROVIDER  { 0Xe3, 0x3c, 0x67, 0xa0, \
                           0xc8, 0x1f, 0x11, 0xce, \
                           0xb2, 0xe4, 0x0, 0xaa, \
                            0x0, 0x51, 0xe, 0x3b  }
 </code></pre>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To register a MAPIUID if your provider is an address book or message store provider</h5>
<p class=indent1>
Call <a href="inter025_91no.htm"><b>IMAPISupport::SetProviderUID</b></a>.</p>
<p>
Register a <b>MAPIUID</b> for each logon object that you instantiate and include this <b>MAPIUID</b> in the first 16 bytes of the <b>ab</b> member of every entry identifier that you create. MAPI uses <b>MAPIUID</b>s to associate objects with service providers. When a client calls the <a href="inter023_146x.htm"><b>IMAPISession::OpenEntry</b></a> method to open an object, MAPI examines the <b>MAPIUID</b> portion of the entry identifier, matching it against the registered <b>MAPIUID</b>, to determine which logon object should receive the open request. </p>
<p>
If your provider is a transport, register one or more <b>MAPIUID</b>s when MAPI calls your <b>IXPLogon::AddressTypes</b> method. MAPI uses the <b>MAPIUID</b>s registered by transport providers to assign responsibility for message delivery. </p>
<p>
Although service providers typically register a single <b>MAPIUID</b>, you can register multiple <b>MAPIUID</b>s. If your address book or message store provider supports multiple logon objects, perhaps by permitting a user to add more than one instance of your provider to their profile, you might want to implement a different <b>MAPIUID</b> for each logon object. There are a few other reasons to support more than one <b>MAPIUID</b>:
<ul>
<li>
You must support more than one version of your provider and the entry identifiers must represent the appropriate version. Assign a different <b>MAPIUID</b> for each version.</li>
<li>
You want to distinguish between the types of objects you support. For example, an address book provider might want to register one <b>MAPIUID</b> to use in the entry identifiers of its messaging user objects and a different <b>MAPIUID</b> to use for distribution lists.</li>
</ul>
<p>
When there are multiple logon objects that are concurrently active, it makes sense to have unique <b>MAPIUID</b>s for each one. This increases the accuracy with which MAPI matches entry identifiers to service providers and saves some work. When every logon object has its own unique identifier, MAPI can guarantee that any request it routes to a logon object can be handled by that object. When logon objects share <b>MAPIUID</b>s, MAPI routes the request to the first logon object that is identified by the <b>MAPIUID</b>. If one of your logon objects receives a request that it cannot process because it does not handle the entry identifier, pass the request on to your next logon object before returning an error.</p>
<p>&nbsp;</p></body>
</HTML>
