<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISupport::Subscribe</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisupport_subscribe"></a>IMAPISupport::Subscribe</h2>
<p>
The <b>IMAPISupport::Subscribe</b> method registers an advise sink to receive notifications through MAPI.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter025_8uge.htm"><b>IMAPISupport : IUnknown</b></a>.</p>
<pre><code><b>HRESULT Subscribe(
  LPNOTIFKEY</b><i> lpKey</i><b>,</b>                
<b>  ULONG</b><i> ulEventMask</i><b>,</b>               
<b>  ULONG</b><i> ulFlags</i><b>,</b>                   
<b>  LPMAPIADVISESINK</b><i> lpAdviseSink</i><b>,</b>   
<b>  ULONG FAR *</b><i> lpulConnection       </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpKey</i></dt>
<dd>
[in] Pointer to a notification key that represents the advise source object. The <i>lpKey </i>parameter cannot be NULL.</dd>
<dt>
<i>ulEventMask</i></dt>
<dd>
[in] A mask of values indicating the types of notification events that the caller is interested in and should be included in the registration. The following values are valid:
<dl>
<dt>
<i>fnevCriticalError</i></dt>
<dd>
Registers for notifications about severe errors, such as insufficient memory.</dd>
<dt>
<i>fnevExtended</i></dt>
<dd>
Registers for notifications about events specific to the particular address book or message store provider.</dd>
<dt>
<i>fnevNewMail</i></dt>
<dd>
Registers for notifications about the arrival of new messages. </dd>
<dt>
<i>fnevObjectCreated</i></dt>
<dd>
Registers for notifications about the creation of a new object.</dd>
<dt>
<i>fnevObjectCopied</i></dt>
<dd>
Registers for notifications about an object being copied.</dd>
<dt>
<i>fnevObjectDeleted</i></dt>
<dd>
Registers for notifications about an object being deleted.</dd>
<dt>
<i>fnevObjectModified</i></dt>
<dd>
Registers for notifications about an object being modified.</dd>
<dt>
<i>fnevObjectMoved</i></dt>
<dd>
Registers for notifications about an object being moved.</dd>
<dt>
<i>fnevSearchComplete</i></dt>
<dd>
Registers for notifications about the completion of a search operation.</dd>
</dl>
</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how notification occurs. The following flag can be set:
<dl>
<dt>
NOTIFY_SYNC</dt>
<dd>
When the caller calls <a href="inter025_8fax.htm"><b>IMAPISupport::Notify</b></a><b> </b>to generate notifications for this advise sink, <b>Notify</b> should make all necessary calls to advise sinks before returning. If this flag is not set, notification is asynchronous and callbacks are queued to the processes that have subscribed and started when those processes gain control of the CPU.</dd>
</dl>
</dd>
<dt>
<i>lpAdviseSink</i></dt>
<dd>
[in] Pointer to an advise sink object. </dd>
<dt>
<i>lpulConnection</i></dt>
<dd>
[out] Pointer to a non-zero connection number representing the registration.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The notification registration was successful.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISupport::Subscribe</b> method is implemented for all service provider support objects. Service providers call <b>Subscribe</b> from one of their <b>Advise</b> methods to allow MAPI to manage the notifications. </p>
<h4>Notes to Callers</h4>
<p>
To use the MAPI support methods for notification, create a key for the advise source — the object about which notifications should be generated. The value of the key must be unique and should be easily regenerated each time the object changes. </p>
<p>
MAPI uses the notification key to search for any callback functions registered through the <a href="function_9bhn.htm"><b>HrAllocAdviseSink</b></a> function for the corresponding advise source. Pass this key to <b>IMAPISupport::Notify</b> whenever you need to generate a notification for the corresponding advise source.</p>
<p>
The NOTIFY_SYNC flag affects the operation of subsequent calls to <b>Notify</b>. When you set NOTIFY_SYNC, <b>Notify</b> does not return until it has finished sending all of the necessary notifications. When you do not set NOTIFY_SYNC, <b>Notify</b> operates asynchronously, possibly returning before all of the notifications have been sent.</p>
<h4>See Also</h4>
<p>
<a href="function_9bhn.htm"><b>HrAllocAdviseSink</b></a>, <a href="inter010_4y2h.htm"><b>IMAPIAdviseSink::OnNotify</b></a>, <a href="inter025_8fax.htm"><b>IMAPISupport::Notify</b></a>, <a href="structyp_5dbi.htm"><b>NOTIFICATION</b></a>, <a href="structyp_5cc9.htm"><b>NOTIFKEY</b></a></p>
<p>&nbsp;</p></body>
</HTML>
