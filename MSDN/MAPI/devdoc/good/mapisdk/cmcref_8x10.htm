<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>cmc_list</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_cmc_list"></a>cmc_list</h2>
<p>
The <b>cmc_list</b> function lists summary information for messages that meet client application-specified criteria.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>XCMC.H</td>
</tr>
</table><br>
<pre><code><b>CMC_return_code cmc_list (
  CMC_session_id</b><i> session</i><b>,</b>                   
<b>  CMC_string</b><i> message_type</i><b>,</b>                  
<b>  CMC_flags</b><i> list_flags</i><b>,</b>                     
<b>  CMC_message_reference *</b><i> seed</i><b>,</b>             
<b>  CMC_uint32 FAR *</b><i> count</i><b>,</b>                   
<b>  CMC_ui_id</b><i> ui_id</i><b>,</b>                          
<b>  CMC_message_summary FAR * FAR *</b><i> result</i><b>,</b>   
<b>  CMC_extension FAR *</b><i> list_extensions       </i>
<b>)</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>session</i></dt>
<dd>
[in] Opaque session handle that represents a MAPI session object indicating a session with a message service. If the session handle is invalid, this function returns <small>cmc_e_invalid_session_id</small>. </dd>
<dt>
<i>message_type </i></dt>
<dd>
[in] Pointer to the ASCII name of the type of message for which this function lists information. If the <b>cmc_list</b> function does not recognize the specified message type, it returns <small>cmc_e_unrecognized_message_type</small>. If the function receives a value of NULL for the message type, it lists information for all available message types. </dd>
<dt>
<i>list_flags</i></dt>
<dd>
[in] Bitmask of flags. The following flags can be set:
<dl>
<dt>
CMC_ERROR_UI_ALLOWED</dt>
<dd>
Displays a dialog box on encountering recoverable errors. If this flag is not set, <b>cmc_list</b> does not display a dialog box and returns an error value instead.</dd>
<dt>
CMC_LIST_COUNT_ONLY</dt>
<dd>
Lists only a count of messages meeting the specified criteria, not any actual summary information. If this flag is not set, the function lists summary information in the array.</dd>
<dt>
CMC_LIST_MSG_REFS_ONLY</dt>
<dd>
Writes only message reference information to the array pointed to by the <i>result</i> parameter. If this flag is not set, <b>cmc_list</b> writes information to all members of the structures in the array.</dd>
<dt>
CMC_LIST_UNREAD_ONLY</dt>
<dd>
Lists unread messages only. If this flag is not set, <b>cmc_list</b> can list both read and unread messages.</dd>
</dl>
</dd>
<dt>
<i>seed </i></dt>
<dd>
[in] Pointer to a message reference that identifies the message after which <b>cmc_list</b> should begin to search. A value of NULL for this parameter indicates that the function should start the search with the first message in the mailbox. A pointer to a message reference of length zero is invalid and causes <b>cmc_list</b> to return <small>cmc_e_invalid_message_reference</small>. If the <i>seed</i> parameter is part of a structure that is returned by an earlier CMC call, the structure that was allocated by CMC should be freed before the current session exits.</dd>
<dt>
<i>count </i></dt>
<dd>
[in, out] A message count. On input, this parameter specifies a pointer to the maximum number of messages for which <b>cmc_list</b> should provide summary information. A value of zero indicates no maximum.
<p>
On output, the <i>count</i> parameter specifies the location to which <b>cmc_list</b> writes the number of messages for which it provides summary information. If no messages match the search criteria, or if the mailbox is empty, <b>cmc_list </b>writes zero. 
</dd>
<dt>
<i>ui_id</i></dt>
<dd>
[in] Handle of a dialog box for <b>cmc_list</b> to present to help resolve processing questions. </dd>
<dt>
<i>result</i></dt>
<dd>
[out] Pointer to the location to which <b>cmc_list</b> writes the address of the array of <a href="cmcref_90jd.htm"><b>CMC_message_summary</b></a> structures that it has written. </dd>
<dt>
<i>list_extensions </i></dt>
<dd>
[in, out] Pointer to an array of <a href="cmcref_1woe.htm"><b>CMC_extension</b></a> structures specifying function extensions. On input, this array contains MAPI extensions to the standard <b>cmc_list</b> function. A value of NULL for the <i>list_extensions </i>parameter indicates that the client application has no extensions for <b>cmc_list</b> and is expecting no extensions. 
<p>
On output, <b>cmc_list</b> writes to the array new information about its processing of the message summaries. It writes NULL if it generates no output extensions. 

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
CMC_E_FAILURE</dt>
<dd>
There was a general failure that does not fit the description of any other return value.</dd>
<dt>
CMC_E_INSUFFICIENT_MEMORY</dt>
<dd>
Insufficient memory was available to complete the requested operation.</dd>
<dt>
CMC_E_INVALID_FLAG</dt>
<dd>
A flag set using a flags parameter was invalid.</dd>
<dt>
CMC_E_INVALID_MESSAGE_REFERENCE</dt>
<dd>
The specified message reference is invalid or no longer valid — for example, it has been deleted.</dd>
<dt>
CMC_E_INVALID_PARAMETER</dt>
<dd>
A function parameter was invalid. </dd>
<dt>
CMC_E_INVALID_SESSION_ID</dt>
<dd>
The specified session handle is invalid or no longer valid — for example, after logging off.</dd>
<dt>
CMC_E_INVALID_UI_ID</dt>
<dd>
The specified user-interface identifier is invalid or no longer valid.</dd>
<dt>
CMC_E_UNRECOGNIZED_MESSAGE_TYPE</dt>
<dd>
The specified message type is not supported by the current implementation.</dd>
<dt>
CMC_E_UNSUPPORTED_FLAG</dt>
<dd>
The flag requested is not supported.</dd>
<dt>
CMC_E_UNSUPPORTED_FUNCTION_EXT</dt>
<dd>
The function extension requested is not supported.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The client application can specify a <b>cmc_list</b> search to start with a certain message or to start at the first message in the mailbox. It can also specify the maximum number of messages to list. The <b>cmc_list</b> function writes the summary information for the specified messages in an array of <a href="cmcref_90jd.htm"><b>CMC_message_summary</b></a> structures. Using the message references in these structures, the application can then make calls to the <a href="cmcref_2944.htm"><b>cmc_read</b></a> and <a href="cmcref_81im.htm"><b>cmc_act_on</b></a> functions for additional processing.</p>
<p>
Before <b>cmc_list</b> writes message summary information, it must allocate memory for the structure array to contain the information. When this memory is no longer needed, the client application should free the entire array with a call to the <a href="cmcref_5z51.htm"><b>cmc_free</b></a><b> </b>function. </p>
<h4>See Also</h4>
<p>
<a href="cmcref_81im.htm"><b>cmc_act_on</b></a>,<b> <a href="cmcref_1woe.htm">CMC_extension</a></b>,<b> <a href="cmcref_5z51.htm">cmc_free</a></b>,<b> <a href="cmcref_90jd.htm">CMC_message_summary</a></b>, <a href="cmcref_2944.htm"><b>cmc_read</b></a></p>
<p>&nbsp;</p></body>
</HTML>
