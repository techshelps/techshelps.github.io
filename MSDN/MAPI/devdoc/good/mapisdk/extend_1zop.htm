<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending Messages with MAPI</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_sending_messages_with_mapi"></a>Sending Messages with MAPI</h1>
<p>
Client applications call the <a href="inter029_65ut.htm"><b>IMessage::SubmitMessage</b></a> method to send a message. <b>SubmitMessage</b> calls <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> to save the message before transferring control to either the MAPI spooler or directly to a transport provider. The MAPI spooler receives the message if:
<ul>
<li>
The message store provider and transport provider are not tightly coupled.</li>
<li>
The message requires preprocessing.</li>
<li>
The tightly coupled message store and transport cannot handle all of the recipients to whom the message is addressed.</li>
</ul>
<p>
A tightly coupled message store must take into account a message's status before it presents it to the MAPI spooler to be downloaded to a transport provider. There are situations where a message may appear to require the MAPI spooler, but the MAPI spooler should really not be involved.  </p>
<p>
For example, consider the situation where a user submits a message from the Inbox. The client is using a tightly coupled store and transport. If the tightly coupled message store uses the message's location as the sole criteria for deciding about whether or not to allow the MAPI spooler to handle the message, the MAPI spooler will always receive the message. To avoid this kind of problem, a tightly coupled message store must check the message status in addition to message location. Specifically, the transport provider should not request that the MAPI spooler download any message that is actively submitted.</p>
<p>
The message transmission process involves the message store provider, one or more transport providers, and MAPI. The following topics provide detailed information about specific roles in the message transmission process:</p>
<p>
For information about a message store provider's role in sending messages, see <a href="extend_5qgj.htm">Sending Messages: Message Store Provider Tasks</a>. </p>
<p>
For information about the MAPI spooler's role in sending messages, see <a href="extend_2pwz.htm">Sending Messages: MAPI Spooler Tasks</a>. </p>
<p>
For information about a transport provider's role in sending messages, see <a href="extend_96er.htm">Sending Messages: Transport Provider Tasks</a>. </p>
<p>
For information, from the client perspective, about what to do with a message after it has already been sent, see <a href="consider_7eed.htm">Processing a Sent Message</a>. </p>
<p>&nbsp;</p></body>
</HTML>
