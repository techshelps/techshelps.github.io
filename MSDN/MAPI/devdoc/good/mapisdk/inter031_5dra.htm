<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMsgStore::StoreLogoff</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imsgstore_storelogoff"></a>IMsgStore::StoreLogoff</h2>
<p>
The <b>IMsgStore::StoreLogoff</b> method enables the orderly logoff of the message store.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter031_1jg0.htm"><b>IMsgStore : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT StoreLogoff(
  ULONG FAR *</b><i> lpulFlags  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpulFlags</i></dt>
<dd>
[in, out] Bitmask of flags that controls logoff from the message store. On input, all flags set for this parameter are mutually exclusive; a caller must specify only one flag per call. The following flags are valid on input:
<dl>
<dt>
LOGOFF_ABORT</dt>
<dd>
Any transport provider activity for this message store should be stopped before logoff. Control is returned to the caller after activity is stopped. If any transport provider activity is taking place, the logoff does not occur and no change in the behavior of the MAPI spooler or transport providers occurs. If transport provider activity is quiet, the MAPI spooler releases the store. </dd>
<dt>
LOGOFF_NO_WAIT</dt>
<dd>
The message store should not wait for messages from transport providers before closing. Outbound messages that are ready to be sent are sent. If this store contains the default Inbox, any in-process messages are received, and then further reception is disabled. When all activity is completed, the MAPI spooler releases the store, and control is returned to the caller immediately. </dd>
<dt>
LOGOFF_ORDERLY</dt>
<dd>
The message store should not wait for information from transport providers before closing. Messages currently being processed are completed, but no new messages are processed. When all activity is completed, the MAPI spooler releases the store, and control is returned to the store provider immediately. </dd>
<dt>
LOGOFF_PURGE</dt>
<dd>
The logoff should work the same as if the LOGOFF_NO_WAIT flag is set, but that either <a href="inter042_8vn7.htm"><b>IXPLogon::FlushQueues</b></a> or <a href="inter024_8c37.htm"><b>IMAPIStatus::FlushQueues</b></a> for the appropriate transport providers should be called. The LOGOFF_PURGE flag returns control to the caller after completion. </dd>
<dt>
LOGOFF_QUIET</dt>
<dd>
If any transport provider activity is taking place, the logoff should not occur. 
</dd>
</dl>
</dd>
</dl>
<p>
The following flags are valid on output:
<dl>
<dt>
LOGOFF_INBOUND</dt>
<dd>
Inbound messages are currently arriving.</dd>
<dt>
LOGOFF_OUTBOUND</dt>
<dd>
Outbound messages are in the process of being sent.</dd>
<dt>
LOGOFF_OUTBOUND_QUEUE</dt>
<dd>
Outbound messages are pending, that is, they are in the Outbox.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The logoff completed successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMsgStore::StoreLogoff</b> method exerts control over the interaction of the message store and transport providers during the logoff process. Calling <b>StoreLogoff</b> is valid only for message stores that are being used by only the caller. When two clients, for example, are using the same message store and one of them calls <b>StoreLogoff</b>, the message store is immediately released and control is returned to the calling client.</p>
<h4>Notes to Implementers</h4>
<p>
Save the flags that are passed to <b>StoreLogoff</b> and pass them when you call <a href="inter025_3asz.htm"><b>IMAPISupport::StoreLogoffTransports</b></a>. Do not call <b>StoreLogoffTransports</b> until the message store's reference count drops to zero. Multiple calls to <b>StoreLogoffTransports</b> simply overwrite the saved flags.</p>
<p>
If no call has been made to <b>StoreLogoff</b> before the message store's reference count reaches zero, set the LOGOFF_ABORT flag in the <i>ulFlags</i> parameter that you pass to <b>StoreLogoffTransports</b>.</p>
<h4>See Also</h4>
<p>
<a href="inter024_8c37.htm"><b>IMAPIStatus::FlushQueues</b></a>,<b> <a href="inter025_3asz.htm">IMAPISupport::StoreLogoffTransports</a></b>, <a href="inter042_8vn7.htm"><b>IXPLogon::FlushQueues</b></a></p>
<p>&nbsp;</p></body>
</HTML>
