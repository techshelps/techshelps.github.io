<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TNEF Stream Syntax</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_tnef_stream_syntax"></a>TNEF Stream Syntax</h2>
<p>
This topic presents a Bakus-Nauer like description of the TNEF stream syntax. In this description, nonterminal elements that have a further definition are in italics. Constants and literal items are in bold. Sequences of elements are listed in order on a single line. For example, the <i>Stream</i> item consists of the constant <b>TNEF_SIGNATURE</b>, followed by a <i>Key</i>, followed by an <i>Object</i>. When an item has more than one possible implementation, the alternatives are listed on consecutive lines. For example, an <i>Object</i> can consist of a <i>Message_Seq</i>, a <i>Message_Seq</i> followed by an <i>Attach_Seq</i>, or just an <i>Attach_Seq</i>.
<dl>
<dt>
<i>TNEF_Stream:</i></dt>
<dd>
<b>TNEF_SIGNATURE</b> <i>Key</i> <i>Object</i></dd>
<dt>
<i>Key:</i></dt>
<dd>
a nonzero 16-bit unsigned integer
</dd>
</dl>
<p>
TNEF enabled transports generate this value before using the TNEF implementation to generate a TNEF stream.
<dl>
<dt>
<i>Object:</i></dt>
<dd>
<i>Message_Seq<br>
Message_Seq Attach_Seq<br>
Attach_Seq</i></dd>
<dt>
<i>Message_Seq:</i></dt>
<dd>
<i>attTnefVersion<br>
attTnefVersion Msg_Attribute_Seq<br>
attTnefVersion attMessageClass<br>
attTnefVersion attMessageClass Msg_Attribute_Seq<br>
attMessageClass<br>
attMessageClass Msg_Attribute_Seq<br>
Msg_Attribute_Seq</i></dd>
<dt>
<i>attTnefVersion:</i></dt>
<dd>
<b>LVL_MESSAGE attTnefVersion sizeof(ULONG)</b> <b>0x00010000 </b>checksum</dd>
<dt>
<i>attMessageClass:</i></dt>
<dd>
<b>LVL_MESSAGE attMessageClass</b> <i>msg_class_length msg_class</i> checksum</dd>
<dt>
<i>Msg_Attribute_Seq:</i></dt>
<dd>
<i>Msg_Attribute<br>
Msg_Attribute Msg_Attribute_Seq</i></dd>
<dt>
<i>Msg_Attribute:</i></dt>
<dd>
<b>LVL_MESSAGE</b> attribute-ID attribute-length attribute-data checksum
</dd>
</dl>
<p>
Attribute-ID is one of the TNEF attribute identifiers, such as <b>attSubject</b>. Attribute-length is the length in bytes of the attribute data. Attribute-data is the data associated with the attribute.
<dl>
<dt>
<i>Attach_Seq:</i></dt>
<dd>
<i>attRenddata<br>
attRenddata Att_Attribute_Seq</i></dd>
<dt>
<i>attRenddata:</i></dt>
<dd>
<b>LVL_ATTACHMENT attRenddata</b> <b>sizeof(RENDDATA)</b> renddata checksum
</dd>
</dl>
<p>
Renddata is the data associated with the <b>RENDDATA</b> structure containing the rendering information for the corresponding attachment. The <b>RENDDATA</b> structure is defined in the TNEF.H header file.
<dl>
<dt>
<i>Att_Attribute_Seq:</i></dt>
<dd>
<i>Att_Attribute<br>
Att_Attribute Att_Attribute_Seq</i></dd>
<dt>
<i>Att_Attribute:</i></dt>
<dd>
<b>LVL_ATTACHMENT</b> attribute-ID attribute-length attribute-data checksum
</dd>
</dl>
<p>
Attribute-ID, attribute-length, and attribute-data have the same meanings as for the Msg_Attribute item.</p>
<p>&nbsp;</p></body>
</HTML>
