<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Rendering an Attachment in Formatted Text</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_rendering_an_attachment_in_formatted_text"></a>Rendering an Attachment in Formatted Text</h2>
<p>
Rich Text Format (RTF)-aware clients can retrieve rendering position information from RTF message text by looking for the following escape sequence in the message's <a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a> property:</p>
<pre><code>\objattph
 </code></pre>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To locate rendering information in formatted text</h5>
<ol>
<li>
Call <a href="inter029_24it.htm"><b>IMessage::GetAttachmentTable</b></a> to access the message's attachment table.</li>
<li>
Build a property restriction that limits the table to rows that have <a href="propb_8uni.htm">PR_RENDERING_POSITION</a> not equal to -1.</li>
<li>
Call<b> <a href="inter026_43lg.htm">IMAPITable::Restrict</a></b> to enforce the restriction.</li>
<li>
Call <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a> to sort the attachments.</li>
<li>
Call<b> <a href="inter026_7wkz.htm">IMAPITable::QueryRows</a></b> to retrieve the appropriate rows. </li>
<li>
Call the message's <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method to retrieve <a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a> with the <b>IStream</b> interface.</li>
<li>
Scan the stream, looking for the rendering placeholder, <code>\objattph</code>. The character following this placeholder is the place for the next attachment in the sorted table.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
