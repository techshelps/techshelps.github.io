<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Launching a Form Server</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_launching_a_form_server"></a>Launching a Form Server</h2>
<p>
The series of interactions that occurs when a form is loaded from persistant storage — that is, from a form library — to display a message is as follows:
<ol>
<li>
The messaging client gets the message's message class, message flags and message status. This step is optional; if these pieces of data are not provided in step 2, the form manager will retrieve them.</li>
<li>
The messaging client calls <a href="inter019_8ju5.htm"><b>IMAPIFormMgr::LoadForm</b></a> with the target message.</li>
<li>
The form manager loads the form server from the appropriate form library. If the form server for the target message is not installed, the form manager installs the form's executable files as well.</li>
<li>
The form manager calls <b>IUnknown::QueryInterface</b> on the form object to obtain the form object's <a href="inter014_0dym.htm"><b>IMAPIForm</b></a> and <a href="inter034_24ry.htm"><b>IPersistMessage</b></a> interfaces.</li>
<li>
The form manager calls <a href="inter034_69wk.htm"><b>IPersistMessage::Load</b></a> with the message site and message interfaces from the viewer object.</li>
<li>
The form object calls back to the messaging client's <a href="inter020_6i43.htm"><b>IMAPIMessageSite::GetSiteStatus</b></a> method.</li>
<li>
The form manager calls the form object's <a href="inter014_01ro.htm"><b>IMAPIForm::SetViewContext</b></a> with the view context interface from the messaging client.</li>
<li>
The form object calls back to the messaging client's <a href="inter028_0cbv.htm"><b>IMAPIViewContext::SetAdviseSink</b></a> method.</li>
<li>
The form object calls back to the messaging client's <a href="inter028_916b.htm"><b>IMAPIViewContext::GetViewStatus</b></a> method.</li>
<li>
The messaging client calls the form object's <a href="inter014_1wkl.htm"><b>IMAPIForm::Advise</b></a> method with the view context interfaces from the viewer object and the message site object.</li>
<li>
The messaging client calls the form object's <a href="inter014_94ki.htm"><b>IMAPIForm::DoVerb</b></a> method.</li>
<li>
The form object creates its user interface, if necessary, and interacts with the user.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
