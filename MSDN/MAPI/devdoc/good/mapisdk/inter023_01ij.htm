<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISession::OpenAddressBook</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisession_openaddressbook"></a>IMAPISession::OpenAddressBook</h2>
<p>
The <b>IMAPISession::OpenAddressBook</b> method opens the MAPI integrated address book, returning an <b>IAddrBook</b> pointer for further access.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter023_64ry.htm"><b>IMAPISession : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OpenAddressBook(
  ULONG</b><i> ulUIParam</i><b>,</b>            
<b>  LPCIID</b><i> lpInterface</i><b>,</b>         
<b>  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPADRBOOK FAR *</b><i> lppAdrBook  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the common address dialog box and other related displays.</dd>
<dt>
<i>lpInterface</i></dt>
<dd>
[in] Pointer to the interface identifier (IID) representing the interface to be used to access the address book. Passing NULL results in a pointer to the address book's standard interface, or <b>IAddrBook</b>, being returned. </dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the opening of the address book. The following flag can be set:
<dl>
<dt>
AB_NO_DIALOG</dt>
<dd>
Suppresses the display of dialog boxes. If the AB_NO_DIALOG flag is not set, the address book providers contributing to the integrated address book can prompt the user for any necessary information. </dd>
</dl>
</dd>
<dt>
<i>lppAdrBook</i></dt>
<dd>
[out] Pointer to a pointer to the address book.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The address book was successfully opened.</dd>
<dt>
MAPI_E_UNKNOWN_CPID</dt>
<dd>
The server is not configured to support the client's code page.</dd>
<dt>
MAPI_E_UNKNOWN_LCID</dt>
<dd>
The server is not configured to support the client's locale information.</dd>
<dt>
MAPI_W_ERRORS_RETURNED</dt>
<dd>
The call succeeded, but the containers of one or more address book providers could not be opened. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISession::OpenAddressBook</b> method opens the MAPI integrated address book — a collection of the top-level containers of all of the address book providers in the profile. The pointer that is returned in the <i>lppAdrBook</i> parameter provides further access to the contents of the address book, allowing the caller to perform tasks such as opening individual containers, finding messaging users, and displaying common address dialog boxes. </p>
<h4>Notes to Callers</h4>
<p>
<b>OpenAddressBook</b> returns MAPI_W_ERRORS_RETURNED if it cannot load one or more of the address book providers in the profile. This value is a warning, not an error value; handle it as you would S_OK. <b>OpenAddressBook</b> always returns a valid pointer in the <i>lppAdrBook</i> parameter, regardless of how many of the address book providers failed to load. Therefore, you must always call the address book's <b>IUnknown::Release</b> method at some point before logging off.</p>
<p>
When <b>OpenAddressBook</b> returns MAPI_W_ERRORS_RETURNED, call <a href="inter023_8lde.htm"><b>IMAPISession::GetLastError</b></a> to obtain a <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a> structure containing information about the failing providers. A single <b>MAPIERROR</b> structure is returned that contains information supplied by all of the providers. </p>
<h4>See Also</h4>
<p>
<a href="inter023_8lde.htm"><b>IMAPISession::GetLastError</b></a>, <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a></p>
<p>&nbsp;</p></body>
</HTML>
