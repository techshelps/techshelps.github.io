<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIProp::GetLastError</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapiprop_getlasterror"></a>IMAPIProp::GetLastError</h2>
<p>
The <b>IMAPIProp::GetLastError</b> method returns a <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a> structure containing information about the previous error.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter022_00tq.htm"><b>IMAPIProp : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetLastError(
  HRESULT</b><i> hResult</i><b>,</b>                
<b>  ULONG</b><i> ulFlags</i><b>,</b>                  
<b>  LPMAPIERROR FAR *</b><i> lppMAPIError  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hResult</i></dt>
<dd>
[in] HRESULT data type containing the error code generated in the previous method call.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that indicates the format for the text returned in the <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a> structure pointed to by <i>lppMAPIError</i>. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The strings should be in Unicode format. If the MAPI_UNICODE flag is not set, the strings should be in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lppMAPIError</i></dt>
<dd>
[out] Pointer to a pointer to the <b>MAPIERROR</b> structure containing version, component, and context information for the error. The <i>lppMAPIError </i>parameter can be set to NULL if there is no error information to return.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The error information was returned.</dd>
<dt>
MAPI_E_BAD_CHARWIDTH</dt>
<dd>
Either the MAPI_UNICODE flag was set and the implementation does not support Unicode, or MAPI_UNICODE was not set and the implementation only supports Unicode.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIProp::GetLastError</b> method supplies information about a prior method call that failed. Clients can provide their users with detailed information about the error by including the data from the <b>MAPIERROR</b> structure in a dialog box.</p>
<p>
All of the implementations of <b>GetLastError</b> provided by MAPI are ANSI implementations except for the <b>IAddrBook</b> implementation. The <b>GetLastError</b> method included with <b>IAddrBook</b> supports Unicode on Windows NT platforms only. </p>
<h4>Notes to Implementers</h4>
<p>
The specifics of a remote transport provider's implementation of this method and what messages this method returns are up to the transport provider, since the particular error conditions which lead to various HRESULT values will be different for different transport providers.</p>
<h4>Notes to Callers</h4>
<p>
You can make use of the <b>MAPIERROR</b> structure pointed to by the <i>lppMAPIError</i> parameter, if <b>GetLastError</b> supplies one, only if the return value is S_OK. Sometimes <b>GetLastError</b> cannot determine what the last error was or has nothing more to report about the error. In this situation, a pointer to NULL is returned in <i>lppMAPIError</i> instead. </p>
<p>
To release the memory for the <b>MAPIERROR</b> structure, call <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a>.</p>
<p>
For more information about the <b>GetLastError</b> method, see <a href="extend_5kkz.htm">Using Extended Errors</a>.</p>
<h4>See Also</h4>
<p>
<a href="structyp_0qpe.htm"><b>MAPIERROR</b></a>, <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a></p>
<p>&nbsp;</p></body>
</HTML>
