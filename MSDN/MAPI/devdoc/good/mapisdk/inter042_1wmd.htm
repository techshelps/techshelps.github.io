<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IXPLogon::ValidateState</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_ixplogon_validatestate"></a>IXPLogon::ValidateState</h2>
<p>
The <b>IXPLogon::ValidateState</b> method checks the transport provider's external status.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter042_2u9a.htm"><b>IXPLogon : IUnknown</b></a>.</p>
<pre><code><b>HRESULT ValidateState(
  ULONG</b><i> ulUIParam</i><b>,</b>   
<b>  ULONG</b><i> ulFlags      </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for any dialog boxes or windows this method displays.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the status check is done and its results. The following flags can be set:
<dl>
<dt>
ABORT_XP_HEADER_OPERATION</dt>
<dd>
The user canceled the operation, typically by clicking the <b>Cancel</b> button in a dialog box. The transport provider has the option to continue working on the operation, or it can abort the operation and return MAPI_E_USER_CANCELED. </dd>
<dt>
CONFIG_CHANGED</dt>
<dd>
Validates the state of currently loaded transport providers by causing the MAPI spooler to call their <a href="inter042_0xbn.htm"><b>IXPLogon::AddressTypes</b></a> and <a href="inter023_9ier.htm"><b>IMAPISession::MessageOptions</b></a> methods. This flag also provides the MAPI spooler an opportunity to correct critical transport-provider failures without forcing client applications to log off and then log on again.</dd>
<dt>
FORCE_XP_CONNECT</dt>
<dd>
The user selected a connect operation. When this flag is used with the REFRESH_XP_HEADER_CACHE or PROCESS_XP_HEADER_CACHE flag, the connect action occurs without caching.</dd>
<dt>
FORCE_XP_DISCONNECT</dt>
<dd>
The user selected a disconnect operation. When this flag is used with REFRESH_XP_HEADER_CACHE or PROCESS_XP_HEADER_CACHE, the disconnect action occurs without caching.</dd>
<dt>
PROCESS_XP_HEADER_CACHE</dt>
<dd>
Entries in the header cache table should be processed, all messages marked with the MSGSTATUS_REMOTE_DOWNLOAD flag should be downloaded, and all messages marked with the MSGSTATUS_REMOTE_DELETE flag should be deleted. Messages that have both MSGSTATUS_REMOTE_DOWNLOAD and MSGSTATUS_REMOTE_DELETE set should be moved.</dd>
<dt>
REFRESH_XP_HEADER_CACHE</dt>
<dd>
A new list of message headers should be downloaded, and all message status marking flags should be cleared.</dd>
<dt>
SUPPRESS_UI</dt>
<dd>
Prevents the transport provider from displaying a user interface.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.</dd>
<dt>
MAPI_E_BUSY</dt>
<dd>
Another operation is in progress; it should be allowed to complete or it should be stopped before this operation is attempted.</dd>
<dt>
MAPI_E_NO_SUPPORT</dt>
<dd>
The remote transport provider involved does not support a user interface, and the client application should display the dialog box itself.</dd>
<dt>
MAPI_E_USER_CANCEL</dt>
<dd>
The user canceled the operation, typically by clicking the <b>Cancel</b> button in a dialog box.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The MAPI spooler calls the <b>IXPLogon::ValidateState </b>method to support calls to the <a href="inter024_6x2d.htm"><b>IMAPIStatus::ValidateState</b></a> method for the status object. The transport provider should respond to the <b>IXPLogon::ValidateState</b> call exactly as if the MAPI spooler had opened a status object for the current logon session and then called <b>ValidateState</b> on that object.</p>
<p>
To support its implementation of <b>IMAPIStatus::ValidateState</b>, the MAPI spooler calls <b>IXPLogon::ValidateState</b> on all logon objects for all active transport providers running in a profile session.</p>
<h4>See Also</h4>
<p>
<a href="inter023_9ier.htm"><b>IMAPISession::MessageOptions</b></a>, <a href="inter024_6x2d.htm"><b>IMAPIStatus::ValidateState</b></a>, <a href="inter042_0xbn.htm"><b>IXPLogon::AddressTypes</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
