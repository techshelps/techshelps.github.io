<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Copying a Recipient</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_copying_a_recipient"></a>Copying a Recipient</h2>
<p>
To copy one or more recipients from one container into another or the same container, first check that the target container is modifiable. Containers that are modifiable set the AB_MODIFIABLE flag in their <a href="propa_3m7n.htm">PR_CONTAINER_FLAGS</a> property. </p>
<p>
To copy one or more entries into a modifiable container, call the destination container's <a href="inter003_02b7.htm"><b>IABContainer::CopyEntries</b></a> method. Because copying address book entries can be time-consuming, <b>CopyEntries</b> accepts four input parameters: an array of entry identifiers for the entries to be copied, a window handle, a progress indicator, and a bitmask of flags. </p>
<p>
The window handle and progress indicator are used by the address book provider to show the status of the operation to the user. If you want to display progress, pass a window handle for the parent window of the progress indicator in the <i>ulUIParam</i> parameter and do not set the AB_NO_DIALOG flag in the <i>ulFlags</i> parameter. If you have your own implementation of a progress indicator, pass a pointer to the implementation in the <i>lpProgress</i> parameter. If not, pass NULL. The address book provider will use the MAPI progress indicator implementation. </p>
<p>
The bitmask of flags indicates whether or not you want to display a progress indicator and how duplicate entry checking should be handled. Set the AB_NO_DIALOG flag to suppress a progress indicator. Set the CREATE_CHECK_DUP_LOOSE flag to instruct the address book provider to loosely check for duplicates or the CREATE_CHECK_DUP_STRICT flag for stricter duplicate checking. Set the CREATE_REPLACE flag to have copied entries replace existing entries when the provider determines there are duplicates. </p>
<p>
When copying into a personal address book (PAB) container, the provider copies some or all of the properties for each entry. Some PABs, such as the PAB supplied by MAPI, copy all of the properties. Other PABs eliminate properties. Because MAPI does not establish requirements for providers implementing container copy operations, you cannot make assumptions about the number and type of properties that are copied with an address book entry.</p>
<p>&nbsp;</p></body>
</HTML>
