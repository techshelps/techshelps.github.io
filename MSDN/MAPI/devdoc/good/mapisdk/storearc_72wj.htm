<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Providing Read and Nonread Reports for Message Store Providers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_providing_read_and_nonread_reports_for_message_store_providers"></a>Providing Read and Nonread Reports for Message Store Providers</h2>
<p>
If a message store provider can receive messages, it is required to support read reports and nonread reports of messages received by the message store provider. If a received message contains the <a href="propb_07qc.htm">PR_READ_RECEIPT_REQUESTED</a> property and that property's value is TRUE, then the message store should send a notification message to the sender when the user opens the message indicating that the message has been read. Similarly, if the user deletes the message before opening it, the message store should issue a reply to the sender indicating that the message was not read.</p>
<p>
Issuing these reports is a matter of creating an <a href="inter029_525s.htm"><b>IMessage : IMAPIProp</b></a> object, filling out the relevant properties on the message, and submitting it to the MAPI spooler as if the message had originated with the user. The <a href="inter025_4xro.htm"><b>IMAPISupport::ReadReceipt</b></a> method can be used for this.</p>
<p>
<b>Note</b>  Special care must be taken when a message store makes copies of an unread message with pending read or nonread reports. Such reports should not be generated when users read any copies of a message for which reports have been requested. When making a copy of such a message, the message store provider should include the CLEAR_RN_PENDING and CLEAR_NRN_PENDING flags in its calls to <a href="inter013_1msz.htm"><b>IMAPIFolder::SetReadFlags</b></a> and <a href="inter029_4x47.htm"><b>IMessage::SetReadFlag</b></a>.</p>
<p>&nbsp;</p></body>
</HTML>
