<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITnef::EncodeRecips</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_itnef_encoderecips"></a>ITnef::EncodeRecips</h2>
<p>
The <b>ITnef::EncodeRecips</b> method encodes a view for a message's recipient table in the TNEF data stream for the message.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter041_0ai6.htm"><b>ITnef : IUnknown</b></a>.</p>
<pre><code><b>HRESULT EncodeRecips(
  ULONG</b><i> ulFlags</i><b>,</b>                
<b>  LPMAPITABLE</b><i> lpRecipientTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lpRecipientTable</i></dt>
<dd>
[in] Pointer to the recipient table for which the view is encoded. The <i>lpRecipientTable </i>parameter can be NULL.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Transport providers, message store providers, and gateways call the <b>ITnef::EncodeRecips</b> method to perform TNEF encoding for a particular recipient table view. Such encoding is useful, for instance, if a provider or gateway requires a particular column set, sort order, or restriction for the recipient table. </p>
<p>
A provider or gateway passes the table view to be encoded in <i>lpRecipientTable</i>. The TNEF implementation encodes the recipient table with the given view, using the given column set, sort order, restriction, and position. If a provider or gateway passes NULL in <i>lpRecipientTable</i>, TNEF gets the recipient table from the message being encoded, using the <a href="inter029_9zhh.htm"><b>IMessage::GetRecipientTable</b></a> method, and processes every row of the table into the TNEF stream using the table's current settings.</p>
<p>
Calling <b>EncodeRecips</b> with NULL in <i>lpRecipientTable</i> thus encodes all message recipients and is equivalent to calling the <a href="inter041_267n.htm"><b>ITnef::AddProps</b></a> method with the TNEF_PROP_INCLUDE flag in its <i>ulFlags</i> parameter and the <a href="propa_1zw3.htm">PR_MESSAGE_RECIPIENTS</a> property in its <i>lpPropList</i> parameter.</p>
<p>
Note that it is rarely necessary to call <b>EncodeRecips</b> unless there is some requirement for encoding a particular recipient table view. Foreign messaging systems almost always have facilities for handling recipient lists that are powerful enough to handle the common needs of encoding recipient lists and thus almost never require TNEF for this.</p>
<h4>See Also</h4>
<p>
<a href="inter029_9zhh.htm"><b>IMessage::GetRecipientTable</b></a>, <a href="inter041_267n.htm"><b>ITnef::AddProps</b></a>, <a href="propa_1zw3.htm">PR_MESSAGE_RECIPIENTS</a></p>
<p>&nbsp;</p></body>
</HTML>
