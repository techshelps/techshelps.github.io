<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IProfSect : IMAPIProp</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_iprofsect_imapiprop"></a>IProfSect : IMAPIProp</h1>
<p>
The <b>IProfSect</b> interface is used to work with the properties of profile section objects. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file:</td>
<td width=57%>MAPIX.H</td>
</tr>
<tr valign=top>
<td width=43%>Exposed by:</td>
<td width=57%>Profile section objects</td>
</tr>
<tr valign=top>
<td width=43%>Implemented by:</td>
<td width=57%>MAPI</td>
</tr>
<tr valign=top>
<td width=43%>Called by:</td>
<td width=57%>Client applications and service providers</td>
</tr>
<tr valign=top>
<td width=43%>Interface identifier:</td>
<td width=57%>IID_IProfSect</td>
</tr>
<tr valign=top>
<td width=43%>Pointer type:</td>
<td width=57%>LPPROFSECT</td>
</tr>
<tr valign=top>
<td width=43%>Transaction model:</td>
<td width=57%>Nontransacted</td>
</tr>
</table><br>
<h4>Vtable Order</h4>
<p>
No unique methods</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Required properties</th>
<th align=left width=52%>Access</th>
</tr>
<tr valign=top>
<td width=48%><a href="propb_0okl.htm">PR_OBJECT_TYPE</a></td>
<td width=52%>Read-only</td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_48it.htm">PR_PROFILE_NAME</a></td>
<td width=52%>Read-only</td>
</tr>
</table><br>
<h4>Notes to Callers</h4>
<p>
The <b>IProfSect</b> interface does not have any unique methods of its own, but you can call the profile section's <a href="inter022_00tq.htm"><b>IMAPIProp</b></a> methods. There are some differences between the <b>IProfSect</b> implementation and other implementations of <b>IMAPIProp</b>:
<ul>
<li>
<b>IProfSect</b> does not support a transaction model.</li>
<li>
<b>IProfSect</b> does not support named properties. </li>
<li>
<b>IProfSect</b> reserves the identifier range 0X67F0 to 0X67FF for secure properties. </li>
</ul>
<p>
Not supporting a transaction model means that all changes made to a profile section following calls to the <a href="inter022_406r.htm"><b>IMAPIProp::CopyProps</b></a> and <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a> methods occur immediately. Calls to the <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method succeed, but don't actually save any changes. </p>
<p>
To be protected from changes that occur prematurely, service providers need to make copies of their profile sections that are displayed to users through property sheets. The property sheets should work with the copy, rather than the real profile section. When the user has verified that the changes are accurate by clicking the <b>OK</b> button, the changes can be saved to the real profile section.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To implement a property sheet with a copied profile section</h5>
<ol>
<li>
Open the profile section by calling <a href="inter025_6rvy.htm"><b>IMAPISupport::OpenProfileSection</b></a> or <a href="inter038_5oku.htm"><b>IProviderAdmin::OpenProfileSection</b></a>.</li>
<li>
Call <a href="function_8ldc.htm"><b>CreateIProp</b></a> to retrieve a property data object — an object that supports the <b>IPropData</b> interface.</li>
<li>
Call the profile section's <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a> method to copy the properties to appear on the property sheet from the profile section to the property data object.</li>
<li>
Call <a href="inter025_9s1g.htm"><b>IMAPISupport::DoConfigPropSheet</b></a> to request that the service provider display a property sheet and pass a pointer to the property data object in the <i>lpConfigData</i> parameter.</li>
<li>
When the user saves changes to configuration properties in the property sheet, call the <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a> method to copy the properties from the property data object back to the profile section.</li>
</ol>
<p>
Profile sections, unlike other objects, do not support named properties. <a href="inter022_49f7.htm"><b>IMAPIProp::GetIDsFromNames</b></a> and <a href="inter022_7ib7.htm"><b>IMAPIProp::GetNamesFromIDs</b></a> return MAPI_E_NO_SUPPORT if called on a profile section object. Attempts to set properties with identifiers in the range above 0x8000 with <a href="inter022_6cxf.htm"><b>IMAPIProp::SetProps</b></a> return PT_ERROR as the property type.</p>
<p>
Profile sections reserve the identifier range 0X67F0 to 0X67FF for secure properties. Service providers can use this range to store passwords and other provider-specific credentials. Properties in this range are not returned in the complete list of properties when NULL is passed in the <i>lpPropTag</i> parameter of the <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method, nor are they returned in the <i>lppPropTagArray</i> parameter of the <a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a> method. Secure properties must be requested specifically by their identifiers.</p>
<p>
MAPI furnishes a profile section with the hard-coded constant MUID_PROFILE_INSTANCE as its identifier and <a href="propb_960p.htm">PR_SEARCH_KEY</a> as its single property. The PR_SEARCH_KEY property is guaranteed by MAPI to be unique among all profiles created. Use this property rather than <a href="propb_48it.htm">PR_PROFILE_NAME</a> when uniqueness is important, because it is possible for a deleted profile to be succeeded by another profile with the same name.</p>
<p>
For more information on using profile sections, see <a href="consider_59yr.htm">Administering Profiles and Message Services</a>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
