<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFormFactory::LockServer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapiformfactory_lockserver"></a>IMAPIFormFactory::LockServer</h2>
<p>
The <b>IMAPIFormFactory::LockServer</b> method keeps an open form server in memory.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter017_6ppq.htm"><b>IMAPIFormFactory : IUnknown</b></a>.</p>
<pre><code><b>HRESULT LockServer(
  ULONG</b><i> ulFlags</i><b>,</b>     
<b>  ULONG</b><i> fLockServer  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>fLockServer</i></dt>
<dd>
[in] Variable set to TRUE if the lock count is to be incremented, and FALSE otherwise. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Form viewers call the <b>IMAPIFormFactory::LockServer</b> method to keep an open form server application in memory. Keeping the form server in memory improves its performance when forms are created and released frequently. </p>
<h4>Notes to Implementers</h4>
<p>
The <b>LockServer</b> method is very similar to the <b>IClassFactory::LockServer</b> method. Essentially, this method maintains a count of how many times it has been called and as long as that count is greater than 0, prevents the form server from being unloaded from memory. You can use the OLE function <b>CoLockObjectExternal</b> to implement this. See the <i>OLE Programmer's Reference</i> for details.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
