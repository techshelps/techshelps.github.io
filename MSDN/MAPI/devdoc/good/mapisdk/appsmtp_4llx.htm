<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Message Envelope</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_message_envelope"></a>Message Envelope</h1>
<p>
RFC 822 headers are mapped to MAPI properties as follows. PR_SENDER_* is an abbreviation for the following 5 properties:</p>
<p class=indent1>
<a href="propb_9orp.htm">PR_SENDER_NAME</a></p>
<p class=indent1>
<a href="propb_9751.htm">PR_SENDER_ADDRTYPE</a></p>
<p class=indent1>
<a href="propb_94qb.htm">PR_SENDER_EMAIL_ADDRESS</a></p>
<p class=indent1>
<a href="propb_6055.htm">PR_SENDER_SEARCH_KEY</a></p>
<p class=indent1>
<a href="propb_1pno.htm">PR_SENDER_ENTRYID</a></p>
<p>
Similar abbreviations are used for PR_SENT_REPRESENTING_* and other groups of message properties.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=43%>SMTP header</th>
<th align=left width=57%>MAPI property</th>
</tr>
<tr valign=top>
<td width=43%>From:</td>
<td width=57%>Outbound: PR_SENDER_*; inbound: PR_SENDER_* and PR_SENT_REPRESENTING_*</td>
</tr>
<tr valign=top>
<td width=43%>Date:</td>
<td width=57%>Outbound: current time; inbound: <a href="propa_17ad.htm">PR_MESSAGE_DELIVERY_TIME</a></td>
</tr>
<tr valign=top>
<td width=43%>To:</td>
<td width=57%><a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> and <a href="propa_2t9v.htm">PR_EMAIL_ADDRESS</a> for recipients where <a href="propb_0n6t.htm">PR_RECIPIENT_TYPE</a> is MAPI_TO</td>
</tr>
<tr valign=top>
<td width=43%>Cc:</td>
<td width=57%>PR_DISPLAY_NAME and PR_EMAIL_ADDRESS for recipients where PR_RECIPIENT_TYPE is MAPI_CC</td>
</tr>
<tr valign=top>
<td width=43%>Bcc:</td>
<td width=57%>PR_DISPLAY_NAME and PR_EMAIL_ADDRESS for recipients where PR_RECIPIENT_TYPE is MAPI_BCC</td>
</tr>
<tr valign=top>
<td width=43%> </td>
<td width=57%> </td>
</tr>
<tr valign=top>
<td width=43%>Received:</td>
<td width=57%>No corresponding MAPI property; put local host name and your component name here</td>
</tr>
<tr valign=top>
<td width=43%>Return-receipt-to:</td>
<td width=57%><a href="propb_8a3p.htm">PR_REPORT_NAME</a> and <a href="propb_8azo.htm">PR_REPORT_ENTRYID</a></td>
</tr>
<tr valign=top>
<td width=43%>Reply-to:</td>
<td width=57%><a href="propb_3eib.htm">PR_REPLY_RECIPIENT_ENTRIES</a> and <a href="propb_5upf.htm">PR_REPLY_RECIPIENT_NAMES</a></td>
</tr>
<tr valign=top>
<td width=43%>Subject:</td>
<td width=57%><a href="propb_3c8k.htm">PR_SUBJECT</a><br>
No particular length limitation.</td>
</tr>
<tr valign=top>
<td width=43%>MIME-version:</td>
<td width=57%>Always "1.0"</td>
</tr>
<tr valign=top>
<td width=43%> </td>
<td width=57%> </td>
</tr>
<tr valign=top>
<td width=43%>X-MS-Attachment:</td>
<td width=57%>For compatibility with MS Mail SMTP gateway.<br>
<i>filename size mm-dd-yyy hh:mm</i><br>
Details below.</td>
</tr>
<tr valign=top>
<td width=43%> </td>
<td width=57%> </td>
</tr>
<tr valign=top>
<td width=43%><i>entire SMTP message envelope</i></td>
<td width=57%><a href="propb_3i0j.htm">PR_TRANSPORT_MESSAGE_HEADERS</a></td>
</tr>
<tr valign=top>
<td width=43%>header name TBD</td>
<td width=57%><a href="propb_7wmn.htm">PR_SEND_RICH_INFO</a> <i>for sender only.</i><br>
The TBD<i> </i>header should be used to determine whether the sender is capable of interpreting TNEF content in a reply.</td>
</tr>
<tr valign=top>
<td width=43%>MessageID:</td>
<td width=57%><a href="propb_0zsp.htm">PR_TNEF_CORRELATION_KEY</a></td>
</tr>
<tr valign=top>
<td width=43%>Content-type</td>
<td width=57%>Either text/plain or multipart/mixed. See "Message Content" section.</td>
</tr>
</table><br>
<p>
The X-MS-Attachment header is formatted as four tokens, separated by a space:</p>
<p>
<i>name size date time</i></p>
<p>
The first token is the filename, which may contain embedded spaces, so this header should be parsed from the right on inbound messages. The size is in bytes; the date is formatted as <i>mm-dd-yyyy,</i> and the time as <i>hh:mm.</i></p>
<p>
<b>Note</b>  MessageID is not mapped to PR_SEARCH_KEY because the SMTP domain has specific requirements on the format of the message identifier which make it impossible to encode an arbitrary MAPI message identifier. Instead, MessageID is mapped to <a href="propb_0zsp.htm">PR_TNEF_CORRELATION_KEY</a>. This property is a transport-defined property that is set by the transport sending an outbound message and used by a transport receiving an inbound message. For more information, see <a href="xptnef_6d9u.htm">Developing a TNEF-Enabled Transport Provider</a>.</p>
<p>&nbsp;</p></body>
</HTML>
