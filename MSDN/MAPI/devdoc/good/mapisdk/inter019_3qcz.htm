<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFormMgr::ResolveMessageClass</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapiformmgr_resolvemessageclass"></a>IMAPIFormMgr::ResolveMessageClass</h2>
<p>
The <b>IMAPIFormMgr::ResolveMessageClass</b> method resolves a message class to its form within a form container and returns a form information object for that form.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter019_3ju6.htm"><b>IMAPIFormMgr : IUnknown</b></a>.</p>
<pre><code><b>HRESULT ResolveMessageClass(
  LPCSTR</b><i> szMsgClass</i><b>,</b>           
<b>  ULONG</b><i> ulFlags</i><b>,</b>               
<b>  LPMAPIFOLDER</b><i> pFolderFocus</i><b>,</b>   
<b>  LPMAPIFORMINFO FAR *</b><i> ppResult  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szMsgClass</i></dt>
<dd>
[in] String naming the message class being resolved.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the message class is resolved. The following flag can be set:
<dl>
<dt>
MAPIFORM_EXACTMATCH</dt>
<dd>
Only message class strings that are an exact match should be resolved.</dd>
</dl>
</dd>
<dt>
<i>pFolderFocus</i></dt>
<dd>
[in] Pointer to the folder containing the message being resolved. The <i>pFolderFocus </i>parameter can be NULL.</dd>
<dt>
<i>ppResult</i></dt>
<dd>
[out] Pointer to a pointer to a returned form information object. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.</dd>
<dt>
MAPI_E_NOT_FOUND</dt>
<dd>
The message class passed in the <i>szMsgClass</i> parameter does not match the message class for any form in the form library.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Form viewers call the<i> </i><b>IMAPIFormMgr::ResolveMessageClass</b><i> </i>method<i> </i>to resolve a message class to its form within a form container. The form information object returned in the <i>ppResult</i> parameter provides further access to the properties of the form with the given message class. </p>
<h4>Notes to Callers</h4>
<p>
To resolve a message class to a form, a form viewer passes in the name of the message class to be resolved, such as "<code>IPM.HelpDesk.Software</code>".To force the resolution to be exact — that is, to prevent resolution to a superclass of the message class when an exactly matching form server is not available — the MAPIFORM_EXACTMATCH flag can be passed in the <i>ulFlags</i> parameter. If the <i>pFolderFocus</i> parameter is NULL, the message-class resolution process does not search a folder container.</p>
<p>
The order of the containers searched depends on the implementation of the form library provider. The default form library provider searches first the local container, then the folder container for the passed-in folder, the personal form container, and finally the organization container.</p>
<p>
Message class names are always ANSI strings, never Unicode.</p>
<p>
The class identifier for the resolved message class is returned as part of the form information object. A form viewer should not work on the assumption that the class identifier exists in the OLE library until after the form viewer has called either the <a href="inter019_71pp.htm"><b>IMAPIFormMgr::PrepareForm</b></a> method or the <a href="inter019_6w31.htm"><b>IMAPIFormMgr::CreateForm</b></a> method.</p>
<h4>See Also</h4>
<p>
<a href="inter018_5igg.htm"><b>IMAPIFormInfo</b> <b>: IMAPIProp</b></a>,<b> <a href="inter019_6w31.htm">IMAPIFormMgr::CreateForm</a></b>,<b> <a href="inter019_71pp.htm">IMAPIFormMgr::PrepareForm</a></b></p>
<p>&nbsp;</p></body>
</HTML>
