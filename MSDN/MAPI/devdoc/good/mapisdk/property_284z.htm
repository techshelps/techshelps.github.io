<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Saving Properties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_saving_properties"></a>Saving Properties</h1>
<p>
Many objects support a transaction model of processing whereby changes to properties are not made permanent until they are committed at a later time. Whereas changes to properties are handled by the <a href="inter022_6cxf.htm"><b>IMAPIProp::SetProps</b></a> and <a href="inter022_37xv.htm"><b>IMAPIProp::DeleteProps</b></a> methods, the commit step is handled by <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a>. It isn't until after a successful call to <b>SaveChanges</b> that the most recent version of an object's properties can be accessed. </p>
<p>
When <b>SaveChanges</b> returns the error value MAPI_E_OBJECT_CHANGED, this is a warning that another client is simultaneously committing changes to the object. It is possible, depending on the provider implementing the object, for multiple clients to successfully open an object by calling its <b>OpenEntry</b> method with the MAPI_MODIFY flag set, giving them read/write access. The object that is returned from such an <b>OpenEntry</b> call is a snapshot of the storage data. Each subsequent attempt to change this data can overwrite the previous attempt. </p>
<p>
Upon receiving MAPI_E_OBJECT_CHANGED from <b>SaveChanges</b>, a client has the option to:
<ul>
<li>
Make a copy of the object to hold the changes.</li>
<li>
Make another call to <b>SaveChanges</b>, specifying FORCE_SAVE. </li>
</ul>
<p>
Calling <b>SaveChanges</b> with the FORCE_SAVE flag overwrites the previous save and makes a client's changes permanent.</p>
<p>&nbsp;</p></body>
</HTML>
