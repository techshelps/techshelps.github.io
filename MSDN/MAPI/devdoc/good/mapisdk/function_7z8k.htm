<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WrapStoreEntryID</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_wrapstoreentryid"></a>WrapStoreEntryID</h2>
<p>
The <b>WrapStoreEntryID</b> function converts a message store's internal entry identifier to an entry identifier more usable by the messaging system. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIUTIL.H </td>
</tr>
<tr valign=top>
<td width=48%>Implemented by: </td>
<td width=52%>MAPI </td>
</tr>
<tr valign=top>
<td width=48%>Called by: </td>
<td width=52%>Client applications and service providers </td>
</tr>
</table><br>
<pre><code><b>WrapStoreEntryID(
  ULONG</b><i> ulFlags</i><b>,</b>           
<b>  LPTSTR</b><i> szDLLName</i><b>,</b>        
<b>  ULONG</b><i> cbOrigEntry</i><b>,</b>       
<b>  LPENTRYID</b><i> lpOrigEntry</i><b>,</b>   
<b>  ULONG *</b><i> lpcbWrappedEntry</i><b>,</b>   
<b>  LPENTRYID *</b><i> lppWrappedEntry  </i>
<b>);</b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>ulFlags </i></dt>
<dd>
[in] Bitmask of flags. The following flag can be set: 
<dl>
<dt>
MAPI_UNICODE </dt>
<dd>
The strings are in Unicode format. If the MAPI_UNICODE flag is not set, the strings are in ANSI format. </dd>
</dl>
</dd>
<dt>
<i>szDLLName </i></dt>
<dd>
[in] The name of the message store provider DLL. </dd>
<dt>
<i>cbOrigEntry </i></dt>
<dd>
[in] Size, in bytes, of the original entry identifier for the message store. </dd>
<dt>
<i>lpOrigEntry </i></dt>
<dd>
[in] Pointer to an <a href="structyp_05gk.htm"><b>ENTRYID</b></a> structure containing the original entry identifier. </dd>
<dt>
<i>lpcbWrappedEntry </i></dt>
<dd>
[out] Pointer to the size, in bytes, of the new entry identifier. </dd>
<dt>
<i>lppWrappedEntry </i></dt>
<dd>
[out] Pointer to a pointer to an <b>ENTRYID</b> structure containing the new entry identifier. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
A message store object retains an internal entry identifier which is meaningful only to service providers coresident with that message store. For other messaging components, MAPI supplies a wrapped version of the internal entry identifier that makes it recognizable as belonging to the message store. Coresident service providers should always be given the original unwrapped message store entry identifier; client applications should always be given the wrapped version, which is then usable anywhere in the messaging domain and in other domains. </p>
<p>
A service provider can wrap a message store entry identifier using either the <b>WrapStoreEntryID</b> function or the <a href="inter025_5s10.htm"><b>IMAPISupport::WrapStoreEntryID</b></a> method, which calls the <b>WrapStoreEntryID</b> function. The provider must wrap the entry identifier when exposing the message store's <a href="propa_8cv8.htm">PR_ENTRYID</a> property or writing it into a profile section, and when exposing the <a href="propb_2vqc.htm">PR_STORE_ENTRYID</a> property. MAPI wraps a message store entry identifier when responding to an <a href="inter023_59id.htm"><b>IMAPISession::OpenMsgStore</b></a> call. </p>
<p>
When a client application passes a wrapped message store entry identifier to MAPI, for example in a <a href="inter023_146x.htm"><b>IMAPISession::OpenEntry</b></a> call, MAPI unwraps the entry identifier before using it to call a provider method such as <a href="inter033_4ze6.htm"><b>IMSProvider::Logon</b></a> or <a href="inter033_8ho3.htm"><b>IMSProvider::CompareStoreIDs</b></a>. </p>
<h4>See Also</h4>
<p>
<a href="groups_1jlf.htm">Entry Identifier Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
