<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISession::GetMsgStoresTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisession_getmsgstorestable"></a>IMAPISession::GetMsgStoresTable</h2>
<p>
The <b>IMAPISession::GetMsgStoresTable</b> method provides access to the message store table — a table with information about all of the message stores in the session profile.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter023_64ry.htm"><b>IMAPISession : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetMsgStoresTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that determines the format for columns that are character strings. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The string columns are in Unicode format. If the MAPI_UNICODE flag is not set, the string columns are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the message store table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The table was successfully returned.</dd>
<dt>
MAPI_E_BAD_CHARWIDTH</dt>
<dd>
The MAPI_UNICODE flag was set and MAPI does not support Unicode at present.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISession::GetMsgStoresTable</b> method retrieves a pointer to the message store table, a table maintained by MAPI that contains information about each open message store in the profile. </p>
<p>
For a complete list of required and optional columns in the message store table, see <a href="tables_9bl1.htm">Message Store Table</a>. </p>
<h4>Notes to Callers</h4>
<p>
Because MAPI updates the message store table during the session whenever changes occur, call the <b>Advise</b> method of the message store table to register to be notified of these changes. Possible changes include the addition of new message stores, removal of existing stores, and changes to the default store. </p>
<p>
Setting the MAPI_UNICODE flag in the <i>ulFlags </i>parameter affects the format of the columns returned from the following <b>IMAPITable</b> methods:
<ul>
<li>
<a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a> </li>
<li>
<a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> </li>
</ul>
<p>
This flag also controls the property types in the sort order returned by the <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> method.</p>
<h4>See Also</h4>
<p>
<a href="inter023_59id.htm"><b>IMAPISession::openMsgStore</b></a>, <a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a>, <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>, <a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a>, <a href="inter026_7x83.htm"><b>IMAPITable::SetColumns</b></a>, <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a></p>
<p>&nbsp;</p></body>
</HTML>
