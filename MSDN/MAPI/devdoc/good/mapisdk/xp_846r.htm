<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Properties on Incoming Messages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_setting_properties_on_incoming_messages"></a>Setting Properties on Incoming Messages</h2>
<p>
The client applications within the MAPI subsystem expect a number of properties in any received message. When the transport provider brings a message into MAPI, it should set these properties, since it is either the only process with the necessary information to do so, or is at least the best source of the information.</p>
<p>
Providers are encouraged to set the values for all of these properties in incoming messages.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=58%>Property Name</th>
<th align=left width=42%>Description</th>
</tr>
<tr valign=top>
<td width=58%><a href="propb_3c8k.htm">PR_SUBJECT</a></td>
<td width=42%>Subject of the message.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propa_9lvd.htm">PR_BODY</a></td>
<td width=42%>Plain text message text.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_7vhg.htm">PR_RTF_COMPRESSED</a></td>
<td width=42%>Compressed RTF message text.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propa_17ad.htm">PR_MESSAGE_DELIVERY_TIME</a></td>
<td width=42%>Date and time the message was delivered.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_9orp.htm">PR_SENDER_NAME</a></td>
<td width=42%>Display name of the message originator.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_1pno.htm">PR_SENDER_ENTRYID</a></td>
<td width=42%>Address book entry of the message originator.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_6055.htm">PR_SENDER_SEARCH_KEY</a></td>
<td width=42%>Address book search key of the message originator.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propa_7pr9.htm">PR_CLIENT_SUBMIT_TIME</a></td>
<td width=42%>The time that the message was submitted to its messaging system by the sender's messaging client.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_799h.htm">PR_SENT_REPRESENTING_NAME</a></td>
<td width=42%>Name of the representative delegate for sending. </td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_17hg.htm">PR_SENT_REPRESENTING_ENTRYID</a></td>
<td width=42%>Address book entry of the sending delegate.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_5fax.htm">PR_SENT_REPRESENTING_SEARCH_KEY</a></td>
<td width=42%>Address book search key of the sending delegate.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_6m1x.htm">PR_RCVD_REPRESENTING_NAME</a></td>
<td width=42%>Name of the representative delegate for receiving.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_21lw.htm">PR_RCVD_REPRESENTING_ENTRYID</a></td>
<td width=42%>Address book entry of the receiving delegate.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_7qrd.htm">PR_RCVD_REPRESENTING_SEARCH_KEY</a></td>
<td width=42%>Address book search key of the receiving delegate.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_5upf.htm">PR_REPLY_RECIPIENT_NAMES</a></td>
<td width=42%>List of delegated recipient display names, separated by a semicolon and space "; ".</td>
</tr>
<tr valign=top>
<td width=58%><a href="propb_3eib.htm">PR_REPLY_RECIPIENT_ENTRIES</a></td>
<td width=42%>List of delegated recipients for a reply.</td>
</tr>
<tr valign=top>
<td width=58%><a href="propa_061x.htm">PR_MESSAGE_TO_ME</a></td>
<td width=42%>Indicates that the recipient was specifically named as a To recipient (not in a group).</td>
</tr>
<tr valign=top>
<td width=58%><a href="propa_9nad.htm">PR_MESSAGE_CC_ME</a></td>
<td width=42%>Indicates that the recipient was specifically named as a Cc recipient (not in a group).</td>
</tr>
<tr valign=top>
<td width=58%><a href="propa_76ed.htm">PR_MESSAGE_RECIP_ME</a></td>
<td width=42%>Indicates that the recipient was specifically named as a To, Cc or Bcc recipient (not in a group).</td>
</tr>
</table><br>
<p>
Providers which have no apparent mappings can set the PR_SENT_REPRESENTING group of properties to the same values as the PR_SENDER group, the PR_RCVD_REPRESENTING group to the same values as the PR_RECEIVED_BY group, and build the PR_REPLY_RECIPIENT group of properties based on the values of the PR_SENDER group. For example, PR_SENT_REPRESENTING_NAME can be set to the same value as PR_SENDER_NAME.</p>
<p>
The PR_ENTRYID or PR_ENTRYLIST properties can be generated if necessary by calling the <a href="inter025_37mu.htm"><b>IMAPISupport::CreateOneOff</b></a> method. The PR_SEARCH_KEY properties can be generated by concatenating the PR_ADDRTYPE property associated with a user, a colon ':', and the PR_EMAIL_ADDRESS property associated with the user, then folding the result to uppercase. The Windows API <b>CharUpperBuff</b> is a convenient function to use for this purpose. What is required of this process is to make a canonical form of the address that can be compared as a binary quantity. Note that this is not necessary if the transport provider is case-sensitive with respect to e-mail addresses.</p>
<p>&nbsp;</p></body>
</HTML>
