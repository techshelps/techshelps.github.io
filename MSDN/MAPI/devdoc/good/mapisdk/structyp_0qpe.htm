<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPIERROR</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_mapierror"></a>MAPIERROR</h2>
<p>
The <b>MAPIERROR</b> structure provides detailed information about an error, typically generated by the operating system, MAPI, or a service provider. </p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIDEFS.H</td>
</tr>
</table><br>
<pre><code>typedef struct _MAPIERROR 
{ 
     ULONG      ulVersion; 
     LPTSTR     lpszError; 
     LPTSTR     lpszComponent; 
     ULONG      ulLowLevelError; 
     ULONG      ulContext; 
 
} MAPIERROR, FAR * LPMAPIERROR; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>ulVersion</b></dt>
<dd>
Version number of the structure. The <b>ulVersion</b> member is used for future expansion and should be set to MAPI_ERROR_VERSION, which is currently defined as zero. </dd>
<dt>
<b>lpszError</b></dt>
<dd>
Pointer to a string describing the error. This string will be in Unicode format if the <i>ulFlags</i> parameter to the method in which this structure is used is set to MAPI_UNICODE.</dd>
<dt>
<b>lpszComponent</b></dt>
<dd>
Pointer to a string describing the component that generated the error. This string will be in Unicode format if the <i>ulFlags</i> parameter to the method in which this structure is used is set to MAPI_UNICODE. </dd>
<dt>
<b>ulLowLevelError</b></dt>
<dd>
Low-level error value used only when the error to be returned is low-level.</dd>
<dt>
<b>ulContext</b></dt>
<dd>
Value that represents the location within the component pointed to by the <b>lpszComponent </b>member that identifies where the error occurred. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MAPIERROR</b> structure is used to describe error information. Clients and service providers pass a pointer to a <b>MAPIERROR</b> structure in the <i>lppMAPIError</i> parameter of the <a href="inter022_1hv6.htm"><b>IMAPIProp::GetLastError</b></a><b> </b>method. <b>GetLastError</b> returns information about the previous error that has occurred to an object. Callers of <b>GetLastError</b> free the memory for the <b>MAPIERROR</b> structure by calling <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a>.</p>
<p>
The <b>lpszComponent</b> member can be used to map the component's Help file, if one exists. Service providers should limit the size of the component string to 30 characters so that it can easily be displayed in a dialog box. The <b>ulContext</b> member can also be used to refer to an online Help topic for common errors. </p>
<p>
Because service providers are not required to provide detailed error information, clients should not expect any of the members of the <b>MAPIERROR</b> structure that are returned to contain valid data. However, at a minimum MAPI strongly recommends that providers specify information in the <b>lpszComponent</b> and <b>ulContext</b> members. </p>
<p>
For more information about error handling in MAPI, see <a href="extend_28dj.htm">Error Handling</a>.</p>
<h4>See Also</h4>
<p>
<a href="inter004_81wy.htm"><b>IABLogon::GetLastError</b></a>,<b> <a href="inter005_8nqm.htm">IABProvider::Logon</a></b>, <a href="inter012_3d82.htm"><b>IMAPIControl::GetLastError</b></a>, <a href="inter022_1hv6.htm"><b>IMAPIProp::GetLastError</b></a>, <a href="inter023_8lde.htm"><b>IMAPISession::GetLastError</b></a>,<b> <a href="inter025_7q5u.htm">IMAPISupport::GetLastError</a></b>, <a href="inter025_6nmz.htm"><b>IMAPISupport::OpenAddressBook</b></a>, <a href="inter023_01ij.htm"><b>IMAPISession::OpenAddressBook</b></a>, <a href="inter026_6lde.htm"><b>IMAPITable::GetLastError</b></a>, <a href="inter030_6kz6.htm"><b>IMsgServiceAdmin::GetLastError</b></a>, <a href="inter032_1agi.htm"><b>IMSLogon::GetLastError</b></a>, <a href="inter033_4ze6.htm"><b>IMSProvider::Logon</b></a>, <a href="inter035_373m.htm"><b>IProfAdmin::GetLastError</b></a>, <a href="inter038_41iq.htm"><b>IProviderAdmin::GetLastError</b></a></p>
<p>&nbsp;</p></body>
</HTML>
