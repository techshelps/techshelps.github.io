<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Centralizing the Receipt of NDRs</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_centralizing_the_receipt_of_ndrs"></a>Centralizing the Receipt of NDRs</h2>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To have nondelivery reports (NDRs) arrive at a central location when multiple instances of your client are running simultaneously</h5>
<ol>
<li>
Set <a href="propb_8azo.htm">PR_REPORT_ENTRYID</a>, <a href="propb_8a3p.htm">PR_REPORT_NAME</a>, and <a href="propb_4lh5.htm">PR_REPORT_SEARCH_KEY</a> to the appropriate values for the account that is to receive the reports. Create the entry identifier by calling <a href="inter006_92zq.htm"><b>IAddrBook::CreateOneOff</b></a> if necessary.</li>
<li>
Understand that there are messaging systems that will ignore the account you've requested for reports and send them to the originator. Reduce the impact that this will have on administrators that will need to move reports around by:<ul>
<li>
Giving your original message a distinct message class, such as IPM.Note.MSNNews. Look for incoming messages with class Report.IPM.Note.MSNNews.NDR and forward them to the account you intended reports to come to. At the same time, send e-mail to the messaging system that ignored your nondelivery report account to the affect that it should honor the <a href="propb_8azo.htm">PR_REPORT_ENTRYID</a> property.</li>
<li>
Most messaging systems which do not honor PR_REPORT_ENTRYID will not honor the MAPI message class conventions either. Therefore, you'll receive something that looks like a note. This is a little harder to deal with since the input is so variable. Look at the subject and forward it if you find either something from a list of words that mean "undeliverable" or something from your original subject.</li>
</ul>
<ol>
<li>
Be prepared to tune these lists over time.</li>
</ol>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
