<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LAUNCHWIZARDENTRY</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_launchwizardentry"></a>LAUNCHWIZARDENTRY</h2>
<p>
The <b>LAUNCHWIZARDENTRY</b> function prototype defines a function that starts the Profile Wizard application for the purpose of adding one or more message services to a profile. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIWZ.H </td>
</tr>
<tr valign=top>
<td width=48%>Defined function implemented by: </td>
<td width=52%>MAPI </td>
</tr>
<tr valign=top>
<td width=48%>Defined function called by: </td>
<td width=52%>Client applications </td>
</tr>
</table><br>
<pre><code><b>HRESULT LAUNCHWIZARDENTRY( 
  HWND</b><i> hParentWnd</i><b>,</b>                       
<b>  ULONG</b><i> ulFlags</i><b>,</b>                         
<b>  LPCTSTR FAR *</b><i> lppszServiceNameToAdd</i><b>,</b>   
<b>  ULONG</b><i> cbBufferMax</i><b>,</b>                     
<b>  LPTSTR</b><i> lpszNewProfileName</i>              
<b>); </b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>hParentWnd </i></dt>
<dd>
[in] A handle to the caller's parent window. If the caller does not have a parent window, the <i>hParentWnd</i> parameter should be NULL. </dd>
<dt>
<i>ulFlags </i></dt>
<dd>
[in] Bitmask of flags indicating options for the Profile Wizard. The following flags can be set: 
<dl>
<dt>
MAPI_PW_ADD_SERVICE_ONLY </dt>
<dd>
The Profile Wizard is to add only the message services listed through the <i>lppszServiceNameToAdd</i> parameter, and not display its page for selecting message services. </dd>
<dt>
MAPI_PW_FIRST_PROFILE </dt>
<dd>
The profile to be created is the first one for this workstation. </dd>
<dt>
MAPI_PW_HIDE_SERVICES_LIST </dt>
<dd>
The Profile Wizard's page for selecting message services should not be displayed. </dd>
<dt>
MAPI_PW_LAUNCHED_BY_CONFIG </dt>
<dd>
The Profile Wizard was launched by the Control Panel configuration application. </dd>
<dt>
MAPI_PW_PROVIDER_UI_ONLY </dt>
<dd>
Only the service providers's configuration dialog boxes should be displayed and the Profile Wizard's pages should not appear. This flag can only be set if the MAPI_PW_ADD_SERVICE_ONLY flag is set. </dd>
</dl>
</dd>
<dt>
<i>lppszServiceNameToAdd </i></dt>
<dd>
[in] Pointer to an array of strings containing the names of the message services to be added to the profile. The array must terminate with a NULL value. </dd>
<dt>
<i>cbBufferMax </i></dt>
<dd>
[in] Size of the buffer pointed to by the <i>lpszNewProfileName</i> parameter.<i> </i></dd>
<dt>
<i>lpszNewProfileName </i></dt>
<dd>
[out] Pointer to a string buffer where the function based on <b>LAUNCHWIZARDENTRY</b> returns the name of the created profile. 
</dd>
</dl>
<h4>Return Values </h4>
<dl>
<dt>
S_OK </dt>
<dd>
The call succeeded and has returned the expected value or values. </dd>
<dt>
MAPI_E_CALL_FAILED </dt>
<dd>
An error of unexpected or unknown origin prevented the operation from completing. Possibilities include failure to initialize the MAPI subsystem for the Profile Wizard, inability to access the default profile, and an error return from the dialog box. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The MAPI implementation of the <b>LAUNCHWIZARDENTRY</b> function prototype is the entry point into the MAPI Profile Wizard application. MAPI names this entry point <b>LaunchWizard</b>. </p>
<p>
When the MAPI_PW_ADD_SERVICE_ONLY flag is set in the <i>ulFlags</i> parameter, the following rules apply: 
<ul>
<li>
The MAPI_PW_LAUNCHED_BY_CONFIG flag inhibits the welcome page from being displayed. </li>
<li>
The MAPI_PW_HIDE_SERVICES_LIST and MAPI_PW_PROVIDER_UI_ONLY flags are useful only when there is no default profile. In this case these flags determine which Profile Wizard page is to be displayed. </li>
<li>
If a default profile exists, none of the Profile Wizard pages are to be displayed. </li>
<li>
If a default profile exists, only one message service is listed through the <i>lppszServiceNameToAdd</i> parameter, and that message service is already in the default profile, the Profile Wizard returns S_OK without adding anything to the profile. </li>
</ul>
<p>
For every message service to be added to the profile, the Profile Wizard calls the service's entry point function based on the <a href="function_7nnd.htm"><b>MSGSERVICEENTRY</b></a> prototype. For each service provider selected from a message service to be added to the profile, the Profile Wizard calls the provider's entry point function based on the <a href="function_0gzd.htm"><b>WIZARDENTRY</b></a> prototype. During interactive configuration, every user event in the property pages causes the Profile Wizard to call the provider's callback function based on the <a href="function_8nxf.htm"><b>SERVICEWIZARDDLGPROC</b></a> prototype. </p>
<p>
If a service provider being added to the profile supports the Profile Wizard pages, it must allow programmatic configuration of the profile. For more information on creating profiles, see <a href="start_1ihx.htm">Creating and Configuring a Profile</a>. </p>
<h4>See Also</h4>
<p>
<a href="groups_6tmb.htm">Profile Wizard Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
