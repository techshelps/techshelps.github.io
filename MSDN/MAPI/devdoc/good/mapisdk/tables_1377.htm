<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with Multivalued Columns</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_working_with_multivalued_columns"></a>Working with Multivalued Columns</h2>
<p>
A multivalued column contains the data of a multivalued property, or property that has an array of values of the base type rather than a single value. Because none of the tables include multivalued properties in their default column sets, multivalued properties are included in a table only if the user of the table requests it. </p>
<p>
Multivalued columns can be displayed in tables:
<ul>
<li>
In a single row, with all of the property values appearing in the single column instance. This is the default. <p>
– Or –
</li>
<li>
In a series of rows, with one row for each of the property values. Each unique value appears in the column in its own row with there being as many rows as there are values in the multivalued property. Each row has a unique value for the <a href="propa_65h5.htm">PR_INSTANCE_KEY</a> property, but the same values for the other columns.<p>
If a row contains more than one column with multiple values, for example, two columns with <i>M</i> and <i>N</i> values respectively, then <i>M*N</i> instances of the row appear in the table. 
</li>
</ul>
<p>
A table user requests the nondefault type of display by calling the <a href="inter026_7x83.htm"><b>IMAPITable::SetColumns</b></a> method with the MVI_FLAG flag set in the property type of the multivalued column. The MVI_FLAG flag is a constant defined as the result of combining the MV_FLAG and MV_INSTANCE flags with a logical <b>OR</b> operation. In addition to being used in <b>SetColumns</b>, MVI_FLAG can also be passed to <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a> in the <i>lpSortCriteria</i> parameter and <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a> in the <b>ulPropTag</b> member of the <i>lpRestriction</i> parameter. When passed the MVI_FLAG, <b>SortTable</b> performs similarly to <b>SetColumns</b>, adding one row for each value in the multivalued column and sorting on the single values in the instances. One row is added for each value. </p>
<p>
<b>Restrict</b>, however, does not expand the multivalued column into additional computed rows. A multivalued column with the MVI_FLAG set instructs the service provider to use that column in restricting the table. If there is a property value in the restriction, it must be a single value property tag identical to the one that would be returned by <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> for the column.</p>
<p>
Table implementers are only required to support the default type of display and can return the MAPI_E_TOO_COMPLEX value when a caller requests the other alternative. The ability to support both types of display is most important for message store providers implementing folder contents tables. </p>
<p>&nbsp;</p></body>
</HTML>
