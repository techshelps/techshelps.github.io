<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Synchronizing Text and Formatting</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_synchronizing_text_and_formatting"></a>Synchronizing Text and Formatting</h2>
<p>
The main challenge in sending Rich Text Format (RTF) messages is keeping the text synchronized with the formatting. To ensure that when messages arrive at their destination they are as their originators intended and that the text and formatting are synchronized, MAPI provides the <a href="function_4yg3.htm"><b>RTFSync</b></a> function. <b>RTFSync</b> is typically called by RTF-aware clients before displaying incoming messages and by the MAPI spooler when it downloads messages to a transport provider. Callers specify the area of possible discrepancy by passing one or two flags to <b>RTFSync</b>:
<ul>
<li>
RTF_SYNC_BODY_CHANGED to indicate a modification in message text.</li>
<li>
RTF_SYNC_RTF_CHANGED to indicate a modification in message formatting.</li>
</ul>
<p>
The synchronization process that occurs in <b>RTFSync</b> is a sophisticated cyclic redundancy check (CRC) of the message text that ignores some characters and converts others. Characters that most likely were added by transport providers are ignored. MAPI defines several properties for working with RTF as described in the following table.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>RTF property</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="propb_6lgn.htm">PR_RTF_SYNC_BODY_TAG</a></td>
<td width=52%>Indicates the beginning of the real message text.</td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_54kj.htm">PR_RTF_SYNC_BODY_CRC</a></td>
<td width=52%>Contains the result of the cyclic redundancy check of the message text.</td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_4v78.htm">PR_RTF_SYNC_BODY_COUNT</a></td>
<td width=52%>Contains the number of characters in PR_RTF_SYNC_BODY_CRC.</td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_26ar.htm">PR_RTF_IN_SYNC</a></td>
<td width=52%>Set to TRUE when the message text and formatting have been synchronized.</td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_2xdg.htm">PR_RTF_SYNC_PREFIX_COUNT</a></td>
<td width=52%>Contains the number of nonwhitespace characters that preceed the message text.</td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_43g4.htm">PR_RTF_SYNC_TRAILING_COUNT</a></td>
<td width=52%>Contains the number of nonwhitespace characters that trail the message text.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
