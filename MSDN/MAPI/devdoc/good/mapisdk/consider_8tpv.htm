<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending and Receiving Form Notifications</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_sending_and_receiving_form_notifications"></a>Sending and Receiving Form Notifications</h2>
<p>
Form notifications are used in MAPI to facilitate communication both from the form to your viewer as well as from your viewer to the form. </p>
<p>
Forms send notifications to your viewer when one of the following events occur:
<ul>
<li>
The form is closed.</li>
<li>
A new message is loaded in the form.</li>
<li>
Printing status changes.</li>
<li>
A save operation is completed.</li>
<li>
A message is sent.</li>
</ul>
<p>
Each of these event types correspond to a particular method in <a href="inter027_652m.htm"><b>IMAPIViewAdviseSink</b></a>, one of the interfaces that your form viewer must implement. When an event occurs, the form calls the corresponding <b>IMAPIViewAdviseSink</b> method in your viewer's advise sink. For example, when a new message arrives that your viewer should include in its display, the form calls your <a href="inter027_59ut.htm"><b>IMAPIViewAdviseSink::OnNewMessage</b></a><b> </b>method. </p>
<p>
Implement your view advise sink in a way that makes sense for your viewer; there is no standard implementation. For example, in <b>OnNewMessage</b> you can update the view of the current folder's contents table to include the newly arrived message. In <a href="inter027_1h9g.htm"><b>IMAPIViewAdviseSink::OnSubmitted</b></a>, the method that is called when you receive a submitted message event, you can copy the submitted message to a Sent Items folder.</p>
<p>
Forms receive notification from your viewer when a change occurs that affects the form and when you are loading a new message. To notify a form, call one of the methods of <b>IMAPIFormAdviseSink</b>: <a href="inter015_5h5x.htm"><b>OnChange</b></a> or <a href="inter015_9gc4.htm"><b>OnActivateNext</b></a>. Call <b>OnChange</b> to communicate status. For example, if the form is displaying the last item in a folder when a new message arrives, call <b>OnChange</b> with the VCSTATUS_NEXT flag set to tell the form that there is now a next item.</p>
<p>
Call <b>OnActivateNext</b> to alert the form to the arrival of a new message that it may or may not be able to display. Pass the message class of the message to <b>OnActivateNext</b>. </p>
<p>
Notifications by a form object to the client application are handled by the client application's <b>IMAPIViewAdviseSink</b> interface. See <a href="inter027_652m.htm"><b>IMAPIViewAdviseSink : IUnknown</b></a> for details.</p>
<p>&nbsp;</p></body>
</HTML>
