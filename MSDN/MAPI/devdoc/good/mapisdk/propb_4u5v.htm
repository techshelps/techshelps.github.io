<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PR_RESOURCE_FLAGS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_pr_resource_flags"></a>PR_RESOURCE_FLAGS</h2>
<p>
The PR_RESOURCE_FLAGS property contains a bitmask of flags for message services and providers.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file:</td>
<td width=57%>MAPITAGS.H</td>
</tr>
<tr valign=top>
<td width=43%>Must be exposed by:</td>
<td width=57%>Status objects</td>
</tr>
<tr valign=top>
<td width=43%>Must be a column in:</td>
<td width=57%>Message service, message store, and status tables</td>
</tr>
<tr valign=top>
<td width=43%>Identifier:</td>
<td width=57%>0x3009</td>
</tr>
<tr valign=top>
<td width=43%>Property type:</td>
<td width=57%>PT_LONG</td>
</tr>
<tr valign=top>
<td width=43%>Property tag:</td>
<td width=57%>0x30090003</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
PR_RESOURCE_FLAGS describes the characteristics of a message service, a service provider, or a status object. The flags that are set for PR_RESOURCE_FLAGS depend on its context. For example, some flags are valid only for status objects and other flags only for columns in the message service table. </p>
<p>
The flags are of three classes: static, modifiable, and dynamic. Static flags are set by MAPI from data in MAPISVC.INF and never altered. Modifiable flags are set by MAPI from MAPISVC.INF but can be subsequently changed. Dynamic flags can be set and reset by MAPI methods.</p>
<p>
For a message service, one or more of the following flags can be set in PR_RESOURCE_FLAGS: 
<dl>
<dt>
SERVICE_CREATE_WITH_STORE</dt>
<dd>
Reserved. Do not use.</dd>
<dt>
SERVICE_DEFAULT_STORE  </dt>
<dd>
Dynamic. The message service contains the default store. A user interface should be displayed prompting the user for confirmation before deleting or moving this service out of the profile. </dd>
<dt>
SERVICE_NO_PRIMARY_IDENTITY</dt>
<dd>
Static. The service level flag that should be set to indicate that none of the providers in the message service can be used to supply an identity. Either this flag or SERVICE_PRIMARY_IDENTITY should be set, but not both.</dd>
<dt>
SERVICE_PRIMARY_IDENTITY</dt>
<dd>
Modifiable. The corresponding message service contains the provider used for the primary identity for this session. Use <a href="inter030_1zeh.htm"><b>IMsgServiceAdmin::SetPrimaryIdentity</b></a> to set this flag. Either this flag or SERVICE_NO_PRIMARY_IDENTITY should be set, but not both.</dd>
<dt>
SERVICE_SINGLE_COPY</dt>
<dd>
Static. Any attempt to create or copy this message service into a profile where the service already exists will fail. To create a single copy message service add the PR_RESOURCE_FLAGS property to the service's section in MAPISVC.INF and set this flag.</dd>
</dl>
<p>
For a service provider, one or more of the following flags can be set in PR_RESOURCE_FLAGS: 
<dl>
<dt>
HOOK_INBOUND</dt>
<dd>
Static. The spooler hook needs to process inbound messages.</dd>
<dt>
HOOK_OUTBOUND</dt>
<dd>
Static. The spooler hook needs to process outbound messages. </dd>
<dt>
STATUS_DEFAULT_OUTBOUND</dt>
<dd>
Modifiable. This identity should be applied to outbound messages if the profile contains multiple instances of this transport provider. This can happen if multiple instances of a single transport provider appear in the profile.</dd>
<dt>
STATUS_DEFAULT_STORE</dt>
<dd>
Modifiable. This message store is the default store for the profile. </dd>
<dt>
STATUS_NEED_IPM_TREE</dt>
<dd>
Dynamic. The standard folders in this message store, including the interpersonal message (IPM) root folder, have not yet been verified. MAPI sets and clears this flag. </dd>
<dt>
STATUS_NO_DEFAULT_STORE</dt>
<dd>
Static. This message store is incapable of becoming the default message store for the profile.</dd>
<dt>
STATUS_NO_PRIMARY_IDENTITY</dt>
<dd>
Static. This provider does not furnish an identity in its status row. Either this flag or STATUS_PRIMARY_IDENTITY must be set.</dd>
<dt>
STATUS_OWN_STORE</dt>
<dd>
Static. This transport provider is tightly coupled with a message store and furnishes the <a href="propb_46jo.htm">PR_OWN_STORE_ENTRYID</a> property in its status row.</dd>
<dt>
STATUS_PRIMARY_IDENTITY</dt>
<dd>
Modifiable. This provider furnishes the primary identity for the session; the entry identifier for the object furnishing the identity is returned from <a href="inter023_7x89.htm"><b>IMAPISession::QueryIdentity</b></a>. Either this flag or STATUS_NO_PRIMARY_IDENTITY must be set.</dd>
<dt>
STATUS_PRIMARY_STORE</dt>
<dd>
Modifiable. This message store is to be used when a client application logs on. Once opened, this store should be set as the default store for the profile. </dd>
<dt>
STATUS_SECONDARY_STORE</dt>
<dd>
Modifiable. This message store is to be used if the primary store is not available when a client application logs on. Once opened, this store should be set as the default store for the profile. </dd>
<dt>
STATUS_SIMPLE_STORE</dt>
<dd>
Dynamic. This message store will be used by Simple MAPI or CMC as its default message store.</dd>
<dt>
STATUS_TEMP_SECTION</dt>
<dd>
Dynamic. This message store should not be published in the message store table and will be deleted from the profile after logoff. </dd>
<dt>
STATUS_XP_PREFER_LAST</dt>
<dd>
Static. This transport expects to be the last transport selected to send a message when multiple transport providers are able to transmit the message. 
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="groups_67cj.htm">Provider Properties</a>, <a href="inter030_0ysy.htm"><b>IMsgServiceAdmin::MsgServiceTransportOrder</b></a>, <a href="propa_3q1w.htm">PR_IDENTITY_ENTRYID</a></p>
<p>&nbsp;</p></body>
</HTML>
