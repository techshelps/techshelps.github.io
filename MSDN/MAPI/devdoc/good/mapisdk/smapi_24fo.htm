<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Initializing a Simple MAPI Client</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_initializing_a_simple_mapi_client"></a>Initializing a Simple MAPI Client</h1>
<p>
Before starting a Simple MAPI messaging session you need to initialize your client application. This involves checking the computer's WIN.INI file to determine if Simple MAPI is available, loading the correct dynamic link library (DLL) that contains the Simple MAPI functions, and setting a pointer to each function.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To initialize your client</h5>
<ol>
<li>
Determine that Simple MAPI is available by checking the <b>[MAIL]</b> section in the computer's WIN.INI file for the MAPI entry. This entry will have a value of 1 if Simple MAPI is installed, or 0 if uninstalled.</li>
<li>
Load the correct DLL for your operating system by calling the Windows <b>LoadLibrary</b> function as follows:<pre><code>hlibMAPI = LoadLibrary("MAPI.DLL");    // 16 bit clients
hlibMAPI = LoadLibrary("MAPI32.DLL");  // 32 bit clients
 </code></pre>
<p>
The two DLLs for Simple MAPI are MAPI.DLL for 16-bit clients and MAPI32.DLL for 32-bit clients.
</li>
<li>
Set the pointer variable to the actual address of the <a href="smapiref_68tq.htm"><b>MAPILogon</b></a> function as follows:<pre><code>lpfnMAPILogon = (LPFNMAPILOGON) GetProcAddress 
    (hlibMAPI, "MAPILogon")))
 </code></pre>
</li>
</ol>
<p>
Similarly defined constants exist for the other Simple MAPI functions, so you simply need to set the value of the function pointers using the Win32 function <b>GetProcAddress</b> as in the previous example.</p>
<p>&nbsp;</p></body>
</HTML>
