<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFolder::DeleteMessages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapifolder_deletemessages"></a>IMAPIFolder::DeleteMessages</h2>
<p>
The <b>IMAPIFolder::DeleteMessages</b> method deletes one or more messages.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT DeleteMessages(
  LPENTRYLIST</b><i> lpMsgList</i><b>,</b>   
<b>  ULONG</b><i> ulUIParam</i><b>,</b>         
<b>  LPMAPIPROGRESS</b><i> lpProgress</i><b>,</b>   
<b>  ULONG</b><i> ulFlags            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpMsgList</i></dt>
<dd>
[in] Pointer to an <a href="structyp_8o1g.htm"><b>ENTRYLIST</b></a> structure that contains the number of messages to delete and an array of <a href="structyp_05gk.htm"><b>ENTRYID</b></a> structures identifying the messages.</dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the progress indicator. The <i>ulUIParam</i> parameter is ignored unless the MESSAGE_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>lpProgress</i></dt>
<dd>
[in] Pointer to a progress object for displaying a progress indicator. If NULL is passed in <i>lpProgress</i>, the message store provider displays a progress indicator using the MAPI progress object implementation. The <i>lpProgress</i> parameter is ignored unless the MESSAGE_DIALOG flag is set in <i>ulFlags</i>.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the messages are deleted. The following flag can be set:
<dl>
<dt>
MESSAGE_DIALOG</dt>
<dd>
Displays a progress indicator as the operation proceeds.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The specified message or messages were successfully deleted.</dd>
<dt>
MAPI_W_PARTIAL_COMPLETION</dt>
<dd>
The call succeeded, but not all of the messages were successfully deleted. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIFolder::DeleteMessages</b> method deletes messages from a folder. Messages that do not exist, that have been moved elsewhere, that are open with read/write access, or that are currently submitted cannot be deleted. </p>
<h4>Notes to Implementers</h4>
<p>
When the delete operation involves more than one message, perform the operation as completely as possible for each folder, even if one or more of the messages cannot be deleted. Do not stop the operation prematurely unless a failure occurs that is beyond your control, such as running out of memory, running out of disk space, or corruption in the message store.</p>
<p>
During a <b>DeleteMessages</b> call, messages being processed by the MAPI spooler are not deleted; they are left in their parent folders. Do not call the <a href="inter031_5gac.htm"><b>IMsgStore::AbortSubmit</b></a> method for these messages. </p>
<h4>Notes to Callers</h4>
<p>
Expect these return values under the following conditions:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Condition</th>
<th align=left width=52%>Return value</th>
</tr>
<tr valign=top>
<td width=48%><b>DeleteMessages</b> has successfully deleted every message.</td>
<td width=52%>S_OK</td>
</tr>
<tr valign=top>
<td width=48%><b>DeleteMessages</b> was unable to successfully delete every message and subfolder.</td>
<td width=52%>MAPI_W_PARTIAL_COMPLETION or MAPI_E_NOT_FOUND</td>
</tr>
<tr valign=top>
<td width=48%><b>DeleteMessages</b> was unable to complete.</td>
<td width=52%>Any error value except MAPI_E_NOT_FOUND</td>
</tr>
</table><br>
<p>
When <b>DeleteMessages</b> is unable to complete, do not assume that no work was done. <b>DeleteMessages</b> might have been able to delete one or more of the messages before encountering the error. </p>
<p>
<b>DeleteMessages</b> returns MAPI_W_PARTIAL_COMPLETION or MAPI_E_NOT_FOUND, depending on the message store's implementation. </p>
<p>&nbsp;</p></body>
</HTML>
