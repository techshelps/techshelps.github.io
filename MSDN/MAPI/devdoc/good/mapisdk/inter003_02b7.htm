<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IABContainer::CopyEntries</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iabcontainer_copyentries"></a>IABContainer::CopyEntries</h2>
<p>
The <b>IABContainer::CopyEntries</b> method copies one or more entries, typically messaging users or distribution lists.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter003_4gxe.htm"><b>IABContainer : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT CopyEntries(
  LPENTRYLIST</b><i> lpEntries</i><b>,</b>   
<b>  ULONG</b><i> ulUIParam</i><b>,</b>         
<b>  LPMAPIPROGRESS</b><i> lpProgress</i><b>,</b>   
<b>  ULONG</b><i> ulFlags            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpEntries</i></dt>
<dd>
[in] Pointer to an array of <a href="structyp_8o1g.htm"><b>ENTRYLIST</b></a> structures containing the entry identifiers of the entries to copy.</dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for any dialog boxes or windows this method displays. The <i>ulUIParam</i> parameter must be zero if the AB_NO_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>lpProgress</i></dt>
<dd>
[in] Pointer to a progress object for displaying a progress indicator or NULL. If <i>lpProgress</i> is NULL, a progress indicator should be displayed using the progress object supplied by MAPI through the <b>IMAPISupport::DoProgressDialog</b> method. The <i>lpProgress</i> parameter is ignored if AB_NO_DIALOG is set in <i>ulFlags</i>.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the copy operation is performed. The following flags can be set:
<dl>
<dt>
AB_NO_DIALOG</dt>
<dd>
Suppresses display of a progress indicator. If this flag is not set, a progress indicator is displayed.</dd>
<dt>
CREATE_CHECK_DUP_LOOSE</dt>
<dd>
Suggests that a loose level of duplicate entry checking should be performed. The implementation of loose duplicate entry checking is provider-specific. For example, a provider can define a loose match as any two entries having the same display name.</dd>
<dt>
CREATE_CHECK_DUP_STRICT</dt>
<dd>
Suggests that a strict level of duplicate entry checking should be performed. The implementation of strict duplicate entry checking is provider-specific. For example, a provider can define a strict match as any two entries having both the same display name and messaging address.</dd>
<dt>
CREATE_REPLACE</dt>
<dd>
A new entry should replace an existing one if it is determined that the two are duplicates.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The copy operation succeeded.</dd>
<dt>
MAPI_W_PARTIAL_COMPLETION</dt>
<dd>
The copy operation succeeded overall, but one or more of the recipients could not be copied. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IABContainer::CopyEntries</b> method copies recipients from the same container or a different container. A call to <b>CopyEntries</b> is functionally equivalent to making the following three calls for each recipient to be copied:
<ol>
<li>
<a href="inter003_8b21.htm"><b>IABContainer::CreateEntry</b></a> to create the new recipient.</li>
<li>
The new recipient's <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method to perform a save.</li>
<li>
The new recipient's <b>IUnknown::Release </b>method to release the container's reference. </li>
</ol>
<p>
The personal address book (PAB) supplied by MAPI does not support the CREATE_REPLACE flag. For duplicate entry checking, the PAB defines "loose" to mean that two entries are duplicates if their original display names are equal and "strict" to mean that two entries are duplicates if both their original display names and search keys are equal. In the PAB, the original display name is defined as the transmittable display name, if available. Otherwise, it is simply the display name. Combined with the <a href="propb_960p.htm">PR_SEARCH_KEY</a> property, these criteria usually eliminate duplicates in most applications whether automated or user driven. </p>
<h4>Notes to Implementers</h4>
<p>
All containers that support <b>IABContainer::CopyEntries</b> must be modifiable. Set your container's AB_MODIFIABLE flag in its <a href="propa_3m7n.htm">PR_CONTAINER_FLAGS</a> property to indicate that it is modifiable. </p>
<p>
You must support all of the <i>ulFlags</i> flags; however, the interpretation and use of these flags is implementation-specific. That is, you can determine what the semantics of CREATE_CHECK_DUP_LOOSE and CREATE_CHECK_DUP_STRICT mean within the context of your implementation. If you cannot or do not determine whether an entry is a duplicate, always allow the entry to be copied. </p>
<p>
If CREATE_REPLACE is set, always copy the entry regardless of whether CREATE_CHECK_DUP_LOOSE or CREATE_CHECK_DUP_STRICT is set and whether or not the entry is a duplicate. </p>
<p>
If CREATE_REPLACE is not set and CREATE_CHECK_DUP_STRICT is set, check for duplicates. If any entries are determined to be duplicates, do not copy the entry. </p>
<p>
You do not need to support the CREATE_REPLACE flag; not supporting CREATE_REPLACE means that you can ignore it and always perform a copy. </p>
<p>
Return the warning MAPI_W_PARTIAL_COMPLETION only if a nonduplicate entry cannot be copied. </p>
<h4>Notes to Callers</h4>
<p>
Use the CREATE_CHECK_DUP_LOOSE and CREATE_CHECK_DUP_STRICT flags to suggest to the provider how you would like the container to perform duplicate entry checking. If you need to have an entry added regardless of whether or not it is a duplicate, either do not set either of these flags or set the CREATE_REPLACE flag. CREATE_REPLACE indicates that you do not care if an entry is a duplication; you always want it to replace the original entry. </p>
<h4>See Also</h4>
<p>
<a href="structyp_8o1g.htm"><b>ENTRYLIST</b></a>,<b> <a href="inter003_8b21.htm">IABContainer::CreateEntry</a></b>,<b> <a href="inter021_7icu.htm">IMAPIProgress : IUnknown</a></b>, <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a></p>
<p>&nbsp;</p></body>
</HTML>
