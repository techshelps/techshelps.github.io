<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Converting to Active Messaging Library Identifiers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_converting_to_active_messaging_library_identifiers"></a>Converting to Active Messaging Library Identifiers</h2>
<p>
Some clients use multiple client interfaces to take advantage of what more than one client API has to offer. Typically, these clients use MAPI for some tasks and a simpler API such as the Active Messaging Library for other tasks. If you take advantage of both the MAPI and the Active Messaging Library client interfaces, you will need to convert between the two types of identifiers that are used for opening objects. Whereas MAPI objects are accessed with binary entry identifiers, Active Messaging Library objects are accessed with hexadecimal message identifiers.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To convert a MAPI entry identifier to an Active Messaging Library message identifier</h5>
<ol>
<li>
Call the message's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method to retrieve its <a href="propa_8cv8.htm">PR_ENTRYID</a> property. </li>
<li>
Call <a href="function_9k4u.htm"><b>HexFromBin</b></a> to convert the entry identifier to a hexadecimal string or use client code to perform the conversion. </li>
<li>
Call the Win32 function <b>SysAllocString</b>, if necessary, to make the string compatible with Visual Basic. </li>
<li>
Make the hexadecimal string available to the Visual Basic application. </li>
<li>
Use the <b>Session.GetMessage</b> method in the Active Messaging Library to open the message. </li>
</ol>
<p>
To reverse the process — converting an Active Messaging Library message identifier to a MAPI entry identifier — call <a href="function_2mgo.htm"><b>FBinFromHex</b></a>. <b>FBinFromHex</b> converts a hexadecimal string to binary data.</p>
<p>&nbsp;</p></body>
</HTML>
