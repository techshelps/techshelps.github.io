<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISession::ShowForm</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisession_showform"></a>IMAPISession::ShowForm</h2>
<p>
The <b>IMAPISession::ShowForm</b> method displays a form.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter023_64ry.htm"><b>IMAPISession : IUnknown</b></a>.</p>
<pre><code><b>HRESULT ShowForm(
  ULONG</b><i> ulUIParam</i><b>,</b>           
<b>  LPMDB</b><i> lpMsgStore</i><b>,</b>          
<b>  LPMAPIFOLDER</b><i> lpParentFolder</i><b>,</b>   
<b>  LPCIID</b><i> lpInterface</i><b>,</b>        
<b>  ULONG</b><i> ulMessageToken</i><b>,</b>      
<b>  LPMESSAGE</b><i> lpMessageSent</i><b>,</b>   
<b>  ULONG</b><i> ulFlags</i><b>,</b>             
<b>  ULONG</b><i> ulMessageStatus</i><b>,</b>     
<b>  ULONG</b><i> ulMessageFlags</i><b>,</b>      
<b>  ULONG</b><i> ulAccess</i><b>,</b>            
<b>  LPSTR</b><i> lpszMessageClass     </i>
<b>);</b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>ulUIParam </i></dt>
<dd>
[in] Handle of the parent window for the form. The <i>ulUIParam</i> parameter must not be NULL if the form has been created using Microsoft® Electronic Forms Designer. The <i>ulUIParam</i> parameter can be NULL if the form has been created using C or C++. </dd>
<dt>
<i>lpMsgStore </i></dt>
<dd>
[in] Pointer to the message store containing the folder pointed to by the <i>lpParentFolder</i> parameter. </dd>
<dt>
<i>lpParentFolder </i></dt>
<dd>
[in] Pointer to the folder in which the message associated with the <i>ulMessageToken</i> parameter was created. </dd>
<dt>
<i>lpInterface </i></dt>
<dd>
[in] Pointer to the interface identifier (IID) representing the interface to be used to access the message being displayed in the form. The <i>lpInterface</i> parameter must be NULL or IID_IMessage. Passing NULL results in the standard interface, or <b>IMessage</b>, being used. </dd>
<dt>
<i>ulMessageToken </i></dt>
<dd>
[in] Token associated with the message to be displayed in the form. The <i>ulMessageToken</i> parameter must be set to the contents of the <i>lpulMessageToken</i> parameter from the preceding call to <a href="inter023_2vzh.htm"><b>IMAPISession::PrepareForm</b></a>.</dd>
<dt>
<i>lpMessageSent </i></dt>
<dd>
Reserved; must be NULL. </dd>
<dt>
<i>ulFlags </i></dt>
<dd>
[in] Bitmask of flags that controls how and whether the message is saved. The following flags can be set: 
<dl>
<dt>
MAPI_NEW_MESSAGE </dt>
<dd>
The message has never been saved — that is, its <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method has never been called. </dd>
<dt>
MAPI_POST_MESSAGE </dt>
<dd>
The message should be saved to its parent folder. The message is not processed for sending but posted to the folder instead. If this flag is not set, the message is copied to the Outbox and processed for sending. </dd>
</dl>
</dd>
<dt>
<i>ulMessageStatus </i></dt>
<dd>
[in] Bitmask of flags copied from the <a href="propb_3c1f.htm">PR_MSG_STATUS</a> property of the message associated with the token in the <i>ulMessageToken</i> parameter. The flags provide information on the state of the message. </dd>
<dt>
<i>ulMessageFlags </i></dt>
<dd>
[in] Bitmask of flags copied from the <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property of the message associated with the token in the <i>ulMessageToken</i> parameter. These flags provide further information on the state of the message. </dd>
<dt>
<i>ulAccess </i></dt>
<dd>
[in] Flag indicating the access level for the message being displayed in the form. This information is copied from the <a href="propa_63eb.htm">PR_ACCESS</a> property of the message associated with the token in the <i>ulMessageToken</i> parameter.  </dd>
<dt>
<i>lpszMessageClass </i></dt>
<dd>
[in] Pointer to the message class of the message being displayed in the form, copied from the <a href="propa_0ecz.htm">PR_MESSAGE_CLASS</a> property of the message associated with the token in the <i>ulMessageToken</i> parameter. 
</dd>
</dl>
<h4>Return Values </h4>
<dl>
<dt>
S_OK </dt>
<dd>
The form was successfully displayed.</dd>
<dt>
MAPI_E_USER_CANCEL </dt>
<dd>
The user canceled the operation, typically by clicking the <b>Cancel</b> button in a dialog box. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The <b>IMAPISession::ShowForm</b> method displays a message form that has been prepared by the <a href="inter023_2vzh.htm"><b>IMAPISession::PrepareForm</b></a> method. </p>
<h4>Notes to Callers</h4>
<p>
You should only have a single reference to the message passed in the <b>PrepareForm</b> method's <i>lpMessage</i> parameter. </p>
<p>
Be aware that form implementations can return error values other than the ones documented by MAPI. If you are able to use these error values to make a more accurate determination of the error condition, do so. Otherwise, handle these errors in the same manner as you would handle MAPI_E_CALL_FAILED. </p>
<p>&nbsp;</p></body>
</HTML>
