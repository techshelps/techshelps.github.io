<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Verifying Service Provider Configuration</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_verifying_service_provider_configuration"></a>Verifying Service Provider Configuration</h3>
<p>
Your logon method, either <b>IABProvider::Logon</b>, <b>IMSProvider::Logon</b>, or <b>IXPProvider::TransportLogon</b>, must verify your provider's configuration. This involves checking that all of the properties needed for full operation are set and set correctly. Every provider requires a different number of properties; configuration depends on your provider and the degree of user interaction you allow. Some service providers keep all of the necessary properties in the profile. Other service providers keep a partial set of properties in the profile and prompt the user for missing values. Still other providers do not store properties in the profile at all, relying on the user to supply all of the information needed for configuration.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To retrieve properties stored in the profile</h5>
<ol>
<li>
Call <a href="inter025_6rvy.htm"><b>IMAPISupport::OpenProfileSection</b></a>, passing the <b>MAPIUID</b> of your provider as an input parameter.<ol>
<li>
Call the profile section's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> or <a href="inter022_79v8.htm"><b>GetPropList</b></a> methods to retrieve individual properties or a property list.</li>
</ol>
</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set properties from user information</h5>
<p class=indent1>
Display a property sheet, if MAPI has not set a flag prohibiting the display. The following flags indicate that a user interface cannot be presented.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Flag</th>
<th align=left width=52%>Service provider</th>
</tr>
<tr valign=top>
<td width=48%>AB_NO_DIALOG</td>
<td width=52%>Address book provider</td>
</tr>
<tr valign=top>
<td width=48%>LOGON_NO_DIALOG</td>
<td width=52%>Transport provider</td>
</tr>
<tr valign=top>
<td width=48%>MDB_NO_DIALOG</td>
<td width=52%>Message store provider</td>
</tr>
</table><br>
<p>
If your provider does not store all of its configuration properties in the profile, requiring user interaction, and MAPI passes one of the dialog box suppression flags to your logon method, return MAPI_E_UNCONFIGURED. Also return this error when the dialog suppression flag is not set, but the user does not supply all of the required information.</p>
<p>
When your service provider fails its logon method with MAPI_E_UNCONFIGURED, MAPI calls your entry point function again. If the information cannot be located with the second call, depending on how important your service provider is, the session might terminate.  </p>
<p>
The following illustration shows the logic required for configuration in your service provider logon method. </p>
<p>
<img src="images/amapi_62.gif" border=0></p>
<p>&nbsp;</p></body>
</HTML>
