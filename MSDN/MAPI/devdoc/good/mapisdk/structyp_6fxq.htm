<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SPropertyRestriction</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_spropertyrestriction"></a>SPropertyRestriction</h2>
<p>
The <b>SPropertyRestriction</b> structure describes a property restriction which is used to match a constant with the value of a property.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file:</td>
<td width=52%>MAPIDEFS.H</td>
</tr>
</table><br>
<pre><code>typedef struct _SPropertyRestriction 
{ 
     ULONG        relop; 
     ULONG        ulPropTag; 
     LPSPropValue lpProp; 
} SPropertyRestriction; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>relop</b></dt>
<dd>
Relational operator to be used in the search. Possible values are:
<dl>
<dt>
RELOP_GE</dt>
<dd>
The comparison is made based on a greater or equal first value.</dd>
<dt>
RELOP_GT</dt>
<dd>
The comparison is made based on a greater first value.</dd>
<dt>
RELOP_LE</dt>
<dd>
The comparison is made based on a lesser or equal first value.</dd>
<dt>
RELOP_LT</dt>
<dd>
The comparison is made based on a lesser first value.</dd>
<dt>
RELOP_NE</dt>
<dd>
The comparison is made based on unequal values.</dd>
<dt>
RELOP_RE</dt>
<dd>
The comparison is made based on LIKE (regular expression) values.</dd>
<dt>
RELOP_EQ</dt>
<dd>
The comparison is made based on equal values.</dd>
</dl>
</dd>
<dt>
<b>ulPropTag</b></dt>
<dd>
Property tag identifying the property to be compared. </dd>
<dt>
<b>lpProp</b></dt>
<dd>
Pointer to an <a href="structyp_9sbp.htm"><b>SPropValue</b></a> structure containing the constant value to be used in the comparison.
</dd>
</dl>
<h4>Remarks</h4>
<p>
There are two property tags in an <b>SPropertyRestriction</b> structure: one in the <b>ulPropTag</b> member and the other in the <b>ulPropTag</b> member of the <b>SPropValue</b> structure pointed to by <b>lpProp</b>. In both tags, MAPI requires only the property type field and ignores the property identifier field. However, the two property types must match, or else the error value MAPI_E_TOO_COMPLEX is returned when the restriction is used in a call to <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a> or <a href="inter026_2lkn.htm"><b>IMAPITable::FindRow</b></a>.  </p>
<p>
The comparison order is <i>(property value) (relational operator) (constant value)</i>.</p>
<p>
When a property restriction is passed to <b>IMAPITable::Restrict</b> or <b>IMAPITable::FindRow </b>and the target property does not exist, the results of the restriction are undefined. By creating an <b>AND</b> restriction that joins the property restriction with an exist restriction, a caller can be guaranteed accurate results. Use an <a href="structyp_7qy6.htm"><b>SExistRestriction</b></a> structure to define the exist restriction and an <a href="structyp_0v1q.htm"><b>SAndRestriction</b></a> structure to define the <b>AND</b> restriction.</p>
<p>
Multivalued properties can be used in property restrictions if the service provider implementing the table supports them. If supported, multivalued property tags can be used anywhere single-valued property tags can be used. They can be used in <a href="inter022_6cxf.htm"><b>IMAPIProp::SetProps</b></a>, <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a>, <a href="inter026_7x83.htm"><b>IMAPITable::SetColumns</b></a>, <a href="inter026_3gmd.htm"><b>IMAPITable::SortTable</b></a>, and <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a>. </p>
<p>
For more information on the <b>SPropertyRestriction</b> structure, see <a href="tables_0qyb.htm">About Restrictions</a>.  </p>
<h4>See Also</h4>
<p>
<a href="groups_3dpv.htm">Restriction Structures</a>, <a href="structyp_9sbp.htm"><b>SPropValue</b></a>,<b> <a href="structyp_45ny.htm">SRestriction</a></b></p>
<p>&nbsp;</p></body>
</HTML>
