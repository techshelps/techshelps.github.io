<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Managing Memory</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_managing_memory"></a>Managing Memory</h1>
<p>
Knowing how and when to allocate and free memory is an important part of programming with MAPI. MAPI provides both functions and macros that your client or service provider can use to manage memory in a consistent way. The three functions are:</p>
<p class=indent1>
<a href="function_8z3m.htm"><b>MAPIAllocateBuffer</b></a></p>
<p class=indent1>
<a href="function_11wl.htm"><b>MAPIAllocateMore</b></a></p>
<p class=indent1>
<a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a></p>
<p>
When clients and service providers use these functions, the issue of who "owns" — that is,<i> </i>knows how to release — a particular block of memory is eliminated. A client calling a service provider method need not pass a buffer large enough to hold a return value of any size. The service provider can simply allocate the appropriate amount of memory using <b>MAPIAllocateBuffer</b> and, if necessary, <b>MAPIAllocateMore</b>, and the client can later release it at will using <b>MAPIFreeBuffer</b>, independent of the service provider. For more information about these functions, see <a href="groups_1bhv.htm">Memory Management Functions</a>.</p>
<p>
The memory macros are used to allocate structures or arrays of structures of a specific size. Clients and service providers should use these macros rather than allocate the memory manually. For example, if a client needs to perform name resolution processing on a recipient list with three entries, the <b>SizedADRLIST</b> macro can be used to create an <b>ADRLIST</b> structure to pass to <b>IAddrBook::ResolveName</b> with the correct number of <b>ADRENTRY</b> members. All of the memory macros are defined in the MAPIDEFS.H header file. These macros are:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="structyp_9uwk.htm"><b>SizedADRLIST</b></a></td>
<td width=52%><a href="structyp_5291.htm"><b>SizedDtblPage</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="structyp_6aem.htm"><b>SizedDtblButton</b></a></td>
<td width=52%><a href="structyp_1spw.htm"><b>SizedENTRYID</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="structyp_41x4.htm"><b>SizedDtblCheckBox</b></a></td>
<td width=52%><a href="structyp_9d89.htm"><b>SizedSPropProblemArray</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="structyp_76t4.htm"><b>SizedDtblComboBox</b></a></td>
<td width=52%><a href="structyp_5yrd.htm"><b>SizedSPropTagArray</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="structyp_3ius.htm"><b>SizedDtblEdit</b></a></td>
<td width=52%><a href="structyp_3qgk.htm"><b>SizedSRowSet</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="structyp_4i0o.htm"><b>SizedDtblGroupBox</b></a></td>
<td width=52%><a href="structyp_1tbo.htm"><b>SizedSSortOrderSet</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="structyp_56ss.htm"><b>SizedDtblLabel</b></a></td>
<td width=52%></td>
</tr>
</table><br>
<p>
MAPI also supports the use of the OLE interface <b>IMalloc</b> for memory management. Service providers are given an <b>IMalloc</b> interface pointer by MAPI at initialization time and can also retrieve one through the <a href="function_6roj.htm"><b>MAPIGetDefaultMalloc</b></a> function. The main advantage to using the <b>IMalloc</b> methods for managing memory over the MAPI functions is that with the OLE methods it is possible to reallocate an existing buffer. The MAPI memory functions do not support reallocation.</p>
<p>&nbsp;</p></body>
</HTML>
