<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Facsimile (FAX, MSFAX)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_facsimile_fax_msfax_"></a>Facsimile (FAX, MSFAX)</h1>
<p>
Support is required for custom recipient addresses in the following format:</p>
<p>
<b>[FAX:</b><i>Dialable</i> | <i>Name</i> @ <i>Canonical</i> | <i>SpecialDialing</i>]
<dl>
<dt>
<i>Dialable</i></dt>
<dd>
A dialable fax phone number that consists of any of the following characters: 0-9, ( ), -, space. Examples are 64545 and 9, 1-206-8828080.</dd>
<dt>
<i>Name</i></dt>
<dd>
Optional field used for inbound routing by Microsoft At Work Fax. MAPI providers that do not support Microsoft At Work Fax should simply ignore this field. The name field is interpreted by the receiving machine and can contain any information which helps route the fax to its intended recipient. For example, this field might be a recipient's e-mail name. This field can include the at sign character (@).</dd>
<dt>
<i>Canonical</i></dt>
<dd>
Must be a canonical fax phone number. If a canonical fax phone number is included in the address, and the provider can process canonical numbers, the provider should always use the canonical number instead of the dialable phone number.</dd>
<dt>
|</dt>
<dd>
Separator character, ASCII Hex 0x7C. The separator between the subscriber number and special dialing instructions (such as a postfix or TIA/EIA/IS-141 subaddress) is optional. If the phone number is in canonical form and a separator is not present, then the special dialing instructions are assumed to begin with the first character in the local number which is not one of the following: the numerals 0-9, hyphen (-), space.</dd>
<dt>
<i>SpecialDialing</i></dt>
<dd>
Must be a postfix, TIA/EIA/IS-141 subaddress or ISDN subaddress. MAPI 1.0 providers can optionally support these special dialing extensions.
</dd>
</dl>
<p>
Examples of this address type are:</p>
<pre><code>[FAX:936-7329]
[FAX:1-206-9367329]
[FAX:936-7329 | +1 (206) 936-7329]
[FAX:936-7329 | tedst@ +1 (206) 936-7329]
[FAX:936-7329 | tedst@+1 (206) 936-7329]
[FAX:936-7329 | +1 (206) 9367329|#546]
[FAX:936-7329 | +1 (206) 9364344|,,,,,567]
 </code></pre>
<p>
<b>Note</b>  Some service providers create 'MSFAX' formatted addresses but with the 'FAX' address type. Providers can either handle these addresses, or not accept responsibility for them as they see fit; either method is acceptable.</p>
<p>
Support is optional (but recommended) for custom recipient addresses in the following format:</p>
<p>
<b>[MSFAX:</b><i>Name@</i> <i>PhoneNumber</i> | <i>SpecialDialing</i><b>]</b>
<dl>
<dt>
<i>Name</i></dt>
<dd>
Optional field used for inbound routing by Microsoft At Work Fax. MAPI providers that do not support Microsoft At Work Fax should simply ignore this field. The name field is interpreted by the receiving machine and can contain any information which helps route the fax to its intended recipient. For example, this field might be a recipient's e-mail name. This field can include the at sign character (@).</dd>
<dt>
<i>PhoneNumber</i></dt>
<dd>
Must be a canonical phone number or dialable phone number.</dd>
<dt>
|</dt>
<dd>
Separator character, ASCII Hex 7c. This is the separator between the subscriber number and special dialing instructions (such as a postfix or TIA/EIA/IS-141 subaddress). This separator is optional. If the phone number is in canonical form and a separator is not present, then the special dialing instructions are assumed to begin with the first character in the local number which is not one of the following: the numerals 0-9, hyphen (-), period (.), and space.</dd>
<dt>
<i>DialablePhoneNumber</i></dt>
<dd>
A dialable address is a phone number that consists of any of the following characters: the numerals 0-9, letters A-D, asterisk (*), pound (#), comma (,), exclamation mark (!), uppercase and lowercase w (W, w), uppercase and lowercase p (P, p), uppercase and lowercase t (T, t), at sign (@), dollar sign ($), question mark (?), hyphen (-), period (.), and space. For example 64545. Dialable addresses are intended to be used to represent internal phone extensions.</dd>
<dt>
<i>SpecialDialing</i></dt>
<dd>
Must be a postfix, TIA/EIA/IS-141 subaddress or ISDN subaddress. MAPI 1.0 providers can optionally support these special dialing extensions.
</dd>
</dl>
<p>
Examples of this address type are:</p>
<pre><code>[MSFAX: 936-7329]
[MSFAX: +1 (206) 936-7329]
[MSFAX: tedst@+1 (206) 936-7329]
[MSFAX: +1 (206) 9367329|#546]
[MSFAX: +1 (206) 9364344|,,,,,567]
 </code></pre>
<p>
The following table includes descriptions of the components of this address:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Component</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>canonical phone number</td>
<td width=52%>A phone number in the form: <b>+</b><i>CountryCode</i> space (<i>AreaCode</i>) space <i>LocalNumber</i>. Examples are +1 (206) 936-4479 and +43 443444. <i>CountryCode</i> and <i>AreaCode</i> can only contain the numerals 0 through 9. If the area code is present it must be preceded by exactly one ASCII left parenthesis character (0x28), and be followed by exactly one ASCII right parenthesis character (0x29) and one ASCII space character (0x20). The local number must contain one or more of the numerals 0 through 9 but must not include any of the following characters:<p>
AaBbCcDdPpTtWw*#!,@$?;()|^ <b>CRLF</b></p>
</td>
</tr>
<tr valign=top>
<td width=48%>special dialing</td>
<td width=52%>Must be a postfix, TIA/EIA/IS-141 subaddress or ISDN subaddress. MAPI 1.0 providers can optionally support these special dialing extensions.</td>
</tr>
<tr valign=top>
<td width=48%>postfix</td>
<td width=52%>A string of dialing control characters and digits used to complete calls which require DTMF routing, manual dialing, or pauses in the dialing sequence. The string must begin with one of the following characters: $ , ? W w @ and can contain any of the following characters: 0-9 A-D * # , ! W w P p T t @ $ ?. An example is +1 (206) 9367329|,,,,,567. This waits for several seconds after the main number is dialed before entering the DTMF tones 567.</td>
</tr>
<tr valign=top>
<td width=48%>TIA/EIA/IS-141 subaddress</td>
<td width=52%>Used for inbound routing according to the U.S. standard TIA/EIA/IS-141. MAPI 1.0 providers that cannot transmit this subaddress information should remove this field before dialing. This field must begin with the number sign (#). In typical use, this value uniquely identifies a recipient. An example is +1 (206) 9367329|#543. This example enables inbound routing to employee 543</td>
</tr>
<tr valign=top>
<td width=48%>ISDN Subaddress</td>
<td width=52%>For faxing over ISDN. MAPI 1.0 providers that cannot transmit ISDN subaddresses should remove this field before dialing. An ISDN subaddress can begin with any character except the following: # $ , ? W w @</td>
</tr>
<tr valign=top>
<td width=48%>$</td>
<td width=52%>Wait for "billing signal", such as a credit card prompt tone.</td>
</tr>
<tr valign=top>
<td width=48%>,</td>
<td width=52%>Indicates that dialing is to be paused. The duration of a pause is device specific.</td>
</tr>
<tr valign=top>
<td width=48%>?</td>
<td width=52%>Indicates that the user is to be prompted before continuing with dialing.</td>
</tr>
<tr valign=top>
<td width=48%>W w</td>
<td width=52%>Dialing should proceed only after a dialing tone has been detected.</td>
</tr>
<tr valign=top>
<td width=48%>@</td>
<td width=52%>Indicates that dialing is to "wait for quiet answer" before dialing the remainder of the number. This means to wait for at least one ringback tone followed by several seconds of silence.</td>
</tr>
<tr valign=top>
<td width=48%>P p</td>
<td width=52%>Indicates that pulse dialing is to be used for the digits following it.</td>
</tr>
<tr valign=top>
<td width=48%>T t</td>
<td width=52%>Indicates that tone (DTMF) dialing is to be used for the digits following it.</td>
</tr>
</table><br>
<p>
<b>Note</b>  Microsoft supports two FAX address formats. FAX is intended to be used for compatibility with downlevel systems — including the Microsoft Mail for PC Networks FAX gateway. Although it is optional, all transport writers are encouraged to support and use the MSFAX standard. The 'FAX' standard will likely be eliminated in favor of the 'MSFAX' standard in a future release.</p>
<p>
For more information on dialable and canonical addresses, see the Win32 Telephony (TAPI) documentation.</p>
<p>&nbsp;</p></body>
</HTML>
