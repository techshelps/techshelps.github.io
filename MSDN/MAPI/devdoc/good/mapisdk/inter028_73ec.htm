<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIViewContext::ActivateNext</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapiviewcontext_activatenext"></a>IMAPIViewContext::ActivateNext</h2>
<p>
The <b>IMAPIViewContext::ActivateNext</b> method activates the next or previous message in the view order. </p>
<h4>Quick Info </h4>
<p>
See <a href="inter028_4zla.htm"><b>IMAPIViewContext : IUnknown</b></a>. </p>
<pre><code><b>HRESULT ActivateNext(
  ULONG</b><i> ulDir</i><b>,</b>        
<b>  LPCRECT</b><i> prcPosRect  </i>
<b>);</b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>ulDir </i></dt>
<dd>
[in] Status flags giving information about the message to be activated. Valid flag settings are: 
<dl>
<dt>
VCDIR_CATEGORY </dt>
<dd>
The viewer should activate a message in another category of the view. The message to be activated is: 
<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;The first message in the next view category if this flag is <b>OR</b>ed with VCDIR_NEXT. </td>
</tr>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;The last message in the previous view category if this flag is <b>OR</b>ed with VCDIR_PREV and the previous category is expanded. </td>
</tr>
<tr valign=top>
<td width=100%><font face="Symbol">·</font>&nbsp;&nbsp;&nbsp;&nbsp;The first message in the previous view category if this flag is <b>OR</b>ed with VCDIR_PREV and the previous category is not expanded. In this case the previous category undergoes automatic expansion. </td>
</tr>
</table>
</dd>
<dt>
VCDIR_DELETE </dt>
<dd>
The viewer should activate the next or previous message because the current message has been deleted. </dd>
<dt>
VCDIR_MOVE </dt>
<dd>
The viewer should activate the next or previous message because the current message has been moved. </dd>
<dt>
VCDIR_NEXT </dt>
<dd>
The viewer should activate the next message in the view order. </dd>
<dt>
VCDIR_PREV </dt>
<dd>
The viewer should activate the previous message in the view order. </dd>
<dt>
VCDIR_UNREAD </dt>
<dd>
The viewer should activate the next or previous unread message in the view order. </dd>
</dl>
</dd>
<dt>
<i>prcPosRect </i></dt>
<dd>
[in] Pointer to a Windows <b>RECT</b> structure containing the size and position of the window to be used to display the activated message. 
</dd>
</dl>
<h4>Return Values </h4>
<dl>
<dt>
S_OK </dt>
<dd>
The message was activated successfully. </dd>
<dt>
S_FALSE </dt>
<dd>
The message was activated successfully, but a different type of form was opened in the process. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
Form objects call the <b>IMAPIViewContext::ActivateNext</b><i> </i>method to change what message is displayed to the user. The value passed in the <i>ulDir</i> parameter indicates which message should be activated and, in some cases, why. The VCDIR_NEXT and VCDIR_PREVIOUS flags correspond to users choosing the <b>Next</b> or <b>Previous</b> command in a view, respectively. These operations usually correspond to moving up or down one message in the form viewer's list of messages. </p>
<p>
The VCDIR_DELETE and VCDIR_MOVE flags are set by the <a href="inter020_1dt1.htm"><b>IMAPIMessageSite::DeleteMessage</b></a> and <a href="inter020_8qat.htm"><b>IMAPIMessageSite::MoveMessage</b></a><b> </b>methods, respectively. Implementations of these methods call <b>ActivateNext</b> with the appropriate direction and then perform the requested operation on the message if the <b>ActivateNext</b> call did not fail. Form viewers typically enable users to specify the direction to move in the message list.</p>
<h4>Notes to Implementers</h4>
<p>
Your implementation of <a href="#_mapi1book_imapiviewcontext_activatenext"><b>IMAPIViewContext::ActivateNext</b></a> makes the next or previous message in the folder, depending on the value of <i>ulDir</i>, the current message. After <b>ActivateNext</b> returns, call <a href="inter020_5vz9.htm"><b>IMAPIMessageSite::GetMessage</b></a> to get a pointer to the newly activated message.</p>
<h4>Notes to Callers</h4>
<p>
If <b>ActivateNext</b> returns S_FALSE, or if a current message is not present, perform your normal shutdown procedure which should include calling your form's <a href="inter014_79wt.htm"><b>IMAPIForm::ShutdownForm</b></a> method. If a next or previous message is displayed, use the window rectangle passed in the <i>prcPosRect</i> parameter to display it.</p>
<h4>See Also</h4>
<p>
<a href="inter028_916b.htm"><b>IMAPIViewContext::GetViewStatus</b></a></p>
<p>&nbsp;</p></body>
</HTML>
