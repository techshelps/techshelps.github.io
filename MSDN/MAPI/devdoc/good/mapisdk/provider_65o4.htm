<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing a Property Sheet</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_implementing_a_property_sheet"></a>Implementing a Property Sheet</h1>
<p>
A property sheet is a dialog box for displaying the properties of an object. The properties can be read-only, enabling the user only to view them, or read/write, enabling the user to make changes. A property sheet contains one or more overlapping child windows called pages, each page contains control windows for setting a group of related properties. Users navigate from page to page by selecting a tab that brings the corresponding page to the foreground of the property sheet.</p>
<p>
Service providers are required to implement a property sheet that displays a minimal set of properties related to configuration in the message service. If you allow these message service properties to be changed, you can either allow users of client applications such as the Control Panel applet to make the changes or implement the changes programmatically. Implementing property sheets to display and edit other types of properties is optional. </p>
<p>
Typically, you will need to display a property sheet:
<ul>
<li>
When a client calls your status object's <b>IMAPIStatus::SettingsDialog</b> method.</li>
<li>
When MAPI calls your provider object's logon method.</li>
<li>
When MAPI calls the entry point function for your provider's message service.</li>
</ul>
<p>
Transport providers also implement property sheets to display properties related to message options, and address book providers implement property sheets to view and edit detailed information about messaging users and distribution lists, advanced search criteria, and templates for entering new users.</p>
<p>
There are three techniques for creating a property sheet:
<ul>
<li>
Manually, as you would any dialog box.</li>
<li>
Using the property sheet common control provided in the Platform SDK.</li>
<li>
Using a MAPI display table.</li>
</ul>
<p>
MAPI recommends that providers choose the third option; create a property sheet using a display table. This is the simplest option because it eliminates the need to work with the Windows user interface. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To implement a property sheet built from a display table for your message service properties</h5>
<ol>
<li>
Call<b> <a href="inter025_6rvy.htm">IMAPISupport::OpenProfileSection</a></b> to open a section in the current profile. Pass your <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> or NULL to open your provider's profile section.</li>
<li>
Call <a href="function_8ldc.htm"><b>CreateIProp</b></a> to create a property data object. </li>
<li>
Call the profile section's <a href="inter022_83qn.htm"><b>IMAPIProp::CopyTo</b></a> method to copy all of the section's properties to the property data object. </li>
<li>
Create a display table either by building one or more <a href="structyp_7zxh.htm"><b>DTPAGE</b></a> structures that describe the controls to appear on the property sheet and calling the <a href="function_5wpx.htm"><b>BuildDisplayTable</b></a> function or by implementing custom code. </li>
<li>
Call <a href="inter025_9s1g.htm"><b>IMAPISupport::DoConfigPropSheet</b></a> to display a property sheet with the copied properties. Pass a pointer to the property data object as the <i>lpConfigData</i> parameter and a pointer to the display table as the <i>lpDisplayTable</i> parameter. If you want to override the default access mode for this property sheet, do not set the DT_EDITABLE flag for each control in the display table that represents a read-only property.</li>
<li>
When all of the changes have been made in the property sheet, call the property data object's <b>IMAPIProp::CopyTo</b> method to copy the changed properties back to the profile section. </li>
</ol>
<p>
For an overview of display tables, see <a href="tables_6rw3.htm">Display Tables</a>. </p>
<p>
For detailed information about display tables, see <a href="provider_155x.htm">Implementing a Display Table</a>. </p>
<p>
For information about implementing a control, see <a href="provider_3e0k.htm">Implementing a Control Object</a>.</p>
<p>
To retrieve the index of a control selected by a user in a display table list box, wait until the user clicks <b>OK</b> or <b>Apply Now</b>. At this point, the entry identifier of the selected item is written back to the <b>IMAPIProp</b> interface as the value of the property specified by the <b>ulPRSetProperty</b> member in the <a href="structyp_9svs.htm"><b>DTBLLBX</b></a> structure. </p>
<p>
If you need to be able to add or remove items from your list box, using a display table and <a href="inter025_9s1g.htm"><b>IMAPISupport::DoConfigPropsheet</b></a><b> </b>will not work. Instead, consider implementing a property sheet with the Win32 property sheet API contained in COMDLG32.DLL.</p>
<p>&nbsp;</p></body>
</HTML>
