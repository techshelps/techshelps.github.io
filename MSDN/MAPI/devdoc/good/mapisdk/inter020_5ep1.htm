<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIMessageSite::NewMessage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapimessagesite_newmessage"></a>IMAPIMessageSite::NewMessage</h2>
<p>
The <b>IMAPIMessageSite::NewMessage</b> method creates a new message.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter020_5elq.htm"><b>IMAPIMessageSite : IUnknown</b></a>.</p>
<pre><code><b>HRESULT NewMessage(
  ULONG</b><i> fComposeInFolder</i><b>,</b>                
<b>  LPMAPIFOLDER</b><i> pFolderFocus</i><b>,</b>             
<b>  LPPERSISTMESSAGE</b><i> pPersistMessage</i><b>,</b>      
<b>  LPMESSAGE FAR *</b><i> ppMessage</i><b>,</b>             
<b>  LPMAPIMESSAGESITE FAR *</b><i> ppMessageSite</i><b>,</b>   
<b>  LPMAPIVIEWCONTEXT FAR *</b><i> ppViewContext  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>fComposeInFolder</i></dt>
<dd>
[in] Variable indicating in which folder the message should be composed. If the variable is FALSE, the <i>pFolderFocus</i> parameter is ignored and the form viewer can compose the message in any folder. If the variable is TRUE and NULL is passed in <i>pFolderFocus</i>, the message is composed in the current folder. If the variable is TRUE and a non-null value is passed in <i>pFolderFocus</i>, the message is composed in the folder pointed to by <i>pFolderFocus</i>.</dd>
<dt>
<i>pFolderFocus</i></dt>
<dd>
[in] Pointer to the folder where the new message is created.</dd>
<dt>
<i>pPersistMessage</i></dt>
<dd>
[in] Pointer to the form object for the new form.</dd>
<dt>
<i>ppMessage</i></dt>
<dd>
[out] Pointer to a pointer to the new message.</dd>
<dt>
<i>ppMessageSite</i></dt>
<dd>
[out] Pointer to a pointer to a message site object for the new message.</dd>
<dt>
<i>ppViewContext</i></dt>
<dd>
[out] Pointer to a pointer to a view context appropriate for passing to a new form with the new message. If the form implements its own view context, NULL can be passed in the <i>ppViewContext</i> parameter.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Form objects call the <b>IMAPIMessageSite::NewMessage</b><i> </i>method to create a new message. The form uses <b>NewMessage</b> to get a new message and the associated message site from its view. It can then modify the new message.</p>
<p>
An associated view context can also be obtained by passing in a non-null value in the <i>ppViewContext</i> parameter. This view context can be used directly, or it can be aggregated and passed to the new message. If a complete implementation is required, NULL should be passed in <i>ppViewContext</i>.</p>
<p>
For a list of interfaces related to form servers, see <a href="formsarc_4r03.htm">MAPI Form Interfaces</a>.</p>
<h4>See Also</h4>
<p>
<a href="inter028_4zla.htm"><b>IMAPIViewContext : IUnknown</b></a></p>
<p>&nbsp;</p></body>
</HTML>
