<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Profile with NEWPROF</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_creating_a_profile_with_newprof"></a>Creating a Profile with NEWPROF</h3>
<p>
The NEWPROF utility is a tool that creates a profile without user interaction. All of the configuration settings are contained in a template file, a file that is expected to have the .PRF extension. MAPI provides a default .PRF file called DEFAULT.PRF that lists the services implemented by Microsoft and is divided into the following four sections, similar to the sections in a profile:
<ul>
<li>
Section 1 includes the <b>[General]</b> section.</li>
<li>
Section 2 includes the <b>[Service List]</b> section.</li>
<li>
Section 3 includes sections that describe individual message services.</li>
<li>
Section 4 includes sections that map to profile properties.</li>
</ul>
<p>
You can create a new .PRF file using portions of DEFAULT.PRF as a model or modify the DEFAULT.PRF file directly, adding portions that pertain to your profile and configuration. For each service you plan to use, copy the section that lists the name, type, and property identifier for each configuration property. The section must have the same name as the service. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a .PRF file</h5>
<ol>
<li>
Assemble information from existing .PRF files.</li>
<li>
Place the profile name in the ProfileName= line of the <b>[General]</b> section.</li>
<li>
Create the <b>[Service List]</b> section after the <b>[General]</b> section. In this section, list each message service that you require and the name of the section that contains its configuration properties. For information about ordering services in profiles, see <a href="extend_4fxv.htm">Profiles</a>. </li>
<li>
For each service listed in the <b>[Service List]</b> section, create an individual message section that lists the value for each configuration property. The section must have the same name as the service. See Section 3 in the DEFAULT.PRF file for an example. </li>
<li>
Invoke the NEWPROF utility. On 32-bit operating systems, NEWPROF can be run from a command line or batch file. On 16-bit Windows systems, NEWPROF cannot be run from an MS-DOS shell. Instead, run NEWPROF:<ul>
<li>
With a Windows-based setup script.</li>
<li>
With the <b>Run</b> command on the <b>File</b> menu in Program Manager or File Manager.</li>
<li>
With the <b>WinExec</b> system call. </li>
</ul>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
