<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Writing a Hierarchy Viewer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_writing_a_hierarchy_viewer"></a>Writing a Hierarchy Viewer</h2>
<p>
A hierarchy viewer is a user interface component that is used for displaying folder and address book container hierarchy tables. Hierarchy viewers can display members of the hierarchy at different levels, expanding and contracting each level on demand. </p>
<p>
If you are using the 32-bit version of MAPI, you can implement your hierarchy viewer manually or with the standard tree control from COMCTL32.DLL.</p>
<p>
The container property, <a href="propa_8xk8.htm">PR_DEPTH</a>, controls the level at which a hierarchy member is displayed. Entries that represent top-level address book containers or folders have their PR_DEPTH property set to zero. The value of this property is incremented sequentially for entries in sequential levels. That is, when a user selects a top-level container to expand, display all containers with PR_DEPTH set to 1. When a user expands one of these subcontainers, display the containers with PR_DEPTH set to 2, and so on. </p>
<p>
Hierarchy viewers support a different range of depths. You can limit your viewer to only one or two levels or support multiple levels, if displaying an expansive hierarchy is a priority. </p>
<p>
The address book provides a hierarchy viewer for the top-level containers in the address book. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To access the address book hierarchy viewer</h5>
<ol>
<li>
Call <a href="inter006_4cc9.htm"><b>IAddrBook::OpenEntry</b></a>, passing a null entry identifier, to open the address book's root container.</li>
<li>
Call the root container's <a href="inter011_1sh1.htm"><b>IMAPIContainer::GetHierarchyTable</b></a> method to access the hierarchy table of the MAPI address book. </li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To access the default message store's hierarchy viewer</h5>
<ol>
<li>
Call <a href="inter023_9f8l.htm"><b>IMAPISession::GetMsgStoresTable</b></a> to access the message store table. </li>
<li>
Build a restriction using the <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> structure to limit the table to only those rows that have a <a href="propa_7t2d.htm">PR_DEFAULT_STORE</a> property set to TRUE. </li>
<li>
Call <a href="inter026_2lkn.htm"><b>IMAPITable::FindRow</b></a>, passing it the <b>SPropertyRestriction</b>, to locate the row representing the default message store. </li>
<li>
Call <a href="inter023_146x.htm"><b>IMAPISession::OpenEntry</b></a>, passing in the <a href="propa_8cv8.htm">PR_ENTRYID</a> property from the default message store's row in the message store table.</li>
<li>
Call the message store's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> method to retrieve the <a href="propa_7tb8.htm">PR_IPM_SUBTREE_ENTRYID</a> property.</li>
<li>
Call the message store's <a href="inter031_3se1.htm"><b>IMsgStore::OpenEntry</b></a> method, passing the <a href="propa_7tb8.htm">PR_IPM_SUBTREE_ENTRYID</a> property, to open the root folder of the message store's IPM subtree.</li>
<li>
Call the IPM root folder's <a href="inter011_1sh1.htm"><b>IMAPIContainer::GetHierarchyTable</b></a> method to access its hierarchy table. </li>
</ol>
<p>&nbsp;</p></body>
</HTML>
