<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting Message Service Configuration</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_supporting_message_service_configuration"></a>Supporting Message Service Configuration</h2>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To support message service configuration</h5>
<ol>
<li>
Implement an entry point function that conforms to the <a href="function_7nnd.htm"><b>MSGSERVICEENTRY</b></a> prototype. Message service entry point functions manage access to configuration data and are called:<ul>
<li>
When a client logs on to retrieve information for configuring your message service.</li>
<li>
When a client wants to view or change a configuration property. </li>
</ul>
<p>
Although most message services will provide entry point functions and MAPI strongly recommends that they do, these functions are not strictly required. Message services can provide access to configuration data in other ways. However, using an entry point function standardizes and simplifies the process of configuration.
<p>
MAPI expects all message service entry point functions to be able to store and retrieve properties from the profile sections that are associated with their message service. You can support this functionality interactively, programmatically, or both interactively and programmatically.
<p>
To support interactive configuration, provide a property sheet that displays the properties involved in configuring your message service. As an option, you can also supply property sheets for each configurable provider. Some message services restrict users to a read-only view of configuration properties; other message services allow them to make changes. 
<p>
To support programmatic configuration, your message service entry point function must be able to work without user intervention. If your message service can be called by the Profile Wizard, you must support programmatic configuration. If your message service does not allow itself to be configured with the Profile Wizard, you can choose whether or not to support programmatic configuration.
<p>
For more information about how to support configuration in a message service entry point function, see <a href="function_7nnd.htm"><b>MSGSERVICEENTRY</b></a>.
</li>
<li>
Publish the name of your message service entry point function in the MAPISVC.INF configuration file by including the following entry in the message service section:</li>
</ol>
<pre><code>PR_SERVICE_ENTRY_NAME=&lt;name of message service&gt;
</code></pre>
<ol start=3>
<li>
Create one or more property sheet dialog boxes for displaying configuration data.</li>
<li>
Perform the following tasks if you want to allow the Profile Wizard to configure your message service:<ul>
<li>
Implement an entry point function that conforms to the <a href="function_0gzd.htm"><b>WIZARDENTRY</b></a> prototype.</li>
<li>
Implement a standard Windows dialog procedure that conforms to the <a href="function_8nxf.htm"><b>SERVICEWIZARDDLGPROC</b></a> prototype.</li>
<li>
Enhance your message service entry point function to respond to additional events.</li>
</ul>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
