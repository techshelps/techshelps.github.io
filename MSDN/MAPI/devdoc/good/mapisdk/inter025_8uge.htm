<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISupport : IUnknown</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_imapisupport_iunknown"></a>IMAPISupport : IUnknown</h1>
<p>
The <b>IMAPISupport</b> interface provides implementations for tasks that are commonly performed by service providers and message service entry point functions. Service providers receive a pointer to their support object when MAPI calls their provider object's logon method; message services receive their support object pointer in the call to their entry point function.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>Header file:</td>
<td width=57%>MAPISPI.H</td>
</tr>
<tr valign=top>
<td width=43%>Exposed by:</td>
<td width=57%>Support objects</td>
</tr>
<tr valign=top>
<td width=43%>Implemented by:</td>
<td width=57%>MAPI</td>
</tr>
<tr valign=top>
<td width=43%>Called by:</td>
<td width=57%>Service providers</td>
</tr>
<tr valign=top>
<td width=43%>Interface identifier:</td>
<td width=57%>IID_IMAPISup</td>
</tr>
<tr valign=top>
<td width=43%>Pointer type:</td>
<td width=57%>LPMAPISUP</td>
</tr>
</table><br>
<h4>Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=34%><a href="inter025_7q5u.htm"><b>GetLastError</b></a></td>
<td width=66%>Returns a <a href="structyp_0qpe.htm"><b>MAPIERROR</b></a> structure containing information about the previous support object error.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_8v5f.htm"><b>GetMemAllocRoutines</b></a></td>
<td width=66%>Retrieves the addresses of the MAPI memory allocation and deallocation functions: <a href="function_8z3m.htm"><b>MAPIAllocateBuffer</b></a>, <a href="function_11wl.htm"><b>MAPIAllocateMore</b></a>, and <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a>.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_56xx.htm"><b>Subscribe</b></a></td>
<td width=66%>Registers an advise sink to receive notifications through MAPI.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_3rhh.htm"><b>Unsubscribe</b></a></td>
<td width=66%>Cancels the responsibility for sending notifications that was previously established with a call to the <b>IMAPISupport::Subscribe</b> method.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_8fax.htm"><b>Notify</b></a></td>
<td width=66%>Sends a notification of a specified event to an advise source that originally registered for the notification through <b>IMAPISupport::Subscribe</b>.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_0oxj.htm"><b>ModifyStatusRow</b></a></td>
<td width=66%>Modifies the status table by adding a new row or modifying an existing row.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_6rvy.htm"><b>OpenProfileSection</b></a></td>
<td width=66%>Opens a section of the current profile and returns an <b>IProfSect</b> pointer for further access</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_53qq.htm"><b>RegisterPreprocessor</b></a></td>
<td width=66%>Registers a transport provider's preprocessor function, a function that conforms to the <a href="function_82lh.htm"><b>PreprocessMessage</b></a> prototype.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_0eck.htm"><b>NewUID</b></a></td>
<td width=66%>Creates a new <a href="structyp_3p9g.htm"><b>MAPIUID</b></a> structure to be used as a unique identifier.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_8d2c.htm"><b>MakeInvalid</b></a></td>
<td width=66%>Marks an object as unusable.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_3pt0.htm"><b>SpoolerYield</b></a></td>
<td width=66%>Gives control of the CPU to the MAPI spooler so that it can perform any tasks it deems necessary.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_5b7d.htm"><b>SpoolerNotify</b></a></td>
<td width=66%>Notifies the MAPI spooler of a change in status or a request for service.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_37mu.htm"><b>CreateOneOff</b></a></td>
<td width=66%>Creates an entry identifier for a one-off address.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_91no.htm"><b>SetProviderUID</b></a></td>
<td width=66%>Registers a <b>MAPIUID</b> structure that uniquely represents the service provider.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_34s3.htm"><b>CompareEntryIDs</b></a></td>
<td width=66%>Compares two entry identifiers to determine if they refer to the same object.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_8aec.htm"><b>OpenTemplateID</b></a></td>
<td width=66%>Opens a recipient entry in a foreign address book provider.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_4rnd.htm"><b>OpenEntry</b></a></td>
<td width=66%>Opens an object and returns an interface pointer for further access.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_6odh.htm"><b>GetOneOffTable</b></a></td>
<td width=66%>Returns a pointer to the MAPI one-off table — a list of templates supported by all address book providers for creating new recipients.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_2m2b.htm"><b>Address</b></a></td>
<td width=66%>Displays the common address dialog box. </td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_5l6b.htm"><b>Details</b></a></td>
<td width=66%>Displays a modal dialog box showing details about a particular address book entry.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_8q2h.htm"><b>NewEntry</b></a></td>
<td width=66%>Adds a new recipient directly to an address book container or to the recipient list of an outgoing message.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_9s1g.htm"><b>DoConfigPropsheet</b></a></td>
<td width=66%>Displays a configuration property sheet.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_0h4j.htm"><b>CopyMessages</b></a></td>
<td width=66%>Copies or moves messages from one folder to another folder.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_8oj6.htm"><b>CopyFolder</b></a></td>
<td width=66%>Copies or moves a folder from its current parent folder to another parent folder.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_2zcf.htm"><b>DoCopyTo</b></a></td>
<td width=66%>Copies or moves all properties of one object, except for specifically excluded properties, to another object.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_054j.htm"><b>DoCopyProps</b></a></td>
<td width=66%>Copies or moves one or more properties of an object to another object.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_3i1z.htm"><b>DoProgressDialog</b></a></td>
<td width=66%>Retrieves a progress object for displaying a progress indicator.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_4xro.htm"><b>ReadReceipt</b></a></td>
<td width=66%>Generates a read or nonread report for a message.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_5q5w.htm"><b>PrepareSubmit</b></a></td>
<td width=66%>Prepares a message for submission to the MAPI spooler.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_52pf.htm"><b>ExpandRecips</b></a></td>
<td width=66%>Completes a message's recipient list, expanding particular distribution lists.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_19d8.htm"><b>DoSentMail</b></a></td>
<td width=66%>Performs processing on a sent message.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_6nmz.htm"><b>OpenAddressBook</b></a></td>
<td width=66%>Provides access to the address book.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_2bl3.htm"><b>CompleteMsg</b></a></td>
<td width=66%>Performs postprocessing on a message. </td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_3asz.htm"><b>StoreLogoffTransports</b></a></td>
<td width=66%>Requests the orderly release of a message store.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_7chf.htm"><b>StatusRecips</b></a></td>
<td width=66%>Generates delivery and nondelivery reports.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_5s10.htm"><b>WrapStoreEntryID</b></a></td>
<td width=66%>Converts a message store's internal entry identifier to an entry identifier in the MAPI standard format.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_5eud.htm"><b>ModifyProfile</b></a></td>
<td width=66%>Makes the profile section for a message store provider permanent.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_8sod.htm"><b>IStorageFromStream</b></a></td>
<td width=66%>Implements a storage object to access a stream.</td>
</tr>
<tr valign=top>
<td width=34%><a href="inter025_7giy.htm"><b>GetSvcConfigSupportObj</b></a></td>
<td width=66%>Creates a message service support object.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
There are four different support objects, one for address book, message store, and transport providers and one for message services. Service providers and message services call the methods in their support objects as part of their implementations of other interface methods. Each different support object has complete implementations of the methods that are applicable to its caller; the methods that are not applicable return MAPI_E_NO_SUPPORT. 
<dl>
<dt>
Address book provider support objects have implementations for the following methods:</dt>
</dl>
<pre></pre>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=33%><b>Address</b></td>
<td width=38%><b>CompareEntryIDs </b></td>
<td width=29%><b>CreateOneOff </b></td>
</tr>
<tr valign=top>
<td width=33%><b>Details</b></td>
<td width=38%><b>DoConfigPropsheet </b></td>
<td width=29%><b>DoProgressDialog</b></td>
</tr>
<tr valign=top>
<td width=33%><b>GetLastError  </b></td>
<td width=38%><b>GetMemAllocRoutines</b></td>
<td width=29%><b>GetOneOffTable</b></td>
</tr>
<tr valign=top>
<td width=33%><b>IStorageFromStream</b></td>
<td width=38%><b>GetSvcConfigSupportObj</b></td>
<td width=29%><b>MakeInvalid</b></td>
</tr>
<tr valign=top>
<td width=33%><b>ModifyStatusRow   </b></td>
<td width=38%><b>NewEntry</b></td>
<td width=29%><b>NewUID</b></td>
</tr>
<tr valign=top>
<td width=33%><b>Notify</b></td>
<td width=38%><b>OpenAddressBook </b></td>
<td width=29%><b>OpenEntry</b></td>
</tr>
<tr valign=top>
<td width=33%><b>OpenProfileSection</b></td>
<td width=38%><b>OpenTemplateID</b></td>
<td width=29%><b>SetProviderUID  </b></td>
</tr>
<tr valign=top>
<td width=33%><b>Subscribe</b></td>
<td width=38%><b>Unsubscribe</b></td>
<td width=29%><b>WrapStoreEntryID</b></td>
</tr>
</table><br>
<dl>
<dt>
Message store provider support objects have implementations for the following methods:</dt>
</dl>
<pre></pre>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=33%><b>CompareEntryIDs </b></td>
<td width=38%><b>CompleteMsg</b></td>
<td width=29%><b>CopyFolder </b></td>
</tr>
<tr valign=top>
<td width=33%><b>CopyMessages</b></td>
<td width=38%><b>CreateOneOff</b></td>
<td width=29%><b>DoCopyProps</b></td>
</tr>
<tr valign=top>
<td width=33%><b>DoCopyTo </b></td>
<td width=38%><b>DoConfigPropsheet </b></td>
<td width=29%><b>DoProgressDialog</b></td>
</tr>
<tr valign=top>
<td width=33%><b>DoSentMail </b></td>
<td width=38%><b>ExpandRecips</b></td>
<td width=29%><b>GetLastError </b></td>
</tr>
<tr valign=top>
<td width=33%><b>GetMemAllocRoutines</b></td>
<td width=38%><b>GetSvcConfigSupportObj</b></td>
<td width=29%><b>MakeInvalid</b></td>
</tr>
<tr valign=top>
<td width=33%><b>IStorageFromStream </b></td>
<td width=38%><b>ModifyProfile</b></td>
<td width=29%><b>ModifyStatusRow  </b></td>
</tr>
<tr valign=top>
<td width=33%><b>NewUID</b></td>
<td width=38%><b>Notify </b></td>
<td width=29%><b>OpenAddressBook</b></td>
</tr>
<tr valign=top>
<td width=33%><b>OpenEntry </b></td>
<td width=38%><b>OpenProfileSection</b></td>
<td width=29%><b>PrepareSubmit  </b></td>
</tr>
<tr valign=top>
<td width=33%><b>ReadReceipt</b></td>
<td width=38%><b>SetProviderUID  </b></td>
<td width=29%><b>SpoolerNotify</b></td>
</tr>
<tr valign=top>
<td width=33%><b>StoreLogoffTransports</b></td>
<td width=38%><b>Subscribe </b></td>
<td width=29%><b>Unsubscribe </b></td>
</tr>
<tr valign=top>
<td width=33%><b>WrapStoreEntryID</b></td>
<td width=38%></td>
<td width=29%></td>
</tr>
</table><br>
<dl>
<dt>
Transport provider support objects have implementations for the following methods:</dt>
</dl>
<pre></pre>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=33%><b>DoConfigPropsheet </b></td>
<td width=38%><b>CompareEntryIDs </b></td>
<td width=29%><b>CreateOneOff </b></td>
</tr>
<tr valign=top>
<td width=33%><b>GetMemAllocRoutines</b></td>
<td width=38%><b>GetSvcConfigSupportObj</b></td>
<td width=29%><b>GetLastError</b></td>
</tr>
<tr valign=top>
<td width=33%><b>IStorageFromStream</b></td>
<td width=38%><b>MakeInvalid</b></td>
<td width=29%><b>ModifyStatusRow</b></td>
</tr>
<tr valign=top>
<td width=33%><b>OpenAddressBook </b></td>
<td width=38%><b>RegisterPreprocessor</b></td>
<td width=29%><b>NewUID</b></td>
</tr>
<tr valign=top>
<td width=33%><b>Notify </b></td>
<td width=38%><b>OpenProfileSection</b></td>
<td width=29%><b>OpenEntry</b></td>
</tr>
<tr valign=top>
<td width=33%><b>StatusRecips </b></td>
<td width=38%><b>SpoolerNotify </b></td>
<td width=29%><b>SpoolerYield</b></td>
</tr>
<tr valign=top>
<td width=33%><b>WrapStoreEntryID</b></td>
<td width=38%><b>Subscribe</b></td>
<td width=29%><b>Unsubscribe</b></td>
</tr>
</table><br>
<dl>
<dt>
Message service support objects have implementations for the following methods:</dt>
</dl>
<pre></pre>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=46%><b>DoConfigPropsheet </b></td>
<td width=54%><b>GetLastError</b></td>
</tr>
<tr valign=top>
<td width=46%><b>GetMemAllocRoutines</b></td>
<td width=54%><b>GetSvcConfigSupportObj</b></td>
</tr>
<tr valign=top>
<td width=46%><b>MakeInvalid</b></td>
<td width=54%><b>NewUID</b></td>
</tr>
<tr valign=top>
<td width=46%><b>OpenProfileSection</b></td>
<td width=54%></td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
