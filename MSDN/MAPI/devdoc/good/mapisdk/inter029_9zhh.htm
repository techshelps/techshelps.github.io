<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMessage::GetRecipientTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imessage_getrecipienttable"></a>IMessage::GetRecipientTable</h2>
<p>
The <b>IMessage::GetRecipientTable</b> method returns the message's recipient table.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter029_525s.htm"><b>IMessage : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT GetRecipientTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>)</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the return of the table. The following flags can be set:
<dl>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
Allows <b>GetRecipientTable</b> to return successfully, possibly before the table is fully accessible to the calling client. If the table is not accessible, making a subsequent call to it can result in an error.</dd>
<dt>
MAPI_UNICODE</dt>
<dd>
The string columns should be in Unicode format. If the MAPI_UNICODE flag is not set, the string columns should be in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the recipient table.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The recipient table was returned successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMessage::GetAttachmentTable</b> method returns a pointer to the message's recipient table, which includes information about all of the recipients for the message. There is one for every recipient. </p>
<p>
Recipient tables have a different column set depending on whether the message has been submitted. For a complete list of the columns in a recipient table, see <a href="tables_1d4j.htm">Recipient Tables</a>.</p>
<p>
Some recipient tables support a wide variety of restrictions; others do not. Support for restrictions depends on the message store provider's implementation. </p>
<p>
Setting the MAPI_UNICODE flag in the <i>ulFlags </i>parameter affects the following calls to the recipient table: 
<ul>
<li>
<a href="inter026_98c3.htm"><b>IMAPITable::QueryColumns</b></a> to retrieve the column set.</li>
<li>
<a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a> to retrieve rows.</li>
<li>
<a href="inter026_16pe.htm"><b>IMAPITable::QuerySortOrder</b></a> to retrieve the sort order.</li>
</ul>
<p>
Setting the Unicode flag requests that the information for any string columns returned from these calls be in Unicode format. However, because not all message store providers support Unicode, setting this flag is only a request.</p>
<h4>Notes to Callers</h4>
<p>
You can change a recipient table while it is open by calling the <a href="inter029_8vw3.htm"><b>IMessage::ModifyRecipients</b></a><b> </b>method. <b>ModifyRecipients</b> adds recipients, deletes recipients, or modifies recipient properties. </p>
<h4>See Also</h4>
<p>
<a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a>, <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>, <a href="inter029_8vw3.htm"><b>IMessage::ModifyRecipients</b></a></p>
<p>&nbsp;</p></body>
</HTML>
