<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SERVICEWIZARDDLGPROC</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC</h2>
<p>
The <b>SERVICEWIZARDDLGPROC</b> function prototype defines a callback function invoked by the Profile Wizard to allow a service provider to react to user events when the provider's property sheets or pages are being shown. </p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Header file: </td>
<td width=52%>MAPIWZ.H </td>
</tr>
<tr valign=top>
<td width=48%>Defined function implemented by: </td>
<td width=52%>Service providers </td>
</tr>
<tr valign=top>
<td width=48%>Defined function called by: </td>
<td width=52%>MAPI Profile Wizard </td>
</tr>
</table><br>
<pre><code><b>BOOL SERVICEWIZARDDLGPROC(
  HWND</b><i> hDlg</i><b>,</b>       
<b>  UINT</b><i> wMsgID</i><b>,</b>     
<b>  WPARAM</b><i> wParam</i><b>,</b>   
<b>  LPARAM</b><i> lParam    </i>
<b>);</b>
 </code></pre>
<h4>Parameters </h4>
<dl>
<dt>
<i>hDlg </i></dt>
<dd>
[in] Window handle to the Profile Wizard dialog box. </dd>
<dt>
<i>wMsgID </i></dt>
<dd>
[in] The window message to be processed. In addition to the regular window messages expected by a modal dialog box, the following messages can be received: 
<dl>
<dt>
WM_CLOSE </dt>
<dd>
The Profile Wizard has completed. The service provider should do all required cleanup such as deallocating any dynamically allocated memory. </dd>
<dt>
WM_COMMAND </dt>
<dd>
One of the provider's controls has been selected, or the <b>Next</b> or <b>Back</b> button has been clicked. The value in the <i>wParam</i> parameter indicates which of these user events has occurred. </dd>
<dt>
WM_INITDIALOG </dt>
<dd>
The user has moved to another property page, for which the dialog box must be initialized. The provider should initialize the controls that the Profile Wizard has added to the dialog box. </dd>
<dt>
WIZ_QUERYNUMPAGES </dt>
<dd>
The Profile Wizard is prompting for the number of pages that the provider needs to display. The provider should return the number of pages instead of TRUE or FALSE. For example, use the following return statement to indicate that three pages should to be displayed: 
<pre><code>return (BOOL)3; 
 </code></pre>
</dd>
</dl>
</dd>
<dt>
<i>wParam </i></dt>
<dd>
[in] A 32-bit parameter associated with window messages. Possible values depend on the message specified in the <i>wMsgID</i> parameter. In addition to the values expected with the regular window messages for a modal dialog box, the following values can be received: 
<dl>
<dt>
WIZ_NEXT </dt>
<dd>
When <i>wMsgID</i> contains WM_COMMAND, the user has clicked the <b>Next</b> button. </dd>
<dt>
WIZ_PREV </dt>
<dd>
When <i>wMsgID</i> contains WM_COMMAND, the user has clicked the <b>Back</b> button. </dd>
</dl>
</dd>
<dt>
<i>lParam </i></dt>
<dd>
[in] A 32-bit parameter associated with window messages. Possible values depend on the message specified in the <i>wMsgID</i> parameter. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
The value returned by a <b>SERVICEWIZARDDLGPROC</b> – based function is dependent on the window message received. Note in particular the exceptional return value for the WIZ_QUERYNUMPAGES message. The normal return values are: 
<dl>
<dt>
TRUE </dt>
<dd>
The service provider has processed the received window message. </dd>
<dt>
FALSE </dt>
<dd>
The service provider has not processed the received window message. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
When the user moves from one property page to another, the provider is responsible for hiding the old page's controls and showing the controls for the next or previous page. When the user clicks the <b>Next</b> button, the <b>SERVICEWIZARDDLGPROC </b>– based function is called with the WM_COMMAND message and WIZ_NEXT in the <i>wParam</i> parameter. The following steps describe what occurs between the time the user clicks <b>Next</b> and the time the first provider's configuration pages are rendered. 
<ol>
<li>
The Profile Wizard hides any controls that are on the window. </li>
<li>
The Profile Wizard adds the provider's hidden controls to the page. </li>
<li>
The Profile Wizard calls <b>SERVICEWIZARDDLGPROC</b>, sending the WM_INITDIALOG message, so that the provider can initialize the controls. </li>
<li>
The Profile Wizard calls <b>SERVICEWIZARDDLGPROC</b>, sending the WIZ_QUERYNUMPAGES message. The provider returns the number of pages that are to be shown. </li>
<li>
The Profile Wizard calls <b>SERVICEWIZARDDLGPROC</b>, sending the WM_COMMAND message with the <i>wParam</i> parameter set to either WIZ_NEXT or WIZ_PREV. At this point, the provider either returns FALSE {error} or reveals its controls and returns TRUE {success}. If the Profile Wizard passes in ID_NEXT, the provider's first page is displayed. If ID_PREV is passed in, the last page is displayed. </li>
<li>
The Profile Wizard calls the provider's <b>SERVICEWIZARDDLGPROC</b> function, sending the WM_COMMAND message with the <i>wParam</i> parameter set to either WIZ_NEXT or WIZ_PREV (depending on which button the user clicked). The provider is responsible for showing or hiding its controls and writing its data to the <b>IMAPIProp</b> passed to the Profile Wizard to step through its sequence of pages. The provider should return TRUE if the next or previous page was successfully shown, and FALSE if neither the next nor previous page could be shown. The provider needs to be aware of when it is stepping outside of its sequence of pages, and respond appropriately by hiding its controls and writing its data to the profile. </li>
<li>
If the user steps outside the provider's range of pages, the Profile Wizard deletes the provider's hidden controls from the dialog box and calls the next provider — or displays its next page if that was the last provider. </li>
</ol>
<h4>See Also</h4>
<p>
<a href="groups_6tmb.htm">Profile Wizard Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
