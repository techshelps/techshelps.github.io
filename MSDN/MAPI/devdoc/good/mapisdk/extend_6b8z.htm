<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Search-Results Folders</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_search_results_folders"></a>Search-Results Folders</h2>
<p>
A search-results folder holds links to messages in generic folders rather than the actual messages. Clients create a search-results folder by calling <a href="inter013_9tpu.htm"><b>IMAPIFolder::CreateFolder</b></a> with FOLDER_SEARCH as the <i>ulFolderType</i> parameter. Clients fill a search-results folder by setting up and applying search criteria, or rules that serve to filter out messages with particular characteristics. Search criteria are set up with the <a href="inter011_2psx.htm"><b>IMAPIContainer::SetSearchCriteria</b></a><b> </b>method. Clients build one or more <a href="structyp_45ny.htm"><b>SRestriction</b></a> structures to represent the search criteria to be applied and pass them to <b>SetSearchCriteria</b>. Also specified is a list of folders indicating the search domain and a set of flags controlling details of how the search is performed. </p>
<p>
<b>SetSearchCriteria</b> identifies the messages that match the specified restriction. The selected messages, the ones that satisfy the criteria, appear as links in the search-results folder. When the client calls <b>IMAPIContainer::GetContentsTable</b> to access the search-results folder's contents table, the selected messages appear in the table. Contents tables for search-results folders contain the same columns as contents tables for generic folders. However, for search-results folders, PR_PARENT_ENTRYID is the entry identifer of the folder where the linked message resides. Search-results folders are not considered parent folders.</p>
<p>
Search-results folders have the following limits:
<ul>
<li>
The only way that the contents of a search-results folder can be modified is through the <a href="inter011_2psx.htm"><b>IMAPIContainer::SetSearchCriteria</b></a> call. </li>
<li>
Messages cannot be moved or copied into or out of search-results folders. </li>
<li>
Search-results folders cannot contain subfolders. </li>
<li>
Clients cannot set search criteria on a search-results folder, making it the subject of a search. </li>
</ul>
<p>
It is possible, however, to modify the properties of a search-results folder and use it to delete a message. When a message is deleted from a search-results folder, it is actually deleted from the real folder. However, deleting the search-results folder has no impact on the messages inside; they remain in their generic folders. </p>
<p>&nbsp;</p></body>
</HTML>
