<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using MAPI Objects</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_using_mapi_objects"></a>Using MAPI Objects</h1>
<p>
Clients and service providers use MAPI objects by calling the methods in their interface implementations. This is the only way that MAPI objects can be used; methods that are implemented by an object outside of a MAPI interface are not publicly accessible. Because all of an object's interfaces are related through inheritance, an object's user can call methods in either the base interface or one of the inherited interfaces as if they belong to the same interface. </p>
<p>
When an object's user wants to make a call to a method and that object implements several interfaces related through inheritance, the user need not know to which interface the method belongs. The user can call any of the methods on any of the interfaces with a single pointer to the object. For example, the following illustration shows how a client application uses a folder object. Folder objects implement the <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a> interface which inherits from <b>IUnknown</b> indirectly through <b>IMAPIProp</b> and <b>IMAPIContainer</b>. A client can call one of the <a href="inter022_00tq.htm"><b>IMAPIProp</b></a> methods, such as <b>GetProps</b>, and one of the <a href="inter013_9ohe.htm"><b>IMAPIFolder</b></a> methods, such as <b>CreateMessage</b>, in the same way with the same object pointer. A client is not aware of or affected by the fact that these calls belong to different interfaces.</p>
<p>
<img src="images/amapi_40.gif" border=0></p>
<p>
These calls translate into code differently depending on whether the client making the calls is written in C or C++. Before any call to a method can be made, a pointer to the interface implementation must be retrieved. Interface pointers can be obtained by:
<ul>
<li>
Calling a method on a different object.</li>
<li>
Calling an API function.</li>
<li>
Calling <b>IUnknown::QueryInterface</b> on the target object.</li>
</ul>
<p>
MAPI provides several methods and API functions that return pointers to interface implementations. For example, clients can call the <a href="inter023_9f8l.htm"><b>IMAPISession::GetMsgStoresTable</b></a> method to retrieve a pointer to a table object that provides access to message store provider information through the <b>IMAPITable : IUnknown</b> interface. Service providers can call the API function <a href="function_8fs5.htm"><b>CreateTable</b></a> to retrieve a pointer to a table data object. When there is no function or method available and clients or service providers already have a pointer to an object, they can call the object's <b>QueryInterface</b> method to retrieve a pointer to another of the object's interface implementations.</p>
<p>&nbsp;</p></body>
</HTML>
