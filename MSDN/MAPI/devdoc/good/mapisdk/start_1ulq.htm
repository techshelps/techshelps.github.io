<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a Send Command to an Application</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_adding_a_send_command_to_an_application"></a>Adding a Send Command to an Application</h1>
<p>
Being able to add a <b>Send</b> command to a document-based application's <b>File</b> menu is a Microsoft Windows 95 logo requirement. The same logic applies to sending a message from any application.</p>
<h4>Design Tasks</h4>
<ol>
<li>
Decide whether to use Simple MAPI, CMC, MAPI, or the Active Messaging Library. See <a href="intro_3lph.htm">Selecting a Client Interface</a>.</li>
<li>
Decide when to load and unload the selected interface, and when to create and destroy its session. You should share the messaging client's session, if it is active. See <a href="intro_1qwj.htm">MAPI Sessions</a>.</li>
</ol>
<h4>Implementation Tasks</h4>
<ol>
<li>
Determine whether the <b>Send</b> command should be enabled. Installation of messaging support in the operating system is optional, and your <b>Send</b> command should be disabled if the selected interface is not available. See <a href="intro_7xyc.htm">Determining Which Client Interfaces are Installed</a>.</li>
<li>
Load the selected interface DLL and the entry points you will need. See one of the following topics, depending upon which interface you have selected:<ul>
<li>
For Simple MAPI, see <a href="smapi_24fo.htm">Initializing a Simple MAPI Client</a>. </li>
<li>
For CMC, see Starting a CMC<a href="cmc_9wa6.htm"> Session</a>.  </li>
<li>
For MAPI, see Initializing<a href="consider_49k9.htm"> MAPI</a> and <a href="consider_8prd.htm">Initializing OLE for Use with MAPI</a>.</li>
<li>
For the Active Messaging Library, no explicit load step is necessary. Simply instantiate one of the top-level objects, MAPI.Session or MAPI.Message.</li>
</ul>
</li>
<li>
Send a document using the selected interface. See one of the following topics, depending upon which interface you have selected:<ul>
<li>
For Simple MAPI, see Sending<a href="smapi_0295.htm"> Messages with Simple MAPI</a>.</li>
<li>
For CMC, see <a href="cmc_90gz.htm">Sending Messages with CMC</a>.</li>
<li>
For the Active Messaging Library, see <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_olemsg_creating_and_sending_a_message">
</object><a href=JavaScript:alink_1.Click()>Creating and Sending a Message</a>.</li>
<li>
For MAPI, several steps are necessary: </li>
</ul>
<ol>
<li>
Open the default message store. See <a href="consider_54yt.htm">Opening a Message Store</a>.</li>
<li>
Open the Outbox. See <a href="consider_4wqa.htm">Opening a Folder</a>.</li>
<li>
Add recipients to the message's recipient table. See <a href="extend_86b7.htm">Recipients</a>.</li>
<li>
Add the document to the message as an attachment. See <a href="extend_7qwj.htm">Attachments</a>.</li>
<li>
Optionally, add text to the message. See <a href="propa_9lvd.htm">PR_BODY</a>.</li>
<li>
Send the message. See <a href="extend_1zop.htm">Sending Messages with MAPI</a>.</li>
<li>
Release all the objects created in the preceding steps.</li>
</ol>
</li>
</ol>
<h4>About Sample Source Code</h4>
<p>
See the following topics:</p>
<p class=indent1>
<a href="start_2stw.htm">Sample CMC Client</a></p>
<p class=indent1>
<a href="start_3bzo.htm">Sample Routing Client</a></p>
<p class=indent1>
<a href="start_0iyh.htm">Sample RTF Utility</a></p>
<p class=indent1>
<a href="start_3jsk.htm">Sample Simple MAPI Client</a></p>
<p class=indent1>
<a href="start_5epa.htm">Sample Timecard Application</a></p>
<p>&nbsp;</p></body>
</HTML>
