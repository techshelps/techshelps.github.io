<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sorting and Categorization</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_sorting_and_categorization"></a>Sorting and Categorization</h2>
<p>
Sorting a table places rows in an order that makes sense for its viewer. For example, one viewer might prefer to see the contents table of a folder sorted by message subject so that all the threads of a conversation are together while another viewer might want the messages sorted by the name of the sender. A newly instantiated table is not necessarily sorted in any particular order. </p>
<p>
There are two types of sorting: 
<ul>
<li>
Standard sorting</li>
<li>
Categorized sorting </li>
</ul>
<p>
With standard sorting, all of the rows are displayed in a flat list using one or more columns as a sort key. With categorized sorting, the rows are displayed hierarchically with one or more columns as the sort key. Within each category, there is a special heading row that contains the following columns:
<ul>
<li>
The column or columns that make up the sort key</li>
<li>
<a href="propa_9up0.htm">PR_CONTENT_UNREAD</a></li>
<li>
<a href="propa_65h5.htm">PR_INSTANCE_KEY</a></li>
<li>
<a href="propa_8xk8.htm">PR_DEPTH</a></li>
<li>
<a href="propb_79id.htm">PR_ROW_TYPE</a>. </li>
</ul>
<p>
Indented under the heading row are all the rows from the table that contain columns with values that match the sort key. These rows are called the leaf rows. Leaf rows contain all the columns in the column set minus the sort key columns. </p>
<p>
The contents tables of folders often support categorized sorting in addition to standard sorting. The contents tables of address book containers typically support only standard sorting. </p>
<p>
A category can have two states: collapsed and expanded. When a category is in the collapsed state, only the heading row is returned from <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>. When a category is in the expanded state, all of the rows related to the category are returned. This includes the heading row and the leaf rows. </p>
<p>
Each category in a table view can be expanded or collapsed independently. That is, not all categories must be in the same state at the same time; some categories can be collapsed while others are expanded. </p>
<p>
The user of a categorized table decides how it is displayed. One common option is to use a control provided in the Platform SDK called the treeview control. Treeview controls are list boxes that support information in a tree-like structure. Heading rows for categories in the expanded state are marked with a minus sign while heading rows for categories in the collapsed state are marked with a plus sign. Expanded categories are displayed with the leaf rows indented under the heading rows. </p>
<p>
The following illustration shows a categorized contents table with an expanded category to illustrate the difference between how an expanded and collapsed category can appear to the user. The table is sorted by sender name — the <a href="propb_9orp.htm">PR_SENDER_NAME</a> property. Heading rows contain the sender name and the computed properties for the row. The category where sender name is equal to Bill Lee is expanded to include five leaf rows. All of the leaf rows are visible and there is a minus sign next to the heading row, indicating that no further expansion of the category is possible. </p>
<p>
<img src="images/amapi_59.gif" border=0></p>
<p>
In the following illustration, the category is collapsed with none of the leaf rows included in the display. The heading row has a plus sign indicating that the category can be expanded further.</p>
<p>
<img src="images/amapi_57.gif" border=0></p>
<p>
To collapse and expand a category, a client application or service provider uses the following <b>IMAPITable</b> methods: </p>
<p class=indent1>
<a href="inter026_59lx.htm"><b>GetCollapseState</b></a></p>
<p class=indent1>
<a href="inter026_74v9.htm"><b>SetCollapseState</b></a></p>
<p class=indent1>
<a href="inter026_8o53.htm"><b>ExpandRow</b></a></p>
<p class=indent1>
<a href="inter026_43w7.htm"><b>CollapseRow</b></a></p>
<p>&nbsp;</p></body>
</HTML>
