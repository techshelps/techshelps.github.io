<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFolder::DeleteFolder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapifolder_deletefolder"></a>IMAPIFolder::DeleteFolder</h2>
<p>
The <b>IMAPIFolder::DeleteFolder</b> method removes a subfolder.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT DeleteFolder(
  ULONG</b><i> cbEntryID</i><b>,</b>             
<b>  LPENTRYID</b><i> lpEntryID</i><b>,</b>         
<b>  ULONG</b><i> ulUIParam</i><b>,</b>             
<b>  LPMAPIPROGRESS</b><i> lpProgress</i><b>,</b>   
<b>  ULONG</b><i> ulFlags                </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cbEntryID</i></dt>
<dd>
[in] Count of bytes in the entry identifier pointed to by the <i>lpEntryID </i>parameter. </dd>
<dt>
<i>lpEntryID</i></dt>
<dd>
[in] Pointer to the entry identifier of the subfolder to delete.</dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the progress indicator. The <i>ulUIParam</i> parameter is ignored unless the FOLDER_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>lpProgress</i></dt>
<dd>
[in] Pointer to a progress object for displaying a progress indicator. If NULL is passed in <i>lpProgress</i>, the message store provider displays a progress indicator using the MAPI progress object implementation. The <i>lpProgress</i> parameter is ignored unless the FOLDER_DIALOG flag is set in <i>ulFlags</i>.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the deletion of the subfolder. The following flags can be set:
<dl>
<dt>
DEL_FOLDERS</dt>
<dd>
All subfolders of the subfolder pointed to by <i>lpEntryID</i> should be deleted.</dd>
<dt>
DEL_MESSAGES</dt>
<dd>
All messages in the subfolder pointed to by <i>lpEntryID</i> should be deleted.</dd>
<dt>
FOLDER_DIALOG</dt>
<dd>
A progress indicator should be displayed while the operation proceeds.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The specified folder has been successfully deleted.</dd>
<dt>
MAPI_E_HAS_FOLDERS</dt>
<dd>
The subfolder being deleted contains subfolders, and the DEL_FOLDERS flag was not set. The subfolder was not deleted.</dd>
<dt>
MAPI_E_HAS_MESSAGES</dt>
<dd>
The subfolder being deleted contains messages, and the DEL_MESSAGES flag was not set. The subfolder was not deleted.</dd>
<dt>
MAPI_W_PARTIAL_COMPLETION</dt>
<dd>
The call succeeded, but not all of the entries were successfully deleted. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIFolder::DeleteFolder</b> method deletes a subfolder. Folders to be deleted must be located in the folder designated as the special wastebasket folder, typically the Deleted Items folder in the IPM subtree. By default, <b>DeleteFolder</b> only operates on empty folders, but it can be used successfully on non-empty folders by setting two flags: DEL_FOLDERS and DEL_MESSAGES. Only empty folders or folders that set both the DEL_FOLDERS and DEL_MESSAGES flags on the <b>DeleteFolder</b> call can be deleted. DEL_FOLDERS enables all of the folder's subfolders to be removed; DEL_MESSAGES enables all of the folder's messages to be removed.</p>
<h4>Notes to Implementers</h4>
<p>
When the delete operation involves more than one folder, perform the operation as completely as possible for each folder. Sometimes one of the folders to be deleted does not exist or has been moved or copied elsewhere. Do not stop the operation prematurely unless a failure occurs that is beyond your control, such as running out of memory, running out of disk space, or corruption in the message store.</p>
<p>
During a <b>DeleteFolder</b> call, messages being processed by the MAPI spooler are not deleted; they are left in their parent folders. Do not call the <a href="inter031_5gac.htm"><b>IMsgStore::AbortSubmit</b></a> method for these messages. </p>
<h4>Notes to Callers</h4>
<p>
Expect these return values under the following conditions:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Condition</th>
<th align=left width=52%>Return value</th>
</tr>
<tr valign=top>
<td width=48%><b>DeleteFolder</b> has successfully deleted every message and subfolder.</td>
<td width=52%>S_OK</td>
</tr>
<tr valign=top>
<td width=48%><b>DeleteFolder</b> was unable to successfully delete every message and subfolder.</td>
<td width=52%>MAPI_W_PARTIAL_COMPLETION or MAPI_E_NOT_FOUND</td>
</tr>
<tr valign=top>
<td width=48%><b>DeleteFolder </b>was unable to complete.</td>
<td width=52%>Any error value except MAPI_E_NOT_FOUND</td>
</tr>
</table><br>
<p>
When <b>DeleteFolder</b> is unable to complete, do not assume that no work was done. <b>DeleteFolder</b> might have been able to delete one or more of the messages and subfolders before encountering the error. </p>
<p>
If one or more subfolders cannot be deleted, <b>DeleteFolder</b> returns MAPI_W_PARTIAL_COMPLETION or MAPI_E_NOT_FOUND, depending on the message store provider's implementation. </p>
<p>&nbsp;</p></body>
</HTML>
