<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding or Deleting Providers in a Message Service</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_adding_or_deleting_providers_in_a_message_service"></a>Adding or Deleting Providers in a Message Service</h2>
<p>
To add or delete service providers in a message service, use the <a href="inter038_7vla.htm"><b>IProviderAdmin</b></a> interface. You can retrieve an <b>IProviderAdmin</b> pointer by calling <a href="inter030_2yur.htm"><b>IMsgServiceAdmin::AdminProviders</b></a>. The provider table, accessable through <a href="inter038_5alh.htm"><b>IProviderAdmin::GetProviderTable</b></a>, lists information about the service providers currently installed in the message service. Clients and service providers can use the provider table to access the name of the provider DLL file, for example, or the <b>MAPIUID</b>, display name, and type of the provider as well as information about the message service. See <a href="tables_6vs5.htm">Provider Table</a> for more information.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To add or delete a service provider in a message service </h5>
<ol>
<li>
Call the <b>AdminServices</b> method to access a message service administration object.</li>
<li>
Call <a href="inter030_4did.htm"><b>IMsgServiceAdmin::GetMsgServiceTable</b></a> to access the message service table.</li>
<li>
Build a property restriction using an <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> structure that matches <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> or <a href="propb_18yt.htm">PR_SERVICE_NAME</a> with the name of the message service to be modified. </li>
<li>
Call the message service table's <a href="inter026_2lkn.htm"><b>IMAPITable::FindRow</b></a> method to locate the row in the table that represents the targeted message service.</li>
<li>
Call <a href="inter030_2yur.htm"><b>IMsgServiceAdmin::AdminProviders</b></a> to retrieve an <b>IProviderAdmin</b> pointer. Pass the <a href="propb_357o.htm">PR_SERVICE_UID</a> column from the message service table row as the <i>lpUID</i> parameter.</li>
<li>
Call <a href="inter038_5alh.htm"><b>IProviderAdmin::GetProviderTable</b></a> to access the provider table. </li>
<li>
Build a property restriction using an <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> structure that matches <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> or <a href="propb_9aux.htm">PR_PROVIDER_DISPLAY</a> with the name of the service provider to be added or deleted. </li>
<li>
Call the provider table's <a href="inter026_2lkn.htm"><b>IMAPITable::FindRow</b></a> method to locate the row in the table that represents the targeted service provider.</li>
<li>
Call <a href="inter038_6ppu.htm"><b>IProviderAdmin::CreateProvider</b></a> to add the provider or <a href="inter038_23w2.htm"><b>IProviderAdmin::DeleteProvider</b></a> to remove it from the message service. For <b>CreateProvider</b>, pass the provider's <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> property as the <i>lpszProvider</i> parameter. For either method, pass the provider's <a href="propb_357o.htm">PR_SERVICE_UID</a> property as the <i>lpUID</i> parameter. After the service provider has been added or deleted, the change will not be apparent until a new session is created.</li>
</ol>
<p>
Another technique for adding a service provider, specifically a message store provider, to a profile involves constructing an entry identifier for the provider. Because constructing an entry identifier requires knowledge of its format, this technique can only be used if the service provider has made its entry identifier format public. </p>
<p>
With the newly constructed entry identifier, a client can call <a href="inter023_59id.htm"><b>IMAPISession::OpenMsgStore</b></a>. MAPI automatically creates a profile section in the profile for the service provider, but does not add it to a message service. </p>
<p>
Some message services do not allow this type of dynamic modification; whether or not it is supported is up to the message service. Another feature that may or may not be supported is the ability to directly access a message service's private profile sections. If the message service you are using permits such access, it will publish the <b>GUID</b> that represents the private section in MAPISVC.INF. You can pass this <b>GUID</b> in a call to <a href="inter038_5oku.htm"><b>IProviderAdmin::OpenProfileSection</b></a> to access the profile section. </p>
<p>&nbsp;</p></body>
</HTML>
