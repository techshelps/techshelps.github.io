<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Message Submission Model</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_message_submission_model"></a>Message Submission Model</h3>
<p>
Message submission is accomplished by a series of calls from the MAPI spooler to the transport provider. The calls are sequenced as follows:
<ol>
<li>
The MAPI spooler calls <a href="inter042_18v9.htm"><b>IXPLogon::SubmitMessage</b></a>, passing in an <b>IMessage</b> instance, to begin the process.</li>
<li>
The transport provider then places a reference value — a transport-defined identifier used in future references to this message — in the location referenced in <b>SubmitMessage</b>.</li>
<li>
The transport provider accesses the message data by using the passed <b>IMessage</b> instance. For each recipient in the passed <b>IMessage</b> for which it accepts responsibility, the transport provider sets the <a href="propb_92pl.htm">PR_RESPONSIBILITY</a> property, and then returns.</li>
<li>
The transport provider can use the <a href="inter025_7chf.htm"><b>IMAPISupport::StatusRecips</b></a> method to indicate if it recognizes any recipients that cannot be delivered to, or to create a standard delivery report. <b>StatusRecips</b> is a convenience for transport providers that have determined that some of the recipients cannot be delivered to or have received delivery information from their underlying messaging system that the user or client application might find useful.</li>
<li>
The MAPI spooler's call to <a href="inter042_576t.htm"><b>IXPLogon::EndMessage</b></a> is the final responsibility hand-off for the message from the MAPI spooler to the transport provider.</li>
<li>
The MAPI spooler can use <a href="inter042_5cah.htm"><b>IXPLogon::TransportNotify</b></a><b> </b>to cancel message processing during the <b>SubmitMessage</b> or <b>EndMessage</b> calls.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
