<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing Name Resolution</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_implementing_name_resolution"></a>Implementing Name Resolution</h2>
<p>
Address book providers are responsible for supporting name resolution — the process of associating an entry identifier with a display name. Clients initiate name resolution when they call <a href="inter006_64v9.htm"><b>IAddrBook::ResolveName</b></a> to ensure that each member of an outgoing message's recipient list corresponds to a valid address.</p>
<p>
Your provider can support name resolution by:
<ul>
<li>
Supporting the <a href="propa_1gtu.htm">PR_ANR</a> property restriction, a requirement for all address book containers.</li>
<li>
Implementing the <a href="inter003_0ss3.htm"><b>IABContainer::ResolveNames</b></a> method, an option for all address book containers. </li>
</ul>
<p>
</p>
<p>
If you choose to support <b>IABContainer::ResolveNames</b>, attempt to locate an exact match for each unresolved display name in the <a href="structyp_87n8.htm"><b>ADRLIST</b></a> structure passed in with the <i>lpAdrList</i> parameter. You can identifiy an unresolved display name because it is missing the PR_ENTRYID property in the property value array in its <b>aEntries</b> member of the <b>ADRLIST</b> structure. Ignore any entries that have zero properties associated with them. </p>
<p>
Report the result of your attempt at resolution in the <i>lpFlagList</i> parameter, an array of flags that corresponds to the array of display names in <i>lpAdrList</i>. The flags are positional such that the first flag corresponds to the first <b>aEntries</b> member in the <b>ADRLIST</b> structure, the second flag corresponds to the second <b>aEntries </b>member, and so on. </p>
<p>
There are three possible results for each unresolved entry:
<ul>
<li>
No match was found, meaning that none of the entries in your container entries match the entry in the <b>ADRLIST</b> structure. Set the corresponding entry in the <i>lpFlagList</i> parameter to MAPI_UNRESOLVED. </li>
<li>
Several matches can be found, meaning that there are multiple container entries that match the entry in the <b>ADRLIST</b> structure. Set the corresponding entry in the <i>lpFlagList</i> parameter to MAPI_AMBIGUOUS. Do not change the number of entries in the <b>ADRLIST</b> structure.</li>
<li>
An exact match can be found, meaning that there is only one container entry that matches the entry in the <b>ADRLIST</b> structure. Set the corresponding member in the <i>lpFlagList</i> parameter to MAPI_RESOLVED and add the entry identifier to the array of properties associated with the <b>ADRLIST</b> entry.</li>
</ul>
<p>
If you choose not to support <b>IABContainer::ResolveNames</b>, return MAPI_E_NO_SUPPORT from your implementation.</p>
<p>
All address book providers are required to support ambiguous name resolution — the <a href="propa_1gtu.htm">PR_ANR</a> property restriction — on their containers' contents tables. To provide this support, handle the PR_ANR restriction in your implementation of <a href="inter026_43lg.htm"><b>IMAPITable::Restrict</b></a> by performing a "best guess" type of search, matching against one or more particular properties that make sense for your provider. You can choose to use the same property or properties every time, such as PR_DISPLAY_NAME or PR_ACCOUNT, or allow an administrator to choose from a list of acceptable properties. </p>
<p>
Although most providers supply their own contents table implementation, you can customize the implementation supplied by MAPI through the <a href="function_8fs5.htm"><b>CreateTable</b></a> function. However, because the MAPI implementation does not support restrictions of any kind, you must create a wrapper object to include a customized version of <b>Restrict </b>that intercepts the call. </p>
<p>&nbsp;</p></body>
</HTML>
