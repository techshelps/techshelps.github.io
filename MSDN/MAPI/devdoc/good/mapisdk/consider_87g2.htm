<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing a Form Viewer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_implementing_a_form_viewer"></a>Implementing a Form Viewer</h2>
<p>
A form viewer includes three objects: a message site, a view advise sink, and a view context. Each of these objects allows you to interact with a form server and its forms. </p>
<p>
A message site is an object that implements the <a href="inter020_5elq.htm"><b>IMAPIMessageSite</b></a> interface and assists form servers with tasks such as moving, saving, or deleting messages, creating new messages, or launching new form servers. Message sites are used by forms to get information about your client's status with respect to various service providers. For example, a form can use your message site to get a pointer to your current message store, a message, or a folder. </p>
<p>
There are two types of methods in the <b>IMAPIMessageSite</b> interface: 
<ul>
<li>
Methods that give information to form objects.</li>
<li>
Methods that manipulate messages.</li>
</ul>
<p>
The methods that give information to form objects are straightforward to implement. In all cases except <a href="inter020_6i43.htm"><b>IMAPIMessageSite::GetSiteStatus</b></a>, you should already have available the information required by each method.</p>
<p>
The methods that manipulate messages should act as if they had been triggered through your regular user interface. For example, if a form object calls your <a href="inter020_5ep1.htm"><b>IMAPIMessageSite::NewMessage</b></a> method, behave as if the user had chosen to compose a new custom message with your regular user interface. Commands which typically generate this behavior are <b>Compose</b>, <b>Open</b>, <b>Reply</b>, <b>Reply to All Recipients</b>, <b>Forward</b>, <b>Print</b>, and <b>Save As</b>.</p>
<p>
A view context is an object that implements the <a href="inter028_4zla.htm"><b>IMAPIViewContext</b></a> interface and provides form servers with a context for the current message, allowing servers to easily switch to the next or previous message in the folder. A form uses a view context for sharing information. With a view context object, a form can:
<ul>
<li>
Register with your client for notifications.</li>
<li>
Activate the next or previous message in the folder.</li>
<li>
Get printing information.</li>
<li>
Get your client's status.</li>
<li>
Get a stream that can be used to save the text version of a message.</li>
</ul>
<p>
Similar to the methods in the <a href="inter020_5elq.htm"><b>IMAPIMessageSite</b></a> interface, the methods in <b>IMAPIViewContext</b> correlate with user actions and client features that relate to the view context. For example, a view context is involved with activating the next or previous message, sorting the contents of the folder, and filtering the contents of the folder. </p>
<p>
It is not important what mechanism you provide for users to activate these features, such as from a button bar or from menu commands; it is only important that the semantics of those features map well to the methods in the <b>IMAPIViewContext</b> interface.</p>
<p>
A view advise sink is an object that implements the <a href="inter027_652m.htm"><b>IMAPIViewAdviseSink</b></a> interface and handles notifications from form servers that affect your viewer and help forms and form viewers to work together. See <a href="consider_8tpv.htm">Sending and Receiving Form Notifications</a> for more information. </p>
<p>&nbsp;</p></body>
</HTML>
