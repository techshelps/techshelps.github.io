<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFormMgr::LoadForm</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapiformmgr_loadform"></a>IMAPIFormMgr::LoadForm</h2>
<p>
The <b>IMAPIFormMgr::LoadForm</b> method launches a form to open an existing message.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter019_3ju6.htm"><b>IMAPIFormMgr : IUnknown</b></a>.</p>
<pre><code><b>HRESULT LoadForm(
  ULONG</b><i> ulUIParam</i><b>,</b>                  
<b>  ULONG</b><i> ulFlags</i><b>,</b>                    
<b>  LPCSTR</b><i> lpszMessageClass</i><b>,</b>          
<b>  ULONG</b><i> ulMessageStatus</i><b>,</b>            
<b>  ULONG</b><i> ulMessageFlags</i><b>,</b>             
<b>  LPMAPIFOLDER</b><i> pFolderFocus</i><b>,</b>        
<b>  LPMAPIMESSAGESITE</b><i> pMessageSite</i><b>,</b>   
<b>  LPMESSAGE</b><i> pmsg</i><b>,</b>                   
<b>  LPMAPIVIEWCONTEXT</b><i> pViewContext</i><b>,</b>   
<b>  REFIID</b><i> riid</i><b>,</b>                      
<b>  LPVOID FAR *</b><i> ppvObj               </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the progress indicator displayed while the form is launched. The <i>ulUIParam </i>parameter is ignored unless the MAPI_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the form is launched. The following flags can be set:
<dl>
<dt>
MAPI_DIALOG</dt>
<dd>
Displays a user interface to provide status or prompt the user for additional information. If this flag is not set, no user interface is displayed.</dd>
<dt>
MAPIFORM_EXACTMATCH</dt>
<dd>
Only message class strings that are an exact match should be resolved.</dd>
</dl>
</dd>
<dt>
<i>lpszMessageClass</i></dt>
<dd>
[in] Pointer to a string naming the message class of the message to be loaded. If NULL is passed in the <i>lpszMessageClass</i> parameter, the message class is determined from the message pointed to by the <i>pmsg</i> parameter.</dd>
<dt>
<i>ulMessageStatus</i></dt>
<dd>
[in] Bitmask of client- or provider-defined flags — copied from the <a href="propb_3c1f.htm">PR_MSG_STATUS</a> property of the message — that provides information on the state of the message. The <i>ulMessageStatus</i> parameter must be set if <i>lpszMessageClass</i> is non-null; otherwise, <i>ulMessageStatus</i> is ignored.</dd>
<dt>
<i>ulMessageFlags</i> </dt>
<dd>
[in] Pointer to a bitmask of flags — copied from the <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property of the message — that indicates the current state of the message. The <i>ulMessageFlags</i> parameter must be set if <i>lpszMessageClass</i> is non-null; otherwise, <i>ulMessageFlags</i> is ignored.</dd>
<dt>
<i>pFolderFocus</i></dt>
<dd>
[in] Pointer to the folder that directly contains the message. The <i>pFolderFocus</i> parameter can be NULL if such a folder doesn't exist — for example, if the message is embedded in another message.</dd>
<dt>
<i>pMessageSite</i></dt>
<dd>
[in] Pointer to the message site of the message.</dd>
<dt>
<i>pmsg</i></dt>
<dd>
[in] Pointer to the message.</dd>
<dt>
<i>pViewContext</i></dt>
<dd>
[in] Pointer to the view context for the message. The <i>pViewContext </i>parameter can be NULL.</dd>
<dt>
<i>riid</i></dt>
<dd>
[in] Interface identifier (IID) of the interface to be used for the returned form object. The <i>refiidToAsk</i> parameter must not be NULL.</dd>
<dt>
<i>ppvObj</i></dt>
<dd>
[out] Pointer to a pointer to the returned interface.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.</dd>
<dt>
MAPI_E_NO_INTERFACE</dt>
<dd>
The form does not support the requested interface.</dd>
<dt>
MAPI_E_NOT_FOUND</dt>
<dd>
The message class passed in <i>lpszMessageClass</i> does not match the message class for any form in the form library.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Form viewers call the <b>IMAPIFormMgr::LoadForm</b><i> </i>method to launch a form for an existing message. <b>LoadForm</b> launches the form object, loads the message into the form object, sets up the appropriate view context if necessary, and returns the requested interface for the form object.</p>
<p>
The <i>pFolderFocus</i> parameter points to the folder containing the message. If the message is embedded within another message, <i>pFolderFocus</i> should be NULL.</p>
<h4>Notes to Implementers</h4>
<p>
If NULL is passed in <i>lpszMessageClass</i>, then the implementation obtains the message's message class, status, and flags from the message's <a href="propa_0ecz.htm">PR_MESSAGE_CLASS</a>, <a href="propb_3c1f.htm">PR_MSG_STATUS</a> and <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> properties. If a message class string is provided in <i>lpszMessageClass</i>, then the implementation must use the values in <i>ulMessageStatus</i> and <i>ulMessageFlags</i>.</p>
<h4>See Also</h4>
<p>
<a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a>, <a href="propb_3c1f.htm">PR_MSG_STATUS</a></p>
<p>&nbsp;</p></body>
</HTML>
