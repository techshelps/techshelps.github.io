<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting Message Service Installation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_supporting_message_service_installation"></a>Supporting Message Service Installation</h2>
<p>
The setup program for installing your message service should:
<ol>
<li>
Copy message service files, such as the message service and service provider DLLs, from a CD or disk to a local drive on the workstation. The files that need to be copied depend on your message service. Typically you will copy at least one DLL.</li>
<li>
Add entries to the MAPISVC.INF configuration file. For information about how to modify this file to support the service providers in your message service, see <a href="appxfile_723q.htm">File Format of MAPISVC.INF</a>.</li>
<li>
Add entries as appropriate to the WIN.INI initialization file for 16-bit message services or the system registry for 32-bit message services. For details about the entries that should appear in the WIN.INI file or the system registry, see <a href="intro_1qzt.htm">Installing MAPI</a>.</li>
<li>
Create a default profile if one does not yet exist using one of the following:<ul>
<li>
NEWPROF utility to create a profile programmatically from information contained in a .PRF file. For more information, see <a href="consider_2equ.htm">Creating a Profile with NEWPROF</a>.</li>
<li>
Profile Wizard to create a profile with user interaction through a series of dialog boxes. For more information about using the Profile Wizard, see <a href="consider_3yec.htm">Creating a Profile with the Profile Wizard</a>.</li>
<li>
Control Panel to create a profile with user interaction. The Control Panel offers the user more flexibility than the Profile Wizard in configuring the message services and setting profile properties. </li>
</ul>
</li>
</ol>
<p>
Place the setup program in a designated public directory. This is important because most configuration clients, such as the Control Panel, require that users enter the name of the directory. The Control Panel invokes a setup program when a user clicks the <b>Add</b> button, invokes the <b>Have Disk</b> dialog box, and specifies the path to the program. The Control Panel runs the program and calls your message service's entry point function with the <i>ulContext</i> parameter set to MSG_SERVICE_INSTALL. </p>
<p>
<b>Warning</b>  Because profiles are an expendable part of the MAPI architecture, make sure that your installation program does not store anything in the default profile that would be difficult to recreate. There are no utilities for profile recovery, for moving profiles from one machine to another, for off-line backup, or for individual or global restoration from backup copies.</p>
<p>&nbsp;</p></body>
</HTML>
