<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Folders</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_folders"></a>Folders</h1>
<p>
Folders are MAPI objects that serve as the basic unit of organization for messages. Arranged hierarchically, folders can contain messages and other folders. Folders make it easier to locate and work with messages. </p>
<p>
Folders implement the <a href="inter013_9ohe.htm"><b>IMAPIFolder</b></a> interface, which indirectly inherits from <b>IUnknown</b> through <b>IMAPIContainer</b> and <b>IMAPIProp</b>. Clients use <b>IMAPIFolder</b> to create, copy, and delete messages and folders, to retrieve and set message status, and to set or clear the read flag for a message. Although message store providers are required to support all the methods in <b>IMAPIFolder</b>, some of them introduce a level of complexity that message store providers might want to avoid. MAPI saves message store providers some work by implementing some of the more complex folder functionality in the <a href="inter025_8uge.htm"><b>IMAPISupport</b></a> interface. Rather than implementing their own copy methods, for example, message store providers can call the copy methods in the support object and get the same results.</p>
<p>
There are three kinds of folders: 
<ul>
<li>
Root folders</li>
<li>
Generic folders</li>
<li>
Search-results folders</li>
</ul>
<p>
Every message store has at least a root folder. The root folder appears at the top of the hierarchy and contains messages and other folders. Root folders cannot be moved, copied, renamed, or deleted. There is only one root folder for each message store.</p>
<p>
Most other folders are generic folders. Like root folders, generic folders contain messages and other folders. Unlike root folders, they can be moved, copied, renamed, and deleted. Generic folders can be created within the root folder or other generic folders. When a client creates a generic folder within another folder, the new folder is called a subfolder, or child folder. The folder in which the new folder is placed is referred to as the parent folder of the new folder. Generic folders that have the same parent are called sibling folders. Both sibling and non-sibling folders may or may not have unique names, depending on the message store provider. Message store providers that require sibling folders to have unique names return the error value MAPI_E_COLLISION when a client attempts to create two folders within the same parent with the same name. </p>
<p>
A search-results folder contains links to messages that match a set of predefined criteria. Because search-results folders contain links rather than actual messages, they are in effect read-only. They cannot contain other folders or have messages or folders moved or copied into them. They cannot have new messages created in them; and they themselves cannot be moved, copied, or renamed. When a message is deleted from a search-results folder, it is actually deleted from the folder that contains the message.</p>
<p>
Folder type is stored in the <a href="propa_0vhh.htm">PR_FOLDER_TYPE</a> property. Every folder has this property set to either FOLDER_GENERIC, FOLDER_ROOT, or FOLDER_SEARCH, depending on its type.</p>
<p>
Every folder has one entry identifier and one record key. The entry identifier, <a href="propa_8cv8.htm">PR_ENTRYID</a>, is used by clients and service providers to open the folder. The record key, <a href="propb_6lkp.htm">PR_RECORD_KEY</a>, is a binary value that is used to compare the folder with other folders. </p>
<p>
A folder has other properties to identify related folders and the message store. The following properties are required:</p>
<p class=indent1>
<a href="propb_3d7o.htm">PR_PARENT_ENTRYID</a></p>
<p class=indent1>
<a href="propb_2vqc.htm">PR_STORE_ENTRYID</a></p>
<p class=indent1>
<a href="propb_7hrt.htm">PR_STORE_RECORD_KEY</a></p>
<p>
Some folders support the <a href="propa_63eb.htm">PR_ACCESS</a> property which describes the type of operations a user can perform. For example, one of the valid settings for PR_ACCESS is MAPI_ACCESS_DELETE, indicating that the folder can be removed. Another setting, MAPI_ACCESS_MODIFY, indicates that the folder should be modifiable. </p>
<p>
For a complete list of required folder properties, see <a href="inter013_9ohe.htm"><b>IMAPIFolder</b></a>. </p>
<p>&nbsp;</p></body>
</HTML>
