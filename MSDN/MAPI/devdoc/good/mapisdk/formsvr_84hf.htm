<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving Form Properties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_retrieving_form_properties"></a>Retrieving Form Properties</h2>
<p>
To issue a query meaningful to a custom message type, an application needs to know the properties expected on that message. To get a list of properties used by a custom message class, a client application queries the MAPI form manager. The form manager gets this information from the appropriate form configuration file so that this information can be used by client applications without the overhead of activating the form server itself. To do this, the client application calls <a href="inter019_3qcz.htm"><b>IMAPIFormMgr::ResolveMessageClass</b></a>, like this:</p>
<pre><code>IMAPIFormInfo *pfrminf = NULL;
hr = pfrmmgr-&gt;ResolveMessageClass("IPM.Demo", 0L, NULL, &amp;pfrminf);
 </code></pre>
<p>
Note that the third argument to <b>ResolveMessageClass</b> is the folder containing the associated contents table that the query will search for form servers. NULL indicates that the form manager should search all available form containers. If the query is to run against a particular folder it is better to include the appropriate <b>IMAPIFolder</b> pointer instead.</p>
<p>&nbsp;</p></body>
</HTML>
