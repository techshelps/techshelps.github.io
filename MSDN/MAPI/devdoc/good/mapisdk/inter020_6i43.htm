<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIMessageSite::GetSiteStatus</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapimessagesite_getsitestatus"></a>IMAPIMessageSite::GetSiteStatus</h2>
<p>
The <b>IMAPIMessageSite::GetSiteStatus</b> method returns information from a message site object about the message site's capabilities for the current message.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter020_5elq.htm"><b>IMAPIMessageSite : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetSiteStatus(
  ULONG FAR *</b><i> lpulStatus  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpulStatus</i></dt>
<dd>
[out] Pointer to a bitmask of flags giving information on message status. The following flags can be set: 
<dl>
<dt>
VCSTATUS_COPY</dt>
<dd>
The message can be copied. </dd>
<dt>
VCSTATUS_DELETE</dt>
<dd>
The message can be deleted.</dd>
<dt>
VCSTATUS_DELETE_IS_MOVE</dt>
<dd>
When deleted, a message is actually moved to a Deleted Items folder in its message store rather than being immediately removed from its message store.</dd>
<dt>
VCSTATUS_MOVE</dt>
<dd>
The message can be moved.</dd>
<dt>
VCSTATUS_NEW_MESSAGE</dt>
<dd>
A new message can be created.</dd>
<dt>
VCSTATUS_SAVE</dt>
<dd>
The message can be saved.</dd>
<dt>
VCSTATUS_SUBMIT</dt>
<dd>
The message can be submitted.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Form objects call the <b>IMAPIMessageSite::GetSiteStatus </b>method to obtain the message site object's capabilities for the current message. The flags returned in the <i>lpulStatus</i> parameter provide information on the message site; typically, a form enables or disables menu commands based on information the flags provide on the capabilities of the message site implementation. If a new message is loaded into a form by the <a href="inter034_4uck.htm"><b>IPersistMessage::SaveCompleted</b></a> method or the <a href="inter034_69wk.htm"><b>IPersistMessage::Load</b></a> method, the status flags must be checked. Some message site objects, particularly read-only ones, do not permit messages to be saved or deleted.</p>
<h4>Notes to Implementers</h4>
<p>
<b>IMAPIMessageSite::GetSiteStatus</b> may require your client application to do some calculation to determine what operations can and can't be performed on the current message. Typically, that involves looking at the status row for the current message's message store provider, or querying the store provider directly to determine which actions the client application can perform using the message store. For example, determining whether to return the MAPI_DELETE_IS_MOVE flag could be done by checking the message store object's <a href="propa_3qxw.htm">PR_IPM_WASTEBASKET_ENTRYID</a> property to see whether there is a Deleted Items folder in the message store.</p>
<p>
For a list of interfaces related to form servers, see <a href="formsarc_4r03.htm">MAPI Form Interfaces</a>.</p>
<h4>See Also</h4>
<p>
<a href="inter034_69wk.htm"><b>IPersistMessage::Load</b></a>, <a href="inter034_4uck.htm"><b>IPersistMessage::SaveCompleted</b></a></p>
<p>&nbsp;</p></body>
</HTML>
