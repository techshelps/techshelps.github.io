<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Guidelines for Allocating Scarce Resources</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_mapi1book_guidelines_for_allocating_scarce_resources"></a>Guidelines for Allocating Scarce Resources</h3>
<p>
Transport providers that use scarce resources — such as a modem or COM port — to send and receive messages or message headers need to adhere to the following conventions in order to avoid resource conflicts with other transport providers:
<ul>
<li>
Transport providers can allocate scarce resources when the <a href="inter043_2r72.htm"><b>TransportLogon</b></a> method is called and retain them until the <a href="inter042_8gvn.htm"><b>RegisterOptions</b></a> method returns, at which time the resources must be released.</li>
<li>
Transport providers can allocate scarce resources when the <a href="inter042_18v9.htm"><b>SubmitMessage</b></a> method is called and retain them before returning from the subsequent call to the <a href="inter042_576t.htm"><b>EndMessage</b></a> method.</li>
<li>
Transport providers can allocate scarce resources for the duration of a call to the <a href="inter042_1a1x.htm"><b>StartMessage</b></a> method. The transport provider must release the resources before returning.</li>
<li>
Transport providers that need to keep a resource open across multiple method calls, such as while flushing queues, should signal the MAPI spooler of this need by setting the STATUS_INBOUND_ENABLED or STATUS_OUTBOUND_ENABLED bits in the transport provider's <a href="propb_2zj9.htm">PR_STATUS_CODE</a> property in the MAPI status table.<p>
When the MAPI spooler next makes a call to a method in the transport provider's logon object the transport provider can allocate the resource. The transport provider can keep the resource until the time that the action, such as flushing queues, is completed. In some cases, the transport provider will already hold the resource before calling the <a href="inter025_0oxj.htm"><b>IMAPISupport::ModifyStatusRow</b></a> method to update the transport provider's PR_STATUS_CODE property. This will cause some multi-transport operations to fail, but is sometimes unavoidable. The MAPI spooler will handle errors in such cases.
</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
