<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMessage::SubmitMessage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imessage_submitmessage"></a>IMessage::SubmitMessage</h2>
<p>
The <b>IMessage::SubmitMessage</b> method saves all of the message's properties and marks the message as ready to be sent.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter029_525s.htm"><b>IMessage : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT SubmitMessage(
  ULONG</b><i> ulFlags  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags used to control how a message is submitted. The following flag can be set:
<dl>
<dt>
FORCE_SUBMIT</dt>
<dd>
MAPI should submit the message immediately. This flag is not currently in use. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.</dd>
<dt>
MAPI_E_NO_RECIPIENTS</dt>
<dd>
The message's recipient table is empty.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMessage::SubmitMessage</b> method marks a message as ready to be transmitted. MAPI passes messages to the underlying messaging system in the order in which they are marked for sending. Because of this functionality, a message might stay in a message store for some time before the underlying messaging system can take responsibility for it. The order of receipt at the destination is in the underlying messaging system's control and does not necessarily match the order in which messages were sent.</p>
<h4>Notes to Implementers</h4>
<p>
Call the message's<b> <a href="inter022_5rqr.htm">IMAPIProp::SaveChanges</a></b> method to save it and then check the message's <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property. If the MSGFLAG_RESEND flag is set, call <a href="inter025_5q5w.htm"><b>IMAPISupport::PrepareSubmit</b></a>. <b>PrepareSubmit</b> updates the recipient type and <a href="propb_92pl.htm">PR_RESPONSIBILITY</a> property for all of the recipients in the resend message.</p>
<h4>Notes to Callers</h4>
<p>
When <b>SubmitMessage</b> returns, all pointers to the message and its associated subobjects — messages, folders, attachments, streams, tables, and so on — are no longer valid. MAPI does not permit any further operations on these pointers, except for calling their <b>IUnknown::Release</b> methods. MAPI is designed such that after <b>SubmitMessage</b> is called, you should release the message and all associated subobjects. However, if <b>SubmitMessage</b> returns an error value indicating missing or invalid information, the message remains open and the pointers remain valid. </p>
<p>
To cancel a send operation, get and store a pointer to the message's <a href="propa_8cv8.htm">PR_ENTRYID</a> property before the message is submitted. Because a message's entry identifier is invalidated after the message has been submitted, it is necessary to save it before calling <b>SubmitMessage</b>. To cancel the send, point the <i>lpEntryId</i> parameter to this entry identifier and call <a href="inter031_5gac.htm"><b>IMsgStore::AbortSubmit</b></a>.</p>
<h4>See Also</h4>
<p>
<a href="inter031_5gac.htm"><b>IMsgStore::AbortSubmit</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
