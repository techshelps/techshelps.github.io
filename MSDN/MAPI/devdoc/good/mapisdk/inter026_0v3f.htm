<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPITable::CreateBookmark</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapitable_createbookmark"></a>IMAPITable::CreateBookmark</h2>
<p>
The <b>IMAPITable::CreateBookmark</b> method marks the table's current position.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>.</p>
<pre><code><b>HRESULT CreateBookmark(
  BOOKMARK FAR *</b><i> lpbkPosition  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpbkPosition</i></dt>
<dd>
[out] Pointer to the returned 32-bit bookmark value. This bookmark can later be passed in a call to the <a href="inter026_8xx3.htm"><b>IMAPITable::SeekRow</b></a> method.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The call succeeded and has returned the expected value or values.</dd>
<dt>
MAPI_E_UNABLE_TO_COMPLETE</dt>
<dd>
The requested operation could not be completed.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPITable::CreateBookmark</b> method marks a table position by creating a value called a bookmark. A bookmark can be used to return to the position identified by the bookmark. The bookmarked position is associated with the object at that row in the table. </p>
<p>
Bookmarks are not supported on attachment tables, and attachment table implementations of <b>CreateBookmark</b> return MAPI_E_NO_SUPPORT.</p>
<h4>Notes to Implementers</h4>
<p>
Because of the memory expense of maintaining cursor positions with bookmarks, limit the number of bookmarks that you can create. When you reach that number, return MAPI_E_UNABLE_TO_COMPLETE from all subsequent calls to <b>CreateBookmark</b>.</p>
<p>
Sometimes a bookmark points to a row that is no longer in the table view. If a caller uses such a bookmark, move the cursor to the next visible row and stop there. </p>
<p>
When the caller attempts to use a bookmark that is pointing to a nonvisible row because it has been collapsed, return MAPI_W_POSITION_CHANGED after moving the bookmark. You can reposition the bookmark to the next visible row either at this time or when the collapsing occurs in the <b>SetCollapseState</b> method. If you move the bookmark at the time the row is collapsed, you must retain a bit in the bookmark that indicates exactly when the bookmark was moved: since its last use or — if it has never been used — since its creation.</p>
<h4>Notes to Callers</h4>
<p>
<b>CreateBookmark </b>allocates memory for the bookmark it creates. Release the resources for the bookmark by calling the <a href="inter026_7t63.htm"><b>IMAPITable::FreeBookmark</b></a><b> </b>method.</p>
<h4>See Also</h4>
<p>
<a href="inter026_7t63.htm"><b>IMAPITable::FreeBookmark</b></a>, <a href="inter026_8xx3.htm"><b>IMAPITable::SeekRow</b></a></p>
<p>&nbsp;</p></body>
</HTML>
