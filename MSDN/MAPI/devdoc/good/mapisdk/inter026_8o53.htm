<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPITable::ExpandRow</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapitable_expandrow"></a>IMAPITable::ExpandRow</h2>
<p>
The <b>IMAPITable::ExpandRow</b> method expands a collapsed table category, adding the leaf rows belonging to the category to the table view. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>.</p>
<pre><code><b>HRESULT ExpandRow(
  ULONG</b><i> cbInstanceKey</i><b>,</b>   
<b>  LPBYTE</b><i> pbInstanceKey</i><b>,</b>  
<b>  ULONG</b><i> ulRowCount</i><b>,</b>      
<b>  ULONG</b><i> ulFlags</i><b>,</b>         
<b>  LPSRowSet FAR *</b><i> lppRows</i><b>,</b>   
<b>  ULONG FAR *</b><i> lpulMoreRows  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cbInstanceKey</i></dt>
<dd>
[in] Count of bytes in the PR_INSTANCE_KEY property pointed to by the <i>pbInstanceKey</i> parameter.</dd>
<dt>
<i>pbInstanceKey</i></dt>
<dd>
[in] Pointer to the <a href="propa_65h5.htm">PR_INSTANCE_KEY</a> property that identifies the heading row for the category. </dd>
<dt>
<i>ulRowCount</i></dt>
<dd>
[in] Maximum number of leaf rows to add to the table view. </dd>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<i>lppRows</i></dt>
<dd>
[out] Pointer to an <a href="structyp_2378.htm"><b>SRowSet</b></a> structure holding the leaf rows that have been inserted into the table view as a result of the expansion. These rows are inserted after the heading row identified by the <i>pbInstanceKey</i> parameter. The <i>lppRows</i> parameter can be NULL if the <i>ulRowCount</i> parameter is zero.</dd>
<dt>
<i>lpulMoreRows</i></dt>
<dd>
[out] Pointer to the total number of rows that were added to the table view. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The category was expanded successfully.</dd>
<dt>
MAPI_E_NOT_FOUND</dt>
<dd>
The row identified by the <i>pbInstanceKey</i> parameter does not exist.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPITable::ExpandRow</b> method expands a collapsed table category, adding the leaf rows that belong to the category to the table view. A limit to the number of rows to be included in the expanded category can be specified in the <i>ulRowCount</i> parameter. When <i>ulRowCount</i> is set to a value greater than zero and one or more rows are returned in the row set pointed to by <i>lppRows</i>, the position of the bookmark BOOKMARK_CURRENT is moved to the row immediately following the last row in the row set.</p>
<p>
When <i>ulRowCount</i> is set to zero, requesting that zero leaf rows be added to the category, or zero rows are returned because there are no leaf rows in the category, the position of BOOKMARK_CURRENT is set to the row following the row identified by <i>pbInstanceKey</i>. </p>
<h4>Notes to Implementers</h4>
<p>
Do not generate notifications on rows that are added to a table view due to category expansion.</p>
<h4>Notes to Callers</h4>
<p>
The number of rows in the row set pointed to by the <i>lppRows</i> parameter might not equal the number of rows that were actually added to the table, the entire set of leaf rows for the category. Errors can occur, such as insufficient memory, or the number of rows in the category exceeding the number specified in <i>ulRowCount</i> parameter. In either case, BOOKMARK_CURRENT will be positioned at the last row returned. To immediately retrieve the rest of the rows in the category, call <a href="inter026_7wkz.htm"><b>IMAPITable::QueryRows</b></a>.</p>
<p>
Do not expect to receive a table notification when a category changes its state. You can maintain a local cache of rows that can be updated with every <b>ExpandRow</b> or <b>CollapseRow</b> call.</p>
<p>
For more information about categorized tables, see <a href="tables_2wq6.htm">Sorting and Categorization</a>.</p>
<h4>See Also</h4>
<p>
<a href="inter026_43w7.htm"><b>IMAPITable::CollapseRow</b></a></p>
<p>&nbsp;</p></body>
</HTML>
