<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIContainer::GetContentsTable</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapicontainer_getcontentstable"></a>IMAPIContainer::GetContentsTable</h2>
<p>
The <b>IMAPIContainer::GetContentsTable</b> method returns a pointer to the container's contents table.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter011_7u0g.htm"><b>IMAPIContainer : IMAPIProp</b></a>.</p>
<pre><code><b>HRESULT GetContentsTable(
  ULONG</b><i> ulFlags</i><b>,</b>              
<b>  LPMAPITABLE FAR *</b><i> lppTable  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls how the contents table is returned. The following flags can be set:
<dl>
<dt>
MAPI_ASSOCIATED</dt>
<dd>
The container's associated contents table should be returned rather than the standard contents table. This flag is used only with folders. The messages that are included in the associated contents table were created with the MAPI_ASSOCIATED flag set in the call to <a href="inter013_7wv9.htm"><b>IMAPIFolder::CreateMessage</b></a>. Clients typically use the associated contents table to retrieve forms and views. </dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
<b>GetContentsTable</b> can return successfully, possibly before the table is made accessible to the caller. If the table is not accessible, making a subsequent table call can result in an error.</dd>
<dt>
MAPI_UNICODE</dt>
<dd>
Requests that the columns containing string data be returned in the Unicode format. If the MAPI_UNICODE flag is not set, the strings should be returned in the ANSI format. </dd>
</dl>
</dd>
<dt>
<i>lppTable</i></dt>
<dd>
[out] Pointer to a pointer to the contents table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The contents table was successfully retrieved.</dd>
<dt>
MAPI_E_BAD_CHARWIDTH</dt>
<dd>
Either the MAPI_UNICODE flag was set and the implementation does not support Unicode, or MAPI_UNICODE was not set and the implementation only supports Unicode.</dd>
<dt>
MAPI_E_NO_SUPPORT</dt>
<dd>
The container has no contents and cannot provide a contents table.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIContainer::GetContentsTable</b> method returns a pointer to the contents table of a container. A contents table contains summary information about objects within the container. </p>
<p>
Contents tables have lengthy column sets. For a complete list of the required and optional columns in contents tables, see <a href="tables_9i9f.htm">Contents Tables</a>. </p>
<p>
It is possible for some containers to have no contents. These containers return MAPI_E_NO_SUPPORT from their implementations of <b>GetContentsTable</b>.</p>
<h4>Notes to Implementers</h4>
<p>
If you support a contents table for your container, you must also:
<ul>
<li>
Support calls to the container's <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a> method to open the <a href="propa_4df7.htm">PR_CONTAINER_CONTENTS</a> property.</li>
<li>
Return PR_CONTAINER_CONTENTS in response to a call to the container's <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a> and <a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a> methods.</li>
</ul>
<p>
A remote transport provider's implementation of this method must return a pointer to an <b>IMAPITable</b> interface in the <i>ppTable</i> parameter passed into the <b>GetContentsTable</b> method. If your transport provider has an existing contents table, it suffices to return a pointer to it. If not, then this method must create a new <b>IMAPITable</b> object, populate the table with message headers (if any are available), and return a pointer to the new table. The <b>ITableData</b> method <b>HrGetView</b> is useful for generating a return value and storing the table pointer in the <i>ppTable</i> parameter. The contents table must support at least the following property columns:  </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="propa_8cv8.htm">PR_ENTRYID</a></td>
<td width=52%><a href="propb_9orp.htm">PR_SENDER_NAME</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_799h.htm">PR_SENT_REPRESENTING_NAME</a></td>
<td width=52%><a href="propa_8hkf.htm">PR_DISPLAY_TO</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_3c8k.htm">PR_SUBJECT</a></td>
<td width=52%><a href="propa_0ecz.htm">PR_MESSAGE_CLASS</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a></td>
<td width=52%><a href="propa_97fp.htm">PR_MESSAGE_SIZE</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_277d.htm">PR_PRIORITY</a></td>
<td width=52%><a href="propa_2b39.htm">PR_IMPORTANCE</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_9mk9.htm">PR_SENSITIVITY</a></td>
<td width=52%><a href="propa_17ad.htm">PR_MESSAGE_DELIVERY_TIME</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propb_3c1f.htm">PR_MSG_STATUS</a></td>
<td width=52%><a href="propa_4dd1.htm">PR_MESSAGE_DOWNLOAD_TIME</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propa_404o.htm">PR_HASATTACH</a></td>
<td width=52%><a href="propb_0okl.htm">PR_OBJECT_TYPE</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="propa_65h5.htm">PR_INSTANCE_KEY</a></td>
<td width=52%><a href="propb_5xo4.htm">PR_NORMALIZED_SUBJECT</a></td>
</tr>
</table><br>
<p>
</p>
<h4>Notes to Callers</h4>
<p>
String and binary contents table columns can be truncated. Typically, providers return 255 characters. Because you cannot know ahead of time whether or not a table includes truncated columns, assume that a column is truncated if the length of the column is either 255 or 510 bytes. You can always retrieve the full value of a truncated column if necessary from the object directly by using its entry identifier to open it and then calling the <b>IMAPIProp::GetProps</b> method.</p>
<p>
Depending on the provider's implementation, restrictions and sorting operations can apply to an entire string or to the truncated version of that string.</p>
<h4>See Also</h4>
<p>
<a href="inter022_79v8.htm"><b>IMAPIProp::GetPropList</b></a>, <a href="inter022_44c3.htm"><b>IMAPIProp::GetProps</b></a>, <a href="inter022_15vd.htm"><b>IMAPIProp::OpenProperty</b></a>, <a href="inter026_44ry.htm"><b>IMAPITable : IUnknown</b></a>, <a href="propa_4df7.htm">PR_CONTAINER_CONTENTS</a></p>
<p>&nbsp;</p></body>
</HTML>
