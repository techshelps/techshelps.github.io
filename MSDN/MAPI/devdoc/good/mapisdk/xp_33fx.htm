<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Transport Provider's Role in the MAPI Subsystem</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_transport_providers_role_in_the_mapi_subsystem"></a>Transport Provider's Role in the MAPI Subsystem</h1>
<p>
Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and that part of a messaging system responsible for message sending and receiving. The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message. The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed. Multiple transports can be installed on the same system, but MAPI supplies the one spooler required.</p>
<p>
Client applications do not typically communicate directly with the transport provider; rather, clients submit messages through a store provider, and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store. The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle. After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues. </p>
<p>
Transport providers have the following responsibilities in a MAPI messaging system:
<ul>
<li>
Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages. One transport provider can register more than one address type. Transport providers can also register specific recipients' addresses with the MAPI spooler. Messages addressed to one of these addresses will be submitted to the transport provider that registered this address with the MAPI spooler. For more information, see <a href="xp_87fw.htm">Transport Provider-MAPI Spooler Operational Model</a>.</li>
<li>
Deliver incoming messages to the MAPI spooler. Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or can request that the MAPI spooler poll the transport provider periodically to check for new messages.</li>
<li>
Convert MAPI message properties to and from message properties native to the messaging system. For example, the transport provider might have to convert the sender's and recipients' addresses in an outgoing message to a form that is acceptable to the messaging system. Some messaging systems do not support all of the MAPI message properties. For information on preserving MAPI message properties when delivering messages to a messaging system, see <a href="xptnef_6d9u.htm">Developing a TNEF-Enabled Transport Provider</a>.</li>
<li>
Register message and recipient options specific to the transport provider.</li>
<li>
Perform any verification of credentials required by the messaging system.</li>
<li>
Access outbound messages using the message object passed to it by the MAPI spooler.</li>
<li>
Translate message format as required by the underlying messaging system.</li>
<li>
Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the <a href="propb_92pl.htm">PR_RESPONSIBILITY</a> property for those recipients.</li>
<li>
Inform the MAPI spooler when an incoming message needs to be handled.</li>
<li>
Pass incoming message data to the MAPI spooler by using message objects.</li>
<li>
Assign values to all required MAPI message properties on incoming messages.</li>
<li>
Delete the message from the underlying messaging system after delivery, if necessary.</li>
<li>
Provide status information for the MAPI spooler and client applications.</li>
</ul>
<p>
The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</p>
<p>
<img src="images/xp01.gif" border=0></p>
<p>&nbsp;</p></body>
</HTML>
