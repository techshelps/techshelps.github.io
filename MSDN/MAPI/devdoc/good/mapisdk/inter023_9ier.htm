<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPISession::MessageOptions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapisession_messageoptions"></a>IMAPISession::MessageOptions</h2>
<p>
The <b>IMAPISession::MessageOptions</b> method displays a dialog box showing option properties for a particular address type and message.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter023_64ry.htm"><b>IMAPISession : IUnknown</b></a>.</p>
<pre><code><b>HRESULT MessageOptions(
  ULONG</b><i> ulUIParam</i><b>,</b>     
<b>  ULONG</b><i> ulFlags</i><b>,</b>       
<b>  LPTSTR</b><i> lpszAdrType</i><b>,</b>  
<b>  LPMESSAGE</b><i> lpMessage  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the dialog box.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the format of the message option properties. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The message option properties are in Unicode format. If the MAPI_UNICODE flag is not set, the message option properties are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lpszAdrType</i></dt>
<dd>
[in] Pointer to the address type for which option properties should be displayed, or NULL, indicating that all message option properties for all transport providers should be displayed.</dd>
<dt>
<i>lpMessage</i></dt>
<dd>
[in] Pointer to the message for which option properties should be displayed.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The dialog box was successfully displayed.</dd>
<dt>
MAPI_E_NOT_FOUND</dt>
<dd>
No options were registered for the message and address type.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPISession::MessageOptions</b> method presents a dialog box displaying properties that relate to a particular message and addess type. These properties are under the control of the transport provider handling the address type. Users can make changes to the properties, but these changes do not take affect until the client calls the message's <a href="inter022_5rqr.htm"><b>IMAPIProp::SaveChanges</b></a> method. </p>
<p>
Users can make changes to option properties that apply to:
<ul>
<li>
A particular message and address type.</li>
<li>
All messages for a particular address type.</li>
</ul>
<p>
Changes made to the option properties for a particular message and address type do not affect the option properties that apply to all messages. </p>
<p>
For more information about working with message option properties, see <a href="consider_48z7.htm">Message and Recipient Options</a>.</p>
<p>&nbsp;</p></body>
</HTML>
