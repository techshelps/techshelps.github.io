<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Starting a CMC Session</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_starting_a_cmc_session"></a>Starting a CMC Session</h1>
<p>
CMC function calls occur within the context of a messaging session. Establish a <a href="glossary_4s37.htm#_mapi1book_gly_session">session</a> with a call to the <a href="cmcref_3dbi.htm"><b>cmc_logon</b></a> function. The <b>cmc_logon</b> function checks the user's credentials for the messaging system, sets session attributes, and returns a session handle for use in later CMC calls. Session attributes include the character set and version number for the CMC API. Currently, the CMC API provides no support for sharing sessions among clients. End a session with a call to the <a href="cmcref_5o4m.htm"><b>cmc_logoff</b></a> function.</p>
<p>
You can convert the CMC session handles to MAPI session handles with the <a href="function_5fhf.htm"><b>ScMAPIXFromCMC</b></a> function. For example, you can convert the session handle returned from the <b>cmc_logon</b> function to an LPMAPISESSION value and use it to access the methods in the <a href="inter023_64ry.htm"><b>IMAPISession</b></a> interface. This enables you to use CMC for the bulk of your messaging tasks without sacrificing access to MAPI functions. CMC session handles cannot be converted to Simple MAPI session handles. Clients that need both CMC and Simple MAPI functionality must maintain separate sessions for each.</p>
<p>
You can also use the <a href="cmcref_2nu6.htm"><b>cmc_query_configuration</b></a> function to determine logon identity and messaging options before calling the <a href="cmcref_3dbi.htm"><b>cmc_logon</b></a> function.</p>
<p>&nbsp;</p></body>
</HTML>
