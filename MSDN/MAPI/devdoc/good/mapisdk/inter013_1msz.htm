<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMAPIFolder::SetReadFlags</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_imapifolder_setreadflags"></a>IMAPIFolder::SetReadFlags</h2>
<p>
The <b>IMAPIFolder::SetReadFlags</b> method sets or clears the MSGFLAG_READ flag in the <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property of one or more of the folder's messages and manages the sending of read reports. </p>
<h4>Quick Info</h4>
<p>
See <a href="inter013_9ohe.htm"><b>IMAPIFolder : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT SetReadFlags(
  LPENTRYLIST</b><i> lpMsgList</i><b>,</b>   
<b>  ULONG</b><i> ulUIParam</i><b>,</b>         
<b>  LPMAPIPROGRESS</b><i> lpProgress</i><b>,</b>   
<b>  ULONG</b><i> ulFlags            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpMsgList</i></dt>
<dd>
[in] Pointer to an array of <a href="structyp_8o1g.htm"><b>ENTRYLIST</b></a> structures that identify the message or messages with read flags to set or clear. If <i>lpMsgList</i> is set to NULL, the read flags for all of the folder's messages are set or cleared.</dd>
<dt>
<i>ulUIParam</i></dt>
<dd>
[in] Handle of the parent window for the progress indicator. The <i>ulUIParam</i> parameter is ignored unless the MESSAGE_DIALOG flag is set in the <i>ulFlags</i> parameter.</dd>
<dt>
<i>lpProgress</i></dt>
<dd>
[in] Pointer to a progress object for displaying a progress indicator. If NULL is passed in <i>lpProgress</i>, the message store provider displays a progress indicator using MAPI's implementation. The <i>lpProgress</i> parameter is ignored unless the MESSAGE_DIALOG flag is set in <i>ulFlags</i>.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the setting of a message's read flag and the processing of read reports. The following flags can be set:
<dl>
<dt>
CLEAR_READ_FLAG</dt>
<dd>
The MSGFLAG_READ flag should be cleared in <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> and no read report should be sent. </dd>
<dt>
CLEAR_NRN_PENDING</dt>
<dd>
The MSGFLAG_NRN_PENDING flag should be cleared in PR_MESSAGE_FLAGS and a nonread report should not be sent.</dd>
<dt>
CLEAR_RN_PENDING</dt>
<dd>
The MSGFLAG_RN_PENDING flag should be cleared in PR_MESSAGE_FLAGS and no read report should be sent.</dd>
<dt>
GENERATE_RECEIPT_ONLY</dt>
<dd>
A read report should be sent if one is pending, but there should be no change in the state of the MSGFLAG_READ flag.</dd>
<dt>
MAPI_DEFERRED_ERRORS</dt>
<dd>
Allows <b>SetReadFlags</b> to return successfully, possibly before the operation has completed. </dd>
<dt>
MESSAGE_DIALOG</dt>
<dd>
Displays a progress indicator while the operation proceeds.</dd>
<dt>
SUPPRESS_RECEIPT</dt>
<dd>
A pending read report should be canceled if a read report had been requested and this call changes the state of the message from unread to read. If this call does not change the state of the message, the message store provider can ignore this flag. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The read flag for the specified message or messages was successfully set or cleared.</dd>
<dt>
MAPI_E_NO_SUPPRESS</dt>
<dd>
The message store provider does not support the suppression of read reports.</dd>
<dt>
MAPI_E_INVALID_PARAMETER</dt>
<dd>
One of the following combinations of flags is set in the <i>ulFlags</i> parameter:
<ul>
<li>
SUPPRESS_RECEIPT | CLEAR_READ_FLAG </li>
<li>
SUPPRESS_RECEIPT | CLEAR_READ_FLAG | GENERATE_RECEIPT_ONLY</li>
<li>
CLEAR_READ_FLAG | GENERATE_RECEIPT_ONLY</li>
</ul>
</dd>
<dt>
MAPI_W_PARTIAL_COMPLETION</dt>
<dd>
The call succeeded, but not all of the messages were successfully processed. When this warning is returned, the call should be handled as successful. To test for this warning, use the <b>HR_FAILED</b> macro. See <a href="extend_5k9z.htm">Using Macros for Error Handling</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IMAPIFolder::SetReadFlags</b> method sets or clears the MSGFLAG_READ flag in the <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property of one or more of the folder's messages. Setting the MSGFLAG_READ flag marks a message as having been read, which does not necessarily indicate that the intended recipient has actually read the message.</p>
<p>
<b>SetReadFlags</b> also manages the sending of read reports. </p>
<p>
The read flag cannot be altered for:
<ul>
<li>
Messages that do not exist.</li>
<li>
Messages that have been moved elsewhere.</li>
<li>
Messages that are open with read/write access.</li>
<li>
Messages that are currently submitted.</li>
</ul>
<h4>Notes to Implementers</h4>
<p>
You can choose not to support the sending of read reports and the request to suppress read reports. To avoid suppressing a read report, return MAPI_E_NO_SUPPRESS when <b>SetReadFlags</b> is called with SUPPRESS_RECEIPT set in <i>ulFlags.</i> </p>
<p>
When <i>lpMsgList</i> points to more than one message, perform the operation as completely as possible for each message. Do not stop the operation prematurely unless a failure occurs that is beyond your control, such as running out of memory, running out of disk space, or corruption in the message store.</p>
<p>
If none of the flags is set in the <i>ulFlags</i> parameter, the following rules apply:
<ul>
<li>
If MSGFLAG_READ is already set, do nothing.</li>
<li>
If MSGFLAG_READ is not set, set it immediately and send any pending read reports if the <a href="propb_07qc.htm">PR_READ_RECEIPT_REQUESTED</a> property is set.</li>
</ul>
<p>
When the SUPPRESS_RECEIPT flag is set:
<ul>
<li>
If MSGFLAG_READ is already set, do nothing. </li>
<li>
If MSGFLAG_READ is not set, set it and cancel any pending read reports.</li>
</ul>
<p>
When the CLEAR_READ_FLAG flag is set, clear the MSGFLAG_READ flag in each message's <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a> property and do not send any read reports. </p>
<p>
When the GENERATE_RECEIPT_ONLY flag is set, send any pending read reports. Do not set or clear MSGFLAG_READ.</p>
<p>
When both the SUPPRESS_RECEIPT and GENERATE_RECEIPT_ONLY flags are set, set PR_READ_RECEIPT_REQUESTED to FALSE if it is set and do not send a read report.</p>
<h4>Notes to Callers</h4>
<p>
Expect these return values under the following conditions:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Condition</th>
<th align=left width=52%>Return value</th>
</tr>
<tr valign=top>
<td width=48%><b>SetReadFlags</b> has successfully processed every message.</td>
<td width=52%>S_OK</td>
</tr>
<tr valign=top>
<td width=48%><b>SetReadFlags</b> was unable to successfully process every message.</td>
<td width=52%>MAPI_W_PARTIAL_COMPLETION or MAPI_E_NOT_FOUND</td>
</tr>
<tr valign=top>
<td width=48%><b>SetReadFlags </b>was unable to complete.</td>
<td width=52%>Any error value except MAPI_E_NOT_FOUND</td>
</tr>
</table><br>
<p>
When <b>SetReadFlags</b> is unable to complete, do not assume that no work was done. <b>SetReadFlags</b> might have been able to set or clear the MSGFLAG_READ flag for one or more of the messages before encountering the error. </p>
<h4>See Also</h4>
<p>
<a href="inter029_4x47.htm"><b>IMessage::SetReadFlag</b></a>, <a href="propa_95wz.htm">PR_MESSAGE_FLAGS</a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
