<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IABContainer::ResolveNames</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iabcontainer_resolvenames"></a>IABContainer::ResolveNames</h2>
<p>
The <b>IABContainer::ResolveNames</b> method performs name resolution for one or more recipient entries.</p>
<h4>Quick Info</h4>
<p>
See <a href="inter003_4gxe.htm"><b>IABContainer : IMAPIContainer</b></a>.</p>
<pre><code><b>HRESULT ResolveNames(
  LPSPropTagArray</b><i> lpPropTagArray</i><b>,</b>   
<b>  ULONG</b><i> ulFlags</i><b>,</b>                    
<b>  LPADRLIST</b><i> lpAdrList</i><b>,</b>              
<b>  LPFlagList</b><i> lpFlagList             </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpPropTagArray</i></dt>
<dd>
[in] Pointer to an <a href="structyp_23i1.htm"><b>SPropTagArray</b></a> structure containing an array of property tags describing the properties to be included in the <b>ADRLIST</b> structure returned by the provider. To request the provider's default set of properties, pass NULL in the <i>lpPropTagArray</i> parameter.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags that controls the type of the text in the returned strings. The following flag can be set:
<dl>
<dt>
MAPI_UNICODE</dt>
<dd>
The returned string properties are in Unicode<b> </b>format. If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</dd>
</dl>
</dd>
<dt>
<i>lpAdrList</i></dt>
<dd>
[in, out] On input, pointer to an <a href="structyp_87n8.htm"><b>ADRLIST</b></a><b> </b>structure containing the list of recipients to be resolved. On output, pointer to an <b>ADRLIST</b> structure containing the resolved names.</dd>
<dt>
<i>lpFlagList</i></dt>
<dd>
[in, out] Pointer to an array of flags; each flag corresponding to an <a href="structyp_6m49.htm"><b>ADRENTRY</b></a> structure in the <i>lpAdrList</i> parameter, that provides the status of the name resolution operation for the recipient. The flags in the <i>lpFlagList</i> parameter are in the same order as the entries in <i>lpAdrList</i>. The following flags can be set:
<dl>
<dt>
MAPI_AMBIGUOUS</dt>
<dd>
The corresponding recipient has been resolved, but not to a unique entry identifier. Other containers should not try to resolve this recipient. </dd>
<dt>
MAPI_RESOLVED</dt>
<dd>
The corresponding recipient has been resolved to a unique entry identifier. Other containers should not try to resolve this recipient. </dd>
<dt>
MAPI_UNRESOLVED</dt>
<dd>
The corresponding entry has not been resolved. Other containers should try to resolve this recipient. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The name resolution process was successful.</dd>
<dt>
MAPI_E_BAD_CHARWIDTH</dt>
<dd>
Either the MAPI_UNICODE flag was set and the implementation does not support Unicode, or MAPI_UNICODE was not set and the implementation only supports Unicode.</dd>
<dt>
MAPI_E_NO_SUPPORT</dt>
<dd>
The address book provider does not support bulk name resolution using this method.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IABContainer::ResolveNames</b> method attempts to match unresolved recipients from the array of entries in the <i>lpAdrList</i> parameter to recipients in this address book container. An unresolved recipient typically only has the <a href="propa_1yjp.htm">PR_DISPLAY_NAME</a> property and possibly a few other properties. An unresolved recipient does not have the <a href="propa_8cv8.htm">PR_ENTRYID</a> property, and its corresponding flag in the <i>lpFlagList</i> parameter is set to MAPI_UNRESOLVED. Conversely, a resolved recipient always has at least the PR_ENTRYID property plus several other properties such as PR_EMAIL_ADDRESS, PR_DISPLAY_NAME, and PR_ADDRTYPE.</p>
<p>
The name resolution typically begins when a client calls <a href="inter006_64v9.htm"><b>IAddrBook::ResolveName</b></a>. MAPI responds by calling the <b>IABContainer::ResolveNames</b> method of each address book container that is included in the address book search path — the <a href="propa_0grs.htm">PR_AB_SEARCH_PATH</a> property. The entries in the <i>lpAdrList</i> parameter include recipients already resolved by containers that have already been called because they appear earlier in the search path and unresolved recipients. </p>
<p>
Each container attempts to resolve the unresolved entries by matching the display name of the recipient with the display name of one of its entries. When a unique match is found, <b>ResolveNames</b> adds the PR_ENTRYID property and other properties included in the <i>lpPropTagArray</i> parameter to the corresponding entry in the outgoing <a href="structyp_87n8.htm"><b>ADRLIST</b></a> structure and sets the entry in the <i>lpFlagList</i> parameter to MAPI_RESOLVED. The entry identifier stored in the PR_ENTRYID property can be short-term or long-term.</p>
<p>
After all of the containers in the search path have attempted the name resolution process, MAPI launches a dialog box, if possible, to prompt the user for help in resolving any remaining conflicts. </p>
<p>
Clients can also use the returned <b>ADRLIST</b> structure in calls to the <a href="inter029_8vw3.htm"><b>IMessage::ModifyRecipients</b></a> method.</p>
<h4>Notes to Implementers</h4>
<p>
You are not required to support name resolution with the <b>IABContainer::ResolveNames</b> method. Instead, or in addition, you can support it with the <a href="propa_1gtu.htm">PR_ANR</a> property restriction. If you choose to rely on the PR_ANR restriction for name resolution, you can return MAPI_E_NO_SUPPORT from <b>IABContainer::ResolveNames</b>. For more information, see <a href="ab_94by.htm">Implementing Name Resolution</a>.</p>
<p>
Set a recipient's flag entry in the <i>lpFlagList</i> parameter to MAPI_UNRESOLVED if the recipient does not match any of the container's recipients. </p>
<p>
When a recipient matches multiple recipients, set its flag to MAPI_AMBIGUOUS and do not alter its <a href="structyp_6m49.htm"><b>ADRENTRY</b></a> structure. </p>
<p>
MAPI requires certain properties on recipients that are included in a message's recipient list. You can include them in the <b>ADRENTRY</b> structure as part of the name resolution process or wait for MAPI to request them during the processing of <a href="inter006_98fn.htm"><b>IAddrBook::PrepareRecips</b></a> and <a href="inter025_52pf.htm"><b>IMAPISupport::ExpandRecips</b></a>. Eliminate these extra calls and improve performance by including the following properties in the <b>ADRENTRY</b> structures of all resolved recipients:</p>
<p class=indent1>
<a href="propa_4gkl.htm">PR_ADDRTYPE</a></p>
<p class=indent1>
<a href="propa_1yjp.htm">PR_DISPLAY_NAME</a></p>
<p class=indent1>
<a href="propa_2t9v.htm">PR_EMAIL_ADDRESS</a></p>
<p class=indent1>
<a href="propa_8cv8.htm">PR_ENTRYID</a></p>
<p class=indent1>
<a href="propb_0okl.htm">PR_OBJECT_TYPE</a></p>
<p class=indent1>
<a href="propb_960p.htm">PR_SEARCH_KEY</a></p>
<p class=indent1>
<a href="propb_4f51.htm">PR_TRANSMITTABLE_DISPLAY_NAME</a></p>
<p>
If some of the properties in the <i>lpPropTagArray</i> parameter are unavailable — typically because the container entry does not support them and they are not included in the recipient's <b>ADRENTRY</b> member in the <b>ADRLIST</b> structure — set the property type of each unavailable property to PT_ERROR. </p>
<p>
Do not remove any properties from a resolved recipient's <b>ADRENTRY</b> structure.</p>
<p>
If you need to replace rather than modify an <b>ADRENTRY</b> structure, free the original <b>ADRENTRY</b> structure first by calling the <a href="function_85yq.htm"><b>MAPIFreeBuffer</b></a> function and then allocate the replacement <b>ADRENTRY</b> structure with <a href="function_8z3m.htm"><b>MAPIAllocateBuffer</b></a>.</p>
<h4>See Also</h4>
<p>
<a href="structyp_6m49.htm"><b>ADRENTRY</b></a>, <a href="structyp_87n8.htm"><b>ADRLIST</b></a>, <a href="inter006_98fn.htm"><b>IAddrBook::PrepareRecips</b></a>, <a href="inter006_64v9.htm"><b>IAddrBook::ResolveName</b></a>, <a href="inter025_52pf.htm"><b>IMAPISupport::ExpandRecips</b></a>,<b> <a href="inter029_8vw3.htm">IMessage::ModifyRecipients</a></b>, <a href="propa_1gtu.htm">PR_ANR</a>, <a href="structyp_6fxq.htm"><b>SPropertyRestriction</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
