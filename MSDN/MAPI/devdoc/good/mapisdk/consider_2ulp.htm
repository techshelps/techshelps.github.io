<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Composing a New Message Using a Form</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_composing_a_new_message_using_a_form"></a>Composing a New Message Using a Form</h2>
<p>
To use a form to compose a new message, first create a new custom message object.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To compose a new message using a form </h5>
<ol>
<li>
Call the form manager's <a href="inter019_3qcz.htm"><b>IMAPIFormMgr::ResolveMessageClass</b></a> method to retrieve a pointer to a form information object — an object that implements the <a href="inter018_5igg.htm"><b>IMAPIFormInfo</b></a> interface. </li>
<li>
Pass the pointer to the form information object in a call to <a href="inter019_6w31.htm"><b>IMAPIFormMgr::CreateForm</b></a>. <b>CreateForm</b> loads the appropriate form server. In addition, pass an interface identifier to <b>CreateForm</b> to specify the interface to be used to access the new message. Typically, you request <a href="inter034_24ry.htm"><b>IPersistMessage</b></a> by passing IID_IPersistMessage to <b>CreateForm</b>.</li>
<li>
Save the new message by calling its <a href="inter034_4elh.htm"><b>IPersistMessage::Save</b></a> method. The form server should set values for the message's required properties when it creates the message.</li>
<li>
Load the message by using one of two strategies: <a href="inter019_8ju5.htm"><b>IMAPIFormMgr::LoadForm</b></a> or <a href="inter023_2vzh.htm"><b>IMAPISession::PrepareForm</b></a> followed by <a href="inter023_2rql.htm"><b>IMAPISession::ShowForm</b></a>. For more information about these strategies, see <a href="consider_425p.htm">Loading a Message Into a Form</a>.</li>
</ol>
<p>
<b>Note</b>  There are opportunities for performance gains when loading a new custom message into a form server because you will already have had an opportunity to get some information about the message — such as its message class — during the processing required for the <b>ResolveMessageClass</b> and <b>CreateForm</b> calls. Because of this, you will be able to simplify the processing required before calling <b>LoadForm</b> over that described in the topic <a href="consider_425p.htm">Loading a Message into a Form </a>.</p>
<p>&nbsp;</p></body>
</HTML>
