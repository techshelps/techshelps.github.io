<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>About Custom Form Objects</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_about_custom_form_objects"></a>About Custom Form Objects</h1>
<p>
Objects for custom forms are implemented by three different components:
<ul>
<li>
Form server</li>
<li>
Form library provider</li>
<li>
Form viewer</li>
</ul>
<p>
A form server is similar in functionality to an OLE compound document object application. It is an executable component that implements the form; it controls its display and the operations that a user can perform. MAPI launches a form server upon request when a user wishes to view a message with a message class that is displayed using a form supported by the form server. Form servers implement three objects: a form factory object that resembles the standard OLE class factory, a form advise sink for handling form-specific events, and the form itself. </p>
<p>
A form library provider supplies clients with access to a form's property set, to its container, and to the object that links messages of a specific class with the server that can activate the form for that class. Form library providers implement three objects: a form information object, a form container, and a form manager for binding a message to the appropriate form server based on the message's class.</p>
<p>
A form viewer is a component that is included in clients that support the display of custom forms from within their folder viewers. Form viewers are not independent MAPI components as are form library providers and form servers. They invoke form servers and provide context for them. Form viewers implement three objects: a message site, a view context, and an advise sink specific for handling view-specific events.</p>
<p>
The following table describes all of the custom form objects. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Form object</th>
<th align=left width=67%>Description</th>
</tr>
<tr valign=top>
<td width=33%>Form</td>
<td width=67%>Controls the display and operation of a custom form for viewing messages of a specific class. </td>
</tr>
<tr valign=top>
<td width=33%>Form advise sink</td>
<td width=67%>Handles notifications from the form viewer.</td>
</tr>
<tr valign=top>
<td width=33%>Form factory</td>
<td width=67%>Creates an instance of a form and allows its server to remain in memory.</td>
</tr>
<tr valign=top>
<td width=33%>Form container</td>
<td width=67%>Contains form information.</td>
</tr>
<tr valign=top>
<td width=33%>Form information</td>
<td width=67%>Contains messages and other message containers.</td>
</tr>
<tr valign=top>
<td width=33%>Form manager</td>
<td width=67%>Provides access to an integrated view of custom form information relating to all of the installed forms. Also matches message classes with corresponding form class identifiers.</td>
</tr>
<tr valign=top>
<td width=33%>Message site</td>
<td width=67%>Handles the manipulation of form objects from inside the client and provides access to a form manager object.</td>
</tr>
<tr valign=top>
<td width=33%>View context</td>
<td width=67%>Supports form commands for activating next and previous messages and for saving or printing.</td>
</tr>
<tr valign=top>
<td width=33%>View advise sink</td>
<td width=67%>Handles notifications from the form server.</td>
</tr>
</table><br>
<p>
The following illustration shows the relationship between custom form components, the objects and interfaces that they implement, and the components that are users of the objects. Notice that, unlike most other MAPI objects, the form object implements two interfaces that are not related by direct inheritance. When an object exposes multiple independent interfaces, a user of the object that has a pointer to one of the interfaces can retrieve a pointer to any of the other interfaces. This ability to navigate between an object's interface implementations is a feature of the <b>QueryInterface</b> method, one of the methods in the base interface <b>IUnknown</b>.</p>
<p>
<img src="images/amapi_67.gif" border=0></p>
<p>&nbsp;</p></body>
</HTML>
