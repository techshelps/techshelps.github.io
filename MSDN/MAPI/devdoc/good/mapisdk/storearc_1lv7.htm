<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Providing Notifications for Message Store Providers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_providing_notifications_for_message_store_providers"></a>Providing Notifications for Message Store Providers</h2>
<p>
While notifications are optional, they are a very important part of a good message store provider. Client applications and the MAPI spooler rely on notifications from the message store provider to get good performance when submitting outgoing messages or receiving incoming messages. Clients and the MAPI spooler can function without receiving notifications from the message store provider but will not be able to inform users of changes in the message store without them. Typically, this means that users will be unable to see that a new message has arrived until their client next opens the message store's receive folder.</p>
<p>
Clients register for notifications by calling the <a href="inter031_43l1.htm"><b>IMsgStore::Advise</b></a> method. The client passes in an <a href="inter010_0fn2.htm"><b>IMAPIAdviseSink</b></a> object, a bitmask indicating what type of notifications the client is interested in receiving, and an <b>EntryID</b> indicating which object in the message store the <b>Advise</b> request applies to. When relevant events occur within the object — for example, when a new message arrives in the receive folder within the message store — the message store provider or the object itself should call the <a href="inter010_4y2h.htm"><b>IMAPIAdviseSink::OnNotify</b></a> method for all of the <b>IMAPIAdviseSink</b> objects that have registered for that event type.</p>
<p>
Even if your message store provider never notifies other MAPI components of changes in the message store, it should still implement <b>IMsgStore::Advise</b> to return MAPI_E_NO_SUPPORT. This informs other components not to expect notifications from the message store provider.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
