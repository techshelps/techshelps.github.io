<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Updating the Rowset</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="updatingrowset"></a>Updating the Rowset</h1>
<p>
The <b>IRowsetChange</b> interface is used to update a rowset. Changes may take place immediately or be delayed, depending on whether <b>IRowsetUpdate</b> is exposed by the rowset. For more information, see the <i>OLE DB Programmer’s Reference,</i> Chapter 5, “Updating Data in Rowsets.”</p>
<h1>Setting Row Data with CRowset::SetData</h1>
<p>
Setting data is similar to getting data: The consumer must have a row handle, an accessor handle, and a buffer. The accessor handle describes which columns are being set, and the buffer contains the data. <b>IRowsetChange::SetData</b> is the method used to set data values in a row. <b>CRowset::SetData</b> simply uses <b>IRowsetChange::SetData</b>.</p>
<h1>Deleting Rows with CRowset::DeleteRows</h1>
<p>
<b>IRowsetChange::DeleteRows</b> is used to delete rows from a rowset. Callers are encouraged to supply a DBROWSTATUS array and inspect the row status after deleting the rows.<b> CRowset::DeleteRows</b> is equivalent to <b>IRowsetChange::DeleteRows</b>.</p>
<h1>Inserting Rows with CRowset::InsertRow</h1>
<p>
Inserting a row is simple to do using <b>IRowsetChange::InsertRow</b>. The provider initializes the inserted row based on the binding information defined by the accessor handle argument. If the accessor was created with binding information, then <i>pData</i> must be a valid data buffer. If you have a null accessor—one that was created with no binding information—then <i>pData</i> is ignored and the row is created with default column values.<b> CRowset:: InsertRow</b> is equivalent to <b>IRowsetChange:: InsertRow</b>.</p>
<h1>Delaying Updates</h1>
<p>
Rowsets expose <b>IRowsetUpdate</b> when changes made through <b>IRowsetChange</b> are buffered until <b>IRowsetUpdate::Update</b> is called. Consumers can back out of changes made before <b>IRowsetUpdate::Update</b> is called by calling <b>IRowsetUpdate::Undo</b>. This is referred to as <i>delayed updating</i> (as opposed to <i>immediate updating)</i>. <b>CRowset</b> provides wrappers for all <b>IRowsetUpdate</b> methods.</p>
</font></BODY>
</HTML>
