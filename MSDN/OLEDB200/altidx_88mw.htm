<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAlterIndex::AlterIndex</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbialterindex__alterindex"></a>IAlterIndex::AlterIndex</h1>
<p>
<b>AlterIndex</b> alters the ID and/or properties associated with an index.</p>
<pre><code>HRESULT AlterIndex(
   DBID *   pTableID,
   DBID *   pIndexID,
   DBID *   pNewIndexID,
   ULONG   cPropertySets,
   DBPROPSET   rgPropertySet[]);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pTableID</i></p>
<p class=indent>
[in]<br>
The DBID of the indexed base table.</p>
<p class=dt>
<i>pIndexID</i></p>
<p class=indent>
[in]<br>
The DBID of the existing index to alter.</p>
<p class=dt>
<i>pNewIndexID</i></p>
<p class=indent>
[in]<br>
The new DBID of the index. If this is the same as <i>pIndexID</i>, or a null pointer, then the ID of the index is unchanged.</p>
<p class=dt>
<i>cPropertySets</i></p>
<p class=indent>
[in]<br>
The number of DBPROPSET structures in <i>rgPropertySets</i>. If this is zero, the provider ignores <i>rgPropertySets</i>.</p>
<p class=dt>
<i>rgPropertySets</i></p>
<p class=indent>
[in/out]<br>
An array of DBPROPSET structures containing properties and values to be set. The properties specified in these structures must belong to the index property set.</p>
<p class=label>
<b>Return Code</b></p>
<p class=dt>
S_OK</p>
<p class=indent>
The method succeeded.</p>
<p class=dt>
E_FAIL</p>
<p class=indent>
A provider-specific error occurred.</p>
<p class=dt>
E_INVALIDARG</p>
<p class=indent>
<i>pTableID </i>was a null pointer.</p>
<p class=indent>
<i>pIndexID </i>was a null pointer.</p>
<p class=dt>
DB_E_NOTABLE</p>
<p class=indent>
The table specified in *<i>pTableID</i> does not exist in the current data source.</p>
<p class=dt>
DB_E_NOINDEX</p>
<p class=indent>
The index specified in *<i>pIndexID</i> does not exist in the current data source or did not apply to the specified table.</p>
<p class=dt>
DB_DUPLICATEINDEXID</p>
<p class=indent>
The index specified in *<i>pNewIndexID</i> already exists in the current data source.</p>
<p class=dt>
DB_SEC_E_PERMISSIONDENIED</p>
<p class=indent>
The consumer did not have sufficient permission to alter the index.</p>
<p class=dt>
DB_E_BADINDEXID</p>
<p class=indent>
*<i>pNewIndexID</i> was an invalid index ID.</p>
<p class=dt>
DB_E_INDEXINUSE</p>
<p class=indent>
The specified index was in use.</p>
<p class=dt>
DB_E_TABLEINUSE</p>
<p class=indent>
The specified table was in use and the provider could not modify the index with the table open.</p>
<p class=label>
<b>Comments</b></p>
<p>
<b>AlterIndex</b> applies the new properties and index ID to the existing index. The altered index preserves all properties associated with the existing index that are not explicitly changed by properties specified in <i>*prgProperties</i>. If <i>pNewIndexID</i> is null, or the same as <i>pIndexID</i>, then the index ID is unchanged. If <i>cPropertySets</i> is zero, then no properties are changed. If <i>pNewIndexID</i> is null, or the same as <i>pIndexID</i>, and <i>cPropertySets</i> is zero, then the method makes no change to the state of the index and returns S_OK.</p>
</font></BODY>
</HTML>
