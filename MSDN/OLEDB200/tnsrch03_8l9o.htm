<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Drilling by Level</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="drillingbylevel"></a>Drilling by Level</h1>
<p>
<b>DRILLDOWNLEVEL(&lt;set1&gt; [, &lt;level&gt;]])</b></p>
<p class=tl>
To drill down by a level, the <b>DRILLDOWNLEVEL</b> function is used. This function drills down members in <i>set1</i>, at the level specified by <i>level</i>, to one level below.</P><p class=tl>
For example, the call</P><pre><code>DRILLDOWNLEVEL({USA, California, Washington, France, Canada, Ontario, 
 &nbsp; Quebec}, States)
</code></pre>
<p class=tl>
returns the set</P><pre><code>{USA, California, &lt;all cities in California&gt;, Washington, 
&lt;all cities in Washington&gt;, France, Canada, Ontario, 
&lt;all cities in Ontario&gt;, Quebec, &lt;all cities in Quebec&gt;}
</code></pre>
<p class=tl>
Note that the members that result from the drill down are hierarchized to occur under their parents. Among the original members in <i>set1</i>, order is preserved. Thus, in the above example, France still occurs after USA and Canada still occurs after France.</P><p class=tl>
If <i>level</i> is not specified, then it is assumed to be the level of the lowest level member of <i>set1</i>.</P><p class=tl>
For example, the call</P><pre><code>DRILLDOWNLEVEL({North America, USA, California, Washington, France, 
 &nbsp; Canada})
</code></pre>
<p class=tl>
is equivalent to the call</P><pre><code>DRILLDOWNLEVEL({North America, USA, California, Washington, France, 
 &nbsp; Canada}, States)
</code></pre>
<p class=tl>
When there is no member at the specified level in <i>set1</i>, this call has no effect.</P><p class=tl>
For example, the call</P><pre><code>DRILLDOWNLEVEL({USA, California, Washington, France, Canada, Ontario, 
 &nbsp; Quebec}, Cities)
</code></pre>
<p class=tl>
returns the original set unchanged.</P><p class=tl>
For example, in a typical application, <i>set1</i> is the set of members from a given dimension on a given axis. (Note that <i>set1</i> may itself be the result of an expression.) The UI has a way to specify “drill down to level” — for example, by using a drop-down list box of levels. In response to a user selection, the application calls <b>DRILLDOWNLEVEL</b> with <i>set1</i> and the level specified by the user.</P><p class=tl>
The set returned by this function is described in the following algorithm:</P><ol>
<li>
If <i>level</i> is not specified, then let level be the level of the lowest level member in set1.<br><br></li>
<li>
Let <i>set2</i> = <i>set1</i>.<br><br></li>
<li>
For each member m in <i>set1</i>:<p class=tl>
&nbsp;&nbsp;&nbsp;a. if <i>m</i> is at <i>level</i>, and</P><p class=tl>
&nbsp;&nbsp;&nbsp;b. if there are no descendants of <i>m</i> immediately following <i>m</i>,</P><p class=tl>
then <i>set2</i> = UNION(<i>set2</i>, m.CHILDREN, ALL).</P></li>
<li>
Return <i>set2</i>.</li>
</ol>
<p>
<b>DRILLDOWNLEVELTOP(&lt;set&gt;, &lt;index&gt;[, [&lt;level&gt;]<br>
 &nbsp; [, &lt;numeric_value_expression&gt;]])</b></p>
<p class=tl>
The function <b>DRILLDOWNLEVELTOP</b> is a variation of <b>DRILLDOWNLEVEL</b>. Instead of including all children of a member at the specified level, it just includes the top <i>n</i> children.</P><p class=tl>
For example, the call</P><pre><code>DRILLDOWNLEVELTOP({USA, California, Washington, France, Canada, 
Ontario, Quebec}, 5, States, Sales)
</code></pre>
<p class=tl>
returns the set</P><pre><code>{USA, California, &lt;top 5 cities in California based on sales&gt;, 
Washington, &lt;top 5 cities in Washington based on sales&gt;, France, 
Canada, Ontario, &lt;top 5 cities in Ontario based on sales&gt;, Quebec, 
&lt;top 5 cities in Quebec based on sales&gt;}
</code></pre>
<p class=tl>
As another example, the call</P><pre><code>DRILLDOWNLEVEL({North America, USA, California, Washington, France, 
 &nbsp; Canada}, 5, States, Sales)
</code></pre>
<p class=tl>
results in the set</P><pre><code>{USA, California, &lt;top 5 cities in California&gt;, Washington, 
&lt;top 5 cities in Washington&gt;, France, Canada}
</code></pre>
<p class=tl>
The function <b>DRILLDOWNLEVELBOTTOM</b> is similar, except that the bottom condition is applied instead of the top condition.</P><p>
<b>DRILLUPLEVEL(&lt;set1&gt;[, &lt;level&gt;])</b></p>
<p class=tl>
To drill up by level, the <b>DRILLUPLEVEL</b> function is used.</P><p class=tl>
This function drills up members in <i>set1</i> that are below the specified level. If <i>level</i> is not specified, it is assumed to be one less than the level of the lowest level member in <i>set1</i>.</P><p class=tl>
For example, the call</P><pre><code>DRILLUPLEVEL({USA, California, &lt;all cities in California&gt;, Washington, 
&lt;all cities in Washington&gt;, France, Canada, Ontario, 
&lt;all cities in Ontario&gt;, Quebec, &lt;all cities in Quebec&gt;}, States)
</code></pre>
<p class=tl>
returns the set</P><pre><code>{USA, California, Washington, France, Canada, Ontario, Quebec}
</code></pre>
<p class=tl>
If the <i>level</i> in the above call were changed from States to Countries, then the resulting set would be</P><pre><code>{USA, France, Canada}
</code></pre>
<p class=tl>
The set returned by this function is described by the following algorithm:</P><ol>
<li>
For each member <i>m</i> in <i>set1</i>, if <i>m</i> is below <i>level</i>, then remove <i>m</i> from <i>set1</i>.<br><br></li>
<li>
Return <i>set1</i>.<ol start=14 type=A>
<li>
Note the following about <b>DRILLDOWNLEVEL</b> and <b>DRILLUPLEVEL</b>:<ol>
<li>
Calling DRILLUPLEVEL without a level parameter on a set that has only the root level members has no effect.<br><br></li>
<li>
Calling DRILLDOWNLEVEL without a level parameter has no effect when the input set has all non-leaf members drilled down to their leaf level descendants.</li>
</ol>
</li>
</ol>
</li>
</ol>
</font></BODY>
</HTML>
