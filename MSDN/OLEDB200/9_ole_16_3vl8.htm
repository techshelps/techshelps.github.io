<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL Server Error Detail</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="sql_server_error_detail"></a>SQL Server Error Detail</h1>
<p>
SQLOLEDB defines the provider-specific error interface <b>ISQLServerErrorInfo</b>. The interface returns more detail about a SQL Server error and is valuable when command execution or rowset operations fail.</p>
<p>
<b>ISQLServerErrorInfo</b> is available on the SQLOLEDB implementation of <b>ISQLErrorInfo</b>. Unlike <b>ISQLErrorInfo</b>, the interface is not defined as a custom error object. The consumer queries <b>ISQLErrorInfo</b> to obtain an <b>ISQLServerErrorInfo</b> reference.</p>
<p>
The <b>ISQLServerErrorInfo</b> interface exposes one member function <b>GetErrorInfo</b>. The function returns a pointer to an SSERRORINFO structure and a pointer to a string buffer. Both pointers reference memory the consumer must deallocate by using <b>IMalloc::Free</b>.</p>
<p>
SSERRORINFO structure members are interpreted by the consumer as follows.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=26%><b>Member</b></td>
<td class=label width=74%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=26%><i>pwszMessage</i></td>
<td width=74%>SQL Server error message. Identical to the string returned in <b>IErrorInfo::GetDescription</b>.</td>
</tr>
<tr valign=top>
<td width=26%><i>pwszServer</i></td>
<td width=74%>The name of the session’s SQL Server.</td>
</tr>
<tr valign=top>
<td width=26%><i>pwszProcedure</i></td>
<td width=74%>If appropriate, the name of the procedure in which the error originated. An empty string otherwise.</td>
</tr>
<tr valign=top>
<td width=26%><i>lNative</i></td>
<td width=74%>The SQL Server native error number. Identical to the value returned in the <i>plNativeError</i> parameter of <b>ISQLErrorInfo::GetSQLInfo</b>.</td>
</tr>
<tr valign=top>
<td width=26%><i>bState</i></td>
<td width=74%>The state of a SQL Server error message. </td>
</tr>
<tr valign=top>
<td width=26%><i>bClass</i></td>
<td width=74%>The severity of a SQL Server error message. For more information, see RAISERROR.</td>
</tr>
<tr valign=top>
<td width=26%><i>wLineNumber</i></td>
<td width=74%>When applicable, the line number of a stored procedure on which the error occurred.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
