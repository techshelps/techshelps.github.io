<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRowset::AddRefRows</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbirowset__addrefrows"></a>IRowset::AddRefRows</h1>
<p>
Adds a reference count to an existing row handle.</p>
<pre><code>HRESULT AddRefRows(
   ULONG            cRows,
   const HROW         rghRows[],
   ULONG            rgRefCounts[],
   DBROWSTATUS   rgRowStatus[]);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>cRows</i></p>
<p class=indent>
[in]<br>
The number of rows for which to increment the reference count.</p>
<p class=dt>
<i>rghRows</i></p>
<p class=indent>
[in]<br>
An array of row handles for which to increment the reference count. The reference count of row handles is incremented by one for each time they appear in the array.</p>
<p class=dt>
<i>rgRefCounts</i></p>
<p class=indent>
[out]<br>
An array with <i>cRows</i> elements in which to return the new reference count for each row handle. The consumer allocates memory for this array. If <i>rgRefCounts</i> is a null pointer, no reference counts are returned.</p>
<p class=dt>
<i>rgRowStatus</i></p>
<p class=indent>
[out]<br>
An array with <i>cRows</i> elements in which to return values indicating the status of each row specified in <i>rghRows</i>. If no errors occur while incrementing the reference count of a row, the corresponding element of <i>rgRowStatus</i> is set to DBROWSTATUS_S_OK. If an error occurs while incrementing the reference count of a row, the corresponding element is set as specified in DB_S_ERRORSOCCURRED. The consumer allocates memory for this array. If <i>rgRowStatus</i> is a null pointer, no row statuses are returned. For information about the DBROWSTATUS enumerated type, see "<a href="ch13pr_5ib7.htm">Arrays of Errors</a>" in Chapter 13.</p>
<p class=dt>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded. The reference count of all rows was successfully incremented. The following value can be returned in *<i>prgRowStatus</i>:
<ul type=disc>
<li>
The reference count of the row was successfully incremented. The corresponding element of *<i>prgRowStatus</i> contains DBROWSTATUS_S_OK.</li>
</ul>
<p class=dt>
</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
An error occurred while incrementing the reference count of a row, but the reference count of at least one row was incremented. Successes can occur for the reason listed under S_OK. The following errors can occur:
<ul type=disc>
<li>
A row handle was invalid. The reference count of the row was not incremented and the corresponding element of <i>rgRowStatus</i> contains DBROWSTATUS_E_INVALID.<br><br></li>
<li>
A row handle referred to a row that had a reference count of zero. The reference count of the row was not incremented and the corresponding element of <i>rgRowStatus</i> contains DBROWSTATUS_E_INVALID.<br><br></li>
<li>
A row handle referred to a row for which a deletion had been transmitted to the data source. The reference count of the row was not incremented and the corresponding element of <i>rgRowStatus</i> contains DBROWSTATUS_E_DELETED.<br><br></li>
<li>
The consumer encountered a recoverable, provider-specific error, such as an RPC failure when transmitting the change to a remote server. The corresponding element of <i>rgRowStatus</i> contains DBROWSTATUS_E_FAIL.</li>
</ul>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>rghRows</i> was a null pointer and <i>cRows</i> was not zero.</p>
<p class=dt>
</p>
<p class=indent>
E_UNEXPECTED<br>
<b>ITransaction::Commit</b> or <b>ITransaction::Abort</b> was called and the object is in a zombie state.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
Errors occurred while incrementing the reference count of all of the rows. Errors can occur for the reasons listed under DB_S_ERRORSOCCURRED.</p>
<p class=dt>
</p>
<p class=label>
<b>Comments</b></p>
<p>
<b>AddRefRows</b> must be supported for implementing multiple references to the same row even if the rowset does not support <b>IRowsetIdentity</b>.</p>
<p>
It is always possible for a consumer to call <b>AddRefRows</b> while it is processing a method in <b>IRowsetNotify</b>. That is, the rowset must be reentrant through <b>AddRefRows</b> during notification.</p>
<p>
If <b>AddRefRows</b> encounters an error while incrementing the reference count of a row, it sets the corresponding element in <i>rgRowStatus</i> to the appropriate DBROWSTATUS value and continues processing.</p>
<p>
If a row handle is duplicated in <i>rghRows</i>, the corresponding row will have its reference count incremented by 1 for each time it appears in the array.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="rowset_1v03.htm">IRowset::ReleaseRows</a></p>
</font></BODY>
</HTML>
