<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>States and State Transitions in Providers</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbstates_and_state_transitions_in_providers"></a>States and State Transitions in Providers</h1>
<p>
The following diagram displays finite-states and the text describes the events that take place within a rowset method, such as <b>IRowsetChange::SetData</b> implementing notifications.</p>
<p class=label>
<b>Provider state/state transition diagram</b></p>
<p>
<img src="ch0901.gif" border=0></p>
<h1>States</h1>
<ul type=disc>
<li>
Enter Method and Exit Method are conceptual states representing the initial and final states of a method issuing notifications.<br><br></li>
<li>
OKTODO, ABOUTTODO, SYNCHAFTER, DIDEVENT, and FAILEDTODO are states representing notifications sent by the method to consumers. <br><br></li>
<li>
Preliminary Work, Permanent Work, and Undo Work are internal states representing work done by the provider between notification phases.</li>
</ul>
<h1>Transitions</h1>
<ul type=disc>
<li>
Arrows with a heavy continuous line represent transitions within states when all consumers return S_OK as a result of the notification sent by the state at the start of the arrow. In general, a transition through a heavy continuous line represents an acceptance path by the consumer on the notification.<br><br></li>
<li>
Arrows with a light continuous line represent transitions within states when at least one consumer returns S_FALSE as a result of the notification sent by the state at the start of the arrow. In general, a transition through a light continuous line represents a cancellation path by the consumer on the notification.<br><br></li>
<li>
Arrows with a dashed line represent internal transitions within the method. The transitions from Preliminary Work or Permanent Work to FAILEDTODO are transitions that result from some error in the execution of the method. A transition from Enter Method to Exit Method represents a path where the method detects some error condition that implies no notification work.</li>
</ul>
</font></BODY>
</HTML>
