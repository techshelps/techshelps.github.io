<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IErrorInfo</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbierrorinfo"></a>IErrorInfo</h1>
<p>
<b>IErrorInfo</b> is defined by Automation; the following describes how the interface is used in OLE DB. <b>IErrorInfo</b> returns information about an error in addition to the return code. It returns the error message, name of the component, and GUID of the interface in which the error occurred, and the name and topic of the Help file that applies to the error.</p>
<h1>When to Implement</h1>
<p>
<b>IErrorInfo</b> is implemented by code in the OLE DB Software Development Kit (SDK). This code calls provider-specific code in <b>IErrorLookup</b> to retrieve error messages, sources, and Help file information.</p>
<p>
OLE DB error objects expose <b>IErrorInfo</b> at two levels. First, it is exposed on the OLE DB error object itself, which enables Automation consumers to use OLE DB error objects. The interface pointer is returned by <b>GetErrorInfo</b> in the Automation DLL; it can also be returned by <b>QueryInterface</b>. <b>IErrorInfo</b> returns the information stored in record 0 of the OLE DB error object and uses the default locale ID.</p>
<p>
<b>IErrorInfo</b> is also exposed on individual records in the OLE DB error object. These <b>IErrorInfo</b> interface pointers, returned by <b>IErrorRecords::GetErrorInfo</b>, are different from the <b>IErrorInfo</b> interface pointer exposed on the OLE DB error object itself, and cannot be returned by <b>QueryInterface</b>. The record to which the interface pointer applies and the locale ID it uses is specified by the consumer in <b>IErrorRecords::GetErrorInfo</b>.</p>
<h1>When to Call</h1>
<p>
Automation consumers call <b>GetErrorInfo</b> in the Automation DLL to get an <b>IErrorInfo</b> interface pointer on the OLE DB error object.</p>
<p>
OLE DB consumers also call <b>GetErrorInfo</b> in the Automation DLL. However, they do not generally use the returned <b>IErrorInfo</b> interface pointer. Instead, they call <b>QueryInterface</b> to get an <b>IErrorRecords</b> interface pointer and then call <b>IErrorRecords::GetErrorInfo</b> to get an <b>IErrorInfo</b> interface pointer on a particular record in the OLE DB error object. Then the OLE DB consumers use this interface pointer to retrieve the error information.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=24%><b>Method</b></td>
<td class=label width=76%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=24%><a href="errinf_94fi.htm">GetDescription</a></td>
<td width=76%>Returns a text description of the error.</td>
</tr>
<tr valign=top>
<td width=24%><a href="errinf_4o4k.htm">GetGUID</a></td>
<td width=76%>Returns the GUID of the interface that defined the error.</td>
</tr>
<tr valign=top>
<td width=24%><a href="errinf_8h2s.htm">GetHelpContext</a></td>
<td width=76%>Returns the Help context ID for the error.</td>
</tr>
<tr valign=top>
<td width=24%><a href="errinf_7uud.htm">GetHelpFile</a></td>
<td width=76%>Returns the path of the Help file that describes the error.</td>
</tr>
<tr valign=top>
<td width=24%><a href="errinf_8gf9.htm">GetSource</a></td>
<td width=76%>Returns the name of the component that generated the error, such as "ODBC <i>driver-name</i>".</td>
</tr>
</table>
</font></BODY>
</HTML>
