<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting Information About Properties</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbgetting_information_about_properties"></a>Getting Information About Properties</h1>
<p>
To get information about properties, a consumer performs the following actions:
<ol>
<li>
Determines the properties for which to get information.<br><br></li>
<li>
Determines the property sets that contain the identified properties.<br><br></li>
<li>
Allocates an array of DBPROPIDSET structures, one for each identified property set.<br><br></li>
<li>
Allocates an array of DBPROPIDs for each property set. The number of elements in each array is the number of properties identified in step 1 that belong to that property set.<br><br></li>
<li>
Places the ID of each property in the DBPROPID array.<br><br></li>
<li>
Places the property set GUID in the DBPROPIDSET structure for each property set. It then places the count of elements in and the pointer to the corresponding DBPROPID array in the DBPROPIDSET structure.<br><br></li>
<li>
Calls a method that gets properties and passes it the count and array of DBPROPIDSET structures.</li>
</ol>
<p>
To return property values, the provider performs the following actions:
<ol>
<li>
Allocates an array of DBPROPINFOSET structures. The elements of this array correspond to the elements of the DBPROPIDSET array.<br><br></li>
<li>
For each element of the DBPROPIDSET array, allocates an array of DBPROPINFO structures. The elements of the DBPROPINFO array correspond to the elements of the DBPROPID array.<br><br></li>
<li>
Places the ID, description, type, property group, whether the property can be read from or written to, and list of valid values of each property in the DBPROPINFO structure that corresponds to the DBPROPID value for the property.<br><br></li>
<li>
Places the property set GUID in the DBPROPINFOSET structure for each property set. It then places the count of elements in and the pointer to the corresponding DBPROPINFO array in the DBPROPINFOSET structure.<br><br></li>
<li>
Returns the count and array of DBPROPINFOSET structures to the consumer.</li>
</ol>
<p>
For example, assume that the consumer wants to get information about five properties, where properties 1, 2, and 3 are in property set A and properties 4 and 5 are in property set B. The consumer uses the following structures.</p>
<p class=label>
</p>
<p class=label>
<b>An example of how a consumer gets information about properties</b></p>
<p>
<img src="ch1104.gif" border=0></p>
<p>
The provider returns the following structures.</p>
<p class=label>
<b>An example of what property information a provider returns</b></p>
<p>
<img src="ch1105.gif" border=0></p>
<p>
The following table lists the methods consumers use to get information about properties.</p>
<p class=label>
<b>Methods used by consumers to get property information</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=34%><b>Property group</b></td>
<td class=label width=66%><b>Methods used to get information about properties</b></td>
</tr>
<tr valign=top>
<td width=34%>All property groups</td>
<td width=66%><a href="dbprop_3ffz.htm">IDBProperties::GetPropertyInfo</a></td>
</tr>
<tr valign=top>
<td width=34%>Data Source Creation</td>
<td width=66%><a href="dbadmin_0t2r.htm">IDBDataSourceAdmin::GetCreationProperties</a></td>
</tr>
<tr valign=top>
<td width=34%>Initialization</td>
<td width=66%><a href="dbadmin_0t2r.htm">IDBDataSourceAdmin::GetCreationProperties</a></td>
</tr>
<tr valign=top>
<td width=34%>Session</td>
<td width=66%><a href="dbadmin_0t2r.htm">IDBDataSourceAdmin::GetCreationProperties</a></td>
</tr>
</table><br>
</font></BODY>
</HTML>
