<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAccessor</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbiaccessor"></a>IAccessor</h1>
<p>
<b>IAccessor</b> provides methods for accessor management. For information about accessors, see "<a href="ch06pr_74kz.htm">Accessors</a>" in Chapter 6.</p>
<h1>When to Implement</h1>
<p>
All rowsets and commands must implement <b>IAccessor</b>.</p>
<p>
Accessors can be used for rowset data, parameter data, or both. Row and parameter accessors can be created on a command. The consumer must verify that row accessors created on the command are still valid following a change to the command. Accessors created on a command are not persisted with that command. Accessors created on a command are inherited by the rowsets it creates. To the consumer, it appears as if each accessor has been copied from the command to the rowset: the bindings, flags, and handle of each accessor are the same on both the rowset and the command.</p>
<p>
Accessors created on a rowset are only available to that rowset. They are not available to the command that created the rowset or other rowsets created by the command.</p>
<p>
When an accessor is created on a rowset or command, it has a reference count of 1. If a rowset inherits an accessor from a command, the accessor has a reference count of 1 on the rowset, regardless of the reference count of the same accessor on the command. Calls to <b>AddRefAccessor</b> increment the reference count of the accessor and calls to <b>ReleaseAccessor</b> decrement the reference count of the accessor. When the reference count of an accessor reaches zero, the accessor and all resources used by that accessor are released. If the accessor is created on a command and inherited by the rowset, releasing the accessor on the command does not affect the "copy" of the accessor on the rowset and vice versa.</p>
<p>
When the reference count of a rowset reaches zero, all accessors created on that rowset or inherited from the command that created it are released completely. If any accessors were inherited from the command, the "copies" of these parent accessors on the command are not affected.</p>
<p>
When the reference count of a command reaches zero, all accessors created on the command are released completely. If any rowsets inherited accessors from the command, the "copies" of these accessors on the rowsets are not affected.</p>
<h1>When to Call</h1>
<p>
To create an accessor, a consumer calls <b>CreateAccessor</b>. The consumer may create and release accessors at any time while the rowset or command remains in existence. When one thread of a consumer shares an accessor with another thread, it calls <b>AddRefAccessor</b> to increment the reference count of that accessor.</p>
<p>
When the consumer is done with a rowset, it calls <b>ReleaseAccessor</b> to release any accessors on the rowset, including accessors inherited from the command. When the consumer is done with a command, it calls <b>ReleaseAccessor</b> to release any accessors created on the command. In both cases, the consumer must call <b>ReleaseAccessor</b> once for each reference count on the accessor.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=27%><b>Method</b></td>
<td class=label width=73%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=27%><a href="accssr_3pv6.htm">AddRefAccessor</a></td>
<td width=73%>Adds a reference count to an existing accessor.</td>
</tr>
<tr valign=top>
<td width=27%><a href="accssr_4r02.htm">CreateAccessor</a></td>
<td width=73%>Creates an accessor from a set of bindings.</td>
</tr>
<tr valign=top>
<td width=27%><a href="accssr_30dv.htm">GetBindings</a></td>
<td width=73%>Returns the bindings in an accessor.</td>
</tr>
<tr valign=top>
<td width=27%><a href="accssr_4sdu.htm">ReleaseAccessor</a></td>
<td width=73%>Releases an accessor.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
