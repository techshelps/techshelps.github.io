<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Integrated Indexes</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbintegrated_indexes"></a>Overview of Integrated Indexes</h1>
<p>
OLE DB indexes are designed for use with base tables (tables opened by <b>IOpenRowset::OpenRowset</b>). Providers built over command processors, such as SQL query processors, are expected to use indexes internally but not expose them through OLE DB. The primary consumers of OLE DB indexes are: 
<ul type=disc>
<li>
Query processors accessing data in OLE DB providers, such as DBMS storage engines and ISAMs, which do not support commands.<br><br></li>
<li>
Service components or providers that implement <b>IViewRowset</b>, <b>IViewFilter</b>, or <b>IViewSort</b>.</li>
</ul>
<p>
OLE DB provides the ability to open separate rowsets over base tables and indexes, allowing the consumer to traverse each separately. However, certain providers can support indexes and base table data on the same rowset (also known as a <i>clustered index</i>). Providers can expose this as an integrated index by exposing <b>IRowsetIndex</b> directly on the base table rowset. This allows the consumer to set index ranges and seek index values directly on the base table rowset, without having a separate (and in this case redundant) index rowset. Such rowsets are said to have integrated index behavior. Providers can support separate indexes, integrated indexes, or both.</p>
<p>
This chapter discusses requesting, using, and the structure of integrated indexes. The structure is more loosely defined than a nonintegrated index rowset. An element of their use, of course, is the ability to fetch data. The topic of row fetching includes rowset order, next fetch position, range, updating index rows, visibility of index changes, and the effect of changes on the next fetch position and index range. <i>Accessors</i>, the collection of information that describes how data is stored in the consumer's buffer, are discussed in light of methods and restrictions. Restrictions on integrated indexes and executing commands are discussed also. An integrated index example is given. <br>
</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=603>
<tr valign=top>
<td class=label width=50%><b>For more information on</b></td>
<td class=label width=50%><b>Go to</b></td>
</tr>
<tr valign=top>
<td width=50%>Nonintegrated indexes</td>
<td width=50%>Chapter 8, "<a href="ch08pr_8koj.htm">Indexes</a>"</td>
</tr>
<tr valign=top>
<td width=50%>Requesting integrated indexes</td>
<td width=50%>"<a href="ch16pr_1x2r.htm">Requesting Integrated Indexes</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Using integrated indexes</td>
<td width=50%>"<a href="ch16pr_8u5v.htm">Using Integrated Indexes</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Structure of integrated indexes</td>
<td width=50%>"<a href="ch16pr_1flf.htm">Structure of Integrated Indexes</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Fetching rows</td>
<td width=50%>"<a href="ch04pr_6kdv.htm">Fetching Rows</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Accessor methods and restrictions</td>
<td width=50%>"<a href="ch16pr_7zlf.htm">Accessors</a>" in this chapter<p>
"<a href="ch06pr_74kz.htm">Accessors</a>" in Chapter 6, "Getting and Setting Data"</p>
</td>
</tr>
<tr valign=top>
<td width=50%>Restrictions on integrated indexes and commands</td>
<td width=50%>"<a href="ch16pr_6odv.htm">Integrated Indexes and Commands</a>" in this chapter<p>
Chapter 3, "<a href="ch03pr_8xyr.htm">Commands</a>"</p>
</td>
</tr>
<tr valign=top>
<td width=50%>Calling threads</td>
<td width=50%>"<a href="ch14pr_946r.htm">Provider Threading Models</a>" in Chapter 14, "Programming Considerations"</td>
</tr>
</table><br>
</font></BODY>
</HTML>
