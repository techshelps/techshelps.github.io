<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ISessionProperties::SetProperties</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbisessionproperties__setproperties"></a>ISessionProperties::SetProperties</h1>
<p>
Sets properties in the Session property group.</p>
<pre><code>HRESULT SetProperties (
   ULONG         cPropertySets,
   DBPROPSET   rgPropertySets[]);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>cPropertySets</i></p>
<p class=indent>
[in]<br>
The number of DBPROPSET structures in <i>rgPropertySets</i>. If this is zero, the provider ignores <i>rgPropertySets</i> and the method does not do anything.</p>
<p class=dt>
<i>rgPropertySets</i></p>
<p class=indent>
[in/out]<br>
An array of DBPROPSET structures containing properties and values to be set. The properties specified in these structures must belong to the Session property group. If the same property is specified more than once in <i>rgPropertySets</i>, then which value is used is provider-specific. If <i>cPropertySets</i> is zero, this parameter is ignored.</p>
<p class=tl>
For information about the properties in the Session property group that are defined by OLE DB, see "<a href="appcpr_8u7n.htm#oledbsession_properties">Session Properties</a>" in Appendix C. For information about the DBPROPSET and DBPROP structures, see "<a href="ch11pr_5pb9.htm">DBPROPSET Structure</a>" and "<a href="ch11pr_3xt1.htm">DBPROP Structure</a>" in Chapter 11.</P><p class=tl>
</P><p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded. In all DBPROP structures passed to the method, <i>dwStatus</i> is set to DBPROPSTATUS_OK.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
One or more properties were not set. Properties not in error remain set. The consumer checks <i>dwStatus</i> in the DBPROP structures to determine which properties were not set. <b>SetProperties</b> can fail to set properties for a number of reasons, including:
<ul type=disc>
<li>
The property was not supported by the provider.<br><br></li>
<li>
The property was not in the Session property group.<br><br></li>
<li>
The property set was not supported by the provider.<br><br></li>
<li>
The property is read-only and was not set to its default value.<br><br></li>
<li>
It was not possible to set the property.<br><br></li>
<li>
<i>colid</i> in the DBPROP structure was not DB_NULLID.<br><br></li>
<li>
The value of <i>dwOptions</i> in the DBPROP structure was invalid.<br><br></li>
<li>
The data type in <i>vValue</i> in the DBPROP structure was not the data type of the property or was not VT_EMPTY.<br><br></li>
<li>
The value in <i>vValue</i> in the DBPROP structure was invalid.<br><br></li>
<li>
The property's value conflicted with an existing property.</li>
</ul>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>cPropertySets</i> was not equal to zero and <i>rgPropertySets</i> was a null pointer.</p>
<p class=tl>
In an element of <i>rgPropertySets</i>, <i>cProperties</i> was not zero and <i>rgProperties</i> was a null pointer.</P><p class=dt>
</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
All property values were invalid and no properties were set. The consumer checks <i>dwStatus</i> in the DBPROP structures to determine why properties were not set.</p>
<p class=dt>
</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="dbprop_3ffz.htm">IDBProperties::GetPropertyInfo</a>, <a href="sesprop_17w3.htm">ISessionProperties::GetProperties</a></p>
</font></BODY>
</HTML>
