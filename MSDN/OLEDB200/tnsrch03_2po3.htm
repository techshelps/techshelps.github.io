<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Numeric Functions</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="numericfunctions"></a>Numeric Functions</h1>
<p>
<b>SUM(&lt;set&gt;[, &lt;numeric_value_expression&gt;])</b></p>
<p class=tl>
Sums <i>set</i> based on an optional numeric value expression. </P><p class=tl>
For example,</P><pre><code>SUM({USA, FRANCE}, Sales.VALUE)
</code></pre>
<p class=tl>
will return the sum of sales for USA and France. This can also be written as</P><pre><code>SUM({USA, FRANCE}, Sales)
</code></pre>
<p class=tl>
which is a more intuitive way. The production &lt;numeric_value_expression&gt; ::= &lt;tuple&gt;[.VALUE] is used, and the optional <b>VALUE</b> keyword is left out.</P><p class=tl>
If a numeric value expression is not specified, then it is implied by the other coordinates that appear in the MDX statement. For example, in the statement</P><pre><code>WITH MEMBER Geography.NewMember AS SUM({USA, France})
SELECT NewMember ON COLUMNS,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Quarters.MEMBERS ON ROWS
 &nbsp; FROM SalesCube
WHERE ([1991], [Salesperson].[All], Sales, [Products].[All])
</code></pre>
<p class=tl>
the <b>ROWS</b> expression provides a coordinate from the Quarters dimension. The WHERE clause provides the other four coordinates from the Years, Products, Salesperson, and Measures dimensions. These coordinates together identify a value in the cube for USA. They also identify a value for France. The <b>SUM</b> function adds these two values.</P><p>
<b>AGGREGATE(&lt;set&gt;[, &lt;numeric_value_expression&gt;])</b></p>
<p class=tl>
This function uses the “proper” aggregate function based on the context. For example, consider the following expression:</P><pre><code>WITH MEMBER Geography.Total AS AGGREGATE({USA, France})
SELECT {Measures.SumSales, Measures.MaxSales} ON COLUMNS,
 &nbsp;&nbsp;&nbsp;&nbsp; {USA, France, Total} ON ROWS
FROM SalesCube
WHERE ([1991], [Products].[All], [Salesperson].[All], 
 &nbsp;&nbsp;&nbsp;&nbsp; [Quarters].[All])
</code></pre>
<p class=tl>
In this expression, the calculated member Total is displayed against the measure “SumSales” and the measure “MaxSales.” In the former case, the provider computes Total by adding (with SUM) and in the latter case, the provider computes Total by taking the maximum. What happens when the <i>set</i> argument contains members from the MEASURES dimension is provider-specific.</P><p>
<b>COUNT(&lt;set&gt;[, INCLUDEEMPTY])</b></p>
<p class=tl>
Counts the number of tuples in <i>set</i>. The optional <b>INCLUDEEMPTY</b> flag includes empty cells in the count. For more information, see “Empty Cells."</P><p>
<b>AVG(&lt;set&gt;[, &lt;numeric_value_expression&gt;])</b></p>
<p class=tl>
Computes the average of the tuples in <i>set</i> based on <i>numeric</i>_<i>value</i>_<i>expression</i>. Similar numeric functions are: </P><ul type=disc>
<li>
MEDIAN(&lt;set&gt;[, &lt;numeric_value_expression&gt;])<br><br></li>
<li>
MIN(&lt;set&gt;[, &lt;numeric_value_expression&gt;])<br><br></li>
<li>
MAX(&lt;set&gt;[, &lt;numeric_value_expression&gt;])<br><br></li>
<li>
VARIANCE(&lt;set&gt;[, &lt;numeric_value_expression&gt;])<br><br></li>
<li>
STDDEV(&lt;set&gt;[, &lt;numeric_value_expression&gt;])<br><br></li>
<li>
RANK(&lt;tuple&gt;, &lt;set&gt;)</li>
</ul>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Each of these functions requires an implicit count of the number of cells, which does not include empty cells. In order to force the inclusion of empty cells, the application must use the <b>COALESCEEMPTY()</b> function. For more information, see “Empty Cells” in this chapter.</p>
</font></BODY>
</HTML>
