<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransactionJoin::JoinTransaction</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbitransactionjoin__jointransaction"></a>ITransactionJoin::JoinTransaction</h1>
<p>
Requests that the session enlist in a coordinated transaction.</p>
<pre><code>HRESULT JoinTransaction (
   IUnknown *               punkTransactionCoord,
   ISOLEVEL               isoLevel,
   ULONG                  isoFlags,
   ITransactionOptions *   pOtherOptions);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>punkTransactionCoord</i></p>
<p class=indent>
[in]<br>
A pointer to the controlling <b>IUnknown</b> of the transaction coordinator, or NULL in order to unenlist from the coordinated transaction. If non-null, <b>QueryInterface</b> can be called for <b>ITransaction</b> on the transaction coordinator.</p>
<p class=dt>
<i>isoLevel</i></p>
<p class=indent>
[in]<br>
The isolation level to be used with this transaction. For more information, see <a href="txnloc_44dq.htm">ITransactionLocal::StartTransaction</a>.</p>
<p class=dt>
<i>isoFlags</i></p>
<p class=indent>
[in]<br>
Must be zero.</p>
<p class=dt>
<i>pOtherOptions</i></p>
<p class=indent>
[in]<br>
Optionally a null pointer. If this is not a null pointer, then it is a pointer to an object previously returned from <b>GetOptionsObject</b> called on this session.</p>
<p class=dt>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
An unknown error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>punkTransactionCoord</i> was a null pointer and the provider doesn’t support unenlisting from a coordinated transaction.</p>
<p class=dt>
</p>
<p class=indent>
E_UNEXPECTED<br>
An unknown provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_CONNECTION_DOWN<br>
The connection to the transaction manager failed.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_CONNECTION_REQUEST_DENIED<br>
The transaction manager did not accept a connection request.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_ISOLATIONLEVEL<br>
Neither the requested isolation level, nor a strengthening of it, can be supported by this transaction implementation or <i>isoLevel</i> was not valid.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_LOGFULL<br>
Unable to begin a new transaction because the log file is full.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_NOENLIST<br>
A transaction coordinator was specified, but the new transaction was unable to enlist therein.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_NOISORETAIN<br>
The requested semantics of retention of isolation across retaining commit and abort boundaries cannot be supported by this transaction implementation or <i>isoFlags</i> was not equal to zero.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_NOTIMEOUT<br>
A time-out was specified, but time-outs are not supported.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_TMNOTAVAILABLE<br>
Unable to connect to the transaction manager or the transaction manager is unavailable.</p>
<p class=dt>
</p>
<p class=indent>
XACT_E_XTIONEXISTS<br>
The enlistment request failed for one of the following reasons:
<ul type=disc>
<li>
This session can handle only one extant transaction at a time, and there is presently such a transaction.<br><br></li>
<li>
<i>punkTransactionCoord</i> was NULL, and the session is enlisted in a coordinated transaction with uncommitted work.</li>
</ul>
<p class=dt>
</p>
<p class=label>
<b>Comments</b></p>
<p>
The provider of the session will generally first register its <b>ITransactionOutcomeEvents</b> notification sink with the transaction coordinator, so that it can be notified of the outcome of the coordinated events, and will then enlist with the transaction coordinator using the interfaces defined in OLE Transactions. It is important that the provider first register with the outcome events so that it can be advised of any failures which may occur between enlistment registration of the outcome events.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="txnloc_44dq.htm">ITransactionLocal::StartTransaction</a></p>
</font></BODY>
</HTML>
