<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAccessor::ReleaseAccessor</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbiaccessor__releaseaccessor"></a>IAccessor::ReleaseAccessor</h1>
<p>
Releases an accessor.</p>
<pre><code>HRESULT ReleaseAccessor (
   HACCESSOR   hAccessor,
   ULONG *         pcRefCount);</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>hAccessor</i></p>
<p class=indent>
[in]<br>
The handle of the accessor to release.</p>
<p class=dt>
<i>pcRefCount</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the remaining reference count of the accessor handle. If <i>pcRefCount</i> is a null pointer, no reference count is returned.</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADACCESSORHANDLE<br>
<i>hAccessor</i> was invalid.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOTREENTRANT<br>
The provider called a method from <b>IRowsetNotify</b> in the consumer and the method has not yet returned.</p>
<p class=label>
<b>Comments</b></p>
<p>
<b>ReleaseAccessor</b> decrements the reference count of the accessor. If the reference count reaches zero, it releases the accessor and all resources used by the accessor. After an accessor is released, methods called with the handle to that accessor return DB_E_BADACCESSORHANDLE.</p>
<p>
On rowsets, accessors are read-only and can be shared among threads in a free-threaded style without synchronization. The consumer must call <b>ReleaseAccessor</b> to decrement the reference count on an accessor that has been passed to a thread and is no longer needed by that thread.</p>
<p>
This method can be called while the rowset is in a zombie state to enable the consumer to clean up after a transaction has been committed or aborted.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="accssr_3pv6.htm">IAccessor::AddRefAccessor</a>, <a href="accssr_4r02.htm">IAccessor::CreateAccessor</a></p>
</font></BODY>
</HTML>
