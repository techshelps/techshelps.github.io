<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDBSchemaRowset</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbidbschemarowset"></a>IDBSchemaRowset</h1>
<p>
This is an optional interface on sessions. It is used to provide advanced schema information.</p>
<p>
Consumers can get information about a data source without knowing its structure by using the <b>IDBSchemaRowset</b> methods. For example, the data source might be a Microsoft SQL Server database that organizes each database into a set of schemas that contain the tables and queries for each schema; the data source might be a Microsoft Access 2.0 database that has a container of tables and a container of queries; or the data source might be a Microsoft Access for a Windows<sup>®</sup> 95 database that enables users to define folders to group tables into an arbitrary hierarchy.</p>
<p>
For the following schema rowsets, it is suggested that providers pay particular attention to rowset construction and data retrieval performance, because these methods will be used frequently by consumers.</p>
<p>
This schema defines a minimum content of the system schema. It is assumed that consumers will precompile and store the specialized queries used for things such as command planning and execution-time plan validation, and storage engines may have specialized optimizations associated with those plans. Consumers can also look at the schema tables in the schema, and thus discover other schema tables and attributes beyond the minimum set.</p>
<p>
For information about the schema rowsets, see Appendix B, "<a href="appbpr_9kdv.htm">Schema Rowsets</a>." Providers must return all of the columns in the rowsets they return. If they cannot return the information in a column, they must return an appropriate value. Generally, this is NULL. Providers can return provider-specific columns after the last column defined by OLE DB.</p>
<p>
Schema rowsets are identified by GUIDs. The following table lists these GUIDs and the columns for which restrictions can be specified on the schema rowset. The number of restriction columns for each schema rowset are defined as constants prefixed with CRESTRICTIONS_ in the header files. Restriction values are treated as literals rather than as search patterns. For example, the restriction value "A_C" matches "A_C" but not "ABC".<br>
</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=45%><b><br>
GUID</b></td>
<td class=label width=16%><b>Number of<br>
restrictions</b></td>
<td class=label width=39%><b><br>
Restriction columns</b></td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_ASSERTIONS</td>
<td width=16%>3</td>
<td width=39%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CATALOGS</td>
<td width=16%>1</td>
<td width=39%>CATALOG_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CHARACTER_SETS</td>
<td width=16%>3</td>
<td width=39%>CHARACTER_SET_CATALOG<br>
CHARACTER_SET_SCHEMA<br>
CHARACTER_SET_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CHECK_CONSTRAINTS</td>
<td width=16%>3</td>
<td width=39%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLLATIONS</td>
<td width=16%>3</td>
<td width=39%>COLLATION_CATALOG<br>
COLLATION_SCHEMA<br>
COLLATION_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLUMN_DOMAIN_<br>
USAGE</td>
<td width=16%>4</td>
<td width=39%>DOMAIN_CATALOG<br>
DOMAIN_SCHEMA<br>
DOMAIN_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLUMN_PRIVILEGES</td>
<td width=16%>6</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME<br>
GRANTOR<br>
GRANTEE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLUMNS</td>
<td width=16%>4</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CONSTRAINT_<br>
COLUMN_USAGE</td>
<td width=16%>7</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME<br>
CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CONSTRAINT_<br>
TABLE_USAGE</td>
<td width=16%>6</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_FOREIGN_KEYS</td>
<td width=16%>6</td>
<td width=39%>PK_TABLE_CATALOG<br>
PK_TABLE_SCHEMA<br>
PK_TABLE_NAME<br>
FK_TABLE_CATALOG<br>
FK_TABLE_SCHEMA<br>
FK_TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_INDEXES</td>
<td width=16%>5</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
INDEX_NAME<br>
TYPE<br>
TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_KEY_COLUMN_<br>
USAGE</td>
<td width=16%>7</td>
<td width=39%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME<br>
TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PRIMARY_KEYS</td>
<td width=16%>3</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PROCEDURE_COLUMNS</td>
<td width=16%>4</td>
<td width=39%>PROCEDURE_CATALOG<br>
PROCEDURE_SCHEMA<br>
PROCEDURE_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PROCEDURE_<br>
PARAMETERS</td>
<td width=16%>4</td>
<td width=39%>PROCEDURE_CATALOG<br>
PROCEDURE_SCHEMA<br>
PROCEDURE_NAME<br>
PARAMETER_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PROCEDURES</td>
<td width=16%>4</td>
<td width=39%>PROCEDURE_CATALOG<br>
PROCEDURE_SCHEMA<br>
PROCEDURE_NAME<br>
PROCEDURE_TYPE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PROVIDER_TYPES</td>
<td width=16%>2</td>
<td width=39%>DATA_TYPE<br>
BEST_MATCH</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_REFERENTIAL_<br>
CONSTRAINTS</td>
<td width=16%>3</td>
<td width=39%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_SCHEMATA</td>
<td width=16%>3</td>
<td width=39%>CATALOG_NAME<br>
SCHEMA_NAME<br>
SCHEMA_OWNER</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_SQL_LANGUAGES</td>
<td width=16%>0</td>
<td width=39%>none</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_STATISTICS</td>
<td width=16%>3</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_TABLE_CONSTRAINTS</td>
<td width=16%>7</td>
<td width=39%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME<br>
TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
CONSTRAINT_TYPE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_TABLE_PRIVILEGES</td>
<td width=16%>5</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
GRANTOR<br>
GRANTEE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_TABLES</td>
<td width=16%>4</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
TABLE_TYPE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_TABLES_INFO</td>
<td width=16%>4</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
TABLE_TYPE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_TRANSLATIONS</td>
<td width=16%>3</td>
<td width=39%>TRANSLATION_CATALOG<br>
TRANSLATION_SCHEMA<br>
TRANSLATION_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_USAGE_PRIVILEGES</td>
<td width=16%>6</td>
<td width=39%>OBJECT_CATALOG<br>
OBJECT_SCHEMA<br>
OBJECT_NAME<br>
OBJECT_TYPE<br>
GRANTOR<br>
GRANTEE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_VIEW_COLUMN_<br>
USAGE</td>
<td width=16%>3</td>
<td width=39%>VIEW_CATALOG<br>
VIEW_SCHEMA<br>
VIEW_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_VIEW_TABLE_USAGE</td>
<td width=16%>3</td>
<td width=39%>VIEW_CATALOG<br>
VIEW_SCHEMA<br>
VIEW_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_VIEWS</td>
<td width=16%>3</td>
<td width=39%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME</td>
</tr>
</table><br>
<p>
For <b>IDBSchemaRowset</b>, providers must support the following GUIDs:
<ul type=disc>
<li>
DBSCHEMA_TABLES<br><br></li>
<li>
DBSCHEMA_COLUMNS<br><br></li>
<li>
DBSCHEMA_PROVIDER_TYPES<br>
</li>
</ul>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>Method</b></td>
<td class=label width=79%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=21%><a href="dbschr_7p9w.htm">GetRowset</a></td>
<td width=79%>Returns a schema rowset.</td>
</tr>
<tr valign=top>
<td width=21%><a href="dbschr_9r5f.htm">GetSchemas</a></td>
<td width=79%>Returns a list of schema rowsets accessible by <b>IDBSchemaRowset::GetRowset</b>.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
