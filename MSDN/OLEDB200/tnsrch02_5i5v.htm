<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Understanding and Using Multidimensional Schemas</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="understandingusingmultidimensionalschemas"></a>Understanding and Using Multidimensional Schemas</h1>
<p>
OLE DB for OLAP provides interfaces and methods for providers to expose schemas and consumers to view schemas. OLE DB for OLAP does not mandate that MDPs expose the schema objects defined in this specification; rather, it simply provides a way for schema objects to be exposed if the MDP chooses to support them.</p>
<p>
OLE DB for OLAP provides interfaces that enable users to browse a set of metadata objects. Most providers expose a subset of all OLE DB for OLAP metadata objects.</p>
<p>
The central metadata object recognized by OLE DB for OLAP is the <i>cube</i>. This is a set of related dimensions, which defines an <i>n</i>-dimensional manifold. The data points of interest are the points in this manifold and each such point is uniquely identified by a set of coordinates. Each coordinate is a member of one component dimension. For example, SalesData is a cube with five dimensions: Salesperson, Geography, Time, Measures, and Products.</p>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>OLE DB for OLAP handles the Measures dimension in the same way that it handles all other dimensions, so there is complete symmetry between dimensions and measures.</p>
<p>
A <i>schema</i> is composed of a set of cubes. As in the relational case, the main purpose of a schema is to impose high-level authorization policies. A set of schemas is grouped together into a <i>catalog</i>. Just because there are catalogs and schemas, a provider doesn’t have to support this two-level grouping system. It may support catalogs only, schemas only, both, or neither.</p>
<p>
A cube has a set of <i>dimensions</i>. Each dimension consists of a set of <i>members</i>. The members of a dimension can be consolidated or aggregated along a <i>hierarchy</i>. Some dimensions can have more than one hierarchy. This means that members can aggregate, or “roll up,” in multiple ways. Each hierarchy has <i>levels</i>, and each level is made up of a set of members.</p>
<p>
For example, consider the SalesData cube mentioned previously. The Geography dimension has the following set of members (consider just two continents for simplicity):</p>
<p>
{All, Europe, North America, Canada, Germany, UK, USA, Canada-East, Canada-West, England, Germany-North, Germany-South, Ireland, Scotland, USA-NE, USA-SE, USA-NW, USA-SW, Wales, Belfast, Berlin, Boise, Boston, Calgary, Cardiff, Cookstown, Dover, Edinburgh, Glasgow, Hamburg, Houston, LA, London, Miami, Munich, New York, Ottawa, Pembroke, Seattle, Shreveport, Stuttgart, Toronto, Vancouver}</p>
<p>
There exists a natural hierarchy in this dimension, as below:</p>
<p>
<b>The World</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Continents</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Countries</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Regions</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cities</b></p>
<p>
Each of these categories is a <i>level</i>. Each level has a list of members associated with it as follows:
<ul type=disc>
<li>
The World = {All}<br><br></li>
<li>
Continents = {Europe, North America}<br><br></li>
<li>
Countries = {Canada, Germany, UK, USA}<br><br></li>
<li>
Regions = {Canada-East, Canada-West, England, Germany-North, Germany-South, Ireland, Scotland, USA-NE, USA-SE, USA-NW, USA-SW, Wales}<br><br></li>
<li>
Cities = {Belfast, Berlin, Boise, Boston, Calgary, Cardiff, Cookstown, Dover, Edinburgh, Glasgow, Hamburg, Houston, LA, London, Miami, Munich, New York, Ottawa, Pembroke, Seattle, Shreveport, Stuttgart, Toronto, Vancouver}</li>
</ul>
<p>
Members at the leaf level have no children, and member(s) at the root level have no parents. All other members have at least one parent and at least one child. For example, a partial traversal of the hierarchy tree in the Geography dimension yields the following parent-child relationships:</p>
<p>
{All} (parent of) {Europe, North America}</p>
<p>
{North America} (parent of) {Canada ,USA}</p>
<p>
{USA} (parent of) {USA-NE, USA-NW, USA-SE, USA-SW}</p>
<p>
{USA-NW} (parent of) {Boise, Seattle}</p>
<p>
To see the need for multiple simultaneous hierarchies, consider the Time dimension of the SalesData cube. There are two ways to roll up to the Year level from the Days level, as follows:</p>
<p>
<b>Year</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Quarter</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Month</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Day of Month</b></p>
<p>
or</p>
<p>
<b>Year</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Week</b></p>
<p>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Day of the Week</b></p>
<p>
This example also illustrates another characteristic: Some members of the Week level of the Year-Week hierarchy do not appear in any level of the Year-Quarter hierarchy. Thus, a hierarchy need not include all members of a dimension. However, if there is just a single hierarchy in a dimension, it is common for all members of the dimension to be included in the hierarchy.</p>
<p>
The final concept is properties. In a Salesperson dimension, there is usually a need to store additional data about each salesperson — data such as “Address” or “Phone Number.” This additional information is called a <i>property</i>. Each level of a hierarchy tends to have a different set of properties, but all members in a given level have the same set of properties. For example, consider the Geography dimension. Each city can have the properties NUMBER_OF_RETAIL_OUTLETS, WAREHOUSE_NAME, and SALESREP, but these properties may not apply at the Region level. Instead, a region might have properties such as REGIONAL_MANAGER and IMPORT_POINT.</p>
</font></BODY>
</HTML>
