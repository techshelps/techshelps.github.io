<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Schema Rowsets</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="schemarowsets"></a>Schema Rowsets</h1>
<p>
This section describes the contents of schema rowsets, as defined in the current implementation of Microsoft<sup>®</sup> PivotTable<sup>®</sup> Service. Each rowset is described by a table. Note that:
<ul type=disc>
<li>
Some of the values in the "Description" column are listed as NULL because they are unknown. (The OLE DB for OLAP specification may require that some columns be non-NULL.)<br><br></li>
<li>
The term "fully-qualified name" means that all parent elements are included in the name, up to but not including, the cube name, and that all elements are enclosed in brackets. For members, all parents are included and level names are excluded – for example:<pre><code>[HighwaysDim].[LocationHier].[USA].[Washington].[Seattle]
</code></pre>
</li>
</ul>
<h2>AXIS Rowset</h2>
<p class=indent>
<B><b>Note</b></B> &nbsp; The AXIS Rowset is not a true schema rowset because it will not be returned by <b>IDBSchemaRowset</b>.</p>
<p>
The current OLE DB for OLAP specification provides two separate names for columns appearing in AXIS rowsets. Microsoft PivotTable Service uses the names shown in the following table.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_UNIQUE_NAME</td>
<td width=65%>Fully-qualified member name, for example:<pre><code>[HighwaysDim].[LocationHier].[USA].
[Washington].[Seattle]</code></pre>
</td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_CAPTION</td>
<td width=65%>Naked member name, for example:<pre><code>Seattle</code></pre>
</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_UNIQUE_NAME</td>
<td width=65%>Level unique name, for example:<pre><code>[HighwaysDim].[LocationHier].[CityLevel]</code></pre>
</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_NUMBER</td>
<td width=65%>Level depth, zero-based</td>
</tr>
<tr valign=top>
<td width=35%>CHILDREN</td>
<td width=65%>Can be one of the following:<ul type=disc>
<li>
Zero, if it is guaranteed that no children exist<br><br></li>
<li>
The actual child count<br><br></li>
<li>
A large constant if the count is unknown. This constant is 1000 in the current implementation.</li>
</ul>
</td>
</tr>
</table><br>
<p>
Member properties are also supported and will appear in the AxisRowset if specified in the query. Member properties can be specified for each axis but not for each dimension. For each dimension in the axis where member properties are specified, the corresponding columns from the MEMBERS schema rowset will appear. Consumers can use the information in AxisInfo to navigate this information.</p>
<h2>CUBES Rowset</h2>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>CATALOG_NAME</td>
<td width=65%>Database name.</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_NAME</td>
<td width=65%>Cube name</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_TYPE</td>
<td width=65%>Either "CUBE" or "VIRTUAL CUBE"</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_GUID</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CREATED_ON</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>LAST_SCHEMA_UPDATE</td>
<td width=65%>Time when last cube or dimension was processed</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_UPDATED_BY</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>LAST_DATA_UPDATE</td>
<td width=65%>Time when last cube or dimension was processed</td>
</tr>
<tr valign=top>
<td width=35%>DATA_UPDATED_BY</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>DESCRIPTION</td>
<td width=65%>Always NULL</td>
</tr>
</table><br>
<h2>DIMENSIONS Rowset</h2>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>CATALOG_NAME</td>
<td width=65%>Database name</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_NAME</td>
<td width=65%>Cube name</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_NAME</td>
<td width=65%>Dimension name</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_UNIQUE_NAME</td>
<td width=65%>Fully-qualified dimension name.</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_GUID</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_ORDINAL</td>
<td width=65%>Zero-based ordinal. The measures dimension is represented by the ordinal 0.</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_CAPTION</td>
<td width=65%>Dimension name</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_TYPE</td>
<td width=65%>One of the following values:<ul type=disc>
<li>
MD_DIMTYPE_MEASURE<br><br></li>
<li>
MD_DIMTYPE_TIME<br><br></li>
<li>
MD_DIMTYPE_OTHER</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_CARDINALITY</td>
<td width=65%>Count of members. For dimensions with many members, the count may be an approximation.</td>
</tr>
<tr valign=top>
<td width=35%>DEFAULT_HIERARCHY</td>
<td width=65%>Returns the first hierarchy in the list for this dimension; NULL if this hierarchy has no name, otherwise a fully-qualified hierarchy name.</td>
</tr>
<tr valign=top>
<td width=35%>DESCRIPTION</td>
<td width=65%>Always NULL</td>
</tr>
</table><br>
<h2>HIERARCHIES Rowset</h2>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>CATALOG_NAME</td>
<td width=65%>Database name</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_NAME</td>
<td width=65%>Cube name</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_NAME</td>
<td width=65%>Dimension name</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_UNIQUE_NAME</td>
<td width=65%>Fully-qualified dimension name</td>
</tr>
<tr valign=top>
<td width=35%>HIERARCHY_NAME</td>
<td width=65%>Hierarchy name</td>
</tr>
<tr valign=top>
<td width=35%>HIERARCHY_UNIQUE_NAME</td>
<td width=65%>Fully-qualified hierarchy name. (This is just the dimension name if there is only one hierarchy). All elements are enclosed in brackets.</td>
</tr>
<tr valign=top>
<td width=35%>HIERARCHY_GUID</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_TYPE</td>
<td width=65%>One of the following values:<ul type=disc>
<li>
MD_DIMTYPE_MEASURE<br><br></li>
<li>
MD_DIMTYPE_TIME<br><br></li>
<li>
MD_DIMTYPE_OTHER</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>HIERARCHY_CAPTION</td>
<td width=65%>Dimension name &lt;space&gt; &lt;Hierarchy name&gt;. (If no hierarchy exists, then just the dimension name.)</td>
</tr>
<tr valign=top>
<td width=35%>DEFAULT_MEMBER</td>
<td width=65%>Always returns the very first member</td>
</tr>
<tr valign=top>
<td width=35%>ALL_MEMBER</td>
<td width=65%>The name of the default member if the first level is "All"; otherwise NULL.</td>
</tr>
<tr valign=top>
<td width=35%>DESCRIPTION</td>
<td width=65%>Always NULL</td>
</tr>
</table><br>
<h2>LEVELS Rowset</h2>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>CATALOG_NAME</td>
<td width=65%>Database name</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_NAME</td>
<td width=65%>Cube name</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_UNIQUE_NAME</td>
<td width=65%>Fully-qualified dimension name</td>
</tr>
<tr valign=top>
<td width=35%>HIERARCHY_UNIQUE_NAME</td>
<td width=65%>Hierarchy unique name</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_NAME</td>
<td width=65%>Level name</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_UNIQUE_NAME</td>
<td width=65%>Fully-qualified level name</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_GUID</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_CAPTION</td>
<td width=65%>Level name</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_NUMBER</td>
<td width=65%>Zero-based ordinal of level of this dimension</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_TYPE</td>
<td width=65%>One of the following values:<ul type=disc>
<li>
MDLEVEL_TYPE_ REGULAR<br><br></li>
<li>
MDLEVEL_TYPE_ALL<br><br></li>
<li>
MDLEVEL_TYPE_CALCULATED<br><br></li>
<li>
MDLEVEL_TYPE_TIME<br><br></li>
<li>
MDLEVEL_TYPE_RESERVED1<br><br></li>
<li>
MDLEVEL_TYPE_TIME_YEARS<br><br></li>
<li>
MDLEVEL_TYPE_TIME_HALF_YEAR<br><br></li>
<li>
MDLEVEL_TYPE_TIME_QUARTERS<br><br></li>
<li>
MDLEVEL_TYPE_TIME_MONTHS<br><br></li>
<li>
MDLEVEL_TYPE_TIME_WEEKS<br><br></li>
<li>
MDLEVEL_TYPE_TIME_DAYS<br><br></li>
<li>
MDLEVEL_TYPE_TIME_HOURS<br><br></li>
<li>
MDLEVEL_TYPE_TIME_MINUTES<br><br></li>
<li>
MDLEVEL_TYPE_TIME_SECONDS<br><br></li>
<li>
MDLEVEL_TYPE_TIME_UNDEFINED<br><br></li>
<li>
MDLEVEL_TYPE_UNKNOWN</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>DESCRIPTION</td>
<td width=65%>Always NULL</td>
</tr>
</table><br>
<h2>MEASURES Rowset</h2>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>CATALOG_NAME</td>
<td width=65%>Database name</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_NAME</td>
<td width=65%>Cube name</td>
</tr>
<tr valign=top>
<td width=35%>MEASURE_NAME</td>
<td width=65%>Measure name</td>
</tr>
<tr valign=top>
<td width=35%>MEASURE_UNIQUE_NAME</td>
<td width=65%>Fully-qualified member name, including dimension. Suitable for use in a query.</td>
</tr>
<tr valign=top>
<td width=35%>MEASURE_CAPTION</td>
<td width=65%>Measure name</td>
</tr>
<tr valign=top>
<td width=35%>MEASURES_GUID</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>MEASURE_AGGREGATOR</td>
<td width=65%>Returns one of the following values:<ul type=disc>
<li>
MDMEASURE_AGGR_SUM<br><br></li>
<li>
MDMEASURE_AGGR_COUNT<br><br></li>
<li>
MDMEASURE_AGGR_MIN<br><br></li>
<li>
MDMEASURE_AGGR_MAX</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>DATA_TYPE</td>
<td width=65%>OLE DB data type that most closely matches the OLAP Provider type. One of the following values:<ul type=disc>
<li>
DBTYPE_I2<br><br></li>
<li>
DBTYPE_I4<br><br></li>
<li>
DBTYPE_I8<br><br></li>
<li>
DBTYPE_R4<br><br></li>
<li>
DBTYPE_R8</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>NUMERIC_PRECISION</td>
<td width=65%>Numeric precision for OLE DB data type</td>
</tr>
<tr valign=top>
<td width=35%>NUMERIC_SCALE</td>
<td width=65%>Numeric scale for OLE DB data type</td>
</tr>
<tr valign=top>
<td width=35%>DESCRIPTION</td>
<td width=65%>Always NULL</td>
</tr>
</table><br>
<h2>PROPERTIES Rowset</h2>
<p>
Microsoft PivotTable Service supports cell properties only in this release.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>CATALOG_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_UNIQUE_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>HIERARCHY_UNIQUE_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_UNIQUE_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_UNIQUE_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>PROPERTY_TYPE</td>
<td width=65%>Always MDPROP_CELL. A bitmask indicating that this is a property of the cell. Can be used in the CELL PROPERTIES clause that occurs at the end of a SELECT statement.</td>
</tr>
<tr valign=top>
<td width=35%>PROPERTY_NAME</td>
<td width=65%>One of the following values:<ul type=disc>
<li>
VALUE<br><br></li>
<li>
FORMATTED_VALUE<br><br></li>
<li>
CELL_ORDINAL<br><br></li>
<li>
FORMAT_STRING<br><br></li>
<li>
FORE_COLOR<br><br></li>
<li>
BACK_COLOR<br><br></li>
<li>
FONT_NAME<br><br></li>
<li>
FONT_SIZE<br><br></li>
<li>
FONT_FLAGS</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>PROPERTY_CAPTION</td>
<td width=65%>Property name</td>
</tr>
<tr valign=top>
<td width=35%>DATA_TYPE</td>
<td width=65%>Data type, as listed in the OLE DB specification</td>
</tr>
<tr valign=top>
<td width=35%>CHARACTER_MAXIMUM_LENGTH</td>
<td width=65%>255, if appropriate</td>
</tr>
<tr valign=top>
<td width=35%>CHARACTER_OCTET_LENGTH</td>
<td width=65%>As appropriate</td>
</tr>
<tr valign=top>
<td width=35%>NUMERIC_PRECISION</td>
<td width=65%>As appropriate</td>
</tr>
<tr valign=top>
<td width=35%>NUMERIC_SCALE</td>
<td width=65%>As appropriate</td>
</tr>
<tr valign=top>
<td width=35%>DESCRIPTION</td>
<td width=65%>Always NULL</td>
</tr>
</table><br>
<h2>MEMBERS Rowset</h2>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td class=label width=35%><b>Name</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%>CATALOG_NAME</td>
<td width=65%>Database name</td>
</tr>
<tr valign=top>
<td width=35%>SCHEMA_NAME</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>CUBE_NAME</td>
<td width=65%>Cube name</td>
</tr>
<tr valign=top>
<td width=35%>DIMENSION_UNIQUE_NAME</td>
<td width=65%>Dimension unique name</td>
</tr>
<tr valign=top>
<td width=35%>HIERARCHY_UNIQUE _NAME</td>
<td width=65%>Hierarchy unique name</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_UNIQUE _NAME</td>
<td width=65%>Level unique name</td>
</tr>
<tr valign=top>
<td width=35%>LEVEL_NUMBER</td>
<td width=65%>Zero-based ordinal of level of this dimension</td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_NAME</td>
<td width=65%>Member name without parent member</td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_UNIQUE_NAME</td>
<td width=65%>Fully-qualified member name, including dimension, hierarchy, and all parent members.</td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_TYPE</td>
<td width=65%>One of the following:<ul type=disc>
<li>
MDMEMBER_TYPE_REGULAR<br><br></li>
<li>
MDMEMBER_TYPE_ALL<br><br></li>
<li>
MDMEMBER_TYPE_MEASURE<br><br></li>
<li>
MDMEMBER_TYPE_FORMULA</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_GUID</td>
<td width=65%>Always NULL</td>
</tr>
<tr valign=top>
<td width=35%>MEMBER_CAPTION</td>
<td width=65%>Member name without parent member</td>
</tr>
<tr valign=top>
<td width=35%>CHILDREN</td>
<td width=65%>Can be one of the following:<ul type=disc>
<li>
Zero, if it is guaranteed that no children exist<br><br></li>
<li>
The actual child count<br><br></li>
<li>
A large constant if the count is unknown. This constant is 1000 in the current implementation.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=35%>PARENT_LEVEL</td>
<td width=65%>LEVEL_NUMBER minus 1 (0 for root level).</td>
</tr>
<tr valign=top>
<td width=35%>PARENT_NAME</td>
<td width=65%>Parent member name. NULL for root level of dimension.</td>
</tr>
</table><br>
<h2>Schema Rowset Restrictions</h2>
<p>
TREE_OPERATOR is implemented. Operators are combined with bitwise OR. The resulting rowset is the union of each operation, as required by the OLE DB for OLAP specification. </p>
<p>
Note that duplicate rows may be generated when the algorithm for tree operators is used – for example, when retrieving the siblings of all members in a level – but this presents no practical problems.</p>
<p>
MEMBER_NAME acts like most other restrictions. You can view the rowset as the result of a WHERE clause constraint on a giant table of all members. (This is the normal model presented by the OLE DB for OLAP specification.) Duplicates will appear. For instance, restricting member name to Portland might yield two rows, with parent names of ME and OR. Note that the member name restriction should not be enclosed in brackets, since it does not appear in the context where brackets would be needed.</p>
<p>
The MEMBER_UNIQUE_NAME restriction acts like a WHERE clause. Input to the restriction can be fully qualified with elements enclosed in brackets. It is not an error for MEMBER_UNIQUE_NAME to result in no members – for example, city [XXX], which does not exist, will return an empty rowset.</p>
<p>
Giving nonstring restrictions (for example, VT_NULL) for member names will yield an empty rowset.</p>
<p>
The MEMBER_UNIQUE_NAME restriction can accept unqualified names, but will return only one matching row for the cube, even if several exist. The restriction is expected to execute more quickly than the MEMBER_NAME restriction because more information is available for use in searching.</p>
</font></BODY>
</HTML>
