<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving Cell Properties</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="retrievingcellproperties"></a>Retrieving Cell Properties</h1>
<p>
A cell may have more properties than the obvious VALUE. The complex and sophisticated nature of multidimensional cubes allows cells to have enhanced properties that enable smart formatting and coloring. Support for these enhanced properties may vary from provider to provider. OLE DB for OLAP recognizes the following properties as typical properties that a provider may support for a cell:</p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=26%><b><br>
Property name</b></td>
<td class=label width=17%><b>Mandatory/<br>
Optional</b></td>
<td class=label width=23%><b><br>
Data type</b></td>
<td class=label width=34%><b><br>
Description</b></td>
</tr>
<tr valign=top>
<td width=26%>CELL_ORDINAL</td>
<td width=17%>Mandatory</td>
<td width=23%>DBTYPE_UI4</td>
<td width=34%>Ordinal number of the cell in the dataset. For more information, see “Cell Navigation in a Dataset.”</td>
</tr>
<tr valign=top>
<td width=26%>VALUE</td>
<td width=17%>Mandatory</td>
<td width=23%>DBTYPE_VARIANT</td>
<td width=34%>Actual data value.</td>
</tr>
<tr valign=top>
<td width=26%>FORMATTED_VALUE</td>
<td width=17%>Mandatory</td>
<td width=23%>DBTYPE_WSTR</td>
<td width=34%>Character string that represents a formatted display of VALUE.</td>
</tr>
<tr valign=top>
<td width=26%>FORMAT_STRING</td>
<td width=17%>Optional</td>
<td width=23%>DBTYPE_WSTR</td>
<td width=34%>Format string used to create FORMATTED_VALUE. For more information, see “Contents of FORMAT_STRING” in this section.</td>
</tr>
<tr valign=top>
<td width=26%>FORE_COLOR</td>
<td width=17%>Optional</td>
<td width=23%>DBTYPE_UI4</td>
<td width=34%>Foreground color for displaying VALUE. For more information, see “Contents of FORE COLOR and BACK COLOR” in this section.</td>
</tr>
<tr valign=top>
<td width=26%>BACK_COLOR</td>
<td width=17%>Optional</td>
<td width=23%>DBTYPE_UI4</td>
<td width=34%>Background color for displaying VALUE. For more information, see “Contents of FORE COLOR and BACK COLOR” in this section.</td>
</tr>
<tr valign=top>
<td width=26%>FONT_NAME</td>
<td width=17%>Optional</td>
<td width=23%>DBTYPE_WSTR</td>
<td width=34%>Font to be used to display VALUE.</td>
</tr>
<tr valign=top>
<td width=26%>FONT_SIZE</td>
<td width=17%>Optional</td>
<td width=23%>DBTYPE_UI2</td>
<td width=34%>Font size to be used to display VALUE.</td>
</tr>
<tr valign=top>
<td width=26%>FONT_FLAGS</td>
<td width=17%>Optional</td>
<td width=23%>DBTYPE_I4</td>
<td width=34%>Bitmask detailing effects on the font. Can be the result of a bitwise OR operation of one or more of the following:<ul type=disc>
<li>
MDFF_BOLD<br><br></li>
<li>
MDFF_ITALIC<br><br></li>
<li>
MDFF_UNDERLINE<br><br></li>
<li>
MDFF_STRIKEOUT</li>
</ul>
</td>
</tr>
</table><br>
<p>
A provider must support the properties labeled as “Mandatory” in this table. A provider may also support other properties not listed. To find out what cell properties a provider supports, an application can obtain the PROPERTIES rowset with a restriction on the PROPERTY_TYPE column set to MDPROP_CELL. The application can specify exactly what properties it wants to see by using the <b>CELL PROPERTIES</b> keyword after the WHERE clause. For example, the expression</p>
<pre><code>SELECT NON EMPTY Products DIMENSION PROPERTIES Products.SKU, Products.SRP 
 &nbsp; ON ROWS,
CROSSJOIN (Years, (Sales, BudgetedSales)) ON COLUMNS
FROM SalesCube
WHERE (January, SalesPerson.All, Geography.USA)
CELL PROPERTIES VALUE, FORMATTED_VALUE, FORE_COLOR, BACK_COLOR
</code></pre>
<p>
will yield a dataset in which each cell has the properties VALUE, FORMATTED_VALUE, FORE_COLOR, and BACK_COLOR.</p>
<p>
If the application does not specify any properties for a cell in the MDX statement, the provider assumes a default set of properties that <i>must</i> include CELL_ORDINAL, VALUE, and FORMATTED_VALUE, in that order. It can also include other properties that are provider-specific (for example, provider-specific mandatory properties). It must not include any of the optional properties specified in the table above. If the consumer uses the CELL PROPERTIES clause, then only those properties selected in this clause are returned. (If the clause does not include any of the default properties mentioned above, then those default properties are not returned.)</p>
<p>
The properties present in the dataset, their data types, and so on, are available by means of the <b>IColumnsInfo</b> interface on the dataset. You can determine the cell properties in the data source that are available for use in the CELL PROPERTIES clause by using the PROPERTIES rowset and restricting it with the PROPERTY_TYPE column.</p>
</font></BODY>
</HTML>
