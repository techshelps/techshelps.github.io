<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Data Type Mapping in ITableDefinition</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="data_type_mapping_in_itabledefinition"></a>Data Type Mapping in ITableDefinition</h1>
<p>
When creating tables by using <b>ITableDefinition::CreateTable</b>, the SQLOLEDB consumer can specify SQL Server data types in the <i>pwszTypeName</i> member of the DBCOLUMNDESC array passed. If the consumer specifies a column’s data type by name, then OLE DB type mapping, represented by the <i>wType</i> member of the DBCOLUMNDESC structure, is ignored.</p>
<p>
When specifying new column data types with OLE DB types, that is, when using the DBCOLUMNDESC structure <i>wType</i> member, SQLOLEDB maps OLE DB types as follows.<br>
</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=29%><b><br>
OLE DB data type</b></td>
<td class=label width=25%><b>SQL Server data type</b></td>
<td class=label width=46%><b><br>
Additional information</b></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_BOOL</td>
<td width=25%><b>bit</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_BYTES</td>
<td width=25%><b>binary</b>,<b> varbinary </b>or<b> image</b></td>
<td width=46%>SQLOLEDB inspects the <i>ulColumnSize</i> member of the DBCOLUMNDESC structure. Based on the value, and the version of the SQL Server, SQLOLEDB maps the type to <b>image</b>.<p>
If the value of <i>ulColumnSize</i> is smaller than the maximum length of a binary data type column, then SQLOLEDB inspects the DBCOLUMNDESC <i>rgPropertySets</i> member. If the DBPROP_COL_<br>
FIXEDLENGTH is VARIANT_<br>
TRUE, SQLOLEDB maps the type to <b>binary</b>. If the value of the property is VARIANT_FALSE, SQLOLEDB maps the type to <b>varbinary</b>. In either case, the DBCOLUMNDESC <i>ulColumnSize</i> member determines the width of the SQL Server column created.</p>
</td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_CY</td>
<td width=25%><b>money</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_<br>
DBTIMESTAMP</td>
<td width=25%><b>datetime</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_GUID</td>
<td width=25%><b>uniqueidentifier</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_I2</td>
<td width=25%><b>smallint</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_I4</td>
<td width=25%><b>int</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_NUMERIC</td>
<td width=25%><b>numeric</b></td>
<td width=46%>SQLOLEDB inspects the DBCOLUMDESC <i>bPrecision</i> and <i>bScale</i> members to determine precision and scale for the <b>numeric</b> column.</td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_R4</td>
<td width=25%><b>real</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_R8</td>
<td width=25%><b>float</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_STR</td>
<td width=25%><b>char</b>, <b>varchar</b> or <b>text</b></td>
<td width=46%>SQLOLEDB inspects the <i>ulColumnSize</i> member of the DBCOLUMNDESC structure. Based on the value and the version of the SQL Server, SQLOLEDB maps the type to <b>text</b>.<p>
If the value of <i>ulColumnSize</i> is smaller than the maximum length of a multibyte character data type column, then SQLOLEDB inspects the DBCOLUMNDESC <i>rgPropertySets</i> member. If the DBPROP_COL_FIXEDLENGTH is VARIANT_TRUE, SQLOLEDB maps the type to <b>char</b>. If the value of the property is VARIANT_<br>
FALSE, SQLOLEDB maps the type to <b>varchar</b>. In either case, the DBCOLUMNDESC <i>ulColumnSize</i> member determines the width of the SQL Server column created.</p>
</td>
</tr>
<tr valign=top>
<td width=29%>DBTYPE_UI1</td>
<td width=25%><b>TINYINT</b></td>
<td width=46%></td>
</tr>
</table><br>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>When creating a new table, SQLOLEDB maps only the OLE DB data type enumeration values specified in the table above. Attempting to create a table with a column of any other OLE DB type generates an error.</p>
<p class=indent>
</p>
</font></BODY>
</HTML>
