<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMDFind::FindCell</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="imdfindfindcell"></a>IMDFind::FindCell</h1>
<p>
Finds and returns a cell ordinal based on an array of members and a starting cell ordinal in the dataset.</p>
<pre><code>HRESULT FindCell(
   ULONG         ulStartingOrdinal,
   ULONG         cMembers,
   LPCOLESTR*   rgpwszMember,
   ULONG*      pulCellOrdinal);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>ulStartingOrdinal</i>[in]</p>
<p class=indent>
The cell ordinal from which to begin the search. For more information, see comments.</p>
<p class=dt>
<i>cMembers</i>[in]</p>
<p class=indent>
The cardinality of the <i>rgpwszMember</i> array.</p>
<p class=dt>
<i>rgpwszMember</i>[in]</p>
<p class=indent>
An array of members. Each element of the array contains a member along a given axis. For more information, see comments.</p>
<p class=dt>
<i>pulCellOrdinal</i>[out]</p>
<p class=indent>
The ordinal value of the cell specified by the members in the <i>rgpwszMember </i>array.</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=indent>
E_INVALIDARG<br>
<i>pulCellOrdinal</i> was a null pointer.</p>
<p class=tl>
<i>cMembers</i> was less than 1.</P><p class=indent>
MD_E_BADCOORDINATE<br>
<i>ulStartingOrdinal</i> did not identify a cell in the dataset.</p>
<p class=tl>
The set of members for a given axis did not identify a valid tuple.</P><p class=tl>
The set of tuples resulting from the member array did not identify a valid cell in the Dataset beyond <i>ulStartingOrdinal</i> (inclusive).</P><p class=tl>
One or more elements of the member array specified a member that does not exist.</P><p class=tl>
One or more elements of the member array contained an ambiguous member specification.</P><p class=label>
<b>Comments</b></p>
<p>
The search is initiated from the cell identified by <i>ulStartingOrdinal</i>, in the direction of increasing axis ordinals. The starting cell is included in the search.</p>
<p>
Each member string is null terminated.</p>
<p>
The members must be listed in increasing order of numeric axis identifiers and members for a given axis must form a tuple on that axis. Constituent members of this tuple are listed in increasing order of dimension nesting — that is, members of the outermost dimension come first, followed by members of inner dimensions.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Members must be specified with enough qualifiers to create an unambiguous reference. Using MEMBER_UNIQUE_NAME from the MEMBERS rowset accomplishes this, because it is qualified to the extent required to create an unambiguous reference.</p>
<p>
The members collectively specify a cell in the dataset. The provider generates a cell ordinal, identifying this cell, and returns a pointer to the ordinal, which can then be used as the input argument to <b>IMDDataset::GetCellData()</b>. For more information on cell ordinals and how they are generated, see <b>IMDDataset::GetCellData</b>.</p>
<p>
This method searches for an exact match in that it compares for equality. Since members must be qualified to create an unambiguous reference, there is no possibility (by definition) of finding more than one cell.</p>
<p>
Because the same tuple can be repeated on an axis, there can be more than one cell identified by the same set of members. The parameter <i>ulStartingOrdinal</i> can be used to find all such occurrences. You call this method successively, setting <i>ulStartingOrdinal</i> to 0 for the first call. Successive calls increment the value of <i>*pulCellOrdinal</i> returned by the previous call and use the new value for <i>ulStartingOrdinal</i>.</p>
<p>
The default member of a dimension (if one exists) is used in the absence of an explicit member specification. To use the default member for a given dimension, you set the corresponding array element to a null pointer. If <i>rgpwszMember</i> is a null pointer, then default members are used for all the constituent dimensions. </p>
<p>
If an error occurs, the contents of <i>*pulCellOrdinal</i> are undefined.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The <b>FindCell</b> method calls <b>FindTuple</b> for each axis, and uses the returned AxisTupleOrdinals to calculate the cell coordinate.</p>
</font></BODY>
</HTML>
