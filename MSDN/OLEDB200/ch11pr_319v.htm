<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting Property Values</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbgetting_property_values"></a>Getting Property Values</h1>
<p>
To get property values, a consumer performs the following actions:
<ol>
<li>
Determines the properties for which to get values.<br><br></li>
<li>
Determines the property sets that contain the identified properties.<br><br></li>
<li>
Allocates an array of DBPROPIDSET structures, one for each identified property set.<br><br></li>
<li>
Allocates an array of DBPROPIDs for each property set. The number of elements in each array is the number of properties identified in step 1 that belong to that property set.<br><br></li>
<li>
Places the ID of each property in the DBPROPID array.<br><br></li>
<li>
Places the property set GUID in the DBPROPIDSET structure for each property set. It then places the count of elements in and the pointer to the corresponding DBPROPID array in the DBPROPIDSET structure.<br><br></li>
<li>
Calls a method that gets properties and passes it the count and array of DBPROPIDSET structures.</li>
</ol>
<p>
To return property values, the provider performs the following actions:
<ol>
<li>
Allocates an array of DBPROPSET structures. The elements of this array correspond to the elements of the DBPROPIDSET array.<br><br></li>
<li>
For each element of the DBPROPIDSET array, allocates an array of DBPROP structures. The elements of the DBPROP array correspond to the elements of the DBPROPID array.<br><br></li>
<li>
Places the value, column ID, whether the property is required or optional, and status of each property in the DBPROP structure that corresponds to the DBPROPID value for the property.<br><br></li>
<li>
Places the property set GUID in the DBPROPSET structure for each property set. It then places the count of elements in and the pointer to the corresponding DBPROP array in the DBPROPSET structure.<br><br></li>
<li>
Returns the count and array of DBPROPSET structures to the consumer.</li>
</ol>
<p>
For example, assume that the consumer wants to get values for five properties, where properties 1, 2, and 3 are in property set A and properties 4 and 5 are in property set B. The consumer uses the following structures.</p>
<p class=label>
<b>An example of how a consumer gets property values</b></p>
<p>
<img src="ch1102.gif" border=0></p>
<p>
The provider returns the following structures.</p>
<p class=label>
<b>An example of what property values a provider returns</b></p>
<p>
<img src="ch1103.gif" border=0></p>
<p>
The following table lists the methods that consumers use to get property values.</p>
<p class=label>
<b>Methods used by consumers to get property values</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=38%><b>Property group</b></td>
<td class=label width=62%><b>Methods used to get property values</b></td>
</tr>
<tr valign=top>
<td width=38%>Data Source</td>
<td width=62%><u>IDBProperties::GetPropertiesoledbIDBProperties__GetProperties</u></td>
</tr>
<tr valign=top>
<td width=38%>Data Source Information</td>
<td width=62%><u>IDBProperties::GetPropertiesoledbIDBProperties__GetProperties</u></td>
</tr>
<tr valign=top>
<td width=38%>Index</td>
<td width=62%><a href="rowidx_9g8f.htm">IRowsetIndex::GetIndexInfo</a></td>
</tr>
<tr valign=top>
<td width=38%>Initialization</td>
<td width=62%><u>IDBProperties::GetPropertiesoledbIDBProperties__GetProperties</u></td>
</tr>
<tr valign=top>
<td width=38%>Rowset</td>
<td width=62%><a href="cmdprop_2wqb.htm">ICommandProperties::GetProperties</a><b>,<br>
</b><a href="rowinf_1pgz.htm">IRowsetInfo::GetProperties</a></td>
</tr>
<tr valign=top>
<td width=38%>Session</td>
<td width=62%><u>ISessionProperties::GetProperties</u>oledbISessionProperties__GetProperties</td>
</tr>
</table><br>
</font></BODY>
</HTML>
