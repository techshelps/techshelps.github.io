<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>If Clause</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="ifclause"></a>If Clause</h1>
<p>
The if clause, <b>iif</b>, can be used to test any search condition and choose one value or another based on whether the test is true or false. The BMF construct is:</p>
<pre><code>&lt;if_expression&gt; ::= iif(&lt;search_condition&gt;, &lt;true_part&gt;, &lt;false_part&gt;)
&lt;true_part&gt; ::= &lt;value_expression&gt;
&lt;false_part&gt; ::= &lt;value_expression&gt;
</code></pre>
<p>
The data type of <i>true_part</i> must be the same as the data type of <i>false_part</i>. That is, either both are numeric value expressions or both are string value expressions.</p>
<p>
The following example demonstrates the use of <b>iif</b>. The query displays actual sales, budgeted sales, and variance (that is, the difference between actual and budgeted sales) for Asia and Europe for each quarter of 1991, for all sales reps and all products. The conditional expression is used to keep the variance always positive.</p>
<pre><code>WITH MEMBER [Measures].[Variance] AS iif ((Sales &gt; BudgetedSales), 
  (Sales - BudgetedSales), (BudgetedSales - Sales))
SELECT
  {Sales, BudgetedSales, Variance} ON COLUMNS,
  CROSSJOIN({Asia, Europe}, {Qtr1, Qtr2, Qtr3, Qtr4}) ON ROWS
FROM SalesCube
WHERE ([1991], [SalesPerson].[ALL], [Products].[ALL])
</code></pre>
</font></BODY>
</HTML>
