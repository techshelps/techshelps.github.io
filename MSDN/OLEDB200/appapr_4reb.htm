<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Conversions Involving Strings</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbconversions_involving_strings"></a>Conversions Involving Strings</h1>
<p>
The following formats are used for conversions to and from strings. Only nontrivial formats are listed. Converting a string to a nonstring type may fail for some providers if the string contains trailing blanks.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=30%><b>Type indicator</b></td>
<td class=label width=70%><b>Format</b></td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_BYTES</td>
<td width=70%>When strings are converted to and from binary data, each byte of binary data is represented as two ASCII characters. These characters are the ASCII character representation of the number in its hexadecimal form. For example, a binary 00000001 is converted to "01" and a binary 11111111 is converted to "FF".</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_CY</td>
<td width=70%>"...<i>cccc</i>.<i>cccc</i>"</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_BOOL</td>
<td width=70%>"True" and "False"</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_DATE</td>
<td width=70%>As in Automation, according to the regional settings of the machine. For example, for the "English(United States)" default setting, this would typically be:<p>
"<i>mm/dd/yy hh</i>:<i>mm</i>:<i>ss</i> {AM|PM}"</p>
</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_DBDATE</td>
<td width=70%>As specified by ISO:<p>
"<i>yyyy</i>-<i>mm</i>-<i>dd</i>"</p>
</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_FILETIME</td>
<td width=70%>"yyyyy-mm-dd hh:mm:ss.fff" where fff is from 0-999. Up to 3 digits may be used. The format is the same as SYSTEMTIME. Valid filetime value is 0x0000000000000000 -&nbsp; 0x7FFFFFFFFFFFFFFF, which is 01601-01-01 00:00:000 - 30828-09-14 02:24:05.477.</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_DBTIME</td>
<td width=70%>As specified by ISO:<p>
&nbsp;"<i>hh</i>:<i>mm</i>:<i>ss</i>"</p>
</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_<br>
DBTIMESTAMP</td>
<td width=70%>As specified by ISO:<p>
&nbsp;"<i>yyyy</i>-<i>mm</i>-<i>dd</i> <i>hh</i>:<i>mm</i>:<i>ss</i>.<i>f</i>..."</p>
<p>
where "<i>f</i>..." is fractions of a second (up to nine digits may be used).</p>
</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_GUID</td>
<td width=70%>As represented in the registry:<p>
&nbsp;"{<i>xxxxxxxx</i>-<i>xxxx</i>-<i>xxxx</i>-<i>xxxx</i>-<i>xxxxxxxxxxxx</i>}"</p>
<p>
where <i>x</i> is a hexadecimal digit.</p>
</td>
</tr>
<tr valign=top>
<td width=30%>DBTYPE_STR<br>
DBTYPE_WSTR<br>
DBTYPE_BSTR</td>
<td width=70%>Conversion between strings of different locale IDs (LCIDs) is not supported. Conversion between ANSI and Unicode strings of the same LCID are required.<p>
In converting a Unicode string to ANSI, information may be lost because the Unicode range is greater. Lost characters are represented in the ANSI string by a special character and the conversion is considered to be a truncation.</p>
<p>
When mixing character sets, conversion to Unicode is the preferred solution. If conversion to ANSI is needed to use ANSI strings with the user interface, and the LCID of the user interface is different from the LCID of some columns, then the consumer is responsible for the conversion. The LCID of a column is returned in the DBCOLUMN_COLLATING_SEQUENCE column returned by <b>IColumnsRowset::GetColumnsRowset</b>.</p>
</td>
</tr>
</table><br>
</font></BODY>
</HTML>
