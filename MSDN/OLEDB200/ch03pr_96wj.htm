<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Command States</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h2><a name="oledbcommand_states"></a>Command States</h2>
<p>
Commands can be in one of four states:
<ul type=disc>
<li>
<b>Initial</b>—No command text is set. A command is in this state after <b>IDBCreateCommand::CreateCommand</b> is called.<br><br></li>
<li>
<b>Unprepared</b>—The command text is set but the command is not prepared. A command is in this state after <b>ICommandText::SetCommandText</b> is called.<br><br></li>
<li>
<b>Prepared</b>—The command text is set and the command is prepared. A command is in this state after <b>ICommandPrepare::Prepare</b> is called.<br><br></li>
<li>
<b>Executed</b>—The command text is executed. A command is in this state after <b>ICommand::Execute</b> is called.</li>
</ul>
<p>
The following table lists each state and shows the code returned by each method in a command interface when it is called in that state. This table uses the following abbreviations:</p>
<p>
OK= S_OK<br>
NC= DB_E_NOCOMMAND<br>
NP= DB_E_NOTPREPARED<br>
OO= DB_E_OPENOBJECT</p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=23%><b>Method</b></td>
<td class=label width=20%><b>Initial</b></td>
<td class=label width=19%><b>Unprepared</b></td>
<td class=label width=13%><b>Prepared</b></td>
<td class=label width=25%><b>Executed</b></td>
</tr>
<tr valign=top>
<td width=23%><b>IColumnsInfo</b></td>
<td width=20%></td>
<td width=19%></td>
<td width=13%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%><b>GetColumnInfo</b></td>
<td width=20%>NC</td>
<td width=19%>OK (<b>ICommandPrepare</b> is not supported)<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
<td width=13%>OK</td>
<td width=25%>OK<p>
(<b>ICommandPrepare</b> is not supported)</p>
<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>MapColumnIDs</b></td>
<td width=20%>NC</td>
<td width=19%>OK (<b>ICommandPrepare</b> is not supported)<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
<td width=13%>OK</td>
<td width=25%>OK<p>
(<b>ICommandPrepare</b> is not supported)</p>
<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>IColumnsRowset</b></td>
<td width=20%></td>
<td width=19%></td>
<td width=13%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%><b> GetAvailableColumns</b></td>
<td width=20%>NC</td>
<td width=19%>OK (<b>ICommandPrepare</b> is not supported)<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
<td width=13%>OK</td>
<td width=25%>OK<p>
(<b>ICommandPrepare</b> is not supported)</p>
<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b> GetColumnsRowset</b></td>
<td width=20%>NC</td>
<td width=19%>OK (<b>ICommandPrepare</b> is not supported)<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
<td width=13%>OK</td>
<td width=25%>OK<p>
(<b>ICommandPrepare</b> is not supported)</p>
<p>
- or -</p>
<p>
NP (<b>ICommandPrepare</b> is supported)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>ICommand</b></td>
<td width=20%></td>
<td width=19%></td>
<td width=13%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%><b> Cancel</b></td>
<td width=20%>OK</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK</td>
</tr>
<tr valign=top>
<td width=23%><b> Execute</b></td>
<td width=20%>NC</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK</td>
</tr>
<tr valign=top>
<td width=23%><b> GetDBSession</b></td>
<td width=20%>OK</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK</td>
</tr>
<tr valign=top>
<td width=23%><b>ICommandPrepare</b></td>
<td width=20%></td>
<td width=19%></td>
<td width=13%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%><b> Prepare</b></td>
<td width=20%>NC</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK (<b>Execute</b> did not create a rowset)<p>
- or -</p>
<p>
OO (<b>Execute</b> created a rowset, and the rowset is still open)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b> Unprepare</b></td>
<td width=20%>OK</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK (<b>Execute</b> did not create a rowset)<p>
- or -</p>
<p>
OO (<b>Execute</b> created a rowset, and the rowset is still open)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>ICommandProperties</b></td>
<td width=20%></td>
<td width=19%></td>
<td width=13%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%><b> GetProperties</b></td>
<td width=20%>OK</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK</td>
</tr>
<tr valign=top>
<td width=23%><b> SetProperties</b></td>
<td width=20%>OK</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK (<b>Execute</b> did not create a rowset)<p>
- or -</p>
<p>
OO (<b>Execute</b> created a rowset, and the rowset is still open)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>ICommandText</b></td>
<td width=20%></td>
<td width=19%></td>
<td width=13%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%><b> GetCommandText</b></td>
<td width=20%>NC</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK</td>
</tr>
<tr valign=top>
<td width=23%><b> SetCommandText</b></td>
<td width=20%>OK</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK (<b>Execute</b> did not create a rowset)<p>
- or -</p>
<p>
OO (<b>Execute</b> created a rowset, and the rowset is still open)</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>ICommandWithParameters</b></td>
<td width=20%></td>
<td width=19%></td>
<td width=13%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%><b> GetParameterInfo</b></td>
<td width=20%>OK (<b>SetParameterInfo</b> has been called) <p>
- or - </p>
<p>
NC (<b>SetParameterInfo</b> has not been called)</p>
</td>
<td width=19%>OK (<b>SetParameterInfo</b> has been called) <p>
- or - </p>
<p>
NP (<b>ICommandPrepare</b> is supported and <b>SetParameterInfo</b> has not been called)</p>
</td>
<td width=13%>OK</td>
<td width=25%>OK</td>
</tr>
<tr valign=top>
<td width=23%><b> MapParameterNames</b></td>
<td width=20%>OK (<b>SetParameterInfo</b> has been called)<p>
- or - </p>
<p>
NC (<b>SetParameterInfo</b> has not been called)</p>
</td>
<td width=19%>OK (<b>SetParameterInfo</b> has been called) <p>
- or - </p>
<p>
NP (<b>ICommandPrepare</b> is supported and <b>SetParameterInfo</b> has not been called)</p>
</td>
<td width=13%>OK</td>
<td width=25%>OK</td>
</tr>
<tr valign=top>
<td width=23%><b> SetParameterInfo</b></td>
<td width=20%>OK</td>
<td width=19%>OK</td>
<td width=13%>OK</td>
<td width=25%>OK (<b>Execute</b> did not create a rowset)<p>
- or -</p>
<p>
OO (<b>Execute</b> created a rowset, and the rowset is still open)</p>
</td>
</tr>
</table><br>
<p>
The following figures illustrate the state transitions for a command. The first shows the command text set to an empty string, the second to a nonempty string.</p>
<p class=label>
<b>Command text set to an empty string, then a nonempty string</b></p>
<p>
<img src="ch0301.gif" border=0></p>
</font></BODY>
</HTML>
