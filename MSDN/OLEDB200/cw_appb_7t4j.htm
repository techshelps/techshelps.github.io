<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>class CPersistProperties</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="classcpersistproperties"></a>class CPersistProperties</h1>
<p>
This class helps you manage a collection of properties to be persisted. This class does all the work necessary to exchange property values between the user-defined buffer and the persistence medium.</p>
<p class=label>
<b>To use the CPersistProperties class</b>
<ol>
<li>
Declare an instance of the class.<br><br></li>
<li>
Add properties using <b>AddProp</b>.<br><br></li>
<li>
Use <b>EnablePropSave</b> to designate that a property should be saved. All properties are enabled for saving by default.<br><br></li>
<li>
Call <b>Load</b> and <b>Save</b> to persist to the desired medium.<br><br></li>
<li>
Use <b>IsPropSaved</b> to query whether a property is saved after a <b>Load</b> or <b>Save</b>.<br><br></li>
<li>
Use <b>GetVersionPersisted</b> to determine the version number of loaded properties.</li>
</ol>
<p>
A property is identified by its offset in the user buffer (see <b>AddProp</b>). Once persisted, the user buffer should not be modified where the offset of existing properties are changed. You can add new properties to the user buffer as long as you don’t modify existing property offsets. If you modify the existing property offsets, then you should change the stream ID to invalidate previously persisted streams.</p>
<p>
Change the version number as desired to distinguish the current version of the properties from those previously persisted. Properties will continue to load if the existing version is the same or higher than previous versions. If the current version is lower than the persisted version, then the properties will not load. </p>
<p>
All methods of the base class <b>CArray</b> are available. </p>
</font></BODY>
</HTML>
