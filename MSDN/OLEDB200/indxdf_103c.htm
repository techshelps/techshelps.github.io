<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IIndexDefinition::DropIndex</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbiindexdefinition__dropindex"></a>IIndexDefinition::DropIndex</h1>
<p>
Drops an index from the base table.</p>
<pre><code>HRESULT DropIndex(
   DBID *   pTableID,
   DBID *   pIndexID);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pTableID</i></p>
<p class=indent>
[in]<br>
A pointer to the DBID of the base table.</p>
<p class=dt>
<i>pIndexID</i></p>
<p class=indent>
[in]<br>
A pointer to the DBID of the index to drop. This must be an index on the table specified with <i>pTableID</i>. If <i>pIndexId</i> is a null pointer, all indexes for the table specified with <i>pTableID</i> are dropped.<br>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded and the index has been dropped from the base table.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
<i>pIndexID</i> was a null pointer, at least one index was successfully dropped, but one or more indexes for the specified table could not be dropped. The consumer can determine the set of indexes not dropped through the INDEXES schema rowset.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>pTableID</i> was a null pointer.</p>
<p class=indent>
DB_E_BADTABLEID<br>
<i>*pTableID</i> was an invalid table ID.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
<i>pIndexID</i> was a null pointer, but none of the indexes for the specified table could be dropped.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_INDEXINUSE<br>
The specified index was in use.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOINDEX<br>
The specified index does not exist in the current data source or did not apply to the specified table.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOTABLE<br>
The specified table does not exist in the current data source.</p>
<p class=indent>
</p>
<p class=indent>
DB_E_TABLEINUSE<br>
The specified table was in use and the provider could not drop the index with the table open.</p>
<p class=dt>
</p>
<p class=indent>
DB_SEC_E_PERMISSIONDENIED<br>
The consumer did not have sufficient permission to drop the index.<br>
</p>
<p class=label>
<b>Comments</b></p>
<p>
For partitioned indexes, a call to this method drops all partitions.</p>
<p>
If <b>DropIndex</b> returns any errors, the index is not dropped.</p>
<p>
If <i>pIndexID</i> is a null pointer, and one or more indexes for that table cannot be dropped, the processing continues to attempt to drop the remaining indexes for that table.<br>
</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="indxdf_60mw.htm">IIndexDefinition::CreateIndex</a></p>
</font></BODY>
</HTML>
