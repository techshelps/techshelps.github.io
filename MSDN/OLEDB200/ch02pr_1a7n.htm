<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enumerating Data Sources and Enumerators</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbenumerating_data_sources_and_enumerators"></a>Enumerating Data Sources and Enumerators</h1>
<p>
Generic consumers should use enumerators to search for data sources and other enumerators, rather than searching the registry directly. In this way, consumers will continue to work if the registry information changes or new root enumerators with additional functionality, such as the ability to enumerate data sources on other machines, are later introduced. To create an enumerator, the consumer calls <b>CoCreateInstance</b> with the class ID of the enumerator. In most cases, the consumer requests <b>ISourcesRowset</b> when creating an enumerator.</p>
<p>
To list the data sources and enumerators visible to the current enumerator, the consumer calls <b>ISourcesRowset::GetSourcesRowset</b>. This method returns a rowset of information about the currently visible data sources and enumerators. To create an instance of a data source or enumerator listed in this rowset, the consumer first calls <b>IParseDisplayName::ParseDisplayName</b> for the returned display name. This method returns a <i>moniker</i>, which is the name of the object instance. The consumer can then bind to create an instance of the object.</p>
<p>
Each row in the rowset returned by <b>ISourcesRowset</b> contains a SOURCES_ISPARENT column. For enumerator rows, this column contains VARIANT_TRUE if the enumerator described by the row is the same one that can enumerate the current one. For example, if the enumerator lists files and directories in the file system, this is the parent directory. The SOURCES_ISPARENT column thus allows the consumer to traverse backward through a hierarchy of enumerators, such as might be found over a file system. The consumer ignores the SOURCES_ISPARENT column for data source rows.</p>
<p>
A root enumerator is shipped in the OLE DB Software Development Kit (SDK). This enumerator traverses the registry searching for providers and enumerators. It has a class ID of CLSID_OLEDB_ENUMERATOR. For more information about it, see the "Root Enumerator Object" in the OLE DB Core Components documentation.</p>
<p>
Providers also can support enumerators, although they are not required to do so. These enumerators search for data sources and enumerators known to the provider. For example, suppose a provider exposes data in an SQL DBMS that supports multiple, separate databases in a single installation where the DBMS treats each database as a separate data source. The enumerator for this provider might search the DBMS for databases. The rowset returned by the enumerator would include one row for each database it finds, marking that database as a data source.</p>
<p>
Or suppose a provider exposes data in text files and treats each directory as a data source and each text file in that directory as a table. The enumerator for this provider might traverse the file system. The rowset returned by the enumerator would include two rows for each directory it finds, marking one row as a data source and the other row as an enumerator. To access the files in a directory, the consumer would create an instance of a data source object over the directory, using the display name from the row marked as a data source. To search for subdirectories, the consumer would create an instance of an enumerator over the directory, using the display name from the row marked as an enumerator.</p>
<p>
For information about the registry entries used by enumerators, see "<a href="ch14pr_3iyb.htm">Enumerator Registry Entries</a>" in Chapter 14.</p>
</font></BODY>
</HTML>
