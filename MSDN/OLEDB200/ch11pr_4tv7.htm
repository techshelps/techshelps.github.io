<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Property Values</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbsetting_property_values"></a>Setting Property Values</h1>
<p>
To set property values, a consumer performs the following actions:
<ol>
<li>
Determines the properties for which to set values. To set the value of a property to a different value, the property must be updatable. However, consumers can set the value of a read-only property to its current value. For information about how to determine if a property is writable, see "<a href="ch11pr_1gdv.htm">Getting Information about Properties</a>" in this chapter.<br><br></li>
<li>
Determines the property sets that contain the identified properties.<br><br></li>
<li>
Allocates an array of DBPROPSET structures, one for each identified property set.<br><br></li>
<li>
Allocates an array of DBPROP structures for each property set. The number of elements in each array is the number of properties, identified in step 1, that belong to that property set.<br><br></li>
<li>
Places the property's value and a flag showing whether it is required or optional in the DBPROP structure for each property. If the provider cannot set the value of a required property, it will fail to create the object to which the property applies and the method will return DB_E_ERRORSOCCURRED. If the provider cannot easily set the value of an optional property, it will create the object to which the property applies and the method will return DB_S_ERRORSOCCURRED.<p class=tl>
If the property belongs to the Rowset property group and applies to a single column, the consumer sets the <i>colid</i> element of the DBPROP structure to the ID of the column.</P></li>
<li>
For each property set, places the property set GUID in the DBPROPSET structure. It then places the count of elements in and the pointer to the corresponding DBPROP array in the DBPROPSET structure.<br><br></li>
<li>
Calls a method that sets properties and passes it the count and array of DBPROPSET structures. The provider returns the status of each property in the <i>dwStatus</i> element of the DBPROP structure for that property; that is, whether the property was set and, if not, why it was not set.</li>
</ol>
<p>
For example, assume that the consumer wants to set values for five properties, where properties 1, 2, and 3 are in property set A and properties 4 and 5 are in property set B. The consumer uses the following structures.</p>
<p class=label>
<b>An example of setting property values</b></p>
<p>
<img src="ch1101.gif" border=0></p>
<p>
The following table lists the methods that consumers use to set property values.</p>
<p class=label>
<b>Methods used by consumer to set property values</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=36%><b>Property group</b></td>
<td class=label width=64%><b>Methods used to set property values</b></td>
</tr>
<tr valign=top>
<td width=36%>Column</td>
<td width=64%><a href="tbldef_19b9.htm">ITableDefinition::CreateTable</a></td>
</tr>
<tr valign=top>
<td width=36%>Data Source</td>
<td width=64%><a href="dbprop_8n8z.htm">IDBProperties::SetProperties</a></td>
</tr>
<tr valign=top>
<td width=36%>Data Source Creation</td>
<td width=64%><a href="dbadmin_20x1.htm">IDBDataSourceAdmin::CreateDataSource</a></td>
</tr>
<tr valign=top>
<td width=36%>Data Source Information</td>
<td width=64%><a href="dbprop_8n8z.htm">IDBProperties::SetProperties</a></td>
</tr>
<tr valign=top>
<td width=36%>Initialization</td>
<td width=64%><a href="dbprop_8n8z.htm">IDBProperties::SetProperties</a></td>
</tr>
<tr valign=top>
<td width=36%>Index</td>
<td width=64%><a href="indxdf_60mw.htm">IIndexDefinition::CreateIndex</a></td>
</tr>
<tr valign=top>
<td width=36%>Rowset</td>
<td width=64%><a href="colrow_83p0.htm">IColumnsRowset::GetColumnsRowset</a><b>,<br>
</b><a href="cmdprop_7nzn.htm">ICommandProperties::SetProperties</a><b>,<br>
</b><a href="dbschr_7p9w.htm">IDBSchemaRowset::GetRowset</a><b>,<br>
</b><a href="opnrst_7c50.htm">IOpenRowset::OpenRowset</a><b>,<br>
</b><a href="dbenum_6i7o.htm">ISourcesRowset::GetSourcesRowset</a><b>,<br>
</b><a href="tbldef_19b9.htm">ITableDefinition::CreateTable</a></td>
</tr>
<tr valign=top>
<td width=36%>Session</td>
<td width=64%><a href="sesprop_17w3.htm">ISessionProperties::SetProperties</a></td>
</tr>
<tr valign=top>
<td width=36%>Table</td>
<td width=64%><a href="tbldef_19b9.htm">ITableDefinition::CreateTable</a></td>
</tr>
</table><br>
<p>
Read-only properties can always be set to their default values or to VT_EMPTY. Setting read-only properties to any other values will cause an error.</p>
</font></BODY>
</HTML>
