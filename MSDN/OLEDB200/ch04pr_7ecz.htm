<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Chapters</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbchapters"></a>Chapters</h1>
<p>
Chapters are used to identify a group of rows within a rowset. The group of rows may have a common characteristic, such as satisfying a filter condition or having a common parent in a hierarchical rowset, and may have an imposed order. Chapter handles are defined as follows:</p>
<pre><code>typedef ULONG HCHAPTER;
# define DB_NULL_HCHAPTER&nbsp; 0x00&nbsp; // Always invalid
</code></pre>
<p>
Chapters are assumed to have significant overhead, so they must be managed. This is done automatically according to the following rules:
<ul type=disc>
<li>
The rules for sequential rowsets take precedence, so a grouped sequential rowset's chapters can be opened only in the proper sequence and cannot be revisited after they have been scanned. It may be necessary to close a prior chapter before the next can be opened.<br><br></li>
<li>
A chapter is opened upon use, if it is not already in an active state.</li>
</ul>
<p>
When the reference count on a chapter is released to zero, then the resources needed to manage the chapter can be discarded or marked as discardable. Note, however, that if the reference count on a chapter falls to zero and the chapter contains rows with pending changes, the chapter's resources might not be freed until the pending change status on the rows is cleared, either through a call to <b>IRowsetUpdate::Update</b> or <b>IRowsetUpdate::Undo</b>.</p>
</font></BODY>
</HTML>
