<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IViewFilter::GetFilter</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbiviewfilter__getfilter"></a>IViewFilter::GetFilter</h1>
<p>
Retrieves the filter applied to a view.</p>
<pre><code>HRESULT GetFilter (
   HACCESSOR         hAccessor,
   ULONG *               pcRows,
   DBCOMPAREOP *   pCompareOps[],
   void *                  pCriteriaData);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>hAccessor</i></p>
<p class=indent>
[in]<br>
A row data accessor describing the data to be written to <i>ppCriteriaData</i>. The same column may appear more than once in the criteria.</p>
<p class=dt>
<i>pcRows</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to write the number of rows in the criteria table, where the criteria described by each row is joined in a logical OR with the other rows. If <i>pcRows</i> is greater than one, then the <i>cbRowSize</i> argument used in the call to <b>CreateAccessor</b> is used to specify the offset between each set of row values.</p>
<p class=dt>
<i>pCompareOps</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to write a two-dimensional array of comparisons operators. The two-dimensional array contains <i>pcRows</i> by <i>cBindings</i> comparison operators in <i>pcRows</i>-major format, where <i>cBindings</i> is the number of columns represented in <i>hAccessor</i>, and is written in row-major format. Each comparison operator in the <i>cBindings</i> dimension refers to a column in <i>pCriteriaData</i>, and each set of columns in the <i>pcRows</i> dimension refers to a row in <i>pCriteriaData</i>. Columns within a row are joined together in a logical AND, and each row is joined in a logical OR with another row. For information about the DBCOMPAREOP enumerated type, see <a href="rowfnd_0gfr.htm">IRowsetFind::FindNextRow</a>.</p>
<p class=dt>
<i>pCriteriaData</i></p>
<p class=indent>
[out]<br>
A pointer to a buffer in which to return the criteria data.</p>
<p class=dt>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
An error occurred while returning data for one or more columns, but data was successfully returned for at least one column. To determine the columns for which data was returned, the consumer checks the status values. For a list of status values that can be returned by this method, see "Status Values Used When Getting Data" in "Status" in Chapter 6.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_OUTOFMEMORY<br>
The provider was unable to allocate sufficient memory in which to return the filter information.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADACCESSORHANDLE<br>
<i>hAccessor</i> was invalid. Providers are required to check for this condition in this method.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADACCESSORTYPE<br>
The specified accessor was not a row accessor.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADCOMPAREOP<br>
In an element of <i>pCompareOps</i>, both DBCOMPAREOPS_CASESENSITIVE and DBCOMPAREOPS_CASEINSENSITIVE were specified.</p>
<p class=dt>
</p>
<p class=indent>
The provider was asked for an option that it does not support.DB_E_ERRORSOCCURRED<br>
Errors occurred while returning data for all columns. To determine what errors occurred, the consumer checks the status values. For a list of status values that can be returned by this method, see "Status Values Used When Getting Data" in "Status" in Chapter 6.</p>
<p class=dt>
</p>
<p class=label>
<b>Comments</b></p>
<p>
None.</p>
</font></BODY>
</HTML>
