<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connecting to a Simple Provider Using ActiveX Data Objects (ADO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbpwk_adoconn"></a><sup></sup>Connecting to a Simple Provider Using ActiveX Data Objects (ADO) </h1>
<p>
ADO, as an OLE DB consumer, makes requests to a provider to access data sources and retrieve the desired information. In ADO, you supply the name of the provider either as part of a connection string , or in the <b>Provider</b> property of the <b>Connection</b> object. The steps to make the connection depends on whether your Simple Provider is registered as a full OLE DB Provider or not.
<ul type=disc>
<li>
<b>Simple Provider Registered as a full OLE DB Provider</b><p class=tl>
In the following example, when the Simple Provider is registered as a full OLE DB provider, the steps are:</P><ol>
<li>
Supply the ProgID of your Simple Provider, in this case, <b>SampleOSP_VB</b>, as a parameter to the <b>Provider</b> method of the <b>Connection</b> object.<br><br></li>
<li>
Open the connection.<br><br></li>
<li>
Set the <b>Recordset</b> Object's source to the <b>Data Member</b> of your provider's <b>Data Source</b> Object.</li>
</ol>
<p class=tl>
The corresponding code follows:</P><p class=tl>
</P><pre><code>con.Provider = "SampleOSP_VB"
con.Open
rs.Open " C:\Oledbsdk\Osptk\Samples\Customer.txt", con
</code></pre>
</li>
<li>
<b>Simple Provider Not Registered as a full OLE DB Provider, but it's Data Source Object is Registered</b><p class=tl>
In the following example, when the Simple Provider is not registered as a full OLE DB provider, but it's Data Source Object is registered, the steps are:</P><ol>
<li>
Supply the ProgID of the OLE DB <a href="pw_toverview_4fxz.htm#oledbpwk_oledbmappinglayer">Simple Provider DLL</a> (the mapping layer), in this case, MSDAOSP, as a parameter to the <b>Provider</b> method of the <b>Connection</b> object.<br><br></li>
<li>
Supply the name of your simple provider's Data Source Object, in this case, <b>SampleOSP_VB.MyDataSource</b>, as a parameter to the <b>Properties</b> method of the <b>Connection</b> object.<br><br></li>
<li>
Open the connection.<br><br></li>
<li>
Set the <b>Recordset</b> Object's source to the <b>Data Member</b> of your provider's <b>Data Source</b> Object.</li>
</ol>
<p class=tl>
The corresponding code follows:</P><p class=tl>
</P><pre><code>con.Provider = "MSDAOSP"
con.Properties("Data Source") = "SampleOSP_VB.MyDataSource"
con.Open
rs.Open " C:\Oledbsdk\Osptk\Samples\Customer.txt", con
</code></pre>
</li>
</ul>
</font></BODY>
</HTML>
