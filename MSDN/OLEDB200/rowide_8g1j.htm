<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRowsetIdentity::IsSameRow</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbirowsetidentity__issamerow"></a>IRowsetIdentity::IsSameRow</h1>
<p>
Compares two row handles to see if they refer to the same row instance.</p>
<pre><code>HRESULT IsSameRow (
   HROW   hThisRow,
   HROW   hThatRow);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>hThisRow</i></p>
<p class=indent>
[in]<br>
The handle of an active row.</p>
<p class=dt>
<i>hThatRow</i></p>
<p class=indent>
[in]<br>
The handle of an active row.<br>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_FALSE<br>
The method succeeded and the row handles do not refer to the same row instance.</p>
<p class=dt>
</p>
<p class=indent>
S_OK<br>
The method succeeded and the row handles do refer to the same row instance.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_UNEXPECTED<br>
<b>ITransaction::Commit</b> or <b>ITransaction::Abort</b> was called and the object is in a zombie state.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADROWHANDLE<br>
<i>hRowThis</i> or <i>hRowThat</i> was invalid.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_DELETEDROW<br>
<i>hRowThis</i> or <i>hRowThat</i> referred to a row for which a deletion had been transmitted to the data source.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NEWLYINSERTED<br>
The provider is unable to determine identity for a row for which an insertion had been transmitted to the data source. This condition can occur when DBPROP_STRONGIDENTITY is set to VARIANT_FALSE.</p>
<p class=dt>
</p>
<p class=label>
<b>Comments</b></p>
<p>
This method makes no logical change to the state of the object.</p>
<p>
The row handles refer to the same row instance if the value set in any column in the row by means of one row handle will be the value returned for that column when gotten through the other row handle.</p>
<p>
Rowsets that support this interface must also implement the detection of row identity within their rowset. That is, if they fetch rows at different times, they can detect when the row handles are referring to the same logical row and arrange for both row handles to reflect the same data and state.</p>
<p>
The value of the row handles—their bit patterns as handles—is not necessarily the same if the underlying row is the same. This depends on the value of the DBPROP_LITERALIDENTITY property.</p>
<p>
The outcome of <b>IsSameRow</b> is not changed when one or both of its parameters correspond to a row with a pending delete.</p>
</font></BODY>
</HTML>
