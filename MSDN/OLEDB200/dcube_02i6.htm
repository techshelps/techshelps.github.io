<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Deviations from or Clarifications to the OLE DB for OLAP Specification</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="deviationsfromorclarificationstooledbforolapspecification"></a>Deviations from or Clarifications to the OLE DB for OLAP Specification</h1>
<p>
This section discusses the ways in which the current release of Microsoft<sup>®</sup> PivotTable<sup>®</sup> Service either differs from or expands upon the OLE DB or OLE DB for OLAP specifications.</p>
<h2>Commands</h2>
<p>
Accessors are not available from Command objects. This is due to the use of components for rowsets that do not provide for accessor creation outside the scope of a rowset.</p>
<h2>OLE DB Properties</h2>
<p>
OLE DB properties (DBPROPSET) are not fully implemented.</p>
<h2>OLAP Properties</h2>
<p>
Dimension properties (properties derived from a dimension or level) are not supported. None will be returned from the PROPERTIES or MEMBERS schema rowsets. None can be requested in an MDX query.</p>
<p>
Member properties are supported. The member properties are not returned from the PROPERTIES rowset. Only the standard cell properties are exposed.</p>
<h2>Filter Axes</h2>
<p>
<b>IMDDataset::GetAxisInfo </b>returns the filter axis as the last element of the MDAXISINFO array. In the filter axis, <i>iAxis</i>=(~0)=MDAXIS_FILTERS.</p>
<p>
The AXIS rowset for filter axes can be obtained by requesting either <i>iAxis</i>=<i>cAxis</i>-1 (the last axis), or <i>iAxis</i>=MDAXIS_FILTERS.</p>
<h2>Measures</h2>
<p>
Microsoft PivotTable Service exposes measures as the first dimension (ordinal 0), in the dimensions rowset with the name "Measures". This dimension has one level named "MeasuresLevel". (The OLE DB for OLAP specification suggests, but does not require, that the name of the level be "Measures"; providers can select a different name.)</p>
<p>
Microsoft PivotTable Service does not embed level names in the fully-qualified member names that it returns. (This is not an issue with respect to the OLE DB for OLAP specification, because it simply says that providers are to present unambiguous member names.)</p>
<h2>Flattened Rowsets</h2>
<p>
Microsoft PivotTable Service uses the following algorithm to determine whether to create a flattened rowset or a dataset. First, Microsoft PivotTable Service recognizes the IIDs <b>IRowset</b>, <b>IRowsetIdentity</b>, <b>IRowsetInfo</b>, <b>IRowsetLocate</b>, and <b>IRowsetScroll</b>, Then it examines DBPROPSET_Rowset and DBPROP_IRowset, which serve as a means for requesting a flattened rowset rather than a dataset. If these indicators are absent, a dataset is produced. Datasets are the preferred method for navigating the result of an MDX query.</p>
<p>
Flattened rowsets report the data type of each column as DBTYPE_VARIANT. Clients still bind columns as strings if appropriate, and the conversion will occur successfully.</p>
<p>
For flattened rowsets, Microsoft PivotTable Service returns DBSTATUS_S_ISNULL rather than MDSTATUS_S_NOTONAXIS. Both of these values are versions of NULL, but as a practical matter that is acceptable because the OLE DB for OLAP specification allows multiple versions of NULL in order to support missing sublevel elements. The term "missing sublevel elements" refers to the situation that arises when there are many levels for a dimension and some of the axis tuples do not exist at the lowest level. For example, consider the hierarchy [Country].[State].[City]. If [State] is the finest level of granularity, the [City] member name is returned as DBSTATUS_S_ISNULL. (DBSTATUS_S_ISNULL is the representation expected from a ROLAP implementation.)</p>
<h2>IMDFind Interface</h2>
<p>
The <b>IMDFind </b>interface is not supported.</p>
<h2>MDX Syntax</h2>
<p>
This<b> </b>section describes current deviations from or clarifications to the MDX syntax as described in the OLE DB for OLAP specification.
<ul type=disc>
<li>
Using an ambiguous member name or level name will not generate a warning or error and could return any one of the members that matches the ambiguous name.<br><br></li>
<li>
Defined sets cannot appear inside a WHERE clause. The reason for this limitation is that a defined set may contain a formula (for example, "TOP") that depends upon the context defined by the WHERE clause.<br><br></li>
<li>
Division operations return double-precision floating point values even when both operands are integers; this differs from the behavior of Microsoft<sup>®</sup> SQL Server<sup>™</sup>.<br><br></li>
<li>
In the Elements topic, &lt;<i>dim-hier</i>&gt;.<b>LEVELS</b>(<i>index</i>) is not supported.<br><br></li>
<li>
In the Expressions topic, &lt;<i>tuple</i>&gt;<b>.VALUE</b> is not supported.<br><br></li>
<li>
In the Set Value Expression topic, the following differences apply:<br><br></li>
<li>
When a virtual dimension of a cube contains more than 1,000 members, the HIERARCHIZE function does not sort members according to their natural order and does not delete duplicate members from a set when sorting it.<br><br></li>
<li>
The TOPCOUNT and BOTTOMCOUNT functions will return incorrect results if the optional third parameter, &lt;numeric value expression&gt; is not specified.<br><br></li>
<li>
The functions PERIODSTODATE, LASTPERIODS, YTD, QTD, MTD, and WTD are not implemented.<br><br></li>
<li>
In the Member Value Expression topic, the following differences apply:<br><br></li>
<li>
The FIRSTCHILD and LASTCHILD functions may return incorrect values.<br><br></li>
<li>
The keyword CURRENTMEMBER is implemented as CURRENT.<br><br></li>
<li>
The optional COUSIN, PARALLELPERIOD, OPENINGPERIOD, and CLOSINGPERIOD functions are not implemented.<br><br></li>
<li>
In the Tuple Value Expression topic, the keyword CURRENTMEMBER is implemented as CURRENT, and specification by &lt;<i>index</i>&gt; is not supported.<br><br></li>
<li>
In the Numeric Value Function topic, the optional MEDIAN, AGGREGATE, COVARIANCE, CORRELATION, LINREGSLOPE, LINREGINTERCEPT, LINREGVARIANCE, LINREG2, and LINREGPOINT functions are not implemented.<br><br></li>
<li>
The FONT_FLAGS member property is not supported in formulas.<br><br></li>
<li>
Formulas support the properties EXPRESSION, SOLVEORDER, and FORMAT_STRING.</li>
</ul>
</font></BODY>
</HTML>
