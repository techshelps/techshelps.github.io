<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDBAsynchStatus::GetStatus</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbidbasynchstatus__getstatus"></a>IDBAsynchStatus::GetStatus</h1>
<p>
Returns the status of an asynchronously executing operation.</p>
<pre><code>HRESULT GetStatus (
   HCHAPTER         hChapter,
   ULONG            ulOperation,
   ULONG*            pulProgress,
   ULONG*            pulProgressMax,
   ULONG*            pulAsynchPhase,
   LPOLESTR *      ppwszStatusText);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>hChapter <br>
</i>[in]</p>
<p class=indent>
The chapter handle. If the object being polled is not a rowset object, or the operation does not apply to a chapter, this should be set to DB_NULL_HCHAPTER, which is ignored by the provider.</p>
<p class=dt>
<i>ulOperation <br>
</i>[in]</p>
<p class=indent>
The operation for which the asynchronous status is being requested. This should be the following value:<br>
<br>
DBASYNCHOP_OPEN<br>
The consumer requests information about the asynchronous opening or population of a rowset, or the asynchronous initialization of a data source.</p>
<p class=dt>
<i>pulProgress <br>
</i>[out]<br>
A pointer to memory in which to return the current progress of the asynchronous operation relative to the expected maximum indicated in the <i>pulProgressMax</i> parameter. For more information about the meaning of <i>pulProgress</i>, see the description of <i>pulAsynchPhase</i>.</p>
<p class=dt>
</p>
<p class=indent>
If <i>pulProgress</i> is a null pointer, no progress is returned.</p>
<p class=dt>
<i>pulProgressMax</i></p>
<p class=indent>
[out]<i><br>
</i>A pointer to memory in which to return the expected maximum value of the <i>pulProgress</i> parameter. This value may change across calls to this method. For more information about the meaning of <i>pulProgressMax</i>, see the description of <i>pulAsynchPhase</i>.</p>
<p class=dt>
</p>
<p class=indent>
If <i>pulProgressMax</i> is a null pointer, no expected maximum value is returned.</p>
<p class=dt>
</p>
<p class=indent>
<i>pulAsynchPhase <br>
</i>[out]<i> <br>
</i>A pointer to memory in which to return additional information regarding the progress of the asynchronous operation. Valid values include:</p>
<p class=dt>
</p>
<p class=indent>
DBASYNCHPHASE_INITIALIZATION<br>
The object is in an initialization phase. The arguments <i>pulProgress</i> and <i>pulProgressMax</i> indicate an estimated ratio of completion. The object is not yet fully materialized. Attempting to call any other interfaces may fail, and the full set of interfaces may not be available on the object.</p>
<p class=indent>
If the asynchronous operation was a result of calling <b>ICommand::Execute</b> for a command that updates, deletes, or inserts rows, and <i>cParamSets</i> is greater than 1, <i>pulProgress</i> and <i>pulProgressMax</i> may indicate the progress for a single set of parameters or for the full array of parameter sets.</p>
<p class=dt>
</p>
<p class=indent>
DBASYNCHPHASE_POPULATION<br>
The object is in a population phase. Although the rowset is fully initialized, and the full range of interfaces are available on the object, there may be additional rows not yet populated into the rowset.</p>
<p class=indent>
While <i>pulProgress</i> and <i>pulProgressMax</i> can be based on the number of rows populated, they are generally based on the time or effort required to populate the rowset. A caller should, therefore, use this information as a rough estimate of how long the process might take, not the eventual row count.</p>
<p class=indent>
This phase is returned only during population of a rowset; it is never returned in the initialization of a data source or by the execution of a command that updates, deletes, or inserts rows.</p>
<p class=dt>
</p>
<p class=indent>
DBASYNCHPHASE_COMPLETE<br>
All asynchronous processing of the object has completed. <b>IDBAsynchStatus::GetStatus</b> returns an HRESULT indicating the outcome of the operation. Typically, this will be the HRESULT that would have been returned had the operation been called synchronously.</p>
<p class=indent>
If the asynchronous operation was a result of calling <b>ICommand::Execute</b> for a command that updates, deletes, or inserts rows, <i>pulProgress</i> and <i>pulProgressMax</i> are equal to the total number of rows affected by the command. If <i>cParamSets</i> is greater than 1, this is the total number of rows affected by all of the sets of parameters specified in the execution.</p>
<p class=dt>
</p>
<p>
If <i>pulAsynchPhase</i> is a null pointer, no status code is returned.</p>
<p class=dt>
<i>ppwszStatusText</i></p>
<p class=indent>
[in/out]<i> <br>
</i>A pointer to memory containing additional information about the operation. A provider may use this value to distinguish between different elements of an operation; for instance, different resources being accessed. This string is localized according to the DBPROP_INIT_LCID property on the data source object.</p>
<p class=indent>
If <i>*ppwszStatusText</i> is non-null on input, the provider returns status associated with the particular element identified by <i>*ppwszStatusText</i>. If <i>*ppwszStatusText</i> does not indicate an element of <i>ulOperation</i>, the provider returns S_OK with <i>pulProgress</i> and <i>pulProgressMax</i> set to the same value. If the provider does not distinguish between elements based on a textual identifier, it sets <i>*ppwszStatusText</i> to NULL and returns information about the operation as a whole; otherwise, if <i>*ppwszStatusText</i> is non-null on input, the provider leaves <i>*ppwszStatusText</i> untouched.</p>
<p class=indent>
If <i>*ppwszStatusText</i> is null on input, the provider sets <i>*ppwszStatusText</i> to a value indicating more information about the operation, or NULL if no such information is available or if <b>GetStatus</b> returns an error. When <i>*ppwszStatusText</i> is null on input, the provider allocates memory for the status string and returns the address to this memory. The consumer releases this memory with <b>IMalloc::Free</b> when it no longer needs the string.</p>
<p class=dt>
</p>
<p class=indent>
If <b>ppwszStatusString</b> is NULL on input, no status string is returned and the provider returns information about any element of the operation, or the operation in general.</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method returned successfully.
<ul type=disc>
<li>
If <i>pulAsynchPhase</i> is equal to DBASYNCHPHASE_INITIALIZATION, the object is not yet fully initialized; attempting to call any other interfaces may fail, and the full set of interfaces may not be available on the object.<br><br></li>
<li>
If <i>pulAsynchPhase</i> is equal to DBASYNCHPHASE_POPULATION, the rowset is fully initialized, and the full range of interfaces are available on the object; however, there may be additional rows not yet populated into the rowset.<br><br></li>
<li>
If <i>pulAsynchPhase</i> is equal to DBASYNCHPHASE_COMPLETE, all asynchronous processing of the object has completed. The object fully initialized and populated.</li>
</ul>
<p class=dt>
</p>
<p class=indent>
DB_E_CANCELED
<ul type=disc>
<li>
If the method is being called on a rowset during the population phase, population stops but the rowset remains valid for the rows already populated.<br><br></li>
<li>
If the method is being called on a data source in the initialization phase, that data source is in an uninitialized state.</li>
</ul>
<p class=indent>
</p>
<p class=dt>
E_UNEXPECTED<br>
<b>IDBAsynchStatus::GetStatus</b> was called on a data source and <b>Initialize</b> has not been called on the data source.<br>
</p>
<p class=indent>
<b>IDBAsynchStatus::GetStatus</b> was called on a rowset, <b>ITransaction::Commit</b> or <b>ITransaction::Abort</b> was called, and the object is in a zombie state.<br>
</p>
<p class=indent>
<b>IDBAsynchStatus::GetStatus</b> was called on a rowset that was asynchronously canceled in its initialization phase. The rowset is in a zombie state.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=label>
<b>Comments</b></p>
<p>
If the rowset is initialized or populated asynchronously, it must support this method.</p>
<p>
In addition to the return values listed, <b>IDBAsynchStatus::GetStatus</b> can return any HRESULT that would have been returned by the method that initiated the asynchronous operation, indicating the success or failure of the operation.</p>
<p>
Some asynchronous operations might not be able to return any states other than "finished" and "not finished". They should set <i>pulProgressMax</i> to a value of 1, indicating the all-or-nothing granularity of their estimate, so their answers would be either 0/1 or 1/1.</p>
<p>
A provider may change <i>pulProgressMax</i> in successive calls, and even return a smaller ratio than previously, if this reflects an improving estimate of the degree of completion of the task. </p>
<p>
The provider is not obliged to guarantee any further accuracy, but encouraged to do so in cases where reasonable estimates of completion are possible. Such efforts will improve user-interface quality, because the main use of this function is likely to be to give progress feedback to the user. User satisfaction increases with the quality of feedback on an invisible, long-running task.</p>
<p>
Calling <b>GetStatus</b> on an initialized data source or a populated rowset, or passing a value for <i>ulOperation</i> other than DBASYNCHOP_OPEN, returns S_OK with <i>pulProgress </i>and<i> pulProgressMax</i> set to the same value. If <b>GetStatus</b> is called on an object created from the execution of a command that updates, deletes, or inserts rows, both <i>pulProgress</i> and <i>pulProgressMax</i> indicate the total number of rows affected by the command.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="asntfy_1ycz.htm">IDBAsynchNotify::OnProgress</a></p>
</font></BODY>
</HTML>
