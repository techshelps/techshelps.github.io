<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>New Additions to IDBSchemaRowset</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="newadditionstoidbschemarowset"></a>New Additions to IDBSchemaRowset</h1>
<p>
Multidimensional schema rowsets are browsable by the <b>IDBSchemaRowset</b> interface. Consumers can get information about the available cubes, dimensions, hierarchies, levels, and members available at the data source.</p>
<p>
The following schema objects are relevant for OLE DB for OLAP: catalogs, schemas, cubes, measures, dimensions, hierarchies, levels, members, and properties (for each dimension level).</p>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>It is assumed that a multidimensional data source has catalogs, which contain schemas, which in turn contain cubes. Of course, some providers may have only catalogs or only schemas, or neither. This is no different from the TDP case.</p>
<p>
Schema rowsets are identified by GUIDs. The following table lists these GUIDs and the columns for which restrictions can be specified on the SCHEMA rowset, for each schema object. The number of restriction columns for each SCHEMA rowset is defined as constants prefixed with CRESTRICTIONS_ in the header files. Restriction values are treated as literals rather than as search patterns.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=37%><b><br>
GUID</b></td>
<td class=label width=17%><b>Number of <br>
restrictions</b></td>
<td class=label width=46%><b><br>
Restriction columns</b></td>
</tr>
<tr valign=top>
<td width=37%>MDSCHEMA_CUBES</td>
<td width=17%>3</td>
<td width=46%>CATALOG_NAME, SCHEMA_NAME, CUBE_NAME</td>
</tr>
<tr valign=top>
<td width=37%>MDSCHEMA_DIMENSIONS</td>
<td width=17%>5</td>
<td width=46%>CATALOG_NAME, SCHEMA_NAME, CUBE_NAME, DIMENSION_NAME, DIMENSION_UNIQUE_NAME</td>
</tr>
<tr valign=top>
<td width=37%>MDSCHEMA_HIERARCHIES</td>
<td width=17%>6</td>
<td width=46%>CATALOG_NAME, SCHEMA_NAME, CUBE_NAME, DIMENSION_UNIQUE_NAME, HIERARCHY_NAME, HIERARCHY_UNIQUE_NAME</td>
</tr>
<tr valign=top>
<td width=37%>MDSCHEMA_LEVELS</td>
<td width=17%>7</td>
<td width=46%>CATALOG_NAME, SCHEMA_NAME, CUBE_NAME, DIMENSION_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, LEVEL_NAME, LEVEL_UNIQUE_NAME</td>
</tr>
<tr valign=top>
<td width=37%>MDSCHEMA_MEASURES</td>
<td width=17%>5</td>
<td width=46%>CATALOG_NAME, SCHEMA_NAME, CUBE_NAME, MEASURE_NAME, MEASURE_UNIQUE_NAME</td>
</tr>
<tr valign=top>
<td width=37%>MDSCHEMA_PROPERTIES</td>
<td width=17%>9</td>
<td width=46%>CATALOG_NAME, SCHEMA_NAME, CUBE_NAME, DIMENSION_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, LEVEL_UNIQUE_NAME, MEMBER_UNIQUE_NAME, PROPERTY_NAME, PROPERTY_TYPE</td>
</tr>
<tr valign=top>
<td width=37%>MDSCHEMA_MEMBERS</td>
<td width=17%>12</td>
<td width=46%>CATALOG_NAME, SCHEMA_NAME, CUBE_NAME, DIMENSION_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, LEVEL_UNIQUE_NAME, LEVEL_NUMBER, MEMBER_NAME, MEMBER_UNIQUE_NAME,&nbsp; MEMBER_CAPTION, MEMBER_TYPE, and tree operator</td>
</tr>
</table><br>
<p>
The provider must support the following GUIDs if the provider lists itself as an MDP in the SOURCES rowset returned by <b>ISourcesRowset::GetSourcesRowset()</b>.
<ul type=disc>
<li>
MDSCHEMA_CUBES<br><br></li>
<li>
MDSCHEMA_DIMENSIONS<br><br></li>
<li>
MDSCHEMA_HIERARCHIES<br><br></li>
<li>
MDSCHEMA_LEVELS<br><br></li>
<li>
MDSCHEMA_MEASURES<br><br></li>
<li>
MDSCHEMA_PROPERTIES<br><br></li>
<li>
MDSCHEMA_MEMBERS</li>
</ul>
<p>
Some columns in schema rowsets are optional. If a provider does not support an optional column, it will return NULL for that column name in the schema rowset. Note that a column can be mandatory and still contain NULL under certain circumstances. For example, the NUMERIC_SCALE column of the MEASURES rowset can be NULL if the data type of the MEASURE is not DBTYPE_NUMERIC or DBTYPE_DECIMAL. Such cases are noted in the reference section.</p>
<p>
CATALOG_NAME, SCHEMA_NAME, _GUID, and DESCRIPTION are optional for all rowsets. The following columns are also optional in schema rowsets. (All other columns are mandatory.)
<ul type=disc>
<li>
CUBES rowset: CREATED_ON, LAST_SCHEMA_UPDATE, SCHEMA_UPDATED_BY, LAST_DATA_UPDATE, DATA_UPDATED_BY<br><br></li>
<li>
DIMENSIONS rowset: None<br><br></li>
<li>
HIERARCHIES rowset: ALL_MEMBER<br><br></li>
<li>
LEVELS rowset: None<br><br></li>
<li>
MEASURES rowset: None<br><br></li>
<li>
PROPERTIES rowset: None<br><br></li>
<li>
MEMBERS rowset: None</li>
</ul>
<p>
Most of the OLE DB for OLAP interfaces treat measures just like any other dimension. In fact, the measures dimension appears in the DIMENSIONS rowset. The MEASURES rowset is really the MEMBERS rowset restricted by the measures dimension. It appears separately because consumers are usually interested in special information about a measure that does not necessarily apply to the members of another dimension.</p>
<p>
If a provider does not support the concepts of catalogs or schemas, it does not support the DBSCHEMA_CATALOG and DBSCHEMA_SCHEMATA rowsets. A consumer can call <b>IDBSchemaRowset::GetSchemas</b> to find out which schema rowsets are supported. If the provider does not support catalogs or schemas, then specifying a restriction on either of these results in DB_E_NOTSUPPORTED.</p>
</font></BODY>
</HTML>
