<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IViewSort::SetSortOrder</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbiviewsort__setsortorder"></a>IViewSort::SetSortOrder</h1>
<p>
Specifies a sort order to be applied to a view.</p>
<pre><code>HRESULT SetSortOrder (
   ULONG            cColumns,
   const ULONG      rgColumns[],
   const DBSORT      rgOrders[]);</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>cColumns</i></p>
<p class=indent>
[in]<br>
Count of the number of columns to be used in specifying the order, or zero in order to clear any sort order previously set on the view.</p>
<p class=dt>
<i>rgColumns</i></p>
<p class=indent>
[in]<br>
The ordinals of the columns used to describe the sort. The order of the columns in the list defines the precedence of the columns in the sort. This argument is ignored in <i>cColumns</i> is zero.</p>
<p class=dt>
<i>rgOrders</i></p>
<p class=indent>
[in]<br>
The sort order for the corresponding column in the <i>rgColumns</i> list. This argument is ignored in <i>cColumns</i> is zero.</p>
<p class=tl>
The DBSORT structure is</P><pre><code>typedef DWORD DBSORT;

enum DBSORTENUM {
DBSORT_ASCENDING = 0,
DBSORT_DESCENDING
};
</code></pre>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>rgColumns</i> was NULL and <i>cColumns</i> was not equal to zero.</p>
<p class=indent>
<i>rgOrders</i> was NULL and <i>cColumns</i> was not equal to zero.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_CANTORDER<br>
The described order could not be opened. The provider may have limitations on the columns used in an order or a limitation on the complexity of the order.</p>
<p class=indent>
The same column ordinal appeared multiple times in <i>rgColumns</i>.</p>
<p class=dt>
</p>
<p class=label>
<b>Comments</b></p>
<p>
A provider may impose constraints on the columns that can be used for sorting. For example, a provider may only support ordering on columns for which there exists an index. If the provider does not support sorting for the specified columns, it returns DB_E_CANTORDER. If there is already a sort order applied to a view, <b>SetSortOrder</b> overrides the previous sort order.</p>
<p>
The setting of sort columns is atomic. If any columns cannot be set, then <b>SetSortOrder</b> returns DB_E_CANTORDER and the sort order for the view remains unchanged.</p>
<p>
Changing the sort order of a view does not change the sort order of any rowsets or chapters previously opened using that view.</p>
</font></BODY>
</HTML>
