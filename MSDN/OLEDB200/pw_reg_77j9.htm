<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the RegisterProvider.reg File</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbpwk_usingtheregfile"></a><sup></sup>Using the RegisterProvider.reg File</h1>
<p>
The RegisterProvider.reg file is supplied with the OLE DB Simple Provider Toolkit to automate the process of registering a provider. Use this file only when <a href="pw_reg_8e93.htm">fully registering</a> a provider (that is, including a registration entry for the OSP Data Object). </p>
<p>
Use this topic as a guide to entering the correct information in the RegisterProvider.reg file. Once you are finished completing the template, you should rename it, and double-click the file to import those settings into the Windows registry. </p>
<p>
Running the registry file is necessary so that the Simple Provider DLL recognizes the OSP Data Object. You must also register the OSP Data Object separately using regsvr32.exe, or javareg if you coded the object in Microsoft Visual J++.</p>
<p>
If you are coding in Microsoft Visual C++, you can add the required registry entries by using DLLRegisterServer instead of running RegisterProvider.reg.</p>
<p>
You need to supply the following values before running RegisterProvider.reg: 
<ul type=disc>
<li>
<b>ProgID for OLE DB Provider.</b> A value you provide to identify your OLE DB provider in the registry.<br><br></li>
<li>
<b>Name of OLE DB Provider.</b> The name that your provider will be listed under. It is also created by you. (Note that the name of the provider can be localized, because the ProgID references the object rather than the name. The ProgID is not localized.)<br><br></li>
<li>
<b>GUID for OLE DB Provider</b>. This is a unique GUID that identifies the OLE DB provider you have created. You should create one using a GUID generator.<br><br></li>
<li>
<b>ProgID for OSP Data Object</b>. You determine this value from the OSP Data Object you developed; see the section in each of the development tools as to how this is determined. (For example, in Microsoft Visual Basic, it will be the project name followed by the name of the data source object class or control name. The names are separated by a "." (period).)</li>
</ul>
<p>
Following is a copy of the registration template, and following that, an illustration of a completed registration template showing a set of example values.</p>
<pre><code>Template ========================================================&gt;
REGEDIT4

[HKEY_CLASSES_ROOT\&lt;INSERT:&nbsp; ProgID for OLE DB Provider&gt;]
@="&lt;INSERT:&nbsp; Name of OLE DB Provider&gt;"

[HKEY_CLASSES_ROOT\&lt;INSERT: ProgID for OLE DB Provider&gt;\CLSID]
@="&lt;INSERT:&nbsp; GUID for OLE DB Provider&gt;"

[HKEY_CLASSES_ROOT\CLSID\&lt;INSERT: GUID for OLE DB Provider&gt;]
@="&lt;INSERT: ProgID of OLE DB Provider&gt;"

[HKEY_CLASSES_ROOT\CLSID\&lt;INSERT:&nbsp; GUID for OLE DB 
Provider&gt;\InprocServer32]
@="&lt;INSERT:&nbsp; Path to OLE DB Directory example --&gt; 
c:\\Program Files\\Common Files\\System\\OLE DB\\&gt;MSDAOSP.DLL"
"ThreadingModel"="Both"

[HKEY_CLASSES_ROOT\CLSID\&lt;INSERT:&nbsp; GUID for 
OLE DB Provider&gt;\ProgID]
@="&lt;INSERT:&nbsp; ProgId of OLE DB Provider&gt;.1"

[HKEY_CLASSES_ROOT\CLSID\&lt;INSERT:&nbsp; GUID for 
OLE DB Provider&gt;\VersionIndependentProgID]
@="&lt;INSERT:&nbsp; ProgId of OLE DB Provider&gt;"

[HKEY_CLASSES_ROOT\CLSID\&lt;INSERT:&nbsp; GUID for 
OLE DB Provider&gt;\OLE DB Provider]
@="&lt;INSERT:&nbsp; Name of OLE DB Provider&gt;"

[HKEY_CLASSES_ROOT\CLSID\&lt;INSERT:&nbsp; GUID for 
OLE DB Provider&gt;\OSP Data Object]
@="&lt;INSERT:&nbsp; ProgID for OSP Data Object&gt;"

==========================================&gt;
Example Values 
==========================================&gt;
ProgID for OLE DB Provider = TestPWProv
Name of OLE DB Provider = Microsoft Test OLE DB Provider for OSP
GUID for OLE DB Provider = {6B94E051-E170-11d0-94EA-00C04FB66A50}
ProgId for OSP Data Object= MyOSPProject.OSPClass

==========================================&gt;
Example 
==========================================&gt;
REGEDIT4

[HKEY_CLASSES_ROOT\TestPWProv]
@="Microsoft Test OLE DB Provider for OSP"

[HKEY_CLASSES_ROOT\TestPWProv\CLSID]
@="{6B94E051-E170-11d0-94EA-00C04FB66A50}"

[HKEY_CLASSES_ROOT\CLSID\
{6B94E051-E170-11d0-94EA-00C04FB66A50}]
@="TestPWProv"

[HKEY_CLASSES_ROOT\CLSID\
{6B94E051-E170-11d0-94EA-00C04FB66A50}\InprocServer32]
@="c:\\Program Files\\Common Files\\
System\\OLE DB\\MSDAOSP.DLL"
"ThreadingModel"="Both"

[HKEY_CLASSES_ROOT\CLSID\{6B94E051-E170-11d0-94EA-00C04FB66A50}\ProgID]
@="TestPWProv.1"

[HKEY_CLASSES_ROOT\CLSID\{6B94E051-E170-11d0-94EA-00C04FB66A50}
\VersionIndependentProgID]
@="TestPWProv"

[HKEY_CLASSES_ROOT\CLSID\{6B94E051-E170-11d0-94EA-00C04FB66A50}
\OLE DB Provider]
@="Microsoft Test OLE DB Provider for OSP"

[HKEY_CLASSES_ROOT\CLSID\{6B94E051-E170-11d0-94EA-00C04FB66A50}
\OSP Data Object]
@="MyOSPProject.OSPClass"</code></pre>
</font></BODY>
</HTML>
