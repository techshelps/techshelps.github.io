<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Providers</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="providers"></a>Providers</h1>
<p>
Providers choose the functionality that they support according to the native functionality of the data that they expose. However, in order to be consumed by generic consumers, providers must be able to meet at least the minimum consumer functionality defined above. The developer of the provider can achieve this functionality in one of three ways:
<ol>
<li>
By writing to a set of simple provider-writer interfaces in Java, VB, or C++, and using the Provider Writer's toolkit.<br><br></li>
<li>
By implementing the minimum provider functionality defined below directly in C or C++, and using service components to implement the additional functionality required for the minimal consumer functionality.<br><br></li>
<li>
By implementing at least the "Level 1" functionality defined below directly in C or C++.</li>
</ol>
<p>
In addition, providers may expose interfaces for these sets of functionality: rowset processing, commands, and indexes.</p>
<p>
All providers must be either apartment or free threaded, and must support aggregation of the <b>DataSource</b>, <b>Session</b>, <b>Rowset</b>, and (if applicable) <b>Command</b> and <b>View</b> objects.</p>
<h1>Minimum Provider Functionality</h1>
<p>
Provider writers are strongly encouraged to implement the full set of interfaces that apply to their particular type of data. At a minimum, the following interfaces and behavior must be implemented in order to be considered a generic OLE DB provider. Providers implementing this minimum provider functionality can be aggregated by common service components available in the SDK in order to support the minimum consumer functionality.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=35%><b>Object</b></td>
<td class=label width=65%><b>Interface Behavior</b></td>
</tr>
<tr valign=top>
<td width=35%>DataSource</td>
<td width=65%>IDBCreateSession</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IDBInitialize</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IDBProperties</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IPersist</td>
</tr>
<tr valign=top>
<td width=35%>DataSource Behavior</td>
<td width=65%>DBPROP_INIT_PROMPT</td>
</tr>
<tr valign=top>
<td width=35%>Session</td>
<td width=65%>IGetDataSource</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IOpenRowset</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>ISessionProperties</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>ITransactionLocal <sup>3</sup></td>
</tr>
<tr valign=top>
<td width=35%>Rowset</td>
<td width=65%>IAccessor</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IConvertType</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IColumnsInfo</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IRowset</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IRowsetChange <sup>2</sup></td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IRowsetIdentity</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>IRowsetInfo</td>
</tr>
<tr valign=top>
<td width=35%>Rowset Behavior</td>
<td width=65%>DBPROP_CANHOLDROWS</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>DBPROP_CANFETCHBACKWARDS</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>DBPROP_COMMITPRESERVE <sup>3</sup></td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>DBPROP_OWNUPDATEDELETE <sup>2</sup></td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>DBPROP_OWNINSERT <sup>2</sup></td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>DBPROP_REMOVEDELETED <sup>2</sup></td>
</tr>
</table><br>
<p class=mini>
(2) Minimal level of support for providers wanting to expose update capability. Providers not supporting this functionality are treated as read-only by generic consumers.</p>
<p class=mini>
(3) Minimal level of support for providers wanting to support transactions to general consumers. </p>
<h1>Level 1 Providers</h1>
<p>
Providers that implement the full set of Level 1 interfaces can be consumed by general consumers without the support of additional service components. Providers that can fully implement this level of functionality are strongly encouraged to do so.</p>
<p>
Providers implementing the following functionality in addition to the minimum provider functionality are consumed as full Level 1 providers.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=34%><b>Object</b></td>
<td class=label width=66%><b>Interface Behavior</b></td>
</tr>
<tr valign=top>
<td width=34%>DataSource</td>
<td width=66%>IConnectionPointContainer for: IDBAsynchNotify</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IDBAsynchStatus</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ISupportErrorInfo</td>
</tr>
<tr valign=top>
<td width=34%>Rowset</td>
<td width=66%>IDBAsynchStatus</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IConnectionPointContainer for: IRowsetNotify, IDBAsynchNotify</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetFind</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetLocate</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetScroll</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ISupportErrorInfo</td>
</tr>
<tr valign=top>
<td width=34%>Rowset Properties</td>
<td width=66%>DBPROP_CANSCROLLBACKWARDS</td>
</tr>
</table><br>
<h1>Extended Interfaces</h1>
<p>
The following additional functionality may be supported by general-purpose providers. Providers are encouraged to support as much from this list as makes sense for their particular type of data.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=34%><b>Object</b></td>
<td class=label width=66%><b>Interface Behavior</b></td>
</tr>
<tr valign=top>
<td width=34%>DataSource</td>
<td width=66%>IDataSourceAdmin</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IPersistFile</td>
</tr>
<tr valign=top>
<td width=34%>Session</td>
<td width=66%>IDBSchemaRowset</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IDBView</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ITableDefinition</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ITransactionJoin <sup>3</sup></td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ITransactionObject <sup>3</sup></td>
</tr>
<tr valign=top>
<td width=34%>Rowset</td>
<td width=66%>IColumnsRowset</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetIdentity</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetLocate</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetResynch <sup>2</sup></td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetUpdate <sup>2</sup></td>
</tr>
<tr valign=top>
<td width=34%>Rowset Properites</td>
<td width=66%>DBPROP_ABORTPRESERVE <sup>3</sup></td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_CHANGEINSERTEDROWS</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_LITERALBOOKMARKS</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_ORDEREDBOOKMARKS</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_LITERALIDENTITY</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_BOOKMARKSKIPPED</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_OTHERINSERT</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_OTHERUPDATEDELETE</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_RETURNPENDINGROWS</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_STRONGIDENTITY</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_IMMOBILEROWS</td>
</tr>
<tr valign=top>
<td width=34%>Blobs</td>
<td width=66%>DBPROP_OLEOBJECTS</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_MULTIPLESTORAGEOBJECTS</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_STRUCTUREDSTORAGE</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ISequentialStream</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IStream</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IStorage</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ILockBytes</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>DBPROP_BLOCKINGSTORAGEOBJECTS=FALSE</td>
</tr>
</table><br>
<p class=mini>
(2) Extended functionality that may be exposed by updatable providers.</p>
<p class=mini>
(3) Extended functionality that may be exposed by transacted providers. </p>
<h1>Rowset Processing Behavior</h1>
<p>
Providers that support filtering or sorting of data are encouraged to support the following rowset processing interfaces.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=34%><b>Object</b></td>
<td class=label width=66%><b>Interface Behavior</b></td>
</tr>
<tr valign=top>
<td width=34%>Session</td>
<td width=66%>IDBView</td>
</tr>
<tr valign=top>
<td width=34%>View</td>
<td width=66%>IViewFilter</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IViewSort</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IColumnsInfo</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IAccessor</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ISupportErrorInfo</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IViewRowset</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IViewChapter</td>
</tr>
<tr valign=top>
<td width=34%>Rowset</td>
<td width=66%>IChapteredRowset</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetView</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetFind</td>
</tr>
</table><br>
<h1>Command Behavior</h1>
<p>
Providers that support more sophisticated query/statement execution support commands. In order to be a general provider of commands, the provider must support the following set of functionality in addition to the minimal provider functionality defined above.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=34%><b>Object</b></td>
<td class=label width=66%><b>Interface Behavior</b></td>
</tr>
<tr valign=top>
<td width=34%>DataSource</td>
<td width=66%>IDBInfo</td>
</tr>
<tr valign=top>
<td width=34%>Session</td>
<td width=66%>IDBCreateCommand</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ITransactionLocal</td>
</tr>
<tr valign=top>
<td width=34%>Command</td>
<td width=66%>IAccessor</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ICommand</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ICommandText</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IColumnsInfo</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ICommandProperties</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ICommandWithParameters</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IConvertType</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ISupportErrorInfo</td>
</tr>
<tr valign=top>
<td width=34%>Command Properties</td>
<td width=66%>MAXTABLESINSELECT&gt;1 (not true for consumer)</td>
</tr>
<tr valign=top>
<td width=34%>Custom Error</td>
<td width=66%>ISQLErrorInfo</td>
</tr>
</table><br>
<p>
The following set of extended command functionality may also be supported by command providers.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=34%><b>Object</b></td>
<td class=label width=66%><b>Interface Behavior</b></td>
</tr>
<tr valign=top>
<td width=34%>Session</td>
<td width=66%>ITransactionJoin</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ITransactionObject</td>
</tr>
<tr valign=top>
<td width=34%>Command</td>
<td width=66%>ICommandPrepare</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IColumnsRowset</td>
</tr>
<tr valign=top>
<td width=34%>Mult Results Object</td>
<td width=66%>IMultipleResults</td>
</tr>
<tr valign=top>
<td width=34%>Rowset</td>
<td width=66%>IRowsetResynch</td>
</tr>
<tr valign=top>
<td width=34%>Rowset Properties</td>
<td width=66%>DBPROP_CANSCROLLBACKWARDS</td>
</tr>
</table><br>
<h1>Indexing Behavior</h1>
<p>
Providers built on indexed data can expose index functionality to service providers such as query processors by implementing the following interfaces.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=34%><b>Object</b></td>
<td class=label width=66%><b>Interface Behavior</b></td>
</tr>
<tr valign=top>
<td width=34%>Session</td>
<td width=66%>IDBView</td>
</tr>
<tr valign=top>
<td width=34%>Rowset</td>
<td width=66%>IRowsetIndex</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IIndexDefinition</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IChapterRowset</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IRowsetView</td>
</tr>
<tr valign=top>
<td width=34%>View</td>
<td width=66%>IViewFilter</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IViewSort</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IColumnsInfo</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IAccessor</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>ISupportErrorInfo</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IViewRowset</td>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=66%>IViewChapter</td>
</tr>
</table><br>
</font></BODY>
</HTML>
