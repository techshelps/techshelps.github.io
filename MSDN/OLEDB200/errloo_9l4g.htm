<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IErrorLookup</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbierrorlookup"></a>IErrorLookup</h1>
<p>
<b>IErrorLookup</b> is used by OLE DB error objects to determine the values of the error message, source, Help file path, and context ID based on the return code and a provider-specific error number.</p>
<p>
<b>IErrorLookup</b> is exposed by a provider-specific error lookup service that is mandatory for all providers that return OLE DB error objects.</p>
<h1>When to Implement</h1>
<p>
All providers that return OLE DB error objects must implement <b>IErrorLookup</b> in a separate lookup service. For information about the registry entries used by error lookup services, see "<a href="ch14pr_3q5v.htm">Error Lookup Service Registry Entries</a>" in Chapter 14.</p>
<h1>When to Call</h1>
<p>
<b>IErrorLookup</b> is called by the code shipped in the OLE DB SDK that implements OLE DB error objects. It should not be called by general consumers.</p>
<p>
When an error occurs, the following sequence of events takes place:
<ol>
<li>
The provider creates an OLE DB error object and adds a record to that object.<br><br></li>
<li>
The consumer retrieves the error object and gets an <b>IErrorInfo</b> interface on a particular record in that object. It then calls a method in <b>IErrorInfo</b>.<br><br></li>
<li>
Except for the <b>IErrorInfo::GetGUID</b> method, the OLE DB error object code, which is shipped with the OLE DB SDK, loads the error lookup service based on the class ID stored in the error record.<br><br></li>
<li>
The OLE DB error object code returns the <i>hrError</i> element of the ERRORINFO structure, the lookup ID, and the error parameters from the error record. It also returns the locale ID requested in <b>IErrorRecords::GetErrorInfo</b>. It passes all of this information to the appropriate <b>IErrorLookup</b> method.<br><br></li>
<li>
The <b>IErrorLookup</b> method returns the requested information, based on the <i>hrError</i>, <i>dwLookupID</i>, and <i>lcid</i> arguments, integrates the parameters, and returns this to the error object code.<br><br></li>
<li>
The OLE DB error object code returns the requested information to the consumer.<br><br></li>
<li>
The consumer releases the OLE DB error object.<br><br></li>
<li>
The OLE DB error object code calls <b>IErrorLookup::ReleaseErrors</b> for all error records with a nonzero dynamic error ID to release the error information associated with that record.</li>
</ol>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=31%><b>Method</b></td>
<td class=label width=69%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=31%><a href="errloo_7sfi.htm">GetErrorDescription</a></td>
<td width=69%>Returns the error message and source, based on the return code and the provider-specific error number.</td>
</tr>
<tr valign=top>
<td width=31%><a href="errloo_9n5b.htm">GetHelpInfo</a></td>
<td width=69%>Returns the path of the Help file and the context ID of the topic that explains the error.</td>
</tr>
<tr valign=top>
<td width=31%><a href="errloo_460j.htm">ReleaseErrors</a></td>
<td width=69%>Releases any dynamic error information associated with a dynamic error ID.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
