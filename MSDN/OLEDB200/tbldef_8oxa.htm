<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITableDefinition::AddColumn</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbitabledefinition__addcolumn"></a>ITableDefinition::AddColumn</h1>
<pre><code>Adds a new column to a base table.HRESULT AddColumn(
   DBID *                     pTableID,
   DBCOLUMNDESC *      pColumnDesc,
   DBID **                  ppColumnID);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pTableID</i></p>
<p class=indent>
[in]<br>
A pointer to the DBID of the table to which the column is to be added.</p>
<p class=dt>
<i>pColumnDesc</i></p>
<p class=indent>
[in/out]<br>
A pointer to the DBCOLUMNDESC structure that describes the new column.</p>
<p class=dt>
<i>ppColumnID</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the returned DBID of newly created column. If this is a null pointer, no DBID is returned. If <i>ppColumnID</i> is non-null, the provider allocates memory for the DBID and overwrites *<i>ppColumnID</i> with a pointer to this new DBID without regard for its current value.</p>
<p class=dt>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
The column was added, but one or more properties—for which the <i>dwOptions</i> element of the DBPROP structure was DBPROPOPTIONS_OPTIONAL—were not set. The consumer checks <i>dwStatus</i> in the DBPROP structures to determine which properties were not set. The method can fail to set properties for a number of reasons, including:
<ul type=disc>
<li>
The property was not supported by the provider.<br><br></li>
<li>
The property was not in the Column, Rowset, or Table property group.<br><br></li>
<li>
The property set was not supported by the provider.<br><br></li>
<li>
It was not possible to set the property.<br><br></li>
<li>
<i>colid</i> in the DBPROP structure was not DB_NULLID.<br><br></li>
<li>
The data type in <i>vValue</i> in the DBPROP structure was not the data type of the property or was not VT_EMPTY.<br><br></li>
<li>
The value in <i>vValue</i> in the DBPROP structure was invalid.<br><br></li>
<li>
The property's value conflicted with an existing property.</li>
</ul>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>pTableID</i> or <i>pColumnDesc</i> was a null pointer.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADCOLUMNID<br>
<i>dbcid</i> in <i>*pColumnDesc</i> was an invalid column ID.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADPRECISION<br>
The precision in <i>*pColumnDesc</i> was invalid.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADSCALE<br>
The scale in <i>*pColumnDesc</i> was invalid.</p>
<p class=indent>
DB_E_BADTABLEID<br>
<i>*pTableID</i> was an invalid table ID.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADTYPE<br>
One or more of the <i>wType</i>, <i>pwszTypeName</i>, and <i>pTypeInfo</i> elements in an element of <i>rgColumnDescs</i> was invalid.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_DUPLICATECOLUMNID<br>
<i>dbcid</i> in <i>*pColumnDesc</i> was the same as an existing column ID.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
The column was not added because one or more properties—for which the <i>dwOptions</i> element of the DBPROP structure was DBPROPOPTIONS_REQUIRED or an invalid value—could not be set. The consumer checks <i>dwStatus</i> in the DBPROP structures to determine which properties were not set. The method can fail to set properties for any of the reasons specified in DB_S_ERRORSOCCURRED.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOTABLE<br>
The specified table does not exist in the current data source.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_TABLEINUSE<br>
The specified table was in use.</p>
<p class=dt>
</p>
<p class=indent>
DB_SEC_E_PERMISSIONDENIED<br>
The consumer did not have sufficient permission to add a column.</p>
<p class=dt>
</p>
<p class=label>
<b>Comments</b></p>
<p>
If <b>AddColumn</b> returns any errors, the column is not created.</p>
<p>
The placement of the new column, whether inserted or added after the last column, is provider-specific.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="dbprop_3ffz.htm">IDBProperties::GetPropertyInfo</a>, <a href="tbldef_19b9.htm">ITableDefinition::CreateTable</a>, <a href="tbldef_83e6.htm">ITableDefinition::DropColumn</a></p>
</font></BODY>
</HTML>
