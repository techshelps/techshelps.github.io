<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRowsetIndex::GetIndexInfo</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbirowsetindex__getindexinfo"></a>IRowsetIndex::GetIndexInfo</h1>
<p>
Returns information about the index rowset capabilities.</p>
<pre><code>HRESULT GetIndexInfo (
   ULONG *                        pcKeyColumns,
   DBINDEXCOLUMNDESC **   prgIndexColumnDesc,
   ULONG *                        pcIndexProperties,
   DBPROPSET **               prgIndexProperties);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pcKeyColumns</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the number of key columns in the index.</p>
<p class=dt>
<i>prgIndexColumnDesc</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return an array of DBINDEXCOLUMNDESC structures in key column order. For more information, see <a href="indxdf_60mw.htm">IIndexDefinition::CreateIndex</a>. The size of the array is equal to *<i>pcKeyColumns</i>. If an error occurs, *<i>prgIndexColumnDesc</i> is set to a null pointer.</p>
<p class=dt>
<i>pcIndexProperties</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the number of DBPROPSET structures returned in *<i>prgIndexProperties</i>. *<i>pcIndexProperties</i> is the total number of property sets for which the provider supports at least one property in the Index property group. If an error occurs, *<i>pcIndexProperties</i> is set to zero.</p>
<p class=dt>
<i>prgIndexProperties</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return an array of DBPROPSET structures. One structure is returned for each property set that contains at least one property belonging to the Index property group. For information about the properties in the Index property group that are defined by OLE DB, see "<a href="appcpr_8u7n.htm#oledbindex_properties">Index Properties</a>" in Appendix C.</p>
<p class=tl>
The provider allocates memory for the structures and returns the address to this memory; the consumer releases this memory with <b>IMalloc::Free</b> when it no longer needs the structures. Before calling <b>IMalloc::Free</b> for *<i>prgPropertySets</i>, the consumer should call <b>IMalloc::Free</b> for the <i>rgProperties</i> element within each element of *<i>prgPropertySets</i>. If *<i>pcIndexProperties</i> is zero on output, or if an error occurs, the provider does not allocate any memory and ensures that *<i>prgIndexProperties</i> is a null pointer on output.</P><p class=tl>
For information about the DBPROPSET and DBPROP structures, see "<a href="ch11pr_5pb9.htm">DBPROPSET Structure</a>" and "<a href="ch11pr_3xt1.htm">DBPROP Structure</a>" in Chapter 11.</P><p class=tl>
</P><p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>pcKeyColumns</i>, <i>prgIndexColumnDesc, pcIndexProperties</i>, or <i>prgIndexProperties</i> was a null pointer.</p>
<p class=dt>
</p>
<p class=indent>
E_OUTOFMEMORY<br>
The provider was unable to allocate sufficient memory in which to return the column description structures or properties of the index.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOINDEX<br>
The rowset uses integrated indexes and there is no current index.</p>
<p class=dt>
</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="dbprop_3ffz.htm">IDBProperties::GetPropertyInfo</a>, <a href="indxdf_60mw.htm">IIndexDefinition::CreateIndex</a></p>
</font></BODY>
</HTML>
