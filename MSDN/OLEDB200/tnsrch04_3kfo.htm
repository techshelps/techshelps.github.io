<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Data Source Object</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="datasourceobject"></a>Data Source Object</h1>
<p>
OLE DB for OLAP adds a number of properties to the DBPROPSET_DATASOURCEINFO property set of a data source object. These properties give the consumer information about variations among multidimensional providers.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=588>
<tr valign=top>
<td class=label width=38%><b>Property ID</b></td>
<td class=label width=62%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_FLATTENING_<br>
SUPPORT </td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Flattening Support.</p>
<p>
If the value of this property is:
<ul type=disc>
<li>
MDPROPVAL_FS_FULL_SUPPORT, then the provider supports flattening as described in “Flattening a Dataset to Produce a Rowset” in chapter 2.<br><br></li>
<li>
MDPROPVAL_FS_GENERATED_COLUMN, then the provider supports flattening by using dummy names, as described in Chapter 2, “Lack of Support for Named Levels.”<br><br></li>
<li>
MDPROPVAL_FS_GENERATED_DIMENSION, then the provider supports flattening by generating one column per dimension as described in Chapter 2, “Lack of Support for Named Levels.”<br><br></li>
<li>
MDPROPVAL_FS_NO_SUPPORT, then the provider does not support flattening. For such a provider, calling <b>ICommand::Execute</b> with a language dialect of MDGUID_MDX and asking for the <b>IRowset</b> interface returns an error (E_NOINTERFACE).</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_NAMED_LEVELS</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for named levels.</p>
<p>
A bitmask specifying whether the provider supports named levels and/or numbered levels. Can be one or more of the following values:
<ul type=disc>
<li>
MDPROPVAL_NL_NAMEDLEVELS, which means that the provider supports named levels.<br><br></li>
<li>
MDPROPVAL_NL_NUMBEREDLEVELS, which means that the provider supports numbered levels using the LEVELS(n) function.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>DBPROP_DATASOURCE_TYPE</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Data source type.</p>
<p>
If the value of this property is:
<ul type=disc>
<li>
DBPROPVAL_DST_TDP, then it means that the provider is a tabular data provider.<br><br></li>
<li>
DBPROPVAL_DST_MDP, then it means that the provider is a multidimensional provider.<br><br></li>
<li>
DBPROPVAL_DST_TDPANDMDP, then it means that the provider is both a TDP and MDP.</li>
</ul>
<p>
Note that DBPROPVAL_DST_TDPANDMDP is the bitwise OR of DBPROPVAL_DST_TDP and DBPROPVAL_DST_MDP.</p>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_JOINCUBES</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for query joining multiple cubes.</p>
<p>
A bitmask that can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MJC_IMPLICITCUBE, which means that the provider supports an empty FROM clause. The cube is implicitly resolved by the axis and slicer dimensions.<br><br></li>
<li>
MDPROPVAL_MJC_SINGLECUBE, which means that the provider supports only one cube in the CONTEXT clause of the MDX statement.<br><br></li>
<li>
MDPROPVAL_MJC_MULTICUBES, which means that the provider supports more than one cube in the CONTEXT clause of the MDX statement.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_AXES</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Number of axes in the dataset.</p>
<p>
The value of this property is the maximum number of axes that the provider supports in the dataset. To be compliant with OLE DB for OLAP, this value must be at least 3.</p>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_AGGREGATECELL_<br>
UPDATE</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for updating aggregated cells.</p>
<p>
If the value of this property is:
<ul type=disc>
<li>
MDPROPVAL_AU_UNSUPPORTED, then it means that the provider does not support updating nonatomic cells.<br><br></li>
<li>
MDPROPVAL_AU_UNCHANGED, then it means that the provider supports updating of aggregated cells, but the value of cells beneath the aggregated cell remains unchanged.<br><br></li>
<li>
MDPROPVAL_AU_UNKNOWN, then it means that the provider supports updating of aggregated cells, but the value of cells beneath the aggregated cell remains undefined.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_RANGEROWSET</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for cell updates.</p>
<p>
If the value of this property is:
<ul type=disc>
<li>
MDPROPVAL_RR_NORANGEROWSET, then it means that the provider does not support <b>IMDRangeRowset </b>interface.<br><br></li>
<li>
MDPROPVAL_RR_READONLY, then it means that the provider supports a read-only range rowset.<br><br></li>
<li>
MDPROPVAL_RR_UPDATE, then it means that the provider supports an updatable range rowset.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_SLICER</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: The capabilities in the WHERE clause of an MDX statement.</p>
<p>
If the value of this property is:
<ul type=disc>
<li>
MDPROPVAL_MS_SINGLETUPLE, it means that the provider supports only one tuple in the WHERE clause.<br><br></li>
<li>
MDPROPVAL_MS_MULTIPLETUPLES, it means that the provider supports more than one tuple in the WHERE clause.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_<br>
OBJQUALIFICATION</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Provider’s ability to qualify a cube name.</p>
<p>
A bitmask specifying how MD schema object names can be qualified in an MDX expression. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MOQ_DATASOURCE _CUBE, which means that cubes can be qualified by the data source name.<br><br></li>
<li>
MDPROPVAL_MCQ_CATALOG _CUBE, which means that cubes can be qualified by the catalog name.<br><br></li>
<li>
MDPROPVAL_MCQ_SCHEMA _CUBE, which means that cubes can be qualified by the schema name.<p class=atl>
<b>Note&nbsp;&nbsp;&nbsp;</b>If none of the above bits are set, then the provider does not support cube qualification.</p></li>
<li>
MDPROPVAL_MOQ_CUBE_DIM, which means that dimensions can be qualified by cube name.<br><br></li>
<li>
MDPROPVAL_MOQ_DIM_HIER, which means that hierarchies can be qualified by dimension names. <br><br></li>
<li>
MDPROPVAL_MOQ_DIMHIER_LEVEL, which means that levels can be qualified by the dimension name and/or hierarchy name. Note that this property applies only if named levels are supported, which can be checked by the property MDPROP_NAMED_LEVELS. If named levels are not supported then this bit must be set.<br><br></li>
<li>
MDPROPVAL_MOQ_DIMHIER_MEMBER, which means that members can be qualified by a dimension name and/or a hierarchy name.<br><br></li>
<li>
MDPROPVAL_MOQ_LEVEL_MEMBER, which means that members can be qualified by a level name.<br><br></li>
<li>
MDPROPVAL_MOQ_MEMBER_MEMBER, which means that members can be qualified by their ancestor names.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_<br>
OUTERREFERENCE</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for outer reference in an MDX statement.
<ul type=disc>
<li>
If the value of this property is <ul type=disc>
<li>
MDPROPVAL_MO_TUPLE, then it means that the provider supports <i>tuple</i>[.VALUE] to be qualified by a <i>cube_name</i> argument in an MDX statement.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_<br>
QUERYBYPROPERTY</td>
<td width=62%>Type: VT_BOOL<p>
Typical R/W: R</p>
<p>
Description: Support for querying by property values in an MDX statement.</p>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_CASESUPPORT</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for MDX case statements.</p>
<p>
A bitmask specifying the support in a provider for case statements. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MC_SIMPLECASE, which means that the provider supports a simple case statement.<br><br></li>
<li>
MDPROPVAL_MC_SEARCHEDCASE, which means that the provider supports a searched case statement.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_STRING_<br>
COMPOP</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for string comparison operators other than equals and not-equals operators.</p>
<p>
A bitmask specifying the support in a provider for string comparison operators. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MSC_LESSTHAN, which means that the provider supports the less-than operator.<br><br></li>
<li>
MDPROPVAL_MSC_GREATERTHAN, which means that the provider supports the greater-than operator.<br><br></li>
<li>
MDPROPVAL_MSC_LESSTHANEQUAL, which means that the provider supports the less-than-or-equal-to operator.<br><br></li>
<li>
MDPROPVAL_MSC_GREATERTHANEQUAL, which means that the provider supports the greater-than-or-equal-to operator.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_DESCFLAGS</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for various &lt;<i>desc flag</i>&gt; values in the <b>DESCENDANTS</b> function. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MD_BEFORE, which means that the provider supports the flag BEFORE.<br><br></li>
<li>
MDPROPVAL_MD_AFTER, which means that the provider supports the flag AFTER.<br><br></li>
<li>
MDPROPVAL_MD_SELF, which means that the provider supports the flag SELF. Note that this bit must be set by all providers because support for SELF is mandatory.</li>
</ul>
<p>
Support for other <i>desc flag</i> values, such as SELF_AND_BEFORE, are implied by multiple bits being on.</p>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_SET_<br>
FUNCTIONS</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for various set functions. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MSF_TOPPERCENT, which means that the provider supports the function <b>TOPPERCENT</b>.<br><br></li>
<li>
MDPROPVAL_MSF_BOTTOMPERCENT, which means that the provider supports the function <b>BOTTOMPERCENT</b>.<br><br></li>
<li>
MDPROPVAL_MSF_TOPSUM, which means that the provider supports the function <b>TOPSUM</b>.<br><br></li>
<li>
MDPROP_MSF_BOTTOMSUM, which means that the provider supports the function <b>BOTTOMSUM</b>.<br><br></li>
<li>
MDPROP_MSF_PERIODSTODATE, which means that the provider supports the function <b>PERIODSTODATE</b>.<br><br></li>
<li>
MDPROP_MSF_LASTPERIODS, which means that the provider supports the function <b>LASTPERIODS</b>.<br><br></li>
<li>
MDPROP_MSF_YTD, which means that the provider supports the function <b>YTD</b>.<br><br></li>
<li>
MDPROP_MSF_QTD, which means that the provider supports the function <b>QTD</b>.<br><br></li>
<li>
MDPROP_MSF_MTD, which means that the provider supports the function <b>MTD</b>.<br><br></li>
<li>
MDPROP_MSF_WTD, which means that the provider supports the function <b>WTD</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLDOWNMEMBER, which means that the provider supports the function <b>DRILLDOWNMEMBER</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLDOWNLEVEL, which means that the provider supports the function <b>DRILLDOWNLEVEL</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLDOWNMEMBERTOP, which means that the provider supports the function <b>DRILLDOWNMEMBERTOP</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLDOWNMEMBERBOTTOM, which means that the provider supports the function <b>DRILLDOWNMEMBERBOTTOM</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLDOWNLEVELTOP, which means that the provider supports the function <b>DRILLDOWNLEVELTOP</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLDOWNLEVELBOTTOM, which means that the provider supports the function <b>DRILLDOWNLEVELBOTTOM</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLUPMEMBER, which means that the provider supports the function <b>DRILLUPMEMBER</b>.<br><br></li>
<li>
MDPROP_MSF_DRILLUPLEVEL, which means that the provider supports the function <b>DRILLUPLEVEL</b>.<br><br></li>
<li>
MDPROPVAL_MSF_TOGGLEDRILLSTATE, which means that the provider supports the function TOGGLEDRILLSTATE.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_MEMBER_<br>
FUNCTIONS</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for various member functions. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MMF_COUSIN, which means that the provider supports the function <b>COUSIN</b>.<br><br></li>
<li>
MDPROPVAL_MMF_PARALLELPERIOD, which means that the provider supports the function <b>PARALLELPERIOD</b>.<br><br></li>
<li>
MDPROPVAL_MMF_OPENINGPERIOD, which means that the provider supports the function <b>OPENINGPERIOD</b>.<br><br></li>
<li>
MDPROP_MMF_CLOSINGPERIOD, which means that the provider supports the function <b>CLOSINGPERIOD</b>.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_NUMERIC_<br>
FUNCTIONS</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for various numeric functions. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MNF_MEDIAN, which means that the provider supports the function <b>MEDIAN</b>.<br><br></li>
<li>
MDPROPVAL_MNF_VAR, which means that the provider supports the function <b>VAR</b>.<br><br></li>
<li>
MDPROPVAL_MNF_STDDEV, which means that the provider supports the function <b>STDDEV</b>.<br><br></li>
<li>
MDPROP_MNF_RANK, which means that the provider supports the function <b>RANK</b>.<br><br></li>
<li>
MDPROPVAL_MNF_AGGREGATE, which means that the provider supports the function <b>AGGREGATE</b>.<br><br></li>
<li>
MDPROPVAL_MNF_COVARIANCE, which means that the provider supports the function <b>COVARIANCE</b>.<br><br></li>
<li>
MDPROPVAL_MNF_CORRELATION, which means that the provider supports the function <b>CORRELATION</b>.<br><br></li>
<li>
MDPROP_MNF_LINREGSLOPE, which means that the provider supports the function <b>LINREGSLOPE</b>.<br><br></li>
<li>
MDPROPVAL_MNF_LINREGVARIANCE, which means that the provider supports the function <b>LINREGVARIANCE</b>.<br><br></li>
<li>
MDPROPVAL_MNF_LINREG2, which means that the provider supports the function <b>LINREG2</b>.<br><br></li>
<li>
MDPROPVAL_MNF_LINREGPOINT, which means that the provider supports the function <b>LINREGPOINT</b>.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_FORMULAS</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: Support for creation of named sets and calculated members. Can be a combination of zero or more of the following:
<ul type=disc>
<li>
MDPROPVAL_MF_WITH_CALCMEMBERS, which means that the provider supports the creation of calculated members by using the WITH clause before a SELECT.<br><br></li>
<li>
MDPROPVAL_MF_WITH_NAMEDSETS, which means that the provider supports the creation of named sets by using the WITH clause before a SELECT.<br><br></li>
<li>
MDPROPVAL_MF_CREATE_CALCMEMBERS, which means that the provider supports the creation of named calculated members by using the CREATE clause.<br><br></li>
<li>
MDPROPVAL_MF_CREATE_NAMEDSETS, which means that the provider supports the creation of named sets by using the CREATE clause.<br><br></li>
<li>
MDPROPVAL_MF_SCOPE_SESSION, which means that the provider supports the <i>scope</i> value of SESSION during the creation of named sets and calculated members.<br><br></li>
<li>
MDPROPVAL_MF_SCOPE_GLOBAL, which means that the provider supports the <i>scope</i> value of GLOBAL during the creation of named sets and calculated members.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=38%>MDPROP_MDX_NONMEASURE_<br>
EXPRESSONS</td>
<td width=62%>Type: VT_I4<p>
Typical R/W: R</p>
<p>
Description: The capabilities in the <i>numeric_value_expression </i>argument of set functions.</p>
<p>
If the value of this property is:
<ul type=disc>
<li>
MDPROPVAL_MNE_MEASURESONLY, then it means that the provider supports only expressions involving measure dimension members.<br><br></li>
<li>
MDPROPVAL_MNE_ALLDIMENSIONS, then it means that the provider supports expressions involving members from any dimension.</li>
</ul>
<p>
For example, say Revenue and Cost are measures, and USA is a member of Geography dimension. In this case, in set functions that take a <i>numeric_value_expression</i> argument, expressions such as Revenue/3 and (Revenue - Cost)/Cost*100 are made of measures only. However, in expressions such as (USA, Sales)/3 are made of measures and nonmeasures.</p>
</td>
</tr>
</table><br>
</font></BODY>
</HTML>
