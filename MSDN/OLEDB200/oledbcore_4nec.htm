<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDataConvert::DataConvert</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbidataconvert__dataconvert"></a>IDataConvert::DataConvert</h1>
<p>
Converts the data from the source type to the destination type.</p>
<pre><code>HRESULT DataConvert (
&nbsp;&nbsp;&nbsp;DBTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wSrcType,
&nbsp;&nbsp;&nbsp;DBTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wDstType,
&nbsp;&nbsp;&nbsp;ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbSrcLength,
&nbsp;&nbsp;&nbsp;ULONG *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pcbDstLength,
&nbsp;&nbsp;&nbsp;void *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pSrc,
&nbsp;&nbsp;&nbsp;void *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDst,
&nbsp;&nbsp;&nbsp;ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbDstMaxLength,
&nbsp;&nbsp;&nbsp;DBSTATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbsSrcStatus,
&nbsp;&nbsp;&nbsp;DBSTATUS *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdbsStatus,
&nbsp;&nbsp;&nbsp;BYTE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bPrecision,
&nbsp;&nbsp;&nbsp;BYTE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bScale,
&nbsp;&nbsp;&nbsp;DBDATACONVERT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwFlags);</code></pre>
<p class=label>
</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>wSrcType</i></p>
<p class=indent>
[in]<br>
The source type of the data to be converted.</p>
<p class=dt>
<i>wDstType</i></p>
<p class=indent>
[in]<br>
The destination type of the data to be converted.</p>
<p class=dt>
<i>cbSrcLength</i></p>
<p class=indent>
[in]<br>
The length of the source data in bytes.</p>
<p class=dt>
<i>pcbDstLength</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the length in bytes of the output data after conversion.</p>
<p class=dt>
<i>pSrc</i></p>
<p class=indent>
[in]<br>
A pointer to the source data. Note that this is a pointer to the underlying data type, based upon the value of <i>wSrcType</i>. For example, this would be the address of the BSTR pointer if <i>wSrcType</i> is DBTYPE_BSTR, not the BSTR pointer itself.</p>
<p class=dt>
<i>pDst</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the destination data. As in the case of <i>pSrc</i>, this is a pointer to the underlying data type, based upon the value of <i>wDstType</i>.</p>
<p class=dt>
<i>cbDstMaxLength</i></p>
<p class=indent>
[in]<br>
The maximum allowable length of the destination data in bytes. This is used only for variable length destination data types.</p>
<p class=dt>
<i>dbsSrcStatus</i></p>
<p class=indent>
[in]<br>
The status value for the source data.</p>
<p class=dt>
<i>pdbsStatus</i></p>
<p class=indent>
[out]<br>
A pointer to the status for the conversion.</p>
<p class=dt>
<i>bPrecision</i></p>
<p class=indent>
[in]<br>
The precision of the output data in bytes, if applicable. This argument is used when converting to DBTYPE_NUMERIC data only.</p>
<p class=dt>
<i>bScale</i></p>
<p class=indent>
[in]<br>
The scale of the output data in bytes, if applicable. This argument is used when converting to DBTYPE_NUMERIC data only.</p>
<p class=dt>
<i>dwFlags</i></p>
<p class=indent>
[in]<br>
The data-conversion flag indicating the requested conversion behavior. These flags can be combined.</p>
<p class=indent>
The following flags are available:</p>
<pre><code>typedef DWORD DBDATACONVERT;
enum DBDATACONVERTENUM{
 DBDATACONVERT_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0,
 DBDATACONVERT_SETDATABEHAVIOR&nbsp;&nbsp;&nbsp;= 1,
 DBDATACONVERT_LENGTHFROMNTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 2
};
</code></pre>
<p class=indent>
The DBDATACONVERT_SETDATABEHAVIOR flag indicates that data truncation is an error and that the memory pointed to by <i>pDst</i> will not be changed if any error occurs.</p>
<p class=indent>
The DBDATACONVERT_LENGTHFROMNTS flag indicates that the data conversion library should calculate <i>cbSrcLength</i> for string (DBTYPE_STR, DBTYPE_WSTR) source data.</p>
<p class=tl>
</P><p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The conversion succeeded.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
<i>pSrc</i> was a null pointer.</p>
<p class=dt>
</p>
<p class=indent>
E_OUTOFMEMORY<br>
The data conversion object was unable to allocate memory.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_BADBINDINFO<br>
The source or destination data type was invalid.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_DATAOVERFLOW<br>
The requested conversion resulted in an overflow.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
Errors occurred while converting data. The requested conversion can fail for a number of reasons, including:
<ul type=disc>
<li>
The source data was unavailable.<br><br></li>
<li>
Data truncation occurred.<br><br></li>
<li>
The precision and scale arguments did not make sense for the data type.<br><br></li>
<li>
There was an invalid character or second decimal point in the source data.</li>
</ul>
<p class=dt>
</p>
<p class=indent>
DB_E_UNSUPPORTEDCONVERSION<br>
The requested conversion was not supported.</p>
</font></BODY>
</HTML>
