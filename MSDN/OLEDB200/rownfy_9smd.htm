<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRowsetNotify::OnFieldChange</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbirowsetnotify__onfieldchange"></a>IRowsetNotify::OnFieldChange</h1>
<p>
Notifies the consumer of any change to the value of a column.</p>
<pre><code>HRESULT OnFieldChange (
   IRowset*            pRowset,
   HROW               hRow,
   ULONG            cColumns,
   ULONG            rgColumns[],
   DBREASON         eReason,
   DBEVENTPHASE   ePhase,
   BOOL               fCantDeny);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pRowset</i></p>
<p class=indent>
[in]<br>
A pointer to the rowset, because the consumer may be receiving notifications from multiple rowsets and this identifies which one is calling.</p>
<p class=dt>
<i>hRow</i></p>
<p class=indent>
[in]<br>
The handle of the row in which the column value was changed. After this method returns, the reference count of this row will be unchanged unless the consumer explicitly changes it. This is different from other methods that return rows to the consumer, in which the provider explicitly increments the reference count. Therefore, if the consumer wants to guarantee that this row handle is valid after this method returns, it must call <b>IRowset::AddRefRows</b> for the row while it is processing this method.</p>
<p class=dt>
<i>cColumns</i></p>
<p class=indent>
[in]<br>
The count of columns in <i>rgColumns</i>.</p>
<p class=dt>
<i>rgColumns</i></p>
<p class=indent>
[in]<br>
An array of columns in the row for which the value was changed.</p>
<p class=dt>
<i>eReason</i></p>
<p class=indent>
[in]<br>
The reason of the event that caused this change. If this value is not recognized by the method, the method returns S_OK or DB_S_UNWANTEDREASON.</p>
<p class=dt>
<i>ePhase</i></p>
<p class=indent>
[in]<br>
The phase of this notification.</p>
<p class=dt>
<i>fCantDeny</i></p>
<p class=indent>
[in]<br>
When this flag is set to TRUE, the consumer cannot veto the event by returning S_FALSE because the provider cannot undo the event.</p>
<p class=dt>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
S_FALSE<br>
The event/phase is vetoed by reason of logical objection or a failure to be able to implement.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_UNWANTEDPHASE<br>
The consumer is not interested in receiving this phase for this reason. The provider can optimize by making no further calls with this reason and phase. The phases for other reasons are unaffected.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_UNWANTEDREASON<br>
The consumer is not interested in receiving any phases for this reason. The provider can optimize by making no further calls with this reason.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A consumer-specific error occurred. Unless the consumer also returns S_FALSE, the provider continues the operation.</p>
<p class=dt>
</p>
<p class=label>
<b>Comments</b></p>
<p>
Possible reasons are DBREASON_COLUMN_SET and DBREASON_COLUMN_RECALCULATED.</p>
<p>
All phases can occur for a DBREASON_COLUMN_SET event. The new value is visible beginning with the DBEVENTPHASE_SYNCHAFTER phase. For a DBREASON_COLUMN_RECALCULATED event, only the DBEVENTPHASE_DIDEVENT phase occurs.</p>
<p>
Setting a column to its current value may, but is not required to, generate a notification for that column.</p>
<p>
Unless the consumer returns S_FALSE, the provider continues the operation. This is true even if the consumer returns E_FAIL or any other error code.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="rownfy_63ol.htm">IRowsetNotify::OnRowChange</a>, <a href="rownfy_5rmt.htm">IRowsetNotify::OnRowsetChange</a></p>
</font></BODY>
</HTML>
