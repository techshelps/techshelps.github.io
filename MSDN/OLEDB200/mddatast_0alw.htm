<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMDDataset::GetAxisRowset</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="imddatasetgetaxisrowset"></a>IMDDataset::GetAxisRowset</h1>
<p>
Returns the specified axis rowset.</p>
<pre><code>HRESULT GetAxisRowset(
   IUnknown*   pUnkOuter,
   ULONG         iAxis,
   REFIID      riid,
   ULONG         cPropertySets,
   DBPROPSET   rgPropertySets[],
   IUnknown**   ppRowset);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pUnkOuter</i>[in]</p>
<p class=indent>
A pointer to the controlling <b>IUnknown</b> if the axis rowset is being created as part of an aggregate. If <b>IMDDataset</b> isn’t being aggregated, it is a null pointer.</p>
<p class=dt>
<i>iAxis</i>[in]</p>
<p class=indent>
The numeric identifier of an axis.</p>
<p class=tl>
OLE DB for OLAP defines manifest constants for commonly used axes: MDAXIS_COLUMNS, MDAXIS_ROWS, MDAXIS_PAGES, MDAXIS_SECTIONS, and MDAXIS_ CHAPTERS. They denote (respectively) the columns, rows, pages, sections, and chapters axes. For the purposes of this function, the set of slicer dimensions is treated as a special axis and is identified by the constant MDAXIS_SLICERS.</P><p class=dt>
<i>riid</i>[in]</p>
<p class=indent>
The IID of the requested rowset interface.</p>
<p class=dt>
<i>cPropertySets</i>[in]</p>
<p class=indent>
The number of DBPROPSET structures in <i>rgPropertySets</i>. If this is 0, the provider ignores <i>rgPropertySets</i>.</p>
<p class=dt>
<i>rgPropertySets</i>[in/out]</p>
<p class=indent>
An array of DBPROPSET structures, containing properties and values to be set. The properties specified in these structures must belong to the rowset property group. If the same property is specified more than once in <i>rgPropertySets</i>, which value to be used is provider-specific.</p>
<p class=dt>
<i>ppRowset</i>[out]</p>
<p class=indent>
A pointer to memory in which to return the requested interface pointer on the axis rowset. The returned rowset is read-only.</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded. In all DBPROP structures passed to the method, <i>dwStatus</i> is set to DBPROPSTATUS_OK.</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
The rowset was opened but one or more properties — for which the <i>dwOptions</i> element of the DBPROP structure was DBPROPOPTIONS_SETIFCHEAP — were not set. The consumer checks <i>dwStatus</i> in the DBPROP structures to determine which properties weren’t set. The method can fail to set properties for a number of reasons, including:
<ul type=disc>
<li>
The property wasn’t supported by the provider.<br><br></li>
<li>
The property wasn’t in the rowset property group.<br><br></li>
<li>
The property set wasn’t supported by the provider.<br><br></li>
<li>
It wasn’t cheap to set the property.<br><br></li>
<li>
The <i>colid</i> value in the DBPROP structure was invalid.<br><br></li>
<li>
The value of <i>dwOptions</i> in the DBPROP structure was invalid.<br><br></li>
<li>
The data type in <i>vValue</i> in the DBPROP structure wasn’t the data type of the property or wasn’t VT_EMPTY.<br><br></li>
<li>
The value in <i>vValue</i> in the DBPROP structure was invalid.<br><br></li>
<li>
The property’s value conflicted with an existing property.<br><br></li>
<li>
A property was specified to be applied to all columns, but couldn’t be applied to one or more columns.</li>
</ul>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=indent>
E_INVALIDARG<br>
<i>ppRowset</i> was a null pointer.</p>
<p class=tl>
<i>cPropertySets</i> was greater than 0 and <i>rgPropertySets</i> was a null pointer.</P><p class=tl>
In an element of <i>rgPropertySets</i>, <i>cProperties</i> wasn’t zero and <i>rgProperties</i> was a null pointer.</P><p class=indent>
E_NOINTERFACE<br>
The axis rowset didn’t support the interface specified in <i>riid</i>.</p>
<p class=indent>
MD_E_INVALIDAXIS<br>
<i>iAxis</i> wasn’t a valid axis for this Dataset.</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
No rowset was returned because one or more properties — for which the <i>dwOptions</i> element of the DBPROP structure was DBPROPOPTIONS_REQUIRED — were not set. The consumer checks <i>dwStatus</i> in the DBPROP structures to determine which properties weren’t set. None of the properties are remembered. The method can fail to set properties for any of the reasons specified in DB_S_ERRORSOCCURRED except for the reason that states that it wasn’t cheap to set the property.</p>
<p class=indent>
DB_E_NOAGGREGATION<br>
<i>pUnkOuter</i> wasn’t a null pointer and the axis rowset doesn’t support aggregation.</p>
<p class=label>
<b>Comments</b></p>
<p>
An axis rowset contains the name, display caption, level name, depth, and number of children for each tuple component or member along the axis. The axis rowset also contains a column that has the ordinal for each axis coordinate. This ordinal can be used when calculating the cell ordinal for fetching the cell data with.<b>IMDDataset::GetCellData</b>.</p>
<p>
Additional columns may be present for a dimension if:
<ul type=disc>
<li>
The provider returns provider-specific columns.<br><br></li>
<li>
The consumer has requested to see member properties using the DIMENSION PROPERTIES clause in the SELECT statement.</li>
</ul>
<p>
<i>rgcColumns</i> in the MDAXISINFO structure points to an array containing the number of columns in the axis rowset for each constituent dimension.</p>
<p>
The axis for which the rowset is requested is identified by its numeric identifier.</p>
<p>
For a complete description of the columns in an axis rowset and their data types, see “Axis Rowsets” in Chapter 3.</p>
<p>
The set of slicer dimensions is treated as a special axis and is identified by the axis identifier MDAXIS_SLICERS. Calling this method with <i>iAxis</i> set to MDAXIS_SLICERS returns information about the slicer dimensions in the form of an axis rowset. For more information, see “Finding Slicer Information” in Chapter 3.</p>
<p>
If an error occurs, <i>*ppRowset</i> is set to NULL.</p>
</font></BODY>
</HTML>
