<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Row States</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbrow_states"></a>Row States</h1>
<p>
A row has a state that depends on whether it has been changed and whether that change is pending or transmitted. Consumers call <b>IRowsetUpdate::GetRowStatus</b> to determine the state of a row. They call <b>IRowsetUpdate::GetPendingRows</b> to get all rows in a pending change state. The state is indicated by the DBPENDINGSTATUS enumerated type. The values in this type have the following meanings.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=33%><b>Value</b></td>
<td class=label width=17%><b>State name</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=33%>DBPENDINGSTATUS_<br>
NEW</td>
<td width=17%>Pending Insert</td>
<td width=50%>The row has a pending insert.</td>
</tr>
<tr valign=top>
<td width=33%>DBPENDINGSTATUS_<br>
CHANGED</td>
<td width=17%>Pending Update</td>
<td width=50%>The row has a pending update.</td>
</tr>
<tr valign=top>
<td width=33%>DBPENDINGSTATUS_<br>
DELETED</td>
<td width=17%>Pending Delete</td>
<td width=50%>The row has a pending delete.</td>
</tr>
<tr valign=top>
<td width=33%>DBPENDINGSTATUS_<br>
UNCHANGED</td>
<td width=17%>Unchanged</td>
<td width=50%>No changes have been made to the row, or changes have been made to the row and have been transmitted or undone.</td>
</tr>
<tr valign=top>
<td width=33%>DBPENDINGSTATUS_<br>
INVALIDROW</td>
<td width=17%>Deleted</td>
<td width=50%>The row has been deleted and that deletion has been transmitted to the data source. This status is also used when a row handle passed to <b>GetRowStatus</b> was invalid.</td>
</tr>
</table><br>
<p>
The Unchanged and Deleted states are the <i>nonending change states</i>. The Pending Update, Pending Delete, and Pending Insert states are the <i>pending change states</i>. The following figure shows these states, how methods affect them, and the corresponding DBPENDINGSTATUS values.<br>
</p>
<p class=label>
<b>Pending change states</b></p>
<p>
<img src="ch0502.gif" border=0></p>
<p>
If the consumer calls <b>IRowset::ReleaseRows</b> for a row and the reference count for that row falls to zero, release of the row and its resources depends on the row's state. In the nonpending change states, the row and its resources are usually released when the reference count falls to zero, although the actual point of release is provider specific.</p>
<p>
In the pending change states, the row and its resources are not released when the reference count falls to zero, nor are the pending changes lost. The row remains valid until the changes are transmitted or undone (the row moves to a nonpending change state), then the row and its resources are released. Rows in a pending change state that have a reference count of zero are still considered active for purposes such as calculating row limits such as those returned by the DBPROP_MAXOPENROWS and DBPROP_MAXPENDINGROWS properties. Although the row handle might remain valid for such rows, consumers should not count on this.</p>
</font></BODY>
</HTML>
