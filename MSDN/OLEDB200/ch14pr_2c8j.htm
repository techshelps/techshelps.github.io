<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Threading and Notifications</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbthreading_and_notifications"></a>Threading and Notifications</h1>
<p>
In the case of free-threaded rowset objects, <b>IConnectionPoint</b> should be enabled to handle apartment-model or single-thread listeners. Single-threaded listeners should always be called on their thread so the listeners are not unduly interrupted from the wrong thread.</p>
<p>
The creator of a rowset must use <b>CoMarshalInterface</b> when making the object's interfaces available to other threads. Because these are free-threaded rowsets, COM will stay out of the way. If <b>IConnectionPoint</b> receives an interface from <b>IRowsetNotify</b> and it wants to use that interface on another thread, it must also use <b>CoMarshalInterface</b> to move the interface to another thread. Whatever moves the interface to another thread must call <b>CoMarshalInterface</b>. The receiving thread doesn't just get the pointer, but becomes involved by extracting the pointer through <b>CoUnmarshalInterface</b>.</p>
<p>
This entails that a rowset is written internally to use multiple threads, not just to run on multiple threads. As a consequence of this, a rowset should keep track of the threads on which a listener is connected to it.</p>
<p class=label>
<b>Multiple threads</b></p>
<p>
<img src="ch1402.gif" border=0></p>
</font></BODY>
</HTML>
