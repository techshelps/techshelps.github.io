<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Rowsets</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbrowsets"></a>Overview of Rowsets</h1>
<p>
A rowset is simply a set of rows in which each row has columns of data. This chapter explains how to create and release rowsets, as well as how to set their properties, such as supported interfaces. Also presented is a description of how to manage the activity of individual rows or rowsets: fetching, reference-counting handles, and column access and reference. Rowset reference and fetching are discussed in the use of bookmarks of various types, chapters, and views. <i>Bookmarks</i> allow the consumer to return quickly to a row, chapters identify a group of rows within a rowset, and a view can expose simple operations such as sorting or filtering a rowset. Hierarchical rowsets are those linked together by using chapters. The interfaces, navigation, properties, lifetime, and notifications when using hierarchical rowsets are all discussed.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=602>
<tr valign=top>
<td class=label width=50%><b>For more information on</b></td>
<td class=label width=50%><b>Go to</b></td>
</tr>
<tr valign=top>
<td width=50%>Creating and releasing rowsets</td>
<td width=50%>"<a href="ch04pr_8zcj.htm">Creating and Releasing Rowsets</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Setting properties of rowsets</td>
<td width=50%>"<a href="ch04pr_02ib.htm">Setting Rowset Properties</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Column access</td>
<td width=50%>"<a href="ch04pr_4ewj.htm">Deferred Columns and Column IDs</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Rows</td>
<td width=50%>"<a href="ch04pr_24vn.htm">Rows</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Fetching rows</td>
<td width=50%>"<a href="ch04pr_6kdv.htm">Fetching Rows</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Bookmarks</td>
<td width=50%>"<a href="ch04pr_9h6b.htm">Bookmarks</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Chapters</td>
<td width=50%>"<a href="ch04pr_7ecz.htm">Chapters</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Views</td>
<td width=50%>"<a href="ch04pr_9rjn.htm">Views</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Hierarchical rowsets</td>
<td width=50%>"<a href="ch04pr_5enn.htm">Hierarchical Rowsets</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Navigation </td>
<td width=50%>"<a href="ch04pr_4yk3.htm">Navigating Hierarchical Rowsets</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Properties of hierarchical rowsets</td>
<td width=50%>"<a href="ch04pr_9unn.htm">Setting Properties on Hierarchical Rowsets</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Lifetime of rowsets</td>
<td width=50%>"<a href="ch04pr_8odv.htm">Lifetime of Row Handles and Chapters</a>" in this chapter</td>
</tr>
</table><br>
<p>
Rowsets are the central objects that enable all OLE DB data providers to expose data in tabular form. Conceptually, a rowset is a set of rows in which each row has columns of data. Base table providers present their data in the form of rowsets. Query processors present query results in the form of rowsets. This makes it possible to layer components that consume or produce data through the same object.</p>
<p>
Rowsets:</p>
<pre><code>CoType TRowset {
   [mandatory] interface IAccessor;
   [mandatory] interface IColumnsInfo;
   [mandatory] interface IConvertType;
   [mandatory] interface IRowset;
   [mandatory] interface IRowsetInfo;
   [optional]&nbsp; interface IChapteredRowset;
   [optional]&nbsp; interface IColumnsRowset;
   [optional]&nbsp; interface IConnectionPointContainer;
   [optional]&nbsp; interface IDBAsynchStatus;
   [optional]&nbsp; interface IRowsetChange;
   [optional]&nbsp; interface IRowsetFind;
   [optional]&nbsp; interface IRowsetIdentity;
   [optional]&nbsp; interface IRowsetIndex;
   [optional]&nbsp; interface IRowsetLocate;
   [optional]&nbsp; interface IRowsetRefresh;
   [optional]&nbsp; interface IRowsetScroll;
   [optional]&nbsp; interface IRowsetUpdate;
   [optional]&nbsp; interface IRowsetView;
   [optional]&nbsp; interface ISupportErrorInfo;
}</code></pre>
<p>
The most basic rowset exposes the following interfaces:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=584>
<tr valign=top>
<td width=25%><b>IRowset</b></td>
<td width=75%>Contains methods for fetching rows in the rowset sequentially. </td>
</tr>
<tr valign=top>
<td width=25%><b>IAccessor </b></td>
<td width=75%>Permits the definition of groups of column bindings describing the way tabular data is bound to consumer program variables.</td>
</tr>
<tr valign=top>
<td width=25%><b>IColumnsInfo</b></td>
<td width=75%>Provides information about the columns of the rowset.</td>
</tr>
<tr valign=top>
<td width=25%><b>IRowsetInfo</b></td>
<td width=75%>Provides information about the rowset itself.</td>
</tr>
<tr valign=top>
<td width=25%><b>IConvertType</b></td>
<td width=75%>Provides information about the data type conversions supported by the rowset.</td>
</tr>
</table><br>
<p>
Using <b>IRowset</b>, a consumer can sequentially traverse the rows in the rowset, including traversing backward if the rowset supports it.</p>
<pre></pre>
</font></BODY>
</HTML>
