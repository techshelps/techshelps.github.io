<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Information in OLE DB Error Interfaces</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="information_in_ole_db_error_interfaces"></a>Information in OLE DB Error Interfaces</h1>
<p>
SQLOLEDB reports some error and status information in the OLE DB-defined error interfaces <b>IErrorInfo</b>,<b> IErrorRecords</b>, and <b>ISQLErrorInfo</b>.</p>
<p>
SQLOLEDB supports <b>IErrorInfo</b> member functions as follows.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=32%><b>Member function</b></td>
<td class=label width=68%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=32%><b>GetDescription</b></td>
<td width=68%>A descriptive error message string.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetGUID</b></td>
<td width=68%>The GUID of the interface that defined the error.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetHelpContext</b></td>
<td width=68%>Not supported. Returns zero always.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetHelpFile</b></td>
<td width=68%>Not supported. Returns NULL always.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetSource</b></td>
<td width=68%>The string Sqloledb.dll.</td>
</tr>
</table><br>
<p>
SQLOLEDB supports consumer-available <b>IErrorRecords</b> member functions as follows.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=32%><b>Member function</b></td>
<td class=label width=68%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=32%><b>GetBasicErrorInfo</b></td>
<td width=68%>Fills an ERRORINFO structure with basic information about an error. An ERRORINFO structure contains members that identify the HRESULT return value for the error and the provider and interface on which the error applies.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetCustomErrorObject</b></td>
<td width=68%>Returns a reference on an <b>ISQLErrorInfo</b> interface.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetErrorInfo</b></td>
<td width=68%>Returns a reference on an <b>IErrorInfo</b> interface.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetErrorParameters</b></td>
<td width=68%>SQLOLEDB does not return parameters to the consumer through <b>GetErrorParameters</b>.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetRecordCount</b></td>
<td width=68%>The count of error records available.</td>
</tr>
</table><br>
<p>
SQLOLEDB supports <b>ISQLErrorInfo::GetSQLInfo</b> parameters as follows.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=32%><b>Parameter</b></td>
<td class=label width=68%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=32%><i>pbstrSQLState</i></td>
<td width=68%>Returns a SQLSTATE representing for the error. SQLSTATE values are defined in the ANSI SQL92, ODBC and ISO SQL, and API specifications. Neither Microsoft SQL Server nor SQLOLEDB define implementation-specific SQLSTATE values.</td>
</tr>
<tr valign=top>
<td width=32%><i>plNativeError</i></td>
<td width=68%>Returns the SQL Server error number from <b>master.dbo.sysmessages</b> when available. Native errors are available after a successful attempt to initialize a SQLOLEDB data source. Prior to the attempt, SQLOLEDB always returns zero.</td>
</tr>
</table><br>
</font></BODY>
</HTML>
