<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IColumnsInfo::MapColumnIDs</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbicolumnsinfo__mapcolumnids"></a>IColumnsInfo::MapColumnIDs</h1>
<p>
Returns an array of ordinals of the columns in a rowset that are identified by the specified column IDs.</p>
<pre><code>HRESULT MapColumnIDs (
   ULONG      cColumnIDs,
   const DBID   rgColumnIDs[],
   ULONG      rgColumns[]);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>cColumnIDs</i></p>
<p class=indent>
[in]<br>
The number of column IDs to map. If <i>cColumnIDs</i> is 0, <b>MapColumnIDs</b> does nothing and returns S_OK.</p>
<p class=dt>
<i>rgColumnIDs</i></p>
<p class=indent>
[in]<br>
An array of IDs of the columns of which to determine the column ordinals. If <i>rgColumnIDs</i> contains a duplicate column ID, a column ordinal is returned once for each occurrence of the column ID. If the column ID is invalid, the corresponding element of <i>rgColumns</i> is set to DB_INVALIDCOLUMN.</p>
<p class=dt>
<i>rgColumns</i></p>
<p class=indent>
[out]<br>
An array of <i>cColumnIDs</i> ordinals of the columns identified by the elements of <i>rgColumnIDs</i>. The consumer allocates, but is not required to initialize, memory for this array and passes the address of this memory to the provider. The provider returns the column IDs in the array.</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded. All elements of <i>rgColumns</i> are set to values other than DB_INVALIDCOLUMN.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
An element of <i>rgColumnIDs</i> was invalid. If the column ID is invalid, the corresponding element of <i>rgColumns</i> is set to DB_INVALIDCOLUMN.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>cColumnIDs</i> was not 0 and <i>rgColumnIDs</i> was a null pointer.</p>
<p class=tl>
<i>rgColumns</i> was a null pointer.</P><p class=dt>
</p>
<p class=indent>
E_UNEXPECTED<br>
<b>ITransaction::Commit</b> or <b>ITransaction::Abort</b> was called and the object is in a zombie state. This error can be returned only when the method is called on a rowset.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
All elements of <i>rgColumnIDs</i> were invalid. All elements of <i>rgColumns</i> are set to DB_INVALIDCOLUMN.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOCOMMAND<br>
No command text was set. This error can be returned only when this method is called from the Command object.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOTPREPARED<br>
The command exposed <b>ICommandPrepare</b> and the command text was set, but the command was not prepared. This error can be returned only when this method is called from the Command object.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOTREENTRANT<br>
The provider called a method from <b>IRowsetNotify</b> in the consumer and the method has not yet returned.</p>
<p class=label>
<b>Comments</b></p>
<p>
This method makes no logical change to the state of the object.</p>
<p>
<b>MapColumnIDs</b> returns the ordinals of the columns in the rowset that are identified by the elements of <i>rgColumnIDs</i>. These column ordinals do not change during the life of the rowset. Column ordinals may change between different instantiations of a rowset if the command text does not define an order, such as a <b>SELECT * FROM MyTable</b>.</p>
<p>
Two column IDs that are the same—except that one contains a GUID and the other contains a pointer to a GUID—are equivalent if both use the same GUID. Both are mapped to the same column ordinal.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="colinf_3lrj.htm">IColumnsInfo::GetColumnInfo</a>, <a href="colrow_83p0.htm">IColumnsRowset::GetColumnsRowset</a></p>
</font></BODY>
</HTML>
