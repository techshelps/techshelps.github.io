<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example 1</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="namedsetscalculatedmembersexample1"></a>Example 1</h1>
<p>
On the ROWS axis, show the Actual Sales and percent change from last year’s sales for the product lines for which actual is less than budget. This should be sorted by Sales Last Year. On the COLUMNS axis, show the top two cities in the top two countries in the regions Europe and America.</p>
<p>
<img src="te_ch0204.gif" border=0></p>
<p>
The MDX statement that retrieves this dataset is</p>
<pre><code>WITH MEMBER
 &nbsp; Measures.[% Change from Last Year Sales] AS Sales / 
 &nbsp;&nbsp;&nbsp;&nbsp; (Sales, Year.PREVMEMBER)
SELECT GENERATE(
 &nbsp; GENERATE({America, Europe},
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TOPCOUNT(Geography.CURRENTMEMBER.CHILDREN, 2, Sales)),
 &nbsp; TOPCOUNT(Geography.CURRENTMEMBER.CHILDREN, 2, Sales)) ON COLUMNS, 
 &nbsp; CROSSJOIN({Sales, [% Change from Last Year Sales]},
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ORDER(FILTER([Product Lines].MEMBERS, 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (Sales,Actual)&lt;(Sales,Budget))
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (Sales, Year.PREVMEMBER))) ON ROWS
FROM SalesCube
WHERE ([1997], Actual)
</code></pre>
<p>
The WITH MEMBER clause defines a new member called <b>% Change from Last Year Sales</b>. This appears on the Measures dimension (as indicated by the qualifier [Measures]). This member is specified by the formula Sales/(Sales, Year.PREVMEMBER). Within the context of the rest of the expression, this new member is evaluated for each value in the <i>n</i>-dimensional manifold selected by the dataset to yield the required result.</p>
</font></BODY>
</HTML>
