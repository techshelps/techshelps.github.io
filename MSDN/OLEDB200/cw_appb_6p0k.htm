<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Load</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="load"></a>Load</h1>
<pre><code>HRESULT Load(
IStream *pStream, 
void *pBuffer, 
long cbBuffer);
HRESULT Load(
IPropertyBag *pPropertyBag, 
IErrorLog *pErrorLog, 
void *pBuffer, 
long cbBuffer);</code></pre>
<p class=label>
</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pStream</i></p>
<p class=indent>
Pointer to <b>IStream</b> from which to load properties. </p>
<p class=dt>
<i>pBuffer</i></p>
<p class=indent>
User-defined buffer. This data is not modified.</p>
<p class=dt>
<i>cbBuffer</i></p>
<p class=indent>
Size of the user buffer. Buffer overwrite is checked using this buffer size.</p>
<p class=dt>
<i>pPropertyBag</i></p>
<p class=indent>
Pointer to <b>IPropertyBag</b> from which to load.</p>
<p class=dt>
<i>pErrorLog</i></p>
<p class=indent>
Pointer to <b>IErrorLog</b> interface. Load errors are sent to the log file.</p>
<p class=dt>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=dt>
S_OK</p>
<p class=indent>
Method succeeded.</p>
<p>
E_FAIL <br>
Returned if the persisted version is greater or stream IDs differ.</p>
<p class=label>
<b>Comments (Load IStream)</b></p>
<p>
Loads properties from the stream. All properties saved to the stream are loaded into memory, but only those properties currently in the collection are set, provided that they were loaded (previously saved). This allows the current collection to contain fewer or more properties than the persisted stream.</p>
<p class=label>
<b>Comments (Load PropertyBag)</b></p>
<p>
Loads properties from the PropertyBag. When loading, all properties in the collection are attempted. If a property fails to load, then it is assumed that it was not persisted. Its offset in the user buffer remains unmodified. <b>IsProperSaved </b>will return FALSE for any property not loaded.</p>
<p>
If a property is loaded, then the current value of its location in the user buffer is properly freed. Each property is freed according to its data type.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=50%><b>Property type</b></td>
<td class=label width=50%><b>What happens</b></td>
</tr>
<tr valign=top>
<td width=50%>VT_BOOL</td>
<td width=50%>Value replaced.</td>
</tr>
<tr valign=top>
<td width=50%>VT_I2</td>
<td width=50%>Value replaced.</td>
</tr>
<tr valign=top>
<td width=50%>VT_I4</td>
<td width=50%>Value replaced.</td>
</tr>
<tr valign=top>
<td width=50%>VT_R4</td>
<td width=50%>Value replaced.</td>
</tr>
<tr valign=top>
<td width=50%>VT_R8</td>
<td width=50%>Value replaced.</td>
</tr>
<tr valign=top>
<td width=50%>VT_LPWSTR</td>
<td width=50%>Current pointer is freed using <b>CoTaskMemFree</b>.</td>
</tr>
<tr valign=top>
<td width=50%>VT_LPSTR</td>
<td width=50%>Current pointer is freed using <b>CoTaskMemFree</b>.</td>
</tr>
<tr valign=top>
<td width=50%>VT_BSTR</td>
<td width=50%>Current pointer is freed using <b>SysFreeString</b>.</td>
</tr>
<tr valign=top>
<td width=50%>VT_UNKNOWN</td>
<td width=50%>Current pointer is freed using <b>IUknown::Release</b>.</td>
</tr>
</table><br>
<p>
Call <b>IsPropSaved</b> to test whether a property was actually saved or loaded. </p>
</font></BODY>
</HTML>
