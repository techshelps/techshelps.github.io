<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Empty Cells in a Dataset</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="emptycellsindataset"></a>Empty Cells in a Dataset</h1>
<p>
Frequently, the MDX statement that specifies a dataset will include empty cells in the dataset. Just like any other cell, an&nbsp; empty cell is associated with a set of tuples. There are some tuples for which every cell is empty at the intersection of this tuple and any other tuple in all of the other axes. Such tuples are called <i>empty tuples</i>. </p>
<p>
Depending on an application’s presentation requirements, it is sometimes desirable to have empty tuples in the dataset and sometimes not. The MDX keyword <b>NON EMPTY</b> is used to filter out empty tuples. Using this keyword in a query filters out all empty tuples along an axis. The BNF construct is:</p>
<pre><code>&lt;MDX_Statement&gt; ::= SELECT &lt;axis_specification&gt;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [, &lt;axis_specification&gt;...]
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM &lt;cube_specification&gt;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE &lt;slicer_specification&gt;

&lt;axis_specification&gt; ::= [NON EMPTY] &lt;set_expression&gt; ON &lt;axis_name&gt;
</code></pre>
<p>
If <b>NON EMPTY</b> is specified, empty tuples are removed from the axis. The default is for empty tuples to appear on the axis.</p>
<p>
Empty cells are possible even if <b>NON EMPTY</b> is specified. For example, suppose that the salesrep Venkatrao did not sell anything during the first half of 1996. During the second half of 1996, he sold only Office products, but no Operating System products. In 1997, he sold all products. Now consider the dataset that results from the following MDX statement:</p>
<pre><code>SELECT 
 &nbsp; NON EMPTY CROSSJOIN({Venkatrao, Netz}, {Office, [Operating Systems]}) 
 &nbsp;&nbsp;&nbsp;&nbsp; ON COLUMNS,
 &nbsp; NON EMPTY {[1996], [1997]} ON ROWS
FROM SalesCube
WHERE (Sales)
</code></pre>
<p>
This results in the following dataset:</p>
<table border=1 cellpadding=5 cols=6 frame=below rules=rows width=462>
<tr valign=top>
<td width=11%></td>
<td colspan=2 width=20%><b>Venkatrao</b></td>
<td width=23%></td>
<td width=15%><b>Netz</b></td>
<td width=31%></td>
</tr>
<tr valign=top>
<td width=11%></td>
<td width=16%><b>Office</b></td>
<td colspan=2 width=27%><b>Operating <br>
Systems</b></td>
<td width=15%><b>Office</b></td>
<td width=31%><b>Operating <br>
Systems</b></td>
</tr>
<tr valign=top>
<td width=11%><b>1996</b></td>
<td width=16%>4032</td>
<td colspan=2 width=27%></td>
<td width=15%>9876</td>
<td width=31%>13</td>
</tr>
<tr valign=top>
<td width=11%><b>1997</b></td>
<td width=16%>10002</td>
<td colspan=2 width=27%>54</td>
<td width=15%>18734</td>
<td width=31%>21</td>
</tr>
</table><br>
<p>
The cell that has operating systems for Venkatrao in 1996 is empty because Venkatrao did not sell any operating systems in all of 1996. <b>NON EMPTY </b>does not suppress this because the cell is not associated with any empty tuple.</p>
<p>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;It is not possible to filter out the empty tuples by applying some kind of a set expression during the axis specification because the cell data is populated after all axis specifications are evaluated. Any filter in the axis specification cannot be based on data in the cells of a dataset. Therefore, filtering out the empty tuples from an axis is done only after the set expressions of all of the axes have been evaluated.</p>
</font></BODY>
</HTML>
