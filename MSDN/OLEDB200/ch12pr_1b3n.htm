<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Nested Transactions</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbnested_transactions"></a>Nested Transactions</h1>
<p>
A nested transaction occurs when a database-transaction object (the parent transaction) sets up a transaction. Changes made within the inner transaction are completely invisible to the outer transaction until the inner transaction is committed. Even then, the changes are not visible outside the outer transaction until that transaction is committed. The inner transaction object must be released before the parent can be released.</p>
<p>
Providers that expose <b>ITransactionLocal</b> may support a limited number of nested transactions, including zero. For providers that support nested transactions, calling <b>ITransactionLocal::StartTransaction</b> with an existing transaction begins a new transaction nested below the current transaction. <b>StartTransaction</b> returns the level of the new transaction, starting with *<i>pulTransactionLevel</i> = 1 for the root transaction. Calling <b>ITransactionLocal::Commit</b> or <b>ITransactionLocal::Abort</b> commits or aborts the transaction at the current (lowest) level. If the <i>fRetaining</i> flag is set to TRUE, a new unit of work for the nested transaction is begun; if the <i>fRetaining</i> flag is set to FALSE, no new nested transaction is begun and additional work is done within the scope of the parent transaction.</p>
</font></BODY>
</HTML>
