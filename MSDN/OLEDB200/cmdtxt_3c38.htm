<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ICommandText::GetCommandText</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbicommandtext__getcommandtext"></a>ICommandText::GetCommandText</h1>
<p>
Returns the text command set by the last call to <b>SetCommandText</b>.</p>
<pre><code>HRESULT GetCommandText (
   GUID *            pguidDialect,
   LPOLESTR *   ppwszCommand);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>pguidDialect</i></p>
<p class=indent>
[in/out]<br>
A pointer to memory containing a GUID that specifies the syntax and general rules for parsing the command text—that is, the dialect that will be used by the provider to interpret the statement. This is generally the dialect specified in <b>SetCommandText</b>. However, if DBGUID_DEFAULT is specified in <b>SetCommandText</b>, the provider returns the particular dialect that it will use to interpret the statement. If the provider determines between multiple dialects at execution time for a command that has been set with DBGUID_DEFAULT, or if the provider is returning some provider-specific syntax that may be different from the command set in <b>SetCommandText</b>, it returns DBGUID_DEFAULT. Providers can define GUIDs for their own dialects.</p>
<p class=tl>
For more information about dialects, see "<a href="ch03pr_2ltf.htm">Using Commands</a>" in Chapter 3, "Commands."</P><p class=tl>
If <b>GetCommandText</b> returns an error, *<i>pguidDialect</i> is set to DB_NULLGUID.</P><p class=dt>
<i>ppwszCommand</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the command text. The command object allocates memory for the command text and returns the address to this memory. The consumer releases this memory with <b>IMalloc::Free</b> when it no longer needs the text. If <b>GetCommandText</b> returns an error, *<i>ppwszCommand</i> is set to a null pointer.</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_DIALECTIGNORED<br>
The method succeeded, but the input value of <i>pguidDialect</i> was ignored. The text is returned in the dialect specified in <b>SetCommandText</b> or the dialect that makes the most sense to the provider. The value returned in *<i>pguidDialect</i> represents that dialect.</p>
<p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>ppwszCommand</i> was a null pointer.</p>
<p class=dt>
</p>
<p class=indent>
E_OUTOFMEMORY<br>
The provider was unable to allocate sufficient memory in which to return the command text.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_NOCOMMAND<br>
No command text was currently set on the command object.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="cmdtxt_7sok.htm">ICommandText::SetCommandText</a></p>
<p class=label>
<b>Comments</b></p>
<p>
The GUID returned in <b>GetCommandText</b> is the dialect that will be used by the provider to interpret the statement. This is generally the dialect specified in <b>SetCommandText</b>. However, if DBGUID_DEFAULT is specified in <b>SetCommandText</b>, the provider should return the particular dialect that it will use to interpret the statement. If the provider determines between multiple dialects at execution time for a command that has been set with DBGUID_DEFAULT, or if the provider is returning some provider-specific syntax that may be different from the command set in <b>SetCommandText</b>, it returns DBGUID_DEFAULT.</p>
</font></BODY>
</HTML>
