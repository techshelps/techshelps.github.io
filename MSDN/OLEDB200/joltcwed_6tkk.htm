<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDBSchemaRowset</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="idbschemarowset"></a>IDBSchemaRowset</h1>
<p>
Consumers can get information about a data source without knowing its structure by using the <b>IDBSchemaRowset</b> methods. </p>
<p>
This schema defines a minimum content of the system schema. It is assumed that consumers will precompile and store specialized queries, such as those for command planning and execution-time plan validation, and that storage engines may have specialized optimizations associated with those plans. Consumers can also look at the schema tables in the schema, and thus discover other schema tables and attributes beyond the minimum set.</p>
<p>
For information about the schema rowsets, see Appendix B, “Schema Rowsets,” in this document. This provider returns all of the columns in the rowsets returned. This information may be NULL. Provider-specific columns described in Appendix B are returned after the last column defined by OLE DB.</p>
<p>
Schema rowsets are identified by GUIDs. The following table lists these GUIDs and the columns for which restrictions can be specified on the schema rowset. The number of restriction columns for each schema rowset are defined as constants prefixed with CRESTRICTIONS_ in the header files. Restriction values are treated as literals rather than as search patterns. For example, the restriction value “A_C” matches “A_C” but not “ABC.”</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=45%><b>GUID</b></td>
<td class=label width=23%><b>Number of restrictions</b></td>
<td class=label width=32%><b>Restriction columns</b></td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_ASSERTIONS</td>
<td width=23%>3</td>
<td width=32%>CONSTRAINT_CATALOG<p>
CONSTRAINT_SCHEMA</p>
<p>
CONSTRAINT_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CATALOG</td>
<td width=23%>1</td>
<td width=32%>CATALOG_NAME</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CHARACTER_SETS</td>
<td width=23%>3</td>
<td width=32%>CHARACTER_SET_CATALOG<p>
CHARACTER_SET_SCHEMA</p>
<p>
CHARACTER_SET_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CHECK_CONSTRAINTS</td>
<td width=23%>3</td>
<td width=32%>CONSTRAINT_CATALOG<p>
CONSTRAINT_SCHEMA</p>
<p>
CONSTRAINT_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLLATIONS</td>
<td width=23%>3</td>
<td width=32%>COLLATION_CATALOG<p>
COLLATION_SCHEMA</p>
<p>
COLLATION_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLUMN_DOMAIN_USAGE</td>
<td width=23%>4</td>
<td width=32%>DOMAIN_CATALOG<p>
DOMAIN_SCHEMA</p>
<p>
DOMAIN_NAME</p>
<p>
COLUMN_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLUMN_PRIVILEGES</td>
<td width=23%>6</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
<p>
COLUMN_NAME</p>
<p>
GRANTOR</p>
<p>
GRANTEE</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_COLUMNS</td>
<td width=23%>4</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
<p>
COLUMN_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CONSTRAINT_COLUMN_USAGE</td>
<td width=23%>4</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
<p>
COLUMN_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_CONSTRAINT_TABLE_USAGE</td>
<td width=23%>3</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_FOREIGN_KEYS</td>
<td width=23%>6</td>
<td width=32%>PK_TABLE_CATALOG<p>
PK_TABLE_SCHEMA</p>
<p>
PK_TABLE_NAME</p>
<p>
FK_TABLE_CATALOG</p>
<p>
FK_TABLE_SCHEMA</p>
<p>
FK_TABLE_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_INDEXES</td>
<td width=23%>5</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
INDEX_NAME</p>
<p>
TYPE</p>
<p>
TABLE_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_KEY_COLUMN_USAGE</td>
<td width=23%>7</td>
<td width=32%>CONSTRAINT_CATALOG<p>
CONSTRAINT_SCHEMA</p>
<p>
CONSTRAINT_NAME</p>
<p>
TABLE_CATALOG</p>
<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
<p>
COLUMN_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PRIMARY_KEYS</td>
<td width=23%>3</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PROCEDURE_COLUMNS</td>
<td width=23%>4</td>
<td width=32%>PROCEDURE_CATALOG<p>
PROCEDURE_SCHEMA</p>
<p>
PROCEDURE_NAME</p>
<p>
COLUMN_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PROCEDURE_PARAMETERS</td>
<td width=23%>4</td>
<td width=32%>PROCEDURE_CATALOG<p>
PROCEDURE_SCHEMA</p>
<p>
PROCEDURE_NAME</p>
<p>
PROCEDURE_TYPE</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_PROVIDER_TYPES</td>
<td width=23%>2</td>
<td width=32%>DATA_TYPE<p>
BEST_MATCH</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_REFERENTIAL_CONSTRAINTS</td>
<td width=23%>3</td>
<td width=32%>CONSTRAINT_CATALOG<p>
CONSTRAINT_SCHEMA</p>
<p>
CONSTRAINT_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_SCHEMATA</td>
<td width=23%>3</td>
<td width=32%>CATALOG_NAME<p>
SCHEMA_NAME</p>
<p>
SCHEMA_OWNER</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_SQL_LANGUAGES</td>
<td width=23%>0</td>
<td width=32%>NONE</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_STATISTICS</td>
<td width=23%>3</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_TABLE_CONSTRAINTS</td>
<td width=23%>7</td>
<td width=32%>CONSTRAINT_CATALOG<p>
CONSTRAINT_SCHEMA</p>
<p>
CONSTRAINT_NAME</p>
<p>
TABLE_CATALOG</p>
<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
<p>
CONSTRAINT_TYPE</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_TABLE_PRIVILEGES</td>
<td width=23%>5</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
<p>
GRATOR</p>
<p>
GRANTEE</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_VIEW_COLUMN_USAGE</td>
<td width=23%>3</td>
<td width=32%>VIEW_CATALOG<p>
VIEW_SCHEMA</p>
<p>
VIEW_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_VIEW_TABLE_USAGE</td>
<td width=23%>3</td>
<td width=32%>VIEW_CATALOG<p>
VIEW_SCHEMA</p>
<p>
VIEW_NAME</p>
</td>
</tr>
<tr valign=top>
<td width=45%>DBSCHEMA_VIEWS</td>
<td width=23%>3</td>
<td width=32%>TABLE_CATALOG<p>
TABLE_SCHEMA</p>
<p>
TABLE_NAME</p>
</td>
</tr>
</table><br>
<p>
For a list of supported schema rowsets, see Appendix B.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Method</b><u> </u></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=50%><b>GetRowset</b></td>
<td width=50%>Returns a schema rowset.</td>
</tr>
<tr valign=top>
<td width=50%><b>GetSchemas</b></td>
<td width=50%>Returns a list of schema rowsets accessible by IDBSchemaRowset::GetRowset.</td>
</tr>
</table><br>
<h3>IDBSchemaRowset::GetRowset</h3>
<p>
Returns a schema rowset. For information on how this interface is implemented, see the <i>OLE DB Programmer’s Reference</i>. For information about the rowset property set, see Appendix A. For more information about the schema rowsets supported, see Appendix B.</p>
<h3>IDBSchemaRowset::GetSchemas</h3>
<p>
Returns a list of schema rowsets accessible by <b>IDBSchemaRowset::GetRowset</b>. For information on how this interface is implemented, see the <i>OLE DB Programmer’s Reference</i>.</p>
</font></BODY>
</HTML>
