<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Command Syntax</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="command_syntax"></a>Command Syntax</h1>
<p>
SQLOLEDB recognizes command syntax specified by the DBGUID_DBSQL macro. For SQLOLEDB, the specifier indicates that an amalgam of ODBC, ANSI, and SQL Server-specific Transact-SQL is valid syntax. For example, the following SQL statement uses an ODBC SQL escape sequence to specify the LCASE string function:</p>
<pre><code>SELECT customerid={fn LCASE(CustomerID)} FROM Customers
<b><i>  </i></b></code></pre>
<p>
LCASE returns a character string, converting all uppercase characters to their lowercase equivalents. The ANSI SQL string function LOWER performs the same operation, so the following SQL statement is an ANSI equivalent to the ODBC statement presented above:</p>
<pre><code>SELECT customerid=LOWER(CustomerID) FROM Customers
<b><i>  </i></b></code></pre>
<p>
SQLOLEDB successfully processes either form of the statement when specified as text for a command.</p>
<h3>Stored Procedures</h3>
<p>
When executing an SQL Server stored procedure using an SQLOLEDB command, use the ODBC procedure call escape sequence in the command text. SQLOLEDB then uses the remote procedure call mechanism of SQL Server to optimize command processing. For example, the following ODBC SQL statement is preferred command text over the Transact-SQL form:</p>
<p>
<b>ODBC SQL</b></p>
<pre><code>{call SalesByCategory('Produce', '1995')}
<b><i>  </i></b></code></pre>
<p>
<b>Transact-SQL</b></p>
<pre><code>EXECUTE SalesByCategory 'Produce', '1995'
<b><i>  </i></b></code></pre>
</font></BODY>
</HTML>
