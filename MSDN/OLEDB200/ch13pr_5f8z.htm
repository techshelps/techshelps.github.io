<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Errors</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledberrors"></a>Overview of Errors</h1>
<p>
This chapter addresses the ability of OLE DB to process errors by using methods, which either return a code or create an error object. Error objects, which are a basic OLE DB component, can return detailed error information. Handling of multiple error items is discussed under "<a href="ch13pr_5ib7.htm">Arrays of Errors</a>." </p>
<p>
Automation is the ability to expose one software application's services to another application by using interfaces, such as COM. The mechanics of how an Automation component returns and/or retrieves an error object, as well as its use of threads, is presented here. OLE DB extends Automation error objects by adding the ability for an error object to contain multiple <i>error records</i>. Provider-specific error lookup services are also discussed.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=603>
<tr valign=top>
<td class=label width=50%><b>For more information on</b></td>
<td class=label width=50%><b>Go to</b></td>
</tr>
<tr valign=top>
<td width=50%>Return codes</td>
<td width=50%>"<a href="ch13pr_1kqb.htm">Return Codes</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Basic OLE DB components</td>
<td width=50%>"<a href="ch01pr_26b7.htm">OLE DB Components</a>" in Chapter 1, "Overview of OLE DB"</td>
</tr>
<tr valign=top>
<td width=50%>Arrays of errors</td>
<td width=50%>"<a href="ch13pr_5ib7.htm">Arrays of Errors</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>How an Automation component returns an error object</td>
<td width=50%>"<a href="ch13pr_2ks4.htm">How an Automation Component Returns an Error Object</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>How an Automation consumer retrieves an error object</td>
<td width=50%>"<a href="ch13pr_1r90.htm">How an Automation Consumer Retrieves an Error Object</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>OLE DB error objects</td>
<td width=50%>"<a href="ch13pr_90qb.htm">OLE DB Error Objects</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Error records</td>
<td width=50%>"<a href="ch13pr_6a5v.htm">Error Records</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Interfaces used by OLE DB error objects</td>
<td width=50%>"<a href="ch13pr_4mwj.htm">Interfaces Used by OLE DB Error Objects</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>How an Automation component returns an error object</td>
<td width=50%>"<a href="ch13pr_78hg.htm">How a Provider Returns an OLE DB Error Object</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>How an Automation component retrieves an error object</td>
<td width=50%>"<a href="ch13pr_2fn8.htm">How a Consumer Retrieves an OLE DB Error Object</a>" in this chapter</td>
</tr>
<tr valign=top>
<td width=50%>Use of threads</td>
<td width=50%>"<a href="ch13pr_74dv.htm">OLE DB Error Objects and Threads</a>" in this chapter<p>
"<a href="ch14pr_54s3.htm">Threading and Error Objects</a>" in Chapter 14, "Programming Considerations"</p>
</td>
</tr>
<tr valign=top>
<td width=50%>Provider-specific error lookup services</td>
<td width=50%>"<a href="ch13pr_529f.htm">Error Lookup Services</a>" in this chapter<p>
"<a href="ch14pr_3q5v.htm">Error Lookup Service Registry Entries</a>" in Chapter 14, "Programming Considerations"</p>
</td>
</tr>
<tr valign=top>
<td width=50%>Consumers and providers</td>
<td width=50%>"<a href="ch01pr_9lgz.htm">Consumers and Providers</a>" in Chapter 1, "Overview of OLE DB"</td>
</tr>
</table><br>
<p>
Methods return error information in two ways. The code returned by a method indicates the overall success or failure of the method, and <i>error objects </i>provide detailed information about the error, such as text describing the error, the Help file containing information about the error, a text description of the program that was the source of the error, and any provider-specific error information. Error objects in OLE DB are an extension of the error objects in Automation, use many of the same mechanisms, and can be used as Automation error objects.</p>
<p>
Errors:</p>
<pre><code>CoType TErrorObject {
   [mandatory] interface IErrorRecords;
}</code></pre>
<p>
Custom errors:</p>
<pre><code>CoType TCustomErrorObject {
   [optional]&nbsp; interface ISQLErrorInfo
   [optional]&nbsp; interface IErrorLookup;
}
</code></pre>
<p>
Error records:</p>
<pre><code>CoType TErrorRecord {
   [mandatory] interface IErrorInfo;
}</code></pre>
</font></BODY>
</HTML>
