<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tables and Sets</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="tablessets"></a>Tables and Sets</h1>
<h2>Dimensionality of a Set</h2>
<p>
Many MDX functions take a set or sets as input, and return a set as output. A set consists of tuples. A tuple is a vector of members. Let <i>n</i> be the number of members in any given tuple. The value <i>n</i> is called as the <i>dimensionality</i> of the set. Note the following rules:
<ul type=disc>
<li>
Each member of the tuple must be from a different dimension. <br><br></li>
<li>
The dimension of the <i>p</i>th member of a tuple is the same across all tuples. (The value of <i>p</i> ranges from 1 to <i>n</i>.) </li>
</ul>
<h2>Table Associated with a Set</h2>
<p>
When mapping a statement in MDX, a set maps to a table. This table has <i>n+</i>1 columns, where <i>n</i> is the dimensionality of the set. There is one column for each dimension, and a RANK column that has the rank of a tuple within the set. This column is needed because sets in MDX are ordered. A table in SQL is not.</p>
<p>
Any intermediate table in the expansion of a MDX also has a RANK column. The expansions below use this implicit column in an ORDER BY clause to preserve the order. Note that the notion of rank is somewhat similar to that of an identity column.</p>
<h2>Use of ORDER BY</h2>
<p>
Many sections in this document deal with how to expand MDX set value expressions into equivalent SQL statements. For set value expressions that return another set (such as ORDER and CROSSJOIN), the final result of the expansion is a SELECT statement (which returns a virtual table, also known as set). This SELECT statement always contains an ORDER BY on the RANK column. This is appropriate for a section that deals only with mapping a set value expression. However, it is inefficient to do this when evaluating a full-fledged MDX statement that has multiple such functions along an axis. In that case, the ORDER BY is done at the end after evaluating the entire MDX expression.</p>
</font></BODY>
</HTML>
