<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connection Model</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="connectionmodel"></a>Connection Model</h1>
<p>
A client connects to Microsoft<sup>®</sup> PivotTable<sup>®</sup> Service through the OLE DB for OLAP interfaces. Additional special properties for the Data Source object are used to declare connection criteria specific to Microsoft PivotTable Service, such as creating a local cube, when initializing a session.</p>
<p>
Microsoft PivotTable Service also supports ODBC connections. The OLEDB _SOURCE_DSN property may contain either:
<ul type=disc>
<li>
an ODBC DSN or<br><br></li>
<li>
an entire ODBC connection string</li>
</ul>
<p>
The provider may be either a Microsoft OLAP Server or Microsoft PivotTable Service.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=591>
<tr valign=top>
<td class=label width=37%><b>Property</b></td>
<td class=label width=63%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_INIT_DATASOURCE</td>
<td width=63%>Name of server machine or local cube file</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_INIT_CATALOG</td>
<td width=63%>Name of default (initial) database (catalog)</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_AUTH_USERUID</td>
<td width=63%>Ignored in this release</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_AUTH_PASSWORD</td>
<td width=63%>Ignored in this release</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_INIT_ASYNCH</td>
<td width=63%>Used for asynchronous initialization</td>
</tr>
<tr valign=top>
<td width=37%>MDPROP_INIT_CREATE_CUBE</td>
<td width=63%>(optional) CREATE CUBE statement to create a local cube file<p>
Otherwise: NULL</p>
</td>
</tr>
<tr valign=top>
<td width=37%>MDPROP_INIT_INSERT_INTO</td>
<td width=63%>(optional) INSERT INTO statement to populate a local cube file created with CREATE CUBE<p>
Otherwise: NULL</p>
</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_MSMD_SOURCE_DSN</td>
<td width=63%>ODBC connection string, OLEDB connection string, or DSN for source relational database, used only when creating a local cube file</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_MSMD_SOURCE_UID</td>
<td width=63%>ODBC UID for source relational database, used only when creating a local cube file</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_MSMD_SOURCE_PWD</td>
<td width=63%>ODBC PWD for source relational database, used only when creating a local cube file</td>
</tr>
<tr valign=top>
<td width=37%>DBPROP_INIT_PROVIDERSTRING</td>
<td width=63%>A predefined string containing other initialization properties.</td>
</tr>
<tr valign=top>
<td width=37%>MSMD_USEEXISTINGFILE</td>
<td width=63%>If the first character of this string is Y, T, or a numeric digit other than 0, CREATE CUBE and INSERT INTO properties will be ignored.</td>
</tr>
<tr valign=top>
<td width=37%>MSMD_ARTIFICIALDATA</td>
<td width=63%>If the first character of this string is Y, T, or a numeric digit other than 0, artificial aggregate values will be calculated using a simple algorithm instead of calculating real values.</td>
</tr>
</table><br>
<h1>Notes</h1>
<p>
The following notes about properties apply when connecting to Microsoft PivotTable Service:
<ul type=disc>
<li>
When working with relational data sources, the server name specified is the name of the local Microsoft PivotTable Service, which provides a gateway to the relational data source. The relational data source is specified when the cube is to be populated using the INSERT INTO statement. The same string format is used when specifying the &lt;source&gt; in the INSERT INTO statement (see Appendix A).<br><br></li>
<li>
The IDataInit component enables you to persist these properties in a connection string that can then be used to initiate the session.<br><br></li>
<li>
DBPROP_INIT_DATASOURCE: Usage depends on the operation mode:<ol>
<li>
When working with the Microsoft OLAP Server, this is the name of the server machine, or LOCALHOST, or empty for the local machine.<br><br></li>
<li>
When working with local cube files this is the name of the cube file. Cube files have the default extension of .cub. A .cub file is a multidimensional database and may contain multiple cubes.</li>
</ol>
</li>
<li>
DBPROP_AUTH_USERUID: Ignored in this release.<br><br></li>
<li>
DBPROP_AUTH_PASSWORD: Ignored in this release.<br><br></li>
<li>
DBPROP_MSMD_SOURCE_DSN: The relational database's ODBC DSN.<br><br></li>
<li>
DBPROP_MSMD_SOURCE_UID: The relational database's ODBC UID.<br><br></li>
<li>
DBPROP_MSMD_SOURCE_PWD: The relational database's ODBC PWD.<br><br></li>
<li>
DBPROP_INIT_PROVIDERSTRING: This is a standard OLE DB property, but does not specify usage, which is specific to those providers that use it. The Microsoft PivotTable Service uses this property as follows:<ul type=disc>
<li>
This property is used by ADO and ADOMD<br><br></li>
<li>
The property string is semicolon delimited. Double quotes may be used to delimit individual values.<br><br></li>
<li>
During initialization (<b>IDBInit::Initialize</b>), every recognized property from the DBPROP_INIT_PROVIDERSTRING is copied into its respective property value, overwriting existing property values.<br><br></li>
<li>
After completion of the initialization process (connection to a database or creation of a data cube), a new value for DBPROP_INIT_PROVIDERSTRING is created by concatenating all properties that were used during the initialization process, then concatenating unrecognized properties at the end of the string.</li>
</ul>
</li>
<li>
It is the client application's responsibility to persist the connection string. Also, if the cube file contains more than one cube and the application intends to work with a specific cube, this cube name should also be persisted.<br><br></li>
<li>
MSMD_USEEXISTINGFILE: Specifies whether to override the CREATE CUBE and INSERT INTO properties<br><br></li>
<li>
MSMD_ARTIFICIALDATA: Specifies whether Microsoft PivotTable Service should produce artificial example aggregate values instead of calculating real aggregations.</li>
</ul>
</font></BODY>
</HTML>
