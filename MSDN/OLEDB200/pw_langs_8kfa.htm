<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Visual C++: Information and Guidelines</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbpwk_vcstuff"></a><sup></sup>Visual C++: Information and Guidelines</h1>
<p>
Here is a brief outline of the steps needed to build the OSP component in Visual C++:
<ul type=disc>
<li>
Create an Automation object with standard registration.<br><br></li>
<li>
Implement <a href="pw_id_6xid.htm">IDataSource</a> on the object.<br><br></li>
<li>
Implement the methods for <a href="pw_osp_90s2.htm">OLEDBSimpleProvider</a> with the object (at least once).</li>
</ul>
<h4>Registration</h4>
<p>
In Visual C++, you create your own ProgID for the OSP Data Object, and use it when registering the OLE DB provider. Because you control the <b>DLLRegisterServer</b> function, you can use it to write the registry entries instead of running a copy of the supplied <a href="pw_reg_77j9.htm">RegisterProvider.reg file</a>.</p>
<h4>Programming Notes</h4>
<ul type=disc>
<li>
When compiling in Visual C++, make sure to point to the Include directory where the OLE DB and OLEDBSimpleProvider header files are located.<br><br></li>
<li>
When linking in Visual C++, make sure to add the path for the LIB files so you can link the LIB file containing the IIDs for the Simple Provider interfaces and classes.<br><br></li>
<li>
In Visual C++ implementations, use <b>IDataSource</b> to expose the correct OSP implementation to the <a href="pw_toverview_4fxz.htm#oledbpwk_oledbmappinglayer">Simple Provider DLL</a> (MSDAOSP.DLL).<br><br></li>
<li>
When coding data source notifications in Visual C++, use the <a href="pw_id_2q7m.htm">addDataSourceListener</a> and <a href="pw_id_5uia.htm">removeDataSourceListener</a> methods of <b>IDataSource</b> to add and remove listeners.</li>
</ul>
</font></BODY>
</HTML>
