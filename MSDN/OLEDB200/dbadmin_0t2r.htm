<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDBDataSourceAdmin:: GetCreationProperties</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="oledbidbdatasourceadmin___getcreationproperties"></a>IDBDataSourceAdmin:: GetCreationProperties</h1>
<p>
Returns information about the data source creation properties supported by the data provider.</p>
<pre><code>HRESULT GetCreationProperties (
   ULONG                  cPropertyIDSets,
   const DBPROPIDSET   rgPropertyIDSets[],
   ULONG *                  pcPropertyInfoSets,
   DBPROPINFOSET **   prgPropertyInfoSets,
   OLECHAR **            ppDescBuffer);
</code></pre>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>cPropertyIDSets</i></p>
<p class=indent>
[in]<br>
The number of DBPROPIDSET structures in <i>rgPropertyIDSets</i>.</p>
<p class=tl>
If <i>cPropertySets</i> is zero, the provider ignores <i>rgPropertyIDSets</i> and returns information about all of the properties in the Data Source Creation and Session property groups it supports and all of the properties in the Initialization property group it supports for use in creating data sources.</P><p class=tl>
If <i>cPropertyIDSets</i> is not zero, the provider returns information about the requested properties. If a property is not supported, or if a property in the Initialization property group cannot be used to create data sources, the returned value of <i>dwStatus</i> in the returned DBPROPINFO structure for that property is DBPROPFLAGS_NOTSUPPORTED and the values of the <i>pwszDescription</i>, <i>vtType</i>, and <i>vValues</i> elements are undefined.</P><p class=dt>
<i>rgPropertyIDSets</i></p>
<p class=indent>
[in]<br>
An array of <i>cPropertyIDSets</i> DBPROPIDSET structures. The properties specified in these structures must belong to the Data Source Creation or Session property group or belong to the Initialization property group and be supported for use in creating data sources. The provider returns information about the properties specified in these structures. If <i>cPropertyIDSets</i> is zero, then this parameter is ignored.</p>
<p class=tl>
For information about the properties in the Data Source Creation, Initialization, and Session property groups that are defined by OLE DB, see "<a href="appcpr_8u7n.htm#oledbdata_source_creation_properties">Data Source Creation Properties</a>," "<a href="appcpr_8u7n.htm#oledbinitialization_properties">Initialization Properties</a>," and "<a href="appcpr_8u7n.htm#oledbsession_properties">Session Properties</a>" in Appendix C. For information about the DBPROPIDSET structure, see "<a href="ch11pr_3gbp.htm">DBPROPIDSET Structure</a>" in Chapter 11.</P><p class=dt>
<i>pcPropertyInfoSets</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return the number of DBPROPINFOSET structures returned in *<i>prgPropertyInfoSets</i>. If <i>cPropertyIDSets</i> is zero, *<i>pcPropertyInfoSets</i> is the total number of property sets for which the provider supports at least one property in the Data Source Creation, Initialization, or Session property groups. If <i>cPropertyIDSets</i> is greater than zero, *<i>pcPropertyInfoSets</i> is set to <i>cPropertyIDSets</i>. If an error occurs, *<i>pcPropertyInfoSets</i> is set to zero.</p>
<p class=dt>
<i>prgPropertyInfoSets</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return an array of DBPROPINFOSET structures. If <i>cPropertyIDSets</i> is zero, then one structure is returned for each property set that contains at least one property belonging to the Data Source Creation, Initialization, or Session property group. If <i>cPropertyIDSets</i> is not zero, then one structure is returned for each property set specified in <i>rgPropertyIDSets</i>.</p>
<p class=tl>
If <i>cPropertyIDSets</i> is not zero, the DBPROPINFOSET structures in *<i>prgPropertyInfoSets</i> are returned in the same order as the DBPROPIDSET structures in <i>rgPropertyIDSets</i>; that is, for corresponding elements of each array, the <i>guidPropertySet</i> elements are the same. If <i>cPropertyIDs</i>, in an element of <i>rgPropertyIDSets</i>, is not zero, the DBPROPINFO structures in the corresponding element of *<i>prgPropertyInfoSets</i> are returned in the same order as the DBPROPID values in <i>rgPropertyIDs</i>; that is, for corresponding elements of each array, the property IDs are the same.</P><p class=tl>
The provider allocates memory for the structures and returns the address to this memory; the consumer releases this memory with <b>IMalloc::Free</b> when it no longer needs the structures. Before calling <b>IMalloc::Free</b> for *<i>prgPropertyInfoSets</i>, the consumer should call <b>IMalloc::Free</b> for the <i>rgPropertyInfos</i> element in each element of *<i>prgPropertyInfoSets</i>. If *<i>pcPropertyInfoSets</i> is zero on output or an error occurs, then *<i>prgPropertyInfoSets</i> must be a null pointer on output.</P><p class=tl>
For information about the DBPROPINFOSET and DBPROPINFO structures, see "<a href="ch11pr_34o5.htm">DBPROPINFOSET Structure</a>" and "DBPROPINFO Structure" in Chapter 11.</P><p class=dt>
<i>ppDescBuffer</i></p>
<p class=indent>
[out]<br>
A pointer to memory in which to return a pointer to storage for all string values returned in the *<i>pwszDescription</i> element of the DBPROPINFO structure. The provider allocates this memory with <b>IMalloc</b> and the consumer frees it with <b>IMalloc::Free</b> when it no longer needs the property descriptions. If <i>ppDescBuffer</i> is a null pointer on input, <b>GetCreationProperties</b> does not return the property descriptions. If *<i>pcPropertyInfoSets</i> is zero on output or an error occurs, the provider does not allocate any memory and ensures that *<i>ppDescBuffer</i> is a null pointer on output.<br>
</p>
<p class=label>
<b>Return Code</b></p>
<p class=indent>
S_OK<br>
The method succeeded. In all DBPROPINFO structures returned by the method, <i>dwFlags</i> is set to a value other than DBPROPFLAGS_NOTSUPPORTED.</p>
<p class=dt>
</p>
<p class=indent>
DB_S_ERRORSOCCURRED<br>
One or more properties specified in <i>rgPropertyIDSets</i> were not supported by the provider. The <i>dwFlags</i> element of the DBPROPINFO structure for such properties is set to DBPROPFLAGS_NOTSUPPORTED.</p>
<p class=tl>
One or more properties specified in <i>rgPropertyIDSets</i> were not in the Data Source Creation, Initialization, or Session property groups. The <i>dwFlags</i> element of the DBPROPINFO structure for such properties is set to DBPROPFLAGS_NOTSUPPORTED.</P><p class=tl>
One or more properties specified in <i>rgPropertyIDSets</i> were in the Initialization property group but could not be used to create data sources. The <i>dwFlags</i> element of the DBPROPINFO structure for such properties is set to DBPROPFLAGS_NOTSUPPORTED.</P><p class=tl>
One or more property sets specified in <i>rgPropertyIDSets</i> were not supported by the provider. The <i>dwFlags</i> element of the DBPROPINFO structure for all specified properties in these sets is set to DBPROPFLAGS_NOTSUPPORTED. If <i>cPropertyIDs</i> in the DBPROPIDSET structure for the property set was zero, the provider cannot set <i>dwStatus</i> in the DBPROP structure because it does not know the IDs of any properties in the property set. Instead, it sets <i>cProperties</i> to zero in the DBPROPSET structure returned for the property set.</P><p class=dt>
</p>
<p class=indent>
E_FAIL<br>
A provider-specific error occurred.</p>
<p class=dt>
</p>
<p class=indent>
E_INVALIDARG<br>
<i>pcPropertyInfoSets</i> or <i>prgPropertyInfoSets</i> was a null pointer.</p>
<p class=tl>
<i>cPropertyIDSets</i> was not equal to zero and <i>rgPropertyIDSets</i> was a null pointer.</P><p class=tl>
In an element of <i>rgPropertyIDSets</i>, <i>cPropertyIDs</i> was not zero and <i>rgPropertyIDs</i> was a null pointer.</P><p class=dt>
</p>
<p class=indent>
E_OUTOFMEMORY<br>
The provider was unable to allocate sufficient memory in which to return the DBPROPINFOSET or DBPROPINFO structures or the property descriptions.</p>
<p class=dt>
</p>
<p class=indent>
DB_E_ERRORSOCCURRED<br>
Values were not returned for any properties. The provider allocates memory for *<i>prgPropertySets</i> and the consumer checks <i>dwStatus</i> in the DBPROP structures to determine why properties were not returned. The consumer frees this memory when it no longer needs the information.<br>
</p>
<p class=label>
<b>Comments</b></p>
<p>
<b>GetCreationProperties</b> returns properties in the Data Source Creation and Session property groups and properties in the Initialization property group that can be used in data source creation. It is possible that there are properties in the Initialization property group that cannot be used in data source creation. The properties for which values must be set to create a data source are indicated in the <i>dwFlags</i> element of the DBPROPINFO structure as DBPROPFLAGS_REQUIRED.</p>
<p>
This method can be called before the data source object has been initialized.<br>
</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="dbadmin_20x1.htm">IDBDataSourceAdmin::CreateDataSource</a></p>
</font></BODY>
</HTML>
