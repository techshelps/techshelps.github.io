<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connection String Syntax</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="connectionstringsyntax"></a>Connection String Syntax</h1>
<p>
A connection string is a string version of the initialization properties needed to connect to a data source and enables you to easily store connection information within your application or pass it between applications. Without a connection string, you would be required to store or pass a complex array of structures to access data.</p>
<p>
In ADO, connection strings are retrieved and set using the ADO <b>ConnectionString</b> property to create a <b>Connection</b> object. When accessing OLE DB directly, using the <a href="msdasc_ref_6605.htm">IDataInitialize</a> interface, the connection string is passed as a parameter to create an OLE DB data source object.</p>
<p>
In some cases, it might be desirable to manually build a connection string within an application. For example, if you want to provide a custom user interface for your users, rather than using the standard data link user interface, then you would manually build the connection string. In these cases, it is important that the connection string syntax adhere to the formatting rules.</p>
<p>
This section includes the following topics:
<ul type=disc>
<li>
Basic Connection String Format<br><br></li>
<li>
The Provider Keyword<br><br></li>
<li>
Specifying a Keyword<br><br></li>
<li>
Setting Keyword Values<br><br></li>
<li>
Listing Keywords Multiple Times<br><br></li>
<li>
Setting the Window Handle Property<br><br></li>
<li>
Format Limitations <br><br></li>
<li>
A Note to Provider Writers</li>
</ul>
<p>
<b>Basic Connection String Format</b></p>
<p>
The basic format of a connection string is based on the ODBC connection string. The string contains a series of keyword/value pairs separated by semicolons. The equals sign (=) separates each keyword and its value.</p>
<p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>keyword1=value; keyword2=value</code></P><p>
<b>The Provider Keyword</b></p>
<p>
The <b>Provider</b> keyword identifies the OLE DB provider to be used. To specify your OLE DB provider, set the <b>Provider</b> keyword to the <i>VersionIndependentProgID</i> of the provider:</p>
<p class=tl>
<B><b>Example</b></B>&nbsp;&nbsp;&nbsp;<code>Provider=MSDASQL</code></P><p>
The value can also be set to the ProgID of the provider, which may have a version attached to it:</p>
<p class=tl>
<B><b>Example</b></B>&nbsp;&nbsp;&nbsp;<code>Provider=MSDASQL.1</code></P><p>
If two versions of a provider are installed on the same system, use the ProgID to specify exactly which version to use. If two versions are installed on a system and the <i>VersionIndependentProgID</i> is specified, the most recent version of the provider is used.</p>
<p>
If no <b>Provider</b> keyword is in the string, the OLE DB Provider for ODBC (MSDASQL) is the default value. This provides backward compatibility with ODBC connection strings. The following ODBC connection string can be passed in and it will successfully connect:</p>
<p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Driver={SQL Server};Server=MyServer;db=pubs;uid=sa;pwd=MyPassword</code></P><p>
If the <b>Provider</b> keyword is specified, but specifies a provider that does not exist or is invalid, the connection string returns an error:</p>
<p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Provider=;Database=MyDatabase</code></P><p>
<b>Specifying a Keyword</b></p>
<p>
To identify a keyword used after the <b>Provider</b> keyword, use the <b>Description</b> property of the OLE DB initialization property that you want to set. Standard OLE DB properties are documented in the <i>OLE DB Programmer's Reference</i> under the OLE DB Initialization property group (DBPROPSET<b><code>_</code></b>DBINIT).</p>
<p>
For example, the <b>Description</b> property of the standard OLE DB initialization property DBPROP_INIT_LOCATION is <b>Location</b>. Thus, to include this property in a connection string, use the keyword <b>Location</b>:</p>
<p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;Location=Pubs</code></P><p>
For more information about OLE DB property groups, see <a href="appcpr_7zcj.htm">Appendix C</a> of the <i>OLE DB Programmer's Reference.</i></p>
<p>
For information about provider-specific initialization properties, see the documentation that came with your provider.</p>
<p>
Keywords can contain any printable character except for the equals sign (=). All of the following examples are correct:</p>
<p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Provider=Microsoft.Jet.OLEDB.3.5.1;Jet OLE DB:System Database=c:\system.mda</code></P><p class=tl>
The keyword is "Jet OLE DB:System Database".</P><p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Provider=Microsoft.Jet.OLEDB.3.5.1;Authentication;Info=Column 5</code></P><p class=tl>
The keyword is "Authentication;Info".</P><p>
If a keyword contains an equals sign (=), it must be preceded by an additional = sign to indicate that it is part of the keyword:</p>
<p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Provider=Microsoft.Jet.OLEDB.3.5.1;Verification==Security=True</code></P><p class=tl>
The keyword is "Verification=Security".</P><p>
If multiple = signs appear, each one must be preceded by an additional = sign:</p>
<p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;Many====One=Valid</code></P><p class=tl>
The keyword is "Many==One".</P><p class=tl>
<b><B>Example</B>&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;TooMany===VARIANT_FALSE</code></P><p class=tl>
The keyword is "TooMany=".</P><p>
<b>Setting Keyword Values</b></p>
<p>
The value of a keyword must be specified using a string format. The value depends on the property being set and the value that the OLE DB provider expects. </p>
<h3>Short Property Values</h3>
<p>
The data link API uses a shortened, "friendlier" version of the property values defined in the OLE DB specification. The short value of a property is derived by removing the prefix from the documented property value and replacing any underscores with spaces. For example, the OLE DB specification defines the following values for the <b>Cache Authentication</b> (DBPROP_AUTH_CACHE_AUTHINFO) property:
<ul type=disc>
<li>
<code>VARIANT_TRUE</code><br><br></li>
<li>
<code>VARIANT_FALSE</code></li>
</ul>
<p>
The prefix "VARIANT_" is removed and the short values are "TRUE" and "FALSE". </p>
<p class=indent>
<b>Tip</b>&nbsp;&nbsp;&nbsp;The short property values are case insensitive; thus the values can be made more readable by using "True" and "False".</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;Location=Pubs;Cache Authentication=True</code></P><p>
Another example is the <b>Prompt</b> (DBPROP_INIT_PROMPT) property for which the OLE DB specification defines the following values: 
<ul type=disc>
<li>
<code>DBPROMPT_PROMPT</code><br><br></li>
<li>
<code>DBPROMPT_COMPLETE</code><br><br></li>
<li>
<code>DBPROMPT_COMPLETEREQUIRED</code><br><br></li>
<li>
<code>DBPROMPT_NOPROMPT</code></li>
</ul>
<p>
Again, the prefix "DBPROMPT_" is removed and mixed case is used for the short values:
<ul type=disc>
<li>
<code>Prompt</code><br><br></li>
<li>
<code>Complete</code><br><br></li>
<li>
<code>CompleteRequired</code><br><br></li>
<li>
<code>NoPrompt</code><p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;Location=Pubs;Prompt=Complete</code></P></li>
</ul>
<p>
Some of the values defined for the <b>Mode</b> (DBPROP_INIT_MODE) property include:
<ul type=disc>
<li>
<code>DB_MODE_SHARE_DENY_READ</code><br><br></li>
<li>
<code>DB_MODE_SHARE_DENY_WRITE</code><br><br></li>
<li>
<code>DB_MODE_SHARE_EXCLUSIVE</code></li>
</ul>
<p>
Note that the underscores after the prefix "DB_MODE_SHARE_" are replaced with spaces in the short values:
<ul type=disc>
<li>
<code>Deny Read</code><br><br></li>
<li>
<code>Deny Write</code><br><br></li>
<li>
<code>Share Exclusive</code></li>
</ul>
<p>
These shortened, "friendlier" property values apply only to those properties that are documented in the OLE DB specification. Note that different OLE DB data providers may use custom properties and/or property values. The <a href="msdasc_ov_84rp.htm">OLE DB Initialization Properties: Quick Reference</a> lists the property description and the short property value (where applicable) for each OLE DB initialization property.</p>
<h3>Setting Numeric Values</h3>
<p>
To set a numeric property value, use either a decimal, hex, or octal value.</p>
<p class=tl>
<b>Examples:</b></P><p class=tl>
<code>Provider= Microsoft.Jet.OLEDB.3.5.1; Window Handle=123</code></P><p class=tl>
<code>Provider= Microsoft.Jet.OLEDB.3.5.1; Window Handle=0x123</code></P><p class=tl>
<code>Provider= Microsoft.Jet.OLEDB.3.5.1; Window Handle=0123</code></P><h3>Setting Values that Use Reserved Characters</h3>
<p>
To include values that contain a semicolon, single-quote character, or double-quote character, the value must be quoted. Typically, the value will be quoted using the double-quote character:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;ExtendedProperties="UID=sa;pwd=sa;Databse=MyDB"</code></P><p>
If the value contains both a semicolon and a double-quote character, the value can be quoted using the single-quote character:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;ExtendedProperties='UID=sa;pwd=sa;Databse="My DB"'</code></P><p class=tl>
The value for the UID keyword is UID=sa;pwd=sa;Databse="My DB".</P><p>
The single-quote is also useful if the value begins with a double-quote character:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=SQLOLEDB;DataSchema='"MyCustTable"'</code></P><p class=tl>
The value for the <b>DataSchema</b> keyword is "MyCustTable".</P><p>
Conversely, the double-quote can be used if the value begins with a single-quote:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=SQLOLEDB;DataSchema="'MyOtherCustTable'"</code></P><p class=tl>
The value is 'MyOtherCustTable'.</P><p>
If the value contains both single- and double-quote characters, the quote character used to surround the value must be doubled each time it occurs within the value:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=SQLOLEDB;NewRecordsCaption='"Company''s "new" customer"'</code></P><p class=tl>
The value is "Company's "new" customer".</P><p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=SQLOLEDB;NewRecordsCaption="""Company''s ""new"" customer"""</code></P><p class=tl>
The value is "Company's "new" customer".</P><p>
Quotes can also be used if the value begins or ends with spaces:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=SQLOLEDB;Database Name=" Badly Named Database "</code></P><h3>Setting Values that Use Spaces</h3>
<p>
Any leading or trailing spaces around a keyword or value are ignored. However, spaces within a keyword or value are allowed and recognized.</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;MyKeyword=My Value</code></P><p class=tl>
The value for the <b>MyKeyword</b> keyword is My<code>[space]</code>Value.</P><p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;MyKeyword= My Value ;MyNextValue=Value</code></P><p class=tl>
The value for the <b>MyKeyword</b> keyword is My<code>[space]</code>Value.</P><p>
To include preceding or trailing spaces in the value, the value must be quoted using either the single or double quote mark.</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;MyKeyword= ' My Value&nbsp; '</code></P><p class=tl>
The value for the <b>MyKeyword</b> keyword is <code>[space]</code>My<code>[space]</code>Value<code>[space][space]</code>.</P><p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;MyKeyword= "&nbsp; My Value "</code></P><p class=tl>
The value for the <b>MyKeyword</b> keyword is <code>[space][space]</code>My<code>[space]</code>Value<code>[space]</code>.</P><p>
There is one exception to this behavior. If the keyword does not correspond to a standard OLE DB Initialization property—in which case, the keyword value is placed in the <b>Extended Properties</b> (DBPROP_INIT_PROVIDERSTRING) property—the spaces around the value will be included in the value. This is done to support backward compatibility for ODBC connection strings.</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Driver=SQL Server;uid= MyName;pwd= MyPassword</code></P><p>
The actual connection string generated would be:</p>
<p class=tl>
<code>Provider=MSDASQL;Extended Properties="Driver=SQL Server;uid= MyName;pwd= MyPassword"</code></P><p class=tl>
The value for the <b>uid</b> keyword is <code>[space]</code>MyName.</P><p class=tl>
The value for the <b>pwd</b> keyword is <code>[space]</code>MyPassword.</P><p>
In this case, the underlying provider can deal with white spaces in its own manner.</p>
<h3>Returning Multiple Values</h3>
<p>
For the OLE DB initialization properties specified in the OLE DB specification that can return multiple values, such as the <b>Mode</b> property, each value returned is separated with a pipe (|) character. The pipe character can have spaces around it or not:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;Mode=Deny Write|Deny Read</code></P><p>
<b>Listing Keywords Multiple Times</b></p>
<p>
If a connection string contains a keyword/value pair multiple times, the last occurrence listed is used in the value set:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;Location=Pubs;Cache Authentication=True;Prompt=DBPROMPT_COMPLETE;Location=Customers</code></P><p class=tl>
In this case, the <b>Location</b> property will be set to <i>Customers</i>.</P><p>
One exception to this is the <b>Provider</b> keyword. If this keyword occurs multiple times in the string, the first occurrence is used:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=MSDASQL;Location=Pubs; Provider=SQLOLEDB</code></P><p class=tl>
In this case, <i>MSDASQL</i> will be used.</P><p>
<b>Setting the Window Handle Property</b></p>
<p>
To set the <b>Window Handle</b> (DBPROP_INIT_HWND) property in a connection string, a long integer value is typically used:</p>
<p class=tl>
<b>Example&nbsp;&nbsp;&nbsp;</b><code>Provider=Microsoft.Jet.OLEDB.3.5.1;Window Handle=14829</code></P><p class=indent>
<b>Note&nbsp;&nbsp;&nbsp;</b>When the string is returned, the <b>Window Handle</b> keyword will not be included in the string because Window Handle is not a property that should be persisted.</p>
<p>
<b>Format Limitations </b></p>
<p>
The connection string format has some limitations on what initialization settings it can persist and set.</p>
<p class=label>
<b>COLID Properties</b></p>
<p class=indent>
The connection string format does not support the ability to persist provider-specific properties that require a COLID for extra information.</p>
<p class=label>
<b>Mathematical Operations</b></p>
<p class=indent>
No mathematical operations will be performed on the value set. For example, setting a property to "2+3" will be set to the constant "2+3". If the property is not a string data type, it will be an illegal value. Similarly, the C technique of joining items together in a logical <b>OR</b> using the pipe (|) character is not allowed:</p>
<p class=tl>
<b>Example</b>&nbsp;&nbsp;&nbsp;<code>Provider=MSDASQL;DBType=3|5</code></P><p class=tl>
<b>Example</b>&nbsp;&nbsp;&nbsp;<code>Provider=MSDASQL;Connection Timeout=(34*23)/8</code></P><p class=tl>
Each of these examples is illegal, assuming the property data types are not string. If they are string, they will be set to the constant specified.</P><p>
<b>A Note to Provider Writers</b></p>
<p>
If you are writing an OLE DB data provider, your implementation is independent of any of the formatting rules for connection strings. OLE DB implements and validates these rules seamlessly for you.</p>
<p class=label>
<b>See Also</b></p>
<p>
<a href="msdasc_ov_2ng7.htm">Data Link API Overview</a></p>
<p>
<a href="msdasc_ov_0kvi.htm">Referencing a Connection String in Your Application</a></p>
<p>
<a href="msdasc_ov_84rp.htm">OLE DB Initialization Properties: Quick Reference</a>, which is taken from <a href="appcpr_7zcj.htm">Appendix C</a> of the <i>OLE DB Programmer's Reference</i>.</p>
</font></BODY>
</HTML>
