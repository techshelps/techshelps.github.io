<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADO Events in ADO/WFC</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdmscadoeventsinjado"></a>ADO Events in ADO/WFC</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscADOEventsInJADO_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscADOEventsInJADO_S">
</object>
<ul type=disc>
<li>
<b>ADO for Windows Foundation Classes (ADO/WFC)</b> builds on the <b>ADO Event</b> <b>Model</b> and presents a simplified application programming interface. <br><br></li>
<li>
In general, ADO/WFC intercepts ADO events, consolidates the event parameters into a single event class, then calls your event handler. </li>
</ul>
<p class=label>
<b>To use ADO Events in ADO/WFC</b>
<ol>
<li>
Define your own event handler method to process an event. For example, if you wanted to process the <b>ConnectComplete</b> event in the <b>ConnectionEvent </b>family, you might use this code:<pre><code>public void onConnectComplete(Object sender,ConnectionEvent e)
{
System.out.println("onConnectComplete:" + e);
}
</code></pre>
</li>
<li>
Define a <i>handler</i> object to represent your event handler method. The handler object should be of data type <b>ConnectEventHandler</b> for an event of type <b>ConnectionEvent</b>, or data type <b>RecordsetEventHandler</b> for an event of type&nbsp; <b>RecordsetEvent</b>. For example, code the following for your <b>ConnectComplete</b> event handler:<pre><code>ConnectionEventHandler handler = 
new ConnectionEventHandler(this, "onConnectComplete");
</code></pre>
<p class=tl>
The first argument of the <b>ConnectionEventHandler</b> constructor is a reference to the class that contains the method named in the second argument.</P><p class=tl>
The Microsoft Visual J++ compiler also supports an equivalent syntax:</P><pre><code>ConnectionEventHandler handler = 
new ConnectionEventHandler(this.onConnectComplete);</code></pre>
<p class=tl>
</P><p class=tl>
The single argument is a reference to the desired class (that is, <b>this</b>) and method within the class (that is, <b>onConnectComplete</b>).</P></li>
<li>
Add your event handler to a list of handlers designated to process a particular type of event. Use the method with a name such as <b>addOn</b><i>EventName</i>(<i>handler</i>). <br><br></li>
<li>
ADO/WFC internally implements all the ADO Event handlers. Therefore, an event caused by a <b>Connection</b> or <b>Recordset</b> operation is intercepted by an ADO/WFC event handler. <p class=tl>
The ADO/WFC event handler passes ADO <b>ConnectionEvent</b> parameters in an instance of the ADO/WFC <b>ConnectionEvent</b> class, or ADO <b>RecordsetEvent</b> parameters in an instance of the ADO/WFC <b>RecordsetEvent</b> class. These ADO/WFC classes consolidate the ADO event parameters; that is, each ADO/WFC class contains one data member for each unique parameter in all the ADO <b>ConnectionEvent</b> or <b>RecordsetEvent</b> methods.&nbsp; </P></li>
<li>
ADO/WFC then calls your event handler with the ADO/WFC event object. For example, your <b>onConnectComplete</b> handler has a signature like this:<pre><code>public void onConnectComplete(Object sender,ConnectionEvent e)</code></pre>
</li>
</ol>
<pre></pre>
<p class=tl>
The first argument is the type of object that sent the event (<b>Connection</b> or <b>Recordset</b>), and the second argument is the ADO/WFC event object (<b>ConnectionEvent</b> or <b>RecordsetEvent</b>).</P><p class=tl>
The signature of your event handler is simpler than an ADO event. However, you must still understand the ADO Event model to know what parameters apply to an event and how to respond. </P><ol start=6>
<li>
Return from your event handler to the ADO/WFC handler for the ADO Event. ADO/WFC copies pertinent ADO/WFC event data members back to the ADO event parameters, then the ADO Event handler returns.<br><br></li>
<li>
When you are finished processing, remove your handler from the list of ADO/WFC event handlers. Use the method with a name such as <b>removeOn</b><i>EventName</i>(<i>handler</i>).</li>
</ol>
</font></BODY>
</HTML>
