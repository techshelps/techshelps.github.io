<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 1: Open a Connection (ADO Tutorial)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="mdhowopenconnection"></a>Step 1: Open a Connection (ADO Tutorial)</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowOpenConnection_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowOpenConnection_S">
</object></p>
<p class=label>
<b>You are Here...</b>
<ul type=disc>
<li>
<b>Make a connection to a data source.</b><br><br></li>
<li>
Optionally, create an object to represent an SQL query<b> </b>command.<br><br></li>
<li>
Optionally, specify values in the SQL command as variable parameters.<br><br></li>
<li>
Execute the command. If the command is row-returning, store the rows in a storage object.<br><br></li>
<li>
Optionally, navigate, examine, manipulate, and edit the data.<br><br></li>
<li>
If appropriate, update the data source with changes from the storage object. Optionally, embed the update in a transaction.<br><br></li>
<li>
If you used a transaction, accept or reject the changes made during the transaction. End the transaction.</li>
</ul>
<p class=label>
<b>Discussion</b></p>
<p>
You require a means to establish the conditions necessary to exchange data; that is, a <i>connection</i>. The data source you connect to is specified in a <i>connection string</i>, although the parameters specified in a connection string may differ for each provider and data source. </p>
<p>
The main way ADO opens a connection is with the <b>Connection.Open</b> method. Alternatively, you can invoke the shortcut method, <b>Recordset.Open</b>, to both open a connection and issue a command over that connection in one operation. Following is the syntax for each method in Visual Basic:</p>
<pre><code>connection.<span class=cfe><b>Open</b></span> <i>ConnectionString</i>, <i>UserID</i>, <i>Password</i>, <i>OpenOptions</i>
recordset.<span class=cfe><b>Open</b></span> <i>Source</i>, <i>ActiveConnection</i>, <i>CursorType</i>, <i>LockType</i>, <i>Options</i>
</code></pre>
<p>
It's helpful to compare these two methods to highlight some useful characteristics of ADO method operands in general. </p>
<p>
ADO provides several convenient ways to specify an operand. For example, <b>Recordset.Open</b> takes an <b>ActiveConnection</b> operand, which could be the literal <b><i>string</i></b>, a variable representing that string, or a <b>Connection</b> object representing an open connection. </p>
<p>
Most methods on an object have properties that can provide an argument if a method operand is omitted. In the case of <b>Connection.Open</b>, you could omit the explicit <b>ConnectionString</b> operand and supply the information implicitly by setting the <b>ConnectionString</b> property to <code>"DSN=pubs;uid=sa;pwd=;database=pubs"</code>.</p>
<p>
Conversely, the <b><i>uid</i></b> and <b><i>pwd</i></b> keyword operands in a connection string can set the <b>Connection</b> object <b>UserID</b> and <b>Password</b> parameters.</p>
<p>
This tutorial invokes the <b>Connection.Open</b> method with an explicit connection string. The data source will be the Open Database Connectivity (ODBC) <b><i>pubs</i></b> database, which ships as a test database with Microsoft SQL Server. (The actual location of the data source—such as a local drive or remote server—is specified when you define the Data Source Name (DSN).)</p>
<pre><code>connection.<span class=cfe><b>Open</b></span> "DSN=pubs;uid=sa;pwd=;database=pubs"
</code></pre>
<p>
<B><b>Next&nbsp;&nbsp;&nbsp;</b></B><a href="mdatut03_7ylg.htm">Step 2</a></p>
</font></BODY>
</HTML>
