<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveConnection Property (ADO MD)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="amproactiveconnection"></a>ActiveConnection Property (ADO MD)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="amproActiveConnection_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="amproActiveConnection_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="amproActiveConnection_A">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="amproActiveConnection_S">
</object></p>
<p>
The <b>ActiveConnection</b> property indicates to which <b>Connection</b> object the current <b>Cellset</b> or <b>Catalog</b> currently belongs.</p>
<p class=label>
<b>Settings and Return Values</b></p>
<p>
<b>ActiveConnection</b> sets or returns a <b>Variant</b> that contains a <b>String</b> defining a connection or <b>Connection</b> object. Default is empty.<b> ActiveConnection</b> is read/write.</p>
<p class=label>
<b>Remarks</b></p>
<p>
You can set this property to a valid ADO <b>Connection</b> object or to a valid connection string. When this property is set to a connection string, the provider creates a new <b>Connection</b> object using this definition and opens the connection. </p>
<p>
If you use the <b>ActiveConnection</b> argument of the <b>Open</b> method to open a <b>Cellset</b> object, the <b>ActiveConnection</b> property will inherit the value of the argument.</p>
<p>
Setting the <b>ActiveConnection</b> property of a <b>Catalog</b> object to <b>Nothing</b> releases the associated data, including data in the <b>CubeDefs</b> collection and any related <b>Dimension</b>, <b>Hierarchy</b>, <b>Level</b>, and <b>Member</b> objects. Closing a <b>Connection</b> object that was used to open a <b>Catalog</b> has the same effect as setting the <b>ActiveConnection</b> property to <b>Nothing</b>.</p>
<p>
An error will occur if you attempt to change the <b>ActiveConnection</b> property for an open <b>Cellset</b> object.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Remember to use the <b>Set</b> keyword when setting the <b>ActiveConnection</b> property to a <b>Connection</b> object. If you omit the <b>Set</b> keyword you will actually be setting the <b>ActiveConnection</b> property equal to the <b>Connection</b> object's default property: <b>ConnectionString</b>. The code will work; however, you will create an additional connection to the data source, which may have negative performance implications.</p>
<p>
To specify a connection string to an OLAP server, the Data Source property should be set to a Data Source name supported by the server. To connect to a cube file that is disconnected from a server, set the Location property to the full path to the .CUB file. In either case, the Provider property should be set to a provider name. For example, the following string connects to a Data Source named Bobs Video Store with a Provider named msolap:</p>
<pre><code>"Data Source=Bobs Video Store;Provider=msolap"
</code></pre>
<p>
The following string connects to a local cube file at the location C:\MSDASDK\samples\oledb\olap\data\bobsvid.cub:</p>
<pre><code>"Location=C:\MSDASDK\samples\oledb\olap\data\bobsvid.cub;Provider=msolap"
</code></pre>
</font></BODY>
</HTML>
