<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 4: Manipulate the Data (ADO Tutorial)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="mdhowmanipulatedata"></a>Step 4: Manipulate the Data (ADO Tutorial)</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowManipulateData_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowManipulateData_S">
</object></p>
<p class=label>
<b>You are Here...</b>
<ul type=disc>
<li>
Make a connection to a data source.<br><br></li>
<li>
Optionally, create an object to represent an SQL query<b> </b>command.<br><br></li>
<li>
Optionally, specify values in the SQL command as variable parameters.<br><br></li>
<li>
Execute the command. If the command is row-returning, store the rows in a storage object.<br><br></li>
<li>
<b>Optionally, navigate, examine, manipulate, and edit the data.</b><br><br></li>
<li>
If appropriate, update the data source with changes from the storage object. Optionally, embed the update in a transaction.<br><br></li>
<li>
If a transaction was used, accept or reject the changes made during the transaction. End the transaction.</li>
</ul>
<p class=label>
<b>Discussion</b></p>
<p>
The bulk of the <b>Recordset</b> object methods and properties are devoted to examining, navigating, and manipulating the rows of <b>Recordset</b> data. </p>
<p>
A <b>Recordset</b> can be thought of as an array of rows. The row you can examine and manipulate at any given time is the <i>current row, </i>and your location in the <b>Recordset</b> is the <i>current row</i> <i>position. </i>Every time you move to another row, that row becomes the new current row. </p>
<p>
Several methods explicitly move or "navigate" through the <b>Recordset </b>(the <b>Move</b> methods). Some methods (the <b>Find</b> method) do so as a side effect of their operation. In addition, setting certain properties (<b>Bookmark</b> property) can also change your row position.</p>
<p>
The <b>Filter</b> property can be applied to control rows you can access (that is, which rows are "visible" to you). The <b>Sort</b> property controls the order in which you navigate the rows of the <b>Recordset</b>. </p>
<p>
A <b>Recordset</b> has a <b>Fields</b> collection, which is the set of <b>Field</b> objects that represent each field, or column, in a row. Assign or retrieve the data for a field from the <b>Field</b> object’s <b>Value</b> property. As an option, you can access field data in bulk (the <b>GetRows</b> and <b>Update</b> methods).</p>
<p>
In this tutorial, you will:
<ul type=disc>
<li>
Assume that telephone numbers in the "<b>415</b>" area code with exchanges starting with "<b>5</b>", are changing to the mythical area code "<b>777</b>."<br><br></li>
<li>
Set the <b>Optimize</b> property of the <b><i>au_lname</i> Field</b> object to improve the performance of sorting and filtering.<br><br></li>
<li>
<b><i>Sort</i></b> the <b>Recordset</b> on each author's last name.<br><br></li>
<li>
<b><i>Filter</i></b> the <b>Recordset</b> so the only accessible (that is, "visible") rows will be those where the author's area code is "<b>415</b>" and exchange begins with "<b>5</b>".</li>
</ul>
<p>
Use the <b>Move</b> methods to navigate from the beginning of the sorted, filtered <b>Recordset</b> to the end. Stop when the <b>Recordset EOF</b> property indicates you've reached the last row. As you move through the <b>Recordset</b>, display the author's first and last name and the original telephone number, then change the area code in the <b><i>phone</i></b> field to "<b>777</b>". (Telephone numbers in the <b><i>phone</i></b> field are of the form "<b>aaa xxx-yyyy</b>" where <b>aaa</b> is the area code and <b>xxx</b> is the exchange.)</p>
<pre><code>rs!au_lname.<span class=cfe><b>Optimize</b></span> = TRUE
rs.<span class=cfe><b>Sort</b></span> = "au_lname ASCENDING"
rs.<span class=cfe><b>Filter</b></span> = "phone LIKE '415 5*'"
rs.<span class=cfe><b>MoveFirst</b></span>
Do While Not rs.<span class=cfe><b>EOF</b></span>
   Debug.Print "Name: " &amp; rs!au_fname &amp; " " rs!au_lname &amp; _
      "Phone: " rs!phone &amp; vbCr
   rs!phone = "777" &amp; Mid(rs!phone, 5, 11)
   rs.<span class=cfe><b>MoveNext</b></span>
Loop
</code></pre>
<p>
<B><b>Next&nbsp;&nbsp;&nbsp;</b></B><a href="mdatut03_3p7l.htm">Step 5</a></p>
</font></BODY>
</HTML>
