<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenSchema Method (ADO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdmthopenschema"></a>OpenSchema Method (ADO)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthOpenSchema_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthOpenSchema_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthOpenSchema_A">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthOpenSchema_S">
</object></p>
<p>
Obtains database schema information from the provider.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Set </b><i>recordset</i> = <i>connection</i><b>.OpenSchema</b> <b>(<i>QueryType</i></b>, <b><i>Criteria</i></b>, <b><i>SchemaID</i>)</b></p>
<p class=label>
<b>Return Values</b></p>
<p>
Returns a <b>Recordset</b> object that contains schema information. The <b>Recordset</b> will be opened as a read-only, static cursor.</p>
<p class=label>
<b>Parameters</b></p>
<p>
<b><i>QueryType&nbsp;&nbsp;&nbsp;</i></b>The type of schema query to run. Can be any of the constants listed below.</p>
<p>
<b><i>Criteria&nbsp;&nbsp;&nbsp;</i></b>Optional. An array of query constraints for each <b><i>QueryType</i></b> option, as listed below.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b><i>QueryType</i> values</b></td>
<td class=label width=50%><b><i>Criteria</i> values</b></td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaAsserts</b></td>
<td width=50%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaCatalogs</b></td>
<td width=50%>CATALOG_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaCharacterSets</b></td>
<td width=50%>CHARACTER_SET_CATALOG<br>
CHARACTER_SET_SCHEMA<br>
CHARACTER_SET_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaCheckConstraints</b></td>
<td width=50%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaCollations</b></td>
<td width=50%>COLLATION_CATALOG<br>
COLLATION_SCHEMA<br>
COLLATION_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaColumnDomainUsage</b></td>
<td width=50%>DOMAIN_CATALOG<br>
DOMAIN_SCHEMA<br>
DOMAIN_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaColumnPrivileges</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME<br>
GRANTOR<br>
GRANTEE</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaColumns</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaConstraintColumnUsage</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaConstraintTableUsage</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaForeignKeys</b></td>
<td width=50%>PK_TABLE_CATALOG<br>
PK_TABLE_SCHEMA<br>
PK_TABLE_NAME<br>
FK_TABLE_CATALOG<br>
FK_TABLE_SCHEMA<br>
FK_TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaIndexes</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
INDEX_NAME<br>
TYPE<br>
TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaKeyColumnUsage</b></td>
<td width=50%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME<br>
TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaPrimaryKeys</b></td>
<td width=50%>PK_TABLE_CATALOG<br>
PK_TABLE_SCHEMA<br>
PK_TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaProcedureColumns</b></td>
<td width=50%>PROCEDURE_CATALOG<br>
PROCEDURE_SCHEMA<br>
PROCEDURE_NAME<br>
COLUMN_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaProcedureParameters</b></td>
<td width=50%>PROCEDURE_CATALOG<br>
PROCEDURE_SCHEMA<br>
PROCEDURE_NAME<br>
PARAMTER_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaProcedures</b></td>
<td width=50%>PROCEDURE_CATALOG<br>
PROCEDURE_SCHEMA<br>
PROCEDURE_NAME<br>
PARAMTER_TYPE</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaProviderSpecific</b></td>
<td width=50%>See Remarks</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaProviderTypes</b></td>
<td width=50%>DATA_TYPE<br>
BEST_MATCH</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaReferentialConstraints</b></td>
<td width=50%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaSchemata</b></td>
<td width=50%>CATALOG_NAME<br>
SCHEMA_NAME<br>
SCHEMA_OWNER</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaSQLLanguages</b></td>
<td width=50%>&lt;none&gt;</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaStatistics</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaTableConstraints</b></td>
<td width=50%>CONSTRAINT_CATALOG<br>
CONSTRAINT_SCHEMA<br>
CONSTRAINT_NAME<br>
TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
CONSTRAINT_TYPE</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaTablePrivileges</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
GRANTOR<br>
GRANTEE</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaTables</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME<br>
TABLE_TYPE</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaTranslations</b></td>
<td width=50%>TRANSLATION_CATALOG<br>
TRANSLATION_SCHEMA<br>
TRANSLATION_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaUsagePrivileges</b></td>
<td width=50%>OBJECT_CATALOG<br>
OBJECT_SCHEMA<br>
OBJECT_NAME<br>
OBJECT_TYPE<br>
GRANTOR<br>
GRANTEE</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaViewColumnUsage</b></td>
<td width=50%>VIEW_CATALOG<br>
VIEW_SCHEMA<br>
VIEW_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaViewTableUsage</b></td>
<td width=50%>VIEW_CATALOG<br>
VIEW_SCHEMA<br>
VIEW_NAME</td>
</tr>
<tr valign=top>
<td width=50%><b>adSchemaViews</b></td>
<td width=50%>TABLE_CATALOG<br>
TABLE_SCHEMA<br>
TABLE_NAME</td>
</tr>
</table><br>
<p>
<b><i>SchemaID&nbsp;&nbsp;&nbsp;</i></b>The GUID for a provider-schema schema query not defined by the OLE DB specification. This parameter is required if <b><i>QueryType</i></b> is set to <b>adSchemaProviderSpecific</b>; otherwise, it is not used.</p>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>OpenSchema</b> method returns information about the data source, such as information about the tables on the server and the columns in the tables.</p>
<p>
The <b><i>Criteria</i></b> argument is an array of values that can be used to limit the results of a schema query. Each schema query has a different set of parameters that it supports. The actual schemas are defined by the OLE DB specification under the <b>IDBSchemaRowset</b> interface. The ones supported in ADO are listed above.</p>
<p>
The constant <b>adSchemaProviderSpecific</b> is used for the <b><i>QueryType</i></b> argument if the provider defines its own nonstandard schema queries outside those listed above. When this constant is used, the <b><i>SchemaID</i></b> argument is required to pass the GUID of the schema query to execute. If <b><i>QueryType</i></b> is set to <b>adSchemaProviderSpecific</b> but <b><i>SchemaID</i></b> is not provided, an error will result.</p>
<p>
Providers are not required to support all of the OLE DB standard schema queries. Specifically, only <b>adSchemaTables</b>, <b>adSchemaColumns</b>, and <b>adSchemaProviderTypes</b> are required by the OLE DB specification. However, the provider is not required to support the <b><i>Criteria</i></b> constraints listed above for those schema queries.</p>
<p class=indent>
<B><b>Remote Data Service Usage&nbsp;&nbsp;&nbsp;</b></B>The <b>OpenSchema</b> method is not available on a client-side <b>Connection</b> object.</p>
</font></BODY>
</HTML>
