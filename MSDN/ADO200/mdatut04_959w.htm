<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RDS Tutorial (VBScript)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="mdhowrdstutorialvbscript"></a>RDS Tutorial (VBScript)</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowRDSTutorialVBScript_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowRDSTutorialVBScript_S">
</object></p>
<p>
This is a restatement of the RDS Tutorial, written in Microsoft Visual Basic, Scripting Edition.</p>
<p>
In this tutorial, <b>RDS.DataControl</b> and <b>RDS.DataSpace</b> are created at <i>design time—</i> that is, they are defined with object tags, like this: <code>&lt;OBJECT&gt;...&lt;/OBJECT&gt;</code>. Alternatively, they could be created at <i>run time</i> with the <b>Server.CreateObject</b> method. For example, the <b>RDS.DataControl</b> object could be created like this: </p>
<p>
<code>Set DC = <span class=cfe><b>Server.CreateObject</b></span>("RDS.DataControl")</code></p>
<pre><code>&lt;!-- RDS.DataControl --&gt;
&lt;OBJECT 
ID="DC1" CLASSID="CLSID:BD96C556-65A3-11D0-983A-00C04FC29E33"&gt;
&lt;/OBJECT&gt;

&lt;!-- RDS.DataSpace --&gt;
&lt;OBJECT 
ID="DS1" WIDTH=1 HEIGHT=1
CLASSID="CLSID:BD96C556-65A3-11D0-983A-00C04FC29E36"&gt;
&lt;/OBJECT&gt;

&lt;SCRIPT LANGUAGE="VBScript"&gt;

Sub RDSTutorial()
Dim DF1 as Object
</code></pre>
<p class=label>
<b>Step 1—Specify a server program </b></p>
<p>
VBScript can discover the name of the IIS Web server it is running on by accessing the VBScript <b>Request.ServerVariables</b> method available to Active Server Pages:</p>
<pre><code>"http://&lt;%=Request.ServerVariables("SERVER_NAME")%&gt;"
</code></pre>
<p>
However, for this tutorial, use the imaginary server, "yourServer".</p>
<p class=indent>
<b>Note</b>&nbsp;&nbsp;&nbsp;Pay attention to the data type of <b>ByRef</b> arguments. VBScript does not let you specify the variable type, so you must always pass a Variant. When using HTTP, RDS will allow you to pass a Variant to a method that expects a non-Variant if you invoke it with the <b>RDS.DataSpace</b> object <b>CreateObject</b> method. When using DCOM or an in-process server, match the parameter types on the client and server sides or you will receive a "Type Mismatch" error.</p>
<pre><code>Set DF1 = DS1.CreateObject("RDSServer.DataFactory", "http://yourServer")
</code></pre>
<p class=label>
<b>Step 2a—Invoke the server program with RDS.DataControl </b></p>
<p>
This example is merely a comment demonstrating that the default behavior of the <b>RDS.DataControl </b>is to perform the specified query.</p>
<pre><code>&lt;OBJECT CLASSID="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33" ID="DC1"&gt;
&lt;PARAM NAME="SQL" VALUE="SELECT * FROM authors"&gt;
&lt;PARAM NAME="Connect" VALUE="DSN=Pubs;"&gt;
&lt;PARAM NAME="Server" VALUE="http://YourServer/"&gt;
&lt;/OBJECT&gt;
...
&lt;SCRIPT LANGUAGE="VBScript"&gt;

Sub RDSTutorial2A()
Dim RS as New ADODB.Recordset
DC1.Refresh
Set RS = DC1.Recordset
...
</code></pre>
<p class=label>
<b>Step 2b—Invoke the server program with RDSServer.DataFactory</b></p>
<p class=label>
<b>Step 3—Server obtains a Recordset </b></p>
<p class=label>
<b>Step 4—Server returns the Recordset </b></p>
<pre><code>Set RS = DF1.Query("DSN=pubs", "SELECT * FROM authors")
</code></pre>
<p class=label>
<b>Step 5—DataControl is made usable by visual controls</b></p>
<pre><code>' Assign the returned recordset to the DataControl.

DC1.SourceRecordset = RS
</code></pre>
<p class=label>
<b>Step 6a—Changes are sent to the server with RDS.DataControl</b></p>
<p>
This example is merely a comment demonstrating how the <b>RDS.DataControl</b> performs updates.</p>
<pre><code>&lt;OBJECT CLASSID="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33" ID="DC1"&gt;
&lt;PARAM NAME="SQL" VALUE="SELECT * FROM authors"&gt;
&lt;PARAM NAME="Connect" VALUE="DSN=Pubs;"&gt;
&lt;PARAM NAME="Server" VALUE="http://YourServer/"&gt;
&lt;/OBJECT&gt;
...
&lt;SCRIPT LANGUAGE="VBScript"&gt;

Sub RDSTutorial6A()
Dim RS as New ADODB.Recordset
DC1.Refresh
...
Set RS = DC1.Recordset
' Edit the Recordset object...
' The SERVER and CONNECT properties are already set from Step 2A.
Set DC1.SourceRecordset = RS
...
DC1.SubmitChanges
</code></pre>
<p class=label>
<b>Step 6b—Changes are sent to the server with RDSServer.DataFactory</b></p>
<pre><code>DF.SubmitChanges<span class=cfe><b> </b></span>"DSN=pubs", RS

End Sub
&lt;/SCRIPT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>
<p>
<b>This is the end of the tutorial. </b></p>
</font></BODY>
</HTML>
