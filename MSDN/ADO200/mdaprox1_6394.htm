<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Count Property Example</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdprocountx"></a>Count Property Example</h1>
<p>
This example demonstrates the <b>Count</b> property with two collections in the Employee database. The property obtains the number of objects in each collection, and sets the upper limit for loops that enumerate these collections. Another way to enumerate these collections without using the <b>Count</b> property would be to use <code>For Each...Next</code> statements.</p>
<pre><code>Public Sub CountX()

   Dim rstEmployees As ADODB.Recordset
   Dim strCnn As String
   Dim intloop As Integer

   ' Open recordset with data from Employee table.
   strCnn = "Provider=sqloledb;" &amp; _
      "Data Source=srv;Initial Catalog=pubs;User Id=sa;Password=; "
   Set rstEmployees = New ADODB.Recordset
   rstEmployees.Open "employee", strCnn, , , adCmdTable

   ' Print information about Fields collection.
   Debug.Print rstEmployees.Fields.<span class=cfe><b>Count</b></span> &amp; _
      " Fields in Employee"
   For intloop = 0 To rstEmployees.Fields.<span class=cfe><b>Count</b></span> - 1
      Debug.Print "   " &amp; rstEmployees.Fields(intloop).Name
   Next intloop

   ' Print information about Properties collection.
   Debug.Print rstEmployees.Properties.<span class=cfe><b>Count</b></span> &amp; _
      " Properties in Employee"
   For intloop = 0 To rstEmployees.Properties.<span class=cfe><b>Count</b></span> - 1
      Debug.Print "   " &amp; rstEmployees.Properties(intloop).Name
   Next intloop

   rstEmployees.Close

End Sub</code></pre>
</font></BODY>
</HTML>
