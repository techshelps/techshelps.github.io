<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 6: Changes are Sent to the Server (RDS Tutorial)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h3><a name="mdhowstep6changessenttoserver"></a>Step 6: Changes are Sent to the Server (RDS Tutorial)</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowStep6ChangesSentToServer_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowStep6ChangesSentToServer_S">
</object></p>
<p class=label>
<b>You are Here...</b>
<ul type=disc>
<li>
Specify the program to be invoked on the server, and obtain a proxy.<br><br></li>
<li>
Invoke the server program. Pass parameters to the server program that identify the data source and the command to issue. <br><br></li>
<li>
The server program obtains a <b>Recordset</b> object from the data source, typically by using ADO. <br><br></li>
<li>
The server program returns the final <b>Recordset</b> object to the client application. <br><br></li>
<li>
On the client, the <b>Recordset</b> object is optionally put into a form that can be easily used by visual controls. <br><br></li>
<li>
<b>Changes to the Recordset object are sent back to the server and used to update the data source. </b></li>
</ul>
<p class=label>
<b>Discussion</b></p>
<p>
If the <b>Recordset</b> object is edited, any changes (that is, rows that are added, changed, or deleted) can be sent back to the server. </p>
<p class=indent>
<b>Note</b>&nbsp;&nbsp;&nbsp;The default behavior of RDS can be invoked implicitly with ADO objects and the MS Remote provider. Queries can return recordsets, and edited recordsets can update the data source. This tutorial doesn't invoke RDS with ADO objects, but this is how it would look if it did:</p>
<pre><code>Dim rs as New ADODB.Recordset
rs.<span class=cfe><b>Open</b></span> "SELECT * FROM authors", "<span class=cfe><b>Provider</b></span>=MS Remote;<span class=cfe><b>Data Source</b></span>=pubs;<span class=cfe><b>Remote Server</b></span>=http://YourServer"
...            'Edit the recordset
rs.<span class=cfe><b>UpdateBatch</b></span>    'The equivalent of <span class=cfe><b>SubmitChanges</b></span>
...</code></pre>
<p>
<b>Part A</b>&nbsp;&nbsp;&nbsp;Assume for this case that you have only used the <b>RDS.DataControl</b> and that a <b>Recordset</b> object is now associated with the <b>RDS.DataControl</b>. The <b>SubmitChanges</b> method updates the data source with any changes to the <b>Recordset</b> object if the <a href="mdapro06_73jk.htm">Server</a> and <a href="mdapro02_75f4.htm">Connect</a> properties are still set. </p>
<pre><code>Sub RDSTutorial6A()
Dim DC as New RDS.DataControl
Dim RS as New ADODB.Recordset   'Optionally, ADOR.Recordset
DC.<span class=cfe><b>Server</b></span> = "http://yourServer"
DC.<span class=cfe><b>Connect</b></span> = "DSN=pubs"
DC.<span class=cfe><b>SQL</b></span> = "SELECT * FROM authors"
DC.<span class=cfe><b>Refresh</b></span>
...
Set RS = DC.<span class=cfe><b>Recordset</b></span>
...                           'Edit the Recordset
...
DC.<span class=cfe><b>SubmitChanges</b></span>
...
</code></pre>
<p>
<b>Part B</b>&nbsp;&nbsp;&nbsp;Alternatively, you could update the server with the <b>RDSServer.DataFactory</b> object, specifying a connection and a <b>Recordset</b> object.</p>
<pre><code>Sub RDSTutorial6B()
Dim DS as New RDS.DataSpace
Dim RS as New ADODB.Recordset   'Optionally, ADOR.Recordset
Dim DC as New RDS.DataControl
Dim DF as Object
Set DF = DS.<span class=cfe><b>CreateObject</b></span>("RDSServer.DataFactory", "http://yourServer")
Set RS = DF.<span class=cfe><b>Query</b></span> ("DSN=pubs", "SELECT * FROM authors")
DC.<span class=cfe><b>SourceRecordset</b></span> = RS         'Visual controls can now bind to DC.
...                           'Edit the Recordset
blnStatus = DF.<span class=cfe><b>SubmitChanges </b></span>"DSN=pubs", RS
</code></pre>
<p>
<b>This is the end of the tutorial. </b></p>
</font></BODY>
</HTML>
