<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FilterColumn, FilterCriterion, FilterValue, SortColumn, and SortDirection Properties and Reset Method Example</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdprosortfilterx"></a>FilterColumn, FilterCriterion, FilterValue, SortColumn, and SortDirection Properties and Reset Method Example</h1>
<p>
The following code shows how to set the <b>RDS.DataControl</b> <b>Server</b> parameter at design time and bind it to a data-aware control using an ODBC data source called <i>Pubs</i>. Pubs ships with SQL Server 6.5. To try the example you will need rich text controls named txtSortcolumn, txtSortdirection, txtFiltercolumn, txtCriterion, and txtFilterValue, and an HTML Form Input Button named SortFilter.</p>
<pre><code>&lt;OBJECT CLASSID="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33"
ID=ADC HEIGHT=10 WIDTH=10&gt;
&lt;PARAM NAME="SQL" VALUE="Select * from Sales "&gt;
&lt;PARAM NAME="SERVER" VALUE="http://<span class=cfe><b>MyWebServer</b></span>"&gt;
&lt;PARAM NAME="CONNECT" VALUE="dsn=pubs;UID=sa;PWD=;"&gt;
&lt;/OBJECT&gt;

&lt;!-- Sheridan Grid --&gt;
&lt;Object CLASSID="clsid:AC05DC80-7DF1-11d0-839E-00A024A94B3A"
   CODEBASE="http://<span class=cfe><b>MyWebServer</b></span>
/MSADC/Samples/Sheridan.cab"
   ID=GRID1 
      datasrc=#ADC 
      HEIGHT=125 
      WIDTH=495&gt;
   &lt;PARAM NAME="AllowAddNew" VALUE="TRUE"&gt;
   &lt;PARAM NAME="AllowDelete" VALUE="TRUE"&gt;
   &lt;PARAM NAME="AllowUpdate" VALUE="TRUE"&gt;
   &lt;PARAM NAME="BackColor"&nbsp;&nbsp; VALUE="-2147483643"&gt;
   &lt;PARAM NAME="BackColorOdd"&nbsp; VALUE="-2147483643"&gt;
   &lt;PARAM NAME="ForeColorEven" VALUE="0"&gt;
&lt;/OBJECT&gt;

&lt;Script Language="VBScript"&gt;
&lt;!--
Sub SortFilter_OnClick

   ' Set the values. txtSortcolumn is a rich text box
   ' control. The value of SortColumn will be the text
   ' value of what the user specifies in the
   ' txtSortcolumn box.
   If(txtSortcolumn.text &lt;&gt; "") then
      ADC.<span class=cfe><b>SortColumn</b></span> = txtSortcolumn.text
   End If

   ' txtSortdirection is a rich text box
   ' control. The value of SortDirection will be the 
   ' text value of what the user specifies in the
   ' txtSortdirection box.
   Select Case UCASE(txtSortDirection.text)
   Case "TRUE"
      ADC.<span class=cfe><b>SortDirection</b></span> = TRUE
   Case "FALSE"
      ADC.SortDirection = FALSE
   Case Else
      MsgBox "Only true or false are accepted for sort direction"
   End Select

   ' txtFiltercolumn is a rich text box
   ' control. The value of FilterColumn will be the 
   ' text value of what the user specifies in the
   ' txtFiltercolumn box.
   If (txtFiltercolumn.text &lt;&gt; "") Then
      ADC.<span class=cfe><b>FilterColumn</b></span> = txtFiltercolumn.text
   End If

   ' txtCriterion is a rich text box
   ' control. The value of FilterCriterion will be the 
   ' text value of what the user specifies in the
   ' txtCriterion box.
   If (txtCriterion.text &lt;&gt; "") Then
      ADC.<span class=cfe><b>FilterCriterion </b></span>= txtCriterion.text
   End If

   ' txtFilterValue is a rich text box
   ' control. The value of FilterValue will be the 
   ' text value of what the user specifies in the
   ' txtFilterValue box.
   If (txtFilterValue.text &lt;&gt; "") Then
      ADC.<span class=cfe><b>FilterValue</b></span> = txtFilterValue.text
   End If

   ' Execute the sort and filter on a client-side
   ' Recordset based on the specified sort and filter
   ' properties. Calling Reset refreshes the result set
   ' that is displayed in the data-bound controls to
   ' display the filtered, sorted recordset.
   ADC.<span class=cfe><b>Reset</b></span>

End Sub
--&gt;
&lt;/Script&gt;
</code></pre>
</font></BODY>
</HTML>
