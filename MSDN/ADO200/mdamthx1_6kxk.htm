<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MoveFirst, MoveLast, MoveNext, and MovePrevious Methods Example</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdmthmovefirstx"></a>MoveFirst, MoveLast, MoveNext, and MovePrevious Methods Example</h1>
<p>
This example uses the <b>MoveFirst</b>, <b>MoveLast</b>, <b>MoveNext</b>, and <b>MovePrevious </b>methods to move the record pointer of a <b>Recordset </b>based on the supplied command. The MoveAny procedure is required for this procedure to run.</p>
<pre><code>Public Sub MoveFirstX()

   Dim rstAuthors As ADODB.Recordset
   Dim strCnn As String
   Dim strMessage As String
   Dim intCommand As Integer

   ' Open recordset from Authors table.
      strCnn = "Provider=sqloledb;" &amp; _
      "Data Source=srv;Initial Catalog=pubs;User Id=sa;Password=; "
   Set rstAuthors = New ADODB.Recordset
   rstAuthors.CursorType = adOpenStatic
   ' Use client cursor to enable AbsolutePosition property.
   rstAuthors.CursorLocation = adUseClient
   rstAuthors.Open "authors", strCnn, , , adCmdTable

   ' Show current record information and get user's method choice.
   Do While True

      strMessage = "Name: " &amp; rstAuthors!au_fName &amp; " " &amp; _
         rstAuthors!au_lName &amp; vbCr &amp; "Record " &amp; _
         rstAuthors.AbsolutePosition &amp; " of " &amp; _
         rstAuthors.RecordCount &amp; vbCr &amp; vbCr &amp; _
         "[1 - MoveFirst, 2 - MoveLast, " &amp; vbCr &amp; _
         "3 - MoveNext, 4 - MovePrevious]"
      intCommand = Val(Left(InputBox(strMessage), 1))
      If intCommand &lt; 1 Or intCommand &gt; 4 Then Exit Do

      ' Call method based on user's input.
      MoveAny intCommand, rstAuthors
   Loop
   rstAuthors.Close

End Sub

Public Sub MoveAny(intChoice As Integer, _
   rstTemp As Recordset)

   ' Use specified method, trapping for BOF and EOF.
   Select Case intChoice
      Case 1
         rstTemp.MoveFirst
      Case 2
         rstTemp.MoveLast
      Case 3
         rstTemp.MoveNext
         If rstTemp.EOF Then
            MsgBox "Already at end of recordset!"
            rstTemp.MoveLast
         End If
      Case 4
         rstTemp.MovePrevious
         If rstTemp.BOF Then
            MsgBox "Already at beginning of recordset!"
            rstTemp.MoveFirst
         End If
   End Select

End Sub
</code></pre>
<h2>VBScript Version</h2>
<p>
Here is the same example written in VBScript to be used in an Active Server Page (ASP). To view this fully functional example, you need to create a system Data Source Name (DSN) called AdvWorks using the data source AdvWorks.mdb installed with IIS and located at C:\InetPub\ASPSamp\AdvWorks. This is a Microsoft Access database file. Use <b>Find</b> to locate the file Adovbs.inc and place it in the directory you plan to use. Cut and paste the following code to Notepad or another text editor and save it as MoveOne.asp. You can view the result in any client browser.</p>
<p>
Try moving beyond the upper or lower limits of the recordset to see error handling work.</p>
<pre><code>&lt;!-- #Include file="ADOVBS.INC" --&gt;
&lt;% Language = VBScript %&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;TITLE&gt;ADO MoveNext MovePrevious MoveLast MoveFirst Methods&lt;/TITLE&gt;&lt;/HEAD&gt;
&lt;BODY&gt; 
&lt;FONT FACE="MS SANS SERIF" SIZE=2&gt;
&lt;Center&gt;
&lt;H3&gt;ADO Methods&lt;BR&gt;MoveNext MovePrevious MoveLast MoveFirst&lt;/H3&gt;
&lt;!-- Create Connection and Recordset Objects on Server --&gt;
&lt;%
 'Create and Open Connection Object
Set OBJdbConnection = Server.CreateObject("ADODB.Connection") 
OBJdbConnection.Open "AdvWorks" 
'Create and Open Recordset Object
Set RsCustomerList = Server.CreateObject("ADODB.Recordset")
RsCustomerList.ActiveConnection = OBJdbConnection
RsCustomerList.CursorType = adOpenKeyset
RsCustomerList.LockType = adLockOptimistic
RsCustomerList.Source = "Customers"

RsCustomerList.Open

' Check Request.Form collection to see if any moves are recorded

If Not IsEmpty(Request.Form("MoveAmount")) Then
'Keep track of the number and direction of moves this session
   
   Session("Moves") = Session("Moves") + Request.Form("MoveAmount")
   
   Clicks = Session("Moves")
'Move to last known position
   RsCustomerList.Move CInt(Clicks)
'Check if move is + or - and do error checking
      If CInt(Request.Form("MoveAmount")) = 1 Then
      
         If RsCustomerList.EOF Then
            Session("Moves") = RsCustomerList.RecordCount
            RsCustomerList.MoveLast
         End If   

         RsCustomerList.MoveNext
      End If

      If Request.Form("MoveAmount") &lt; 1 Then
         
         RsCustomerList.MovePrevious
      End If
'Check if First Record or Last Record Command Buttons Clicked
      If Request.Form("MoveLast") = 3 Then
         RsCustomerList.MoveLast
         Session("Moves") = RsCustomerList.RecordCount
      End If
      If Request.Form("MoveFirst") = 2 Then
         RsCustomerList.MoveFirst
         Session("Moves") = 1
      End If
   
   
End If
' Do Error checking for combination of Move Button clicks
      If RsCustomerList.EOF Then
         Session("Moves") = RsCustomerList.RecordCount
         RsCustomerList.MoveLast
         Response.Write "This is the Last Record"
         End If   
   
      If RsCustomerList.BOF Then
         Session("Moves") = 1
         RsCustomerList.MoveFirst
         Response.Write "This is the First Record"
      End If
   

%&gt;

&lt;H3&gt;Current Record Number is &lt;BR&gt;
&lt;!-- Display Current Record Number and Recordset Size --&gt;
&lt;% If IsEmpty(Session("Moves"))&nbsp; Then 
Session("Moves") = 1
End If
%&gt;

&lt;%Response.Write(Session("Moves") )%&gt; of &lt;%=RsCustomerList.RecordCount%&gt;&lt;/H3&gt;
&lt;HR&gt;


&lt;Center&gt;&lt;TABLE COLSPAN=8 CELLPADDING=5 BORDER=0&gt;

&lt;!-- BEGIN column header row for Customer Table--&gt;

&lt;TR&gt;&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;Company Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;Contact Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER WIDTH=150 BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;Phone Number&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;City&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;State/Province&lt;/FONT&gt;
&lt;/TD&gt;&lt;/TR&gt;

&lt;!--Display ADO Data from Customer Table--&gt;

  &lt;TR&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt; 
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RSCustomerList("CompanyName")%&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RScustomerList("ContactLastName") &amp; ", " %&gt; 
  &lt;%= RScustomerList("ContactFirstName") %&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt;
 &nbsp; 
  &lt;%= RScustomerList("PhoneNumber")%&gt; 
 &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RScustomerList("City")%&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RScustomerList("StateOrProvince")%&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;
  &lt;/TR&gt; &lt;/Table&gt;&lt;/FONT&gt;


&lt;HR&gt;
&lt;Input Type = Button Name = cmdDown&nbsp; Value = "&lt;  "&gt;
&lt;Input Type = Button Name = cmdUp Value = "&nbsp; &gt;"&gt;
&lt;BR&gt;
&lt;Input Type = Button Name = cmdFirst Value = "First Record"&gt;

&lt;Input Type = Button Name = cmdLast Value = "Last Record"&gt;
&lt;H5&gt;Click Direction Arrows to Use MovePrevious or MoveNext 
&lt;BR&gt; &lt;/H5&gt;

&lt;!-- Use Hidden Form Fields to send values to Server --&gt;

&lt;Form Method = Post Action="MoveOne.asp" Name=Form&gt;
&lt;Input Type="Hidden" Size="4" Name="MoveAmount" Value = 0&gt;
&lt;Input Type="Hidden" Size="4" Name="MoveLast" Value = 0&gt;
&lt;Input Type="Hidden" Size="4" Name="MoveFirst" Value = 0&gt;
&lt;/Form&gt;&lt;/BODY&gt;

&lt;Script Language = "VBScript"&gt;

Sub cmdDown_OnClick
'Set Values in Form Input Boxes and Submit Form
   Document.Form.MoveAmount.Value = -1
   Document.Form.Submit
End Sub

Sub cmdUp_OnClick

   Document.Form.MoveAmount.Value = 1
   Document.Form.Submit

End Sub

Sub cmdFirst_OnClick

   Document.Form.MoveFirst.Value = 2
   Document.Form.Submit

End Sub

Sub cmdLast_OnClick

   Document.Form.MoveLast.Value = 3
   Document.Form.Submit

End Sub
&lt;/Script&gt;&lt;/HTML&gt;
</code></pre>
</font></BODY>
</HTML>
