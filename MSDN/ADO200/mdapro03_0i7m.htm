<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Filter Property (ADO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdprofilter"></a>Filter Property (ADO)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproFilter_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproFilter_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproFilter_A">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproFilter_S">
</object></p>
<p>
Indicates a filter for data in a <a href="mdaobj01_2zdv.htm">Recordset</a>.</p>
<p class=label>
<b>Settings and Return Values</b></p>
<p>
Sets or returns a <b>Variant</b> value, which can contain one of the following:
<ul type=disc>
<li>
Criteria string—a string made up of one or more individual clauses concatenated with <b>AND</b><code> </code>or <b>OR</b> operators.<br><br></li>
<li>
Array of bookmarks—an array of unique bookmark values that point to records in the <b>Recordset</b> object.<br><br></li>
<li>
One of the following <b>FilterGroupEnum</b> values.<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=571>
<tr valign=top>
<td class=label width=38%><b>Constant</b></td>
<td class=label width=62%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterNone</b></td>
<td width=62%>Removes the current filter and restores all records to view.</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterPendingRecords</b></td>
<td width=62%>Allows you to view only records that have changed but have not yet been sent to the server. Applicable only for batch update mode.</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterAffectedRecords</b></td>
<td width=62%>Allows you to view only records affected by the last <a href="mdamth02_5rvp.htm">Delete</a>, <a href="mdamth03_2vs3.htm">Resync</a>, <a href="mdamth03_3hrc.htm">UpdateBatch</a>, or <a href="mdamth01_03vs.htm">CancelBatch</a> call.</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterFetchedRecords</b></td>
<td width=62%>Allows you to view records in the current cache—that is, the results of the last call to retrieve records from the database.</td>
</tr>
<tr valign=top>
<td width=38%><b>adFilterConflictingRecords</b></td>
<td width=62%>Allows you to view the records that failed the last batch update attempt.</td>
</tr>
</table><br>
</li>
</ul>
<p class=label>
<b>Remarks</b></p>
<p>
Use the <b>Filter</b> property to selectively screen out records in a <b>Recordset</b> object. The filtered <b>Recordset</b> becomes the current cursor. This affects other properties such as <a href="mdapro01_6n8z.htm">AbsolutePosition</a>, <a href="mdapro01_436t.htm">AbsolutePage</a>, <a href="mdapro05_1aes.htm">RecordCount</a>, and <a href="mdapro05_9790.htm">PageCount</a> that return values based on the current cursor, because setting the <b>Filter</b> property to a specific value will move the current record to the first record that satisfies the new value.</p>
<p>
The criteria string is made up of clauses in the form <i>FieldName-Operator-Value</i> (for example, "<code>LastName = 'Smith'</code>"). You can create compound clauses by concatenating individual clauses with <b>AND</b> (for example, "<code>LastName = 'Smith' AND FirstName = 'John'</code>") or <b>OR</b> (for example, <code>"LastName = 'Smith' OR LastName = 'Jones'"</code>). Use the following guidelines for criteria strings:
<ul type=disc>
<li>
<i>FieldName</i> must be a valid field name from the <b>Recordset</b>. If the field name contains spaces, you must enclose the name in square brackets.<br><br></li>
<li>
<i>Operator</i> must be one of the following: &lt;, &gt;, &lt;=, &gt;=, &lt;&gt;, =, or <b>LIKE</b>.<br><br></li>
<li>
<i>Value</i> is the value with which you will compare the field values (for example, <code>'Smith'</code>, <code>#8/24/95#</code>, <code>12.345</code> or <code>$50.00</code>). Use single quotes with strings and pound signs (<code>#</code>) with dates. For numbers, you can use decimal points, dollar signs, and scientific notation. If <i>Operator</i> is <b>LIKE</b>, <i>Value</i> can use wildcards. Only the asterisk (*) and percent sign (%) wild cards are allowed, and they must be the last character in the string. <i>Value</i> cannot be <b>Null</b>.<br><br></li>
<li>
There is no precedence between <b>AND</b> and <b>OR</b>. Clauses can be grouped within parentheses. However, you cannot group clauses joined by an <b>OR</b> and then join the group to another clause with an <b>AND</b>, like this:<pre><code>(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'</code></pre>
</li>
</ul>
<pre></pre>
<ul type=disc>
<li>
Instead, you would construct this filter as<pre><code>(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')</code></pre>
</li>
</ul>
<pre></pre>
<ul type=disc>
<li>
In a <b>LIKE</b> clause, you can use a wildcard at the beginning and end of the pattern (for example, <code>LastName Like '*mit*'</code>), or only at the end of the pattern (for example, <code>LastName Like 'Smit*'</code>).</li>
</ul>
<p>
The filter constants make it easier to resolve individual record conflicts during batch update mode by allowing you to view, for example, only those records that were affected during the last <b>UpdateBatch</b> method call.</p>
<p>
Setting the <b>Filter</b> property itself may fail because of a conflict with the underlying data (for example, a record has already been deleted by another user); in such a case, the provider returns warnings to the <a href="mdaobj02_9pwz.htm">Errors</a> collection but does not halt program execution. A run-time error occurs only if there are conflicts on all the requested records. Use the <a href="mdapro06_6fn7.htm">Status</a> property to locate records with conflicts.</p>
<p>
Setting the <b>Filter</b> property to a zero-length string ("") has the same effect as using the <b>adFilterNone</b> constant.</p>
<p>
Whenever the <b>Filter</b> property is set, the current record position moves to the first record in the filtered subset of records in the <b>Recordset</b>. Similarly, when the <b>Filter</b> property is cleared, the current record position moves to the first record in the <b>Recordset</b>.</p>
<p>
See the <a href="mdapro01_1vxn.htm">Bookmark</a> property for an explanation of bookmark values from which you can build an array to use with the <b>Filter</b> property.</p>
</font></BODY>
</HTML>
