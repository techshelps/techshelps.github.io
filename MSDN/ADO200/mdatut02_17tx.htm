<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Address Book Application Source Code</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdhowabsourcecode"></a>Address Book Application Source Code</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowABSourceCode_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowABSourceCode_S">
</object></p>
<p>
The following code is the complete source code for the Address Book sample application.</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Corporate Address Book&lt;/TITLE&gt;
&lt;/HEAD&gt;

&lt;!--
   Purpose:   To provide a company directory search service for Web users.
   Written By:   Microsoft Remote Data Service Team, Microsoft Corp.
   Date:   April, 1997
--&gt;

&lt;BODY BACKGROUND="Arcadia.gif" LANGUAGE="VBScript" onload="Load"&gt;
&lt;tr&gt;
   &lt;td align="center" width="40%"&gt;
      &lt;table border="2" cellpadding="7" cellspacing="7"&gt;
         &lt;tr&gt;
            &lt;td width="100%"&gt;&lt;font color="#160B5A"&gt;&lt;font
            size="4"&gt;&lt;strong&gt;Arcadia Bay Corporate Phone
            Directory&lt;/strong&gt;&lt;/font&gt;&lt;/font&gt;&lt;/td&gt;
         &lt;/tr&gt;
      &lt;/table&gt;
      &lt;/td&gt;
&lt;/tr&gt;

&lt;hr&gt;
&lt;h2&gt;&lt;font color = "#160B5A"&gt;Search Parameters&lt;/h2&gt;
&lt;h5&gt;&lt;font color = "#160B5A"&gt;Please enter one or more search patterns and press FIND to search.&lt;/h5&gt;

&lt;FONT COLOR = "#160B5A"&gt;&lt;B&gt;

&lt;PRE&gt; First Name&nbsp;&nbsp; &lt;INPUT NAME=SFirst SIZE=30&gt; &lt;/PRE&gt;

&lt;PRE&gt; Last Name&nbsp; &lt;INPUT NAME=SLast&nbsp; SIZE=30&gt; &lt;/PRE&gt;

&lt;PRE&gt; Title&nbsp;&nbsp;&nbsp; &lt;INPUT NAME=STitle SIZE=30&gt; &lt;/PRE&gt;

&lt;PRE&gt; E-mail Alias &lt;INPUT NAME=SEmail SIZE=30&gt; &lt;/PRE&gt;

&lt;!-- 
   Command button options:
   -----------------------
   Find      Submit a search request to the database.
   Clear      Clear the QBE fields (labor saving function only).
   Update Profile   Send updated "address profile" back to the database.
   Cancel Changes   Undo all changes since the last Update Profile.
--&gt;

&lt;INPUT TYPE=BUTTON NAME="Find"    VALUE="Find"&gt;
&lt;INPUT TYPE=BUTTON NAME="Clear"    VALUE="Clear"&gt;
&lt;INPUT TYPE=BUTTON NAME="Update"    VALUE="Update Profile"&gt;
&lt;INPUT TYPE=BUTTON NAME="Cancel"    VALUE="Cancel Changes"&gt;

&lt;hr&gt;
&lt;h2&gt;&lt;font color = "#400040"&gt;Search Results&lt;/h2&gt;
&lt;/B&gt;
&lt;br&gt;

&lt;!-- 
   This Sheridan DataGrid control (SGrid) is initialized to
   allow changes to the data - these changes will be saved
   to the database when the Update Profile button is pressed. 
--&gt;

&lt;Object CLASSID="clsid:AC05DC80-7DF1-11d0-839E-00A024A94B3A"
   CODEBASE="http://&lt;%=Request.ServerVariables("SERVER_NAME")%&gt;/MSADC/Samples/ssdatb32.cab"
   ID=GRID1 
 &nbsp;&nbsp; datasrc=#SControl 
 &nbsp;&nbsp; HEIGHT=125 
 &nbsp;&nbsp; WIDTH=495&gt;
   &lt;PARAM NAME="AllowAddNew" VALUE="TRUE"&gt;
   &lt;PARAM NAME="AllowDelete" VALUE="TRUE"&gt;
   &lt;PARAM NAME="AllowUpdate" VALUE="TRUE"&gt;
   &lt;PARAM NAME="BackColor"&nbsp;&nbsp; VALUE="-2147483643"&gt;
   &lt;PARAM NAME="BackColorOdd"&nbsp; VALUE="-2147483643"&gt;
   &lt;PARAM NAME="ForeColorEven" VALUE="0"&gt;
&lt;/OBJECT&gt;

&lt;br&gt;
&lt;br&gt;
&lt;INPUT TYPE=BUTTON NAME="First"    VALUE="First"&gt;
&lt;INPUT TYPE=BUTTON NAME="Prev"    VALUE="Previous"&gt;
&lt;INPUT TYPE=BUTTON NAME="Next"   VALUE="Next"&gt;
&lt;INPUT TYPE=BUTTON NAME="Last"   VALUE="Last"&gt;
&lt;hr&gt;


&lt;!-- Non-visual controls - RDS.DataControl --&gt;

&lt;OBJECT classid="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33"
   ID=SControl
   WIDTH=1 HEIGHT=1&gt;
   &lt;PARAM NAME="SERVER" VALUE="http://&lt;%=Request.ServerVariables("SERVER_NAME")%&gt;"&gt;
   &lt;PARAM NAME="CONNECT" VALUE="dsn=ADCDemo;UID=ADCDemo;PWD=ADCDemo;"&gt;
&lt;/OBJECT&gt;


&lt;!-- VBS scripting for composing queries, updating profiles, and retrieving search results. --&gt;

&lt;SCRIPT LANGUAGE="VBScript"&gt;

Dim myQuery

Sub Load
   Grid1.CAPTION = "Arcadia Bay Corporate Phone Directory"

   'Initialize data grid with column names only.
   SControl.SQL = "Select FirstName, LastName, Title, Email, Building, Room, Phone from Employee where 2 &lt; 1"
   SControl.Refresh

End Sub

'Implement "Clear" button - clears all of the QBE fields in preparation for a new "Find."

Sub Clear_OnClick
   SFirst.Value=""
   SLast.Value=""
   STitle.Value=""
   SEmail.Value=""
End Sub


'Implement "Find" button - composes a dynamic SQL query to be processed by the database and returns matching records to be bound to the SGrid object.

Sub Find_OnClick

   myQuery = "Select FirstName, LastName, Title, Type, Email, ManagerEmail, Building, Room, Phone from Employee"

   'Check QBE fields and compose a dynamic SQL query.

   IF (SFirst.Value &lt;&gt; "") THEN
      myQuery = myQuery + " where FirstName like '" + SFirst.Value + "%'"
   End IF

   IF (SLast.Value &lt;&gt; "") THEN
      myQuery = myQuery + " where LastName like '" + SLast.Value + "%'"
   End IF

   IF (STitle.Value &lt;&gt; "") THEN
      myQuery = myQuery + " where Title like '" + STitle.Value + "%'"
   End IF

   IF (SEmail.Value &lt;&gt; "") THEN
      myQuery = myQuery + " where Email like '" + SEmail.Value + "%'"
   End IF

   'Set the new query and then refresh the SControl so that the new results are displayed.

   SControl.SQL = myQuery
   SControl.Refresh
   
End Sub

'Navigation subroutines - based on currency changes to RDS.DataControl (SControl).

'Move to the first record in the bound recordset.

Sub First_OnClick
     SControl.Recordset.MoveFirst
End Sub

'Move to the next record from the current position in the bound recordset.

Sub Next_OnClick
   If SControl.Recordset.EOF Then   'cannot move beyond bottom record
      SControl.Recordset.MoveFirst 
      SControl.Recordset.MoveNext
      Exit Sub
   End If   

   SControl.Recordset.MoveNext

End Sub

'Move to the previous record from the current position in the bound recordset.

Sub Prev_OnClick
If SControl.Recordset.BOF Then   'cannot move beyond top record
      SControl.Recordset.MoveLast   'Get out of BOF buffer
      SControl.Recordset.MovePrevious
      Exit Sub
   End If
   SControl.Recordset.MovePrevious
End Sub

'Move to the last record in the bound recordset.

Sub Last_OnClick
     SControl.Recordset.MoveLast
End Sub

'Submit edits made and pull a clean copy of the new data.

Sub Update_OnClick
     SControl.SubmitChanges
   SControl.Refresh&nbsp;&nbsp;&nbsp; ' A Refresh is not required in ADC 1.5 after a SubmitChanges, but it ensures fresh data.
End Sub

'Cancel edits and restore original values.

Sub Cancel_OnClick
     SControl.CancelUpdate
End Sub

&lt;/SCRIPT&gt;

&lt;BR&gt;
&lt;font color = "#400040"&gt;This site powered by Microsoft Remote Data Service. &lt;/font&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>
</font></BODY>
</HTML>
