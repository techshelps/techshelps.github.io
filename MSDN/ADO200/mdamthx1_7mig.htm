<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddNew Method Example</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdmthaddnewx"></a>AddNew Method Example</h1>
<p>
This example uses the <b>AddNew</b> method to create a new record with the specified name.</p>
<pre><code>Public Sub AddNewX()

   Dim cnn1 As ADODB.Connection
   Dim rstEmployees As ADODB.Recordset
   Dim strCnn As String
   Dim strID As String
   Dim strFirstName As String
   Dim strLastName As String
   Dim booRecordAdded As Boolean

   ' Open a connection.
   Set cnn1 = New ADODB.Connection
   strCnn = "Provider=sqloledb;" &amp; _
      "Data Source=srv;Initial Catalog=pubs;User Id=sa;Password=;"
   cnn1.Open strCnn
      
   ' Open Employee table.
   Set rstEmployees = New ADODB.Recordset
   rstEmployees.CursorType = adOpenKeyset
   rstEmployees.LockType = adLockOptimistic
   rstEmployees.Open "employee", cnn1, , , adCmdTable

   ' Get data from the user. The employee ID must be formatted as 
   ' first, middle, and last initial, five numbers, then M or F to 
   ' signify the gender. For example, the employee id for Bill Sornsin
   ' would be "B-S55555M".
   strID = Trim(InputBox("Enter employee ID:"))
   strFirstName = Trim(InputBox("Enter first name:"))
   strLastName = Trim(InputBox("Enter last name:"))

   ' Proceed only if the user actually entered something
   ' for both the first and last names.
   If (strID &lt;&gt; "") And (strFirstName &lt;&gt; "") _
      And (strLastName &lt;&gt; "") Then

      rstEmployees.AddNew
      rstEmployees!emp_id = strID
      rstEmployees!fname = strFirstName
      rstEmployees!lname = strLastName
      rstEmployees.Update
      booRecordAdded = True

      ' Show the newly added data.
      MsgBox "New record: " &amp; rstEmployees!emp_id &amp; " " &amp; _
         rstEmployees!fname &amp; " " &amp; rstEmployees!lname

   Else
      MsgBox "Please enter an employee ID, " &amp; _
         "first name, and last name."
   End If
      
   ' Delete the new record because this is a demonstration.
   cnn1.Execute "DELETE FROM employee WHERE emp_id = '" &amp; strID &amp; "'"
      
   rstEmployees.Close
   cnn1.Close

End Sub
</code></pre>
<h2>VBScript Version</h2>
<p>
The following is the same example written in VBScript to be used in an Active Server Page (ASP). To view this fully functional example, you need to create a system Data Source Name (DSN) called AdvWorks using the data source AdvWorks.mdb installed with IIS and located at C:\InetPub\ASPSamp\AdvWorks. This is a Microsoft Access database file. Use <b>Find</b> to locate the file Adovbs.inc and place it in the directory you plan to use. Cut and paste the following code to Notepad or another text editor and save it as AddNew.asp. You can view the result in any client browser.</p>
<p>
To exercise the example, add a new fictional record in the HTML form. Click <b>Add New</b>. See the <b>Delete</b> method example to remove unwanted records.</p>
<pre><code>&lt;!-- #Include file="ADOVBS.INC" --&gt;
&lt;% Language = VBScript %&gt;
&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;ADO Open Method&lt;/TITLE&gt;
&lt;/HEAD&gt;&lt;BODY&gt; 
&lt;FONT FACE="MS SANS SERIF" SIZE=2&gt;
&lt;Center&gt;&lt;H3&gt;ADO AddNew Method&lt;/H3&gt;
&lt;!-- ADO Connection Object used to create recordset--&gt;
&lt;% 
'Create and Open Connection Object
Set OBJdbConnection = Server.CreateObject("ADODB.Connection") 
OBJdbConnection.Open "AdvWorks" 
'Create and Open Recordset Object
Set RsCustomerList = Server.CreateObject("ADODB.Recordset")
RsCustomerList.ActiveConnection = OBJdbConnection
RsCustomerList.CursorType = adOpenKeyset
RsCustomerList.LockType = adLockOptimistic
RsCustomerList.Source = "Customers"
RsCustomerList.Open

%&gt;
&lt;!-- If this is first time page is open, Form collection will be empty when data is entered. 

run AddNew method--&gt;
&lt;% If Not IsEmpty(Request.Form) Then
   If Not Request.Form("CompanyName") = "" Then
      RsCustomerList.AddNew
      RsCustomerList("CompanyName") = Request.Form("CompanyName")
      RsCustomerList("ContactLastName") = Request.Form("LastName")
      RsCustomerList("ContactFirstName") = Request.Form("FirstName")
      RsCustomerList("PhoneNumber") = Request.Form("PhoneNumber")
      RsCustomerList("City") = Request.Form("City")
      RsCustomerList("StateOrProvince") = Request.Form("State")
      RsCustomerList.Update
      RsCustomerList.MoveFirst
      
   End If
End If
%&gt;

&lt;TABLE COLSPAN=8 CELLPADDING=5 BORDER=0&gt;

&lt;!-- BEGIN column header row for Customer Table--&gt;

&lt;TR&gt;&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;Company Name&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;Contact Name&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER WIDTH=150 BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;Phone Number&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;City&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR="#008080"&gt;
&lt;FONT STYLE="ARIAL NARROW" COLOR="#ffffff" SIZE=1&gt;State/Province&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;!--Display ADO Data from Customer Table one row on each pass through recordset--&gt;
&lt;% Do While Not RsCustomerList.EOF %&gt;
  &lt;TR&gt;&lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt; 
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RSCustomerList("CompanyName")%&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RScustomerList("ContactLastName") &amp; ", " %&gt; 
  &lt;%= RScustomerList("ContactFirstName") %&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt;
 &nbsp; &lt;%= RScustomerList("PhoneNumber")%&gt; 
 &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RScustomerList("City")%&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR="f7efde" ALIGN=CENTER&gt;
  &lt;FONT STYLE="ARIAL NARROW" SIZE=1&gt; 
  &lt;%= RScustomerList("StateOrProvince")%&gt; 
  &lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt; 
&lt;!-- Next Row = Record Loop and add to row html table--&gt;
&lt;% 
RScustomerList.MoveNext 
Loop 
%&gt;

&lt;/TABLE&gt;&lt;HR&gt;
&lt;!-- Form to enter new record posts variables back to this page --&gt;
&lt;Table&gt;
&lt;Form Method = Post Action="AddNew.asp" Name=Form&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Company Name:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type="Text" Size="50" Name="CompanyName" Value = ""&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Contact First Name:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type="Text" Size="50" Name="FirstName" Value = ""&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Contact Last Name:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type="Text" Size="50" Name="LastName" Value = ""&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Contact Phone:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type="Text" Size="50" Name="PhoneNumber" Value = ""&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;City:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type="Text" Size="50" Name="City" Value = ""&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;State / Province:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type="Text" Size="5" Name="State" Value = ""&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;Input Type="Submit" Value="Add New "&gt;&lt;Input Type="Reset" Value="Reset Form"&gt;
&lt;/Form&gt;&lt;/Table&gt;&lt;/Center&gt;&lt;/FONT&gt;
&lt;%'Show location of DSN data source
Response.Write(OBJdbConnection)
%&gt;
&lt;Script Language = "VBScript"&gt;
Sub Form_OnSubmit
   MsgBox "Sending New Record to Server",,"ADO-ASP _Example"
End Sub
&lt;/Script&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
</font></BODY>
</HTML>
