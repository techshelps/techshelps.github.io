<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Microsoft OLE DB Provider for Microsoft Active Directory Service</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdrefadsprovspec"></a>Microsoft OLE DB Provider for Microsoft Active Directory Service</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdrefADSProvSpec_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdrefADSProvSpec_S">
</object></p>
<p>
The Microsoft<sup>®</sup> Active Directory Service Interfaces (ADSI) Provider allows ADO to connect to heterogeneous directory services through ADSI. This gives ADO applications read-only access to the Microsoft<sup>®</sup>Windows NT<sup>®</sup> 4.0 directory services, as well as to any LDAP-compliant directory service and Novell Directory Services. ADSI itself is based on a provider model, so if there is a new provider giving access to another directory, the ADO application will be able to access it seamlessly. The ADSI provider is free-threaded and unicode enabled.</p>
<p class=label>
<b>Connection String Parameters</b></p>
<p>
To connect to this provider, set the <b>Provider</b> argument of the <b>ConnectionString</b> property to:</p>
<pre><code>ADSDSOObject
</code></pre>
<p>
Reading the <b>Provider </b>property will return this string as well.</p>
<p class=label>
<b>Command Text</b></p>
<p>
The provider recognizes a four-part command text string in the following syntax:</p>
<p>
<b>"</b><i>Root</i><b>;</b> <i>Filter</i><b>;</b> <i>Attributes</i>[<b>;</b> <i>Scope</i>]<b>"</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Value</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=50%><i>Root</i> </td>
<td width=50%>The <b>ADsPath</b> object from which the search is to be started (that is, the root of the search).</td>
</tr>
<tr valign=top>
<td width=50%><i>Filter</i> </td>
<td width=50%>The search filter in the RFC 960 format.</td>
</tr>
<tr valign=top>
<td width=50%><i>Attributes</i> </td>
<td width=50%>A comma-delimited list of attributes to be returned.</td>
</tr>
<tr valign=top>
<td width=50%><i>Scope</i> </td>
<td width=50%>Optional. A <b>String</b> that specifies the scope of the search. Can be one of the following:<ul type=disc>
<li>
Base—Search only the base object (root of the search).<br><br></li>
<li>
OneLevel—Search only one level.<br><br></li>
<li>
Subtree—Search the entire subtree.</li>
</ul>
</td>
</tr>
</table><br>
<p>
The provider does not accept stored procedure calls or simple table names (for example, the <b>CommandType</b> property will always be <b>adCmdText</b>). See the Active Directory Service Interfaces documentation for a more complete description of the command text elements.</p>
<p class=label>
<b>Recordset Behavior</b></p>
<p>
The following tables list the features available on a <b>Recordset</b> object opened with this provider. Only the Static cursor type (<b>adOpenStatic</b>) is available.</p>
<p>
For more detailed information about <b>Recordset</b> behavior for your provider configuration, run the <b>Supports</b> method and enumerate the <b>Properties </b>collection of the <b>Recordset</b> to determine whether provider-specific dynamic properties are present.</p>
<p>
Availability of standard ADO<b> Recordset</b> properties:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=54%><b>Property</b></td>
<td class=label width=46%><b>Availability</b></td>
</tr>
<tr valign=top>
<td width=54%><b>AbsolutePage</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>AbsolutePosition</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>ActiveConnection</b></td>
<td width=46%>read-only</td>
</tr>
<tr valign=top>
<td width=54%><b>BOF</b></td>
<td width=46%>read-only</td>
</tr>
<tr valign=top>
<td width=54%><b>Bookmark</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>CacheSize</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>CursorLocation</b></td>
<td width=46%>always <b>adUseServer</b></td>
</tr>
<tr valign=top>
<td width=54%><b>CursorType</b></td>
<td width=46%>always <b>adOpenStatic</b></td>
</tr>
<tr valign=top>
<td width=54%><b>EditMode</b></td>
<td width=46%>always <b>adEditNone</b></td>
</tr>
<tr valign=top>
<td width=54%><b>EOF</b></td>
<td width=46%>read-only</td>
</tr>
<tr valign=top>
<td width=54%><b>Filter</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>LockType</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>MarshalOptions</b></td>
<td width=46%>not available</td>
</tr>
<tr valign=top>
<td width=54%><b>MaxRecords</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>PageCount</b></td>
<td width=46%>read-only</td>
</tr>
<tr valign=top>
<td width=54%><b>PageSize</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>RecordCount</b></td>
<td width=46%>read-only</td>
</tr>
<tr valign=top>
<td width=54%><b>Source</b></td>
<td width=46%>read/write</td>
</tr>
<tr valign=top>
<td width=54%><b>State</b></td>
<td width=46%>read-only</td>
</tr>
<tr valign=top>
<td width=54%><b>Status</b></td>
<td width=46%>read-only</td>
</tr>
</table><br>
<p>
Availability of standard ADO <b>Recordset</b> methods:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=595>
<tr valign=top>
<td class=label width=54%><b>Method</b></td>
<td class=label width=46%><b>Available?</b></td>
</tr>
<tr valign=top>
<td width=54%><b>AddNew</b></td>
<td width=46%>No</td>
</tr>
<tr valign=top>
<td width=54%><b>Cancel</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=54%><b>CancelBatch</b></td>
<td width=46%>No</td>
</tr>
<tr valign=top>
<td width=54%><b>CancelUpdate</b></td>
<td width=46%>No</td>
</tr>
<tr valign=top>
<td width=54%><b>Clone</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Close</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Delete</b></td>
<td width=46%>No</td>
</tr>
<tr valign=top>
<td width=54%><b>GetRows</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Move</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>MoveFirst</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>MoveLast</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>MoveNext</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>MovePrevious</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>NextRecordset</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Open</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Requery</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Resync</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Supports</b></td>
<td width=46%>Yes</td>
</tr>
<tr valign=top>
<td width=54%><b>Update</b></td>
<td width=46%>No</td>
</tr>
<tr valign=top>
<td width=54%><b>UpdateBatch</b></td>
<td width=46%>No</td>
</tr>
</table><br>
<p>
<B><b>See Also&nbsp;&nbsp;&nbsp;</b></B>For more information about ADSI in general and the specifics of the provider, please refer to the documentation provided in the Active Directory Service Interfaces SDK. You can install the SDK from the ADSI Web page at http://www.microsoft.com/ntserver/info/adsi.htm.</p>
</font></BODY>
</HTML>
