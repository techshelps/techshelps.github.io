<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Microsoft OLE DB Provider for ODBC</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdrefodbcprovspec"></a>Microsoft OLE DB Provider for ODBC</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdrefODBCProvSpec_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdrefODBCProvSpec_S">
</object></p>
<p>
To an ADO or RDS programmer, an ideal world would be one in which every data source exposes an OLE DB interface, so that ADO could call directly into the data source. Although more and more database vendors are implementing OLE DB interfaces, some data sources are not yet exposed this way. However, virtually all DBMS systems in use today can be accessed through ODBC.</p>
<p>
The Microsoft<sup>®</sup> ODBC Provider allows ADO to connect to any ODBC data source. ODBC drivers are available for every major DBMS in use today, including Microsoft<sup>®</sup> SQL Server™, Microsoft Access (Microsoft Jet database engine), and Microsoft FoxPro<sup>®</sup>, as well as non-Microsoft database products such as Oracle. The provider is free-threaded and unicode enabled.</p>
<p>
The provider supports transactions, although different DBMS engines offer different types of transaction support. For example, Microsoft Access supports nested transactions, up to five levels deep.</p>
<p>
This is the default provider for ADO and, when used with Microsoft SQL Server 6.5, all provider-dependent ADO properties and methods are supported, except as noted in the ADO language reference topics.</p>
<p class=label>
<b>Connection String Parameters</b></p>
<p>
To connect to this provider, set the <b>Provider=</b> argument of the <b>ConnectionString</b> property to:</p>
<pre><code>MSDASQL
</code></pre>
<p>
Reading the <b>Provider</b> property will return this string as well.</p>
<p>
Because this is the default provider for ADO, if you omit the <b>Provider=</b> parameter from the connection string, ADO will attempt to establish a connection to this provider.</p>
<p>
The provider does not support any specific connection parameters in addition to those defined by ADO. However, the provider will pass any non-ADO connection parameters to the ODBC driver manager. </p>
<p>
Because you can omit the <b>Provider</b> parameter, you can therefore compose an ADO connection string that is identical to an ODBC connection string for the same data source, using the same parameter names (<b>DRIVER=</b>, <b>DATABASE=</b>, <b>DSN=</b>, and so on), values, and syntax as you would when composing an ODBC connection string. You can connect with or without a predefined data source name (DSN) or FileDSN.</p>
<p>
Syntax with a DSN or FileDSN:</p>
<p>
<b>"</b>[<b>Provider=MSDASQL;</b>] { <b>DSN=</b><i>name</i> | <b>FileDSN=</b><i>filename</i> } <b>;</b> [<b>DATABASE=</b><i>database</i><b>;</b>] <b>UID=</b><i>user</i><b>;</b> <b>PWD=</b><i>password</i><b>"</b></p>
<p>
Syntax without a DSN (DSN-less connection):</p>
<p>
<b>"</b>[<b>Provider=MSDASQL;</b>] <b>DRIVER=</b><i>driver</i><b>;</b> <b>SERVER=</b><i>server</i><b>;</b> <b>DATABASE=</b><i>database</i><b>;</b> <b>UID=</b><i>user</i><b>;</b> <b>PWD=</b><i>password</i><b>"</b></p>
<p>
If you use a <b>DSN</b> or <b>FileDSN</b>, it must be defined through the ODBC Administrator in the Windows Control Panel. As an alternative to setting a <b>DSN</b>, you can specify the ODBC driver (<b>DRIVER=</b>), such as "SQLServer," the server name (<b>SERVER=</b>), and the database name (<b>DATABASE=</b>).</p>
<p>
You can also specify a user account name (<b>UID=</b>), and the password for the user account (<b>PWD=</b>) in the ODBC-specific parameters or in the standard ADO-defined <b><i>User ID</i></b> and <b><i>Password</i></b> parameters. If you include both the ADO and the ODBC-specific parameters for these values, the ADO parameters take precedence.</p>
<p>
Although a <b>DSN</b> definition already specifies a database, you can specify a <b><i>DATABASE</i></b> parameter in addition to a <b>DSN</b> to connect to a different database. This also changes the <b>DSN</b> definition to include the specified database. It is a good idea to always include the <b><i>DATABASE</i></b> parameter when you use a <b>DSN</b>. This will ensure that you connect to the proper database because another user may have changed the default database parameter since you last checked the <b>DSN</b> definition.</p>
<p class=label>
<b>Command Text</b></p>
<p>
How you use the <b>Command</b> object largely depends on the data source, and what type of query or command statement it will accept.</p>
<p>
ODBC does provide a specific syntax for calling stored procedures. For the <b>CommandText</b> property of a <b>Command</b> object, the <b><i>CommandText</i></b> argument to the <b>Execute</b> method on a <b>Connection</b> object, or the <b><i>Source</i></b> argument to the <b>Open</b> method on a <b>Recordset</b> object, pass in a string having this syntax:</p>
<p>
<b>"{</b> [ <b>? = </b>] <b>call</b> <i>procedure</i> [ <b>(</b> <b>?</b> [<b>, ? </b>[ <b>,</b> … ]] <b>)</b> ] <b>}"</b></p>
<p>
Where each <b>?</b> references an object in the <b>Parameters</b> collection. The first <b>?</b> references <b>Parameters</b>(0), the next <b>?</b> references <b>Parameters</b>(1), and so on.</p>
<p>
The parameter references are optional and depend on the structure of the stored procedure. If you want to call a stored procedure that defines no parameters, your string would look like this:</p>
<p>
<b>"{</b> <b>call </b><i>procedure</i><b> }"</b></p>
<p>
If you have two query parameters, your string would look like this:</p>
<p>
<b>"{ call </b><i>procedure</i><b> ( ?, ? ) }"</b></p>
<p>
If the stored procedure wants to return a value, the return value is treated as another parameter. If you have no query parameters but you do have a return value, your string would look like this:</p>
<p>
<b>"{ ? = call </b><i>procedure</i><b> }"</b></p>
<p>
Finally, if you have a return value and two query parameters, your string would look like this:</p>
<p>
<b>"{ ? = call</b> <i>procedure</i> <b>( ?, ? ) }"</b></p>
<p class=label>
<b>Recordset Behavior</b></p>
<p>
The following tables list the standard ADO methods and properties available on a <b>Recordset</b> object opened with this provider.</p>
<p>
For more detailed information about <b>Recordset</b> behavior for your provider configuration, run the <b>Supports</b> method and enumerate the <b>Properties</b> collection of the <b>Recordset</b> to determine whether provider-specific dynamic properties are present.</p>
<p>
Availability of standard ADO <b>Recordset</b> properties:</p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=26%><b>Property</b></td>
<td class=label width=21%><b>ForwardOnly</b></td>
<td class=label width=20%><b>Dynamic</b></td>
<td class=label width=16%><b>Keyset</b></td>
<td class=label width=17%><b>Static</b></td>
</tr>
<tr valign=top>
<td width=26%><b>AbsolutePage</b></td>
<td width=21%>not available</td>
<td width=20%>not available</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>AbsolutePosition</b></td>
<td width=21%>not available</td>
<td width=20%>not available</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>ActiveConnection</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>BOF</b></td>
<td width=21%>read-only</td>
<td width=20%>read-only</td>
<td width=16%>read-only</td>
<td width=17%>read-only</td>
</tr>
<tr valign=top>
<td width=26%><b>Bookmark</b></td>
<td width=21%>not available</td>
<td width=20%>not available</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>CacheSize</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>CursorLocation</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>CursorType</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>EditMode</b></td>
<td width=21%>read-only</td>
<td width=20%>read-only</td>
<td width=16%>read-only</td>
<td width=17%>read-only</td>
</tr>
<tr valign=top>
<td width=26%><b>EOF</b></td>
<td width=21%>read-only</td>
<td width=20%>read-only</td>
<td width=16%>read-only</td>
<td width=17%>read-only</td>
</tr>
<tr valign=top>
<td width=26%><b>Filter</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>LockType</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>MarshalOptions</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>MaxRecords</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>PageCount</b></td>
<td width=21%>not available</td>
<td width=20%>not available</td>
<td width=16%>read-only</td>
<td width=17%>read-only</td>
</tr>
<tr valign=top>
<td width=26%><b>PageSize</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>RecordCount</b></td>
<td width=21%>not available</td>
<td width=20%>not available</td>
<td width=16%>read-only</td>
<td width=17%>read-only</td>
</tr>
<tr valign=top>
<td width=26%><b>Source</b></td>
<td width=21%>read/write</td>
<td width=20%>read/write</td>
<td width=16%>read/write</td>
<td width=17%>read/write</td>
</tr>
<tr valign=top>
<td width=26%><b>State</b></td>
<td width=21%>read-only</td>
<td width=20%>read-only</td>
<td width=16%>read-only</td>
<td width=17%>read-only</td>
</tr>
<tr valign=top>
<td width=26%><b>Status</b></td>
<td width=21%>read-only</td>
<td width=20%>read-only</td>
<td width=16%>read-only</td>
<td width=17%>read-only</td>
</tr>
</table><br>
<p>
The <b>AbsolutePosition</b> and <b>AbsolutePage</b> properties are write-only when ADO is used with version 1.0 of the Microsoft OLE DB Provider for ODBC.</p>
<p>
Availability of standard ADO <b>Recordset</b> methods:</p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=26%><b>Method</b></td>
<td class=label width=21%><b>ForwardOnly</b></td>
<td class=label width=20%><b>Dynamic</b></td>
<td class=label width=16%><b>Keyset</b></td>
<td class=label width=17%><b>Static</b></td>
</tr>
<tr valign=top>
<td width=26%><b>AddNew</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Cancel</b></td>
<td width=21%></td>
<td width=20%></td>
<td width=16%></td>
<td width=17%></td>
</tr>
<tr valign=top>
<td width=26%><b>CancelBatch</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>CancelUpdate</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Clone</b></td>
<td width=21%>No</td>
<td width=20%>No</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Close</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Delete</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>GetRows</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Move</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>MoveFirst</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>MoveLast</b></td>
<td width=21%>No</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>MoveNext</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>MovePrevious</b></td>
<td width=21%>No</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>NextRecordset*</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Open</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Requery</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Resync</b></td>
<td width=21%>No</td>
<td width=20%>No</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Supports</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>Update</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
<tr valign=top>
<td width=26%><b>UpdateBatch</b></td>
<td width=21%>Yes</td>
<td width=20%>Yes</td>
<td width=16%>Yes</td>
<td width=17%>Yes</td>
</tr>
</table><br>
<p>
*Not supported for Microsoft Access databases.</p>
<p>
<B><b>See Also&nbsp;&nbsp;&nbsp;</b></B>For specific implementation details and functional information about the Microsoft OLE DB Provider for ODBC, consult the documentation for Microsoft OLE DB Provider for ODBC and the <i>Microsoft OLE DB Programmer's Reference</i>, available in the Data Access SDK. You can also see the Data Access Web page at http://www.microsoft.com/data. </p>
</font></BODY>
</HTML>
