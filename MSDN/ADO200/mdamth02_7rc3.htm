<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NextRecordset Method (ADO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="mdmthnextrec"></a>NextRecordset Method (ADO)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthNextRec_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthNextRec_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthNextRec_A">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthNextRec_S">
</object></p>
<p>
Clears the current <a href="mdaobj01_2zdv.htm">Recordset</a> object and returns the next <b>Recordset</b> by advancing through a series of commands.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Set</b> <i>recordset2</i> = <i>recordset1</i><b>.NextRecordset(</b> <b><i>RecordsAffected </i>)</b></p>
<p class=label>
<b>Return Value</b></p>
<p>
Returns a <b>Recordset</b> object. In the syntax model, <i>recordset1</i> and <i>recordset2</i> can be the same <b>Recordset</b> object, or you can use separate objects.</p>
<p class=label>
<b>Parameters</b></p>
<p>
<b><i>RecordsAffected&nbsp;&nbsp;&nbsp;</i></b>Optional. A <b>Long</b> variable to which the provider returns the number of records that the current operation affected.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Use the <b>NextRecordset</b> method to return the results of the next command in a compound command statement or of a stored procedure that returns multiple results. If you open a <b>Recordset</b> object based on a compound command statement (for example, "SELECT * FROM table1;SELECT * FROM table2") using the <a href="mdamth02_7qlh.htm">Execute</a> method on a <b>Command</b> or the <a href="mdamth03_4tgu.htm">Open</a> method on a <b>Recordset</b>, ADO executes only the first command and returns the results to <i>recordset</i>. To access the results of subsequent commands in the statement, call the <b>NextRecordset</b> method.</p>
<p>
As long as there are additional results, the <b>NextRecordset</b> method will continue to return <b>Recordset</b> objects. If a row-returning command returns no records, the returned <b>Recordset</b> object will be empty; test for this case by verifying that the <a href="mdapro01_3sx2.htm">BOF</a> and <a href="mdapro01_3sx2.htm">EOF</a> properties are both <b>True</b>. If a non–row-returning command executes successfully, the returned <b>Recordset</b> object will be closed, which you can verify by testing the <a href="mdapro06_95ut.htm">State</a> property on the <b>Recordset</b>. When there are no more results, <i>recordset</i> will be set to <i>Nothing</i>.</p>
<p>
If an edit is in progress while in immediate update mode, calling the <b>NextRecordset</b> method generates an error; call the <a href="mdamth03_7oit.htm">Update</a> or <a href="mdamth01_70md.htm">CancelUpdate</a> method first.</p>
<p>
If you need to pass parameters for more than one command in the compound statement by filling the <a href="mdaobj02_94oj.htm">Parameters</a> collection or by passing an array with the original <b>Open</b> or <b>Execute</b> call, the parameters must be in the same order in the collection or array as their respective commands in the command series. You must finish reading all the results before reading output parameter values.</p>
<p>
When you call the <b>NextRecordset</b> method, ADO executes only the next command in the statement. If you explicitly close the <b>Recordset</b> object before stepping through the entire command statement, ADO never executes the remaining commands.</p>
<p class=indent>
<B><b>Remote Data Service Usage&nbsp;&nbsp;&nbsp;</b></B>The <b>NextRecordset</b> method is not available on a client-side <b>Recordset</b> object.</p>
</font></BODY>
</HTML>
