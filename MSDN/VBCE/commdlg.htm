<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CommonDialog Control</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_vbce_commondialog_control"></a>CommonDialog Control</h2>
<p>
The <b>CommonDialog</b> control provides a standard set of dialog boxes for operations such as opening and saving files, and selecting colors and fonts. The control also has the ability to display help by running the Windows Help engine.</p>
<h4>Syntax</h4>
<p>
<b>CommonDialog</b></p>
<h4>Library Name</h4>
<p>
CEComDlg</p>
<h4>DLL Name</h4>
<p>
MSCEComDlg.dll</p>
<p>
The <b>CommonDialog</b> properties, methods, and events listed in the following table are supported:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Properties</th>
<th align=left width=34%>Methods</th>
<th align=left width=35%>Events</th>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_23.htm">CancelError</a></td>
<td width=34%><a href="methods_81.htm">ShowOpen</a></td>
<td width=35%>None</td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_47.htm">Color</a></td>
<td width=34%><a href="methods_82.htm">ShowSave</a></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_67.htm">DefaultExt</a></td>
<td width=34%><a href="methods_78.htm">ShowColor</a></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_69.htm">DialogTitle</a></td>
<td width=34%><a href="methods_79.htm">ShowFont</a></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_80.htm">FileName</a></td>
<td width=34%><a href="methods_80.htm">ShowHelp</a></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_81.htm">FileTitle</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_85.htm">Filter</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_86.htm">FilterIndex</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_87.htm">Flags</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_90.htm">FontBold</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_92.htm">FontItalic</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_97.htm">FontStrikethru</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_99.htm">FontUnderline</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_93.htm">FontName</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_95.htm">FontSize</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_109.htm">HelpCommand</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_110.htm">HelpContext</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_111.htm">HelpFile</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_122.htm">InitDir</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_152.htm">Max, Min</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%><a href="proprts_153.htm">MaxFileSize</a></td>
<td width=34%></td>
<td width=35%></td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
You use the <b>CommonDialog</b> control in your application by adding it to a form and setting its properties. The dialog displayed by the control is determined by the methods of the control. At run time, a dialog box is displayed or the help engine is executed, when the appropriate method is invoked; at design time, the <b>CommonDialog</b> control is displayed as an icon on a form. This icon cannot be sized.</p>
<p>
The <b>CommonDialog</b> control can display the following commonly used dialog boxes:
<ul>
<li>
Open</li>
<li>
Save As</li>
<li>
Font</li>
<li>
Color</li>
</ul>
<h4><img src="wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To use the common dialog control</h4>
<ol>
<li>
If you haven't done so already, add the <b>CommonDialog</b> control to the toolbox. For information on adding a control, see <a href="getstart_13.htm">Installing Controls Using the Windows CE Control Manager</a>.</li>
<li>
On the toolbox, click the <b>CommonDialog</b> control and draw it on a form.<p>
When you draw a <b>CommonDialog</b> control on a form, it automatically resizes itself. The <b>CommonDialog</b> control is invisible at run time
</li>
<li>
At run time, use the appropriate method, as listed in the following table, to display the desired dialog.</li>
</ol>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Method</th>
<th align=left width=52%>Dialog Box Displayed</th>
</tr>
<tr valign=top>
<td width=48%>ShowOpen</td>
<td width=52%>Open</td>
</tr>
<tr valign=top>
<td width=48%>ShowSave</td>
<td width=52%>SaveAs</td>
</tr>
<tr valign=top>
<td width=48%>ShowColor</td>
<td width=52%>Color</td>
</tr>
<tr valign=top>
<td width=48%>ShowFont</td>
<td width=52%>Font</td>
</tr>
<tr valign=top>
<td width=48%>ShowHelp</td>
<td width=52%>Invokes the Windows Help Engine</td>
</tr>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
</table><br>
<p>
<b>Note</b>  In Windows CE, common dialog boxes are not movable; they are always centered vertically and horizontally on the screen. Common dialog boxes in Windows CE always have the Help button displayed.</p>
<p>
<b>The Color Dialog Box</b></p>
<p>
The <b>Color </b>common dialog box enables the user to select a color from a palette or to create and select a custom color. At run time, when the user chooses a color and closes the dialog box, you use the <b>Color</b> property to get the selected color.</p>
<h4><img src="wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display the Color dialog box</h4>
<ol>
<li>
Set the <b>Flags</b> property for the <b>CommonDialog</b> control to the Visual Basic constant <b>cdlCCRGBInit</b>.</li>
<li>
Use the <b>ShowColor</b> method to display the dialog box</li>
</ol>
<p>
Use the <b>Color</b> property to get the RGB value of the color the user selects. </p>
<p>
<b>The Open and Save As Dialog Boxes</b></p>
<p>
The <b>Open</b> common dialog box provides users with a way to select a file to open.</p>
<p>
The <b>Save As</b> common dialog box is identical to the Open dialog box in appearance, except for the dialog's caption, and file names appearing dimmed out. At run time, when the user chooses a file and closes the dialog box, the <b>FileName</b> property is used to get the selected file name.</p>
<h4><img src="wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display the Open or Save As dialog box</h4>
<ol>
<li>
Specify the list of file filters that are displayed in the <b>Files of type</b> list box by setting the <b>Filter</b> property. </li>
<li>
Use the <b>ShowOpen</b> method to display the dialog box. </li>
</ol>
<p>
After the user chooses a file, use the <b>FileName</b> property to get the name of the selected file.</p>
<p>
With all the common dialog boxes, when the <b>CancelError</b> property is <b>True</b>, an error is generated when the user clicks the dialog box's Cancel button. You detect that the Cancel button was pressed by trapping the error when the dialog box is displayed.</p>
<p>
<b>The Font Dialog Box</b></p>
<p>
The <b>Font</b> dialog box enables the user to select a font by its size, color, and style. </p>
<p>
<img src="font.gif" border=0></p>
<h4><img src="wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display the Font dialog box</h4>
<ol>
<li>
Set the <b>Flags</b> property to one of the following constant values:<ul>
<li>
<b>CdlCFScreenFonts</b> (screen Fonts)</li>
<li>
<b>CdlCFPrinterFonts</b> (printer Fonts)</li>
<li>
<b>CdlCFBoth</b> (both screen and printer fonts)</li>
</ul>
<p>
<b>Note</b>  You must set the <b>Flags</b> property to one of these values before displaying the Font dialog box. Otherwise, the following error occurs:
</li>
</ol>
<p>
<code>No Font Exists</code></p>
<ol start=2>
<li>
Use the <b>ShowFont</b> method to display the Font dialog box.</li>
</ol>
<p>
<b>Displaying a Help File</b></p>
<p>
The <b>ShowHelp</b> method of the common dialog control allows you to display a Help file.</p>
<h4><img src="wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display a Help file using the ShowHelp method</h4>
<ol>
<li>
Set the <b>HelpCommand</b> and <b>HelpFile</b> properties. </li>
<li>
Use the <b>ShowHelp</b> method to display the specified Help file.</li>
</ol>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%></th>
<th align=left width=34%></th>
<th align=left width=35%></th>
</tr>
<tr valign=top>
<td colspan=3 width=100%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=34%></td>
<td width=35%></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
