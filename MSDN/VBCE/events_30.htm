<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>QueryUnload</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_vbce_queryunload"></a>QueryUnload</h2>
<p>
Occurs before a form or application closes. </p>
<h4>Syntax</h4>
<p>
Private Sub Form_QueryUnload(<i>cancel</i>, <i>unloadmode</i>)</p>
<p>
The <b>QueryUnload</b> event syntax has these parts:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Part</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><i>cancel</i></td>
<td width=52%>An integer. Setting this argument to any value other than 0 stops the <b>QueryUnload</b> event in all loaded forms and stops the form and application from closing.</td>
</tr>
<tr valign=top>
<td width=48%><i>unloadmode</i></td>
<td width=52%>A value or constant indicating the cause of the <b>QueryUnload</b> event, as described in Return Values.</td>
</tr>
</table><br>
<h4>Return Values</h4>
<p>
The <i>unloadmode</i> argument returns the following values:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Constant</th>
<th align=left width=34%>Value</th>
<th align=left width=35%>Description</th>
</tr>
<tr valign=top>
<td width=31%><b>vbFormControlMenu</b></td>
<td width=34%>0</td>
<td width=35%>The user chose the <b>Close</b> command from the Control menu on the form.</td>
</tr>
<tr valign=top>
<td width=31%><b>vbFormCode</b></td>
<td width=34%>1</td>
<td width=35%>The <b>Unload</b> statement is invoked from code.</td>
</tr>
<tr valign=top>
<td width=31%><b>vbAppWindows</b></td>
<td width=34%>2</td>
<td width=35%>The current Microsoft Windows operating environment session is ending.</td>
</tr>
<tr valign=top>
<td width=31%><b>vbAppTaskManager</b></td>
<td width=34%>3</td>
<td width=35%>The Microsoft Windows Task Manager is closing the application.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
This event is typically used to make sure there are no unfinished tasks in the forms included in an application before that application closes. For example, if a user has not yet saved some new data in any form, your application can prompt the user to save the data.</p>
<p>
When an application closes, you can use either the <b>QueryUnload</b> or <b>Unload</b> event procedure to set the <b>Cancel</b> property to <b>True</b>, stopping the closing process. However, the <b>QueryUnload</b> event occurs in all forms before any are unloaded, and the <b>Unload</b> event occurs as each form is unloaded.</p>
<p>&nbsp;</p></body>
</HTML>
