<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Grouping Rows in Query Results</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowgroupingrowsinqueryresults"></a>Grouping Rows in Query Results</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowGroupingRowsInQueryResults_C;dvhowGroupingRowsInQueryResultsC">
</object></p>
<p>
If you want to create subtotals or show other summary information for subsets of a table, you create groups using an <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgaggregatequery">aggregate query</a>. Each group summarizes the data for all the rows in the table that have the same value.</p>
<p>
For example, you might want to see the average price of a book in the <code>titles</code> table, but break the results down by publisher. To do so, you group the query by publisher (for example, <code>pub_id</code>). The resulting query output might look like this:</p>
<p>
<img src="dv3w9e1.gif" border=0></p>
<p>
When you group data, you can display only summary or grouped data, such as:
<ul type=disc>
<li>
The values of the grouped columns (those that appear in the GROUP BY clause). In the example above, <code>pub_id</code> is the grouped column.<br><br></li>
<li>
Values produced by <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgaggregatefunction">aggregate functions</a> such as SUM(&nbsp;) and AVG(&nbsp;). In the example above, the second column is produced by using the AVG(&nbsp;) function with the <code>price</code> column.</li>
</ul>
<p>
You cannot display the contents of individual columns. For example, if you group only by publisher, you cannot also display individual titles in the query. Therefore, if you add columns to the query output, the Query Designer automatically adds them to the GROUP BY clause of the statement in the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefSQLPane">
</object><a href=JavaScript:alink_2.Click()>SQL pane</a>. If you want a column to be summarized instead, you can specify an aggregate function for that column.</p>
<p>
If you group by more than one column, each group in the query shows the summary values for all grouping columns.</p>
<p>
For example, the following query against the <code>titles</code> table groups by publisher (<code>pub_id</code>) and also by book type (<code>type</code>). The query results are ordered by publisher and show summary information for each different type of book that the publisher produces:</p>
<pre><code>SELECT pub_id, type, SUM(price) Total_price
FROM titles
GROUP BY pub_id, type
</code></pre>
<p>
The resulting output might look like this:</p>
<p>
<img src="dv3w9e2.gif" border=0></p>
<p class=label>
<b>To group rows</b>
<ol>
<li>
Start the query by adding the table you want to summarize to the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefDiagramPane">
</object><a href=JavaScript:alink_3.Click()>Diagram pane</a>.<br><br></li>
<li>
From the <b>Query</b> menu, choose <b>Group By</b>. The Query Designer adds a <b>Group By</b> column to the grid in the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefGridPane">
</object><a href=JavaScript:alink_4.Click()>Grid pane</a>.<br><br></li>
<li>
Add the column you want to group to the <b>Grid</b> pane. If you want the column to appear in the query output, be sure that the column is marked for output.<p class=tl>
The Query Designer adds a GROUP BY clause to the statement in the SQL pane. For example, the SQL statement might look like this:</P><pre><code>SELECT pub_id
FROM titles
GROUP BY pub_id
</code></pre>
</li>
<li>
Add the column you want to summarize to the <b>Grid</b> pane. Be sure that the column is marked for output.<br><br></li>
<li>
In the <b>Group By</b> grid column for the summary data column, select the aggregate function that you want to use to summarize the data.<p class=tl>
The Query Designer automatically assigns a column <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgalias">alias</a> to the column you are summarizing to create a useful column heading in query output. For more details, see <a href="dvhowcreatingcolumnaliases.htm">Creating Column Aliases</a>.</P><p>
<img src="dv3w9e3.gif" border=0></P><p class=tl>
The corresponding statement in the <b>SQL</b> pane might look like this:</P><pre><code>SELECT&nbsp;&nbsp; pub_id, SUM(price) AS Expr1
FROM&nbsp;&nbsp;&nbsp;&nbsp; titles
GROUP BY pub_id
</code></pre>
</li>
</ol>
</BODY>
</HTML>
