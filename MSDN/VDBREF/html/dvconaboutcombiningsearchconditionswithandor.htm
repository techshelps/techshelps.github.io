<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Combining Search Conditions</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvconaboutcombiningsearchconditionswithandor"></a>Combining Search Conditions</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconAboutCombiningSearchConditionsWithANDOR_C;dvconAboutCombiningSearchConditionsWithANDORC">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconAboutCombiningSearchConditionsWithANDOR_T;dvconAboutCombiningSearchConditionsWithANDORT">
</object></p>
<p>
You can create queries that include any number of <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsearchcondition">search conditions</a>, linked with any number of AND and OR operators. A query with a combination of AND and OR clauses can become complex, so it is helpful to understand how such a query is interpreted when you execute it, and how such a query is represented in the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefGridPane">
</object><a href=JavaScript:alink_3.Click()>Grid</a> and <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefSQLPane">
</object><a href=JavaScript:alink_4.Click()>SQL</a> panes.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;For details about search conditions that contain only one AND or OR operator, see <a href="dvhowspecifyingmultiplesearchconditionsforonecolumn.htm">Specifying Multiple Search Conditions for One Column</a> and <a href="dvhowspecifyingmultiplesearchconditionsformultiplecolumns.htm">Specifying Multiple Search Conditions for Multiple Columns</a>.</p>
<p>
Below you will find information about:
<ul type=disc>
<li>
The precedence of AND and OR in queries that contain both.<br><br></li>
<li>
How the conditions in AND and OR clauses relate logically to one another.<br><br></li>
<li>
How the Query Designer represents in the Grid pane queries that contain both AND and OR.</li>
</ul>
<p>
To help you understand the discussion below, imagine that you are working with an <code>employee</code> table containing the columns <code>hire_date</code>, <code>job_lvl</code>, and <code>status</code>. The examples assume that you need to know information such as how long an employee has worked with the company (that is, what the employee’s hire date is), what type of job the employee performs (what the job level is), and the employee’s status (for example, retired).</p>
<h2>Precedence of AND and OR</h2>
<p>
When a query is executed, it evaluates first the clauses linked with AND, and then those linked with OR.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The NOT operator takes precedence over both AND and OR.</p>
<p>
For example, to find either employees who have been with the company for more than five years in lower-level jobs or employees with middle-level jobs without regard for their hire date, you can construct a WHERE clause such as the following:</p>
<pre><code>WHERE 
   hire_date &lt; '01/01/90' AND 
   job_lvl = 100 OR
   job_lvl = 200
   
</code></pre>
<p>
To override the default precedence of AND over OR, you can put parentheses around specific conditions in the SQL pane. Conditions in parentheses are always evaluated first. For example, to find all employees who have been with the company more than five years in either lower or middle-level jobs, you can construct a WHERE clause such as the following:</p>
<pre><code>WHERE 
   hire_date &lt; '01/01/90' AND 
   <b>(</b>job_lvl = 100 OR job_lvl = 200<b>)</b>
</code></pre>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;It is recommended that, for clarity, you always include parentheses when combining AND and OR clauses instead of relying on the default precedence.</p>
<h2>How AND Works with Multiple OR Clauses</h2>
<p>
Understanding how AND and OR clauses are related when combined can help you construct and understand complex queries in the Query Designer.</p>
<p>
If you link multiple conditions using AND, the first set of conditions linked with AND applies to all the conditions in the second set. In other words, a condition linked with AND to another condition is distributed to all the conditions in the second set. For example, the following schematic representation shows an AND condition linked to a set of OR conditions:</p>
<pre><code>A AND (B OR C)
</code></pre>
<p>
The representation above is logically equivalent to the following schematic representation, which shows how the AND condition is distributed to the second set of conditions:</p>
<pre><code>(A AND B) OR (A AND C)
</code></pre>
<p>
This distributive principle affects how you use the Query Designer. For example, imagine that you are looking for all employees who have been with the company more than five years in either lower or middle-level jobs. You enter the following WHERE clause into the statement in the <b>SQL</b> pane:</p>
<pre><code>WHERE (hire_date &lt; '01/01/90' ) AND 
   (job_lvl = 100 OR job_lvl = 200)
</code></pre>
<p>
The clause linked with AND applies to both clauses linked with OR. An explicit way to express this is to repeat the AND condition once for each condition in the OR clause. The following statement is more explicit (and longer) than the previous statement, but is logically equivalent to it:</p>
<pre><code>WHERE    (hire_date &lt; '01/01/90' ) AND
  (job_lvl = 100) OR 
  (hire_date &lt; '01/01/90' ) AND 
  (job_lvl = 200)
</code></pre>
<p>
The principle of distributing AND clauses to linked OR clauses applies no matter how many individual conditions are involved. For example, imagine that you want to find lower or middle-level employees who have been with the company more than five years or are retired. The WHERE clause might look like this:</p>
<pre><code>WHERE 
   (job_lvl = 200 OR job_lvl = 300) AND
   (hire_date &lt; '01/01/90' ) OR (status = 'R')
</code></pre>
<p>
After the conditions linked with AND have been distributed, the WHERE clause will look like this:</p>
<pre><code>WHERE 
   (job_lvl = 200 AND hire_date &lt; '01/01/90' ) OR
   (job_lvl = 200 AND status = 'R') OR
   (job_lvl = 300 AND hire_date &lt; '01/01/90' ) OR
   (job_lvl = 300 AND status = 'R') 
</code></pre>
<h2>How Multiple AND and OR Clauses Are Represented in the Grid Pane</h2>
<p>
The Query Designer represents your search conditions in the <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefGridPane">
</object><a href=JavaScript:alink_5.Click()>Grid pane</a>. However, in some cases that involve multiple clauses linked with AND and OR, the representation in the Grid pane might not be what you expect. In addition, if you modify your query in the Grid or <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefDiagramPane">
</object><a href=JavaScript:alink_6.Click()>Diagram</a> panes, you might find that your SQL statement has been changed from what you entered.</p>
<p>
In general, these rules dictate how AND and OR clauses appear in the <b>Grid</b> pane:
<ul type=disc>
<li>
All conditions linked with AND appear in the <b>Criteria </b>grid column or in the same <b>Or&nbsp;…</b> column.<br><br></li>
<li>
All conditions linked with OR appear in separate <b>Or&nbsp;…</b> columns.<br><br></li>
<li>
If the logical result of a combination of AND and OR clauses is that the AND is distributed into several OR clauses, the <b>Grid</b> pane represents this explicitly by repeating the AND clause as many times as necessary.</li>
</ul>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The exact format of date information that you enter will depend on the database you are using. For details about entering dates, see <a href="dvconenteringsearchvalues.htm">Entering Search Values</a>.</p>
<p>
For example, in the SQL pane you might create a search condition such as the following, in which two clauses linked with AND take precedence over a third one linked with OR:</p>
<pre><code>WHERE (hire_date &lt; '01/01/90' ) <b>AND</b> 
  (job_lvl = 100)<b> OR </b>
  (status = 'R')
</code></pre>
<p>
The Query Designer represents this WHERE clause in the <b>Grid</b> pane as follows:</p>
<p>
<img src="dv3w8s1.gif" border=0></p>
<p>
However, if the linked OR clauses take precedence over an AND clause, the AND clause is repeated for each OR clause. This causes the AND clause to be distributed to each OR clause. For example, in the <b>SQL</b> pane you might create a WHERE clause such as the following:</p>
<pre><code>WHERE (hire_date &lt; '01/01/90' )<b> AND </b>
  ( (job_lvl = 100) <b>OR </b>
  (status = 'R') )
</code></pre>
<p>
The Query Designer represents this WHERE clause in the Grid pane as follows:</p>
<p>
<img src="dv3w8s2.gif" border=0></p>
<p>
If the linked OR clauses involve only one data column, the Query Designer can place the entire OR clause into a single cell of the grid, avoiding the need to repeat the AND clause. For example, in the SQL pane you might create a WHERE clause such as the following:</p>
<pre><code>WHERE (hire_date &lt; '01/01/90' ) <b>AND</b> 
  ((status = 'R') <b>OR</b> (status = 'A'))
</code></pre>
<p>
The Query Designer represents this WHERE clause in the <b>Grid</b> pane as follows:</p>
<p>
<img src="dv3w8s3.gif" border=0></p>
<p>
If you make a change to the query (such as changing one of the values in the Grid pane), the Query Designer recreates the SQL statement in the SQL pane. The recreated SQL statement will resemble the Grid pane display rather than your original statement. For example, if the Grid pane contains distributed AND clauses, the resulting statement in the SQL pane will be recreated with explicit distributed AND clauses. For details, see "How AND Works with Multiple OR Clauses" earlier in this topic.</p>
</BODY>
</HTML>
