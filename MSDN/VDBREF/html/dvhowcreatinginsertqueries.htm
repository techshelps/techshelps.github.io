<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Insert Queries</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowcreatinginsertqueries"></a>Creating Insert Queries</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingInsertQueries_C;dvhowCreatingInsertQueriesC">
</object></p>
<p>
You can copy rows from one table to another or within a table using an Insert query. For example, in a <code>titles</code> table, you can use an Insert Query to copy information about all the titles for one publisher to a second table that you can make available to that publisher. An Insert query is similar to a <a href="dvhowcreatingmaketablequeries.htm">Make Table</a> query, but copies rows into an existing table.</p>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;You can also copy rows from one table to another using cut and paste. For details, see <a href="dvhowaddingnewrowsinresultspane.htm">Adding New Rows in the Results Pane</a>.</p>
<p>
When you create an Insert query, you specify:
<ul type=disc>
<li>
The database table to copy rows to (the destination table).<br><br></li>
<li>
The table or tables to copy rows from (the source table). The source table or tables become part of a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsubquery">subquery</a>. If you are copying within a table, the source table is the same as the destination table.<br><br></li>
<li>
The columns in the source table whose contents you want to copy.<br><br></li>
<li>
The target columns in the destination table to copy the data to.<br><br></li>
<li>
<a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsearchcondition">Search conditions</a> to define the rows you want to copy.<br><br></li>
<li>
Sort order, if you want to copy the rows in a particular order.<br><br></li>
<li>
Group By options, if you want to copy only summary information.</li>
</ul>
<p>
For example, the following query copies title information from the <code>titles</code> table to an archive table called <code>archivetitles</code>. The query copies the contents of four columns for all titles belonging to a particular publisher:</p>
<pre><code>INSERT INTO archivetitles 
 &nbsp; (title_id, title, type, pub_id)
SELECT title_id, title, type, pub_id
FROM titles
WHERE (pub_id = '0766')
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;To insert values into a new row, use an <a href="dvhowcreatinginsertvaluesqueries.htm">Insert Values</a> query.</p>
<p>
For general information about using queries to update tables, see <a href="dvconusingqueriestomodifydata.htm">Modifying Data Using Queries</a>.</p>
<p>
You can copy the contents of selected columns or of all columns in a row. In either case, the data you are copying must be compatible with the columns in the rows you are copying to. For example, if you copy the contents of a column such as <code>price</code>, the column in the row you are copying to must accept numeric data with decimal places. If you are copying an entire row, the destination table must have compatible columns in the same physical position as the source table.</p>
<p>
When you create an Insert query, the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefGridPane">
</object><a href=JavaScript:alink_2.Click()>Grid pane</a> changes to reflect options available for copying data. Because you do not display data in an Insert query, the Output<b> </b>column is removed. An Append column is added to allow you to specify the columns into which data should be copied.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;You cannot undo the action of executing an Insert query. As a precaution, back up your data before executing the query.</p>
<p class=label>
<b>To create an Insert query</b>
<ol>
<li>
Start an Insert query by choosing <b>Change Type</b> from the <b>Query</b> menu or the Query Designer Toolbar, and then choosing <b>Insert</b>.<br><br></li>
<li>
In the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefInsertIntoTableDialogBox">
</object><a href=JavaScript:alink_3.Click()>Insert Into Table</a> dialog box, select the table to copy rows to (the destination table).<p>
<img src="dv3wag1.gif" border=0></P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The Query Designer cannot determine in advance which tables and <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgview">views</a> you can update. Therefore, the <b>Table Name</b> list in the <b>Insert Into Table</b> dialog box shows all available tables and views in the data connection you are querying, even those that you might not be able to copy rows to.</p></li>
<li>
Add to the query the table to copy rows from (the source table). For details, see <a href="dvhowaddinginputsources.htm">Adding Input Sources</a>. If you are copying rows within a table, you can add the source table as a destination table.<p class=tl>
The data columns from the source table appear in an input window in the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefDiagramPane">
</object><a href=JavaScript:alink_4.Click()>Diagram pane</a>.</P></li>
<li>
In the input source window, choose the names of the columns whose contents you want to copy. To copy entire rows, choose <b>* (All Columns)</b>.<p>
<img src="dv3wag2.gif" border=0></P><p class=tl>
The Query Designer adds the columns you choose to the <b>Column</b> column of the <b>Grid</b> pane.</P></li>
<li>
In the <b>Append</b> column of the <b>Grid</b> pane, select a target column in the destination table for each column you are copying. Choose <i>tablename</i>.<b>*</b> if you are copying entire rows. The columns in the destination table must have the same (or compatible) data types as the columns in the source table.<p>
<img src="dv3wag3.gif" border=0></P></li>
<li>
If you want to copy rows in a particular order, specify a sort order. For details, see <a href="dvhoworderingqueryresults.htm">Ordering Query Results</a>.<br><br></li>
<li>
Specify the rows to copy by entering search conditions in the <b>Criteria</b> column. For details, see <a href="dvhowspecifyingsearchconditions.htm">Specifying Search Conditions</a>.<p>
<img src="dv3wag4.gif" border=0></P><p class=tl>
If you do not specify a search condition, all rows from the source table will be copied to the destination table.</P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When you add a column to search to the <b>Grid</b> pane, the Query Designer also adds it to the list of columns to copy. If you want to use a column for searching but not copy it, clear the check box next to the column name in the input source window (&nbsp;<img src="dv3wbi8.gif" border=0>&nbsp;).</p></li>
<li>
If you want to copy summary information, specify Group By options. For details, see <a href="dvhowsummarizingvaluesforallrowsintable.htm">Summarizing Values for All Rows in a Table</a>.</li>
</ol>
<p>
When you execute an Insert query, no results are reported in the <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefResultsPane">
</object><a href=JavaScript:alink_5.Click()>Results pane</a>. Instead, a message appears indicating how many rows were copied.</p>
</BODY>
</HTML>
