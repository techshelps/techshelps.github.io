<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Subqueries</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowcreatingsubqueries"></a>Creating Subqueries</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingSubqueries_C;dvhowCreatingSubqueriesC">
</object></p>
<p>
You can use the results of one query as the input for another. Typically, you use the results of a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsubquery">subquery</a> as a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsearchcondition">search condition</a> that uses the IN(&nbsp;) function or EXISTS operator. However, you can also use a subquery as the FROM clause to specify a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgresultset">result set</a> to be used as an <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsginputsource">input source</a>.</p>
<p>
You can create a subquery by entering it in either the Grid pane or SQL pane.</p>
<p class=label>
<b>To define an EXISTS subquery in the Grid pane</b>
<ol>
<li>
Create the primary query.<br><br></li>
<li>
In the <b>Column</b> column for the first empty row in the <b>Grid</b> pane, enter EXISTS followed by the subquery in parentheses.<br><br></li>
<li>
In the <b>Criteria</b> column for the row containing the subquery, enter TRUE, FALSE, =TRUE, or =FALSE. Entering FALSE or =FALSE results in a NOT EXISTS query.</li>
</ol>
<p class=indent>
<b>Note</b> &nbsp; To create a NOT EXISTS query, create an EXISTS query as listed in the above steps, and set the Criteria column to FALSE. If you enter NOT EXISTS in the Grid pane, the Query Designer will display an error.</p>
<p>
If you enter a subquery in the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefSQLPane">
</object><a href=JavaScript:alink_2.Click()>SQL pane</a>, you will probably find it easier to use Cut and Paste commands to create the query.</p>
<p class=label>
<b>To define a subquery in the SQL pane</b>
<ol>
<li>
Create the primary query.<br><br></li>
<li>
In the <b>SQL</b> pane, select the SQL statement, and then use the <b>Copy</b> command to move the query to the Clipboard.<br><br></li>
<li>
Start the new query, and then use the <b>Paste</b> command to move the first query into the new query’s WHERE or FROM clause.</li>
</ol>
<p>
For example, imagine you have two tables, <code>products</code> and <code>suppliers</code>, and you want to create a query showing all products for suppliers in Sweden. Create the first query on the <code>suppliers</code> table to find all Swedish suppliers:</p>
<pre><code>SELECT supplier_id
FROM supplier
WHERE (country = 'Sweden')
</code></pre>
<p>
Use the Copy command to move this query to the Clipboard. Create the second query using the <code>products</code> table, listing the information you need about products:</p>
<pre><code>SELECT product_id, supplier_id, product_name
FROM products
</code></pre>
<p>
In the SQL pane, add a WHERE clause to the second query, then paste the first query from the Clipboard. Place parentheses around the first query, so that the end result looks like this:</p>
<pre><code>SELECT product_id, supplier_id, product_name
FROM products
WHERE supplier_id IN
 &nbsp; (SELECT supplier_id
  FROM supplier
  WHERE (country = 'Sweden'))
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When you add a subquery to the WHERE clause, the subquery appears in the <b>Criteria</b> column of the Grid pane. You can edit it further in either the Grid pane or SQL pane. However, the input sources, columns, and <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgexpression">expressions</a> referenced in the subquery are not displayed in the Diagram or Grid pane.</p>
</BODY>
</HTML>
