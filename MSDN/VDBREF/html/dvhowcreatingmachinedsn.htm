<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Machine DSN</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowcreatingmachinedsn"></a>Creating a Machine DSN</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingMachineDSN_C">
</object></p>
<p>
A machine data source name (DSN) stores information about a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgdataconnection">data connection</a> in the Windows<sup>®</sup> Registry of the computer on which the DSN was created.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The information stored in the registry is the same information that is stored in a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgfiledsn">file DSN</a>. However, you cannot use a machine DSN to create a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgdsn-lessconnection">DSN-less connection</a> as you can a file DSN. For more information about the DSN-less connection, see <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingFileDSN">
</object><a href=JavaScript:alink_2.Click()>Creating a File DSN</a>.</p>
<p>
In a file DSN, connection information is stored in the Global.asa file. In a machine DSN, the Global.asa file contains a pointer to the information stored in the Windows Registry. Therefore, every computer that uses the project (including the Web server) must have the connection information in exactly the same Registry address. This makes a machine DSN less portable than a file DSN.</p>
<p>
However, if you use a machine DSN during development, it is easy to change the database you are working with simply by changing the entry in the Windows Registry; you do not have to change the Global.asa file each time. In addition, machine DSNs are useful if you need to use the same DSN in many different applications on your computer.</p>
<p class=label>
<b>To create a new machine DSN</b>
<ol>
<li>
In the Project Explorer, right-click the database project you want to add a data connection to, and then select <b>Add</b> <b>Data Connection</b>.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;In Microsoft<sup>®</sup> Visual C++<sup>®</sup>, right-click the database project in <b>FileView</b>.</p></li>
<li>
Select the <b>Machine Data Source</b> tab.<br><br></li>
<li>
Choose <b>New</b>, and then choose whether you want to create a <b>User Data Source</b> or a <b>System Data Source</b>. A user data source is available only to the user who created it. A system data source is available to any user who logs onto the computer. When you have chosen the data source type, choose <b>Next</b>.<br><br></li>
<li>
Select the driver for which you want to set up a data source, and then choose <b>Next</b>.<br><br></li>
<li>
Review the information you have entered. If everything is as you want it, choose <b>Finish</b>. If you want to make changes, choose <b>Back</b>.<br><br></li>
<li>
Follow the instructions for the <b>Create a New Data Source</b> wizard or the dialog box that is displayed. For help with these dialog boxes, choose the <b>Help</b> button.<p class=tl>
For SQL Server data sources, you use the <b>Create a New Data Source</b> wizard. For other data sources, you use various dialog boxes. For example, for Microsoft<sup>®</sup> Access data sources, you use the <b>ODBC Microsoft Access 97 Setup</b> dialog box, and for Microsoft<sup>®</sup> FoxPro<sup>®</sup> data sources, you use the <b>ODBC Visual FoxPro Setup</b> dialog box.</P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When you specify a database, enter a location that will work not only in the development environment you are using, but also in your final project. For example, if your project involves a database that is accessed from a Web server, use a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgunc(universalnamingcode)">Universal Naming Code (UNC)</a> to be sure that the database location you specify is accessible from the Web server.</p></li>
</ol>
<p>
If you've created a machine DSN for a server-based database, you will be prompted with the login dialog box for the database server. You will be prompted again each time you connect to the database using the DSN.</p>
</BODY>
</HTML>
