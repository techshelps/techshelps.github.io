<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Summarizing Values for All Rows in a Table</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowsummarizingvaluesforallrowsintable"></a>Summarizing Values for All Rows in a Table</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowSummarizingValuesForAllRowsInTable_C;dvhowSummarizingValuesForAllRowsInTableC">
</object></p>
<p>
Using an <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgaggregatefunction">aggregate function</a>, you can create a summary for all the values in a table. For example, you can create a query such as the following to display the total price for all books in the <code>titles</code> table:</p>
<pre><code>SELECT SUM(price)
FROM titles
</code></pre>
<p>
You can create multiple summaries in the same query by using aggregate functions with more than one column. For example, you can create a query that calculates the total of the <code>price</code> column and the average of the <code>discount</code> column.</p>
<p>
You can also summarize the same column in different ways (such as totaling, counting, and averaging) in the same query. For example, the following query averages and summarizes the <code>price</code> column from the <code>titles</code> table:</p>
<pre><code>SELECT AVG(price), SUM(price)
FROM titles
</code></pre>
<p>
If you add a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsearchcondition">search condition</a>, you can summarize the subset of rows that meet that condition.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;You can also count all the rows in the table or the ones that meet a specific condition. For details, see <a href="dvhowcountingrowsintable.htm">Counting Rows in a Table</a>.</p>
<p>
When you create a single summary value for all rows in a table, you display only the summaries themselves. For example, if you are totaling the value of the <code>price</code> column of the <code>titles</code> table, you would not also display individual titles, publisher names, and so on.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you are subtotaling — that is, creating groups — you can display column values for each group. For details, see <a href="dvhowgroupingrowsinqueryresults.htm">Grouping Rows in Query Results</a>.</p>
<p class=label>
<b>To summarize values for all rows</b>
<ol>
<li>
Start the query by adding the table you want to summarize to the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefDiagramPane">
</object><a href=JavaScript:alink_2.Click()>Diagram pane</a>.<br><br></li>
<li>
From the <b>Query</b> menu, choose <b>Group By</b>. The Query Designer adds a <b>Group By</b> column to the grid in the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefGridPane">
</object><a href=JavaScript:alink_3.Click()>Grid pane</a>.<br><br></li>
<li>
Add the column you want to summarize to the <b>Grid</b> pane. Be sure that the column is marked for output.<p class=tl>
The Query Designer automatically assigns a column <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgalias">alias</a> to the column you are summarizing to create a useful column heading in query output. For more details, see <a href="dvhowcreatingcolumnaliases.htm">Creating Column Aliases</a>.</P></li>
<li>
In the <b>Group By</b> grid column, select the aggregate function that you want to use to summarize the data: <b>Sum</b>, <b>Avg</b>, <b>Min</b>, <b>Max</b>, <b>Count</b>. If you want to summarize only unique rows in the result set, choose an aggregate function with the DISTINCT options, such as <b>Min Distinct</b>. Do not choose <b>Group By</b>, <b>Expression</b>, or <b>Where</b>, because those options do not apply when you are summarizing all rows.<p>
<img src="dv3w9c1.gif" border=0></P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Oracle supports additional aggregate functions. For details, see <a href="dvconquerydesignerconsiderationsinoracledatabases.htm">Query Designer Considerations for Oracle Databases</a>.</p><p class=tl>
The Query Designer replaces the column name in the statement in the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefSQLPane">
</object><a href=JavaScript:alink_4.Click()>SQL pane</a> with the aggregate function that you specify. For example, the SQL statement might look like this:</P><pre><code>SELECT SUM(price)
FROM titles
</code></pre>
</li>
<li>
If you want to create more than one summary in the query, repeat steps 3 and 4.<p class=tl>
When you add another column to the query output list or order by list, the Query Designer automatically fills the term <b>Group By</b> into the <b>Group By</b> column of the grid. Select the appropriate aggregate function.</P></li>
<li>
Add search conditions, if any, to specify the subset of rows you want to summarize.</li>
</ol>
<p>
When you execute the query, the Results pane displays the summaries that you specified.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The Query Designer maintains aggregate functions as part of the SQL statement in the SQL pane until you explicitly turn off Group By mode. Therefore, if you modify your query by changing input sources or changing its type, the resulting query might include invalid aggregate functions.</p>
</BODY>
</HTML>
