<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Saving a Change Script</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowsavingchangescript"></a>Saving a Change Script</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowSavingChangeScript_C;dvhowSavingChangeScriptC">
</object></p>
<p>
You can save an SQL <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgchangescript">change script</a> if you don’t have security permissions to alter a database or if you’re not ready to update the database (for example, if you've made changes to the database diagram that conflict with changes made by other users). An <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsql">SQL</a> change script provides a record of your changes that can be applied to the database at a later time using a database tool (for example, Microsoft<sup>®</sup> SQL Server’s™ isql command-line utility).</p>
<p class=label>
<b>To save a change script</b>
<ol>
<li>
From the <b>File</b> menu or the Database Designer toolbar, choose <b>Save Change Script</b>. This command is available whenever you have unsaved database changes in your diagram.<br><br></li>
<li>
In the <b>Save Change Script</b> dialog box, choose <b>Yes</b>.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If the option to automatically generate a change script is selected, a change script is generated whenever you save your database diagram or any changed database object in the diagram. This is helpful if you need to track the changes you have made to the database.
<ol start=3>
<li>
A message box displays the file name of the saved change script. Choose <b>OK</b>.</li>
</ol>
<p>
Each time you save a change script, a new text file named DbDgm<i>N</i>.sql (where <i>N</i> equals 1 for the first change script you generate and N+1 for the next change script) is created and saved in the current working directory.</p>
<p>
The change script file lists any changed tables and how they were changed (using the DROP TABLE, ALTER TABLE, or CREATE TABLE SQL statements). The change script file also contains any error handling code that is required to clean up temporary tables or to rollback transactions that were part of unsuccessful changes (changes that couldn't be saved). In addition, the change script file contains code to make the script run successfully against the database and code (Print statements) that describe what the script is doing when it runs.</p>
<p>
Any error messages that occurred while the changes were saved are stored in a log file, with the same name as the script file, except with a .log extension. You can also view messages showing which tables were successfully and unsuccessfully saved in the Log Viewer.</p>
</BODY>
</HTML>
