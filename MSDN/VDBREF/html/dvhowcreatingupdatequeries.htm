<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Update Queries</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowcreatingupdatequeries"></a>Creating Update Queries</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingUpdateQueries_C;dvhowCreatingUpdateQueriesC">
</object></p>
<p>
You can change the contents of multiple rows in one operation by using an <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgupdatequery">Update query</a>. For example, in a <code>titles</code> table you can use an Update query to add 10% to the price of all books for a particular publisher.</p>
<p>
When you create an Update query, you specify:
<ul type=disc>
<li>
The table to update<br><br></li>
<li>
The columns whose contents you want to update<br><br></li>
<li>
The value or <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgexpression">expression</a> to use to update the individual columns<br><br></li>
<li>
<a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsearchcondition">Search conditions</a> to define the rows you want to update</li>
</ul>
<p>
For example, the following query updates the <code>titles</code> table by adding 10% to the price of all titles for one publisher:</p>
<pre><code>UPDATE titles
SET price = price * 1.1
WHERE (pub_id = '0766')
</code></pre>
<p>
For general information about using queries to update tables, see <a href="dvconusingqueriestomodifydata.htm">Modifying Data Using Queries</a>.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;You cannot undo the action of executing an Update query. As a precaution, back up your data before executing the query.</p>
<p class=label>
<b>To create an Update query</b>
<ol>
<li>
Add the table you want to update to the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefDiagramPane">
</object><a href=JavaScript:alink_2.Click()>Diagram pane</a>.<br><br></li>
<li>
Convert the default query to an Update query by choosing <b>Change Type</b> from the <b>Query</b> menu or the Query Designer Toolbar, and then choosing <b>Update</b>.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp; If more than one table is displayed in the <b>Diagram</b> pane when you start the Update query, the Query Designer displays the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefUpdateTableDialogBox">
</object><a href=JavaScript:alink_3.Click()>Update Table</a> dialog box to prompt you for the name of the table to update.</p><p>
<img src="dv3waf3.gif" border=0></P></li>
<li>
Define the data columns to update by adding them to the query. For details, see <a href="dvhowaddingcolumns.htm">Adding Columns</a>. Columns will be updated only if you add them to the query.<br><br></li>
<li>
In the <b>New Value</b> column of the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefGridPane">
</object><a href=JavaScript:alink_4.Click()>Grid pane</a>, enter the update value for the column. You can enter literal values, column names, or expressions. The value must match (or be compatible with) the data type of the column you are updating.<p>
<img src="dv3waf1.gif" border=0></P><p class=atl>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;The Query Designer cannot check that a value fits within the length of the column you are updating. If you provide a value that is too long, it might be truncated without warning. For example, if a <code>name</code> column is 20 characters long but you specify an update value of 25 characters, the last 5 characters might be truncated.</p></li>
<li>
Define the rows to update by entering search conditions in the <b>Criteria</b> column. For details, see <a href="dvhowspecifyingsearchconditions.htm">Specifying Search Conditions</a>.<p>
<img src="dv3waf2.gif" border=0></P><p class=tl>
If you do not specify a search condition, all rows in the specified table will be updated.</P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When you add a column to the Grid pane for use in a search condition, the Query Designer also adds it to the list of columns to be updated. If you want to use a column for a search condition but not update it, clear the check box next to the column name in the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsginputsource">input source</a> window (&nbsp;<img src="dv3wbi9.gif" border=0>&nbsp;).</p></li>
</ol>
<p>
When you execute an Update query, no results are reported in the <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefResultsPane">
</object><a href=JavaScript:alink_5.Click()>Results pane</a>. Instead, a message appears indicating how many rows were changed.</p>
</BODY>
</HTML>
