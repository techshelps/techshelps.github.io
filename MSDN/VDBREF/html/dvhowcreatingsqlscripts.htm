<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating SQL Scripts</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowcreatingsqlscripts"></a>Creating SQL Scripts</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingSQLScripts_C;dvhowCreatingSQLScriptsC">
</object></p>
<p>
You can create and modify database objects in a database project using SQL script files. These files contain DDL (<a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgdatadefinitionlanguage(ddl)">data definition language</a>) SQL statements that define and modify database objects.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;In Microsoft<sup>®</sup> Visual InterDev™, you can use the <b>Copy SQL Script</b> command in the Data View window to create a SQL script that will create the selected database object when added to a database project and executed. For more information, see <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vihowPopulatingDatabaseProject">
</object><a href=JavaScript:alink_2.Click()>Populating a Database Project</a>.</p>
<p class=label>
<b>To create a new SQL script file and add it to a project in Visual InterDev or Visual J++™</b>
<ol>
<li>
Expand the database project folder in the Project Explorer.<br><br></li>
<li>
Right-click the data connection and choose <b>Add SQL Script</b>.<p class=tl>
The <b>Add Item</b> dialog box is displayed.</P><p class=atl>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;You can also right-click the project name and select <b>Add Item</b> to open the <b>Add Item</b> dialog box.</p></li>
<li>
Select <b>SQL Script</b> in the right pane. Enter a name for the SQL script in the <b>Name</b> box if you want. Click <b>Open</b>.<p class=tl>
The SQL Editor window is displayed and the SQL script is added to the Project Explorer under the data connection node.</P></li>
<li>
Enter SQL statements in the SQL Editor window that define the database objects you want to add to this database project. Follow the conventions of your database. For more information, see your database documentation.</li>
</ol>
<p>
You can also add specialized SQL scripts to your database project using the templates provided with the Visual Database Tools. You can select an SQL script file that creates a table, view, stored procedure, or trigger. You can use these supplied SQL script files as templates for creating your own SQL scripts</p>
<p class=label>
<b>To create specialized script files based on templates in Visual InterDev or Visual J++</b>
<ol>
<li>
Expand the database project folder in the Project Explorer.<br><br></li>
<li>
Right-click the data connection and choose <b>Add SQL Script</b>.<p class=tl>
The <b>Add Item</b> dialog box is displayed.</P><p class=atl>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;You can also right-click the project name and select <b>Add Item</b> to open the <b>Add Item</b> dialog box.</p></li>
<li>
Select <b>Table Script</b> in the right pane. Enter a name for the SQL script in the <b>Name</b> box if you want. Click <b>Open</b>.<p class=tl>
The SQL Editor window is displayed and the SQL script is added to the Project Explorer under the data connection.</P></li>
<li>
Modify the existing SQL statements in the SQL Editor window to define the database object you want to add to this database project. Follow the conventions of your database. For more information, see your database documentation.</li>
</ol>
<p>
Once you've created the SQL script you want, you can execute it to create or modify database objects using the SQL statements in the SQL script file. You can execute the script file from Project Explorer using the Execute command or by double-clicking the script name in the SQL Editor. For more information, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowExecutingSQLScript">
</object><a href=JavaScript:alink_3.Click()>Executing an SQL Script</a>.</p>
<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;An SQL script must be executed against a database. You can execute an SQL script against any database for which there's a data connection in your database project.</p><p>
You can also modify database objects in the Data View window using the Visual Database Tools. For more information, see <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconWorkingWithDatabaseProjects">
</object><a href=JavaScript:alink_4.Click()>Working with Database Projects</a>.</p>
<p class=label>
<b>To create a new SQL script and add it to a project in Visual C++<sup>®</sup></b>
<ol>
<li>
From the <b>File</b> menu, choose <b>New</b>.<br><br></li>
<li>
Choose the <b>Files</b> tab, and then select <b>ODBC Script File</b>.<br><br></li>
<li>
Check <b>Add to Project</b>.<br><br></li>
<li>
Select the name of the database project you want to add the file to.<br><br></li>
<li>
In the <b>File Name</b> box, type a name for the script file, and then choose <b>OK</b>.<br><br></li>
<li>
Enter the SQL script, and then save it by choosing <b>Save</b> or <b>Save As</b> from the <b>File</b> menu.</li>
</ol>
<p>
After you have added an SQL script file to the project, you can add commands to the file. For example, you can create the following SQL script to display in the Output window the version number of a Microsoft<sup>®</sup> SQL Server™ database:</p>
<pre><code>SELECT @@Version
</code></pre>
<p>
You can run this script against any Microsoft SQL Server database.</p>
<p>
You can also create an SQL script to execute a stored procedure. For example, in a Microsoft SQL Server database, you can create an SQL script that runs a built-in stored procedure, such as <code>sp_help</code> or <code>sp_who</code>.</p>
<p class=label>
<b>To create an SQL script that executes a stored procedure</b>
<ol>
<li>
Create a new SQL script file.<br><br></li>
<li>
Type <b>Exec</b> followed by the name of the stored procedure to execute, as in the following two commands:<pre><code>Exec sp_who
Exec sp_help
</code></pre>
</li>
<li>
Save the script.</li>
</ol>
</BODY>
</HTML>
