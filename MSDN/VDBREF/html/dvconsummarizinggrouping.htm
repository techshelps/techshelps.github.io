<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Summarizing and Grouping</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvconsummarizinggrouping"></a>Summarizing and Grouping</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconSummarizingGrouping_C;dvconSummarizingGroupingC">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconSummarizingGrouping_T;dvconSummarizingGroupingT">
</object></p>
<p>
In addition to creating queries that display individual data rows, you can create aggregate queries—queries that summarize information from multiple rows. For example, you can create a query that averages the contents of a <code>price</code> column. You can create the average for all rows in a table, or for groups of related rows — for example, all the rows that apply to a particular customer.</p>
<p>
In this topic you can find information about summarizing and grouping information using queries.
<ul type=disc>
<li>
<a href="#dvmscsummaryqueries">Summary Queries</a><br><br></li>
<li>
<a href="#dvmscsummarizingdata">Summarizing Data</a><br><br></li>
<li>
<a href="#dvmscgroupingrows">Grouping Rows</a></li>
</ul>
<h2><a name="dvmscsummaryqueries"></a>Summary Queries</h2>
<p>
Using summary queries, you can:
<ul type=disc>
<li>
Create totals or averages of the data in numeric columns. For example, in an <code>orders</code> table, you can find the total of the <code>order_total</code> column to discover the sales total for a day.<br><br></li>
<li>
Count the number of rows that meet specific criteria. For example, in a <code>customers</code> table, you can find out how many customers are in the state of California.<br><br></li>
<li>
Find the minimum or maximum value in a specific column. For example, in an <code>invoices</code> table, you can find the highest sale made this month.</li>
</ul>
<p>
You can create summary queries on a table as a whole, or you can summarize subsets of a table by subdividing the table into groups.</p>

<h2><a name="dvmscsummarizingdata"></a>Summarizing Data</h2>
<p>
To summarize all the data in a table, you create an <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgaggregatequery">aggregate query</a> that involves a function such as SUM(&nbsp;) or AVG(&nbsp;). When you run the query, the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgresultset">result set</a> contains a single row with the summary information. For example, you can calculate the total price of all books in the <code>titles</code> table by creating a query that sums the contents of the <code>price</code> column. The resulting query output might look like this:</p>
<p>
<img src="dv3w9a1.gif" border=0></p>
<p>
The corresponding <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsql">SQL</a> statement might look like this:</p>
<pre><code>SELECT SUM(price) total_price
FROM titles
</code></pre>
<p>
You can use the following <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgaggregatefunction">aggregate functions</a>:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=36%><b>Aggregate function</b></td>
<td class=label width=64%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=36%>AVG(<i>expr</i>)</td>
<td width=64%>Average of the values in a column. The column can contain only numeric data.</td>
</tr>
<tr valign=top>
<td width=36%>COUNT(<i>expr</i>), COUNT(*)</td>
<td width=64%>A count of the values in a column (if you specify a column name as <i>expr</i>) or of all rows in a table or group (if you specify *). COUNT(<i>expr</i>) ignores null values, but COUNT(*) includes them in the count.</td>
</tr>
<tr valign=top>
<td width=36%>MAX(<i>expr</i>)</td>
<td width=64%>Highest value in a column (last value alphabetically for text data types). Ignores null values.</td>
</tr>
<tr valign=top>
<td width=36%>MIN(<i>expr</i>)</td>
<td width=64%>Lowest value in a column (first value alphabetically for text data types). Ignores null values.</td>
</tr>
<tr valign=top>
<td width=36%>SUM(<i>expr</i>)</td>
<td width=64%>Total of values in a column. The column can contain only numeric data.</td>
</tr>
</table><br>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Oracle supports additional aggregate functions. For details, see <a href="dvconquerydesignerconsiderationsinoracledatabases.htm">Query Designer Considerations for Oracle Databases</a>.</p>
<p>
When you use an aggregate function, by default the summary information includes all specified rows. In some instances, a result set includes non-unique rows. You can filter out non-unique rows by using the DISTINCT option of an aggregate function.</p>
<p>
You can combine aggregate functions with other expressions to calculate other summary values. For details, see <a href="dvhowsummarizingvaluesusingcustomexpressions.htm">Summarizing Values Using Custom Expressions</a>.</p>
<h2><a name="dvmscgroupingrows"></a>Grouping Rows</h2>
<p>
To create summary values for groups of rows, you create a query containing a GROUP BY clause. All the rows that contain the same group value are summarized into one row of the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgresultset">result set</a>. The result set contains as many rows as there are unique values in the column you choose to group. If you group by multiple columns, the result set contains unique values for each combination of grouping columns you specify.</p>
<p>
For example, you can query a <code>titles</code> table to find out the average price of a book for each publisher. To do so, you group the <code>pub_id</code> column so that all the rows for a specific publisher are summarized. The result set might look like this:</p>
<p>
<img src="dv3w9a2.gif" border=0></p>
<p>
The corresponding <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsql">SQL</a> statement might look like this:</p>
<pre><code>SELECT pub_id, AVG(price) AveragePrice
FROM titles
GROUP BY pub_id
</code></pre>
</BODY>
</HTML>
