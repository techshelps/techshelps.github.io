<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Save Incomplete Dialog Box</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvrefsaveincompletedialogbox"></a>Save Incomplete Dialog Box</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefSaveIncompleteDialogBox_C;dvrefSaveIncompleteDialogBoxC">
</object>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefSaveIncompleteDialogBox_T;dvrefSaveIncompleteDialogBoxT">
</object></p>
<p>
Appears when errors have been encountered while you were trying to save a database diagram or selected tables. This dialog box lists the following: the objects that were successfully saved in the database, the objects that were not saved, and the errors that were encountered.</p>
<h2>Options</h2>
<h3>OK</h3>
<p class=indent>
Returns to the diagram.</p>
<h3>Save Text File</h3>
<p class=indent>
Saves the information shown in a text file in the project directory and displays a message box with the fully qualified file name of the text file. This file provides a record of the database changes that were successfully saved as well as the changes that could not be saved due to errors.</p>
<p>
For more information about the errors that can occur, see:
<ul type=disc>
<li>
<a href="#dvmsgerrormodifyingcolumnproperties">Error modifying column properties</a><br><br></li>
<li>
<a href="#dvmsginvalidcursorstate">Invalid cursor state</a><br><br></li>
<li>
<a href="#dvmsgunabletoaddconstraint">Unable to add constraint</a><br><br></li>
<li>
<a href="#dvmsgunabletocreateindex">Unable to create index</a><br><br></li>
<li>
<a href="#dvmsgunabletocreaterelationship">Unable to create relationship</a><br><br></li>
<li>
<a href="#dvmsgunabletomodifytable">Unable to modify table</a><br><br></li>
<li>
<a href="#dvmsgunabletopreservetrigger">Unable to preserve trigger</a></li>
</ul>
<p>
If the error you want to troubleshoot does not appear in this list, see <a href="#dvmsgsystemerrors">System errors</a> for additional messages returned by Microsoft<sup>®</sup> SQL Server™.</p>

<h2><a name="dvmsgerrormodifyingcolumnproperties"></a>Error modifying column properties</h2>
<p>
Appears when your <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgconstraint">constraint</a> <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgexpression">expression</a> contains an error.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]The name <i>'[column value]'</i> is illegal in this context. Only constants, constant expressions, or variables allowed here. Column names are illegal.</p>
<h4>Cause</h4>
<p>
A <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgdefault">default</a> value defined for a character column is not enclosed in single quotation marks (').</p>
<h4>Recommended solution</h4>
<p>
Enclose the value in single quotation marks in the database column's Default Value cell. and then save the table.</p>

<h2><a name="dvmsginvalidcursorstate"></a>Invalid cursor state</h2>
<p>
Appears when Microsoft<sup>®</sup> SQL Server™ runs out of resources while attempting to save selected <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgtable">tables</a> or a database diagram.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver]Invalid cursor state.</p>
<h4>Cause</h4>
<p>
There is insufficient space in your database or <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgtransactionlog">transaction log</a> to complete the save process.</p>
<h4>Recommended solution</h4>
<p>
Check to see if the database or the transaction log is full. If so, increase the size of the database to accommodate the change. Check other system resources or contact your System Administrator.</p>
<p>
For more information about increasing the size of your database, see "Expanding or Shrinking Databases" in <i>SQL Server Books Online.</i></p>

<h2><a name="dvmsgunabletoaddconstraint"></a>Unable to add constraint</h2>
<p>
Appears when a new <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgconstraint">constraint</a> has failed on existing data or your constraint <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgexpression">expression</a> contains an error. Compare the ODBC error text that appears in the <a href="#dvrefsaveincompletedialogbox">Save Incomplete dialog box</a> with the error text shown below to determine the appropriate solution.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Data exists in table '<i>[table name]'</i>, database <i>'[database name]'</i>, that violates CHECK constraint <i>'[constraint name]'</i> being added. ALTER command has been aborted.</p>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Unable to create constraint. See previous errors.</p>
<h4>Cause</h4>
<p>
Existing data does not match the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgcheckconstraint">check constraint</a>.</p>
<h4>Recommended solution</h4>
<p>
Change the data (for example, by using Query Designer) to match the constraint. For details, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvovrQueryDesigner">
</object><a href=JavaScript:alink_3.Click()>Query Designer</a>.</p>
<p class=tl>
-or-</P><p>
Clear the <b>Check existing data on creation</b> check box in the Tables <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgpropertypage">property page</a> for the check constraint in question. For more information about disabling this property, see <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCheckingExistingDataWhenCreatingRelationship">
</object><a href=JavaScript:alink_4.Click()>Checking Existing Data when Creating a Relationship</a>.</p>
<p class=tl>
-or-</P><p>
Change the constraint expression in the Tables property page for the check constraint in question.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column <i>'[column name]'</i> specified in constraint definition.</p>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Unable to create constraint. See previous errors.</p>
<h4>Cause</h4>
<p>
The text value in the check constraint expression on the Tables property page is not enclosed in single quotation marks (').</p>
<p class=tl>
-or-</P><p>
A column that participates in the check constraint has been renamed. For example, if the original constraint had the expression (<code>cityname = 'Paris'</code>) and you renamed the column to <code>city</code>, you would see the same error except that <code>'cityname'</code> would be the invalid column shown in the error message.</p>
<h4>Recommended solution</h4>
<p>
Correct the expression and save the table.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Line <i>[line number]:</i> Incorrect syntax near <i>'[operator]'</i>.</p>
<h4>Cause</h4>
<p>
The expression defined for the check constraint (in the Tables property page) or the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgdefault">default</a> constraint (in the Default Value cell) is not valid <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgsql">SQL</a> syntax. For example, the check constraint expression <code>'city equals Paris'</code> was typed instead of <code>'city = Paris'</code>.</p>
<h4>Recommended solution</h4>
<p>
Correct the expression and save the table.</p>
<p>
For more information about constraints, see <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconConstraints">
</object><a href=JavaScript:alink_5.Click()>Constraints</a>.</p>

<h2><a name="dvmsgunabletocreateindex"></a>Unable to create index</h2>
<p>
Appears when a new <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgindex">index</a> has failed on existing data.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Create unique index aborted on duplicate key. Primary key is <i>'[primary key data]'</i></p>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Unable to create constraint. See previous errors.</p>
<h4>Cause</h4>
<p>
A unique index was created in the Indexes/Keys <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgpropertypage">property page</a> but duplicate data exists in the database. The value after the phrase "Primary key is" is the first duplicate value that Microsoft<sup>®</sup> SQL Server™ found as it created the index.</p>
<h4>Recommended solution</h4>
<p>
Remove duplicate data from the database (for example, by using Query Designer). For more information, see <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvovrQueryDesigner">
</object><a href=JavaScript:alink_6.Click()>Designing Queries</a>.</p>
<p class=tl>
-or-</P><p>
Change the option in the Indexes/Keys property page to allow duplicate rows in the index.</p>
<p>
For more information about creating unique indexes, see <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingUniqueIndex">
</object><a href=JavaScript:alink_7.Click()>Creating a Unique Index</a>.</p>

<h2><a name="dvmsgunabletocreaterelationship"></a>Unable to create relationship</h2>
<p>
Appears when a new <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgconstraint">constraint</a> has failed on existing data.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Data exists in table <i>'[table name]'</i>, database <i>'[database name]'</i>, that violates FOREIGN KEY constraint <i>'[constraint name]</i>' being added. ALTER command has been aborted.</p>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Unable to create constraint. See previous errors.</p>
<h4>Cause</h4>
<p>
Existing data fails the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgforeignkey">foreign key</a> constraint.</p>
<h4>Recommended solution</h4>
<p>
Change the data that fails the foreign key constraint by running a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgquery">query</a> to show all the foreign key values that do not match <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgprimarykey">primary key</a> values. For example, to find foreign key values in the <code>job_id</code> column of the <code>employee</code> table that do not match primary key values in the <code>jobs</code> table, run a query with this SQL syntax:</p>
<pre><code>SELECT&nbsp; employee.emp_id, employee.job_id
FROM&nbsp; employee LEFT OUTER JOIN jobs ON employee.job_id = jobs.job_id
WHERE (jobs.job_id IS NULL)
</code></pre>
<p>
For more information, see <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvovrCreatingQueries">
</object><a href=JavaScript:alink_8.Click()>Creating Queries</a>.</p>
<p class=tl>
-or-</P><p>
Clear the <b>Check existing data on creation</b> check box in the Relationships property page. For more information, see <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCheckingExistingDataWhenCreatingRelationship">
</object><a href=JavaScript:alink_9.Click()>Checking Existing Data when Creating a Relationship</a>.</p>

<h2><a name="dvmsgunabletomodifytable"></a>Unable to modify table</h2>
<p>
Appears when a new <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgconstraint">constraint</a> has failed on existing data. Compare the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgodbc(opendatabaseconnectivity)">ODBC</a> error text that appears in the <a href="#dvrefsaveincompletedialogbox">Save Incomplete dialog box</a> with the two ODBC errors shown below to determine the appropriate solution.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]The column <i>[column name]</i> in table Tmp_ <i>[table name]</i> may not be null.</p>
<h4>Cause</h4>
<p>
A new database <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgcolumn">column</a> has been added that doesn't allow null values and doesn't provide a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgdefault">default</a> value. The table name in question appears after "Tmp_".</p>
<h4>Recommended solution</h4>
<p>
Change the column properties. Either select the <b>Allow Nulls </b><a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgproperty">property</a> or type a <b>Default Value </b>setting. For more information about setting properties for database columns, see <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvovrColumnProperties">
</object><a href=JavaScript:alink_10.Click()>Column Properties</a>.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Attempt to insert the value NULL into column <i>'[column name]'</i>, table <i>'[database name] </i>TMP_ <i>[table name]'</i>; column does not allow nulls. INSERT fails.</p>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Command has been aborted.</p>
<h4>Cause</h4>
<p>
The Allow Nulls property on an existing database column has been cleared, but the column has existing null values in it. The table name in question appears after "TMP_".</p>
<h4>Recommended solution</h4>
<p>
Go to the column and select the <b>Allow Nulls </b>property.</p>
<p>
For more information about setting properties for database columns, see <object id=alink_11 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvovrColumnProperties">
</object><a href=JavaScript:alink_11.Click()>Column Properties</a>.</p>

<h2><a name="dvmsgunabletopreservetrigger"></a>Unable to preserve trigger</h2>
<p>
Appears when your <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgtrigger">trigger</a> text references a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgcolumn">column</a> that has been renamed, deleted, or assigned a different data type.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name <i>'[column name]'</i>.<br>
- Unable to preserve trigger <i>'[trigger name]'</i>.</p>
<h4>Cause</h4>
<p>
A change to the table required the table to be recreated. When a table is recreated, the triggers attached to that table are automatically recreated as well.</p>
<h4>Recommended solution</h4>
<p>
The recommended solution depends on the type of change made to the column referenced by the trigger.</p>
<p class=label>
<b>To preserve a trigger that references a renamed column</b>
<ul type=disc>
<li>
Rename the column to its original name and then save the table. This action will allow the table to be recreated. You can now rename the column, save the table again, and then edit the trigger to fix the renamed columns.</li>
</ul>
<p class=label>
<b>To preserve a trigger that references a deleted column</b>
<ol>
<li>
Expand the table that the trigger is attached to.<br><br></li>
<li>
Right-click the trigger you want to change and choose <b>Open</b> from the shortcut menu.<br><br></li>
<li>
Edit the trigger text and save the trigger.<br><br></li>
<li>
Save the table or database diagram.</li>
</ol>
<p class=label>
<b>To preserve a trigger that references a column whose data type changed</b>
<ol>
<li>
In your database diagram, click the <b>Save Change Script</b> button <img src="dv3w501.gif" border=0> in the <b>Database Diagram</b> toolbar. For more information, see <object id=alink_12 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowSavingChangeScript">
</object><a href=JavaScript:alink_12.Click()>Saving a Change Script</a>.<br><br></li>
<li>
Open the change script.<br><br></li>
<li>
In <b>Data View</b>, expand the table that the incorrect trigger is attached to.<br><br></li>
<li>
Delete the incorrect trigger. For details, see <object id=alink_13 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowDeletingTrigger">
</object><a href=JavaScript:alink_13.Click()>Deleting a Trigger</a>.<br><br></li>
<li>
Create a new trigger for the table. For details, see <object id=alink_14 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingTrigger">
</object><a href=JavaScript:alink_14.Click()>Creating a Trigger</a>.<br><br></li>
<li>
In the change script, select the trigger text. The set of statements that creates the trigger begins with a <code>CREATE TRIGGER </code>statement.<br><br></li>
<li>
Copy the selected text into the <b>Trigger</b> window.<br><br></li>
<li>
On the toolbar, click the <b>Save</b> button. This action saves the trigger in the database and adds the trigger to the table in the <b>Tables</b> folder.<br><br></li>
<li>
Repeat steps 3 through 8 for each trigger you want to recreate.</li>
</ol>
<p>
For more information about triggers, see <object id=alink_15 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconWorkingWithTriggers">
</object><a href=JavaScript:alink_15.Click()>Triggers</a> and your database documentation.</p>

<h2><a name="dvmsgsystemerrors"></a>System errors</h2>
<p>
Two system errors can appear in the <a href="#dvrefsaveincompletedialogbox">Save Incomplete dialog box</a> when you exceed Microsoft<sup>®</sup> SQL Server™ limitations that are not controlled by the Database Designer.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver][SQL Server]Can't allocate space for object 'Syslogs' in database 'Guest' because the 'logsegment' segment is full. If you ran out of space in Syslogs, dump the transaction log. Otherwise, use ALTER DATABASE or sp_extendsegment to increase the size of the segment.</p>
<h4>Cause</h4>
<p>
This error occurs because there is insufficient log space to complete the transaction.</p>
<h4>Recommended solution</h4>
<p>
Follow the recommendation in the message and delete the transaction log. (Typically this action will not entirely solve the problem.)</p>
<p class=tl>
-or-</P><p>
Increase the size of the database to accommodate the change. With large databases, changes that require the recreation of tables (for example, changing a column data type or size) may not be possible using the Database Designer. You may need to use methods of transferring data that don't require transactions, such as <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgbcp(bulkcopyprogram)">BCP</a>.</p>
<h4>ODBC error text</h4>
<p>
[Microsoft][ODBC SQL Server Driver]Timeout expired.</p>
<h4>Cause</h4>
<p>
The timeout can occur when you're updating the database with any Transact-SQL changes.</p>
<h4>Recommended solution</h4>
<p>
Try again later to save the diagram or selected tables.</p>
<p class=tl>
-or-</P><p>
Save a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgchangescript">change script</a> and apply it to the database at a later time. For more information, see <object id=alink_16 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowSavingChangeScript">
</object><a href=JavaScript:alink_16.Click()>Saving a Change Script</a>.</p>
<p class=tl>
-or-</P><p>
Increase the SQL Query Time-out value and try to save the diagram or selected tables again.</p>
<p class=label>
<b>To increase the SQL Query Time-out value</b>
<ol>
<li>
From the <b>Tools</b> menu, choose <b>Options</b>.<br><br></li>
<li value=1>
In the left pane, click <b>Data Tools</b>, and then click <b>Data View</b>.<br><br></li>
<li>
Type a new value in the <b>SQL query time-out</b> box.</li>
</ol>
<p>
For additional information about Microsoft SQL Server errors, see <i>SQL Server Books Online</i>.</p>
</BODY>
</HTML>
