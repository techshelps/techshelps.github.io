<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Clustered Index</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowcreatingclusteredindex"></a>Creating a Clustered Index</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowCreatingClusteredIndex_C;dvhowCreatingClusteredIndexC">
</object></p>
<p>
In Microsoft<sup>®</sup> SQL Server™ databases you can create a clustered index. In a clustered index, the physical order of the rows in the table is the same as the logical (indexed) order of the <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgkey">key</a> values. A table can contain only one clustered index. UPDATE and DELETE operations are often accelerated by clustered indexes because these operations require large amounts of data to be read.</p>
<p>
Consider using a clustered index for:
<ul type=disc>
<li>
Columns that contain a limited number of unique values, such as a <code>state</code> column that contains only 50 unique state codes.<br><br></li>
<li>
<a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgquery">Queries</a> that return a range of values, using operators such as BETWEEN, &gt;, &gt;=, &lt;, and &lt;=.<br><br></li>
<li>
Queries that return large <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgresultset">result sets</a>.</li>
</ul>
<p>
You can also use a clustered index to control what happens when a duplicate key or duplicate <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgrow">row</a> is created as a result of adding or updating data to the indexed table (with the INSERT or UPDATE statement).</p>
<p class=label>
<b>To create a clustered index</b>
<ol>
<li>
In your database diagram, select the table whose index you want to modify.<br><br></li>
<li>
Right-click the table, and choose <b>Properties</b> from the shortcut menu.<br><br></li>
<li>
Choose the <b>Indexes/Keys</b> tab.<br><br></li>
<li>
Create a new index. For details, see <a href="dvhowcreatingindex.htm">Creating an Index</a>.<p class=tl>
To modify an existing index, select the index from the <b>Selected index</b> list.</P></li>
<li>
Select the <b>Create as CLUSTERED</b> check box.<br><br></li>
<li>
Select one of the duplicate row options:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=28%><b>Option</b></td>
<td class=label width=72%><b>Treatment of duplicate rows</b></td>
</tr>
<tr valign=top>
<td width=28%><b>Disallow duplicate rows</b></td>
<td width=72%>The default option. If duplicate rows exist, the index cannot be created when you attempt to save the table.</td>
</tr>
<tr valign=top>
<td width=28%><b>Ignore duplicate rows</b></td>
<td width=72%>If duplicate rows exist, the index is created but duplicate rows are deleted when you save the table. When new rows are inserted, duplicates are not accepted and a SQL Server error appears when you attempt to save the table.</td>
</tr>
<tr valign=top>
<td width=28%><b>Allow duplicate rows</b></td>
<td width=72%>Duplicate rows are accepted in new and existing data.</td>
</tr>
</table><br>
</li>
</ol>
<p>
The index is created in the database when you save the table or diagram.</p>
</BODY>
</HTML>
