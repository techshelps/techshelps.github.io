<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sorting Data in a Clustered Index</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowsortingdatainclusteredindex"></a>Sorting Data in a Clustered Index</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowSortingDataInClusteredIndex_C;dvhowSortingDataInClusteredIndexC">
</object></p>
<p>
When you create or modify a clustered index in Microsoft<sup>®</sup> SQL Server™ database, you set an option to control when data is sorted in the index. You can either sort the data when the index is created, or sort and reorganize the data when the table has become fragmented. For details about what causes table fragmentation and for recommended solutions, see the DBCC statement in <i>SQL Server Books Online</i>.</p>
<p>
The option to sort the data when the index is created is always the faster of these two options because it doesn’t require the data to be copied or nonclustered indexes to be rebuilt.</p>
<p class=label>
<b>To sort index values</b>
<ol>
<li>
In your database diagram, select the table whose index values you want to sort.<br><br></li>
<li>
Right-click the table, and choose <b>Properties</b> from the shortcut menu.<br><br></li>
<li>
Choose the <b>Indexes/Keys</b> tab.<br><br></li>
<li>
Select the index from the <b>Selected index</b> list.<br><br></li>
<li>
Make sure the <b>Create as CLUSTERED</b> option is selected.<br><br></li>
<li>
Choose one of the sort options:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=30%><b>Option</b></td>
<td class=label width=70%><b>Action</b></td>
</tr>
<tr valign=top>
<td width=30%><b>Sort data</b></td>
<td width=70%>The default option. Sorts the data when the index is created.</td>
</tr>
<tr valign=top>
<td width=30%><b>Data already sorted</b></td>
<td width=70%>Eliminates the sort performed when a clustered index is created and verifies that the data has been sorted by checking each index value to determine whether it is higher than the previous one. If any row fails this check, the index cannot be created when you attempt to save the table.<p>
When the data satisfies the check, this option will always be faster than the <b>Reorganize sorted data</b> option because the data is not copied and nonclustered indexes will not be rebuilt. This option is useful when a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgfillfactor">fill factor</a> is specified to compact or expand the pages on which a table is stored.</p>
<p>
For more information about fill factors, see <a href="dvhowspecifyingfillfactorforindex.htm">Specifying a Fill Factor for an Index</a>.</p>
</td>
</tr>
<tr valign=top>
<td width=30%><b>Reorganize sorted data</b></td>
<td width=70%>Same as <b>Data already sorted</b>, except that this option will always be slower because the data is copied and nonclustered indexes will be rebuilt. Reorganizing the data is a good idea when a table becomes fragmented and you want to re-sort index values.</td>
</tr>
</table><br>
</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;<b>Data already sorted</b> creates the clustered index with the SORTED_DATA option. <b>Reorganize sorted data</b> creates the clustered index with the SORTED_DATA_REORG option. If you select either option and any row fails the check, the attempt to create the index when you save the table will fail. In the event of such a failure, you can either fix the data or choose the <b>Sort data</b> option.</p>
</BODY>
</HTML>
