<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mapping Many-to-Many Relationships to a Database Diagram</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="dvhowmappingmany-to-manyrelationshipstodatabasediagram"></a>Mapping Many-to-Many Relationships to a Database Diagram</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvhowMappingMany-to-ManyRelationshipsToDatabaseDiagram_C;dvhowMappingMany-to-ManyRelationshipsToDatabaseDiagramC">
</object></p>
<p>
Many-to-many relationships enable you to relate many rows in one table to many rows in another table. For example, you could create a many-to-many relationship between the <code>authors</code> table and the <code>titles</code> table to match multiple authors to all of their books. Creating a <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgone-to-manyrelationship">one-to-many relationship</a> from either table would incorrectly assume a book can have only one author, or that an author can write only one book.</p>
<p>
Many-to-many relationships between tables are accommodated in database diagrams by means of <a href="dvovrvisualdatabasetoolsglossary.htm#dvmsgjunctiontable">junction tables</a>. A junction table contains the primary key columns of the two tables you want to relate. You then create a relationship from the primary key columns of each of those two tables to the matching columns in the junction table.</p>
<p class=label>
<b>To create a many-to-many relationship between tables</b>
<ol>
<li>
In your database diagram, add the tables that you want to create a many-to-many relationship between.<br><br></li>
<li>
Create a third table by right-clicking the diagram and choosing <b>New Table</b> from the shortcut menu. This will become the junction table. For details, see <a href="dvhowaddingtabletodatabasediagram.htm">Adding Tables to a Database Diagram</a>.<br><br></li>
<li>
In the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvrefChooseNameDialogBox">
</object><a href=JavaScript:alink_2.Click()>Choose Name</a> dialog box, change the system-assigned table name. For example, the junction table between the <code>titles</code> table and the <code>authors</code> table is now named <code>titleauthors</code>. For details, see <a href="dvhowrenamingtable.htm">Renaming a Table</a>.<br><br></li>
<li>
Copy the primary key columns from each of the other two tables to the junction table. You can add other columns to this table, just as you can to any other table. For details, see <a href="dvhowcopyingcolumnsfromonetabletoanother.htm">Copying Columns from One Table to Another</a>.<br><br></li>
<li>
In the junction table, set the primary key to include all the primary key columns from the other two tables. For details, see <a href="dvhowdefiningprimarykey.htm">Defining a Primary Key</a>.<br><br></li>
<li>
Define a one-to-many relationship between each of the two primary tables and the junction table. For details, see <a href="dvhowcreatingrelationshipbetweentables.htm">Creating a Relationship Between Tables</a>.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The creation of a junction table in a database diagram does not insert data from the related tables into the junction table. For information about inserting data into a junction table, see <a href="dvhowcreatinginsertqueries.htm">Creating Insert Queries</a>.</p>
</BODY>
</HTML>
