<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting Information About the Taskbar</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>Getting Information About the Taskbar</h2>

<p>You can also use SHAppBarMessage to get information about the
system's taskbar&#151;specifically, information about the
taskbar's position. In SHELLFUN, the user can do this by choosing
a menu option. </p>

<p><tt>case IDM_TASKBAR:<br>
{<br>
APPBARDATA abd;<br>
char buff [MAX_PATH];<br>
<br>
memset (buff, `\0', sizeof (buff));<br>
<br>
abd.cbSize = sizeof (APPBARDATA);<br>
SHAppBarMessage (ABM_GETTASKBARPOS, &amp;abd);<br>
<br>
wsprintf (buff, &quot;Left: %d, Right: %d, Top: %d, Bottom:
%d&quot;,<br>
abd.rc.left, abd.rc.right, abd.rc.top, abd.rc.bottom);<br>
<br>
// Update the multiline edit control.<br>
SendMessage (hwndEdit, WM_SETTEXT, 0, (LPARAM)buff);<br>
break;<br>
}</tt> </p>

<p>The information returned from the call to SHAppBarMessage is
displayed in the multiline edit control in the client area of the
main SHELLFUN window, as shown in Figure 11-8. </p>

<p><b>Figure 11-8.</b> </p>

<p><img src="fig11-8.gif" width="355" height="119"></p>

<h4><i>Taskbar information retrieved by the SHELLFUN sample.</i> </h4>
</body>
</html>
