<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>An Example of Registering a File Viewer</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>An Example of Registering a File Viewer</h2>

<p>Let's look at an example of registering a file viewer for text
(TXT) files. The viewer is implemented in an in-process server
DLL called MFCVIEW.DLL, whose class identifier is
e83b63c0-6ff5-11ce-993c-00aa004adb6c. The actual Registry entries
appear in the REG file shown here: </p>

<p><tt>REGEDIT4<br>
<br>
[HKEY_CLASSES_ROOT\CLSID\{e83b63c0-6ff5-11ce-993c-00aa004adb6c}]<br>
@=&quot;Nancy's Viewer&quot;<br>
[HKEY_CLASSES_ROOT\CLSID\{e83b63c0-6ff5-11ce-993c-00aa004adb6c}<br>
\InprocServer32]<br>
@=&quot;c:\\windows\\system\\viewers\\mfcview.dll&quot;<br>
&quot;ThreadingModel&quot;=&quot;Apartment&quot;<br>
<br>
[HKEY_CLASSES_ROOT\QuickView\.TXT]<br>
@=&quot;txtfile&quot;<br>
[HKEY_CLASSES_ROOT\QuickView\.TXT\{e83b63c0-6ff5-11ce-993c-<br>
00aa004adb6c}]<br>
@=&quot;Nancy's Viewer&quot;<br>
<br>
[HKEY_CLASSES_ROOT\txtfile\CLSID]<br>
@=&quot;{e83b63c0-6ff5-11ce-993c-00aa004adb6c}&quot;</tt> </p>

<p>The first line, <i>REGEDIT4</i>, specifies that the
registration file follows a new (Windows 95) syntax. Notice the
syntax of the entries, with square brackets (&nbsp;[ ]&nbsp;)
surrounding each key and each value enclosed in quotation marks.
This syntax allows you to specify the InprocServer32 and
ThreadingModel subkeys. The threading model in this code is set
to <i>Apartment</i>, which specifies that multiple threads in the
executable can create OLE objects. (Although long lines in the
REG file above are broken to fit on the printed page, you must
enter each one as a single unbroken line. There is no
continuation character.) </p>
</body>
</html>
