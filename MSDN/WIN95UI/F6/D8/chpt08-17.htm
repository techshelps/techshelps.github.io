<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Hiding File Extensions</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>Hiding File Extensions</h2>

<p>Windows 95 interface components such as Windows Explorer strip
off the file extension by default when displaying the name of a
file. (You can set an option to display the MS-DOS file
extensions.) If you run Windows Explorer in details view, you
will see a file &#147;type,&#148; but this is not necessarily the
file extension. For example, in the Type column for a Microsoft
Word file, you'll see the more explanatory phrase <i>Microsoft
Word Document</i> rather than the DOC extension. </p>

<p>An application can get the filename to display (that is, the
filename with the extension stripped off)through various methods,
such as the SHGetFileInfo function. This function provides an
easy way to get the attributes of a file, given the full path.
SHGetFileInfo uses a structure called SHFILEINFO that contains
the handle to the icon, the index to the icon, the file
attributes, the display name (or the path for a folder), and the
file type. Table 8-1 lists the flags that you can specify when
calling SHGetFileInfo. </p>

<table border="1">
    <tr>
        <td valign="top"><b>Flag</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">SHGFI_ICON</td>
        <td valign="top">Retrieves the icon associated with the
        file.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_DISPLAYNAME</td>
        <td valign="top">Retrieves the file's display name.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_TYPENAME</td>
        <td valign="top">Retrieves the file's type name.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_ATTRIBUTES</td>
        <td valign="top">Retrieves the attributes of the file.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_ICONLOCATION</td>
        <td valign="top">Retrieves the icon location.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_EXETYPE</td>
        <td valign="top">Retrieves the executable type of the
        file.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_SYSICONINDEX</td>
        <td valign="top">Retrieves the system icon index.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_LINKOVERLAY</td>
        <td valign="top">Places a link overlay on the icon.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_SELECTED</td>
        <td valign="top">Displays the icon in selected state.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_LARGEICON</td>
        <td valign="top">Retrieves the large icon.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_SMALLICON</td>
        <td valign="top">Retrieves the small icon.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_OPENICON</td>
        <td valign="top">Retrieves the open icon.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_SHELLICONSIZE</td>
        <td valign="top">Retrieves the icon size used by the
        shell.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_PIDL</td>
        <td valign="top">The path specified in the <i>pszPath</i>
        parameter is a pointer to an ITEMID list.</td>
    </tr>
    <tr>
        <td valign="top">SHGFI_USEFILEATTRIBUTES</td>
        <td valign="top">The file attributes passed in the <i>dwFileAttributes</i>
        parameter should be used.</td>
    </tr>
</table>

<p><b>Table 8-1.</b> </p>

<p><i>File information flags.</i> </p>

<p>Although generally you should not display file extensions,
they are nevertheless useful to the application programmer. An
application designer can use unique file extensions to
differentiate his or her files from other files in the system. So
feel free to employ them&#151;but don't show them to the user
unless you must. </p>
</body>
</html>
