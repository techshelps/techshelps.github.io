<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Chapter Twelve: File Viewers</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><b>Chapter Twelve: File Viewers</b> </h1>

<p>Let's say that you have created some Microsoft Word documents
named STUFF1.DOC, STUFF2.DOC, and STUFF3.DOC. Now let's say that
you want to give those files to a reviewer who doesn't use Word.
(Heresy, I know, but there's always one in the crowd.) You can of
course resave the documents as text files that can be read with
any text editor. Or, if the reviewer happens to be running the
Microsoft Windows 95 operating system, he or she can use a file
viewer to check out the files. </p>

<p>A file viewer, one of the new features of Windows 95, allows a
user to quickly see the contents of a file without having to run
the full application that created the file&#151;in fact, without
even requiring the presence of that application. The file viewer
not only displays a file's contents but also provides a user
interface that can include items such as a menu, a toolbar, and a
status bar. </p>

<p>To use a file viewer, you first right-click a file to display
its context menu, which will look something like the menu shown
in Figure 12-1 on the next page. Then simply choose the Quick
View option from the context menu to display the file contents in
a file viewer. (Alternatively, you can select the file and choose
Quick View from the File menu in Windows Explorer.) </p>

<p>Before you go off and try this on your computer, however, be
aware that the Quick View option will not appear on a file's
context menu unless a file viewer is registered for that
particular type of file (DOC, TXT, AVI, and so on). The option is
displayed only if you have a file viewer installed and if that
file viewer has registered itself properly in the Registry. When
you right-click a file, the system checks the Registry to find a
viewer for that file based on the file's extension and class. If
no file viewer is registered for that file type, the Quick View
option doesn't appear on the context menu. </p>

<p><b>Figure 12-1.</b> </p>

<p><img src="fig12-1.gif" width="122" height="212"></p>

<h4><i>A context menu containing the Quick View option.</i> </h4>

<p>If you install the sample I wrote for this chapter, MFCVIEW,
you will have a rudimentary file viewer for text files, shown in
Figure 12-2. You need to copy the dynamic-link library to your
\WINDOWS\SYSTEM\VIEWERS folder and then run the MFCVIEW.REG file.
The DLL is registered to reside in this path; if you want to
place the DLL somewhere else, change the REG file to reflect the
new location. (If you rebuild the project, the DLL file will
automatically be placed in \WINDOWS\SYSTEM\VIEWERS. You can
change this location by going to the Project menu, choosing
Settings, clicking the Link tab, and changing the Output File
Menu item. Then click the Debug tab and edit the Executable For
Debug Session and the Working Directory items. You must alter
these three items for both Win32 Debug and Win32 Release. Note
that you must still change and run the REG file.) </p>

<p><b>Figure 12-2.</b> </p>

<p><img src="fig12-2.gif" width="366" height="267"></p>

<h4><i>Nancy's Viewer (a rudimentary file viewer).</i> </h4>
</body>
</html>
