<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Basic Steps in Creating a File Viewer</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">Basic Steps in Creating a File Viewer</font></h1>

<p>You have two options when you decide to write your own file
viewer: you can take the really hard way and use C, or you can
use MFC version 3.1 or later and let MFC do a lot of the grunt
work for you. Since one of the rules I live by is &#147;Don't do
anything that you can get someone else to do for you,&#148; I
chose the MFC method. If you want to do all the work yourself,
you aren't out of luck: the FILEVIEW sample in the Win32 SDK
demonstrates exactly what you have to do to reinvent that wheel. </p>

<p>When I wrote the MFCVIEW sample, I followed the steps outlined
in a technical article by Nigel Thompson, &#147;MFC/COM Objects
1: Creating a Simple Object&#148;msdn_house1(available on the
Microsoft Developer Network Development Library CD), and the
information in &#147;Technical Note 38: MFC/OLE IUnknown
Implementation&#148; (one of the MFC technical notes found in the
Visual C++ documentation). So if you think the steps look
familiar and you've read Nigel's article recently, you'll know
why. </p>

<p>Here is what I did to create Nancy's Viewer: </p>

<ol>
    <li>Create the project. </li>
    <li>Generate GUIDs. </li>
    <li>Create the object class. </li>
    <li>Implement the basic object. </li>
    <li>Implement the IUnknown interface. </li>
    <li>Implement the IFileViewer interface. </li>
    <li>Implement the IPersistFile interface. </li>
    <li>Let MFC initialize the class factories for you. </li>
    <li>Create the class to show the file contents. </li>
    <li>Build, register, and run the file viewer. </li>
</ol>
</body>
</html>
