<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How File Viewers Are Instantiated</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>How File Viewers Are Instantiated</h2>

<p>The system doesn't directly call a file viewer; instead, it
starts an instance of QUIKVIEW.EXE for each file to be viewed.
QUIKVIEW is a program that starts the file viewing process and
creates a message queue for file viewers. The program then
associates a path with a file viewer, instantiates the file
viewer object, and tells the file viewer to load and display the
file. At this point, QUIKVIEW turns over execution of the process
it created to the file viewer until the file viewer shuts down.
When determining which file viewer to instantiate, QUIKVIEW uses
one of these three methods: </p>

<ul>
    <li>If the file is an OLE compound file, it contains a class
        identifier (CLSID) that identifies its type. QUIKVIEW
        uses this CLSID to determine the file type and which
        viewer to use. </li>
    <li>If the file is not an OLE compound file but begins with a
        consistent and unique byte pattern, the application that
        created it can register the byte pattern in the Registry
        and associate the pattern with a CLSID, which will
        determine the file type. </li>
    <li>If the file is not an OLE compound file (or if it is but
        lacks a CLSID), QUIKVIEW uses the filename extension to
        identify the file type. </li>
</ul>

<p>If a file type is registered but the system can't find its
file viewer, or if the Quick View operation fails, QUIKVIEW
displays the message <i>There is no viewer capable of viewing</i>
&lt;type of file&gt; <i>files.</i> </p>
</body>
</html>
