<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Icon Handlers</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">Icon Handlers</font></h1>

<p>An icon handler allows you to customize the icon that is
displayed for a particular type of file. If you create a file
whose extension is not registered for a specific icon, the
standard Windows icon is associated with the file by default.
Figure 13-3 on the next page shows three test files with the
default icons. </p>

<p>To install the icon handler created by the SHELLEXT sample,
copy SHELLEXT.DLL to the \WINDOWS\SYSTEM folder and run
SHELLEXT.REG. Then go to Windows Explorer, right-click one of the
test files, choose Properties from the context menu, and select a
GAK color. Finally, refresh Windows Explorer (by pressing the F5
key) to see the icons for the test files change to the ones that
are specified in the handler, as shown in Figure 13-4 on the next
page. </p>

<p><b>Figure 13-3.</b> </p>

<p><img src="fig13-3.gif" width="759" height="447"></p>

<h4><i>Test files with default Windows icons.</i> </h4>

<p><b>Figure 13-4.</b> </p>

<p><img src="fig13-4.gif" width="751" height="447"></p>

<h4><i>New icons for the test files.</i> </h4>

<p>If you want to provide an icon for all files of a certain
type, you don't need to write an icon handler. Instead, you can
simply add the DefaultIcon key for your application to the
Registry and set its value to the path of the executable or the
DLL containing the icon and the index to the icon: </p>

<p><tt>DefaultIcon = c:\Mydir\Myapp.exe,1</tt> </p>

<p>Under Windows 95, you can specify that each file instance of a
certain type should have a different icon. To do this, specify %1
as the value for the DefaultIcon key, and then register the icon
handler under the shellex\IconHandler key. An application can
have only one IconHandler entry. </p>

<p><tt>[HKEY_CLASSES_ROOT\NWCFile\shellex\IconHandler]<br>
@=&quot;{&lt;CLSID value&gt;}&quot;</tt> </p>
</body>
</html>
