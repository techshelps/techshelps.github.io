<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Context Menu Handlers</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">Context Menu Handlers</font></h1>

<p>The first user interface extensions we'll look at are context
menu handlers, which you can use to add items to a context menu.
Figure 13-1 shows the result of installing the context menu
handler in the CTXTMENU sample. I added the Test Context Menu
item to the menu. </p>

<p><b>Figure 13-1.</b> </p>

<p><img src="fig13-1.gif" width="147" height="229"></p>

<h4><i>The context menu after the CTXTMENU handler has been
installed.</i> </h4>

<p>By adding items to an object's context menu, you are also
adding verbs for that file type. <i>Verbs</i> are the set of
operations supported by a particular object&#151;open, save, or
play, for instance. You can designate a menu item as either
class-specific or instance-specific. Instance-specific context
menus apply only to individual files. Generally, unless the menu
items are dynamic (that is, they depend on the state of the
object), it's much easier to simply add static verbs in the
Registry than to add a context menu handler. The data exported
from the Registry for the audio CD player on my system is shown
here. The Play command is a static verb. </p>

<p><tt>REGEDIT4<br>
<br>
[HKEY_CLASSES_ROOT\AudioCD]<br>
@=&quot;AudioCD&quot;<br>
&quot;EditFlags&quot;=hex:02,00,00,00<br>
<br>
[HKEY_CLASSES_ROOT\AudioCD\DefaultIcon]<br>
@=&quot;C:\\WINDOWS\\SYSTEM\\shell32.dll,40&quot;<br>
<br>
[HKEY_CLASSES_ROOT\AudioCD\shell]<br>
@=&quot;play&quot;<br>
<br>
[HKEY_CLASSES_ROOT\AudioCD\shell\play]<br>
@=&quot;&amp;Play&quot;<br>
<br>
[HKEY_CLASSES_ROOT\AudioCD\shell\play\command]<br>
@=&quot;C:\\WINDOWS\\cdplayer.exe /play %1&quot;</tt> </p>

<p>Although you can use a context menu handler to alter items on
a context menu or remove items from a context menu, it is not
recommended. Think about it. Would you want other applications
messing around with your menu items? Some context menu handlers
might rely on others being added first, when in fact the last
thing the system does is add an item to the context menu. As a
result, a handler might be loaded, but the item might not appear
on the context menu. </p>
</body>
</html>
