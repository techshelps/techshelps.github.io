<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registering User Interface Extensions</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">Registering User Interface Extensions</font></h1>

<p>Like all COM objects, user interface extensions must be
registered in the Registry, or they won't work. An extension must
register its class ID (CLSID) under the Registry key
HKEY_CLASSES_ROOT\CLSID. Within this key, the extension adds an
InProcServer32 key that gives the location of the extension's
DLL. The first statement in the following sample code registers
the CLSID of my property sheet extension, NancyPropSheet. The
second statement in the code specifies the location of the DLL
containing the extension and the threading model: </p>

<p><tt>[HKEY_CLASSES_ROOT\CLSID\{771a9da0-731a-11ce-993c-00aa004adb6c}]<br>
@=&quot;NancyPropSheet&quot;<br>
[HKEY_CLASSES_ROOT\CLSID\{771a9da0-731a-11ce-993c-00aa004adb6c}\<br>
InprocServer32]<br>
@=&quot;c:\\windows\\system\\propext.dll&quot;<br>
&quot;ThreadingModel&quot;=&quot;Apartment&quot;</tt> </p>

<p>The shellex key contains the information used to associate a
user interface extension with a file type. You must also register
your extension under this key. You can map the user interface
extension to a particular class of file (based on the filename
extension), or you can specify that it is valid for files of all
types. To register the property sheet for files of a specific
type&#151;NWCFile, for example&#151;specify the file type as
shown here: </p>

<p><tt>[HKEY_CLASSES_ROOT\.NWC]<br>
@=&quot;NWCFile&quot;<br>
[HKEY_CLASSES_ROOT\NWCFile]<br>
@=&quot;Shell Extension file&quot;<br>
[HKEY_CLASSES_ROOT\NWCFile\shellex\PropertySheetHandlers]<br>
@=&quot;NWCPage&quot;<br>
[HKEY_CLASSES_ROOT\NWCFile\shellex\PropertySheetHandlers\NWCPage]<br>
@=&quot;{771a9da0-731a-11ce-993c-00aa004adb6c}&quot;</tt> </p>

<p>If you want all files to reap the benefits of your special
property sheet page, specify an asterisk (*) after
HKEY_CLASSES_ROOT, as I did in my property sheet handler,
PROPEXT: </p>

<p><tt>[HKEY_CLASSES_ROOT\*\shellex\PropertySheetHandlers]<br>
@=&quot;NWCPage&quot;<br>
[HKEY_CLASSES_ROOT\*\shellex\PropertySheetHandlers\NWCPage]<br>
@=&quot;{771a9da0-731a-11ce-993c-00aa004adb6c}&quot;</tt> </p>

<p>NOTE: To remove any of the user interface extensions that are
registered by the samples discussed in this chapter, please refer
to the \README.TXT file on the companion disc. </p>
</body>
</html>
