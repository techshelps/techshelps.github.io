<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Incorporating a Property Sheet</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">Incorporating a Property Sheet</font></h1>

<p>In this application, I implemented a property sheet with two
property sheet pages. One allows the user to view and change the
properties for a particular house listing (for example, the
address and the city); the other displays information about the
listing agent (for example, the agent's name and phone number),
which the user can also change. Figure 7-4 shows the House
Listing property sheet page. </p>

<p><b>Figure 7-4.</b> </p>

<p><img src="fig7-4.gif" width="350" height="281"></p>

<h4><i>The House Listing property sheet page.</i> </h4>

<p>Processing a property sheet page is similar to processing a
dialog box, with one major difference: when you process a
property sheet page, you handle notifications instead of the
commands generated for the OK and Cancel buttons. I could process
my property sheet pages as follows: </p>

<ul>
    <li>Save the original values for the house or agent in
        response to the WM_INITDIALOG message. </li>
    <li>Reset the values for the house or agent in response to
        the PSN_APPLY and PSN_KILLACTIVE notifications. </li>
    <li>Reset the values for the house or agent in response to a
        PSN_RESET notification. </li>
    <li>In response to the PSN_SETACTIVE notification, set the
        edit fields in the page for the item. </li>
</ul>

<p>To initialize the property sheet pages, I had to determine
which house was currently selected and save that information for
future reference. The House Listing page is displayed first.
Responding to the WM_INITDIALOG message offers the first chance
to determine the currently selected house. I used the code on the
following page to determine the index of the selected house
within my global array of houses. </p>

<p><tt>char szTemp [MAX_ADDRESS];<br>
static char szAddSave [MAX_ADDRESS];<br>
static char szCitySave [MAX_CITY];<br>
static int iPrice, iBeds, iBaths;<br>
BOOL bErr;<br>
int index, count;<br>
LV_ITEM lvItem;<br>
§<br>
case WM_INITDIALOG: <br>
// Fill in the list box with the cities.<br>
for (index = 0; index &lt; g_Listing.NumCities; index++)<br>
SendDlgItemMessage (hDlg, IDE_CITY, CB_INSERTSTRING, <br>
(WPARAM)(-1), (LPARAM)(rgCities[index].szCity));<br>
<br>
// Get the index to the selected list view item.<br>
index = ListView_GetNextItem (g_Listing.hWndListView,<br>
-1, MAKELPARAM (LVNI_SELECTED, 0));<br>
<br>
// Get the house address.<br>
lvItem.iItem = index;<br>
lvItem.iSubItem = 0;<br>
lvItem.mask = LVIF_TEXT;<br>
lvItem.cchTextMax = sizeof (szAddSave);<br>
lvItem.pszText = szAddSave;<br>
ListView_GetItem (g_Listing.hWndListView,&amp;lvItem);<br>
<br>
// Find the house in the list.<br>
for (count = 0; count &lt; g_Listing.NumHouses; count++)<br>
{<br>
if (strcmp (lvItem.pszText, rgHouses[count].szAddress) == 0)<br>
break;<br>
}<br>
g_Listing.iSelHouse = count;<br>
§</tt> </p>

<p>My other property sheet page, Listing Agent, allows the user
to view and change the name and phone number of the listing agent
associated with the selected house. I used similar code to handle
this page, except that I modified the <i>szAgent</i> and <i>szNumber</i>
members of the HOUSEINFO structure instead of altering the other
house-specific fields. Figure 7-5 shows the Listing Agent
property sheet page. </p>

<p><b>Figure 7-5.</b> </p>

<p><img src="fig7-5.gif" width="349" height="282"></p>

<h4><i>The Listing Agent property sheet page.</i> </h4>

<p> </p>
</body>
</html>
