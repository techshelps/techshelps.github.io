<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Page Setup Common Dialog Box</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>Using the Page Setup Common Dialog Box</h2>

<p>Page Setup is a new common dialog box for Windows 95. (In
earlier versions of Windows, the dialog template for the Print
common dialog box included the code for page setup.) The Page
Setup common dialog box, which is shown in Figure 6-15, allows
the user to set the paper size, paper source, document
orientation, and margins for printing. The sample representation
of the page at the top of the dialog box gives the user an idea
of what the printed output will look like.</p>

<p><b>Figure 6-15.</b> </p>

<p><img src="fig6-15.gif" width="368" height="417"></p>

<h4><i>The Page Setup common dialog box.</i> </h4>

<p>You can customize the Page Setup dialog box to use a hook
function to paint the sample page. To use the hook function, the
application must specify the PSD_ENABLEPAGEPAINTHOOK flag in the <i>Flags</i>
member of the PAGESETUPDLG structure and the name of the hook
function in the <i>lpfnPagePaintHook</i> member. This hook
function will receive messages for all the steps in the drawing
process. Table 6-1 lists the messages that are sent to the page
setup hook in the order that the hook receives them. </p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">WM_PSD_PAGESETUPDLG</td>
        <td valign="top">Notifies the hook function to carry out
        initialization tasks.</td>
    </tr>
    <tr>
        <td valign="top">WM_PSD_FULLPAGERECT</td>
        <td valign="top">Specifies the bounding rectangle of the
        sample page.</td>
    </tr>
    <tr>
        <td valign="top">WM_PSD_MINMARGINRECT</td>
        <td valign="top">Specifies the minimum margin rectangle.</td>
    </tr>
    <tr>
        <td valign="top">WM_PSD_MARGINRECT</td>
        <td valign="top">Specifies the margin rectangle.</td>
    </tr>
    <tr>
        <td valign="top">WM_PSD_GREEKTEXTRECT</td>
        <td valign="top">Specifies the Greek-text rectangle.</td>
    </tr>
    <tr>
        <td valign="top">WM_PSD_ENVSTAMPRECT</td>
        <td valign="top">Specifies the envelope-stamp rectangle
        (for envelopes only).</td>
    </tr>
</table>

<p><b>Table 6-1.</b><i> Page setup messages.</i> </p>

<p>From a programming standpoint, using the Page Setup common
dialog box is very much like programming the other common dialog
boxes: you fill out a structure and make a function call. The new
structure provided for the Page Setup dialog box is PAGESETUPDLG.
When you have filled out this structure, a call to PageSetupDlg
with a pointer to the structure displays the dialog box. This
code demonstrates how the CMNDLG32 sample fills out the structure
and produces the Page Setup common dialog box: </p>

<p><tt>void PageSetup (HWND hWnd)<br>
{<br>
// Initialize the PAGESETUPDLG structure.<br>
psDlg.lStructSize = sizeof (PAGESETUPDLG);<br>
psDlg.hwndOwner = hWnd;<br>
psDlg.hDevMode = (HANDLE)NULL;<br>
psDlg.hDevNames = (HANDLE)NULL;<br>
psDlg.hInstance = (HANDLE)hInst;<br>
psDlg.lCustData = (LPARAM)NULL;<br>
psDlg.hPageSetupTemplate = (HGLOBAL)NULL;<br>
psDlg.Flags = PSD_DEFAULTMINMARGINS |
PSD_INHUNDREDTHSOFMILLIMETERS;<br>
<br>
switch (wMode)<br>
{<br>
case IDM_STANDARD:<br>
psDlg.lpfnPageSetupHook = (LPPAGESETUPHOOK)(FARPROC)NULL;<br>
psDlg.lpPageSetupTemplateName = (LPTSTR)NULL;<br>
psDlg.lpfnPagePaintHook = (LPPAGEPAINTHOOK)(FARPROC)NULL;<br>
break;<br>
<br>
case IDM_HOOK:<br>
psDlg.Flags |= PSD_ENABLEPAGESETUPHOOK;<br>
psDlg.lpfnPageSetupHook =
(LPPAGESETUPHOOK)(FARPROC)PageSetupHook;<br>
psDlg.lpPageSetupTemplateName = (LPTSTR)NULL;<br>
psDlg.lpfnPagePaintHook = (LPPAGEPAINTHOOK)(FARPROC)NULL;<br>
break;<br>
<br>
case IDM_CUSTOM:<br>
psDlg.Flags |= PSD_ENABLEPAGESETUPHOOK | <br>
PSD_ENABLEPAGESETUPTEMPLATE;<br>
psDlg.lpfnPageSetupHook =
(LPPAGESETUPHOOK)(FARPROC)PageSetupHook;<br>
psDlg.lpPageSetupTemplateName = (LPTSTR)PRNSETUPDLGORD95;<br>
psDlg.lpfnPagePaintHook = (LPPAGEPAINTHOOK)(FARPROC)NULL;<br>
break;<br>
}<br>
<br>
// Call the Page Setup common dialog procedure.<br>
if (PageSetupDlg (&amp;psDlg) == FALSE)<br>
ProcessCDError (CommDlgExtendedError (), hWnd);<br>
}</tt> </p>

<p>Like the Open and Save As common dialog boxes, the three
printing common dialog boxes have new templates. Here's what they
look like: </p>

<p><tt>// Print dialog box<br>
PRINTDLGORD DIALOG DISCARDABLE 32, 32, 288, 186<br>
STYLE DS_MODALFRAME | WS_POPUP | WS_VISIBLE | WS_CAPTION |
WS_SYSMENU |<br>
DS_CONTEXTHELP | DS_3DLOOK<br>
CAPTION &quot;Print&quot;<br>
FONT 8, &quot;MS Sans Serif&quot;<br>
BEGIN<br>
GROUPBOX &quot;Printer&quot;,grp4,8,4,272,84,WS_GROUP<br>
LTEXT &quot;&amp;Name:&quot;,stc6,16,20,36,8<br>
COMBOBOX cmb4,52,18,152,152,CBS_DROPDOWNLIST | CBS_SORT |<br>
WS_VSCROLL | WS_GROUP | WS_TABSTOP<br>
PUSHBUTTON &quot;&amp;Properties&quot;,psh2,212,17,60,14,WS_GROUP<br>
LTEXT &quot;Status:&quot;,stc8,16,36,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc12,52,36,224,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
LTEXT &quot;Type:&quot;,stc7,16,48,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc11,52,48,224,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
LTEXT &quot;Where:&quot;,stc10,16,60,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc14,52,60,224,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
LTEXT &quot;Comment:&quot;,stc9,16,72,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc13,52,72,152,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
CONTROL &quot;Print to
fi&amp;le&quot;,chx1,&quot;Button&quot;,BS_AUTOCHECKBOX |<br>
WS_GROUP | WS_TABSTOP,212,70,64,12<br>
GROUPBOX &quot;Print range&quot;,grp1,8,92,144,64,WS_GROUP<br>
CONTROL
&quot;&amp;All&quot;,rad1,&quot;Button&quot;,BS_AUTORADIOBUTTON |
WS_GROUP |<br>
WS_TABSTOP,16,106,64,12<br>
CONTROL
&quot;Pa&amp;ges&quot;,rad3,&quot;Button&quot;,BS_AUTORADIOBUTTON,<br>
16,122,36,12<br>
CONTROL
&quot;&amp;Selection&quot;,rad2,&quot;Button&quot;,BS_AUTORADIOBUTTON,<br>
16,138,64,12<br>
RTEXT &quot;&amp;from:&quot;,stc2,52,124,20,8<br>
EDITTEXT edt1,74,122,26,12,WS_GROUP | ES_NUMBER<br>
RTEXT &quot;&amp;to:&quot;,stc3,100,124,16,8<br>
EDITTEXT edt2,118,122,26,12,WS_GROUP | ES_NUMBER<br>
GROUPBOX &quot;Copies&quot;,grp2,160,92,120,64,WS_GROUP<br>
LTEXT &quot;Number of &amp;copies:&quot;,stc5,168,108,68,8<br>
EDITTEXT edt3,240,106,32,12,WS_GROUP | ES_NUMBER<br>
ICON &quot;&quot;,ico3,162,124,76,24,WS_GROUP | SS_CENTERIMAGE<br>
CONTROL
&quot;C&amp;ollate&quot;,chx2,&quot;Button&quot;,BS_AUTOCHECKBOX
| <br>
WS_GROUP | WS_TABSTOP,240,130,36,12<br>
DEFPUSHBUTTON &quot;OK&quot;,IDOK,180,164,48,14,WS_GROUP<br>
PUSHBUTTON &quot;Cancel&quot;,IDCANCEL,232,164,48,14<br>
END<br>
<br>
// Print Setup dialog box<br>
PRNSETUPDLGORD DIALOG DISCARDABLE 32, 32, 288, 178<br>
STYLE DS_MODALFRAME | WS_POPUP | WS_VISIBLE | WS_CAPTION |
WS_SYSMENU |<br>
DS_CONTEXTHELP | DS_3DLOOK<br>
CAPTION &quot;Print Setup&quot;<br>
FONT 8, &quot;MS Sans Serif&quot;<br>
BEGIN<br>
GROUPBOX &quot;Printer&quot;,grp4,8,4,272,84,WS_GROUP<br>
LTEXT &quot;&amp;Name:&quot;,stc6,16,20,36,8<br>
COMBOBOX cmb1,52,18,152,152,CBS_DROPDOWNLIST | CBS_SORT |<br>
WS_VSCROLL | WS_GROUP | WS_TABSTOP<br>
PUSHBUTTON &quot;&amp;Properties&quot;,psh2,212,17,60,14,WS_GROUP<br>
LTEXT &quot;Status:&quot;,stc8,16,36,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc12,52,36,224,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
LTEXT &quot;Type:&quot;,stc7,16,48,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc11,52,48,224,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
LTEXT &quot;Where:&quot;,stc10,16,60,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc14,52,60,224,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
LTEXT &quot;Comment:&quot;,stc9,16,72,36,10,SS_NOPREFIX<br>
LTEXT &quot;&quot;,stc13,52,72,224,10,SS_NOPREFIX | <br>
SS_LEFTNOWORDWRAP<br>
GROUPBOX &quot;Paper&quot;,grp2,8,92,164,56,WS_GROUP<br>
LTEXT &quot;Si&amp;ze:&quot;,stc2,16,108,36,8<br>
COMBOBOX cmb2,52,106,112,112,CBS_DROPDOWNLIST | CBS_SORT |<br>
WS_VSCROLL | WS_GROUP | WS_TABSTOP<br>
LTEXT &quot;&amp;Source:&quot;,stc3,16,128,36,8<br>
COMBOBOX cmb3,52,126,112,112,CBS_DROPDOWNLIST | CBS_SORT |<br>
WS_VSCROLL | WS_GROUP | WS_TABSTOP<br>
GROUPBOX &quot;Orientation&quot;,grp1,180,92,100,56,WS_GROUP<br>
ICON &quot;&quot;,ico1,195,112,18,20,WS_GROUP<br>
CONTROL
&quot;P&amp;ortrait&quot;,rad1,&quot;Button&quot;,BS_AUTORADIOBUTTON
| <br>
WS_GROUP | WS_TABSTOP,224,106,52,12<br>
CONTROL
&quot;L&amp;andscape&quot;,rad2,&quot;Button&quot;,BS_AUTORADIOBUTTON,<br>
224,126,52,12<br>
DEFPUSHBUTTON &quot;OK&quot;,IDOK,180,156,48,14,WS_GROUP<br>
PUSHBUTTON &quot;Cancel&quot;,IDCANCEL,232,156,48,14<br>
END<br>
<br>
// Page Setup dialog box<br>
PAGESETUPDLGORD DIALOG DISCARDABLE 32, 32, 240, 240<br>
STYLE DS_MODALFRAME | WS_POPUP | WS_VISIBLE | WS_CAPTION | <br>
WS_SYSMENU | 0x4 | DS_CONTEXTHELP<br>
CAPTION &quot;Page Setup&quot;<br>
FONT 8, &quot;MS Sans Serif&quot;<br>
BEGIN<br>
CONTROL &quot;&quot;,rct1,&quot;Static&quot;,SS_WHITERECT |
WS_GROUP,80,8,80,80<br>
CONTROL &quot;&quot;,rct2,&quot;Static&quot;,SS_GRAYRECT |
WS_GROUP,160,12,4,80<br>
CONTROL &quot;&quot;,rct3,&quot;Static&quot;,SS_GRAYRECT |
WS_GROUP,84,88,80,4<br>
GROUPBOX &quot;Paper&quot;,grp2,8,96,224,56,WS_GROUP<br>
LTEXT &quot;Si&amp;ze:&quot;,stc2,16,112,36,8<br>
COMBOBOX cmb2,64,110,160,160,CBS_DROPDOWNLIST | CBS_SORT |<br>
WS_VSCROLL | WS_GROUP | WS_TABSTOP<br>
LTEXT &quot;&amp;Source:&quot;,stc3,16,132,36,8<br>
COMBOBOX cmb3,64,130,160,160,CBS_DROPDOWNLIST | CBS_SORT |<br>
WS_VSCROLL | WS_GROUP | WS_TABSTOP<br>
GROUPBOX &quot;Orientation&quot;,grp1,8,156,64,56,WS_GROUP<br>
CONTROL
&quot;P&amp;ortrait&quot;,rad1,&quot;Button&quot;,BS_AUTORADIOBUTTON
| <br>
WS_GROUP | WS_TABSTOP,16,170,52,12<br>
CONTROL
&quot;L&amp;andscape&quot;,rad2,&quot;Button&quot;,BS_AUTORADIOBUTTON,<br>
16,190,52,12<br>
GROUPBOX &quot;Margins&quot;,grp4,80,156,152,56,WS_GROUP<br>
LTEXT &quot;&amp;Left:&quot;,stc15,88,172,32,8<br>
EDITTEXT edt4,120,170,28,12,WS_GROUP<br>
LTEXT &quot;&amp;Right:&quot;,stc16,164,172,32,8<br>
EDITTEXT edt6,196,170,28,12,WS_GROUP<br>
LTEXT &quot;&amp;Top:&quot;,stc17,88,192,32,8<br>
EDITTEXT edt5,120,190,28,12,WS_GROUP<br>
LTEXT &quot;&amp;Bottom:&quot;,stc18,164,192,32,8<br>
EDITTEXT edt7,196,190,28,12,WS_GROUP<br>
DEFPUSHBUTTON &quot;OK&quot;,IDOK,80,220,48,14,WS_GROUP<br>
PUSHBUTTON &quot;Cancel&quot;,IDCANCEL,132,220,48,14<br>
PUSHBUTTON &quot;&amp;Printer...&quot;,psh3,184,220,48,14<br>
END</tt> </p>
</body>
</html>
