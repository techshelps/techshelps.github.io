<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Property Sheet Messages</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>Property Sheet Messages</h2>

<p>Table 4-1 lists and describes the messages that support
property sheets in Windows 95. If you need to find more detailed
information about the parameters and return values for these
messages, you can refer to the Win32 SDK documentation. </p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">PSM_ADDPAGE</td>
        <td valign="top">Adds a page to the end of an existing
        property sheet. An added page should be no larger than
        the maximum size already in use, because the property
        sheet will not resize dynamically added pages and because
        the size of the property sheet itself cannot change.</td>
    </tr>
    <tr>
        <td valign="top">PSM_APPLY</td>
        <td valign="top">Simulates clicking the Apply button.
        This message returns TRUE if and only if every page
        successfully saved its information.</td>
    </tr>
    <tr>
        <td valign="top">PSM_CANCELTOCLOSE</td>
        <td valign="top">Sent when a change is made that cannot
        be canceled in the property sheet. It disables the Cancel
        button and changes the OK button to Close.</td>
    </tr>
    <tr>
        <td valign="top">PSM_CHANGED</td>
        <td valign="top">Sent to a property sheet when
        information in a page has changed. The property sheet
        changes the page name to italic text in the list of
        pages, and the Apply button is enabled. (This button is
        initially disabled when a page becomes active and there
        are no property changes to apply yet.) When the page
        receives user input through one of its controls,
        indicating that the user has edited a property, the page
        sends the PSM_CHANGED message to the property sheet. If
        the user then clicks the Apply button or the Cancel
        button, the page reinitializes its controls and sends the
        PSM_UNCHANGED message to redisable the Apply button.
        Sometimes the Apply button causes a page to change a
        property sheet, and the change cannot be undone. In that
        case, the page sends the PSM_CANCELTOCLOSE message to the
        property sheet, which changes the Cancel button to Close,
        indicating to the user that the applied changes cannot be
        canceled.</td>
    </tr>
    <tr>
        <td valign="top">PSM_GETTABCONTROL</td>
        <td valign="top">Retrieves a handle to a tab control. </td>
    </tr>
    <tr>
        <td valign="top">PSM_PRESSBUTTON</td>
        <td valign="top">Causes the specified button to appear
        &#147;pressed&#148; (to be selected). <i>wParam,</i> the
        ID of the button, can be one of the following values:</td>
    </tr>
    <tr>
        <td valign="top">PSBTN_BACK</td>
        <td valign="top">Select the Back button</td>
    </tr>
    <tr>
        <td valign="top">PSBTN_NEXT</td>
        <td valign="top">Select the Next button</td>
    </tr>
    <tr>
        <td valign="top">PSBTN_FINISH</td>
        <td valign="top">Select the Finish button</td>
    </tr>
    <tr>
        <td valign="top">PSBTN_OK</td>
        <td valign="top">Select the OK button</td>
    </tr>
    <tr>
        <td valign="top">PSBTN_APPLYNOW</td>
        <td valign="top">Select the Apply button</td>
    </tr>
    <tr>
        <td valign="top">PSBTN_CANCEL</td>
        <td valign="top">Select the Cancel button</td>
    </tr>
    <tr>
        <td valign="top">PSBTN_HELP</td>
        <td valign="top">Select the Help button</td>
    </tr>
</table>

<p><b>Table 4-1. </b><i>Property sheet messages.</i> <i>(continued)</i>
</p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">PSM_QUERYSIBLINGS</td>
        <td valign="top">Forwarded to each property sheet page
        until a page returns a nonzero value, which becomes the
        return value of this message. This message is convenient
        for passing information between pages that don't know
        about one another. For example, the printer property page
        extensions use this message to communicate with the
        property sheet pages provided by the system.</td>
    </tr>
    <tr>
        <td valign="top">PSM_REBOOTSYSTEM</td>
        <td valign="top">Sent when the user must reboot to have
        the changes specified in the property sheet take effect.
        The page sends this notification only in response to a
        PSN_APPLY or PSN_KILLACTIVE notification. The
        PSM_REBOOTSYSTEM message supersedes all
        PSM_RESTARTWINDOWS notifications that precede or follow.
        It causes the property sheet return value to be
        ID_PSREBOOTSYSTEM if the user chooses OK to close the
        property sheet.</td>
    </tr>
    <tr>
        <td valign="top">PSM_REMOVEPAGE</td>
        <td valign="top">Removes a page from an existing property
        sheet. If <i>hPage</i> is NULL or does not exist, the
        property sheet removes the page at the location specified
        by the <i>index</i> parameter. When a page is defined, an
        application can specify the address of a
        ReleasePropSheetPageProc callback function that the
        property sheet calls when it is removing the page. Using
        a ReleasePropSheetPageProc function gives an application
        the opportunity to perform cleanup operations for
        individual pages. </td>
    </tr>
    <tr>
        <td valign="top">PSM_RESTARTWINDOWS</td>
        <td valign="top">Sent when the user must restart Windows
        to have changes specified in the property sheet take
        effect. The page sends this notification only in response
        to a PSN_APPLY or PSN_KILLACTIVE notification. This
        causes the property sheet to return ID_PSRESTARTWINDOWS
        if the user chooses OK to close the property sheet.</td>
    </tr>
    <tr>
        <td valign="top">PSM_SETCURSEL</td>
        <td valign="top">Sent to the property sheet to change
        focus to a different page. If <i>hPage</i> is NULL or
        does not exist, the property sheet sets the active page
        at the location specified by the <i>index</i> parameter.</td>
    </tr>
    <tr>
        <td valign="top">PSM_SETCURSELID</td>
        <td valign="top">Sets the active page by the ID of the
        tab or the <i>hPage</i> as specified in <i>lParam</i>.</td>
    </tr>
</table>

<p><b>Table 4-1. </b><i>continued</i> </p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">PSM_SETFINISHTEXT</td>
        <td valign="top">Enables the Finish button, hides the
        Back button, and sets the text on the Finish button to
        the text specified in <i>lParam</i>. </td>
    </tr>
    <tr>
        <td valign="top">PSM_SETTITLE</td>
        <td valign="top">Changes the caption for the property
        sheet.</td>
    </tr>
    <tr>
        <td valign="top">PSM_SETWIZBUTTONS</td>
        <td valign="top">Specifies which buttons should be
        enabled in a wizard-style property sheet. <i>lParam</i>
        can be a combination of the following values:</td>
    </tr>
    <tr>
        <td valign="top">PSWIZB_BACK</td>
        <td valign="top">Enable the Back button</td>
    </tr>
    <tr>
        <td valign="top">PSWIZB_NEXT</td>
        <td valign="top">Enable the Next button</td>
    </tr>
    <tr>
        <td valign="top">PSWIZB_FINISH</td>
        <td valign="top">Enable the Finish button</td>
    </tr>
    <tr>
        <td valign="top">PSM_UNCHANGED</td>
        <td valign="top">Sent to a property sheet when the
        information in a page has reverted to its previously
        saved state. The property sheet cancels any changes
        caused by PSM_CHANGED. The Apply button is disabled if no
        pages with registered changes remain.</td>
    </tr>
</table>
</body>
</html>
