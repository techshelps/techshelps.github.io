<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Trackbar</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>Creating a Trackbar</h2>

<p>You can create a trackbar by using the CreateWindow or
CreateWindowEx function and specifying the TRACKBAR_CLASS class
name or by using the MFC Create member function on your
CSliderCtrl object. You can then use trackbar messages or member
functions to set the minimum and maximum positions for the
slider, draw tick marks, and set a selection range. To use
trackbars in your application, you must include the COMMCTRL.H
header file, and you also need to have the COMCTL32.LIB file in
your list of libraries. This C code creates the status bar and
three trackbars in the SLIDER sample: </p>

<p><tt>case WM_CREATE:<br>
<br>
hWndStatus = CreateWindow (<br>
STATUSCLASSNAME, <br>
&quot;&quot;, <br>
WS_CHILD | WS_BORDER | WS_VISIBLE,<br>
-100, -100, 10, 10,<br>
hWnd, <br>
(HMENU)100, <br>
hInst, <br>
NULL);<br>
<br>
hWndSlider1 = CreateWindow (<br>
TRACKBAR_CLASS,<br>
&quot;&quot;,<br>
WS_CHILD | WS_VISIBLE | TBS_AUTOTICKS,<br>
10, 50, 200, 20,<br>
hWnd, <br>
(HMENU)10, <br>
hInst,<br>
NULL);<br>
<br>
if (hWndSlider1 == NULL)<br>
MessageBox (NULL, &quot;Slider1 not created!&quot;, NULL, MB_OK);<br>
<br>
hWndSlider2 = CreateWindow (<br>
TRACKBAR_CLASS,<br>
&quot;&quot;,<br>
WS_CHILD | WS_VISIBLE | TBS_AUTOTICKS | TBS_TOP |<br>
TBS_ENABLESELRANGE,<br>
10, 100, 200, 20,<br>
hWnd, <br>
(HMENU)11, <br>
hInst,<br>
NULL);<br>
<br>
if (hWndSlider2 == NULL)<br>
MessageBox (NULL, &quot;Slider2 not created!&quot;, NULL, MB_OK);<br>
<br>
hWndSlider3 = CreateWindow (<br>
TRACKBAR_CLASS,<br>
&quot;&quot;,<br>
WS_CHILD | WS_VISIBLE | TBS_VERT | TBS_LEFT | TBS_AUTOTICKS,<br>
10, 150, 20, 100,<br>
hWnd, <br>
(HMENU)12, <br>
hInst,<br>
NULL);<br>
<br>
if (hWndSlider3 == NULL)<br>
MessageBox (NULL, &quot;Slider3 not created!&quot;, NULL, MB_OK);<br>
<br>
// Set the default range.<br>
SendMessage (hWndSlider1, TBM_SETRANGE, TRUE, MAKELONG (1,10));<br>
SendMessage (hWndSlider2, TBM_SETRANGE, TRUE, MAKELONG (1,10));<br>
SendMessage (hWndSlider3, TBM_SETRANGE, TRUE, MAKELONG (1,10));<br>
<br>
// Set the selection range.<br>
SendMessage (hWndSlider2, TBM_SETSEL, TRUE, MAKELONG (3,5));<br>
break;</tt> </p>

<p>In the MFC version, MFCTRACK, I created the trackbar in the
view class. I also needed to include the AFXCMN.H file in my
STDAFX.H file. </p>

<p><tt>// The view class is defined as follows in MFCTRVW.H.<br>
class CMfctrackView : public CView<br>
{<br>
protected: // create from serialization only<br>
CMfctrackView ();<br>
DECLARE_DYNCREATE (CMfctrackView);<br>
CSliderCtrl m_Slider1;<br>
CSliderCtrl m_Slider2;<br>
CSliderCtrl m_Slider3;<br>
<br>
// Attributes<br>
public:<br>
CMfctrackDoc *GetDocument ();<br>
<br>
// Operations<br>
public:<br>
CSliderCtrl *GetSlider (int iSlider);<br>
<br>
// Overrides<br>
// ClassWizard generated virtual function overrides.<br>
// {{AFX_VIRTUAL (CMfctrackView)<br>
public:<br>
virtual void OnDraw (CDC *pDC); // overridden to <br>
// }}AFX_VIRTUAL // draw this view<br>
<br>
// Implementation<br>
public:<br>
virtual ~CMfctrackView ();<br>
#ifdef _DEBUG<br>
virtual void AssertValid () const;<br>
virtual void Dump (CDumpContext&amp; dc) const;<br>
#endif<br>
<br>
protected:<br>
VOID TrackScrolling (UINT nSBCode); <br>
<br>
// Generated message map functions<br>
protected:<br>
// {{AFX_MSG (CMfctrackView)<br>
afx_msg int OnCreate (LPCREATESTRUCT lpCreateStruct);<br>
afx_msg void OnDestroy ();<br>
afx_msg void OnHScroll (UINT nSBCode, UINT nPos, <br>
CScrollBar *pScrollBar);<br>
afx_msg void OnRange ();<br>
afx_msg void OnFrequency ();<br>
afx_msg void OnLinesize ();<br>
afx_msg void OnPagesize ();<br>
afx_msg void OnVScroll (UINT nSBCode, UINT nPos, <br>
CScrollBar *pScrollBar);<br>
// }}AFX_MSG<br>
DECLARE_MESSAGE_MAP ()<br>
};</tt> </p>

<p><tt>// The trackbars are created in MFCTRVW.CPP.<br>
int CMfctrackView::OnCreate (LPCREATESTRUCT lpCreateStruct) <br>
{<br>
if (CView::OnCreate (lpCreateStruct) == -1)<br>
return -1;<br>
<br>
// Create the trackbars.<br>
m_Slider1.Create (WS_CHILD | WS_VISIBLE | TBS_AUTOTICKS,<br>
CRect (10, 50, 200, 70),<br>
this, <br>
ID_SLIDER1);<br>
<br>
m_Slider2.Create (WS_CHILD | WS_VISIBLE | TBS_AUTOTICKS | TBS_TOP
| <br>
TBS_ENABLESELRANGE,<br>
CRect (10, 100, 200, 130),<br>
this, <br>
ID_SLIDER2); <br>
<br>
m_Slider3.Create (WS_CHILD | WS_VISIBLE | TBS_VERT | TBS_LEFT |<br>
TBS_AUTOTICKS,<br>
CRect (10, 150, 30, 350),<br>
this,<br>
ID_SLIDER3);<br>
<br>
// Set the default range.<br>
m_Slider1.SetRange (1, 10, TRUE);<br>
m_Slider2.SetRange (1, 25, TRUE);<br>
m_Slider3.SetRange (1, 30, TRUE);<br>
<br>
// Set the selection range.<br>
m_Slider2.SetSelection (10, 20);<br>
<br>
return 0;<br>
}</tt> </p>
</body>
</html>
