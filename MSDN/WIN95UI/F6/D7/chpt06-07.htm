<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Font Common Dialog Box</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">The Font Common Dialog Box</font></h1>

<p>The Font common dialog box displays lists of typefaces,
styles, and point sizes that correspond to the available fonts.
After the user selects the current font for an application, the
dialog box displays sample text rendered with that font, as shown
in Figure 6-7. </p>

<p><b>Figure 6-7.</b> </p>

<p><b><img src="fig6-7.gif" width="404" height="346"></b></p>

<h4><i>The Font common dialog box.</i> </h4>

<p>To use the Font common dialog box, you fill out the CHOOSEFONT
structure and call the ChooseFont function. The CHOOSEFONT
structure contains information such as the attributes of the
initial font, the point size, and the types of fonts (screen
fonts or printer fonts), as well as hook and template
information. </p>

<p>The following code demonstrates how the CMNDLG32 sample fills
out the CHOOSEFONT structure. In the sample, how some of the
fields are filled depends on whether a hook or a template should
be included. The flags indicate that the strikeout, underline,
and color effects should be enabled (CF_EFFECTS) and that the
fonts listed should include only the screen fonts supported by
the system (CF_SCREENFONTS). Note that, although it is not used
in this sample, the CF_NOSCRIPTSEL flag is available if you want
to gray out the script box. </p>

<p><tt>CHOOSEFONT chf;<br>
LOGFONT lf;<br>
§<br>
<br>
HDC hDC;<br>
<br>
hDC = GetDC (hWnd);<br>
chf.hDC = CreateCompatibleDC (hDC);<br>
ReleaseDC (hWnd, hDC);<br>
chf.lStructSize = sizeof (CHOOSEFONT);<br>
chf.hwndOwner = hWnd;<br>
chf.lpLogFont = &amp;lf;<br>
chf.Flags = CF_SCREENFONTS | CF_EFFECTS; <br>
chf.rgbColors = RGB (0, 255, 255);<br>
chf.lCustData = 0;<br>
chf.hInstance = (HANDLE)hInst;<br>
chf.lpszStyle = (LPTSTR)NULL;<br>
chf.nFontType = SCREEN_FONTTYPE;<br>
chf.nSizeMin = 0;<br>
chf.nSizeMax = 0;<br>
<br>
switch (wMode)<br>
{<br>
case IDM_STANDARD:<br>
chf.lpfnHook = (LPCFHOOKPROC)(FARPROC)NULL;<br>
chf.lpTemplateName = (LPTSTR)NULL;<br>
break;<br>
<br>
case IDM_HOOK:<br>
chf.Flags |= CF_ENABLEHOOK;<br>
chf.lpfnHook = (LPCFHOOKPROC)ChooseFontHookProc;<br>
chf.lpTemplateName = (LPTSTR)NULL;<br>
break;<br>
<br>
case IDM_CUSTOM:<br>
chf.Flags |= CF_ENABLEHOOK | CF_ENABLETEMPLATE;<br>
chf.lpfnHook = (LPCFHOOKPROC)ChooseFontHookProc;<br>
chf.lpTemplateName = (LPTSTR) MAKEINTRESOURCE (FORMATDLGORD31);<br>
break; <br>
}</tt> </p>

<p>After you fill out the structure, you simply call the
ChooseFont function and delete the DC. The common dialog
procedure sets the font for you. If you need to customize the
dialog box, your application should provide a hook function and,
if you want to add controls, a dialog template. Instead of
specifying additional controls in a child dialog box, as you do
for the Open and Save As common dialog boxes, you must include
the full template for the Font common dialog box in order to
customize it. For example, the CMNDLG32.RC file includes the
following template for the Font dialog box: </p>

<p><tt>1543 DIALOG DISCARDABLE 13, 54, 264, 147<br>
STYLE DS_MODALFRAME | WS_POPUP | WS_CAPTION | WS_SYSMENU<br>
CAPTION &quot;Font&quot;<br>
FONT 8, &quot;Helv&quot;<br>
BEGIN<br>
LTEXT &quot;&amp;Font:&quot;,1088,6,3,40,9<br>
COMBOBOX 1136,6,13,94,54,CBS_SIMPLE | CBS_OWNERDRAWFIXED | <br>
CBS_AUTOHSCROLL | CBS_SORT | CBS_HASSTRINGS | <br>
CBS_DISABLENOSCROLL | WS_VSCROLL | WS_TABSTOP<br>
LTEXT &quot;Font St&amp;yle:&quot;,1089,108,3,44,9<br>
COMBOBOX 1137,108,13,64,54,CBS_SIMPLE | CBS_DISABLENOSCROLL | <br>
WS_VSCROLL | WS_TABSTOP<br>
LTEXT &quot;&amp;Size:&quot;,1090,179,3,30,9<br>
COMBOBOX 1138,179,13,32,54,CBS_SIMPLE | CBS_OWNERDRAWFIXED | <br>
CBS_SORT | CBS_HASSTRINGS | CBS_DISABLENOSCROLL | <br>
WS_VSCROLL | WS_TABSTOP<br>
DEFPUSHBUTTON &quot;OK&quot;,IDOK,218,6,40,14,WS_GROUP<br>
PUSHBUTTON &quot;Cancel&quot;,IDCANCEL,218,23,40,14,WS_GROUP<br>
PUSHBUTTON &quot;&amp;Apply&quot;,1026,218,40,40,14,WS_GROUP<br>
PUSHBUTTON &quot;&amp;Help&quot;,1038,218,57,40,14,WS_GROUP<br>
GROUPBOX &quot;Effects&quot;,1072,6,72,84,34,WS_GROUP<br>
CONTROL &quot;Stri&amp;keout&quot;,1040,&quot;Button&quot;,<br>
BS_AUTOCHECKBOX | WS_TABSTOP,10,82,49,10<br>
CONTROL &quot;&amp;Underline&quot;,1041,&quot;Button&quot;,<br>
BS_AUTOCHECKBOX,10,94,51,10<br>
LTEXT &quot;&amp;Color:&quot;,1091,6,110,30,9<br>
COMBOBOX 1139,6,120,84,100,<br>
CBS_DROPDOWNLIST | CBS_OWNERDRAWFIXED | <br>
CBS_AUTOHSCROLL | CBS_HASSTRINGS | WS_BORDER | <br>
WS_VSCROLL | WS_TABSTOP<br>
GROUPBOX &quot;Sample&quot;,1073,98,72,160,49,WS_GROUP<br>
CTEXT &quot;&quot;,1093,98,124,160,20,SS_NOPREFIX | NOT WS_GROUP<br>
CTEXT &quot;AaBbYyZz&quot;,1092,104,81,149,37,SS_NOPREFIX | NOT <br>
WS_VISIBLE<br>
END</tt> </p>
</body>
</html>
