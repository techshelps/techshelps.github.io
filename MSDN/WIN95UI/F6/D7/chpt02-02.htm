<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Trackbars</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">Trackbars</font></h1>

<p>A trackbar is a window containing a slider and tick marks. You
use a trackbar as a scrolling control: when you drag the slider
(sometimes referred to as the <i>thumb</i>), the control sends a
message to indicate the change in the slider's position. A
horizontal trackbar (the default style) sends a WM_HSCROLL
message, and a vertical trackbar uses a WM_VSCROLL message. The
tick marks indicate how many points you can move left and right
or up and down. </p>

<p>In Figure 2-1, you can see a simple horizontal trackbar with a
range of 1 through 10. </p>

<p><b>Figure 2-1.</b> </p>

<p><img src="fig2-1.gif" width="301" height="151"></p>

<h4><i>The anatomy of a trackbar.</i> </h4>

<p>Trackbars are based on scroll bar controls, and many of the
styles and notifications for trackbars are similar to those for
scroll bars. By default, the tick marks appear on the right side
of a vertical trackbar and on the bottom of a horizontal
trackbar. When a user drags the slider or clicks on either side
of it, the slider moves in the appropriate direction, tick by
tick. In other words, scrolling is not continuous; instead, you
scroll in increments indicated by the tick marks. For example, a
trackbar with 10 ticks and a range of 1 through 100 allows you to
scroll only in increments of 10. You can change the frequency of
ticks programmatically. </p>

<p>You can set a portion of a trackbar as a selection range. A
blue line in the channel of the trackbar indicates this selection
range, and two arrows (replacing the tick marks) indicate its
beginning and end. The selection range is a visual representation
only; it does not prevent the user from moving the slider outside
the selected area. This would be useful, for example, in a
scheduling application; the user could see the range of ticks
corresponding to the hours for which meetings have been
scheduled. In Figure 2-2, the line in the trackbar's channel
shows the selection range. To change this range, the application
sends a message, TBM_SETSEL, or uses MFC's SetSelection member
function. </p>

<p><b>Figure 2-2.</b> </p>

<p><img src="fig2-2.gif" width="192" height="30"></p>

<h4><i>A trackbar with a selection range.</i> </h4>

<p>Table 2-1 lists the styles you can choose when creating a
trackbar. You can combine styles for different looks, depending
on the effect you want. </p>

<table border="1">
    <tr>
        <td valign="top"><b>Style</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">TBS_AUTOTICKS</td>
        <td valign="top">Adds tick marks when you set the range
        on the trackbar by using the TBM_SETRANGE message (or the
        MFC SetRange member function).</td>
    </tr>
    <tr>
        <td valign="top">TBS_BOTH</td>
        <td valign="top">Places ticks on both sides of the
        trackbar.</td>
    </tr>
    <tr>
        <td valign="top">TBS_BOTTOM</td>
        <td valign="top">Places ticks on the bottom of a
        horizontal trackbar.</td>
    </tr>
    <tr>
        <td valign="top">TBS_ENABLESEL-RANGE</td>
        <td valign="top">Allows you to set a selection range on
        the trackbar.</td>
    </tr>
    <tr>
        <td valign="top">TBS_FIXEDLENGTH</td>
        <td valign="top">Specifies that the length of the slider
        remains the same even if the selection range changes.</td>
    </tr>
    <tr>
        <td valign="top">TBS_HORZ</td>
        <td valign="top">Specifies a horizontal trackbar. This is
        the default.</td>
    </tr>
    <tr>
        <td valign="top">TBS_LEFT</td>
        <td valign="top">Places ticks on the left side of a
        vertical trackbar.</td>
    </tr>
    <tr>
        <td valign="top">TBS_NOTHUMB</td>
        <td valign="top">Specifies that the trackbar has no
        slider.</td>
    </tr>
    <tr>
        <td valign="top">TBS_NOTICKS</td>
        <td valign="top">Specifies that no ticks are placed on
        the trackbar.</td>
    </tr>
    <tr>
        <td valign="top">TBS_RIGHT</td>
        <td valign="top">Places ticks on the right side of a
        vertical trackbar.</td>
    </tr>
    <tr>
        <td valign="top">TBS_TOP</td>
        <td valign="top">Places ticks on the top of a horizontal
        trackbar.</td>
    </tr>
    <tr>
        <td valign="top">TBS_VERT</td>
        <td valign="top">Specifies a vertical trackbar.</td>
    </tr>
</table>

<p><b>Table 2-1.</b> </p>

<p><i>Trackbar styles.</i> </p>

<p>I wrote a small sample called SLIDER (trackbars themselves are
sometimes referred to as <i>sliders</i>) to demonstrate the
trackbar styles and how they work. The design goals for SLIDER
included the following: </p>

<ul>
    <li>To create a trackbar with default styles. </li>
    <li>To create a horizontal trackbar with tick marks on the
        top and a selection range set. </li>
    <li>To create a vertical trackbar with tick marks on the left
        side. </li>
    <li>To set a range for a trackbar. </li>
    <li>To set the line size for a trackbar. (<i>Line size</i>
        specifies how many ticks the slider moves when the user
        presses the Up or Down arrow key.) </li>
    <li>To set the page size for a trackbar. (<i>Page size</i>
        specifies how many ticks the slider moves when the user
        presses the PgUp or PgDn key.) </li>
    <li>To demonstrate the notifications that are sent when you
        manipulate a trackbar. (In the SLIDER sample, the status
        bar at the bottom of the screen indicates the
        notification being sent to the trackbar that has the
        keyboard focus.) </li>
</ul>

<p>I also wrote an MFC-equivalent sample called MFCTRACK that
demonstrates how to create and manipulate trackbars using the MFC
CSliderCtrl class. You can see the MFCTRACK sample in Figure 2-3.
</p>

<p><b>Figure 2-3.</b> </p>

<p align="center"><img src="fig2-3.gif" width="766" height="562"></p>

<h4><i>The MFCTRACK sample.</i> </h4>
</body>
</html>
