<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>List View Control Messages and Member Functions</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>List View Control Messages and Member Functions</h2>

<p>Table 3-3 describes the messages and member functions
supported by list view controls. The MFC class that supports
these controls is the<b> </b>CListCtrl class. To use a list view
control in your application, you must link with the COMCTL32.LIB
library. If you write your application in C, you must include the
COMMCTRL.H header file; if you write the application in MFC, you
need to include the AFXCMN.H file in your STDAFX.H file (if you
are using STDAFX.H). </p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Member Function</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">LVM_ARRANGE</td>
        <td valign="top">Arrange</td>
        <td valign="top">Arranges the items in large icon view
        based on the flags set.</td>
    </tr>
    <tr>
        <td valign="top">LVM_CREATE- DRAGIMAGE</td>
        <td valign="top">Create- DragImage</td>
        <td valign="top">Creates a drag image for the specified
        item.</td>
    </tr>
    <tr>
        <td valign="top">LVM_DELETEALLITEMS</td>
        <td valign="top">DeleteAllItems</td>
        <td valign="top">Removes all items from a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_DELETECOLUMN</td>
        <td valign="top">DeleteColumn</td>
        <td valign="top">Removes a column from a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_DELETEITEM</td>
        <td valign="top">DeleteItem</td>
        <td valign="top">Removes a single item from a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_EDITLABEL</td>
        <td valign="top">EditLabel</td>
        <td valign="top">Begins in-place editing of an item's
        text label. This message selects and sets the focus to
        the item. When the user completes or cancels the editing,
        the edit window is destroyed and the handle becomes
        invalid. You can safely subclass the edit window, but do
        not destroy it. To cancel editing, send a WM_CANCELMODE
        message to the list view control.</td>
    </tr>
    <tr>
        <td valign="top">LVM_ENSUREVISIBLE</td>
        <td valign="top">EnsureVisible</td>
        <td valign="top">Ensures that an item is entirely or
        partially visible by scrolling the list view window if
        necessary.</td>
    </tr>
    <tr>
        <td valign="top">LVM_FINDITEM</td>
        <td valign="top">FindItem</td>
        <td valign="top">Searches for an item in a list view
        control.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETBKCOLOR</td>
        <td valign="top">GetBkColor</td>
        <td valign="top">Retrieves the background color of the
        list view window.</td>
    </tr>
</table>

<p><b>Table 3-3.</b><i> List view control messages and member
functions.</i> <i>(continued)</i> </p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Member Function</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">LVM_GETCALLBACKMASK</td>
        <td valign="top">GetCallbackMask</td>
        <td valign="top">Retrieves the callback mask for a list
        view window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETCOLUMN</td>
        <td valign="top">GetColumn</td>
        <td valign="top">Retrieves the attributes of a column in
        a list view control. The <i>mask</i> member of the
        LV_COLUMN structure passed in specifies which attributes
        to get. If the LVCF_TEXT flag is specified, the <i>pszText</i>
        member must contain the address of the buffer that
        receives the item's text, and the <i>cchTextMax</i>
        member must specify the size of the buffer.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETCOLUMNWIDTH</td>
        <td valign="top">GetColumnWidth</td>
        <td valign="top">Retrieves the width of a column in list
        view or details view.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETCOUNTPERPAGE</td>
        <td valign="top">GetCountPerPage</td>
        <td valign="top">Calculates the number of items that can
        fit vertically in the visible area in list view or
        details view.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETEDITCONTROL</td>
        <td valign="top">GetEditControl</td>
        <td valign="top">Retrieves the handle of the edit window
        used to edit an item's text label in place. The item
        being edited currently has the focus. When the user
        completes or cancels the editing, the edit window is
        destroyed and the handle becomes invalid. You can safely
        subclass the edit window, but do not destroy it. To
        cancel editing, send a WM_CANCELMODE message to the list
        view control.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETIMAGELIST</td>
        <td valign="top">GetImageList</td>
        <td valign="top">Retrieves the handle of an image list
        used for drawing items.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETITEM</td>
        <td valign="top">GetItem</td>
        <td valign="top">Retrieves the attributes of an item.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETITEMCOUNT</td>
        <td valign="top">GetItemCount</td>
        <td valign="top">Retrieves the number of items in a list
        view control.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETITEMPOSITION</td>
        <td valign="top">GetItemPosition</td>
        <td valign="top">Retrieves the position of an item in
        large icon view or small icon view.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETITEMRECT</td>
        <td valign="top">GetItemRect</td>
        <td valign="top">Retrieves the bounding rectangle for an
        item in the current view.</td>
    </tr>
</table>

<p><i>(continued)</i> </p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Member Function</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">LVM_GETITEMSTATE</td>
        <td valign="top">GetItemState</td>
        <td valign="top">Retrieves the state of an item.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETITEMTEXT</td>
        <td valign="top">GetItemText</td>
        <td valign="top">Retrieves the text of an item or a
        subitem.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETNEXTITEM</td>
        <td valign="top">GetNextItem</td>
        <td valign="top">Searches for the next item, starting
        from a specified item.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETORIGIN</td>
        <td valign="top">GetOrigin</td>
        <td valign="top">Retrieves the list view origin point,
        which is needed for setting the item position.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETSTRINGWIDTH</td>
        <td valign="top">GetStringWidth</td>
        <td valign="top">Retrieves the minimum column width
        necessary to display the given string. The returned width
        takes the current font and column margins of the list
        view control (but not the width of a small icon) into
        account.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETTEXTBKCOLOR</td>
        <td valign="top">GetTextBkColor</td>
        <td valign="top">Retrieves the background text color in a
        list view window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETTEXTCOLOR</td>
        <td valign="top">GetTextColor</td>
        <td valign="top">Retrieves the color of the text in a
        list view window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETTOPINDEX</td>
        <td valign="top">GetTopIndex</td>
        <td valign="top">Retrieves the index of the first visible
        item in a list view window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_GETVIEWRECT</td>
        <td valign="top">GetViewRect</td>
        <td valign="top">Retrieves the bounding rectangle of all
        items in large icon view.</td>
    </tr>
    <tr>
        <td valign="top">LVM_HITTEST</td>
        <td valign="top">HitTest</td>
        <td valign="top">Determines which item is at a specified
        position in a list view window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_INSERTCOLUMN</td>
        <td valign="top">InsertColumn</td>
        <td valign="top">Inserts a new column in a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_INSERTITEM</td>
        <td valign="top">InsertItem</td>
        <td valign="top">Inserts a new item in a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_REDRAWITEMS</td>
        <td valign="top">RedrawItems</td>
        <td valign="top">Forces a redraw of a range of items in a
        list view control. The specified items are not repainted
        until the control receives a WM_PAINT message. To repaint
        immediately, call the UpdateWindow function after using
        this message.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SCROLL</td>
        <td valign="top">Scroll</td>
        <td valign="top">Scrolls the contents of a list view
        window. In details view, the <i>dx</i> parameter must be
        0, and the <i>dy</i> parameter is the number of lines to
        scroll. </td>
    </tr>
</table>

<p><i>(continued)</i> </p>

<table border="1">
    <tr>
        <td valign="top"><b>Message</b></td>
        <td valign="top"><b>Member Function</b></td>
        <td valign="top"><b>Description</b></td>
    </tr>
    <tr>
        <td valign="top">LVM_SETBKCOLOR</td>
        <td valign="top">SetBkColor</td>
        <td valign="top">Sets the background color of a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETCALLBACKMASK</td>
        <td valign="top">SetCallbackMask</td>
        <td valign="top">Sets the callback mask for a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETCOLUMN</td>
        <td valign="top">SetColumn</td>
        <td valign="top">Sets the attributes of a column in a
        list view control.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETCOLUMNWIDTH</td>
        <td valign="top">SetColumnWidth</td>
        <td valign="top">Sets the width of a column in details
        view or list view.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETIMAGELIST</td>
        <td valign="top">SetImageList</td>
        <td valign="top">Sets the image list used for drawing
        items in a list view control.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETITEM</td>
        <td valign="top">SetItem</td>
        <td valign="top">Sets an item's attributes. </td>
    </tr>
    <tr>
        <td valign="top">LVM_SETITEMCOUNT</td>
        <td valign="top">SetItemCount</td>
        <td valign="top">Sets the item count of a list view
        control.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETITEMPOSITION</td>
        <td valign="top">SetItemPosition</td>
        <td valign="top">Sets the position of an item in large
        icon view or small icon view relative to the list view
        rectangle.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETITEMSTATE</td>
        <td valign="top">SetItemState</td>
        <td valign="top">Sets the state of an item.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETITEMTEXT</td>
        <td valign="top">SetItemText</td>
        <td valign="top">Sets the text of an item or a subitem.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETTEXTBKCOLOR</td>
        <td valign="top">SetTextBkColor</td>
        <td valign="top">Sets the background text color in a list
        view window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SETTEXTCOLOR</td>
        <td valign="top">SetTextColor</td>
        <td valign="top">Sets the text color in a list view
        window.</td>
    </tr>
    <tr>
        <td valign="top">LVM_SORTITEMS</td>
        <td valign="top">SortItems</td>
        <td valign="top">Sorts items in a list view control,
        using an application-defined comparison function.</td>
    </tr>
    <tr>
        <td valign="top">LVM_UPDATE</td>
        <td valign="top">Update</td>
        <td valign="top">Updates an item. If the list view
        control has the LVS_AUTOARRANGE style, the list view
        items will be automatically arranged in the window.</td>
    </tr>
</table>
</body>
</html>
