<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Property Sheet in MFC</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>Creating a Property Sheet in MFC</h2>

<p>For the MFC-based sample, I decided to use the built-in
classes CPropertySheet and CPropertyPage, which require
considerably less code than I had to implement in the C version
of the sample. The property sheet is displayed in response to the
House Properties command. </p>

<p><tt>void CMfcexpView::OnProperties () <br>
{<br>
if (m_iSelected == -1)<br>
return;<br>
<br>
// Create a property sheet object.<br>
CPropertySheet dlgPropertySheet (&quot;House Properties&quot;,
this);<br>
CHouse dlgHouse;<br>
CAgent dlgAgent;<br>
int index, count;<br>
LV_ITEM lvItem;<br>
char szAddSave [MAX_ADDRESS];<br>
<br>
dlgPropertySheet.AddPage (&amp;dlgHouse);<br>
dlgPropertySheet.AddPage (&amp;dlgAgent);<br>
<br>
// Fill in the list box with the cities.<br>
for (index = 0; index &lt; m_NumCities; index++)<br>
SendDlgItemMessage (IDC_CITY, CB_ADDSTRING, 0, <br>
(LPARAM) (LPCTSTR) m_rgCities[index].szCity);<br>
<br>
// Get the index to the selected list view item.<br>
index = m_ListCtl.GetNextItem (-1, LVNI_SELECTED);<br>
<br>
// Get the house address.<br>
lvItem.iItem = index;<br>
lvItem.iSubItem = 0;<br>
lvItem.mask = LVIF_TEXT;<br>
lvItem.cchTextMax = sizeof (szAddSave);<br>
lvItem.pszText = szAddSave;<br>
m_ListCtl.GetItem (&amp;lvItem);<br>
<br>
// Find the house in the list.<br>
for (count = 0; count &lt; m_NumHouses; count++)<br>
{<br>
if (strcmp (lvItem.pszText, m_rgHouses[count].szAddress) == 0)<br>
break;<br>
}<br>
m_iSelHouse = count;<br>
<br>
dlgHouse.m_Address = m_rgHouses[m_iSelHouse].szAddress; <br>
dlgHouse.m_City = m_rgHouses[m_iSelHouse].szCity;<br>
dlgHouse.m_Price = m_rgHouses[m_iSelHouse].iPrice;<br>
dlgHouse.m_Bedrooms = m_rgHouses[m_iSelHouse].iBeds ;<br>
dlgHouse.m_Bathrooms = m_rgHouses[m_iSelHouse].iBaths;<br>
<br>
dlgAgent.m_AgentName = m_rgHouses[m_iSelHouse].szAgent;<br>
dlgAgent.m_PhoneNumber = m_rgHouses[m_iSelHouse].szNumber;<br>
<br>
if (dlgPropertySheet.DoModal () == IDOK)<br>
{<br>
m_rgHouses[m_iSelHouse].szAddress = dlgHouse.m_Address; <br>
m_rgHouses[m_iSelHouse].szCity = dlgHouse.m_City;<br>
m_rgHouses[m_iSelHouse].iPrice = dlgHouse.m_Price;<br>
m_rgHouses[m_iSelHouse].iBeds = dlgHouse.m_Bedrooms;<br>
m_rgHouses[m_iSelHouse].iBaths = dlgHouse.m_Bathrooms;<br>
<br>
m_rgHouses[m_iSelHouse].szAgent = dlgAgent.m_AgentName;<br>
m_rgHouses[m_iSelHouse].szNumber = dlgAgent.m_PhoneNumber;<br>
<br>
GetDocument() -&gt; SetModifiedFlag();<br>
GetDocument() -&gt; UpdateAllViews(NULL);<br>
}<br>
}</tt></p>
</body>
</html>
