<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Paragraph Formatting</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h1><font size="5">Paragraph Formatting</font></h1>

<p>In a rich edit control, the user can also set the attributes
of entire paragraphs, including alignment (left-justified,
centered, or right-justified), tab stops, indention, and
numbering. </p>

<p>You can apply paragraph formatting to text in a rich edit
control by using the EM_SETPARAFORMAT message. As with all good
Windows APIs, you use the EM_GETPARAFORMAT message to find out
the current paragraph formatting. Both messages use the
PARAFORMAT structure to specify paragraph attributes. </p>

<p>The RICHED sample supports all three paragraph alignment
options, as the following code demonstrates. It's interesting to
note that it takes more code to ensure that the buttons are
&#147;pressed&#148; and the menu items are checked than it does
to actually set the paragraph format. </p>

<p><tt>VOID AlignCmd (HWND hWnd, HWND hWndRichEdit, int iAlign)<br>
{<br>
PARAFORMAT pf; <br>
<br>
// Fill out the PARAFORMAT structure with the mask and size.<br>
pf.cbSize = sizeof (pf);<br>
pf.dwMask = PFM_ALIGNMENT;<br>
<br>
switch (iAlign)<br>
{<br>
case IDM_ALIGNLEFT:<br>
pf.wAlignment = PFA_LEFT;<br>
§<br>
}<br>
<br>
// Set the new paragraph alignment.<br>
SendMessage (hWndRichEdit, EM_SETPARAFORMAT, 0, (LPARAM)&amp;pf);<br>
// Reset the dirty bit.<br>
SendMessage (hWndRichEdit, EM_SETMODIFY, (WPARAM)TRUE, OL);<br>
}</tt> </p>

<p>Figure 5-5 shows you the look that is produced by centering
text in the RICHED sample. </p>

<p>&nbsp;</p>

<p><b>Figure 5-5.</b> </p>

<p><b><img src="fig5-5.gif" width="483" height="323"></b></p>

<h4><i>Centered paragraphs in the RICHED sample.</i> </h4>
</body>
</html>
