<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Tree View Control</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<h2>Creating a Tree View Control</h2>

<p>To create a tree view control in C, use the CreateWindow or
CreateWindowEx function and specify the WC_TREEVIEW style for the
window class. If you are using MFC, create a CTreeCtrl object by
using the Create member function. The following code produces a
tree view control and uses the image list functions to create an
image list associated with it: </p>

<p><tt>HWND CreateTreeView (HWND hWndParent)<br>
{<br>
HWND hwndTree; // handle to tree view window<br>
RECT rcl; // rectangle for setting size of window<br>
HBITMAP hBmp; // handle to a bitmap<br>
HIMAGELIST hIml; // handle to image list<br>
<br>
// Ensure that the common control DLL is loaded.<br>
InitCommonControls ();<br>
<br>
// Get the size and position of the parent window.<br>
GetClientRect (hWndParent, &amp;rcl);<br>
<br>
// Create the tree view window.<br>
hwndTree = CreateWindowEx (<br>
0L,<br>
WC_TREEVIEW, // tree view class<br>
&quot;&quot;, // no default text<br>
WS_VISIBLE | WS_CHILD | WS_BORDER | TVS_HASLINES | TVS_HASBUTTONS
| <br>
TVS_LINESATROOT,<br>
0, 0,<br>
rcl.right - rcl.left, rcl.bottom - rcl.top - 15,<br>
hWndParent,<br>
(HMENU)ID_TREEVIEW,<br>
hInst,<br>
NULL);<br>
<br>
if (hwndTree == NULL)<br>
return NULL;<br>
<br>
// Initialize the tree view window.<br>
// First create the image list you will need.<br>
hIml = ImageList_Create (<br>
BITMAP_WIDTH, // width<br>
BITMAP_HEIGHT, // height<br>
0, // creation flags<br>
NUM_BITMAPS, // number of images<br>
0); // amount this list can grow<br>
<br>
// Load the bitmaps and add them to the image list.<br>
hBmp = LoadBitmap (hInst, MAKEINTRESOURCE (FORSALE));<br>
idxForSale = ImageList_Add (<br>
hIml, // handle to image list<br>
hBmp) // handle of bitmap to add<br>
NULL); // handle of bitmap mask<br>
<br>
hBmp = LoadBitmap (hInst, MAKEINTRESOURCE (REDMOND));<br>
idxRedmond = ImageList_Add (hIml, hBmp, NULL);<br>
<br>
hBmp = LoadBitmap (hInst, MAKEINTRESOURCE (BELLEVUE));<br>
idxBellevue = ImageList_Add (hIml, hBmp, NULL);<br>
<br>
hBmp = LoadBitmap (hInst, MAKEINTRESOURCE (SEATTLE));<br>
idxSeattle = ImageList_Add (hIml, hBmp, NULL);<br>
<br>
// Be sure that all the bitmaps were added.<br>
if (ImageList_GetImageCount (hIml) &lt; NUM_BITMAPS)<br>
return FALSE;<br>
<br>
// Associate the image list with the tree view control.<br>
TreeView_SetImageList (hwndTree, hIml, idxForSale);<br>
<br>
return hwndTree;<br>
}</tt></p>
</body>
</html>
