<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GLOBALS.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5658"></a>GLOBALS.H</h2>
<pre><code>#ifdef DEFINE_GLOBALS <br> <br>#define GLOBAL    <br> <br>// #include "counters.h" <br> <br>// initialize some of the globals <br>// only perfmon.c will define DEFINE_GLOBALS <br> <br>int     aiIntervals [] = { 1, 5, 15, 30, 60, 120, 300, 600, 3600 } ; <br> <br> <br>// setup CVS delimiter and line ending used by Export routines <br>CHAR           CommasStr[] = "," ; <br>CHAR           TabStr[] = "\t" ; <br>CHAR           *pDelimiter = TabStr ; <br>CHAR           LineEndStr[] = "\n" ; <br>TCHAR          DashLine[] = TEXT("- - - -") ; <br> <br>// PDFN           CounterFuncEntry = CounterEntry ; <br> <br> <br>#else <br>// only perfmon.c define DEFINE_GLOBALS, <br>// all other references to them as extern <br>#define GLOBAL extern <br> <br>#define  NumIntervals   9 <br>GLOBAL   int            aiIntervals [] ; <br> <br>// setup CVS delimiter and line ending used by Export routines <br>GLOBAL   CHAR           CommasStr[] ; <br>GLOBAL   CHAR           TabStr[] ; <br>GLOBAL   CHAR           *pDelimiter ; <br>GLOBAL   CHAR           LineEndStr[] ; <br>GLOBAL   TCHAR          DashLine[] ; <br>#endif <br> <br> <br> <br>//=============================// <br>// Graph Data Information      // <br>//=============================// <br> <br> <br>// GLOBAL   PPERFSYSTEM    pSysInfo ; <br>GLOBAL   PGRAPHSTRUCT   pGraphs; <br> <br> <br>//=============================// <br>// Font Information            // <br>//=============================// <br> <br> <br>GLOBAL   HFONT          hFontScales ; <br>GLOBAL   HFONT          hFontScalesBold ; <br>GLOBAL   LONG           HalfTextHeight; <br> <br>#ifdef KEEP_PRINT <br>GLOBAL   HFONT          hFontPrinterScales ; <br>GLOBAL   HFONT          hFontPrinterScalesBold ; <br>#endif <br> <br>//=============================// <br>// Control Information         // <br>//=============================// <br> <br> <br>GLOBAL   INT            iPerfmonView ; <br>GLOBAL   LANGID         iLanguage ; <br>GLOBAL   LANGID         iEnglishLanguage ; <br>GLOBAL   OPTIONS        Options ; <br> <br>GLOBAL   HICON          hIcon ; <br>GLOBAL   HANDLE         hInstance; <br>GLOBAL   HANDLE         hAccelerators ; <br> <br>GLOBAL   HANDLE         hEventLog ; <br> <br>GLOBAL   HMENU          hMenuChart ; <br>GLOBAL   HMENU          hMenuAlert ; <br>GLOBAL   HMENU          hMenuLog ; <br>GLOBAL   HMENU          hMenuReport ; <br> <br> <br>//=============================// <br>// Windows                     // <br>//=============================// <br> <br> <br>GLOBAL   HWND    hWndMain ; <br>GLOBAL   HWND    hWndGraph ; <br>GLOBAL   HWND    hWndLog ; <br>GLOBAL   HWND    hWndAlert ; <br>GLOBAL   HWND    hWndReport ; <br> <br>GLOBAL   HWND    hWndGraphDisplay ; <br>GLOBAL   HWND    hWndGraphLegend ; <br>GLOBAL   HWND    hWndGraphStatus ; <br> <br>GLOBAL   HWND    hWndAlertLegend ; <br>GLOBAL   HWND    hWndLogEntries ; <br> <br>GLOBAL   HWND    hWndToolbar ; <br>GLOBAL   HWND    hWndStatus ; <br> <br> <br>//=============================// <br>// System Metrics              // <br>//=============================// <br> <br> <br>GLOBAL   int     xScreenWidth ; <br>GLOBAL   int     yScreenHeight ; <br> <br>GLOBAL   int     xBorderWidth ; <br>GLOBAL   int     yBorderHeight ; <br> <br>GLOBAL   int     xScrollWidth ; <br>GLOBAL   int     yScrollHeight ; <br> <br>GLOBAL   int     xScrollThumbWidth ; <br>GLOBAL   int     yScrollThumbHeight ; <br> <br> <br>GLOBAL   int     xDlgBorderWidth ; <br>GLOBAL   int     yDlgBorderHeight ; <br> <br>GLOBAL   int     MinimumSize ; <br> <br>//=============================// <br>// Miscellaneous               // <br>//=============================// <br> <br>GLOBAL   int            iUnviewedAlerts ; <br>GLOBAL   COLORREF       crLastUnviewedAlert ; <br> <br>GLOBAL   LPTSTR         pChartFileName ; <br>GLOBAL   LPTSTR         pChartFullFileName ; <br>GLOBAL   LPTSTR         pAlertFileName ; <br>GLOBAL   LPTSTR         pAlertFullFileName ; <br>GLOBAL   LPTSTR         pLogFileName ; <br>GLOBAL   LPTSTR         pLogFullFileName ; <br>GLOBAL   LPTSTR         pReportFileName ; <br>GLOBAL   LPTSTR         pReportFullFileName ; <br>GLOBAL   LPTSTR         pWorkSpaceFileName ; <br>GLOBAL   LPTSTR         pWorkSpaceFullFileName ; <br> <br> <br>// globals for perfmornance improvements <br> <br>// frequently used GDI objects  <br>GLOBAL   UINT     ColorBtnFace ;  // for concave/convex button painting <br>GLOBAL   HBRUSH   hBrushFace ;    // for concave/convex button painting <br>GLOBAL   HPEN     hPenHighlight ; // for concave/convex button painting <br>GLOBAL   HPEN     hPenShadow ;    // for concave/convex button painting <br>GLOBAL   HPEN     hWhitePen ;     // for chart highlighting <br>GLOBAL   HANDLE   hbLightGray ;   // for painting the background <br> <br>// bPerfmonIconic is TRUE when perfmon is minimized. <br>// Thus, we don't need to update chart or report view until <br>// it is not iconized <br>GLOBAL   BOOL     bPerfmonIconic ; <br> <br>// bAddLineInPorgress is TRUE when Addline dialog is up.  It is used <br>// in freeing unused system during data collecting. (But not while <br>// addline dialog is still up) <br>GLOBAL   BOOL     bAddLineInProgress ; <br> <br>// bDelayAddAction is TRUE when reading setting files or adding more <br>// than 1 counter.  This is to delay some of the costly screen adjustments <br>// until we have added all the lines. <br>GLOBAL   BOOL     bDelayAddAction ; <br> <br> <br>// bExplainTxtButtonHit is TRUE when the ExplainText button in addline  <br>// dialog is clicked.  This is to save time and memory for fetching the <br>// help text, during BuildNameTable(), unless it is needed. <br>GLOBAL   BOOL     bExplainTextButtonHit ; <br> <br>// globals used for WinHelp <br>GLOBAL   DWORD          dwCurrentDlgID ; <br>GLOBAL   DWORD          dwCurrentMenuID ; <br>GLOBAL   LPTSTR         pszHelpFile ; <br> <br>// Following includes space for trailing NULL and preceeding \\'s <br>GLOBAL   TCHAR  LocalComputerName[MAX_COMPUTERNAME_LENGTH + 3]; <br>GLOBALTCHAR CmdLineComputerName[MAX_COMPUTERNAME_LENGTH + 3]; <br> <br>// Flag to indicate if we need to close local machine <br>GLOBAL   BOOL           bCloseLocalMachine ; <br> <br>// Timeout for data collection thread in msec <br>GLOBAL   DWORD          DataTimeOut ; <br> <br>// 20 sec for the data thread timeout <br>#define  DEFAULT_DATA_TIMEOUT    20000L <br> <br>//=============================// <br>// Log Playback Information    // <br>//=============================// <br> <br>GLOBAL   PLAYBACKLOG    PlaybackLog ; <br> <br>GLOBAL   REPORT         Report ; <br>GLOBAL   ALERT          Alert ; <br>GLOBAL   LOG            Log ; <br> <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
