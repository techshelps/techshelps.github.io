<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDESPY.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5589"></a>DDESPY.H</h2>
<pre><code><br>/******************************************************************************\ <br>*       This is a part of the Microsoft Source Code Samples.  <br>*       Copyright 1993 - 1998 Microsoft Corporation. <br>*       All rights reserved.  <br>*       This source code is only intended as a supplement to  <br>*       Microsoft Development Tools and/or WinHelp documentation. <br>*       See these sources for detailed information regarding the  <br>*       Microsoft samples programs. <br>\******************************************************************************/ <br> <br>/* <br> * DDESPY.H <br> * <br> * Header file for DDESPY Symbols <br> */ <br>#define DDEMLDB <br> <br>#include &lt;ddeml.h&gt; <br>#include "dialog.h" <br> <br>#define MH_INTCREATE                5 <br>#define MH_INTKEEP                  6 <br>#define MH_INTDELETE                7 <br> <br>#define IDD_MSGFILTERS              300 <br>#define IDRB_WM_DDE_INITIATE        305 <br>#define IDRB_WM_DDE_TERMINATE       306 <br>#define IDRB_WM_DDE_ADVISE          307 <br>#define IDRB_WM_DDE_UNADVISE        308 <br>#define IDRB_WM_DDE_ACK             309 <br>#define IDRB_WM_DDE_DATA            310 <br>#define IDRB_WM_DDE_REQUEST         311 <br>#define IDRB_WM_DDE_POKE            312 <br>#define IDRB_WM_DDE_EXECUTE         313 <br>#define IDRB_XTYP_ERROR             314 <br>#define IDRB_XTYP_ADVDATA           315 <br>#define IDRB_XTYP_ADVREQ            316 <br>#define IDRB_XTYP_ADVSTART          317 <br>#define IDRB_XTYP_ADVSTOP           318 <br>#define IDRB_XTYP_EXECUTE           319 <br>#define IDRB_XTYP_CONNECT           320 <br>#define IDRB_XTYP_CONNECT_CONFIRM   321 <br>#define IDRB_XACT_COMPLETE          322 <br>#define IDRB_XTYP_POKE              323 <br>#define IDRB_XTYP_REGISTER          324 <br>#define IDRB_XTYP_REQUEST           325 <br>#define IDRB_XTYP_DISCONNECT        326 <br>#define IDRB_XTYP_UNREGISTER        327 <br>#define IDRB_XTYP_WILDCONNECT       328 <br>#define IDRB_TERSE                  329 <br> <br>#define IDR_ACCEL                   30 <br>#define IDR_MENU                    31 <br>#define IDD_VALUEENTRY              50 <br>#define IDD_ABOUTBOX                51 <br>#define IDD_OPEN                    52 <br>#define IDM_OUTPUT_FIRST            100 <br>#define IDM_OUTPUT_FILE             100 <br>#define IDM_OUTPUT_DEBUG            101 <br>#define IDM_OUTPUT_SCREEN           102 <br>#define IDM_CLEARSCREEN             103 <br>#define IDM_MARK                    104 <br>#define IDM_FILTER_FIRST            200 <br>#define IDM_FILTER_HSZINFO          200 <br>#define IDM_FILTER_INIT_TERM        201 <br>#define IDM_FILTER_DDEMSGS          202 <br>#define IDM_FILTER_CALLBACKS        203 <br>#define IDM_FILTER_ERRORS           204 <br>#define IDM_FILTER_DIALOG           205 <br>#define IDM_TRACK_FIRST             301 <br>#define IDM_TRACK_HSZS              301 <br>#define IDM_TRACK_CONVS             302 <br>#define IDM_TRACK_LINKS             303 <br>#define IDM_TRACK_SVRS              304 <br>#define IDM_TRACK_LAST              304 <br>#define IDM_ABOUT                   401 <br>#define IDM_TEST                    402 <br> <br>#define IDM_MSGF_0                  500 <br>#define IDM_MSGF_1                  501 <br>#define IDM_MSGF_2                  502 <br>#define IDM_MSGF_3                  503 <br>#define IDM_MSGF_4                  504 <br>#define IDM_MSGF_5                  505 <br>#define IDM_MSGF_6                  506 <br>#define IDM_MSGF_7                  507 <br>#define IDM_MSGF_8                  508 <br> <br>#define IDM_CBF_0                   600 <br>#define IDM_CBF_1                   601 <br>#define IDM_CBF_2                   602 <br>#define IDM_CBF_3                   603 <br>#define IDM_CBF_4                   604 <br>#define IDM_CBF_5                   605 <br>#define IDM_CBF_6                   606 <br>#define IDM_CBF_7                   607 <br>#define IDM_CBF_8                   608 <br>#define IDM_CBF_9                   609 <br>#define IDM_CBF_10                  610 <br>#define IDM_CBF_11                  611 <br>#define IDM_CBF_12                  612 <br>#define IDM_CBF_13                  613 <br>#define IDM_CBF_14                  614 <br> <br>#define IDS_TITLE                   0 <br>#define IDS_DEFAULT_OUTPUT_FNAME    1 <br>#define IDS_INIFNAME                2 <br>#define IDS_CLASS                   3 <br>#define IDS_HUH                     4 <br>#define IDS_ZERO                    5 <br>#define IDS_CRLF                    6 <br>#define IDS_TRACKTITLE_1            7 <br>#define IDS_TRACKTITLE_2            8 <br>#define IDS_TRACKTITLE_3            9 <br>#define IDS_TRACKTITLE_4            10 <br>#define IDS_TRACKHEADING_1          11 <br>#define IDS_TRACKHEADING_2          12 <br>#define IDS_TRACKHEADING_3          13 <br>#define IDS_TRACKHEADING_4          14 <br>#define IDS_QCLOSEFILE_TEXT         15 <br>#define IDS_QCLOSEFILE_CAPTION      16 <br>#define IDS_ACTION_CLEANEDUP        17 <br>#define IDS_ACTION_DESTROYED        18 <br>#define IDS_ACTION_INCREMENTED      19 <br>#define IDS_ACTION_CREATED          20 <br>#define IDS_SENT                    21 <br>#define IDS_POSTED                  22 <br>#define IDS_INPUT_DATA              23 <br>#define IDS_TABDDD                  24 <br>#define IDS_OUTPUT_DATA             25 <br>#define IDS_WARM                    26 <br>#define IDS_HOT                     27 <br>#define IDS_UNKNOWN_CALLBACK        28 <br>#define IDS_APPIS                   29 <br>#define IDS_TOPICIS                 30 <br>#define IDS_ITEMIS                  31 <br>#define IDS_OR                      32 <br>#define IDS_FACKREQ                 33 <br>#define IDS_DEFERUPD                34 <br>#define IDS_FACK                    35 <br>#define IDS_FBUSY                   36 <br>#define IDS_FRELEASE                37 <br>#define IDS_FREQUESTED              38 <br>#define IDS_ERRST0                  39 <br>#define IDS_ERRST1                  40 <br>#define IDS_ERRST2                  41 <br>#define IDS_ERRST3                  42 <br>#define IDS_ERRST4                  43 <br>#define IDS_ERRST5                  44 <br>#define IDS_ERRST6                  45 <br>#define IDS_ERRST7                  46 <br>#define IDS_ERRST8                  47 <br>#define IDS_ERRST9                  48 <br>#define IDS_ERRST10                 49 <br>#define IDS_ERRST11                 50 <br>#define IDS_ERRST12                 51 <br>#define IDS_ERRST13                 52 <br>#define IDS_ERRST14                 53 <br>#define IDS_ERRST15                 54 <br>#define IDS_ERRST16                 55 <br>#define IDS_ERRST17                 56 <br>#define IDS_MSG0                    57 <br>#define IDS_MSG1                    58 <br>#define IDS_MSG2                    59 <br>#define IDS_MSG3                    60 <br>#define IDS_MSG4                    61 <br>#define IDS_MSG5                    62 <br>#define IDS_MSG6                    63 <br>#define IDS_MSG7                    64 <br>#define IDS_MSG8                    65 <br>#define IDS_TYPE0                   66 <br>#define IDS_TYPE1                   67 <br>#define IDS_TYPE2                   68 <br>#define IDS_TYPE3                   69 <br>#define IDS_TYPE4                   70 <br>#define IDS_TYPE5                   71 <br>#define IDS_TYPE6                   72 <br>#define IDS_TYPE7                   73 <br>#define IDS_TYPE8                   74 <br>#define IDS_TYPE9                   75 <br>#define IDS_TYPE10                  76 <br>#define IDS_TYPE11                  77 <br>#define IDS_TYPE12                  78 <br>#define IDS_TYPE13                  79 <br>#define IDS_TYPE14                  80 <br>#define IDS_TYPE15                  81 <br>#define IDS_INVALID_FNAME           82 <br>#define IDS_PROF_OUT_FILE           83 <br>#define IDS_PROF_OUT_DEBUG          84 <br>#define IDS_PROF_OUT_SCREEN         85 <br>#define IDS_PROF_MONITOR_STRINGHANDLES   86 <br>#define IDS_PROF_MONITOR_INITIATES       87 <br>#define IDS_PROF_MONITOR_DDE_MESSAGES    88 <br>#define IDS_PROF_MONITOR_CALLBACKS       89 <br>#define IDS_PROF_MONITOR_ERRORS          90 <br>#define IDS_PROF_TRACK_STRINGHANDLES     91 <br>#define IDS_PROF_TRACK_LINKS             92 <br>#define IDS_PROF_TRACK_CONVERSATIONS     93 <br>#define IDS_PROF_TRACK_SERVICES          94 <br>#define IDS_PROF_TERSE              95 <br>#define IDS_YES                     96 <br>#define IDS_NO                      97 <br>#define IDS_MARKDLGTITLE            98 <br>#define IDS_SEPERATOR               99 <br>#define IDS_MARKTEXT                100 <br>#define IDS_LISTCLASS               101 <br>#define IDS_LBOX                    102 <br>#define IDS_WILD                    103 <br>#define IDS_STRINGCLASS             104 <br>#define IDS_FMT_CB1                 105 <br>#define IDS_FMT_CB2                 106 <br>#define IDS_FMT_CTXT1               107 <br>#define IDS_FMT_DATAIS1             108 <br>#define IDS_FMT_ER1                 109 <br>#define IDS_FMT_EXEC1               110 <br>#define IDS_FMT_MSG1                111 <br>#define IDS_FMT_MSG2                112 <br>#define IDS_FMT_STATUSIS            113 <br>#define IDS_FMT_TRS_CB1             114 <br>#define IDS_FMT_TRS_CB2             115 <br>#define IDS_FMT_TRS_CTXT1           116 <br>#define IDS_FMT_TRS_DATAIS1         117 <br>#define IDS_FMT_TRS_ER1             118 <br>#define IDS_FMT_TRS_EXEC1           119 <br>#define IDS_FMT_TRS_MSG1            120 <br>#define IDS_FMT_TRS_MSG2            121 <br>#define IDS_FMT_TRS_STATUSIS        122 <br>#define IDS_FMT_SH_MSG1             123 <br>#define IDS_FMT_BADATOM    124 <br>#define IDS_LAST                    124 <br>// IDS_LAST marks the last string ID that is used. <br> <br>#define T_ATOM                      0x0001 <br>#define T_OPTIONHANDLE              0x0002 <br>#define T_FORMAT                    0x0004 <br>#define T_STATUS                    0x0008 <br>#define T_DATAHANDLE                0x0010 <br>#define T_STRINGHANDLE              0x0020 <br>#define T_VALUE                     0x0040 <br>#define T_APP                       0x0080 <br>#define T_TOPIC                     0x0100 <br>#define T_ITEM                      0x0200 <br>#define T_OR                        0x0400 <br> <br> <br>#define IO_FILE                     0 <br>#define IO_DEBUG                    1 <br>#define IO_SCREEN                   2 <br>#define IO_COUNT                    3 <br> <br>#define IF_HSZ                      0 <br>#define IF_SEND                     1 <br>#define IF_POST                     2 <br>#define IF_CB                       3 <br>#define IF_ERR                      4 <br> <br>#define IF_COUNT                    5 <br> <br>#define IT_HSZS                     0 <br>#define IT_CONVS                    1 <br>#define IT_LINKS                    2 <br>#define IT_SVRS                     3 <br> <br>#define IT_COUNT                    4 <br> <br>#define MAX_FNAME                   MAX_PATH <br>#define BUFFER_SIZE                 400 <br>#define MAX_MARK                    32 <br>#define MAX_DISPDATA                48      // max bytes of non-text data to dump <br> <br>#define CLINES                      100 <br>#define CCHARS                      200 <br> <br>extern HINSTANCE hInst; <br> <br>/* macro definitions */ <br>#define MyAlloc(cb)         (LPTSTR)LocalAlloc(LPTR, (cb)) <br>#define MyFree(p)           (LocalUnlock((HANDLE)(p)), LocalFree((HANDLE)(p))) <br>#define RefString(id)       (LPTSTR)apszResources[id] <br>#define Type2String(type)   apszResources[IDS_TYPE0 + ((type &amp; XTYP_MASK) &gt;&gt; XTYP_SHIFT)] <br>#define MPRT(b)             (isprint(b) ? (b) : '.') <br> <br>/* prototype definitions */ <br>BOOL InitApplication(HANDLE); <br>BOOL InitInstance(HANDLE, INT); <br>VOID CloseApp(VOID); <br>LONG CALLBACK MainWndProc(HWND, UINT, WPARAM, LPARAM); <br>BOOL CALLBACK About(HWND, UINT, WPARAM, LPARAM); <br>BOOL SetFilters(VOID); <br>BOOL CALLBACK OpenDlg(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam); <br>BOOL CALLBACK FilterDlgProc(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam); <br>LPTSTR DisectMsgLP(UINT msg, MONMSGSTRUCT *pmms, LPTSTR pszBuf); <br>LPTSTR DisectWord(UINT type, UINT data, DDEML_MSG_HOOK_DATA *pdmhd, LPTSTR pstr); <br>LPTSTR pdf(UINT fmt); <br>LPTSTR DumpFormat(UINT fmt, LPTSTR pstr); <br>LPTSTR DdeMsg2String(UINT msg); <br>LPTSTR Error2String(UINT error); <br>LPTSTR DumpData(LPBYTE pData, UINT cb, TCHAR *szBuf, UINT fmt); <br>LPTSTR GetHszName(HSZ hsz); <br>VOID OutputString(LPTSTR pstr); <br>VOID GetProfile(VOID); <br>VOID SaveProfile(VOID); <br>BOOL GetProfileBoolean(LPTSTR pszKey, BOOL fDefault); <br>VOID SetProfileBoolean(LPTSTR pszKey, BOOL fSet); <br>HDDEDATA CALLBACK DdeCallback(UINT wType, UINT wFmt, HCONV hConv, HSZ hsz1, <br>      HSZ hsz2, HDDEDATA hData, UINT lData1, UINT lData2); <br>INT FAR DoDialog(LPTSTR lpTemplateName, DLGPROC lpDlgProc, UINT param, <br>      BOOL fRememberFocus, HWND hwndParent, HANDLE hInst); <br>BOOL  CALLBACK MarkDlgProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam); <br> <br>/* testsubs.c prototypes */ <br> <br>/* StringWindow structure */ <br>typedef struct { <br>    INT cchLine; <br>    INT cLine; <br>    INT offBuffer; <br>    INT offBufferMax; <br>    INT offBottomLine; <br>    INT offOutput; <br>    INT cBottomLine; <br>    INT cLeftChar; <br>} STRWND; <br> <br> <br>BOOL InitTestSubs(VOID); <br>VOID CloseTestSubs(HANDLE hInst); <br>VOID NextLine(STRWND *psw); <br>VOID DrawString(HWND hwnd, TCHAR *sz); <br>VOID ClearScreen(STRWND *psw); <br>LONG CALLBACK StrWndProc(HWND hwnd, UINT msg, WPARAM wParam, UINT lParam); <br>VOID scroll(HWND hwnd, UINT msg, UINT sliderpos, UINT style); <br>BOOL StrWndCreate(HWND hwnd, INT cchLine, INT cLine); <br>VOID PaintStrWnd(HWND hwnd, LPPAINTSTRUCT pps); <br> <br>#define strchr      My_mbschr <br>#ifdef stricmp <br>#undef stricmp <br>#endif <br>#define stricmp     lstrcmpi <br>LPTSTR _CRTAPI1 My_mbschr(LPTSTR, unsigned short); <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
