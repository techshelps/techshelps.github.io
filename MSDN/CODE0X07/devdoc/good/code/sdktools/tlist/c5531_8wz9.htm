<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TLIST.C</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5535"></a>TLIST.C</h2>
<pre><code><br>/******************************************************************************\ <br>*       This is a part of the Microsoft Source Code Samples.  <br>*  Copyright (C) 1994-1998 Microsoft Corporation. <br>*       All rights reserved.  <br>*       This source code is only intended as a supplement to  <br>*       Microsoft Development Tools and/or WinHelp documentation. <br>*       See these sources for detailed information regarding the  <br>*       Microsoft samples programs. <br>\******************************************************************************/ <br> <br>/*++ <br> <br>Copyright (c) 1994  Microsoft Corporation <br> <br>Module Name: <br> <br>    tlist.c <br> <br>Abstract: <br> <br>    This module implements a task list application. <br> <br>--*/ <br> <br>#include &lt;windows.h&gt; <br>#include &lt;stdio.h&gt; <br>#include &lt;stdlib.h&gt; <br>#include &lt;string.h&gt; <br>#include "common.h" <br> <br> <br>#define MAX_TASKS           256 <br> <br>#define PrintTask(idx) \ <br>        printf( "%4d %-16s", tlist[idx].dwProcessId, tlist[idx].ProcessName ); \ <br>        if (tlist[idx].hwnd) { \ <br>            printf( "  %s", tlist[idx].WindowTitle ); \ <br>        } \ <br>        printf( "\n" ); <br> <br> <br>DWORD numTasks; <br>TASK_LIST tlist[MAX_TASKS]; <br> <br>VOID Usage(VOID); <br> <br> <br>int _cdecl <br>main( <br>    int argc, <br>    char *argv[] <br>    ) <br> <br>/*++ <br> <br>Routine Description: <br> <br>    Main entrypoint for the TLIST application.  This app prints <br>    a task list to stdout.  The task list include the process id, <br>    task name, ant the window title. <br> <br>Arguments: <br> <br>    argc             - argument count <br>    argv             - array of pointers to arguments <br> <br>Return Value: <br> <br>    0                - success <br> <br>--*/ <br> <br>{ <br>    DWORD             i; <br>    TASK_LIST_ENUM    te; <br>    BOOL              fTree; <br>    OSVERSIONINFO     verInfo = {0}; <br>    LPGetTaskList     GetTaskList; <br>    LPEnableDebugPriv EnableDebugPriv; <br> <br> <br>    if (argc &gt; 1 &amp;&amp; (argv[1][0] == '-' || argv[1][0] == '/') &amp;&amp; argv[1][1] == '?') { <br>        Usage(); <br>    } <br> <br>    // <br>    // Determine what system we're on and do the right thing <br>    // <br> <br>    verInfo.dwOSVersionInfoSize = sizeof (verInfo); <br>    GetVersionEx(&amp;verInfo); <br> <br>    switch (verInfo.dwPlatformId) <br>    { <br>    case VER_PLATFORM_WIN32_NT: <br>       GetTaskList     = GetTaskListNT; <br>       EnableDebugPriv = EnableDebugPrivNT; <br>       break; <br> <br>    case VER_PLATFORM_WIN32_WINDOWS: <br>       GetTaskList = GetTaskList95; <br>       EnableDebugPriv = EnableDebugPriv95; <br>       break; <br> <br>    default: <br>       printf ("tlist requires Windows NT or Windows 95\n"); <br>       return 1; <br>    } <br> <br> <br> <br>    fTree = FALSE; <br> <br>    // <br>    // Obtain the ability to manipulate other processes <br>    // <br>    EnableDebugPriv(); <br> <br>    // <br>    // get the task list for the system <br>    // <br>    numTasks = GetTaskList( tlist, MAX_TASKS ); <br> <br>    // <br>    // enumerate all windows and try to get the window <br>    // titles for each task <br>    // <br>    te.tlist = tlist; <br>    te.numtasks = numTasks; <br>    GetWindowTitles( &amp;te ); <br> <br>    // <br>    // print the task list <br>    // <br>    for (i=0; i&lt;numTasks; i++) { <br>PrintTask( i ); <br>    } <br> <br>    // <br>    // end of program <br>    // <br>    return 0; <br>} <br> <br>VOID <br>Usage( <br>    VOID <br>    ) <br> <br>/*++ <br> <br>Routine Description: <br> <br>    Prints usage text for this tool. <br> <br>Arguments: <br> <br>    None. <br> <br>Return Value: <br> <br>    None. <br> <br>--*/ <br> <br>{ <br>    fprintf( stderr, "Microsoft (R) Windows NT (TM) Version 3.5 TLIST\n" ); <br>    fprintf( stderr, "Copyright (C) 1994-1995 Microsoft Corp. All rights reserved\n\n" ); <br>    fprintf( stderr, "usage: TLIST\n" ); <br>    ExitProcess(0); <br>} <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
