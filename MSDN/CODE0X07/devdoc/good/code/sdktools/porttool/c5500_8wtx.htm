<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PORTTOOL.H</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5505"></a>PORTTOOL.H</h2>
<pre><code><br>/******************************************************************************\ <br>*       This is a part of the Microsoft Source Code Samples.  <br>*       Copyright 1993 - 1998 Microsoft Corporation. <br>*       All rights reserved.  <br>*       This source code is only intended as a supplement to  <br>*       Microsoft Development Tools and/or WinHelp documentation. <br>*       See these sources for detailed information regarding the  <br>*       Microsoft samples programs. <br>\******************************************************************************/ <br> <br>#include &lt;windows.h&gt; <br>#include &lt;commdlg.h&gt; <br>#include &lt;string.h&gt; <br>#include &lt;stdlib.h&gt; <br> <br>#define strncpy     My_mbsncpy <br>#define strtok      My_mbstok <br>unsigned char * _cdecl My_mbsncpy( <br>                        unsigned char *, const unsigned char *, size_t); <br>unsigned char * _cdecl My_mbstok(unsigned char *, unsigned char *); <br> <br>#ifdef RC_INVOKED <br>#define ID(id) id <br>#else <br>#define ID(id) MAKEINTRESOURCE(id) <br>#endif <br> <br>#undef EDIT_FIXED <br> <br>// resource ID's <br>#define IDPortTool ID(1) <br>#define IDBkPort ID(2) <br> <br>#define IDA_PORTTOOL 1 <br> <br>// edit control child window ID <br>#define IDC_EDIT 1000 <br> <br>// max string lengths <br>#define MAXSEARCHSTRING  80 <br>#define MAXPTRDEFINITION 200 <br>#define MAXPTRDEVICE 50 <br>#define MAXPTRDRIVER 50 <br>#define MAXPTRPORT 50 <br> <br>// extra byte window word and long definitions <br>#define WL_HWNDEDIT 0 <br>#define WW_SCROLL 4 <br>#define WW_UNTITLED 6 <br>#define WW_SEARCHCASE 8 <br>#define WW_SEARCHDN 10 <br>#define WL_HPTRDEVNAMES  12 <br>#define CBWNDEXTRA 16 <br> <br>// menuitem IDs, file submenu <br>#define IDM_FILENEW  1001 <br>#define IDM_FILEOPEN 1002 <br>#define IDM_FILESAVE 1003 <br>#define IDM_FILESAVEAS 1004 <br>#define IDM_FILEPRINT 1005 <br>#define IDM_FILESETUP 1006 <br>#define IDM_FILEEXIT 1007 <br>#define IDM_FILEABOUT 1008 <br>// edit submenu <br>#define IDM_EDITUNDO 2000 <br>#define IDM_EDITCUT  2001 <br>#define IDM_EDITCOPY 2002 <br>#define IDM_EDITPASTE 2003 <br>#define IDM_EDITCLEAR 2004 <br>#define IDM_EDITSELECT 2005 <br>#define IDM_EDITWRAP 2006 <br>#define IDM_EDITSCROLL 2007 <br>#define IDM_EDITFONT 2008 <br>// search submenu <br>#define IDM_SEARCHFIND 3001 <br>#define IDM_SEARCHNEXT 3002 <br>#define IDM_SEARCHPREV 3003 <br>// port submenu <br>#define IDM_PORTCURFILE  4000 <br>#define IDM_PORTBKGND 4001 <br> <br>#define IDM_FUNCTION1 5000 <br>#define IDM_FUNCTION2 5001 <br>#define IDM_FUNCTION3 5002 <br>#define IDM_FUNCTION4 5003 <br>#define IDM_FUNCTION5 5004 <br> <br>// dialog &amp; control IDs <br> <br>// about dialog <br>#define IDD_ABOUT ID(300) <br>#define IDC_SYSTEM       301 <br>#define IDC_APP          302 <br>#define IDC_VERSION      303 <br>#define IDC_COPYRIGHT    304 <br>#define IDC_OSVERSION    305 <br> <br>// cancel print dialog <br>#define IDD_CANCELDLG ID(400) <br>#define IDC_PRINTDEVICE  401 <br>#define IDC_PRINTPORT 402 <br>#define IDC_PRINTTITLE 403 <br> <br>// port options dialog <br>#define IDD_OPTIONSDLG ID(500) <br>#define IDC_NOAPIS 501 <br>#define IDC_NOMESSAGES 502 <br>#define IDC_NOSTRUCTURES 503 <br>#define IDC_NOMACROS 504 <br>#define IDC_NOCONSTANTS  505 <br>#define IDC_NOTYPES 506 <br>#define IDC_NOCUSTOM 507 <br>#define IDC_IGNORECASE 508 <br>#define IDC_CURTOKEN 509 <br>#define IDC_IGNORETOKEN  510 <br> <br>// port current file dialog <br>#define IDD_PORTDIALOG ID(600) <br>#define IDC_SEARCHFOUND  601 <br>#define IDC_ISSUECNT 602 <br>#define IDC_LINENO 603 <br>#define IDC_LINE 604 <br>#define IDC_ISSUE 605 <br>#define IDC_CONTINUE 606 <br>#define IDC_SUGGESTION 608 <br>#define IDC_SUGGESTLABEL 609 <br>#define IDC_OPTIONS 610 <br>#define IDC_DONE 611 <br>#define IDC_HELPM 612 <br>#define IDC_RESTART 613 <br> <br>// background port status dialog <br>#define IDD_BKPORTDIALOG ID(700) <br>#define IDC_BKNOAPIS 702 <br>#define IDC_BKNOMESSAGES 703 <br>#define IDC_BKNOSTRUCTURES 704 <br>#define IDC_BKNOMACROS 705 <br>#define IDC_BKNOCONSTANTS 706 <br>#define IDC_BKNOTYPES 707 <br>#define IDC_BKNOCUSTOM 708 <br>#define IDC_BKIGNORECASE 709 <br>#define IDC_CHANGEOPTIONS 710 <br>#define IDC_ADDFILE 711 <br>#define IDC_COMPLETE 712 <br>#define IDC_LINES 713 <br>#define IDC_ISSUES 714 <br>#define IDC_ABORTFILE 715 <br>#define IDC_FILEPATH 716 <br>#define IDC_FILELIST 717 <br>#define IDC_BKDONE 718 <br> <br> <br>// file I/O error stringtable entries <br>#define IDS_OPENFAILED  WM_USER+101 <br>#define IDS_NOSIZE  WM_USER+102 <br>#define IDS_READFAILED  WM_USER+103 <br>#define IDS_REALLOCFAILED  WM_USER+104 <br>#define IDS_EDITWNDFAILED  WM_USER+105 <br>#define IDS_GETHANDLEFAILED  WM_USER+106 <br>#define IDS_WRITEOPENFAILED  WM_USER+107 <br>#define IDS_WRITEFAILED   WM_USER+108 <br>#define IDS_PTRCOMMDLGFAILED  WM_USER+109 <br>#define IDS_PRINTABORTED  WM_USER+110 <br>#define IDS_STARTDOCFAILED  WM_USER+111 <br>#define IDS_SETABORTPROCFAILED  WM_USER+112 <br>#define IDS_CANCELDLGFAILED  WM_USER+113 <br>#define IDS_PTRCONFIGFAILED  WM_USER+114 <br>#define IDS_NOFILETOPORT  WM_USER+115 <br>#define IDS_PORTINITFAILED  WM_USER+116 <br>#define IDS_MEMORYFAILED  WM_USER+117 <br>#define IDS_FONTFAILEDTOCREATE  WM_USER+118 <br>#define IDS_LOADPORTFAILED  WM_USER+119 <br>#define IDS_PROCADDRESSFAILED  WM_USER+120 <br>#define IDS_UNTITLED  WM_USER+201 <br>#define IDS_APPNAME  WM_USER+202 <br>#define IDS_PRINTJOB  WM_USER+203 <br>#define IDS_PRINTERROR  WM_USER+204 <br>#define IDS_DATACHANGED   WM_USER+205 <br>#define IDS_DEFAULTFILEEXT  WM_USER+206 <br>#define IDS_SAVEASTITLE   WM_USER+207 <br>#define IDS_FILEOPENTITLE  WM_USER+208 <br>#define IDS_STRINGNOTFOUND  WM_USER+209 <br>#define IDS_SEARCHDLGFAILED  WM_USER+210 <br>#define IDS_WINDOWSAPPNAME  WM_USER+211 <br>#define IDS_DEVICENAME  WM_USER+212 <br>#define IDS_PORTFILE  WM_USER+213 <br>#define IDS_SEARCHING  WM_USER+214 <br>#define IDS_FOUND  WM_USER+215 <br>#define IDS_NOMOREPORTISSUES  WM_USER+216 <br>#define IDS_INIFILE  WM_USER+217 <br>#define IDS_WINHELP  WM_USER+218 <br>#define IDS_NOTYETIMPLEMENTED  WM_USER+219 <br>#define IDS_NOT   WM_USER+220 <br>#define IDS_PORTDLLFILE   WM_USER+221 <br>#define IDS_CHECKSTRING   WM_USER+222 <br>#define IDS_BKPORTNEWLINE  WM_USER+223 <br>#define IDS_BKPORTHEADER  WM_USER+224 <br>#define IDS_BKPORTTOKEN   WM_USER+225 <br>#define IDS_BKPORTISSUE   WM_USER+226 <br>#define IDS_BKPORTSUGGEST  WM_USER+227 <br>#define IDS_BKPORTHELP  WM_USER+228 <br>#define IDS_BKPORTHELPFILE  WM_USER+229 <br>#define IDS_BKPORTEOL  WM_USER+230 <br>#define IDS_BKPORTABORT   WM_USER+231 <br>#define IDS_BKPORTSTATUS  WM_USER+232 <br>#define IDS_BKPORTCANCEL  WM_USER+233 <br>#define IDS_BKPORTSTARTFAILED  WM_USER+234 <br>#define IDS_CANTBUILDFILELIST  WM_USER+235 <br>#define IDS_PORTFILEBACKMSG  WM_USER+236 <br>#define IDS_DEFAULTPORTEXT    WM_USER+237 <br>#define IDS_PORTFILEOPENTITLE    WM_USER+238 <br>#define IDS_UNKNOWN_ERROR         WM_USER+239 <br>#define IDS_ERR_INVALID_THREADHND WM_USER+240 <br>#define IDS_CANCEL_BKGND_PROCESS  WM_USER+241 <br>#define IDS_ABORT_TITLE           WM_USER+242 <br>#define IDS_FILE_FILTER_SPEC1     WM_USER+243 <br>#define IDS_EXT_FILTER_SPEC1      WM_USER+244 <br>#define IDS_FILE_FILTER_SPEC2     WM_USER+245 <br>#define IDS_EXT_FILTER_SPEC2      WM_USER+246 <br>#define IDS_FILE_FILTER_SPEC3     WM_USER+247 <br>#define IDS_EXT_FILTER_SPEC3      WM_USER+248 <br>#define IDS_FILE_FILTER_SPEC4     WM_USER+249 <br>#define IDS_EXT_FILTER_SPEC4      WM_USER+250 <br>#define IDS_FILE_FILTER_SPEC5     WM_USER+251 <br>#define IDS_EXT_FILTER_SPEC5      WM_USER+252 <br> <br>// define background porting handle array indexes <br>#define BKPORT_ABORT0 <br>#define BKPORT_STATUS1 <br>#define nBKPORTEVENTS2 <br> <br>#define MAXBKTHREADS20 <br> <br>// define structure used in background porting <br>typedef struct tagBkPortFile <br>    { <br>    char    szFile[MAX_PATH]; <br>    char    szFilePath[MAX_PATH]; <br>    DWORD   dwPTFlags; <br>    HANDLE  hThread; <br>    HWND    hDlg; <br>    }BKPORTFILESTRUCT, * LPBKPORTFILESTRUCT; <br> <br> <br>// linked list structure defines background files being ported <br>typedef struct _BKFILELIST <br>    { <br>    BKPORTFILESTRUCTbkFile; <br>    HANDLEhEvents[nBKPORTEVENTS]; <br>    LPVOIDNext; <br>    }BKFILELIST, * LPBKFILELIST; <br> <br> <br>// function prototypes defined in PORTTOOL.C <br>#define UM_SAVEFILE WM_USER+1 <br>VOIDWINAPI ErrorNotify (HWND, int); <br>LONGWINAPI MainWndProc (HWND, UINT, UINT, LONG); <br>BOOLWINAPI AboutDlgProc (HWND, UINT, UINT, LONG); <br> <br>// globals and function prototypes defined in PTFILE.C <br>externcharlpszFilePath[MAX_PATH]; <br>BOOLWINAPI GetFileName(HWND, char *, char *); <br>BOOLWINAPI GetFileFromPath (char *, char *); <br>BOOLWINAPI GetIniFile (char *); <br>intWINAPI SaveFile (HWND, char *); <br>BOOLWINAPI SaveAsFileName (HWND, char *, char *); <br>intWINAPI LoadFile (HWND, char *); <br>BOOL WINAPI GetPortIniFileName ( HWND, char *, char *); <br> <br>// globals and function prototypes defined in PTFIND.C <br>externcharlpszSearch[MAXSEARCHSTRING+1]; <br>externHWNDhDlgSearch; <br>BOOLWINAPI FindDialog (HWND, WORD, WORD, char *); <br>BOOLWINAPI LocateText (HWND, WORD, WORD, char *); <br> <br>// globals and function prototypes defined in PTPRINT.C <br>#define UM_CANCELPRINT  WM_USER+2 <br>intWINAPI PrintFile (HWND); <br>intWINAPI PrinterSetup (HWND); <br>BOOLWINAPI GetPrinterConfig (HWND); <br> <br>// globals and function prototypes defined in PTDLGS.C <br>BOOLWINAPI OptionsDlgProc (HWND, UINT, UINT, LONG); <br>BOOLWINAPI PortDlgProc (HWND, UINT, UINT, LONG); <br>BOOLWINAPI BkPortDlgProc (HWND, UINT, UINT, LONG); <br> <br>// globals and function prototypes defined in PTBKPORT.C <br>#define UM_THREADCOMPLETE WM_USER+2 <br>#define UM_STATUSUPDATE  WM_USER+3 <br>HANDLEWINAPI StartBkPortThread (LPBKPORTFILESTRUCT); <br>BOOLWINAPI CreateEvents (HANDLE *, LPBKPORTFILESTRUCT); <br>voidWINAPI DestroyEvents (HANDLE *); <br> <br>BOOL WINAPI InitPortData(CHAR *); <br> <br>CHAR                lpszPortIniFilePath[MAX_PATH]; </code></pre>
<p>&nbsp;</p></body>
</HTML>
