<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add a Menu to the ActiveX Document</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconaddmenutoactivexdocument"></a>Adding a Menu to the ActXDoc Project</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconAddMenuToActiveXDocumentC">
</object></p>
<p>
You can add menus to your ActiveX document using the Menu Editor. Because an ActiveX document alone cannot have a menu, the menu you create will be merged with the application you used to view the ActiveX document. Thus, you must consider menu negotiation when adding a menu to an ActiveX document.</p>
<p>
When users navigate to your ActiveX document, they may not have any indication of its origin (or that it is an ActiveX document). To remedy this, you should always include an "About" form with your ActiveX document.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a sample ActiveX control. It begins with the topic <a href="vbconcreatingdocumentobject.htm">Creating an ActiveX Document</a>.</p>
<p class=label>
<b>To add a menu and About box to the FirstDoc ActiveX document</b>
<ol>
<li>
On the <b>Project</b> menu, click <b>Add Form</b>.<br><br></li>
<li>
In the <b>Add Form </b>dialog box, double-click the <b>About Dialog</b> icon to add an About Box form to the project.<br><br></li>
<li>
Set Caption property of the form and controls according to the following table.<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Object</b></td>
<td class=label width=50%><b>Caption value</b></td>
</tr>
<tr valign=top>
<td width=50%>frmAbout</td>
<td width=50%>About FirstDoc</td>
</tr>
<tr valign=top>
<td width=50%>lblTitle</td>
<td width=50%>FirstDoc ActiveX Document</td>
</tr>
<tr valign=top>
<td width=50%>lblVersion</td>
<td width=50%>Version 1.0</td>
</tr>
<tr valign=top>
<td width=50%>lblDescription</td>
<td width=50%>ActiveX document</td>
</tr>
</table><br>
</li>
<li>
Delete the Label control named lblDisclaimer.<br><br></li>
<li>
In the <b>Project Explorer </b>window, double-click <b>FirstDoc</b> to bring its designer forward.<br><br></li>
<li>
Click the FirstDoc designer to select it, and on the <b>Tools </b>menu, click <b>Menu Editor </b>to display the menu editor dialog box.<br><br></li>
<li>
Click the <b>Caption </b>box and type <b>&amp;Help</b>.<br><br></li>
<li>
Click the <b>Name </b>box and type <b>mnuHelp</b>.<br><br></li>
<li>
Click the <b>NegotiatePosition</b> box, and click <b>Right</b>.<br><br></li>
<li>
Click the <b>Next </b>button to create a new menu item.<br><br></li>
<li>
In the <b>Caption</b> box type <b>About FirstDoc</b>.<br><br></li>
<li>
In the <b>Name</b> box type <b>mnuAbout</b>.<br><br></li>
<li>
Click the right-facing arrow button to indent the menu item.<br><br></li>
<li>
Click <b>OK</b>.<br><br></li>
<li>
Double-click the FirstDoc designer to bring its <b>Code</b> window to the front.<br><br></li>
<li>
Add the following code to the mnuAbout Click event:<pre><code>Private Sub mnuAbout_Click()
 &nbsp; frmAbout.Show vbModal
End Sub
</code></pre>
</li>
</ol>
<h2>Running the Project</h2>
<p>
Once you have added a menu to the UserDocument, you can run the project, view the ActiveX document in Internet Explorer, and see the how the menu has been negotiated.
<ol>
<li>
Run the project by pressing f5.<br><br></li>
<li>
In Internet Explorer, type the path of the FirstDoc.vbd file in the <b>Address</b> box or select it from the drop-down list of previously typed addresses.<br><br></li>
<li>
On Internet Explorer's command bar, click the <b>Help </b>menu, and among the menu items will be the <b>FirstDoc Help</b> menu item.<br><br></li>
<li>
Click <b>About FirstDoc</b> to see the new About box.</li>
</ol>
<h3>Step by Step</h3>
<p>
This topic is part of a series that walks you through creating a sample ActiveX document.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>To</b></td>
<td class=label width=66%><b>See</b></td>
</tr>
<tr valign=top>
<td width=34%>Go to the next step</td>
<td width=66%><a href="vbconlifecycleofdocumentobject.htm">Life Cycle of a UserDocument</a></td>
</tr>
<tr valign=top>
<td width=34%>Start from the beginning</td>
<td width=66%><a href="vbconcreatingdocumentobject.htm">Creating an ActiveX Document</a></td>
</tr>
</table>
</BODY>
</HTML>
