<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Detecting Mouse Buttons</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbcondetectingmousebuttons"></a>Detecting Mouse Buttons</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconDetectingMouseButtonsC">
</object></p>
<p>
You can make your applications more powerful by writing code that responds differently to mouse events, depending on which mouse button is used or whether the SHIFT, CTRL, or ALT key is pressed. To provide these options, you use the arguments <i>button </i>and <i>shift</i> with the MouseDown, MouseUp, and MouseMove event procedures. Techniques for using the <i>shift</i> argument are described in "Detecting SHIFT, CTRL , and ALT States" later in this chapter.</p>
<p>
The MouseDown, MouseUp, and MouseMove events use the <i>button</i> argument to determine which mouse button or buttons are pressed. The <i>button</i> argument is a bit-field argument — a value in which each bit represents a state or condition. These values are expressed as integers. The three least-significant (lowest) bits represent the left, right, and middle mouse buttons, as shown in Figure 11.4.</p>
<p class=label>
<b>Figure 11.4&nbsp;&nbsp;&nbsp;How bits represent the state of the mouse</b></p>
<p>
<img src="avp11005.gif" border=0></p>
<p>
The default value of each bit is 0 (False). If no buttons are pressed, the binary value of the three bits is 000. If you press the left button, the binary value, or pattern, changes to 001. The left-button bit-value changes from 0 (False) to 1 (True).</p>
<p>
The <i>button</i> argument uses either a decimal value or an constant to represent these binary patterns. The following table lists the binary value of the bits, the decimal equivalent, and the Visual Basic constant:</p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Binary Value</b></td>
<td class=label width=25%><b>Decimal Value</b></td>
<td class=label width=25%><b>Constant</b></td>
<td class=label width=25%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=25%>001</td>
<td width=25%>1</td>
<td width=25%>vbLeftButton</td>
<td width=25%>The left button is pressed.</td>
</tr>
<tr valign=top>
<td width=25%>010</td>
<td width=25%>2</td>
<td width=25%>vbRightButton</td>
<td width=25%>The right button is pressed.</td>
</tr>
<tr valign=top>
<td width=25%>100</td>
<td width=25%>4</td>
<td width=25%>vbMiddleButton</td>
<td width=25%>The middle button is pressed.</td>
</tr>
</table><br>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Visual Basic provides constants that represent the binary values of the <i>button</i> and <i>shift</i> arguments. These constants can be used interchangeably with their equivalent decimal values. Not all values have corresponding constants, however. The values for some button and/or shift combinations are derived by simply adding decimal values.</p>
<p>
The middle button is assigned to decimal value 4. Pressing the left and right buttons simultaneously produces a single digit value of 3 (1+2). On a three-button mouse, pressing all three buttons simultaneously produces the decimal value of 7 (4+2+1). The following table lists the remaining button values derived from the possible button combinations:</p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Binary Value</b></td>
<td class=label width=25%><b>Decimal Value</b></td>
<td class=label width=25%><b>Constant</b></td>
<td class=label width=25%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=25%>000</td>
<td width=25%>0</td>
<td width=25%></td>
<td width=25%>No buttons are pressed.</td>
</tr>
<tr valign=top>
<td width=25%>011</td>
<td width=25%>3</td>
<td width=25%>vbLeftButton + vbRightButton</td>
<td width=25%>The left and right buttons are pressed.</td>
</tr>
<tr valign=top>
<td width=25%>101</td>
<td width=25%>5</td>
<td width=25%>vbLeftButton + vbMiddleButton</td>
<td width=25%>The left and middle buttons are pressed.</td>
</tr>
<tr valign=top>
<td width=25%>110</td>
<td width=25%>6</td>
<td width=25%>vbRightButton + vbMiddleButton</td>
<td width=25%>The right and middle buttons are pressed.</td>
</tr>
<tr valign=top>
<td width=25%>111</td>
<td width=25%>7</td>
<td width=25%>vbRightButton + vbMiddleButton + vbLeftButton</td>
<td width=25%>All three buttons are pressed.</td>
</tr>
</table><br>
</BODY>
</HTML>
