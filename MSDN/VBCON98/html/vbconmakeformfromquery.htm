<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Create a Data Grid Form Based on a Query</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconmakeformfromquery"></a>Create a Data Grid Form Based on a Query</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconMakeFormFromQuery_C">
</object></p>
<p>
You can use the same drag-and-drop technique you used to create a simple data-bound form to create a data grid form based on a query. Simply create a Command object based on an SQL query, then drag the Command object onto a blank form. You can use the Query designer to create the SQL query.</p>
<p>
In this topic, you'll create a form that displays orders for French customers in the Northwind Traders sample database in a data grid.</p>
<p class=label>
<b>To create a data-bound form based on a query</b>
<ol>
<li>
Create a data environment Command object based on a query.<br><br></li>
<li>
Drag the Command object from the data environment designer to a blank form.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a simple database application that interacts with data in Nwind.mdb. It begins with the topic, <a href="vbconconnecttoisamdatabase.htm">Interacting with Data in a Microsoft Jet/Microsoft Access Database</a>.</p>
<h2>Create a Data Environment Command Object Based on a Query</h2>
<p>
You can easily create a data environment Command object based on a query by using the Query designer. First, follow the instructions in the previous steps in this scenario to open an existing Data Environment designer or create a new one.</p>
<p>
Create the Command object by clicking the Add Command button on the Data Environment toolbar, or by right-clicking the connection in the Data Environment designer and selecting Add Command from the menu. You can then specify the Command object's name, the connection it uses, and the source of its data in the Command Properties dialog box. To display this dialog box, right-click the Command object in your data environment and then choose Properties from the shortcut menu.</p>
<p>
For example, to create a Command objects based on a query of orders by French customers in the Northwind Traders sample database, set the following properties:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=39%><b>Property</b></td>
<td class=label width=61%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=39%>Command Name</td>
<td width=61%>FrenchCustomersOrders</td>
</tr>
<tr valign=top>
<td width=39%>Connection</td>
<td width=61%>Connection1</td>
</tr>
</table><br>
<p>
Rather than select a specific database object as the basis for the command, as you did in the "Create a Data Environment Command Object" step, select SQL Statement as the source of data for the command. Then click the SQL Builder button to open the Query designer, where you specify the tables, fields, and criteria for the query.</p>
<p>
For example, create a query that returns information about orders by French customers by dragging the Customers and Orders tables from the Data View window (available from the View menu) to the upper pane of the Query designer. (The designer automatically displays a line between the tables showing their related field, CustomerID.) Then click the check box next to the fields that you want to include in the query:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=39%><b>Table</b></td>
<td class=label width=61%><b>Field</b></td>
</tr>
<tr valign=top>
<td width=39%>Orders</td>
<td width=61%>OrderID</td>
</tr>
<tr valign=top>
<td width=39%>Orders</td>
<td width=61%>CustomerID</td>
</tr>
<tr valign=top>
<td width=39%>Orders</td>
<td width=61%>OrderDate</td>
</tr>
<tr valign=top>
<td width=39%>Orders</td>
<td width=61%>ShippedDate</td>
</tr>
<tr valign=top>
<td width=39%>Customers</td>
<td width=61%>Country</td>
</tr>
</table><br>
<p>
Finally, specify the criteria for the query by entering "France" in the Country field's Criteria box in the Query designer grid. As you specify the fields and criteria, the Query designer automatically builds the query's underlying SQL statement:</p>
<pre><code>SELECT Orders.OrderID, Orders.CustomerID, Orders.OrderDate, Orders.ShippedDate, Customers.Country
FROM Customers, Orders
WHERE Customers.CustomerID = Orders.CustomerID AND (Customers.Country = 'France')</code></pre>
<p>
To view the results of the query, right-click the Query designer and select Run. The Query designer displays the resulting recordset.</p>
<p>
When you save the query, the Data Environment designer updates the Command object to use the SQL statement as its data source. To verify the statement, you can open the Command properties dialog box and see the statement is in the SQL Statement box.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvovrQueryDesigner">
</object><a href=JavaScript:alink_2.Click()>Designing Queries</a>.</p>
<h2>Drag the Command Object from the Data Environment to a Blank Form</h2>
<p>
In the "Create a Simple Data-Bound Form" topic, you created a data-bound form that displayed data in text boxes by dragging a Command object from the data environment designer to a blank form. You can also display the data in a data grid by dragging a data environment Command object.</p>
<p>
For example, to create a data grid that displays the orders of French customers, select the FrenchCustomersOrders Command object you created in the previous step. Then while pressing the right mouse button, drag the Command object onto a blank form. Visual Basic displays a popup menu that lets you select whether to create a data grid or bound control. When you select Data Grid, Visual Basic automatically creates a data grid that displays records from the command's recordset.</p>
<p>
When you run the form, Visual Basic displays the records returned by the FrenchCustomersOrders Command object in a data grid.</p>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a simple database application that interacts with data in Nwind.mdb.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>To</b></td>
<td class=label width=69%><b>See</b></td>
</tr>
<tr valign=top>
<td width=31%>Go to the next step</td>
<td width=69%><a href="vbconcreatedetailreportonform.htm">Create a Master/Detail Form</a></td>
</tr>
<tr valign=top>
<td width=31%>Start from the beginning</td>
<td width=69%><a href="vbconconnecttoisamdatabase.htm">Interacting with Data in a Microsoft Jet/Microsoft Access Database</a></td>
</tr>
</table><br>
</BODY>
</HTML>
