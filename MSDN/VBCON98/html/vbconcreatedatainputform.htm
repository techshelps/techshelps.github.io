<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Data Entry HTML Page</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcreatedatainputform"></a>Creating a Data Entry HTML Page</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCreateDataInputFormC">
</object></p>
<p>
Visual Basic lets you easily create an HTML page that you can use to enter records in an SQL Server database. You can use the DHTML Page designer to create the HTML page and a data environment Command object to establish a connection to the database. You can write code that uses ActiveX Data Objects (ADO) to handle data processing.</p>
<p>
This topic shows how to create an HTML page to enter data in the Customers table you created in the "Adding a Table to an SQL Server Database" topic. It shows how to use the data environment and ADO code to pass data from the HTML page to the table.</p>
<p class=label>
<b>To create a data entry HTML page</b>
<ol>
<li>
Add labels and TextField elements to an HTML page.<br><br></li>
<li>
Create a data environment Command object.<br><br></li>
<li>
Add a Button element to the page to append records to a table.<br><br></li>
<li>
Load the HTML page.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a simple database application that interacts with data in an SQL Server database. It begins with the topic <a href="vbconquerysqlserverdatabase.htm">Creating a DHTML Application that Interacts with SQL Server Data</a>.</p>
<h3>Add Labels and TextField Elements to an HTML Page</h3>
<p>
You can use the DHTML Page designer to design your HTML page. Double-click the DHTML Page designer icon in the Project Explorer to bring up the designer. To add a label to a page, simply click in the right pane of the designer window and type the label text. To add a TextField element to the page, select the element from the toolbox and drag it to the right pane of the designer window.</p>
<p>
For example, you can create a data entry HTML page that lets you enter address information in the new Customers table in the Pubs sample database. First, type "Customer ID:" in the right pane of the designer window to serve as a label for a Customer ID TextField element, then drag a TextField element next to the label, set its Name and ID properties to CustomerID, and clear its Value property. Repeat the same process for CompanyName, Address, City, Region, PostalCode, and Country elements.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information on using the DHTML Page designer, see <a href="vbcondesigningpagesforclientinternetapplications.htm">Designing Pages for DHTML Applications</a> in Chapter 2, "Developing DHTML Applications" of <i>Building Internet Applications</i> in the <i>Component Tools Guide</i>.</p>
<h3>Create a Data Environment Command Object</h3>
<p>
As you saw in the "Interact with Data in a Microsoft Jet/Microsoft Access Database" scenario, a data environment Command object can give you access to a table's data. In a DHTML application, a data environment Command object can serve as a logical "middle tier," linking a data source with data displayed on an HTML page.</p>
<p>
Create the Command object by clicking the Add Command button on the Data Environment toolbar, or by right-clicking the connection in the Data Environment designer and selecting Add Command from the shortcut menu. You can then specify the Command object's name, the connection it uses, and the source of its data in the Command Properties dialog box. To display this dialog box, right-click the Command object in your data environment and then choose Properties from the menu..</p>
<p>
For example, you can create a data environment Command object that provides access to the new Customers table in the Pubs sample database. Set the following properties, using the connection to the Pubs sample database that you created in the "Adding a Table to an SQL Server Database" topic:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=39%><b>Property</b></td>
<td class=label width=61%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=39%>Command Name</td>
<td width=61%>Customers</td>
</tr>
<tr valign=top>
<td width=39%>Connection</td>
<td width=61%>Connection1</td>
</tr>
<tr valign=top>
<td width=39%>Database Object</td>
<td width=61%>Table</td>
</tr>
<tr valign=top>
<td width=39%>Object Name</td>
<td width=61%>dbo.customers</td>
</tr>
</table><br>
<p>
To enable updating of records in the Customers table, change the default lock type used by the command. Click the Advanced tab in the Command Properties dialog box and set the Lock Type property to Optimistic.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information on creating a data environment Command object, see <a href="vbconcommandobjects.htm">Command Objects</a> in "About the Data Environment Designer."</p>
<h3>Add a Button Element to the Page to Append Records to a Table</h3>
<p>
To provide a way to append the data entered on the HTML page to a table, you can add a Button element to the HTML page by dragging a Button element to the right pane of the DHTML Page designer. For example, you can add a Button element that appends address information to the Customers table. First, drag a Button element to the right pane of the designer window, and then set its name and id properties to AddCustomer.</p>
<p>
Using the data environment and ADO, you can easily append records to a table in an SQL database. Refer to the data entered in an HTML page's TextField elements using the element's Value property, then use ADO code to append the data to the corresponding field in the table. The recordset underlying a data environment Command object can provide the "middle tier" between the table and the HTML page.</p>
<p>
For example, to enable the data entry HTML page for the new Customers table in the Pubs sample database, add the following code to the onclick event procedure for the DHTML Page object's AddCustomer Button element:</p>
<pre><code>Private Function AddCustomer_onclick() As Boolean

   ' Run the Customers Command object.
   MyDataEnvironment.Customers

   ' Append values from the DHTML Page object's elements
   ' to the command's underlying recordset.
   With MyDataEnvironment.rsCustomers
      .AddNew
      !CustomerID = CustomerID.Value
      !CompanyName = CompanyName.Value
      !Address = Address.Value
      !City = City.Value
      !Region = Region.Value
      !PostalCode = PostalCode.Value
      !Country = Country.Value
      .Update
      .Close
   End With

   ' Clear the elements.
   CustomerID.Value = ""
   CompanyName.Value = ""
   Address.Value = ""
   City.Value = ""
   Region.Value = ""
   PostalCode.Value = ""
   Country.Value = ""

End Function
</code></pre>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information on using ADO, see <a href="vbconusingadodaordoinvisualbasic.htm">ADO, DAO and RDO in Visual Basic</a>.</p>
<h3>Load the HTML Page</h3>
<p>
To view the finished page in Internet Explorer, press F5 or click the Start button on the toolbar. You can also explicitly make a dynamic-link library and HTML page for the project by setting properties on the Make tab of the Project Properties dialog box, then selecting Make .dll from the File menu.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information on testing your DHTML applications, see <a href="vbcontestingyourclientinternetapplication.htm">Testing Your DHTML Application</a> in Chapter 2, "Developing DHTML Applications" in <i>Building Internet Applications</i> in the <i>Component Tools Guide</i>.</p>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a simple DHTML application that interacts with data in an SQL Server database.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>To</b></td>
<td class=label width=69%><b>See</b></td>
</tr>
<tr valign=top>
<td width=31%>Go to the next step</td>
<td width=69%><a href="vbconcreatesqltableusingdesigner.htm">Creating an HTML Page for Viewing and Updating Data</a></td>
</tr>
<tr valign=top>
<td width=31%>Start from the beginning</td>
<td width=69%><a href="vbconquerysqlserverdatabase.htm">Creating a DHTML Application that Interacts with SQL Server Data</a></td>
</tr>
</table><br>
</BODY>
</HTML>
