<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Controlling Display Using DrawMode</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcontrollingdisplayusingdrawmode"></a>Controlling Display Using DrawMode</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconControllingDisplayUsingDrawModeC">
</object></p>
<p>
The DrawMode property determines what happens when you draw one pattern on top of another. Although changing the DrawMode property usually has some effect (especially with color systems), it is often not necessary to use this property when you are drawing on a blank or pure white background, or on a background of undifferentiated color.</p>
<p>
You can set DrawMode to a value from 1 to 16. Common settings appear in the following table.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=15%><b>Setting</b></td>
<td class=label width=85%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=15%>4</td>
<td width=85%>Not Copy Pen. Draws the inverse of the line pattern, regardless of what is already there.</td>
</tr>
<tr valign=top>
<td width=15%>7</td>
<td width=85%>Xor Pen. Displays the difference between the line pattern and the existing display, as explained later in this section. Drawing an object twice with this mode restores the background precisely as it was.</td>
</tr>
<tr valign=top>
<td width=15%>11</td>
<td width=85%>No operation. In effect, this turns drawing off.</td>
</tr>
<tr valign=top>
<td width=15%>13</td>
<td width=85%>Copy Pen (default). Applies the line’s pattern, regardless of what is already there.</td>
</tr>
</table><br>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See "DrawMode Property" in the <i>Language Reference</i>.</p>
<h3>The Xor Pen</h3>
<p>
A DrawMode setting of 7 is useful for animation. Drawing a line twice restores the existing display precisely as it was before the line was drawn. This makes it possible to create one object that "moves over" a background without corrupting it, because you can restore the background as you go. Most modes are not guaranteed to preserve the old background.</p>
<p>
For example, the following code moves a circle every time the mouse is clicked. No matter what pattern was underneath the circle, it gets restored.</p>
<pre><code>Private Sub Form_Click ()
   ForeColor = 255 : DrawMode = 7
   Circle (CurrentX, CurrentY), 1000
   CurrentX = CurrentX + 220
   CurrentY = CurrentY + 220
   Circle (CurrentX, CurrentY), 1000
End Sub
</code></pre>
<p>
The Xor Pen draw mode (and most of the other DrawMode settings) works by comparing each individual pixel in the draw pattern (called the "Pen") and the corresponding pixel in the existing area (called the "Destination"). On monochrome systems, the pixel is turned either on or off, and Visual Basic performs a simple logical comparison: It turns a pixel on if either the Pen or Destination pixel is on, but not if both are on.</p>
<p>
In color systems, each pixel is assigned a color value. For DrawMode settings such as Xor Pen, Visual Basic compares each corresponding pair of pixels in the Pen and Destination and performs a binary (bitwise) comparison. The result determines the color value of the resulting pixel, as shown in Figure 12.21.</p>
<p class=label>
<b>Figure 12.21&nbsp;&nbsp;&nbsp;Using the Xor Pen to set the binary value of a pixel in a line</b></p>
<p>
<img src="avp12021.gif" border=0></p>
</BODY>
</HTML>
