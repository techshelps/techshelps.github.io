<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Simple Data Report</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcreatingsimpledatareport"></a>Creating a Simple Data Report</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCreatingSimpleDataReport_C">
</object></p>
<p>
This topic creates a simple data report using a Data Environment designer as a data source. The Data Environment designer uses the NorthWind database supplied with Visual Basic to create a simple hierarchical cursor. The cursor contains two tables, Customers and Orders, and uses the CustomerID field to link the two. The finished report resembles the figure below.</p>
<p class=label>
<b>Simple Data Report: Order Dates by Customers</b></p>
<p>
<img src="vb4vo81.gif" border=0></p>
<p>
Before you begin the step-by-step process, ensure that the Northwind database (Nwind.mdb) is present on your computer. If it is not present, copy the file from your Visual Basic CD onto your hard disk.</p>
<p class=label>
<b>To create a simple hierarchical cursor in the Data Environment designer</b>
<ol>
<li>
Create a new <b>Standard EXE</b> project.<br><br></li>
<li>
On the <b>Project</b> menu, click <b>Add Data Environment </b>to add a designer to your project. If the designer is not listed on the <b>Project</b> menu, click <b>Components</b>. Click the <b>Designers</b> tab, and click <b>Data Environment </b>to add the designer to the menu.<p class=atl>
<b>Note</b> &nbsp; The first four kinds of ActiveX designers loaded for a project are listed on the <b>Project</b> menu. If more than four designers are loaded, the later ones will be available from the <b>More ActiveX Designers</b> submenu on the <b>Project</b> menu. </p></li>
<li>
On the <b>Data Link Properties</b> dialog box, click <b>Microsoft Jet 3.51 OLE DB Provider</b>. This selects the correct OLE DB provider for accessing a Jet database.<br><br></li>
<li>
Click the Next button to get to the <b>Connection</b> tab.<br><br></li>
<li>
Click the ellipsis button (…) next to the first text box.<br><br></li>
<li>
Use the <b>Select Access Database </b>dialog box to navigate to the nwind.mdb file, which is installed in the Program Files\Microsoft Visual Studio\Vb98 directory.<br><br></li>
<li>
Click <b>OK</b> to close the dialog box.<br><br></li>
<li>
Right-click the <b>Connection1</b> icon, and click <b>Rename</b>. Change the name of the icon to Northwind.<br><br></li>
<li>
Right-click the <b>Northwind </b>icon, and then click <b>Add Command</b> to display the <b>Command1</b> dialog box. In the dialog box, set the properties as shown below:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=32%><b>Property</b></td>
<td class=label width=68%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=32%>Command Name </td>
<td width=68%>Customers</td>
</tr>
<tr valign=top>
<td width=32%>Connection </td>
<td width=68%>Northwind</td>
</tr>
<tr valign=top>
<td width=32%>DataBase Object </td>
<td width=68%>Table</td>
</tr>
<tr valign=top>
<td width=32%>Object Name </td>
<td width=68%>Customers</td>
</tr>
</table><br>
</li>
<li>
Click <b>OK</b> to close the dialog box.<br><br></li>
<li>
Right-click the <b>Customers </b>command, and click <b>Add Child Command</b> to display the <b>Command2 </b>dialog box. In the dialog box, set the properties as shown below:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Property</b></td>
<td class=label width=66%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=34%>Command Name </td>
<td width=66%>Orders</td>
</tr>
<tr valign=top>
<td width=34%>Connection </td>
<td width=66%>Northwind</td>
</tr>
<tr valign=top>
<td width=34%>DataBase Object </td>
<td width=66%>Table</td>
</tr>
<tr valign=top>
<td width=34%>Object Name </td>
<td width=66%>Orders</td>
</tr>
</table><br>
</li>
<li>
Click the <b>Relation </b>tab. The <b>Relate to a Parent Command Object </b>check box should be checked. The <b>Parent </b>box should contain <b>Customers</b>; both the <b>Parent Fields </b>and <b>Child Fields/Parameters </b>boxes should contain <b>CustomerID</b>.<p class=tl>
When designing relational databases, it's customary for related tables to use the same name for linking fields. In this case, the linking fields are both named CustomerID. The Data Environment designer automatically matches such pairs in the dialog box.</P></li>
<li>
Click <b>Add</b>. Click <b>OK </b>to close the dialog box.<p class=tl>
Clicking the Add button adds the relation to the Command object. After closing the dialog box, the Data Environment designer reflects the relationship by displaying the two commands as a hierarchy. This hierarchy will be used to create the data report.</P></li>
<li>
Set the properties of the project and designer according to the settings below, then save the project:<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>Object</b></td>
<td class=label width=33%><b>Property</b></td>
<td class=label width=34%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=33%>Project</td>
<td width=33%>Name</td>
<td width=34%>prjNwind</td>
</tr>
<tr valign=top>
<td width=33%>DataEnvironment</td>
<td width=33%>Name</td>
<td width=34%>deNwind</td>
</tr>
<tr valign=top>
<td width=33%>Form</td>
<td width=33%>Name</td>
<td width=34%>frmShowReport</td>
</tr>
</table><br>
</li>
</ol>
<h2>Creating the Data Report</h2>
<p>
Once the Data Environment designer has been created, you can create a data report. Because not all of the fields in the data environment will be useful in a report, this series of topics creates a limited report that displays only a few fields.</p>
<p class=label>
<b>To create a new data report</b>
<ol>
<li>
On the <b>Project</b> menu, click <b>Add Data Report</b>, and Visual Basic will add it to your project. If the designer is not on the <b>Project</b> menu, click <b>Components</b>. Click the <b>Designers</b> tab, and click <b>Data Report </b>to add the designer to the menu.<p class=atl>
<b>Note</b> &nbsp; The first four kinds of ActiveX designers loaded for a project are listed on the <b>Project</b> menu. If more than four designers are loaded, the later ones will be available from the <b>More ActiveX Designers</b> submenu on the <b>Project</b> menu. </p></li>
<li>
Set the properties of the <b>DataReport </b>object according to the table below:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=40%><b>Property</b></td>
<td class=label width=60%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=40%>Name</td>
<td width=60%>rptNwind</td>
</tr>
<tr valign=top>
<td width=40%>Caption</td>
<td width=60%>Northwind Data Report</td>
</tr>
</table>
</li>
<li>
On the <b>Properties </b>window, click <b>DataSource </b>and then click <b>deNwind</b>. Then click <b>DataMember</b> and click <b>Customers</b>.<p class=atl>
<B><b>Important</b></B>&nbsp;&nbsp;&nbsp;To set the DataSource property to deNwind, the Data Environment designer must be open. If it is closed, press CTRL+R to display the Project window, then double-click the data environment icon.</p></li>
<li>
Right-click the Data Report designer, and click <b>Retrieve Structure</b>.<p class=tl>
You have added a new group section to the designer. Each group section has a one-to-one correspondence to a Command object in the data environment; in this case, the new Group section corresponds to the Customers Command object. Notice also that the Group Header has a matching Group Footer section.</P><p class=atl>
<B><b>Note</b></B> &nbsp; The Data Environment allows you to create hierarchies of Command objects wherein a Command object has more than one child object — child Command objects parallel to each other. The Data Report designer, however, is not as flexible, and can't display more than one child object at a time. In such cases, when executing a Retrieve Structure command, the Data Report will display only the first of the child commands, and none below it. Thus you should avoid creating Command hierarchies with parallel children commands.</p></li>
<li>
From the Data Environment designer, drag the <b>CompanyName</b> field (under the <b>Customers</b> command) onto the <b>Group Header (Customers_Header)</b> section.<p class=tl>
The Group Header section can contain any field from the Customers command, however, for demonstration purposes, only the Customer name is displayed at this time.</P></li>
<li>
Delete the Label control (rptLabel) named <b>Label1</b>.<p class=tl>
If you do not want a Label control to be included with the TextBox control, you can uncheck the <b>Drag and Drop Fields Caption </b>option on the <b>Field Mapping </b>tab of the Data Environment designer's <b>Options </b>dialog box.</P></li>
<li>
From the Data Environment designer, drag the <b>OrderDate</b> field (under the <b>Orders</b> command) onto the <b>Details (Orders_Detail)</b> section. Delete the Label control.<p class=tl>
The Details section represents the innermost "repeating" section, and thus corresponds to the lowest Command object in the Data Environment hierarchy: the Orders Command object.</P></li>
<li>
Resize the Data Report<b> </b>designer's sections to resemble the figure below:<p>
<img src="vb4vo82.gif" border=0></P><p class=tl>
It's important to resize the height of the Details section to be as short as possible because the height will be multiplied for every OrderDate returned for the CompanyName. Any extra space below or above the OrderDate text box will result in unneeded space in the final report.</P></li>
<li>
Save the project.</li>
</ol>
<h2>Preview the Data Report Using the Show Method</h2>
<p>
Now that the data environment and the data report objects have been created, you are almost ready to run the project. One step remains: to write code to show the data report.</p>
<p class=label>
<b>To show the data report at run time</b>
<ol>
<li>
On the <b>Project Explorer</b> window, double-click the <b>frmShowReport</b> icon to display the Form designer.<br><br></li>
<li>
On <b>Toolbox</b>, click the <b>General </b>tab.<p class=tl>
When you add a Data Report designer to your project, its controls are added to the tab named <b>DataReport</b>. To use the standard Visual Basic controls, you must switch to the General tab.</P></li>
<li>
Click the <b>CommandButton</b> icon and draw a <b>CommandButton</b> on the form.<br><br></li>
<li>
Set the properties of the <b>Command1 </b>control according to the table below:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=43%><b>Property</b></td>
<td class=label width=57%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=43%>Name</td>
<td width=57%>cmdShow</td>
</tr>
<tr valign=top>
<td width=43%>Caption</td>
<td width=57%>Show Report</td>
</tr>
</table><br>
</li>
<li>
In the button's Click event, paste the code below.<pre><code>Private Sub cmdShow_Click()
rptNwind.Show
End Sub</code></pre>
</li>
<li>
Save and run the project.<br><br></li>
<li>
Click <b>Show Report </b>to display the report in print preview mode.</li>
</ol>
<h4>Optional—Setting the Data Report as the Startup Object</h4>
<p>
You can also display the data report with no code at all.
<ol>
<li>
On the <b>Project </b>menu, click <b>prjNwind Properties</b>.<br><br></li>
<li>
In the <b>Startup Object </b>box, select <b>rptNwind</b>.<br><br></li>
<li>
Save and run the project.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you use this method, you can remove the Form object from your project.</p></li>
</ol>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a sample data report.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>To</b></td>
<td class=label width=69%><b>See</b></td>
</tr>
<tr valign=top>
<td width=31%>Go to the next step</td>
<td width=69%><a href="vbconextendingdatareport.htm">Extending the Data Report</a></td>
</tr>
</table><br>
</BODY>
</HTML>
