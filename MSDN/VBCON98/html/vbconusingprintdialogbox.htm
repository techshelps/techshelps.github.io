<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Print Dialog Box</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconusingprintdialogbox"></a>Using the Print Dialog Box</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconUsingPrintDialogBoxC">
</object></p>
<p>
The Print dialog box allows the user to specify how output should be printed. The user can specify a range of pages to be printed, a print quality, a number of copies, and so on. This dialog box also displays information about the currently installed printer and allows the user to configure or reinstall a new default printer.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This dialog box does not actually send data to a printer. It allows users to specify how they want data printed. You must write code to print the data in the format they select.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See "Working with Text and Graphics" for information on printing data.</p>
<p>
At run time, when the user makes selections in the Print dialog box, the following properties contain information about the user's selection.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=41%><b>Property</b></td>
<td class=label width=59%><b>Determines</b></td>
</tr>
<tr valign=top>
<td width=41%>Copies</td>
<td width=59%>The number of copies to print.</td>
</tr>
<tr valign=top>
<td width=41%>FromPage</td>
<td width=59%>The page to start printing.</td>
</tr>
<tr valign=top>
<td width=41%>ToPage</td>
<td width=59%>The page to stop printing.</td>
</tr>
<tr valign=top>
<td width=41%>hDC</td>
<td width=59%>The device context for the selected printer.</td>
</tr>
<tr valign=top>
<td width=41%>Orientation</td>
<td width=59%>The page's orientation (portrait or landscape).</td>
</tr>
</table><br>
<p class=label>
<b>Figure 7.15&nbsp;&nbsp;&nbsp;The Print dialog box</b></p>
<p>
<img src="avp07030.gif" border=0></p>
<p class=label>
<b>To display the Print dialog box</b>
<ol>
<li>
Set any desired default settings for the dialog by setting the appropriate Print dialog properties.<p class=tl>
For example, to display 2 in the Copies box when the dialog is displayed, set the Copies property to 2:</P><pre><code>CommonDialog1.Copies = 2
</code></pre>
</li>
<li>
Use the ShowPrinter method to display the Print dialog box.</li>
</ol>
<p>
The following code displays the Print dialog box when the user clicks the Command1 command button:</p>
<pre><code>Private Sub Command1_Click ()
   Dim BeginPage, EndPage, NumCopies, Orientation, i
   ' Set Cancel to True.
   CommonDialog1.CancelError = True
   On Error GoTo ErrHandler
   ' Display the Print dialog box.
   CommonDialog1.ShowPrinter
   ' Get user-selected values from the dialog box.
   BeginPage   = CommonDialog1.FromPage
   EndPage       = CommonDialog1.ToPage 
   NumCopies   = CommonDialog1.Copies
   Orientation = CommonDialog1.Orientation
   For i = 1 to NumCopies   
   ' Put code here to send data to your printer.
   Next
   Exit Sub
ErrHandler:
   ' User pressed Cancel button.
   Exit Sub
End Sub
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If the PrinterDefault property is set to True, you can print to the Visual Basic Printer object. In addition, when the PrinterDefault property is True, any changes the user makes in the Setup portion of the Print dialog box are used to change the printer settings in the user's Printer setup.</p>
</BODY>
</HTML>
