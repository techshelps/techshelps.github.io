<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the MonthView Control</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconusingmonthviewcontrol"></a>Using the MonthView Control</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconUsingMonthViewControlC">
</object></p>
<p>
The MonthView control makes it easy for users to view and set date information via a calendar-like interface. Users can select a single date or a range of dates.</p>
<p>
The control can be navigated using either the keyboard or mouse. Buttons at the top of the control are used to scroll months in and out of view.</p>
<p>
In addition, the control has the ability to display up to 12 months at a time. This can be helpful when you want to give users the ability to view date information around the date of interest.</p>
<p class=label>
<b>MonthView control</b></p>
<p>
<img src="vb2yat1.gif" border=0></p>
<h2>Possible Uses</h2>
<ul type=disc>
<li>
To present date information where a calendar representation of a date is easier to understand than that of a Label or Textbox control.<br><br></li>
<li>
To give users the ability to choose a date with the click of a mouse rather than typing a date value.<br><br></li>
<li>
To enable users to view multiple months as part of an advanced booking system such as those used by hotels and airlines.</li>
</ul>
<h3>Setting and Returning Dates</h3>
<p>
The currently selected date in the control is determined by the Value property. You can set the Value of the control before it is displayed (for example, in the form's Load event) to determine which date will be initially selected in the control:</p>
<pre><code>MonthView1.Value = "10/31/97"
</code></pre>
<p>
By default, the control's Value is set to the current date, and the current date is selected when the control first appears. If you change the MonthView's Value through code, the control will be updated immediately to reflect the new setting.</p>
<p>
Certain events of the control can also be used to return date values. For example, the DateClick event is fired whenever the user clicks on a date in the control. The DateClick event returns a <i>DateClicked</i> value that evaluates to the date the user clicked. Similarly, the DateDblClick event returns a <i>DateDblClicked</i> value indicating the date that was double-clicked to cause the event. When using these events, you should refer to the value returned by the event, rather than the Value property of the control, as Value is not updated until after the event has occurred.</p>
<p>
The Value property returns a date value that you can format in whatever manner you wish. The MonthView control also has several properties that return specific date information. The Month property returns the integer value (1-12) of the month containing the currently selected date. The Day property returns the day number (1-31) currently selected, and the DayOfWeek property returns a value indicating the day of the week the selected date falls on (values correspond to the values of <i>vbDayOfWeek</i> constants.) The Year property returns the year containing the selected date as an integer value. Finally, there is a Week property that will return the number of the week containing the selected date.</p>
<p>
These properties can be set as well as read at run time, with varying effects on the currently selected date. For example, changing the value of the DayOfWeek property will select the date that falls on the specified day in the same week. This will change the value of the Day property, but depending on how the week falls, it may also change the value of the Month property. Changing the value of the Year property will cause the current date to be selected in the specified year, which may affect the value of DayOfWeek.</p>
<p>
You should be especially careful when changing the value of the Week property. Setting a different week as the current week will not change the value of DayOfWeek, but will affect the value of Day, and possibly the values of Week, Month or even Year. For example, if the user has selected a Friday, and you set the value of Week to 52 in a year that ends on a Wednesday, the value of Week will become 1, and the values of Month and Year will also change. Weeks 1 and 52 will usually overlap.</p>
<h3>Selecting A Range of Dates</h3>
<p>
You can use the MonthView control to display a contiguous range of dates, or to allow the user to select a date range. In order to extend the selection to more than one date, the MultiSelect property must be set to True. You can control the maximum number of days that may be selected by changing the value of the MaxSelCount property. By default, the maximum selection allowed is seven days.</p>
<p>
The SelStart and SelEnd properties determine which days are selected. You can check the values of these properties to find out what range the user has selected. If only one date is selected, the two values will be the same. You can also set the values of these properties in code, which will cause a range of dates to become selected in the control. When setting the SelStart and SelEnd properties through code, you must observe the following rules:
<ul type=disc>
<li>
The SelStart date must occur before the SelEnd date.<br><br></li>
<li>
The selected range must contain the currently selected date. If necessary, you should set the Value property to one of the dates in the range before setting the SelStart and SelEnd values.<br><br></li>
<li>
The number of dates included in the range cannot exceed the maximum range size as specified by MaxSelCount.</li>
</ul>
<p>
For example, to select the week before Halloween through code, you would use the following:</p>
<pre><code>MonthView1.Value = "10/31/97"
MonthView1.MaxSelCount = 7
MonthView1.SelStart = "10/25/97"
MonthView1.SelEnd = "10/31/97"
</code></pre>
<h3>Formatting the Control's Appearance</h3>
<p>
The MonthView control allows you to customize its appearance in many ways. Various color attributes such as MonthBackColor, TitleBackColor, TitleForeColor and TrailingForeColor enable you to create a unique color scheme or the control. For example, TrailingForeColor determines the color of the dates that precede and follow the displayed month or months.</p>
<p>
The font settings for the control determine the width and height of the control. Using larger fonts causes the control to grow to accommodate the increased font size. Conversely, you can set the font to a smaller size to shrink the control. Font size is set through the Font property.</p>
<h4>Displaying More Than One Month</h4>
<p>
The MonthView control can display from one to twelve months at a time. You specify how many months will be displayed and how they will be arranged within the control. You do this by using the MonthRows and MonthColumns properties. For example, setting MonthRows to 2 and MonthColumns to 3 would result in a MonthView control that displayed six months at a time. Clicking on the arrow buttons at the top of the control would scroll the next six months or the previous six months into view.</p>
<p>
Individual months are separated by a separator bar. The size of the separator is dependent on control size and display characteristics, but you can retrieve the dimensions used via the SeperatorHeight and SeparatorWidth properties. You can also retrieve the size of a single calendar by using the CalendarWidth and CalendarHeight properties. Together these properties are useful in determining how the control will change size if another row or column is added, and adjusting the size and position of your controls accordingly.</p>
<h4>Other Formatting Settings</h4>
<p>
You can determine which day of the week will appear as the first day by changing the value of the <b>StartOfWeek</b> property. You can choose to display week numbers in the control by setting the <b>ShowWeekNumbers</b> property to True. Week numbers appear in a separate column to the left of the first day of the week. The display of the current date at the bottom of the control can be enabled or disabled using the <b>ShowToday</b> property.</p>
<h3>Formatting Specific Days</h3>
<p>
Any day number on the MonthView control can also have its font set to bold. This capability can be used to draw attention to dates (i.e. holidays, vacations, etc.) or just distinguish them from ordinary dates. More than one date can be bolded at the same time. Although the bold information for a day is not preserved while scrolling from month to month, this behavior can be simulated using the <b>GetDayBold</b> event.</p>
<p>
The following example makes all Sundays bold, even when new months are scrolled into view:</p>
<pre><code>Private Sub MonthView1_GetDayBold(ByVal StartDate As Date, ByVal Count As Integer, State() As Boolean)
   Dim i As Integer
   i = vbSunday
   While i &lt; Count
      State(i - MonthView1.StartOfWeek) = True
      i = i + 7
   Wend
End Sub
</code></pre>
<h3>Keyboard Interface</h3>
<p>
The MonthView control can be manipulated using the keyboard. The following table describes the different actions you can perform with the control at runtime.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=37%><b>Key</b></td>
<td class=label width=63%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=37%>LEFT ARROW</td>
<td width=63%>Select the next day</td>
</tr>
<tr valign=top>
<td width=37%>RIGHT ARROW</td>
<td width=63%>Select the previous day</td>
</tr>
<tr valign=top>
<td width=37%>UP ARROW</td>
<td width=63%>Select the same day of week in the previous week</td>
</tr>
<tr valign=top>
<td width=37%>DOWN ARROW</td>
<td width=63%>Select the same day of week in the next week</td>
</tr>
<tr valign=top>
<td width=37%>PAGE UP</td>
<td width=63%>Scrolls the display to past months.</td>
</tr>
<tr valign=top>
<td width=37%>PAGE DOWN</td>
<td width=63%>Scrolls the display to future months.</td>
</tr>
<tr valign=top>
<td width=37%>CTRL+PAGE UP</td>
<td width=63%>Scrolls the display to the previous year.</td>
</tr>
<tr valign=top>
<td width=37%>CTRL+PAGE DOWN</td>
<td width=63%>Scrolls the display to the next year.</td>
</tr>
</table><br>
<h3>Navigating the MonthView</h3>
<p>
In addition to the two buttons at the top of the control, the MonthView control provides other ways to set the currently displayed month(s). You can display a particular month of any particular year.</p>
<p class=label>
<b>To select a particular month</b>
<ol>
<li>
Click on the month name at the top of the calendar. A context menu will appear with the names of all the months.<br><br></li>
<li>
From the menu, choose the name of the month you want to select.</li>
</ol>
<p>
The control will display the selected month in the current year.</p>
<p class=label>
<b>To go directly to a particular year</b>
<ol>
<li>
Select the month you want.<br><br></li>
<li>
Click on the year number at the top of the calendar. This will place it in edit mode.<br><br></li>
<li>
Either click the up/down scroll buttons to scroll the year or type the year in the edit box.<br><br></li>
<li>
Click anywhere outside the edit box or press the ENTER key when you are done.</li>
</ol>
<p>
The control will display the current month in the year you specified.</p>
<p class=indent>
<B><b>Distribution Note</b></B>&nbsp;&nbsp;&nbsp;The <b>UpDown</b> control is part of a group of ActiveX controls that are found in the COMCT232.ocx file. To use the <b>UpDown</b> control in your application, you must add the COMCT232.ocx file to the project. When distributing your application, install the COMCT232.ocx file in the user’s Microsoft Windows System or System32 directory. For more information on how to add an ActiveX control to a project, see the <i>Programmer’s Guide</i>.</p>
</BODY>
</HTML>
