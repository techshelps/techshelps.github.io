<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Extending the Data Report</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconextendingdatareport"></a>Extending the Data Report</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconExtendingDataReport_C">
</object></p>
<p>
Once you have a simple data report, it's easy to extend it and make a more complex presentation. In the procedure below, the data environment is first extended with the Order Details and Products tables. The extended report includes the names of products ordered on a specific date, and resembles the figure below.</p>
<p class=label>
<b>Extended Data Report With Order Details</b></p>
<p>
<img src="vb4vo91.gif" border=0></p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a sample data report. It begins with the topic, <a href="vbconcreatingsimpledatareport.htm">Creating a Simple Data Report</a>.</p>
<p class=label>
<b>To extend the data environment</b>
<ol>
<li>
On the Data Environment designer, right-click the <b>Orders</b> Command object. Then click <b>Add Child Command</b>.<br><br></li>
<li>
On the <b>Command1 Properties </b>dialog box, set the following properties:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Property</b></td>
<td class=label width=66%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=34%>Command Name </td>
<td width=66%>OrderDetails</td>
</tr>
<tr valign=top>
<td width=34%>Connection </td>
<td width=66%>Northwind</td>
</tr>
<tr valign=top>
<td width=34%>DataBase Object </td>
<td width=66%>Table</td>
</tr>
<tr valign=top>
<td width=34%>Object Name </td>
<td width=66%>Order Details</td>
</tr>
</table><br>
</li>
<li>
Click the <b>Relation </b>tab. The <b>Relate to a Parent Command Object </b>check box should be checked. The <b>Parent </b>box should contain <b>Orders</b>; both the <b>Parent Fields </b>and <b>Child Fields/Parameters </b>boxes should contain <b>OrderID</b>. Click the <b>Add </b>button and then click <b>OK </b>to close the dialog box.<br><br></li>
<li>
Right-click the <b>OrderDetails </b>Command object, and click <b>Add Child Command</b>. Set the properties of the connection as shown below:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Property</b></td>
<td class=label width=66%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=34%>Command Name </td>
<td width=66%>Products</td>
</tr>
<tr valign=top>
<td width=34%>Connection </td>
<td width=66%>Northwind</td>
</tr>
<tr valign=top>
<td width=34%>DataBase Object </td>
<td width=66%>Table</td>
</tr>
<tr valign=top>
<td width=34%>Object Name </td>
<td width=66%>Products</td>
</tr>
</table>
</li>
<li>
Click the <b>Relation </b>tab. The <b>Relate to a Parent Command Object </b>check box should be checked. The <b>Parent </b>box should contain <b>OrderDetails</b>; both the <b>Parent Fields </b>and <b>Child Fields/Parameters </b>boxes should contain <b>ProductID</b>. Click the <b>Add </b>button and then click <b>OK </b>to close the dialog box.</li>
</ol>
<h2>Extending the Data Report</h2>
<p>
Once the data environment has been extended with new tables, you can extend the data report as well by dragging fields from the Data Environment designer to the Data Report designer.</p>
<p class=label>
<b>To Extend the data report</b>
<ol>
<li>
Right-click the <b>Data Report </b>designer, and clear <b>Show Page Header/Footer</b> box.<p class=tl>
Clearing this option deletes the page header and footer, which are not being used at this point.</P></li>
<li>
Right-click the Data Report designer, and click <b>Insert Group Header/Footer</b>. The <b>Insert New Group Header/Footer</b> dialog box will be displayed.<p class=tl>
The dialog box allows you to determine if the new header and footer will "bracket" other header/footer pairs. This becomes important as you add more header and footer pairs because the outermost pair of header/footers subordinates all other pairs. This is discussed in greater detail in "Parts of the Data Report."</P></li>
<li>
Click <b>OK</b> to select the default placement of the new header and footer pair and close the dialog box.<br><br></li>
<li>
Select the new group header, and on the <b>Properties</b> window, change its name from Section1 to <b>Orders_Header</b>. Change the corresponding footer name from Section4 to <b>Orders_Footer</b>.<br><br></li>
<li>
Repeat steps 2 to 3. Name the new group header <b>OrderDetails_Header</b>, and the new group footer <b>OrderDetails_Footer</b>.<br><br></li>
<li>
Click the <b>Detail (Orders_Detail) </b>section to select it. On the <b>Properties </b>window, change the section's name to <b>Products_Detail</b>.<br><br></li>
<li>
Using the mouse, drag the <b>OrderDate </b>field from the <b>Detail (Products_Detail) </b>section to the <b>Orders_Header </b>section.<br><br></li>
<li>
From the Data Environment designer, drag the <b>ProductName</b> field (under the <b>Products</b> command) into the <b>Detail (Products_Detail) </b>section.<br><br></li>
<li>
Delete the <b>Label </b>control named Label1.<br><br></li>
<li>
Resize the group headers, and rearrange the text box controls to resemble the figure below.<p>
<img src="vb4vo92.gif" border=0></P><p class=tl>
The figure above requires some explanation. First, the Group footers are all closed in order to take up the least possible space. Like the Details section, any additional space left in any header or footer will be multiplied in the final report. Therefore, if a header or footer doesn't contain any fields, you can close the distance between the headers or footers.</P><p class=tl>
The Group Header named <b>OrderDetails_Header </b>is also closed. If you wonder why no fields are being shown, you must understand that the Order Details table in the Northwind database is a join table—the table contains only the IDs of records from the Orders table joined to IDs of records from the Products table. Thus the Order Details table doesn't contain fields which are actually displayed. Instead, it functions only to join two other tables. In the Data Report designer, the Order Details table therefore functions only to create groups of records—the product names grouped under the order dates.</P><p class=tl>
Finally, the <b>Details</b> section contains only the names of products. The Details section contains the innermost level of repeating records. </P></li>
<li>
Save and run the project.</li>
</ol>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a sample data report.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>To</b></td>
<td class=label width=69%><b>See</b></td>
</tr>
<tr valign=top>
<td width=31%>Go to the next step</td>
<td width=69%><a href="vbconaddingcalculatedfieldtodatareport.htm">Adding a Calculated Field to the Data Report</a></td>
</tr>
<tr valign=top>
<td width=31%>Start from the beginning</td>
<td width=69%><a href="vbconcreatingsimpledatareport.htm">Creating a Simple Data Report</a></td>
</tr>
</table><br>
</BODY>
</HTML>
