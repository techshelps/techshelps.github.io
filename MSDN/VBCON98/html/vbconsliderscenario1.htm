<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Slider Scenario 1: Resize a Graph Control Proportionally</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconsliderscenario1"></a>Slider Scenario 1: Resize a Graph Control Proportionally</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconSliderScenario1C">
</object></p>
<p>
One possible use of the Slider is to resize a PictureBox control on a form while keeping its proportions.</p>
<p>
The code below uses the following objects:
<ul type=disc>
<li>
Form named "frmPictureBox"<br><br></li>
<li>
Slider control named "sldResize"<br><br></li>
<li>
PictureBox control named "picPhoto"</li>
</ul>
<p class=label>
<b>To resize a PictureBox control with a Slider control</b>
<ol>
<li>
Create two global variables for the Height and Width properties.<br><br></li>
<li>
Use the Form’s Load event to set global variables and the Max property.<br><br></li>
<li>
Resize the height and width of the PictureBox through the Scroll event.</li>
</ol>
<h2>Create Two Global Variables for Height and Width</h2>
<p>
One simple formula for retaining proportions would be:</p>
<pre><code>picPhoto.Height = sldResize.Value * _
OriginalHeight / 100
picPhoto.Width = sldResize.Value * OriginalWidth / 100
</code></pre>
<p>
This formula depends on two constant values: the original height and width of the PictureBox control. These values should be set when the form is loaded, and should be available as global variables, as shown below:</p>
<pre><code>Option Explicit
Private gHeight As Long
Private gWidth As Long
</code></pre>
<h3>Use the Form Load Event to Set Global Values and the Max Property</h3>
<p>
To set the values for the global variables, use the Form object's Load event. It's also more efficient to calculate the values of <code>OriginalHeight/100</code> and <code>OriginalWidth/100</code> once, and store those values in global variables, as shown below:</p>
<pre><code>gHeight = picPhoto.Height / 100
gWidth = picPhoto.Width / 100
</code></pre>
<p>
The Load event can also be used to set the Max property of the Slider control. The Max property specifies the maximum value the Slider will accommodate. To keep the math simple, set the value of the Max property to 100:</p>
<pre><code>sldResize.Max = 100
</code></pre>
<p>
The complete code below, then, sets the global variables and the Max property in the Form object's Load event:</p>
<pre><code>Private Sub Form_Load()
   gHeight = picPhoto.Height/100
   gWidth = picPhoto.Width/100
   sldResize.Max = 100
End Sub
</code></pre>
<h3>Resize the Height and Width of the PictureBox through the Scroll Event</h3>
<p>
The Slider control has a Scroll event that occurs whenever the Slider's thumb is moved by the user. Use this event when you wish to continually process the Value property of the Slider control. In the present scenario, this means the size of the PictureBox will be dynamically changed as the thumb is moved. (If you don't want the user to be distracted by the dynamically changing control, you should use the Click event. The Click event updates the size of the control after the thumb has been released.) The code below shows the formula within the Scroll event:</p>
<pre><code>Private Sub sldResize_Scroll()
   picPhoto.Height = sldResize.Value * gHeight
   picPhoto.Width = sldResize.Value * gWidth
End Sub
</code></pre>
<h2>The Complete Code</h2>
<p>
The complete code is shown below:</p>
<pre><code>Private gHeight As Long
Private gWidth As Long

Private Sub Form_Load()
   gHeight = picPhoto.Height / 100
   gWidth = picPhoto.Width / 100
   sldResize.Max = 100
End Sub

Private Sub sldResize_Scroll()
   picPhoto.Height = sldResize.Value * gHeight
   picPhoto.Width = sldResize.Value * gWidth
End Sub
</code></pre>
</BODY>
</HTML>
