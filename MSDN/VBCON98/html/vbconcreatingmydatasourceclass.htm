<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the MyDataSource Class</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcreatingmydatasourceclass"></a>Creating the MyDataSource Class</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCreatingMyDataSourceClass_C">
</object></p>
<p>
In the previous topic, we created a class that implements an OLE DB Simple Provider. In this step we'll create another class that will provide data from the MyOSPObject class to other objects.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating sample data source components. It begins with the topic <a href="vbconbuildingdatasources.htm">Creating Data Sources</a>.</p>
<p class=label>
<b>To create the MyDataSource class</b>
<ol>
<li>
Select the <b>MyDataComponent</b> project in the <b>Project Explorer</b>.<br><br></li>
<li>
Select <b>Add Class Module</b> from the <b>Project</b> menu, then choose <b>Class Module</b> from the <b>Add Class Module</b> dialog box.<br><br></li>
<li>
Select the <b>Properties</b> window and set the following properties for the new class module:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=37%><b>Property</b></td>
<td class=label width=63%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=37%>(Name)</td>
<td width=63%>MyDataSource</td>
</tr>
<tr valign=top>
<td width=37%>DataSourceBehavior</td>
<td width=63%>2-vbOLEDBProvider</td>
</tr>
</table><br>
</li>
<li>
In the <b>Object </b>box, select <b>Class</b>. In the <b>Procedure </b>box, select the <b>GetDataMember</b> event. Add the following code to the Class_GetDataMember event procedure:<pre><code>Private Sub Class_GetDataMember(DataMember As String, Data As Object)
 &nbsp; ' Declare an instance of the MyOSPObject class
 &nbsp; Dim MyOSP As New MyOSPObject

 &nbsp; ' Make sure the DataMember is valid
 &nbsp; If DataMember = "" Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Err.Raise (E_FAIL)
 &nbsp; End If

 &nbsp; ' Set the FilePath property
 &nbsp; MyOSP.FilePath = DataMember

 &nbsp; ' Call the LoadData method to populate the class
 &nbsp; MyOSP.LoadData

 &nbsp; ' Set MyDataSource's data to MyOSPObject's data
 &nbsp; Set Data = MyOSP
End Sub
</code></pre>
</li>
<li>
Choose Save Project Group from the File menu to save your changes. When prompted for a file name for the Class module, choose the default (MyDataSource.cls).</li>
</ol>
<p>
As you may have noticed, this class is much simpler than the MyOSPObject class. In fact, if you go back and compare it with the GetDataMember event, you'll see that it's doing essentially the same thing. The main difference here is that we're using a class that we created rather than the pre-existing ADODB class.</p>
<p>
In the next step, we'll convert the form that we created earlier to use our new data source object, and we'll test it to see the results.</p>
<h3>Step by Step</h3>
<p>
This topic is part of a series that walks you through creating sample ActiveX data sources.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>To</b></td>
<td class=label width=50%><b>See</b></td>
</tr>
<tr valign=top>
<td width=50%>Go to the next step</td>
<td width=50%><a href="vbcontestingmydatacomponent.htm">Testing the MyData Component</a></td>
</tr>
<tr valign=top>
<td width=50%>Start from the beginning</td>
<td width=50%><a href="vbconbuildingdatasources.htm">Creating Data Sources</a></td>
</tr>
</table><br>
</BODY>
</HTML>
