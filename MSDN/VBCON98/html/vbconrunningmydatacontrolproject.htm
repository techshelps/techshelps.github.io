<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Running the MyDataControl Project</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconrunningmydatacontrolproject"></a>Running the MyDataControl Project</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconRunningMyDataControlProject_C">
</object></p>
<p>
In the previous topic, we added the code that allows the MyData control to provide data to other objects. In this step we'll connect the MyData control to an ADO source and bind to it using both simple and complex binding.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating sample data source components. It begins with the topic <a href="vbconbuildingdatasources.htm">Creating Data Sources</a>.</p>
<p class=label>
<b>To test the MyData control</b>
<ol>
<li>
If it's still open, close the MyData designer and open the designer for Form1.<br><br></li>
<li>
Select the <b>MyData</b> control and switch to the <b>Properties</b> window.<br><br></li>
<li>
Double-click the <b>ConnectionString</b> property and enter the DSN connection string for the Northwind database. It should look something like this: DSN = Northwind.<p class=atl>
<B><b>Important</b></B>&nbsp;&nbsp;&nbsp;If you haven't previously created a DSN for the Northwind database, you'll need to create one first.The procedure for creating a DSN is discussed in "Connection Objects" in "About the Data Environment Designer" in the <i>Data Access Guide</i>.</p></li>
<li>
Double-click the <b>RecordSource</b> property and enter Customers. This specifies the Customers table in the Northwind database; you could also enter a SQL statement here in order to filter the data.<br><br></li>
<li>
Select a <b>TextBox</b> control in the <b>Toolbox</b> and add it to Form1, then switch to the <b>Properties</b> window.<br><br></li>
<li>
Select the <b>DataSource</b> property and choose MyData1 from the drop-down list.<br><br></li>
<li>
Select the <b>DataField</b> property. The drop-down list should contain a list of the fields in the Customers table. Select the CompanyName field.<br><br></li>
<li>
Select <b>Start </b>from the <b>Run</b> menu to run the project.<p class=tl>
As you click the buttons on the MyData control, names from the CompanyName field should appear in the TextBox. Try editing a name in the TextBox, then move forward and back to the same record. You'll notice that your change has been saved to the database. The TextBox is simple-bound to the Northwind database by way of the MyData control.</P></li>
<li>
Stop the project (by selecting <b>End</b> from the <b>Run</b> menu), then select the form.<br><br></li>
<li>
Choose <b>Components</b> from the <b>Project</b> menu to open the <b>Components</b> dialog. Check the <b>Microsoft Data Grid 6.0</b> to add it to your project, then click <b>OK</b>.<br><br></li>
<li>
Select the <b>DataGrid</b> in the <b>Toolbox</b> and add it to Form1, then switch to the <b>Properties</b> window.<br><br></li>
<li>
Select the <b>DataSource</b> property and set it to MyData1.<br><br></li>
<li>
Select <b>Start </b>from the <b>Run</b> menu to run the project.<p class=tl>
The grid should contain all of the data from the Customers table. As you click the buttons on the MyData control, the selected row in the grid changes to match the data in the TextBox, scrolling as necessary. As with the TextBox, you can edit data in the grid and the changes are saved in the database. The DataGrid is complex-bound to the Northwind database by way of the MyData control.</P></li>
<li>
Stop the project (by selecting <b>End </b>from the <b>Run</b> menu), then select the MyData control on Form1.<br><br></li>
<li>
In the <b>Properties </b>window, double-click the ConnectionString property and enter an OLE DB connection string, such as Provider=Microsoft.Jet.OLE DB.3.51;Data Source=c:\northwind.mdb.<p class=atl>
<B><b>Important</b></B>&nbsp;&nbsp;&nbsp;If you haven't previously created a OLE DB connection for the Northwind database, you'll need to create one first.The procedure for creating a DSN is discussed in "Creating the Northwind OLEDB Data Source" in "Using Visual Basic's Standard Controls" in the <i>Programmer's Guide</i>.</p></li>
<li>
Select <b>Start</b> from the <b>Run</b> menu to run the project.<p class=tl>
You'll see that the data looks and acts exactly like it did before. The data is now being accessed through an OLE DB interface rather than a ODBC interface, and all you had to do was change the connection string!</P></li>
</ol>
<p>
As long as you have the project open, take some time to play around with other property settings such as BOFAction and EOFAction to see their behavior.</p>
<p>
In the next few steps, we'll build a ActiveX DLL and connect our form to an OLE DB Simple Provider.</p>
<h3>Step by Step</h3>
<p>
This topic is part of a series that walks you through creating sample ActiveX data sources.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>To</b></td>
<td class=label width=50%><b>See</b></td>
</tr>
<tr valign=top>
<td width=50%>Go to the next step</td>
<td width=50%><a href="vbconcreatingmydatacomponentproject.htm">Creating the MyData Component Project</a></td>
</tr>
<tr valign=top>
<td width=50%>Start from the beginning</td>
<td width=50%><a href="vbconbuildingdatasources.htm">Creating Data Sources</a></td>
</tr>
</table><br>
</BODY>
</HTML>
