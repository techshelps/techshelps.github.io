<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Simple DataCombo Application</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcreatingsimpledatacomboapplication"></a>Creating a Simple DataCombo Application</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCreatingSimpleDataComboApplicationC">
</object></p>
<p>
The following example uses the DataCombo box control to create a data entry screen for the Titles table of the Northwind.mdb sample database. It lets the user enter new products and assign them to existing suppliers by providing a lookup table of all the suppliers' names. When users get to the Supplier field in the entry form, they can choose a supplier from a list box. When they select a supplier, that supplier's SupplierID field is copied into the SupplierID field of the Products table.</p>
<p class=label>
<b>To create a lookup table with the DataCombo control</b>
<ol>
<li>
Create an OLEDB Data Source for the Northwind database.<p class=tl>
If a Data Source has not been created, follow the steps in "Creating the Northwind OLEDB Data Source."</P></li>
<li>
Create a new Standard EXE project in Visual Basic.<p class=tl>
If the <b>DataGrid</b>, <b>DataCombo</b>, or <b>ADO Data Control</b> is not present in the Toolbox, right-click the <b>Toolbox</b>, and use the <b>Components </b>dialog box to add it.</P></li>
<li>
Add a DataCombo, two ADO Data controls, and a DataGrid control to your form.<br><br></li>
<li>
In the Properties window, set the properties of the first data control (Adodc1) as shown in the table below.<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Property</b></td>
<td class=label width=50%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=50%>Name</td>
<td width=50%>adoDataSource</td>
</tr>
<tr valign=top>
<td width=50%>ConnectionString</td>
<td width=50%>Northwind.udl</td>
</tr>
<tr valign=top>
<td width=50%>RecordSource</td>
<td width=50%>Select * From Products;</td>
</tr>
<tr valign=top>
<td width=50%>Caption</td>
<td width=50%>Products</td>
</tr>
</table><br>
</li>
<li>
In the Properties window, set the properties of the second data control (Adodc2) as shown in the table below.<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Property</b></td>
<td class=label width=50%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=50%>Name</td>
<td width=50%>adoRowSource</td>
</tr>
<tr valign=top>
<td width=50%>ConnectionString</td>
<td width=50%>Northwind.udl</td>
</tr>
<tr valign=top>
<td width=50%>RecordSource</td>
<td width=50%>Select CompanyName, SupplierID From Suppliers;</td>
</tr>
<tr valign=top>
<td width=50%>Caption</td>
<td width=50%>Suppliers</td>
</tr>
<tr valign=top>
<td width=50%>Visible</td>
<td width=50%>False</td>
</tr>
</table><br>
</li>
<li>
In the Properties window, set the properties of the DataGrid control as shown in the table below.<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Property</b></td>
<td class=label width=50%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=50%>Name</td>
<td width=50%>grdProducts</td>
</tr>
<tr valign=top>
<td width=50%>DataSource</td>
<td width=50%>AdoDataSource</td>
</tr>
<tr valign=top>
<td width=50%>Caption</td>
<td width=50%>Products</td>
</tr>
</table><br>
</li>
<li>
In the Properties window, set the properties of the DataCombo control as shown in the table below.<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Property</b></td>
<td class=label width=50%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=50%>Name</td>
<td width=50%>dcbSuppliers</td>
</tr>
<tr valign=top>
<td width=50%>DataSource</td>
<td width=50%>adoDataSource</td>
</tr>
<tr valign=top>
<td width=50%>DataField</td>
<td width=50%>SupplierID</td>
</tr>
<tr valign=top>
<td width=50%>RowSource</td>
<td width=50%>adoRowSource</td>
</tr>
<tr valign=top>
<td width=50%>ListField</td>
<td width=50%>CompanyName</td>
</tr>
<tr valign=top>
<td width=50%>BoundColumn</td>
<td width=50%>SupplierID</td>
</tr>
</table><br>
</li>
<li>
Finally, add the following code to the form's code module:<pre><code>Private Sub Form_Load()
 &nbsp; ' Hide the SupplierID field in the DataGrid control, so the user is
 &nbsp; ' not confused on which value to change.
grdProducts.Columns("SupplierID").Visible = False
End Sub
</code></pre>
</li>
<li>
Run the project.</li>
</ol>
<p>
You can navigate through the recordset by clicking the arrows on the visible ADO Data control. As you do so, the DataCombo control will update and display the name of the supplier for each product. To edit the SupplierID field, click the DataCombo control's arrow to display a drop-down list, then click again on a different supplier to change the value written to the SupplierID field.</p>
</BODY>
</HTML>
