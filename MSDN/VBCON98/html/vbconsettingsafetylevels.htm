<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Safety Levels for ActiveX Components</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconsettingsafetylevels"></a>Setting Safety Levels for ActiveX Components</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconSettingSafetyLevels_C">
</object></p>
<p>
There are two ways you can set safety levels for your downloadable components. The easiest way is to use the Package and Deployment Wizard to mark your .cab files as safe. The other option is to use the IObjectSafety interface to tell the client machine that your code is safe.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;IObjectSafety is an advanced coding topic that requires an understanding of the Implements interface and is intended for experienced programmers. For information on the Implements interface, see "Polymorphism" in Programming with Objects," in the <i>Programmer's Guide</i>.</p>
<h2>Using the Package and Deployment Wizard</h2>
<p>
If you do not implement the IObjectSafety interface on your objects, the Package and Deployment Wizard will present you with the opportunity to set safety flags on your download package. You can select the Safe for Scripting flag, the Safe for Initialization flag, or both.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you have used the IObjectSafety interface for an object, it will not appear in the safety settings screen of the Package and Deployment Wizard.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See "Distributing your Applications," in the <i>Programmer's Guide</i> for more information on using the Package and Deployment Wizard to package your controls.</p>
<h2>Using IObjectSafety</h2>
<p>
IObjectSafety is an interface that exposes functionality to Internet Explorer's Safe for Scripting and Safe for Initialization security features. IObjectSafety should be implemented for objects that have interfaces that support untrusted clients — or those clients for which specific functionality cannot be predicted or safe usage cannot be guaranteed — such as scripts. The interface allows you to specify which parts of the object need to be protected from use.</p>
<p>
Using IObjectSafety, you can mark your object and its parts in three ways:
<ul type=disc>
<li>
Safe for Automation with untrusted Automation clients or scripts<br><br></li>
<li>
Safe for initialization with untrusted data<br><br></li>
<li>
Safe for running untrusted scripts</li>
</ul>
<p>
There are three possible scenarios to consider for your objects:
<ol>
<li>
All properties and methods on your object are always safe for scripting. In this scenario, you can notify the client that your object is safe for scripting by not returning an error in the IObjectSafety_SetInterfaceSafetyOptions interface method. This allows your object to be successfully created and run.<br><br></li>
<li>
Your object is never safe for scripting. In this case, you can notify the client that your object is not safe by returning an error, E_Fail, in the IObjectSafety_SetInterfaceSafetyOptions interface method. This prevents the client from accessing any methods or properties through script.<br><br></li>
<li>
Some but not all of the properties and methods on your object are unsafe for scripting. In this case you can either notify the client that your entire object is unsafe, or notify the client that your object is safe, but disable the properties and methods that are unsafe.</li>
</ol>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See the Internet Client SDK at http://www.microsoft.com/msdn/sdk/inetsdk/help/compdev/safety.htm for more information on the IObjectSafety interface. An IObjectSafety sample application can be found in the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbsamples">
</object><a href=JavaScript:alink_2.Click()>Samples</a> directory.</p>
</BODY>
</HTML>
