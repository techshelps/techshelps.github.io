<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Font, Display and Print Considerations in a DBCS Environment</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconfontdisplayprintconsiderationsindbcsenvironment"></a>Font, Display, and Print Considerations in a DBCS Environment</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconFontDisplayPrintConsiderationsInDBCSEnvironmentC">
</object></p>
<p>
When you use a font designed only for SBCS characters, DBCS characters may not be displayed correctly in the DBCS version of Windows. You need to change the Font object's Name property when developing a DBCS-enabled application with the English version of Visual Basic or any other SBCS-language version. The Name property determines the font used to display text in a control, in a run-time drawing, or during a print operation. The default setting for this property is MS Sans Serif in the English version of Visual Basic. To display text correctly in a DBCS environment, you have to change the setting to an appropriate font for the DBCS environment where your application will run. You may also need to change the font size by changing the Size property of the Font object. Usually, the text in your application will be displayed best in a 9-point font on most East Asian platforms, whereas an 8-point font is typical on European platforms.</p>
<p>
These considerations apply to printing DBCS characters with your application as well.</p>
<h3>How to Avoid Changing Font Settings</h3>
<p>
If you do not have any DBCS-enabled font or do not know which font is appropriate for the target platform, there are several options for you to work around the font issues.</p>
<p>
In the Traditional Chinese, Simplified Chinese, and Korean versions of Windows, there is a system capability called <i>Font Association</i>. With Korean Windows, for example, Font Association automatically maps any English fonts in your application to a Korean font. Therefore, you can still see Korean characters displayed, even if your application uses English fonts. The associated font is determined by the setting in \HKEY_LOCAL_MACHINE\System\CurrentControlSet\control\fontassoc<br>
\Associated DefaultFonts in the system registry of the run-time platform. With Font Association supported by the system, you can run your English application on a Chinese or Korean platform without changing any font settings. Font Association is not available on other platforms, such as Japanese Windows.</p>
<p>
Another option is to use the System or FixedSys font. These fonts are available on every platform. Note that the System and FixedSys fonts have few variations in size. If the font size you set at design time (with the Size property of the Font object) for either of these fonts does not match the size of the font on the user's machine, the setting may be ignored and the displayed text truncated.</p>
<h3>How to Change the Font at Run Time</h3>
<p>
Even though you have the options above, these solutions have restrictions. Here is an example of a global solution to changing the font in your application at run time. The following code, which works in any language version of Windows, applies the proper font to the Font object specified in the argument.</p>
<pre><code>Private Const DEFAULT_CHARSET = 1
Private Const SYMBOL_CHARSET = 2
Private Const SHIFTJIS_CHARSET = 128
Private Const HANGEUL_CHARSET = 129
Private Const CHINESEBIG5_CHARSET = 136
Private Const CHINESESIMPLIFIED_CHARSET = 134
Private Declare Function GetUserDefaultLCID Lib "kernel32" () As Long

Public Sub SetProperFont(obj As Object)
 &nbsp;&nbsp; On Error GoTo ErrorSetProperFont
 &nbsp;&nbsp; Select Case GetUserDefaultLCID
 &nbsp;&nbsp; Case &amp;H404 ' Traditional Chinese
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Charset = CHINESEBIG5_CHARSET
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Name = ChrW(&amp;H65B0) + ChrW(&amp;H7D30) + ChrW(&amp;H660E) _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + ChrW(&amp;H9AD4)&nbsp;&nbsp; 'New Ming-Li
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Size = 9
 &nbsp;&nbsp; Case &amp;H411 ' Japan
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Charset = SHIFTJIS_CHARSET
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Name = ChrW(&amp;HFF2D) + ChrW(&amp;HFF33) + ChrW(&amp;H20) + _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ChrW(&amp;HFF30) + ChrW(&amp;H30B4) + ChrW(&amp;H30B7) + ChrW(&amp;H30C3) + _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ChrW(&amp;H30AF)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Size = 9
 &nbsp;&nbsp; Case &amp;H412 'Korea UserLCID
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Charset = HANGEUL_CHARSET
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Name = ChrW(&amp;HAD74) + ChrW(&amp;HB9BC)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Size = 9
 &nbsp;&nbsp; Case &amp;H804 ' Simplified Chinese
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Charset = CHINESESIMPLIFIED_CHARSET
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Name = ChrW(&amp;H5B8B) + ChrW(&amp;H4F53)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Size = 9
 &nbsp;&nbsp; Case Else&nbsp;&nbsp; ' The other countries
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Charset = DEFAULT_CHARSET
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Name = ""&nbsp;&nbsp; ' Get the default UI font.
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Size = 8
 &nbsp;&nbsp; End Select
 &nbsp;&nbsp; Exit Sub
ErrorSetProperFont:
 &nbsp;&nbsp; Err.Number = Err
End Sub
</code></pre>
<p>
You can modify this sample code to make the font apply to other font settings, such as printing options.</p>
</BODY>
</HTML>
