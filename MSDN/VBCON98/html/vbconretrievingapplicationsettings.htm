<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving Application Settings</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconretrievingapplicationsettings"></a>Retrieving Application Settings</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconRetrievingApplicationSettingsC">
</object></p>
<p>
You can use the GetSetting and GetAllSettings functions to retrieve registry values stored in your application's registry location. For example, your application can retrieve registry settings to recreate its condition at the time it was closed.</p>
<h2>One Setting at a Time</h2>
<p>
To retrieve a single registry setting, use the following syntax for the GetSetting function:</p>
<p>
<b>GetSetting</b>(<i>appname</i>, <i>section</i>, <i>key[, default]</i>)</p>
<p>
The following code retrieves the value of the LastEntry key in the "RegCust" application's Startup section, and displays the value in the Immediate window.</p>
<pre><code>Private Sub Form_Load()
   Dim intLastEntry As Integer
   intLastEntry = GetSetting("RegCust", "Startup", _
   "LastEntry", "0")
   Debug.Print intLastEntry
End Sub
</code></pre>
<p>
Note that you can use the optional parameter, <i>default</i>, to set the value returned by Visual Basic when there is no value listed in the registry for the specified key.</p>
<h2>Multiple Settings</h2>
<p>
To retrieve a list of registry keys and their values, use the following syntax for the GetAllSettings function:</p>
<p>
<b>GetAllSettings</b>(<i>appname</i>, <i>section</i>)</p>
<p>
The following code retrieves a two-column list of registry keys and their values in the "RegCust" application's Startup section, and displays the results in the Immediate window.</p>
<pre><code>Private Sub Form_Load()
   Dim avntSettings As Variant
   Dim intX As Integer
   avntSettings = GetAllSettings("RegCust", "Startup")
   For intX = 0 To UBound(avntSettings, 1)
      Debug.Print avntSettings(intX, 0), _ 
      avntSettings(intX, 1)
   Next intX
End Sub
</code></pre>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See "GetSetting Function" and "GetAllSettings Function."</p>
</BODY>
</HTML>
