<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Dependency Files</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcreatingdependencyfiles"></a>Dependency Files</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCreatingDependencyFiles_C">
</object></p>
<p>
A dependency (.dep) file contains information about the run-time requirements of an application or component — for example, which files are needed, how they are to be registered, and where on the user's machine they should be installed. You can create .dep files for standard projects in all versions of Visual Basic. If you have the Professional or Enterprise edition of Visual Basic, you can create .dep files for ActiveX controls, ActiveX documents, and other ActiveX components.</p>
<p>
The Package and Deployment Wizard uses .dep files when it packages your applications. It scans all available dependency information for the application to build a comprehensive list of information about the run-time files the application needs, then builds installation information from that list. For a standard package, the information from the .dep files is written to a Setup.lst file that is stored outside the packaged .cab file. For an Internet package, the .dep file information is written to an .inf file that is stored within the packaged .cab file.</p>
<p>
When you package a component, you have the option of creating a .dep file to accompany it when it is deployed. You would do this if you have created a component you want to distribute with dependency information. It is recommended that you package and deploy your component before you package and deploy your dependency file, so that the packaging portion of the wizard knows the source location of the component that the dependency file references.</p>
<h2>Types of Dependency Files</h2>
<p>
In Visual Basic, dependency information is stored in files generated by the Package and Deployment Wizard or created manually by you. There are two types of files that can contain dependency information:
<ul type=disc>
<li>
Component .dep files — a .dep file lists files needed by a particular control or component. The Package and Deployment Wizard uses this file when it creates the setup program. In addition, the wizard can create this type of .dep file for you.<br><br></li>
<li>
The VB6dep.ini file — a list of dependency files for the entire Visual Basic development environment.</li>
</ul>
<p>
When you run the Package and Deployment Wizard, it looks for dependency information in .dep files and in vb6dep.ini. If dependency information cannot be found for a component in either location, the wizard notifies you of the missing dependency information. You can ignore this omission or correct the problem by creating the appropriate dependency files.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you ignore the omission, your program may not function properly after installation. If, however, you are certain that a dependent file will already be loaded on the user's machine, you may ignore the warning and proceed.</p>
<h3>Component Dependency Files</h3>
<p>
A <i>.</i>dep file lists all the files required by a particular component. When you purchase or use a component from a vendor, you receive a .dep file from them. For example, all of the ActiveX controls shipped with Visual Basic have a companion .dep file. These .dep files list all of the dependent files used by the control, plus version and registry information.</p>
<p>
You should generate a .dep file for any component that you create in Visual Basic if that component may be used in another project. The information from the .dep file for each component in a project is combined to form the project's dependency information. If you do not create a .dep file for your component, the dependency information for any projects in which it is used may be incorrect.</p>
<h3>The VB6dep.ini File</h3>
<p>
The VB6dep.ini file provides the Package and Deployment Wizard with an all-purpose list of dependencies and references used by Visual Basic. This list is created when you install Visual Basic and resides in the \Wizards\PDWizard subdirectory of the main Visual Basic directory.</p>
<h2>Missing Dependency Information</h2>
<p>
The Package and Deployment Wizard will inform you if dependency information is missing for a component in your project. There are three ways you can add the necessary dependency information:
<ul type=disc>
<li>
Edit the vb6dep.ini file to manually add an entry for a particular component.<br><br></li>
<li>
Create a .dep file for the component with the Package and Deployment Wizard.<br><br></li>
<li>
Contact the component's vendor and request a .dep file.</li>
</ul>
</BODY>
</HTML>
