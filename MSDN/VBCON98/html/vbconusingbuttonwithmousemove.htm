<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Button with MouseMove</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconusingbuttonwithmousemove"></a>Using Button with MouseMove</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconUsingButtonWithMouseMoveC">
</object></p>
<p>
For the MouseMove event, <i>button</i> indicates the complete state of the mouse buttons — not just which button caused the event, as with MouseDown and MouseUp. This additional information is provided because all, some, or none of the bits might be set. This compares with just one bit per event in the MouseDown and MouseUp procedures.</p>
<h2>Testing for a Single Button</h2>
<p>
If you test MouseMove for equality to 001 (decimal 1), you're testing to see if <i>only</i> the left mouse button is being held down while the mouse is moved. If another button is held down with the left button, the following code doesn't print anything:</p>
<pre><code>Private Sub Form_MouseMove (Button As Integer, _
      Shift As Integer, X As Single, Y As Single)
   If Button = 1 Then Print "You're pressing _
      only the left button."
End Sub
</code></pre>
<p>
To test for whether a particular button is down, use the And operator. The following code prints the message for each button pressed, regardless of whether another button is pressed:</p>
<pre><code>Private Sub Form_MouseMove (Button As Integer, _
      Shift As Integer, X As Single, Y As Single)
   If Button And 1 Then Print "You're pressing _
      the left button."
   If Button And 2 Then Print "You're pressing _
      the right button."
End Sub
</code></pre>
<p>
Pressing both buttons simultaneously prints both messages to the form. The MouseMove event recognizes multiple button states.</p>
<h2>Testing for Multiple Buttons</h2>
<p>
In most cases, to isolate which button or buttons are being pressed, you use the MouseMove event.</p>
<p>
Building on the previous examples, you can use the If…Then…Else statement to determine whether the left, right, or both buttons are being pressed. The following example tests for the three button states (left button pressed, right button pressed, and both buttons pressed) and prints the corresponding message.</p>
<p>
Add the following code to the form's MouseMove event:</p>
<pre><code>Private Sub Form_MouseMove(Button As Integer, _
      Shift As Integer, X As Single, Y As Single)
   If Button = 1 Then
      Print "You're pressing the left button."
   ElseIf Button = 2 Then
      Print "You're pressing the right button."
   ElseIf Button = 3 Then
      Print "You're pressing both buttons."
   End If
End Sub
</code></pre>
<p>
You could also use the And operator with the Select Case statement to determine <i>button</i> and <i>shift</i> states. The And operator combined with the Select Case statement isolates the possible button states of a three-button mouse and then prints the corresponding message.</p>
<p>
Create a variable called <code>ButtonTest</code> in the Declarations section of the form:</p>
<pre><code>Dim ButtonTest as Integer
</code></pre>
<p>
Add the following code to the form's MouseMove event:</p>
<pre><code>Private Sub Form_MouseMove(Button As Integer, _
      Shift As Integer, X As Single, Y As Single)
ButtonTest = Button And 7
   Select Case ButtonTest
      Case 1 ' or vbLeftButton
         Print "You're pressing the left button."
      Case 2 ' or vbRightButton
         Print "You're pressing the right button."
      Case 4 ' or vbMiddleButton
         Print "You're pressing the middle button."
      Case 7
         Print "You're pressing all three buttons."
   End Select
End Sub
</code></pre>
</BODY>
</HTML>
