<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Stored Procedures in the SQL Editor</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconstoredprocsqleditor"></a>Stored Procedures in the SQL Editor</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconStoredProcSQLEditor_C">
</object></p>
<p>
Stored procedures enable you to manage your server-based database and display information about that database and its users. For example, you can use a stored procedure to display the title (from the <code>titles</code> table) and publisher (from the <code>publishers</code> table) for each author in the <code>authors</code> table.</p>
<p>
Stored procedures can contain program flow, logic, and queries against the database. They can accept parameters, generate parameters, return single or multiple result sets, and return values.</p>
<p>
You can use stored procedures for any purpose for which you would use SQL statements, with these advantages:
<ul type=disc>
<li>
You can execute a series of SQL statements in a single stored procedure.<br><br></li>
<li>
You can reference other stored procedures from within your stored procedure, which can simplify a series of complex statements.<br><br></li>
<li>
The stored procedure is compiled on the server when it is created, so it executes faster than individual SQL statements.<br><br></li>
<li>
The compiled stored procedure can be cached in memory as well, for faster execution.</li>
</ul>
<h3>Creating New Stored Procedures</h3>
<p>
The SQL editor can be opened from the Data View window. The Data View window can be opened from the View menu or the Standard toolbar.</p>
<p class=label>
<b>To create a new stored procedure</b>
<ol>
<li>
In Data View, right-click the <b>Stored Procedures</b> folder or any stored procedure in that folder.<br><br></li>
<li>
Choose <b>New Stored Procedure</b> from the shortcut menu.<p class=tl>
A new stored procedure is created using a template containing SQL statements.</P></li>
<li>
Replace <code>StoredProcedure</code> in the first line with the name of the procedure. For example, you might use "MyProcedure" as the name:<pre><code>Create Procedure MyProcedure
</code></pre>
<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Stored procedures must have unique names. If you choose a name that is already assigned to another stored procedure in your project, an error message is displayed.</p></li>
<li>
Write the remaining procedure text in SQL.</li>
</ol>
<p>
For more information and examples of stored procedures, see the documentation for your server. If you are using Microsoft<sup>®</sup> SQL Server™, see <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_create_procedure_statement">
</object><a href=JavaScript:alink_2.Click()>CREATE PROCEDURE statement</a> in the SQL Server documentation. The Visual Basic SQL Editor also works with Oracle Stored Procedures, Functions, and Packages.</p>
<h3>Running Stored Procedures</h3>
<p>
You can run a stored procedure against your database to execute the SQL statements it contains and display the results in the Immediate window.</p>
<p class=label>
<b>To run a stored procedure</b>
<ol>
<li>
In Data View, expand the <b>Stored Procedures</b> folder.<br><br></li>
<li>
Right-click the name of the stored procedure that you want to run. Choose <b>Run</b> from the shortcut menu.<br><br></li>
<li>
If any parameters are required, a dialog appears to enter the parameter values.</li>
</ol>
<h3>Copying Stored Procedures</h3>
<p>
You can copy a stored procedure as the first step in creating a new stored procedure for your database. Because stored procedures must have names that are unique, the new stored procedure is automatically assigned a new unique name based on the original name.</p>
<p class=label>
<b>To copy a stored procedure</b>
<ol>
<li>
In Data View, expand the <b>Stored Procedures</b> folder.<br><br></li>
<li>
Right-click the name of the stored procedure that you want to copy. Choose <b>Design</b> from the shortcut menu.<p class=tl>
The SQL Editor opens with the stored procedure.</P></li>
<li>
Select all the text in the SQL Editor.<br><br></li>
<li>
Right-click the SQL Editor. Choose <b>Copy</b> from the shortcut menu.<br><br></li>
<li>
Right-click the SQL Editor. Choose <b>New Stored Procedure Wizard</b> from the shortcut menu.<br><br></li>
<li>
Clear the template text.<br><br></li>
<li>
Right-click the SQL Editor. Choose <b>Paste</b> from the shortcut menu to create your new stored procedure.<br><br></li>
<li>
Change the name of the stored procedure.<br><br></li>
<li>
Save the stored procedure to the database.</li>
</ol>
<p>
You can edit the SQL statements in the new stored procedure.</p>
<h3>Setting Execution Permissions on Stored Procedures</h3>
<p>
You can set execute permissions for a stored procedure that you own to allow access to the stored procedure by specific users or groups. In many databases, such as Microsoft<sup>®</sup> SQL Server™ and Oracle Database Server, if you are not the database owner, then you must explicitly grant permissions for your stored procedure to other users. Use SQL Server’s ISQL utility, Enterprise Manager, or an Oracle Tool to run the change commands or visually set the permissions.</p>
</BODY>
</HTML>
