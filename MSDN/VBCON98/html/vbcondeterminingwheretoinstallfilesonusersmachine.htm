<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Where to Install Files on the User's Machine</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbcondeterminingwheretoinstallfilesonusersmachine"></a>Where to Install Files on the User's Machine</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconDeterminingWhereToInstallFilesOnUsersMachine_C">
</object></p>
<p>
Before writing your setup program, you must determine where to install all of the necessary files on the user's machine. You record this information in your Setup.lst file. See "Manually Editing a Setup.lst File" in this chapter for more information on how to record this information in the file.</p>
<p>
The files required by your application can be divided into several categories.
<ul type=disc>
<li>
Program-specific files — files your application requires to run and that are not used by other applications.<br><br></li>
<li>
Shared files — files used by your application but also accessed by other applications on the user's machine.<br><br></li>
<li>
Remote Automation server components - files necessary for Remote Automation or DCOM functionality.</li>
</ul>
<p>
Each type of file is best installed in a different location.</p>
<h2>Program Files</h2>
<p>
Program files are files your application must have in order to run and that are useful only in the context of your application — for example, the application's .exe file and its required data files.</p>
<p>
Program files should be installed in the application directory that the user specifies during installation. Code in Setup1.vbp demonstrates how to write files to this location. By default, the Setup Toolkit uses the \Program Files directory as the root location to install applications onto Windows 95 or later and Windows NT systems. For example, Setup1 suggests that Project1 be installed in the \Program Files\Project1 directory.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;When installing a file on the user's machine, you should not copy an older version of the file over a new version. The CopyFile function in Setup1.bas uses the VerInstallFile API function to copy files to the user's machine. VerInstallFile will <i>not</i> overwrite an existing file with an older version.</p>
<h2>Shared Application Files</h2>
<p>
Shared application files are files that can be used by more than one application on the system. For example, several different vendors may ship applications that use the same ActiveX control. If you create an application that uses the control, you should indicate in your installation program that the control's .ocx file is designed to be shared.</p>
<p>
Shared files must be installed in a location that allows other applications to access the them. In most cases, this is \Program Files\Common Files for Windows 95 and Windows NT 4.0 or later.</p>
<p>
When an end user uninstalls your application, the system only removes a shared file if there are no other applications that could use the file.</p>
<h2>Remote Automation Components</h2>
<p>
Install Remote Automation server components to the \Windows\System or \Winnt\System32 directory. This ensures that your applications use the most current Remote Automation server components.</p>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;You can use the $(WinSysPath) installation macro to ensure that these files are installed in the correct directory.</p>
</BODY>
</HTML>
