<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying Pop-up Menus</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbcondisplayingpopupmenus"></a>Displaying Pop-up Menus</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconDisplayingPopupMenusC">
</object></p>
<p>
A <i>pop-up menu </i>is a floating menu that is displayed over a form, independent of the menu bar. The items displayed on the pop-up menu depend on where the pointer was located when the right mouse button was pressed; therefore, pop-up menus are also called <i>context menus</i>. In Microsoft Windows 95, you activate context menus by clicking the right mouse button.</p>
<p>
Any menu that has at least one menu item can be displayed at run time as a pop-up menu. To display a pop-up menu, use the PopupMenu method. This method uses the following syntax:</p>
<p>
[<i>object</i>.]<b>PopupMenu</b> <i>menuname</i> [<i>, flags</i> [<i>,x</i> [, <i>y</i> [, <i>boldcommand</i> ]]]]</p>
<p>
For example, the following code displays a menu named mnuFile when the user clicks a form with the right mouse button. You can use the MouseUp or MouseDown event to detect when the user clicks the right mouse button, although the standard is to use the MouseUp event:</p>
<pre><code>Private Sub Form_MouseUp (Button As Integer, Shift As _
   Integer, X As Single, Y As Single)
   If Button = 2 Then   ' Check if right mouse button 
                        ' was clicked.
      PopupMenu mnuFile   ' Display the File menu as a 
                        ' pop-up menu.
   End If
End Sub
</code></pre>
<p>
Any code following a call to the PopupMenu method is not run until the user selects an item in the menu or cancels the menu.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Only one pop-up menu can be displayed at a time. While a pop-up menu is displayed, calls to the PopupMenu method are ignored. Calls to the PopupMenu method are also ignored whenever a menu control is active.</p>
<p>
Often you want a pop-up menu to access options that are not usually available on the menu bar. To create a menu that will not display on the menu bar, make the top-level menu item invisible at design time (make sure the Visible check box in the Menu Editor is not checked). When Visual Basic displays a pop-up menu, the Visible property of the specified top-level menu is ignored.</p>
<h2>The Flags Argument</h2>
<p>
You use the <i>flags</i> argument in the PopupMenu method to further define the location and behavior of a pop-up menu. The following table lists the flags available to describe a pop-up menu's location.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=37%><b>Location constants</b></td>
<td class=label width=63%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=37%>vbPopupMenuLeftAlign</td>
<td width=63%>Default. The specified <i>x</i> location defines the left edge of the pop-up menu.</td>
</tr>
<tr valign=top>
<td width=37%>vbPopupMenuCenterAlign</td>
<td width=63%>The pop-up menu is centered around the specified <i>x</i> location.</td>
</tr>
<tr valign=top>
<td width=37%>vbPopupMenuRightAlign</td>
<td width=63%>The specified <i>x</i> location defines the right edge of the pop-up menu.</td>
</tr>
</table><br>
<p>
The following table lists the flags available to describe a pop-up menu's behavior.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>Behavior constants</b></td>
<td class=label width=62%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=38%>vbPopupMenuLeftButton</td>
<td width=62%>Default. The pop-up menu is displayed when the user clicks a menu item with the left mouse button only.</td>
</tr>
<tr valign=top>
<td width=38%>vbPopupMenuRightButton</td>
<td width=62%>The pop-up menu is displayed when the user clicks a menu item with either the right or left mouse button.</td>
</tr>
</table><br>
<p>
To specify a flag, you combine one constant from each group using the Or operator. The following code displays a pop-up menu with its top border centered on a form when the user clicks a command button. The pop-up menu triggers Click events for menu items that are clicked with either the right or left mouse button.</p>
<pre><code>Private Sub Command1_Click ()
   ' Dimension X and Y variables.
   Dim xloc, yloc

   ' Set X and Y variables to center of form.
   xloc = ScaleWidth / 2
   yloc = ScaleHeight / 2

   ' Display the pop-up menu.
   PopupMenu mnuEdit, vbPopupMenuCenterAlign Or _
   vbPopupMenuRightButton, xloc, yloc
End Sub
</code></pre>
<h2>The Boldcommand Argument</h2>
<p>
You use the <i>boldcommand</i> argument to specify the name of a menu control in the displayed pop-up menu that you want to appear in bold. Only one menu control in the pop-up menu can be bold.</p>
</BODY>
</HTML>
