<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tracking Records with Bookmarks and SelBookmarks</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbcontrackingrecordswithbookmarksselbookmarks"></a>Tracking Records with Bookmarks and SelBookmarks</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconTrackingRecordsWithBookmarksSelBookmarksC">
</object></p>
<p>
Bookmarks and SelBookmarks provide a means to track records. This is necessary when you program special functionality into an application, such as allowing the end user to manually select several discontiguous records, and performing a bulk update of the selected records. In that case, you will need to track which records have been selected, and you would therefore use the SelBookmarks collection and its properties.</p>
<p>
Two functions, the CellText and CellValue methods, require bookmarks to perform properly.</p>
<h3>Tracking User Selections</h3>
<p>
The SelBookmarks collection contains the bookmarks of all selected records. When the end user manually selects records (by holding down the CTRL key while clicking) the bookmark for each selected record is added to the collection. Using standard iteration methods, you can determine what has been selected, store the bookmarks (in case you need to restore a value), and perform the operation:</p>
<pre><code>Dim i as Integer ' Counter
Dim intCount As Integer
intCount = DataGrid1.SelBookmarks.Count - 1
ReDim arrSelBK(intCount) ' Declare array to hold bookmarks.
For i = 0 To intCount
   ArrSelBK(i) = DataGrid1.SelBookmarks(i)
   ' Perform operations here. If the operations must be
   ' cancelled, exit the loop and use the array to 
   ' rollback the changes.
Next i
</code></pre>
<h3>Programmatically Select Records by Adding to the SelBookmarks Collection</h3>
<p>
You can also programmatically select records by adding them to the collection. For example, you may have a grid that shows all of the orders by a certain customer. To highlight all of the records where the customer spent more than $100, filter the records, and add the resulting bookmarks to the SelBookmarks collection.</p>
<pre><code>Dim rs As Recordset
Set rs = Adodc1.Recordset

While Not rs.EOF
   If rs!SupplierID = 12 Then
      DataGrid1.SelBookmarks.Add rs.Bookmark
   End If
   rs.MoveNext
Wend
</code></pre>
</BODY>
</HTML>
