<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Manipulating Your Data Environment</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconmanipulatingyourde"></a>Manipulating Your Data Environment</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconManipulatingYourDE_C">
</object></p>
<p>
This section contains information on viewing objects within your Data Environment designer, modifying and deleting objects, refreshing Command and Connection objects, and setting Data Environment designer options.</p>
<h2>Data Environment Designer Views</h2>
<p>
The Data Environment designer window has an outline view that shows the defined Connection and Command objects. This outline view can be arranged either by object type or by connection. You can also set this outline view to either display or hide the field objects of each Command object.</p>
<h3>View By Connection</h3>
<p>
By Connection displays the objects grouped by connection, with the Command objects listed under the Connection object to which they are linked. Thus, you can easily view the association of Command objects with Connection objects. All defined Command hierarchies retain their structure.</p>
<p class=label>
<b>To view By Connection</b>
<ul type=disc>
<li>
Click the <b>Arrange by Connections</b> button in the Data Environment designer toolbar.</li>
</ul>
<p class=label>
<b>Outline View By Connection</b></p>
<p>
<img src="vb533x1.gif" border=0></p>
<h3>View By Object</h3>
<p>
By Object groups objects of the same type together. This enables you to focus on objects of a specific type, regardless of their associated connection.</p>
<p class=label>
<b>To view By Object</b>
<ul type=disc>
<li>
Click the <b>Arrange by Objects</b> button in the Data Environment designer toolbar.</li>
</ul>
<p class=label>
<b>Outline View By Object</b></p>
<p>
<img src="vb533x2.gif" border=0></p>
<h2>Hiding Field Objects in Your Data Environment Designer</h2>
<p>
By default, the Field objects of each Command object display in the outline view of the Data Environment designer. You can expand or collapse the view of these Field objects by clicking the plus (+) or minus (-) bitmap associated with the Command object. However, you can hide all Field objects completely from the outline view to clearly view relationships between Command objects.</p>
<p class=label>
<b>To hide the Field objects for all Command objects</b>
<ol>
<li>
Right-click on the DataEnvironment object. The DataEnvironment object is the top-most object in your Data Environment outline view.<br><br></li>
<li>
Clear the selection of <b>Show Fields</b> from the shortcut menu.</li>
</ol>
<h2>Modifying an Object in Your Data Environment Designer</h2>
<p>
You can modify any existing Command or Connection object by accessing either its Properties dialog box or the Visual Basic <b>Properties</b> window. Common modifications include changing a Command object's connection source, adjusting a Connection object's logon information, and renaming an object.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;While using the Visual Basic <b>Properties</b> window provides a direct means of changing individual property values, it can be more difficult if you are unfamiliar with the properties associated with the object.</p>
<p class=label>
<b>To modify an existing Command or Connection object using its Properties</b> <b>dialog box</b>
<ol>
<li>
Right-click the Command or Connection object to modify, and then select <b>Properties</b> from the shortcut menu to access its <b>Properties </b>dialog box.<p class=tl>
-or-</P><p class=tl>
Double-click your Command or Connection object to open its <b>Properties </b>dialog box.</P></li>
<li>
To change any of the Command object's properties, from the <b>Command Properties </b>dialog box, click the appropriate tab: <b>General</b>, <b>Parameters</b>, <b>Relation</b>, <b>Grouping</b>, <b>Aggregates</b>, or <b>Advanced</b>, and then make the appropriate changes. For information on each tab's settings, click the tab, and then press F1 to access online Help for the Command object's properties.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When the source of a Command object is changed, the Data Environment updates its associated field and parameter information.</p></li>
<li>
To change any of the Connection object's properties, from the <b>Data Link Properties </b>dialog box, click the appropriate tab: <b>Provider</b>, <b>Connection</b>, <b>Advanced</b>, or <b>All</b>, and then make the appropriate changes. For information on each tab's settings, press F1 or <b>Help</b> to access the online Help for the Connection object's properties.<br><br></li>
<li>
Click <b>OK</b> to apply the properties to the object.</li>
</ol>
<p class=label>
<b>To modify an existing Command or Connection object using the Visual Basic Properties window</b>
<ol>
<li>
Select the Command or Connection object from the drop-down list in the Visual Basic <b>Properties</b> window.<br><br></li>
<li>
Choose either the <b>Alphabetic</b> or the <b>Categorized</b> tab, and then change the property information in the right column as necessary.</li>
</ol>
<h2>Renaming an Object in Your Data Environment Designer</h2>
<p>
Upon creation, objects in your Data Environment designer are given default names, such as Command1, Connection1, or DataEnvironment1. However, you can change these to more meaningful, unique names. For example, if you are creating a connection based on the Northwind database, a logical name may be "Northwind." Likewise, if you are creating a command based on the customer's table, a logical name may be "Customers."</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When a Connection object is renamed, any Command objects associated with it automatically update in the ActiveConnectionName property. In addition, when a Command object is renamed, its link to the Connection object and other Command objects is maintained.</p>
<p class=label>
<b>To rename an object in your Data Environment designer</b>
<ul type=disc>
<li>
Right-click the object that you wish to rename and choose <b>Properties</b> from the shortcut menu. The <b>Properties</b> dialog box appears. Type a new name in the <b>Name</b> box and click <b>OK</b> to apply the changes and exit the dialog box.<p class=tl>
-or-</P><p class=tl>
Right-click the Command or Connection object you wish to rename and choose <b>Rename </b>from the shortcut menu. The outline view is now in edit mode. Type the new name, and then press enter to accept the change.</P><p class=tl>
-or-</P><p class=tl>
On the Visual Basic <b>Properties </b>window, select the entry to the right of <b>(Name)</b>, and type the new name.</P></li>
</ul>
<h2>Deleting an Object from Your Data Environment</h2>
<p>
You can remove DataEnvironment, Connection, or Command objects from your Data Environment designer. When deleting an object, a warning message appears, unless Prompt before deleting objects is cleared in the Options dialog box. In addition, if the object selected for deletion has dependent objects, a message appears, asking if you also want to delete the dependent objects. For example, a Connection object has dependent objects if it is associated with a Command object, or a Command object has dependent objects if it is involved in a relation or grouping hierarchy.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;Once a Connection object is deleted, any Command objects associated with it become invalid, and the ActiveConnectionName property for all its associated Command objects is cleared.</p>
<p class=label>
<b>To delete a Command or Connection object from your Data Environment designer</b>
<ol>
<li>
Select the object that you wish to remove and press delete.<p class=tl>
-or-</P><p class=tl>
Right-click the Command or Connection object that you wish to remove and choose <b>Delete </b>from the shortcut menu.</P></li>
<li>
If <b>Prompt before deleting objects </b>is selected in the <b>Options</b> dialog box, warning messages display to alert you to any affects of the delete.</li>
</ol>
<h2>Refreshing an Object in Your Data Environment Designer</h2>
<p>
The Refresh function differs in function between Connection and Command objects.</p>
<h3>Refreshing Connection Objects</h3>
<p>
When a refresh is performed on a Connection object, the connection is closed and the internal cache is cleared of the metadata associated with the Connection object. In addition, refreshing a Connection forces the Data Environment to open the connection. After the refresh, the next time a list of tables or stored procedures is accessed, the list is rebuilt.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Refreshing a Connection object does not automatically refresh its associated Command objects.</p>
<h3>Refreshing Command Objects</h3>
<p>
When a refresh is performed on a Command object, all metadata stored with the object, including the Field and Parameter objects, is rebuilt. If the Command object's definition of the table or stored procedure has changed, the changes are reflected in the Command object <i>after</i> the refresh.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;Refreshing a Command object removes user-defined data, including parameter and field mapping information. Once removed, it cannot be retrieved.</p>
<p class=label>
<b>To refresh a Connection or Command object</b>
<ul type=disc>
<li>
Select the Command or Connection object to refresh, and then click <b>Refresh</b> in the Data Environment designer toolbar.<p class=tl>
-or-</P><p class=tl>
Right-click the Command or Connection object to refresh, and choose <b>Refresh </b>from the shortcut menu.</P></li>
</ul>
<p>
Connection and Command objects are also refreshed whenever their respective source properties are modified.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The status bar text indicates whether a Connection object is open (connected).</p>
<h2>Changing Warning and Confirmation Dialog Box Display</h2>
<p>
You can change the display of warning and confirmation dialog boxes using the Options dialog box.</p>
<p class=label>
<b>To change warning and confirmation dialog box display</b>
<ol>
<li>
Click <b>Options </b>in the Data Environment designer toolbar.<p class=tl>
-or-</P><p class=tl>
Right-click a DataEnvironment object and choose <b>Options </b>from the shortcut menu.</P></li>
<li>
From the <b>General</b> tab of the <b>Options</b> dialog box, set the following:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Item</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><b>Prompt before deleting object</b></td>
<td width=71%>When selected, a confirmation dialog box displays when you delete an object.<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;It is recommended that this option remain selected, so that the system presents an alert when deletion of an object affects other objects within your Data Environment.</p>
</td>
</tr>
<tr valign=top>
<td width=29%><b>Disable Warnings</b></td>
<td width=71%>When not selected, warning messages appear when appropriate.</td>
</tr>
<tr valign=top>
<td width=29%><b>Prompt before executing command</b></td>
<td width=71%>When selected, the system prompts you before executing a Command object.<p>
Occasionally it is not possible for the Data Environment to obtain field information about a Command object from the data provider using its normal processes. When the Data Environment is unsuccessful in obtaining metadata about the Recordset of a particular Command object, it attempts to obtain this information from the data provider by executing the Command object. Thus, your permission is requested before the Data Environment executes the user-defined code.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This situation generally only occurs for Command objects based on stored procedures or SQL text.</p>
</td>
</tr>
</table><br>
</li>
<li>
Click <b>OK</b> to apply the options to your Data Environment designer and close the <b>Options </b>dialog box.</li>
</ol>
</BODY>
</HTML>
