<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Menu Control Array</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcreatingmenucontrolarray"></a>Creating a Menu Control Array</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCreatingMenuControlArrayC">
</object></p>
<p>
A <i>menu control array </i>is a set of menu items on the same menu that share the same name and event procedures. Use a menu control array to:
<ul type=disc>
<li>
Create a new menu item at run time when it must be a member of a control array. The MDI Notepad sample, for example, uses a menu control array to store a list of recently opened files.<br><br></li>
<li>
Simplify code, because common blocks of code can be used for all menu items.</li>
</ul>
<p>
Each menu control array element is identified by a unique index value, indicated in the Index property box on the Menu Editor. When a member of a control array recognizes an event, Visual Basic passes its Index property value to the event procedure as an additional argument. Your event procedure must include code to check the value of the Index property, so you can determine which control you're using.</p>
<p>
<b><B>For More Information</B>&nbsp;&nbsp;&nbsp;</b>For more information on control arrays, see "Working with Control Arrays" in "Using Visual Basic's Standard Controls."</p>
<p class=label>
<b>To create a menu control array in the Menu Editor</b>
<ol>
<li>
Select the form.<br><br></li>
<li>
From the <b>Tools</b> menu, choose <b>Menu Editor</b>.<p class=tl>
–or–</P><p class=tl>
Click the <b>Menu Editor</b> button on the toolbar.</P></li>
<li>
In the <b>Caption</b> text box, type the text for the first menu title that you want to appear on the menu bar.<p class=tl>
The menu title text is displayed in the menu control list box.</P></li>
<li>
In the <b>Name</b> text box, type the name that you will use to refer to the menu control in code. Leave the <b>Index</b> box empty.<br><br></li>
<li>
At the next indentation level, create the menu item that will become the first element in the array by setting its <b>Caption</b> and <b>Name</b>.<br><br></li>
<li>
Set the <b>Index</b> for the first element in the array to 0.<br><br></li>
<li>
Create a second menu item at the same level of indentation as the first.<br><br></li>
<li>
Set the <b>Name</b> of the second element to the same as the first element and set its <b>Index</b> to 1.<br><br></li>
<li>
Repeat steps 5 – 8 for subsequent elements of the array.</li>
</ol>
<p class=indent>
<b><B>Important</B>&nbsp;&nbsp;&nbsp;</b>Elements of a menu control array must be contiguous in the menu control list box and must be at the same level of indentation. When you're creating menu control arrays, be sure to include any separator bars that appear on the menu.</p>
</BODY>
</HTML>
