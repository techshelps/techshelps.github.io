<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Detecting SHIFT, CTRL, and ALT States</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbcondetectingshiftctrlaltstates"></a>Detecting SHIFT, CTRL, and ALT States</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconDetectingSHIFTCTRLALTStatesC">
</object></p>
<p>
The mouse and keyboard events use the <i>shift</i> argument to determine whether the SHIFT, CTRL, and ALT keys are pressed and in what, if any, combination. If the SHIFT key is pressed, <i>shift</i> is 1; if the CTRL key is pressed, <i>shift</i> is 2; and if the ALT key is pressed, <i>shift</i> is 4. To determine combinations of these keys, use the total of their values. For example, if SHIFT and ALT are pressed, <i>shift</i> equals 5 (1 + 4).</p>
<p>
The three least-significant bits in <i>shift</i> correspond to the state of the SHIFT, CTRL, and ALT keys, as shown in Figure 11.5.</p>
<p class=label>
<b>Figure 11.5&nbsp;&nbsp;&nbsp;How bits represent the state of the SHIFT, CTRL, and ALT keys</b></p>
<p>
<img src="avp11006.gif" border=0></p>
<p>
Any or all of the bits in <i>shift</i> can be set, depending on the state of the SHIFT, CTRL, and ALT keys. These values and constants are listed in the following table:</p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=13%><b>Binary Value</b></td>
<td class=label width=16%><b>Decimal Value</b></td>
<td class=label width=24%><b>Constant</b></td>
<td class=label width=47%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=13%>001</td>
<td width=16%>1</td>
<td width=24%>vbShiftMask</td>
<td width=47%>The SHIFT key is pressed.</td>
</tr>
<tr valign=top>
<td width=13%>010</td>
<td width=16%>2</td>
<td width=24%>vbCtrlMask</td>
<td width=47%>The CTRL key is pressed.</td>
</tr>
<tr valign=top>
<td width=13%>100</td>
<td width=16%>4</td>
<td width=24%>vbAltMask</td>
<td width=47%>The ALT key is pressed.</td>
</tr>
<tr valign=top>
<td width=13%>011</td>
<td width=16%>3</td>
<td width=24%>vbShiftMask + vbCtrlMask</td>
<td width=47%>The SHIFT and CTRL keys are pressed.</td>
</tr>
<tr valign=top>
<td width=13%>101</td>
<td width=16%>5</td>
<td width=24%>vbShiftMask + vbAltMask</td>
<td width=47%>The SHIFT and ALT keys are pressed.</td>
</tr>
<tr valign=top>
<td width=13%>110</td>
<td width=16%>6</td>
<td width=24%>vbCtrlMask + vbAltMask</td>
<td width=47%>The CTRL and ALT keys are pressed.</td>
</tr>
<tr valign=top>
<td width=13%>111</td>
<td width=16%>7</td>
<td width=24%>vbCtrlMask + vbAltMask + vbShiftMask</td>
<td width=47%>The SHIFT, CTRL, and ALT keys are pressed.</td>
</tr>
</table><br>
<p>
As with the mouse events' <i>button</i> argument, you can use the If…Then…Else statement or the And operator combined with the Select Case statement to determine whether the SHIFT, CTRL, or ALT keys are being pressed and in what, if any, combination.</p>
<p>
Open a new project and add the variable <code>ShiftTest</code> to the Declarations section of the form:</p>
<pre><code>Dim ShiftTest as Integer
</code></pre>
<p>
Add the following code to the form's MouseDown event:</p>
<pre><code>Private Sub Form_MouseDown(Button As Integer, _
      Shift As Integer, X As Single, Y As Single)
   ShiftTest = Shift And 7
   Select Case ShiftTest
      Case 1 ' or vbShiftMask
         Print "You pressed the SHIFT key."
      Case 2 ' or vbCtrlMask
         Print "You pressed the CTRL key."
      Case 4 ' or vbAltMask
         Print "You pressed the ALT key."
      Case 3
         Print "You pressed both SHIFT and CTRL."
      Case 5
         Print "You pressed both SHIFT and ALT."
      Case 6
         Print "You pressed both CTRL and ALT."
      Case 7
         Print "You pressed SHIFT, CTRL, and ALT."
      End Select
End Sub
</code></pre>
</BODY>
</HTML>
