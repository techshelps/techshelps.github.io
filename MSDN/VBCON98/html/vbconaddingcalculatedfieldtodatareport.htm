<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a Calculated Field to the Data Report</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconaddingcalculatedfieldtodatareport"></a>Adding a Calculated Field to the Data Report</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconAddingCalculatedFieldToDataReport_C">
</object></p>
<p>
A calculated field is a field whose value is calculated as the report is generated. For example, when estimating the tax on an order, you must multiply the total price by the local tax rate. But since local tax rates differ and won't be stored in the database, the tax is generated as the report is created—a calculated field.</p>
<p>
In this example, the extended Data Report designer is modified to include a <b>Total</b> field that calculates the value of <code>Quantity * UnitPrice</code>. Adding a calculated field involves the following steps:
<ol>
<li>
Using a SQL statement in the data environment's Command object to create the calculated field.<br><br></li>
<li>
Adding three text box controls to the data report: <b>Quantity</b>, <b>UnitPrice</b>, and (for the calculated field) <b>Total</b>.</li>
</ol>
<p>
The modified data report resembles the figure below.</p>
<p>
<img src="vb4xib1.gif" border=0></p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a sample data report. It begins with the topic, <a href="vbconcreatingsimpledatareport.htm">Creating a Simple Data Report</a>.</p>
<p class=label>
<b>To add a calculated field to the data report</b>
<ol>
<li>
In the Data Environment designer, right-click the <b>OrderDetails </b>command. Then click <b>Properties</b> to display the <b>OrderDetails Properties </b>dialog box.<br><br></li>
<li>
On the <b>General </b>tab, click the <b>SQL Statement</b> button, and add the following statement to the box:<pre><code>Select OrderID, ProductID, UnitPrice, Quantity, (Quantity * UnitPrice) As Total From [Order Details]
</code></pre>
<p class=tl>
The SQL statement multiplies the Quantity value by the UnitPrice value to create the Total value—the calculated field. Also note that the name of the table (Order Details) contains a space, and must be enclosed by brackets.</P></li>
<li>
Click <b>OK</b> to close the dialog box.<br><br></li>
<li>
From the Data Environment designer, drag the Quantity, UnitPrice, and Total fields (under the <b>OrderDetails </b>command) onto the <b>Detail (Products_Detail)</b> section of the Data Report designer.<br><br></li>
<li>
Delete two Label controls, and change the <b>Caption</b> value of the remaining Label control to <b>*</b>, and arrange the controls to resemble the figure below:<p>
<img src="vb4xib2.gif" border=0></P></li>
<li>
On the Data Report designer, click the <b>UnitPrice </b>text box to select it. On the <b>Properties</b> window, double-click <b>DataFormat</b> to display the <b>Property Pages</b> dialog box.<br><br></li>
<li>
In the <b>Format Type</b> box, click <b>Currency</b>. In the <b>Symbol</b> combo box, select the currency appropriate to your country.<br><br></li>
<li>
Repeat steps 6 and 7 to change the <b>DataFormat</b> property of the <b>Total</b> text box to <b>Currency</b>.<br><br></li>
<li>
Click the <b>Total</b> text box control to select it. On the Properties window, change the Alignment property to <b>1</b> – <b>rptJustifyRight</b>.<br><br></li>
<li>
Save and run the project.</li>
</ol>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a sample data report.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>To</b></td>
<td class=label width=66%><b>See</b></td>
</tr>
<tr valign=top>
<td width=34%>Go to the next step</td>
<td width=66%><a href="vbconaddingfunctiontodatareport.htm">Adding a Function Control to the Data Report</a></td>
</tr>
<tr valign=top>
<td width=34%>Start from the beginning</td>
<td width=66%><a href="vbconcreatingsimpledatareport.htm">Creating a Simple Data Report</a></td>
</tr>
</table>
</BODY>
</HTML>
