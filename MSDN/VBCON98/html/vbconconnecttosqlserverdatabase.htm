<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a Table to an SQL Server Database</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconconnecttosqlserverdatabase"></a>Adding a Table to an SQL Server Database</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconConnectToSQLServerDatabaseC">
</object></p>
<p>
When you create a DHTML application that interacts with a SQL Server database, you may want to add new tables to the database. You can use a data environment to create a connection to the SQL Server database, then create your tables in the Data View window.</p>
<p>
This topic shows how to create a connection to the Pubs sample database in SQL Server, and how to add a new Customers table to the database.</p>
<p class=label>
<b>To add a table to an SQL database</b>
<ol>
<li>
Open a new DHTML Application DLL project.<br><br></li>
<li>
Create a connection to an SQL Server database.<br><br></li>
<li>
Add a table to the database.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a simple database application that interacts with data in an SQL Server database. It begins with the topic <a href="vbconquerysqlserverdatabase.htm">Creating a DHTML Application that Interacts with SQL Server Data</a>.</p>
<h3>Open a DHTML Application DLL Project</h3>
<p>
The first step in creating a DHTML application is to open a new DHTML Application DLL project. A DHTML Application DLL project is an ActiveX DLL project template that automatically loads the DHTML Page designer and its HTML toolbox tab and HTML controls, which are known as <i>elements</i>. Select New Project from the File menu, then select DHTML Application in the New Project dialog box.</p>
<p>
Visual Basic automatically adds a DHTML Page designer to your project. For every HTML page in your application, you need a corresponding designer. Open the Designers folder in the Project Explorer and double-click DHTMLPage1. The DHTML Page designer displays the page's interface in the right pane of the designer window, and a hierarchical list of the objects on the page in the left pane of the window.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information on creating a DHTML application, see <a href="vbcondevelopingclientinternetapplications.htm">Developing DHTML Applications</a> in <i>Building Internet Applications</i> in the <i>Component Tools Guide</i>.</p>
<h3>Create a Connection to an SQL Server Database</h3>
<p>
A data environment provides an easy way to create a connection to a database. To add a data environment to your project, select Add Data Environment from the Project menu. Visual Basic loads a data environment, and adds a Connection object to the data environment.</p>
<p>
You establish the connection to your data source by setting properties in the Data Link Properties dialog box. To display this dialog box, right-click the Connection object in your data environment and then choose Properties from the menu. Select an OLE DB provider on the Provider tab of the dialog box. Then click Next and enter connection information on the Connection tab of the dialog box. The layout of the Connection tab varies, depending on the OLE DB provider you select on the Provider tab.</p>
<p>
For example, to connect to an SQL Server database such as the Pubs sample database, select the Microsoft OLE DB Provider for SQL Server on the Provider tab. On the Connection tab, enter the server name, log on information, and the database name or SQL database file name.</p>
<p>
You set additional connection properties by clicking the Advanced or All tabs, or test the connection by clicking Test Connection.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information on using the Data Environment, see Chapter 3, <a href="vbconusingdataenvironmentdesigner.htm">About the Data Environment Designer</a>. For more information on connections and connection properties, see <a href="vbconconnectionobjects.htm">Connection Objects</a> in "About the Data Environment Designer." And for more information on Data Links, see <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="DataLinkAPIOverview">
</object><a href=JavaScript:alink_2.Click()>Data Link API Overview</a> in "Database and Messaging Services" in the Platform SDK.</p>
<h3>Add a Table to the Database</h3>
<p>
The Data View window lets you easily add a table, view, or stored procedure to your database. Open the Data View window by clicking the Data View Window button on the Standard toolbar. The Data View window displays a hierarchical view of any database connections you've created. For example, if you've created a connection to the Pubs sample database, the Data View window shows the database and its diagrams, tables, views, and stored procedures.</p>
<p>
Add a table to the database by right-clicking the Tables folder in the Data View window and selecting the New Table command. The Data View window displays the Choose Name dialog box, where you enter a name for the table. When you click OK, the Data View window displays the New Table window, where you enter the table definition — the name of each column in the table, its datatype, and other information about the column. To specify a primary key for the table, disable the Allow Nulls box, right-click the cell, and select Set Primary Key from the shortcut menu.</p>
<p>
For example, to add a Customers table to the Pubs database that stores customer address information, enter Customers in the Choose Name dialog box and enter the following table definition:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=43%><b>Column Name</b></td>
<td class=label width=31%><b>Datatype</b></td>
<td class=label width=26%><b>Length</b></td>
</tr>
<tr valign=top>
<td width=43%>CustomerID</td>
<td width=31%>char</td>
<td width=26%>5</td>
</tr>
<tr valign=top>
<td width=43%>CompanyName</td>
<td width=31%>varchar</td>
<td width=26%>20</td>
</tr>
<tr valign=top>
<td width=43%>Address</td>
<td width=31%>varchar</td>
<td width=26%>40</td>
</tr>
<tr valign=top>
<td width=43%>City</td>
<td width=31%>varchar</td>
<td width=26%>20</td>
</tr>
<tr valign=top>
<td width=43%>Region</td>
<td width=31%>varchar</td>
<td width=26%>10</td>
</tr>
<tr valign=top>
<td width=43%>PostalCode</td>
<td width=31%>varchar</td>
<td width=26%>10</td>
</tr>
<tr valign=top>
<td width=43%>Country</td>
<td width=31%>varchar</td>
<td width=26%>20</td>
</tr>
</table><br>
<p>
Set CustomerID as the primary key. When you save the table definition, the table is added to the database.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information on using the Data View window, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvovrWorkingInDataView">
</object><a href=JavaScript:alink_3.Click()>Managing Databases in Data View</a>. For more information on using the Data View window to create a table, see <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvconTables">
</object><a href=JavaScript:alink_4.Click()>Tables</a>.</p>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a simple DHTML application that interacts with data in an SQL Server database.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>To</b></td>
<td class=label width=69%><b>See</b></td>
</tr>
<tr valign=top>
<td width=31%>Go to the next step</td>
<td width=69%><a href="vbconcreatedatainputform.htm">Create a Data Entry HTML Page</a></td>
</tr>
<tr valign=top>
<td width=31%>Start from the beginning</td>
<td width=69%><a href="vbconquerysqlserverdatabase.htm">Creating a DHTML Application that Interacts with SQL Server Data</a></td>
</tr>
</table><br>
</BODY>
</HTML>
