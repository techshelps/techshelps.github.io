<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Package and Deployment Wizard with the Setup Toolkit</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconusingsetupwizardwithsetuptoolkit"></a>Using the Package and Deployment Wizard with the Setup Toolkit</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconUsingPackageDeploymentWizardWithSetupToolkitC;vbconUsingSetupWizardWithSetupToolkit_C">
</object></p>
<p>
In addition to using the Setup Toolkit project to create your own custom setup project, you can use the Setup Toolkit project in conjunction with the Package and Deployment Wizard. In this case, you use the Setup Toolkit project to customize the screens or other parts of the installation sequence, then use the wizard to create and deploy the package for the application. </p>
<p>
For example, you might use the Setup Toolkit and the Package and Deployment Wizard together to add dialog boxes to the installation program, prompting the user to specify whether to install optional features in your application. For example, you may have an online Help file that some users would rather not install. You can add as many installation options as you want.</p>
<p class=label>
<b>To add an installation option to your setup program</b>
<ol>
<li>
In the Setup1.vbp project, edit the code for the Form_Load event in the setup1.frm form. To add functionality, you add code after the code block calls the ShowBeginForm function (Sub ShowBeginForm).<p class=tl>
The following shows an example of how you would add a dialog box that asks if the user wants to install optional files:</P><pre><code>Dim LoadHelp As Integer
LoadHelp = MsgBox ("Do you want to install Help? ", vbYesNo)
If LoadHelp = vbYes Then
 &nbsp; CalcDiskSpace "Help"
EndIf
' Block of code containing cIcons = CountIcons(strINI FILES)
If LoadHelp = vbYes Then
 &nbsp; cIcons = CountIcons("Help")
EndIf
' Block of code containing CopySection strINI_FILES.
If LoadHelp = vbYes Then
 &nbsp; CopySection "Help"
EndIf
' Block of code containing CreateIcons, strINI FILES, strGroupName 
</code></pre>
</li>
<li>
Close Setup1.frm, save the form and the Setup Toolkit project, and compile to create the Setup1.exe file.<br><br></li>
<li>
Run the <b>Package and Deployment Wizard</b>, and select <b>Package</b> from the main screen.<br><br></li>
<li>
Proceed through the wizard, making the appropriate choices. For the example shown above, you would make sure that all optional files the user could choose to install in your custom dialog box were listed in the Add and Remove screen.<br><br></li>
<li>
Once you are done with the Package and Deployment Wizard, generate the distribution media.<br><br></li>
<li>
Make any necessary changes to the Setup.lst file. In the example above, you would add a new section with a section you used in the CopySection section of your code. In this case, your section would look something like this:<pre><code>[Help]
File1=MyApp.HL1,MyApp.HLP,$(AppPath),,,10/12/96,2946967,0.0.0
</code></pre>
</li>
<li>
Deploy and test your package.<pre></pre>
</li>
</ol>
<p>
When the user runs the installation program for the example shown in this procedure, the setup program copies all the BootStrap files to the user's machine and then prompts the user to indicate whether to install the Help files. If the user chooses Yes, the CalcDiskSpace statement determines whether there is sufficient disk space on the user's machine for the Help files. The program then installs all of the files listed with the Setup1 Files section in Setup.lst.</p>
<p>
Next, the program tests the LoadHelp flag again. If the user chose to install the Help files, Setup1.exe next executes the CopySection statement for the Help files, and installs the files listed in the [Help] section of Setup.lst.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See "The Package and Deployment Wizard" earlier in this chapter for more information on features of the wizard.</p>
</BODY>
</HTML>
