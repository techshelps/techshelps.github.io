<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Create a Master Detail Report on a Form</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconcreatedetailreportonform"></a>Create a Master/Detail Form</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconCreateDetailReportOnFormC">
</object></p>
<p>
In database applications, it's often useful to simultaneously view a record with a group of related records. For example, you may want to view a customer record and the current orders for the customer. A common way to accomplish this is to create a master/detail form.</p>
<p class=label>
<b>To create a Master/Detail form</b>
<ol>
<li>
Create a parent/child data environment Command object.<br><br></li>
<li>
Drag the Command object from the Data Environment designer to a blank form.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a simple database application that interacts with data in Nwind.mdb. It begins with the topic, <a href="vbconconnecttoisamdatabase.htm">Interacting with Data in a Microsoft Jet/Microsoft Access Database</a>.</p>
<h2>Create a Parent/Child Data Environment Command Object</h2>
<p>
You've seen in the "Create a Data Environment Command Object" and "Create a Data Grid Form Based on a Query" topics how to create a data environment Command object based on a single table or query. You can also use a hierarchical parent/child Command object that lets you simultaneously view a record from one table or query with a group of related records in a second table or query.</p>
<p>
For example, you can create a parent Command object that returns address information for all French customers in the Northwind Traders sample database. You can then add a related child Command object to the parent Command object that displays order information for each French customer.</p>
<p>
Create the parent Command object by following the instructions in the previous steps in this scenario to open an existing Data Environment designer or create a new one. Then click the Add Command button on the Data Environment toolbar and set the following properties in the Command Properties dialog box:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=39%><b>Property</b></td>
<td class=label width=61%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=39%>Command Name</td>
<td width=61%>FrenchCustomers</td>
</tr>
<tr valign=top>
<td width=39%>Connection</td>
<td width=61%>Connection1</td>
</tr>
</table><br>
<p>
Select SQL Statement as the source of data for the Command object. Click the SQL Builder button to open the Query designer, drag the Customers table from the Data View window to the upper pane of the Query designer, and then click the check box next to the CustomerID, CompanyName, Address, City, PostalCode, and Country fields. Specify the criteria for the query by entering "France" in the Country field's Criteria box. The Query designer builds the following SQL statement:</p>
<pre><code>SELECT CustomerID, CompanyName, Address, City, PostalCode, Country
FROM Customers
WHERE (Country = 'France')
</code></pre>
<p>
Add the child command to the parent command by right-clicking the FrenchCustomers command in the Data Environment designer, and then select Add Child Command from the popup menu. Set the following properties in the Command Properties dialog box:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=23%><b>Property</b></td>
<td class=label width=77%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=23%>Command Name</td>
<td width=77%>OrderDates</td>
</tr>
<tr valign=top>
<td width=23%>Connection</td>
<td width=77%>Connection1</td>
</tr>
</table><br>
<p>
Select SQL Statement as the source of data for the Command object. Click the SQL Builder button to open the Query designer, drag the Orders table from the Data View window to the upper pane of the Query designer, and then click the check box next to the OrderID, CustomerID, OrderDate, and ShippedDate fields. The Query designer&nbsp; builds the following SQL statement:</p>
<pre><code>SELECT OrderID, CustomerID, OrderDate, ShippedDate
FROM Orders 
</code></pre>
<p>
Finally, define the relationship between the parent and child Command objects. In the Data Environment designer, select the OrderDates Command object and click the Properties button on the toolbar. Click the Relation tab. Define a relationship between the CustomerID fields in the parent and child Command objects by selecting CustomerID in the Parent Fields and Child Fields/Parameters lists. Then click the Add button. The Data Environment designer adds the relation to the Relation Definition box.</p>
<p>
When you've finished, the data environment displays a hierarchical view of the parent Command object and its fields along with the child Command object and its fields.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconHowDECommandsExposed">
</object><a href=JavaScript:alink_2.Click()>How Commands are Exposed for Programmatic Access</a>.</p>
<h2>Drag the Command Object from the Data Environment to a Blank Form</h2>
<p>
As with the data-bound forms based on a single table or query, you can create a master/detail form based on a hierarchical parent/child Command object by simply dragging the Command object from the Data Environment designer to a blank form.</p>
<p>
For example, create a master/detail form that displays address information and related order information for French customers by selecting the FrenchCustomers Command object you created in the previous step. Then while pressing the right mouse button, drag the Command object onto a blank form. Visual Basic displays a popup menu that lets you select whether to create a data grid, hierarchical flexgrid, or bound controls. When you select hierarchical flexgrid, Visual Basic automatically creates a master/detail form based on the parent/child Command object.</p>
<p>
When you run the form, Visual Basic displays the address records returned by the FrenchCustomers Command object and related order records returned by the OrderDates Command object.</p>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a simple database application that interacts with data in Nwind.mdb.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>To</b></td>
<td class=label width=69%><b>See</b></td>
</tr>
<tr valign=top>
<td width=31%>Go to the next step</td>
<td width=69%><a href="vbconmakereportusingdesigner.htm">Create a Data-Bound Report</a></td>
</tr>
<tr valign=top>
<td width=31%>Start from the beginning</td>
<td width=69%><a href="vbconconnecttoisamdatabase.htm">Interacting with Data in a Microsoft Jet/Microsoft Access Database</a></td>
</tr>
</table><br>
</BODY>
</HTML>
