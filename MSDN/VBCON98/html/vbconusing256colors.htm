<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with 256 Colors</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconusing256colors"></a>Working with 256 Colors</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconUsing256ColorsC">
</object></p>
<p>
Visual Basic supports 256 colors on systems with video adapters and display drivers that handle 256 or more colors. The ability to display 256 simultaneous colors is particularly valuable in multimedia applications or applications that need to display near –photographic-quality images.</p>
<p>
You can display 256-color images and define up to 256 colors for graphics methods in:
<ul type=disc>
<li>
Forms<br><br></li>
<li>
Picture boxes<br><br></li>
<li>
Image controls (display images only)</li>
</ul>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Support for 256 colors does not apply to Windows metafiles. Visual Basic displays metafiles using the default palette of 16 VGA colors.</p>
<h2>Color Palettes</h2>
<p>
<i>Color palettes</i> provide the basis for 256-color support in Visual Basic applications. In discussing palettes, it’s important to understand the relationship between different palette types. The <i>hardware palette </i>contains 256 entries defining the actual RGB values that will be displayed on screen. The <i>system halftone palette</i> is a predefined set of 256 RGB values made available by Windows itself. A <i>logical palette</i> is a set of up to 256 RGB values contained within a bitmap or other image.</p>
<p>
Windows can draw using the 256 colors in the hardware palette. Twenty of these 256 colors, called <i>static colors</i>, are reserved by the system and cannot be changed by an application. Static colors include the 16 colors in the default VGA palette (the same as the colors defined by Visual Basic’s QBColor function), plus four additional shades of gray. The system halftone palette always contains these static colors.</p>
<p>
The foreground window (the window with focus) determines the 236 nonstatic colors in the hardware palette. Each time the hardware palette is changed, all background windows are redrawn using these colors. If the colors in a background window’s logical palette don’t perfectly match those currently in the hardware palette, Windows will assign the closest match.</p>
<h2>Displaying 256-Color Images</h2>
<p>
Forms, picture boxes, and image controls automatically display images in 256 colors if the user’s display hardware and software can support that many colors on screen. If the user’s system supports fewer colors than the image, then Visual Basic will map all colors to the closest available.</p>
<p>
On true-color (16-million color) displays, Visual Basic always uses the correct color. On monochrome or 16-color displays, Visual Basic will dither background colors and colors set with the FillColor property. <i>Dithering</i> is a process used to simulate colors not available from the video adapter and display driver.</p>
<h2>Drawing with Color Palettes</h2>
<p>
With 256-color video drivers, you can use up to 256 colors with graphics methods. By default, the 256 colors available in Visual Basic are those in the system halftone palette. Although you can specify an exact color using the RGB function, the actual color displayed will be the closest match from the halftone palette, as shown in Figure 12.22.</p>
<p class=label>
<b>Figure 12.22&nbsp;&nbsp;&nbsp;Color matching from a specified color to the display</b></p>
<p>
<img src="avp12022.gif" border=0></p>
<p>
Although the default palette for Visual Basic is the system halftone palette, you can also control the display of colors with the PaletteMode and Palette properties of forms, user controls, and user documents. In this case, the color match is much the same, except that colors will be matched to the closest color in the hardware palette.</p>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;To learn more about the Palette and PaletteMode properties, see "Managing Multiple Color Palettes" later in this chapter.</p>
</BODY>
</HTML>
