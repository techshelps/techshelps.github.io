<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a Function Control to the Data Report</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconaddingfunctiontodatareport"></a>Adding a Function Control to the Data Report</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconAddingFunctionToDataReport_C">
</object></p>
<p>
The Data Report designer features its own set of controls. Among these, the Function control has no counterpart among the Visual Basic intrinsic controls and deserves further explanation.</p>
<p>
The Function control displays data that is calculated at run time, using a built-in function, as the report is generated. A typical example is shown in the figure below, where the Function control is used to display the sum of sub-totals to create a total value for a particular order.</p>
<p>
If you have created a calculated field using a SQL statement (in the previous topic, "Adding a Calculated Field to the Data Report"), you may wonder why a Function control can't also be used to calculate the value of<code> Quantity * UnitPrice</code>. In short, the Function control can calculate values only after all other records in a group section have been processed. In contrast, a SQL statement calculates the values as part of the fields in a record as they are processed.</p>
<p>
The steps to adding a Function control to the Data Report designer are:
<ol>
<li>
Draw a Function control in an appropriate Footer section of the Data Report designer.<br><br></li>
<li>
Set the DataMember and DataField properties to appropriate values (a numeric field from a relevant data environment Command object.)</li>
</ol>
<p class=label>
<b>Data Report with Function Control Showing Totals</b></p>
<p>
<img src="vb4voa1.gif" border=0></p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic is part of a series that walks you through creating a sample data report. It begins with the topic, <a href="vbconcreatingsimpledatareport.htm">Creating a Simple Data Report</a>.</p>
<p class=label>
<b>To add a Function control to the data report</b>
<ol>
<li>
Using the mouse pointer, click the group footer<b> </b>named <b>Customers_Footer</b>, and drag it towards the bottom of the window, to create a space between it and the <b>Orders_Footer</b> footer.<br><br></li>
<li>
On the <b>Toolbox</b>, click the <b>rptFunction </b>control.<br><br></li>
<li>
Draw the <b>rptFunction</b> control in the space between the two footers.<br><br></li>
<li>
Set the properties of the <b>rptFunction</b> control according to the table below:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Property</b></td>
<td class=label width=50%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=50%>DataMember</td>
<td width=50%>OrderDetails</td>
</tr>
<tr valign=top>
<td width=50%>DataField</td>
<td width=50%>Total</td>
</tr>
<tr valign=top>
<td width=50%>Name</td>
<td width=50%>fncTotal</td>
</tr>
<tr valign=top>
<td width=50%>Alignment</td>
<td width=50%>1 – rptJustifyRight</td>
</tr>
<tr valign=top>
<td width=50%>DataFormat</td>
<td width=50%>Currency</td>
</tr>
</table><br>
<p class=tl>
The <b>FunctionType</b> property of the control determines what operation will be performed with the data found in the <b>DataField</b>. By default, the property is set to <b>0-RptFuncSum</b>, to sum the data. Other functions include: Average, Minimum, Maximum, Row Count, STDDev (Standard Deviation), and Value Count.</P></li>
<li>
Draw a <b>Line</b> control just above the Quantity text box, and a <b>Label</b> control to the left of the text box. Set the <b>Caption</b> property of the label to <b>Total</b>.<br><br></li>
<li>
Click the <b>fncTotal</b> control to select it. On the Properties window, double-click <b>Font</b> to display the <b>Font</b> dialog box. Change the <b>Font style</b> to <b>Bold</b>.<br><br></li>
<li>
Repeat step 6 with the Label control.<br><br></li>
<li>
Position the controls on the designer to resemble the figure below:<p>
<img src="vb4voa2.gif" border=0></P></li>
<li>
Save and run the project.</li>
</ol>
<h2>Increasing the scope of the function</h2>
<p>
You can increase the scope of the function by placing the control in a lower group footer. For example, you may want to find out the grand total of each customer's set of orders.</p>
<p class=label>
<b>To show a grand total for all orders</b>
<ol>
<li>
Draw a new <b>Function </b>control in the <b>Customers_Footer </b>section. Align the new control with the Function control created above.<br><br></li>
<li>
Draw a <b>Label </b>control to the left of the new <b>Function</b> control.<br><br></li>
<li>
Set the properties of the controls as shown in the table below:<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>Control</b></td>
<td class=label width=33%><b>Property</b></td>
<td class=label width=34%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=33%>rptFunction</td>
<td width=33%>Name</td>
<td width=34%>fncGrandTotal</td>
</tr>
<tr valign=top>
<td width=33%>rptFunction</td>
<td width=33%>DataMember</td>
<td width=34%>OrderDetails</td>
</tr>
<tr valign=top>
<td width=33%>rptFunction</td>
<td width=33%>DataField</td>
<td width=34%>Total</td>
</tr>
<tr valign=top>
<td width=33%>rptFunction</td>
<td width=33%>Font (Font Style)</td>
<td width=34%>Bold</td>
</tr>
<tr valign=top>
<td width=33%>rptFunction</td>
<td width=33%>Alignment</td>
<td width=34%>1 – rptJustifyRight</td>
</tr>
<tr valign=top>
<td width=33%>rptLabel</td>
<td width=33%>Caption</td>
<td width=34%>Grand Total</td>
</tr>
<tr valign=top>
<td width=33%>rptLabel</td>
<td width=33%>Font (Font Style) </td>
<td width=34%>Bold</td>
</tr>
<tr valign=top>
<td width=33%>rptLabel</td>
<td width=33%>Alignment</td>
<td width=34%>1 – rptJustifyRight</td>
</tr>
</table><br>
</li>
<li>
The Data Report designer should now resemble the figure below:<p>
<img src="vb4voa3.gif" border=0></P></li>
<li>
Save and run the project.</li>
</ol>
<h2>Optional—Adding a Report Total</h2>
<p>
It's possible to increase the scope of the Function control even further. If you wish to see a total of <b>all</b> orders in the report, you can add a Function control to the Report Footer section.</p>
<p class=label>
<b>To add a Report Total to the data report</b>
<ol>
<li>
Right-click the Data Report designer and click <b>Show Report Header/Footer</b>.<br><br></li>
<li>
Add a <b>Function </b>control to the report footer.<br><br></li>
<li>
Set the property of the control as shown in the table below:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Property</b></td>
<td class=label width=50%><b>Setting</b></td>
</tr>
<tr valign=top>
<td width=50%>Name</td>
<td width=50%>fncReportTotal</td>
</tr>
<tr valign=top>
<td width=50%>DataMember</td>
<td width=50%>OrderDetails</td>
</tr>
<tr valign=top>
<td width=50%>DataField</td>
<td width=50%>Total</td>
</tr>
<tr valign=top>
<td width=50%>DataFormat</td>
<td width=50%>Currency</td>
</tr>
<tr valign=top>
<td width=50%>Alignment</td>
<td width=50%>1 – rptJustifyRight</td>
</tr>
</table><br>
<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The number for the entire report will be especially large. Therefore the width of the Function control will have to be adjusted accordingly.</p></li>
<li>
Save and run the project.</li>
</ol>
<h4>Step by Step</h4>
<p>
This topic is part of a series that walks you through creating a sample data report.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>To</b></td>
<td class=label width=69%><b>See</b></td>
</tr>
<tr valign=top>
<td width=31%>Go to the next step</td>
<td width=69%><a href="vbcongroupinginformationindatareport.htm">Grouping Information in the Data Report</a></td>
</tr>
<tr valign=top>
<td width=31%>Start from the beginning</td>
<td width=69%><a href="vbconcreatingsimpledatareport.htm">Creating a Simple Data Report</a></td>
</tr>
</table><br>
</BODY>
</HTML>
