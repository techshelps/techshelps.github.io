<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calling Windows API Functions</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconhowtocallwindowsapifunctionsindbcsenvironment"></a>Calling Windows API Functions</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconHowToCallWindowsAPIFunctionsInDBCSEnvironmentC">
</object></p>
<p>
Many Windows API and DLL functions return size in bytes. This return value represents the size of the returned string. Visual Basic converts the returned string into Unicode even though the return value still represents the size of the ANSI or DBCS string. Therefore, you may not be able to use this returned size as the string's size. The following code gets the returned string correctly:</p>
<pre><code>buffer = String(145, Chr(" "))
   ret = GetPrivateProfileString(section, _
   entry, default, buffer, Len(buffer)-1, filename)
   retstring = Left(buffer, Instr(buffer, Chr(0))-1))
</code></pre>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;For more information, see "Accessing the Microsoft Windows API" in "Accessing DLLs and the Windows API" of the Co<i>mponent Tools Guide</i>, available in the Professional and Enterprise editions.</p>
</BODY>
</HTML>
