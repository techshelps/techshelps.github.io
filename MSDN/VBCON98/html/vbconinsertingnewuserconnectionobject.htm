<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Inserting a New UserConnection Object</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconinsertingnewuserconnectionobject"></a>Inserting a New UserConnection Object</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconInsertingNewUserConnectionObject_C">
</object></p>
<p class=label>
<b>To insert a new connection object</b>
<ol>
<li>
Make sure the Remote Data Object 2.0 library is referenced in the <b>References</b> dialog box available from the <b>Project</b> menu.<br><br></li>
<li>
Make sure the designer is enabled by checking <b>Microsoft UserConnection</b> on the <b>Designers</b> tab of the <b>Components </b>dialog box, available on the <b>Projects</b> menu.<br><br></li>
<li>
Insert the UserConnection designer into the project by selecting <b>Microsoft UserConnection</b> from the <b>Add ActiveX Designer</b> item on the <b>Project</b> menu.</li>
</ol>
<h2>The Connection Designer Properties Window</h2>
<p>
When you insert the UserConnection designer, a new connection class is added to the current project and brings up a visual representation of the class, overlaid with its properties window, shown below.</p>
<p class=label>
<b>UserConnection Properties Connection tab</b></p>
<p>
<img src="avc03004.gif" border=0></p>
<p>
The UserConnection properties window has three tabs: Connection, Authentication, and Miscellaneous.</p>
<h3>Connection Properties</h3>
<p>
The Connection properties are used to establish connections to the server during design time (for retrieving a list of available stored procedures) and is also persisted in the new UserConnection object so that you don't have to specify connection information when the class is created at run time. This connection information is just the data source name (or, if you select Use DSN-less Connection String, the driver and server name) along with any special connection tokens specified in the "Other ODBC Attributes" box.</p>
<p>
The Use ODBC Datasource box displays all DSNs on the current computer. You can also define a new DSN by clicking on the New button.</p>
<h3>Authentication Properties</h3>
<p>
The authentication tab contains information needed for connecting to the data source specified in the connection information tab. These properties of the connection may or may not be persisted with the new connection object, depending on the setting of the check boxes at the bottom of the page. See "Persistence of Authentication" below for more details.</p>
<p class=label>
<b>Authentication tab</b></p>
<p>
<img src="avc03005.gif" border=0></p>
<p>
The user name and password text boxes are self-explanatory. The password box displays asterisks as the password is entered.</p>
<p>
The Prompt Behavior box allows you to choose the prompt behavior for the rdoConnection object.</p>
<h3>Persistence of Authentication</h3>
<p>
Due to concerns about security and password protection, there are two levels of persistence available for the UserConnection object's authentication properties. By default both of these levels are turned off, so that no caching or persistence of authentication properties occurs.</p>
<p>
If Save Connection Information for new Run-Mode Class is checked, the user name and password properties are stored in the properties of the actual class and are persisted in the built executable or DLL.</p>
<p>
If Save Connection Information for Design Time is checked, the user name and password properties persist only during design-time, and are not written into the built .exe or .dll file.</p>
<h3>Miscellaneous Properties</h3>
<p>
The last tab on the connection property page allows the developer to adjust the Timeout properties and cursor library for the new UserConnection class.</p>
<p class=label>
<b>Miscellaneous Properties</b></p>
<p>
<img src="avc03006.gif" border=0></p>
<p>
The Logon Timeout and Query Timeout values can be set to any values allowed in RDO 2.0.</p>
<p>
The Cursor Driver combo box contains options that map to the RDO constants for the "CursorDriver" property.</p>
<h2>The UserConnection designer form</h2>
<p>
After entering the properties to establish an ODBC connection for your UserConnection object, click OK to close the properties window. The new object appears in the main UserConnection form.</p>
<p class=label>
<b>The UserConnection Form</b></p>
<p>
<img src="avc03007.gif" border=0></p>
<p>
The toolbar buttons at the top of the form allow you to add single or multiple queries, delete queries, examine or change query properties, and change global options for the UserConnection designer.</p>
</BODY>
</HTML>
