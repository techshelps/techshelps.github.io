<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Aggregates</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconaggregates"></a>Aggregates</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconAggregates_C">
</object></p>
<p>
An aggregate is a special type of Field object that you can use to have data automatically calculated based on a hierarchy of Command objects. You can define an aggregate on any relation or grouped-based hierarchy. Each aggregate you define adds a new Field object to the current Command object. At <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defruntime">
</object><a href=JavaScript:alink_2.Click()>run time</a>, you can access the calculated data just like any other field.</p>
<p>
In addition, you can create a Grand Total Aggregate, which can be used on any top-level Command object to calculate its values. When a Grand Total Aggregate is created, a new Command object is created as the parent of the Command object on which the calculated values are based. Thus, the existing Command object becomes a child Command object and is referenced through a field in the parent Command object.</p>
<p>
For example, if an aggregate is based on the CustID field, you can obtain the total number of orders for each customer. This is illustrated by the following figure.</p>
<p>
<img src="vb533s1.gif" border=0></p>
<p>
The aggregate can be based any of the operations in the following table.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=21%><b>Operation</b></td>
<td class=label width=79%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=21%><b>Any</b></td>
<td width=79%>Returns one of the values from the rows of the selected field.</td>
</tr>
<tr valign=top>
<td width=21%><b>Average</b></td>
<td width=79%>Returns the average of the values of the selected field.</td>
</tr>
<tr valign=top>
<td width=21%><b>Count</b></td>
<td width=79%>Returns the count of the number of records of the selected field.</td>
</tr>
<tr valign=top>
<td width=21%><b>Maximum</b></td>
<td width=79%>Returns the highest value of the selected field.</td>
</tr>
<tr valign=top>
<td width=21%><b>Minimum</b></td>
<td width=79%>Returns the smallest value of the selected field.</td>
</tr>
<tr valign=top>
<td width=21%><b>Standard Deviation</b></td>
<td width=79%>Returns the standard deviation of the selected field.</td>
</tr>
<tr valign=top>
<td width=21%><b>Sum</b></td>
<td width=79%>Returns the sum of all the values of the selected field.</td>
</tr>
</table><br>
<p class=label>
<b>To create an aggregate within a Command hierarchy</b>
<ol>
<li>
Right-click any Command object and select <b>Properties</b> from the shortcut menu. (To create an aggregate other than a Grand Total, the Command object must have a child or be grouped.) The <b>Command Properties</b> dialog box appears.<br><br></li>
<li>
Click the <b>Aggregates </b>tab. The <b>Aggregates </b>frame lists all currently defined aggregates.<br><br></li>
<li>
Click <b>Add</b> to add an aggregate to the <b>Aggregates </b>box.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;To delete an aggregate from the <b>Aggregates </b>box, select the aggregate to delete, and then click <b>Remove</b>.</p></li>
<li>
Specify the <b>Aggregate Settings </b>information, as follows:<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=23%><b>Item</b></td>
<td class=label width=77%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=23%><b>Name</b></td>
<td width=77%>The name of the Field object that will be added to the Command object. At <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defruntime">
</object><a href=JavaScript:alink_3.Click()>run time</a>, this field will contain the calculated aggregate value.<p>
You can change this to a more meaningful, unique name that describes the aggregate. For example, if you are creating an aggregate that provides the average number of items on each order, an appropriate name may be AverageOrderNumber.</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>Function</b></td>
<td width=77%>Select the operation to associate with the aggregate: Any, Average, Count, Maximum, Minimum, Standard Deviation, or Sum, as described above.</td>
</tr>
<tr valign=top>
<td width=23%><b>Aggregate&nbsp;On</b></td>
<td width=77%>Select a grouping, a child Command object, or <b>Grand Total</b> from the drop-down list. The selected item is what the aggregate is based upon.<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;<b>Grand Total</b> is only available on top-level Command objects. Choosing <b>Grand Total</b> implies that an additional Command object will be created to provide a grand total of your data.</p>
</td>
</tr>
<tr valign=top>
<td width=23%><b>Field</b></td>
<td width=77%>Choose a Field object on which to base the aggregate. For example, if the aggregate is to provide the average number of orders, specify the field that contains the quantity of orders.</td>
</tr>
<tr valign=top>
<td width=23%><b>Name</b></td>
<td width=77%>If you have selected <b>Grand Total</b> in the <b>Aggregate On</b> box, specify a name for the <b>Grand Total Command</b>. If <b>Grand Total</b> is not selected, this option is disabled. Once created, the <b>Grand Total Name</b> displays as the name of a new top-level Command object within the Data Environment.<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The <b>Grand Total Name</b> can be the same as the <b>Aggregate Name</b>.</p>
</td>
</tr>
</table><br>
</li>
<li>
Click <b>OK</b> to save the aggregate definition and close the dialog box. The aggregate appears as a Field object of the selected Command object in the Data Environment outline view.</li>
</ol>
</BODY>
</HTML>
