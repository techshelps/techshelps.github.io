<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying Open and Save As Dialog Boxes</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbcondisplayingopensaveasdialogboxes"></a>Displaying Open and Save As Dialog Boxes</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconDisplayingOpenSaveAsDialogBoxesC">
</object></p>
<p>
The Open dialog box allows the user to specify a drive, a directory, a file name extension, and a file name.</p>
<p>
The Save As dialog box is identical to the Open dialog in appearance, except for the dialog's caption, and file names appearing dimmed out. At run time, when the user chooses a file and closes the dialog box, the FileName property is used to get the selected file name.</p>
<p class=label>
<b>Figure 7.12&nbsp;&nbsp;&nbsp;An Open dialog box</b></p>
<p>
<img src="avp07027.gif" border=0></p>
<p class=label>
<b>To display the Open dialog box</b>
<ol>
<li>
Specify the list of file filters that are displayed in the <b>Files of type</b> list box.<p class=tl>
You can do this by setting the Filter property using the following format:</P><p class=tl>
<i>description1</i> | <i>filter1</i> | <i>description2</i> | <i>filter2</i>...</P><p class=tl>
<i>Description</i> is the string displayed in the list box — for example, "Text Files (*.txt)." <i>Filter</i> is the actual file filter — for example, "*.txt." Each <br>
<i>description</i> | <i>filter</i> set must be separated by a pipe symbol (|).</P></li>
<li>
Use the ShowOpen method to display the dialog box.</li>
</ol>
<p>
After the user chooses a file, use the FileName property to get the name of the selected file.</p>
<p>
With all the common dialog boxes, when the CancelError property is True, an error is generated when the user clicks the dialog box's Cancel button. You detect that the Cancel button was pressed by trapping the error when the dialog box is displayed.</p>
<p>
The following code displays an Open dialog box and uses the selected file name as an argument to a procedure that opens a file:</p>
<pre><code>Private Sub mnuFileOpen_Click ()
   ' CancelError is True.
   On Error GoTo ErrHandler
   ' Set filters.
   CommonDialog1.Filter = "All Files (*.*)|*.*|Text _
   Files (*.txt)|*.txt|Batch Files (*.bat)|*.bat"
   ' Specify default filter.
   CommonDialog1.FilterIndex = 2

   ' Display the Open dialog box.
   CommonDialog1.ShowOpen 
   ' Call the open file procedure.
   OpenFile (CommonDialog1.FileName)
   Exit Sub

ErrHandler:
' User pressed Cancel button.
   Exit Sub
End Sub
</code></pre>
</BODY>
</HTML>
