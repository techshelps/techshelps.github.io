<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the StatusBar Control</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconusingstatusbarcontrol"></a>Using the StatusBar Control</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconUsingStatusBarControlC">
</object></p>
<p>
A StatusBar control is a frame that can consist of several panels which inform the user of the status of an application. The control can hold up to sixteen frames. Additionally, the control has a "simple" style (set with the Style property), which switches from multi-panels to a single panel for special messages.</p>
<p>
The StatusBar control can be placed at the top, bottom, or sides of an application. Optionally, the control can "float" within the application's client area.</p>
<h2>Possible Uses</h2>
<ul type=disc>
<li>
To inform the user of a database table's metrics, such as number of records, and the present position in the database.<br><br></li>
<li>
To give the user information about a RichTextBox control's text and font status.<br><br></li>
<li>
To give status about key states (such as the Caps Lock or the Number Lock).</li>
</ul>
<h2>The Panel Object and the Panels Collection</h2>
<p>
The StatusBar control is built around the Panels collection. Up to sixteen Panel objects can be contained in the collection. Each object can display an image and text, as shown below:</p>
<p>
<img src="avtct062.gif" border=0></p>
<p>
At run time, you can dynamically change the text, images, or widths of any Panel object, using the Text, Picture and Width properties. To add Panel objects at design time, right-click on the control, and click on Properties to display the Property Pages dialog box, as shown in Figure 2.26 below:</p>
<p class=label>
<b>Figure 2.26&nbsp;&nbsp;&nbsp;StatusBar panels page</b></p>
<p>
<img src="avtct063.gif" border=0></p>
<p>
Using this dialog box, you can add individual Panel objects and set the various properties for each panel.</p>
<h2>Use the Set Statement with the Add Method to Create Panels at Run Time</h2>
<p>
To add Panel objects at run time, use the Set statement with the Add method. First declare an object variable of type Panel, then set the object variable to a Panel created with the Add method, as shown in the code below:</p>
<pre><code>' The StatusBar control is named "sbrDB."
Dim pnlX As Panel
Set pnlX = sbrDB.Panels.Add()
</code></pre>
<p>
Once you have created a Panel object and set the object variable to reference the new object, you can set the various properties of the Panel:</p>
<pre><code>pnlX.Text = Drive1.Drive 
pnlX.Picture = LoadPicture("mapnet.bmp")
pnlX.Key = "drive"
</code></pre>
<p>
If you plan to have the control respond when the user clicks on a particular Panel object, be sure to set the Key property. Because the Key property must be unique, you can use it to identify particular panels.</p>
<h2>Use the Select Case Statement in the PanelClick Event to Determine the Clicked Panel</h2>
<p>
To program the StatusBar control to respond to user clicks, use the Select Case statement within the PanelClick event. The event contains an argument (the <i>panel </i>argument) which passes a reference to the clicked Panel object. Using this reference, you can determine the Key property of the clicked panel, and program accordingly, as shown in the code below:</p>
<pre><code>Private Sub sbrDB_PanelClick(ByVal Panel As Panel)
   Select Case Panel.Key
   Case "drive"
      Panel.Text = Drive1.Drive
   Case "openDB"
      Panel.Text = rsOpenDB.Name
   Case Else
   ' Handle other cases.
   End Select
End Sub
</code></pre>
<h2>The Style Property: Automatic Status Functions</h2>
<p>
One feature of the StatusBar control is its ability to display key states, time, and date with a minimum of code. By simply setting the Style property, any Panel object can display one of the following:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=20%><b>Constant</b></td>
<td class=label width=15%><b>Value</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=20%>sbrText</td>
<td width=15%>0</td>
<td width=65%>(Default). Text and/or a bitmap. Set text with the Text property.</td>
</tr>
<tr valign=top>
<td width=20%>sbrCaps</td>
<td width=15%>1</td>
<td width=65%>Caps Lock key. Displays the letters CAPS in bold when Caps Lock is enabled, and dimmed when disabled.</td>
</tr>
<tr valign=top>
<td width=20%>sbrNum</td>
<td width=15%>2</td>
<td width=65%>Number Lock. Displays the letters NUM in bold when the number lock key is enabled, and dimmed when disabled.</td>
</tr>
<tr valign=top>
<td width=20%>sbrIns</td>
<td width=15%>3</td>
<td width=65%>Insert key. Displays the letters INS in bold when the insert key is enabled, and dimmed when disabled.</td>
</tr>
<tr valign=top>
<td width=20%>sbrScrl</td>
<td width=15%>4</td>
<td width=65%>Scroll Lock key. Displays the letters SCRL in bold when scroll lock is enabled, and dimmed when disabled.</td>
</tr>
<tr valign=top>
<td width=20%>sbrTime</td>
<td width=15%>5</td>
<td width=65%>Time. Displays the current time in the system format.</td>
</tr>
<tr valign=top>
<td width=20%>sbrDate</td>
<td width=15%>6</td>
<td width=65%>Date. Displays the current date in the system format.</td>
</tr>
<tr valign=top>
<td width=20%>sbrKana</td>
<td width=15%>7</td>
<td width=65%>Kana. displays the letters KANA in bold when kana lock is enabled, and dimmed when disabled. (enabled on Japanese operating systems only)</td>
</tr>
</table><br>
<p>
The code below creates eight Panel objects, and assigns one of the eight styles to each:</p>
<pre><code>Private Sub MakeEight()
   ' Delete the first Panel object, which is
   ' created automatically.
   StatusBar1.Panels.Remove 1
   Dim i As Integer

   ' The fourth argument of the Add method 
   ' sets the Style property.
   For i = 0 To 7
      StatusBar1.Panels.Add , , , i
   Next i

   ' Put some text into the first panel.
   StatusBar1.Panels(1).Text = "Text Style"
End Sub
</code></pre>
<h2>Bevel, AutoSize, and Alignment Properties Program Appearance</h2>
<p>
Using the Bevel, AutoSize, and Alignment properties, you can precisely control the appearance of each Panel object. The Bevel property specifies whether the Panel object will have an inset bevel (the default), raised, or none at all. All three bevels are shown in the figure below:</p>
<p>
<img src="avtct064.gif" border=0></p>
<p>
Settings for the Bevel property are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=20%><b>Constant</b></td>
<td class=label width=12%><b>Value</b></td>
<td class=label width=68%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=20%>sbrNoBevel</td>
<td width=12%>0</td>
<td width=68%>The Panel displays no bevel, and text looks like it is displayed right on the status bar.</td>
</tr>
<tr valign=top>
<td width=20%>sbrInset</td>
<td width=12%>1</td>
<td width=68%>The Panel appears to be sunk into the status bar.</td>
</tr>
<tr valign=top>
<td width=20%>sbrRaised</td>
<td width=12%>2</td>
<td width=68%>The Panel appears to be raised above the status bar.</td>
</tr>
</table><br>
<p>
The AutoSize property determines how a Panel object will size itself when the parent container (either a Form or a container control) is resized by the user. The figure below shows a StatusBar control before being resized:</p>
<p>
<img src="avtct065.gif" border=0></p>
<p>
When the <i>container</i> (the Form on which the StatusBar control is placed) of the control is resized, notice that the first panel retains its width, the second "springs" to fill the extra space, and the third sizes according to its contents (and therefore retains its width):</p>
<p>
<img src="avtct066.gif" border=0></p>
<p>
Settings for the AutoSize property are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=23%><b>Constant</b></td>
<td class=label width=14%><b>Value</b></td>
<td class=label width=63%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=23%>sbrNoAutoSize</td>
<td width=14%>0</td>
<td width=63%>None. No autosizing occurs. The width of the panel is always and exactly that specified by the Width property.</td>
</tr>
<tr valign=top>
<td width=23%>sbrSpring</td>
<td width=14%>1</td>
<td width=63%>Spring. When the parent form resizes and there is extra space available, all panels with this setting divide the space and grow accordingly. However, the panels' width never falls below that specified by the MinWidth property.</td>
</tr>
<tr valign=top>
<td width=23%>sbrContents</td>
<td width=14%>2</td>
<td width=63%>Content. The panel is resized to fit its contents.</td>
</tr>
</table><br>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;Set the AutoSize property to Content (2) when you want to assure that the contents of a particular panel are always visible.</p>
<p>
The Alignment property specifies how the text in a panel will align relative to the panel itself as well as any image in the panel. As with a word processor, the text can be aligned left, center, or right, as shown below:</p>
<p>
<img src="avtct067.gif" border=0></p>
<p>
Settings for the Alignment property are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=17%><b>Constant</b></td>
<td class=label width=13%><b>Value</b></td>
<td class=label width=70%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=17%>sbrLeft</td>
<td width=13%>0</td>
<td width=70%>Text appears left-justified and to right of bitmap.</td>
</tr>
<tr valign=top>
<td width=17%>sbrCenter</td>
<td width=13%>1</td>
<td width=70%>Text appears centered and to right of bitmap.</td>
</tr>
<tr valign=top>
<td width=17%>sbrRight</td>
<td width=13%>2</td>
<td width=70%>Text appears right-justified but to the left of any bitmap.</td>
</tr>
</table><br>
<h2>Style Property and the SimpleText Property</h2>
<p>
The StatusBar control features a secondary mode in which the multiple panels are replaced by a single panel that spans the width of the control. This single panel has one property, the SimpleText property which specifies what text is displayed on the panel. To display this single panel, set the Style property of the StatusBar to sbrSimple (1).</p>
<p>
One reason for switching to the Simple style and displaying a single panel is to notify the user that a lengthy transaction is occurring. For example, if you are performing a database operation, the Simple style may be used to notify the user of the current state of the transaction, as seen in the code below:</p>
<pre><code>Private Sub GetRecords(State)
   ' The query finds all records which match
   ' the parameter State. While the query 
   ' is creating the recordset, show the
   ' SimpleText on the StatusBar control.
   sbrDB.SimpleText = "Getting records …"
   sbrDB.Style = sbrSimple ' Simple style.
   sbrDB.Refresh    ' You must refresh to see the 
                  ' Simple text.

   Set rsNames = mDbBiblio.OpenRecordset _
   ("select * from Names Where State= " &amp; _
   State)
End Sub
</code></pre>
</BODY>
</HTML>
