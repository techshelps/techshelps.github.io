<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Automated Teller Machine Sample Application</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbconatmsamapp"></a>The Automated Teller Machine Sample Application</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbconATMSamAppC">
</object></p>
<p>
This sample application has been designed to illustrate support for resource files in Visual Basic. The application contains three forms, a standard module, and a resource file. When you run the Automated Teller Machine (Atm.vbp) sample application, an opening screen lets you perform a bank transaction in one of several languages, including German, French, Italian, and Spanish.</p>
<p>
The following code from the FrmInput.frm file loads resources stored in the Atm32.res file, which contains the localized strings for all languages.</p>
<pre><code>Sub Form_Load()
   imgFlag = LoadResPicture(I, vbResBitmap)
   Caption = LoadResString(I)
   lblPINCode = LoadResString(1 + I)
   fraAccount = LoadResString(2 + I)
   optChecking.Caption = LoadResString(3 + I)
   optSavings.Caption = LoadResString(4 + I)
   lblAmount = LoadResString(5 + I)
   cmdOK.Caption = LoadResString(6 + I)
   SetCursor cmdOK
End Sub

Sub cmdOK_click()
   ' Display a process message.
   MsgBox LoadResString(7 + I)
   frmAmountWithdrawn.Show vbModal
   Unload Me
End Sub
</code></pre>
<p>
At run time, this code reads the appropriate section of the resource file, based on an offset that is initialized when the user makes a language selection in the opening screen. The <i>offset</i> is a public variable declared in the standard module that indicates how far from a starting point a particular item is located. In the ATM sample application, the offset variable is <code>I</code>.</p>
<p>
In the resource file, resource identifiers 16 through 47 are reserved for English, 48 through 79 are reserved for French, 80 through 111 are reserved for German, and so on. Each language contains the localized entries that make up the data block of the sample application. This block currently contains the eleven resources that are particular to each language.</p>
<p>
This sample application, which contains several data blocks, introduces an alternative to a language-specific resource file using only one data block. Depending on the nature of the application you are developing, you may consider using one resource file per language version of your application or a single resource file containing all the localized data blocks.</p>
<p>
The design of the Automated Teller Machine sample application presents several advantages beyond the ones outlined earlier in the chapter:
<ul type=disc>
<li>
The application can grow in scope by providing service in more languages. Simply add the same data block to the resource file and localize it as needed. If you decide to add a language, you may have to add a button to the opening screen.<br><br></li>
<li>
The application can grow in size if you want to extend your application by, for instance, allowing the ATM users to make deposits. Simply allow for wider identifier ranges (160 for example) for each language in the resource file. Currently, the identifiers range from 16 to 47, 48 to 79, and so on.</li>
</ul>
<p>
<B><b>For More Information</b></B>&nbsp;&nbsp;&nbsp;See "LoadResString Function," "LoadResPicture Function," and "LoadResData Function" in the <i>Language Reference</i>. For information on resource files, see "Working with Resource Files" in "More About Programming" and "Designing for Performance and Compatibility."</p>
</BODY>
</HTML>
