<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ButtonMenu Object, ButtonMenuClick Event Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtbuttonmenuobjectclickeventx"></a>ButtonMenu Object, ButtonMenuClick Event Example</h1>
<p>
The example adds five <b>Button</b> objects to a <b>Toolbar</b> control and also adds two <b>ButtonMenu</b> objects to each <b>Button</b> object. When a ButtonMenu object is clicked, the ButtonMenuClick event is used to determine its behavior. To try the example, place a Toolbar control on a form and paste the code into the Declarations section of the code module.</p>
<pre><code>Option Explicit

Private Sub Form_Load()
   Dim i As Integer
   Dim btn As Button
   
   ' Add five Button objects to the Toolbar control.
   For i = 1 To 5
      Set btn = Toolbar1.Buttons.Add(Caption:= i, Style:= tbrDropDown)
      ' Add two ButtonMenu objects to each Button.
         btn.ButtonMenus.Add Text:="Help"
         btn.ButtonMenus.Add Text:="Options"
   Next i
End Sub

Private Sub Toolbar1_<span class=cfe><b>ButtonMenuClick</b></span>(ByVal ButtonMenu As ComctlLib.ButtonMenu)
   Select Case ButtonMenu.Index
   Case 1
      MsgBox "Press the button."
   Case 2
      MsgBox "Offer some option"
   End Select
End Sub</code></pre>
</BODY>
</HTML>
