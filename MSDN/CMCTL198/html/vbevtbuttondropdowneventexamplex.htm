<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ButtonDropDown Event Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtbuttondropdowneventexamplex"></a>ButtonDropDown Event Example</h1>
<p>
The example below returns all of the menu items in a <b>ButtonMenus </b>collection. To try the example, draw a <b>Toolbar </b>control on a form, and paste the code into the Declarations section. Run the project and click the button menus.</p>
<pre><code>Private Sub Toolbar1_<span class=cfe><b>ButtonDropDown</b></span>(ByVal Button As ComctlLib.Button)
   ' Hide a ButtonMenu based on the index of the Button.
   Select Case Button.Index
   Case 1
      Button.ButtonMenus(1).Visible = False
   Case 2
      Button.ButtonMenus(2).Visible = False
   Case 3
      Button.ButtonMenus(3).Visible = False
   End Select
End Sub

Private Sub Form_Load()
   Dim btn As Button
   Dim i As Integer
   Dim j As Integer
   ' Add three buttons to the Toolbar. For each button, add three
   ' menu items to the ButtonMenus collection.
   For i = 1 To 3
      Set btn = Toolbar1.Buttons.Add(, , "button " &amp; i, tbrDropdown)
      For j = 1 To 3
         btn.ButtonMenus.Add , , "button " &amp; i &amp; " menuitem " &amp; j
      Next j
   Next i
End Sub</code></pre>
</BODY>
</HTML>
