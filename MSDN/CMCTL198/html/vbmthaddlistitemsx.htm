<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Method (ListItems, ColumnHeaders), SubItems Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbmthaddlistitemsx"></a>Add Method (ListItems, ColumnHeaders), ListItems Property, SubItems Property Example</h1>
<p>
The following example uses the Biblio.mdb database as a source to populate a <b>ListView</b> control with <b>ListItem</b> objects. To try this example, place a <b>ListView</b> control on a form and paste the code into the Declarations section. You must also be sure that the Biblio.mdb has been installed on your machine. In the code below, check the path in the <b>OpenDatabase</b> function and change it to reflect the actual path to Biblio.mdb on your machine.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The example will not run unless you add a reference to the Microsoft DAO 3.5 Object Library. To do this, on the <b>Project</b> menu click <b>References</b>. Search for Microsoft DAO 3.5 Object Library and click the checkbox to select it.</p>
<pre><code>Private Sub Form_Load()
   ' Add ColumnHeaders. The width of the columns is 
   ' the width of the control divided by the number of 
   ' ColumnHeader objects.
   ListView1.ColumnHeaders. _
   <span class=cfe><b>Add </b></span>, , "Author", ListView1.Width / 3
   ListView1.ColumnHeaders. _
   <span class=cfe><b>Add </b></span>, , "Author ID", ListView1.Width / 3, _
   lvwColumnCenter
   ListView1.ColumnHeaders. _
   <span class=cfe><b>Add </b></span>, , "Birthdate", ListView1.Width / 3
   ' Set View property to Report.
   ListView1.View = lvwReport 

   ' Declare object variables for the 
   ' Data Access objects.
   Dim myDb As Database, myRs As Recordset
   ' Set the Database to the BIBLIO.MDB database.
   ' IMPORTANT: the Biblio.mdb must be on your
   ' machine, and you must set the correct path to
   ' the file in the OpenDatabase function below.
   Set myDb =    DBEngine.Workspaces(0) _
      .OpenDatabase("c:\Program Files\VB\BIBLIO.MDB")
   ' Set the recordset to the "Authors" table.
   Set myRs = _
   myDb.OpenRecordset("Authors", dbOpenDynaset)
   
   ' Declare a variable to add ListItem objects.
   Dim itmX As ListItem

   ' While the record is not the last record, 
   ' add a ListItem object. Use the author field for 
   ' the ListItem object's text. Use the AuthorID 
   ' field for the ListItem object's SubItem(1).
   ' Use the "Year of Birth" field for the ListItem 
   ' object's SubItem(2).

   While Not myRs.EOF
      Set itmX = ListView1.ListItems. _
      <span class=cfe><b>Add</b></span>(, , CStr(myRs!Author))   ' Author.
      
      ' If the AuthorID field is not null, then set 
      ' SubItem 1 to it.
      If Not IsNull(myRs!Au_id) Then
         itmX.SubItems(1) = CStr(myRs!Au_id)
      End If

      ' If the birth field is not Null, set 
      ' SubItem 2 to it.
      If Not IsNull(myRs![Year Born]) Then
         itmX.SubItems(2) = myRs![Year Born]
      End If
      myRs.MoveNext   ' Move to next record.
   Wend
End Sub
</code></pre>
</BODY>
</HTML>
