<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ListSubItem Object,  ListSubItems Collection Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbprolistsubitemobjectcollectionx"></a>ListSubItem Object,&nbsp; ListSubItems Collection Example</h1>
<p>
The example creates twenty <b>ListItem </b>objects; for each object, four <b>ListSubItem </b>objects are also created. Before creating <b>ListSubItem </b>objects, however, the code creates five <b>ColumnHeader </b>objects—one for the <b>ListItem </b>object, and four for the <b>ListSubItem </b>objects. To try the example, place a <b>ListView </b>control on a form and paste the code into the Declarations section of the code.</p>
<pre><code>Option Explicit

Private Sub Form_Load()
   Dim i As Integer ' Counter
   Dim j As Integer ' Counter for ListSubItems
   Dim sngWidth As Single
   Dim si As ListSubItem
   Dim li As ListItem

   ' You can't see ColumnHeaders or ListSubitems
   ' unless the View is set to lvwReport.
   ListView1.View = lvwReport

   ' Calculate the width of a ColumnHeader object.
   sngWidth = ListView1.Width / 5

   ' Create five ColumnHeader objects.
   For i = 1 To 5
      ListView1.ColumnHeaders.Add Text:="Col " &amp; i, Width:=sngWidth
   Next i
   
   ' Create twenty ListItem objects. For each ListItem, create four 
   ' ListSubItem objects. Set the ForeColor for each object to red.
   For i = 1 To 20
      Set li = ListView1.ListItems.Add(Text:="Item " &amp; i)
      For j = 1 To 4 
         Set si = li.ListSubItems.Add(Text:="Subitem " &amp; j)
         si.ForeColor = vbRed
      Next j
   Next i
End Sub
</code></pre>
</BODY>
</HTML>
