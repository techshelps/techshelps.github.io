<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registry Keys That Are Important for Policy</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_zaw_registry_keys_that_are_important_for_policy"></a>Registry Keys That Are Important for Policy</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Developers should make sure that their applications check various registry keys if the applications expose any functionality controlled by settings of certain registry keys. </p>
<p>
If a registry key is applicable to functionality that an application exposes, the application should take the following steps:
<ul>
<li>
Check the registry at startup for the settings of the relevant key.</li>
<li>
At startup, remove from the user interface access to functionality that the registry key indicates should be disabled.</li>
<li>
Immediately before exposing the functionality, check the registry again, and fail gracefully if the functionality has been disabled since startup.</li>
</ul>
<p>
When spawning another process, an application does not have to check that the new process is permitted as long as it uses <b>ShellExecute</b> to spawn the application in question rather than <b>CreateProcess</b>. If <b>ShellExecute</b> is used, the shell checks that the executable being spawned is allowed.</p>
<p>
The following keys are particularly important for implementation of system policies in enterprise environments:</p>
<p>
HKEY_CURRENT_USER\<br>
&nbsp;&nbsp;Software\<br>
&nbsp;&nbsp;&nbsp;&nbsp;Microsoft\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Windows\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentVersion\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Policies\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System\</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=33%><pre><code>DisableRegistryTools</code></pre>
</td>
<td width=67%>Disable registry editing tools.</td>
</tr>
<tr valign=top>
<td width=33%><pre><code>DisableTaskMgr</code></pre>
</td>
<td width=67%>Disable Task Manager.</td>
</tr>
<tr valign=top>
<td width=33%><pre><code>NoDispAppearancePage</code></pre>
</td>
<td width=67%>Hide Control Panel <b>Appearance</b> tab.</td>
</tr>
<tr valign=top>
<td width=33%><pre><code>NoDispBackgroundPage</code></pre>
</td>
<td width=67%>Hide Control Panel <b>Background</b> tab.</td>
</tr>
<tr valign=top>
<td width=33%><pre><code>NoDispCPL</code></pre>
</td>
<td width=67%>Do not display Control Panel.</td>
</tr>
<tr valign=top>
<td width=33%><pre><code>NoDispScrSavPage</code></pre>
</td>
<td width=67%>Hide Control Panel <b>Screen Saver</b> tab.</td>
</tr>
<tr valign=top>
<td width=33%><pre><code>NoDispSettingsPage</code></pre>
</td>
<td width=67%>Hide Control Panel <b>Settings</b> tab.</td>
</tr>
</table><br>
<p>
HKEY_CURRENT_USER\<br>
&nbsp;&nbsp;Software\<br>
&nbsp;&nbsp;&nbsp;&nbsp;Microsoft\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Windows\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentVersion\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Policies\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Explorer\</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=45%><pre><code>EnforceShellExtensionSecurity</code></pre>
</td>
<td width=55%>Run only certain shell extensions.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>LinkResolveIgnoreLinkInfo</code></pre>
</td>
<td width=55%>Disable link file tracking.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoClose</code></pre>
</td>
<td width=55%>Disable the Shut Down option on the Start menu.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoCommonGroups</code></pre>
</td>
<td width=55%>Do not display common groups in Start menu, Programs.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoDesktop</code></pre>
</td>
<td width=55%>Hide all items on the desktop.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoDrives</code></pre>
</td>
<td width=55%>Remove the drive icons in My Computer.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoEntireNetwork</code></pre>
</td>
<td width=55%>Do not display the entire network in Network Neighborhood.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoFileMenu</code></pre>
</td>
<td width=55%>Remove the File menu from the Windows® Explorer toolbar.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoFind</code></pre>
</td>
<td width=55%>Remove the Find command from the Start menu.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoNetConnectDisconnect</code></pre>
</td>
<td width=55%>Remove the Map Network Drive and Disconnect Network Drive buttons and menu options.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoNetHood</code></pre>
</td>
<td width=55%>Remove the Network Neighborhood icon from the desktop.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoRun</code></pre>
</td>
<td width=55%>Remove the Run command from the Start menu.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoSaveSettings</code></pre>
</td>
<td width=55%>Do not save settings on exit.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoSetFolders</code></pre>
</td>
<td width=55%>Remove Control Panel and Printer folders from the Start, Settings menu.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoSetTaskbar</code></pre>
</td>
<td width=55%>Remove the Taskbar from the Start, Settings menu.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoStartMenuSubFolders</code></pre>
</td>
<td width=55%>Hide all Start menu subfolders.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoTrayContextMenu</code></pre>
</td>
<td width=55%>Disable context menus on the taskbar.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoViewContextMenu</code></pre>
</td>
<td width=55%>Disable the Explorer default context menu.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>NoWorkgroupContents</code></pre>
</td>
<td width=55%>Do not display workgroup contents in Network Neighborhood.</td>
</tr>
<tr valign=top>
<td width=45%><pre><code>RestrictRun
&nbsp;&nbsp;\<i>[Index Numbers]</i></code></pre>
</td>
<td width=55%>Run only those Windows applications listed in the numbered keys under RestrictRun.</td>
</tr>
</table><br>
<p>
HKEY_LOCAL_MACHINE\<br>
&nbsp;&nbsp;Software\<br>
&nbsp;&nbsp;&nbsp;&nbsp;Microsoft\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Windows\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentVersion\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Run\</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=33%><pre><i><code>[Application Name]</code></i></pre>
</td>
<td width=67%>List of applications user may run when logging on interactively.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
