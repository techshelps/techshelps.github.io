<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Default Data Locations</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_zaw_default_data_locations"></a>Default Data Locations</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
For your application to work properly in a 32-bit enterprise environment, you must take care to store data in standard places. See the <b>Designed for Microsoft</b>®<b> Windows</b>®<b> </b>Logo requirements and recommendations at: 
<ul>
<li>
<a href="logo_6tlx.htm">Be Easy to Install and Remove</a> </li>
<li>
<a href="logo_1855.htm">Use the Registry Correctly</a> </li>
<li>
<a href="logo_1coj.htm">Save Data to the Best Locations</a> </li>
</ul>
<p>
The main things to keep in mind are:
<ul>
<li>
Use <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_msi_introduction_to_new_microsoft_installer_technology">
</object><a href=JavaScript:alink_1.Click()>new Microsoft installation and component management technology</a> to install application files as needed to the correct folders, and to let some components be accessed over a network or from a CD-ROM. Satisfying this <b>Designed for Microsoft</b>®<b> Windows</b>® Logo <a href="logo_1fax.htm">requirement</a> considerably eases the complexity of creating a good setup. Furthermore, applications installed using the new installer technology are generally much more reconstructable than applications that are not.</li>
<li>
Avoid DLL version conflicts. Except for operating system components, do not globally share DLLs. The small additional hard drive usage that this requires is more than compensated for by not running the risk of destabilizing your users' environments. The <b>Designed for Microsoft</b>®<b> Windows</b>® Logo guidelines strongly recommend the following:<ul>
<li>
<a href="logo_2ss3.htm">Do not write to Windows system directories</a>. (Recommended) </li>
<li>
<a href="logo_5nub.htm">Use Microsoft update packs to upgrade system components</a>. (Recommended) </li>
<li>
<a href="logo_5h4j.htm">Do not install globally shared DLLs</a>. (Recommended) </li>
</ul>
</li>
<li>
Store user settings in the registry, in the HKEY_CURRENT_USER hive, or, in the case of large blocks of user profile information, in the <b>Application Data</b> folder under the user's <b>Profile</b> folder. If you do need to use the <b>Application Data</b> folder, be sure to establish the same hierarchical structure that HKEY_CURRENT_USER has, namely:<p>
Application Data\<br>
&nbsp;&nbsp;Software\<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<i>company name</i>]\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<i>product name</i>]\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<i>version</i>]\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<i>your top level</i>]\
</li>
<li>
Do not assume that you know the names or locations of any of the standard folders, such as <b>My Documents</b> or <b>Application Data</b>, that you are going to use (for example, starting with Windows NT 5.0, the default name of the <b>Personal</b> folder has changed to <b>My Documents</b>). For all you know, your application might be running on a foreign-language version of Windows, or the user's profile folder might reside on a server instead of on a local hard drive. <p>
Rather than make any assumptions, call <b>SHGetSpecialFolderLocation</b> to obtain a path to standard folders, as explained in <a href="clean_2y0j.htm">Locating the Standard Folders Where Data Belongs</a>.
</li>
<li>
Use the improved <b>My Documents</b> folder (previously the <b>Personal</b> folder) to save all files created by users. "My Documents" is a collection of operating-system changes designed to help centralize local user data storage so as to ensure recoverability and improve discoverability.<p>
A <b>My Documents</b> folder now appears on every desktop (this is not to be confused with the <b>My Documents</b> folder created by Office 95). The Home directory defaults to this folder, and it appears by default in standard FileOpen/SaveAs dialog boxes if you initialize <b>lpstrInitialDir</b> to NULL or to the path to "My Documents". You can always locate it by calling <b>SHGetSpecialFolderLocation</b> with CSIDL_PERSONAL.
</li>
<li>
Support security by assuming that the file system is NTFS, locked down with Access Control Lists (ACLs), and that %UserProfile% and %Temp% are the only writeable locations.</li>
<li>
Hide extra program files and directories to present a simplified file system (use the hidden attribute).</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
