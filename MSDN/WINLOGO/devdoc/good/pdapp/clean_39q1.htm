<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Registry Properly</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_using_the_registry_properly"></a>Using the Registry Properly</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> 
<ul>
<li>
<b>Do not store hard-coded path names in the registry.</b> Use system environment variables wherever possible. This allows administrators to redirect components and remap drive letters. Important environment variables are:<dl>
<dt>
%UserProfile%\</dt>
<dt>
%Temp%\</dt>
<dt>
%ProgramFiles%\</dt>
<dt>
%SystemDrive%\</dt>
<dt>
%SystemRoot%\</dt>
<dd>
</dd>
</dl>
<p>
This is also a <a href="logo_66b7.htm">Designed for Windows Logo recommendation</a>.
</li>
<li>
<b>Register classes on a per-user basis.</b> On Microsoft® Windows NT® 5.0, be sure to register class information in HKEY_CURRENT_USER (in HKCU\Software\Classes). </li>
<li>
<b>Use the correct access mask when opening a registry key.</b> Use KEY_READ and KEY_WRITE rather than KEY_ALL_ACCESS.</li>
<li>
<b>Store user settings separately from computer settings.</b> User settings and computer settings are different. Computer settings do not vary from user to user. As a general rule, user settings should be recoverable, and computer settings reconstructable. <p>
Do not store a mixture of user information and computer information together, and definitely do not store them with the application binaries, where they will be lost if the computer fails. 
<p>
This is also a <a href="logo_8qcz.htm">Designed for Microsoft Windows Logo requirement</a>.
</li>
<li>
<b>Store small user setting data in HKEY_CURRENT_USER (HKCU).</b> </li>
<li>
<b>Store large user-profile data in the Application Data folder.</b> Store any user-profile information that is too large to be suitable for the registry in the Application Data folder of the user's Profile. Get the path to this folder by calling <b>SHGetSpecialFolderLocation</b> with CSIDL_APPDATA. <p>
For more information, see the applicable <a href="logo_92nm.htm">Designed for Windows Logo recommendation</a>.
</li>
<li>
<b>Store hardware-independent computer settings in HKLM.</b> Installed hardware can change, whether by docking and undocking, computer replacement, presence or absence of portable peripherals, and so forth. HKEY_LOCAL_MACHINE should contain static information that has to do with the logical computer in the context of the enterprise, as opposed to an actual physical configuration of that computer.</li>
<li>
<b>Store hardware-dependent computer settings in HKCC</b>. HKEY_CURRENT_CONFIG is the place to store all hardware-related data about the computer's configuration.</li>
<li>
<b>Do not assume that HKEY_CURRENT_USER is initialized.</b> In a multi-user environment an application can be installed on a computer without setup having had an opportunity to initialize HKEY_CURRENT_USER (HKCU) for the user who starts the application. Supply a reasonable default value for each user setting, and use it if the corresponding registry key is not present in HKCU. This is also a <a href="logo_2yhw.htm">logo recommendation</a>.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
