<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using ControlWizard to Create Custom Control Code</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana, arial, helvetica" size="2"><h1><a name="usingcontrolwizardtocreatecustomcontrolcode"></a>Using ControlWizard to Create Custom Control Code</h1>
<p>
The first step in creating the LISTER.OCX is to use Visual C++&#39;s ControlWizard to create a skeleton version of all the support files we&#39;ll need, just as AppWizard creates skeletal support files for EXE programs. To create LISTER, select the New item in Visual C++&#39;s File menu and then select Project Workspace. Next, select the OLE ControlWizard option, as shown in Figure 9.1.</p>
<p>
<img src="fig09-01.gif" border=0></p>
<p>
<b>Figure 9.1&nbsp;Visual C++&#39;s ControlWizard.</b></p>
<p>
We&#39;ll base the LISTER control on the standard List Box control so that we&#39;ll have all the functionality of a listbox. (But note that you need not base your custom control on any preexisting control type.) In ClassWizard&#39;s step 2 box, select LISTBOX as the type of control our control should subclass, as shown in Figure 9.2.</p>
<p>
<img src="fig09-02.gif" border=0></p>
<p>
<b>Figure 9.2&nbsp;ControlWizard&#39;s Control Options box.</b></p>
<p>
This selection indicates to ControlWizard that we want to base our new control on the listbox type. Now click OK in the Control Options box and Finish in ControlWizard to create the support files for LISTER.OCX.</p>
<p>
At this point, ControlWizard creates the new project, including these important files:
<ul>
<li>
LISTER.MAK: The project file<br><br></li>
<li>
LISTER.CPP: OLE DLL initialization, termination, other bookkeeping<br><br></li>
<li>
LISTERCTL.CPP: Main implementation file (CListerCtrl class)<br><br></li>
<li>
LISTERPPG.CPP: Implementation of the CListerPropPage property page class<br><br></li>
<li>
LISTER.ODL: Object Description Language source code for the type library<p>
Let&#39;s take a moment to examine some of the files created by ControlWizard.
</li>
</ul>
<h1></h1>
</font></BODY>
</HTML>
