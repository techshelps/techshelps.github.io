<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Grid Control in Detail</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana, arial, helvetica" size="2"><h1><a name="thegridcontrolindetail"></a>The Grid Control in Detail</h1>
<p>
The grid control presents us with a spreadsheet-like display, and we can place text and graphics in each cell. Let&#39;s assume that we have a grid control in our Web page like this:</p>
<pre><code>
	-----------------------------------------------
          |           _____________________________       |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
          |          |_____|_____|_____|_____|_____|      |
           -----------------------------------------------</code></pre>
<p>
To become more familiar with this control, let&#39;s make this example a spreadsheet, allowing the user to enter data into the grid by typing it. However, the grid control cannot respond directly to key press events, so we will enter the data in a separate textbox, making the example look something like this:</p>
<pre><code>
	-----------------------------------------------
          |         ---------------   ------------        |
          |        |               | | Enter Data |       |
          |         ---------------   ------------        |
          |          _____________________________        |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
          |         |_____|_____|_____|_____|_____|       |
           -----------------------------------------------</code></pre>
<p>
The user clicks the grid, highlighting a cell, and then types the data for that cell into the textbox. When the data is ready to be transferred to the highlighted cell, the user clicks the control button we have called Enter Data.</p>
<p>
This is a common way of entering data into a grid control. Another, more complicated way is to place code in a Grid_MouseDown() event handler so that when the user clicks a certain cell, you position a borderless textbox exactly over that cell and make it visible. The user gets the impression that it&#39;s possible to enter text directly into the grid. After the user presses, say, the Enter key, you can move the text from the textbox into the underlying grid cell and hide the textbox once again.</p>
<p>
In addition to allowing the user to enter data into the grid, let&#39;s label the first row and the first column of cells just as they might appear in a spreadsheet:</p>
<pre><code>
	-----------------------------------------------
          |         ---------------   ------------        |
          |        |               | | Enter Data |       |
          |         ---------------   ------------        |
          |          _____________________________        |
          |         |_____|__A__|__B__|__C__|__D__|       |
          |         |__1__|_____|_____|_____|_____|       |
          |         |__2__|_____|_____|_____|_____|       |
          |         |__3__|_____|_____|_____|_____|       |
          |         |__4__|_____|_____|_____|_____|       |
          |         |__5__|_____|_____|_____|_____|       |
          |         |__6__|_____|_____|_____|_____|       |
          |         |__7__|_____|_____|_____|_____|       |
          |         |__8__|_____|_____|_____|_____|       |
          |         |__9__|_____|_____|_____|_____|       |
           -----------------------------------------------</code></pre>
<p>
Create a new Web page named grid.htm. Next, add a rich text box, RichText1, to the page:</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;The Grid Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript ONLOAD = "Page_Initialize"&gt;
&lt;CENTER&gt;
&lt;H1&gt;The Grid Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;CENTER&gt;
&lt;!- RichText - richtx32.ocx&gt;
&lt;OBJECT CLASSID="clsid:3b7c8860-d78f-101b-b9b5-04021c009402"   &lt;--
        HEIGHT=40 WIDTH=300 ID=RichText1&gt;&lt;/OBJECT&gt;
        .
        .
        .</code></pre>
<p>
Now we add a 3-D button, with the ID Cmd1, to the page; we&#39;ll give this button the caption Enter Data in a minute:</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;The Grid Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript ONLOAD = "Page_Initialize"&gt;
&lt;CENTER&gt;
&lt;H1&gt;The Grid Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;CENTER&gt;
&lt;!- RichText - richtx32.ocx&gt;
&lt;OBJECT CLASSID="clsid:3b7c8860-d78f-101b-b9b5-04021c009402"
        HEIGHT=40 WIDTH=300 ID=RichText1&gt;&lt;/OBJECT&gt;
&lt;!- SSCommand - threed32.ocx&gt;
&lt;OBJECT CLASSID="clsid:0ba686b4-f7d3-101a-993e-0000c0ef6f5e"   &lt;--
        HEIGHT=30 WIDTH=150 ID=Cmd1&gt;&lt;/OBJECT&gt;
&lt;/CENTER&gt;
     .
     .
     .</code></pre>
<p>
Finally, we add the grid control:</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;The Grid Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript ONLOAD = "Page_Initialize"&gt;
&lt;CENTER&gt;
&lt;H1&gt;The Grid Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;CENTER&gt;
&lt;!- RichText - richtx32.ocx&gt;
&lt;OBJECT CLASSID="clsid:3b7c8860-d78f-101b-b9b5-04021c009402"
        HEIGHT=40 WIDTH=300 ID=RichText1&gt;&lt;/OBJECT&gt;
&lt;!- SSCommand - threed32.ocx&gt;
&lt;OBJECT CLASSID="clsid:0ba686b4-f7d3-101a-993e-0000c0ef6f5e"
        HEIGHT=30 WIDTH=150 ID=Cmd1&gt;&lt;/OBJECT&gt;
&lt;/CENTER&gt;
&lt;!- Grid - grid32.ocx&gt;
&lt;PRE&gt;
&lt;OBJECT CLASSID="clsid:a8c3b720-0b5a-101b-b22e-00aa0037b2fc"   &lt;--
        HEIGHT=200 WIDTH=500 ID=Grid1&gt;&lt;/OBJECT&gt;
&lt;/PRE&gt;
   .
   .
   .</code></pre>
<p>
Now our Web page is almost finished:</p>
<pre><code>
	-----------------------------------------------
          |         ---------------   ------------        |
          |        |               | | Enter Data |       |
          |         ---------------   ------------        |
          |          _____________________________        |
          |         |_____|__A__|__B__|__C__|__D__|       |
          |         |__1__|_____|_____|_____|_____|       |
          |         |__2__|_____|_____|_____|_____|       |
          |         |__3__|_____|_____|_____|_____|       |
          |         |__4__|_____|_____|_____|_____|       |
          |         |__5__|_____|_____|_____|_____|       |
          |         |__6__|_____|_____|_____|_____|       |
          |         |__7__|_____|_____|_____|_____|       |
          |         |__8__|_____|_____|_____|_____|       |
          |         |__9__|_____|_____|_____|_____|       |
           -----------------------------------------------</code></pre>
<p>
The next step is to prepare the grid by labeling the first row with the letters A, B, C, and so on, and the first column with the numbers 1, 2, 3, and so forth. By default, the first row and column of a grid control appear gray and are usually used to label the cells; such label rows and columns, called <font face="Font14793">fixed</font> rows and columns, are controlled by the FixedRows and FixedCols properties. If you do not want to label the cells, simply set FixedRows and FixedCols to 0. To label the cells, create the Page_Initialize subroutine:</p>
<pre><code>Sub Page_Initialize
        .
        .
        .
    End Sub</code></pre>
<p>
As we saw before, each grid control has both a Row and a Col property, and they hold the (Row, Col) location of the currently active cell. (Don&#39;t confuse the Row and Col properties with the Rows and Cols properties, which hold the <font face="Font14793">total</font> number of rows and columns in the grid.) We start by giving our grid control 21 rows and 11 columns with the Rows and Cols properties:</p>
<pre><code>Sub Page_Initialize
 --&gt;          Grid1.Rows = 21
 --&gt;          Grid1.Cols = 11
                .
                .
                .</code></pre>
<p>
In addition, we set the caption of the button (Cmd1) to Enter Data this way:</p>
<pre><code>Sub Page_Initialize
        Grid1.Rows = 21
        Grid1.Cols = 11
 --&gt;    Cmd1.Caption = "Enter Data"
                .
                .
                .</code></pre>
<p>
When we transfer data to the grid control, the data will appear in the cell at the location (Row, Col). To label the first column, column 0, with numbers, we start by setting Grid1&#39;s Col property to 0 with this new code:</p>
<pre><code>Sub Page_Initialize
        Grid1.Rows = 21
        Grid1.Cols = 11
        Cmd1.Caption = "Enter Data"
 --&gt;    Grid1.Col = 0
                .
                .
                .</code></pre>
<p>
Next, we loop over all rows, setting the Row property accordingly (note that we start at Row 1):</p>
<pre><code>--&gt; Dim loop_index
    Sub Page_Initialize
        Grid1.Rows = 21
        Grid1.Cols = 11
        Cmd1.Caption = "Enter Data"
        Grid1.Col = 0
--&gt;     For loop_index = 1 To 20
--&gt;         Grid1.Row = loop_index
                .
                .
                .
--&gt;     Next
        .
        .
        .
    End Sub</code></pre>
<p>
Now that we&#39;ve set the Row and Col properties of the grid, we are free to enter text in the grid&#39;s Text property. That text will appear in the cell at the current (Row, Col) location (which the user has set by clicking the grid control with the mouse). We place ascending numbers in the first column like this:</p>
<pre><code>Dim loop_index
    Sub Page_Initialize
        Grid1.Rows = 21
        Grid1.Cols = 11
        Cmd1.Caption = "Enter Data"
        Grid1.Col = 0
        For loop_index = 1 To 20
            Grid1.Row = loop_index
  --&gt;       Grid1.Text = CStr(loop_index)
        Next
          .
          .
          .
    End Sub</code></pre>
<p>
Now we label the first row with letters. We set Row to 0 and loop over the columns:</p>
<pre><code>Dim loop_index
    Sub Page_Initialize
        Grid1.Rows = 21
        Grid1.Cols = 11
        Cmd1.Caption = "Enter Data"
        Grid1.Col = 0
        For loop_index = 1 To 20
            Grid1.Row = loop_index
            Grid1.Text = CStr(loop_index)
        Next
  --&gt;       Grid1.Row = 0
  --&gt;   For loop_index = 1 To 10
  --&gt;       Grid1.Col = loop_index
                  .
                  .
                  .
  --&gt;   Next
    End Sub</code></pre>
<p>
All we have to do is to convert the loop index into a character starting at &#34;A&#34; and place it into the grid&#39;s Text property:</p>
<pre><code>Dim loop_index
    Sub Page_Initialize
        Grid1.Rows = 21
        Grid1.Cols = 11
        Cmd1.Caption = "Enter Data"
        Grid1.Col = 0
        For loop_index = 1 To 20
            Grid1.Row = loop_index
            Grid1.Text = CStr(loop_index)
        Next
            Grid1.Row = 0
        For loop_index = 1 To 10
            Grid1.Col = loop_index
  --&gt;       Grid1.Text = Chr(Asc("A") + loop_index - 1)
        Next
    End Sub</code></pre>
<p>
Now our grid control&#39;s cells are labeled.</p>
<p>
The next step is to allow the user to enter data. When the user clicks the grid control, the Row and Col properties are automatically set to the location of the clicked cell. After that, the user enters the data in the textbox RichText1 and clicks the command button marked Enter Data. We need only transfer the data from the textbox to the currently active cell and then clear the textbox. Add the subroutine Cmd1_Click() to intercept button clicks, and place this code in it:</p>
<pre><code>Sub Cmd1_Click()
 --&gt;    Grid1.Text = RichText1.Text
 --&gt;    RichText1.Text = ""
    End Sub</code></pre>
<p>
And that&#39;s it&mdash;our Grid example is complete. Run it now, as shown in Figure 6.5, and enter data by clicking the correct cell with the mouse, typing into the textbox, and clicking the Enter Data button. The grid page is a success.</p>
<p>
<img src="fig06-05.gif" border=0></p>
<p>
<b>Figure 6.5&nbsp; Our grid control allows the user to enter and display data.</b></p>
<p>
Note that if you were creating a spreadsheet and the cells were tied together&mdash;such as a running sum being kept at the bottom of every column&mdash;you could perform any required operations (such as adding the column) when the new data was entered into the cell.</p>
<p>
The code for this Web page, grid.htm, appears in Listing 6.2.</p>
<p>
<b>Listing 6.2&nbsp;grid.htm</b></p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;The Grid Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript ONLOAD = "Page_Initialize"&gt;
&lt;CENTER&gt;
&lt;H1&gt;The Grid Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;CENTER&gt;
&lt;!- RichText - richtx32.ocx&gt;
&lt;OBJECT CLASSID="clsid:3b7c8860-d78f-101b-b9b5-04021c009402"
        HEIGHT=40 WIDTH=300 ID=RichText1&gt;&lt;/OBJECT&gt;
&lt;!- SSCommand - threed32.ocx&gt;
&lt;OBJECT CLASSID="clsid:0ba686b4-f7d3-101a-993e-0000c0ef6f5e"
        HEIGHT=30 WIDTH=150 ID=Cmd1&gt;&lt;/OBJECT&gt;
&lt;/CENTER&gt;
&lt;!- Grid - grid32.ocx&gt;
&lt;PRE&gt;
&lt;OBJECT CLASSID="clsid:a8c3b720-0b5a-101b-b22e-00aa0037b2fc"
        HEIGHT=200 WIDTH=500 ID=Grid1&gt;&lt;/OBJECT&gt;
&lt;/PRE&gt;
&lt;SCRIPT LANGUAGE = VBScript&gt;
    Dim loop_index
    Sub Page_Initialize
        Grid1.Rows = 21
        Grid1.Cols = 11
        Cmd1.Caption = "Enter Data"
        Grid1.Col = 0
        For loop_index = 1 To 20
            Grid1.Row = loop_index
            Grid1.Text = CStr(loop_index)
        Next
            Grid1.Row = 0
        For loop_index = 1 To 10
            Grid1.Col = loop_index
            Grid1.Text = Chr(Asc("A") + loop_index - 1)
        Next
    End Sub
    Sub Cmd1_Click()
        Grid1.Text = RichText1.Text
        RichText1.Text = ""
    End Sub
&lt;/SCRIPT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</code></pre>
<p>
That&#39;s it for our coverage of the grid control. The next custom control we&#39;ll cover is also an extremely popular one: the graph control.</p>
<h1></h1>
</font></BODY>
</HTML>
