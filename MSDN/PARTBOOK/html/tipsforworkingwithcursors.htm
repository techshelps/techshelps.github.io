<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tips for Working with Cursors</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000 dir=ltr>
<h1><a name="tipsforworkingwithcursors"></a>Tips for Working with Cursors</h1>
<p>
Some providers, such as SQL Server, implement a forward-scrolling, read-only (or 'firehose') cursor mode, meaning that they can efficiently retrieve data by keeping a connection open. When working with such providers, the connection could be blocked by another user's transaction. The following examples demonstrate scenarios that result in errors.</p>
<pre><code>dbConn.Open "DSN=SQLForum;UID=sa;PWD=;"        'Example 1
dbConn.BeginTrans
RS.Open "SELECT * FROM Message", dbConn
Set dbCmd.ActiveConnection = dbConn</code></pre>
<ul type=disc>
<li>
<b>Example 1</b>: The problem is that the command object's <b><code>ActiveConnection</code></b> is being set to a connection that is forward-scrolling and in 'firehose' mode. This is the same connection involved in the batch mode. The error from the provider will only appear in the <b><code>Err</code></b> object, and it will return as unspecified. For example, with the ODBC Provider, you will get "Unspecified error".<br><br></li>
<li>
<pre><code>dbConn.Open "DSN=SQLForum;UID=sa;PWD=;"        'Example 2
RS.Open "SELECT * FROM Message", dbConn
dbConn.BeginTrans</code></pre>
</li>
<li>
<b>Example 2</b>: The problem here is that the connection is forward-scrolling and in firehose mode, so it cannot be put into transaction mode. The error returned in the <b><code>Errors</code></b> collection from the provider will indicate that it is operating in firehose mode, and can't work in transaction mode. For example, with the ODBC Provider against Microsoft SQL Server, you will get the error "Cannot start transaction while in firehose mode".<br><br></li>
<li>
<pre><code>dbConn.Open "DSN=SQLForum;UID=sa;PWD=;"        'Example 3
RS.Open "SELECT * FROM Message", dbConn
Set dbCmd.ActiveConnection = dbConn
dbConn.BeginTrans</code></pre>
</li>
<li>
<b>Example 3</b>: The problem here is that the connection is in forward-scrolling firehose mode, so it cannot also be involved in a batch mode. The error returned in the <b><code>Errors</code></b> collection from the provider will indicate that the transaction could not be started. For example, with the ODBC Provider against Microsoft SQL Server, you will get the error "Cannot start transaction because more than one hdbc is in use".</li>
</ul>
</BODY>
</HTML>
