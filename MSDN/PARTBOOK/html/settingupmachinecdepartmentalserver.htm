<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting up Machine C, the Departmental Server</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000 dir=ltr>
<h1><a name="settingupmachinecdepartmentalserver"></a>Setting up Machine C, the Departmental Server</h1>
<p>
This machine represents a departmental server, and it has the following software configuration:</p>
<ul type=disc>
<li>
Windows 95 with Service Pack 1<br><br></li>
<li>
DCOM for Windows 95</li>
</ul>
<p>
Setting up this machine is rather similar to the setup of machine B. However, since the <b><code>ATLDept.dll</code></b> is a DLL, we can't simply start it listening for calls as we did with <b><code>ATLFinder.exe</code></b> on machine B.</p>
<p>
To install <b><code>ATLDept.dll</code></b> on this machine, follow these steps:</p>
<OL>
<li>
Copy <b><code>Regsvr32.exe</code></b> into <b><code>\Windows\System</code></b> directory if it's not already there.<br><br></li>
<li>
Copy the ATL support DLL, <b><code>atl.dll</code></b>, over to <b><code>\Windows\System</code></b> directory.<br><br></li>
<li>
Run <b><code>regsvr32 atl.dll</code></b>.<br><br></li>
<li>
Copy the <b><code>ATLDept.dll</code></b> file over to the working directory.<br><br></li>
<li>
Run <b><code>regsvr32 ATLDept.dll</code></b>.</li>
</ol>
<p>
This is all that's necessary for this machine since it isn't accessing any remote server.</p>
<p>
To make sure everything is running okay, start Object Viewer on machine C. In the left-hand pane, select ATLDept1 Class, double-click it to instantiate it. If you have a problem instantiating ATLDept locally, backtrack over the steps and correct any errors.</p>
<p>
Once you can instantiate it locally, it's time to try it on machine B. First, however, since Windows 95 offers no remote launching facility (due to security issues), you need to start the server.</p>
</BODY>
</HTML>
