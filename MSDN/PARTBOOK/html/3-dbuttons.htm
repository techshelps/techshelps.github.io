<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3-D Buttons</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana, arial, helvetica" size="2"><h1><a name="3-dbuttons"></a>3-D Buttons</h1>
<p>
The first example (ocx.htm) is a Web page that holds a number of the most popular ActiveX controls, and the first step is to insert such a control into the Web page. Let&#39;s start by giving our Web page a title and a header (&#34;OCX Control Page&#34;):</p>
<pre><code>&lt;HTML&gt;
    &lt;HEAD&gt;
    &lt;TITLE&gt;OCX Control Page&lt;/TITLE&gt;
    &lt;/HEAD&gt;
    &lt;BODY LANGUAGE = VBScript ONLOAD = "Page_Initialize"&gt;
    &lt;CENTER&gt;
--&gt; &lt;H1&gt;OCX Control Page&lt;/H1&gt;
    &lt;/CENTER&gt;
        .
        .
        .</code></pre>
<p>
Now we&#39;ll insert our first ActiveX control, the 3-D push-button control. This button is much like the standard buttons we have used throughout this book, but it has a more three-dimensional appearance. The 3-D button is supported by the threed.ocx file, which should be in your windows\system directory if you want to use this control; you can do Windows registration of .ocx files using RegSvr32.exe. We&#39;ll need the registration value of this control in the Windows registry.</p>
<p>
To get that registration value, you can use the Windows regedit.exe tool (regedit.exe is in your Windows directory); start regedit and select Find in the Edit menu, opening the Find dialog box. Type the name of the control you are looking for, Threed Command Button, in the Find what: box and click Find Next. You can also use Microsoft&#39;s aclist.exe tool, available from www.microsoft.com, to list ActiveX controls available in your computer. You&#39;ll find that this control has a class ID in the registry: 0ba686b4-f7d3-101a-993e-0000c0ef6f5e. This value, called the control&#39;s class ID or clsid, uniquely represents the 3-D command button to Windows. We add it to our Web page using the &lt;OBJECT&gt; tag, giving the 3-D command button the ID Cmd1:</p>
<pre><code>&lt;HTML&gt;
    &lt;HEAD&gt;
    &lt;TITLE&gt;OCX Control Page&lt;/TITLE&gt;
    &lt;/HEAD&gt;
    &lt;BODY LANGUAGE = VBScript ONLOAD = "Page_Initialize"&gt;
    &lt;CENTER&gt;
    &lt;H1&gt;OCX Control Page&lt;/H1&gt;
    &lt;/CENTER&gt;
    &lt;!- SSCommand&gt;
    &lt;PRE&gt;
--&gt; SSCommand:   &lt;OBJECT CLASSID="clsid:0ba686b4-f7d3-101a-993e-0000c0ef6f5e"
                   HEIGHT=30 WIDTH=70 ID=Cmd1&gt;&lt;/OBJECT&gt;
    &lt;/PRE&gt;
        .
        .
        .</code></pre>
<p>
Note: Each control that we are discussing in this chapter <font face="Font14793">must </font>be registered with Windows 95 in order to be accessible to VBScript. If one or more of the controls do not work, you should check your Registry to find out what ActiveX controls you have available.</p>
<p>
That&#39;s the general form of the &lt;OBJECT&gt; tag; we fill the properties of the new OLE control with the &lt;PARAM&gt; tag between &lt;OBJECT&gt; and &lt;/OBJECT&gt;:</p>
<pre><code>&lt;OBJECT CLASSID = "clsid:   " HEIGHT = 30 WIDTH = 70 ID=IDname&gt;
                &lt;PARAM NAME = "FontName" VALUE = "Arial"&gt;
                &lt;PARAM NAME = "FontSize" VALUE = 12&gt;
        &lt;/OBJECT&gt;</code></pre>
<p>
Using the &lt;PARAM&gt; tag, we supply both the name of the property we are setting and the value we want to set it to. If we want to let users download our .ocx file automatically (for example, if we know they don&#39;t have it on disk), we can use the CODEBASE keyword, indicating that the needed support file, called control96.ocx, is in the server directory ocxcode:</p>
<pre><code>&lt;OBJECT CLASSID = "clsid:   " HEIGHT = 30 WIDTH = 70
            CODEBASE="/ocxcode/control96.ocx" ID=IDname&gt;
                &lt;PARAM NAME = "FontName" VALUE = "Arial"&gt;
                &lt;PARAM NAME = "FontSize" VALUE = 12&gt;
        &lt;/OBJECT&gt;</code></pre>
<p>
In the case of our 3-D command button, we now refer to it as Cmd1 because we gave it that ID:</p>
<pre><code>SSCommand:   &lt;OBJECT CLASSID="clsid:0ba686b4-f7d3-101a-993e-0000c0ef6f5e"
                   HEIGHT=30 WIDTH=70 ID=Cmd1&gt;&lt;/OBJECT&gt;</code></pre>
<p>
As with standard buttons, we can set the button&#39;s caption to, say, &#34;Hello,&#34; when the page first loads by setting Cmd1&#39;s Caption property in Page_Initialize:</p>
<pre><code>&lt;HTML&gt;
    &lt;HEAD&gt;
    &lt;TITLE&gt;OCX Control Page&lt;/TITLE&gt;
    &lt;/HEAD&gt;
    &lt;BODY LANGUAGE = VBScript ONLOAD = "Page_Initialize"&gt;
    &lt;CENTER&gt;
    &lt;H1&gt;OCX Control Page&lt;/H1&gt;
    &lt;/CENTER&gt;
    &lt;!- SSCommand&gt;
    &lt;PRE&gt;
    SSCommand:   &lt;OBJECT CLASSID="clsid:0ba686b4-f7d3-101a-993e-0000c0ef6f5e"
                   HEIGHT=30 WIDTH=70 ID=Cmd1&gt;&lt;/OBJECT&gt;
    &lt;/PRE&gt;
       .
       .
       .
    &lt;SCRIPT LANGUAGE = VBScript&gt;
 --&gt;        Sub Page_Initialize
 --&gt;              Cmd1.Caption = "Hello"
 --&gt;        End Sub
    &lt;/SCRIPT&gt;
    &lt;/BODY&gt;
    &lt;/HTML&gt;</code></pre>
<p>
The result appears in Figure 6.1, where you can see the new 3-D button with the caption &#34;Hello.&#34;</p>
<p>
<img src="fig06-01.gif" border=0></p>
<p>
<b>Figure 6.1 &nbsp;Our ActiveX Controls Web page.</b></p>
<p>
We can use Cmd1 like any standard button, adding a click event like this (assuming we have a textbox named Text1):</p>
<pre><code>Sub Cmd1_Click()
                  Text1.Text = "Hello World!"
            End Sub</code></pre>
<p>
So that&#39;s how we connect ActiveX controls to VBScript: we add them with an &lt;OBJECT&gt; tag and give them a control ID (such as Cmd1) that we can refer to in code. Now let&#39;s examine two more 3-D controls: 3-D frames and 3-D panels.</p>
<h1></h1>
</font></BODY>
</HTML>
