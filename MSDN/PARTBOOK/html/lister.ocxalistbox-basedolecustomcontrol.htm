<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LISTER.OCX: A Listbox-Based OLE Custom Control</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana, arial, helvetica" size="2"><h1><a name="lister.ocxalistbox-basedolecustomcontrol"></a>LISTER.OCX: A Listbox-Based OLE Custom Control</h1>
<p>
Our first example custom OLE control is a customized listbox control. In all ways, this control acts as a listbox except when the user clicks it. After being clicked, our customized listbox displays the text &#34;Hello world.&#34;:</p>
<pre><code>Web Page
         -----------------------
        |                       |
        |        ------------   |
        |       |Hello, world|  |
        |       |            |  |
        |       |            |  |
        |       |            |  |
        |        ------------   |
        |                       |
         -----------------------</code></pre>
<p>
We will place the support for this custom control in a file named LISTER.OCX, and we&#39;ll be able to add this control to our VBScript pages in the same way we add any other ActiveX control.</p>
<p>
Visual C++ provides an excellent tool for testing the ActiveX controls we create. In the Visual C++ Tools menu, you will find the menu item OLE Control Test Container. Clicking that tool opens the Visual C++ test container, and the Edit menu of that container program has an item named Insert OLE Control:</p>
<pre><code>
	-----------------------
         | Container             |
         |-----------------------|
         | File Edit             |
         |-----|---------------------
         |     |Insert Ole Control...|
         |     |                     |
         |      ---------------------
         |                       |
         |                       |
         |                       |
          -----------------------</code></pre>
<p>
When you select that item, the Insert OLE Control box opens, displaying all the custom controls available, including our LISTER control:</p>
<pre><code>
	-----------------------
         | Container             |
         |-----------------------|
         |         -------------------------------
         |        |Insert OLE Control   --------  |
         |        |                    |   OK   | |
         |        |Object Type          --------  |
         |        | ---------------     --------  |
         |        ||Lister Control |   | Cancel | |
          --------||               |    --------  |
                  | ---------------               |
                   -------------------------------</code></pre>
<p>
Here, you see the entry Lister Control in the Object Type box. (We assume that we have already registered our ActiveX control with Windows, and now Windows is informing us that it is available.) When we select Lister Control in the Object Type box and then click OK, a new LISTER control appears in the test container. (It is just an empty listbox at this point):</p>
<pre><code>
	-----------------------
         | Container             |
         |-----------------------|
         |        ------------   |
         |       |            |  |
         |       |            |  |
         |       |            |  |
         |       |            |  |
         |        ------------   |
         |                       |
          -----------------------</code></pre>
<p>
When a user clicks this listbox, it displays the text &#34;Hello, world.&#34;:</p>
<pre><code>
	-----------------------
         | Container             |
         |-----------------------|
         |        ------------   |
         |       |Hello, world|  |
         |       |            |  |
         |       |            |  |
         |       |            |  |
         |        ------------   |
         |                       |
          -----------------------</code></pre>
<p>
Now we know what we are aiming for. Let&#39;s get started.</p>
<h1></h1>
</font></BODY>
</HTML>
