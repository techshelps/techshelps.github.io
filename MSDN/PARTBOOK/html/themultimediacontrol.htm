<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Multimedia Control</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana, arial, helvetica" size="2"><h1><a name="themultimediacontrol"></a>The Multimedia Control</h1>
<p>
Multimedia is certainly a hot topic, because it lets us create an integrated environment of video, sound, still pictures, and text. VBScript gives us access to multimedia through custom controls such as the media control interface (MCI) multimedia control. Let&#39;s take advantage of this and create a new Web page, multimed.htm. As we&#39;ve seen, the multimedia control consists of a set of buttons much like you would see on a CD player:</p>
<pre><code>
	--------------------------------------------------------------
         |      |      |      |      |      |      |   _  |   _  |  __  |
         | |/|  | |\|  |  |\  |  ||  |  /|| |  ||\ |  | | |  | | |  /\  |
         | |\|  | |/|  |  |/  |  ||  |  \|| |  ||/ |  |_| |  |_| |  ==  |
         |      |      |      |      |      |      |      |      |      |
          --------------------------------------------------------------</code></pre>
<p>
With these buttons, we can control the operation of multimedia devices. The different device types that the multimedia control can work with are shown in Table 6.2.</p>
<p>
<b>Table 6.2&nbsp;MMControl device types.</b></p>
<table border=1 cols=2 frame=box rules=all>
<tr valign=top>
<td width=146><b>Name</b></td>
<td width=366><b>Type of Device</b></td>
</tr>
<tr valign=top>
<td width=146>Animation</td>
<td width=366>Plays animation</td>
</tr>
<tr valign=top>
<td width=146>CDAudio</td>
<td width=366>Plays CD audio</td>
</tr>
<tr valign=top>
<td width=146>AVIVideo</td>
<td width=366>Plays <b>.AVI</b> video files</td>
</tr>
<tr valign=top>
<td width=146>Other</td>
<td width=366>Device is not defined</td>
</tr>
<tr valign=top>
<td width=146>Overlay</td>
<td width=366>Plays analog video</td>
</tr>
<tr valign=top>
<td width=146>Sequencer</td>
<td width=366>The musical instrument digital interface (MIDI)</td>
</tr>
<tr valign=top>
<td width=146>VideoDisc</td>
<td width=366>Plays video discs</td>
</tr>
<tr valign=top>
<td width=146>WaveAudio</td>
<td width=366>Plays <b>.WAV</b> sound files</td>
</tr>
</table><br>
<p>
Let&#39;s see how to use this control with CD audio. We begin by adding a new multimedia control to a Web page, multimed.htm, and giving that new control the ID MMControl1:</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Multimedia Control Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript&gt;
&lt;CENTER&gt;
&lt;H1&gt;Multimedia Control Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;!- MMControl&gt;
&lt;PRE&gt;
MMControl:  &lt;OBJECT CLASSID="clsid:C1A8AF25-1257-101B-8FB0-0020AF039CA3" &lt;--
            HEIGHT=50 WIDTH=400 ID=MMControl1&gt;&lt;/OBJECT&gt;
&lt;/PRE&gt;
   .
   .
   .</code></pre>
<p>
As we did earlier, we add a button, MMButton, to start the multimedia control:</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Multimedia Control Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript&gt;
&lt;CENTER&gt;
&lt;H1&gt;Multimedia Control Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;!- MMControl&gt;
&lt;PRE&gt;
MMControl:  &lt;OBJECT CLASSID="clsid:C1A8AF25-1257-101B-8FB0-0020AF039CA3"
            HEIGHT=50 WIDTH=400 ID=MMControl1&gt;&lt;/OBJECT&gt;
&lt;/PRE&gt;
&lt;CENTER&gt;
&lt;INPUT TYPE = BUTTON NAME = "MMButton" VALUE = "Activate MM Control"&gt; &lt;--
&lt;/CENTER&gt;
&lt;BR&gt;
    .
    .
    .</code></pre>
<p>
When the user clicks this button, we set the multimedia control to play CD audio and start it as before in MMButton_OnClick:</p>
<pre><code>Sub MMButton_OnClick
              MMControl1.DeviceType = "CDAudio"
              MMControl1.Command = "Open"
        End Sub</code></pre>
<p>
We can do more with the multimedia control by using its StatusUpdate event, which is called when it switches modes (e.g., from Stop to Play). The mode of the multimedia control is stored in its Mode property, and the available settings appear in Table 6.3.</p>
<p>
<b>Table 6.3&nbsp;Multimedia modes.</b></p>
<table border=1 cols=2 frame=box rules=all>
<tr valign=top>
<td width=122><b>Mode Value</b></td>
<td width=186><b>Means</b></td>
</tr>
<tr valign=top>
<td width=122>524</td>
<td width=186>Device not open</td>
</tr>
<tr valign=top>
<td width=122>525</td>
<td width=186>Device stop</td>
</tr>
<tr valign=top>
<td width=122>526</td>
<td width=186>Device play</td>
</tr>
<tr valign=top>
<td width=122>527</td>
<td width=186>Device record</td>
</tr>
<tr valign=top>
<td width=122>528</td>
<td width=186>Device seek</td>
</tr>
<tr valign=top>
<td width=122>529</td>
<td width=186>Device pause</td>
</tr>
<tr valign=top>
<td width=122>530</td>
<td width=186>Device ready</td>
</tr>
</table><br>
<p>
If we add a textbox to our Web page, we can indicate the status of the multimedia control: whether it is playing or paused, or whatever condition it is in. We add a rich text box, RichText1, for this purpose:</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Multimedia Control Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript&gt;
&lt;CENTER&gt;
&lt;H1&gt;Multimedia Control Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;!- MMControl&gt;
&lt;PRE&gt;
MMControl:  &lt;OBJECT CLASSID="clsid:C1A8AF25-1257-101B-8FB0-0020AF039CA3"
            HEIGHT=50 WIDTH=400 ID=MMControl1&gt;&lt;/OBJECT&gt;
&lt;/PRE&gt;
&lt;CENTER&gt;
&lt;INPUT TYPE = BUTTON NAME = "MMButton" VALUE = "Activate MM Control"&gt;
&lt;/CENTER&gt;
&lt;BR&gt;
&lt;!- RichText&gt;
&lt;CENTER&gt;
&lt;OBJECT CLASSID="clsid:3b7c8860-d78f-101b-b9b5-04021c009402"   &lt;--
             HEIGHT=40 WIDTH=300 ID=RichText1&gt;&lt;/OBJECT&gt;
&lt;/CENTER&gt;
    .
    .
    .</code></pre>
<p>
We will display the status of MMControl1 with the MMControl1_StatusUpdate() subroutine; the control calls this subroutine when its status changes:</p>
<pre><code>Sub MMControl1_StatusUpdate()
             .
             .
             .
        End Sub</code></pre>
<p>
In this subroutine, we place the correct text into the rich text box to match the control&#39;s status:</p>
<pre><code>Sub MMControl1_StatusUpdate()
  --&gt;        If MMControl1.Mode = 525 Then RichText1.Text = "Stopped."
  --&gt;        If MMControl1.Mode = 526 Then RichText1.Text = "Playing."
  --&gt;        If MMControl1.Mode = 527 Then RichText1.Text = "Recording."
  --&gt;        If MMControl1.Mode = 528 Then RichText1.Text = "Seeking."
  --&gt;        If MMControl1.Mode = 529 Then RichText1.Text = "Paused."
  --&gt;        If MMControl1.Mode = 530 Then RichText1.Text = "Ready."
        End Sub</code></pre>
<p>
And that&#39;s it&mdash;now our multimedia program is set. Run it as shown in Figure 6.8. If you place a music CD in your CD-ROM drive, you can use the multimedia control to control it and play music. (Even if you don&#39;t have a sound card, CD-ROM drives often have earphone jacks for this purpose.) In addition, the status of each multimedia device is shown. Our new Web page is a success. The multimed.htm file appears in Listing 6.4.</p>
<p>
<img src="fig06-08.gif" border=0></p>
<p>
<b>Figure 6.8&nbsp;Our multimedia control plays CD music.</b></p>
<p>
<b>Listing 6.4&nbsp;multimed.html</b></p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Multimedia Control Page&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY LANGUAGE = VBScript&gt;
&lt;CENTER&gt;
&lt;H1&gt;Multimedia Control Page&lt;/H1&gt;
&lt;/CENTER&gt;
&lt;!- MMControl&gt;
&lt;PRE&gt;
MMControl:  &lt;OBJECT CLASSID="clsid:C1A8AF25-1257-101B-8FB0-0020AF039CA3"
            HEIGHT=50 WIDTH=400 ID=MMControl1&gt;&lt;/OBJECT&gt;
&lt;/PRE&gt;
&lt;CENTER&gt;
&lt;INPUT TYPE = BUTTON NAME = "MMButton" VALUE = "Activate MM Control"&gt;
&lt;/CENTER&gt;
&lt;BR&gt;
&lt;!- RichText&gt;
&lt;CENTER&gt;
&lt;OBJECT CLASSID="clsid:3b7c8860-d78f-101b-b9b5-04021c009402"
             HEIGHT=40 WIDTH=300 ID=RichText1&gt;&lt;/OBJECT&gt;
&lt;/CENTER&gt;
&lt;SCRIPT LANGUAGE = VBScript&gt;
        Sub MMButton_OnClick
              MMControl1.DeviceType = "CDAudio"
              MMControl1.Command = "Open"
        End Sub
        Sub MMControl1_StatusUpdate()
             If MMControl1.Mode = 525 Then RichText1.Text = "Stopped."
             If MMControl1.Mode = 526 Then RichText1.Text = "Playing."
             If MMControl1.Mode = 527 Then RichText1.Text = "Recording."
             If MMControl1.Mode = 528 Then RichText1.Text = "Seeking."
             If MMControl1.Mode = 529 Then RichText1.Text = "Paused."
             If MMControl1.Mode = 530 Then RichText1.Text = "Ready."
        End Sub
&lt;/SCRIPT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</code></pre>
<p>
That&#39;s it for our ActiveX control chapter. In this chapter, we&#39;ve explored many controls: 3-D buttons, 3-D frames and panels, grid controls, graph controls, AVI file controls, multimedia controls, spin buttons, progress bars, and more. As you can see, there is a great deal of power here&mdash;all that remains is to put it to work.</p>
</font></BODY>
</HTML>
