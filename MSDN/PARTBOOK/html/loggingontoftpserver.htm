<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logging On to an FTP Server</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana,arial,helvetica" size="2"><h1><a name="loggingontoftpserver"></a>Logging On to an FTP Server</h1>
<p>
The first step is to log on to the FTP server ftp.microsoft.com. In general, there are two types of FTP servers: public and private ones. For both types, you must provide a user name and password. In public FTP servers, such as ftp.microsoft.com, you typically use &#34;anonymous&#34; as your user name, and your email address as the password. The Internet Transfer control makes it easy, because it supplies this information automatically (getting your email address from the Windows registry).</p>
<p>
To log on to a private FTP server, you must provide a password and user name, and you do that using the Internet Transfer control&#39;s UserName and Password properties. For example, if we wanted to connect to ftp.private.com, we would start by setting the Internet Transfer control&#39;s URL property to ftp.private.com. (You don&#39;t have to set the URL property if you use the OpenURL() method, because you pass the URL when calling OpenURL().)</p>
<pre><code>Inet1.URL = "ftp://ftp.private.com"
           .
           .
           .</code></pre>
<p>
Next, set the UserName and Password properties:</p>
<pre><code>Inet1.URL = "ftp://ftp.private.com"
  &mdash;&gt;   Inet1.UserName = "George Washington"
  &mdash;&gt;   Inet1.Password = "no_lies"
           .
           .
           .</code></pre>
<p>
Then you can the Execute method to execute FTP commands such as GET; in this case, we&#39;ll download a file named <b>source.txt</b> from the FTP server and save it as <b>c:\target.txt</b>:</p>
<pre><code>Inet1.URL = "ftp://ftp.private.com"
        Inet1.UserName = "George Washington"
        Inet1.Password = "no_lies"
        Inet1.Execute , "GET source.txt C:\target.txt"
                .
                .
                .</code></pre>
<p>
In this way, you use the Execute method to execute FTP commands (just as you might in a command-line FTP program). Finally, we execute a CLOSE command to close the connection:</p>
<pre><code>Inet1.URL = "ftp://ftp.private.com"
        Inet1.UserName = "George Washington"
        Inet1.Password = "no_lies"
        Inet1.Execute , "GET source.txt C:\target.txt"
  &mdash;&gt;   Inet.Execute ,"CLOSE"</code></pre>
<p>
That&#39;s the way to execute FTP commands: with the Execute method. You may be familiar with these commands. They are the backbone of FTP handling, although, as we&#39;ll see in a minute, you don&#39;t have to use any of these commands to download if you use the OpenURL() method. Table 3.1 shows the supported FTP commands, such as CD, GET, DELETE, PUT, and MKDIR (MKDIR creates a new directory on the Internet host if you have the privilege to do so), and describes what they do. Using these commands, we can download files from and upload files to FTP sites. For example, to change directories and upload a file named <b>source.txt</b>, renaming it to <b>target.txt</b>, you would execute this code:</p>
<pre><code>Inet1.URL = "ftp://ftp.private.com"
        Inet1.UserName = "George Washington"
        Inet1.Password = "no_lies"
        Inet1.Execute , "CD gifs\thegifs"
        Inet1.Execute , "PUT C:\source.txt target.txt"
        Inet.Execute ,"CLOSE"</code></pre>
<p>
<b>Table 3.1&nbsp;FTP commands of the Internet Transfer Control&#39;s Execute Method</b></p>
<table border=1 cols=2 frame=box rules=all>
<tr valign=top>
<td width=158><b>Command</b></td>
<td width=426><b>Does This</b></td>
</tr>
<tr valign=top>
<td width=158>CD newdir</td>
<td width=426>Changes directory (e.g., Execute , &#34;CD gifs\thegifs&#34;).</td>
</tr>
<tr valign=top>
<td width=158>CDUP</td>
<td width=426>Changes to parent directory. Identical to &#34;CD ..&#34;.</td>
</tr>
<tr valign=top>
<td width=158>DELETE file</td>
<td width=426>Deletes specified file (e.g., Execute , &#34;DELETE nogood.dat&#34;).</td>
</tr>
<tr valign=top>
<td width=158>DIR [newdir]</td>
<td width=426>Searches current directory or directory specified. Use GetChunk() to get the data (e.g., Execute , &#34;DIR /gifs&#34;).</td>
</tr>
<tr valign=top>
<td width=158>GET source target</td>
<td width=426>Gets file &#34;source&#34; and creates a local file &#34;target&#34; (e.g., Execute , &#34;GET source.txt C:\target.txt&#34;).</td>
</tr>
<tr valign=top>
<td width=158>LS</td>
<td width=426>List. Same as DIR.</td>
</tr>
<tr valign=top>
<td width=158>MKDIR newdir</td>
<td width=426>Creates new directory newdir (e.g., Execute , &#34;MKDIR /newdir&#34;).</td>
</tr>
<tr valign=top>
<td width=158>PUT source target</td>
<td width=426>Copies local file &#34;source&#34; to remote computer as &#34;target&#34; (e.g., Execute , &#34;PUT C:\source.txt target.txt&#34;).</td>
</tr>
<tr valign=top>
<td width=158>PWD</td>
<td width=426>Print Working Directory. Use GetChunk() method to get the data (e.g., Execute , &#34;PWD&#34;).</td>
</tr>
<tr valign=top>
<td width=158>QUIT</td>
<td width=426>Close the connection (e.g., Execute , &#34;QUIT&#34;).</td>
</tr>
<tr valign=top>
<td width=158>RECV source target</td>
<td width=426>Same as GET.</td>
</tr>
<tr valign=top>
<td width=158>RENAME oldname </td>
<td width=426>Renames a file (e.g., Execute , &#34;RENAME oldnewname name.txt newname.txt&#34;).</td>
</tr>
<tr valign=top>
<td width=158>RMDIR dirname</td>
<td width=426>Removes directory (e.g., Execute , &#34;RMDIR dirname&#34;).</td>
</tr>
<tr valign=top>
<td width=158>SEND source</td>
<td width=426>Same as PUT.</td>
</tr>
<tr valign=top>
<td width=158>SIZE filename</td>
<td width=426>Gets the size of specified file (e.g., Execute &#34;SIZE filename.txt&#34;).</td>
</tr>
</table><br>
<h1></h1>
</font></BODY>
</HTML>
