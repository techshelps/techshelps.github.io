<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a DSN 'On the Fly'</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000 dir=ltr>
<h1><a name="creatingdsnonfly"></a>Creating a DSN 'On the Fly'</h1>
<p>
So far, each of our connections has assumed that we have previously defined a <b>Data</b> <b>Source</b> <b>Name</b> (DSN). The DSN describes a data source, and the standard settings to be used when attaching to it. However, this can be limiting in some circumstances—especially when attaching to data sources that are dynamic in nature. </p>
<p>
For example, let’s take a situation where the user connects to several servers, depending on the information they need. We could setup an ODBC Data Source Name definition for each server and selectively attach to it. A better way is to create the connection 'on the fly', without using a DSN:</p>
<pre><code>ServerName = Request.QueryString("ServerName")   'from the submitted page
DBConn.Open "Driver={SQL Server};Server=" &amp; ServerName &amp; _    
    ";UID=sa;PWD=;WSID=MAINFRAME;Language=us_english;Database=Forum;DSN=;"
...</code></pre>
<p>
In this example we create a definition on the fly, using the server name from a form submitted by the user to determine which SQL Server to attach to. </p>
</BODY>
</HTML>
