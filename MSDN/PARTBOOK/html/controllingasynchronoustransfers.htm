<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Controlling Asynchronous Transfers</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana,arial,helvetica" size="2"><h1><a name="controllingasynchronoustransfers"></a>Controlling Asynchronous Transfers</h1>
<p>
Execute() works asynchronously, and that means that we need some way of keeping track of what it is doing. In particular, we need to know when the operation is finished (such as when the file we want is downloaded). We do that in the Internet Transfer control&#39;s StateChanged event; double-clicking the Internet Transfer control opens this event:</p>
<pre><code>Private Sub Inet1_StateChanged(ByVal State As Integer)
        End Sub</code></pre>
<p>
We can determine what is happening in this event by checking the variable passed to us: State. Table 3.2 lists the values that this variable can contain and describes what those values mean. Using this event handler, we can watch as the control connects to the Internet, downloads the data, and finishes.</p>
<p>
<b>Table 3.2&nbsp;The Internet Transfer Control&#39;s StateChanged Values</b></p>
<table border=1 cols=2 frame=box rules=all>
<tr valign=top>
<td width=344><b>Value</b></td>
<td width=344><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=344>icNone (= 0)</td>
<td width=344>No state</td>
</tr>
<tr valign=top>
<td width=344>icHostResolvingHost (= 1)</td>
<td width=344>Looking up IP address of specified computer</td>
</tr>
<tr valign=top>
<td width=344>icHostResolved (= 2)</td>
<td width=344>Got the IP address of specified computer</td>
</tr>
<tr valign=top>
<td width=344>icConnecting (= 3)</td>
<td width=344>Connecting to computer</td>
</tr>
<tr valign=top>
<td width=344>icConnected (= 4)</td>
<td width=344>Connected to computer</td>
</tr>
<tr valign=top>
<td width=344>icRequesting (= 5)</td>
<td width=344>Sending request to host computer</td>
</tr>
<tr valign=top>
<td width=344>icRequestSent (= 6)</td>
<td width=344>Sent the request</td>
</tr>
<tr valign=top>
<td width=344>icReceivingResponse (= 7)</td>
<td width=344>Receiving a response from computer</td>
</tr>
<tr valign=top>
<td width=344>icResponseReceived (= 8)</td>
<td width=344>Received a response from computer</td>
</tr>
<tr valign=top>
<td width=344>icDisconnecting (= 9)</td>
<td width=344>Disconnecting from computer</td>
</tr>
<tr valign=top>
<td width=344>icDisconnected (= 10)</td>
<td width=344>Disconnected from computer</td>
</tr>
<tr valign=top>
<td width=344>icError (= 11)</td>
<td width=344>Error occurred</td>
</tr>
<tr valign=top>
<td width=344>icResponseCompleted (= 12)</td>
<td width=344>Request completed and data received</td>
</tr>
</table><br>
<p>
For example, if we want to determine when a particular document has been downloaded, we place code like this into the Inet1_StateChanged() event handler:</p>
<pre><code>Private Sub Inet1_StateChanged(ByVal State As Integer)
   &mdash;&gt;      If(State = icResponseCompleted) Then ReceivedFlag = True
        End Sub</code></pre>
<p>
In this way, we&#39;re able to determine when a document is fully downloaded when we use the Execute method. (There is no such question when you use the OpenURL method, because that method won&#39;t return until the file you have requested has been downloaded.)</p>
<h1></h1>
</font></BODY>
</HTML>
