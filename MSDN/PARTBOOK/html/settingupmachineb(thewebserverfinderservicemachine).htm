<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting up Machine B (the Web Server and Finder Service machine)</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000 dir=ltr>
<h1><a name="settingupmachineb(thewebserverfinderservicemachine)"></a>Setting up Machine B (the Web Server and Finder Service machine) </h1>
<p>
This is the server machine, and it has the following software configuration: </p>
<ul type=disc>
<li>
Windows 95 with Service Pack 1<br><br></li>
<li>
DCOM for Windows 95<br><br></li>
<li>
Microsoft Personal Web Server for Windows 95</li>
</ul>
<p>
On this machine, machine B, we'll set up the <b><code>ATLFinder.exe</code></b> COM server class, and we will set pointers to the <b><code>ATLDept.dll </code></b>class that will be residing on machine C. To prepare the machine for serving ATLFinder objects, perform the following steps:</p>
<OL>
<li>
Copy <b><code>Regsvr32.exe</code></b> into <b><code>\Windows\System</code></b> directory if it's not already there.<br><br></li>
<li>
Copy the ATL support DLL,<b><code> atl.dll</code></b>, over to <b><code>\Windows\System</code></b> directory.<br><br></li>
<li>
Run <b><code>regsvr32 atl.dll</code></b>.<br><br></li>
<li>
Copy the <b><code>ATLFinder.exe</code></b> file over to a working directory.<br><br></li>
<li>
Run <b><code>ATLFinder /RegServer</code></b> to create the registry entries.</li>
</ol>
<p>
This is all that's needed for ATLFinder. In order to create the link to the required ATLDept objects, we need to do the following:</p>
<OL>
<li>
Copy the <b><code>ATLDept.dll</code></b> file over to the working directory.<br><br></li>
<li>
Run <b><code>regsvr32 ATLDept.DLL</code></b>.<br><br></li>
<li>
Remove the <b><code>ATLDept.dll</code></b> file.<br><br></li>
<li>
Start <b><code>Oleview.exe</code></b>, select ATLDept1 Class on the left pane, and the Implementation tab on the right pane.<br><br></li>
<li>
Select the Inproc Server tab and remove the Path to Implementation content.<br><br></li>
<li>
Select the Activation tab on the right pane, click the <u>L</u>aunch as Interactive User check box, and enter in the IP address of machine C into the <u>R</u>emote Machine Name edit.</li>
</ol>
<p>
This machine is now ready to support calls to ATLFinder1 classes and remote calls to ATLDept1 classes. Before moving on to set up machine C, it's a good idea to test the setup between machine A and machine B. To do this, we again acquire the assistance of <b><code>Oleview.exe</code></b>:</p>
<OL>
<li>
Start the ATLFinder server on machine B by typing <b><code>ATLFinder /Server</code></b> at the command line.<br><br></li>
<li>
Start <b><code>Oleview.exe</code></b> on machine A.<br><br></li>
<li>
Find the ATLFinder1 Class entry on the left pane and double-click on it.</li>
</ol>
<p>
If everything is setup correctly, after a little delay, you should see ATLFinder being expanded on the left pane with all its interfaces exposed. The ATLFinder1 Class entry is also in bold to indicate that an instance has been created successfully. </p>
<p>
<img src="03750912.gif" border=0></p>
<p>
Using Object Viewer, you can then select the <u>O</u>bject menu and Release Instance to release the selected instance.</p>
<p>
This concludes and confirms the setup of machine B. </p>
<p>
In actual deployment, under certain design circumstances, one may need to install the middle tier server components (such as ATLFinder) repeatedly on different systems. In these cases, of course, the Setup toolkit that comes with Visual C++ 5.0 may be used to create a setup script which can perform all of the above for us when the server object is installed on the system.</p>
</BODY>
</HTML>
