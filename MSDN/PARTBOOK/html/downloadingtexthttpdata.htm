<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Downloading Text HTTP Data</title>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana,arial,helvetica" size="2"><h1><a name="downloadingtexthttpdata"></a>Downloading Text HTTP Data</h1>
<p>
Let&#39;s use the HTTP protocol in a program. We&#39;ll download the Microsoft Visual Basic Web page itself using the HTTP protocol. This page is named default.htm, and it resides at http://www.microsoft.com/vbasic. Let&#39;s name this new program HTTPer. Create that project in Visual Basic, making it an SDI program with the Application Wizard. Then add a rich text box (RichTextbox1) and an Internet Transfer control (Inet1) as we did in the previous example, FTPer:</p>
<p>
<b><img src="img03_06.gif" border=0></b></p>
<p>
Now we add a new item to the File menu&mdash;<b>Get File</b>&mdash;using the Visual Basic Menu Editor. When the user clicks this item, we&#39;ll download the HTML of the Visual Basic Web page. As with FTPer, place this item after the <b>Close</b> item in the File menu and give it the name <b>GetFile</b>. Now open that item&#39;s click event handler:</p>
<pre><code>Private Sub GetFile_Click()
End Sub</code></pre>
<p>
To get the Visual Basic Web page, we use OpenURL() as we have before in this chapter. Because the URL we are opening is prefaced http:, OpenURL() will use the HTTP protocol. We open the Web page and place its text into our rich text box this way:</p>
<pre><code>Private Sub GetFile_Click()
&mdash;&gt; RichTextBox1.Text =
        Inet1.OpenURL("http://www.microsoft.com/vbasic/default.htm")
        .
        .
        .
End Sub</code></pre>
<p>
That&#39;s all there is to it. Now we can download HTML files using the HTTP protocol. When we run our program, the result appears in Figure 3.3.</p>
<p>
<img src="fig03-03.gif" border=0><b>&nbsp;</p>
<p>Downloading the microsoft.com Visual Basic Web page.</b></p>
<p>
We can also download binary data using OpenURL(), and we&#39;ll take a look at that now.</p>
<h1></h1>
</font></BODY>
</HTML>
