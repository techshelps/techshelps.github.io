<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PersistentState Property for Resources</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_wolf_persistentstate_property_for_resources"></a>PersistentState Property for Resources</h2>
<p>
The PersistentState property describes the last known persistent state of the resource.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=25%>Type:</td>
<td width=75%>DWORD</td>
</tr>
<tr valign=top>
<td width=25%>Access:</td>
<td width=75%>Read/write</td>
</tr>
<tr valign=top>
<td width=25%>Function:</td>
<td width=75%><a href="clusapi_5hd8.htm"><b>ClusterResourceControl</b></a></td>
</tr>
<tr valign=top>
<td width=25%>Structure:</td>
<td width=75%><a href="clustruct_7vfo.htm"><b>CLUSPROP_DWORD</b></a></td>
</tr>
<tr valign=top>
<td width=25%>Control Code:</td>
<td width=75%><a href="clusctl_29f7.htm">CLUSCTL_RESOURCE_GET_COMMON_PROPERTIES</a></td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
When <b>ClusterResourceControl</b> processes the CLUSCTL_RESOURCE_GET_COMMON_PROPERTIES control code, it returns a <a href="cluguide_1e2b.htm">property list</a> that includes the PersistentState property as one of the entries. The property value portion of the entry contains a <b>CLUSPROP_DWORD</b> structure that is set as follows:</p>
<pre><code>DWORD PersistentStateData = FALSE;
CLUSPROP_DWORD PersistentStateValue;
PersistentStateValue.Syntax = CLUSPROP_SYNTAX_LIST_VALUE_DWORD;
PersistentStateValue.cbLength = sizeof(DWORD);
PersistentStateValue.dw = PersistentStateData;
 </code></pre>
<p>
The data value for the PersistentState property describes what should happen to the resource the next time the Cluster Service is started. Valid values are TRUE and FALSE. When PersistentState is set to TRUE, the resource should be brought online. When set to FALSE, it should be left offline. Typically, resources inherit their state from the state of the group to which they belong. When that state differs, as can happen when the group is online and the resource is offline, the PersistentState property of the resource is saved as FALSE. </p>
<p>
A resource remains offline until the network administrator manually brings it back online. When it is brought online, the resource's PersistentState property is deleted from the cluster database. Because a resource cannot be online if its group is offline, it makes no sense to save the resource's PersistentState property unless the resource is offline.</p>
<p>
To retrieve the current state of a resource, call the <a href="clusapi_34o5.htm"><b>GetClusterResourceState</b></a> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Version: </b>Use Windows NT Server Enterprise Edition 4.0.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in clusapi.h.</p>
<p>&nbsp;</p></body>
</HTML>
