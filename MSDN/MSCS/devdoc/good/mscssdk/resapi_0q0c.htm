<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ResourceTypeControl</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_wolf_resourcetypecontrol"></a>ResourceTypeControl</h2>
<p>
The <b>ResourceTypeControl</b> entry point function performs an operation that applies to a resource type.</p>
<pre><code><b>DWORD WINAPI ResourceTypeControl(
  LPCWSTR</b><i> ResourceTypeName</i><b>,  </b>
<b>  DWORD</b><i> ControlCode</i><b>,     </b>
<b>  LPVOID</b><i> InBuffer</i><b>,       </b>
<b>  DWORD</b><i> InBufferSize</i><b>,    </b>
<b>  LPVOID</b><i> OutBuffer</i><b>,      </b>
<b>  DWORD</b><i> OutBufferSize</i><b>,   </b>
<b>  LPDWORD</b><i> BytesReturned  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ResourceTypeName</i></dt>
<dd>
[in] Type of resource to be affected by the operation.</dd>
<dt>
<i>ControlCode</i></dt>
<dd>
[in] Control code that represents the operation to be performed. For a list of all valid values for the <i>ControlCode</i> parameter, see <a href="clusctl_6soj.htm">Control Codes for Resource Types</a>. </dd>
<dt>
<i>InBuffer</i></dt>
<dd>
[in] Pointer to a buffer containing data to be used in the operation. <i>InBuffer</i> can be NULL if the operation does not require data.</dd>
<dt>
<i>InBufferSize</i></dt>
<dd>
[in] Size, in bytes, of the buffer pointed to by <i>InBuffer</i>.</dd>
<dt>
<i>OutBuffer</i></dt>
<dd>
[out] Pointer to a buffer containing data resulting from the operation. <i>OutBuffer</i> can be NULL if the operation returns no data.</dd>
<dt>
<i>OutBufferSize</i></dt>
<dd>
[in] Size, in bytes, of the available space pointed to by <i>OutBuffer</i>.</dd>
<dt>
<i>BytesReturned</i></dt>
<dd>
[out] Number of bytes in the buffer pointed to by <i>OutBuffer</i> that actually contain data.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_SUCCESS</dt>
<dd>
The operation indicated by <i>ControlCode</i> was completed successfully.</dd>
<dt>
ERROR_INVALID_FUNCTION</dt>
<dd>
The resource DLL may not support the operation represented by <i>ControlCode</i>. In some cases this is a signal to the Resource Monitor for it to process the request.
</dd>
</dl>
<p>
If the operation was unsuccessful, <b>ResourceTypeControl</b> should return a Win32 error value.</p>
<h4>Notes to Implementers</h4>
<p>
<b>ResourceTypeControl</b> should be implemented by all resource DLLs. However, it is not necessary to provide code to handle all of the control codes that are defined for resource types. As a minimum, you should support the following control codes that manipulate private properties:
<ul>
<li>
<a href="clusctl_1smr.htm">CLUSCTL_RESOURCE_TYPE_ENUM_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_3kmr.htm">CLUSCTL_RESOURCE_TYPE_GET_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_8fjn.htm">CLUSCTL_RESOURCE_TYPE_GET_RO_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_7nw3.htm">CLUSCTL_RESOURCE_TYPE_SET_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_77ar.htm">CLUSCTL_RESOURCE_TYPE_VALIDATE_PRIVATE_PROPERTIES</a></li>
</ul>
<p>
If your resource type has required dependencies, you must support <a href="clusctl_5gdv.htm">CLUSCTL_RESOURCE_TYPE_GET_REQUIRED_DEPENDENCIES</a>. </p>
<p>
If your resource type needs to replicate a portion of the system registry, you must support <a href="clusctl_24xf.htm">CLUSCTL_RESOURCE_TYPE_GET_REGISTRY_CHECKPOINTS</a>. </p>
<p>
Support for any of the other control codes is optional. To determine how and why to support a particular control code, see its reference entry in the documentation. It is preferable not to provide support for some of the codes because they depend on the standard processing that the Resource Monitor supplies. In particular, do not include support for <a href="clusctl_34xf.htm">CLUSCTL_RESOURCE_TYPE_GET_CHARACTERISTICS</a> because it is important not to override the processing provided by the Resource Monitor. </p>
<p>
To request that the Resource Monitor process a control code, return ERROR_INVALID_FUNCTION. You can return this value for a control code regardless of whether you include support for the code in <b>ResourceTypeControl</b>. Some resource DLLs support a control code to augment the functionality that the Resource Monitor supplies. </p>
<p>
If at all possible, make your implementation of <b>ResourceTypeControl </b>finish in less than 300 milliseconds.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Version: </b>Use Windows NT Server Enterprise Edition 4.0.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in resapi.h.</p>
<p>&nbsp;</p></body>
</HTML>
