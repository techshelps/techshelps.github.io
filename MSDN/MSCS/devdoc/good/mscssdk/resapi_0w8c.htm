<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ResourceControl</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_wolf_resourcecontrol"></a>ResourceControl</h2>
<p>
The <b>ResourceControl</b> entry point function performs an operation that applies to a resource. </p>
<pre><code><b>DWORD WINAPI ResourceControl(
  RESID</b><i> ResourceId</i><b>,     </b>
<b>  DWORD</b><i> ControlCode</i><b>,    </b>
<b>  LPVOID</b><i> InBuffer</i><b>,      </b>
<b>  DWORD</b><i> InBufferSize</i><b>,   </b>
<b>  LPVOID</b><i> OutBuffer</i><b>,     </b>
<b>  DWORD</b><i> OutBufferSize</i><b>,  </b>
<b>  LPDWORD</b><i> BytesReturned </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ResourceId</i></dt>
<dd>
[in] Resource identifier of the affected resource. </dd>
<dt>
<i>ControlCode</i></dt>
<dd>
[in] <a href="clusctl_26nn.htm">Control code</a> that represents the operation to be performed. For a list of the valid values for the <i>ControlCode</i> parameter, see <a href="clusctl_26nn.htm">Control Codes for Resources</a>. </dd>
<dt>
<i>InBuffer</i></dt>
<dd>
[in] Pointer to a buffer containing data to be used in the operation. <i>InBuffer</i> can be NULL if no data is required.</dd>
<dt>
<i>InBufferSize</i></dt>
<dd>
[in] Size, in bytes, of the buffer pointed to by <i>InBuffer</i>.</dd>
<dt>
<i>OutBuffer</i></dt>
<dd>
[out] Pointer to a buffer containing data resulting from the operation. <i>OutBuffer</i> can be NULL if the operation does not need to return data.</dd>
<dt>
<i>OutBufferSize</i></dt>
<dd>
[in] Size, in bytes, of the available space pointed to by <i>OutBuffer</i>.</dd>
<dt>
<i>BytesReturned</i></dt>
<dd>
[out] Number of bytes in the buffer pointed to by <i>OutBuffer</i> that actually contain data. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_SUCCESS</dt>
<dd>
The operation associated with <i>ControlCode</i> was completed successfully.</dd>
<dt>
ERROR_INVALID_FUNCTION</dt>
<dd>
The resource DLL may not support the operation represented by <i>ControlCode</i>. In some cases this is a signal to the Resource Monitor for it to process the request.
</dd>
</dl>
<p>
If the operation was unsuccessful, <b>ResourceControl</b> returns a Win32 error value.</p>
<h4>Notes to Implementers</h4>
<p>
<b>ResourceControl</b> should be implemented by all resource DLLs. However, it is not necessary to provide code to handle all of the control codes that are defined for resources. As a minimum, you should support the following control codes that manipulate private properties:
<ul>
<li>
<a href="clusctl_9i5v.htm">CLUSCTL_RESOURCE_ENUM_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_3dpv.htm">CLUSCTL_RESOURCE_GET_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_59yr.htm">CLUSCTL_RESOURCE_GET_RO_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_7gz7.htm">CLUSCTL_RESOURCE_SET_PRIVATE_PROPERTIES</a></li>
<li>
<a href="clusctl_4alv.htm">CLUSCTL_RESOURCE_VALIDATE_PRIVATE_PROPERTIES</a></li>
</ul>
<p>
Without support for CLUSCTL_RESOURCE_GET_PRIVATE_PROPERTIES, you will not be able to set nonstring private properties on a newly created resource using the command-line tool CLUSTER.EXE. Without support for CLUSCTL_RESOURCE_SET_PRIVATE_PROPERTIES, you will not be able to validate the properties before setting them.</p>
<p>
Without support for CLUSCTL_RESOURCE_VALIDATE_PRIVATE_PROPERTIES, Cluster Administrator will not be able to automatically validate your private properties before setting them. </p>
<p>
If resources handled by your resource DLL have required dependencies, you must support <a href="clusctl_2asz.htm">CLUSCTL_RESOURCE_GET_REQUIRED_DEPENDENCIES</a>. </p>
<p>
If your resource DLL needs to replicate a portion of the system registry, you must support <a href="clusctl_5iwj.htm">CLUSCTL_RESOURCE_GET_REGISTRY_CHECKPOINTS</a>. </p>
<p>
Support for any of the other control codes is optional. To determine how and why to support a particular control code, see its reference entry in the documentation. It is preferable not to provide support for some of the codes because they depend on the standard processing that the Resource Monitor supplies. In particular, do not include support for <a href="clusctl_5woj.htm">CLUSCTL_RESOURCE_GET_CHARACTERISTICS</a> because it is important not to override the processing provided by the Resource Monitor. </p>
<p>
To request that the Resource Monitor process a control code, return ERROR_INVALID_FUNCTION. You can return this value for a control code regardless of whether you include support for the code in <b>ResourceControl</b>. Some resource DLLs support a control code to augment the functionality that the Resource Monitor supplies. </p>
<p>
If at all possible, make your implementation of <b>ResourceControl</b> finish in less than 300 milliseconds.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Version: </b>Use Windows NT Server Enterprise Edition 4.0.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in resapi.h.</p>
<p>&nbsp;</p></body>
</HTML>
