<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DllRegisterServer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_wolf_dllregisterserver"></a>DllRegisterServer</h2>
<p>
The <b>DllRegisterServer</b> function registers a Cluster Administrator extension DLL with the COM library by adding information to the Microsoft® Windows NT® system registry.</p>
<pre><code><b>STDAPI DllRegisterServer(</b>void<b>);</b>
 </code></pre>
<h4>Remarks</h4>
<p>
Client-side registration must be done on each computer on which Cluster Administrator runs. </p>
<p>
When Cluster Administrator calls the OLE function <b>CoCreateInstance</b>, the system registry is examined to find out how to load the extension. Since the Cluster Administrator extension is providing the user interface, the extension must be implemented as an in-process (INPROC) server.</p>
<p>
In order for <b>CoCreateInstance</b> to find the correct server, its CLSID must be registered under HKEY_CLASSES_ROOT\CLSID. At the root, an empty-named value must contain the name of the Cluster Administrator extension. Three subkeys are situated below the root: 
<ul>
<li>
InProcServer32</li>
<li>
ProgID</li>
<li>
VersionIndependentProgID </li>
</ul>
<p>
An empty-named value must be defined at the InProcServer32 key to contain the path to the extension DLL. An empty-named value must be defined at the ProgID and VersionIndependentProgID keys to contain the short name of the extension.</p>
<p>
To complete the registration, create a key at "HKEY_CLASSES_ROOT\CLUADMEX.&lt;short name of extension&gt;". An empty-named value must be defined there with the name of the extension. Below that, a CLSID key must be defined, with an empty-named value containing the extension CLSID.</p>
<p>
Here is an example of the registry entries for a Cluster Administrator extension named FileSmpEx with a CLSID of {00000000-0000-0000-0000-000000000000}:</p>
<pre><code>HKEY_CLASSES_ROOT

CLSID {00000000-0000-0000-0000-000000000000} = 
Cluster Administrator File Share Sample Extension (FileSmpEx) 1.0
InprocServer32 = filesmpex.dll
ProgID = CLUADMEX.FileSmpEx
VersionIndependentProgID = CLUADMEX.FileSmpEx
CLUADMEX.FileSmpEx = Cluster Administrator File Share Sample Extension(FileSmpEx) 1.0
CLSID = {00000000-0000-0000-0000-000000000000}
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Version: </b>Use Windows NT Server Enterprise Edition 4.0.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in cluadmex.h.</p>
<p>&nbsp;</p></body>
</HTML>
