<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cluster Administrator Extension Registration Functions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_wolf_cluster_administrator_extension_registration_functions"></a>Cluster Administrator Extension Registration Functions</h1>
<p>
A Cluster Administrator extension DLL must be registered for each computer that is running Cluster Administrator. There are two parts to the registration:
<ul>
<li>
Registering the extension with the cluster.</li>
<li>
Registering the extension with the COM library.</li>
</ul>
<p>
To register a Cluster Administrator extension with a cluster, implement the <a href="cluadmex_6d2m.htm"><b>DllRegisterCluAdminExtension</b></a> entry point function. <b>DllRegisterCluAdminExtension</b> creates or modifies the <a href="cluprops_8w4z.htm">AdminExtensions</a> property for the resource type supported by the extension. <b>DllRegisterCluAdminExtension</b> is exported only by Cluster Administrator extensions.</p>
<p>
To register a Cluster Administrator extension with the COM library, implement the <a href="cluadmex_9dpu.htm"><b>DllRegisterServer</b></a> entry point function. <b>DllRegisterServer </b>registers the extension by creating two new keys in the system registry: a key for the ProgId below HKEY_CLASSES_ROOT and a key for the CLSID below HKEY_CLASSES_ROOT\CLSID. <b>DllRegisterServer</b> is exported by all COM servers.</p>
<p>
Applications that need to register an extension should call a program named <a href="cluadmex_0lil.htm"><b>REGCLADM.EXE</b></a>. <b>REGCLADM</b> calls both the <b>DllRegisterCluAdminExtension</b> and <b>DllRegisterServer </b>entry point functions to take care of both types of registration. Setup programs that need to register extension DLLs must be modified to also call these entry point functions. However, if the setup program is run on a non-cluster node, only the COM registration must be performed. Cluster registration should occur only when the extension is running on a node in a cluster. </p>
<p>
Because it is necessary at times to cancel registration, the Cluster Administrator Extension API defines two entry point functions for that purpose: <a href="cluadmex_9zu6.htm"><b>DllUnregisterCluAdminExtension</b></a> and <a href="cluadmex_4g1e.htm"><b>DllUnregisterServer</b></a>. As with <b>DllRegisterCluAdminExtension</b>, <b>DllUnregisterCluAdminExtension</b> is specific to Cluster Administrator extensions. As with <b>DllRegisterServer</b>, <b>DllUnregisterServer</b> is exported by all COM servers.</p>
<p>
The following table briefly describes the two registration functions and the functions that can be used to cancel registration:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Function</th>
<th align=left width=51%>Description</th>
</tr>
<tr valign=top>
<td width=49%><a href="cluadmex_6d2m.htm"><b>DllRegisterCluAdminExtension</b></a></td>
<td width=51%>Registers a Cluster Administrator extension DLL with the cluster by adding information to the cluster database.</td>
</tr>
<tr valign=top>
<td width=49%><a href="cluadmex_9dpu.htm"><b>DllRegisterServer</b></a></td>
<td width=51%>Registers a Cluster Administrator extension DLL with COM by adding information to the Microsoft® Windows NT® system registry.</td>
</tr>
<tr valign=top>
<td width=49%><a href="cluadmex_9zu6.htm"><b>DllUnregisterCluAdminExtension</b></a></td>
<td width=51%>Cancels the registration of a Cluster Administrator extension DLL with the cluster by removing information from the cluster database.</td>
</tr>
<tr valign=top>
<td width=49%><a href="cluadmex_4g1e.htm"><b>DllUnregisterServer</b></a></td>
<td width=51%>Cancels the registration of a Cluster Administrator extension DLL with COM by removing information from the Windows NT system registry.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
