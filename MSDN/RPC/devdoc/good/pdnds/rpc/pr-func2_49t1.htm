<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RpcNsMgmtHandleSetExpAge</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_rpcnsmgmthandlesetexpage"></a>RpcNsMgmtHandleSetExpAge</h1>
<p>
The <b>RpcNsMgmtHandleSetExpAge</b> function sets the expiration age of a name-service handle for local copies of name-service data.</p>
<pre><code><b>#include &lt;rpc.h&gt;
RPC_STATUS RPC_ENTRY RpcNsMgmtHandleSetExpAge( 
  RPC_NS_HANDLE </b><i> NsHandle</i><b>,   </b>
<b>  unsigned long </b><i> ExpirationAge  </i>
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>NsHandle</i></dt>
<dd>
Specifies a name-service handle that an expiration age is set for. A name-service handle is returned from a name-service "begin" operation.</dd>
<dt>
<i>ExpirationAge</i></dt>
<dd>
Specifies an integer value in seconds that sets the expiration age of local name-service data read by all "next" routines using the specified <i>NsHandle</i> argument.
<p>
An expiration age of 0 causes an immediate update of the local name-service data.

</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=59%>Value</th>
<th align=left width=41%>Meaning</th>
</tr>
<tr valign=top>
<td width=59%>RPC_S_OK</td>
<td width=41%>Success</td>
</tr>
<tr valign=top>
<td width=59%>RPC_S_NAME_SERVICE_UNAVAILABLE</td>
<td width=41%>Name service unavailable</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>RpcNsMgmtHandleSetExpAge</b> routine sets a handle-expiration age for a specified name-service handle (<i>NsHandle</i>). The expiration age is the amount of time that a local copy of data from a name-service attribute can exist before a request from the application for the attribute requires updating the local copy. When an application begins running, the RPC run-time library specifies a default expiration age of two hours. The default is global to the application. A handle-expiration age applies only to a specific name-service handle and temporarily overrides the current global expiration age.</p>
<p>
Normally, you should avoid using <b>RpcNsMgmtHandleSetExpAge</b>; instead, you should rely on the application's global expiration age.</p>
<p>
A handle-expiration age is used exclusively by name-service "next" operations (which read data from name-service attributes). A "next" operation normally starts by looking for a local copy of the attribute data being requested by an application. In the absence of a local copy, the "next" operation creates one with fresh attribute data from the name-service database. If a local copy already exists, the operation compares its actual age to the expiration age being used by the application (which in this case is the expiration age set for the name-service handle). If the actual age exceeds the handle-expiration age, the operation automatically tries to update the local copy with fresh attribute data. If updating is impossible, the old local data remains in place and the "next" operation fails, returning the RPC_S_NAME_SERVICE_UNAVAILABLE status code.</p>
<p>
The scope of a handle-expiration age is a single series of "next" operations. The <b>RpcNsMgmtHandleSetExpAge</b> routine operates within the following context:
<ul>
<li>
A "begin" operation creates a name-service handle.</li>
<li>
A call to the <b>RpcNsMgmtHandleSetExpAge</b> routine creates an expiration age for the handle.</li>
<li>
A series of "next" operations for the name-service handle uses the handle expiration age.</li>
<li>
A "done" operation for the name-service handle deletes both the handle and its expiration age.</li>
</ul>
<p>
Setting the handle-expiration age to a small value causes the name-service "next" operations to frequently update local data for any name-service attribute requested by your application. For example, setting the expiration age to 0 forces the "next" operation to update local data for the name-service attribute requested by your application. Therefore, setting a small handle-expiration age can create performance problems for your application. Furthermore, if your application is using a remote name-service server, a small expiration age can adversely affect network performance for all applications.</p>
<p>
Limit the use of <b>RpcNsMgmtHandleSetExpAge</b> to the following situations:
<ul>
<li>
When you must always get accurate name-service data.<p>
For example, during management operations to update a profile, you may need to always see the profile's current contents. In this case, before beginning to inquire about a profile, your application should call the <b>RpcNsMgmtHandleSetExpAge</b> routine and specify 0 for the <i>ExpirationAge</i> argument.
</li>
<li>
When a request using the default expiration age has failed, and your application needs to retry the operation.<p>
For example, a client application using name-service "import" operations should first try to obtain bindings using the application's default expiration age. However, sometimes the "import-next" operation returns either no binding handles or an insufficient number of them. In this case, the client could retry the "import" operation and, after the <b>RpcNsBindingImportBegin</b> call, include a <b>RpcNsMgmtHandleSetExpAge</b> call and specify 0 for the <i>ExpirationAge</i> argument. When the client calls the "import-next" routine again, the small handle-expiration age causes the "import-next" operation to update the local attribute data.
</li>
</ul>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in rpcnsi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with rpcns4.lib.</p>
<h4>See Also</h4>
<p>
<a href="pr-func1_001a.htm"><b>RpcNsBindingImportBegin</b></a>, <a href="pr-func2_4wbp.htm"><b>RpcNsMgmtInqExpAge</b></a>, <a href="pr-func2_38yt.htm"><b>RpcNsMgmtSetExpAge</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
