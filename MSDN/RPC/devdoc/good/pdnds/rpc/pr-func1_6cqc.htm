<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RpcNsBindingImportNext</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_rpcnsbindingimportnext"></a>RpcNsBindingImportNext</h1>
<p>
The <b>RpcNsBindingImportNext</b> function looks up an interface, and optionally an object from a name-service database, and returns a binding handle of a compatible server (if found).</p>
<pre><code><b>#include &lt;rpc.h&gt;
RPC_STATUS RPC_ENTRY RpcNsBindingImportNext( 
  RPC_NS_HANDLE </b><i> ImportContext</i><b>,</b>   
<b>  RPC_BINDING_HANDLE * </b><i> Binding  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ImportContext</i></dt>
<dd>
Specifies a name-service handle returned from the <b>RpcNsBindingImportBegin</b> routine.</dd>
<dt>
<i>Binding</i></dt>
<dd>
Returns a pointer to a client-compatible server binding handle for a server.
</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=59%>Value</th>
<th align=left width=41%>Meaning</th>
</tr>
<tr valign=top>
<td width=59%>RPC_S_OK</td>
<td width=41%>Success</td>
</tr>
<tr valign=top>
<td width=59%>RPC_S_NO_MORE_BINDINGS</td>
<td width=41%>No more bindings</td>
</tr>
<tr valign=top>
<td width=59%>RPC_S_NAME_SERVICE_UNAVAILABLE</td>
<td width=41%>Name service unavailable</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>RpcNsBindingImportNext</b> routine returns one client-compatible server binding handle for a server offering the interface and object UUID specified by the <i>IfSpec</i> and <i>ObjUuid</i> arguments in the <b>RpcNsBindingImportBegin</b> routine. The <b>RpcNsBindingImportNext</b> routine communicates only with the name-service database, not directly with servers. </p>
<p>
Effective with version 5.0 of Windows NT, the RPC environment uses the Active Directory as its name service database and the order in which the runtime environment performs the lookup is as follows:
<ul>
<li>
Lookup in the local cache. If there is no entry,</li>
<li>
Lookup in the Active Directory. If there is no entry,</li>
<li>
Send broadcast requests to all other Directory Services in the domain.<br>
Note that if the entry exists in the Active Directory, but there is no information associated with the entry, the runtime will not issue this broadcast request.</li>
</ul>
<p>
The returned compatible binding handle always contains an object UUID. Its value depends on the <i>ObjUuid</i> argument value specified in the <b>RpcNsBindingImportBegin</b> routine as follows:
<ul>
<li>
If a non-nil object UUID was specified, the returned binding handle contains that object UUID.</li>
<li>
If a nil object UUID or null value was specified, the object UUID returned in the binding handle depends on how the server exported object UUIDs:<ul>
<li>
If the server did not export any object UUIDs, the returned binding handle contains a nil object UUID.</li>
<li>
If the server exported one object UUID, the returned binding handle contains that object UUID.</li>
<li>
If the server exported multiple object UUIDs, the returned binding handle contains one of the object UUIDs. The import-next operation selects the returned object UUID in a non-deterministic fashion. As a result, a different object UUID can be returned for each compatible binding handle from a single server entry.</li>
</ul>
</li>
</ul>
<p>
The <b>RpcNsBindingImportNext</b> routine selects and returns one server binding handle from the compatible binding handles found. The client application can use that binding handle to attempt to make a remote procedure call to the server. If the client fails to establish a relationship with the server, it can call the <b>RpcNsBindingImportNext</b> routine again.</p>
<p>
Each time the client calls the <b>RpcNsBindingImportNext</b> routine, the routine returns another server binding handle. The returned binding handles are unordered.</p>
<p>
A client application calls the <b>RpcNsBindingInqEntryName</b> routine to obtain the name-service database in the entry name from which the binding handle came.</p>
<p>
When the search reaches the end of the name-service database, the routine returns a status of RPC_S_NO_MORE_BINDINGS and returns a binding argument value of NULL.</p>
<p>
The <b>RpcNsBindingImportNext</b> routine allocates storage for the data referenced by the returned <i>Binding</i> argument. When a client application finishes with the binding handle, it must call the <b>RpcBindingFree</b> routine to deallocate the storage. Each call to the <b>RpcNsBindingImportNext</b> routine requires a corresponding call to the <b>RpcBindingFree</b> routine.</p>
<p>
The client is responsible for calling the <b>RpcNsBindingImportDone</b> routine. <b>RpcNsBindingImportDone</b> deletes the import context. The client also calls the <b>RpcNsBindingImportDone</b> routine if the application wants to start a new search for compatible servers (by calling the <b>RpcNsBindingImportBegin</b> routine). The order of binding handles returned is different for each new search. This means the order in which binding handles are returned to an application can be different each time the application is run.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in rpcnsi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with rpcns4.lib.</p>
<h4>See Also</h4>
<p>
<a href="pr-func1_86n9.htm"><b>RpcBindingFree</b></a>, <a href="pr-func1_001a.htm"><b>RpcNsBindingImportBegin</b></a>, <a href="pr-func1_1145.htm"><b>RpcNsBindingImportDone</b></a>, <a href="pr-func1_3kbp.htm"><b>RpcNsBindingInqEntryName</b></a>, <a href="pr-func1_4i7i.htm"><b>RpcNsBindingLookupBegin</b></a>, <a href="pr-func1_3aed.htm"><b>RpcNsBindingLookupDone</b></a>, <a href="pr-func1_8m0k.htm"><b>RpcNsBindingLookupNext</b></a>, <a href="pr-func1_8uno.htm"><b>RpcNsBindingSelect</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
