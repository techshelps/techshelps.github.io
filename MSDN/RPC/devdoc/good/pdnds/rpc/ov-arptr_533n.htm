<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Default Pointer Types for Pointers</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_rpc_default_pointer_types_for_pointers"></a>Default Pointer Types for Pointers</h2>
<p>
The MIDL compiler offers three different default cases for pointers that do not have pointer attributes at definition time: 
<ul>
<li>
Function parameters that are top-level pointers default to <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_ref">
</object><a href=JavaScript:alink_1.Click()><b>ref</b></a> pointers. </li>
<li>
Pointers embedded in structures and pointers to other pointers (non-top-level pointers) default to the type specified by the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_pointer_default">
</object><a href=JavaScript:alink_2.Click()><b>pointer_default</b></a> attribute. </li>
<li>
When no <b>pointer_default</b> attribute is supplied, non-top-level pointers default to <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_unique">
</object><a href=JavaScript:alink_3.Click()><b>unique</b></a> pointers in MIDL's default (<u>Microsoft-extensions</u>) mode, and to <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_ptr">
</object><a href=JavaScript:alink_4.Click()><b>ptr</b></a> in DCE-compatible mode.</li>
</ul>
<p>
A pointer returned by a function must be a unique or full pointer. The MIDL compiler reports an error if a function result is, either explicitly or by default, a reference pointer. The returned pointer always indicates new storage because there is not enough information for the stubs to determine whether there is existing storage in the caller address space for pointer-valued function results.</p>
<p>
Functions that return a pointer value can specify a pointer attribute as a function attribute. If a pointer attribute is not present, the function return pointer uses the value provided by the pointer_default attribute.</p>
<p>
<b>Note</b>&nbsp;&nbsp;To ensure unambiguous pointer-attribute behavior, always use explicit pointer attributes when defining a pointer.</p>
<p>&nbsp;</p></body>
</HTML>
