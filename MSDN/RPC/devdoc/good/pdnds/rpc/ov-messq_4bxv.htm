<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Developing RPC-MQ Applications</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_developing_rpc_mq_applications"></a>Developing RPC-MQ Applications</h1>
<p>
Very little effort is necessary to take advantage of the MSMQ transport in your RPC application. For synchronous messaging you need only specify the message queue transport (<b>ncadg_mq</b>) as the protocol sequence. The <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_ncadg_mq">
</object><a href=JavaScript:alink_1.Click()><b>ncadg_mq</b></a><b> </b>protocol supports all of the standard datagram features except broadcasting calls. Also, note that currently the message-queue transport does not support dynamic endpoints.</p>
<p>
By applying the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_message">
</object><a href=JavaScript:alink_2.Click()><b>message</b></a> attribute to remote procedure declarations in the IDL file, you automatically implement asynchronous-mode message queuing for those calls, and make it possible for the client and server applications to control many of the properties associated with messages and message queues, including: 
<ul>
<li>
Quality of delivery.</li>
<li>
Acknowledgement of receipt.</li>
<li>
Journaling.</li>
<li>
Call priority.</li>
<li>
Persistence of Server Process Queue. </li>
</ul>
<p>
Quality of delivery is the effort that the transport will go to in order to deliver the call to the server process. An express delivery will be queued in memory, so it is fairly fast, but the call will be lost if a machine or network connection goes down at the wrong time. A recoverable delivery will be posted to a disk file until it is delivered, so the call will not be lost, even in the face of a machine crash. This gives guaranteed delivery, but at a cost in performance as each call is written to disk. </p>
<p>
You can also tell the MSMQ transport to wait for an acknowledgment that the call made it to the destination (server) queue before returning. Choosing this option blocks the client until the server acknowledges the call, otherwise control returns to the client immediately upon making the call.</p>
<p>
By using journaling, calls can be logged to disk. If journaling is turned on, then each call is logged to disk as it is transmitted to the next hop on its way to the server process. </p>
<p>
Call priority can be used in conjunction with the RPC <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_message">
</object><a href=JavaScript:alink_3.Click()><b>message</b></a> function attribute to allow calls with higher priority to take precedence over calls with lower priority, even if they arrived later. Call priority will also work in a limited fashion with synchronous RPC, but synchronous RPC calls cannot stack up in the same manner as asynchronous calls.</p>
<p>
The client process controls all of the above properties by calling <a href="pr-func1_3wku.htm"><b>RpcBindingSetOption</b></a><b>.</b> Once set, these properties remain in effect until they are changed in another call to <a href="pr-func1_3wku.htm"><b>RpcBindingSetOption</b></a>.</p>
<p>
The RPC server process can control the lifetime of its receive queue. By default the queue is deleted when the server processes exits. However, the server process can use <a href="pr-func2_4drs.htm"><b>RpcServerUseProtseqEpEx</b></a> when setting up its endpoint to tell the transport to allow the queue to continue to exist and accept call requests even when the server process is not running. In this case the calls are queued up and executed later, when the server process comes back on line. </p>
<p>
<b>Note</b>&nbsp;&nbsp;If you are using asynchronous<b> </b>(<b>message</b>) calls in an interface, then you must register the interface by calling <a href="pr-func2_25ye.htm"><b>RpcServerRegisterIf</b></a> or <a href="pr-func2_9prs.htm"><b>RpcServerRegisterIfEx</b></a> <i>before</i> calling <b>RpcServerUseProtseqEpEx(ncadg_mq)</b>. Once you turn on the protocol sequence, any calls already waiting on the queue for the server will begin to be read off the queue. If the corresponding RPC interface has not been registered, the calls will fail. This situation can happen if you have a setup a permanent endpoint for your remote procedure calls, the server has been shutdown, and clients have continued to send calls to the server. These calls will be stacked up in the queue, waiting to be read once the server comes back online.</p>
<h4>See Also</h4>
<p>
<a href="pr-func1_3wku.htm"><b>RpcBindingSetOption</b></a>, <a href="pr-func2_4drs.htm"><b>RpcServerUseProtseqEpEx</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_message">
</object><a href=JavaScript:alink_4.Click()><b>message</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_ncadg_mq">
</object><a href=JavaScript:alink_5.Click()><b>ncadg_mq</b></a></p>
<p>&nbsp;</p></body>
</HTML>
