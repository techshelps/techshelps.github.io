<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RpcBindingInqOption</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_rpcbindinginqoption"></a>RpcBindingInqOption</h1>
<p>
RPC client processes use <b>RpcBindingInqOption </b>to determine current values of the binding options that are specific to the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_ncadg_mq">
</object><a href=JavaScript:alink_1.Click()><b>ncadg_mq</b></a> message-queuing transport. This function is supported only on Windows NT, version 4.0 with Service Pack 3. Support for Windows 95 will be available with a forthcoming version of DCOM 95.</p>
<pre><code><b>#include &lt;rpc.h&gt;
RPC_STATUS RPC_ENTRY RpcBindingInqOption(
  RPC_BINDING_HANDLE </b><i> hBinding</i><b>,  </b>
<b>  unsigned long </b><i> Option</i><b>,         </b>
<b>  unsigned long *</b><i> pOptionValue</i>   
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hBinding</i></dt>
<dd>
The server binding about<i> </i>which to determine binding-option values.</dd>
<dt>
<i>Option</i></dt>
<dd>
The binding handle property to inquire about (see table in the Remarks section).</dd>
<dt>
<i>pOptionValue</i></dt>
<dd>
The memory location to place the value for the specified <i>Option</i> (see table in the Remarks section).
</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Value</th>
<th align=left width=47%>Meaning</th>
</tr>
<tr valign=top>
<td width=53%>RPC_S_OK</td>
<td width=47%>Success.</td>
</tr>
<tr valign=top>
<td width=53%>RPC_S_CANNOT_SUPPORT</td>
<td width=47%>The function is not supported for either the operating system or the transport. Note that calling <b>RpcBindingInqOption</b> on binding handles that use any protocol sequence other than <b>ncadg_mq</b> will fail and return this value.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
When you use the Microsoft Message Queue Server (MSMQ)as the transport mechanism for your RPC application, and you use asynchronous <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_message">
</object><a href=JavaScript:alink_2.Click()><b>message</b></a> calls, the client process can control certain binding-specific options that affect queue operation. </p>
<p>
Client processes call <b>RpcBindingInqOption</b> to determine the current settings of the message options. To inquire about authentication settings, the client must call <b>RpcBindingInqAuthClient</b>. The following table describes the message options and their possible values.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=27%>Option</th>
<th align=left width=35%>OptionValue</th>
<th align=left width=38%>Description</th>
</tr>
<tr valign=top>
<td width=27%>RPC_C_OPT_MQ<br>
_DELIVERY</td>
<td width=35%>RPC_C_MQ_EXPRESS (The default value.)</td>
<td width=38%>Remote calls to the server remain in active memory as they pass through the network.</td>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=35%>RPC_C_MQ<br>
_RECOVERABLE</td>
<td width=38%>Remote calls to the server are stored on disk until they are delivered and executed. This guarantees delivery even if the server goes down.</td>
</tr>
<tr valign=top>
<td width=27%>RPC_C_OPT_MQ<br>
_PRIORITY</td>
<td width=35%>0-7 (The default is 3.) </td>
<td width=38%>Calls with a higher priority number have precedence over calls with a lower priority number. </td>
</tr>
<tr valign=top>
<td width=27%>RPC_C_OPT_MQ<br>
_JOURNAL</td>
<td width=35%>RPC_MQ_JOURNAL<br>
_NONE (The default value.)</td>
<td width=38%>Calls are never logged</td>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=35%>RPC_C_MQ_JOURNAL<br>
_DEADLETTER</td>
<td width=38%>Calls are logged only when the message cannot be delivered. This can occur when the time specified in RPC_C_MQ_TIME_TO_<br>
REACH_QUEUE or RPC_C_MQ_TIME_TO_BE_<br>
RECEIVED expires before the message is delivered to the server, or the target queue no longer (of the server) no longer exists.</td>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=35%>RPC_MQ_JOURNAL<br>
_ALWAYS</td>
<td width=38%>Calls are always logged at the originating machine.</td>
</tr>
<tr valign=top>
<td width=27%>RPC_C_OPT_MQ<br>
_ACKNOWLEDGE</td>
<td width=35%>FALSE (The default value.)</td>
<td width=38%>Control returns to the client process immediately after the MSMQ transport receives the call.</td>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=35%>TRUE</td>
<td width=38%>The remote call blocks until it receives an acknowledgment that the call reached the server's receive queue.</td>
</tr>
<tr valign=top>
<td width=27%>RPC_C_OPT_MQ<br>
_TIME_TO_REACH<br>
_QUEUE</td>
<td width=35%>Time in seconds. The default value is INFINITE.</td>
<td width=38%>The amount of time allowed for a call to reach the Queue Manager on the target system. If the call times out before reaching the target system, it is discarded.</td>
</tr>
<tr valign=top>
<td width=27%>RPC_C_OPT_MQ<br>
_TIME_TO_<br>
BE_RECEIVED</td>
<td width=35%>Time in seconds. The default value is INFINITE.</td>
<td width=38%>The amount of time allowed for a call to reach the server-process receive queue on the target system. If the call times out before the RPC server application receives it, it is discarded.</td>
</tr>
</table><br>
<h4>See Also</h4>
<p>
<a href="pr-func1_3wku.htm"><b>RpcBindingSetOption</b></a>, <a href="#_rpc_rpcbindinginqoption"><b>RpcBindingInqOption</b></a>, <a href="pr-func1_3chb.htm"><b>RpcBindingSetAuthInfo</b></a>, <a href="pr-func1_5dkk.htm"><b>RpcBindingInqAuthClient</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_message">
</object><a href=JavaScript:alink_3.Click()><b>message</b></a>, <a href="ov-messq_5hlz.htm">RPC Message Queuing</a></p>
<p>&nbsp;</p></body>
</HTML>
