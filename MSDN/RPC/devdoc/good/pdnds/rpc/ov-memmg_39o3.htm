<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Length, Size, and Directional Attributes</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_rpc_length_size_and_directional_attributes"></a>Length, Size, and Directional Attributes</h2>
<p>
The size-related attributes <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_max_is">
</object><a href=JavaScript:alink_1.Click()><b>max_is</b></a> and <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_size_is">
</object><a href=JavaScript:alink_2.Click()><b>size_is</b></a> determine how many array elements the server stub allocates on the server.</p>
<p>
The length-related attributes <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_length_is">
</object><a href=JavaScript:alink_3.Click()><b>length_is</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_first_is">
</object><a href=JavaScript:alink_4.Click()><b>first_is</b></a>, and <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_last_is">
</object><a href=JavaScript:alink_5.Click()><b>last_is</b></a> determine how many elements are transmitted to both the server and the client. </p>
<p>
Different directional attribute(s) can be applied to a declarator and the parameter specified by a field attribute. However, some combinations of different directional attributes can cause errors when they are applied to the declarator and to the field attribute parameter. </p>
<p>
As an example, consider a procedure with two parameters, an array, and the transmitted length of the array. The italicized term <i>dir_attr</i> refers to the directional attribute applied to the parameter as:</p>
<pre><code>Proc1(
    [<i>dir_attr</i>] short * plength;
    [<i>dir_attr</i>, length_is(pLength)] short array[MAX_SIZE]);
 </code></pre>
<p>
The MIDL compiler behavior for each combination of directional attributes is described below:</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=11%><br>
Array</th>
<th align=left width=16%>Length parameter</th>
<th align=left width=37%>Stub actions during call<br>
from client to server</th>
<th align=left width=36%>Stub actions on return<br>
from server to client</th>
</tr>
<tr valign=top>
<td width=11%><object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_in">
</object><a href=JavaScript:alink_6.Click()><b>in</b></a></td>
<td width=16%><b>in</b></td>
<td width=37%>Transmit the length and the number of elements indicated by the parameter.</td>
<td width=36%>No data transmitted.</td>
</tr>
<tr valign=top>
<td width=11%><b>in</b></td>
<td width=16%><object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_out_idl">
</object><a href=JavaScript:alink_7.Click()><b>out</b></a></td>
<td width=37%>Not legal; MIDL compiler error.</td>
<td width=36%>Not legal; MIDL compiler error.</td>
</tr>
<tr valign=top>
<td width=11%><b>in</b></td>
<td width=16%><b>in</b>,<b> out</b></td>
<td width=37%>Transmit the length and the number of elements indicated by the length parameter.</td>
<td width=36%>Transmit the length only.</td>
</tr>
<tr valign=top>
<td width=11%><b>out</b></td>
<td width=16%><b>in</b></td>
<td width=37%>Transmit the length.<p>
If array size is fixed, allocate the array size on the server, but transmit no elements.</p>
<p>
If array size is not bound, not legal: MIDL compiler error.</p>
</td>
<td width=36%>Transmit the number of elements indicated by the length.<p>
Note that the length can be changed and can have a different value from the value on the client. Do not transmit the length.</p>
</td>
</tr>
<tr valign=top>
<td width=11%><b>out</b></td>
<td width=16%><b>out</b></td>
<td width=37%>Allocate space for the length parameter on the server but do not transmit the parameter.<p>
If the array size is fixed, allocate the array size on the server, but transmit no elements.</p>
<p>
If array size is not fixed, not legal: MIDL compiler error. </p>
</td>
<td width=36%>Transmit the length and the number of elements indicated by the length as set by the server application.</td>
</tr>
<tr valign=top>
<td width=11%><b>out</b></td>
<td width=16%><b>in</b>,<b> out</b></td>
<td width=37%>Transmit the length parameter.<p>
If the array size is bound, allocate the array size on the server, but transmit no elements. </p>
<p>
If array size is not bound, not legal: MIDL compiler error. </p>
</td>
<td width=36%>Transmit the length.<p>
Transmit the number of array elements indicated by the length.</p>
</td>
</tr>
<tr valign=top>
<td width=11%><b>in</b>,<b> out</b></td>
<td width=16%><b>in</b></td>
<td width=37%>Transmit the length and the number of elements indicated by the parameter.</td>
<td width=36%>Do not transmit the length.<p>
Transmit the number of elements indicated by the length.</p>
<p>
Note that the length can be changed and can have a different value from the original value on the client.</p>
</td>
</tr>
<tr valign=top>
<td width=11%><b>in</b>,<b> out</b></td>
<td width=16%><b>out</b></td>
<td width=37%>Not legal; MIDL compiler error.</td>
<td width=36%>Not legal; MIDL compiler error.</td>
</tr>
<tr valign=top>
<td width=11%><b>in</b>,<b> out</b></td>
<td width=16%><b>in</b>,<b> out</b></td>
<td width=37%>Transmit the length and the number of elements indicated by the parameter. </td>
<td width=36%>Transmit the length and the number of elements indicated by the parameter.</td>
</tr>
</table><br>
<p>
In general, you should not modify the length or size parameters on the server side. If you change the length parameter, you can orphan memory. For more information, see <a href="ov-memmg_7zvr.htm">Memory Orphaning</a>. </p>
<p>&nbsp;</p></body>
</HTML>
