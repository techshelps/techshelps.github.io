<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Importing Files and Type Libraries</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_rpc_importing_files_and_type_libraries"></a>Importing Files and Type Libraries</h2>
<p>
The MIDL keywords <b>include</b>, <b>import</b>, and <b>importlib</b> let you reuse code by referencing existing header, IDL, and ODL files, and compiled type libraries.</p>
<p>
The ACF<b> <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_include">
</object><a href=JavaScript:alink_1.Click()>include</a></b> directive lets you specify, within an ACF file, one or more C-language header files to be included in the MIDL-generated stub code. The generated file will have a line with a #include C-preprocessor directive with the indicated header file. Use this <b>include</b> directive to bring in header files that are specific to a particular operating environment and that do not contain information necessary for the interface between client and server. Do not use <b>include </b>for header files that contain data types that you want available to the IDL file; instead, use the <b>import </b>directive.</p>
<h4>Example</h4>
<pre><code>[auto_handle] interface X86PC
{ 
include "gendefs.h", "protos.h", "foo.h"; 
//interface typdefs and function declarations here
}
 </code></pre>
<p>
The IDL <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_import">
</object><a href=JavaScript:alink_2.Click()><b>import</b></a> directive is the standard method for bringing type and interface definitions from other IDL (or ODL) files and header files into your IDL file. All IDL statements in the imported file, such as typedefs, const declarations, and interface definitions become available to the importing .IDL file.</p>
<p>
Like the C-language preprocessor macro <b>#include</b>, the <b>import</b> directive tells the compiler to include data types that were defined in the imported IDL files. Unlike the <b>#include</b> directive, the <b>import</b> directive ignores procedure prototypes, since no stubs are generated for anything in the imported file. Because the preprocessor is invoked separately for the imported file, pre-processor directives (such as #define) do not carry over to the importing IDL file.</p>
<p>
For additional information on using <b>import</b> to include system header files in an IDL file, see <a href="ov-build_87cj.htm">Importing System Header Files</a>.</p>
<h4>Example</h4>
<pre><code>[uuid(. . .), object] interface IKnown : IUnknown
{
import "base.idl", "unknwn.idl", "helper.idl";
//remainder of interface definition
}
 </code></pre>
<p>
The ODL <b>importlib</b> directive lets you reference a compiled type library in your IDL or ODL file. The <b>importlib</b> directive must be inside a <b>library </b>statement, and must precede other type descriptions in the library. The imported library, as well as the generated library, must be available to the application at run time.</p>
<h4>Example</h4>
<pre><code>library NewBrowser
{
importlib("stdole32.tlb");
importlib("legacy.tlb");
//remainder of library definition
};
 </code></pre>
<p>
You can also use the C-preprocessor #include directive to include headers and other files in your IDL or ODL file. Be aware, however, that this directive will literally include the entire contents of the specified file. If a header file contains prototypes that you do not need or want in the MIDL-generated stub files, or if it contains nonremotable type definitions, you should use MIDL <b>import</b> directive instead of the #include directive. </p>
<h4>See Also</h4>
<p>
<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_import">
</object><a href=JavaScript:alink_3.Click()><b>import</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_importlib">
</object><a href=JavaScript:alink_4.Click()><b>importlib</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_include">
</object><a href=JavaScript:alink_5.Click()><b>include</b></a>, <a href="ov-build_87cj.htm">Importing System Header Files</a></p>
<p>&nbsp;</p></body>
</HTML>
