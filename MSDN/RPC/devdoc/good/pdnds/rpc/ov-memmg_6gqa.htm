<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Application-Allocated Buffer</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_rpc_application_allocated_buffer"></a>Application-Allocated Buffer</h2>
<p>
The ACF attribute <b>byte_count</b> directs the stubs to use a preallocated buffer that is not allocated or freed by the client support routines. The <b>byte_count</b> attribute is applied to a pointer or array parameter that points to the buffer. It requires a parameter that specifies the buffer size in bytes.</p>
<p>
The client-allocated memory area can contain complex data structures with multiple pointers. Because the memory area is contiguous, the application does not have to make many calls to individually free each pointer and structure. Like the <b>allocate(all_nodes)</b> attribute, the memory area can be allocated or freed with one call to the memory-allocation routine or the free routine. However, unlike the <b>allocate(all_nodes)</b> attribute, the buffer parameter is not managed by the client stub but by the client application.</p>
<p>
The buffer must be an <b>out</b>-only parameter andthe buffer length in bytes must be an <b>in</b>-only parameter.</p>
<p>
The <b>byte_count</b> attribute can only be applied to pointer types. The <b>byte_count</b> ACF attribute is a Microsoft extension to DCE IDL and, as such, is not available if you compile using the MIDL /<b>osf</b> switch.</p>
<p>
In the following example, the parameter <i>pRoot</i> uses byte count:</p>
<pre><code>/* function prototype in IDL file (fragment) */
void SortNames(
    [in] short cNames,
    [in, size_is(cNames)] STRINGTYPE pszArray[],
    [in] short cBytes,
    [out, ref] P_TREE_TYPE pRoot  /* tree with sorted data */
);
 </code></pre>
<p>
The <b>byte_count</b> attribute appears in the ACF as:</p>
<pre><code>/* ACF file (fragment) */
SortNames([byte_count(cBytes)] pRoot);
 </code></pre>
<p>
The client stub generated from these IDL and ACF files does not allocate or free the memory for this buffer. The server stub allocates and frees the buffer in a single call using the provided size parameter. If the data is too large for the specified buffer size, an exception is raised.</p>
<p>&nbsp;</p></body>
</HTML>
