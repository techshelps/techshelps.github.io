<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Configuring the Windows NT Registry for Port Allocations and Selective Binding</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rpc_configuring_the_windows_nt_registry_for_port_allocations_and_selective_binding"></a>Configuring the Windows NT Registry for Port Allocations and Selective Binding</h1>
<p>
The following registry keys specify the system defaults for dynamic port allocation and for binding to NICs on multihomed machines. You must first create these keys, then specify the appropriate settings. If a key is missing or if it contains an invalid value, then the entire configuration is marked as invalid and all RpcServerUseProtseq* calls over <b>ncacn_ip_tcp </b>or <b>ncadg_ip_udp </b>will fail.</p>
<p>
<b>Note</b>&nbsp;&nbsp;Ports allocated to a process remain allocated until that process dies. If all available ports are in use, then the API will return RPC_S_OUT_OF_RESOURCES.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Port Key</th>
<th align=left width=23%>Data Type</th>
<th align=left width=44%>Description</th>
</tr>
<tr valign=top>
<td width=33%>HKEY_LOCAL_MACHINE\<br>
Software\Microsoft\Rpc\<br>
Internet\Ports</td>
<td width=23%>REG_MULTI_SZ</td>
<td width=44%>Specifies a set of IP port ranges consisting of either all the ports available from the Internet or all the ports not available from the Internet. Each string represents a single port or an inclusive set of ports (for example,"1000-1050" "1984"). If any entries are outside the range of zero to 65535, or if any string cannot be interpreted, the RPC run time will treat the entire configuration as invalid.</td>
</tr>
<tr valign=top>
<td width=33%>HKEY_LOCAL_MACHINE\<br>
Software\Microsoft\Rpc\<br>
Internet\PortsInternetAvailable</td>
<td width=23%>REG_SZ</td>
<td width=44%>Y or N (not case-sensitive). If Y, the ports listed in the Ports key are all the Internet-available ports on that machine. If N, the ports listed in the Ports key are all those ports that are not Internet-available.</td>
</tr>
<tr valign=top>
<td width=33%>HKEY_LOCAL_MACHINE\<br>
Software\Microsoft\Rpc\<br>
Internet\UseInternetPorts</td>
<td width=23%>REG_SZ</td>
<td width=44%>Y or N (not case-sensitive). Specifies the system default policy. If Y, the processes using the default will be assigned ports from the set of Internet-available ports, as defined above. If N, processes using the default will be assigned ports from the set of intranet-only ports.</td>
</tr>
<tr valign=top>
<td width=33%>HKEY_LOCAL_MACHINE\<br>
System\CurrentControlSet\<br>
Services\Rpc\Linkage\Bind</td>
<td width=23%>REG_MULTI_SZ</td>
<td width=44%>Lists the device names of all the NICs on which to bind by default (for example, \Device\AMDPCN1). If the key does not exist, the server will bind to all NICs. If the key does exist, the server will bind to the NICs specified in the key, unless the NICFlags field is set to RPC_C_BIND_TO_ALL_NICS. If the key has a null ("") value, the configuration will be marked as invalid and all calls to RpcServerUseProtseq* over <b>ncacn_ip_tcp </b>or <b>ncadg_ip_udp </b>will fail.</td>
</tr>
</table><br>
<h4>See Also</h4>
<p>
<a href="pr-dtype_32gp.htm">RPC_POLICY</a>, <a href="pr-func2_27y0.htm"><b>RpcServerUseAllProtseqsEx</b></a>, <a href="pr-func2_6xq0.htm"><b>RpcServerUseAllProtseqsIfEx</b></a>, <a href="pr-func2_38l4.htm"><b>RpcServerUseProtseqEx</b></a>, <a href="pr-func2_4drs.htm"><b>RpcServerUseProtseqEpEx</b></a>, <a href="pr-func2_5z94.htm"><b>RpcServerUseProtseqIfEx</b></a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_ncacn_ip_tcp">
</object><a href=JavaScript:alink_1.Click()><b>ncacn_ip_tcp</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_ncadg_ip_udp">
</object><a href=JavaScript:alink_2.Click()><b>ncadg_ip_udp</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
