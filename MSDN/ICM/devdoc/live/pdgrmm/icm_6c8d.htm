<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CMCreateMultiProfileTransform</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_cmcreatemultiprofiletransform"></a>CMCreateMultiProfileTransform</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CMCreateMultiProfileTransform</b> function accepts an array of profiles or a single <a href="icmglsry_6ysk.htm#_win32_icm_2.0_glossary_device_link_profile_gloss">device link profile</a> and creates a color transform. This transform is a mapping from the color space specified by the first profile to that of the second profile and so on to the last one. </p>
<pre><code><b>HCMTRANSFORM CMCreateMultiProfileTransform(
  LPHPROFILE </b><i>lpahProfiles</i><b>,  </b>// array of profile handles
<b>  DWORD </b><i>nProfiles</i><b>,          </b>// profile handle array size
  <b>PDWORD</b> <i>padwIntents</i><b>,</b>       // array of rendering intents
<b>  DWORD </b><i>nIntents</i><b>,           </b>// intent array size
<b>  DWORD </b><i>dwFlags             </i>// transform creation flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpahProfiles</i></dt>
<dd>
Points to an array of profile handles.</dd>
<dt>
<i>nProfiles</i></dt>
<dd>
Specifies the number of profiles in the array.</dd>
<dt>
<i>padwIntents</i></dt>
<dd>
Points to an array of rendering intents. Each rendering intent is represented by one of the following values:
<pre><code>INTENT_PERCEPTUAL
INTENT_SATURATION
INTENT_RELATIVE_COLORIMETRIC
INTENT_ABSOLUTE_COLORIMETRIC
 </code></pre>

<p>
For more information, see <a href="icm_3ng3.htm">Rendering Intents</a>.
</dd>
<dt>
<i>nIntents</i></dt>
<dd>
Specifies the number of intents in the intent array. Can be 1, or the same value as <i>nProfiles</i>.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Specifies flags to used control creation of the transform. These flags are intended only as hints, and it is up to the CMM to determine how best to use these flags. 
<p>
Set the high-order <b>WORD</b> to ENABLE_GAMUT_CHECKING if the transform will be used for gamut checking. 

<p>
The low-order <b>WORD</b> can have one of the following constant values: PROOF_MODE, NORMAL_MODE, BEST_MODE. Moving from PROOF_MODE to BEST_MODE, output quality generally improves and transform speed declines.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If this function succeeds, the return value is a color transform in the range 256 to 65,535. Since only the low <b>WORD</b> of the transform is retained, valid transforms cannot exceed this range.</p>
<p>
If this function fails, the return value is an error code having a value less than 256. When the return value is less than 256, signaling an error, the CMM should use <b>SetLastError</b> to set the last error to a valid error value as defined in Winerror.h.</p>
<h4>Remarks</h4>
<p>
Every CMM is required to export this function.</p>
<p>
The array of intents specifies how profiles should be combined. The <i>n</i>th intent is used for combining the <i>n</i>th profile in the array. If only one intent is specified, it is used for the first profile, and all other profiles are combined using Absolute Colorimetric intent.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="icm_156c.htm">Color Management Overview</a>, <a href="icm_4f77.htm">ICM 2.0 Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
