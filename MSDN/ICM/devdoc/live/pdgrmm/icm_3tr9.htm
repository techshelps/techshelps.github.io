<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateDeviceLinkProfile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createdevicelinkprofile"></a>CreateDeviceLinkProfile</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CreateDeviceLinkProfile</b> function creates a <a href="icmglsry_6ysk.htm#_win32_icm_2.0_glossary_device_link_profile_gloss">device link profile</a> from a set of color profiles, using the specified intents.</p>
<pre><code><b>BOOL WINAPI CreateDeviceLinkProfile(
  PHPROFILE </b><i>pahProfiles</i><b>,</b>
<b>  DWORD </b><i>nProfiles</i><b>,</b>
<b>  PDWORD</b> <i>padwIntent</i>,
  <b>DWORD </b><i>nIntents,</i>
  <b>DWORD</b> <i>dwFlags</i>,
<b>  PBYTE </b><i>*pProfileData</i><b>,</b>
<b>  DWORD </b><i>indexPreferredCMM </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pahProfiles</i></dt>
<dd>
Pointer to an array of handles of the color profiles to be used.</dd>
<dt>
<i>nProfiles</i></dt>
<dd>
Specifies the number of profiles in the array pointed to by <i>pahProfiles</i>.</dd>
<dt>
<i>padwIntent</i></dt>
<dd>
Pointer to an array of <b>DWORDS</b> containing the intents to be used. See <a href="icm_3ng3.htm">Rendering Intents</a>.</dd>
<dt>
<i>nIntents</i></dt>
<dd>
The number of intents in the array pointed to by <i>padwIntent</i>.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Specifies flags to control creation of the transform. It is up to the CMM to determine how best to use these flags. 
<p>
Set the high-order <b>WORD</b> to ENABLE_GAMUT_CHECKING if the transform will be used for gamut checking. 

<p>
The low-order <b>WORD</b> can have one of the following constant values: PROOF_MODE, NORMAL_MODE, BEST_MODE. Moving from PROOF_MODE to BEST_MODE, output quality generally improves and transform speed declines.
</dd>
<dt>
<i>pProfileData</i></dt>
<dd>
Pointer to a pointer to a buffer. If successful, this function allocates the buffer, places its address in <i>*pProfileData</i>, and fills it with a device link profile. If the function succeeds, the calling application must free the buffer after it is no longer needed. </dd>
<dt>
<i>indexPreferredCMM</i></dt>
<dd>
Specifies the one-based index of the color profile that indicates which color management module (CMM) to use. If the application developer doesn't care which CMM is used and would like Windows to choose a CMM, it should set this parameter to INDEX_DONT_CARE.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If this function succeeds, the return value is a nonzero value.</p>
<p>
If this function fails, the return value is zero. For extended error information, call <b>GetLastError</b>.</p>
<h4>Remarks</h4>
<p>
The first and the last profiles in the array must be device profiles. The other profiles can be color space or abstract profiles.</p>
<p>
Each profile's output color space must be the next profile's input color space.</p>
<p>
The calling application must free the buffer allocated by this function and pointed to by the <i>pProfileData</i> parameter. The <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalfree">
</object><a href=JavaScript:alink_1.Click()><b>GlobalFree</b></a> function should be used to free the buffer.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in icm.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mscms.lib.</p>
<h4>See Also</h4>
<p>
<a href="icm_156c.htm">Color Management Overview</a>, <a href="icm_4f77.htm">ICM 2.0 Functions</a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalfree">
</object><a href=JavaScript:alink_2.Click()><b>GlobalFree</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
