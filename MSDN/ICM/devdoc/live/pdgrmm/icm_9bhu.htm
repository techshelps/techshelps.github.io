<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COLORMATCHSETUP</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_colormatchsetup_str"></a>COLORMATCHSETUP</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>COLORMATCHSETUP</b> structure contains information that the <a href="icm_2zc7.htm"><b>SetupColorMatching</b></a> function uses to initialize the Color Management dialog box. After the user closes the dialog box, <b>SetupColorMatching</b> returns information about the user's selection in this structure.</p>
<h4>Structure</h4>
<pre><code>typedef struct _tagCOLORMATCHSETUP {
    DWORD   dwSize;
    DWORD   dwVersion;
    DWORD   dwFlags; 
    HWND    hwndOwner;
    PCTSTR  pSourceName; 
    PCTSTR  pDisplayName; 
    PCTSTR  pPrinterName;
    DWORD   dwRenderIntent; 
    DWORD   dwProofingIntent;
    PTSTR   pMonitorProfile; 
    DWORD   ccMonitorProfile;
    PTSTR   pPrinterProfile; 
    DWORD   ccPrinterProfile;
    PTSTR   pTargetProfile; 
    DWORD   ccTargetProfile;
    DLGPROC lpfnHook; 
    LPARAM  lParam;
    PCMSCALLBACKA lpfnApplyCallback;
    LPARAM        lParamApplyCallback; 
 
} COLORMATCHSETUP;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>dwSize</b></dt>
<dd>
Size of the structure. Should be set to <b>sizeof</b>(<b>COLORMATCHSETUP</b>).</dd>
<dt>
<b>dwVersion</b></dt>
<dd>
Version of the <b>COLORMATCHSETUP</b> structure. This should be set to COLOR_MATCH_VERSION.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
A set of bit flags used to initialize the dialog box. If set to 0 on entry, all controls assume their default states. 
<p>
When the dialog box returns, these flags are set to indicate the user's input. 

<p>
This member can be set using a combination of the following flags.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=43%>Flag</th>
<th align=left width=57%>Meaning</th>
</tr>
<tr valign=top>
<td width=43%>CMS_DISABLEICM</td>
<td width=57%>If set on entry, this flag indicates that the "Enable Color Management" check box is cleared, disabling all other controls. If set on exit, it means that the user does not wish color management performed.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_ENABLEPROOFING</td>
<td width=57%>If set on entry, this flag indicates that the Proofing controls are to be enabled, and the Proofing check box is checked. If set on exit, it means that the user wishes to do color management for a different target device than the selected printer.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_SETRENDERINTENT</td>
<td width=57%>If set on entry, this flag indicates that the <b>dwRenderIntent</b> member contains the value to use to initialize the Rendering Intent control. Otherwise, the control defaults to Perceptual rendering. This flag is set on exit if ICM is enabled.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_SETPROOFINTENT</td>
<td width=57%>Ignored unless CMS_ENABLEPROOFING is also set. If set on entry, and CMS_ENABLEPROOFING  is also set, this flag indicates that the <b>dwProofingIntent</b> member is to be used to initialize the Target Rendering Intent control. Otherwise, the control defaults to Perceptual rendering. This flag is set on exit if proofing is enabled.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_SETMONITORPROFILE</td>
<td width=57%>If set on entry, this flag indicates that the color management profile named in the <b>pMonitorProfile</b> member is to be the initial selection in the monitor profile control. If the specified profile is not associated with the monitor, this flag is ignored, and the default profile for the monitor is used.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_SETPRINTERPROFILE</td>
<td width=57%>If set on entry, this flag indicates that the color management profile named in the <b>pPrinterProfile</b> member is to be the initial selection in the printer profile control. If the specified profile is not associated with the printer, this flag is ignored, and the default profile for the printer is used.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_SETTARGETPROFILE</td>
<td width=57%>If set on entry, this flag indicates that the color profile named in the <b>pTargetProfile</b> member is to be the initial selection in the target profile control. If the specified profile is not installed, this flag is ignored, and the default profile for the printer is used. If the printer has no default profile, then the first profile in alphabetical order will be displayed.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_USEHOOK</td>
<td width=57%>This flag specifies that the <b>lpfnHook</b> member contains the address of a hook procedure, and the <b>lParam</b> member contains a value to be passed to the hook procedure when the WM_INITDIALOG message is sent.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_MONITOROVERFLOW</td>
<td width=57%>This flag is set on exit if color management is to be enabled and the buffer size given in <b>ccMonitorProfile</b> is insufficient for the selected profile name. <b>GetLastError</b> returns ERROR_INSUFFICIENT_BUFFER in such a case.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_PRINTERROVERFLOW</td>
<td width=57%>This flag is set on exit if color management is to be enabled and the buffer size given in <b>ccPrinterProfile</b> is insufficient for the selected profile name. <b>GetLastError</b> returns ERROR_INSUFFICIENT_BUFFER in such a case.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_TARGETOVERFLOW</td>
<td width=57%>This flag is set on exit if proofing is to be enabled and the buffer size given in <b>ccTargetProfile</b> is insufficient for the selected profile name. <b>GetLastError</b> returns ERROR_INSUFFICIENT_BUFFER in such a case.</td>
</tr>
<tr valign=top>
<td width=43%>CMS_USEAPPLYCALLBACK</td>
<td width=57%>If set on entry, this flag indicates that the <b>SetupColorMatching</b> function should call the function <a href="icm_36we.htm"><b>ApplyCallbackFunction</b></a>. The address of the callback function is contained in <i>lpfnApplyCallback</i>.</td>
</tr>
</table><br>

</dd>
<dt>
<b>hwndOwner</b></dt>
<dd>
The window handle for the owner of the dialog box, or NULL if the dialog box has no owner.</dd>
<dt>
<b>pSourceName</b></dt>
<dd>
Pointer to an application-specified string which describes the source profile of the item for which color management is to be performed. If this is NULL, the Image Source control displays the name of the Windows default color profile.</dd>
<dt>
<b>pDisplayName</b></dt>
<dd>
Points to a string naming the monitor to be used for color management. If this is not the name of a valid monitor, the first enumerated monitor is used.</dd>
<dt>
<b>pPrinterName</b></dt>
<dd>
Points to a string naming the printer on which the image is to be rendered. If this is not a valid printer name, the default printer is used and named in the dialog.</dd>
<dt>
<b>dwRenderIntent</b></dt>
<dd>
The type of color management desired. Valid values are: 
<pre><code>INTENT_PERCEPTUAL
INTENT_SATURATION
INTENT_RELATIVE_COLORIMETRIC
INTENT_ABSOLUTE_COLORIMETRIC
 </code></pre>

<p>
For more information, see <a href="icm_3ng3.htm">Rendering Intents</a>.
</dd>
<dt>
<b>dwProofingIntent</b></dt>
<dd>
The type of color management desired for the proofed image. Valid values are: 
<pre><code>INTENT_PERCEPTUAL
INTENT_SATURATION
INTENT_RELATIVE_COLORIMETRIC
INTENT_ABSOLUTE_COLORIMETRIC
 </code></pre>

<p>
For more information, see <a href="icm_3ng3.htm">Rendering Intents</a>.
</dd>
<dt>
<b>pMonitorProfile</b></dt>
<dd>
Pointer to a buffer in which to place the name of the user-selected monitor profile. If the CMS_SETMONITORPROFILE flag is used, this flag can also be used to select a profile other than the monitor default when the dialog is first displayed.</dd>
<dt>
<b>ccMonitorProfile</b></dt>
<dd>
The size of the buffer pointed to by the <b>pMonitorProfile</b> member, in characters. If the buffer is not large enough to hold the selected name, the name is truncated to this size, and ERROR_INSUFFICIENT_BUFFER is returned. A buffer of MAX_PATH size always works.</dd>
<dt>
<b>pPrinterProfile</b></dt>
<dd>
Points to a buffer in which to place the name of the user-selected printer profile. If the CMS_SETPRINTERPROFILE flag is used, this flag can also be used to select a profile other than the printer default when the dialog is first displayed.</dd>
<dt>
<b>ccPrinterProfile</b></dt>
<dd>
The size of the buffer pointed to by the <b>pPrinterProfile</b> member, in characters. If the buffer is not large enough to hold the selected name, the name is truncated to this size, and ERROR_INSUFFICIENT_BUFFER is returned.  A buffer of MAX_PATH size always works.</dd>
<dt>
<b>pTargetProfile</b></dt>
<dd>
Points to a buffer in which to place the name of the user-selected target profile for proofing. If the CMS_SETTARGETPROFILE flag is used, this flag can also be used to select a profile other than the printer default when the dialog is first displayed.</dd>
<dt>
<b>ccTargetProfile</b></dt>
<dd>
The size of the buffer pointed to by the <b>pTargetProfile</b> member, in characters. If the buffer is not large enough to hold the selected name, the name is truncated to this size, and ERROR_INSUFFICIENT_BUFFER is returned.  A buffer of MAX_PATH size always works.</dd>
<dt>
<b>lpfnHook</b></dt>
<dd>
If the CMS_USEHOOK flag is set, this member is the address of a dialog procedure (see <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_dialogproc">
</object><a href=JavaScript:alink_1.Click()><b>DialogProc</b></a>) that can filter or handle messages for the dialog. The hook procedure receives no messages issued before WM_INITDIALOG. It is called on the WM_INITDIALOG message after the system-provided dialog procedure has processed the message. On all other messages, the hook procedure receives the message before the system-provided procedure. If the hook procedure returns TRUE to these messages, the system-provided procedure is not called. 
<p>
The hook procedure may call the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_enddialog">
</object><a href=JavaScript:alink_2.Click()><b>EndDialog</b></a> function.
</dd>
<dt>
<b>lParam</b></dt>
<dd>
If the CMS_USEHOOK flag is set, this member is passed to the application-provided hook procedure as the <i>lParam</i> parameter when the WM_INITDIALOG message is processed.</dd>
<dt>
<b>lpfnApplyCallback</b><i> </i></dt>
<dd>
Contains a pointer to a callback function that is invoked when the <b>Apply</b> button of the Color Management dialog box is selected. If no callback function is provided, this member should be set to NULL.</dd>
<dt>
<b>lParamApplyCallback</b> </dt>
<dd>
Contains a value that will be passed to the function <b>ApplyCallbackFunction</b> through its <i>lParam</i> parameter. The meaning and content of the value is specified by the application.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in icm.h.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined as Unicode and ANSI structures.</p>
<h4>See Also</h4>
<p>
<a href="icm_82i5.htm#_win32_a_common_dialog_for_color_management">A Common Dialog for Color Management</a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_dialogproc">
</object><a href=JavaScript:alink_3.Click()><b>DialogProc</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_enddialog">
</object><a href=JavaScript:alink_4.Click()><b>EndDialog</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
