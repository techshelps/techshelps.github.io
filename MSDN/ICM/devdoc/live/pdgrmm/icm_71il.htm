<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateColorTransform</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createcolortransform"></a>CreateColorTransform</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CreateColorTransform</b> function creates a color transform that applications can use to perform color management.</p>
<pre><code><b>HTRANSFORM WINAPI CreateColorTransform(
  LPLOGCOLORSPACE </b><i>pLogColorSpace</i><b>,</b>
<b>  HPROFILE </b><i>hDestProfile</i><b>,</b>
<b>  HPROFILE </b><i>hTargetProfile</i><b>,</b>
<b>  DWORD </b><i>dwFlags</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pLogColorSpace</i></dt>
<dd>
Pointer to the input <a href="icm_2lf6.htm"><b>LOGCOLORSPACE</b></a>.</dd>
<dt>
<i>hDestProfile</i></dt>
<dd>
Handle to the profile of the destination device.</dd>
<dt>
<i>hTargetProfile</i></dt>
<dd>
Handle to the profile of the target device.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
The high-order <b>WORD</b> of <i>dwFlags</i> should be set to ENABLE_GAMUT_CHECKING if this transform will be used for gamut checking.
<p>
The low-order <b>WORD</b> can have one of the following constant values: PROOF_MODE, NORMAL_MODE, BEST_MODE. Moving from PROOF_MODE to BEST_MODE, output quality generally improves and transform speed declines.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If this function succeeds, the return value is a handle to the color transform.</p>
<p>
If this function fails, the return value is NULL. For extended error information, call <b>GetLastError</b>.</p>
<h4>Remarks</h4>
<p>
If the target profile is NULL, the transform goes from the source logical color space to the destination profile. If the target profile is given, the transform goes from the source logical color space to the target profile and then to the destination profile. This allows previewing output meant for the target device on the destination device.</p>
<p>
The values in <i>dwFlags</i> are intended as hints only. The color management module must determine the best way to use them.</p>
<p>
The <b>CreateColorTransform</b> function is used outside of a DC. Colors may shift when transforming from a color profile to the same color profile. This is due to precision errors. Therefore, a color transform should not be performed under these circumstances.</p>
<p>
The B2Ax tags are required for any profile that is the target of a transform.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in icm.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mscms.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="icm_156c.htm">Color Management Overview</a>, <a href="icm_4f77.htm">ICM 2.0 Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
