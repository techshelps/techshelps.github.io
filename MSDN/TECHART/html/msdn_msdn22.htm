<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 22: Converting DWords, Words, and Bytes</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn22"></a></sup>Tip 22: Converting DWords, Words, and Bytes</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
You can write functions in Visual Basic® that split and combine DWords, Words, and Bytes. These functions can be used to do such things as taking two integer values and transferring them to a long integer value, where the first integer is the high word and the second integer is the low word.</p>
<h2>Conversion Routines for Visual Basic</h2>
<p>
The seven functions listed below can be used to convert DWords, Words, and Bytes to other equivalent values. These routines can be used when calling Windows® application programming interface (API) functions that require specific parameters that Visual Basic® itself does not provide.</p>
<p>
<b>Function HiByte(ByVal w As Integer) As Byte</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;If w And &amp;H8000 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HiByte = &amp;H80 Or ((w And &amp;H7FFF) \ &amp;HFF)
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HiByte = w \ 256
 &nbsp;&nbsp; End If
End Function
</code></pre>
<p>
<b>Function HiWord(dw As Long) As Integer</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;If dw And &amp;H80000000 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HiWord = (dw \ 65535) - 1
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HiWord = dw \ 65535
 &nbsp;&nbsp; End If
End Function
</code></pre>
<p>
<b>Function LoByte(w As Integer) As Byte</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;LoByte = w And &amp;HFF
End Function
</code></pre>
<p>
<b>Function LoWord(dw As Long) As Integer</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;If dw And &amp;H8000&amp; Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoWord = &amp;H8000 Or (dw And &amp;H7FFF&amp;)
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoWord = dw And &amp;HFFFF&amp;
 &nbsp;&nbsp; End If
End Function
</code></pre>
<p>
<b>Function LShiftWord(ByVal w As Integer, ByVal c As Integer) As Integer</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;Dim dw As Long
 &nbsp;&nbsp; dw = w * (2 ^ c)
 &nbsp;&nbsp; If dw And &amp;H8000&amp; Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LShiftWord = CInt(dw And &amp;H7FFF&amp;) Or &amp;H8000
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LShiftWord = dw And &amp;HFFFF&amp;
 &nbsp;&nbsp; End If
End Function
</code></pre>
<p>
<b>Function RShiftWord(ByVal w As Integer, ByVal c As Integer) As Integer</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;Dim dw As Long
 &nbsp;&nbsp; If c = 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RShiftWord = w
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dw = w And &amp;HFFFF&amp;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dw = dw \ (2 ^ c)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RShiftWord = dw And &amp;HFFFF&amp;
 &nbsp;&nbsp; End If
End Function
</code></pre>
<p>
<b>Function MakeWord(ByVal bHi As Byte, ByVal bLo As Byte) As Integer</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;If bHi And &amp;H80 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MakeWord = (((bHi And &amp;H7F) * 256) + bLo) Or &amp;H8000
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MakeWord = (bHi * 256) + bLo
 &nbsp;&nbsp; End If
End Function
</code></pre>
<p>
<b>Function MakeDWord(wHi As Integer, wLo As Integer) As Long</b></p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;If wHi And &amp;H8000&amp; Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MakeDWord = (((wHi And &amp;H7FFF&amp;) * 65536) Or (wLo And &amp;HFFFF&amp;)) _Or &amp;H80000000
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MakeDWord = (wHi * 65535) + wLo
 &nbsp;&nbsp; End If
End Function
</code></pre>
</BODY>
</HTML>
