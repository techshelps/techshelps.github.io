<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 109: Modifying an MDI Form's Border Style</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn109"></a></sup>Tip 109: Modifying an MDI Form's Border Style</h1>
<p>
June 12, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how you can create a multiple-document interface (MDI) form that has a fixed border in a Microsoft® Visual Basic® application.</p>
<h2>Retrieving and Setting a Form's BorderStyle</h2>
<p>
Every form you create when designing a Microsoft® Visual Basic® application can have one of four border styles. Just set the form's <b>BorderStyle</b> property to one of the following styles.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=41%><b>Property</b></td>
<td class=label width=59%><b>Style</b></td>
</tr>
<tr valign=top>
<td width=41%>0</td>
<td width=59%>None</td>
</tr>
<tr valign=top>
<td width=41%>1</td>
<td width=59%>Fixed Single</td>
</tr>
<tr valign=top>
<td width=41%>2</td>
<td width=59%>Sizeable</td>
</tr>
<tr valign=top>
<td width=41%>3</td>
<td width=59%>Fixed Double</td>
</tr>
</table><br>
<p>
An MDI child form, however, does not have a <b>BorderStyle</b> property. But by using the Microsoft Windows® <b>GetWindowLong</b> and <b>SetWindowLong</b> application programming interface (API) functions , you can change an MDI form's border style to a fixed border style.</p>
<p>
The <b>GetWindowLong</b> function retrieves information about the specified window's style attributes and the <b>SetWindowLong</b> function modifies the specified window's style attributes.</p>
<p>
<b>GetWindowLong</b> requires only two arguments. The first argument is the target window's handle. The second argument specifies the type of information you want to retrieve, which is the style settings for the window.</p>
<p>
After retrieving the window's current style settings, use the bitwise <b>And Not</b> function to remove the WS_THICKFRAME attribute from the style settings value. Next, issue a call to the <b>SetWindowLong</b> function to set the new style settings for the specified window. This creates an MDI form that has a fixed border style.</p>
<h2>Example Program</h2>
<p>
This program shows how to create an MDI form that has a fixed border. Run the example program by pressing F5. The MDI form will be displayed with a fixed border.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
From the Insert menu, select MDI Form to create an MDI form. MDIForm1 is created by default.<br><br></li>
<li>
Set Form1's <b>MDIChild</b> property to True. Modify the size of this form so that it is smaller than the MDIForm1 form.<br><br></li>
<li>
Add the following <b>Constant</b> and <b>Declare</b> statements to the General Declarations section of Form1 (note that each <b>Declare</b> statement must be typed as a single line of text):<pre><code>Private Declare Function GetWindowLong Lib "User" (ByVal hWnd As Integer, ByVal 
  nIndex As Integer) As Long
Private Declare Function SetWindowLong Lib "User" (ByVal hWnd As Integer, ByVal 
  nIndex As Integer, ByVal dwNewLong As Long) As Long
Const GWL_STYLE = (-16)
Const WS_THICKFRAME = &amp;H40000
</code></pre>
</li>
<li>
Add the following code to the Load event for MDIForm1 (note that the NewStyle line must be typed as a single line of code):<pre><code>Private Sub MDIForm_Load()
 &nbsp;&nbsp; Dim CurStyle As Long
 &nbsp;&nbsp; Dim NewStyle As Long
 &nbsp;&nbsp; CurStyle = GetWindowLong(MDIForm1.hWnd, GWL_STYLE)
 &nbsp;&nbsp; NewStyle = SetWindowLong(MDIForm1.hWnd, GWL_STYLE, CurStyle And 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Not (WS_THICKFRAME))
End Sub
</code></pre>
</li>
</ol>
<h2>Additional References</h2>
<p>
"GetSystemMenu." (MSDN Library Archive, Product Documentation, SDKs, Windows 3.1 SDK, Programmer's Reference, Volume 2: Functions) </p>
<p>
Knowledge Base Q118376. "How to Lock a Form So It Cannot Be Moved."</p>
<p>
Knowledge Base Q110393. "How to Remove Menu Items from a Form's Control-Menu Box."</p>
<p>
Knowledge Base Q77930. "Modifying the System Menu of an MDI Child Window."</p>
<p>
Knowledge Base Q71669. "Preventing an MDI Child Window from Changing Size."</p>
</BODY>
</HTML>
