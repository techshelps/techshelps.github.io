<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 178: Enabling or Disabling Fast Task Switching in Windows</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn178"></a></sup>Tip 178: Enabling or Disabling Fast Task Switching in Windows</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
Within a Microsoft® Visual Basic® application, you can use the Microsoft Windows® <b>SystemParametersInfo</b> to enable or disable fast task switching key combinations. This article contains an example program that disables fast task switching.</p>
<h2>Using the SystemParametersInfo Function</h2>
<p>
When you have several Microsoft® Windows®-based applications loaded into memory at the same time, there are several methods you can use to switch to any one of these applications. For example, when you press the alt+tab key combination, Windows displays a window from which you can select the program to which you want to switch the focus. This is called <i>fast task switching</i>.</p>
<p>
From within a Microsoft Visual Basic® application, you can enable or disable the fast task switching feature. You can do this by calling the Windows application programming interface (API) <b>SystemParametersInfo</b> function, which retrieves or sets a multitude of different settings.</p>
<p>
To enable the fast task switching capability in Windows, you must call the <b>SystemParametersInfo</b> function with its <i>lpvParam</i> variable set to False. To disable fast task switching, however, you set <i>lpvParam</i> to True.</p>
<p>
In the example program below, you disable fast task switching by executing the following statement:</p>
<pre><code>X = SystemParametersInfo(97, True, lpvparam, 0)
</code></pre>
<p>
After this statement is executed, the alt+tab, ctrl+esc, and ctrl+alt+del key combinations are no longer recognized by the Windows operating system.</p>
<h2>Example Program</h2>
<p>
This program shows how to disable certain key combinations such as ctrl+esc, alt+tab, and ctrl+alt+del. This, in effect, prevents the fast task switching mechanism available under the Windows operating system.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following <b>Declare</b> statement to the General Declarations section of Form1 (note that the <b>Declare</b> statement must be typed as a single line of code):<pre><code>Private Declare Function SystemParametersInfo Lib "user32" Alias 
 &nbsp; "SystemParametersInfoA" (ByVal uAction As Long, ByVal uParam As Long, 
 &nbsp; lpvparam As Any, ByVal fuWinIni As Long) As Long
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; Dim lpvparam As Boolean
 &nbsp;&nbsp; Dim X As Long

 &nbsp;&nbsp; X = SystemParametersInfo(97, True, lpvparam, 0)
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing f5. Form1 appears on the screen. Notice that you cannot use the alt+tab, ctrl+esc, or ctrl+alt+del key combinations—the Windows operating system ignores these actions.</p>
</BODY>
</HTML>
