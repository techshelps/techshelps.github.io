<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 6: Displaying a File's Contents Correctly in a Text Box</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn6"></a></sup>Tip 6: Displaying a File's Contents Correctly in a Text Box</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
When trying to display text in a multiline text box, the carriage return and linefeed characters pose a special problem. Microsoft® Windows® version 3.0 deletes the character following Chr$(13), while version 3.1 substitutes a pipe "|" character for the Chr$(13) character. This poses a problem when reading ASCII data from a file into a text box.</p>
<h2>Wrapping Lines in Text Boxes Correctly</h2>
<p>
To alleviate missing or replaced characters when reading ASCII data from a file, you must add both the linefeed and the carriage return characters to the end of each line of text you process.</p>
<p>
The following program retrieves the contents of the AUTOEXEC.BAT file and displays it in a multiline text box.</p>
<h2>Example Program</h2>
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a text box control to Form1. Set its <b>MultiLine</b> property to True and its <b>ScrollBars</b> property to 3-Both.<br><br></li>
<li>
Add the following code to Form1's Form_Load event:<pre><code>Form_Load()
 &nbsp;&nbsp; crlf$ = Chr(13) &amp; Chr(10)
 &nbsp;&nbsp; Text1.Text = ""
 &nbsp;&nbsp; open "C:\AUTOEXEC.BAT" for input as #1
 &nbsp;&nbsp; while not eof(1)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line input #1, file_data$
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Text1.Text = Text1.Text &amp; file_data$ &amp; crlf$
 &nbsp;&nbsp; wend
 &nbsp;&nbsp; close #1
End Sub
</code></pre>
</li>
</ol>
<p>
When you execute this program, each line is read correctly from the AUTOEXEC.BAT file and added to the text already stored in the Text1 text box. If you don't specifically add the CRLF$ to the end of the string just read from the file, the text appears as one continuous line of characters when displayed in the text box.</p>
<p>
You should also be aware of another problem: Text boxes do not process the carriage return/linefeed characters properly unless you first write the Chr(13) character and then the Chr(10) character to the file or append it to the end of a string. Therefore, you must make sure that you specify CRLF$ as containing first the Chr(13) character and then the Chr(10) character.</p>
<h2>Additional References</h2>
<p>
Knowledge Base Q74906. "PRB: Carriage Return Won't Wrap Lines in Text Box Control." (MSDN Library, Knowledge Base)</p>
</BODY>
</HTML>
