<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 89: Invoking the Microsoft Word Page Setup Dialog Box</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn89"></a></sup>Tip 89: Invoking the Microsoft Word Page Setup Dialog Box</h1>
<p>
May 22, 1995</p>
<h2>Abstract</h2>
<p>
From within a Visual Basic® application, you can instruct Microsoft® Word to display its Page Setup dialog box. This article explains how this task can be accomplished by creating a Word Basic macro and executing that macro from within Visual Basic.</p>
<h2>Calling Word Basic Macros from Within Visual Basic</h2>
<p>
You can execute a Word Basic macro from within a Visual Basic® application to perform any number of tasks. The example program below executes Microsoft® Word and opens up a new document page. Then the program calls a Word Basic macro, <b>FPSdlg</b>, to display the Word Page Setup dialog box.</p>
<p>
In order to execute Word from within a Visual Basic application, you must initiate a connection to Word. This is done by calling the <b>CreateObject</b> function. This function lets you create an OLE object, in this case Microsoft Word. When this function is executed, it runs Word if it is not already running in memory. To transfer control to Word, you can use the <b>AppActivate</b> function.</p>
<p>
The next step is to call the Word Basic macro that you have previously created in Word. In your Visual Basic program, you execute a Word Basic command with the <b>Object.Method</b> syntax. For example, after executing Word, we want to start with a new document. Therefore, we issue the statement <b>wobjApp.FileNewDefault</b>, where the object has been defined as Word and <b>FileNewDefault</b> is the Basic command we want to execute. A list of these Word Basic commands can be found in the WRDBASIC.HLP file that is stored in the Word directory when you initially installed Microsoft Word.</p>
<p>
After the new document screen has been displayed in Word, we want to actually execute the Word Basic macro called <b>CallFPS</b>. To do this, we again issue a Word Basic command called <b>ToolsMacro</b>. This command executes the specified macro file in Word. When the macro has been terminated, we can close Word and return to our Visual Basic program by issuing the <b>Set wobjApp=Nothing</b> statement. This statement removes the object variable, which in turn causes Word to terminate. </p>
<h2>Example Program</h2>
<p>
The following example program shows how you can invoke a Word Basic macro to call up the Word Page Setup dialog box.</p>
<p>
First, you must create the Word Basic macro that the Visual Basic program will call. Start Word. From the Tools menu, select Macro. Type the name of the macro as <b>FPSdlg</b> and click the Create command button.</p>
<p>
Type the following as the macro's text. When you're done, save the macro so that it can be used by all newly created Word documents.</p>
<pre><code>Sub Main
 &nbsp;&nbsp; Dim FPSdlg as FilePageSetup
 &nbsp;&nbsp; GetCurValues FPSdlg
 &nbsp;&nbsp; rc = Dialog(FPSdlg)
 &nbsp;&nbsp; If rc &lt;&gt; 0 then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FilePageSetup FPSdlg
 &nbsp;&nbsp; End If
End Sub
</code></pre>
<p>
At this point, make sure the macro actually works from within Word. From the Tools menu, select Macro. Click the name of the macro you want to execute—in this case, the <b>FPSdlg</b> macro. Click the Run command button. Word should respond by popping up the Page Setup dialog box. Click the Cancel button to return to the document screen. Exit Word.</p>
<p>
Now, you need to create the demonstration program in Visual Basic by following these steps:
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim wobjApp As Object
 &nbsp;&nbsp; Set wobjApp = CreateObject("word.basic")
 &nbsp;&nbsp; AppActivate "Microsoft Word"
 &nbsp;&nbsp; 
 &nbsp;&nbsp; wobjApp.FileNewDefault
 &nbsp;&nbsp; wobjApp.ToolsMacro "CallFPS", True
 &nbsp;&nbsp; Set wobjApp = Nothing
 &nbsp;&nbsp; 
End Sub
</code></pre>
</li>
</ol>
<p>
To run the example program, press the F5 function key. Click the command button. After a few seconds, Word will be executed and the <b>FPSdlg</b> macro will also be executed. The program stops after it has displayed the Page Setup dialog box in Word. Click the Cancel command button and you will be returned to Visual Basic's design environment.</p>
<h2>Additional References</h2>
<p>
Knowledge Base Q115782. "How to Have a VB Program Change a Word Document's Page Layout."</p>
</BODY>
</HTML>
