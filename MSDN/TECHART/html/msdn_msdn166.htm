<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 166: Playing .WAV Files in Visual Basic</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn166"></a></sup>Tip 166: Playing .WAV Files in Visual Basic</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to play a waveform-audio (.WAV) file in your Microsoft® Visual Basic® application.</p>
<h2>Using the sndPlaySound Function</h2>
<p>
Adding sound to your Microsoft® Visual Basic® application is one of the ways you can add more interest to your application. You can play a waveform-audio file by calling the Microsoft Windows® application programming interface (API) <b>sndPlaySound</b> function. This function's <b>Declare </b>statement is:</p>
<pre><code>Private Declare Function sndPlaySound Lib "winmm.dll" Alias "sndPlaySoundA" 
 &nbsp; (ByVal lpszSoundName As String, ByVal uFlags As Long) As Long
</code></pre>
<p>
The first argument for the <b>sndPlaySound</b> function is a string containing the name of the waveform-audio file. Alternatively, this string can contain an entry from the registry or WIN.INI file.</p>
<p>
The second argument for the <b>sndPlaySound</b> function specifies how you want the file to be played. You can use one or a combination of the following values for this argument:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=23%>SND_ASYNC</td>
<td width=77%>The function returns after immediately playing the file. The file is played asynchronously.</td>
</tr>
<tr valign=top>
<td width=23%>SND_LOOP</td>
<td width=77%>Used with SND_ASYNC, the file is played repeatedly until you call the <b>sndPlaySound</b> function with the first argument set to NULL.</td>
</tr>
<tr valign=top>
<td width=23%>SND_MEMORY</td>
<td width=77%>The file to be played is stored in memory.</td>
</tr>
<tr valign=top>
<td width=23%>SND_NODEFAULT</td>
<td width=77%>If the specified file cannot be found, the function returns. The default sound file is not played.</td>
</tr>
<tr valign=top>
<td width=23%>SND_NOSTOP</td>
<td width=77%>The function returns without playing the specified sound file if a sound file is currently being played.</td>
</tr>
<tr valign=top>
<td width=23%>SND_SYNC</td>
<td width=77%>The function does not return until the sound file has finished playing.</td>
</tr>
</table><br>
<p>
In the example program below, the TADA.WAV waveform-audio file is played. The second argument to the <b>sndPlaySound</b> function tells the function to play the specified sound file only, without playing the default sound.</p>
<h2>Example Program</h2>
<p>
This program shows how to play a .WAV file in Visual Basic.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following <b>Constant </b>and <b>Declare</b> statements to the General Declarations section of Form1 (note that each statement must be typed as a single line of code):<pre><code>Private Declare Function sndPlaySound Lib "winmm.dll" Alias "sndPlaySoundA" 
 &nbsp; (ByVal lpszSoundName As String, ByVal uFlags As Long) As Long
Const SND_SYNC = &amp;H0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp; play synchronously (default)
Const SND_NODEFAULT = &amp;H2&nbsp;&nbsp;&nbsp; '&nbsp; silence not default, if sound not found
</code></pre>
</li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim X As Long
 &nbsp;&nbsp; X = sndPlaySound("c:\windows\media\tada.wav", SND_SYNC Or SND_NODEFAULT)
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the <b>Command Button</b> control. The TADA.WAV file is played.</p>
</BODY>
</HTML>
