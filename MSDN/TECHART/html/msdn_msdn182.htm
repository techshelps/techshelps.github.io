<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 182: Temporarily Enabling or Disabling Tabs on the TabStrip Control</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn182"></a></sup>Tip 182: Temporarily Enabling or Disabling Tabs on the TabStrip Control</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to selectively enable and disable specific Tab buttons in a Microsoft® Windows® 95 application.</p>
<h2>Enabling and Disabling Tab Buttons</h2>
<p>
The <b>TabStrip</b> control is one of the new controls provided in Microsoft® Windows® 95. This control lets you organize information in an orderly manner. For example, you could have a <b>TabStrip</b> control where one of the Tab buttons presents a page of information for selecting your program's default color options. Another Tab button could present a page where the user can select the default printer he or she wants to use. To switch between these two pages, the user simply clicks on one of the Tab buttons.</p>
<p>
In some situations, however, you may want to disable one or more of the Tab buttons temporarily from within your Microsoft Visual Basic® application. The Tab button does not have an <b>Enabled</b> property, but you can accomplish this functionality by maintaining such a state in code.</p>
<p>
You can use a global array to keep track of which Tab buttons are enabled and disabled. Each index in the global array corresponds to one of the Tab buttons on the <b>TabStrip</b> control.</p>
<p>
In your program, you check the global array index for a specific Tab button. If it is "enabled," then the <b>SelectedItem</b> property can be used to activate the code associated with that Tab button. On the other hand, if that button has been flagged as "disabled," you force the currently selected Tab button to remain the default Tab button—not the Tab button the user just clicked.</p>
<p>
Note that this solution for enabling and disabling individual Tab buttons does not prevent the actual click event from being triggered. The code in the Tab button's Click event does not, however, get executed if the Tab button is disabled.</p>
<h2>Example Program</h2>
<p>
This program shows how to selectively enable and disable a specific Tab button on a <b>TabStrip</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>TabStrip</b> control to Form1. TabStrip1 is created by default. Select the <b>TabStrip</b> control by clicking it. Click the right mouse button once to bring up the <b>TabStrip</b> control's pop-up menu. Click once on the <b>Tabs</b> option. Click on the Insert tab. Type the Caption as Tab1. Create four more Tabs with the Captions set to Tab2, Tab3, Tab4, and Tab5, respectively. Click the OK command button when done.<br><br></li>
<li>
Add the following code to the General Declarations section of Form1:<pre><code>Dim PrevTab As Object
Dim TabState(1 To 5) As Integer
Dim FakeNext As Integer
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; For i = 1 To 5 Step 2
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TabState(i) = True
 &nbsp;&nbsp; Next i
 &nbsp;&nbsp; Set PrevTab = TabStrip1.Tabs(1)
 &nbsp;&nbsp; FakeNext = False
End Sub
</code></pre>
</li>
<li>
Add the following code to the Click event for TabStrip1:<pre><code>Private Sub TabStrip1_Click()
 &nbsp;&nbsp; If FakeNext Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FakeNext = False
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Cannot click on this TAB"
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For i = 1 To 5
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If TabStrip1.Tabs(i).Selected And Not TabState(i) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FakeNext = True
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TabStrip1.SelectedItem = PrevTab
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next i
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set PrevTab = TabStrip1.SelectedItem
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Can click on this TAB"
 &nbsp;&nbsp; End If
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing f5. The <b>TabStrip</b> control appears on the screen. Notice that you can click on the Tab buttons numbered 1, 3, and 5. A message box appears telling you that you clicked one of these three Tab buttons. However, when you click the second and fourth Tab buttons, no click event is actually activated. A message box appears indicating that you cannot click on the Tab2 or Tab4 button.</p>
</BODY>
</HTML>
