<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 113: Creating Transparent Forms</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn113"></a></sup>Tip 113: Creating Transparent Forms</h1>
<p>
July 1, 1995</p>
<h2>Abstract</h2>
<p>
When developing an application in Microsoft® Visual Basic®, you may need to design a transparent form. This article explains how to create transparent forms.</p>
<h2>Using Transparent Forms</h2>
<p>
A transparent form is a form that, when displayed, does not cover up the underlying windows beneath it. The Microsoft® Windows® application programming interface (API) function <b>SetWindowLong</b> can be used to change the style settings of a form or window. You can create a transparent window by setting the WS_EX_TRANSPARENT style bit.</p>
<p>
To use the <b>SetWindowLong</b> function within your Microsoft Visual Basic® program, include the following <b>Declare</b> statement in the General Declarations section of a form (note that it must be typed as a single line of code):</p>
<pre><code>Private Declare Function SetWindowLong Lib "User" (ByVal hWnd As Integer, ByVal 
 &nbsp; nIndex As Integer, ByVal dwNewLong As Long) As Long
</code></pre>
<p>
The <b>SetWindowLong</b> function takes the following arguments.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td width=16%><i>hWnd</i></td>
<td colspan=2 width=84%>An integer value containing the window's handle.</td>
</tr>
<tr valign=top>
<td width=16%><i>nIndex</i></td>
<td colspan=2 width=84%>An integer value that describes the type of information you want to set. This value may be one of the following:</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=21%>GWL_EXSTYLE</td>
<td width=63%>Set the extended window style</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=21%>GWL_STYLE</td>
<td width=63%>Set the window style</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=21%>GWL_WNDPROC</td>
<td width=63%>The window function's address</td>
</tr>
<tr valign=top>
<td width=16%><i>dwNewLong</i></td>
<td colspan=2 width=84%>A long value containing the new style bits to be given to the window.</td>
</tr>
</table><br>
<p>
Because you want to make the specified form transparent, you call the <b>SetWindowLong</b> function with the <i>nIndex</i> argument set to GWL_EXSTYLE, specifying the transparency style bit.</p>
<p>
When you run the example program shown below, the form will be displayed in transparent mode.</p>
<h2>Example Program</h2>
<p>
This program shows how to create a transparent form.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default. Set the form's <b>Picture</b> property to the ARCHES.BMP bitmap file (usually found in the \WINDOWS directory).<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Show Form".<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Form2.Show
End Sub
</code></pre>
</li>
<li>
From the Visual Basic Insert menu, select Form to create a new form. Form2 is created by default. Change the size of Form2 so that it is the same size as Form1. Position Form2 so that it is on top of Form1.<br><br></li>
<li>
Add the following <b>Constant</b> and <b>Declare</b> statements to the General Declarations section of Form2 (note that the <b>Declare</b> statement must be typed as one single line of code):<pre><code>Private Declare Function SetWindowLong Lib "User" (ByVal hWnd As Integer, ByVal 
 &nbsp; nIndex As Integer, ByVal dwNewLong As Long) As Long
Const WS_EX_TRANSPARENT = &amp;H20&amp;
Const GWL_EXSTYLE = (-20)
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form2:<pre><code>Private Sub Form_Load()
 &nbsp; Dim Ret As Long
 &nbsp; Ret = SetWindowLong(Form2.hWnd, GWL_EXSTYLE, WS_EX_TRANSPARENT)
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the "Show Form" command button. Form2 is displayed directly over Form1. It appears as if only Form1 is displayed because Form2 has the transparent attribute.</p>
</BODY>
</HTML>
