<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 126: Sorting a List Box Control in Descending Order</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn126"></a></sup>Tip 126: Sorting a List Box Control in Descending Order</h1>
<p>
July 1, 1995</p>
<h2>Abstract</h2>
<p>
The <b>List Box</b> control in Microsoft® Visual Basic® provides a method of sorting a list of items in alphabetic order. This article explains how you can sort the items in a <b>List Box</b> control in descending order.</p>
<h2>Sorting in Descending Order</h2>
<p>
When developing an application in Microsoft® Visual Basic®, you can use the <b>List Box </b>control to maintain a list of related items. For example, you may need to store a list of vendor names in a <b>List Box</b> control.</p>
<p>
You can sort the items contained in a <b>List Box</b> control by setting the control's <b>Sorted</b> property to True. The items will be sorted in ascending alphabetic (A–Z) order. However, if you want to sort the items in descending order, you need to use two <b>List Box</b> controls.</p>
<p>
The example program uses two <b>List Box</b> controls. The first <b>List Box</b> contains the items you want to sort. The <b>Visible</b> property of this <b>List Box</b> is set to False, because it is your "working" <b>List Box</b> control. You don't want to see the contents of this control at run time. In addition, the <b>Sorted</b> property of the <b>List Box</b> is set to True. Each item you add to this <b>List Box</b> control is stored in ascending order.</p>
<p>
The second <b>List Box</b> control used in this program will display the final result of your sort routine. Its <b>Visible</b> property is set to True and its <b>Sorted</b> property is set to False.</p>
<p>
In the example program below, you simply copy the desired items you want to sort from the first <b>List Box</b> control to the second <b>List Box</b> control. To do this, you use a For-Next loop. The <b>ListCount</b> property of a <b>List Box</b> control tells you how many entries are stored in the control. You use this value (minus 1, because you start counting from zero) to step backwards from the end of the list to the beginning. Each time you cycle through the For-Next loop, you add the current item to the second <b>List Box</b> control. This stores the final list of items in descending (Z–A) order in the second <b>List Box</b> control.</p>
<h2>Example Program</h2>
<p>
This program shows how to reverse-sort the contents of a <b>List Box</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; List1.AddItem "Ten"
 &nbsp;&nbsp; List1.AddItem "One"
 &nbsp;&nbsp; List1.AddItem "Four"
 &nbsp;&nbsp; List1.AddItem "Sixteen"
 &nbsp;&nbsp; List1.AddItem "Forty"
End Sub
</code></pre>
</li>
<li>
Add a <b>List Box</b> control to Form1. List1 is created by default. Set its <b>Visible</b> property to False and its <b>Sorted</b> property to True.<br><br></li>
<li>
Add a second <b>List Box</b> control to Form1. List2 is created by default. Set its <b>Sorted</b> property to False.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; For X = List1.ListCount - 1 To 0 Step -1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List2.AddItem List1.List(X)
 &nbsp;&nbsp; Next X
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the command button. The <b>List Box</b> control is populated with the entries from the first (hidden) <b>List Box</b> control. These entries are sorted in descending order, from Z through A.</p>
</BODY>
</HTML>
