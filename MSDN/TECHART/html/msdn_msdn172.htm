<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 172: Extracting the Directory Name and the Filename from the Path</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn172"></a></sup>Tip 172: Extracting the Directory Name and the Filename from the Path</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to extract the directory name and the filename from a path when working with files and directories in your Microsoft® Visual Basic® application.</p>
<h2>Using the Len, Mid$, and Right$ Functions</h2>
<p>
When working with files and directories in Microsoft® Visual Basic®, you may need to isolate one or more elements from a full path. A path consists of the drive letter, directory name, and filename. Each element of a path is separated by a backslash character (\).</p>
<p>
When you need to extract the filename element from a complete path, you need to search for the last backslash character in the path string. To do this, you must first calculate the length of the path. This can be done using the Visual Basic <b>Len</b> function. The <b>Len</b> function returns the number of characters found in the specified string.</p>
<p>
When you know the actual length of the path string, you can check each character, beginning with the last character in the path string, to see whether it is a backslash character. The Visual Basic <b>Mid$</b> function can be used to perform this character comparison. When you finally locate the backslash character, you know that this signals the beginning of the filename stored within the path. You then use the Visual Basic <b>Right$</b> function to extract the filename from the longer string.</p>
<p>
This same technique can be used to extract the directory name from the path. In this case, however, the comparison routine starts from the beginning of the path string.</p>
<h2>Example Program</h2>
<p>
This program shows how to extract both the directory name and the filename from a path.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Text Box</b> control to Form1. Text1 is created by default.<br><br></li>
<li>
Add a second <b>Text Box</b> control to Form1. Text2 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim PathName As String

 &nbsp;&nbsp; PathName = "c:\eudora\wintips.exe"
 &nbsp;&nbsp; Text1.Text = ExtractFileName(PathName)
 &nbsp;&nbsp; Text2.Text = ExtractDirName(PathName)
End Sub
</code></pre>
</li>
<li>
Create a new function called <b>ExtractDirName</b>. Add the following code to this function:<pre><code>Function ExtractDirName(PathName As String) As String
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For X = Len(PathName) To 1 Step -1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Mid$(PathName, X, 1) = "\" Then Exit For
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExtractDirName = Left$(PathName, X - 1)
End Function
</code></pre>
</li>
<li>
Create a new function called <b>ExtractFileName</b>. Add the following code to this function:<pre><code>Function ExtractFileName(PathName As String) As String
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; For X = Len(PathName) To 1 Step -1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Mid$(PathName, X, 1) = "\" Then Exit For
 &nbsp;&nbsp; Next
 &nbsp;&nbsp; ExtractFileName = Right$(PathName, Len(PathName) - X)
End Function
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the <b>Command Button</b> control. The filename appears in the first <b>Text Box</b> control, and the directory name appears in the second <b>Text Box</b> control.</p>
</BODY>
</HTML>
