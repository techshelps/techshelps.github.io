<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 102: Modifying a Child Window's Caption</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn102"></a></sup>Tip 102: Modifying a Child Window's Caption</h1>
<p>
June 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how you can modify the caption displayed in a multiple-document interface (MDI) child window.</p>
<h2>Changing the Caption of Child Windows or Forms</h2>
<p>
The Microsoft® Word for Windows® application allows you to have several documents loaded into memory at one time. These text files are displayed in multiple-document interface (MDI) child windows.</p>
<p>
An MDI child window automatically inherits the parent window's caption. This caption is inserted before the child window's own caption. As an example, if the parent window's caption is MDIForm1 and the child window's caption is Form1, the child window's caption, at run time, will be set to MDIForm1 - [Form1].</p>
<p>
In your Visual Basic® application, you can set the child form's caption to a NULL string so that only the caption of the parent window is displayed. However, the dash and bracket characters must also be deleted. Because the caption is displayed in the non-client area of a window, you must use a subclassing control to process the paint event yourself. The <b>Message</b> <b>Blaster</b> custom control can be used to modify a child window's caption.</p>
<p>
However, another solution can do the same thing without using a subclassing control. Just use Visual Basic's string functions (<b>Mid</b> and <b>InStr</b>) to remove the unwanted text from the child window's caption. This code, as shown below in the example program, is placed in the child form's Resize event. Each time Windows needs to repaint the window, the caption will be modified.</p>
<h2>Example Program</h2>
<p>
This program shows how to modify a child window's caption text. Start this program by pressing F5. The original caption is "MDIForm1 - [Form1]".</p>
<p>
Start this program again after removing the <b>Exit</b> <b>Sub</b> statement from the Resize event (at the beginning of the code listing). The caption for the MDIForm1 window now reads, "MDIForm1 - Form1". The dash and bracket characters have been removed from the string. In addition, if you set Form1's caption to a NULL string, MDIForm1 will simply display its own caption—even when Form1 is minimized.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
From the Visual Basic Insert menu, select MDI Form. MDIForm1 is created by default.<br><br></li>
<li>
Set Form1's <b>MDIChild</b> property to True. Modify the size of this form so that it is smaller than the MDIForm1 form.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; Form1.Tag = Form1.Caption
 &nbsp;&nbsp; MDIForm1.Tag = MDIForm1.Caption
 &nbsp;&nbsp; Form1.WindowState = 2 'Maximize this form
 &nbsp;&nbsp; 
End Sub
</code></pre>
</li>
<li>
Add the following code to the Resize event for Form1:<pre><code>Private Sub Form_Resize()
 &nbsp; ' Exit Sub
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Dim Cap As String
 &nbsp;&nbsp; Dim Postn As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; If (Form1.WindowState = 2) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cap = MDIForm1.Caption
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MDIForm1.Caption = ""
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Postn = InStr(Cap, "[")
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (Postn) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mid(Cap, Postn, 1) = " "
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Postn = InStr(Cap, "]")
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (Postn) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mid(Cap, Postn, 1) = " "
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Postn = InStr(Cap, "-")
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (Postn) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mid(Cap, Postn, 1) = " "
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Form1.Caption = ""
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MDIForm1.Caption = Cap
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; 
 &nbsp;&nbsp; If (Form1.WindowState = 0) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Form1.Caption = Form1.Tag
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MDIForm1.Caption = MDIForm1.Tag
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; 
End Sub
</code></pre>
</li>
</ol>
</BODY>
</HTML>
