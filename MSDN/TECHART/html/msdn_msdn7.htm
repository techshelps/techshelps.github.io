<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 7: Minimizing and Maximizing Program Manager</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn7"></a></sup>Tip 7: Minimizing and Maximizing Program Manager</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
When writing an application in Visual Basic®, you may want to keep your desktop window as free of clutter as possible. This article explains how to minimize Program Manager so that it appears as an icon on your desktop. The article also demonstrates how you can restore Program Manager's window to its original size.</p>
<h2>Using the FindWindow and ShowWindow Functions</h2>
<p>
The Windows <b>ShowWindow</b> function is used to set a window's visibility status. You can tell the function to display the window as minimized, maximized, or any number of other states.</p>
<p>
To declare this function within your program, include the following <b>Declare</b> statement in the Global Module or General Declarations section of your form:</p>
<pre><code>Declare Function ShowWindow Lib "User" (ByVal hWnd As Integer, ByVal nCmdShow As Integer) As Integer
</code></pre>
<p>
Note that this <b>Declare</b> statement must be typed as one single line of text.</p>
<p>
To call the <b>ShowWindow</b> function, you pass the window's handle and the visibility status you want to apply to the window. The visibility status may be one of the following constants:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=31%><b>SW_HIDE</b></td>
<td width=69%>Window is hidden.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_MINIMIZE</b></td>
<td width=69%>Window is minimized.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_RESTORE</b></td>
<td width=69%>Window is restored to original size/position.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_SHOW</b></td>
<td width=69%>Window is restored to original size/position and activated.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_SHOWMAXIMIZED</b></td>
<td width=69%>Window is maximized and activated.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_SHOWMINIMIZED</b></td>
<td width=69%>Window is minimized and activated.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_SHOWMINNOACTIVE</b></td>
<td width=69%>Window is minimized but not activated.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_SHOWNA</b></td>
<td width=69%>Window is shown at current size/position but not activated.</td>
</tr>
<tr valign=top>
<td width=31%><b>SW_SHOWNORMAL</b></td>
<td width=69%>Window is restored to original size/position.</td>
</tr>
</table><br>
<p>
To change the visibility status of a window with the <b>ShowWindow</b> function, you must first determine the window's handle. In our case, we need to retrieve the handle for Program Manager. This can be accomplished by calling the <b>FindWindow</b> function.</p>
<p>
To declare the <b>FindWindow</b> function within your program, include the following <b>Declare</b> statement in the Global Module or General Declarations section of your form:</p>
<pre><code>Declare Function FindWindow Lib "User" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Integer
</code></pre>
<p>
To call the <b>FindWindow</b> function, you must pass it two arguments, as follows:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=20%><i>lpClassName</i></td>
<td width=80%>A string (or long pointer to a string) that contains the window's class name. A value of zero is used to accept any class.</td>
</tr>
<tr valign=top>
<td width=20%><i>lpWindowName</i></td>
<td width=80%>A string (or long pointer to a string) that contains the window's title bar text. A value of zero is used to accept any window title.</td>
</tr>
</table><br>
<p>
Because we want to minimize (or maximize) Program Manager to an icon, we would call the <b>FindWindow</b> function with the following statement:</p>
<pre><code>hWnd = FindWindow(0&amp;, "Program Manager")
</code></pre>
<p>
The window's handle will be returned in the <i>hWnd</i> variable. We can then call the <b>ShowWindow</b> function to minimize or to maximize Program Manager with these two statements:</p>
<pre><code>I = ShowWindow(hWnd, SW_SHOWMINNOACTIVE)
I = ShowWindow(hWnd, SW_RESTORE)
</code></pre>
<h2>Example Program</h2>
<p>
The following program shows how to minimize and maximize Program Manager from within a Visual Basic application.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following <b>Constant</b> and <b>Declare </b>statements to the General Declarations section of Form1 (note that each <b>Declare</b> statement must be typed as a single line of text):<pre><code>Declare Function ShowWindow Lib "User" (ByVal hWnd As Integer, ByVal nCmdShow
 &nbsp;&nbsp; As Integer) As Integer
Declare Function FindWindow Lib "User" (ByVal lpClassName As Any, ByVal 
 &nbsp;&nbsp; lpWindowName As Any) As Integer
Const SW_SHOWMINNOACTIVE = 7
Const SW_RESTORE = 9
</code></pre>
</li>
<li>
Add a Command Button control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Minimize PM".<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Sub Command1_Click()
 &nbsp;&nbsp; Dim hWnd As Integer, I As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; hWnd = FindWindow(0&amp;, "Program Manager")
 &nbsp;&nbsp; If hWnd &lt;&gt; 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I = ShowWindow(hWnd, SW_SHOWMINNOACTIVE)
 &nbsp;&nbsp; End If
End Sub
</code></pre>
</li>
<li>
Add a second Command Button control to Form1. Command2 is created by default. Set its <b>Caption</b> property to "Maximize PM".<br><br></li>
<li>
Add the following code to the Click event for Command2:<pre><code>Sub Command2_Click()
 &nbsp;&nbsp; Dim hWnd As Integer, I As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; hWnd = FindWindow(0&amp;, "Program Manager")
 &nbsp;&nbsp; If hWnd &lt;&gt; 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I = ShowWindow(hWnd, SW_RESTORE)
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; Form1.SetFocus
End Sub
</code></pre>
</li>
</ol>
<p>
When you execute this demonstration program, click on the "Minimize PM" command button to make Program Manager a minimized icon on the desktop. Click on the "Maximize PM" command button to restore Program Manager to its default size.</p>
</BODY>
</HTML>
