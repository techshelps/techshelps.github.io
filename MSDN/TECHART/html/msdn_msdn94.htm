<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 94: Using Drag-and-Drop on Multiple Items in a List Box Control</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn94"></a></sup>Tip 94: Using Drag-and-Drop on Multiple Items in a List Box Control</h1>
<p>
May 22, 1995</p>
<h2>Abstract</h2>
<p>
The drag-and-drop functionality provided in many Windows®-based applications allows you to copy an item from one program to another or from one control to another control in the same application. This article explains how to use this drag-and-drop technique in Visual Basic® to copy multiple items selected in a <b>List Box</b> control to another <b>List Box</b> control.</p>
<h2>Dragging Multiple List Box Items</h2>
<p>
Many Windows-based applications include drag-and-drop functionality. This means that you can select an item, such as an entry in a <b>List Box</b> control, click on the item, and, while holding the mouse button down, drag that item to another window or control and drop it on its new location.</p>
<p>
The example program below shows how you can add this drag-and-drop feature to your Visual Basic® applications. This program allows you to select multiple items in the source <b>List Box</b> control and drag the whole group of selected items to a second <b>List Box</b> control all at one time.</p>
<h2>Example Program</h2>
<p>
This program shows how to drag several items selected in one <b>List Box</b> control to another <b>List Box</b> control. Run the example program by pressing the F5 function key. From the first <b>List</b> <b>Box</b> control, click the mouse on several items to select (highlight) them. While clicking each item, hold down the SHIFT key. When you want to drag the selected items to the second <b>List Box</b> control, click once on the first <b>List Box</b> control and hold the mouse button down while you drag the control to the second <b>List Box</b>. Release the mouse button to drop the selected items onto the second <b>List Box</b> control.</p>
<p>
While using this program, you can select the items from the first <b>List Box</b> either by holding the SHIFT key down while you click on each entry, or by simply clicking the mouse on each individual entry. If you hold the SHIFT key down when selecting entries, those entries will remain selected (highlighted) in the first <b>List Box</b> control after the items have been dropped onto the second <b>List Box</b> control. If the SHIFT key is <i>not</i> used, one of the selected items will not retain its selected status after the drag-and-drop operation has finished.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the General Declarations section of Form1:<pre><code>Option Explicit
Dim IG As Integer
Dim LIG(20) As Integer
Dim LGlobal As Long
Const VK_SHIFT = &amp;H10
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
Dim X As Integer
IG = 0
For X = 0 To 9
List1.AddItem "Item #" + Str$(X)
Next X
List1.DragMode = 0
LGlobal = 99999
End Sub
</code></pre>
</li>
<li>
Add a <b>List Box</b> control to Form1. List1 is created by default. Set its <b>MultiSelect</b> property to 1-Simple.<br><br></li>
<li>
Add the following code to the MouseDown event for List1 (note that the Private line must be typed as a single line of code):<pre><code>Private Sub List1_MouseDown(Button As Integer, Shift As Integer, X As Single, 
Y As Single)
LGlobal = List1.ListIndex
For X = 1 To IG
List1.Selected(LIG(X)) = True
Next X
List1.Drag
End Sub
</code></pre>
</li>
<li>
Add a second <b>List Box</b> control to Form1. List2 is created by default. Set its <b>MultiSelect</b> property to 1-Simple.<br><br></li>
<li>
Add the following code to the DragDrop event for List2:<pre><code>Private Sub List2_DragDrop(Source As Control, X As Single, Y As Single)
 &nbsp;&nbsp; For X = 0 To List1.ListCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If X = LGlobal Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List2.AddItem List1.List(X)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If List1.Selected(X) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List2.AddItem List1.List(X)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp; Next X
 &nbsp;&nbsp; LGlobal = 99999
 &nbsp;&nbsp; IG = 0
End Sub
</code></pre>
</li>
</ol>
<h2>Additional References</h2>
<p>
Knowledge Base Q80187. "How to Drop Item into Specified Location in VB List Box."</p>
<p>
<a href="msdn_msdn50.htm">"Tip #50: Using Drag and Drop in List Box Controls."</a></p>
</BODY>
</HTML>
