<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 15: Creating a List of Directories Stored on a Disk</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn15"></a></sup>Tip 15: Creating a List of Directories Stored on a Disk</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
Visual Basic® has three file system controls: the Drive List Box, the Directory List Box, and the File List Box. Using these three controls, a Visual Basic application can access every file stored on a floppy, fixed, or network disk drive.</p>
<h2>Finding All Directories on a Disk Drive</h2>
<p>
You can use the Visual Basic® file system controls to navigate up and down the directory structure of a disk. This means that you can determine the name of each directory, saving the name in a List Box or dynamic array, if desired. Finding the directory names would be useful, for example, in a file-finding application.</p>
<p>
When a Visual Basic program displays a Directory List Box control on the screen, the user can see a list of the current directories in the selected path. The user can select a directory by double-clicking on its name. However, the default directory is not automatically changed to the selected directory by the Directory List Box control. Your application must retrieve the selected directory's name from the <b>Path</b> property of the Directory List Box and call a <b>ChDir</b> function to physically change directories on the disk. When using the Drive List Box and the File List Box controls, your application must also physically change to the selected drive and filename, respectively.</p>
<p>
The Path property of a Directory List Box always returns the name of the currently selected directory. When you change the <b>Path</b> property, the PathChange event is automatically triggered. This event updates the Directory List Box to show the new directories in the selected directory.</p>
<h2>Example Program</h2>
<p>
The following program shows how you can determine the names of all directories stored on a hard drive.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Place a <b>ListBox</b>, a <b>DirListBox</b>, and a <b>CommandButton</b> on the form.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Sub FindDirectories()
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Dim i As Integer
 &nbsp;&nbsp; On Error Resume Next
 &nbsp;&nbsp; 
 &nbsp;&nbsp; For i = 0 To Dir1.ListCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dir1.Path = Dir1.List(i)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List1.AddItem Dir1.List(Dir1.ListIndex)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FindDirectories
 &nbsp;&nbsp; Next i
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Dir1.Path = Dir1.Path &amp; "\.."
 &nbsp; 
 &nbsp;&nbsp; DoEvents
 &nbsp;&nbsp; 

End Sub

Private Sub Command1_Click()

 &nbsp;&nbsp; Dir1.Path = "c:\"

 &nbsp;&nbsp; FindDirectories

End Sub
</code></pre>
</li>
<li>
Add a Directory List Box control to Form1. Dir1 is created by default. Set its <b>Visible</b> property to False.<br><br></li>
<li>
Add the following code to the Change event for the Dir1 Directory List Box control:<pre><code>Sub Form_Load()
 &nbsp;&nbsp; Next_Dir = 0
 &nbsp;&nbsp; Temp_Dir = "C:\"
 &nbsp;&nbsp; Dir1.Path = Temp_Dir
 &nbsp;&nbsp; Temp_Dir = List2.List(Next_Dir)&nbsp;&nbsp;&nbsp; 
Get_Next:
 &nbsp;&nbsp; Next_Dir = Next_Dir + 1
 &nbsp;&nbsp; Dir1.Path = Temp_Dir
 &nbsp;&nbsp; Temp_Dir = List2.List(Next_Dir)&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp; If List2.ListCount - 1 = Next_Dir Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; GoTo Get_Next
End Sub
</code></pre>
</li>
<li>
Add a List Box control to Form1. List1 is created by default. Set its <b>Visible</b> property to False and its <b>MultiSelect</b> property to 1-Simple.<br><br></li>
<li>
Add a second List Box control to Form1. List2 is created by default. Set its <b>Visible</b> property to True, its <b>MultiSelect</b> property to 1-Simple, and its <b>Sorted</b> property to True.</li>
</ol>
<p>
When you execute this program, Visual Basic will search for all subdirectories on the drive C. This may take a few moments to do, depending on the size of the hard disk and the number of directories the application finds. The name of each subdirectory will be displayed in the List Box, in alphabetical order.</p>
</BODY>
</HTML>
