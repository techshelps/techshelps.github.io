<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mapping the Microsoft Project for Windows 95 Object Library: MSProject 4.1</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_mapprj95"></a></sup>Mapping the Microsoft Project for Windows 95 Object Library: MSProject 4.1</h1>
<p>
Ken Lassesen<br>
Microsoft Developer Network Technology Group</p>
<p>
January 12, 1996</p>
<p>
<OBJECT id=sample1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"
	width=0 height=0 hspace=0>
<PARAM name="Command" value="Sample">
<PARAM name="Item1" value="Technical Articles Sample">
<PARAM name="Item2" value="4541">
</OBJECT><a href="javascript:sample1.Click()">Click here for a diagram of the Microsoft Project for Windows 95 object library in various graphics formats.</a></p>
<h2>Abstract</h2>
<p>
This article presents a graphic map of the Microsoft® Project for Windows® 95 object, showing its properties, methods, and child objects. This server is available from Visual C++® and many products based on Visual Basic® for Applications, including Microsoft Excel version 5.0 and later, Microsoft Access 95, Visual Basic version 4.0, and Visual C++ version 4.0. </p>
<h2>Microsoft Project for Windows 95 Object</h2>
<p>
The Microsoft® Project® for Windows® 95 object (MSProject) enables the developer to manipulate Microsoft Project project files from other applications.</p>
<p>
This object is accessible from Visual C++® version 4.0 and many products that contain Visual Basic® for Applications, including Microsoft Excel version 5.0 and later, Microsoft Access 95, Visual Basic version 4.0, and Microsoft Project. For further information on using this object, see the documentation for these products and the articles in the bibliography.</p>
<p>
Figure 1 shows the relationship between objects as described by the Object Viewer and online Help files. A map serves as a good learning aid and as a quick reference for developers. After producing a map, I found that it was easy to work with the object: I just post the appropriate map on my wall for quick reference, which is a lot faster than clicking objects in a Help file one by one to discover their properties and methods.</p>
<p>
Because Figure 1 is difficult to read online, I have included the two most common graphics formats—encapsulated PostScript™ (.EPS) and Windows metafile (.WMF)—as well as a copy of my original ShapeWare™ Visio™ version 4.0 file (.VSD). The first two formats can be opened and the maps printed across multiple pages using Microsoft Excel or a commercial graphics application such as Adobe™ PageMaker™, CorelDRAW®, or Microsoft Publisher. The original Visio file is included for those who wish to modify the diagram. </p>
<p>
<img src="mapprj95_1.gif" border=0> </p>
<p class=label>
<b>Figure 1. Map of the Microsoft Project for Windows 95 object library</b></p>
<h3>True Confessions</h3>
<p>
The developers of the Microsoft Project OLE Automation server were faced with the problem of backward compatibility with the version 3.0 macro language. (As the Danish programmer Hamlet put it, "To break or not to break; that is the question!") The decision to support backward compatibility meant including some unusual methods that may cause problems. These methods are shown in the diagram and are discouraged for new development. The <b>Application.About</b> method, which causes the About dialog box to be displayed, is an example of one such method. This dialog box<i> </i>hangs the controller applications until the user dismisses it. The following problems can occur:
<ul type=disc>
<li>
The dialog box becomes hidden behind a dialog box of another application.<br><br></li>
<li>
The controller displays a time-out message if the user doesn't dismiss the dialog box quickly enough.<br><br></li>
<li>
The dialog box appears on a screen at an unknown location if Remote OLE Automation is used. The user must then gain physical access and logon permission to dismiss the dialog box.</li>
</ul>
<p>
The <b>Application.About</b> method, included to support backward compatibility, violates the rule that an OLE Automation server never be put into a state where it is not possible to close the server using only OLE Automation.</p>
<p>
The Microsoft Project for Windows 95 OLE Automation server type library is inconsistent with the documentation in several cases. Some read-only properties are not marked read only in the type library. For example, many collections have a <b>Count</b> element. The <b>Count</b> element cannot be set, although a developer can write code that will compile. For example:</p>
<pre><code>Dim x As MSProject.Projects
x.Count = 5 'Should produce error message at compile time but does not
</code></pre>
<p>
Many of the elements referred to as <b>Application.</b><i>properties</i> in the documentation are defined in the type library as being <b>Application.</b><i>methods</i> when examined by the OLE 2 Object View application. I underlined in Figure 1 all of the elements that are documented to be properties and are defined to be methods. These items appear as <b><i><u>Property</u></i></b> instead of Property or <u>Property</u>. Similarly, a few elements are documented as methods but are defined as properties; these elements appear as defined rather than as documented.</p>
<p>
One element defined in the documentation does not exist in the type library—<b>Application.Left</b>. However, because <b>MSProject.Application</b> is late bound in the type library, the following code works:</p>
<pre><code>Dim appMSProject As MSProject.Application
Set appMSProject = CreateObject("MSProject.Application")
appMSProject.Top = 100
appMSProject.Left = 0
</code></pre>
<h3>Object Definitions</h3>
<p>
The objects and collections in Figure 1 are defined in Table 1.</p>
<p class=label>
<b>Table 1. Object and Collection Definitions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Object or Collection</b></td>
<td class=label width=75%><b>Definition</b></td>
</tr>
<tr valign=top>
<td width=25%><b>Application</b> object</td>
<td width=75%>Represents the active Microsoft Project application. The <b>Application</b> object is the parent of the <b>Cell</b>, <b>Project</b>, <b>Selection</b>, and <b>Window</b> objects and of the <b>Projects</b> and <b>Windows</b> collections.</td>
</tr>
<tr valign=top>
<td width=25%><b>Projects</b> collection</td>
<td width=75%>Contains all open projects.</td>
</tr>
<tr valign=top>
<td width=25%><b>Project</b> object</td>
<td width=75%>Represents one open project. The <b>Project</b> object is the parent of the <b>Tasks</b>, <b>Resources</b>, and <b>Calendars</b> collections.</td>
</tr>
<tr valign=top>
<td width=25%><b>Tasks</b> collection</td>
<td width=75%>Contains all of the tasks in a project.</td>
</tr>
<tr valign=top>
<td width=25%><b>Task</b> object</td>
<td width=75%>Represents a task.</td>
</tr>
<tr valign=top>
<td width=25%><b>Resources</b> collection</td>
<td width=75%>Contains all of the resources for a task or a project.</td>
</tr>
<tr valign=top>
<td width=25%><b>Resource</b> object</td>
<td width=75%>Represents a single resource.</td>
</tr>
<tr valign=top>
<td width=25%><b>Calendars</b> collection</td>
<td width=75%>Contains all of the calendars for a project.</td>
</tr>
<tr valign=top>
<td width=25%><b>Calendar </b>object</td>
<td width=75%>Represents a calendar for a project or a resource.</td>
</tr>
<tr valign=top>
<td width=25%><b>Period</b> object</td>
<td width=75%>Represents a period in a calendar.</td>
</tr>
<tr valign=top>
<td width=25%><b>Shift</b> object</td>
<td width=75%>Represents a work shift for a day, month, period, weekday, or year.</td>
</tr>
<tr valign=top>
<td width=25%><b>Weekdays</b> collection</td>
<td width=75%>Contains the weekdays in a calendar.</td>
</tr>
<tr valign=top>
<td width=25%><b>Weekday</b> object</td>
<td width=75%>Represents a weekday in a calendar.</td>
</tr>
<tr valign=top>
<td width=25%><b>Years</b> collection</td>
<td width=75%>Contains all of the years in a calendar.</td>
</tr>
<tr valign=top>
<td width=25%><b>Year</b> object</td>
<td width=75%>Represents a year in a calendar.</td>
</tr>
<tr valign=top>
<td width=25%><b>Months </b>collection</td>
<td width=75%>Contains all of the months in a year.</td>
</tr>
<tr valign=top>
<td width=25%><b>Month</b> object</td>
<td width=75%>Represents a month of a year.</td>
</tr>
<tr valign=top>
<td width=25%><b>Days </b>collection</td>
<td width=75%>Contains all of the days in a month.</td>
</tr>
<tr valign=top>
<td width=25%><b>Day </b>collection</td>
<td width=75%>Represents a day of a month.</td>
</tr>
<tr valign=top>
<td width=25%><b>Assignments</b> collection</td>
<td width=75%>Contains all of the assignments for a task or a resource.</td>
</tr>
<tr valign=top>
<td width=25%><b>Assignment </b>object</td>
<td width=75%>Represents an assignment for a task or a resource.</td>
</tr>
<tr valign=top>
<td width=25%><b>Windows </b>collection</td>
<td width=75%>Contains all of the windows open in an application or project.</td>
</tr>
<tr valign=top>
<td width=25%><b>Window </b>object</td>
<td width=75%>Represents a window open in an application or project.</td>
</tr>
<tr valign=top>
<td width=25%><b>Properties</b> object</td>
<td width=75%>Is a <b>DocumentProperties</b> object as described in "Mapping the Microsoft Office 95 Object Library: MicrosoftOffice."</td>
</tr>
<tr valign=top>
<td width=25%><b>Cell </b>object</td>
<td width=75%>Represents the active cell of the project.</td>
</tr>
<tr valign=top>
<td width=25%><b>Selection </b>object</td>
<td width=75%>Represents the active selection.</td>
</tr>
<tr valign=top>
<td width=25%><b>List</b> collection</td>
<td width=75%>Contains strings or numbers, field names, resource filters, resource tables, resource views, task filters, task tables, or task views.</td>
</tr>
</table><br>
<h2>Bibliography</h2>
<p>
Lassesen, Ken. <a href="msdn_ole2soln.htm">"Using Microsoft OLE Automation Servers to Develop Solutions."</a> (MSDN Library, Technical Articles)</p>
<p>
Lassesen, Ken. <a href="msdn_mapoff95.htm">"Mapping the Microsoft Office 95 Object Library: MicrosoftOffice."</a> (MSDN Library, Technical Articles)</p>
<p>
"Microsoft Project Visual Basic Reference" (VBA_PJ.HLP) is installed with Visual Basic 4.0 and Microsoft Project for Windows 95.</p>
</BODY>
</HTML>
