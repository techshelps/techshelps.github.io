<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 77: Determining the Amount of RAM Installed in a Computer</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn77"></a></sup>Tip 77: Determining the Amount of RAM Installed in a Computer</h1>
<p>
May 8, 1995</p>
<h2>Abstract</h2>
<p>
You can use the Windows® application programming interface (API) <b>MemManInfo</b> function to determine how much random access memory (RAM) is installed in the computer system. This article explains how to retrieve the amount of RAM.</p>
<h2>How Much Memory Do You Have?</h2>
<p>
The Windows® application programming interface (API) <b>MemManInfo</b> function can be called to determine how much random access memory (RAM) is installed in your computer. This function is included in the TOOLHELP.DLL file.</p>
<p>
To use the <b>MemManInfo</b> function in a Visual Basic® application, you must declare the function as follows:</p>
<pre><code>Private Declare Function MemManInfo% Lib "Toolhelp.dll" (lpmmi As TagMemManInfo)
</code></pre>
<p>
The <b>MemManInfo</b> function takes only one argument: a structure that will hold information about the memory manager. The number of pages of memory is stored in the wPageSize field of this structure. We need only multiply the number of pages found by a value of 4 to calculate how much RAM is installed.</p>
<h2>Example Program</h2>
<p>
The example program below shows how to retrieve the amount of RAM installed in the computer system.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; Dim R As Long
 &nbsp;&nbsp; Text1.Text = "Total RAM installed: "
 &nbsp;&nbsp; R = GetRAMSize
 &nbsp;&nbsp; Text1.Text = Text1.Text + Str(R)
 &nbsp;&nbsp; 
End Sub
</code></pre>
</li>
<li>
Add a new module to the project. Module.Bas is created by default.<br><br></li>
<li>
Add the following code to the Module.Bas file:<pre><code>Type TagMemManInfo
 &nbsp;&nbsp; dwSize As Long
 &nbsp;&nbsp; dwLargestFreeBlock As Long
 &nbsp;&nbsp; dwMaxPagesAvailable As Long
 &nbsp;&nbsp; dwMaxPagesLockable As Long
 &nbsp;&nbsp; dwTotalLinearSpace As Long
 &nbsp;&nbsp; dwTotalUnlockedPages As Long
 &nbsp;&nbsp; dwFreePages As Long
 &nbsp;&nbsp; dwTotalPages As Long
 &nbsp;&nbsp; dwFreeLinearSpace As Long
 &nbsp;&nbsp; wPageSize As Integer
End Type
Private Declare Function MemManInfo% Lib "Toolhelp.dll" (lpmmi As TagMemManInfo)
Function GetRAMSize() As Long
 &nbsp;&nbsp; Dim mmi As TagMemManInfo
 &nbsp;&nbsp; mmi.dwSize = Len(mmi)
 &nbsp;&nbsp; x% = MemManInfo(mmi)
 &nbsp;&nbsp; If x% &lt;&gt; 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetRAMSize = mmi.dwTotalPages * 4
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetRAMSize = 0
 &nbsp;&nbsp; End If
End Function
</code></pre>
</li>
<li>
Add a <b>Text Box</b> control to Form1. Text1 is created by default.</li>
</ol>
<h2>Additional References</h2>
<p>
"Windows Questions and Answers." (MSDN Library Archive, Books and Periodicals, Microsoft Systems Journal, 1994 Volume 9, March 1994 Number 3)</p>
<p>
"FREEMEM2: Displays System Memory Information." (MSDN Library Archive, Sample Code, Book and Periodical Samples, Microsoft Systems Journal Samples, 1994 Volume 9)</p>
</BODY>
</HTML>
