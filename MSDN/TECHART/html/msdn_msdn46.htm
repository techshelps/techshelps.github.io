<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 46: Deleting Entire Directories</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn46"></a></sup>Tip 46: Deleting Entire Directories</h1>
<p>
Created: April 3, 1995</p>
<h2>Abstract</h2>
<p>
Visual Basic® offers several commands to manipulate disk files. You can delete a file with the <b>Kill</b> statement and delete a directory with the <b>RmDir</b> function. If the Visual Basic application you are creating needs to remove all the files stored in a directory, these two commands will do this for you. This article shows how you can use Visual Basic file commands to remove all files stored in a subdirectory, including those files stored under nested subdirectories.</p>
<h2>Recursively Deleting Files and Directories from a Disk</h2>
<p>
The Visual Basic® <b>Kill </b>statement deletes a specified file from the disk. To delete a specific file, you simply pass the filename to the <b>Kill </b>statement. The <b>Kill </b>statement supports the wildcard "*" and "?" characters. By the same token, the <b>RmDir</b> statement in Visual Basic deletes a directory from the disk. To delete a directory successfully, the directory must be empty—that is, all files in the directory must have been previously deleted.</p>
<p>
It's easy to see how the <b>Kill </b>and <b>RmDir</b> statements can be used to delete entire directory structures very quickly. The example program below starts off by changing to the target directory and then deleting all files stored in that directory. Once all the files from this directory have been deleted, the program removes the empty directories it finds. This process is repeated until the entire target directory and its associated files have been successfully removed from the disk.</p>
<p>
The example program only processes files that have a file attribute of Normal. This means that you would have to modify the program to search for and delete files with other attributes, such as hidden, read-only, or volume label files.</p>
<h2>Example Program</h2>
<p>
The following program will delete all the files in a directory. Note that in this example it is assumed that a directory named TEST exists on drive C. All files, including nested subdirectories and their files, will be removed from disk with this program.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a Command Button control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Remove Entire Directory".<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Sub Command1_Click()
  Dim TempDir As String
  TempDir = "C:\TEST"
  Nuke TempDir
End Sub
</code></pre>
</li>
<li>
Add a new subroutine procedure called Nuke. Add the following code to this procedure:<pre><code>Sub Nuke(DirName As String)
  Const ATTR_NORMAL = 0
  Const ATTR_DIRECTORY = 16

  Dim OriginalDir, FileName, NextFileName As String

  OriginalDir = CurDir$
  ChDir DirName
  FileName = Dir$("*.*", ATTR_NORMAL)
  Do While FileName &lt;&gt; ""
 &nbsp;&nbsp;&nbsp;&nbsp; Kill FileName
 &nbsp;&nbsp;&nbsp;&nbsp; FileName = Dir$
  Loop

  Do
 &nbsp;&nbsp; FileName = Dir$("*.*", ATTR_DIRECTORY)
 &nbsp;&nbsp; While FileName = "." Or FileName = ".."
 &nbsp;&nbsp; FileName = Dir$
  Wend

 &nbsp;&nbsp; If FileName = "" Then Exit Do
 &nbsp;&nbsp; Nuke (FileName)
  Loop&nbsp;&nbsp;&nbsp; 

  ChDir OriginalDir
  RmDir DirName
End Sub
</code></pre>
</li>
</ol>
</BODY>
</HTML>
