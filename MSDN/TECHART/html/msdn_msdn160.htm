<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 160: Retrieving the Versions of MS-DOS and Windows</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn160"></a></sup>Tip 160: Retrieving the Versions of MS-DOS and Windows</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to retrieve the version numbers of MS-DOS® and/or the Microsoft® Windows® operating system installed on your computer system.</p>
<h2>Using the GetVersion Function</h2>
<p>
There may be times when you need to retrieve the version of MS-DOS® and/or the Microsoft® Windows® operating system installed on your computer system. This information is useful when you need to perform a task and a check must be made to ensure that the task is supported under MS-DOS or Windows.</p>
<p>
The Windows application programming interface (API) <b>GetVersion</b> function can be used to retrieve both the MS-DOS and the Windows versions installed on the computer system. To use this function, you must add the following <b>Declare</b> statement to the General Declarations section of your form:</p>
<pre><code>Private Declare Function GetVersion Lib "kernel32" () As Long
</code></pre>
<p>
After calling the <b>GetVersion</b> function, a long value is returned. This value contains the major and minor version numbers of Windows in the low word. The high word contains the major and minor version numbers of MS-DOS.</p>
<p>
Once you have retrieved the version information, it is a simple matter to isolate the high and low bytes of each word and convert these values to the version numbers.</p>
<h2>Example Program</h2>
<p>
This program shows how to retrieve the version of MS-DOS and Windows installed in the computer system.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following <b>Declare</b> statement to the General Declarations section of Form1:<pre><code>Private Declare Function GetVersion Lib "kernel32" () As Long
</code></pre>
</li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim WinMajor As Integer
 &nbsp;&nbsp; Dim WinMinor As Integer
 &nbsp;&nbsp; Dim DosMajor As Integer
 &nbsp;&nbsp; Dim DosMinor As Integer
 &nbsp;&nbsp; Dim RetLong As Long
 &nbsp;&nbsp; Dim LoWord As Integer
 &nbsp;&nbsp; Dim HiWord As Integer

 &nbsp;&nbsp; RetLong = GetVersion()
 &nbsp;&nbsp; Call GetHiLoWord(RetLong, LoWord, HiWord)

 &nbsp;&nbsp; Call GetHiLoByte(LoWord, WinMajor, WinMinor)
 &nbsp;&nbsp; Call GetHiLoByte(HiWord, DosMinor, DosMajor)

 &nbsp;&nbsp; Text1.Text = "Windows version:" &amp; WinMajor &amp; "." &amp; WinMinor
 &nbsp;&nbsp; Text2.Text = "DOS version:" &amp; DosMajor &amp; "." &amp; DosMinor

End Sub
</code></pre>
</li>
<li>
Add a <b>Text Box</b> control to Form1. Text1 is created by default.<br><br></li>
<li>
Add a second <b>Text Box</b> control to Form1. Text2 is created by default.<br><br></li>
<li>
Create a new function called <b>GetHiLoByte</b>. Add the following code to this function:<pre><code>Sub GetHiLoByte(X As Integer, LoByte As Integer, HiByte As Integer)
 &nbsp;&nbsp; LoByte = X And &amp;HFF&amp;
 &nbsp;&nbsp; HiByte = X \ &amp;H100
End Sub
</code></pre>
</li>
<li>
Create a new function called <b>GetHiLoWord</b>. Add the following code to this function:<pre><code>Sub GetHiLoWord(X As Long, LoWord As Integer, HiWord As Integer)
 &nbsp;&nbsp; LoWord = CInt(X And &amp;HFFFF&amp;)
 &nbsp;&nbsp; HiWord = CInt(X \ &amp;H10000)
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. The major and minor version numbers of Windows appear in the first <b>Text Box</b> control. The major and minor version numbers of MS-DOS appear in the second <b>Text Box</b> control.</p>
</BODY>
</HTML>
