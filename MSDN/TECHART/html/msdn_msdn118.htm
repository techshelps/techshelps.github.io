<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 118: Converting a Word for Windows Document to RTF Format</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn118"></a></sup>Tip 118: Converting a Word for Windows Document to RTF Format</h1>
<p>
July 1, 1995</p>
<h2>Abstract</h2>
<p>
In a Microsoft® Visual Basic® application, you may need to convert a Microsoft Word for Windows® version 6.0 document to rich-text format (RTF). This article explains how this can be accomplished in Visual Basic.</p>
<h2>Using OLE Automation in Visual Basic</h2>
<p>
You can use OLE Automation in a Microsoft® Visual Basic® application to perform specific tasks in another Microsoft Windows®-based application. For example, you may need to convert a Microsoft Word for Windows version 6.0 document to rich-text format (RTF).</p>
<p>
The example program below shows how to run Word for Windows, load an existing document into Word, and then save that document to disk in RTF format. The OLE commands sent to Microsoft Word enable you to have total control over Word; that is, from within Visual Basic you can tell Word exactly what to do and when to do it.</p>
<p>
In this example program, you need some way to communicate with Microsoft Word. You do this by creating an object variable for Word. In this case, you use WordBasic. Next, you tell Microsoft Word that you want to load a specific document. Therefore, you tell Word to carry out a <b>FileOpen</b> command to load the document into memory.</p>
<p>
In the same manner, you use the object variable to tell Word to save the document&nbsp; (using the WordBasic <b>FileSaveAs</b> command) in RTF format. You must specify both a file name for the document and the file format in which you want to save the document. Because you want to save the file as an RTF document, specify the value 6 for RTF.</p>
<p>
After Word has saved the document in RTF format, you want to exit Word and return to your Visual Basic application. This is done by setting the object variable to Nothing, which closes the server application.</p>
<h2>Example Program</h2>
<p>
This program shows how to use OLE Automation to convert a Microsoft Word for Windows 6.0 document to RTF format from within a Visual Basic application.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Convert to RTF".<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim Obj As Object
 &nbsp;&nbsp; Set Obj = CreateObject("Word.basic")
 &nbsp;&nbsp; Obj.FileOpen "c:\demo.doc"
 &nbsp;&nbsp; Obj.FileSaveAs "c:\demo.rtf", 6
 &nbsp;&nbsp; Set Obj = Nothing
 &nbsp;&nbsp; MsgBox "Document converted to RTF format"
End Sub
</code></pre>
</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This program assumes that you have a Word for Windows 6.0 document named DEMO.DOC stored in the root directory of drive C. This document will be converted to RTF format and stored on drive C as DEMO.RTF.</p>
<p>
Run the example program by pressing F5. Click the "Convert to RTF" command button. Visual Basic runs Microsoft Word, loads DEMO.DOC into memory, and saves a new copy of the document to disk in RTF format. A message box is displayed when the whole process has been completed.</p>
<h2>Additional References</h2>
<p>
Knowledge Base Q112440. "How to Save an Embedded Word Document in Visual Basic."</p>
<p>
Knowledge Base Q108043. "How VB Can Use OLE Automation with Word Version 6.0."</p>
<p>
Knowledge Base Q97618. "OLE Embedding &amp; Linking Word for Windows Objects into VB Apps."</p>
</BODY>
</HTML>
