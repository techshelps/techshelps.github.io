<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 25: Retrieving the Drive Letter for Temporary Files</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn25"></a></sup>Tip 25: Retrieving the Drive Letter for Temporary Files</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
When you install a Windows®-based application on your hard disk, it creates its own directory and copies its files to that directory. However, when you run the application, it may need to create additional temporary data files of some sort. Where does the application store these temporary files and how can your program retrieve this drive number and/or path?</p>
<h2>The GetTempDrive and Environ$ Functions</h2>
<p>
A temporary file can be created in any directory on the hard drive, but a Windows®-based application needs to know where you would like these files stored. To determine which disk drive should be used to hold temporary files, you can call the Windows application programming interface (API) <b>GetTempDrive</b> function . Include the following <b>Declare</b> statement in the Global Module or the General Declarations section of a Visual Basic® program:</p>
<pre><code>Declare Function GetTempDrive Lib "Kernel" (ByVal cDriveLetter As Integer)
 &nbsp; As Integer
</code></pre>
<p>
Note that this <b>Declare</b> statement must be typed as a single line of text.</p>
<p>
The <b>GetTempDrive</b> function does not require any arguments—you simply call it. After you do so, it will return an integer value that represents the disk drive you can use to store temporary files. However, you will need to convert the drive number to an ASCII drive letter.</p>
<p>
To convert the drive number to a drive letter, execute the following code:</p>
<pre><code>DriveLetter = Chr$(Drive And &amp;HFF)
</code></pre>
<p>
As stated earlier, the <b>GetTempDrive</b> function retrieves the drive that can be used to store temporary files while your application is executing. <b>GetTempDrive</b> will return the drive number of the first hard disk it finds, which is usually the C: drive. However, this is not necessarily the same disk drive that is returned by retrieving the TEMP environment variable.</p>
<p>
The TEMP environment variable tells you the drive and/or directory that can be used to store temporary files as well. You retrieve the TEMP environment variable in a Visual Basic application by issuing the statement:</p>
<pre><code>X$ = Environ$("TEMP")
</code></pre>
<p>
Environ$ will retrieve the full path as stored in the DOS environment's TEMP variable. If you are creating a temporary file, you will need to append the filename to this variable's string (that is, X$ = X$ + FileName$).</p>
<h2>Example Program</h2>
<p>
The following program will retrieve the drive letter from the computer system.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
In the general declarations section of Form1, enter the following three statements (note that the <b>Declare</b> statement must be typed as a single line of text):<pre><code>Dim Drive As Integer
Dim DriveLetter As String
Declare Function GetTempDrive Lib "Kernel" (ByVal cDriveLetter As Integer)
 &nbsp;&nbsp; As Integer
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Sub Form_Load()
 &nbsp;&nbsp; Drive = GetTempDrive(0)
 &nbsp;&nbsp; DriveLetter = Chr$(Drive And &amp;HFF)
 &nbsp;&nbsp; Text1.Text = DriveLetter
End Sub
</code></pre>
</li>
<li>
Add a Text Box control to Form1. Text1 is created by default.</li>
</ol>
</BODY>
</HTML>
