<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 99: Adding Three-Dimensional Effects to Visual Basic Forms</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn99"></a></sup>Tip 99: Adding Three-Dimensional Effects to Visual Basic Forms</h1>
<p>
May 29, 1995</p>
<h2>Abstract</h2>
<p>
You can use functions in the CTL3D.DLL dynamic-link library to add a three-dimensional (3-D) look to any form. This article explains how to use this .DLL to create a 3-D form in a Visual Basic® application.</p>
<h2>Creating 3-D Forms</h2>
<p>
The CTL3D.DLL dynamic-link library contains Windows® application programming interface (API) functions you can use to create three-dimensional (3-D) message boxes and common dialog boxes in your Visual Basic® applications. You can also use these functions to create a 3-D form. The form must have a fixed-double-style border. In addition, the form's <b>MinButton</b> and <b>MaxButton</b> properties must be set to False.</p>
<p>
As the example program below shows, the CTL3D.DLL functions can enable your Visual Basic application to display 3-D forms, message boxes, and common dialog boxes.</p>
<h2>Example Program</h2>
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
Form2.Show
End Sub
</code></pre>
</li>
<li>
From the Insert menu, select Form to create a second form. Form2 is created by default. Set the form's <b>BorderStyle</b> property to 3-Fixed Double, the <b>MinButton</b> property to False, and the <b>MaxButton</b> property to False.<br><br></li>
<li>
Add the following code to the Form_Load event for Form2:<pre><code>Private Sub Form_Load()
Call Ctl3DForm(Me)
End Sub
</code></pre>
</li>
<li>
From the Insert menu, select Module to create a new module. Module1.Bas is created by default.<br><br></li>
<li>
Add the following code to Module1.Bas (note that the Private lines must each be typed as a single line of code):<pre><code>Const SWW_HPARENT = -8
Const GWW_HINSTANCE = -6
Const GWW_HPARENT = -8
Const BUTTON_FACE = &amp;H8000000F
Const FIXED_DOUBLE = 3
Const DS_MODALFRAME = &amp;H80&amp;
Const GWL_STYLE = (-16)
Private Declare Function Ctl3DSubClassDlgEx Lib "CTL3D.DLL" (ByVal hWnd As 
 &nbsp; Integer, ByVal Flags As Long) As Integer
Private Declare Function GetWindowLong Lib "User" (ByVal hWnd As Integer, ByVal 
 &nbsp; nIndex As Integer) As Long
Private Declare Function SetWindowLong Lib "User" (ByVal hWnd As Integer, ByVal 
 &nbsp; nIndex As Integer, ByVal dwNewLong As Long) As Long
Sub Ctl3DForm(frm As Form)
 &nbsp;&nbsp; Dim hWnd As Integer
 &nbsp;&nbsp; Dim Result As Integer
 &nbsp;&nbsp; Dim lStyle As Long
 &nbsp;&nbsp; Dim Flag1 As Long
 &nbsp;&nbsp; 
 &nbsp;&nbsp; hWnd = frm.hWnd
 &nbsp;&nbsp; Flag1 = 0
 &nbsp;&nbsp; 
 &nbsp;&nbsp; If frm.BorderStyle = FIXED_DOUBLE Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; frm.BackColor = BUTTON_FACE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lStyle = GetWindowLong(hWnd, GWL_STYLE)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lStyle = lStyle Or DS_MODALFRAME
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lStyle = SetWindowLong(hWnd, GWL_STYLE, lStyle)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Result = Ctl3DSubClassDlgEx(hWnd, Flag1)
 &nbsp;&nbsp; End If
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing the F5 function key. Click the <b>Command Button</b> to display Form2. Form2 is modified so that it has a three-dimensional look.</p>
<h2>Additional References</h2>
<p>
Knowledge Base Q113898. "How to Use CTL3D.DLL in Your Visual Basic Program."</p>
<p>
"Seventeen Techniques for Preparing Your 16-Bit Applications for Chicago." (MSDN Library Archive, Books and Periodicals, Microsoft Systems Journal, 1994 Volume 9, February 1994 Number 2)</p>
<p>
"Windows Questions and Answers." (MSDN Library Archive, Books and Periodicals, Microsoft Systems Journal, 1994 Volume 9, August 1994, Number 8)</p>
</BODY>
</HTML>
