<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 44: Modifying File Attributes</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn44"></a></sup>Tip 44: Modifying File Attributes</h1>
<p>
Created: April 2, 1995</p>
<h2>Abstract</h2>
<p>
Every time a new file is created, the operating system gives the file one or more special attribute settings. In your Visual Basic® program, you can use the <b>GetAttr</b> and <b>SetAttr</b> functions to modify a file's attribute settings.</p>
<h2>What Are File Attributes?</h2>
<p>
A file, whether it is an executable program file, a data file, or other type, is stored to disk with one or more file attributes. The following table lists the seven possible attributes that can be given to a file.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=16%><b>Attribute</b></td>
<td class=label width=11%><b>Value</b></td>
<td class=label width=73%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=16%>Normal</td>
<td width=11%>0</td>
<td width=73%>Data can be read from or written to the file.</td>
</tr>
<tr valign=top>
<td width=16%>Read Only</td>
<td width=11%>1</td>
<td width=73%>Data can be read from but not written to the file.</td>
</tr>
<tr valign=top>
<td width=16%>Hidden</td>
<td width=11%>2</td>
<td width=73%>The file cannot be seen in the directory list.</td>
</tr>
<tr valign=top>
<td width=16%>System</td>
<td width=11%>4</td>
<td width=73%>The file is a system file that is used only by MS-DOS® or Windows®.</td>
</tr>
<tr valign=top>
<td width=16%>Volume Label</td>
<td width=11%>8</td>
<td width=73%>The file is the special name given to the disk. Only one volume label can be given to a disk as its unique identifier.</td>
</tr>
<tr valign=top>
<td width=16%>Directory</td>
<td width=11%>16</td>
<td width=73%>The file is a subdirectory.</td>
</tr>
<tr valign=top>
<td width=16%>Archive</td>
<td width=11%>32</td>
<td width=73%>The file has been modified since backup was last performed.</td>
</tr>
</table><br>
<p>
You can determine which attributes a file has been given by using the Visual Basic® <b>GetAttr</b> function. The syntax for this function is:</p>
<p>
GetAttr(<b>filename</b>)</p>
<p>
When this function is executed, it returns an integer value that tells you which attribute has been given to the file. A file that is read-only, for example, will return a value of 1. Because a file may have more than one attribute associated with it, you can use the And operator to perform a bit-wise comparison.</p>
<h2>Changing File Attributes</h2>
<p>
Visual Basic also provides the <b>SetAttr</b> function, which allows you to change a file's attribute setting. The syntax for this function is:</p>
<p>
SetAttr(<b>filename</b>),(<b>attribute</b>)</p>
<p>
When changing a file's attributes, you must keep in mind that a file can have more than one attribute set at any given time. You must use the And operator to change only the desired bit in the attribute flag. The following table tells you the mask values you can use to change only the individual bit you are interested in.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Attribute</b></td>
<td class=label width=50%><b>Mask Value</b></td>
</tr>
<tr valign=top>
<td width=50%>Archive</td>
<td width=50%>31</td>
</tr>
<tr valign=top>
<td width=50%>System</td>
<td width=50%>59</td>
</tr>
<tr valign=top>
<td width=50%>Hidden</td>
<td width=50%>61</td>
</tr>
<tr valign=top>
<td width=50%>Read Only</td>
<td width=50%>62</td>
</tr>
</table><br>
<p>
You can also remove all the attributes of a file by calling <b>SetAttr</b> with a value of zero as the Attribute value.</p>
<h2>Example Program</h2>
<p>
The following program shows how you can use the <b>GetAttr</b> and <b>SetAttr</b> functions in a Visual Basic application. Execute this program by pressing the F5 function key. Click the "Test Archive Bit" command button. The program will respond by testing the AUTOEXEC.BAT file's attribute flag to see if its Archive bit is set. If the Archive bit is set, the program responds with the message, "File has archive bit set." Click the "Set Archive Off" command button. This resets the file's Archive bit to zero; the resulting message is displayed in the Text Box.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a Command Button control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Test Archive Bit".<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Sub Command1_Click()
  FileName = "c:\autoexec.bat"
  X = GetAttr(FileName)
  If X = 32 Then
 &nbsp;&nbsp;&nbsp;&nbsp; Text1.Text = "File has Archive bit set."
  Else
 &nbsp;&nbsp;&nbsp;&nbsp; Text1.Text = "File does not have Archive bit set."
  End If
End Sub
</code></pre>
</li>
<li>
Add a second Command Button control to Form1. Command2 is created by default. Set its <b>Caption</b> property to "Set Archive Off".<br><br></li>
<li>
Add the following code to the Click event for Command2:<pre><code>Sub Command2_Click()
  FileName = "c:\autoexec.bat"
  SetAttr FileName, GetAttr(FileName) And 31
  Text1.Text = "Archive attribute set to Off."
End Sub
</code></pre>
</li>
<li>
Add a Text Box control to Form1. Text1 is created by default.</li>
</ol>
</BODY>
</HTML>
