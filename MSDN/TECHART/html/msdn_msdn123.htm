<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 123: Displaying Records from a Microsoft Access Database in an Outline Control</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn123"></a></sup>Tip 123: Displaying Records from a Microsoft Access Database in an Outline Control</h1>
<p>
July 1, 1995</p>
<h2>Abstract</h2>
<p>
The <b>Outline</b> control in Microsoft® Visual Basic® lets you create a hierarchical list of items. This article explains how to populate the <b>Outline</b> control with information stored in a Microsoft Access database file.</p>
<h2>Extracting Fields from an Access Database</h2>
<p>
From within a Microsoft® Visual Basic® application, you can retrieve individual fields from a Microsoft Access database and display these fields in an <b>Outline</b> control.</p>
<p>
The <b>OpenDatabase</b> function loads the specified database into Microsoft Access. After the file has been opened, you need to create a Snapshot variable for a specific table within the database. To do this, you use the <b>CreateSnapshot</b> method. The Snapshot allows you to read data from a table but does not allow you to change any data stored in the file.</p>
<p>
After the Snapshot variable has been created, you use a While-Wend loop to process each record in the specified table. The example program below, for instance, retrieves each Title field from the BIBLIO.MDB file and uses the <b>AddItem</b> method of the <b>Outline</b> control to populate that control with the data from the Title field. After processing all the records in the table, you must remember to close both the Snapshot and the Microsoft Access database file.</p>
<h2>Example Program</h2>
<p>
This program shows how to display specific fields from a Microsoft Access database in a Visual Basic <b>Outline</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add an <b>Outline</b> control to Form1. Outline1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim DB As Database
 &nbsp;&nbsp; Dim SN As Snapshot
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; Dim Y As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Set DB = OpenDatabase("C:\VB\BIBLIO.MDB")
 &nbsp;&nbsp; Set SN = DB.CreateSnapshot("select * from titles order by Title")
 
 &nbsp;&nbsp; While Not SN.EOF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Outline1.AddItem SN.Fields("Title")
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SN.MoveNext
 &nbsp;&nbsp; Wend
 &nbsp;&nbsp; SN.Close
 &nbsp;&nbsp; DB.Close
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the command button. The program retrieves the Title field's data from each record in the BIBLIO.MDB file and adds it to the <b>Outline</b> control.</p>
<h2>Additional References</h2>
<p>
"Using Object Variables in Visual Basic for Creating, Maintaining, and Accessing Databases." (MSDN Library Archive, Conferences and Seminars, Tech·Ed, March 1994, Visual Basic)</p>
</BODY>
</HTML>
