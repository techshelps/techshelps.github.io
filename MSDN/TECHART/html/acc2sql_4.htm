<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connecting to SQL Server</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>
<h1>Connecting to SQL Server</h1>
<p>
The first migration steps are to install SQL Server and establish a connection from Microsoft Access. Consult SQL Server Books Online for information about installing the server. You must create a data source on the client computer, the computer running Microsoft Access, to connect to the server. If Microsoft Access and SQL Server are on the same computer, the data source is still required.</p>
<h3>What Is a Data Source?</h3>
<p>
A data source is a method of standardizing database connectivity. Data sources are created with the <b>Open</b> <b>Database</b> <b>Connectivity</b> (ODBC) dialog box accessible from Windows Control Panel. Windows NT and Windows 95 operating systems have a 32-bit version of the ODBC application, while Windows 3.1 and Windows for Workgroups have a 16-bit version. Microsoft Access 95 and 97 can create a new data source from within the application.</p>
<p>
A data source (abbreviated DSN for data source name) can be created as a system data source or a user data source. Should you create a user DSN or a system DSN? A system DSN tends to be more convenient but less secure than a user DSN. Select a user DSN if you have multiple users of the same client computer and you want to hide the existence of the data source from some of the users.</p>
<h3>Creating a System Data Source</h3>
<p>
<b>To create a system data source</b>
<ol>
<li>
On the <b>Start</b> menu, click <b>Settings</b>, then click <b>Control</b> <b>Panel</b>. (In earlier versions of Windows, select <b>Control</b> <b>Panel</b> from the Main program group.) <br><br></li>
<li>
Double-click ODBC to open the driver manager's user interface, the ODBC Data Source Administrator. What you see varies with the version of the Odbc32.dll (or Odbc.dll) that you are using. ODBC 3.0 presents the <b>ODBC Data Source Administrator</b> dialog box.<p class=tl>
ODBC 2.5 presents a dialog box with much of the same information, but without tabs and without the option of creating a System DSN. If you are presented with that dialog box you may want to switch to the ODBC files on the SQL Server CD (Odbc32.dll and Sqlsrv32.dll for 32-bit operating systems or Odbc.dll, Sqlsrvr.dll for 16-bit operating systems.)</P></li>
<li>
Click the <b>System</b> <b>DSN</b> tab.<br><br></li>
<li>
Click<b> Add</b>.<br><br></li>
<li>
From the installed ODBC drivers list, select <b>SQL</b> <b>Server</b> and click <b>OK</b> to bring up the <b>ODBC</b> <b>SQL</b> <b>Server</b> <b>Setup</b> dialog box.<br><br></li>
<li>
Give your data source a name, such as Payroll. This can be either the name of the server to which you are connecting, or the name of the database to which you are connecting or some other name that is meaningful to you, such as the purpose of the connection. You are likely to accumulate several data sources, so the name should be descriptive.<br><br></li>
<li>
The Description field is optional.<br><br></li>
<li>
Enter the name of the SQL Server in the <b>Server</b> box. The SQL Server should have the same name as the Windows NT-based computer on which it is running. <p class=tl>
If Windows NT was reinstalled with a new computer name after SQL Server was installed, they can be different and then you may experience connection problems. See <b>sp_rename</b> in SQL Server Books Online if you suspect this.</P></li>
<li>
Click the <b>Options</b> button and provide the name of the database on SQL Server to which you want to connect. Remember that several databases with different names can exist on one SQL Server.<br><br></li>
<li>
At the bottom of this dialog box is a check box called <b>Convert OEM to ANSI Characters</b>. IMPORTANT: THIS BOX SHOULD NOT BE CHECKED. <br><br></li>
<li>
Click <b>OK</b> to return to the <b>ODBC</b> <b>Data</b> <b>Source</b> <b>Administrator</b> dialog box, and click <b>OK</b> again.</li>
</ol>
<h3>DSN-less Connections</h3>
<p>
Users can easily make their connections with data sources. Moderately skilled users can create and maintain their own DSNs. However, there is also room for user error. Many programmers decide to make programmatic DSN-less connections. This can be more reliable because it does not require maintenance on the client computer, but it cannot be updated without rolling out a new version of the client program.</p>
<p>
<b>To make</b> <b>a connection without a DSN</b>
<ol>
<li>
Create a new SQL Pass-through query in Microsoft Access.<br><br></li>
<li>
On the <b>View</b> menu,<b> </b>click<b> Properties</b>.<br><br></li>
<li>
In the <b>ODBC</b> <b>Connect</b> <b>Str</b>. field of the <b>Query</b> <b>Properties</b> box, enter a connection string like the one below. The <i>italic</i> text must be replaced with your information. Enter the string on one line:<pre><code>ODBC;driver={SQL Server};server=<i>YourServerName</i>;database=
<i>YourDatabaseName</i>;uid=<i>UserName</i>;pwd=<i>Password</i>;dsn=;
</code></pre>
<p class=tl>
This example uses a server named Acctg1, a database named Purchases, and the sa account with no password:</P><pre><code>ODBC;driver={SQL Server};server=Acctg1;database=
Purchases;uid=sa;pwd=;dsn=;
</code></pre>
</li>
</ol>
<p>
For more information about making DSN-Less connections with VBA code, see the Visual Basic Knowledge Base Article Q147875, "How To Use 'DSN-Less' ODBC Connections with RDO and DAO."</p>
</BODY>
</HTML>
