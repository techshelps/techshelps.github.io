<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 145: Inserting Tab Characters in the Rich-Text Box Control</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn145"></a></sup>Tip 145: Inserting Tab Characters in the Rich-Text Box Control</h1>
<p>
August 31, 1995</p>
<h2>Abstract</h2>
<p>
The <b>Rich-Text Box</b> control allows you to create rich-text format (RTF) documents from within your Microsoft® Visual Basic® application. However, when you want to insert a tab character in the <b>Rich-Text Box</b> control, the focus is instead moved to the next control in the tab order specified by the <b>TabIndex</b> property. This article explains how you can insert the tab character into the <b>Rich-Text Box</b> control itself.</p>
<h2>Setting a Control's Tab Order</h2>
<p>
At run time, a Microsoft® Visual Basic® user must press CTRL+TAB to insert a tab character in a <b>Rich-Text Box</b> control. However, most people are accustomed to pressing the TAB key. Whenever the TAB key is pressed from within a <b>Rich-Text Box</b> control, the focus is immediately set to the next control on the form. The <b>TabIndex</b> property of a control determines which control then receives the focus. This is not the effect you want.</p>
<p>
When designing a form in Visual Basic, you can add controls such as <b>Command Buttons</b> and <b>Text Boxes</b> to perform functions within your application. Each time you add a new control to a form, Visual Basic assigns a new value to that control. This value is saved in the control's <b>TabIndex</b> property. At run time, a user can press the TAB key to move the focus from one control to another. The focus is moved to the control that has the next highest <b>TabIndex</b> value.</p>
<p>
You can change the value of a control's <b>TabIndex</b> property either during design time or at run time. However, the control must have a <b>TabStop</b> property associated with it. The <b>TabStop</b> property determines whether a user can press the TAB key to set the focus to that specific control.</p>
<p>
In the example program below, the <b>TabStop</b> property of all controls on the form is set to False. This prevents the user from setting the focus to another control by using the TAB key—even though the <b>Rich-Text Box</b> control has the focus. In this way, the <b>Tab</b> control character is correctly inserted into the text of the <b>Rich-Text Box</b> control.</p>
<h2>Example Program</h2>
<p>
This program shows how to insert a tab control character in the <b>Rich-Text Box</b> control in Visual Basic version 4.0.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Rich-Text Box</b> control to Form1. RichTextBox1 is created by default.<br><br></li>
<li>
Add the following code to the GotFocus event for RichTextBox1.<pre><code>Private Sub RichTextBox1_GotFocus()
 &nbsp;&nbsp; On Error Resume Next
 &nbsp;&nbsp; For Each Control In Controls
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Control.TabStop = False
 &nbsp;&nbsp; Next Control
End Sub
</code></pre>
</li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.</li>
</ol>
<p>
Run the example program by pressing F5. Note that the focus is set to the <b>Rich-Text Box</b> control. Type some text into this control. You can press the TAB key to insert that control character into the text you are typing whenever necessary. You should also note that pressing tab does not move the focus to the <b>Command Button</b> control—you must click the <b>Command Button</b> itself to move the focus to it. In other words, while the focus is set to the <b>Rich-Text Box</b> control, you can press the tab key and that character is inserted into the <b>Rich-Text Box</b> control.</p>
</BODY>
</HTML>
