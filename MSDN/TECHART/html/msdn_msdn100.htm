<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 100: Printing a Form Multiple Times on One Page</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn100"></a></sup>Tip 100: Printing a Form Multiple Times on One Page</h1>
<p>
May 29, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how you can print a Visual Basic® form several times on a single piece of paper.</p>
<h2>Printing Forms on the Printer Device</h2>
<p>
You can use the Windows® application programming interface (API) <b>StretchBlt</b> function to copy a form to another form multiple times. For instance, the example program below uses the <b>StretchBlt</b> function to copy a form to a new form. The original form is copied four times. The destination form then contains a copy of the original form in its upper left, lower left, upper right, and lower right corners.</p>
<p>
The technique presented in this article is useful for duplicating a form several times. For example, if you designed a form to keep track of telephone messages, you could print four messages per printed page, instead of using one piece of paper per telephone message.</p>
<p>
The <b>StretchBlt</b> function can be used to copy an image from one device context to another. To use this function in your Visual Basic® application, include the following <b>Declare</b> statement in the General Declarations section of your form (note that it must be typed as a single line of code):</p>
<pre><code>Private Declare Function StretchBlt Lib "GDI" (ByVal hDC%, ByVal X%, ByVal y%, 
 &nbsp; ByVal nWidth%, ByVal nHeight%, ByVal hSrcDC%, ByVal XSrc%, ByVal YSrc%, ByVal 
 &nbsp; nSrcWidth%, ByVal nSrcHeight%, ByVal dwRop&amp;) As Integer
</code></pre>
<p>
The <b>StretchBlt</b> function requires the following arguments:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=14%><i>hDC</i></td>
<td width=86%>An integer value containing the destination device context.</td>
</tr>
<tr valign=top>
<td width=14%><i>X,Y</i></td>
<td width=86%>Integer values defining the rectangle's upper left corner for the destination device context.</td>
</tr>
<tr valign=top>
<td width=14%><i>nWidth</i></td>
<td width=86%>The width of the image.</td>
</tr>
<tr valign=top>
<td width=14%><i>nHeight</i></td>
<td width=86%>The height of the image.</td>
</tr>
<tr valign=top>
<td width=14%><i>hSrcDC</i></td>
<td width=86%>An integer value containing the source device context.</td>
</tr>
<tr valign=top>
<td width=14%><i>Xsrc, YSrc</i></td>
<td width=86%>Integer values defining the rectangle's upper left corner for the source device context.</td>
</tr>
<tr valign=top>
<td width=14%><i>nSrcWidth</i></td>
<td width=86%>The width of the image.</td>
</tr>
<tr valign=top>
<td width=14%><i>nSrcHeight</i></td>
<td width=86%>The height of the image.</td>
</tr>
<tr valign=top>
<td width=14%><i>dwRop</i></td>
<td width=86%>The raster operation that is to be used.</td>
</tr>
</table><br>
<p>
In the example program below, the <b>StretchBlt</b> function is called four times to copy the original Form1 to the destination Form2. Each time the copy operation is performed, the destination is offset to the next quarter section of Form2.</p>
<h2>Example Program</h2>
<p>
Before running this program, make sure your printer is online and ready to accept data. Press the F5 function key to run the example program, which will print Form2 on the paper four times.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1 (note that the <b>X =</b> lines must each be typed as a single line of code):<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim W As Integer
 &nbsp;&nbsp; Dim H As Integer
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; W = Form2.ScaleWidth / 2
 &nbsp;&nbsp; H = Form2.ScaleHeight / 2
 &nbsp;&nbsp; X = SetStretchBltMode(Form2.hDC, 3)
 &nbsp;&nbsp; X = StretchBlt(Form2.hDC, 0, 0, W, H, Form1.hDC, 0, 0, Form1.ScaleWidth, 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Form1.ScaleHeight, SRCCOPY)
 &nbsp;&nbsp; X = StretchBlt(Form2.hDC, W, 0, W, H, Form1.hDC, 0, 0, Form1.ScaleWidth, 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Form1.ScaleHeight, SRCCOPY)
 &nbsp;&nbsp; X = StretchBlt(Form2.hDC, W, H, W, H, Form1.hDC, 0, 0, Form1.ScaleWidth, 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Form1.ScaleHeight, SRCCOPY)
 &nbsp;&nbsp; X = StretchBlt(Form2.hDC, 0, H, W, H, Form1.hDC, 0, 0, Form1.ScaleWidth, 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Form1.ScaleHeight, SRCCOPY)
 &nbsp;&nbsp; Form2.Refresh
 &nbsp;&nbsp; Form2.PrintForm
End Sub
</code></pre>
</li>
<li>
From Visual Basic's menu, select Insert. Select Form to create a new form. Form2 is created by default. Add a <b>Text Box</b> control to Form2 or otherwise put some type of material on the form so you can see it printed on the paper.<br><br></li>
<li>
Add the following code to the General Declarations section of Form1 (note that each <b>Declare</b> statement should be typed as a single line of code):<pre><code>Private Declare Function SetStretchBltMode Lib "GDI" (ByVal hDC%, ByVal 
 &nbsp; nStretchMode%) As Integer
Private Declare Function StretchBlt Lib "GDI" (ByVal hDC%, ByVal X%, ByVal y%, 
 &nbsp; ByVal nWidth%, ByVal nHeight%, ByVal hSrcDC%, ByVal XSrc%, ByVal YSrc%, ByVal 
 &nbsp; nSrcWidth%, ByVal nSrcHeight%, ByVal dwRop&amp;) As Integer
Const SRCCOPY = &amp;HCC0020
</code></pre>
</li>
</ol>
<h2>Additional References</h2>
<p>
"Creating Bitmaps of Any Size with StretchBlt." <i>Inside Visual Basic</i>. (MSDN Library, Periodicals)</p>
<p>
Knowledge Base Q84066. "How to Print Entire VB Form and Control the Printed Size."</p>
<p>
Knowledge Base Q77060. "How to Print a VB Picture Control Using Windows API Functions."</p>
</BODY>
</HTML>
