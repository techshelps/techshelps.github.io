<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 144: Using Accelerator Keys with the TabStrip Control</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn144"></a></sup>Tip 144: Using Accelerator Keys with the TabStrip Control</h1>
<p>
August 31, 1995</p>
<h2>Abstract</h2>
<p>
The <b>TabStrip</b> control in Microsoft® Visual Basic® does not provide built-in support for using accelerator keys. This article explains how you can add this functionality to your Visual Basic application.</p>
<h2>Adding Accelerator Key Support to the TabStrip Control</h2>
<p>
The <b>TabStrip</b> control in Microsoft® Visual Basic® version 4.0 allows you to present information to your user in an organized manner. The <b>TabStrip</b> control allows you to present, or query the user for, information relating to a single concept. For example, if your user must choose certain ptions to customize his or her Visual Basic program, you could present these options by using one tab of a <b>TabStrip</b> control. Then, on another tab, you could ask the user for his or her name, company, and so on. </p>
<p>
The user can select a tab either by pressing the TAB key to move the focus to the next tab or by clicking the desired tab. Although there is no direct support provided when using the <b>TabStrip</b> control, you can add accelerator keys to the <b>TabStrip</b> control. This will allow your user to switch the focus between tabs by pressing and holding down the ALT key and then pressing another key.</p>
<p>
In the demonstration program below, the <b>TabStrip</b> control displays three tabs: Control, Settings, and Parameters. Notice that an ampersand ("&amp;") has been used in the tabs' <b>Caption</b> property. At run time, the character immediately following the ampersand will be underlined. In the example program, the Control tab will be shown with the letter "C" underlined. Under the Microsoft Windows® operating system, the underlined character tells users that they can press the underlined character while holding down the ALT key to invoke that option. In this case, the user would press and hold down ALT and then press C to move the focus to the Control tab.</p>
<p>
You can add this functionality to your Visual Basic program by trapping each key that is pressed on the keyboard. This is done by first determining the ASCII keycode value of the key that was just pressed. If this key is one of the keys you want to trap (<small>c</small>, S, or <small>p</small> in our example program below), set the <b>Selected</b> property of that tab to True. This moves the focus to that individual tab. On the other hand, if the ALT key was not held down or if the key is not one of the accelerator keys, no action is performed.</p>
<h2>Example Program</h2>
<p>
This program shows how to add support for accelerator keys to the Visual Basic <b>TabStrip</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default. Set its <b>KeyPreview</b> property to True.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1.<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; TabStrip1.Tabs(1).Caption = "&amp;Control"
 &nbsp;&nbsp; TabStrip1.Tabs.Add 2, , "&amp;Settings"
 &nbsp;&nbsp; TabStrip1.Tabs.Add 3, , "&amp;Parameters"
End Sub
</code></pre>
</li>
<li>
Add the following code to the KeyDown event for Form1.<pre><code>Private Sub Form_KeyDown(keycode As Integer, shift As Integer)
 &nbsp;&nbsp; AccessKey$ = "CSP"
 &nbsp;&nbsp; Code% = InStr(AccessKey$, Chr$(keycode))
 &nbsp;&nbsp; If shift = vbAltMask And Code% Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TabStrip1.Tabs(Code%).Selected = True
 &nbsp;&nbsp; End If
End Sub
</code></pre>
</li>
<li>
Add a <b>TabStrip</b> control to Form1. TabStrip1 is created by default.</li>
</ol>
<p>
Run the example program by pressing F5. The <b>TabStrip</b> control is displayed with three tabs set—one for Control, one for Settings, and one for Parameters. You can move the focus from one tab to another by pressing and holding down the ALT key and then pressing the appropriate accelerator key (the underlined character) for the new tab.</p>
</BODY>
</HTML>
