<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 17: Hiding the Cursor (Mouse Pointer)</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn17"></a></sup>Tip 17: Hiding the Cursor (Mouse Pointer)</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
The mouse pointer, or mouse cursor, as it is often called, can be temporarily toggled on or off within a Visual Basic® application. You might want to make the cursor invisible while your program displays a maximized form that contains a graphic picture. Then, after displaying the graphic, you can make the cursor visible again. The Windows® application programming interface (API) <b>ShowCursor </b>function lets a Visual Basic program hide the cursor from view.</p>
<h2>Hiding the Cursor</h2>
<p>
To hide the cursor in your Visual Basic® applications, call the <b>ShowCursor</b> function. To declare this Windows® application programming interface (API) function within your program, include the following <b>Declare</b> statement in the Global Module or the General Declarations section of a Visual Basic form:</p>
<pre><code>Declare Function ShowCursor Lib "User" (ByVal bShow As Integer) As Integer
</code></pre>
<p>
Note that this <b>Declare</b> statement must be typed as a single line of text.</p>
<p>
The <b>ShowCursor</b> function requires only one argument. When <i>bShow</i> is set to TRUE, the cursor is displayed; when <i>bShow</i> is set to FALSE, the cursor is hidden.</p>
<p>
You cannot simply call the <b>ShowCursor</b> function to hide the cursor. You also need to be aware that the cursor's visibility depends on the value of an internal display count that Windows maintains. This count value is incremented by a value of one each time <b>ShowCursor</b> is called with <b>bShow</b> set to TRUE. Conversely, each time <b>ShowCursor</b> is called with <b>bShow</b> set to FALSE, the count value is decremented. When the count value is greater than or equal to zero, the cursor is displayed.</p>
<h2>Example Program</h2>
<p>
The following program demonstrates how to make the cursor invisible and how to make it reappear in a Visual Basic application program.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
In the global declarations section of Form1, enter the following Windows API function declaration (note that this <b>Declare</b> statement must be typed as a single line of text):<pre><code>Declare Function ShowCursor Lib "User" (ByVal bShow As Integer) As Integer
</code></pre>
</li>
<li>
In addition, add the following two <b>Dim</b> statements to the general declarations section of Form1:<pre><code>Dim QuitFlag As Integer
Dim MCount As Integer
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Sub Form_Load()
 &nbsp;&nbsp; MCount = ShowCursor(False) + 1
 &nbsp;&nbsp; 'hide mousepointer
 &nbsp;&nbsp; Do While ShowCursor(False) &gt;= -1
 &nbsp;&nbsp; Loop
 &nbsp;&nbsp; Do While ShowCursor(True) &lt;= -1
 &nbsp;&nbsp; Loop
 &nbsp;&nbsp; Form1.Show
 &nbsp;&nbsp; Text1.Text = "Invisible"&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp; x% = ShowCursor(False)&nbsp;&nbsp; 
 &nbsp;&nbsp; Do
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DoEvents
 &nbsp;&nbsp; Loop Until QuitFlag = True
End Sub
</code></pre>
</li>
<li>
Add the following code to the Form_Unload event for Form1:<pre><code>Sub Form_Unload(Cancel As Integer)
 &nbsp;&nbsp; Do While ShowCursor(False) &gt;= Mcount
 &nbsp;&nbsp; Loop
 &nbsp;&nbsp; Do While ShowCursor(True) &lt;= Mcount
 &nbsp;&nbsp; Loop
 &nbsp;&nbsp; Unload Form1
End Sub
</code></pre>
</li>
<li>
Add the following code to the Click event for Form1:<pre><code>Sub Form_Click()
 &nbsp;&nbsp; Text1.Text = "Visible"
 &nbsp;&nbsp; x% = ShowCursor(True)
 &nbsp;&nbsp; QuitFlag = True
End Sub
</code></pre>
</li>
<li>
Add a Text Box control to Form1. Text1 is created by default. Set its <b>Text</b> property to a NULL (empty) string.</li>
</ol>
<p>
After executing this demonstration program, Visual Basic will display the string "Invisible" in the Text Box. The cursor is made invisible. The program loops continuously until you click the mouse to terminate the program. After clicking the mouse over Form1, the cursor will again be visible.</p>
</BODY>
</HTML>
