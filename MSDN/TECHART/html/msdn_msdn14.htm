<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 14: Copying Selected Items in a List Box to the Clipboard</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn14"></a></sup>Tip 14: Copying Selected Items in a List Box to the Clipboard</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
One of the nice features provided under Windows® 3.1 is its Clipboard. Data (text or graphics) can be copied from an application program to the Clipboard. This data can then be transferred from the Clipboard to a different application, to be processed in some way.</p>
<p>
This article shows how you can copy selected items from a List Box control to the Clipboard. The Clipboard.GetText command copies information from the Clipboard to an object, such as a Text Box. Conversely, the Clipboard.SetText command copies information from an object to the Clipboard.</p>
<h2>Example Program</h2>
<p>
The following Visual Basic® application copies selected items from a List Box control to the Clipboard.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the FormLoad event for Form1:<pre><code>Sub Form_Load()
 &nbsp;&nbsp; List1.AddItem "Vancouver, B.C."
 &nbsp;&nbsp; List1.AddItem "Surrey, B.C."
 &nbsp;&nbsp; List1.AddItem "White Rock, B.C."
 &nbsp;&nbsp; List1.AddItem "Richmond, B.C."
End Sub
</code></pre>
</li>
<li>
Add a List Box control to Form1. List1 is created by default. Set its <b>MultiSelect</b> property to 1-Simple.<br><br></li>
<li>
Draw a Text Box control under the List Box control. Text1 is created by default. Set its <b>MultiLine</b> property to True and its <b>ScrollBars</b> property to 2-Vertical.<br><br></li>
<li>
Add a Command Button control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Copy to Clipboard".<br><br></li>
<li>
Type the following code in the Click event for Command1:<pre><code>Sub Command1_Click()
 &nbsp;&nbsp; Dim CopytoClip As String
 &nbsp;&nbsp; Dim I As Integer
 &nbsp;&nbsp; Clipboard.Clear
 &nbsp;&nbsp; CopytoClip = ""
 &nbsp;&nbsp; For I = 0 To List1.ListCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If List1.Selected(I) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CopytoClip = CopytoClip &amp; Form1.List1.List(I) &amp; Chr$(13) &amp; Chr$(10)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp; Next I
 &nbsp;&nbsp; Clipboard.SetText CopytoClip
End Sub
</code></pre>
</li>
<li>
Add a Command Button control to Form1. Command2 is created by default. Set its <b>Caption</b> property to "Show Clipboard".<br><br></li>
<li>
Type the following code in the Click event for Command2:<pre><code>Sub Command2_Click()
 &nbsp;&nbsp; 'display data stored in clipboard
 &nbsp;&nbsp; Text1.Text = ""
 &nbsp;&nbsp; Text1.Text = Clipboard.GetText(CF_TEXT)
End Sub
</code></pre>
</li>
<li>
Add a Command Button control to Form1. Command3 is created by default. Set its <b>Caption</b> property to "Exit".<br><br></li>
<li>
Type the following code in the Click event for Command3:<pre><code>Sub Command3_Click()
 &nbsp;&nbsp; End
End Sub
</code></pre>
</li>
<li>
Add the following statement to the General Declarations section of Form1:<pre><code>Const CF_TEXT = 1
</code></pre>
</li>
</ol>
<p>
After you execute this demonstration program, the List Box will contain the names of the four cities. Click one or more of these names to select them. Then, click the "Copy to Clipboard" command button. To verify that only the selected items were actually copied to the Clipboard, click the "Show Clipboard" command button. You can experiment with the program several times to verify that it works correctly. To terminate the application, click the Exit command button.</p>
</BODY>
</HTML>
