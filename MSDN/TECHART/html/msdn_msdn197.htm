<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 197: Preventing a Right-Click from Displaying a Context Menu</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn197"></a></sup>Tip 197: Preventing a Right-Click from Displaying a Context Menu</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to prevent the context menu from appearing when the user of your Microsoft® Visual Basic® application uses the right mouse button to click a <b>Text Box</b> control.</p>
<h2>Using Message Blaster to Ignore Right-Clicks</h2>
<p>
A unique feature provided in the Microsoft® Windows® 95 operating system is its ability to display a context menu for specific controls when you click with the right mouse button (right-click) over a control. When developing a Microsoft Visual Basic® application, however, you may not want this context menu to appear.</p>
<p>
Each time you right-click, the system receives a WM_RBUTTONDOWN message. Using a third-party custom control such as <b>Message Blaster</b>, you can tell the operating system to ignore this WM_RBUTTONDOWN message.</p>
<p>
In the example program below, you want to ignore all right-clicks for the <b>Text Box</b> control. To accomplish this, you supply <b>Message Blaster</b> with the handle of the <b>Text Box</b> control and the message you want to trap.</p>
<p>
If a right-click is detected while the program is running, the <b>Message Blaster</b> custom control fools the operating system into believing that no such action was received. <b>Message Blaster</b> is used to send an EATMESSAGE message to the operating system. This, in effect, prevents the context menu from appearing.</p>
<h2>Example Program</h2>
<p>
This program shows how to prevent the context menu from appearing when you right-click on a <b>Text Box</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the General Declarations section of Form1:<pre><code>Const EATMESSAGE = 0
Const WM_RBUTTONDOWN = &amp;H204
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; MsgBlaster1.hWndTarget = Text1.hWnd
 &nbsp;&nbsp; MsgBlaster1.AddMessage WM_RBUTTONDOWN, POSTPROCESS
End Sub
</code></pre>
</li>
<li>
Add a <b>Text Box</b> control to Form1. Text1 is created by default.<br><br></li>
<li>
Add a <b>Message Blaster</b> custom control to Form1. MsgBlaster1 is created by default.<br><br></li>
<li>
Add the following code to the MsgBlaster1_Message event:<pre><code>Private Sub MsgBlaster1_Message(ByVal hWnd As Long, ByVal Msg As Long, 
 &nbsp; wParam As Long, lParam As Long, nPassage As Integer, lReturnValue As Long)
 &nbsp;&nbsp; Select Case Msg

 &nbsp;&nbsp; Case WM_RBUTTONDOWN
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'MsgBox "right mouse was clicked on text box"
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nPassage = EATMESSAGE

 &nbsp;&nbsp; End Select
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing f5. While typing text in the <b>Text Box</b> control, click the right mouse button. The context menu does not appear on the screen.</p>
</BODY>
</HTML>
