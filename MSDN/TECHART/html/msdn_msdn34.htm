<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 34: Displaying Characters in Different Colors</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn34"></a></sup>Tip 34: Displaying Characters in Different Colors</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
In a Visual Basic® application, you have several methods available to display printed text to your user. For example, you can use the <b>Text</b> property of a Text Box. However, the text you display in the Text Box is limited to a specific color. This article shows how text can be displayed with any number of color combinations.</p>
<h2>Displaying Text in Color</h2>
<p>
Each time a form's size is changed, or a window has covered a form, the Paint event is triggered. The Paint event is used to redraw the contents of a form or Picture Box whenever the contents of that control have been changed.</p>
<p>
Therefore, by using the <b>Line</b> method to draw text on a form, which in turn causes a Paint event to be triggered, you can display text in whatever color you desire.</p>
<p>
The <b>Line</b> method is used to draw lines, boxes, and filled boxes on the printer, the Picture Box, and the form controls. To draw a line, you specify the starting position, the ending position, and an optional color to be used. The CurrentX and CurrentY properties can be used to set or retrieve the current print position within the control where printing takes place.</p>
<p>
When drawing text to a control, you must first calculate the space required to draw the character. You do this using the <b>TextWidth</b> and <b>TextHeight</b> methods. Once you have drawn the character on the control with the Line method, you can then use the <b>ForeColor</b> property to change the color of the drawn character.</p>
<h2>Example Program</h2>
<p>
The following Visual Basic program displays the letters A–Z in different colors on the program's form.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the Paint event for Form1:<pre><code>Sub Form_Paint()
 &nbsp;&nbsp; Dim I As Integer, X As Integer, Y As Integer
 &nbsp;&nbsp; Dim C As String
 &nbsp;&nbsp; Cls
 &nbsp;&nbsp; For I = 65 To 91
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X = CurrentX
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Y = CurrentY
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; C = Chr(I)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Line -(X + TextWidth(C), Y = TextHeight(C)), QBColor(Rnd * 16), BF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentX = X
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentY = Y
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ForeColor = RGB(Rnd * 256, Rnd * 256, Rnd * 256)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Print C;
 &nbsp;&nbsp; Next
End Sub
</code></pre>
</li>
</ol>
</BODY>
</HTML>
