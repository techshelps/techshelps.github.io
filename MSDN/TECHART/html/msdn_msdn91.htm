<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 91: Determining If a Form Is Loaded</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn91"></a></sup>Tip 91: Determining If a Form Is Loaded</h1>
<p>
May 22, 1995</p>
<h2>Abstract</h2>
<p>
A Visual Basic® application may contain many different forms. This article presents a function that can be used to determine if a form is currently loaded into memory.</p>
<h2>Is the Form Loaded in Memory?</h2>
<p>
Because a Visual Basic® application can contain several forms, you need to be able to determine if a form is actually loaded into memory. The function presented in the example program below tests to see if a form is loaded. This function will not load the form—it simply tests to see if it is already in memory.</p>
<h2>Example Program</h2>
<p>
This program shows how to find out if a specific form is already loaded in a running Visual Basic application.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
From the Insert menu, select Form. Form2 is created by default.<br><br></li>
<li>
From the Insert menu, select Form. Form3 is created by default.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
Form2.Show
End Sub
</code></pre>
</li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
Dim X As Integer
X = IsFormLoaded(Form2)
If X Then
MsgBox "Form2 is loaded"
End If
X = IsFormLoaded(Form3)
If X = False Then
MsgBox "Form3 is not loaded"
End If
End Sub
</code></pre>
</li>
<li>
Create a new function called <b>IsFormLoaded</b>. Add the following code to this function:<pre><code>Function IsFormLoaded(FormToCheck As Form) As Integer
 &nbsp;&nbsp; Dim Y As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; For Y = 0 To Forms.Count - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Forms(Y) Is FormToCheck Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsFormLoaded = True
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Function
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp; Next
 &nbsp;&nbsp; IsFormLoaded = False
End Function
</code></pre>
</li>
</ol>
<p>
When you run this program, click the <b>Command Button</b>. A message box will pop up on the screen displaying the "Form2 is loaded" message. Click the OK command button. A second message box is immediately shown displaying the "Form3 is not loaded" message.</p>
</BODY>
</HTML>
