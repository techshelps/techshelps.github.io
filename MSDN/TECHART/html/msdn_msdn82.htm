<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 82: Retrieving Multiple Filenames from the Common Dialog Control</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn82"></a></sup>Tip 82: Retrieving Multiple Filenames from the Common Dialog Control</h1>
<p>
May 15, 1995</p>
<h2>Abstract</h2>
<p>
The <b>Common Dialog</b> control in Visual Basic® allows you to display an Open File dialog box. You can select one or more filenames from the Open File dialog box to use within your Visual Basic program. This article explains how you can retrieve multiple filenames from the dialog box, parse them into separate strings, and display them in a <b>List Box</b> control.</p>
<h2>Parsing Filenames from the Common Dialog Control</h2>
<p>
In a Visual Basic® application, you can use an Open File dialog box to allow your users to select a file. Using the Open File dialog box, users can select the drive and directory, as well as the individual files they want to use. To select a file, the user simply clicks the filename. The dialog box’s <b>FileName</b> property can be used in your program to determine the name of the selected file.</p>
<p>
If the <b>Flags</b> property of the <b>Common Dialog </b>control is set to a value of 512 (&amp;H200), the user can select a group of files to work with. To select multiple files, the user would hold the Shift key down while clicking the mouse on each filename. As with selecting a single file, the <b>FileName</b> property of the dialog box would return the names of all the selected files. Each filename is separated by a space character.</p>
<p>
The <b>InStr</b> function can be used within a Do-While loop to parse, or extract, each individual filename from the <b>FileName</b> property. Assuming that the filenames are stored in the string called FileNames, we can tell the <b>InStr</b> function to search through the string until it finds a space character. To extract a single filename, you need to first save the position in the target string that you are starting to search from (this is the beginning of the filename). Then you would use the <b>InStr</b> function to search for the first space character in the string. If a space character is found, you can use the starting position and the position returned by <b>InStr</b> to extract that single filename.</p>
<h2>Example Program</h2>
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Common Dialog</b> control to Form1. CommonDialog1 is created by default.<br><br></li>
<li>
Add a <b>List Box</b> control to Form1. List1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim DelimPos As Integer
 &nbsp;&nbsp; Dim FileNames As String
 &nbsp;&nbsp; Dim NextName As String
 &nbsp;&nbsp; 
 &nbsp;&nbsp; CommonDialog1.Flags = &amp;H200&amp;
 &nbsp;&nbsp; CommonDialog1.Action = 1
 &nbsp;&nbsp; CommonDialog1.Filter = 1
 &nbsp;&nbsp; 
 &nbsp;&nbsp; FileNames = CommonDialog1.FileName
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Do While Len(FileNames) &gt; 0
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DelimPos = InStr(FileNames, " ")
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If DelimPos = 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NextName = FileNames
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileNames = ""
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NextName = Mid$(FileNames, 1, DelimPos - 1)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileNames = Mid$(FileNames, DelimPos + 1)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp; List1.AddItem NextName
 &nbsp;&nbsp; Loop
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing the F5 function key. Click the command button to call up the Open File dialog box. Type a filename such as “*.*” and click the OK command button. Select several files from the file list by holding the SHIFT key down and clicking each individual filename. Click the OK command button when you have selected several files. The files you selected will be displayed in the <b>List Box</b> control.</p>
</BODY>
</HTML>
