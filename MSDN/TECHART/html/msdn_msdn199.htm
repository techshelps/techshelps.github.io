<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 199: Saving the Contents of the List Box Control to Disk in Visual Basic 4.0</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn199"></a></sup>Tip 199: Saving the Contents of the List Box Control to Disk in Visual Basic 4.0</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to save and later retrieve the contents of the Microsoft® Visual Basic® version 4.0 <b>List Box</b> control to and from a file on disk.</p>
<h2>Using Arrays with the List Box Control</h2>
<p>
The Microsoft® Visual Basic® version 4.0 <b>List Box</b> control lets you display a list of items, such as employee names, to your user. In your Visual Basic application, you may allow your user to add new items to the control. Before you quit your application, however, you need to save the entries in the <b>List Box</b> control to a file on disk. Then, when your application is run at a later time, you can retrieve the items to the <b>List Box</b> control from the data file's contents.</p>
<p>
You can save the contents of a <b>List Box</b> control to a sequential file on disk by first saving each entry in the control to an array. To do this, you would run the following code fragment:</p>
<pre><code>For i = 0 To List1.ListCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A(i) = List1.List(i)
Next I
</code></pre>
<p>
The total number of items stored in the <b>List Box</b> control is retrieved from the <b>ListCount</b> property. Next, the array A(i) is created, where the <i>i</i> variable holds a count of the current item being processed. As each item is retrieved from the <b>List Box</b> control, it is saved in the array.</p>
<p>
At this point, you use the Visual Basic <b>Write #</b> statement to save each item in the array to a disk file. Similarly, when you reload the items from the disk file to the <b>List Box</b> control, you use the <b>Input #</b> statement.</p>
<h2>Example Program</h2>
<p>
This program shows how to save the contents of a <b>List Box</b> control to a file on disk. In addition, you are shown how to retrieve the same items from the data file to the <b>List Box</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the General Declarations section of Form1:<pre><code>Dim A(50) As String
Dim ItemCount As Integer
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; For x = 1 To 20
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List1.AddItem "This is item #" &amp; x
 &nbsp;&nbsp; Next x
End Sub
</code></pre>
</li>
<li>
Add a <b>List Box</b> control to Form1. List1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; For i = 0 To List1.ListCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A(i) = List1.List(i)
 &nbsp;&nbsp; Next i
 &nbsp;&nbsp; ItemCount = List1.ListCount
 &nbsp;&nbsp; Open "c:\temp.txt" For Output As #1
 &nbsp;&nbsp; For i = 0 To ItemCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Write #1, A(i)
 &nbsp;&nbsp; Next i
 &nbsp;&nbsp; Close #1
 &nbsp;&nbsp; MsgBox "Data has been saved"

End Sub
</code></pre>
</li>
<li>
Add a second <b>Command Button</b> control to Form1. Command2 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command2:<pre><code>Private Sub Command2_Click()
 &nbsp;&nbsp; List1.Clear
 &nbsp;&nbsp; Open "c:\temp.txt" For Input As #1
 &nbsp;&nbsp; Do Until EOF(1)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Input #1, b$
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List1.AddItem b$
 &nbsp;&nbsp; Loop
 &nbsp;&nbsp; Close #1

End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. The program displays twenty items in the <b>List Box</b> control. Click the first <b>Command Button</b> control. The contents of the <b>List Box</b> control are saved to a file on disk. Click the second <b>Command Button</b> control. The contents of the file on disk are retrieved into the <b>List Box</b> control.</p>
</BODY>
</HTML>
