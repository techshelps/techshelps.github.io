<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using SC.EXE to Develop Windows NT Services</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="msdn_scmslite"></a>Using SC.EXE to Develop Windows NT Services</h1>
<p>
January 1995</p>
<p>
<OBJECT id=sample1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"
	width=0 height=0 hspace=0>
<PARAM name="Command" value="Sample">
<PARAM name="Item1" value="Technical Articles Sample">
<PARAM name="Item2" value="3301">
</OBJECT><a href="javascript:sample1.Click()">Click to open or copy the files in the SC.EXE sample application for this technical article.</a></p>
<h2>Introduction</h2>
<p>
A little-known command-line utility, SC.EXE, can help you develop your services for Microsoft® Windows NT™. SC.EXE, which is provided in the Win32® Software Development Kit (SDK) MSTOOLS directory, implements calls to all of the Windows NT service control application programming interface (API) functions. You can set the parameters to these functions by specifying them on the command line. SC.EXE also displays service status and retrieves the values stored in the status structure fields. The utility also lets you specify the name of a remote computer so that you can call the service API functions or view the service status structures on the remote computer.</p>
<p>
This article describes how to use the SC.EXE utility to obtain detailed information about Windows NT services. For more information about developing Windows NT services and for detailed reference information about the Windows NT Service API functions, such as <b>ControlService</b> and<b> QueryServiceStatus</b>, see the Platform SDK documentation (MSDN Library, Platform, SDK, and DDK Documentation).</p>
<p>
SC.EXE is a development tool that provides more detailed and accurate information about services than the two end-user utilities that are provided with the operating system. The Services Control Panel application and the network command-line interface, NET.EXE, can tell you that a service is running, stopped, or paused. These tools are fine for completely debugged and running services when everything is going smoothly. But when things go wrong, as sometimes happens when developing new code, the information provided by these tools can be misleading.</p>
<p>
For instance, if during the development stage your service hangs in the <i>start-pending</i> state, the Control Panel and NET.EXE report its state as <i>running</i>. If the service hangs when in the <i>stop-pending</i> state, NET START reports the status as <i>running</i>, and the Control Panel reports it as <i>stopped</i>. If you then attempt to start it, the Control Panel tells you the service is already running. This can be quite confusing.</p>
<p>
SC.EXE lets you query the service status and retrieve the values stored in the status structure fields. The NET.EXE program and the Services Control Panel application don't provide the complete status for the service. The SC program, however, will tell you the exact state of the service as well as show you the last checkpoint number and wait hint. The checkpoint can then be used as a debugging tool because it provides a clear indication of how far along the initialization had progressed before the program froze.</p>
<p>
SC.EXE also allows you to call any of the service control API functions and vary any of the parameters from the command line. This offers several advantages to the service developer. For instance, it provides a convenient way of creating or configuring the service information in the Registry and the Service Control Manager's database. The developer doesn't have to configure the service by manually creating entries in the Registry and then rebooting the machine in order to force the Service Control Manager to update its database.</p>
<p>
As a command line program, SC.EXE can also be used to create tests for your service. You can create batch (command) files that call SC.EXE with various parameters that control the service. This is useful if you want to see how your service behaves when it is repeatedly started and stopped. If you have more than one service in your service process, you can leave one service running so that the process doesn't go away, and then repeatedly start and stop the other service while looking for evidence of memory leaks due to an incomplete cleanup.</p>
<p>
The following sections contain reference information for the commands SC, SC QC, and SC QUERY.</p>
<h2>SC</h2>
<p>
The SC command-line utility uses the following syntax:</p>
<h4>Syntax1</h4>
<p>
<b>sc [Servername] Command Servicename [Optionname= Optionvalue...]</b></p>
<h4>Syntax2</h4>
<p>
<b>sc [Command]</b></p>
<p>
Use Syntax1 to run SC.EXE. Use Syntax2 to display help information (except for the "query" command—see the "Comments" section below for more information).</p>
<h4>Parameters</h4>
<p class=dt>
<i>Servername</i></p>
<p class=indent>
Optional. Specifies the name of the server when you want to run the commands on a remote computer. The name must start with two double backslash characters, such as "\\myserver". To run SC on the local computer, do not supply this parameter.</p>
<p class=dt>
<b><i>Command</i></b></p>
<p class=indent>
Specifies the SC command. Note that many of the SC commands require administrative privilege on the specified computer. SC supports the following commands:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=21%><b>Command</b></td>
<td class=label width=79%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=21%>config</td>
<td width=79%>Changes the configuration of a service (persistent).</td>
</tr>
<tr valign=top>
<td width=21%>continue</td>
<td width=79%>Sends a CONTINUE control request to a service.</td>
</tr>
<tr valign=top>
<td width=21%>control</td>
<td width=79%>Sends a control to a service.</td>
</tr>
<tr valign=top>
<td width=21%>create</td>
<td width=79%>Creates a service (adds it to the registry).</td>
</tr>
<tr valign=top>
<td width=21%>delete</td>
<td width=79%>Deletes a service (from the registry).</td>
</tr>
<tr valign=top>
<td width=21%>EnumDepend</td>
<td width=79%>Enumerates service dependencies.</td>
</tr>
<tr valign=top>
<td width=21%>GetDisplayName</td>
<td width=79%>Gets the DisplayName for a service.</td>
</tr>
<tr valign=top>
<td width=21%>GetKeyName</td>
<td width=79%>Gets the ServiceKeyName for a service.</td>
</tr>
<tr valign=top>
<td width=21%>interrogate</td>
<td width=79%>Sends an INTERROGATE control request to a service.</td>
</tr>
<tr valign=top>
<td width=21%>pause</td>
<td width=79%>Sends a PAUSE control request to a service.</td>
</tr>
<tr valign=top>
<td width=21%>qc</td>
<td width=79%>Queries configuration for the service. For detailed information, see the reference section, "SC QC."</td>
</tr>
<tr valign=top>
<td width=21%>query</td>
<td width=79%>Queries the status for a service, or enumerates the status for types of services. For detailed information, see the reference section, "SC QUERY."</td>
</tr>
<tr valign=top>
<td width=21%>start</td>
<td width=79%>Starts a service.</td>
</tr>
<tr valign=top>
<td width=21%>stop</td>
<td width=79%>Sends a STOP request to a service.</td>
</tr>
</table><br>
<p class=dt>
<b><i>Servicename</i></b></p>
<p class=indent>
Specifies the name given to the service key in the registry. Note that this is different from the display name, which is what you see with NET START and the Services Control Panel application. SC uses the service key name as the primary identifier for the service.</p>
<p class=dt>
<b><i>Optionname</i></b></p>
<p class=indent>
The <i>Optionname</i> and <i>Optionvalue</i> parameters allow you to specify the names and values of optional command parameters. Note that there is no space between the <i>Optionname</i> and the equal sign. You can supply zero, one, or more optional parameters name and value pairs.</p>
<p class=indent>
For a list of the available <i>Optionname </i>values, request help for the command by entering "sc <i>Command</i>", where <i>Command</i> is a valid SC command name, as listed in the <i>Command</i> parameter description above.</p>
<p class=dt>
<b><i>Optionvalue</i></b></p>
<p class=indent>
Specifies the value for the parameter named by <i>Optionname</i>. The range of valid values is often restricted for each <i>Optionname</i>. For a list of available values, request help for each command. </p>
<h4>Comments</h4>
<p>
Many of the commands require administrator privileges, so it's a good idea to make sure that you are an administrator of the machine where the development is being done.</p>
<p>
When you enter "SC" with no parameters, SC.EXE displays help information that lists the available commands. When you enter "SC" followed by a command name, you can get specific information about that command. For example, enter "SC CREATE" to get help specific to the CREATE command. </p>
<p>
The exception to this syntax is "SC QUERY", which dumps the status of all services and drivers currently running in the system. For help on the QUERY command, enter "SC", and respond to the prompt, "Would you like to see help for the QUERY command?" by entering "y" for yes.</p>
<p>
When you use the START command, you can pass arguments to the service's main function. Note that the arguments are not passed to the service <i>process's </i>main function.</p>
<h2>SC CREATE</h2>
<p>
The SC CREATE command creates an entry for the service in the Registry and in the Service Control Manager's database.</p>
<h4>Syntax1</h4>
<p>
<b>sc [Servername] create Servicename [Optionname=Optionvalue...]</b></p>
<h4>Parameters</h4>
<p class=dt>
<b><i>Servername</i></b></p>
<p class=indent>
Optional. Specifies the name of the server when you want to run the commands on a remote computer. The name must start with two double backslash characters, such as "\\myserver". To run SC on the local computer, do not supply this parameter.</p>
<p class=dt>
<b><i>Servicename</i></b></p>
<p class=indent>
Specifies the name given to the service key in the Registry. Note that this is different from the display name, which is what you see with NET START and the Services Control Panel application. SC uses the service key name as the primary identifier for the service.</p>
<p class=dt>
<b><i>Optionname</i></b></p>
<p class=indent>
The <i>Optionname</i> and <i>Optionvalue</i> parameters allow you to specify the names and values of optional parameters. Note that there is no space between the <i>Optionname</i> and the equal sign. You can supply zero, one, or more optional parameters name and value pairs. The SC QUERY command supports the following values:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=15%><b>Optionname</b></td>
<td class=label width=25%><b>Optionvalue</b></td>
<td class=label width=60%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=15%>type=</td>
<td width=25%>own, share, interact, kernel, filesys</td>
<td width=60%>Type of service being created. Optionvalues include types used by drivers. (default = share)</td>
</tr>
<tr valign=top>
<td width=15%>start=</td>
<td width=25%>boot, system, auto, demand, disabled</td>
<td width=60%>Start type for the service. Option values include types used by drivers. (default = demand)</td>
</tr>
<tr valign=top>
<td width=15%>error=</td>
<td width=25%>normal, severe, critical, ignore</td>
<td width=60%>Severity of error if the service fails to start during boot. (default = normal)</td>
</tr>
<tr valign=top>
<td width=15%>binPath=</td>
<td width=25%>(string)</td>
<td width=60%>Path name to the service binary file. There is no default for this. This string <i>must</i> be supplied.</td>
</tr>
<tr valign=top>
<td width=15%>group=</td>
<td width=25%>(string)</td>
<td width=60%>Name of group which this service is a member of. The list of groups are stored in the Registry under ServiceGroupOrder. (default = nothing)</td>
</tr>
<tr valign=top>
<td width=15%>tag=</td>
<td width=25%>(string)</td>
<td width=60%>If this string is set to "yes", SC will obtain a TagId from the <b>CreateService</b> call. However, SC does not display the tag so it's pointless to use this. (default = nothing)</td>
</tr>
<tr valign=top>
<td width=15%>depend=</td>
<td width=25%>(space separated string)</td>
<td width=60%>Names of services or groups which must start before this service.</td>
</tr>
<tr valign=top>
<td width=15%>obj=</td>
<td width=25%>(string)</td>
<td width=60%>Name of account in which the service will run. For drivers, this is the NT driver object name. (default = LocalSystem)</td>
</tr>
<tr valign=top>
<td width=15%>DisplayName=</td>
<td width=25%>(string)</td>
<td width=60%>A string that can be used by user-interface programs to identify the service.</td>
</tr>
<tr valign=top>
<td width=15%>password=</td>
<td width=25%>(string)</td>
<td width=60%>A password string. This is required if an account other than LocalSystem is used.</td>
</tr>
</table><br>
<p class=dt>
<b><i>Optionvalue</i></b></p>
<p class=indent>
Specifies the value for the parameter named by <i>Optionname</i>. See the <i>Optionname</i> reference for a list of supported values. When a string is to be input, the use of empty quotes means that an empty string will be passed in.</p>
<h4>Comments</h4>
<p>
The SC CREATE command performs the operations of the <b>CreateService</b> API function. </p>
<h4>Example 1</h4>
<p>
The following example creates a registry entry for the service named "NewService" on the computer called "\\myserver":</p>
<pre><code>sc \\myserver create NewService binpath= c:\nt\system32\NewServ.exe
</code></pre>
<p>
By default this service will be created as a WIN32_SHARE_PROCESS with a SERVICE_DEMAND_START start-type. It will not have any dependencies, and will run in the LocalSystem security context.</p>
<h4>Example 2</h4>
<p>
The following example creates the service on the local computer as an auto-start service that runs in its own process. It has dependencies on the TDI group and on the NetBIOS service. Notice that you must add quotes around the list of space-separated dependencies.</p>
<pre><code>sc create NewService binpath= c:\nt\system32\NewServ.exe type= own 
 start= auto depend= "+TDI Netbios"
</code></pre>
<h4>Example 3</h4>
<p>
The service developer can run the service in the context of the kernel debugger by temporarily changing the binary path (image path) for the service. The following example shows how to call SC to change the service configuration:</p>
<pre><code>sc config NewService binpath= "ntsd -d c:\nt\system32\NewServ.exe"
</code></pre>
<p>
This example causes the Service Control Manager to invoke NTSD.EXE with the following argument string:</p>
<pre><code>"-d c:\nt\system32\NewServ.exe".
</code></pre>
<p>
NTSD will in turn break on the debugger when it loads NEWSERV.EXE so that breakpoints can be set in the service code.</p>
<h2>SC QC</h2>
<p>
The SC QC "query configuration" command lists information about the service configuration from the QUERY_SERVICE_CONFIG structure.</p>
<h4>Syntax1</h4>
<p>
<b>sc [Servername] qc Servicename [Buffersize]</b></p>
<h4>Parameters</h4>
<p class=dt>
<b><i>Servername</i></b></p>
<p class=indent>
Optional. Specifies the name of the server when you want to run the commands on a remote computer. The name must start with two double backslash characters, such as "\\myserver". To run SC on the local computer, do not supply this parameter.</p>
<p class=dt>
<b><i>Servicename</i></b></p>
<p class=indent>
Specifies the name given to the service key in the registry. Note that this is different from the display name, which is what you see with NET START and the Services Control Panel application. SC uses the service key name as the primary identifier for the service.</p>
<p class=dt>
<b><i>Buffersize</i></b></p>
<p class=indent>
Optional. Specifies the size of the buffer in bytes. </p>
<h4>Comments</h4>
<p>
The SC QC command displays the contents of the QUERY_SERVICE_CONFIG structure:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=48%><b><br>
Information displayed by the SC QC command</b></td>
<td class=label width=52%><b>Corresponding field from the QUERY_SERVICE_CONFIG structure</b></td>
</tr>
<tr valign=top>
<td width=48%>TYPE</td>
<td width=52%>dwServiceType</td>
</tr>
<tr valign=top>
<td width=48%>START_TYPE</td>
<td width=52%>dwStartType</td>
</tr>
<tr valign=top>
<td width=48%>ERROR_CONTROL</td>
<td width=52%>dwErrorControl</td>
</tr>
<tr valign=top>
<td width=48%>BINARY_PATH_NAME</td>
<td width=52%>lpBinaryPathName</td>
</tr>
<tr valign=top>
<td width=48%>LOAD_ORDER_GROUP</td>
<td width=52%>lpLoadOrderGroup</td>
</tr>
<tr valign=top>
<td width=48%>TAG</td>
<td width=52%>dwTagId</td>
</tr>
<tr valign=top>
<td width=48%>DISPLAY_NAME</td>
<td width=52%>lpDisplayName</td>
</tr>
<tr valign=top>
<td width=48%>DEPENDENCIES</td>
<td width=52%>lpDependencies</td>
</tr>
<tr valign=top>
<td width=48%>SERVICE_START_NAME</td>
<td width=52%>lpServiceStartName</td>
</tr>
</table><br>
<h4>Example 1</h4>
<p>
The following example queries the configuration of the service named "NewService" that was created in Example 1 for the Create command:</p>
<pre><code>sc \\myserver qc NewService
</code></pre>
<p>
The SC utility displays the following information:</p>
<pre><code>SERVICE_NAME: NewService
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 20&nbsp; WIN32_SHARE_PROCESS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; START_TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 3&nbsp;&nbsp; DEMAND_START
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ERROR_CONTROL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1&nbsp;&nbsp; NORMAL
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BINARY_PATH_NAME&nbsp;&nbsp; : c:\nt\system32\NewServ.exe
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LOAD_ORDER_GROUP&nbsp;&nbsp; :
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TAG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DISPLAY_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NewService
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DEPENDENCIES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SERVICE_START_NAME : LocalSystem
</code></pre>
<p>
NewService has the ability to share a process with other services. It will not be auto-started. The binary file name is NEWSERV.EXE. This service doesn't depend on any other services, and will run in the Local System security context. Because this basically returns the results from a call to <b>QueryServiceStatus</b>, a more detailed explanation of these results can be obtained from the documentation on that API function.</p>
<h2>SC QUERY</h2>
<p>
The SC QUERY command obtains information about the service.</p>
<h4>Syntax</h4>
<p>
<b>sc [Servername] query { Servicename | Optionname= Optionvalue... }</b></p>
<h4>Parameters</h4>
<p class=dt>
<b><i>Servername</i></b></p>
<p class=indent>
Optional. Specifies the name of the server when you want to run the command on a remote computer. The name must start with two double backslash characters, such as "\\myserver".</p>
<p class=dt>
<b><i>Servicename</i></b></p>
<p class=indent>
Specifies the name given to the service key in the Registry. Note that this is different from the display name, which is what you see with NET START and the Services Control Panel application. SC uses the service key name as the primary identifier for the service. Note that you can supply either the <i>Servicename</i> or the options, but not both. When the <i>Servicename</i> is supplied, the other options are ignored.</p>
<p class=dt>
<b><i>Optionname</i></b></p>
<p class=indent>
The <i>Optionname</i> and <i>Optionvalue</i> parameters allow you to specify the names and values of optional parameters. Note that there is no space between the <i>Optionname</i> and the equal sign. You can supply zero, one, or more optional parameters name and value pairs. The SC QUERY command supports the following values:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=16%><b>Optionname</b></td>
<td class=label width=23%><b>Optionvalue</b></td>
<td class=label width=61%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=16%>type=</td>
<td width=23%>driver, service, all</td>
<td width=61%>Type of services to enumerate (default = service)</td>
</tr>
<tr valign=top>
<td width=16%>state=</td>
<td width=23%>active, inactive, all</td>
<td width=61%>State of services to enumerate&nbsp; (default = active)</td>
</tr>
<tr valign=top>
<td width=16%>bufsize=</td>
<td width=23%>(numeric value)</td>
<td width=61%>The size in bytes of the enumeration buffer (default = 1024 bytes)</td>
</tr>
<tr valign=top>
<td width=16%>ri=</td>
<td width=23%>(numeric value)</td>
<td width=61%>The resume index number at which to begin the enumeration (default = 0)</td>
</tr>
</table><br>
<p class=dt>
<b><i>Optionvalue</i></b></p>
<p class=indent>
Specifies the value for the parameter named by <i>Optionname</i>. See the <i>Optionname</i> reference for a list of supported values.</p>
<h4>Comments</h4>
<p>
The SC QUERY command displays the contents of the SERVICE_STATUS structure:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=41%><b>Information displayed by SC QUERY command</b></td>
<td class=label width=59%><b>Corresponding field from the SERVICE_STATUS structure</b></td>
</tr>
<tr valign=top>
<td width=41%>TYPE</td>
<td width=59%>dwServiceType</td>
</tr>
<tr valign=top>
<td width=41%>STATE</td>
<td width=59%>dwCurrentState, dwControlsAccepted</td>
</tr>
<tr valign=top>
<td width=41%>WIN32_EXIT_CODE</td>
<td width=59%>dwWin32ExitCode</td>
</tr>
<tr valign=top>
<td width=41%>SERVICE_EXIT_CODE</td>
<td width=59%>dwServiceSpecificExitCode</td>
</tr>
<tr valign=top>
<td width=41%>CHECKPOINT</td>
<td width=59%>dwCheckPoint</td>
</tr>
<tr valign=top>
<td width=41%>WAIT_HINT</td>
<td width=59%>dwWaitHint</td>
</tr>
</table><br>
<p>
Using the SC QUERY command after booting the machine will tell you whether or not an attempt was made to start this service. If the service was started successfully, the WIN32_EXIT_CODE field should contain a zero (0). If the service failed to start when an attempt was made, this field should contain an exit code provided by the service when it realized it couldn't start.</p>
<h4>Examples</h4>
<p>
To query the status of the service, "NewService," enter:</p>
<pre><code>sc query NewService
</code></pre>
<p>
SC displays the following information:</p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;SERVICE_NAME: NewService
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 20&nbsp; WIN32_SHARE_PROCESS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1&nbsp; STOPPED
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NOT_STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WIN32_EXIT_CODE&nbsp;&nbsp;&nbsp; : 1077&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (0x435)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SERVICE_EXIT_CODE&nbsp; : 0&nbsp; (0x0)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CHECKPOINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0x0
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WAIT_HINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0x0
</code></pre>
<p>
Notice that there is an exit code for this service, even though it has not yet been run. Entering the Windows NT command "net helpmsg 1077" at the command line returns the following text information for error 1077:</p>
<pre><code>No attempts to start the service have been made since the last boot.
</code></pre>
<p>
Net Helpmsg can be used to display the text for most Windows NT error messages. This particular exit code indicates that this service hasn't yet been run. Although obvious in this case, this particular exit code is a useful one to look for if you are expecting your service to be auto-started or perhaps when another auto-start service has a dependency on your service. </p>
<p>
To enumerate status for active services and drivers, use the following command:</p>
<pre><code>sc query 
</code></pre>
<p>
To display status for the messenger service, use the following command:</p>
<pre><code>sc query messenger 
</code></pre>
<p>
To enumerate only active drivers, use the following command:</p>
<pre><code>sc query type= driver
</code></pre>
<p>
To enumerate only Win32 services, use the following command:</p>
<pre><code>sc query type= service
</code></pre>
<p>
To enumerate all services and drivers, use the following command:</p>
<pre><code>sc query state= all
</code></pre>
<p>
To enumerate with a 50-byte buffer, use the following command:</p>
<pre><code>sc query bufsize= 50
</code></pre>
<p>
To enumerate with resume index = 14, use the following command:</p>
<pre><code>sc query ri= 14 
</code></pre>
<p>
To enumerate all interactive services, use the following command:</p>
<pre><code>sc query type= service type= interact 
</code></pre>
</BODY>
</HTML>
