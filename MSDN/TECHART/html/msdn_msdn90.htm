<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 90: Adding ToolTips to Visual Basic Applications</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn90"></a></sup>Tip 90: Adding ToolTips to Visual Basic Applications</h1>
<p>
May 22, 1995</p>
<h2>Abstract</h2>
<p>
Many Windows®-based applications have a toolbox from which you can select a command to execute. When you move the cursor (mouse pointer) over an item in the toolbox, a ToolTip is displayed. This article shows how to add this ToolTip help feature to your own Visual Basic® applications.</p>
<h2>Creating ToolTips in Visual Basic</h2>
<p>
You can create a more professional-looking Visual Basic® application if you include the ToolTips that are featured in the newest version of Microsoft® Word. ToolTips are small, yellow description "balloons" that pop up on your screen when your cursor (mouse pointer) is over a control. The ToolTip usually contains a short descriptive word or phrase that describes the control's underlying purpose. It makes memorizing what icons do a thing of the past.</p>
<p>
The example program below shows the code you need to add to your application to create and use ToolTips. Let's assume that you want to add a <b>Command Button</b> control to your form. In the <b>Tag</b> property of the <b>Command Button</b> control you place the text that you want displayed when the user moves the cursor over the control. This descriptive text can be as long as you like, but keep in mind that the shorter the description, the better. The <b>AutoSize</b> property of the <b>Picture Box</b> control must be set to True so that when the program is running, the <b>Picture Box</b> will size itself according to the length of the descriptive text you entered in the <b>Tag</b> property.</p>
<p>
Next, you need to tell your Visual Basic application when to display the ToolTips description. In the MouseMove event, you want to call the <b>ToolTips</b> function with the statement:</p>
<p>
ToolTip <i>Me</i>, <i>Command1</i>, True</p>
<p>
where "Me" is the form the control resides on, "Command1" is the name of the individual control, and True means you want to display the ToolTip for this control. If you don't want to display a ToolTip for this particular control, set the last argument to False. This is done in the form's MoveMove event so that no ToolTip is ever displayed while the cursor is over the form itself. Once the Timer's interval has elapsed, the ToolTip will be displayed for that control.</p>
<h2>Example Program</h2>
<p>
This program shows how to add ToolTips to a Visual Basic application. Press the F5 function key to run the example program. You will see a <b>Command Button</b> control and a <b>Text Box</b> control on the form. Move the cursor over the <b>Command Button</b> and the ToolTip message "A command button control to click on" will be displayed. Move the cursor over the <b>Text Box</b> control and the ToolTip message "A text box control" will be displayed.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; Timer1.Enabled = True
 &nbsp;&nbsp; ToolTips Me, ToolTip, False
End Sub
</code></pre>
</li>
<li>
Add the following code to the MouseMove event for Form1 (note that the Private line must be typed as a single line of code):<pre><code>Private Sub Form_MouseMove(Button As Integer, Shift As Integer, X As Single,
  Y As Single)
 &nbsp;&nbsp; ToolTips Me, ToolTip, False
End Sub
</code></pre>
</li>
<li>
Add a <b>Timer</b> control to Form1. Timer1 is created by default. Set its <b>Interval</b> property to 1.<br><br></li>
<li>
Add the following code to the Timer_Event for Timer1:<pre><code>Private Sub Timer1_Timer()
 &nbsp;&nbsp;&nbsp;&nbsp; ToolTip.Visible = True
 &nbsp;&nbsp;&nbsp;&nbsp; ToolTip.ZOrder 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp; Timer1.Enabled = False
End Sub
</code></pre>
</li>
<li>
Add a <b>Picture Box</b> control to Form1. Picture1 is created by default. Set the following properties for Picture1:</li>
</ol>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=20%><b>AutoSize </b></td>
<td width=80%>True</td>
</tr>
<tr valign=top>
<td width=20%><b>BackColor </b></td>
<td width=80%>&amp;H0000FFFF&amp; (yellow)</td>
</tr>
<tr valign=top>
<td width=20%><b>Height </b></td>
<td width=80%>255</td>
</tr>
<tr valign=top>
<td width=20%><b>Left </b></td>
<td width=80%>480</td>
</tr>
<tr valign=top>
<td width=20%><b>Name </b></td>
<td width=80%>ToolTip</td>
</tr>
<tr valign=top>
<td width=20%><b>Top </b></td>
<td width=80%>480</td>
</tr>
<tr valign=top>
<td width=20%><b>Visible </b></td>
<td width=80%>False</td>
</tr>
<tr valign=top>
<td width=20%><b>Width </b></td>
<td width=80%>975</td>
</tr>
</table><br>
<ol start=7>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default. Set its <b>Tag</b> property to "A command button control to click on".<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; ToolTips Me, Command1, False
End Sub
</code></pre>
</li>
<li>
Add the following code to the MouseMove event for Command1 (note that the Private line must be typed as a single line of code):<pre><code>Private Sub Command1_MouseMove(Button As Integer, Shift As Integer, X As Single,
  Y As Single)
 &nbsp;&nbsp; ToolTips Me, Command1, True
End Sub
</code></pre>
</li>
<li>
Add a <b>Text Box</b> control to Form1. Text1 is created by default. Set its <b>Tag</b> property to "A text box".<br><br></li>
<li>
Add the following code to the Click event for Text1:<pre><code>Private Sub Text1_Click()
 &nbsp;&nbsp; ToolTips Me, Text1, False
End Sub
</code></pre>
</li>
<li>
Add the following code to the MouseMove event for Text1 (note that the Private line must be typed as a single line of code):<pre><code>Private Sub Text1_MouseMove(Button As Integer, Shift As Integer, X As Single,
  Y As Single)
 &nbsp;&nbsp; ToolTips Me, Text1, True
End Sub
</code></pre>
</li>
<li>
Create a new function called <b>ToolTips</b>. Add the following code to this function:<pre><code>Sub ToolTips(Frm As Form, Ctl As Control, OnOff As Integer)
 If OnOff Then&nbsp; 
 &nbsp; Frm.ToolTip.Cls 
 &nbsp; Frm.ToolTip.Print " " &amp; Ctl.Tag &amp; " "&nbsp;&nbsp; 
 &nbsp; Frm.ToolTip.Width = Frm.ToolTip.TextWidth(Ctl.Tag &amp; "&nbsp; ") 
 &nbsp; If Ctl.Top + Ctl.Height + Frm.ToolTip.Height + 40 &lt; Frm.ScaleHeight Then
 &nbsp;&nbsp;&nbsp;&nbsp; Frm.ToolTip.Top = Ctl.Top + Ctl.Height + 40
 &nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp; Frm.ToolTip.Top = Ctl.Top - Frm.ToolTip.Height - 40
 &nbsp; End If
 &nbsp; If Ctl.Left + Frm.ToolTip.Width &lt; Frm.ScaleWidth Then
 &nbsp;&nbsp;&nbsp;&nbsp; Frm.ToolTip.Left = Ctl.Left
 &nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp; Frm.ToolTip.Left = Ctl.Left - Frm.ToolTip.Width + Ctl.Width
 &nbsp; End If
 &nbsp; Frm.Timer1.Enabled = True&nbsp;&nbsp; 
 Else
 &nbsp; Frm.ToolTip.Visible = False 
 &nbsp; Frm.ToolTip.ZOrder 1&nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp; Frm.Timer1.Enabled = False&nbsp; 
 End If
End Sub
</code></pre>
</li>
</ol>
<h2>Additional References</h2>
<p>
Knowledge Base Q111495. "How to Implement ToolTips Help in Visual Basic Applications."</p>
</BODY>
</HTML>
