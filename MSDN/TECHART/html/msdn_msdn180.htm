<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 180: Performing Searches in a Combo Box Control with SendMessage</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="msdn_msdn180"></a>Tip 180: Performing Searches in a Combo Box Control with SendMessage</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to design your Microsoft® Visual Basic® application so that the user can search for an item in a <b>Combo Box</b> control.</p>
<h2>Searching for Items in a Combo Box Control</h2>
<p>
Microsoft® Visual Basic® <b>Combo Box</b> and <b>List Box</b> controls let you display a list of related items. For example, you might have a <b>Combo Box</b> control that displays a list of colors to the user. The user can select any color he or she wants to use by clicking that particular item in the <b>Combo Box</b> control.</p>
<p>
When your <b>Combo Box</b> or <b>List Box</b> control contains a large number of items, it may be time-consuming to scroll through the items. An alternative solution to this problem can be found by allowing your user to type the item he or she wants to find. Then you can search through each entry in the control until you find the target item.</p>
<p>
The Microsoft Windows® application programming interface (API) <b>SendMessage</b> function allows you to send a specific message to a window. In the example program below, a CB_FINDSTRING message is sent to the <b>Combo Box</b> control. This message tells Windows to search the <b>Combo Box</b> control for the value specified in the <i>lParam</i> variable.</p>
<p>
The <i>lParam</i> variable must be set to the text string you want to locate in the <b>Combo Box</b> control. When the CB_FINDSTRING message is sent to the <b>Combo Box</b> control, the message will return the index number of the item that actually exists in the control. You must be aware, however, that the index number returned is zero-based. Therefore, if a value of 5 is returned, this actually corresponds to the fourth entry in the <b>Combo Box</b> control.</p>
<h2>Example Program</h2>
<p>
This program shows how to find an individual item in a <b>Combo Box</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following <b>Constant</b> and <b>Declare</b> statements to the General Declarations section of Form1 (note that the <b>Declare</b> statement must be typed as a single line of code):<pre><code>Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" 
 &nbsp; (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) 
 &nbsp; As Long
Const CB_FINDSTRING = &amp;H14C
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Load()
 &nbsp;&nbsp; For X = 1 To 10
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Combo1.AddItem "Item" &amp; X
 &nbsp;&nbsp; Next
End Sub
</code></pre>
</li>
<li>
Add a <b>Combo Box</b> control to Form1. Combo1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; X = SendMessage(Combo1.hwnd, CB_FINDSTRING, -1, ByVal "Item5")
 &nbsp;&nbsp; MsgBox "Index number for this entry is: " &amp; Str$(X)
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing f5. Click the <b>Command Button</b> control to search the <b>Combo Box</b> control for the item "Item5". A message box appears that identifies the index number (in this case, a value of 4) that corresponds to the item that was found in the <b>Combo Box</b> control. A value of 4 is returned because index numbers begin at zero.</p>
</BODY>
</HTML>
