<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 189: Determining Which Screen and Printer Fonts Are Available</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn189"></a></sup>Tip 189: Determining Which Screen and Printer Fonts Are Available</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
When displaying text in a Microsoft® Visual Basic® application, you may want to specify which fonts are assigned to the text on the screen and the text sent to the printer. This article explains how you can retrieve a list of screen fonts and a list of printer fonts currently installed on your computer system.</p>
<h2>Retrieving Lists of Installed Screen and Printer Fonts</h2>
<p>
The Fonts collection provided in Microsoft® Visual Basic® is a list of the names of all fonts installed in the Microsoft Windows® operating system. You can retrieve a specific font by specifying an index value with a statement such as:</p>
<pre><code>X$ = Screen.Fonts(2)
</code></pre>
<p>
Note that you cannot modify the <b>Fonts</b> property of an object but can only ask which font is currently being used.</p>
<p>
The Fonts collection exists for both the <b>Screen</b> object and the <b>Printer</b> object, which both have a <b>FontCount</b> property. The <b>FontCount</b> property indicates exactly how many fonts for that particular object are available.</p>
<p>
You can create a list of all available fonts by interrogating the items contained in the Fonts collection. In the example program below, a For-Next loop retrieves each font's name from the Fonts collection. The routine ends when the maximum number of installed fonts (FontCount - 1) has been reached.</p>
<h2>Example Program</h2>
<p>
This program shows how to retrieve a list of all printer and screen fonts installed in the computer system.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>List Box</b> control to Form1. List1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; List1.Clear
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; For X = 0 To Printer.FontCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List1.AddItem Printer.Fonts(X)
 &nbsp;&nbsp; Next X
End Sub
</code></pre>
</li>
<li>
Add a second <b>Command Button</b> control to Form1. Command2 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command2:<pre><code>Private Sub Command2_Click()
 &nbsp;&nbsp; List1.Clear
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; For X = 0 To Screen.FontCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List1.AddItem Screen.Fonts(X)
 &nbsp;&nbsp; Next X
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the first <b>Command Button</b> control. A list of all printer fonts appears in the <b>List Box</b> control. Click the second <b>Command Button</b> control. A list of all screen fonts appears in the <b>List Box</b> control.</p>
</BODY>
</HTML>
