<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mapping the Data Access Object: DAO 3.0</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_mapdao30"></a></sup>Mapping the Data Access Object: DAO 3.0</h1>
<p>
Ken Lassesen<br>
Microsoft Developer Network Technology Group</p>
<p>
Created: July 31, 1995<br>
Revised: October 11, 1995 (Updated diagram)</p>
<p>
<OBJECT id=sample1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"
	width=0 height=0 hspace=0>
<PARAM name="Command" value="Sample">
<PARAM name="Item1" value="Technical Articles Sample">
<PARAM name="Item2" value="4347">
</OBJECT><a href="javascript:sample1.Click()">Click here for a diagram of the Data Access Object (DAO) in various graphics formats.</a></p>
<h2>Abstract</h2>
<p>
This article consists primarily of a graphic map of the Data Access Object (DAO), showing its properties, methods, and child objects. The map highlights changes between DAO version 2.5 and DAO version 3.0.</p>
<h2>The Data Access Object</h2>
<p>
The Data Access Object (DAO) uses the Microsoft® Jet database engine to communicate with database servers via the Open Database Connectivity (ODBC) driver manager and a specified server driver (as shown in Figure 1). The DAO bypasses ODBC when the database is the Jet engine or another ISAM data source. This approach insulates the developer from many database-programming complexities while providing high-level data access objects, properties, and methods.</p>
<p>
<img src="mapdao30_1.gif" border=0></p>
<p class=label>
<b>Figure 1. The relationship between the Data Access Object and other data components</b></p>
<p>
The DAO is available in Visual C and many Visual Basic for Applications–based products. These include Microsoft Excel version 5.0 and higher, Microsoft Access 95, Visual Basic® version 4.0, and Visual C++™ version 4.0. The DAO may be used from other products that support references, for example, Microsoft Project. For information on using the DAO, see your product documentation and search the MSDN Library CD. The bibliography directs you to some key articles.</p>
<p>
Table 1 shows the product heritage of the DAO. </p>
<p class=label>
<b>Table 1. Version of DAO implementation in various products</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=20%><b>DAO version</b></td>
<td class=label width=80%><b>Microsoft products</b></td>
</tr>
<tr valign=top>
<td width=20%>1.0</td>
<td width=80%>Visual Basic 2.0, Visual Basic 3.0, Microsoft Access 1.1</td>
</tr>
<tr valign=top>
<td width=20%>2.0</td>
<td width=80%>Microsoft Access 2.0</td>
</tr>
<tr valign=top>
<td width=20%>2.5</td>
<td width=80%>Visual Basic 4.0 (16-bit only)</td>
</tr>
<tr valign=top>
<td width=20%>3.0</td>
<td width=80%>Visual Basic 4.0, Microsoft Access 95, Microsoft Excel 95, Visual C++ 4.0 </td>
</tr>
</table><br>
<p>
Figure 2 shows the relationship between objects as described by the Object Viewer and online Help files. A map is a good learning aid and a quick reference when developing an application. After producing a map, I found that it was easy to work with the object: I just post the appropriate map on my wall for quick reference, which is a lot faster than clicking objects in a Help file one by one to discover their properties and methods. For an introduction to using OLE Automation see my article, "Using Microsoft OLE Servers to Develop Solutions."</p>
<p>
Because Figure 2 is unreadable online, I have included the two most common graphics formats—encapsulated PostScript™ (.EPS) and Windows® metafile (.WMF)—as well as a copy of my original Shapeware® Visio™ version 4.0 file (.VSD). The first two formats can be printed across multiple pages using any of the commercial graphics applications—such as Adobe™ PageMaker™, Corel® Draw, or Microsoft® Publisher—or using Microsoft Excel. The original Visio file is included for those who have a copy of Visio 95 and wish to modify the diagram easily.&nbsp; </p>
<p>
<img src="mapdao30_2.gif" border=0></p>
<p class=label>
<b>Figure 2. The Data Access Object map</b></p>
<h3>Outdated Item</h3>
<p>
DAO 3.0 has some methods and properties that may disappear in future versions. The <b>Database.V1xNullBehavior</b> property should not be used; it is included for backward compatibility.</p>
<h3>Object Definitions</h3>
<p>
The objects and collections in Figure 2 are defined in Table 2.</p>
<p class=label>
<b>Table 2. Object and Collection Definitions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Object or Collection</b></td>
<td class=label width=75%><b>Definition</b></td>
</tr>
<tr valign=top>
<td width=25%><b>DBEngine</b> object</td>
<td width=75%>This object represents the Microsoft Jet database engine. As the top-level object, it contains and controls all other objects in the hierarchy of data access objects.</td>
</tr>
<tr valign=top>
<td width=25%><b>Workspaces</b> collection</td>
<td width=75%>This collection contains all active, unhidden <b>Workspace</b> objects of the <b>DBEngine</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Workspace</b> object</td>
<td width=75%>This object defines a session for a user. It contains open databases and provides mechanisms for simultaneous transactions and for a secure workgroup.</td>
</tr>
<tr valign=top>
<td width=25%><b>Databases</b> collection</td>
<td width=75%>This collection contains all open <b>Database</b> objects opened or created in a <b>Workspace</b> object of the Microsoft Jet database engine.</td>
</tr>
<tr valign=top>
<td width=25%><b>Database</b> object</td>
<td width=75%>This object represents an open database.</td>
</tr>
<tr valign=top>
<td width=25%><b>Errors</b> collection</td>
<td width=75%>This collection contains all stored <b>Error</b> objects, each of which pertains to a single operation involving data access objects (DAO).</td>
</tr>
<tr valign=top>
<td width=25%><b>Error</b> object</td>
<td width=75%>This object contains details about data access errors.</td>
</tr>
<tr valign=top>
<td width=25%><b>Users</b> collection</td>
<td width=75%>This collection contains all stored <b>User</b> objects of a <b>Workspace</b> or group account.</td>
</tr>
<tr valign=top>
<td width=25%><b>User</b> object</td>
<td width=75%>This object is a user account that has access permissions when a <b>Workspace</b> object operates as a secure workgroup.</td>
</tr>
<tr valign=top>
<td width=25%><b>Groups</b> collection</td>
<td width=75%>This collection contains all stored <b>Group</b> objects of a <b>Workspace</b> or user account. </td>
</tr>
<tr valign=top>
<td width=25%><b>Group</b> object</td>
<td width=75%>This object is a group of user accounts that have common access permissions when a <b>Workspace</b> object operates as a secure work group.</td>
</tr>
<tr valign=top>
<td width=25%><b>QueryDefs</b> collection</td>
<td width=75%>This collection contains all <b>QueryDef</b> objects in a Database object.</td>
</tr>
<tr valign=top>
<td width=25%><b>QueryDef</b> object</td>
<td width=75%>This object is a stored definition of a query in a Microsoft Jet database.</td>
</tr>
<tr valign=top>
<td width=25%><b>Parameters</b> collection</td>
<td width=75%>This collection contains all the <b>Parameter</b> objects of a <b>QueryDef</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Parameter</b> object</td>
<td width=75%>This object is a parameter associated with a <b>QueryDef</b> object created from a parameter query.</td>
</tr>
<tr valign=top>
<td width=25%><b>Recordsets</b> collection</td>
<td width=75%>This collection contains all open <b>Recordset</b> objects in a <b>Database</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Recordset</b> object</td>
<td width=75%>This object consists of the records in a base table or the records returned from a query.</td>
</tr>
<tr valign=top>
<td width=25%><b>TableDefs</b> collection</td>
<td width=75%>This collection contains all stored <b>TableDef</b> objects in a database.</td>
</tr>
<tr valign=top>
<td width=25%><b>TableDef</b> object</td>
<td width=75%>This object represents the stored definition of a base table or an attached table.</td>
</tr>
<tr valign=top>
<td width=25%><b>Indexes</b> collection</td>
<td width=75%>This collection contains stored Index objects of a <b>TableDef</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Index</b> objects</td>
<td width=75%>These objects specify the order of records accessed from database. Index objects provide efficient access to data. For external databases, Index objects describe the indexes established for external tables.</td>
</tr>
<tr valign=top>
<td width=25%><b>Relations</b> collection</td>
<td width=75%>This collection contains stored <b>Relation</b> objects of a <b>Database</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Relation</b> object</td>
<td width=75%>This object is a relationship between fields in tables or queries.</td>
</tr>
<tr valign=top>
<td width=25%><b>Containers</b> collection</td>
<td width=75%>This collection contains all of the <b>Container</b> objects that are in a database.</td>
</tr>
<tr valign=top>
<td width=25%><b>Container</b> object</td>
<td width=75%>This collection contains information about objects grouped in that container. </td>
</tr>
<tr valign=top>
<td width=25%><b>Documents</b> collection</td>
<td width=75%>This collection contains all of the <b>Document</b> objects for a specific object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Document</b> object</td>
<td width=75%>This object contains information about one instance of an object. The object can be a database, saved table, query, or relationship.</td>
</tr>
<tr valign=top>
<td width=25%><b>Properties</b> collection</td>
<td width=75%>This collection contains all the <b>Property</b> objects for a specific instance of an object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Property</b> object</td>
<td width=75%>This object is a built-in characteristic or a user-defined characteristic of a data access object. </td>
</tr>
<tr valign=top>
<td width=25%><b>Fields</b> collection</td>
<td width=75%>This collection contains all stored <b>Field</b> objects of an <b>Index</b>, <b>QueryDef</b>, <b>Recordset</b>, <b>Relation</b>, or <b>TableDef</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Field</b> object</td>
<td width=75%>This object is a column of data with a common data type and a common set of properties.</td>
</tr>
</table><br>
<h2>Bibliography</h2>
<p>
Black, Neil, and Stephen Hecht. "Jet Database Engine ODBC Connectivity." (MSDN Library Archive, Backgrounders)</p>
<p>
Eineigl, Robert. "Basic Principles: Getting the Most from the Data Access Object Layer." <i>Microsoft</i> <i>Developer Network News</i> (May 1995). (MSDN Library, Periodicals)</p>
<p>
Lassesen, Ken, <a href="msdn_ole2soln.htm">"Using Microsoft OLE Servers to Develop Solutions."</a> (MSDN Library, Technical Articles)</p>
<p>
Mee, Michael. "Advanced Data Access Objects (DAO) for Client Server." (MSDN Library, Conference Papers)</p>
<p>
Mee, Michael. "Forty-Two Ways to Make DAO Faster—Programming to DAO Using Microsoft Access." (MSDN Library, Conference Papers)</p>
<p>
Nelson, Greg, and Roger Jennings. "A Client-Server Application: From Concept to Reality." (MSDN Library Archive, Conference Papers)</p>
</BODY>
</HTML>
