<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 186: Formatting Text in a Rich Text Box Control in Visual Basic 4.0</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn186"></a></sup>Tip 186: Formatting Text in a Rich Text Box Control in Visual Basic 4.0</h1>
<p>
February 28, 1996</p>
<h2>Abstract</h2>
<p>
The Microsoft® Visual Basic® version 4.0 <b>Rich Text Box</b> control allows the user to enter and edit text. In addition, this control provides more advanced formatting features than the conventional <b>TextBox</b> control. This article explains how to display selected text in different fonts in the <b>Rich Text Box</b> control.</p>
<h2>Using the TextRTF Property of a Rich Text Box Control</h2>
<p>
The Microsoft® Visual Basic® version 4.0 <b>Rich Text Box</b> control is an advanced version of the <b>TextBox</b> control. Text entered in a <b>Rich Text Box</b> control can be formatted in different colors, fonts and font styles, and point sizes. For example, you can make text appear in bold or italic. You must remember that the <b>Rich Text Box</b> control formatting codes apply to the currently selected text only, not to all text in the control.</p>
<p>
In the example program below, you fill a <b>Rich Text Box</b> control with a list of all screen fonts installed in the computer system. This is accomplished by using the <b>TextRTF</b> property to tell the <b>Rich Text Box</b> control to display the text in the selected font.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The <b>TextRTF</b> property requires the Microsoft Windows® 95 or Microsoft Windows NT® 3.51 or later operating system.</p>
<h2>Example Program</h2>
<p>
This program shows how to display text in different fonts in a <b>Rich Text Box</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Rich Text Box</b> control to Form1. Rich-Text Box1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; Rich-Text Box1.Text = ""
 &nbsp;&nbsp; 
 &nbsp;&nbsp; For X = 0 To Screen.FontCount - 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DoEvents
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With Rich-Text Box1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Var = .TextRTF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var1 = Right(Var, Len(Var) - 1)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Text = Screen.Fonts(X)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Var = .TextRTF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var2 = Left(Var, Len(Var) - 3)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Var = var2 &amp; var1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .TextRTF = Var
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .SelStart = 0
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .SelLength = Len(Screen.Fonts(X))
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .SelFontName = Screen.Fonts(X)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .SelFontSize = 12
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With
 &nbsp;&nbsp; Next X
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the <b>Command Button</b> control. After a short delay, the <b>Rich Text Box</b> control is populated with a list of all installed screen fonts. Each font is displayed in its 12-point size.</p>
</BODY>
</HTML>
