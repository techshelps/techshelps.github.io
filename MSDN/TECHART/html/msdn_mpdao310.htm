<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mapping the Data Access Object: DAO 3.1 (for ODBC Direct Data Sources)</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_mpdao310"></a></sup>Mapping the Data Access Object: DAO 3.1 (for ODBC Direct Data Sources)</h1>
<p>
Ken Lassesen<br>
Microsoft Developer Network Technology Group</p>
<p>
January 31, 1996</p>
<p>
<OBJECT id=sample1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"
	width=0 height=0 hspace=0>
<PARAM name="Command" value="Sample">
<PARAM name="Item1" value="Technical Articles Sample">
<PARAM name="Item2" value="4542">
</OBJECT><a href="javascript:sample1.Click()">Click here for a diagram of the Data Access Object (DAO) in various graphics formats.</a></p>
<h2>Abstract</h2>
<p>
This article presents a graphic map of the Data Access Object (DAO) object model, version 3.1,as the model applies to Open Database Connectivity (ODBC) data sources connected directly to DAO rather than to the Microsoft® Jet database engine (as was required in previous versions). This is an implementation of features found in the Visual Basic® 4.0 Remote Data Object (RDO). The map shows the new DAO 3.1 properties, methods, and child objects available when directly connected to an ODBC data source.</p>
<h2>Data Access Object 3.1</h2>
<p>
The Data Access Object (DAO) version 3.1 object model for Open Database Connectivity (ODBC) direct data sources presented in this article is a subset of the full DAO version 3.1 object model. The objects, methods, and properties shown are those that apply only to ODBC direct data sources.</p>
<p>
<img src="mpdao31o_1.gif" border=0></p>
<p class=label>
<b>Figure 1. Relationship between Data Access Object 3.1 and other data components</b></p>
<p>
DAO is available in Visual C++® and many products based on Microsoft® Visual Basic® for Applications. These products include Microsoft Excel version 5.0 and later, Microsoft Access 95, Visual Basic version 4.0, and Visual C++ version 4.0. DAO may be used from any DAO 3.0 licensed host that can call an OLE Automation server, such as Microsoft Project. For information on using DAO, see your product documentation and search the Microsoft Development Library. The bibliography directs you to some key articles. DAO has gone through several versions, as shown in Table 1.</p>
<p class=label>
<b>Table 1. DAO Version Used in Various Microsoft Products</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=20%><b>DAO version</b></td>
<td class=label width=80%><b>Microsoft products</b></td>
</tr>
<tr valign=top>
<td width=20%>1.0</td>
<td width=80%>Visual Basic 2.0, Visual Basic 3.0, Microsoft Access 1.1</td>
</tr>
<tr valign=top>
<td width=20%>2.0</td>
<td width=80%>Microsoft Access 2.0</td>
</tr>
<tr valign=top>
<td width=20%>2.5</td>
<td width=80%>Visual Basic 4.0 (16-bit only)</td>
</tr>
<tr valign=top>
<td width=20%>3.0</td>
<td width=80%>Visual Basic 4.0, Microsoft Access 95, Microsoft Excel 95, Visual C++ 4.0 </td>
</tr>
<tr valign=top>
<td width=20%>3.1</td>
<td width=80%>Separate release for existing 3.0 hosts</td>
</tr>
</table><br>
<p>
Figure 2 shows the relationship between objects as described by the Object Browser and online Help files. A map serves as a good learning aid and a quick reference for developers. After producing a map, I found that it was easy to work with the object: I just post the appropriate map on my wall for quick reference, which is a lot faster than clicking objects in a Help file one by one to discover their properties and methods. For an introduction to using OLE Automation, see "Using Microsoft OLE Servers to Develop Solutions."</p>
<p>
Because Figure 2 is unreadable online, I have included the two most common graphics formats—encapsulated PostScript™ (.EPS) and Windows® metafile (.WMF)—as well as a copy of my original Shapeware™ Visio™ version 4.0 file (.VSD). The first two formats can be opened and the maps printed across multiple pages using Microsoft Excel or a commercial graphics application such as Adobe™ PageMaker™, CorelDRAW®, or Microsoft Publisher. The original Visio file is included for those who wish to modify the diagram.</p>
<p>
<img src="mpdao31o_2.gif" border=0></p>
<p class=label>
<b>Figure 2. Map of the Data Access Object 3.1</b></p>
<h3>Outdated Items</h3>
<p>
Outdated items in DAO version 2.5 are not available in this version, for example, <b>CreateDynaset</b>. You must replace these items in your code.</p>
<h3>Object Definitions</h3>
<p>
The objects and collections in Figure 2 are defined in Table 2.</p>
<p class=label>
<b>Table 2. Object and Collection Definitions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Object or Collection</b></td>
<td class=label width=75%><b>Definition</b></td>
</tr>
<tr valign=top>
<td width=25%><b>DBEngine</b> object</td>
<td width=75%>Is the top-level object, representing the data source—the Microsoft Jet database engine or an ODBC data source.&nbsp; Contains and controls all other objects in the hierarchy of data access objects. </td>
</tr>
<tr valign=top>
<td width=25%><b>Workspaces</b> collection</td>
<td width=75%>Contains all <b>Workspace</b> objects of the <b>DBEngine</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Workspace</b> object</td>
<td width=75%>Defines a session in a specific environment, for example, Jet or ODBC. It contains open databases and ODBC connections and provides mechanisms for simultaneous transactions.</td>
</tr>
<tr valign=top>
<td width=25%><b>Databases</b> collection</td>
<td width=75%>Contains all open <b>Database</b> objects opened or created in a <b>Workspace</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Database</b> object</td>
<td width=75%>Represents an open database.</td>
</tr>
<tr valign=top>
<td width=25%><b>Errors</b> collection</td>
<td width=75%>Contains all stored <b>Error</b> objects, each of which pertains to a single operation involving data access objects.</td>
</tr>
<tr valign=top>
<td width=25%><b>Error</b> object</td>
<td width=75%>Contains details about each data access error thrown from a single operation.</td>
</tr>
<tr valign=top>
<td width=25%><b>Connections</b> collection</td>
<td width=75%>Contains all stored <b>Connection</b> objects of a <b>Workspace</b>.</td>
</tr>
<tr valign=top>
<td width=25%><b>Connection</b> object</td>
<td width=75%>Is a network connection to an ODBC direct data source (Microsoft Windows NT™ SQL Server, ORACLE®).</td>
</tr>
<tr valign=top>
<td width=25%><b>QueryDefs</b> collection</td>
<td width=75%>Contains all <b>QueryDef</b> objects in a <b>Connection</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>QueryDef</b> object</td>
<td width=75%>Is a stored definition of a query. Off of a <b>Connection</b> object, this is the prepared statement on the ODBC source.</td>
</tr>
<tr valign=top>
<td width=25%><b>Parameters</b> collection</td>
<td width=75%>Contains all the <b>Parameter</b> objects of a <b>QueryDef</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Parameter</b> object</td>
<td width=75%>Is a parameter associated with a <b>QueryDef</b> object created from a parameter query.</td>
</tr>
<tr valign=top>
<td width=25%><b>Recordsets</b> collection</td>
<td width=75%>Contains all open <b>Recordset</b> objects in a <b>Database</b> object or in a <b>Connection</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Recordset</b> object</td>
<td width=75%>Consists of the records in a base table or the records returned from a query.</td>
</tr>
<tr valign=top>
<td width=25%><b>Properties</b> collection</td>
<td width=75%>Contains all the <b>Property</b> objects for a specific instance of an object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Property</b> object</td>
<td width=75%>Is a built-in characteristic or a user-defined characteristic of a data access object. </td>
</tr>
<tr valign=top>
<td width=25%><b>Fields</b> collection</td>
<td width=75%>Contains all stored <b>Field</b> objects of a <b>Recordset</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>Field</b> object</td>
<td width=75%>Is a column of data with a common data type and a common set of properties.</td>
</tr>
</table><br>
<h2>Bibliography</h2>
<p>
Lassesen, Ken. <a href="msdn_mapdao30.htm">"Mapping the Data Access Object: DAO 3.0."</a> (MSDN Library, Technical Articles)</p>
<p>
Lassesen, Ken. <a href="msdn_ole2soln.htm">"Using Microsoft OLE Servers to Develop Solutions."</a> (MSDN Library, Technical Articles)</p>
</BODY>
</HTML>
