<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Functions</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>
<h1>Functions</h1>
<p>
The tables in this section show the relationship between Oracle and SQL Server functions. Although the names may appear to be the same, it is important to note that functions may vary in numbers and types of arguments.</p>
<h3>Number/Mathematical Functions</h3>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=37%><b>Function</b></td>
<td class=label width=31%><b>Oracle</b></td>
<td class=label width=32%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=37%>Absolute value</td>
<td width=31%>ABS</td>
<td width=32%>ABS</td>
</tr>
<tr valign=top>
<td width=37%>Arc cosine</td>
<td width=31%>ACOS</td>
<td width=32%>ACOS</td>
</tr>
<tr valign=top>
<td width=37%>Arc sine</td>
<td width=31%>ASIN</td>
<td width=32%>ASIN</td>
</tr>
<tr valign=top>
<td width=37%>Arc tangent of n</td>
<td width=31%>ATAN</td>
<td width=32%>ATAN</td>
</tr>
<tr valign=top>
<td width=37%>Arc tangent of n and m</td>
<td width=31%><b>ATAN2</b></td>
<td width=32%><b>ATN2</b></td>
</tr>
<tr valign=top>
<td width=37%>Smallest integer &gt;= value</td>
<td width=31%><b>CEIL</b></td>
<td width=32%><b>CEILING</b></td>
</tr>
<tr valign=top>
<td width=37%>Cosine</td>
<td width=31%>COS</td>
<td width=32%>COS</td>
</tr>
<tr valign=top>
<td width=37%>Hyperbolic cosine</td>
<td width=31%><b>COSH</b></td>
<td width=32%><b>COT</b></td>
</tr>
<tr valign=top>
<td width=37%>Degrees</td>
<td width=31%><b>N/A</b></td>
<td width=32%><b>DEGREES</b></td>
</tr>
<tr valign=top>
<td width=37%>Exponential value</td>
<td width=31%>EXP</td>
<td width=32%>EXP</td>
</tr>
<tr valign=top>
<td width=37%>Largest integer &lt;= value</td>
<td width=31%>FLOOR</td>
<td width=32%>FLOOR</td>
</tr>
<tr valign=top>
<td width=37%>Natural logarithm</td>
<td width=31%><b>LN</b></td>
<td width=32%><b>LOG</b></td>
</tr>
<tr valign=top>
<td width=37%>Logarithm, any base</td>
<td width=31%><b>LOG(N)</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Logarithm, base 10</td>
<td width=31%><b>LOG(10)</b></td>
<td width=32%><b>LOG10</b></td>
</tr>
<tr valign=top>
<td width=37%>Modulus (remainder)</td>
<td width=31%><b>MOD</b></td>
<td width=32%><b>USE MODULO (%) OPERATOR</b></td>
</tr>
<tr valign=top>
<td width=37%>PI</td>
<td width=31%><b>N/A</b></td>
<td width=32%><b>PI</b></td>
</tr>
<tr valign=top>
<td width=37%>Power</td>
<td width=31%>POWER</td>
<td width=32%>POWER</td>
</tr>
<tr valign=top>
<td width=37%>Radians</td>
<td width=31%><b>N/A</b></td>
<td width=32%><b>RADIANS</b></td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=37%><b>Function</b></td>
<td class=label width=31%><b>Oracle</b></td>
<td class=label width=32%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=37%>Random number</td>
<td width=31%><b>N/A</b></td>
<td width=32%><b>RAND</b></td>
</tr>
<tr valign=top>
<td width=37%>Round</td>
<td width=31%>ROUND</td>
<td width=32%>ROUND</td>
</tr>
<tr valign=top>
<td width=37%>Sign of number</td>
<td width=31%>SIGN</td>
<td width=32%>SIGN</td>
</tr>
<tr valign=top>
<td width=37%>Sine</td>
<td width=31%>SIN</td>
<td width=32%>SIN</td>
</tr>
<tr valign=top>
<td width=37%>Hyperbolic sine</td>
<td width=31%><b>SINH</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Square root</td>
<td width=31%>SQRT</td>
<td width=32%>SQRT</td>
</tr>
<tr valign=top>
<td width=37%>Tangent</td>
<td width=31%>TAN</td>
<td width=32%>TAN</td>
</tr>
<tr valign=top>
<td width=37%>Hyperbolic tangent</td>
<td width=31%><b>TANH</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Truncate</td>
<td width=31%><b>TRUNC</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Largest number in list</td>
<td width=31%><b>GREATEST</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Smallest number in list</td>
<td width=31%><b>LEAST</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Convert number if NULL</td>
<td width=31%><b>NVL</b></td>
<td width=32%><b>ISNULL</b></td>
</tr>
</table><br>
<h3>Character Functions</h3>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=37%><b>Function</b></td>
<td class=label width=30%><b>Oracle</b></td>
<td class=label width=33%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=37%>Convert character to ASCII</td>
<td width=30%>ASCII</td>
<td width=33%>ASCII</td>
</tr>
<tr valign=top>
<td width=37%>String concatenate</td>
<td width=30%><b>CONCAT</b></td>
<td width=33%><b>(expression expression)</b></td>
</tr>
<tr valign=top>
<td width=37%>Convert ASCII to character</td>
<td width=30%><b>CHR</b></td>
<td width=33%><b>CHAR</b></td>
</tr>
<tr valign=top>
<td width=37%>Returns starting point of character in character string (from left)</td>
<td width=30%><b>INSTR</b></td>
<td width=33%><b>CHARINDEX</b></td>
</tr>
<tr valign=top>
<td width=37%>Returns starting point of character in character string (from right)</td>
<td width=30%><b>N/A</b></td>
<td width=33%><b>RIGHT</b></td>
</tr>
<tr valign=top>
<td width=37%>String compare and difference</td>
<td width=30%><b>N/A</b></td>
<td width=33%><b>DIFFERENCE</b></td>
</tr>
<tr valign=top>
<td width=37%>Convert characters to lowercase</td>
<td width=30%>LOWER</td>
<td width=33%>LOWER</td>
</tr>
<tr valign=top>
<td width=37%>Convert characters to uppercase</td>
<td width=30%>UPPER</td>
<td width=33%>UPPER</td>
</tr>
<tr valign=top>
<td width=37%>Pad left side of character string</td>
<td width=30%><b>LPAD</b></td>
<td width=33%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Remove leading blanks</td>
<td width=30%>LTRIM</td>
<td width=33%>LTRIM</td>
</tr>
<tr valign=top>
<td width=37%>Remove trailing blanks</td>
<td width=30%>RTRIM</td>
<td width=33%>RTRIM</td>
</tr>
<tr valign=top>
<td width=37%>Starting point of pattern in character string</td>
<td width=30%><b>INSTR</b></td>
<td width=33%><b>PATINDEX</b></td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=37%><b>Function</b></td>
<td class=label width=30%><b>Oracle</b></td>
<td class=label width=33%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=37%>Repeat character string <br>
multiple times</td>
<td width=30%><b>RPAD</b></td>
<td width=33%><b>REPLICATE</b></td>
</tr>
<tr valign=top>
<td width=37%>Reverse character string</td>
<td width=30%><b>N/A</b></td>
<td width=33%><b>REVERSE</b></td>
</tr>
<tr valign=top>
<td width=37%>Phonetic representation of <br>
character string</td>
<td width=30%>SOUNDEX</td>
<td width=33%>SOUNDEX</td>
</tr>
<tr valign=top>
<td width=37%>String of repeated spaces</td>
<td width=30%><b>RPAD</b></td>
<td width=33%><b>SPACE</b></td>
</tr>
<tr valign=top>
<td width=37%>Character data converted from numeric data</td>
<td width=30%><b>TO_CHAR</b></td>
<td width=33%><b>STR</b></td>
</tr>
<tr valign=top>
<td width=37%>Substring</td>
<td width=30%><b>SUBSTR</b></td>
<td width=33%><b>SUBSTRING</b></td>
</tr>
<tr valign=top>
<td width=37%>Replace characters</td>
<td width=30%><b>REPLACE</b></td>
<td width=33%><b>STUFF</b></td>
</tr>
<tr valign=top>
<td width=37%>Capitalize first letter of each word in string</td>
<td width=30%><b>INITCAP</b></td>
<td width=33%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Translate character string</td>
<td width=30%><b>TRANSLATE</b></td>
<td width=33%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Length of character string</td>
<td width=30%><b>LENGTH</b></td>
<td width=33%><b>DATALENGTH</b></td>
</tr>
<tr valign=top>
<td width=37%>Greatest character string in list</td>
<td width=30%><b>GREATEST</b></td>
<td width=33%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Least character string in list</td>
<td width=30%><b>LEAST</b></td>
<td width=33%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=37%>Convert string if NULL</td>
<td width=30%><b>NVL</b></td>
<td width=33%><b>ISNULL</b></td>
</tr>
</table><br>
<h3>Date Functions</h3>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=35%><b>Function</b></td>
<td class=label width=33%><b>Oracle</b></td>
<td class=label width=32%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=35%>Date addition</td>
<td width=33%><b>(date column +/- value) or<br>
ADD_MONTHS</b></td>
<td width=32%><b>DATEADD</b></td>
</tr>
<tr valign=top>
<td width=35%>Difference between dates</td>
<td width=33%><b>(date column +/- value) or<br>
MONTHS_BETWEEN</b></td>
<td width=32%><b>DATEDIFF</b></td>
</tr>
<tr valign=top>
<td width=35%>Current date and time</td>
<td width=33%><b>SYSDATE</b></td>
<td width=32%><b>GETDATE()</b></td>
</tr>
<tr valign=top>
<td width=35%>Last day of month</td>
<td width=33%><b>LAST_DAY</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=35%>Time zone conversion</td>
<td width=33%><b>NEW_TIME</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=35%>First weekday after date</td>
<td width=33%><b>NEXT_DAY</b></td>
<td width=32%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=35%>Character string representation <br>
of date</td>
<td width=33%><b>TO_CHAR</b></td>
<td width=32%><b>DATENAME</b></td>
</tr>
<tr valign=top>
<td width=35%>Integer representation of date</td>
<td width=33%><b>TO_NUMBER(TO_CHAR))</b></td>
<td width=32%><b>DATEPART</b></td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=35%><b>Function</b></td>
<td class=label width=33%><b>Oracle</b></td>
<td class=label width=32%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=35%>Date round</td>
<td width=33%><b>ROUND</b></td>
<td width=32%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=35%>Date truncate</td>
<td width=33%><b>TRUNC</b></td>
<td width=32%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=35%>Character string to date</td>
<td width=33%><b>TO_DATE</b></td>
<td width=32%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=35%>Convert date if NULL</td>
<td width=33%><b>NVL</b></td>
<td width=32%><b>ISNULL</b></td>
</tr>
</table><br>
<h3>Conversion Functions</h3>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Function</b></td>
<td class=label width=32%><b>Oracle</b></td>
<td class=label width=34%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=34%>Number to character</td>
<td width=32%><b>TO_CHAR</b></td>
<td width=34%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=34%>Character to number</td>
<td width=32%><b>TO_NUMBER</b></td>
<td width=34%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=34%>Date to character</td>
<td width=32%><b>TO_CHAR</b></td>
<td width=34%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=34%>Character to date</td>
<td width=32%><b>TO_DATE</b></td>
<td width=34%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=34%>Hex to binary</td>
<td width=32%><b>HEX_TO_RAW</b></td>
<td width=34%><b>CONVERT</b></td>
</tr>
<tr valign=top>
<td width=34%>Binary to hex</td>
<td width=32%><b>RAW_TO_HEX</b></td>
<td width=34%><b>CONVERT</b></td>
</tr>
</table><br>
<h3>Other Row-level Functions</h3>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Function</b></td>
<td class=label width=31%><b>Oracle</b></td>
<td class=label width=35%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=34%>Return first non-null expression</td>
<td width=31%><b>DECODE</b></td>
<td width=35%><b>COALESCE</b></td>
</tr>
<tr valign=top>
<td width=34%>Defined length of column</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>COL_LENGTH</b></td>
</tr>
<tr valign=top>
<td width=34%>Name of column from column ID</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>COL_NAME</b></td>
</tr>
<tr valign=top>
<td width=34%>Database ID from database name</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>DB_ID</b></td>
</tr>
<tr valign=top>
<td width=34%>Database name from database ID</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>DB_NAME</b></td>
</tr>
<tr valign=top>
<td width=34%>Database default nullability</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>GETANSINULL</b></td>
</tr>
<tr valign=top>
<td width=34%>Workstation ID number</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>HOST_ID</b></td>
</tr>
<tr valign=top>
<td width=34%>Workstation name</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>HOST_NAME</b></td>
</tr>
<tr valign=top>
<td width=34%>Identity column increment</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>IDENT_INCR</b></td>
</tr>
<tr valign=top>
<td width=34%>Identity column seed</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>IDENT_SEED</b></td>
</tr>
<tr valign=top>
<td width=34%>Current sequence value</td>
<td width=31%><b>CURRVAL</b></td>
<td width=35%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=34%>Next sequence value</td>
<td width=31%><b>NEXTVAL</b></td>
<td width=35%><b>N/A</b></td>
</tr>
<tr valign=top>
<td class=label width=34%><b>Function</b></td>
<td class=label width=31%><b>Oracle</b></td>
<td class=label width=35%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=34%>Name of index column based <br>
on ID</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>INDEX_COL</b></td>
</tr>
<tr valign=top>
<td width=34%>If exp1 = exp2, return null</td>
<td width=31%><b>DECODE</b></td>
<td width=35%><b>NULLIF</b></td>
</tr>
<tr valign=top>
<td width=34%>Object ID number</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>OBJECT_ID</b></td>
</tr>
<tr valign=top>
<td width=34%>Object name based on object ID</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>OBJECT_NAME</b></td>
</tr>
<tr valign=top>
<td width=34%>Date index stats last updated</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>STATS_DATE</b></td>
</tr>
<tr valign=top>
<td width=34%>User's login ID number</td>
<td width=31%><b>UID</b></td>
<td width=35%><b>SUSER_ID</b></td>
</tr>
<tr valign=top>
<td width=34%>User's login name</td>
<td width=31%><b>USER</b></td>
<td width=35%><b>SUSER_NAME</b></td>
</tr>
<tr valign=top>
<td width=34%>User's database ID number</td>
<td width=31%><b>UID</b></td>
<td width=35%><b>USER_ID</b></td>
</tr>
<tr valign=top>
<td width=34%>User's database name</td>
<td width=31%><b>USER</b></td>
<td width=35%><b>USER_NAME</b></td>
</tr>
<tr valign=top>
<td width=34%>Current user</td>
<td width=31%><b>USER</b></td>
<td width=35%><b>USER</b></td>
</tr>
<tr valign=top>
<td width=34%>User environment (audit trail)</td>
<td width=31%><b>USERENV</b></td>
<td width=35%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=34%>Level in CONNECT BY clause</td>
<td width=31%><b>LEVEL</b></td>
<td width=35%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=34%>Text/image pointer <br>
(binary format)</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>TEXTPTR</b></td>
</tr>
<tr valign=top>
<td width=34%>Validate text/image pointer</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>TEXTVALID</b></td>
</tr>
</table><br>
<h3>Row Aggregate Functions</h3>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Function</b></td>
<td class=label width=31%><b>Oracle</b></td>
<td class=label width=35%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=34%>Average</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>AVG</b></td>
</tr>
<tr valign=top>
<td width=34%>Count</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>COUNT</b></td>
</tr>
<tr valign=top>
<td width=34%>Maximum</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>MAX</b></td>
</tr>
<tr valign=top>
<td width=34%>Minimum</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>MIN</b></td>
</tr>
<tr valign=top>
<td width=34%>Summation</td>
<td width=31%><b>N/A</b></td>
<td width=35%><b>SUM</b></td>
</tr>
</table><br>
<h3>Aggregate Functions</h3>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Function</b></td>
<td class=label width=30%><b>Oracle</b></td>
<td class=label width=36%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=34%>Average</td>
<td width=30%>AVG</td>
<td width=36%>AVG</td>
</tr>
<tr valign=top>
<td width=34%>Count</td>
<td width=30%>COUNT</td>
<td width=36%>COUNT</td>
</tr>
<tr valign=top>
<td width=34%>Maximum</td>
<td width=30%>MAX</td>
<td width=36%>MAX</td>
</tr>
<tr valign=top>
<td width=34%>Minimum</td>
<td width=30%>MIN</td>
<td width=36%>MIN</td>
</tr>
<tr valign=top>
<td width=34%>Standard deviation</td>
<td width=30%><b>STDDEV</b></td>
<td width=36%><b>N/A</b></td>
</tr>
<tr valign=top>
<td width=34%>Summation</td>
<td width=30%>SUM</td>
<td width=36%>SUM</td>
</tr>
<tr valign=top>
<td width=34%>Variance</td>
<td width=30%><b>VARIANCE</b></td>
<td width=36%><b>N/A</b></td>
</tr>
</table><br>
<h3>CASE and DECODE Functions</h3>
<p>
Use the CASE expression to replace the DECODE statement in your application code. The table shows the syntax for each statement.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=47%><b>DECODE</b></td>
<td class=label width=53%><b>CASE</b></td>
</tr>
<tr valign=top>
<td width=47%><b>DECODE</b> (<i>test_value</i>,<br>
  <i>expression1</i>, <i>value1</i><br>
  [[,<i>expression2</i>, <i>value2</i>] […]]<br>
  [,<i>default_value</i>]<br>
)</td>
<td width=53%><b>CASE</b> <i>test_value</i><br>
<b>WHEN</b> <i>expression1</i> <b>THEN</b> <i>value1</i><br>
[[<b>WHEN</b> <i>expression2</i> <b>THEN</b> <i>value2</i>] [...]]<br>
[<b>ELSE</b> <i>default_value</i>]<br>
<b>END</b></td>
</tr>
</table><br>
<p>
Both the DECODE statement and the CASE expression perform conditional tests. When the value in <i>test_value</i> matches any following expression, the related value is returned. If no match is found, the <i>default_value</i> is returned. If no <i>default_value</i> is specified, both DECODE and CASE return NULL if there is no match. The table shows an example of a converted DECODE statement.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=46%><b>Oracle</b></td>
<td class=label width=54%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=46%>CREATE VIEW STUDENT_ADMIN.STUDENT_GPA<br>
(SSN, GPA)<br>
AS SELECT SSN, ROUND(AVG<b>(DECODE(grade<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'A', 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'A+', 4.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'A-', 3.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'B', 3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'B+', 3.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'B-', 2.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'C', 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'C+', 2.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'C-', 1.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'D', 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'D+', 1.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,'D-', 0.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0)</b>),2)<br>
FROM STUDENT_ADMIN.GRADE<br>
GROUP BY SSN</td>
<td width=54%>CREATE VIEW STUDENT_ADMIN.STUDENT_GPA<br>
(SSN, GPA)<br>
AS SELECT SSN, ROUND(AVG<b>(CASE grade<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'A' THEN 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'A+' THEN 4.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'A-' THEN 3.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'B' THEN 3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'B+' THEN 3.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'B-' THEN 2.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'C' THEN 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'C+' THEN 2.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'C-' THEN 1.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'D' THEN 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'D+' THEN 1.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 'D-' THEN 0.7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END</b>),2)<br>
FROM STUDENT_ADMIN.GRADE<br>
GROUP BY SSN</td>
</tr>
</table><br>
<p>
The CASE expression can support the use of SELECT statements for performing Boolean tests, something the DECODE statement does not allow. For more information about the CASE expression, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<h3>CONVERT Function</h3>
<p>
The SQL Server CONVERT function is a multiple purpose conversion function. It converts an expression of one data type to another data type, and it supports a variety of special date formats.</p>
<pre><code>CONVERT (data type[(length)], expression [, style])
</code></pre>
<p>
It performs the same operations as the Oracle TO_CHAR, TO_NUMBER, TO_DATE, HEXTORAW, and RAWTOHEX functions.</p>
<p>
The data type is any system data type into which the expression is to be converted. User-defined data types cannot be used. The <i>length</i> parameter is optional and is used with <b>char</b>, <b>varchar</b>, <b>binary</b>, and <b>varbinary</b> data types. The maximum allowable length is 255. If a length is not specified for these data types, the value of 30 is used.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=22%><b>Conversion</b></td>
<td class=label width=36%><b>Oracle</b></td>
<td class=label width=42%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=22%>Character to number</td>
<td width=36%>TO_NUMBER('10')</td>
<td width=42%>CONVERT(numeric, '10')</td>
</tr>
<tr valign=top>
<td width=22%>Number to character</td>
<td width=36%>TO_CHAR(10)</td>
<td width=42%>CONVERT(char, 10)</td>
</tr>
<tr valign=top>
<td width=22%>Character to date</td>
<td width=36%>TO_DATE('04-JUL-97')<br>
TO_DATE('04-JUL-1997', <br>
'dd-mon-yyyy')<br>
TO_DATE('July 4, 1997', <br>
'Month dd, yyyy')</td>
<td width=42%>CONVERT(datetime, '04-JUL-97')<br>
CONVERT (datetime, '04-JUL-1997')<br>
CONVERT (datetime, 'July 4, 1997')</td>
</tr>
<tr valign=top>
<td width=22%>Date to character</td>
<td width=36%>TO_CHAR(sysdate)<br>
TO_CHAR(sysdate, 'dd mon yyyy')<br>
TO_CHAR(sysdate, 'mm/dd/yyyy')</td>
<td width=42%>CONVERT(char, getdate())<br>
CONVERT(char, getdate(), 106)<br>
CONVERT(char, getdate(), 101)</td>
</tr>
<tr valign=top>
<td width=22%>Hex to binary</td>
<td width=36%>HEXTORAW('1F')</td>
<td width=42%>CONVERT(binary, '1F')</td>
</tr>
<tr valign=top>
<td width=22%>Binary to hex</td>
<td width=36%>RAWTOHEX(binary_column)</td>
<td width=42%>CONVERT(char,binary_column)</td>
</tr>
</table><br>
<p>
Notice how character strings are converted to dates. In Oracle, the default date format model is "DD-MON-YY". If you use any other format, you must provide an appropriate date format model. The CONVERT function automatically converts standard date formats without the need for a format model.</p>
<p>
When converting from a date to a character string, the default output for the CONVERT function is "dd mon yyyy hh:mm:ss:mmm(24h)". A numeric style code is used to format the output to other types of date format models. For more information about CONVERT function, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=21%><b>Without century</b></td>
<td class=label width=19%><b>With century</b></td>
<td class=label width=26%><b>Standard</b></td>
<td class=label width=34%><b>Output</b></td>
</tr>
<tr valign=top>
<td width=21%>-</td>
<td width=19%>0 or 100 (*) </td>
<td width=26%>Default</td>
<td width=34%>mon dd yyyy hh:miAM (or PM)</td>
</tr>
<tr valign=top>
<td width=21%>1</td>
<td width=19%>101</td>
<td width=26%>USA</td>
<td width=34%>mm/dd/yy</td>
</tr>
<tr valign=top>
<td width=21%>2</td>
<td width=19%>102</td>
<td width=26%>ANSI</td>
<td width=34%>yy.mm.dd</td>
</tr>
<tr valign=top>
<td width=21%>3</td>
<td width=19%>103</td>
<td width=26%>British/French</td>
<td width=34%>dd/mm/yy</td>
</tr>
<tr valign=top>
<td width=21%>4</td>
<td width=19%>104</td>
<td width=26%>German</td>
<td width=34%>dd.mm.yy</td>
</tr>
<tr valign=top>
<td width=21%>5</td>
<td width=19%>105</td>
<td width=26%>Italian</td>
<td width=34%>dd-mm-yy</td>
</tr>
<tr valign=top>
<td width=21%>6</td>
<td width=19%>106</td>
<td width=26%>-</td>
<td width=34%>dd mon yy</td>
</tr>
<tr valign=top>
<td width=21%>7</td>
<td width=19%>107</td>
<td width=26%>-</td>
<td width=34%>mon dd, yy</td>
</tr>
<tr valign=top>
<td width=21%>8</td>
<td width=19%>108</td>
<td width=26%>-</td>
<td width=34%>hh:mm:ss</td>
</tr>
<tr valign=top>
<td width=21%>-</td>
<td width=19%>9 or 109 (*) </td>
<td width=26%>Default milliseconds</td>
<td width=34%>mon dd yyyy hh:mi:ss:mmm (AM or PM)</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=21%><b>Without century</b></td>
<td class=label width=19%><b>With century</b></td>
<td class=label width=26%><b>Standard</b></td>
<td class=label width=34%><b>Output</b></td>
</tr>
<tr valign=top>
<td width=21%>10</td>
<td width=19%>110</td>
<td width=26%>USA</td>
<td width=34%>mm-dd-yy</td>
</tr>
<tr valign=top>
<td width=21%>11</td>
<td width=19%>111</td>
<td width=26%>JAPAN</td>
<td width=34%>yy/mm/dd</td>
</tr>
<tr valign=top>
<td width=21%>12</td>
<td width=19%>112</td>
<td width=26%>ISO</td>
<td width=34%>yymmdd</td>
</tr>
<tr valign=top>
<td width=21%>-</td>
<td width=19%>13 or 113 (*) </td>
<td width=26%>Europe default </td>
<td width=34%>dd mon yyyy hh:mm:ss:mmm(24h)</td>
</tr>
<tr valign=top>
<td width=21%>14</td>
<td width=19%>114</td>
<td width=26%>-</td>
<td width=34%>hh:mi:ss:mmm(24h)</td>
</tr>
</table><br>
<h3>User-defined Functions</h3>
<p>
SQL Server does not support the use of user-defined PL/SQL functions that can be called from SQL statements. This functionality can often be achieved in other ways.</p>
<p>
In the following example, the user-defined function <b>get_sum_major</b> is used to obtain a sum of tuition paid by major. It can be replaced by using a query as a table.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=47%><b>Oracle</b></td>
<td class=label width=53%><b>SQL Server</b></td>
</tr>
<tr valign=top>
<td width=47%>SELECT ssn, fname, lname, tuition_paid,<br>
tuition_paid/<b>get_sum_major(major)</b> as&nbsp;&nbsp;&nbsp;&nbsp; percent_major<br>
FROM student_admin.student</td>
<td width=53%>SELECT ssn, fname, lname, tuition_paid, tuition_paid/<b>sum_major</b> as percent_major<br>
FROM student_admin.student,<br>
 &nbsp;&nbsp; (<b>SELECT major, sum(tuition_paid</b>) <b>sum_major<br>
</b> &nbsp; <b> FROM student_admin.student<br>
</b> &nbsp;&nbsp; <b>GROUP BY major) sum_student<br>
WHERE student.major = sum_student.major</b></td>
</tr>
<tr valign=top>
<td width=47%><b>CREATE OR REPLACE FUNCTION get_sum_major<br>
(inmajor varchar2) RETURN NUMBER<br>
AS sum_paid number;<br>
BEGIN<br>
SELECT sum(tuition_paid) into sum_paid<br>
FROM student_admin.student<br>
WHERE major = inmajor;<br>
RETURN(sum_paid);<br>
END get_sum_major;</b></td>
<td width=53%><b>No CREATE FUNCTION syntax is required; <br>
use CREATE PROCEDURE syntax.</b></td>
</tr>
</table><br>
</BODY>
</HTML>
