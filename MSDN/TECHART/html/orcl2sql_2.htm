<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Database Examples</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>
<h1>Database Examples</h1>
<p>
A sample university DBMS application has been created to support the sample program applications and code referenced throughout this paper. This application was specifically created to illustrate many of the points, issues, and tricks involved in converting an Oracle 7 application to a SQL Server application.</p>
<h3>Sample University Application</h3>
<p>
This sample application uses four tables to track all university activity. The <b>DEPT </b>table is used to track department offerings within the university. The <b>CLASS</b> table is used to track class offerings within each department. The <b>STUDENT</b> table is used to track each student within the university. The <b>GRADE</b> table is used to track the enrollments of each student within each class.</p>
<p>
<img src="orcl2sql_3.gif" border=0></p>
<p>
In this sample application, social security number (<b>SSN</b>) is used as the primary key for the <b>STUDENT</b> table. The <b>DEPT</b> table uses department code (<b>DEPT</b>) as the primary key, and course code (<b>CCODE</b>) is used as the primary key for the <b>CLASS</b> table. The combination of social security number (<b>SSN</b>) and course code (<b>CCODE</b>) together makes up the primary key for the <b>GRADE</b> table.</p>
<p>
The column <b>major</b> is defined as a foreign key in the <b>STUDENT</b> table. When selecting a major, the student must choose a valid department code (<b>DEPT</b>) from the <b>DEPT</b> table. The department (<b>DEPT</b>) column in the <b>CLASS</b> table is also defined as a foreign key. When a course is inserted in this table, it must also be associated with a valid department (<b>DEPT</b>) from the <b>DEPT</b> table.</p>
<p>
The <b>GRADE</b> table has two foreign keys. When enrolling a student in a class, the social security number (<b>SSN</b>) must exist in the <b>STUDENT</b> table, and the course code (<b>CCODE</b>) must exist in the <b>CLASS</b> table. This ensures that students are not enrolled in nonexistent classes, and that classes are not filled with nonexistent students.</p>
<h3>Sample Application and Code References</h3>
<p>
The following sample application code is referenced throughout this paper. </p>
<p class=dt>
Orademo.cpp</p>
<p class=indent>
Oracle ODBC application that accesses the sample university tables on an Oracle 7 database. This program is the starting point for the conversion process. It allows users to perform data entry and produce reports against the sample university application.</p>
<p class=dt>
Ssdemo.cpp</p>
<p class=indent>
SQL Server ODBC application that accesses SQL Server. This program is the ending point for the conversion process. All of the Oracle SQL commands, procedures, packages, and functions have been converted to SQL Server SQL statements and procedures. Many of the advantages associated with SQL Server are demonstrated in this program.</p>
<p class=dt>
Common.cpp</p>
<p class=indent>
ODBC application that works with both the Oracle and SQL Server DBMS's. In order to connect to Oracle or SQL Server, the user simply provides the ODBC Data Source Name (DSN). The program then logs on to the requested database. The program contains excellent examples of programming techniques that can be used when developing a multidatabase program.</p>
<p class=dt>
Orauser.sql</p>
<p class=indent>
Creates the Oracle user accounts and database roles required for the sample Oracle program.</p>
<p class=dt>
Oratable.sql</p>
<p class=indent>
Creates the Oracle tables and views required for the sample Oracle program.</p>
<p class=dt>
Oraproc.sql</p>
<p class=indent>
Creates the Oracle stored procedure, functions, and packages required for the sample Oracle program.</p>
<p class=dt>
Oracommn.sql</p>
<p class=indent>
Creates all of the additional Oracle database objects that are required to support the Common.cpp program.</p>
<p class=dt>
Oradata.sql</p>
<p class=indent>
Loads sample application data into the tables required for the sample Oracle program.</p>
<p class=dt>
Ssuser.sql</p>
<p class=indent>
Creates the SQL Server user accounts and database groups required for the sample SQL Server program.</p>
<p class=dt>
Sstable.sql</p>
<p class=indent>
Creates the SQL Server tables and views required for the sample SQL Server program.</p>
<p class=dt>
Ssproc.sql</p>
<p class=indent>
Creates the stored procedures required for the sample SQL Server program.</p>
<p class=dt>
Sscommon.sql</p>
<p class=indent>
Creates all of the additional SQL Server database objects that are required to support the Common.cpp application.</p>
<p class=dt>
Ssdata.sql</p>
<p class=indent>
Loads sample application data into the tables required for the sample SQL Server program.</p>
<h3>Running the Supplied Scripts</h3>
<p>
The sample scripts must be run in the following sequence to create the sample applications on the target DBMS platforms.</p>
<p>
<img src="orcl2sql_4.gif" border=0></p>
<p>
Prior to running these scripts for the SQL Server 6.5 database, you must create an application database (named USER_DB) for these scripts and the sample SQL Server program to work. This database can be created using SQL Enterprise Manager. After the database has been created, log on to ISQL/w using the SA account and run these scripts in the indicated order.</p>
<p>
<img src="orcl2sql_5.gif" border=0></p>
<p>
Prior to running these scripts for the Oracle 7.3 database, the sample scripts assume that the USER_DATA and TEMPORARY_DATA tablespaces exist. They are usually created during a default Oracle 7.3 database installation. If these tablespaces do not exist, you must either add them or modify the supplied sample scripts to use other tablespaces.</p>
<p>
<img src="orcl2sql_6.gif" border=0></p>
<p>
After verifying that these tablespaces exist, log on to SQL*Plus using the SYSTEM account. If the password is not the default value of MANAGER, you must change the password in the Oracle SQL scripts.</p>
<h3>DBMS User Accounts</h3>
<p class=indent>
Three user accounts are created for this application:
<ul type=disc>
<li>
<b>STUDENT_ADMIN</b></li>
</ul>
<p class=indent>
This account is the administrative owner of the <b>STUDENT</b> and <b>GRADE</b> tables.
<ul type=disc>
<li>
<b>DEPT_ADMIN</b></li>
</ul>
<p class=indent>
This account is the administrative owner of the <b>DEPT</b> and <b>CLASS</b> tables.
<ul type=disc>
<li>
<b>ENDUSER1</b></li>
</ul>
<p class=indent>
This account is a query only account that can access the <b>STUDENT</b>, <b>GRADE</b>, <b>DEPT</b>, and <b>CLASS</b> tables.</p>
</BODY>
</HTML>
