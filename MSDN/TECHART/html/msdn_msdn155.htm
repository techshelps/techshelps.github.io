<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 155: Scrolling Text Horizontally in a Picture Box Control</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn155"></a></sup>Tip 155: Scrolling Text Horizontally in a Picture Box Control</h1>
<p>
September 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to scroll text horizontally within a <b>Picture Box</b> control in Microsoft® Visual Basic®.</p>
<h2>Creating a Scrolling Marquee Effect in Visual Basic</h2>
<p>
You can add visual effects to your Microsoft® Visual Basic® applications that add interest or grab the user's attention. You can do this, for example, by adding a scrolling message to your program to create a marquee effect.</p>
<p>
A scrolling message is a string of text that is continually displayed in a control. To achieve this effect in your program, you can use the <b>Timer</b> and <b>Picture Box</b> controls.</p>
<p>
The <b>Print</b> function lets you display a character in a <b>Picture Box</b> control. The character is printed at the current x- and y-coordinates within the control. Therefore, to display an entire string in the <b>Picture Box</b>, you first need to extract each character from the target string you want to display. Then you can use the <b>Print</b> function to display that character in the <b>Picture Box</b> control.</p>
<p>
To make the text in the <b>Picture Box</b> scroll continuously, you simply keep track of your position within the target string. When you reach the end of the string, set the pointer to the beginning of the string. Using the <b>Timer</b> control, you can send (that is, print) a character to the <b>Picture Box</b> at specific time intervals. This causes the message to print continuously in the <b>Picture Box</b> control.</p>
<h2>Example Program</h2>
<p>
This program shows how to scroll text horizontally in a <b>Picture Box</b> control.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Picture Box</b> control to Form1. Picture1 is created by default.<br><br></li>
<li>
Add a <b>Timer</b> control to Form1. Timer1 is created by default. Set its <b>Interval</b> property to 250.<br><br></li>
<li>
Add the following code to the Timer1_Event:<pre><code>Private Sub Timer1_Timer()
 &nbsp;&nbsp; ShowMessage
End Sub
</code></pre>
</li>
<li>
Create a new function called <b>ShowMessage()</b>. Add the following code to this function:<pre><code>Sub ShowMessage()
 &nbsp;&nbsp; Static MsgPtr As Integer
 &nbsp;&nbsp; Static MyText As String
 &nbsp;&nbsp; If Len(MyText) = 0 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgPtr = 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyText = "Welcome to Visual Basic programming!"
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; Picture1.Cls
 &nbsp;&nbsp; Picture1.Print Mid$(MyText, MsgPtr); MyText;
 &nbsp;&nbsp; MsgPtr = MsgPtr + 1
 &nbsp;&nbsp; If MsgPtr &gt; Len(MyText) Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgPtr = 1
 &nbsp;&nbsp; End If
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing f5. The "Welcome to Visual Basic programming!" message will scroll across the <b>Picture Box</b> control continuously until you quit the program.</p>
</BODY>
</HTML>
