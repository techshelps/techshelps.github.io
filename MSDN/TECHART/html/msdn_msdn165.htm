<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 165: Locating CD-ROM Drives Installed on a Computer System</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn165"></a></sup>Tip 165: Locating CD-ROM Drives Installed on a Computer System</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
In a Microsoft® Visual Basic® application, you may need to determine what types of disk drives are installed on a computer system. This article explains how to locate the CD-ROM drives that are installed.</p>
<h2>Using the GetDriveType Function</h2>
<p>
Occasionally, in a Microsoft® Visual Basic® application you may need to determine whether a specific disk drive is a CD-ROM, removable, fixed, RAM, or network drive. You can easily make this distinction by using the Microsoft Windows® application programming interface (API) <b>GetDriveType</b> function.</p>
<p>
The following <b>Declare</b> statement should be included in your project:</p>
<pre><code>Private Declare Function GetDriveType Lib "kernel32" Alias "GetDriveTypeA" 
 &nbsp; (ByVal nDrive As String) As Long
</code></pre>
<p>
To use the <b>GetDriveType</b> function, you need to tell it the name of the disk's root directory. This should be in the format "c:\". After you call it, the <b>GetDriveType</b> function returns a value that indicates the type of disk drive.</p>
<p>
The value returned by the <b>GetDriveType</b> function may be one of the following:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=42%><b>Value</b></td>
<td class=label width=58%><b>Drive Type</b></td>
</tr>
<tr valign=top>
<td width=42%>0</td>
<td width=58%>Unknown media type</td>
</tr>
<tr valign=top>
<td width=42%>1</td>
<td width=58%>No such root directory exists</td>
</tr>
<tr valign=top>
<td width=42%>DRIVE_REMOVABLE</td>
<td width=58%>Drive can be removed</td>
</tr>
<tr valign=top>
<td width=42%>DRIVE_FIXED</td>
<td width=58%>Drive cannot be removed</td>
</tr>
<tr valign=top>
<td width=42%>DRIVE_REMOTE</td>
<td width=58%>Network disk drive</td>
</tr>
<tr valign=top>
<td width=42%>DRIVE_CDROM</td>
<td width=58%>CD-ROM disk drive</td>
</tr>
<tr valign=top>
<td width=42%>DRIVE_RAMDISK</td>
<td width=58%>RAM disk drive</td>
</tr>
</table><br>
<p>
As you know, all disk drives are identified by an alphabetic letter, starting with the letter <i>A</i>. The ASCII value for the letter <i>A</i> is 65. Because there are 26 possible disk drives, you can use a For-Next loop to test each possible disk drive to determine whether it is a CD-ROM disk drive.</p>
<h2>Example Program</h2>
<p>
This program shows how to locate all CD-ROM disk drives installed on the computer system.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following <b>Declare</b> statement to the General Declarations section of Form1 (note that the <b>Declare</b> statement must be typed as a single line of code):<pre><code>Private Declare Function GetDriveType Lib "kernel32" Alias "GetDriveTypeA" 
 &nbsp; (ByVal nDrive As String) As Long
</code></pre>
</li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Text1.Text = FindCDROM
End Sub
</code></pre>
</li>
<li>
Add a <b>Text Box</b> control to form1. Text1 is created by default. Set its <b>MultiLine</b> property to True.<br><br></li>
<li>
Create a new function called <b>FindCDROM</b>. Add the following code to this function:<pre><code>Function FindCDROM() As String
 &nbsp;&nbsp; Dim Drive As Integer
 &nbsp;&nbsp; Const DRIVE_CDROM = 5
 &nbsp;&nbsp; FindCDROM = "No CD_ROM Installed"

 &nbsp;&nbsp; For Drive = 65 To 90
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If GetDriveType(Chr(Drive) &amp; ":\") = DRIVE_CDROM Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FindCDROM = "CD-ROM Drive " &amp; Chr(Drive) &amp; ":\"
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit For
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp; Next Drive
End Function
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the <b>Command Button</b> control. A list of all CD-ROM disk drives installed on the computer system appears in the <b>Text Box</b> control.</p>
</BODY>
</HTML>
