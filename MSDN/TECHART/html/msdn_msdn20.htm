<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 20: Detecting When Shift+PrintScrn Is Pressed</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn20"></a></sup>Tip 20: Detecting When Shift+PrintScrn Is Pressed</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
In a Visual Basic® application, you may want to disable the shift+printscrn keystroke combination. This can be accomplished by trapping the key in a control or form's KeyDown event.</p>
<h2>Trapping the SHIFT+PRINTSCRN Keystroke Combination</h2>
<p>
You can trap any key on the keyboard in any form or control. The <b>KeyPreview</b> property of a form, when set to TRUE, forces all keystrokes to the form, not to the control. In this way, the form can be the first object to capture the incoming keystrokes. When the <b>KeyPreview</b> property of a form is set to FALSE, each control must be programmed individually to trap the keystrokes.</p>
<p>
To determine when a specific key has been pressed or released on the keyboard, use the KeyDown and KeyUp events, respectively. Both events will be triggered by a keypress or keyrelease for the control that has the current focus. If a form does not have any controls on it, or if the form's <b>KeyPreview</b> property is set to True, the KeyDown and KeyUp events will trap the keystroke at the form level.</p>
<p>
The KeyDown and KeyUp events return two variables: the keycode and the shift key status. The keycode is a unique number that is assigned to each key on the keyboard. The CONSTANT.TXT file contains a list of all keycodes supported by Visual Basic®. The shift variable tells you which shift key (shift, alt, or ctrl) was pressed.</p>
<p>
In a Visual Basic program, you can determine if shift+printscrn was pressed by executing this statement in the KeyDown event:</p>
<pre><code>If KeyDown = 16 And Shift=1 Then ....
</code></pre>
<h2>Example Program</h2>
<p>
The following program displays a Text Box on the screen. When you press shift+printscrn, the program displays a message to that effect in the text box. If you press the shift+f2 function key combination, the message tells you that that keystroke was pressed.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a Text Box to Form1. Text1 is created by default.<br><br></li>
<li>
Set the <b>KeyPreview</b> property for Form1 to TRUE.<br><br></li>
<li>
Add the following code to the KeyDown event for Form1:<pre><code>Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
 &nbsp;&nbsp; If KeyCode = 16 And Shift = 1 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Text1.Text = "Shift-PrintScreen pressed"
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; If KeyCode = 113 And Shift = 1 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Text1.Text = "Shift-F2 pressed"
 &nbsp;&nbsp; End If&nbsp;&nbsp;&nbsp; 
End Sub
</code></pre>
</li>
</ol>
</BODY>
</HTML>
