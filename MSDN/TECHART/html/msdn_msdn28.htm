<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 28: Determining Which Forms Are Loaded</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn28"></a></sup>Tip 28: Determining Which Forms Are Loaded</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
A program created in Visual Basic® may contain many different forms. Forms can be loaded into memory whenever they are required and removed from memory when no longer needed. Sometimes you need to find out if a specific form is currently loaded. This article provides a technique for determining if a form is loaded or not.</p>
<h2>Which Form Is Loaded?</h2>
<p>
Depending on the application you are developing, you can selectively display a Visual Basic® form on the computer screen at any time. To do this, you use the <b>Load</b> statement:</p>
<pre><code>Load Form2
</code></pre>
<p>
You can also remove a form from the program by using the <b>Unload</b> statement:</p>
<pre><code>Unload Form2
</code></pre>
<p>
It is important to realize that you can only load a form once—two copies of the same form cannot be in memory at the same time.</p>
<p>
Because a Visual Basic application may consist of many different forms, you need a method of determining which form or forms are currently loaded. The <b>Count</b> property can be used to find out how many forms are actually loaded into memory at any given time. The statement:</p>
<pre><code>X = Forms.Count
</code></pre>
<p>
sets the variable X equal to the number of forms in this application. Once you know this count value, its easy to develop a function to search through the index of forms in memory and find out if a specific form is loaded.</p>
<h2>Example Program</h2>
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default. Set its <b>Caption</b> property to "First Form".<br><br></li>
<li>
Create a second form. Form2 is created by default. Set its <b>Caption</b> property to "Second Form".<br><br></li>
<li>
Create a third form. Form3 is created by default. Set its <b>Caption</b> property to "Third Form".<br><br></li>
<li>
Add a Text Box control to Form1. Text1 is created by default.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Sub Form_Load()
 &nbsp;&nbsp; Dim F As Integer
 &nbsp;&nbsp; Load Form2
 &nbsp;&nbsp; F = IsLoaded(Form2)
 &nbsp;&nbsp; Text1.Text = "Form" + Str$(F)
End Sub
</code></pre>
</li>
<li>
Create a new function called <b>IsLoaded</b>:<pre><code>Function IsLoaded(F_Form As Form) As Integer
 &nbsp;&nbsp; Dim X As Integer&nbsp; 
 &nbsp;&nbsp; For X = 0 To Forms.Count
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Forms(X) Is F_Form Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsLoaded = X + 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Function
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp; Next X
 &nbsp;&nbsp; IsLoaded = 0
End Function
</code></pre>
</li>
</ol>
<p>
Execute this demonstration program by pressing the F5 function key. The first form is displayed with a text box. The string "Form 2" should be displayed in the Text Box. The <b>IsLoaded</b> function was passed the index number of the form to be checked. If that form was indeed loaded into memory, the text box will display the form's number. You can change the example program to display the third form's status by changing the "Load Form2" statement to "Load Form3" and the "F=IsLoaded(Form2)" statement to "F=IsLoaded(Form3)" to see if the third form is reported as being loaded.</p>
</BODY>
</HTML>
