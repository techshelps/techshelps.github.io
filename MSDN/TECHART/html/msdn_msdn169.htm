<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 169: Setting the Position and Size of the Windows Help File</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn169"></a></sup>Tip 169: Setting the Position and Size of the Windows Help File</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to set Microsoft® Windows® Help files (or the Help files of any other application) to a specific position on the screen and to a specific size.</p>
<h2>Using the WinHelp Function to Position and Size Help Files</h2>
<p>
Designing a Help file for your Microsoft® Visual Basic® application is necessary if your program is either complicated or fairly large. After you have created your Help file, you can easily use the Microsoft Windows® application programming interface (API) <b>WinHelp</b> function to display your application's Help file in the exact position and in the exact size you want.</p>
<p>
The <b>WinHelp</b> function runs the Windows Help application. This program lets you specify the Help file you want to display to your user. The <b>Declaration</b> statement for the <b>WinHelp</b> function is:</p>
<pre><code>Declare Function WinHelp Lib "user32" Alias "WinHelpA" (ByVal hwnd As Long, 
 &nbsp; ByVal lpHelpFile As String, ByVal wCommand As Long, dwData As Any) As Long
</code></pre>
<p>
The <b>WinHelp</b> function requires four arguments, as follows:</p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows>
<tr valign=top>
<td width=15%><i>hWnd</i></td>
<td colspan=2 width=83%>A long value containing the window's handle.</td>
</tr>
<tr valign=top>
<td width=15%><i>LpHelpFile</i></td>
<td colspan=2 width=83%>A string containing the full path of the Help file to display.</td>
</tr>
<tr valign=top>
<td width=15%><i>Wcommand</i></td>
<td colspan=2 width=83%>A long value that specifies the type of Help to display. This can be one of the following values:</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_COMMAND</td>
<td colspan=2 width=57%>Runs a Help macro or macro string. The <i>dwData</i> argument is a string containing the name of this macro.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>*HELP_CONTENTS</td>
<td colspan=2 width=57%>Displays the topic specified by the Contents option in the [OPTIONS] section of the Help file.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_CONTEXT</td>
<td colspan=2 width=57%>Displays the topic identified by the context identifier defined in the [MAP] section of the Help file. The <i>dwData</i> argument contains the context identifier in a long unsigned integer.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_CONTEXTPOPUP</td>
<td colspan=2 width=57%>Same as HELP_CONTEXT except that the Help file appears in a pop-up window.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_FORCEFILE</td>
<td colspan=2 width=57%>Ensures that Windows displays the correct Help file. The <i>dwData</i> argument must be set to zero.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_HELPONHELP</td>
<td colspan=2 width=57%>Displays the WINHELP.HLP file. This file explains how to use the Windows Help system. The <i>dwData</i> argument must be set to zero.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>*HELP_INDEX</td>
<td colspan=2 width=57%>Displays the index in the Help Topics dialog box. The <i>dwData</i> argument must be set to zero.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_KEY</td>
<td colspan=2 width=57%>Displays the topic in the keyword table that matches the specified keyword. The <i>dwData</i> argument contains the address of a keyword string.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_MULTIKEY</td>
<td colspan=2 width=57%>Displays the topic in the alternative keyword table that matches the specified keyword. The <i>dwData</i> argument points to a <b>MULTIKEYHELP</b> structure. This structure specifies a keyword and a table footnote character.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_PARTIALKEY</td>
<td colspan=2 width=57%>Displays the topic in the keyword table that most closely matches the specified keyword. The index tab appears if more than one match is found. The index can be displayed by using a pointer to an empty string. The <i>dwData</i> argument must contain the address of a keyword string.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_QUIT</td>
<td colspan=2 width=57%>Closes the Windows Help application, providing that no other applications need it. The <i>dwData</i> argument must be set to zero.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_SETCONTENTS</td>
<td colspan=2 width=57%>Displays the Contents topic, which is selected when the user clicks the Contents button. The <i>dwData</i> argument contains the context identifier for the Contents topic in an unsigned long integer.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_SETINDEX</td>
<td colspan=2 width=57%>Displays the specified keyword table in the Index of the Help Topics dialog box. The <i>dwData</i> argument contains the context identifier for the Index topic in an unsigned long integer.</td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=27%>HELP_SETWINPOS</td>
<td colspan=2 width=57%>Displays the Help window. The <i>dwData</i> argument contains the address of a HELPWININFO structure that specifies the Help window's size and position.</td>
</tr>
<tr valign=top>
<td width=15%><i>DwData</i></td>
<td colspan=4 width=85%>Set according to the <i>wCommand</i> argument.</td>
</tr>
</table><br>
<p class=indent>
*<b>Note:</b> New applications should use the <b>HELP_FINDER</b> value instead of this value. This older command is provided for downward compatibility only.</p>
<p>
In the list of options for the <i>wCommand</i> argument above, you can see that calling the <b>WinHelp</b> function with the <b>HELP_SETWINPOS</b> value allows you to set the size and position of your own Help window.</p>
<p>
The <b>HELP_SETWINPOS</b> value displays a Windows Help file window, providing it is loaded in memory and/or minimized. The exact position and size of the window is specified in the <b>HELPWININFO</b> structure.</p>
<p>
The <b>HELPWININFO</b> structure contains seven fields, as follows:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%><i>wStructSize</i></td>
<td width=83%>A long value containing the size of the HELPWININFO structure, specified in bytes.</td>
</tr>
<tr valign=top>
<td width=17%><i>X</i></td>
<td width=83%>A long value containing the X-coordinate of the upper-left corner of the window, specified in screen coordinates.</td>
</tr>
<tr valign=top>
<td width=17%><i>Y</i></td>
<td width=83%>A long value containing the Y-coordinate of the upper-left corner of the window, specified in screen coordinates.</td>
</tr>
<tr valign=top>
<td width=17%><i>Dx</i></td>
<td width=83%>A long value containing the width of the window, specified in pixels.</td>
</tr>
<tr valign=top>
<td width=17%><i>dy</i></td>
<td width=83%>A long value containing the length of the window, specified in pixels.</td>
</tr>
<tr valign=top>
<td width=17%><i>wMax</i></td>
<td width=83%>A long value that specifies how the window is to be displayed. (See the explanation for the <i>nShowCmd</i> argument in Tip #22 for these values.)</td>
</tr>
<tr valign=top>
<td width=17%><i>rgchMember</i></td>
<td width=83%>A string containing the name of the window.</td>
</tr>
</table><br>
<p>
To show a Help window in a specific size, the <b>dx</b> and <b>dy</b> fields of the <b>HELPWININFO</b> structure need to be defined. In the example program below, you set the values of these two fields to 620 pixels each.</p>
<p>
Likewise, you set the position of the Help window in the example program by setting the <b><i>X</i></b> and <b><i>Y</i></b> fields of the <b>HELPWININFO</b> structure to 400 each.</p>
<p>
Each time the program displays the Help window, the window appears at this new position and in this new size.</p>
<h2>Example Program</h2>
<p>
This program shows how to position the Windows Help file (or any other Help file) to a specific location on the screen and in a specific size.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Private Sub Form_Click()
 &nbsp;&nbsp; Dim Temp As Long
 &nbsp;&nbsp; hwf.wStructSize = Len(hwf)
 &nbsp;&nbsp; hwf.x = 400
 &nbsp;&nbsp; hwf.y = 400
 &nbsp;&nbsp; hwf.dx = 620
 &nbsp;&nbsp; hwf.dy = 620
 &nbsp;&nbsp; hwf.wMax = 1
 &nbsp;&nbsp; Temp = WinHelp(Form1.hwnd, "c:\windows\winhelp.hlp", HELP_SETWINPOS, hwf)

End Sub
</code></pre>
</li>
<li>
From the Visual Basic Insert menu, select Module to create a new module. Module1.Bas is created by default.<br><br></li>
<li>
Add the following <b>Constant</b>, <b>Type</b>, and <b>Declare</b> statements to Module1.Bas (note that the <b>Declare</b> statement must be typed as a single line of code):<pre><code>Declare Function WinHelp Lib "user32" Alias "WinHelpA" (ByVal hwnd As Long, 
 &nbsp; ByVal lpHelpFile As String, ByVal wCommand As Long, dwData As Any) As Long
 &nbsp; Type HELPWININFO
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wStructSize As Long
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x As Long
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y As Long
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dx As Long
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dy As Long
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wMax As Long
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rgchMember As String * 2
End Type
Global Const HELP_SETWINPOS = &amp;H203&amp;
Global hwf As HELPWININFO
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing f5. Form1 appears on the screen. Click the mouse anywhere on the form to display the Help file for Windows. Notice that the window is positioned in the lower-right corner of the screen and that the window's size has been set to 620 x 620 pixels.</p>
</BODY>
</HTML>
