<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 104: Creating a Form with a Thin Title Bar</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn104"></a></sup>Tip 104: Creating a Form with a Thin Title Bar</h1>
<p>
June 5, 1995</p>
<h2>Abstract</h2>
<p>
Many Microsoft® Windows®-based applications include a <b>Toolbox</b> control. A toolbox is a group of icons that the user can click to perform various operations within a running application. These toolbox windows usually display a very small, thin title bar instead of the normal-sized title bar. This article explains how you can create forms with thin title bars in your Visual Basic® applications.</p>
<h2>Using SendMessage and GetCursorPos to Create Title Bars</h2>
<p>
You can design a form that contains a thin title bar. This is most often used in <b>Toolbox</b> controls from which the user can click on an icon to perform a&nbsp; program operation.</p>
<p>
In the example program below, we use a <b>Label</b> control, sized to fit at the top of our form. This control, which will become the thin title bar, responds to both the Click and MouseDown events. These two events allow the user to click on the <b>Label</b> control (that is, the thin title bar) and drag the entire form to a new location on the screen. This gives our Microsoft® Visual Basic® application the same functionality as a toolbox window.</p>
<p>
To enable our user to drag the form to a new location on the screen, we need to determine the cursor's current X and Y coordinates on the screen. You can use the Microsoft® Windows® application programming interface (API) <b>GetCursorPos</b> function to retrieve the cursor's current location.</p>
<p>
To call the <b>GetCursorPos</b> function, you must first add its <b>Declare</b> statement to the General Declarations section of your Visual Basic application. Following is the declaration for the <b>GetCursorPos</b> function:</p>
<pre><code>Private Declare Sub GetCursorPos Lib "User" (lpPoint As POINTAPI)
</code></pre>
<p>
The <b>GetCursorPos</b> function requires only one argument—a <b>POINTAPI</b> structure. This structure will hold the cursor's current position, which is reported in screen coordinate values.</p>
<p>
The cursor's horizontal position is stored in the X variable; the cursor's vertical position is stored in the Y variable within the <b>POINTAPI</b> structure:</p>
<pre><code>Type POINTAPI
 &nbsp;&nbsp; X As Integer
 &nbsp;&nbsp; Y As Integer
End Type
</code></pre>
<p>
After the cursor's position has been retrieved, we issue the <b>LSet</b> statement to convert the X and Y values to values that can be understood by the <b>SendMessage</b> function. In other words, <b>LSet</b> converts the X and Y integers to a single long value.</p>
<p>
Next, we issue two <b>SendMessage</b> commands to Windows. The first <b>SendMessage</b> statement tells Windows that, because a MouseDown event has just occurred, it needs an equivalent MouseUp event. The second <b>SendMessage</b> statement tells Windows that the user has clicked the title bar. Windows then processes our thin title bar's Click and MouseDown events as it would for a normal window.</p>
<h2>Example Program</h2>
<p>
This program shows how to create a form with a small title bar.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Set the following properties for Form1:</li>
</ol>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=24%>ClipControls</td>
<td width=76%>0&nbsp; 'False</td>
</tr>
<tr valign=top>
<td width=24%>ControlBox</td>
<td width=76%>0&nbsp; 'False</td>
</tr>
<tr valign=top>
<td width=24%>MaxButton</td>
<td width=76%>0&nbsp; 'False</td>
</tr>
<tr valign=top>
<td width=24%>MinButton</td>
<td width=76%>0&nbsp; 'False</td>
</tr>
</table><br>
<ol start=3>
<li>
Add the following <b>Constant</b> and <b>Declare</b> statements to the General Declarations section of Form1 (note that the <b>Declare</b> statements must be typed as single lines of text):<pre><code>Private Declare Function SendMessage Lib "User" (ByVal hWnd As Integer, ByVal
 &nbsp; wMsg As Integer, ByVal wParam As Integer, ByVal lParam As Any) As Long
Private Declare Sub GetCursorPos Lib "User" (lpPoint As POINTAPI)
Const WM_LBUTTONUP = &amp;H202
Const WM_SYSCOMMAND = &amp;H112
Const MOUSE_MOVE = &amp;HF012
</code></pre>
</li>
<li>
Add a <b>Label</b> control to Form1. Label1 is created by default. Set its <b>Caption</b> property to "Thin Title Bar".<p class=tl>
<b>Note:</b> For this example program, change the size of Form1 so that it resembles the size and shape of a Toolbox window. Next, position the <b>Label</b> control at the top of the form and adjust its size so that it isthe same size as a thin title bar.</P></li>
<li>
Add the following code to the Click event for Label1:<pre><code>Private Sub Label1_Click()
 &nbsp;&nbsp; Dim mpos As POINTAPI
 &nbsp;&nbsp; Dim P As ConvertPOINTAPI
 &nbsp;&nbsp; Dim Ret As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Call GetCursorPos(mpos)
 &nbsp;&nbsp; LSet P = mpos
 &nbsp;&nbsp; Ret = SendMessage(Me.hWnd, WM_LBUTTONUP, 0, P.XY)
 &nbsp;&nbsp; Ret = SendMessage(Me.hWnd, WM_SYSCOMMAND, MOUSE_MOVE, P.XY)
 &nbsp;&nbsp; 
End Sub
</code></pre>
</li>
<li>
Add the following code to the MouseDown event for Label1 (note that the first two lines must be typed as a single line of code):<pre><code>Private Sub Label1_MouseDown(Button As Integer, Shift As Integer,
 X As Single, Y As Single)
 &nbsp;&nbsp; Dim mpos As POINTAPI
 &nbsp;&nbsp; Dim P As ConvertPOINTAPI
 &nbsp;&nbsp; Dim Ret As Integer
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Call GetCursorPos(mpos)
 &nbsp;&nbsp; LSet P = mpos
 &nbsp;&nbsp; Ret = SendMessage(Me.hWnd, WM_LBUTTONUP, 0, P.XY)
 &nbsp;&nbsp; Ret = SendMessage(Me.hWnd, WM_SYSCOMMAND, MOUSE_MOVE, P.XY)
End Sub
</code></pre>
</li>
<li>
From the Insert menu, select Module. Module1.Bas is created by default.<br><br></li>
<li>
Add the following type declarations to Module1.Bas:<pre><code>Type POINTAPI
 &nbsp;&nbsp; X As Integer
 &nbsp;&nbsp; Y As Integer
End Type
Type ConvertPOINTAPI
 &nbsp;&nbsp; XY As Long
End Type
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Form1 should be displayed on the screen with the thin title bar appearing at the top of the form. You can drag the form by clicking on the title bar, just as you would do with any other window that has a title bar.</p>
<h2>Additional References</h2>
<p>
Knowledge Base Q83349. "How to Create a Form with No Title Bar in VB for Windows."</p>
<p>
Knowledge Base Q71280. "How to Create a Flashing Title Bar on a Visual Basic Form."</p>
</BODY>
</HTML>
