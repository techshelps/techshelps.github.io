<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 23: Converting Fractional Values to Two-Decimal-Place Currency Values</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn23"></a></sup>Tip 23: Converting Fractional Values to Two-Decimal-Place Currency Values</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
Visual Basic® offers many functions that can convert values from one type to another. One of these functions is <b>CCur</b>. This function will take a string variable containing a value with four digits after the decimal place and convert the fractional portion of the value to the next highest (rounded) two-digit decimal value.</p>
<h2>Rounding Fractional Values to Two Decimal Places</h2>
<p>
Let's assume that your Visual Basic® program has a string variable that contains the result of some kind of percentage calculation and that value represents a dollar amount. After the calculation has been done, that value is returned as 14.2399. However, you need to round this dollar amount to only two decimal places so your final value is 14.24.</p>
<p>
The <b>CCur</b> function converts a number to a Currency type number—that is, a number that can contain, at maximum, four digits after the decimal place. The variable passed to the <b>CCur</b> function must be no larger than 8 bytes in length and must contain a fixed decimal point.</p>
<p>
By combining the <b>Format</b> and <b>CCur</b> functions, you can easily convert the number to a rounded dollar amount with only two digits after the decimal point.</p>
<h2>Example Program</h2>
<p>
The program below shows how to use the <b>CCur</b> function in a Visual Basic program. When it is executed, this program displays the value 14.2399 in the first Text Box and its properly formatted currency value, 14.24, in the second Text Box.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
In the General Declarations section of Form1, add the following two statements:<pre><code>Dim Amount As Currency
Dim Total As String
</code></pre>
</li>
<li>
Add the following code to the Form_Load event for Form1:<pre><code>Sub Form_Load()
 &nbsp;&nbsp; Amount = 14.2399
 &nbsp;&nbsp; Text1.Text = Str$(Amount) 
 &nbsp;&nbsp; Total = CCur(Format(Amount, "#,##0.00"))
 &nbsp;&nbsp; Text2.Text = Total
End Sub
</code></pre>
</li>
</ol>
</BODY>
</HTML>
