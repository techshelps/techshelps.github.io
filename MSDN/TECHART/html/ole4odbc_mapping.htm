<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mapping ODBC Functions to OLE DB Methods</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>
<h1><a name="ole4odbc_mapping"></a><sup></sup>Mapping ODBC Functions to OLE DB Methods</h1>
<p>
Because a direct mapping between ODBC functions and OLE DB methods does not exist in all cases, only similar functionality is provided. When more than one method can be used to achieve the same thing, the methods are separated with the word "or," for example, MethodA or MethodB. When more than one method must be called in sequence, the methods are numbered, for example, 1. MethodA, 2. MethodB, and so on.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=30%><b>ODBC function</b></td>
<td class=label width=42%><b>OLE DB method</b></td>
<td class=label width=28%><b>Remarks/property</b></td>
</tr>
<tr valign=top>
<td width=30%>SQLAllocHandle<p>
&nbsp;&nbsp;Environment</p>
<p>
&nbsp;&nbsp;Connection</p>
<p>
&nbsp;&nbsp;Descriptor</p>
<p>
&nbsp;&nbsp;Statement</p>
</td>
<td width=42%><p>
<b>OleInitialize</b></p>
<p>
<b>CoCreateInstance</b></p>
<p>
<b>IAccessor::CreateAccessor</b></p>
<p>
<b>IDBCreateCommand::CreateCommand</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLBindCol</td>
<td width=42%><b>IAccessor::CreateAccessor</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLBindParameter</td>
<td width=42%><b>IAccessor::CreateAccessor</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLBrowseConnect</td>
<td width=42%><b>ISourcesRowset::GetSourcesRowset</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLBulkOperations<p>
&nbsp;&nbsp;Insertions</p>
<p>
&nbsp;&nbsp;Deletions</p>
<p>
&nbsp;&nbsp;Updates</p>
<p>
&nbsp;&nbsp;Retrieve by bookmark</p>
</td>
<td width=42%><p>
<b>IRowsetChange::InsertRows</b></p>
<p>
<b>IRowsetChange::DeleteRows</b></p>
<p>
<b>IRowsetChange::SetData</b></p>
<p>
<b>IRowsetLocate::GetRowsByBookmark</b></p>
</td>
<td width=28%>If <b>IRowsetUpdate</b> is requested, all operations are batched until <b>IRowsetUpdate::Update</b> is called</td>
</tr>
<tr valign=top>
<td width=30%>SQLCancel</td>
<td width=42%><b>ICommand::Cancel</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLCloseCursor</td>
<td width=42%><b>IRowset::Release</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLColAttribute</td>
<td width=42%><b>IColumnsInfo::GetColumnInfo </b>or<b> IColumnsRowset::GetColumnsRowset</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLColumnPrivileges</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_<p>
COLUMN_PRIVILEGES</p>
</td>
</tr>
<tr valign=top>
<td width=30%>SQLColumns</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_COLUMNS</td>
</tr>
<tr valign=top>
<td width=30%>SQLConnect</td>
<td width=42%>1.<b> IDBProperties::SetProperties</b><p>
2.<b> IDBInitialize::Initialize</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLDataSources</td>
<td width=42%><b>ISourcesRowset::GetSourcesRowset</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLDescribeCol</td>
<td width=42%><b>IColumnsInfo::GetColumnInfo</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLDescribeParam </td>
<td width=42%><b>ICommandWithParameters::</b><p>
<b>GetParameterInfo</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLDisconnect</td>
<td width=42%><b>IDBInitialize::Uninitialize</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLDriverConnect</td>
<td width=42%>1. <b>IDBProperties::SetProperties</b><p>
2. <b>IDBInitialize::Initialize</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLDrivers </td>
<td width=42%><b>ISourcesRowset::GetSourcesRowset</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLEndTran</td>
<td width=42%><b>ITransaction::Commit </b>or<b> ITransaction::Abort</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLError</td>
<td width=42%>1. <b>GetErrorInfo</b><p>
2. <b>IErrorRecords</b></p>
<p>
3. <b>IErrorInfo</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLExecDirect</td>
<td width=42%><b>ICommand::Execute</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLExecute</td>
<td width=42%><b>ICommand::Execute</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLFetch </td>
<td width=42%>1. <b>IRowset::GetNextRows,</b><p>
<b>IRowsetLocate::GetRowsAt,</b> or </p>
<p>
<b>IRowsetLocate::GetRowsByBookmark</b></p>
<p>
2. <b>IRowset::GetData</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLFetchScroll</td>
<td width=42%>1.<b> IRowset::GetNextRows,</b><p>
<b>IRowsetLocate::GetRowsAt, or</b></p>
<p>
<b>IRowsetLocate::GetRowsByBookmark</b></p>
<p>
2. <b>IRowset::GetData</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLForeignKeys</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_<p>
FOREIGN_KEYS</p>
</td>
</tr>
<tr valign=top>
<td width=30%>SQLFreeHandle <p>
&nbsp;&nbsp;Environment</p>
<p>
&nbsp;&nbsp;Connection</p>
<p>
&nbsp;&nbsp;Descriptor</p>
<p>
&nbsp;&nbsp;Statement</p>
</td>
<td width=42%><p>
<b>OleUninitialize</b></p>
<p>
<b>IDBInitialize::Release</b></p>
<p>
<b>IAccessor::ReleaseAccessor</b></p>
<p>
<b>IRowset::Release</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLFreeStmt<p>
&nbsp;&nbsp;SQL_DROP</p>
<p>
&nbsp;&nbsp;SQL_CLOSE</p>
<p>
&nbsp;&nbsp;SQL_UNBIND</p>
<p>
&nbsp;&nbsp;SQL_RESET_</p>
<p>
&nbsp;&nbsp;PARAMS</p>
</td>
<td width=42%><p>
<b>ICommand::Release</b></p>
<p>
<b>IRowset::Release</b></p>
<p>
<b>IAccessor::ReleaseAccessor</b></p>
<p>
<b>IAccessor::ReleaseAccessor</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetConnectAttr</td>
<td width=42%><b>IDBProperties::GetProperties</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetCursorName </td>
<td width=42%>Not applicable</td>
<td width=28%>OLE DB performs updates through update methods, as opposed to positioned cursor operations</td>
</tr>
<tr valign=top>
<td width=30%>SQLGetData</td>
<td width=42%><b>IRowset::GetData </b><p>
(for all data except BLOBs) or</p>
<p>
<b>ILockBytes, ISequentialStream, IStorage, or IStream</b> (for BLOB data)</p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetDescField</td>
<td width=42%><b>IAccessor::GetBindings</b></td>
<td width=28%>Elements within binding structure</td>
</tr>
<tr valign=top>
<td width=30%>SQLGetDescRec</td>
<td width=42%><b>IAccessor::GetBindings</b></td>
<td width=28%>Elements within binding structure</td>
</tr>
<tr valign=top>
<td width=30%>SQLDiagField</td>
<td width=42%>1.<b> GetErrorInfo</b><p>
2.<b> IErrorRecords</b></p>
<p>
3.<b> IErrorInfo</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLDiagRec</td>
<td width=42%>1. <b>GetErrorInfo</b><p>
2. <b>IErrorRecords</b></p>
<p>
3. <b>IErrorInfo</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetEnvAttr</td>
<td width=42%><b>IDBProperties::GetProperties</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetFunctions</td>
<td width=42%><b>IUnknown::QueryInterface</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetInfo</td>
<td width=42%><b>IDBProperties::GetProperties</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetStmtAttr</td>
<td width=42%><b>ICommandProperties::GetProperties </b>or<b> IRowsetInfo::GetProperties</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLGetTypeInfo</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_<p>
PROVIDER_TYPES</p>
</td>
</tr>
<tr valign=top>
<td width=30%>SQLMoreResults </td>
<td width=42%><b>IMultipleResults</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLNativeSql </td>
<td width=42%><b>ICommandText::GetCommandText</b></td>
<td width=28%>With NULL as pguidDialect</td>
</tr>
<tr valign=top>
<td width=30%>SQLNumParams </td>
<td width=42%><b>ICommandWithParams::GetParameterInfo</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLNumResultCols </td>
<td width=42%><b>IColumnsInfo::GetColumnInfo</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLParamData </td>
<td width=42%>Not applicable</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLPrepare</td>
<td width=42%><b>ICommand::Prepare</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLPrimaryKeys</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_<p>
PRIMARY_KEYS</p>
</td>
</tr>
<tr valign=top>
<td width=30%>SQLProcedureColumns</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_<p>
PROCEDURE_PARAMETERS, DBSCHEMA_</p>
<p>
PROCEDURE_COLUMNS</p>
</td>
</tr>
<tr valign=top>
<td width=30%>SQLProcedures</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_PROCEDURES</td>
</tr>
<tr valign=top>
<td width=30%>SQLPutData </td>
<td width=42%><b>IRowsetChange::SetData</b><p>
(for all data except BLOBs) or</p>
<p>
<b>ISequentialStream </b>(for BLOB data)</p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLRowCount</td>
<td width=42%><i>cRowsAffected</i> in<b> ICommand::Execute</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLSetConnectAttr</td>
<td width=42%><b>IDBProperties::SetProperties</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLSetCursorName </td>
<td width=42%>Not applicable</td>
<td width=28%>OLE DB performs updates through update methods, as opposed to positioned cursor operations</td>
</tr>
<tr valign=top>
<td width=30%>SQLSetDescField</td>
<td width=42%><b>IAccessor::CreateAccessor</b></td>
<td width=28%>Elements within binding structure</td>
</tr>
<tr valign=top>
<td width=30%>SQLSetDescRec</td>
<td width=42%><b>IAccessor::CreateAccessor</b></td>
<td width=28%>Elements within binding structure</td>
</tr>
<tr valign=top>
<td width=30%>SQLSetEnvAttr</td>
<td width=42%><b>IDBProperties::SetProperties</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLSetParam</td>
<td width=42%><b>ICommandWithParameters::SetParameterInfo</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLSetPos<p>
&nbsp;&nbsp;&nbsp;SQL_POSITION</p>
<p>
&nbsp;&nbsp;&nbsp;SQL_REFRESH</p>
<p>
&nbsp;&nbsp;&nbsp;SQL_UPDATE</p>
<p>
&nbsp;&nbsp;&nbsp;SQL_DELETE</p>
<p>
&nbsp;&nbsp;&nbsp;SQL_ADD</p>
</td>
<td width=42%><p>
Not applicable</p>
<p>
<b>IRowset::GetData </b>or<b> IRowsetResynch</b></p>
<p>
<b>IRowsetChange::SetData</b></p>
<p>
<b>IRowsetChange::Delete</b></p>
<p>
<b>IRowsetChange::InsertRow</b></p>
<p>
<b>IRowsetUpdate::Update</b></p>
</td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLSetStmtAttr</td>
<td width=42%><b>ICommandProperties::SetProperties</b></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=30%>SQLSpecialColumns</td>
<td width=42%><b>IColumnsInfo::GetColumnInfo</b></td>
<td width=28%>DBCOLUMNFLAGS_<p>
ISROWID and DBCOLUMNFLAGS_</p>
<p>
ISROWVER</p>
</td>
</tr>
<tr valign=top>
<td width=30%>SQLStatistics</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_STATISTICS</td>
</tr>
<tr valign=top>
<td width=30%>SQLTablePrivileges</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_TABLE_<p>
PRIVILEGES</p>
</td>
</tr>
<tr valign=top>
<td width=30%>SQLTables</td>
<td width=42%><b>IDBSchemaRowset::GetRowset</b></td>
<td width=28%>DBSCHEMA_TABLES</td>
</tr>
<tr valign=top>
<td width=30%>SQLTransact</td>
<td width=42%><b>ITransaction::Abort </b>and<b> ITransaction::Commit</b></td>
<td width=28%></td>
</tr>
</table><br>
</BODY>
</HTML>
