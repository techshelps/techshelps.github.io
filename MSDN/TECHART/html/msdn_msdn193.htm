<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 193: Launching Windows 95 Control Panel Applets in Visual Basic</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn193"></a></sup>Tip 193: Launching Windows 95 Control Panel Applets in Visual Basic</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to launch an applet in Microsoft® Windows® 95 Control Panel from within a Microsoft Visual Basic® application.</p>
<h2>Using the RunDLL32 Utility to Launch Applets</h2>
<p>
The Control Panel program in the Microsoft® Windows® 95 operating system allows you to customize various aspects of the operating system. For example, by running the Printers applet, you can add, remove, or select a new default printer.</p>
<p>
A special utility included with Windows 95 allows you to execute a specific function (that is, a Control Panel applet) from within your own Microsoft Visual Basic® application. This utility is RunDLL32. You can use the RunDLL32 utility to execute the <b>Control_RunDLL</b> function in the Shell32.DLL library. To execute a Control Panel applet, you use a statement such as:</p>
<pre><code>X = Shell("Rundll32.exe shell32.dll,Control_RunDLL main.cpl @2")
</code></pre>
<p>
This statement uses the <b>Shell</b> command to execute the Printers applet in Control Panel. In a Visual Basic application, this would give your user the ability to select a new default printer, check a printer's status, and add or remove printer objects from the Windows 95 operating system.</p>
<p>
When using the <b>Shell</b> command to launch a Control Panel applet, you must be careful to use the exact syntax for the RunDLL32 utility. The capitalization of all components in the statement must not be altered in any way—otherwise, an error will occur.</p>
<p>
Each time you want to launch a Control Panel applet, your Visual Basic statement must include the syntax used above. In other words, you need only to substitute the name of the .CPL file for "main.cpl" used above and specify the number of the particular applet you want to execute. Also, if that applet requires additional command-line parameters, you would specify these as the last parameter to the statement.</p>
<p>
Each applet contained in a .CPL file is numbered starting from zero. If you don't specify which applet you want to execute with the <i>@value</i> parameter, the first applet (@0) is the one that is launched.</p>
<p>
The following list provides a starting point for showing how to launch the different applets found in Control Panel.</p>
<p>
To launch Control Panel itself:</p>
<pre><code>rundll32.exe shell32.dll,Control_RunDLL
</code></pre>
<p>
To launch the Accessibility Options applet:
<ul type=disc>
<li>
General<pre><code>rundll32.exe shell32.dll,Control_RunDLL access.cpl,,5
</code></pre>
</li>
<li>
Display<pre><code>rundll32.exe shell32.dll,Control_RunDLL access.cpl,,3
</code></pre>
</li>
<li>
Keyboard<pre><code>rundll32.exe shell32.dll,Control_RunDLL access.cpl,,1
</code></pre>
</li>
<li>
Mouse<pre><code>rundll32.exe shell32.dll,Control_RunDLL access.cpl,,4
</code></pre>
</li>
<li>
Sound<pre><code>rundll32.exe shell32.dll,Control_RunDLL access.cpl,,2
</code></pre>
</li>
</ul>
<p>
To launch the Regional Settings applet:
<ul type=disc>
<li>
Background<pre><code>rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,0
</code></pre>
</li>
<li>
Appearance<pre><code>rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,2
</code></pre>
</li>
<li>
Screen Saver<pre><code>rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,1
</code></pre>
</li>
<li>
Settings<pre><code>rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,3
</code></pre>
</li>
</ul>
<p>
To launch the Date/Time applet:</p>
<pre><code>rundll32.exe shell32.dll,Control_RunDLL timedate.cpl
</code></pre>
<h2>Example Program</h2>
<p>
This program shows how to launch the Printers applet in Control Panel from within a Visual Basic application.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1 (note that the <b>Shell</b> statement must be typed exactly as shown):<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; X = Shell("Rundll32.exe shell32.dll,Control_RunDLL main.cpl @2")
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing f5. Click the command button. The Printers applet in Control Panel is launched.</p>
</BODY>
</HTML>
