<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mapping the SQL Distributed Management Object: SQLOLE 6.0</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_mapsqldm"></a></sup>Mapping the SQL Distributed Management Object: SQLOLE 6.0</h1>
<p>
Ken Lassesen<br>
Microsoft Developer Network Technology Group</p>
<p>
October 11, 1995</p>
<p>
<OBJECT id=sample1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"
	width=0 height=0 hspace=0>
<PARAM name="Command" value="Sample">
<PARAM name="Item1" value="Technical Articles Sample">
<PARAM name="Item2" value="4435">
</OBJECT><a href="javascript:sample1.Click()">Click here for a diagram of the SQL Distributed Management Object in various graphics formats.</a></p>
<h2>Abstract</h2>
<p>
This article consists primarily of a graphic map of the SQL Distributed Management Object (SQL-DMO), showing its properties, methods, and child objects. The SQL-DMO may be accessed using Visual Basic®, Access Basic, Visual Basic for Applications, or Visual C++®.</p>
<h2>The SQL Distributed Management Object</h2>
<p>
The SQL Distributed Management Object (SQL-DMO) enables the developer to fully control Microsoft® SQL Server version 6.0 or higher. In most prior versions of SQL Server, the server could be administered by programs that are shipped with SQL Server, such as ISQL.EXE, ISQLW.EXE, Winquery.EXE, or pass-through queries using the Data Access Object (DAO). Windows® SQL Server version 4.21 introduced a very well-received graphic interface for administration. The introduction of an OLE Automation server (SQLOLE) simplifies administration further and allows easy programmatic administration. This approach presents the developer with a programming object instead of a massive (and confusing) collection of stored procedures. </p>
<p>
The SQLOLE object is available from Visual C++® version 4.0 and many products that contain Visual Basic® for Applications, including Microsoft Excel version 5.0 and higher, Microsoft Access 95, and Visual Basic version 4.0. The SQL-DMO may be used from other products that support references, for example, Microsoft Project. For further information on using the SQLOLE, see the Microsoft SQL Server product documentation (Development Library, Product Documentation, SDKs) and search the Development Library CD. For an introduction, see my article, <a href="msdn_ole2soln.htm">"Using Microsoft OLE Automation Servers to Develop Solutions."</a></p>
<p>
Figure 1 shows the relationship between objects as described by the Object Viewer and online Help files. A map is a good learning aid and a quick reference when developing an application. After producing a map, I found that it was easy to work with the object: I just post the appropriate map on my wall for quick reference, which is a lot faster than clicking objects in a Help file one by one to discover their properties and methods.</p>
<p>
Because Figure 1 is unreadable online, I have included the two most common graphics formats—encapsulated PostScript™ (.EPS) and Windows metafile (.WMF)—as well as a copy of my original Shapeware® Visio™ version 4.0 file (.VSD). The first two formats can be printed across multiple pages using any of the commercial graphics applications—such as Adobe™ PageMaker™, Corel® Draw, or Microsoft Publisher—or using Microsoft Excel. The original Visio file is included for those who have a copy of Visio 4.0 and wish to modify the diagram easily. </p>
<p>
<img src="mapsqldm_1.gif" border=0></p>
<p>
<b>Figure 1. The SQL Distributed Management Object</b></p>
<h3>Object Definitions</h3>
<p>
The objects and collections in Figure 1 are defined in Table 1. The objects are listed in the same sequence as they appear in the map.</p>
<p class=label>
<b>Table 1. Object and Collection Definitions</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>Object or Collection</b></td>
<td class=label width=69%><b>Definition</b></td>
</tr>
<tr valign=top>
<td width=31%><b>Application </b>object</td>
<td width=69%>This object is a standard OLE object that provides common properties and methods for managing the application environment. Each SQL-DMO application has a single <b>Application</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>SQLServers </b>collection</td>
<td width=69%>This collection contains all SQL Server objects of the <b>Application</b> object. </td>
</tr>
<tr valign=top>
<td width=31%><b>SQLServer </b>object</td>
<td width=69%>This object is the top-level object for the SQL Server OLE object model. All other SQL-DMO objects are either contained within or accessed through a SQL Server object or one of its children.</td>
</tr>
<tr valign=top>
<td width=31%><b>Properties </b>collection</td>
<td width=69%>This collection contains all the <b>Property</b> objects for a specific instance of an object. It is read-only.</td>
</tr>
<tr valign=top>
<td width=31%><b>Property </b>object</td>
<td width=69%>This object is a built-in characteristic or a user-defined characteristic of a data access object. The <b>Property</b> object and the <b>Properties</b> collections are only available to Visual Basic programs and other OLE Automation controllers. They are not available to C++ programs.</td>
</tr>
<tr valign=top>
<td width=31%><b>QueryResults </b>object</td>
<td width=69%>This object contains the result set from an executed Transact-SQL query. The query results returned from SQL Server are stored in memory and cannot be changed.</td>
</tr>
<tr valign=top>
<td width=31%><b>Alerts </b>collection</td>
<td width=69%>This collection contains all <b>Alert</b> objects.</td>
</tr>
<tr valign=top>
<td width=31%><b>Alert </b>object</td>
<td width=69%>This object contains all the information that defines a SQL Server alert. When you use it with <b>Alerts</b> collection, you have the ability to set alerts on SQL Server events. For example, you can generate alerts when a database is about to become full or when a database dump is unsuccessful. The engine generating the alerts is described in the <b>AlertSystem</b> object below.</td>
</tr>
<tr valign=top>
<td width=31%><b>Operators </b>collection</td>
<td width=69%>This collection contains <b>Operator</b> objects.</td>
</tr>
<tr valign=top>
<td width=31%><b>Operator </b>object</td>
<td width=69%>This object contains all the information about a SQL Server operator..</td>
</tr>
<tr valign=top>
<td width=31%><b>Languages </b>collection</td>
<td width=69%>This collection contains all <b>Language</b> objects. </td>
</tr>
<tr valign=top>
<td width=31%><b>Language </b>object</td>
<td width=69%>This object contains all the information about each language supported by SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>Devices </b>collection</td>
<td width=69%>This collection contains all <b>Device</b> objects used by a <b>SQLServer</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>Device </b>object</td>
<td width=69%>This object describes a pre-allocated physical storage used by SQL Server for storing database information. This includes database devices and dump devices.</td>
</tr>
<tr valign=top>
<td width=31%><b>Registry </b>object</td>
<td width=69%>This collection contains all of the information stored in the Windows NT™ Registry for a SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>Logins </b>collection</td>
<td width=69%>This collection contains all <b>Login</b> objects for a SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>Login </b>object</td>
<td width=69%>This object consists of a log-in identifier and password used to connect to SQL Server. A <b>Login</b> object is global to the entire SQL Server and has corresponding <b>User</b> or <b>Alias</b> objects in each database for which the Login object has access.</td>
</tr>
<tr valign=top>
<td width=31%><b>Executive </b>object</td>
<td width=69%>This collection contains information about the scheduling engine used to schedule tasks and alerts.</td>
</tr>
<tr valign=top>
<td width=31%><b>AlertSystem </b>object</td>
<td width=69%>This object contains information about the alert engine. See <b>Alert</b> collection above. </td>
</tr>
<tr valign=top>
<td width=31%><b>Tasks </b>collection</td>
<td width=69%>This collection contains all of the scheduled tasks for a SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>Task </b>objects</td>
<td width=69%>These objects contain information about a scheduled task..</td>
</tr>
<tr valign=top>
<td width=31%><b>IntegratedSecurity </b>object</td>
<td width=69%>This collection contains all the information about how SQL Server security and log-ins are integrated with Windows NT group and user accounts.</td>
</tr>
<tr valign=top>
<td width=31%><b>Configuration </b>collection</td>
<td width=69%>This collection contains a collection of <b>ConfigValue</b> collections.</td>
</tr>
<tr valign=top>
<td width=31%><b>ConfigValues </b>collection</td>
<td width=69%>This collection contains the collection of information on how the SQL Server is configured.</td>
</tr>
<tr valign=top>
<td width=31%><b>ConfigValue </b>object</td>
<td width=69%>This object contains information on each SQL Server configuration option. </td>
</tr>
<tr valign=top>
<td width=31%><b>Names </b>collection</td>
<td width=69%>This collection contains strings instead of objects.</td>
</tr>
<tr valign=top>
<td width=31%><b>RemoteServers </b>collection</td>
<td width=69%>This collection contains all of the <b>RemoteServer</b> objects for a specific SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>RemoteServer </b>object</td>
<td width=69%>This object contains information about a remote SQL Server that is known to the local SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>RemoteLogins </b>collection</td>
<td width=69%>This collection contains all the <b>RemoteLogin</b> objects for a specific SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>RemoteLogin </b>object</td>
<td width=69%>This object contains information about the association of a remote log-in from a specific remote server to a local log-in. Each <b>RemoteServer</b> object can have multiple <b>RemoteLogin</b> objects.</td>
</tr>
<tr valign=top>
<td width=31%><b>SubscriberInfo </b>object</td>
<td width=69%>This object contains all the replication subscribing information about a <b>RemoteServer</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>Databases </b>collection</td>
<td width=69%>This collection contains information about all of the databases on a SQL Server.</td>
</tr>
<tr valign=top>
<td width=31%><b>Database </b>object</td>
<td width=69%>This object contains other objects (like <b>Table</b>, <b>View</b>, and <b>StoredProcedure</b> objects) which contain or interact with data.</td>
</tr>
<tr valign=top>
<td width=31%><b>SystemDataTypes </b>collection</td>
<td width=69%>This collection contains all of the <b>SystemDataType</b> objects.</td>
</tr>
<tr valign=top>
<td width=31%><b>SystemDataType </b>object</td>
<td width=69%>This object contains information about a system-supplied data type.</td>
</tr>
<tr valign=top>
<td width=31%><b>DBOption </b>object</td>
<td width=69%>This object contains all the database options for a database. These options can be set by the database owner.</td>
</tr>
<tr valign=top>
<td width=31%><b>Defaults </b>collection</td>
<td width=69%>This collection contains the information about all of the bindable (non-DRI) default values for a database object.</td>
</tr>
<tr valign=top>
<td width=31%><b>Default </b>object</td>
<td width=69%>This object is a value that is stored in a column or data type to which it is bound if no other value is supplied.</td>
</tr>
<tr valign=top>
<td width=31%><b>Groups </b>collection</td>
<td width=69%>This collection contains the information about all of the groups for a database object.</td>
</tr>
<tr valign=top>
<td width=31%><b>Group </b>object</td>
<td width=69%>This object contains a group of users and can be used to grant privileges to a large number of users with similar access rights.</td>
</tr>
<tr valign=top>
<td width=31%><b>DBObject </b>object</td>
<td width=69%>This object is a generic object that contains information appropriate for all types of database objects. A <b>DBObject</b> object is closely tied to a specific SQL-DMO object, but presents a generic interface that allows the same code to apply to multiple object types. A <b>DBObject</b> object can represent a <b>Table</b>, <b>View</b>, <b>Rule</b>, <b>Default</b>, <b>StoredProcedure</b>, <b>Trigger</b>, or <b>UserDefinedDatatype</b> object.</td>
</tr>
<tr valign=top>
<td width=31%><b>Rules </b>collections</td>
<td width=69%>This collection contains the rules that apply to a database.</td>
</tr>
<tr valign=top>
<td width=31%><b>Rule </b>object</td>
<td width=69%>This object contains information that defines a domain of valid values that can be stored in the column or data type to which it is bound.</td>
</tr>
<tr valign=top>
<td width=31%><b>StoredProcedures </b>collection</td>
<td width=69%>This collection contains the stored procedures that apply to a database.</td>
</tr>
<tr valign=top>
<td width=31%><b>StoredProcedure </b>object</td>
<td width=69%>This object is a named set of Transact-SQL statements that are stored within a database.</td>
</tr>
<tr valign=top>
<td width=31%><b>Tables </b>collection</td>
<td width=69%>This collection contains all of the tables in the database.</td>
</tr>
<tr valign=top>
<td width=31%><b>Table </b>object</td>
<td width=69%>This object contains rows of data in the database.</td>
</tr>
<tr valign=top>
<td width=31%><b>Keys </b>collection</td>
<td width=69%>This collection contains all of the key objects (DRI constraints) associated with a table.</td>
</tr>
<tr valign=top>
<td width=31%><b>Key </b>object</td>
<td width=69%>This object contains information about primary, unique, or foreign keys of a <b>Table</b> object. Each <b>Key</b> object is made up of one or more columns from a table.</td>
</tr>
<tr valign=top>
<td width=31%><b>Indexes </b>collection</td>
<td width=69%>This collection contains all of the indexes associated with a table.</td>
</tr>
<tr valign=top>
<td width=31%><b>Index </b>object.</td>
<td width=69%>This object contains information about an index. The index may be clustered or nonclustered.</td>
</tr>
<tr valign=top>
<td width=31%><b>Columns </b>collection</td>
<td width=69%>This collection contains all the column objects for a table.</td>
</tr>
<tr valign=top>
<td width=31%><b>Column </b>object</td>
<td width=69%>This object defines a specific field of information that is maintained in a table.</td>
</tr>
<tr valign=top>
<td width=31%><b>DRIDefault </b>object</td>
<td width=69%>This object contains information about a default constraint for a column.</td>
</tr>
<tr valign=top>
<td width=31%><b>Checks </b>collection</td>
<td width=69%>This collection contains all of the check constraints for a table.</td>
</tr>
<tr valign=top>
<td width=31%><b>Check </b>object</td>
<td width=69%>This object contains information about a check constraint. </td>
</tr>
<tr valign=top>
<td width=31%><b>Trigger </b>collection</td>
<td width=69%>This collection contains all of the triggers existing for a table. </td>
</tr>
<tr valign=top>
<td width=31%><b>Trigger </b>object</td>
<td width=69%>This object contains Transact-SQL statements that are executed when data in a specific table is inserted, updated, or deleted.</td>
</tr>
<tr valign=top>
<td width=31%><b>Views </b>collection</td>
<td width=69%>This collection contains all of the views in a database.</td>
</tr>
<tr valign=top>
<td width=31%><b>View </b>object</td>
<td width=69%>This object is defined by a SELECT statement (the Text property) that includes specific columns (either actual or aggregated) from one or more tables in a database.</td>
</tr>
<tr valign=top>
<td width=31%><b>Publications </b>collection</td>
<td width=69%>This collection contains all of the publications for a database.</td>
</tr>
<tr valign=top>
<td width=31%><b>Publication </b>object</td>
<td width=69%>This object contains information about a publication containing articles used for replication.</td>
</tr>
<tr valign=top>
<td width=31%><b>Articles </b>collection</td>
<td width=69%>This collection contains all of the articles in a publication.</td>
</tr>
<tr valign=top>
<td width=31%><b>Article </b>object</td>
<td width=69%>This object contains information about an article contained in a publication.</td>
</tr>
<tr valign=top>
<td width=31%><b>Subscriptions </b>collection</td>
<td width=69%>This collection contains all of the subscriptions for an article.</td>
</tr>
<tr valign=top>
<td width=31%><b>Subscription </b>object</td>
<td width=69%>This object contains information about a subscriber to a replicated article.</td>
</tr>
<tr valign=top>
<td width=31%><b>Permission </b>object</td>
<td width=69%>This object contains information about a database user's object or statement privileges. It is returned by various methods.</td>
</tr>
<tr valign=top>
<td width=31%><b>Backup </b>object</td>
<td width=69%>This object contains complete information used to perform a backup or restore of a database or transaction log. </td>
</tr>
<tr valign=top>
<td width=31%><b>HistoryFilter </b>object</td>
<td width=69%>This object is used to qualify task history rows to list or purge.</td>
</tr>
<tr valign=top>
<td width=31%><b>TransactionLog</b> object</td>
<td width=69%>This object contains all the information about a database's transaction log.</td>
</tr>
<tr valign=top>
<td width=31%><b>UserDefinedDatatypes </b>collection</td>
<td width=69%>This collection contains all of the user-defined data types for a database.</td>
</tr>
<tr valign=top>
<td width=31%><b>UserDefinedDatatype </b>object</td>
<td width=69%>This object contains information about a new data type that has been created by the user.</td>
</tr>
</table><br>
<h2>Bibliography</h2>
<p>
<i>Programming SQL Distributed Management Objects.</i> (MSDN Library, Platform, SDK, and DDK Documentation) </p>
</BODY>
</HTML>
