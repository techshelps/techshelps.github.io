<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 185: Determining the Number of Printable Lines Per Page on the Printer</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn185"></a></sup>Tip 185: Determining the Number of Printable Lines Per Page on the Printer</h1>
<p>
December 5, 1995</p>
<h2>Abstract</h2>
<p>
This article explains how to determine the total number of text lines that a printer can accommodate on a single sheet of paper.</p>
<h2>Using the TextHeight and ScaleHeight Methods</h2>
<p>
When sending data to a printer, you often need to determine how many lines of text can be printed on a single sheet of paper. The Microsoft® Visual Basic® <b>TextHeight</b> method indicates how much space is used when text is actually sent to the printer. The <b>TextHeight</b> method, in other words, tells you the vertical height of the output string. Among other things, you can use this information to center a line of text vertically on the printer.</p>
<p>
The <b>ScaleHeight</b> property tells you the horizontal coordinates for a single printed page.</p>
<p>
If you need to determine how many lines of text can be printed on the default printer, you must first retrieve the <b>TextHeight</b> method's value for the printer. Next, you retrieve the <b>ScaleHeight</b> property's value for the printer and divide this value by the height of the text string. The result is the total number of lines per page that you can send to the printer.</p>
<h2>Example Program</h2>
<p>
This program tells you how many lines of text can be printed on a single sheet of paper.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Text Box</b> control to Form1. Text1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim PrinterHeight As Integer
 &nbsp;&nbsp; Dim NumberOfLines As Integer

 &nbsp;&nbsp; PrinterHeight = Printer.TextHeight("Sample string")
 &nbsp;&nbsp; NumberOfLines = Printer.ScaleHeight / PrinterHeight
 &nbsp;&nbsp; Text1.Text = "Lines per page = " &amp; Str$(NumberOfLines)
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the <b>Command Button</b> control. The number of lines the printer can accommodate, using the currently selected font, is displayed in the <b>Text Box</b> control.</p>
</BODY>
</HTML>
