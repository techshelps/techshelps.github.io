<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 128: Calculating the Beginning and Ending Date of a Month</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn128"></a></sup>Tip 128: Calculating the Beginning and Ending Date of a Month</h1>
<p>
July 1, 1995</p>
<h2>Abstract</h2>
<p>
When developing an application in Microsoft® Visual Basic®, you may need to calculate the specific date of the first and last days of a month. This article explains how to accomplish this task in Visual Basic.</p>
<h2>Manipulating Dates in Visual Basic</h2>
<p>
Microsoft® Visual Basic® offers many functions that you can use to determine what day a specific date falls on, what month it is, and so on. You can use the <b>DateValue</b> function to convert a date string, such as July 3, 1995, to a date serial number. This function usually determines what day of the week a specific date falls on.</p>
<p>
The <b>DateSerial</b> function converts a numeric value to a date serial number. The serial number is a unique number that represents each possible date from January 1, 100 A.D. through December 31, 9999. Therefore, you can easily calculate how many days elapsed between two specific dates by using the <b>DateSerial</b> function.</p>
<p>
In the example program below, you want to find the first and last dates in the month of July, 1995. To do this, you convert the string date (July 3, 1995) to a date serial number. Then you use the <b>DateSerial</b> function in conjunction with the <b>Year</b> and <b>Month</b> functions to calculate the first date in the month of July. You repeat this routine to determine the last date in the month of July.</p>
<p>
After calling the <b>DateSerial</b> function, you must use the Visual Basic <b>Year</b>, <b>Month</b>, and <b>Day</b> functions to extract and decode specific portions of information from the date serial number. You must do this because the date serial number is encoded in a special format.</p>
<p>
In the example program below, you use the <b>Year</b> and <b>Month</b> functions to determine which date is the first day of the month. The <b>Month</b> function returns a value of 1 through 12 that represents the specified month. In a similar fashion, the Visual Basic <b>Year</b> function returns the year from the encoded serial number.</p>
<p>
The <b>MonthEnd</b> function in the example program actually calculates the next month's first day. It then backtracks by one day to calculate the correct date for the last day of the month.</p>
<h2>Example Program</h2>
<p>
This program shows how to retrieve the first and last date for a specified month.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Text Box</b> control to Form1. Text1 is created by default. Set its <b>MultiLine</b> property to True.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim LastDay As Variant
 &nbsp;&nbsp; Dim FirstDay As Variant
 &nbsp;&nbsp; Dim ThisDate As Variant
 &nbsp;&nbsp; text1.TEXT = ""
 &nbsp;&nbsp; ThisDate = DateValue("July 3, 1995")
 &nbsp;&nbsp; FirstDay = MonthBegin(ThisDate)
 &nbsp;&nbsp; text1.TEXT = Str$(FirstDay) &amp; Chr$(13) &amp; Chr$(10)
 &nbsp;&nbsp; LastDay = MonthEnd(ThisDate)
 &nbsp;&nbsp; text1.TEXT = text1.TEXT &amp; Str$(LastDay)
End Sub
</code></pre>
</li>
<li>
Create a new function called <b>MonthBegin</b>. Add the following code to this function:<pre><code>Function MonthBegin(vbdate As Variant) As Variant
 &nbsp;&nbsp; MonthBegin = DateSerial(Year(vbdate), Month(vbdate), 1)
End Function
</code></pre>
</li>
<li>
Create a new function called <b>MonthEnd</b>. Add the following code to this function:<pre><code>Function MonthEnd(vbdate As Variant) As Variant
 &nbsp;&nbsp; MonthEnd = DateSerial(Year(vbdate), Month(vbdate) + 1, 0)
End Function
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the command button. The first and last days in the month of July are displayed as 7/1/95 and 7/31/95, respectively.</p>
</BODY>
</HTML>
