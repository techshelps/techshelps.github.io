<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 208: Changing the Displayed Icon in the About Dialog Box in Visual Basic 4.0</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn208"></a></sup>Tip 208: Changing the Displayed Icon in the About Dialog Box in Visual Basic 4.0</h1>
<p>
February 28, 1996</p>
<h2>Abstract</h2>
<p>
In Microsoft® Visual Basic® version 4.0, the Microsoft Windows® application programming interface (API) <b>ShellAbout</b> function lets you display the standard Microsoft Windows About dialog box seen in applications such as Notepad and Explorer. This article explains how to use an icon other than the default Microsoft Windows icon that appears in the About dialog box of your Visual Basic 4.0 application.</p>
<h2>Selecting Icons for the ShellAbout Function</h2>
<p>
Many Microsoft® Windows® applications, such as Notepad and Explorer, display a standard About dialog box. This About dialog box displays information such as the name of the application, a copyright notice, system information, or anything else the developer wants to include in the window. Usually, the About dialog box is accessed from the application's menu system. You can use the Microsoft Windows application programming interface (API) <b>ShellAbout</b> function to display an About dialog box in your Microsoft Visual Basic® version 4.0 application.</p>
<p>
To use the <b>ShellAbout</b> function, you must include the following <b>Declare</b> statement in your Visual Basic project:</p>
<pre><code>Private Declare Function ShellAbout Lib "shell32.dll" Alias "ShellAboutA" 
 &nbsp; (ByVal hwnd As Long, ByVal szApp As String, ByVal szOtherStuff As String, 
 &nbsp; ByVal hIcon As Long) As Long
</code></pre>
<p>
As you can see, the <b>ShellAbout</b> function requires four arguments, as follows:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=16%><i>hWnd</i></td>
<td width=84%>A long value containing the window handle.</td>
</tr>
<tr valign=top>
<td width=16%><i>szApp</i></td>
<td width=84%>A string containing the text that appears in the title bar of the About dialog box.</td>
</tr>
<tr valign=top>
<td width=16%><i>szOtherStuff</i></td>
<td width=84%>A string containing the text that appears after the version and copyright information.</td>
</tr>
<tr valign=top>
<td width=16%><i>hIcon</i></td>
<td width=84%>A long value containing the handle of an icon resource. When set to NULL, the <b>ShellAbout</b> function displays the default Microsoft Windows icon.</td>
</tr>
</table><br>
<p>
You can tell the <b>ShellAbout</b> function to display your About dialog box with an icon of your choice rather than having the function use the Microsoft Windows icon. You can do this by using the icon that is assigned to your Visual Basic 4.0 application, for example. Then, when you call the <b>ShellAbout</b> function, you specify the handle of that icon (Me.Icon) as the <i>hIcon</i> argument to the function.</p>
<h2>Example Program</h2>
<p>
This program shows how to change the icon that appears in the About dialog box when using the <b>ShellAbout</b> function to create the dialog box.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default. Set the <b>Icon</b> property of Form1 to an icon of your choice.<br><br></li>
<li>
Add the following <b>Declare</b> statement to the General Declarations section of Form1 (note that this <b>Declare</b> statement must be typed as a single line of code):<pre><code>Private Declare Function ShellAbout Lib "shell32.dll" Alias "ShellAboutA" 
 &nbsp; (ByVal hwnd As Long, ByVal szApp As String, ByVal szOtherStuff As String, 
 &nbsp; ByVal hIcon As Long) As Long
</code></pre>
</li>
<li>
Add the following code to the Click event for Form1:<pre><code>Private Sub Form_Click()
 &nbsp;&nbsp; Call ShellAbout(Me.hwnd, App.Title, "My App's Details.", Me.Icon)
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing&nbsp; Click the form to display the standard About dialog box. Notice that the icon appearing in the About dialog box is the icon you assigned to Form1 at design time.</p>
<h2>Additional References</h2>
<p>
Knowledge Base Q122893. "How to Use ShellAbout() to Display Standard Windows About Box."</p>
<p>
"ShellAbout QuickInfo Overview Group." (MSDN Library, SDK Documentation, Platform SDK)</p>
</BODY>
</HTML>
