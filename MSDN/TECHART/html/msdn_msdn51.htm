<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 51: Displaying a Status Bar While Executing Lengthy Procedures</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn51"></a></sup>Tip 51: Displaying a Status Bar While Executing Lengthy Procedures </h1>
<p>
Created: April 10, 1995</p>
<h2>Abstract</h2>
<p>
When a Visual Basic® program is executing a time-consuming task, you can display the progress of that task by using a status bar in the program. This article explains how you can use a three-dimensional control to add this feature to your Visual Basic programs.</p>
<h2>Showing the Percentage Status Bar</h2>
<p>
To add a status bar to your Visual Basic® program, you use a three-dimensional (3D) Panel control. Your program displays a blue horizontal bar that is filled from left to right. As your program updates the percentage-completed variable, the 3D Panel is also updated. In the example program below, we set the <i>X</i> variable equal to the number of bytes in the TEST.COM file. As each block of 100 bytes is read from the file, the <b>FloodPercent</b> property of the 3D Panel control is adjusted accordingly. This is how the horizontal bar appears to grow from left to right until the entire file has been processed.</p>
<h2>Example Program</h2>
<p>
The following program shows how you can add a percentage-completed status bar to your own Visual Basic application. It is assumed that you have a temporary file called TEST.COM in the root directory of drive C. As this program reads data from the temporary file, it displays the percentage completed on the status bar. The program ends when the entire file has been processed, showing a "100 percent completed" message in the status bar.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add a <b>Label</b> control to Form1. Label1 is created by default.<br><br></li>
<li>
Add a <b>3D Panel</b> control to Form1. Panel3D1 is created by default. Set its <b>FloodType</b> property to 1-Flood from left to right. Set its <b>FloodShowPct</b> property to True.<br><br></li>
<li>
Add a Command Button control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Process File".<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Sub Command1_Click()

 &nbsp; Dim inp As String * 100
 &nbsp; x = FileLen("c:\test.com")
 &nbsp; Open "c:\test.com" For Binary As #1
 &nbsp; Label1 = "Working..."
 &nbsp; Label1.Refresh
 &nbsp; i = 0
 &nbsp; While Not EOF(1)
 &nbsp;&nbsp;&nbsp;&nbsp; Get #1, , inp
 &nbsp;&nbsp;&nbsp;&nbsp; i = i + 100
 &nbsp;&nbsp;&nbsp;&nbsp; Panel3D1.FloodPercent = 100 * i / x
 &nbsp;&nbsp;&nbsp;&nbsp; Text1 = inp
 &nbsp; Wend
 &nbsp; Close #1
 &nbsp; Label1 = "Done"
End Sub
</code></pre>
</li>
<li>
Add a Text Box control to Form1. Text1 is created by default.</li>
</ol>
<h2>Additional References</h2>
<p>
Knowledge Base Q113999. "How to Create a Setup-Like Status Bar in Visual Basic." (Development Library, Knowledge Base and Bug Lists)</p>
</BODY>
</HTML>
