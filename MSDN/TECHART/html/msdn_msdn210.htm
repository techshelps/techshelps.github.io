<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 210: Determining Whether a Window or Control Has a Scroll Bar</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn210"></a></sup>Tip 210: Determining Whether a Window or Control Has a Scroll Bar</h1>
<p>
February 28, 1996</p>
<h2>Abstract </h2>
<p>
This article explains how to determine whether a window or control has a scroll bar associated with it when your Microsoft® Visual Basic® 4.0 application is running.</p>
<h2>Using the GetWindowLong Function</h2>
<p>
When designing a Microsoft® Visual Basic® version 4.0 application, you may need to determine at run time whether a specific control has a scroll bar. This can be accomplished by using the Microsoft® Windows® application programming interface (API) <b>GetWindowLong</b> function.</p>
<p>
Every form (or window) in a Microsoft Windows-based application has a set of attributes associated with it. These window style bits describe the window. For example, if a window has a border, the WS_BORDER style bit is set. In the same manner, if a window has a scroll bar, the WS_VSCROLL and/or WS_HSCROLL style bits are set.</p>
<p>
You can call the <b>GetWindowLong</b> function to determine whether a control has a scroll bar. The <b>GetWindowLong</b> function requires two arguments: the handle of the window you want to retrieve information for, and the type of information you want to retrieve. In this case, you tell the <b>GetWindowLong</b> function to retrieve the style of the window (GWL_STYLE).</p>
<p>
After the <b>GetWindowLong</b> function is called, you use the Visual Basic AND operator to find out whether the style of the window is set to that of a vertical scroll bar (&amp;H200000). If this statement indicates that a scroll bar is present, the expression returns a True value.</p>
<h2>Example Program</h2>
<p>
This program shows how to determine whether a control has a scroll bar.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the General Declarations section of Form1 (note that the <b>Declare</b> statement must be typed as a single line of code):<pre><code>Private Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA" 
 &nbsp; (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Const GWL_STYLE = (-16)
</code></pre>
</li>
<li>
Add a <b>File List Box</b> control to Form1. File1 is created by default.<br><br></li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1:<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim lFlag As Long, iGotScroll As Long

 &nbsp;&nbsp; lFlag = GetWindowLong(File1.hwnd, GWL_STYLE)
 &nbsp;&nbsp; If (&amp;H200000 And lFlag) &lt;&gt; False Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iGotScroll = True
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "File List Box has a scroll bar"
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iGotScroll = False
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "File List Box does NOT have a scroll bar"
 &nbsp;&nbsp; End If

 &nbsp;&nbsp; lFlag = GetWindowLong(Command1.hwnd, GWL_STYLE)
 &nbsp;&nbsp; If (&amp;H200000 And lFlag) &lt;&gt; False Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iGotScroll = True
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Command Button has a scroll bar"
 &nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iGotScroll = False
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Command Button does NOT have a scroll bar"
 &nbsp;&nbsp; End If

End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. Click the <b>Command Button</b> control. A message box appears indicating that the <b>File List Box</b> control does have a scroll bar. Click OK. A message box appears indicating that the <b>Command Button</b> control does not have a scroll bar. Click OK.</p>
<h2>Additional References</h2>
<p>
"GetWindowLong QuickInfo Overview Group." (MSDN Library, Platform, SDK, and DDK Documentation)</p>
<p>
Knowledge Base Q109741. "How to Scroll a Form When VB Forms Are Limited to Screen Size."</p>
<p>
"Scrolling Windows." (MSDN Library, Specifications)</p>
<p>
<a href="msdn_msdn138.htm">"Tip 138: Enabling and Disabling Scroll Bars in a List Box."</a></p>
</BODY>
</HTML>
