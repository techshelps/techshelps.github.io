<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 211: Changing or Removing the Desktop Wallpaper in Visual Basic 4.0</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn211"></a></sup>Tip 211: Changing or Removing the Desktop Wallpaper in Visual Basic 4.0</h1>
<p>
February 28, 1996</p>
<h2>Abstract</h2>
<p>
Using the Microsoft® Windows® application programming interface (API) <b>SystemParametersInfo</b> function, you can remove or change the default desktop wallpaper from within your Microsoft Visual Basic® 4.0 application.</p>
<h2>Using SystemParametersInfo to Remove/Select Wallpaper</h2>
<p>
In a Microsoft® Visual Basic® application, the Microsoft Windows® application programming interface (API) <b>SystemParametersInfo</b> function can be used to set many different system-wide parameters. One of these parameters is the desktop wallpaper. Normally, a user would select a new desktop wallpaper by using Control Panel.</p>
<p>
As shown in the example program below, the <b>SystemParametersInfo</b> function can be called with the SPI_SETDESKWALLPAPER value and the name of the wallpaper you want to select. The Windows 95 operating system will then make this the new default wallpaper.</p>
<p>
The SPIF_SENDWININICHANGE value tells Windows 95 that it should notify all top-level windows of the new change to the system-wide parameters.</p>
<h2>Example Program</h2>
<p>
This program shows how to remove and select a new desktop wallpaper from within a Visual Basic application.
<ol>
<li>
Create a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following <b>Constant </b>and <b>Declare</b> statements to the General Declarations section of Form1 (note that the <b>Declare</b> statement must be typed as a single line of code):<pre><code>Private Declare Function SystemParametersInfo Lib "user32" Alias 
 &nbsp; "SystemParametersInfoA" (ByVal uAction As Long, ByVal uParam As Long, 
 &nbsp; ByVal lpvParam As String, ByVal fuWinIni As Long) As Long
Const SPIF_UPDATEINIFILE = &amp;H1
Const SPI_SETDESKWALLPAPER = 20
Const SPIF_SENDWININICHANGE = &amp;H2
</code></pre>
</li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default. Set its <b>Caption</b> property to "Remove Wallpaper".<br><br></li>
<li>
Add the following code to the Click event for Command1 (note that the "X =" statement must be typed as a single line of code):<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Dim X As Long
 &nbsp;&nbsp; X = SystemParametersInfo(SPI_SETDESKWALLPAPER, 0&amp;, "(None)", 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SPIF_UPDATEINIFILE Or SPIF_SENDWININICHANGE)
 &nbsp;&nbsp; MsgBox "Wallpaper was removed"
End Sub
</code></pre>
</li>
<li>
Add a second <b>Command Button</b> control to Form1. Command2 is created by default. Set its <b>Caption</b> property to "Change Wallpaper".<br><br></li>
<li>
Add the following code to the Click event for Command2 (note that the "X =" statement must be typed as a single line of code):<pre><code>Private Sub Command2_Click()
 &nbsp;&nbsp; Dim FileName As String
 &nbsp;&nbsp; Dim X As Long

 &nbsp;&nbsp; FileName = "c:\windows\pinstripe.bmp"

 &nbsp;&nbsp; X = SystemParametersInfo(SPI_SETDESKWALLPAPER, 0&amp;, FileName, 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SPIF_UPDATEINIFILE Or SPIF_SENDWININICHANGE)
 &nbsp;&nbsp; MsgBox "Wallpaper was changed"
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. To remove the wallpaper, click the "Remove Wallpaper" command button. Windows 95 displays a black background with no graphics whatsoever. Click the "Change Wallpaper" command button to change the wallpaper to the PINSTRIPE.BMP image.</p>
<h2>Additional References</h2>
<p>
"Desktop Window." (MSDN Library, Platform, SDK, and DDK Documentation)</p>
<p>
Knowledge Base Q97142. "How to Use SystemParametersInfo API for Control Panel Settings."</p>
<p>
"SystemParametersInfo QuickInfo Overview Group." (MSDN Library, Platform, SDK, and DDK Documentation)</p>
<p>
<a href="msdn_msdn5.htm">"Tip 5: Removing the Desktop Wallpaper."</a></p>
</BODY>
</HTML>
