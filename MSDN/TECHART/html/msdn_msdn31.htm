<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 31: Creating the Windows Wallpaper Effect</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn31"></a></sup>Tip 31: Creating the Windows Wallpaper Effect</h1>
<p>
Created: March 1, 1995</p>
<h2>Abstract</h2>
<p>
Windows® displays an image as its wallpaper. You can add this feature to your own Visual Basic® programs. This article explains how you can use the Windows application programming interface (API) <b>BitBlt</b> function to copy a single icon multiple times. The icons are copied so that they cover the entire area of the form, giving it a "wallpaper" look.</p>
<h2>Using BitBlt to Copy an Icon</h2>
<p>
The Windows® application programming interface (API) <b>BitBlt </b>function can be used to copy an icon within a Visual Basic® program. This function copies the specified bitmap from the source device to the destination device. In order for this function to work correctly, the <b>ScaleMode</b> property of both devices must be set to Pixel.</p>
<p>
To declare this function within your program, include the following <b>Declare</b> statement in the Global Module or General Declarations section of your form:</p>
<pre><code>Declare Function BitBlt Lib "GDI" (ByVal hDestDC As Integer, ByVal X As Integer, 
 &nbsp; ByVal Y As Integer, ByVal nWidth As Integer, ByVal nHeight As Integer, ByVal 
 &nbsp; hSrcDC As Integer, ByVal XSrc As Integer, ByVal YSrc As Integer, ByVal dwRop 
 &nbsp; As Long) As Integer
</code></pre>
<p>
Note that this <b>Declare</b> statement must be typed as one single line of text.</p>
<p>
The <b>BitBlt</b> function requires that nine arguments be passed to it. These arguments are as follows:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%><i>hDestDC</i></td>
<td width=83%>An integer value that contains the device context (<b>hDC</b> property) of the destination device</td>
</tr>
<tr valign=top>
<td width=17%><i>hSrcDC</i></td>
<td width=83%>An integer value that contains the device context (<b>hDC</b> property) of the source device</td>
</tr>
<tr valign=top>
<td width=17%><i>X, Y</i></td>
<td width=83%>Integer values that contain the upper-left corner in the destination where the bitmap is to be placed. Specified in logical coordinates.</td>
</tr>
<tr valign=top>
<td width=17%><i>nWidth, nHeight</i></td>
<td width=83%>Integer values that contain the logical dimensions of the bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><i>Xsrc, Ysrc</i></td>
<td width=83%>Integer values that contain the logical coordinates of the source bitmap's upper-left corner</td>
</tr>
<tr valign=top>
<td width=17%><i>dwRop</i></td>
<td width=83%>A long value that specifies how the <b>BitBlt</b> function is to copy the bitmap.</td>
</tr>
</table><br>
<p>
The <i>dwRop</i> argument may be specified as one of the constants in the following table (these values are stored in the CONSTANT.TXT file).</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%><b>BLACKNESS</b></td>
<td width=83%>All output is black.</td>
</tr>
<tr valign=top>
<td width=17%><b>DSTINVERT</b></td>
<td width=83%>The destination bitmap is inverted.</td>
</tr>
<tr valign=top>
<td width=17%><b>MERGECOPY</b></td>
<td width=83%>The Boolean AND operator combines the pattern and the source bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><b>MERGEPAINT</b></td>
<td width=83%>The source bitmap is inverted and the Boolean OR operator is used to combine it with the destination bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><b>NOTSRCCOPY</b></td>
<td width=83%>The source bitmap is inverted and copied to the destination bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><b>NOTSRCERASE</b></td>
<td width=83%>The Boolean OR operator is used to combine the source and destination bitmaps. The resulting bitmap is then inverted.</td>
</tr>
<tr valign=top>
<td width=17%><b>PATCOPY</b></td>
<td width=83%>The pattern is copied to the destination bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><b>PATINVERT</b></td>
<td width=83%>The Boolean XOR operator is used to combine the destination bitmap with the pattern.</td>
</tr>
<tr valign=top>
<td width=17%><b>PATPAINT</b></td>
<td width=83%>The Boolean OR operator is used to invert the source bitmap and combine it with the pattern. The Boolean OR operator is then used to combine the result with the destination bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><b>SRCAND</b></td>
<td width=83%>The Boolean AND operator is used to combine the pixels of the source and destination bitmaps.</td>
</tr>
<tr valign=top>
<td width=17%><b>SRCCOPY</b></td>
<td width=83%>The source bitmap is copied to the destination bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><b>SRCERASE</b></td>
<td width=83%>The Boolean AND operator is used to invert the destination bitmap. The result is then combined with the source bitmap.</td>
</tr>
<tr valign=top>
<td width=17%><b>SRCINVERT</b></td>
<td width=83%>The Boolean XOR operator is used to combine the pixels of the source and destination bitmaps.</td>
</tr>
<tr valign=top>
<td width=17%><b>SRCPAINT</b></td>
<td width=83%>The Boolean OR operator is used to combine the pixels of the source and destination bitmaps.</td>
</tr>
<tr valign=top>
<td width=17%><b>WHITENESS</b></td>
<td width=83%>All output is turned white.</td>
</tr>
</table><br>
<p>
We want to copy a bitmap many times so that the entire form is covered in bitmaps, so we execute the following statement in a Visual Basic program:</p>
<pre><code>D = BitBlt(hDC, X, Y, PatternWidth, PatternHeight, hDC, 0, 0, SRCCOPY)
</code></pre>
<p>
The <b>SRCCOPY</b> constant tells the <b>BitBlt</b> function to copy the bitmap to the destination; in this case we are copying it to the form.</p>
<h2>Example Program</h2>
<p>
The following Visual Basic application displays a pattern over the entire area of a form. This example program uses the ARGYLE.BMP bitmap file shipped with Windows. You can substitute any other bitmap of your choice, as long as it is 32-by-32 pixels. This is hard-coded into the demonstration program in the <i>PatternWidth</i> and <i>PatternHeight</i> variables.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Set the Picture property of Form1 to the ARGYLE.BMP bitmap file (this file will be located in the WINDOWS directory).<br><br></li>
<li>
Add the following <b>Constant</b> and <b>Declare</b> statements to the General Declarations section of Form1 (note that the <b>Declare</b> statement must be typed as one single line of text):<pre><code>Const SRCCOPY = &amp;HCC0020
Declare Function BitBlt Lib "GDI" (ByVal hDestDC As Integer, ByVal X As Integer, 
 &nbsp; ByVal Y As Integer, ByVal nWidth As Integer, ByVal nHeight As Integer, ByVal 
 &nbsp; hSrcDC As Integer, ByVal XSrc As Integer, ByVal YSrc As Integer, ByVal dwRop 
 &nbsp; As Long) As Integer
</code></pre>
</li>
<li>
Add the following code to the Paint event for Form1:<pre><code>Sub Form_Paint()
 &nbsp;&nbsp; Dim X As Integer
 &nbsp;&nbsp; Dim Y As Integer
 &nbsp;&nbsp; Dim D As Integer
 &nbsp;&nbsp; Dim PatternHeight As Integer
 &nbsp;&nbsp; Dim PatternWidth As Integer
 &nbsp;&nbsp; Dim SM As Integer&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp; SM = ScaleMode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'save current value
 &nbsp;&nbsp; ScaleMode = 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'pixel
 &nbsp;&nbsp; PatternHeight = 32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'hard-coded value
 &nbsp;&nbsp; PatternWidth = 32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'hard-coded value&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp; For X = 0 To ScaleWidth Step PatternWidth
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Y = 0 To ScaleHeight Step PatternHeight
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D = BitBlt(hDC, X, Y, PatternWidth, PatternHeight, hDC, 0, 0, SRCCOPY)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next Y
 &nbsp;&nbsp; Next X
 &nbsp;&nbsp; ScaleMode = SM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'reset to previous value
End Sub
</code></pre>
</li>
</ol>
<p>
To execute this program, press the F5 function key. After a few seconds, the ARGYLE bitmap will be displayed over the entire area of the form.</p>
</BODY>
</HTML>
