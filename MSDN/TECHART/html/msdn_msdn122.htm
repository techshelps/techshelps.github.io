<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tip 122: Comparing Object Variables in Visual Basic</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><sup><a name="msdn_msdn122"></a></sup>Tip 122: Comparing Object Variables in Visual Basic</h1>
<p>
July 1, 1995</p>
<h2>Abstract</h2>
<p>
The IS operator in Microsoft® Visual Basic® lets you determine whether the names of two variables refer to the same object (a control or form). This article explains how you can compare two object variables to determine whether they are the same entity.</p>
<h2>Using the IS Operator</h2>
<p>
Microsoft® Visual Basic® allows you to dynamically create new objects at run time. For example, if you wanted to create another copy of Form1 while your program is running, you would issue a <b>Dim</b> statement to create an object variable of the Form type. The <b>Set</b> statement lets you create a new instance of a form or control. The just-cloned copy of the form or control inherits the same properties as the original form or control. Therefore, the <b>Set</b> command assigns a variable name to the cloned form or control, which allows you to keep track of the newly created objects. Later on in your Visual Basic application, you can use the IS operator to determine whether two object variables refer to the same control or form.</p>
<p>
In the example program below, you use the statement:</p>
<pre><code>If CopyOfForm Is Form1 Then...
</code></pre>
<p>
to see whether the new instance of the form you just created is the same as the original form. If it is, you display a message to that effect.</p>
<p>
When using object variables in your Visual Basic applications, you should be aware of two caveats. First, you cannot compare two object variables by using the equal ("=") operation. Second, the IS operator must be used within an If-Then statement, not from within a While loop.</p>
<h2>Example Program</h2>
<p>
This program shows how to compare two Visual Basic objects to see whether they are identical.
<ol>
<li>
Start a new project in Visual Basic. Form1 is created by default.<br><br></li>
<li>
Add the following code to the General Declarations section of Form1:<pre><code>Dim CopyOfForm As New Form1
</code></pre>
</li>
<li>
Add a <b>Command Button</b> control to Form1. Command1 is created by default.<br><br></li>
<li>
Add the following code to the Click event for Command1.<pre><code>Private Sub Command1_Click()
 &nbsp;&nbsp; Set CopyOfForm = Form1
 &nbsp;&nbsp; CopyOfForm.Show
 &nbsp;&nbsp; If CopyOfForm Is Form1 Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "CopyOfForm is a copy of Form1."
 &nbsp;&nbsp; End If
End Sub
</code></pre>
</li>
</ol>
<p>
Run the example program by pressing F5. The <b>Set</b> command creates the two forms, even though only one copy of the form is visible. A message box is displayed, confirming that the two object variables (CopyOfForm and Form1) are the same entities (that is, both forms have exactly the same property settings). Note that if you run the example program by first removing the <b>Set</b> statement in the Click event of Command1, the comparison does not find the two forms to be identical controls.</p>
</BODY>
</HTML>
