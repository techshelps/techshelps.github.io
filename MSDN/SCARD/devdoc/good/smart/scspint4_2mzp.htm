<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ISCardISO7816::SelectFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_smart_iscardiso7816_selectfile"></a>ISCardISO7816::SelectFile</h1>
<p>
The <b>SelectFile</b> method constructs an <a href="scgloss_7mw1.htm#_smart_apdu_gly">APDU</a> command that sets a current elementary file within a logical channel. Subsequent commands may implicitly refer to the current file through the logical channel.</p>
<p>
Selecting a directory (DF) within the card filestore — which may be the root (MF) of the filestore — makes it the current DF. After such a selection, an implicit current elementary file may be referred to through that logical channel.</p>
<p>
Selecting an elementary file sets the selected file and its parent as current files.</p>
<p>
After the answer to reset, the MF is implicitly selected through the basic logical channel, unless specified differently in the historical bytes or in the initial data string.</p>
<pre><code><b>HRESULT SelectFile(
  BYTE</b><i> byP1</i><b>,</b>
<b>  BYTE</b><i> byP2</i><b>,</b>
<b>  LPBYTEBUFFER</b><i> pData</i><b>,</b>
<b>  LONG</b><i> lBytesToRead</i><b>,</b>
<b>  LPSCARDCMD</b><i> *ppCmd</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>byP1, byP2 </i>[in] </dt>
<dd>
Selection control.
<p>
P1 (upper byte in word):

<table cellspacing=4 cols=9>
<tr valign=top>
<th align=left width=24%>Meaning</th>
<th align=left width=9%>8</th>
<th align=left width=10%>7</th>
<th align=left width=9%>6</th>
<th align=left width=10%>5</th>
<th align=left width=9%>4</th>
<th align=left width=10%>3</th>
<th align=left width=9%>2</th>
<th align=left width=10%>1</th>
</tr>
<tr valign=top>
<td width=24%>Select File ID</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>x</td>
<td width=10%>x</td>
</tr>
<tr valign=top>
<td width=24%>  EF, DF, or MF</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
</tr>
<tr valign=top>
<td width=24%>  child DF</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>1</td>
</tr>
<tr valign=top>
<td width=24%>  EF under DF</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>0</td>
</tr>
<tr valign=top>
<td width=24%>  parent DF of current DF</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>1</td>
</tr>
</table><br>


<table cellspacing=4 cols=9>
<tr valign=top>
<th align=left width=24%>Meaning</th>
<th align=left width=9%>8</th>
<th align=left width=10%>7</th>
<th align=left width=9%>6</th>
<th align=left width=10%>5</th>
<th align=left width=9%>4</th>
<th align=left width=10%>3</th>
<th align=left width=9%>2</th>
<th align=left width=10%>1</th>
</tr>
<tr valign=top>
<td width=24%>Select by DF Name</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>1</td>
<td width=9%>x</td>
<td width=10%>x</td>
</tr>
<tr valign=top>
<td width=24%>  DFname</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>1</td>
<td width=9%>0</td>
<td width=10%>0</td>
</tr>
<tr valign=top>
<td width=24%>  RFU</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>1</td>
<td width=9%>0</td>
<td width=10%>1</td>
</tr>
<tr valign=top>
<td width=24%>  RFU</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>1</td>
<td width=9%>1</td>
<td width=10%>0</td>
</tr>
<tr valign=top>
<td width=24%>  RFU</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>1</td>
<td width=9%>1</td>
<td width=10%>1</td>
</tr>
</table><br>


<table cellspacing=4 cols=9>
<tr valign=top>
<th align=left width=24%>Meaning</th>
<th align=left width=9%>8</th>
<th align=left width=10%>7</th>
<th align=left width=9%>6</th>
<th align=left width=10%>5</th>
<th align=left width=9%>4</th>
<th align=left width=10%>3</th>
<th align=left width=9%>2</th>
<th align=left width=10%>1</th>
</tr>
<tr valign=top>
<td width=24%>Select by path</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>0</td>
<td width=9%>x</td>
<td width=10%>x</td>
</tr>
<tr valign=top>
<td width=24%>  from MF</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
</tr>
<tr valign=top>
<td width=24%>  current DF</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>1</td>
</tr>
<tr valign=top>
<td width=24%>  RFU</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>0</td>
</tr>
<tr valign=top>
<td width=24%>  RFU</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>0</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>0</td>
<td width=9%>1</td>
<td width=10%>1</td>
</tr>
</table><br>


<p>
When P1=00, the card knows either because of a specific coding of the file ID or because of the context of execution of the command if the file to select is the MF, a DF, or an EF.

<p>
When P1-P2=0000, if a file ID is provided, then it shall be unique in the following environments:

<ul>
<li>
the immediate children of the current DF</li>
<li>
the parent DF</li>
<li>
the immediate children of the parent DF</li>
</ul>

<p>
If P1-P2=0000 and if the data field is empty or equal to 3F00, then select the MF.

<p>
When P1=04, the data field is a DF name, possibly right truncated.

<p>
When supported, successive such commands with the same data field shall select DFs whose names match with the data field (that is, start with the command data field). If the card accepts the command with an empty data field, then all or a subset of the DFs can be successively selected.

<p>
P2 (lower byte of word):

<table cellspacing=4 cols=9>
<tr valign=top>
<th align=left width=19%>Meaning</th>
<th align=left width=10%>8</th>
<th align=left width=10%>7</th>
<th align=left width=10%>6</th>
<th align=left width=10%>5</th>
<th align=left width=10%>4</th>
<th align=left width=10%>3</th>
<th align=left width=10%>2</th>
<th align=left width=11%>1</th>
</tr>
<tr valign=top>
<td width=19%>First occur</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>-</td>
<td width=10%>-</td>
<td width=10%>0</td>
<td width=11%>0</td>
</tr>
<tr valign=top>
<td width=19%>Last occur</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>-</td>
<td width=10%>-</td>
<td width=10%>0</td>
<td width=11%>1</td>
</tr>
<tr valign=top>
<td width=19%>Next occur</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>-</td>
<td width=10%>-</td>
<td width=10%>1</td>
<td width=11%>0</td>
</tr>
<tr valign=top>
<td width=19%>Previous occur</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>-</td>
<td width=10%>-</td>
<td width=10%>1</td>
<td width=11%>1</td>
</tr>
</table><br>



<table cellspacing=4 cols=9>
<tr valign=top>
<th align=left width=19%>Meaning</th>
<th align=left width=10%>8</th>
<th align=left width=10%>7</th>
<th align=left width=10%>6</th>
<th align=left width=10%>5</th>
<th align=left width=10%>4</th>
<th align=left width=10%>3</th>
<th align=left width=10%>2</th>
<th align=left width=11%>1</th>
</tr>
<tr valign=top>
<td width=19%>File Control</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>x</td>
<td width=10%>x</td>
<td width=10%>-</td>
<td width=11%>-</td>
</tr>
<tr valign=top>
<td width=19%>Return FCI</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>-</td>
<td width=11%>-</td>
</tr>
<tr valign=top>
<td width=19%>Return FCP</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>1</td>
<td width=10%>-</td>
<td width=11%>-</td>
</tr>
<tr valign=top>
<td width=19%>Return FMD</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>0</td>
<td width=10%>1</td>
<td width=10%>0</td>
<td width=10%>-</td>
<td width=11%>-</td>
</tr>
</table><br>

</dd>
<dt>
<i>pData </i>[in, defaultvalue(NULL)] </dt>
<dd>
Data for operation if needed; else, NULL. Types of data that are passed in this parameter include:</dd>
<dt>
</dt>
<dd>

<ul>
<li>
file ID</li>
<li>
path from the MF</li>
<li>
path from the current DF</li>
<li>
DF name</li>
</ul>
</dd>
<dt>
<i>lBytesToRead </i>[in, defaultvalue(0)] </dt>
<dd>
Empty (that is, 0) or maximum length of data expected in response.</dd>
<dt>
<i>ppCmd </i>[in, out] </dt>
<dd>
On input, a pointer to an <b>ISCardCmd</b> interface object or NULL.
<p>
On return, it is filled with the APDU command constructed by this operation. If <i>ppCmd</i> was set to NULL, a smart card <b>ISCardCmd</b> object is internally created and returned via the <i>ppCmd</i> pointer.
</dd>
</dl>
<p>
</p>
<h4>Return Values</h4>
<p>
The possible return values are the following:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=56%>Value</th>
<th align=left width=44%>Meaning</th>
</tr>
<tr valign=top>
<td width=56%>S_OK</td>
<td width=44%>Operation completed successfully.</td>
</tr>
<tr valign=top>
<td width=56%>E_INVALIDARG</td>
<td width=44%>Invalid parameter.</td>
</tr>
<tr valign=top>
<td width=56%>E_POINTER</td>
<td width=44%>A bad pointer was passed in.</td>
</tr>
<tr valign=top>
<td width=56%>E_OUTOFMEMORY</td>
<td width=44%>Out of memory.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
Unless otherwise specified, the correct execution of the encapsulated command modifies the security status according to the following rules:
<ul>
<li>
When the current elementary file is changed, or when there is no current elementary file, the security status specific to a former current elementary file is lost.</li>
<li>
When the current filestore directory (DF) is descendant of, or identical to the former current DF, the security status specific to the former current DF is lost. The security status common to all common ancestors of the previous and new current DF is maintained.</li>
</ul>
<p>
For a list of all the methods provided by the <b>ISCardISO7816</b> interface, see<b> ISCardISO7816</b>.</p>
<p>
In addition to the COM error codes listed above, this interface may return a smart card error code if a smart card function was called to complete the request. For information on smart card error codes, see <a href="scerrors_39v7.htm">Error Codes</a>.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 4.0 SP3 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Use Windows 95 OSR2.1.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in scardsrv.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> scardsrv.tlb.</p>
<h4>See Also</h4>
<p>
<a href="scspint4_1trq.htm"><b>ISCardISO7816</b></a></p>
<p>&nbsp;</p></body>
</HTML>
