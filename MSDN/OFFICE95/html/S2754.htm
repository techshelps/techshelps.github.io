<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A Simple Macro</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H2 CLASS="h1">A Simple Macro</H2><P CLASS="t">A good way to get started with WordBasic is to look at a simple macro. This one transposes characters (for example, to change "teh" to "the"). The following table illustrates the actions that the macro takes and the corresponding WordBasic instructions.</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="88pt" VALIGN="TOP"><COL WIDTH="186pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>What happens <BR>on the screen</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>WordBasic<BR>instruction</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B><BR>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tart"><img src="ATR0301.gif"></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="ct"></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Before the macro begins, the insertion point is positioned after the letters to be switched.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tart"><img src="ATR0302.gif"></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="ct">CharLeft 1, 1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">First, the macro moves the insertion point to the left by one character and selects that character.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tart"><img src="ATR0303.gif"></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="ct">EditCut</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Then it cuts the selected letter.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tart"><img src="ATR0304.gif"></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="ct">CharLeft 1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Then it moves the insertion point to the left by one character.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tart"><img src="ATR0305.gif"></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="ct">EditPaste</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Next, it pastes the character that was cut.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tart"><img src="ATR0306.gif"></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="ct">CharRight 1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Finally, it moves the insertion point to the right by one character&nbsp;—&nbsp;back to where it was before the macro began.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">You can easily record this macro by starting the macro recorder and performing the actions described in the table. (Remember, while recording a macro, you need to use the keyboard to move the insertion point and select text.) If you do so and then choose the Macro command (Tools menu) to open the macro in a macro-editing window, you'll see the following instructions:</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN
CharLeft 1, 1
EditCut
CharLeft 1
EditPaste
CharRight 1
End Sub
</PRE>
<P CLASS="t">As explained in the previous chapter, Sub MAIN and End Sub begin and end every macro. Notice that each instruction within the macro is on a separate line. You can place more than one instruction on the same line, but only if you separate each instruction with a colon (:). Generally, macros are easier to read if each instruction is on a separate line.</P>
<P CLASS="t">Also, notice the pattern of capitalization. When Word saves a macro, it gives the proper capitalization to every word that it recognizes as part of the WordBasic "vocabulary." You do not have to worry about typing instructions with the correct capitalization because WordBasic is not <I>case-sensitive</I>&nbsp;—&nbsp;it recognizes instructions typed in any combination of uppercase and lowercase letters.</P>
<P CLASS="t">Two of the instructions, CharLeft and CharRight, move the insertion point and optionally select text. The other two instructions, EditCut and EditPaste, correspond to the Cut and Paste commands on the Edit menu. In Word, virtually every action you can take has an equivalent WordBasic instruction.</P>
<P></P>

<TABLE COLS="1" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="348pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="sbrh"><B>Comments</B></P>
<P CLASS="sbrt">Comments explain a macro to others and remind you of the purpose of the macro or of particular instructions. Word ignores comments when it runs the macro.</P>
<P CLASS="sbrt">You can use the <B>REM</B> statement to insert a comment in a macro. For example:</P>
<P CLASS="ct">REM This is a comment</P>
<P CLASS="ct"></P>
<P CLASS="sbrt">Or you can use an apostrophe:</P>
<P CLASS="ct">'This is also a comment</P>
<P CLASS="ct"></P>
<P CLASS="sbrt">Both ways of commenting have advantages. The <B>REM</B> statement helps to make comments visible. But <B>REM</B> and the comment that follows it must be on their own line. You can use an apostrophe to place a comment on the same line as an instruction. Word interprets any text after the apostrophe until the end of the line as a comment. For example, you could add comments to these instructions from the macro that transposes characters described earlier in this chapter:</P>
<P CLASS="ct">CharLeft 1, 1            'Select character to the left</P>
<P CLASS="ct">EditCut                    'Cut selected character</P>
<P CLASS="ct"></P>
<P CLASS="sbrt">You can use the Add/Remove REM button on the Macro toolbar to easily add or remove <B>REM</B> statements. For more information about using the Add/Remove REM button, see Chapter 6, "Debugging."</P>
<P CLASS="sbrh"><B></B></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P></FONT></FONT></BODY></HTML>
