<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a Custom Menu Bar</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Adding a Custom Menu Bar</H2><P CLASS="t">If you want to design a set of drop-down menus that differs significantly from what is available on the built-in menu bars, you may need to create a new menu bar. You can accomplish this using the Menu Editor or Visual Basic procedures.</P>
<H3><A NAME="sec0"></A>Using the Menu Editor</H3><P CLASS="t">The Menu Editor provides a convenient way to add a custom menu bar to the active workbook.</P>
<P CLASS="proch"><B><img src="prcarrow.gif">    To add a menu bar to a workbook</B></P>
<P CLASS="ls">    1.    While a Visual Basic module is active, click Menu Editor on the Tools menu.</P>
<P CLASS="ls">    2.    In the Menu Bars box, click the arrow to display the drop-down list, and then click the name of any menu bar.</P>
<P CLASS="lt1">This step cancels the selection of items in the Menus, Menu Items, and Submenu Items boxes. If you omit this step, the text you type in the Caption box becomes the first menu item on the first menu that's selected in the Menus&nbsp;box.</P>
<P CLASS="ls">    3.    Click Insert.</P>
<P CLASS="ls">    4.    In the Caption box, either type a name for the new menu bar or accept the default name.</P>
<P></P>
<P CLASS="t">The new menu bar is added to the list in the Menu Bars box, below the final item. The default list of built-in menu bars is shown in the following table. The custom menu bars you create are listed in the order they're created. You can use up to 15 custom menu bars at one time.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="84pt" VALIGN="TOP"><COL WIDTH="263pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Menu bar</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Worksheet</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The menu bar that appears when a worksheet is active</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Chart</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The menu bar that appears when a chart is active</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">No Documents Open</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The menu bar that appears when no workbooks are open</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Visual Basic Module</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The menu bar that appears when a Visual Basic module is active</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Shortcut Menus 1</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A group of shortcut menus that appears when the user clicks a toolbar, toolbar button, cell, column or row selection, workbook tab, window title bar, or the desktop with the right mouse button</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Shortcut Menus 2</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A group of shortcut menus that appears when the user clicks a drawing object, button graphic object, or text box graphic object with the right mouse button</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Shortcut Menus 3</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">A group of shortcut menus that appears when the user clicks a chart series, text, plot area, axis, gridline, floor or arrow, legend, or the entire chart with the right mouse button</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">A shortcut menu is a type of menu, and each shortcut menu is represented by a <B>Menu</B> object in Visual Basic. Although shortcut menus are shown grouped into menu bars in the Menu Editor, a shortcut menu group isn't represented by a <B>MenuBar</B> object in Visual Basic.</P>
<P></P>
<H3><A NAME="sec1"></A>Using Visual Basic</H3><P CLASS="t">Use the <B>Add</B> method of the <B>MenuBars</B> collection to create a new menu bar; specifying the name of the new menu bar is optional.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars.Add "myWorksheetMenubar"
</FONT></PRE>
<P CLASS="t">The <B>MenuBars</B> collection contains all the menu bars available in Microsoft Excel. The shortcut menu groups that appear in the Menu Editor cannot be accessed with the <B>MenuBars</B> method, as they aren't true menu bars. Use the <B>ShortcutMenus</B> method to access a shortcut menu, as described later in this chapter.</P></FONT>
</FONT></BODY></HTML>
