<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the ThisWorkbook Property</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Using the ThisWorkbook Property</H2><P CLASS="t">The most important thing to remember when writing an add-in is the definition of the active workbook. The active workbook is the one that's on top in the Microsoft Excel window. The active workbook isn't necessarily the one that contains the running Visual Basic code. In fact, an add-in can never be the active workbook, because it's invisible.</P>
<P CLASS="t">When you're writing and debugging an add-in, the workbook that contains the code is often the active workbook. Therefore, statements that contain an implicit <B>ActiveWorkbook</B> property call — such as DialogSheets("MyDialog").Show — work properly. When you compile the add-in and run the same code, the implicit <B>ActiveWorkbook</B> property call returns the workbook that's on top, not the workbook that contains the dialog sheet named "MyDialog." This causes the code to fail.</P>
<P CLASS="t">Using the <B>ThisWorkbook</B> property eliminates the workbook referencing problem. In addition to using <B>ThisWorkbook</B>, you should always use complete references to objects, meaning that you should start with <B>ThisWorkbook</B> and then navigate down the object hierarchy, as shown in the following code.</P>
<P CLASS="a">    <img src="APG1201.gif"></P>
<P CLASS="t">Don't forget that objects are often used in arguments to methods; it's very easy to overlook the workbook reference issue in such cases, as shown in the following code.</P>
<P CLASS="a">    <img src="APG1202.gif"></P></FONT>
</FONT></BODY></HTML>
