<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Filter Event -- Event Procedures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H1><A NAME="sec90"></A>Filter Event -- Event Procedures</H1><P CLASS="t">  </P>
<H2><A NAME="sec91"></A>Description</H2><P>To create an event procedure that is executed when the Filter event occurs, set the <B>OnFilter</B> property to [Event Procedure], and click the Build button.</P>
<H2><A NAME="sec92"></A>Syntax</H2><P><B>Private Sub Form_Filter(</B>Cancel <B>As Integer</B>, FilterType <B>As Integer)</B></P>
<P>The Filter event procedure uses the following arguments.</P>
<P CLASS="t">  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="268pt" VALIGN="TOP"></COLGROUP><TBODY><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Argument</B></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Description</B></P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Cancel</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The setting determining whether to open the filter window. Setting Cancel to <B>True</B> (-1) prevents the filter window from opening. You can also use the <B>CancelEvent</B> method of the <B>DoCmd</B> object to cancel opening the filter window.</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">FilterType</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The filter window the user is trying to open. The FilterType argument can be one of the following intrinsic constants:</P>
<P CLASS="t"><B>Constant</B>                         <B>Value</B></P>
<P CLASS="t"><B>acFilterByForm</B>             0</P>
<P CLASS="t"><B>acFilterAdvanced</B>          1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H2><A NAME="sec93"></A>Remarks</H2><P>You can use the Filter event procedure to disable or hide certain controls in the Filter By Form window, preventing them from being used in filter criteria. For example, you may always want your Orders form to show records that have a value in the TotalDue control, no matter how small. You can disable or hide this control in the Filter event procedure, then enable or show it in the ApplyFilter event procedure. Disabling and hiding controls in the Filter By Form window is best accomplished in the Filter event procedure rather than the Filter macro, because you can check the FilterType argument to see if the user opened the Filter By Form window. All of the fields in a form appear in the Advanced Filter/Sort window, even if the controls are disabled or hidden.</P>
<H2><A NAME="sec94"></A>See Also</H2><P>Filter Event — Macros.</P>
<H2><A NAME="sec95"></A>Example</H2><P>The following example shows how to disable the TotalDue control on an Orders form when the user tries to create a filter, so that the user can’t filter on this field. Any records that have a TotalDue value and meet the other filter criteria will always be shown on the filtered form. This example also forces the user to use the Filter By Form window and not the Advanced Filter/Sort window.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>Private<B> </B>Sub Form_Filter(Cancel As Integer, FilterType As Integer)
    If FilterType = acFilterByForm Then
        Forms!Orders!TotalDue.Enabled = False
    ElseIf FilterType = acFilterAdvanced Then
        MsgBox "The best way to filter this form is to use the " &amp; _
            "Filter By Form command or toolbar button.", vbOKOnly + _            vbInformation
        Cancel = True
    End IfSub</PRE>
<P CLASS="t">  </P>
<P CLASS="t"> </P>
</FONT></FONT></BODY></HTML>
