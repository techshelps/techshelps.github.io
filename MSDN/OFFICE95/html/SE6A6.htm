<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLRequest Function</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>SQLRequest Function</H1><P CLASS="h"><B>Description</B></P>
<P CLASS="t">In Microsoft Excel for Windows 95, do not use <B>SQLRequest</B> and the other ODBC functions in the XLODBC.XLA add-in; use the objects, methods, and properties in the Data Access Objects (DAO) library instead. </P>
<P CLASS="t"><B>SQLRequest</B> connects to an external data source and runs a query from a worksheet, and then returns the result as an array.</P>
<P CLASS="t">This function is contained in the XLODBC.XLA add-in (ODBC Add-In on the Macintosh). Before you use the function, you must establish a reference to the add-in using the References command (Tools menu).</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SQLRequest</B>(<B><I>connectionStr</I></B><I>, </I><B><I>queryText</I></B><I>, </I><B><I>outputRef</I></B><I>, </I><B><I>driverPrompt</I></B><I>, </I><B><I>colNamesLogical</I></B>)</P>
<P CLASS="term1"><B><I>connectionStr</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. Supplies information, such as the data source name, user ID, and passwords, required by the driver being used to connect to a data source and must follow the driver's format. </P>
<P CLASS="dt1">You must define the data source name (DSN) used in <B><I>connectionStr</I></B> before you try to connect to it. </P>
<P CLASS="dt1">If <B>SQLRequest</B> is unable to access the data source using <B><I>connectionStr</I></B>, it returns Error 2042.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>queryText</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. The SQL statement that you want to execute on the data source.</P>
<P CLASS="dt1">If <B>SQLRequest</B> is unable to execute <B><I>queryText</I></B> on the specified data source, it returns Error 2042.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>outputRef</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. A single worksheet cell, as a <B>Range</B> object, where you want the completed connection string placed.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>driverPrompt</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. Specifies when the driver dialog box is displayed and which options are available. Use one of the numbers described in the following table. If <B><I>driverPrompt</I></B> is omitted, <B>SQLRequest</B> uses 2 as the default.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="161pt" VALIGN="TOP"><COL WIDTH="172pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Value</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Meaning</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"><B></B></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>1</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is always displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>2</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is displayed only if information provided by the connection string and the data source specification is not sufficient to complete the connection. All dialog box options are available.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>3</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is displayed only if information provided by the connection string and the data source specification is not sufficient to complete the connection. Dialog box options are dimmed and unavailable if they are not required.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>4</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Dialog box is not displayed. If the connection is not successful, it returns an error.</P></FONT></TD></TR></TBODY></TABLE>
</BLOCKQUOTE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="term1"><B><I>colNamesLogical</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. <B>True</B> if you want the column names to be returned as the first row of results. It should contain <B>False</B> if you do not want the column names returned. The default value, if <B><I>colNamesLogical</I></B> is omitted, is <B>False</B>.</P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">The arguments to the <B>SQLRequest</B> function are in a different order than the arguments to the SQL.REQUEST macro function.</P>
<P CLASS="h"><B>Return Value</B></P>
<P CLASS="t">If this function completes all of its actions, it returns an array of query results or the number of rows affected by the query.</P>
<P CLASS="t">If <B>SQLRequest</B> is unable to complete all of its actions, it returns an error value and places the error information in memory for <B>SQLError</B></P>
<P CLASS="t">If <B>SQLRequest</B> is unable to access the data source using <B><I>connectionStr</I></B>, it returns Error 2042.</P>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>SQLBind</B> Function, <B>SQLClose</B> Function, <B>SQLError</B> Function, <B>SQLExecQuery</B> Function, <B>SQLGetSchema</B> Function, <B>SQLOpen</B> Function, <B>SQLRetrieve</B> Function, <B>SQLRetrieveToFile</B> Function.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example runs a query on the NWind sample database. The result of the query, displayed on Sheet1, is a list of all products that are currently on order. The <B>SQLRequest</B> function also writes the full connection string to Sheet2.</P>
</BLOCKQUOTE>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">If Application.OperatingSystem Like "*Win*" Then
    databaseName = "NWind"
Else        'Macintosh
    databaseName = "NorthWind"
End If
queryString = "SELECT * FROM product.dbf WHERE (product.ON_ORDER&lt;&gt;0)"
returnArray = SQLRequest("DSN=" &amp; databaseName, _
            queryString, _
            Worksheets("Sheet1").Range("A1"), _
            2, True)
For i = LBound(returnArray, 1) To UBound(returnArray, 1)
    For j = LBound(returnArray, 2) To UBound(returnArray, 2)
        Worksheets("Sheet1").Cells(i, j).Formula = returnArray(i, j)
    Next j
Next i
</FONT></PRE></FONT>
</FONT></BODY></HTML>
