<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Understanding Messages</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H3 CLASS="h2">Understanding Messages</H3><H4 CLASS="h3"><A NAME="sec0"></A>The Current Messages</H4><P CLASS="t">The workgroup extensions for Word maintain two <I>current messages</I> in memory. The <I>current outbound message</I> is the message you are preparing to send with <B>MAPISendMail</B> or to save with <B>MAPISaveMail</B>. The <I>current inbound message </I>is the message you most recently read with <B>MAPIReadMail</B>. MAPISet helper functions update the current outbound message, while MAPIQuery helper functions retrieve information from the current inbound message.</P>
<P CLASS="t">To send the current outbound message, use <B>MAPISendMail</B>. To save the current outbound message in the Mail Inbox without sending it, use <B>MAPISaveMail</B>. To retrieve a message from the Inbox and make it the current inbound message, use <B>MAPIFindNext</B> and <B>MAPIReadMail</B>.</P>
<P CLASS="t">The workgroup extensions for Word initialize both current messages when your macro calls the <B>MAPILogon</B> function. It removes both current messages from memory when your macro ends.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Recipients</H4><P CLASS="t">Messages are sent to a recipient list. Each recipient is identified with a <I>friendly name</I> and an <I>address</I>. A friendly name is the descriptive name of the user. Friendly names can be ambiguous, so additional information is required to guarantee unique addressing. The address is a unique string that contains the account name of the user and must be unambiguous. The address string format varies depending on the configuration of the Mail transport system and must be obtained from the workgroup extensions before it can be used. The workgroup extensions return both strings for recipients that are selected using the Mail Address Book.</P>
<P CLASS="t">When setting message recipients, use both the name and address strings to avoid problems with ambiguous names. If you do not supply an address string, the recipient is treated as unresolved. When sending a message, the workgroup extensions will automatically attempt to resolve unresolved recipients and will return an error if it cannot resolve all recipients. You can use <B>MAPIResolveName</B> to force resolution before sending.</P>
<P CLASS="t">WBMAPI.DLL initializes a recipient list for the current outbound message when your macro calls the <B>MAPILogon</B> function. It removes the recipient list from memory when your macro ends.</P></FONT></FONT></BODY></HTML>
