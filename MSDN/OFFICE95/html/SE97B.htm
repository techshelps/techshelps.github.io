<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Event Procedures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Creating Event Procedures</H2><P CLASS="t">Unlike Visual Basic, VBA does not have a pre-defined list of event procedures handy in a control's property sheet.  Generally one event is supported per control.  For instance, when first showing a VBA dialog, Excel supports an event to initialize the dialog's controls, set focus, and do other things.  There are two ways to create the event code.  The first one is to create an init procedure for the dialog by writing one in a Module sheet, for instance:  </P>
<P CLASS="t"></P>
<P>Sub Wiz1_init()</P>
<P>    'Set the focus to the edit box for the data range:</P>
<P>    DialogSheets("Wiz1").Focus =DialogSheets("Wiz1").[RangeEdit].Name</P>
<P>End Sub </P>
<P CLASS="t"></P>
<P CLASS="t">Now, switch back to the dialog editor and select the dialog.  Do this by clicking on its edge, or anywhere in its title bar.  The entire dialog will be outlined if it was selected properly.  Next, right-click the edge or title bar and select Assign Macro.  In the next dialog box, pick out the name of the init procedure just created.  Now when Excel displays the dialog the init procedure will run before the user sees the dialog box.  The advantage of this method is that the writer can control the exact procedure name and where the procedure appears in the module sheet.  </P>
<P CLASS="t">The other way to create the procedure is to select the control or dialog and then click the Edit Code button <img src="20502.gif"> on the Forms toolbar.  Excel will create the stub of a procedure, complete with a small commented header.  Then add the rest of the code.  </P></FONT>
</FONT></BODY></HTML>
