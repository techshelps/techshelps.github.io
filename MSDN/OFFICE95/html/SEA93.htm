<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OnRepeat and OnUndo Methods</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>OnRepeat and OnUndo Methods</H2><P CLASS="t">An OnRepeat event handler runs when the user clicks Repeat on the Edit menu. A good use for an OnRepeat event handler is to allow the user to rerun a macro that performs a series of complicated operations on a worksheet. (Usually, clicking Repeat on the Edit menu after a macro has run will repeat only the last operation in the macro.)</P>
<P CLASS="t">You can use the <B><I>procedure</I></B> argument to the <B>OnRepeat </B>method of the <B>Application</B> object to customize the the Repeat menu item and to associate a procedure with the action of clicking this menu item.</P>
<P CLASS="t">For example, suppose that after pasting a date into a cell, you want to increment the date by one day in each successive paste from the cell above the active cell. To do this, you might use code such as that shown in the following procedure.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub TrapRepeat()
    Application.OnRepeat _ 
        text:= "Paste Next Day", _ 
        procedure := "PasteIncrement"
End Sub

Sub PasteIncrement()                            'OnRepeat handler.
    With ActiveCell
        .Value = .Offset(-1, 0) + 1            'Add a day.
    End With
End Sub
</FONT></PRE>
<P CLASS="t">Similarly, an OnUndo event handler runs when the user clicks Undo on the Edit menu. You use the <B><I>procedure</I></B> argument to the <B>OnUndo</B> method of the <B>Application</B> object to customize the Undo menu item and to associate a procedure with the action of clicking this menu item.</P>
<P CLASS="t">For example, in a procedure that inserts a row containing data for a new record, the last action might be to enter data in a cell; when this happens, the Undo menu item changes to Undo Entry. However, choosing this command removes the information entered in the cell, when you'd probably want to delete the entire row with a command named Undo New Record instead.</P></FONT>
</FONT></BODY></HTML>
