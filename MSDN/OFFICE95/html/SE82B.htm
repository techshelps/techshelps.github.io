<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FILES</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="building filenames list"><META NAME="MS-HKWD" CONTENT="filenames list"><META NAME="MS-HKWD" CONTENT="filenames, returning"><META NAME="MS-HKWD" CONTENT="FILES function"><META NAME="MS-HKWD" CONTENT="list of filenames"><META NAME="MS-HKWD" CONTENT="macro operation, filenames list"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    FILES</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Returns a horizontal text array of the names of all files in the specified directory or folder. Use FILES to build a list of filenames upon which you want your macro to operate.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>FILES</B>(directory_text)</P>
<P CLASS="t">Directory_text    specifies which directories or folders to return filenames from.</P>
<UL><LI>Directory_text accepts an asterisk (*) to represent a series of characters and a question mark (?) to represent a single character in filenames.</LI><LI>If directory_text is not specified, FILES returns filenames from the current directory.</LI></UL><P></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">If you enter FILES in a single cell, only one filename is returned. You will normally use FILES with SET.NAME to assign the returned array to a name. See the last example below.</P>
<P></P>
<P CLASS="nh"><B><B>Tips</B>    You can use COLUMNS to count the number of entries in the returned array. You can use TRANSPOSE to change a horizontal array to a vertical one.</B></P>
<P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">In Microsoft Excel for Windows, the following macro formula returns the names of all files starting with the letter F in the current directory or folder:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FILES("F*.*")
</FONT></PRE>
<P CLASS="t">When entered as an array formula in several cells, the following macro formula returns the filenames in the current directory to those cells. If the directory contains fewer files than can fit in the selected cells, the #N/A error value appears in the extra cells.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FILES()
</FONT></PRE>
<P CLASS="t">In Microsoft Excel for Windows, the following macro formula returns all files starting with "SALE" and ending with the .XLC extension in the \EXCEL\CHARTS subdirectory:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FILES("C:\EXCEL\CHARTS\SALE*.XLC")
</FONT></PRE>
<P CLASS="t">In Microsoft Excel for the Macintosh, the following macro formula returns all files starting with "SALE" in the nested CHART folder:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FILES("DISK:EXCEL:CHART:SALE*")
</FONT></PRE>
<P CLASS="t">The following macro stores the names of the files in the current directory in the named array FileArray</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">SET.NAME("FileArray",FILES())</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE871.HTM">DOCUMENTS</A>    Returns the names of the specified open workbooks</P>
<P><A class="normal" href="SE788.HTM">FILE.DELETE</A>    Deletes a file</P>
<P><A class="normal" href="SE883.HTM">OPEN</A>    Opens a workbook</P>
<P><A class="normal" href="SE76B.HTM">SET.NAME</A>    Defines a name as a value</P>
<P>List of <A class="normal" href="SE748.HTM">Information Functions</A></P></FONT>
</FONT></BODY></HTML>
