<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ExecuteExcel4Macro Method</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>ExecuteExcel4Macro Method</H1><P CLASS="h"><B>Applies To</B></P>
<P CLASS="t"><B>Application </B>Object.</P>
<P CLASS="h"><B>Description</B></P>
<P CLASS="t">Runs a Microsoft Excel 4.0 macro function and returns the results of the function. Returned type depends on the function. Read-write.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><I>object</I>.<B>ExecuteExcel4Macro(</B><B><I>string</I></B><B>)</B></P>
<P CLASS="term1"><I>object</I></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. The <B>Application</B> object.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>string</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. A Microsoft Excel 4.0 macro language function without the equal sign. All references must be given as R1C1 strings. If <B><I>string</I></B> contains embedded double quotation marks, then you must double them. For example, to run the macro function =MID("sometext",1,4), <B><I>string</I></B> would have to be "MID(""sometext"",1,4)".</P>
</BLOCKQUOTE>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">The Microsoft Excel 4.0 macro is not evaluated in the context of the current workbook or sheet. This means that any references should be external and should specify an explicit workbook name. For example, to run a Microsoft Excel 4.0 macro "My_Macro" in Book1 you must use "Book1!My_Macro()". If you do not specify the workbook name, this method fails.</P>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>Run</B> Method.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example runs the <B>GET</B>.<B>CELL(42) </B>macro function on cell C3 on Sheet1 and displays the result in a message box. The <B>GET</B>.<B>CELL(42) </B>macro function returns the horizontal distance from the left edge of the active window to the left edge of the active cell. This macro function has no direct Visual Basic equivalent.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Worksheets("Sheet1").Activate
Range("C3").Select
MsgBox ExecuteExcel4Macro("GET.CELL(42)")
</FONT></PRE></FONT>
</FONT></BODY></HTML>
