<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDEInitiate()</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">DDEInitiate()</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>DDEInitiate(</B><I>Application$</I><B>, </B><I>Topic$</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Initiates a dynamic-data exchange (DDE) conversation with an application and opens a DDE channel through which the conversation takes place. If <B>DDEInitiate</B><B>()</B> is able to open a channel, it returns the number of the open channel, which is an integer greater than 0 (zero). (The first DDE channel Word opens during a session is channel 1, the second is channel 2, and so on.) All subsequent DDE instructions during the DDE conversation use this number to specify the channel. <B>DDEInitiate</B><B>()</B> returns 0 (zero) if it fails to open a channel.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">In Word version 6.0 for Windows NT and Word version 7.0, you cannot depend on a program started with <B>Shell</B> to be finished loading before the instructions following the <B>Shell</B> statement in your macro are run. A <B>DDEInitiate</B> instruction that tries to communicate with an application that has not finished loading will generate errors. To avoid this problem, you can use a <B>For...Next</B> loop to delay the <B>DDEInitiate</B> instruction until the other application is loaded. For example:</P>
<P CLASS="spacing"><BR></P>
<PRE>If AppIsRunning("Microsoft Access") = 0 Then
    Shell "MSACCESS.EXE", 0
    For i = 1 to 2000
        x = i
    Next i
End IF
chan = DDEInitiate("MSAccess", "System")</PRE>
<P></P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="274pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Application$ </I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The name used to specify an application that supports DDE as a DDE server. In Windows, this is usually the name of the application's .EXE file without the .EXE filename extension. If the application is not running, <B>DDEInitiate</B><B>()</B> cannot open a channel and returns an error. </P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Topic$ </I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The name of a topic recognized by <I>Application$</I>. An open document is a typical topic. (If <I>Topic$</I> is a document name, the document must be open.) If <I>Application$</I> doesn't recognize <I>Topic$</I>, <B>DDEInitiate</B><B>()</B> generates an error.</P>
<P CLASS="tt">Many applications that support DDE recognize a topic named System, which is always available and can be used to find out which other topics are available. For more information on the System topic, see <B>DDERequest$</B><B>()</B>.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The maximum number of channels that can be open simultaneously is determined by Microsoft Windows and your system's memory and resources. If you aren't using an open channel, you should conserve resources by closing the channel using <B>DDETerminate</B> or <B>DDETerminateAll</B>.</P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">This example opens a channel to Microsoft Excel and the file SALES.XLS (Windows) or BLUE SKY SALES (Macintosh). The variable channel is assigned the channel number that is returned. If Microsoft Excel is not running or the file is not open, the function returns 0 (zero) and generates an error.</P>
<P CLASS="t">Here is the Windows version of the example:</P>
<P CLASS="spacing"><BR></P>
<PRE>channel&nbsp;=&nbsp;DDEInitiate("Excel", "C:\EXCEL\EXAMPLES\SALES.XLS")
</PRE>
<P CLASS="t">And here is the Macintosh version:</P>
<P CLASS="spacing"><BR></P>
<PRE>channel&nbsp;=&nbsp;DDEInitiate("Excel", "HD1:EXCEL:EXAMPLES:BLUE SKY SALES")
</PRE>
<P CLASS="t">The following example first ensures that Microsoft Excel is running, and then opens a channel to Microsoft Excel and the System topic and uses <B>DDERequest$</B><B>()</B> to get the Topics item. The Topics item, a standard item in the System topic that is always available, is a list of available topics, including the names of open documents.</P>
<P CLASS="t">Here is the Windows version of the example:</P>
<P CLASS="spacing"><BR></P>
<PRE>If AppIsRunning("Microsoft Excel")&nbsp;=&nbsp;0 Then
Shell "C:\EXCEL\EXCEL.EXE"
AppActivate "Microsoft Word", 1
End If
channel&nbsp;=&nbsp;DDEInitiate("Excel", "System")
topics$&nbsp;=&nbsp;DDERequest$(channel, "Topics")
If InStr(topics$, "Sheet1") &lt;&gt; 0 Then 
    MsgBox "Sheet1 is an available topic."
End If
DDETerminate channel
</PRE>
<P CLASS="t">And here is the Macintosh version:</P>
<P CLASS="spacing"><BR></P>
<PRE>If AppIsRunning(MacID$("XCEL"))&nbsp;=&nbsp;0 Then
Shell MacID$("XCEL")
AppActivate MacID$("MSWD"), 1
End If
channel&nbsp;=&nbsp;DDEInitiate("Excel", "System")
topics$&nbsp;=&nbsp;DDERequest$(channel, "Topics")
If InStr(topics$, "Sheet1") &lt;&gt; 0 Then 
    MsgBox "Sheet1 is an available topic."
End If
DDETerminate channel
</PRE>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>DDEExecute</B>,<B> DDEPoke</B>,<B> DDERequest$</B><B>()</B>,<B> DDETerminate</B>,<B> DDETerminateAll</B></P></FONT></FONT></BODY></HTML>
