<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MouseMove Event -- Event Procedures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H1><A NAME="sec179"></A>MouseMove Event -- Event Procedures</H1><P CLASS="t">  </P>
<H2><A NAME="sec180"></A>Description</H2><P>To create an event procedure that is executed when the MouseMove event occurs, set the <B>OnMouseMove</B> property to [Event Procedure], and click the Build button.</P>
<H2><A NAME="sec181"></A>Syntax</H2><P><B>Private Sub Form_MouseMove(</B>Button<B> As Integer</B>,<B> </B>Shift<B> As Integer</B>,<B> </B>X<B> As ÂSingle</B>,<B> </B>Y<B> As Single)</B><B>Private Sub</B> <I>controlname</I>_<B>MouseMove(</B>Button <B>As Integer</B>, Shift <B>As Integer</B>, X <B>ÂAs</B> <B>Single</B>, Y <B>As Single)</B></P>
<P></P>
<P>The MouseMove event uses the following arguments.</P>
<P CLASS="t">  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="100pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"></COLGROUP><TBODY><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Argument</B></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Description</B></P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><I>controlname</I></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">A string that is the name of the control affected by the MouseMove event procedure.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="100pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"></COLGROUP><TBODY><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Argument</B></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Description</B></P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Button</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The state of the mouse buttons when the event occurs. If you need to test for the Button argument, you can use one of the following intrinsic constants as bit masks:</P>
<P CLASS="t"><B>Constant</B>    <B>Description</B></P>
<P CLASS="t"><B>acLeftButton    </B>Bit mask for the left mouse button.</P>
<P CLASS="t"><B>acRightButton    </B>Bit mask for the right mouse button.</P>
<P CLASS="t"><B>acMiddleButton    </B>Bit mask for the middle mouse button.</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Shift</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The state of the SHIFT, CTRL, and ALT keys when the button specified by the Button argument was pressed or released. If you need to test for the Shift argument, you can use one of the following intrinsic constants as bit masks:</P>
<P CLASS="t"><B>Constant</B>    <B>Description</B></P>
<P CLASS="t"><B>acShiftMask</B>    Bit mask for the SHIFT key.</P>
<P CLASS="t"><B>acCtrlMask</B>    Bit mask for the CTRL key.</P>
<P CLASS="t"><B>acAltMask</B>    Bit mask for the ALT key.</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">X, Y</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The x and y coordinates of the current location of the mouse pointer. X and Y are always expressed in twips.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P>You test for a condition by first assigning each result to a temporary <B>Integer</B> variable and then comparing the Shift or Button argument to as intrinsic constant. Use the <B>And</B> operator with the Button argument to test whether the condition is greater than 0, indicating that the left, middle, or right mouse button was pressed, as in the following example.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>LeftDown = (Button And acLeftButton) &gt; 0
</PRE>
<P CLASS="t">  </P>
<P>In a procedure, you can test for any combination of conditions, as in the following example.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>If ShiftDown And CtrlDown Then
    .    ' Do this if SHIFT and CTRL keys are pressed.
    .
    .
</PRE>
<P CLASS="t">  </P>
<P></P>
<P CLASS="t">  </P>
<P><B>Note</B>   The Button argument for the MouseDown and MouseUp events differs from the Button argument for MouseMove. For the MouseMove event, the Button argument indicates the current state of all buttons; a single MouseMove event can indicate that some, all, or no button is pressed. For example, if you press both the left and right buttons while moving the mouse, the Button argument is set to 3 (1 + 2). For the MouseDown and MouseUp events, the Button argument indicates one button per event.</P>
<P CLASS="t">  </P>
<P></P>
<H2><A NAME="sec182"></A>Remarks</H2><P>You can use the arguments for the KeyDown, KeyPress, and KeyUp events, in conjunction with the arguments for the MouseDown, MouseUp, and MouseMove events, to make your application work smoothly for both keyboard and mouse users. For example, you may need to coordinate the keyboard focus with the mouse focus. Normally, these are the same. For example, if you move the mouse pointer to a text box and click the mouse button, both the keyboard focus and the mouse focus move to the text box. However, moving the mouse pointer over a control does not move the keyboard focus to that control. You need to click a mouse button, use one of the keyboard navigation keys, or set the focus to the control in the MouseMove event procedure.</P>
<P>Since the MouseMove event occurs for each area of the form it moves over, you can end up with a multitude of MouseMove events if you donít control them. You may want to make sure that if a control or section has received a MouseMove event, the event doesnít occur for the control or section again while the mouse pointer is still on this area of the form. To do this, set and check a module variable that indicates whether the MouseMove event has already occurred for this control or form section.</P>
<P>You canít cancel the MouseMove event.</P>
<H2><A NAME="sec183"></A>See Also</H2><P>MouseMove Event ó Macros.</P>
<H2><A NAME="sec184"></A>Example</H2><P>The following example determines where the mouse is and whether the left mouse button and/or the SHIFT key is pressed. The X and Y coordinates of the mouse pointer position are displayed in a label control as you move the mouse.</P>
<P>To try this example, add the following code to the Declarations section of a module for a form that contains a label named Coordinates.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>Private Sub Detail_MouseMove(Button As Integer, Shift As Integer, _
        X As Single, Y As Single)
    Dim intShiftDown As Integer, intLeftButton As Integer

    Coordinates.Caption = X &amp; " , " &amp; Y
    ' Use bit masks to determine state of SHIFT key and left button.
    intShiftDown = Shift And acLeftButton
    intLeftButton = Button And acShiftMask
    ' Check that SHIFT key and left button are both pressed.
    If intShiftDown And intLeftButton &gt; 0 Then
        MsgBox "Shift key and left mouse button were pressed."
    End IfSub</PRE>
<P CLASS="t">  </P>
<P CLASS="t"> </P>
</FONT></FONT></BODY></HTML>
