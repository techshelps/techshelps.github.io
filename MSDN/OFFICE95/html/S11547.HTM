<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DateDiff Function</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h1><a name="sec121"></a>DateDiff Function</h1>

<h2><a name="sec122"></a>Description</h2>

<p>Returns the number of time intervals between two specified
dates.</p>

<h2><a name="sec123"></a>Syntax</h2>

<p><b>DateDiff(</b><b><i>interval</i></b><b>,</b> <i>date1</i><b>,</b>
<i>date2</i>[<i>, firstdayofweek</i>[, <i>firstweekofyear</i>]]<b>)</b></p>

<p>The <b>DateDiff</b> function syntax has these named arguments:</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>interval</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">String expression, as described in
        Settings, that is the interval of time you use to
        calculate the difference between <i>date1</i> and <i>date2</i>.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>date1, date2</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Two dates you want to use in the
        calculation.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>firstdayofweek</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A constant, as described in Settings,
        that specifies the first day of the week. If not
        specified, Sunday is assumed.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>firstweekofyear</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A constant, as described in Settings,
        that specifies the first week of the year. If not
        specified, the first week is assumed to be the week in
        which January 1 occurs.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec124"></a>Settings</h2>

<p>The <i>interval</i> argument has these settings:</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><i>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">interval</i></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Time interval</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">yyyy</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Year</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">q</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Quarter</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">m</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Month</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">y</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Day of year</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">d</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Day</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">w</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Weekday</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">ww</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Week</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">h</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Hour</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">n</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Minute</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">s</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Second</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<p>The <i>firstdayofweek</i> argument has these settings:</p>

<table border="0" cellpadding="7" cols="3">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbUseSystem</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">0</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Use application setting if one exists;
        otherwise use NLS API setting.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbSunday</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Sunday (default)</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbMonday</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Monday</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbTuesday</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">3</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Tuesday</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbWednesday</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Wednesday</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbThursday</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">5</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Thursday</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbFriday</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">6</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Friday</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbSaturday</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">7</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Saturday</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<p>The <i>firstweekofyear</i> argument has these settings:</p>

<table border="0" cellpadding="7" cols="3">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbUseSystem</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">0</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Use application setting if one exists;
        otherwise use NLS API setting.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbFirstJan1</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Start with week in which January 1
        occurs (default).</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbFirstFourDays</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Start with the first week that has at
        least four days in the new year.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>vbFirstFullWeek</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">3</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Start with first full week of the year.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec125"></a>Remarks</h2>

<p>You can use the <b>DateDiff</b> function to determine how many
specified time intervals exist between two dates. For example,
you might use <b>DateDiff</b> to calculate the number of days
between two dates, or the number of weeks between today and the
end of the year.</p>

<p>If you want to know the number of days between <i>date1</i>
and <i>date2</i>, you can use either Day of Year (&#147;y&#148;)
or Day (&#147;d&#148;).</p>

<p>When <i>interval</i> is Weekday (&#147;w&#148;), <b>DateDiff</b>
returns the number of weeks between the two dates. If <i>date1</i>
falls on a Monday, <b>DateDiff</b> counts the number of Mondays
until <i>date2</i>. It counts <i>date2</i> but not <i>date1</i>.
If <i>interval</i> is Week (&#147;ww&#148;), however, the <b>DateDiff</b>
function returns the number of calendar weeks between the two
dates. It counts the number of Sundays between <i>date1</i> and <i>date2</i>.
<b>DateDiff</b> counts <i>date2</i> if it falls on a Sunday; but
it doesn&#146;t count <i>date1</i>, even if it does fall on a
Sunday.</p>

<p>If <i>date1</i> refers to a later point in time than <i>date2</i>,
the <b>DateDiff</b> function returns a negative number.</p>

<p>The <i>firstdayofweek</i> argument affects calculations that
use the &#147;w&#148; and &#147;ww&#148; interval symbols.</p>

<p>If <i>date</i> is a date literal (a date enclosed by number
signs (#)), the year, if specified, becomes a permanent part of
that date. However, if <i>date</i> is enclosed in double
quotation marks (&quot;&quot;), and you omit the year, the
current year is inserted in your code each time the <i>date</i>
expression is evaluated. This makes it possible to write code
that can be used in different years.</p>

<h2><a name="sec126"></a>See Also</h2>

<p><b>DateAdd</b> Function, <b>DatePart</b> Function, <b>Day</b>
Function, <b>Format</b> Function, <b>Now</b> Function, <b>Weekday</b>
Function, <b>Year</b> Function.</p>

<h2><a name="sec127"></a>Example</h2>

<p>This example uses the <b>DateDiff</b> function to display the
number of days between a given date and today.</p>

<p class="spacing"><br>
</p>

<pre>Dim TheDate As Date                        ' Declare variables.Msg= InputBox(&quot;Enter a date&quot;)= &quot;Days from today: &quot; &amp; DateDiff(&quot;d&quot;, Now, TheDate)Msg
</pre>

<p>The following examples use the <b>DateDiff</b> function to
calculate the number of calendar weeks between the first of the
year and today, and the number of days since February 1, 1995
respectively.</p>

<p class="spacing"><br>
</p>

<pre>Debug.Print DateDiff(&quot;ww&quot;, &quot;1-1&quot;, Now()).Print DateDiff(&quot;y&quot;, #1-Feb-1995#, Now())
</pre>

<p>The next example shows how to use the <b>DateDiff</b> function
in a query expression. Suppose you have an Orders table that
contains an OrderDate field and a ShippedDate field. You can
create a calculated field in a query to display the time elapsed
between an order date and a shipped date for each order. In the
Query window, create a new query by adding the Orders table and
dragging the OrderID field to the query design grid. In an empty
Field cell, enter the following to create a calculated field.</p>

<p class="spacing"><br>
</p>

<pre>DaysElapsed: DateDiff(&quot;y&quot;, [OrderDate], [ShippedDate])
</pre>
</FONT></FONT></BODY>
</html>
