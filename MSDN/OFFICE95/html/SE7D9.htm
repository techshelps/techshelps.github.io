<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FORMULA Syntax 1</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="active cell, entering formulas in"><META NAME="MS-HKWD" CONTENT="active reference, entering formulas in"><META NAME="MS-HKWD" CONTENT="FORMULA function Syntax 1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    FORMULA Syntax 1</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Enters a formula in the active cell or in a reference. If the active sheet is a worksheet, using FORMULA is equivalent to entering formula_text in the cell specified by reference. Formula_text is entered just as if you typed it in the formula bar.</P>
<P CLASS="t">There are two syntax forms of this function. Use syntax 1 to enter numbers, text, references, and formulas in a worksheet. Although syntax 1 can also be used to enter values on a macro sheet, you will not generally use FORMULA for this purpose. Use syntax 2 to enter a formula in a chart. For information about setting values on a macro sheet, see "Remarks" later in this topic.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>FORMULA</B>(<B>formula_text, </B>reference)</P>
<P CLASS="t">Formula_text    can be text, a number, a reference, or a formula in the form of text, or a reference to a cell containing any of the above.</P>
<UL><LI>If formula_text contains references, they must be R1C1-style references, such as "=RC[1]*(1+R1C1)". If you are recording a macro when you enter a formula, Microsoft Excel converts A1-style references to R1C1-style references. For example, if you enter the formula =B2*(1+$A$1) in cell C2 while recording, Microsoft Excel records that action as =FORMULA("=RC[-1]*(1+R1C1)").</LI><LI>If formula_text is a formula, the formula is entered. Text arguments must be surrounded by double sets of quotation marks. For example, to enter the formula =IF($A$1="Hello World", 1, 0) in the active cell with the FORMULA function, you would use the formula FORMULA|USA|002|001|001|common|UFORMULA("=IF|USA|002|001|001|common|UIF(R1C1=""Hello World"", 1, 0)")
<P CLASS="lt1">If formula_text is a number, text, or logical value, the value is entered as a constant.</P></LI></UL><P></P>
<P CLASS="t">Reference    specifies where formula_text is to be entered. It can be a reference to a cell in the active workbook or an external reference to a workbook. If reference is omitted, formula_text is entered in the active cell.</P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Consider the following guidelines as you choose a function to set values on a worksheet or macro sheet:</P>
<UL><LI>Use FORMULA to enter formulas and change values in a worksheet cell.</LI><LI>SET.VALUE changes values on the macro sheet. Use SET.VALUE to assign initial values to a reference and to store values during the calculation of the macro.</LI><LI>SET.NAME creates names on the macro sheet. Use SET.NAME to create a name and immediately assign a value to the name.</LI></UL><P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">If the active sheet is a worksheet, the following macro formula enters the number constant 523 in the active cell:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA(523)
</FONT></PRE>
<P CLASS="t">If the active sheet is a worksheet, the following macro formula enters the result of the INPUT function in cell A5:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA(INPUT("Enter a formula:", 0), !$A$5)
</FONT></PRE>
<P CLASS="t">If you're using R1C1-style references and the active sheet is a worksheet, the following macro formula enters the formula =RC[-1]*(1+R1C1) in the active cell:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA("=RC[-1]*(1+R1C1)")
</FONT></PRE>
<P CLASS="t">If the active sheet is a worksheet, the following macro formulas enter the number 1000 in the cell two rows down and three columns right from the active cell. The R1C1-style formula is shorter, but the OFFSET method may provide faster performance in larger macro sheets.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA(1000, OFFSET(ACTIVE.CELL(), 2, 3))
FORMULA(1000, "R[2]C[3]")
</FONT></PRE>
<P CLASS="t">The following macro formula enters the phrase "Year to Date" in cell B4 on the sheet named SALES 1993:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA("Year to Date", 'SALES 1993'!B4)
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE7DB.HTM">FORMULA.ARRAY</A>    Enters an array</P>
<P><A class="normal" href="SE7DC.HTM">FORMULA.FILL</A>    Enters a formula in the specified range</P>
<P><A class="normal" href="SE802.HTM">SET.VALUE</A>    Sets the value of a cell on a macro sheet</P>
<P><A class="normal" href="SE7DA.HTM">Syntax 2</A>    Enters formulas in a chart</P>
<P>List of <A class="normal" href="SE742.HTM">Command-Equivalent Functions</A></P></FONT>
</FONT></BODY></HTML>
