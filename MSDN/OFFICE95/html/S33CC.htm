<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>While...Wend</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">While...Wend</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>While</B> <I>Condition<BR></I>    <I>Series of instructions<BR></I><B>Wend</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Repeats a series of instructions between <B>While</B> and <B>Wend</B> while the specified condition is true. The <B>While</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Wend</B> control structure is often used in WordBasic to repeat a series of instructions each time a given piece of text or formatting is found in a Word document. For an example of this use of <B>While</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Wend</B>, see <B>EditFind</B>.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This Windows example uses the <B>Files$</B><B>()</B> function within a <B>While</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Wend</B> loop to insert a list of files in the current folder whose filenames end with the .DOC filename extension. The instruction a$&nbsp;=&nbsp;Files$("*.DOC") returns the first filename with a .DOC extension and a$&nbsp;=&nbsp;Files$() returns the next filename with a .DOC extension each time the instructions within the loop run. As soon as Files$() returns an empty string (""), indicating there are no other .DOC files in the current folder, the condition a$ &lt;&gt; "" is false and Word exits the <B>While</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Wend</B> loop.</P>
<P CLASS="spacing"><BR></P>
<PRE>FileNewDefault
currdir$ = Files$(".")
a$ = Files$("*.DOC")
While a$ &lt;&gt; ""
    count = count + 1
    a$ = FileNameInfo$(a$, 3)
    InsertPara : Insert a$
    a$ = Files$()
Wend
StartOfDocument : Bold 1
Insert currdir$ + " contains" + Str$(count) + " files."
</PRE>
<P CLASS="t">On the Macintosh, you can use a similar example to create a list of Word documents in the current folder by modifying the instruction that sets the currdir$ variable and by specifying a signature instead of "*.DOC" as the file specification. Replace the first two <B>Files$</B><B>()</B> instructions in the previous example with the following instructions:</P>
<P CLASS="spacing"><BR></P>
<PRE>currdir$ = Files$(":")
a$ = Files$(MacID$("W6BN"))
</PRE>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>For</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Next</B>,<B> Goto</B>,<B> If</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Then</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Else</B>,<B> Select Case</B></P>
<P></P></FONT></FONT></BODY></HTML>
