<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Dialog Editor to Create a Dialog Box</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H2 CLASS="h1">Using the Dialog Editor to Create a Dialog Box</H2><P CLASS="t">You can use the Dialog Editor to create a new dialog box or to edit an existing one. Here's the sequence for creating and using a custom dialog box:</P>
<P CLASS="ls">    1.    Design the dialog box using the Dialog Editor application.</P>
<P CLASS="ls">    2.    Select the completed dialog box and copy it into the macro in which you want&nbsp;to use it.</P>
<P CLASS="ls">    3.    Add the instructions needed to display the dialog box and to retrieve information from it.</P>
<P></P>
<H3 CLASS="h3"><A NAME="sec0"></A>Starting the Dialog Editor</H3><P CLASS="t">The Dialog Editor is a separate application included in the Word package. If you chose not to install the Dialog Editor when you set up Word, you can run the Word Setup program again to install it.</P>
<P CLASS="t"><img src="DIALOGED.gif"></P>
<P CLASS="t">The Dialog Editor button (Macro toolbar)</P>
<P CLASS="t">To start the Dialog Editor, click the Dialog Editor button on the Macro toolbar. In Windows, you can also run the Dialog Editor from Program Manager or File Manager. On the Macintosh, you can run the Dialog Editor by double-clicking the Dialog Editor icon in the Word folder. </P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">In Windows, the Dialog Editor does not support 3-D dialog effects. However, when a WordBasic macro displays a dialog box created with the Dialog Editor in Windows, the dialog box has the same 3-D look as built-in Word dialog boxes, assuming the 3-D Dialog And Display Effects check box is selected on the General tab in the Options dialog box (Tools menu).</P>
<P></P>
<H3 CLASS="h3"><A NAME="sec1"></A>Adding Items to a Dialog Box</H3><P CLASS="t">When you start the Dialog Editor, it displays an empty dialog box to which you can add dialog box controls such as buttons, text, and list boxes. In the Dialog Editor, controls are called <I>items</I>. You use the Item menu to add them to the dialog box.</P>
<P CLASS="a">    <img src="ATR0507.gif"></P>
<P CLASS="t">After you have used the Item menu to insert an item, the item remains selected. You can press ENTER to create a copy of the selected item. For example, when a check box is selected you can press ENTER to insert another check box. When an OK button or push button is selected and you press ENTER, the Dialog Editor inserts a Cancel button if there isn't one already; likewise, when a Cancel button or a push button is selected and you press enter, the Dialog Editor inserts an OK button if there isn't one already. If both an OK button and a Cancel button are present, pressing enter when any command button is selected inserts a new push button.</P>
<P CLASS="a">    <img src="ATR0508.gif"></P>
<H4 CLASS="h4"><A NAME="sec2"></A>Adding a Group of Option Buttons</H4><P CLASS="t">An easy way to create a group of option buttons is to insert a group box, press ENTER to insert the first option button, and continue to press ENTER to insert additional option buttons. To insert a group box, choose Group Box from the Item menu. Immediately after creating each option button, type a name for it. (When an option button is selected, you can replace the default text, "Option Button," by typing new text.)</P>
<P CLASS="a">    <img src="ATR0509.gif"></P>
<P CLASS="t"></P>
<H4 CLASS="h4"><A NAME="sec3"></A>Adding a Picture Item</H4><P CLASS="t">Using the Picture command on the Item menu, you can add graphics to your dialog boxes. When you choose the Picture command from the Item menu, it displays the New Picture dialog box, in which you can indicate how the graphic you're adding is stored&nbsp;—&nbsp;as a file, an AutoText entry, an item marked with a bookmark, or an item on the Clipboard. In the Text$ box of the Information dialog box (Info command, Edit menu) for the picture item, type the path and filename of the graphics file, the name of the AutoText entry, or the name of the bookmark, or just type <B>Clipboard</B>. The Dialog Editor does not display the graphic, but you can position and size the picture item just as you can any other item. Don't worry if you don't know the name of the file or the picture type; you can specify it later.</P>
<P CLASS="a">    <img src="ATR0510.gif"></P>
<P CLASS="t"></P>
<H4 CLASS="h4"><A NAME="sec4"></A>Adding a Multiple-Line Text Box</H4><P CLASS="t">When you use the Dialog Editor to insert a text box control, the text box is sized to hold a single line of text. To make the text box into a multiple-line text box, you change the text box's height so that it can accommodate more than one line. Initially, however, the Dialog Editor doesn't allow you to change a text box's height. This is to prevent you from accidentally changing the height as you change the width. To change the height, you have to double-click the text box to display the Information dialog box, which displays settings pertinent to the selected dialog box item, and then clear the Auto check box next to Height. You can then adjust the height of the text box to make it into a multiple-line text box.</P>
<H4 CLASS="h4"><A NAME="sec5"></A>Adding a File Preview Box</H4><P CLASS="t">The Dialog Editor does not have a command to insert a File Preview box. However, you can use another item that can be sized in a similar way as a placeholder. A group box, for example, makes a good placeholder. When you paste the dialog box into your macro, you can then change the name of the item's instruction to <B>FilePreview</B>. Keep in mind that a dialog box can include only one File Preview box; also, when a dialog box includes a File Preview box, it must call a dialog function. For information on dialog functions, see "Using Dynamic Dialog Boxes" later in this chapter. For more information, see <B>FilePreview</B> in Part 2, "WordBasic Reference."</P>
<H3 CLASS="h3"><A NAME="sec6"></A>Positioning and Sizing Items</H3><P CLASS="t">Once you have added an item, you can use the mouse to position and size it.</P>
<P CLASS="t"><img src="4harrow.gif"></P>
<P CLASS="t">The mouse pointer <BR>for positioning</P>
<H4 CLASS="h6"><A NAME="sec7"></A>Positioning</H4><P CLASS="h">You can position an item by dragging it with the mouse. When the mouse pointer is positioned over an item, the pointer changes to a four-headed arrow.</P>
<P CLASS="a">    <img src="ATR0511.gif"></P>
<P CLASS="t"></P>
<P CLASS="t"><img src="ATR0511A.gif"></P>
<P CLASS="t">The mouse pointers for sizing</P>
<H4 CLASS="h6"><A NAME="sec8"></A>Sizing</H4><P CLASS="h">You can size an item by dragging its borders with the mouse. When the mouse pointer is positioned over a border, the pointer changes to a double-headed arrow.</P>
<P CLASS="a">    <img src="ATR0512.gif"></P>
<H4 CLASS="h4"><A NAME="sec9"></A>Positioning and Sizing Precisely</H4><H5 CLASS="h6"><A NAME="sec10"></A>Using the SHIFT key to align</H5><P CLASS="h">If you hold down the SHIFT key just before you move an item, you can drag only vertically or only horizontally, depending on which direction you first move the mouse. </P>
<H5 CLASS="h6"><A NAME="sec11"></A>Using the arrow keys</H5><P CLASS="h">You can use the arrow keys to position or size a selected item. You can position an item by pressing an arrow that corresponds to the direction you want to move the item. To size an item, hold down the SHIFT key and press an arrow key. In Windows, the selected item is moved or sized by four X or Y units each time you press an arrow key. To move or size the item by just one X or Y unit, hold down the Ctrl key while moving or sizing. For example, to increase the width of a selected item by one X unit in Windows, you could press Ctrl+Shift+right arrow. In Windows, you must press ENTER to finish moving or sizing an item; you can press ESC to cancel. On the Macintosh, the selected item is moved or sized one X or Y unit each time you press an arrow key; you can hold down the OPTION key to move or size an item by four X or Y units each time you press an arrow key. For example, to increase the width of a selected item by one X unit on the Macintosh, you could press Shift+right arrow. </P>
<P CLASS="t"></P>
<H5 CLASS="h6"><A NAME="sec12"></A>Using the Information dialog box</H5><P CLASS="h">The Information dialog box displays the exact position and size of an item, so that you can set it precisely. You can also see at a glance whether or not an item is precisely aligned with another item. For example, if you want to align two items horizontally, a good technique is to do it first by eye and then use the Information dialog box to get the Y coordinates of the items; if one of them is off by one or two Y units, you can adjust its position accordingly. To display the Information dialog box for an item, double-click the item, or select it and choose Info from the Edit menu.</P>
<P CLASS="a">    <img src="ATR0513.gif"></P>
<P></P>

<TABLE COLS="1" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="348pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="sbrh"><B>What Do X and Y Represent?</B></P>
<P CLASS="sbrt">The Dialog Editor positions and sizes items in X units for horizontal positioning and width, and Y units for vertical positioning and height. Because monitors have different resolutions, these units are defined in relative rather than absolute terms. X units are increments of 1/8 of the System font in Windows or the dialog font on the Macintosh. Y units are increments of 1/12 of the System font in Windows or the dialog font on the Macintosh.</P>
<P CLASS="sbrt">Note that in Windows, the System font is not the same as the font used to display text in a custom dialog box. Generally, the dialog font and the System font are scaled in proportion to each other, but some display drivers install a System font that is easier to read and disproportionately large. For example, the Windows Super VGA 1024 x 768 (large fonts) display driver uses this technique. When one of these display drivers is installed, the Word dialog font does not expand to the degree the System font does. This means that dialog boxes and controls, whose size is dependent on the System font, expand more than dialog box text, which appears a little shrunken. Likewise, if you design a dialog box with a large-fonts display driver installed and then display the dialog box with a small- or normal-fonts display driver installed, dialog box text may be truncated (since dialog box controls shrink more than the text they contain). </P>
<P CLASS="sbrt">To avoid this problem, either design your dialog boxes with a standard VGA resolution driver installed or, if you're designing with a large-fonts display driver installed, make sure that controls containing text (such as text label and option button controls) are a little larger than necessary so that text has room to expand when displayed with a different display driver.</P>
<P CLASS="sbrh"><B></B></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4 CLASS="h4"><A NAME="sec13"></A>Selecting Multiple Items</H4><P CLASS="t">You can select more than one item by holding down the SHIFT key and clicking the additional items you want to select. This is useful if you want to move several items as a group. You can select every item in a dialog box by using the Select All Items command on the Edit menu.</P>
<H4 CLASS="h4"><A NAME="sec14"></A>Selecting a Group</H4><P CLASS="t">When you move option buttons or other items within a group box, you typically want to move them as a group. The Dialog Editor provides a Select Group command to select all the items within a group box, including the group box. A group box is most often used to group option buttons, but you can include any item within it.</P>
<H4 CLASS="h4"><A NAME="sec15"></A>Positioning and Sizing Automatically</H4><P CLASS="t">The Dialog Editor automatically positions or sizes some items. When an Auto check box is selected for an item, you cannot change the item's position or size. Automatic sizing is a useful way to fix the size of items you generally don't want to resize, such as OK buttons and Cancel buttons. To select or clear automatic positioning and sizing for any item, double-click the item and select or clear the appropriate Auto check boxes in the Information dialog box.</P>
<P CLASS="t">Note that if you select Auto for the position of an item you've already moved, it&nbsp;returns to the position where the Dialog Editor originally inserted it; this may conflict with the position of other items you have moved. However, you can set automatic positioning for an item just after inserting it to force it to move with the item that precedes it. For example, if you select Auto for the position of a text box inserted beneath a text item, you can move them together by dragging only the text item.</P>
<H4 CLASS="h4"><A NAME="sec16"></A>Sizing the Dialog Box</H4><P CLASS="t">When you have added all the items the dialog box will contain, you can drag the borders of the dialog box (Windows) or drag the sizing box at the bottom-right corner (Macintosh) to fit the items. You can also choose the Resize command from the Edit menu or double-click the dialog box border (Windows) or click the zoom box (Macintosh) to have the Dialog Editor size the dialog box for you.</P>
<P CLASS="a">    <img src="ATR0514.gif"></P>
<P CLASS="t"></P>
<H3 CLASS="h3"><A NAME="sec17"></A>Deleting Items</H3><P CLASS="t">You can delete one or more selected items by choosing Clear from the Edit menu. In Windows, you can also press the Delete key; on the Macintosh, you can press either Del or COMMAND+Delete (on the Macintosh, the Delete key deletes text in an item label, not the item itself). To delete all of the items in a dialog box, select the dialog box itself or choose Select All Items from the Edit menu before deleting. To start from scratch with a new, empty dialog box with the default label and default size and position, choose New from the File menu. </P>
<H3 CLASS="h3"><A NAME="sec18"></A>Changing Labels and Identifiers</H3><P CLASS="t">When you insert an item, it has a default label such as "Check Box," "Option Button," or "Text." Immediately after you've inserted an item, while it is selected, you can replace the default label by typing the one you want. Once you have changed the default text, you can select the item and use the Backspace key (Windows) or the Delete key (Macintosh) to delete what you typed, or you can use the Information dialog box to edit it.</P>
<P CLASS="t">To display the Information dialog box, double-click the item or select the item and choose the Info command from the Edit menu. In the Information dialog box, you edit the label by changing the text in the Text$ box. The Auto Quote check box is selected by default; it inserts quotation marks around the item's label when you paste the dialog box definition into a macro. If you want to use a variable name as a label, you can clear the Auto Quote check box (since a variable name should not be enclosed in quotation marks). On the Macintosh, the Auto Quote check box is not included in the Dialog Editor.</P>
<P CLASS="t">Many dialog box items are designed to return a value to the macro that displays the dialog box. In your macro, you use an item's <I>identifier</I> to access the value associated with that dialog box item. The Dialog Editor assigns these items default identifiers such as .CheckBox1 or .ListBox2. You can use the .Field box in the Information dialog box to change an item's identifier to something less generic. The .Field box is so named because the values returned by dialog box items are stored in a dialog record. In programming terminology, values stored in a record are "fields." In this book, the term "identifier" is used instead because identifiers serve not only to indicate fields within records but also to identify dialog box items to other instructions within a macro.</P>
<P CLASS="a">    <img src="ATR0515.gif"></P>
<P CLASS="t"></P>
<H4 CLASS="h6"><A NAME="sec19"></A>Comments</H4><P CLASS="h">In the Comment box, you can add a comment that will appear in the dialog box definition when the dialog box is copied from the Dialog Editor into a macro. In your macro, the comment will be located on the same line as the WordBasic instruction associated with the item.</P>
<H4 CLASS="h6"><A NAME="sec20"></A>Access keys</H4><P CLASS="h">Access keys allow quick keyboard access to items in a dialog box. When an access key is defined for an item in a custom dialog box, the user can press ALT+the specified letter (Windows) or COMMAND+the specified letter (Macintosh) to activate a text box, select or clear a check box, or choose a command button, for example. In the Information dialog box, you define an access key for an item by including an ampersand (&amp;) character before a letter in the Text$ box. In the dialog box, the letter appears underlined. (Note that on the Macintosh, you must hold down the COMMAND key for a second or two before the letter appears underlined.) To define an access key for a text box, you define one for a text item associated with the text box. To associate a text item with a text box, insert the text item first, then insert a text box. In the dialog box definition created when the dialog box is pasted into a macro, the <B>Text</B> instruction must immediately precede the <B>TextBox</B> instruction.</P>
<H3 CLASS="h3"><A NAME="sec21"></A>Copying a Dialog Box to a Macro</H3><P CLASS="t">When you're ready to insert a dialog box into the macro that will display it, you select the dialog box in the Dialog Editor and copy it. You don't have to select each item in the dialog box; you just select the dialog box itself. You can do this by clicking the dialog box title bar or by choosing the Select Dialog command from the Edit menu.</P>
<P CLASS="t">When the dialog box is selected, choose the Copy command from the Edit menu to copy it. In Word, open the macro and position the insertion point where you want to insert the dialog box definition. Then paste the dialog box definition. It will appear as a series of instructions enclosed by a <B>Begin Dialog</B><FONT FACE="Symbol"><B>¼</B></FONT><B>End Dialog </B>instruction.</P>
<P CLASS="a">    <img src="ATR0516.gif"></P>
<H3 CLASS="h3"><A NAME="sec22"></A>Exiting the Dialog Editor</H3><P CLASS="t">In the Dialog Editor, choose Exit (Windows) or Quit (Macintosh) from the File menu. If you've created a new dialog box or changed an existing one and have not copied your work, the Dialog Editor asks if you want to copy it to the Clipboard. If you want to use the dialog box in Word, choose the Yes button. If you choose the No button, the new dialog box or any changes made to an existing one will be lost.</P>
<H3 CLASS="h3"><A NAME="sec23"></A>Editing an Existing Dialog Box</H3><P CLASS="t">You can change a custom dialog box in any macro by copying the dialog box definition from the macro to the Clipboard and then pasting it from the Clipboard into the Dialog Editor. You can then edit the dialog box in the Dialog Editor. Note that when you select a dialog box definition, the selection must start with the <B>Begin Dialog </B>instruction and end with the <B>End Dialog</B> instruction.</P>
<H3 CLASS="h3"><A NAME="sec24"></A>Tips for Using the Dialog Editor</H3><P CLASS="t">The following tips can save you time and effort when building custom dialog boxes with the Dialog Editor.</P>
<H4 CLASS="h6"><A NAME="sec25"></A>Build a dialog box from top to bottom and from left to right</H4><P CLASS="h">Within the Dialog Editor, everything is relative to the upper-left corner of the dialog box. When you resize a dialog box, items aligned with the top and left borders of the dialog box will keep their position relative to the top and left borders, but items aligned with the bottom and right borders will lose their position.</P>
<P CLASS="t"></P>
<H4 CLASS="h6"><A NAME="sec26"></A>Use the SHIFT key to align items with the mouse</H4><P CLASS="h">If you hold down the SHIFT key before moving an&nbsp;item with the mouse, you will only be able to move the item in the direction you first move it. You can confidently position the item without worrying that you'll accidentally move it out of alignment in the other direction. You can also use the SHIFT key to select multiple items and move them together so they maintain their positions relative to each other.</P>
<H4 CLASS="h6"><A NAME="sec27"></A>Select an item, then add an item below it</H4><P CLASS="h">You can minimize the amount of rearranging you have to do if you keep in mind that when you add an item, the Dialog Editor positions it below the currently selected item. For example, if you know you want to add a text box with a text label, add the text label first, then add the text box (assuming that you want the text label to appear above the text box, as it usually does).</P>
<H4 CLASS="h6"><A NAME="sec28"></A>Add a group box first</H4><P CLASS="h">If you want to enclose items such as option buttons or check boxes within a group box, add the group box first. If you add the check boxes or option buttons first, the group box will hide rather than enclose them.</P>
<H4 CLASS="h6"><A NAME="sec29"></A>Use a group box to create a rectangle</H4><P CLASS="h">A group box normally includes a text label, but if you delete the label, the group box forms a rectangle that you can use as a design element.</P>
<H4 CLASS="h6"><A NAME="sec30"></A>Use the arrow keys to make small adjustments</H4><P CLASS="h">In Windows, when you press an arrow key, you move the selected dialog box item four X or Y units; when you press CTRL+an arrow key, you move the item one X or Y unit. To size an item, press SHIFT+an arrow key or CTRL+SHift+an arrow key. Press ENTER to complete positioning or sizing or ESC to cancel it. </P>
<P CLASS="t">On the Macintosh, when you press an arrow key, you move the selected item one X or Y unit; when you press OPTION+an arrow key, you move the item four X or Y units. To size an item, hold down SHIFT and press an arrow key or OPTION+an arrow key.</P>
<H4 CLASS="h6"><A NAME="sec31"></A>Always include a command button</H4><P CLASS="h">A dialog box must include at least one command button. That is, it must include either an OK button, a Cancel button, or a push button. Otherwise, Word will generate an error when you run the macro to display the dialog box.</P>
<H4 CLASS="h6"><A NAME="sec32"></A>Avoid a "value out of range" error</H4><P CLASS="h">Sometimes when you insert a large item such as a group box into a dialog box, the item's boundaries fall outside the dialog box border. If you paste the dialog box into a macro and run it, Word will display a "value out of range" error. You can avoid this error by simply repositioning the item that causes the error. A macro can't display an item in a dialog box unless it&nbsp;lies entirely within the dialog box. (Drop-down list boxes can drop slightly outside the dialog box, but no more than an eighth of an inch or so.)</P>
<P></P>

<TABLE COLS="1" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="348pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="sbrh"><B>A Glossary of Dialog Box Terms</B></P>
<P CLASS="sbrt">The vocabulary associated with dialog boxes can be confusing. Here's a glossary of terms.</P>
<P CLASS="sbrt"><B>Custom dialog box   </B> A dialog box defined by WordBasic instructions. Usually, the Dialog Editor is used to design a custom dialog box, which is then copied into a macro. A custom dialog box is used to display and return information. Also known as a user-defined dialog box.</P>
<P CLASS="sbrt"><B>Dialog box control   </B> An element of a dialog box such as a command button, check box, text label, or list box. Within the Dialog Editor, a dialog box control is referred to as an "item." For descriptions of the dialog box controls available for custom dialog boxes, see "Dialog Box Controls" earlier in this chapter.</P>
<P CLASS="sbrt"><B>Dialog box control identifier</B>    A string used to identify a particular dialog box control. The identifier is used with a dialog record to insert and retrieve values from dialog boxes and to reference dialog box controls.</P>
<P CLASS="sbrt"><B>Dialog box definition</B>    The set of WordBasic instructions used in a macro to define a custom dialog box. These instructions are enclosed within a <B>Begin Dialog</B><FONT FACE="Symbol"><B>¼</B></FONT><B>End Dialog</B> instruction. The Dialog Editor automatically generates a dialog box definition.</P>
<P CLASS="sbrt"><B>Dialog function</B>    A special user-defined function that can be called while a custom dialog box is displayed. The dialog function can make a custom dialog box "dynamic" by responding to events while the dialog box is displayed. See "Using Dynamic Dialog Boxes" later in this chapter.</P>
<P CLASS="sbrt"><B>Dialog record</B>    A variable that contains the values returned by a Word dialog box or by a custom dialog box. Each setting in a dialog box is stored in a field within the record associated with the dialog box. For more information, see "Working with Dialog Records" in Chapter 4, "Advanced WordBasic."</P>
<P CLASS="sbrt"><B>Dynamic dialog box</B>    A custom dialog box whose contents can change dynamically in response to user actions while the dialog box is displayed. See "Using Dynamic Dialog Boxes" later in this chapter.</P>
<P CLASS="sbrt"><B>Word dialog box    </B>A dialog box built into Word. Most dialog boxes are displayed by choosing a menu command, but some, like the Organizer dialog box, are available only by choosing buttons in other dialog boxes.</P>
<P CLASS="sbrh"><B></B></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="h"></P>
<P></P></FONT></FONT></BODY></HTML>
