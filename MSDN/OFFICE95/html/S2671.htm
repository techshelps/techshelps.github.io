<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Understanding the ODBC Extensions</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H2 CLASS="h1">Understanding the ODBC Extensions</H2><P CLASS="t">Open database connectivity (ODBC) is an application programming interface that uses structured query language (SQL) to access and manipulate data in database management systems such as dBASE&reg;, Paradox&reg;, and Microsoft Access.</P>
<P CLASS="t">SQL is a widely accepted industry standard for storing, maintaining, and retrieving information from a DBMS. A particular DBMS may support different SQL functions and grammar to take advantage of unique, proprietary features. For that reason, if SQL statements are used to access data directly, an application would require separate programs, each targeted to a specific DBMS, to work with external data.</P>
<P CLASS="t">Using ODBC API functions, however, a single application can access data in diverse DBMSs without supporting multiple implementations of SQL. To access<BR>a particular DBMS, an application supporting ODBC uses software components called <I>drivers</I>, which perform all interaction between an application and a specific DBMS. The following illustration shows the relationship between the dBASE ODBC driver and an application accessing dBASE database files.</P>
<P CLASS="a">    <img src="ATR0B01.gif"></P>
<P CLASS="t">To provide the same interoperability for WordBasic macros, the WBODBC.WLL add-in provides functions you can call from WordBasic that mirror ODBC functions. With these functions, you can create a macro that can access data in any ODBC-supporting DBMS for which you have an ODBC driver.</P>
<P CLASS="a">    <img src="ATR0B02.gif"></P>
<H3 CLASS="h3"><A NAME="sec0"></A>The ODBC Extensions and SQL</H3><P CLASS="t">After establishing a data source connection through a call to <B>SQLOpen</B>, you issue SQL queries to an ODBC-supporting DBMS by calls to the WordBasic ODBC extensions <B>SQLExecQuery</B> or <B>SQLQueryExec</B>. The SQL statements in the query should conform to SQL grammar. If the SQL grammar is supported by the ODBC API, the query is interpreted by the ODBC driver. The ODBC Driver Manager (ODBC.DLL) then calls the appropriate ODBC API functions to execute the query.</P>
<P CLASS="t">If the query contains SQL grammar that is not supported by the ODBC driver, the query is passed directly to the DBMS without further processing by ODBC API functions. In this way, a driver can support a superset of SQL, including vendor-specific grammar.</P>
<P CLASS="t">You can see some examples of SQL queries in the sample macros in the WBODBC.DOT, which is included on the Microsoft Word Developer's Kit disk. When you run the Exec macro, you can compose and issue queries interactively; you can also use this macro to test queries you create before including the query strings in other macros.</P>
<P CLASS="t">To learn more about the SQL grammar supported by a specific ODBC driver, see the online Help file provided with each driver. For more information about SQL, the following standards are available:</P>
<UL><LI>    Database Language – SQL with Integrity Enhancement, ANSI, 1989 ANSI X3.135-1989.</LI><LI>    X/Open and SQL Access Group SQL CAE draft specification (1991).</LI><LI>    Database Language SQL: ANSI X3H2 and ISO/IEC JTC1,SC21,WG3 (draft international standard).</LI></UL><P></P>
<P CLASS="t">In addition to standards and the SQL documentation provided with the DBMS you are using, there are many books that describe SQL, including:</P>
<UL><LI>    <I>Microsoft ODBC Programmer's Reference,</I> provided with the Microsoft ODBC Software Development Kit version 2.10. </LI><LI>    Date, C. J.: <I>A Guide to the SQL Standard</I> (Addison-Wesley, 1989).</LI><LI>    Emerson, Sandra L., Darnovsky, Marcy, and Bowman, Judith S.: <I>The Practical SQL Handbook</I> (Addison-Wesley, 1989).</LI><LI>    Groff, James R. and Weinberg, Paul N.: <I>Using SQL</I> (Osborne McGraw-Hill, 1990).</LI><LI>    Gruber, Martin: <I>Understanding SQL</I> (Sybex, 1990).</LI><LI>    Hursch, Jack L. and Carolyn J.: <I>SQL, The Structured Query Language</I><BR>(TAB Books, 1988).</LI><LI>    Pascal, Fabian: <I>SQL and Relational Basics</I> (M &amp; T Books, 1990).</LI><LI>    Trimble, J. Harvey, Jr. and Chappell, David: <I>A Visual Introduction to SQL</I> (Wiley, 1989).</LI><LI>    Van der Lans, Rick F.: <I>Introduction to SQL</I> (Addison-Wesley, 1988).</LI><LI>    Vang, Soren: <I>SQL and Relational Databases</I> (Microtrend Books, 1990).</LI><LI>    Viescas, John: <I>Quick Reference Guide to SQL</I> (Microsoft Corp., 1989).</LI></UL><P></P>
<P></P>
<P CLASS="nh"><B>Tip</B></P>
<P CLASS="nt">If you use Microsoft Query, you can create a query in the Query window and then copy the equivalent SQL statements to your WordBasic macro.</P>
<P></P>
<H3 CLASS="h3"><A NAME="sec1"></A>ODBC SQL Data Types</H3><P CLASS="t">Each ODBC driver has different naming syntax for its own SQL data types. A given ODBC driver maps its native SQL data types to ODBC SQL data types. Information about data-type mapping for a specific ODBC driver is provided in the online Help file for each installed driver. For example, the following table shows how the ODBC driver for Paradox maps native Paradox data types.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="256pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Paradox data type</B></P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>ODBC SQL data type</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Alphanumeric</P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">SQL_CHAR</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Date</P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">SQL_DATE</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Number</P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">SQL_DOUBLE</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Short</P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">SQL_SMALLINT</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">A given driver and ODBC data source do not necessarily support all ODBC SQL data types. For complete information about ODBC SQL data types, see the <I>Microsoft ODBC Programmer's Reference </I>in the Microsoft ODBC Software Development Kit version 2.10.</P>
<P CLASS="t">The extensions in WBODBC.WLL allow you to create and delete ODBC tables, as well as to examine and manipulate fields within ODBC tables. When using the SQL statements CREATE TABLE and ALTER TABLE, you must specify the data types native to that particular DBMS. For example, if you are adding a column to a table in Microsoft FoxPro and the data type of the column is "Date," you must specify "Date" as the column data type in the ALTER TABLE statement, not the ODBC SQL data type "SQL_DATE." To determine the appropriate data type for the DBMS you are using, use the WordBasic ODBC function <B>SQLGetTypeInfo$</B>. For any valid SQL data type, this function returns the corresponding data type for the DBMS of the current data source.</P>
<P CLASS="t">Note that the ODBC extensions for Word cannot directly manipulate ODBC SQL data types; the ODBC extensions use only string data types. Numbers are formatted and manipulated as strings.</P></FONT></FONT></BODY></HTML>
