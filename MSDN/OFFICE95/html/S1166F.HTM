<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DMin, DMax Functions</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h1><a name="sec102"></a>DMin, DMax Functions</h1>

<h2><a name="sec103"></a>Description</h2>

<p>You can use the <b>DMin</b> and <b>DMax</b> functions to
determine the minimum and maximum values in a specified set of
records (domain). Use <b>DMin</b> and <b>DMax</b> in a macro or
module, in a query expression, or in a calculated control.</p>

<p>For example, you could use <b>DMin</b> and <b>DMax</b> in
calculated controls on a report to display the greatest and least
order amounts for a particular customer. Or you could use <b>DMin</b>
in a query expression to display all orders with a discount
greater than the minimum possible discount.</p>

<h2><a name="sec104"></a>Syntax</h2>

<p><b>DMin(</b><i>expr</i>, <i>domain</i>[, <i>criteria</i>]<b>)DMax(</b><i>expr</i>,
<i>domain</i>[, <i>criteria</i>]<b>)</b></p>

<p>The <b>DMin</b> and <b>DMax</b> functions use the following
arguments.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>expr</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Expression that identifies the field for
        which you want to find the minimum or maximum value. It
        can be a string expression identifying a field in a table
        or query, or it can be an expression that performs a
        calculation on data in that field. You can include in <i>expr</i>
        the name of a table field, a control on a form, a
        constant, or a function. If <i>expr</i> includes a
        function, it can be either built-in or user-defined, but
        not another domain aggregate or SQL aggregate function.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>domain</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">String expression identifying the set of
        records that constitutes the domain. It can be a table
        name or a query name.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>criteria</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional string expression used to
        restrict the range of data on which <b>DMin</b> or <b>DMax</b>
        is performed. For example, <i>criteria</i> is often
        equivalent to the WHERE clause in an SQL expression,
        without the word WHERE. If <i>criteria</i> is omitted, <b>DMin</b>
        and <b>DMax</b> evaluate <i>expr </i>against the entire
        domain. Any field included in <i>criteria</i> must also
        be a field in <i>domain</i>, otherwise <b>DMin</b> and <b>DMax</b>
        returns a <b>Null</b>.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec105"></a>Remarks</h2>

<p><b>DMin</b> and <b>DMax</b> find the least and greatest value
in the field or expression defined by <i>expr</i> from the table
or query referred to by <i>domain</i>, according to any
restrictions specified by <i>criteria</i>.</p>

<p><b>DMin</b> and <b>DMax</b> return the minimum and maximum
values that satisfy <i>criteria</i>. If <i>expr </i>identifies
numeric data, <b>DMin</b> and <b>DMax</b> return numeric values.
If <i>expr</i> identifies string data, they return the string
that is first or last alphabetically.</p>

<p><b>DMin</b> and <b>DMax</b> ignore <b>Null</b> values in the
field referenced by <i>expr</i>. However, if no record satisfies <i>criteria</i>
or if <i>domain</i> contains no records, <b>DMin</b> and <b>DMax</b>
return a <b>Null</b>.</p>

<p>Whether you use <b>DMin</b> or <b>DMax</b> in a macro or
module, a query expression, or a calculated control, you must
construct the <i>criteria</i> argument carefully to ensure that
it will be evaluated correctly.</p>

<p>You can use <b>DMin</b> and <b>DMax</b> to specify criteria in
the Criteria row of a query, in a calculated field expression in
a query, or in the Update To row of an update query.</p>

<p><b>Note</b> You can use <b>DMin</b> and <b>DMax</b> or <b>Min</b>
and <b>Max</b> in a calculated field expression in a totals
query. If you use <b>DMin</b> or <b>DMax</b>, values are
evaluated before the data is grouped. If you use <b>Min</b> or <b>Max</b>,
the data is grouped before values in the field expression are
evaluated.</p>

<p>Use <b>DMin</b> or <b>DMax</b> in a calculated control when
you need to specify criteria to restrict the range of data on
which the function is performed. For example, to display the
maximum freight charged for an order shipped to California, set
the <b>ControlSource</b> property of a text box to the following
expression.</p>

<p class="spacing"><br>
</p>

<pre>=DMax(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipRegion] = 'CA'&quot;)
</pre>

<p>If you simply want to find the minimum or maximum value of all
records in <i>domain</i>, use the <b>Min</b> or <b>Max</b>
function.</p>

<p>You can use <b>DMin</b> or <b>DMax</b> in a module or macro or
in a calculated control on a form if the field that you need to
display is not in the record source on which your form is based.</p>

<p><b>Tip</b> Although you can use <b>DMin</b> or <b>DMax</b> to
find the minimum or maximum value from a field in a foreign
table, it may be more efficient to create a query that contains
the fields that you need from both tables, and base your form or
report on that query.</p>

<p><b>Note</b> Unsaved changes to records in <i>domain</i> are
not included when you use these functions. If you want the <b>DMax</b>
or <b>DMin</b> function to be based on the changed values, you
must first save the changes by choosing the Save Record command
from the File menu, moving the focus to another record, or using
the <b>Update</b> method.</p>

<h2><a name="sec106"></a>See Also</h2>

<p>Domain Aggregate Functions.</p>

<h2><a name="sec107"></a>Example</h2>

<p>This example returns the lowest and highest values from the
Freight field for orders shipped to the United Kingdom. The
domain is an Orders table. The <i>criteria</i> argument restricts
the resulting set of records to those for which ShipCountry
equals UK.</p>

<p class="spacing"><br>
</p>

<pre>Dim curX As Currency, curY As Currency= DMin(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipCountry] = 'UK'&quot;)= DMax(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipCountry] = 'UK'&quot;)
</pre>

<p>In the next example, the <i>criteria </i>argument includes the
current value of a text box called OrderDate. The text box is
bound to an OrderDate field in an Orders table. Note that the
reference to the control is not included in the double quotation
marks (&quot;) that denote the strings. This ensures that each
time the <b>DMax</b> function is called, Microsoft Access obtains
the current value from the control.</p>

<p class="spacing"><br>
</p>

<pre>Dim curX As Currency= DMax(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[OrderDate] = #&quot; _
    &amp; Forms!Orders!OrderDate &amp; &quot;#&quot;)
</pre>

<p>In the next example, the criteria expression includes a
variable, dteOrderDate. Note that number signs (#) are included
in the string expression, so that when the strings are
concatenated, they will enclose the date.</p>

<p class="spacing"><br>
</p>

<pre>Dim dteOrderDate As Date, curX As Currency= #3/30/95#= DMin(&quot;[Frieght]&quot;, &quot;Orders&quot;, _
    &quot;[OrderDate] = #&quot; &amp; dteOrderDate &amp; &quot;#&quot;)
</pre>
</FONT></FONT></BODY>
</html>
