<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Common WordBasic Techniques</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H2 CLASS="h1">Common WordBasic Techniques</H2><P CLASS="t">So far, this chapter has presented the building blocks needed to construct macros with WordBasic. This section describes a few widely used WordBasic techniques that employ some of those building blocks.</P>
<H3 CLASS="h3"><A NAME="sec0"></A>Inserting Text into a Document</H3><P CLASS="t">To insert text, special characters, and even nonprinting characters like tab characters, you use the <B>Insert</B> statement. The <B>Insert</B> statement is the macro equivalent of typing at the keyboard; anything you can type, a macro can insert with <B>Insert</B>. For example, the following instruction inserts the phrase "Sincerely yours" into a document:</P>
<P CLASS="spacing"><BR></P>
<PRE>Insert "Sincerely yours"
</PRE>
<P CLASS="t">Notice that the statement doesn't specify where "Sincerely yours" is to be inserted. Just as when you type, the phrase is inserted into the active document wherever the insertion point is currently located. If there is a selection, <B>Insert</B> will replace it (assuming the Typing Replaces Selection check box on the Edit tab in the Options dialog box (Tools menu) is selected).</P>
<P CLASS="t">The <B>Insert</B> statement inserts plain text into a document. The text you insert takes on the formatting of the text that precedes it. If you want to insert text with a different format, you place instructions to apply that formatting before the <B>Insert</B> instruction, just as you would turn on formatting before typing text. The following example turns on italic formatting just before inserting text and turns it off just afterward:</P>
<P CLASS="spacing"><BR></P>
<PRE>Italic 1                                'Turn on italic
Insert "Love's Labour's Lost,"        'Insert text
Italic 0                                'Turn off italic
Insert " by William Shakespeare"        'Insert more text
</PRE>
<P CLASS="t">You can insert many special characters and nonprinting characters with <B>Insert</B> by typing them and enclosing them in quotation marks, as you would other text. For example, the following instruction inserts a tab character:</P>
<P CLASS="spacing"><BR></P>
<PRE>Insert "        "                        'Insert a tab character
</PRE>
<P CLASS="t">Just looking at this instruction, though, it's difficult to tell whether you intend to insert a tab character or several spaces. In general, it's a better practice to use the <B>Chr$</B><B>()</B> function with <B>Insert</B> to insert nonprinting characters:</P>
<P CLASS="spacing"><BR></P>
<PRE>Insert Chr$(9)                        'Insert a tab character
</PRE>
<P CLASS="t">To insert paragraph marks, use <B>InsertPara</B>.</P>
<P CLASS="t">If you want to insert text into a document that isn't active, you include statements in your macro to open the document or switch to it. The following example activates the document associated with the variable LetterDoc$ and moves the insertion point to a bookmark called "Closing" before inserting text:</P>
<P CLASS="spacing"><BR></P>
<PRE>Activate LetterDoc$                'Switch to the LetterDoc$ window
EditGoTo "Closing"                'Move the insertion point to a bookmark
Insert "Sincerely yours"            'Insert text</PRE>
<H3 CLASS="h3"><A NAME="sec1"></A>Working on Part of a Document</H3><P CLASS="t">Quite often, you want a macro to operate on only part of a document. For example, a macro that creates a table and inserts information into the table should operate just within the table. Or a macro may be designed to perform a series of formatting and editing operations on a particular paragraph.</P>
<P CLASS="t">The most useful tool Word provides for identifying discrete parts of documents is bookmarks. A simple use for bookmarks is just to mark a selection or location in a&nbsp;document. The following instruction marks the current selection (or the current location of the insertion point if there is no selection) with the bookmark "temp":</P>
<P CLASS="spacing"><BR></P>
<PRE>EditBookmark .Name = "temp", .Add
</PRE>
<P CLASS="t">You can also use bookmarks to select text between two arbitrary locations in a&nbsp;document, as shown in the following example. It marks the current location with&nbsp;the bookmark "temp" and then pastes text from the Clipboard into the next paragraph. The <B>ExtendSelection</B> instruction activates extend mode, and the <B>EditGoto</B> instruction returns to the "temp" bookmark, selecting all the text between the end of the inserted text and "temp" as it does so.</P>
<P CLASS="spacing"><BR></P>
<PRE>EditBookmark .Name = "temp", .Add        'Insert bookmark "temp"
ParaDown                                    'Move to next paragraph
EditPaste                                'Paste from Clipboard
ExtendSelection                            'Activate extend selection
EditGoto "temp"                            'Return to "temp"; select text
</PRE>
<P CLASS="t">Word provides a set of predefined bookmarks for macros. These bookmarks do not appear in the list of bookmarks that appears in the Bookmark and Go To dialog boxes (Edit menu), but a macro can use them in the same way it can use other bookmarks. Here is the list of predefined bookmarks.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="275pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Bookmark</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Sel</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current selection or the insertion point</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;PrevSel1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Most recent location where editing occurred</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;PrevSel2</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Second most recent location where editing occurred</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;StartOfSel</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Start of the current selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;EndOfSel</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">End of the current selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Line</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current line or the first line of the current selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Char</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current character or the character following the insertion point if&nbsp;there is no selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Para</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current paragraph or the first paragraph of the selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Section</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current section or the first section in the selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Doc</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Entire contents of the active document</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="275pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Bookmark</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Page</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current page or the first page of the selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;StartOfDoc</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Beginning of the document</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;EndOfDoc</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">End of the document</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Cell</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current cell or the first cell in the selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;Table</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Current table or the entire first table of the selection</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">\&nbsp;HeadingLevel</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The heading that contains the insertion point or selection, plus any&nbsp;subordinate headings and text</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">For a more detailed description of the predefined bookmarks, see "Operators and Predefined Bookmarks" in Part 2, "WordBasic Reference."</P>
<P CLASS="t">The following example places a tab character in front of every paragraph in a table cell. The first instruction uses the predefined bookmark "&nbsp;\&nbsp;Cell" to select the&nbsp;current cell (assuming the insertion point is already within a cell). The <B>EditReplace</B> instruction then replaces every paragraph mark with a paragraph mark and a tab character. After the replace operation, each paragraph except the first paragraph (since it isn't preceded by a paragraph mark) begins with a tab character. The <B>CharLeft</B> instruction then moves the insertion point to the start of&nbsp;the cell and inserts a tab character in front of the first paragraph.</P>
<P CLASS="spacing"><BR></P>
<PRE>EditGoTo "\Cell"
EditReplace .Find = "^p", .Replace = "^p^t", .Direction = 0, \
            .ReplaceAll, .Format = 0, .Wrap = 0
CharLeft
Insert Chr$(9)
</PRE>
<P CLASS="t">You can use the <B>SelInfo</B><B>()</B> function to test whether the insertion point is within a table. The following example uses <B>SelInfo</B><B>()</B> to control a <B>While</B> loop that moves through a table and inserts information into each cell. When the macro reaches the last cell of the table, it stops.</P>
<P CLASS="spacing"><BR></P>
<PRE>EditGoTo .Destination = "t"                'Go to next table
While SelInfo(12) = - 1
    'Series of instructions to run while in the table
Wend
</PRE>
<P CLASS="t">For more information, see <B>SelInfo</B><B>()</B> in Part 2, "WordBasic Reference."</P>
<H3 CLASS="h3"><A NAME="sec2"></A>Reading Text from a Document</H3><P CLASS="t">Frequently, a macro needs to "read" text from a document. For example, if a macro is moving through a document, it may need to check its location by checking the contents of a selection.</P>
<P CLASS="t">You use the <B>Selection$</B><B>()</B> function to return the contents of the current selection. If no text is selected, <B>Selection$</B><B>()</B> returns the character following the insertion point. The following example determines whether or not a paragraph contains text or just consists of a paragraph mark. If the selection is just a paragraph mark (Chr$(13) is equivalent to a paragraph mark), the message "This paragraph is empty" is displayed.</P>
<P CLASS="spacing"><BR></P>
<PRE>EditGoto "\Para"                            'Select paragraph
If Selection$() = Chr$(13) Then            'Test selection
    MsgBox "This paragraph is empty."
Else
    MsgBox "This paragraph contains text."
End If
</PRE>
<P CLASS="t">You can also use the <B>GetBookmark$</B><B>()</B><B> </B>function to return text marked by a bookmark. For more information, see <B>Selection$</B><B>()</B> and <B>GetBookmark$</B><B>()</B> in Part&nbsp;2, "WordBasic Reference."</P>
<H3 CLASS="h3"><A NAME="sec3"></A>Testing for the End of a Document</H3><P CLASS="t">You often need macros to perform a series of operations on every instance of a&nbsp;particular element in a document. For example, you might want a macro to change the capitalization of every heading formatted with the Heading 5 style. A&nbsp;common way to set up this sort of macro is to have the macro start at the beginning of the document and stop when it reaches the end of the document.</P>
<P CLASS="t">Word provides several ways to test for the end of the document. The most straightforward is the <B>AtEndOfDocument</B><B>()</B> function, which returns a true value,<BR> –1, when the insertion point is at the end of the document. The following loop operates until the insertion point reaches the end of the document:</P>
<P CLASS="spacing"><BR></P>
<PRE>While AtEndOfDocument() &lt;&gt; -1
    'Series of instructions to run until the end of the document
Wend
</PRE>
<P CLASS="t">The <B>LineDown</B><B>()</B> and <B>ParaDown</B><B>()</B> functions return a false value, 0 (zero), when they are unable to move the insertion point, which occurs only when they are at the end of a document. The following loop moves through the document a paragraph at a time until the insertion point reaches the end of the document:</P>
<P CLASS="spacing"><BR></P>
<PRE>While ParaDown()
    'Series of instructions to run until the end of the document
Wend
</PRE>
<P CLASS="t">The end of a document is defined as the location just in front of the final paragraph mark in the document. The functions <B>AtEndOfDocument</B><B>()</B>, <B>LineDown</B><B>()</B>, and <B>ParaDown</B><B>()</B> will not return a value indicating the end of a document unless the insertion point is at that location. It is not enough for the insertion point to be somewhere on the last line or somewhere in the last paragraph of a document.</P>
<P CLASS="t">You can also use <B>CmpBookmarks</B><B>()</B> to test for the end of of the document, as&nbsp;shown in the following example:</P>
<P CLASS="spacing"><BR></P>
<PRE>While CmpBookmarks("\Sel", "\EndOfDoc")
    'Series of instructions to run until the end of the document
Wend
</PRE>
<P CLASS="t">The <B>EditFind</B> and <B>EditReplace</B> instructions do not directly test for the end of a document, but you can use them to perform a task for as long as something is&nbsp;found. The following example changes the capitalization of each Heading 5 paragraph in a document. After the first search for a heading, the <B>While</B><FONT FACE="Symbol"><B>¼</B></FONT><B>Wend</B> loop repeats the search until no more headings formatted with the Heading 5 style are found:</P>
<P CLASS="spacing"><BR></P>
<PRE>StartOfDocument
EditFindClearFormatting
EditFindStyle .Style = "Heading 5"
EditFind .Find = "", .Direction = 0, .Format = 1, .Wrap = 0
While EditFindFound() = - 1
    ChangeCase 2                'Capitalize first letter of each word
    RepeatFind
Wend
</PRE></FONT></FONT></BODY></HTML>
