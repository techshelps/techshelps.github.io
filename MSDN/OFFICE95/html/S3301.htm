<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetDocumentVar, SetDocumentVar()</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">SetDocumentVar, SetDocumentVar()</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SetDocumentVar </B><I>VariableName$</I><B>,</B> <I>VariableText$</I></P>
<P CLASS="syn"><B>SetDocumentVar(</B><I>VariableName$</I><B>,</B> <I>VariableText$</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">The <B>SetDocumentVar</B> statement associates the string <I>VariableText$</I> with the active document. You use the <I>VariableName$</I> argument with the function <B>GetDocumentVar$</B><B>()</B> to return the associated string when the document is active. The variable is saved with the document. You can set multiple document variables for a single document. To delete a document variable, specify an empty string ("") for <I>VariableText$</I>. If the insertion point is not in a document&nbsp;—&nbsp;for example, if the macro-editing window is active&nbsp;—&nbsp;an error occurs.</P>
<P CLASS="t">The <B>SetDocumentVar</B><B>()</B> function behaves the same as the statement, and also returns –1 if the variable is set successfully.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example prompts for a reminder note to store with a document before closing it. If the macro were named FileClose, it would run each time the user chose Close from the File menu (the instruction FileClose runs the built-in command).</P>
<P CLASS="t">The instruction On Error Goto CloseNow ensures that a WordBasic error doesn't appear if the user cancels the <B>InputBox$</B><B>()</B> dialog box. The instructions Err&nbsp;=&nbsp;0 and On Error Resume Next reset error handling and ensure that an error doesn't appear if the user cancels the prompt to save changes.</P>
<P CLASS="spacing"><BR></P>
<PRE>On Error Goto CloseNow
worknote$&nbsp;=&nbsp;InputBox$("Type a note for next time:")
SetDocumentVar "reminder", worknote$
CloseNow:
Err&nbsp;=&nbsp;0
On Error Resume Next
FileClose
</PRE>
<P CLASS="t">For an example of an AutoOpen macro that displays the most recent reminder note each time the document is opened, see <B>GetDocumentVar$</B><B>()</B>.</P>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>GetDocumentVar$</B><B>()</B></P></FONT></FONT></BODY></HTML>
