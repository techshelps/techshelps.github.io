<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>For...Next Statement</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>For...Next Statement</H1><P CLASS="h"><B>Description</B></P>
<P CLASS="t">Repeats a group of statements a specified number of times.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>For</B> <I>counter</I> <B>=</B> <I>start</I> <B>To</B> <I>end</I> [<B>Step</B> <I>step</I>]<BR>    [<I>statements</I>]<BR>    [<B>Exit For</B>]<BR>    [<I>statements</I>]<BR><B>Next</B> [<I>counter</I>]</P>
<P CLASS="t">The <B>For</B>...<B>Next</B> statement syntax has these parts:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="70pt" VALIGN="TOP"><COL WIDTH="278pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Part</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>counter</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Numeric variable used as a loop counter. The variable can't be any array element or any element of a user-defined type.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>start</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Initial value of <I>counter</I>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>end</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Final value of <I>counter</I>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>step</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Amount <I>counter</I> is changed each time through the loop. If not specified, <I>step</I> defaults to one.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>statements</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">One or more statements between <B>For</B> and <B>Next</B> that are executed the specified number of times.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">The <I>step</I> argument can be either positive or negative. The value of the <I>step</I> argument determines loop processing as follows:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="249pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Value</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Loop executes if</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Positive or 0</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>counter</I> &lt;= <I>end</I></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Negative</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>counter</I> &gt;= <I>end</I></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">Once the loop starts and all statements in the loop have executed, <I>step</I> is added to <I>counter</I>. At this point, either the statements in the loop execute again (based on the same test that caused the loop to execute initially), or the loop is exited and execution continues with the statement following the <B>Next</B> statement.</P>
<P></P>
<P CLASS="nh"><B>Tip</B></P>
<P CLASS="nt">Changing the value of <I>counter</I> while inside a loop can make it more difficult to read and debug.</P>
<P></P>
<P CLASS="t">The <B>Exit For</B> can only be used within a <B>For Each</B>...<B>Next</B> or <B>For</B>...<B>Next</B> control structure to provide an alternate way to exit. Any number of <B>Exit For</B> statements may be placed anywhere in the loop. The <B>Exit For </B>is often used with the evaluation of some condition (for example, <B>If</B>...<B>Then</B>), and transfers control to the statement immediately following <B>Next</B>.</P>
<P CLASS="t">You can nest <B>For</B>...<B>Next</B> loops by placing one <B>For</B>...<B>Next</B> loop within another. Give each loop a unique variable name as its <I>counter</I>. The following construction is correct:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">For I = 1 To 10
    For J = 1 To 10
        For K = 1 To 10
            .<B> </B>.<B> </B>.
        Next K
    Next J
Next I
</FONT></PRE>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">If you omit <I>counter</I> in a <B>Next</B> statement, execution continues as if you had included it. If a <B>Next</B> statement is encountered before its corresponding <B>For</B> statement, an error occurs.</P>
<P></P>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>Do</B>...<B>Loop</B> Statement, <B>Exit</B> Statement, <B>For Each</B>...<B>Next</B> Statement, <B>While</B>...<B>Wend</B> Statement.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example uses the <B>For</B>...<B>Next</B> statement to create a string that contains 10 instances of the numbers 0 through 9, each string separated from the other by a single space. The outer loop uses a loop counter variable that is decremented each time through the loop.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">For Words = 10 To 1 Step -1     ' Set up 10 repetitions.
    For Chars = 0 To 9    ' Set up 10 repetitions.
        MyString = MyString &amp; Chars    ' Append number to string.
    Next Chars
    MyString = MyString &amp; " "    ' Append a space.
Next Words
</FONT></PRE>
<P CLASS="t">This example displays the number of columns in the selection on Sheet1. The code also tests for a multiple-area selection; if one exists, the code loops on the areas of the selection.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Worksheets("Sheet1").Activate
areaCount = Selection.Areas.Count
If areaCount &lt;= 1 Then
    MsgBox "The selection contains " &amp; _
        Selection.Columns.Count &amp; " columns."
Else
    For i = 1 To areaCount
        MsgBox "Area " &amp; i &amp; " of the selection contains " &amp; _
            Selection.Areas(i).Columns.Count &amp; " columns."
    Next i
End If
</FONT></PRE>
<P CLASS="t">This example creates a new worksheet and then inserts a list of the active workbook's sheet names in the first column.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Set newSheet = Sheets.Add(Type:=xlWorksheet)
For i = 1 To Sheets.Count
    newSheet.Cells(i, 1).Value = Sheets(i).Name
Next i
</FONT></PRE>
<P CLASS="t">This example selects every other item in list box one on Sheet1.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Dim items() As Boolean
Set lbox = Worksheets("Sheet1").ListBoxes(1)
ReDim items(1 To lbox.ListCount)
For i = 1 To lbox.ListCount
    If i Mod 2 = 1 Then
        items(i) = True
    Else
        items(i) = False
    End If
Next
lbox.MultiSelect = xlExtended
lbox.Selected = items</FONT></PRE></FONT>
</FONT></BODY></HTML>
