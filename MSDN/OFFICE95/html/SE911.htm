<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL.EXEC.QUERY</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="data sources, querying"><META NAME="MS-HKWD" CONTENT="querying, data sources"><META NAME="MS-HKWD" CONTENT="sending, queries to data sources"><META NAME="MS-HKWD" CONTENT="SQL.EXEC.QUERY function"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    SQL.EXEC.QUERY</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Sends a query to a data source using an existing connection. If this function is not available, you must install the Microsoft ODBC add-in (XLODBC.XLA).</P>
<P></P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SQL.EXEC.QUERY</B>(<B>connection_num</B>, <B>query_text</B>)</P>
<P CLASS="t">Connection_num    is the unique connection ID of the data source you want to query.</P>
<UL><LI>Connection_num is returned by a previously executed SQL.OPEN function.</LI><LI>If connection_num is not valid, SQL.EXEC.QUERY returns the #VALUE! error value.</LI></UL><P></P>
<P CLASS="t">Query_text is the SQL language query that is to be executed on the data source. The query must follow the SQL syntax guidelines in the appendix of the Microsoft Excel ODBC Developers Guide.</P>
<UL><LI>If SQL.EXEC.QUERY is unable to execute query_text on the specified data source, SQL.EXEC.QUERY returns the #N/A error value.</LI><LI>Excel limits strings to a length of 255 characters. If query_text needs to be longer than 255 characters then query_text should be a vertical array or vertical range of cells. The values in the array will be joined together to form the complete SQL query.</LI></UL><P></P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>Before calling SQL.EXEC.QUERY a connection must be established with a data source using SQL.OPEN. A successful call to SQL.OPEN returns a unique connection ID number. SQL.EXEC.QUERY uses that connection ID number to send SQL language queries to the data source.</LI><LI>Any results generated from the query will not be returned immediately-- SQL.EXEC.QUERY only executes the query. Retrieving results is handled by the functions SQL.RETRIEVE and SQL.RETRIEVE.TO.FILE.</LI><LI>If SQL.EXEC.QUERY is called using a previously used connection ID number, all pending results on that connection will automatically be discarded. The connection ID will then refer to the new query and its results.</LI><LI>If SQL.EXEC.QUERY is unable to successfully execute the query on the specified data source then an error value will be returned. In such a case SQL.EXEC.QUERY will place error information in memory for the SQL.ERROR function, if such information is available. If SQL.EXEC.QUERY is able to successfully execute the query on the specified connection it will return one of three values depending on the type of SQL statement that was executed.

<UL><LI>If it was a SELECT statement then SQL.EXEC.QUERY will return the number of result columns available.</LI><LI>If it was an UPDATE, INSERT, or DELETE statement then SQL.EXEC.QUERY will return the number of rows affected by the statement.</LI><LI>If it was a legal SQL query that is not in one of the categories above, SQL.EXEC.QUERY will return 0 (zero).</LI></UL></LI></UL><P CLASS="h"><B>Example</B></P>
<P CLASS="t">SQL.EXEC.QUERY(conn1, "SELECT Custmr_ID, Due_Date FROM Orders WHERE Order_Amt &gt; 100") executes a SQL query from a SQL table named "Orders"</P>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE913.HTM">SQL.OPEN</A>    Establishes a connection with a data source</P>
<P><A class="normal" href="SE90E.HTM">SQL.BIND</A>    Specifies storage for a result column</P>
<P><A class="normal" href="SE915.HTM">SQL.RETRIEVE.TO.FILE</A>    Retrieves query results and places them in a file</P>
<P><A class="normal" href="SE914.HTM">SQL.RETRIEVE</A>    Retrieves query results</P>
<P><A class="normal" href="SE912.HTM">SQL.GET.SCHEMA</A>    Gets information about a connected data source.</P>
<P><A class="normal" href="SE90F.HTM">SQL.CLOSE</A>    Closes a data source connection</P>
<P><A class="normal" href="SE910.HTM">SQL.ERROR</A>    Returns detailed error information</P>
<P>List of <A class="normal" href="SE742.HTM">Command-Equivalent Functions</A></P></FONT>
</FONT></BODY></HTML>
