<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDEPoke Method</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>DDEPoke Method</H1><P CLASS="h"><B>Applies To</B></P>
<P CLASS="t"><B>Application </B>Object.</P>
<P CLASS="h"><B>Description</B></P>
<P CLASS="t">Sends data to an application. </P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><I>object</I>.<B>DDEPoke(</B><B><I>channel</I></B>,<B><I> item</I></B>,<B><I> data</I></B><B>)</B></P>
<P CLASS="term1"><I>object</I></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. The <B>Application</B> object.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>channel</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. The channel number returned by the <B>DDEInitiate</B> method.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>item</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. The item to which the data is to be sent.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>data</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. The data to send to the application.</P>
</BLOCKQUOTE>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">An error occurs if the method call is not successful.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example opens a channel to Word 6.0 for Windows, opens the Word document SALES.DOC, and then inserts the contents of cell A1 (on Sheet1) at the beginning of the document.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">channelNumber = Application.DDEInitiate( _
    app:="WinWord", _
    topic:="C:\WINWORD\SALES.DOC")
Set rangeToPoke = Worksheets("Sheet1").Range("A1")
Application.DDEPoke channelNumber, "\StartOfDoc", rangeToPoke
Application.DDETerminate channelNumber
</FONT></PRE>
<P CLASS="t">This example opens a channel to Word 6.0 for the Macintosh, opens the Word document Sales Report, and then inserts the contents of cell A1 (on Sheet1) at the beginning of the document. On the Macintosh, you must use the <B>Shell</B> function to start Word, because the <B>DDEInitiate</B> method does not automatically start Word as it does in Windows. Also, because the <B>Shell</B> function is asynchronous, the macro may call the <B>DDEInitiate</B> method before Word has started. This example demonstrates how you can program around this by putting the <B>DDEInitiate</B> method call in a loop, testing channelNumber until it is no longer an error.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Shell "HD:Sales Report", 6
Do
    channelNumber = Application.DDEInitiate( _
        app:="WinWord", _
        topic:="HD:Sales Report")
Loop Until TypeName(channelNumber) &lt;&gt; "Error"
Set rangeToPoke = Worksheets("Sheet1").Range("A1")
Application.DDEPoke channelNumber, "\StartOfDoc", rangeToPoke
Application.DDETerminate channelNumber</FONT></PRE></FONT>
</FONT></BODY></HTML>
