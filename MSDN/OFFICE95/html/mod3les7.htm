<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Lesson 7: Workgroup Features</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<H1>Lesson 7: Workgroup Features</font></H1>

<p><b>Lesson
Objectives</b></font></p>
  
        <p>Upon
        completion of this lesson, the participant will be able
        to:</font></p>
    
    <ul>
        <li>List
            the Project mail-related macro commands.</font></li>
        <li>Describe
            the purpose of the four messagetype values for the
            MailSendProjectMail command.</font></li>
        <li>Demonstrate
            the use of MailSend, MailRoutingSlip, and
            MailSendProjectMail in a macro.</font></li>
    </ul>
    
        <p><b>Some Topics to
        be introduced in this lesson include:</b></font></p>
        <ul>
            <li>Project
                Mail-Related Macro Commands</font></li>
        </ul>
    


<p><b><i>Programming
Workgroup Features</i></b></font></p>
  
        <p>This
        section includes a discussion of the macro commands
        related to the mail features in MSProject. See Online
        Help for full documentation. Here's the macro commands as
        they are used in the default standard menu (right click
        the menu bar and choose customize, then edit the Standard
        menu bar):</font></p>
    

<div align="center"><center>

<table border="1" cellpadding="7" width="559">
    <tr>
        <td width="39%" bgcolor="#FFFFFF"><p align="center"><b>Menu item</b></font></p>
        </td>
        <td width="61%" bgcolor="#FFFFFF"><p align="center"><b>Macro command</b></font></p>
        </td>
    </tr>
    <tr>
        <td width="39%"><b>File</b></font></td>
        <td width="61%"><font color="#000000"
        face="verdana,arial,helvetica"></font>&nbsp;</td>
    </tr>
    <tr>
        <td width="39%">
            <p>Send</font></p>
        
        </td>
        <td width="61%">MailSend </font></td>
    </tr>
    <tr>
        <td width="39%">
            <p>[Add/Edit
            Routing Slip] </font></p>
        
        </td>
        <td width="61%">MailRoutingSlip</font></td>
    </tr>
    <tr>
        <td width="39%"><b>Tools, Multiple Project</b></font></td>
        <td width="61%"><font color="#000000"
        face="verdana,arial,helvetica"></font>&nbsp;</td>
    </tr>
    <tr>
        <td width="39%">
            <p>Open
            from Database</font></p>
        
        </td>
        <td width="61%">Macro &quot;OpenFromDatabase&quot;</font></td>
    </tr>
    <tr>
        <td width="39%">
            <p>Save
            to Database</font></p>
        
        </td>
        <td width="61%">Macro &quot;SaveToDatabase&quot;</font></td>
    </tr>
    <tr>
        <td width="39%"><b>Tools, Workgroup</b></font></td>
        <td width="61%"><font color="#000000"
        face="verdana,arial,helvetica"></font>&nbsp;</td>
    </tr>
    <tr>
        <td width="39%">
            <p>Send
            Task Request</font></p>
        
        </td>
        <td width="61%">MailSendProjectMail</font></td>
    </tr>
    <tr>
        <td width="39%">
            <p>Send
            Task Update</font></p>
        
        </td>
        <td width="61%">MailSendProjectMail
        MessageType:=&quot;TaskUpdates&quot;</font></td>
    </tr>
    <tr>
        <td width="39%">
            <p>Request
            Task Update</font></p>
        
        </td>
        <td width="61%">MailSendProjectMail
        MessageType:=&quot;UpdateRequest&quot;</font></td>
    </tr>
    <tr>
        <td width="39%">
            <p>Set
            Reminder</font></p>
        
        </td>
        <td width="61%">SchedulePlusReminderSet</font></td>
    </tr>
    <tr>
        <td width="39%">
            <p>Send
            Schedule Note </font></p>
        
        </td>
        <td width="61%">MailSendScheduleNote</font></td>
    </tr>
</table>
</center></div>
  
        
            <p>The
            available mail related macro commands are listed and
            discussed below:</font></p>
            
                <ul>
                    <li>MailLogOff</font></li>
                    <li>MailLogOn</font></li>
                    <li>MailRoutingSlip</font></li>
                    <li>MailSend</font></li>
                    <li>MailSendProjectMail</font></li>
                    <li>MailSendScheduleNote</font></li>
                    <li>MailSession</font></li>
                    <li>MailSystem</font></li>
                    <li>MailUpdateProject</font></li>
                    <li>SchedulePlusReminderSet</font></li>
                </ul>
            
            <p>Note
            the difference between establishing a session and
            running the Mail application itself. None of the
            MSProject mail commands start the Mail application
            directly, although you'll get a system message asking
            if you want to log on to mail.</font></p>
        
        <p><b>Email Address</b></font></p>
        
            <p>Some
            of the mail commands can automatically send mail to
            resources (commands without a &quot;To&quot;
            argument). If the Email Address field for a resource
            is nonblank, then it must contain a valid email name.
            If the Email Address field is blank, then the
            resource name field is used instead.</font></p>
        
        <p><b>MailSend </b></font><i>to, cc,
        subject, body, enclosures, includeDocument, returnReceipt</i></font></p>
        
            <p><b>What
            it sends</b>: Normal piece of mail with options for
            attachments (enclosures), and an option to attach a
            copy of the active project.</font></p>
            <p><b>Who
            it goes to</b>: Recipients specified by the <i><u>to</u></i>
            argument.</font></p>
            <p>Some
            of the arguments are discussed below. See Online Help
            for complete documentation.</font></p>
            <p><i><u>enclosures</u></i></font></p>
            <p>Can
            be a string containing a list of filenames to attach
            to the mail.</font></p>
            <p><i><u>includeDocument</u></i></font></p>
            <p>Set
            True to attach a copy of the active project. </font></p>
            <p><i><u>body</u></i></font></p>
            <p>Can
            be multiline text (e.g. s=&quot;line1&quot; &amp;
            chr(10) &amp; &quot;line2&quot;)</font></p>
            <p><i><u>to</u></i></font></p>
            <p>Online
            Help says the &quot;to&quot; argument can be a list
            of names separated by semicolons. However, MailSend
            actually treats them as a single name. For example, </font></p>
            
                <p>MailSend
                To:=&quot;Jim; Mary&quot; </font></p>
            
            <p>causes
            an error message saying it can't find &quot;Jim;
            Mary&quot;.</font></p>
            <p>Leave
            out the To: argument to get a dialog box.</font></p>
        
        <p><b>MailRoutingSlip</b></font><b><i> </i></b><i>to,
        subject, body, allAtOnce, returnWhenDone, trackStatus,</i></font></p>
        <p><i>clear,
        sendNow</i></font></p>
        
            <p><b>What
            it sends</b>: Normal piece of mail with an attached
            copy of the active project.</font></p>
            <p><b>Who
            it goes to</b>: Recipients specified by the <i><u>to</u></i>
            argument.</font></p>
            <p>Some
            of the arguments are discussed below. See Online Help
            for complete documentation.</font></p>
            <p><i><u>to</u></i></font></p>
            <p>Same
            as in the MailSend method.</font></p>
            <p><i><u>clear</u></i></font></p>
            <p>After
            a routing slip is sent, the File menu changes
            &quot;Add Routing Slip&quot; to &quot;Edit Routing
            Slip&quot;; if you send the slip again, you get the
            message:</font></p>
            <p><b>You
            have routed this project before. Do you want to route
            it again?</b></font></p>
            <p>To
            reset it, use: </font></p>
            <p><b>MailRoutingSlip
            Clear:=True</b></font></p>
            <p><i><u>sendNow</u></i></font></p>
            <p>Prevents
            the mail from being sent if set to False.</font></p>
        
        <p><b>MailSendProjectMail</b></font><b> </b><i>messageType,
        subject, body, fields, updateAsOf, showDialog,
        installationMessage</i></font></p>
        
            <p><b>What
            it sends</b>: Depends on the <i><u>messageType</u></i>
            argument. See below.</font></p>
            <p><b>Who
            it goes to</b>: Sends mail to resources assigned to
            the tasks - each resource only receives mail about
            the tasks it is assigned to.</font></p>
            <p>The
            arguments <i><u>subject</u></i> and <i><u>body</u></i>
            replace default expressions.</font></p>
            <p>The
            Project must be saved - otherwise it tells you it
            must be saved and asks if you want to save it.</font></p>
            <p>A
            task table must be active. Depending on the value of
            the <i><u>messageType</u></i> argument, it will look
            at all tasks, selected tasks, or it will prompt you.
            If <i><u>messageType</u></i> is &quot;Custom&quot; ,
            then it looks only at selected tasks, and you get an
            error if no tasks are selected. The other choices for
            <i><u>messageType</u></i> behave as follows: It looks
            at selected tasks if more than one task is selected.
            If only one task is selected, then it prompts you to
            choose all tasks or selected tasks. If no task is
            selected, then it looks at all tasks.</font></p>
            <p>Some
            of the arguments are discussed below. See Online Help
            for complete documentation.</font></p>
            <p><i><u>messageType</u></i></font></p>
            <p>This
            is the most important argument. It can be one of the
            following strings:</font></p>
            
                <p>&quot;Custom&quot;</font></p>
                <p>&quot;TaskRequest&quot;
                (default)</font></p>
                <p>&quot;TaskUpdates&quot;</font></p>
                <p>&quot;UpdateRequest&quot;</font></p>
            
            <p><i><u>messageType</u></i><u>:=&quot;Custom&quot;</u>
            - Sends specified field information to resources
            assigned to selected tasks. You must specify the <i><u>fields</u></i>
            argument otherwise you get a fields dialog to select
            from. When a resource opens the mail, the fields
            cannot be edited. The resource can send a response,
            but the original sender can't use the response to
            update fields in the project.</font></p>
            <p><i><u>messageType</u></i><u>:=&quot;TaskRequest&quot;</u>
            - Asks resources to accept task assignments. When a
            resource opens the mail, the fields automatically
            included are:</font></p>
            
                <p>Accept?</font></p>
                <p>Task
                Name</font></p>
                <p>Work</font></p>
                <p>Start</font></p>
                <p>Finish</font></p>
                <p>Comments</font></p>
            
            <p>If
            the fields argument is used, then additional read
            only fields show up to the right of the automatic
            ones. Only &quot;Accept?&quot; and
            &quot;Comments&quot; can be edited when a resource
            opens the mail. When the resource replies and
            confirms the task, it automatically tries to make a
            task in the resource's Schedule+.</font></p>
            <p><i><u>messageType</u></i><u>:=&quot;TaskUpdates&quot;</u>
            - Tells resources of changes in assigned task dates.
            It only includes tasks with Yes in the &quot;Update
            Needed&quot; task field, which only happens if at
            least one resource confirmed a request, and the dates
            have since changed. The task &quot;Confirmed&quot;
            field is Yes if no resources are assigned to a task.
            If a task has resources, then &quot;Confirmed&quot;
            is No until all resources assigned to the task have
            confirmed task requests. </font></p>
            <p>BUG:
            If R confirms T, and then R is unassigned and
            reassigned to T, then TaskUpdates asks if you want to
            send mail to R to tell it that it's no longer
            assigned to T.</font></p>
            <p>When
            a resource opens the mail, the fields automatically
            included are:</font></p>
            
                <p>Task
                Name</font></p>
                <p>Work</font></p>
                <p>Start</font></p>
                <p>Finish</font></p>
                <p>Comments</font></p>
            
            <p>If
            the fields argument is used, then additional read
            only fields show up to the right of the automatic
            ones. None of the fields can be edited. If a resource
            opens the mail and chooses the &quot;Update
            Schedule+&quot; button, then a new task is added to
            the resource's Schedule+ with the updated dates - it
            doesn't remove the old task from Schedule+.</font></p>
            <p><i><u>messageType</u></i><u>:=&quot;UpdateRequest&quot;</u>
            Requests status from resources on the selected tasks.
            </font></p>
            <p>The <i><u>updateAsOf</u></i>
            argument is only used if the <i><u>messageType</u></i>
            is &quot;UpdateRequest&quot;. It causes the following
            phrase to show up in the mail:</font></p>
            <p>Enter
            status as of : ...</font></p>
            <p>It
            will send update requests to a resource even if the
            resource has never confirmed a TaskRequest.</font></p>
            <p>When
            a resource opens the mail, the fields automatically
            included are:</font></p>
            
                <p>Task
                Name</font></p>
                <p>Start</font></p>
                <p>Work</font></p>
                <p>Completed</font></p>
                <p>Remaining
                Work</font></p>
                <p>Comments</font></p>
            
            <p>If
            the <i><u>fields</u></i> argument is used, then
            additional read only fields show up to the right of
            the automatic ones. The task Name field and any extra
            fields cannot be edited or updated. If a resource
            opens the mail and double clicks any field or selects
            the Reply button, the Reply button changes to a Send
            button, and a question mark character is placed by
            the following field names: Start, Work Completed, and
            Remaining Work. At that point, the resource can edit
            the fields with the question marks.</font></p>
            <p>NOTE:
            If a resource opens the mail and changes the start
            date, then the task in Schedule+ does not get
            updated.</font></p>
            <p><i><u>fields</u></i></font></p>
            <p>Specifies
            the (only) task fields used if <i><u>messageType</u></i><u>:=&quot;Custom&quot;</u>,
            or additional fields used with other message types.
            Titles can be put in square brackets after field
            name, e.g.
            Fields:=&quot;Duration,Name[Event],Start&quot;. Some
            fields like Name use the default title like Task Name
            unless you specify a title in []. The titles used in
            the project tables don't matter.</font></p>
            <p>Note:
            When a resource opens the mail, they cannot edit any
            of the extra fields specified by the fields argument.
            The extra fields appear to the right of the automatic
            fields.</font></p>
            <p><i><u>installationMessage</u></i></font></p>
            <p>Optional
            message that replaces the default error message that
            occurs if the message handler is not properly
            installed.</font></p>
        
        <p><b>MailSendScheduleNote</b></font><b> </b><i>manager,
        taskContacts, resources, selection, includeDocument,
        includePicture, body, subject</i></font></p>
        
            <p><b>What
            it sends</b>: Normal piece of mail with options for
            attaching a copy and/or picture of the active
            project.</font></p>
            <p><b>Who
            it goes to</b>: All resources or selected resources
            or resources assigned to selected tasks, depending on
            the active view and the value of the <i><u>selection</u></i>
            argument. There are also options to include the
            manager and contacts in the mailing list.</font></p>
            <p>It
            works in any view. The <i><u>selection</u></i>
            argument can be true if a task or resource table is
            active.</font></p>
            <p>The
            arguments <i><u>subject</u></i> and <i><u>body</u></i>
            replace default expressions.</font></p>
        
        <p><b>MailUpdateProject</b></font> <i>dataFile</i></font></p>
        
            <p>The <i><u>dataFile</u></i>
            argument must be the fullname of the kind of file
            invisibly attached to a mail reply to a TaskRequest
            or a mail reply to an UpdateRequest. To get this
            filename, you need to use MAPI calls in MAPI.dll
            and/or VBAMAPI.dll, or write a VB application using
            the MAPI Session and MAPI Messages custom controls
            (In VB, choose File, Add File, and select MSMAPI.VBX
            - it's probably in the system directory). Note that
            you can't use File, Save Attachment in mail to save
            this special kind of attachment.</font></p>
            <p>If
            it's the right kind of data file, then MSProject
            reads it and updates the appropriate project.</font></p>
        
        <p><b>SchedulePlusReminderSet</b></font><b> </b><i>start,
        leadTime</i></font></p>
        
            <p>For
            each selected task and each resource assigned, it
            creates an appointment with a reminder for the
            resource in Schedule+. A task table must be active.</font></p>
            <p>Note:
            SchedulePlusReminderSet creates appointments in
            Schedule+, whereas MailSendProjectMail (with
            messagetype:= &quot;TaskRequest&quot; or
            &quot;TaskUpdates&quot; or &quot;UpdateRequest&quot;)
            creates tasks in Schedule+.</font></p>
        
        <p><b>MailLogoff</b></font></p>
        
            <p>Do
            this after other MSProject mail commands, otherwise
            you can't exit and sign out of the mail application
            while project is still running - you can exit Mail,
            but you can't exit and sign out. MailLogoff notifies
            the mail spooler that it is done using it.</font></p>
        
        <p><b>MailLogon</b></font> <i>name,
        password, downloadNewMail</i></font></p>
        
            <p>Allows
            you to start a session without the sign on dialog box
            - if you know the user name and password - and
            control whether new mail is downloaded. The <i>name </i>argument
            is the name of the user who will be sending mail.</font></p>
        
        <p><b>MailSession</b></font></p>
        
            <p>You
            can check if this property is Null to see if another
            mail command failed, for example: </font></p>
            <p><b>On
            Error Resume Next</b></font></p>
            <p><b>MailLogon</b></font></p>
            <p><b>If
            IsNull(MailSession) then ...</b></font></p>
        
        <p><b>MailSystem</b></font></p>
        
            <p>You
            can use this property to find out what type of mail
            system is available:</font></p>
            
                <p>0
                pjNoMailSystem Unrecognized or none</font></p>
                <p>1
                pjMAPI Microsoft Mail</font></p>
                <p>3
                pjMAPICompatible MAPI compatible</font></p>
            
        
    
    <H1><i>Lesson
    7 Exercises</i></H1>   

<ol>
 <li>Assume
    the resource EmailAddress field in the active project
    contains valid email names. Write a macro that loops through
    all the nonblank resource records and uses MailSend to send
    mail to each resource listing their standard and overtime
    rate on separate lines in the body of the mail, for example,</font></li><br> <br>
    
        <p>Standard
        Rate: $20.00/h</font></p>
        <p>Overtime
        Rate: $30.00/h</font></p>
        <p>The mail
        subject line is: Rates</font></p>
    
    <p>Use the <i>To,
    Subject, Body</i>, and <i>IncludeDocument</i> arguments of
    the MailSend method. You need to set the <i>IncludeDocument</i>
    argument to False to prevent it from attaching a copy of the
    active project to the mail (<i>IncludeDocument</i> defaults
    to True).</font></p>
    <p>Test it out
    on a project that has some valid email names entered in the
    resource EmailAddress field. Open the mail and see if it
    worked.</font></p>
    <li>Assume
    the EmailAddress resource field in the active project
    contains valid email names. Write a macro that sends mail to
    each resource, where the body of the mail to a resource is
    its multiline notes (from the Resource Form). The subject of
    the mail is &quot;Multiline Notes&quot;. This is similar to
    exercise 1. Use GetField to get the multiline notes.</font></li><br> <br>
    <li>Write a
    macro that sends a Task Request to all the resources that are
    assigned to tasks. The subject of the mail should say
    &quot;Assignments&quot;, the body should say &quot;Respond
    ASAP&quot;, and the &quot;Resources Names&quot; field should
    be included with the usual Task Request fields. Don't show
    any dialog boxes.</font></li></ol>

</FONT></BODY>
</html>
