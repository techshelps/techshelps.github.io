<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CANCEL.KEY</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="CANCEL.KEY function"><META NAME="MS-HKWD" CONTENT="disabling macro interruption"><META NAME="MS-HKWD" CONTENT="macro interruption"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    CANCEL.KEY</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Disables macro interruption, or specifies a macro to run when a macro is interrupted. Use CANCEL.KEY to control what happens when a macro is interrupted.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>CANCEL.KEY</B>(<B>enable</B>, macro_ref)</P>
<P CLASS="t">Enable    specifies whether the macro can be interrupted by pressing ESC in Microsoft Excel for Windows or ESC or COMMAND+PERIOD in Microsoft Excel for the Macintosh.</P>
<P>If enable is    Then</P>
<P CLASS="tr">    </P>
<P>FALSE    Pressing ESC or COMMAND+PERIOD does not interrupt a macro</P>
<P>TRUE and macro_ref is omitted    Pressing ESC or COMMAND+PERIOD interrupts a macro</P>
<P>TRUE and macro_ref is specified    Macro_ref runs when ESC or COMMAND+PERIOD is pressed</P>
<P></P>
<P CLASS="t">Macro_ref    is a reference to a macro, as a cell reference or a name, that runs when enable is TRUE and ESC or COMMAND+PERIOD is pressed.</P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>CANCEL.KEY affects only the macro that is currently running. Once the macro is stopped by a RETURN or HALT function, ESC or COMMAND+PERIOD is reactivated.</LI><LI>When CANCEL.KEY is in effect, users can still cancel a dialog box displayed while the macro is running.</LI></UL><P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">The following macro formula prevents the macro from being interrupted by pressing ESC or COMMAND+PERIOD:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">CANCEL.KEY(FALSE)
</FONT></PRE>
<P CLASS="t">The following macro formula reactivates ESC or COMMAND+PERIOD to cancel macro execution:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">CANCEL.KEY(TRUE)
</FONT></PRE>
<P CLASS="t">The following line in a macro runs CheckCancel when ESC or COMMAND+PERIOD is pressed:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">CANCEL.KEY(TRUE, CheckCancel)
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE754.HTM">ERROR</A>    Specifies an action to take if an error occurs while a macro is running</P>
<P><A class="normal" href="SE87F.HTM">ON.KEY</A>    Runs a macro when a specified key is pressed</P>
<P><A class="normal" href="SE881.HTM">ON.TIME</A>    Runs a macro at a specified time</P>
<P>List of <A class="normal" href="SE744.HTM">Customizing Functions</A></P></FONT>
</FONT></BODY></HTML>
