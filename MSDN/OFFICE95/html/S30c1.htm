<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDEExecute</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">DDEExecute</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>DDEExecute </B><I>ChanNum</I><B>,</B><B><I> </I></B><I>Command$</I></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Sends a command or series of commands to an application through a dynamic-data exchange (DDE) channel. </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="274pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>ChanNum</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The channel number of the DDE conversation as returned by <B>DDEInitiate</B><B>()</B>. If <I>ChanNum</I> doesn't correspond to an open channel, an error occurs.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Command$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A command or series of commands recognized by the server application. In Windows, you can also use the format described under <B>SendKeys</B> to send specific key sequences. If the server application can't perform the specified command, an error occurs.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">In Microsoft Excel and many other applications that support DDE, <I>Command$</I> should be one or more statements or functions in the application's macro language. For example, in Microsoft Excel the XLM macro instruction to create a new worksheet is NEW(1). To send the same command through a DDE channel, you use the following instruction:</P>
<P CLASS="spacing"><BR></P>
<PRE>DDEExecute channel, "[NEW(1)]"
</PRE>
<P CLASS="t">Note that some applications, including Microsoft Excel, require that each command received through a DDE channel be enclosed in brackets.</P>
<P CLASS="t">You can use a single <B>DDEExecute</B> instruction to send more than one command. For example, the following instruction tells Microsoft Excel to open and then close a worksheet:</P>
<P CLASS="spacing"><BR></P>
<PRE>DDEExecute channel, "[NEW(1)][FILE.CLOSE(0)]"
</PRE>
<P CLASS="t">Note that there is no space between the bracketed commands; a space character between the commands would cause an error. The preceding instruction is equivalent to the following two instructions:</P>
<P CLASS="spacing"><BR></P>
<PRE>DDEExecute channel, "[NEW(1)]"
DDEExecute channel, "[FILE.CLOSE(0)]"
</PRE>
<P CLASS="t">Many commands require arguments in the form of strings enclosed in quotation marks. Because quotation marks indicate the beginning and end of a string in WordBasic, you must use Chr$(34) to include a quotation mark in a command string. For example, the following instruction tells Microsoft Excel to open SALES.XLS:</P>
<P CLASS="spacing"><BR></P>
<PRE>DDEExecute channel, "[OPEN(" + Chr$(34) + "SALES.XLS" + Chr$(34) + ")]"
</PRE>
<P CLASS="t">For more information on sending commands to Microsoft Excel and other applications, see Chapter 8, "Communicating with Other Applications" in Part 1, "Learning WordBasic."</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example starts Microsoft Excel if it is not running and then opens a channel to Microsoft Excel and the System topic (for information on the System topic, see <B>DDERequest$(</B><B> </B><B>)</B>). The example then sends commands to open SALES.XLS (Windows) or BLUE SKY SALES (Macintosh) and go to cell R4C2. Unlike a document, which may or may not be open, the System topic is always available when Microsoft Excel is running.</P>
<P CLASS="t">Here is the Windows version of the example:</P>
<P CLASS="spacing"><BR></P>
<PRE>If AppIsRunning("Microsoft Excel")&nbsp;=&nbsp;0 Then Shell "C:\EXCEL\EXCEL.EXE"
channel&nbsp;=&nbsp;DDEInitiate("Excel", "System")
q$ = Chr$(34)
cmd1$&nbsp;=&nbsp;"[OPEN(" + q$ + "C:\EXCEL\EXAMPLES\SALES.XLS" + q$ + ")]"
cmd2$ = "[SELECT(" + q$ + " R4C2" + q$ + ", " + q$ + " R4C2" + q$ + ")]"
bothcmds$ = cmd1$ + cmd2$
DDEExecute channel, bothcmds$
</PRE>
<P CLASS="t">And here is the Macintosh version:</P>
<P CLASS="spacing"><BR></P>
<PRE>If AppIsRunning(MacID$("XCEL"))&nbsp;=&nbsp;0 Then Shell MacID$("XCEL")
channel&nbsp;=&nbsp;DDEInitiate("Excel", "System")
q$ = Chr$(34)
cmd1$&nbsp;=&nbsp;"[OPEN(" + q$ + "HD1:EXCEL:EXAMPLES:BLUE SKY SALES" + q$ + ")]"
cmd2$ = "[SELECT(" + q$ + " R4C2" + q$ + ", " + q$ + " R4C2" + q$ + ")]"
bothcmds$ = cmd1$ + cmd2$
DDEExecute channel, bothcmds$
</PRE>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>DDEInitiate</B><B>()</B>,<B> DDEPoke</B>,<B> DDERequest$</B><B>()</B>,<B> DDETerminate</B>,<B> DDETerminateAll</B></P></FONT></FONT></BODY></HTML>
