<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Commands and Separator Bars</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Adding Commands and Separator Bars</H2><P CLASS="t">You can add commands and separator bars to any built-in or custom menu. This section deals with adding these items to drop-down menus and shortcut menus. The following section addresses the specific issues of adding submenus and then adding menu items to those submenus.</P>
<H3><A NAME="sec0"></A>Using the Menu Editor</H3><P CLASS="t">The Menu Editor offers an easy method for adding items to menus.</P>
<P CLASS="proch"><B><img src="prcarrow.gif">    To add a menu item to a drop-down menu or shortcut menu</B></P>
<P CLASS="ls">    1.    While a Visual Basic module is active, click Menu Editor on the Tools menu.</P>
<P CLASS="ls">    2.    In the Menu Bars box, click the name of a menu bar or a group of shortcut menus.</P>
<P CLASS="ls">    3.    In the Menus box, click the name of the menu to which you want to add the menu item or the object for which a shortcut menu is defined.</P>
<P CLASS="ls">    4.    In the Menu Items box, click the name of the menu item above which you want to insert the new menu item.</P>
<P CLASS="lt1">– Or –</P>
<P CLASS="lt1">To add a menu item to the bottom of the menu, click End Of Menu.</P>
<P CLASS="ls">    5.    Click Insert to create the new menu item.</P>
<P CLASS="ls">    6.    In the Caption box, type a name for the new menu item.</P>
<P CLASS="lt1">Type an ampersand (&amp;) before the character you want to use as the access key for the new menu item. To create a separator bar, type one hyphen (<B>-</B>).</P>
<P CLASS="ls">    7.    To specify that a particular procedure run whenever the user clicks the new menu item, enter the name of the procedure in the Macro box.</P>
<H3><A NAME="sec1"></A>Using Visual Basic</H3><P CLASS="t">Use the <B>Add</B> method of the <B>MenuItems</B> collection to add a new menu item to the specified menu. You can specify the menu item caption, its position on the menu, and the name of the procedure to run when the user clicks the menu item.</P>
<P CLASS="t">The following example adds an Open Database menu item to the File menu on the Worksheet menu bar. Microsoft Excel runs the OpenDatabaseProc Visual Basic procedure whenever the user clicks the menu item. Open Database appears directly above the Close item on the File menu.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Set databaseItem = MenuBars(xlWorksheet).Menus("File") _
    .MenuItems.Add(Caption:="Open &amp;Database", _
        OnAction:="OpenDatabaseProc", _
        before:="Close")
</FONT></PRE>
<P CLASS="t">To place the menu item at the end of the specified menu, omit the <B><I>before</I></B><I> </I>argument.</P>
<P CLASS="t">To create a separator bar, specify "-" for the new menu caption, as shown in the following example.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlWorksheet).Menus("File").MenuItems.Add _
    Caption:="-", before:="Close"
</FONT></PRE>
<P CLASS="t">You cannot create a new shortcut menu, but you can modify a built-in shortcut menu by adding or deleting menu items. The following example adds a Format Special menu item at the end of the Worksheet Cell shortcut menu. Notice that although shortcut menus are displayed as groups in the Menu Editor, those menu groups don't actually belong to the <B>MenuBars</B> collection. To access shortcut menus, you must use the <B>ShortcutMenus</B> method instead of the <B>MenuBars</B> method.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ShortcutMenus(xlWorksheetCell).MenuItems.Add _
    Caption:="Format &amp;Special", OnAction:="FormatSpecialProc"
</FONT></PRE></FONT>
</FONT></BODY></HTML>
