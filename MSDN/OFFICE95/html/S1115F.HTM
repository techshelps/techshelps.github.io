<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>#If...Then...#Else Directive</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<H1>#If...Then...#Else Directive</h1>

<H2>Description</h2>

<p class="t">Conditionally compiles selected blocks of Visual
Basic code.</p>

<H2>Syntax</h2>

<p class="syn"><b>#If</b> <i>expression</i> <b>Then</b> <i>statements</i>[<b>#ElseIf</b><i>
expression-n</i> <b>Then</b> [<i>elseifstatements</i>]][<b>#Else</b>
[<i>elsestatements</i>]]<b>#End If</b></p>

<p class="t">The <b>#If...Then...#Else</b> directive syntax has
these parts:</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>expression</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Any expression, consisting exclusively
        of one or more conditional compiler constants, literals,
        and operators, that evaluates to <b>True</b> or <b>False</b>.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>statements</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Visual Basic program lines or compiler
        directives that are evaluated if the associated
        expression is <b>True</b>.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>expression-n</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Same as <i>expression</i>.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>elseifstatements </i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">One or more program lines or compiler
        directives that are evaluated if <i>expression-n</i> is <b>True</b>.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>elsestatements</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">One or more program lines or compiler
        directives that are evaluated if no previous <i>expression</i>
        or <i>expression-n</i> is <b>True</b>.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<H2>Remarks</h2>

<p class="t">The behavior of the <b>#If...Then...#Else</b>
directive is the same as the <b>If...Then...Else</b> statement,
except that there is no single-line form of the <b>#If</b>, <b>#Else</b>,
<b>#ElseIf</b>, and <b>#End If</b> directives, that is, no other
code can appear on the same line as any of the directives.
Conditional compilation is typically used to compile the same
program for different platforms. It is also used to prevent
debugging code from appearing in an executable file. Code
excluded during conditional compilation is completely omitted
from the final executable file, so it has no size or performance
effect.</p>

<p class="t">Regardless of outcome of any evaluation, all
expressions are evaluated. Therefore, all constants used in
expressions must be defined &#151; any undefined constant
evaluates as <b>Empty</b>.</p>

<p class="nt"><b>Note</b> The <b>Option Compare</b> statement
does not affect expressions in <b>#If</b> and <b>#ElseIf</b>
statements. Expressions in a conditional-compiler directive are
always evaluated with <b>Option Compare Text</b>.</p>

<H2>See Also</h2>

<p class="t"><b>#Const</b> Directive, <b>If...Then...Else</b>
Statement.</p>

<H2>Example</h2>

<p class="t">This example references conditional compiler
constants in a <b>#If...Then...#Else</b> construct to determine
whether to compile certain statements.</p>

<p class="spacing"><br>
</p>

<pre>' If Win16 evaluates as true, do the statements following the #If.
#If Win16 Then 
    '. Place exclusively 16-bit Windows statements here.
    '.
    '.
' Otherwise, if it is a 32-bit Windows program, do this:
#ElseIf Win32 Then    
    '. Place exclusively 32-bit Windows statements here.
    '.
    '.
' Otherwise, if it is neither, do this:
#Else
    '. Place other platform statements here.
    '.
    '.
#End If
</pre>
</FONT></FONT></BODY>
</html>
