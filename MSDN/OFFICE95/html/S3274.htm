<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MailMergeState()</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">MailMergeState()</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>MailMergeState(</B><I>Type</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Returns one of four different types of information about the current state of a mail-merge setup. <I>Type</I> 1, <I>Type</I> 2, and <I>Type</I> 3 return –1 if the active document is not a main document, data source, or header source.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="274pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B><I>Type</I></B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Values and descriptions</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">0 (zero)</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Returns information about the active document:</P>
<P CLASS="tt">0 (zero)    Regular Word document</P>
<P CLASS="tt">1    Main document with no data or header source attached</P>
<P CLASS="tt">2    Main document with an attached data source</P>
<P CLASS="tt">3    Main document with an attached header source</P>
<P CLASS="tt">4    Main document with both a data and header source attached</P>
<P CLASS="tt">5    Data source or header source; associated main document is open</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Returns the kind of main document:</P>
<P CLASS="tt">0 (zero)    Form letters</P>
<P CLASS="tt">1    Mailing labels</P>
<P CLASS="tt">2    Envelopes</P>
<P CLASS="tt">3    Catalog</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">2</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Returns information about the selected mail-merge options:</P>
<P CLASS="tt">0 (zero)    Neither blank-line suppression nor query options are enabled.</P>
<P CLASS="tt">1    Blank-line suppression is enabled.</P>
<P CLASS="tt">2    Query options are enabled.</P>
<P CLASS="tt">3    Both blank-line suppression and query options are enabled.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">3</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Returns the mail-merge destination:</P>
<P CLASS="tt">0 (zero)    New document</P>
<P CLASS="tt">1    Printer</P>
<P CLASS="tt">2    Electronic mail</P>
<P CLASS="tt">3    Fax</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example checks the state of the active document before performing a mail merge. If the active document is not a main document, Word displays a message box. If the document is a main document but has no attached data source, a data source is attached. In any other case, the mail merge begins immediately.</P>
<P CLASS="spacing"><BR></P>
<PRE>Select Case MailMergeState(0)
    Case 0
        MsgBox "Not a mail merge main document."
        quitmacro<B>&nbsp;=&nbsp;</B>1
    Case 1, 3
        MailMergeOpenDataSource .Name<B>&nbsp;=&nbsp;</B>"C:\DATA\DATA.DOC"
    Case Else
End Select
If quitmacro<B>&nbsp;=&nbsp;</B>1 Then Goto bye
MailMergeToPrinter
bye:
</PRE>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>MailMergeMainDocumentType</B></P></FONT></FONT></BODY></HTML>
