<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Optional Arguments</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Using Optional Arguments</H2><P CLASS="t">You can specify that arguments to a procedure be optional by using the <B>Optional</B> keyword in the argument list. If you specify an optional argument, all subsequent arguments in the argument list must also be optional and must be declared with the <B>Optional</B> keyword. Optional arguments must be of the <B>Variant</B> data type.</P>
<P CLASS="t">For example, the following procedure takes two required arguments and two optional arguments. The procedure selects a range of cells on the worksheet named "SampleText" and then optionally makes the text red and sorts the range by the values in the first column.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub FormatList(startRow As Integer, startCol As Integer, _
        Optional redText, Optional sortList)
    If IsMissing(redText) Then
        redText = False
    Else
        redText = CBool(redText)
    End If
    If IsMissing(sortList) Then
        sortList = False
    Else
        sortList = CBool(sortList)
    End If
    Set myCells = Worksheets("SampleText") _
        .Cells(startRow, startCol).CurrentRegion
    If redText Then
        textColor = 3
    Else
        textColor = xlAutomatic
    End If
    myCells.Font.ColorIndex = textColor
    If sortList Then myCells.Sort key1:=myCells.Cells(1, 1)
End Sub
</FONT></PRE>
<P CLASS="t">The <B>IsMissing</B> function is used to determine whether an optional argument was passed to the procedure. For more information, see "IsMissing" in Help.</P>
<P CLASS="t">The following example calls FormatList, providing both the required and optional arguments.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub DoList()
    FormatList 2, 2, False, True
End Sub
</FONT></PRE>
<P CLASS="t">The following example provides the second optional argument.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub DoList()
    FormatList 2, 2, , True
End Sub
</FONT></PRE>
<P CLASS="t">If your procedure has several optional arguments, you may want to use named arguments so that you can provide any or all of the arguments, in any order. For more information, see the following section.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt"><B>Sub</B> procedures with optional arguments won't appear in the Macro dialog box (Tools menu). (No <B>Function</B> procedures appear in the Macro dialog box.) You can, however, see procedures with optional arguments in the Object Browser.</P>
<P></P></FONT>
</FONT></BODY></HTML>
