<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLOpen Function</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>SQLOpen Function</H1><P CLASS="h"><B>Description</B></P>
<P CLASS="t">In Microsoft Excel for Windows 95, do not use <B>SQLOpen</B> and the other ODBC functions in the XLODBC.XLA add-in; use the objects, methods, and properties in the Data Access Objects (DAO) library instead.</P>
<P CLASS="t"><B>SQLOpen</B> establishes a connection to a data source.</P>
<P CLASS="t">This function is contained in the XLODBC.XLA add-in (ODBC Add-In on the Macintosh). Before you use the function, you must establish a reference to the add-in using the References command (Tools menu).<I>.</I></P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SQLOpen</B>(<B><I>connectionStr</I></B><I>, </I><B><I>outputRef</I></B><I>, </I><B><I>driverPrompt</I></B>)</P>
<P CLASS="term1"><B><I>connectionStr</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. Supplies the information required by the driver being used to connect to a data source and must follow the driver's format.</P>
<P CLASS="dt1">The <B><I>connectionStr</I></B> supplies the data source name and other information, such as user ID and passwords, that is required by the driver to make a connection.</P>
<P CLASS="dt1">You must define the data source name (DSN) used in <B><I>connectionStr</I></B> before you try to connect to it.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>outputRef</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. A single cell, as a <B>Range</B> object, that contains the completed connection string.</P>
<P CLASS="dt1">Use <B><I>outputRef</I></B> when you want <B>SQLOpen</B> to return the completed connection string to a worksheet.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>driverPrompt</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. Specifies when the driver dialog box is displayed and which options are available. Use one of the numbers described in the following table. If <B><I>driverPrompt</I></B> is omitted, <B>SQLOpen</B> uses 2 as the default.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="161pt" VALIGN="TOP"><COL WIDTH="172pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Value</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Meaning</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"><B></B></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>1</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is always displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>2</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is displayed only if information provided by the connection string and the data source specification are not sufficient to complete the connection. All dialog box options are available.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>3</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">The same as 2 except that dialog box options that are not required are dimmed and unavailable.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><B>4</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Driver dialog box is not displayed. If the connection is not successful, <B>SQLOpen</B> returns an error.</P></FONT></TD></TR></TBODY></TABLE>
</BLOCKQUOTE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="h"><B>Return Value</B></P>
<P CLASS="t">If successful, <B>SQLOpen</B> returns a unique connection ID number. Use the connection ID number with the other ODBC functions.</P>
<P CLASS="t">If <B>SQLOpen</B> is unable to connect using the information you provide, it returns Error 2042. Additional error information is placed in memory for use by <B>SQLError</B>.</P>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>SQLBind</B> Function, <B>SQLClose</B> Function, <B>SQLError</B> Function, <B>SQLExecQuery</B> Function, <B>SQLGetSchema</B> Function, <B>SQLRequest</B> Function, <B>SQLRetrieve</B> Function, <B>SQLRetrieveToFile</B> Function.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example runs a query on the NWind sample database. The result of the query, displayed on Sheet1, is a list of all products that are currently on order.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">If Application.OperatingSystem Like "*Win*" Then
    databaseName = "NWind"
Else        'Macintosh
    databaseName = "NorthWind"
End If
queryString = "SELECT * FROM product.dbf WHERE (product.ON_ORDER&lt;&gt;0)"
chan = SQLOpen("DSN=" &amp; databaseName)
SQLExecQuery chan, queryString
Set output = Worksheets("Sheet1").Range("A1")
SQLRetrieve chan, output, , , True
SQLClose chan
</FONT></PRE></FONT>
</FONT></BODY></HTML>
