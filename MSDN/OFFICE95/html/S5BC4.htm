<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Submenus and Submenu Items</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Adding Submenus and Submenu Items</H2><P CLASS="t">A submenu (child menu) is a menu attached to the right side of a menu item (the submenu caption) on another menu (the parent menu). Submenus can be added to both drop-down menus and shortcut menus.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">A submenu caption is a menu item on the submenu's parent menu. Any commands, separator bars, or submenu captions on the submenu are also menu items; the submenu is their parent menu.</P>
<P></P>
<P CLASS="t">Just as you display the items on a drop-down menu by clicking the menu caption on the menu bar,you display items on a submenu by pointing to the submenu caption on the parent menu. Similarly, just as you first add an empty drop-down menu (containing a caption but no menu items) to a menu bar and then add individual menu items, you first add an empty submenu to a parent menu and then add menu items.</P>
<P CLASS="t">You can add submenu items to existing custom or built-in submenus, but you cannot add submenu items to built-in commands. For example, you can add a submenu item to the Record Macro submenu on the Tools menu, but not to the Macro command on the Tools menu. You can, however, delete a built-in command, add a custom submenu caption with the same name as the built-in command, and then add submenu items to the custom submenu.</P>
<H3><A NAME="sec0"></A>Using the Menu Editor</H3><P CLASS="t">To add a custom submenu using the Menu Editor, you start by adding the submenu caption as a new menu item on the parent menu. To do this, simply follow the instructions in the preceding section for adding a command to a menu, and add the submenu caption as a menu item. You don't need to specify a procedure in the Macro box. After you've added the submenu caption, you can add the submenu items. You can also add submenu items to an existing custom submenu or custom command (after you add a submenu item to a custom command, the command becomes a submenu caption). </P>
<P CLASS="proch"><B><img src="prcarrow.gif">    To add a submenu item</B></P>
<P CLASS="ls">    1.    While a Visual Basic module is active, click Menu Editor on the Tools menu.</P>
<P CLASS="ls">    2.    In the Menu Bars box, click the name of a menu bar or a group of shortcut menus.</P>
<P CLASS="ls">    3.    In the Menus box, click the name of the menu to which you want to add the submenu or the object for which a shortcut menu is defined.</P>
<P CLASS="ls">    4.    In the Menu Items box, click the name of the menu item to which you want to add the submenu item.</P>
<P CLASS="ls">    5.    In the Submenu Items box, click the name of the submenu item above which you want to insert the new submenu item.</P>
<P CLASS="lt1">– Or –</P>
<P CLASS="lt1">To insert a submenu item at the bottom of the submenu, click End Of Submenu.</P>
<P CLASS="ls">    6.    Choose Insert to create the new submenu item.</P>
<P CLASS="ls">    7.    In the Caption box, type the name of the new submenu item.</P>
<P CLASS="lt1">Type an ampersand (<B>&amp;</B>) before the character you want to use as the access key for the new submenu item.</P>
<P CLASS="lt1">To create a separator bar, type one hyphen (<B>-</B>).</P>
<P CLASS="ls">    8.    To specify that a particular procedure run whenever the user chooses the submenu item, enter the name of the procedure in the Macro box.</P>
<P></P>
<H3><A NAME="sec1"></A>Using Visual Basic</H3><P CLASS="t">Adding a submenu to a menu using Visual Basic entails two main steps. First, you add the submenu caption to the parent menu, and then you add submenu items to the submenu. </P>
<P CLASS="t">The <B>AddMenu</B> method of the <B>MenuItems</B> collection adds a submenu caption. You cannot add submenu items to a command or separator bar created with the <B>Add</B> method. (This is different from the Menu Editor, where you use the same technique to add commands, separator bars, and submenu captions.) </P>
<P CLASS="t">The following example creates a custom menu.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlModule).Menus.Add "myMenu"
</FONT></PRE>
<P CLASS="t">The following example adds a submenu caption to a menu.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlModule).Menus("myMenu").MenuItems.AddMenu "mySM"
</FONT></PRE>
<P CLASS="t">Adding items to a submenu can be confusing because you must apply the <B>MenuItems</B> method once to access the submenu caption (a menu item on the parent menu), and then you must apply the method again to access the collection of menu items on the submenu. The following example adds a menu item to the submenu created in the preceding example.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlModule).Menus("myMenu").MenuItems("mySM") _
    .MenuItems.Add "mySMItem"
</FONT></PRE>
<P CLASS="t">The following example places a check mark next to a menu item on a submenu.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlModule).Menus("myMenu").MenuItems("mySM") _
    .MenuItems("mySMItem").Checked = True
</FONT></PRE>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">The <B>MenuItems</B> method returns a <B>MenuItem</B> object when the menu item is a command or a separator bar, and it returns a <B>Menu</B> object when the menu item is a submenu caption.</P>
<P></P>
<P CLASS="t">The following example combines the preceding four examples into one.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlModule).Menus.Add("myMenu").MenuItems.AddMenu("mySM") _
    .MenuItems.Add("mySMItem").Checked = True</FONT></PRE>
<P CLASS="t">The following example adds a new menu to the Worksheet menu bar and then adds several new menu items and a submenu to the new menu.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub AddNewMenu()
    Set sortMenu = MenuBars(xlWorksheet).Menus.Add("&amp;Sort By")
    With sortMenu.MenuItems
        .Add "Company Name", "SortByCompany"
        .Add "Category ID", "SortByCategory"
        .Add "Type", "SortByType"
        .Add ("-")
        .Add "Random", "SetRandomOrder"
        Set sortSubMenu = sortMenu.MenuItems _
                .AddMenu("Cost", before:="-")
            sortSubMenu.MenuItems.Add "Ascending", "SortByCostAscending"
            sortSubMenu.MenuItems.Add "Descending", _
                "SortByCostDescending"
    End With
End Sub</FONT></PRE></FONT>
</FONT></BODY></HTML>
