<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with MAPI Data Types</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H3 CLASS="h2">Working with MAPI Data Types</H3><H4 CLASS="h3"><A NAME="sec0"></A>Handle</H4><P CLASS="t">A handle is a short, signed integer. A valid handle is a non-negative integer. In the current release of MAPI, 0 (zero) is a valid session handle. A negative value for a handle indicates an error. The errors returned are the negative values of the MAPI errors documented in the <I>Microsoft Mail Technical Reference</I>. For example, the MAPI error MAPI_E_INVALID_RECIPS is returned as –25. SUCCESS_SUCCESS is returned as 0 (zero).</P>
<H4 CLASS="h3"><A NAME="sec1"></A>MapiFile</H4><P CLASS="t">The MapiFile<B> </B>data type is not supported in WordBasic. To retrieve the information about the file attachments of a message, use the <B>MAPIQueryAttachments</B> helper function. To add file attachments, use <B>MAPISetAttachment</B>.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>MapiMessage</H4><P CLASS="t">The MapiMessage data type is broken into its component data types. After <B>MAPIReadMail</B> returns successfully, use <B>MAPIQuerySubject</B>, <B>MAPIQueryOriginator</B>, and <B>MAPIQueryDateReceived</B> to retrieve envelope information about a message. Use <B>MAPIQueryNoteText</B> to retrieve the text of the message. Use successive calls to <B>MAPIQueryNoteText</B> to retrieve the text in usable chunks, since the message text can be longer than 65,280 characters, the maximum length of a WordBasic string.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>MapiRecip</H4><P CLASS="t">Several functions use or return a handle to a <B>MapiRecip</B> data type, which contains the recipient list of a message. To add addresses to new messages, follow this general procedure:</P>
<P CLASS="ls">    1.    Use <B>MAPIAddress</B> to allow the user to specify a recipient list.</P>
<P CLASS="ls">    2.    Use <B>MAPIQueryRecipientList</B> to retrieve information about recipients in the recipient list.</P>
<P CLASS="ls">    3.    Use <B>MAPIResolveName</B> to resolve ambiguous names in a recipient list.</P>
<P CLASS="ls">    4.    Finally, use <B>MAPISetRecipient</B> to add recipients to the current outbound message.</P>
<P></P>
<P CLASS="t">See "MAPIQueryRecipientList" later in this appendix for an example of addressing messages and resolving names.</P>
<P CLASS="t">Other helper functions, which you will probably use infrequently, provide greater detail and additional functionality. <B>MAPISetRecipientList</B> adds a complete recipient list to the current outbound message, but the function is useful only if the list does not contain any unresolved names. <B>MAPIQueryRecipientListCount</B> returns the number of names in a recipient list, and <B>MAPIQueryRecipientListElement</B> retrieves information about a specific recipient in the list.</P></FONT></FONT></BODY></HTML>
