<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FOR</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="conditional macro formulas"><META NAME="MS-HKWD" CONTENT="FOR function"><META NAME="MS-HKWD" CONTENT="FOR-NEXT loop, starting"><META NAME="MS-HKWD" CONTENT="loop, FOR-NEXT"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>   FOR</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Starts a FOR-NEXT loop. The instructions between FOR and NEXT are repeated until the loop counter reaches a specified value. Use FOR when you need to repeat instructions a specified number of times. Use FOR.CELL when you need to repeat instructions over a range of cells.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>FOR</B>(<B>counter_text, start_num, end_num, </B>step_num)</P>
<P CLASS="t">Counter_text    is the name of the loop counter in the form of text.</P>
<P CLASS="t">Start_num    is the value initially assigned to counter_text.</P>
<P CLASS="t">End_num    is the last value assigned to counter_text.</P>
<P CLASS="t">Step_num    is a value added to the loop counter after each iteration. If step_num is omitted, it is assumed to be 1.</P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>Microsoft Excel follows these steps as it executes a FOR-NEXT loop:</LI></UL><P CLASS="th"><B>Step    Action</B></P>
<P CLASS="tr">    </P>
<P CLASS="tt">1    Sets counter_text to the value start_num.</P>
<P CLASS="tt">2    If counter_text is greater than end_num (or less than end_num if step_num is negative), the loop ends, and the macro continues with the function after the NEXT function.</P>
<P CLASS="tt">    If counter_text is less than or equal to end_num (or greater than or equal to end_num if step_num is negative), the macro continues in the loop.</P>
<P CLASS="tt">3    Carries out functions up to the following NEXT function. The NEXT function must be below the FOR function and in the same column.</P>
<P CLASS="tt">4    Adds step_num to the loop counter.</P>
<P CLASS="tt">5    Returns to the FOR function and proceeds as described in step 2.</P>
<UL><LI>You can interrupt a FOR-NEXT loop by using the BREAK function.</LI></UL><P></P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">The following macro starts a FOR-NEXT loop that is executed once for every open window:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FOR("Counter", 1, COLUMNS(WINDOWS()))
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE751.HTM">BREAK</A>    Interrupts a FOR-NEXT, FOR.CELL-NEXT, or WHILE-NEXT loop</P>
<P><A class="normal" href="SE759.HTM">FOR.CELL</A>    Starts a FOR.CELL-NEXT loop</P>
<P><A class="normal" href="SE764.HTM">NEXT</A>    Ends a FOR-NEXT, FOR.CELL-NEXT, or WHILE-NEXT loop</P>
<P><A class="normal" href="SE770.HTM">WHILE</A>    Starts a WHILE-NEXT loop</P>
<P>List of <A class="normal" href="SE743.HTM">Control Functions</A></P></FONT>
</FONT></BODY></HTML>
