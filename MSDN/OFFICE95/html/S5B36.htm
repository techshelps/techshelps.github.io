<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with the Range Object</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Working with the Range Object</H2><P CLASS="t">The <B>Range</B> object can represent a single cell, a range of cells, an entire row or column, a selection containing multiple areas, or a 3-D range. The <B>Range</B> object is somewhat unusual in that it can represent both a single cell and multiple cells. There is no separate collection object for the <B>Range</B> object; you can think of it as being both a single object and a collection. There are many different properties and methods that return a <B>Range</B> object, as shown in the following list.</P>
<UL><LI><B>ActiveCell</B></LI><LI>BottomRightCell</LI><LI>Cells</LI><LI>ChangingCells</LI><LI>CircularReference</LI><LI>Columns</LI><LI>CurrentArray</LI><LI>CurrentRegion</LI><LI>Dependents</LI><LI>DirectDependents</LI><LI>DirectPrecedents</LI><LI>EntireColumn</LI><LI>EntireRow</LI><LI>Next</LI><LI>Offset</LI><LI>PageRange</LI><LI>Precedents</LI><LI>Range</LI><LI>RowFields</LI><LI>RowRange</LI><LI>Rows</LI><LI>Selection</LI><LI>TableRange1</LI><LI>TableRange2</LI><LI>TopLeftCell</LI><LI>UsedRange</LI><LI>VisibleRange</LI></UL><P></P>
<P CLASS="t">For more information about these properties and methods, see the individual property and method topics in Help.</P>
<H3><A NAME="sec0"></A>Using the Range Method</H3><P CLASS="t">One of the most common ways to return a <B>Range</B> object is to use the <B>Range</B> method. The argument to the <B>Range</B> method is a string that's either an A1-style reference or the name of a range. The examples in the following table show several different ways to use the <B>Range</B> method.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="125pt" VALIGN="TOP"><COL WIDTH="222pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>To do this</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Use the following code</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set the value of cell A1 on Sheet1</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Worksheets("Sheet1").Range("A1").Value = 3</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set the formula for cell B1 on the active sheet</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Range("B1").Formula = "=5-10*RAND()"</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set the value of each cell in the range C1:E3 on the active sheet</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Range("C1:E3").Value = 6</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Clear the contents of the range A1:E3 on the active sheet</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Range("A1", "E3").ClearContents</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set the font for the range named "myRange" (a workbook-level name) to bold</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Range("myRange").Font.Bold = True</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set the value of each cell in the range named "yourRange" (a&nbsp;sheet-level name) to bold</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Range("Sheet1!yourRange").Value = 3</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set an object variable to refer to a range</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Set objRange = Range("myRange")</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">Remember that expressions such as Range("C1:E3").Value = 6 assume that the <B>Range</B> method operates on the active sheet. If you try to run this code from the module that contains it, a run-time error occurs (error 1004, "Range method of Application class failed").</P>
<P CLASS="t">Another cause for errors can be using the <B>Range</B> method in an argument to another method, without fully qualifying the <B>Worksheet</B> object to which the <B>Range</B> method applies. For example, the following code, which is supposed to sort a range of cells on Sheet1, also causes run-time error 1004.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub SortRange()
Worksheets("Sheet1").Range("A1:B10").Sort _
    key1:=Range("A1"), order1:=xlDescending
End Sub
</FONT></PRE>
<P CLASS="t">This error is more difficult to find, because the line that contains the <B>Sort</B> method is correct. The error is caused by the second line, which contains the <B><I>key1</I></B> argument. This code will run correctly if Sheet1 is the active sheet, but it will fail when it's run from another worksheet or from a module. To correct the error, use the <B>Worksheets</B> method in the argument.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub SortRange()
    Worksheets("Sheet1").Range("A1:B10").Sort _
        key1:=Worksheets("Sheet1").Range("A1"), order1:=xlDescending
End Sub
</FONT></PRE>
<H3><A NAME="sec1"></A>Using the Cells Method</H3><P CLASS="t">The <B>Cells</B> method is similar to the <B>Range</B> method except that it takes numeric arguments instead of string arguments. When you use this method to return a single cell, the first argument is the row number of the cell, and the second argument is the column number of the cell. The examples in the following table show several different ways to use the <B>Cells</B> method.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="105pt" VALIGN="TOP"><COL WIDTH="242pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>To do this</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Use the following code</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set the value of cell A1 on Sheet1</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Worksheets("Sheet1").Cells(1, 1).Value = 3</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set the formula for cell B1 on the active sheet</P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Cells(1, 2).Formula = "=5-10*RAND()"</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Set an object variable </P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="ct">Set objRange = Worksheets("Sheet1").Cells(1, 1)</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The <B>Cells</B> method is very useful when you want to refer to cells using loop counters. For example, the following code loops through cells A1:D10 on Sheet1. If any of the cells has a value less than 0.01, the example replaces the value with 0&nbsp;(zero).</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub RoundToZero()
    For rwIndex = 1 to 4
        For colIndex = 1 to 10
            If Worksheets("Sheet1").Cells(rwIndex, colIndex) &lt; .01 Then
                Worksheets("Sheet1").Cells(rwIndex, colIndex).Value = 0
            End If
        Next colIndex
    Next rwIndex
End Sub
</FONT></PRE>
<P CLASS="t">The following example shows a quick and easy way to display items in a multicolumn list. The code creates a new worksheet and sets the object variable newSheet to refer to the worksheet. The code then creates a list of all the names in the active workbook and shows their formulas in A1-style notation.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub ListNames()
    Set newSheet = Worksheets.Add
    i = 1
    For Each nm In ActiveWorkbook.Names
        newSheet.Cells(i, 1).Value = nm.Name
        newSheet.Cells(i, 2).Value = "'" &amp; nm.RefersTo
        i = i + 1
    Next nm
    newSheet.Columns("A:B").AutoFit
End Sub
</FONT></PRE>
<H3><A NAME="sec2"></A>Combining the Range and Cells Methods</H3><P CLASS="t">In some situations, you may need to create a <B>Range</B> object based on a top row, a bottom row, a left column, and a right column, given as numbers. You can return <B>Range</B> objects by combining the <B>Range</B> and <B>Cells</B> methods in a single statement. The following code returns a <B>Range</B> object that refers to cells A1:D10 on Sheet1. The two <B>Cells</B> method calls define cells A1 and D10, and then the <B>Range</B> method call returns an object bounded by these two cells.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Set myObj = Worksheets("Sheet1").Range(Cells(1, 1), Cells(10, 4))
</FONT></PRE>
<P CLASS="t">The following code uses a <B>Range</B> object that refers to the range bounded by row 1 and column 1 at the upper left and by row 10 and column 6 at the lower right. The range bounds are variables in this example (rwMin, rwMax, and so on).</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub DemoCells()
    rwMin = 1   ' the top row
    rwMax = 10  ' the bottom row
    colMin = 1  ' the left column
    colMax = 6  ' the right column
    Set TLCell = Worksheets("Sheet1").Cells(rwMin, colMin)
    Set BRCell = Worksheets("Sheet1").Cells(rwMax, colMax)
    Set myRange = Worksheets("Sheet1").Range(TLCell, BRCell)
    myRange.Value = "abc"
End Sub
</FONT></PRE>
<H3><A NAME="sec3"></A>Using the Offset Method</H3><P CLASS="t">You often need to return a range of cells that's a certain number of rows or columns from another range of cells. The <B>Offset</B> method takes an input <B>Range</B> object, a <B><I>RowOffset</I></B> argument, and a <B><I>ColumnOffset</I></B> argument to return a new range. For example, the following code determines the type of data in each cell&nbsp;of&nbsp;a range. The code writes the data types in the column to the right of the input cells.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub ScanColumn()
    For Each c In Worksheets("Sheet1").Range("A1:A10").Cells
        If Application.IsText(c.Value) Then
            c.Offset(0, 1).Formula = "Text"
        ElseIf Application.IsNumber(c.Value) Then
            c.Offset(0, 1).Formula = "Number"
        ElseIf Application.IsLogical(c.Value) Then
            c.Offset(0, 1).Formula = "Boolean"
        ElseIf Application.IsError(c.Value) Then
            c.Offset(0, 1).Formula = "Error"
        ElseIf c.Value = "" Then
            c.Offset(0, 1).Formula = "(blank cell)"
        End If
    Next c
End Sub
</FONT></PRE>
<H3><A NAME="sec4"></A>Using the CurrentRegion and UsedRange Properties</H3><P CLASS="t">These two properties are very useful when your code operates on ranges whose size you have no control over. The current region is a range of cells bounded by empty rows and empty columns, or by a combination of empty rows, empty columns, and the edges of the worksheet.</P>
<P CLASS="t">The <B>CurrentRegion</B> property applies to a <B>Range</B> object. There can be many different current regions on a worksheet, depending on the <B>Range</B> object to which you apply the <B>CurrentRegion</B> property.</P>
<P CLASS="a">    <img src="APG0406.gif"></P>
<P CLASS="t">Suppose that Sheet1 contains a list to which you want to apply a number format. The only thing you know about the list is that it begins at cell A1 — you don't know how many rows or columns it contains. The following code shows how to format the list using the <B>CurrentRegion</B> property.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub FormatRange()
    Set myRange = Worksheets("Sheet1").Range("A1").CurrentRegion
    myRange.NumberFormat = "0.0"
End Sub
</FONT></PRE>
<P CLASS="t">The used range is bounded by the upper-left and lower-right nonempty cells on a worksheet. It's a range that contains every nonempty cell on the worksheet, as well as all the empty cells that are interspersed among them. There can be only one used range on a worksheet; the <B>UsedRange</B> property applies to a <B>Worksheet</B> object, not to a <B>Range</B> object.</P>
<P CLASS="a">    <img src="APG0407.gif"></P>
<P CLASS="t">Suppose that the active worksheet contains data from a timed experiment. The used range contains the dates in the first column, the times in the second column, and the measurements in the third and fourth columns. You want to write code that combines each separate date and time into a single value, converts that value from Greenwich Mean Time (GMT) to Pacific Standard Time, and then applies a date format. The raw data appears as in the following example.</P>
<P CLASS="a">    <img src="APG0408.gif"></P>
<P CLASS="t">Notice that the table can contain empty rows and columns. You can use the <B>UsedRange</B> property to return the entire used range, including the two embedded blank rows. The following code shows one way to convert and format the dates and times.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub ConvertDates()
    Set myRange = ActiveSheet.UsedRange
    myRange.Columns("C").Insert
    Set dateCol = myRange.Columns("C")
    For Each c In dateCol.Cells
        If c.Offset(0, -1).Value &lt;&gt; "" Then
            c.FormulaR1C1 = "=RC[-2]+RC[-1]-(8/24)"
        End If
    Next c
    dateCol.NumberFormat = "mmm-dd-yyyy hh:mm"
    dateCol.Copy
    dateCol.PasteSpecial Paste:=xlValues
    myRange.Columns("A:B").Delete
    dateCol.AutoFit
End Sub
</FONT></PRE>
<P CLASS="t">The formatted worksheet appears as in the following example.</P>
<P CLASS="a">    <img src="APG0409.gif"></P>
<P CLASS="t">Notice that the code uses the expression ActiveSheet.UsedRange.Columns("C") to return the third column from the used range (although this is the third column in the used range, it appears in column D on the worksheet because column A is empty). You can use other <B>Range</B> object properties and methods in a similar way to build complex expressions that return sub-ranges or super-ranges of an input <B>Range</B> object. Some properties and methods commonly used in this way are <B>Areas</B>, <B>Cells</B>, <B>Columns</B>, <B>EntireColumn</B>, <B>EntireRow</B>, <B>Range</B>, and <B>Rows</B>.</P>
<H3><A NAME="sec5"></A>Looping on a Range of Cells</H3><P CLASS="t">There are several different ways to loop on the cells in a range. This section shows examples of the <B>For Each...Next</B> statement and the <B>Do...Loop</B> statement applied to looping on a range of cells.</P>
<H4><A NAME="sec6"></A>Using For Each...Next</H4><P CLASS="t">The recommended way to loop on the cells in a range is to use the <B>For&nbsp;Each...Next</B> loop, which is also the recommended way to loop on the elements in a collection.</P>
<P CLASS="t">The following example shows how to loop through the range A1:D10 on Sheet1, setting any number whose absolute value is less than 0.01 to 0 (zero).</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub RoundToZero()
    For Each r In Worksheets("Sheet1").Range("A1:D10").Cells
        If Abs(r.Value) &lt; 0.01 Then
            r.Value = 0
        End If
    Next r
End Sub
</FONT></PRE>
<P CLASS="t">Suppose that you want to modify this code to loop over a range of cells that a user selects. One way of doing this is to use the <B>InputBox</B> method to prompt the user to select a range of cells. The <B>InputBox</B> method returns a <B>Range</B> object that represents the selection. By using the <B><I>type</I></B> argument and error handling, you can ensure that the user selects a valid range of cells before the input box is dismissed.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub RoundToZero()
    Worksheets("Sheet1").Activate
    On Error GoTo PressedCancel
    Set r = Application.InputBox( _
            prompt:="Select a range of cells", _
            Type:=8)
    On Error GoTo 0
    For Each c In r.Cells
        If Abs(c.Value) &lt; 0.01 Then
            c.Value = 0
        End If
    Next c
    Exit Sub
    
PressedCancel:
    Resume
End Sub
</FONT></PRE>
<P CLASS="t">If you don't want the user to select the range, you may be able to use the <B>CurrentRegion</B> property or the <B>UsedRange</B> property to return a <B>Range</B> object. For example, if you know that the data on Sheet1 begins at cell A1 and has no empty rows or columns, you can use the <B>CurrentRegion</B> property to return the entire range automatically.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub RoundToZero()
    Set r = Worksheets("Sheet1").Range("A1").CurrentRegion
    For Each c In r.Cells
        If Abs(c.Value) &lt; 0.01 Then
            c.Value = 0
        End If
    Next c
End Sub
</FONT></PRE>
<P CLASS="t">The following two examples show two different ways to hide every other column in the used range on Sheet1. The first example shows a <B>For Each...Next</B> loop in which the <B>Column</B> property of the object variable is tested.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub HideColumns()
    Set r = Worksheets("Sheet1").UsedRange
    For Each col In r.Columns
        If col.Column Mod 2 = 0 Then
            col.Hidden = True
        End If
    Next col
End Sub
</FONT></PRE>
<P CLASS="t">The second example shows a <B>For Each...Next</B> loop using a loop counter in which the loop counter is tested.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub HideColumns()
    Set r = Worksheets("Sheet1").UsedRange
    For i = 1 To r.Columns.Count
        If i Mod 2 = 0 Then
            r.Columns(i).Hidden = True
        End If
    Next i
End Sub
</FONT></PRE>
<H4><A NAME="sec7"></A>Using Do...Loop</H4><P CLASS="t">Occasionally, the <B>For Each...Next </B>loop isn't the best way to loop on a range. Suppose that you have a column of data and you want to write a macro that sorts the data and then deletes rows that contain duplicate data. You could try to use a <B>For Each...Next </B>loop, as shown in the following code.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub BuggyRemoveDuplicates()    ' DON'T USE THIS CODE!
    Worksheets("Sheet1").Range("A1").Sort _
        key1:=Worksheets("Sheet1").Range("A1")
    Set r = Worksheets("Sheet1").Range("A1").CurrentRegion.Columns("A")
    For Each c In r.Cells
        If c.Offset(1, 0).Value = c.Value Then
            c.Offset(1, 0).EntireRow.Delete
        End If
    Next c
End Sub
</FONT></PRE>
<P CLASS="t">Unfortunately, this code doesn't work correctly because the <B>Delete</B> method is modifying the range over which the <B>For Each...Next </B>loop is iterating. This causes duplicates not to be deleted in some cases.</P>
<P CLASS="t">A better solution is to use a <B>Do...Loop</B> structure, as shown in the following code.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub GoodRemoveDuplicates()
    Worksheets("Sheet1").Range("A1").Sort _
            key1:=Worksheets("Sheet1").Range("A1")
    Set currentCell = Worksheets("Sheet1").Range("A1")
    Do While Not IsEmpty(currentCell)
        Set nextCell = currentCell.Offset(1, 0)
        If nextCell.Value = currentCell.Value Then
            currentCell.EntireRow.Delete
        End If
        Set currentCell = nextCell
    Loop
End Sub
</FONT></PRE>
<P CLASS="t">The loop tests the object variable currentCell, exiting when it encounters an empty cell at the bottom of the column of data. You could build an equivalent loop by testing the value in currentCell against an empty string, as shown in the following code.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">    Do While currentCell.Value &lt;&gt; ""
        ' code here
    Loop
</FONT></PRE>
<P CLASS="t">In either case, don't forget to increment the cell (Set currentCell = nextCell, for example) at the bottom of the <B>Do...Loop</B> structure.</P>
<H3><A NAME="sec8"></A>Using the Address Property to Debug Range Object Code</H3><P CLASS="t">You can apply the <B>Address</B> property to any <B>Range</B> object. The <B>Address</B> property returns the cell address of a range, as a string. The following example shows how to use the <B>Address</B> property to debug the HideColumns code.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub HideColumns()
    Set r = Worksheets("Sheet1").UsedRange
    MsgBox r.Address  ' debugging only!
    For i = 1 To r.Columns.Count
        If i Mod 2 = 0 Then
            r.Columns(i).Hidden = True
            MsgBox r.Columns(i).Address  ' debugging only!
        End If
    Next i
End Sub
</FONT></PRE>
<P CLASS="t">You can also set watch expressions instead of using message boxes. For the preceding example, you could set two watch expressions — r.Address and r.Columns(i).Address — and then examine the values of the watch expressions in the Immediate pane of the Debug window. For more information about debugging, see Chapter 6, "Debugging."</P></FONT>
</FONT></BODY></HTML>
