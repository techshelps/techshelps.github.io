<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Linking Dialog Buttons To Code</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Linking Dialog Buttons To Code</H2><P CLASS="t">It's easy to run a macro when a user clicks buttons in a dialog.  Create the macro, then right click on the button and select Assign Macro.  In the case of the wizard the same Cancel, Back, Next, and Finish buttons appear in each dialog.  There are four common routines to set a global variable (GWizReturn) to a different value for each button.  The main routine then uses GWizReturn to control processing in the Select Case statements.  Here's a partial listing of the code:  </P>
<P>GProgress = 0</P>
<P></P>
<P>Wiz1Entry:</P>
<P>Call WizStep1 'WizStep1 will set GWizReturn depending on what button</P>
<P>              ' the user clicks.</P>
<P>'Set the tracking variable to indicate first dialog is complete.</P>
<P>GProgress = 1</P>
<P>Select Case GWizReturn</P>
<P>Case GO_BACK, CANCEL</P>
<P>    Call UndoWiz1</P>
<P>    GoTo TheVeryEnd</P>
<P>Case GO_NEXT</P>
<P>    'now set up for the second step of the wizard.</P>
<P>Wiz2Entry:</P>
<P>    Call WizStep2(UserInput:=True)</P>
<P>    GProgress = 2</P>
<P>    Select Case GWizReturn</P>
<P>    Case GO_BACK</P>
<P>        Call UndoWiz2</P>
<P>        GoTo Wiz1Entry</P>
<P>    Case CANCEL</P>
<P>        Call UndoWiz2</P>
<P>        Call UndoWiz1</P>
<P>        GoTo TheVeryEnd</P>
<P>    Case GO_NEXT</P>
<P>Wiz3Entry:</P>
<P>        Call WizStep3(UserInput:=True)</P>
<P>        ' . . .</P>
<P>        ' Code for steps 3 through 5 deleted for clarity</P>
<P>        ' . . .</P>
<P>        End Select</P>
<P>    Case FINISH</P>
<P>        Call FinishIt</P>
<P>    End Select</P>
<P>Case FINISH</P>
<P>    Call FinishIt</P>
<P>End Select</P>
<P>Example 6. Main routine processing</P></FONT>
</FONT></BODY></HTML>
