<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enabling or Disabling Menu Components</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Enabling or Disabling Menu Components</H2><P CLASS="t">If you want to prevent the user from choosing a particular menu item under certain conditions, you can disable it. A disabled command still appears on the menu, but it appears dimmed and doesn't respond to user actions. Use the <B>Enabled</B> property to enable or disable a menu item. The <B>Enabled</B> property is <B>True</B> if the menu item is enabled, and it's <B>False</B> if the menu item is disabled (you cannot set the <B>Enabled</B> property for a built-in menu item). The following example adds the Open Database menu item to the File menu on the Worksheet menu bar and then disables Open Database.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlWorksheet).Menus("File") _
    .MenuItems.Add("Open Database").Enabled = False
</FONT></PRE>
<P CLASS="t">If you want to disable all the commands on a drop-down menu, you can disable the menu itself. This effectively disables all the commands on the menu, as the user cannot access them. The following example disables the entire File menu on the Worksheet menu bar.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">MenuBars(xlWorksheet).Menus("File").Enabled = False
</FONT></PRE>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">You can disable all the menu items on a submenu, but you cannot disable the submenu itself.</P>
<P></P>
<P CLASS="t">The following example disables all the menu items on the Cost submenu that was created by the example in "Adding Submenus and Submenu Items" earlier in this chapter.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">With MenuBars(xlWorksheet).Menus("sort by").MenuItems("cost")
    For Each mnItem In .MenuItems
        mnItem.Enabled = False
    Next
End With
<B></B></FONT></PRE>
<P CLASS="t">You can enable or disable a shortcut menu by setting the <B>Enabled</B> property for menu item 0 (zero). The following example disables the Worksheet Cell shortcut menu.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ShortcutMenus(xlWorksheetCell).MenuItems(0).Enabled = False
</FONT></PRE></FONT>
</FONT></BODY></HTML>
