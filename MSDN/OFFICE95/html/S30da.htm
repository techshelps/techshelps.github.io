<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DlgLoadValues, DlgLoadValues()</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">DlgLoadValues, DlgLoadValues()</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>DlgLoadValues</B> <I>ValuesFile$</I><B>,</B> <I>Identifier$</I></P>
<P CLASS="t"><B>DlgLoadValues(</B><I>ValuesFile$</I><B>,</B> <I>Identifier$</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">On the Macintosh, the <B>DlgLoadValues</B> statement retrieves values stored by a <B>DlgStoreValues</B> instruction for controls in a custom dialog box.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="274pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>ValuesFile$</I></P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The name of the file in which the values are stored. <I>ValuesFile$ </I>can include a path. If a path is not included, Word looks for<I> ValuesFile$</I> in the Preferences folder. If <I>ValuesFile$</I> does not exist, empty strings and null values are passed to the dialog box but no error occurs.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Identifier$</I></P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A string that identifies the set of stored values (the same string is used when storing values with <B>DlgStoreValues</B>).</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The <B>DlgLoadValues</B><B>()</B> behaves the same as the statement, and also returns the following values:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="274pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Value</B></P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">0 (zero)</P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If either <I>ValuesFile$</I> or <I>Identifier$ </I>does not exist, or if any of the stored values cannot be loaded (this can occur if the dialog definition has changed since the values were last stored).</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">-1</P></FONT></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If the values were loaded successfully.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">In Windows, <B>DlgLoadValues</B> and <B>DlgLoadValues</B><B>()</B> are not available and generate errors.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This Macintosh macro shows how you can use <B>DlgStoreValues</B> and <B>DlgLoadValues</B> in a dialog function to save settings for a variety of dialog box controls. During initialization of the dialog box, the <B>DlgLoadValues</B> instruction runs; when the user chooses OK, the <B>DlgStoreValues</B> instruction runs. Note that the identifier for the first check box ends in 0 (zero), preventing Word from performing its default action of saving the check box setting. The first time the dialog box is displayed, the file containing the settings (DLGVALS) does not exist. The file is created the first time the <B>DlgStoreValues</B> instruction runs.</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN
Begin Dialog UserDialog 225, 167, "Test", .MyDlgFunction
    CheckBox 11, 48, 88, 19, "Test 1", .FirstBox0
    CheckBox 97, 48, 88, 19, "Test 2", .SecondBox
    OKButton 118, 124, 88, 21
    CancelButton 11, 124, 88, 21
    TextBox 11, 24, 197, 18, .TextBox1
    Text 11, 7, 46, 12, "Name:", .Text1
    GroupBox 11, 71, 197, 41, "Group Box"
    OptionGroup  .OptionGroup1
        OptionButton 17, 84, 89, 18, "Option A", .OptionA
        OptionButton 110, 84, 89, 18, "Option B", .OptionB
End Dialog
Dim dlg As UserDialog
DisableInput 1
button = Dialog(dlg)
DisableInput 0
End Sub

Function MyDlgFunction(identifier$, action, suppvalue)
Select Case action
    Case 1                'initialization
        DlgLoadValues "DLGVALS", "MyDlgFunction"
    Case 2                'button chosen or setting changed
        If identifier$ = "OK" Then
            DlgStoreValues "DLGVALS", "MyDlgFunction"
        End If
    Case Else
End Select
End Function
</PRE>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>DlgStoreValues</B></P>
<P></P></FONT></FONT></BODY></HTML>
