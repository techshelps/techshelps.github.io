<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CVErr Function</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H1><A NAME="sec27"></A>CVErr Function</H1><P CLASS="t">  </P>
<H2><A NAME="sec28"></A>Description</H2><P>Returns a <B>Variant</B> of subtype <B>Error</B> containing an error number specified by the user.</P>
<H2><A NAME="sec29"></A>Syntax</H2><P><B>CVErr(</B><I>errornumber</I><B>)</B></P>
<P>The <I>errornumber</I> argument is any valid error number.</P>
<H2><A NAME="sec30"></A>Remarks</H2><P>Use the <B>CVErr</B> function to create user-defined errors in user-created procedures. For example, if you create a function that accepts several arguments and normally returns a string, you can have your function evaluate the input arguments to ensure they are within acceptable range. If they are not, it is likely that your function will not return what you expect. In this event, <B>CVErr</B> allows you to return an error number that tells you what action to take.</P>
<P>Note that implicit conversion of an <B>Error</B> is not allowed. For example, you can’t directly assign the return value of <B>CVErr </B>to a non-<B>Variant</B> variable. However, you can perform an explicit conversion (using <B>CInt</B>, <B>CDbl</B>, and so on) of the value returned by <B>CVErr</B> and assign that to a variable of the appropriate data type.</P>
<H2><A NAME="sec31"></A>See Also</H2><P>Data Type Summary, <B>IsError</B> Function.</P>
<H2><A NAME="sec32"></A>Example</H2><P>This example uses the <B>CVErr</B> function to return a <B>Variant </B>whose <B>VarType </B>is <B>vbError</B> (10). The user-defined function CalculateDouble returns an error if the argument passed to it isn’t a number. You can use <B>CVErr</B> to return user-defined errors from user-defined procedures or to defer handling of a run-time error. Use the <B>IsError</B> function to test if the value represents an error.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>' Call CalculateDouble with an error-producing argument.Test()
    Debug.Print CalculateDouble("345.45robert")Sub
' Define CalculateDouble Function procedure.CalculateDouble(Number)
    If IsNumeric(Number) Then
        CalculateDouble = Number * 2          ' Return result.
    Else
        CalculateDouble = CVErr(2001)      ' Return a user-defined error
    End If                                  ' number.Function
</PRE>
<P CLASS="t">  </P>
<P CLASS="t"> </P>
</FONT></FONT></BODY></HTML>
