<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ON.DATA</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="DDE links, running macros through"><META NAME="MS-HKWD" CONTENT="macros, running through DDE links"><META NAME="MS-HKWD" CONTENT="ON.DATA function"><META NAME="MS-HKWD" CONTENT="Publish and Subscribe, running macros through"><META NAME="MS-HKWD" CONTENT="Publish, running macros through"><META NAME="MS-HKWD" CONTENT="Subscribe, running macros through"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    ON.DATA</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Runs a specified macro when another application sends data to a particular workbook via dynamic data exchange (DDE) or via Publish and Subscribe on the Macintosh. Workbook links to other applications are called remote references.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>ON.DATA</B>(document_text, macro_text)</P>
<P></P>
<P CLASS="nh"><B><B>Important</B>    Microsoft Excel for the Macintosh requires system software version 7.0 or later for this function.</B></P>
<P></P>
<P CLASS="t">Document_text    is the name of the sheet to which remote data will be sent or the name of the source of the remote data.</P>
<UL><LI>If document_text is the name of the remote data source, it must be in the form app|topic!item. You can use the form app|topic to include all items for a particular topic, or app| to specify an app alone, but you must include the | to indicate that you are specifying the name of a data source.</LI><LI>If document_text is omitted, the macro specified by macro_text is run whenever remote data is sent to any sheet not already assigned to another ON.DATA function.</LI><LI>In Microsoft Excel for the Macintosh, document_text can also be the name of a published edition file. Unless the file is in the current folder, document_text must include the complete path.</LI></UL><P></P>
<P CLASS="t">Macro_text    is the name of, or an R1C1-style reference to, a macro that you want to run when data comes into the workbook or from the source specified by document_text. The name or reference must be in text form.</P>
<UL><LI>If macro_text is omitted, the ON.DATA function is turned off for the specified workbook or source.</LI></UL><P></P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>ON.DATA remains in effect until you either clear it or quit Microsoft Excel. You can clear ON.DATA by specifying document_text and omitting the macro_text argument.</LI><LI>If the macro sheet containing macro_text is closed when data is sent to document_text, an error is returned.</LI><LI>If the incoming data causes recalculation, Microsoft Excel first runs the macro macro_text and then performs the recalculation.</LI></UL><P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">In Microsoft Excel for Windows, the following macro formula runs the macro AddOrders when data is sent to the sheet New in the workbook ORDERSDB.XLS:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.DATA("[ORDERSDB.XLS]New", "AddOrders")
</FONT></PRE>
<P CLASS="t">In Microsoft Excel for the Macintosh, the following macro formula runs the macro beginning at cell R2C3 when data is sent to the sheet North in the workbook SALES DATABASE:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.DATA("[SALES DATABASE]North", "R2C3")
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE754.HTM">ERROR</A>    Specifies what action to take if an error is encountered while a macro is running</P>
<P><A class="normal" href="SE87A.HTM">INITIATE</A>    Opens a channel to another application</P>
<P><A class="normal" href="SE87E.HTM">ON.ENTRY</A>    Runs a macro when data is entered</P>
<P><A class="normal" href="SE880.HTM">ON.RECALC</A>    Runs a macro when a workbook is recalculated</P>
<P>List of <A class="normal" href="SE744.HTM">Customizing Functions</A></P></FONT>
</FONT></BODY></HTML>
