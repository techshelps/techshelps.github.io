<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDE Function</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h1><a name="sec198"></a>DDE Function</h1>

<h2><a name="sec199"></a>Description</h2>

<p>You can use the <b>DDE</b> function to initiate a dynamic data
exchange (DDE) conversation with another application, request an
item of information from that application, and display that
information in a control on a form or report.</p>

<p>Use the <b>DDE</b> function in the <b>ControlSource</b>
property setting of a text box, option group, check box, or combo
box on a form.</p>

<p>For example, you can use the <b>DDE</b> function in the <b>ControlSource</b>
property of a text box to display data from a specified cell in a
Microsoft Excel spreadsheet.</p>

<h2><a name="sec200"></a>Syntax</h2>

<p><b>DDE(</b><i>application</i>, <i>topic</i>,<i> item</i><b>)</b></p>

<p>The <b>DDE</b> function syntax has the following arguments.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>application</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression identifying an
        application that can participate in a DDE conversation.
        Usually, <i>application</i> is the name of an .exe file
        (without the .exe extension) for a Microsoft
        Windows-based application. For example, to initiate a DDE
        conversation with Microsoft Excel, type <b>&#147;Excel&#148;</b>
        for the <i>application</i> argument.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>topic</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression that is the name of
        a topic recognized by <i>application</i>. <i>Topic </i>is
        often a document or data file. Check the other
        application&#146;s documentation for a list of possible
        topics.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>item</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression that is the name of
        a data item recognized by <i>application</i>. Check the
        other application&#146;s documentation for a list of
        possible items.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec201"></a>Remarks</h2>

<p>The <b>DDE</b> function attempts to initiate a DDE
conversation with the specified <i>application </i>and <i>topic</i>,
and requests the data in <i>item</i>. If successful, the <b>DDE</b>
function returns a string that contains the requested
information.</p>

<p>If you are requesting data from Microsoft Excel, <i>item</i>
might be a row-and-column identifier, such as &quot;R1C1&quot; or
the name of a range of cells. In the following example, the <b>DDE</b>
function requests information from the cell at row 1, column 1 in
a Microsoft Excel worksheet. You can enter this expression for a
text box control in the <b>ControlSource</b> property box on the
control&#146;s property sheet.</p>

<p class="spacing"><br>
</p>

<pre>= DDE(&quot;Excel&quot;, &quot;Sheet1&quot;, &quot;R1C1&quot;)
</pre>

<p>You can use the <b>DDE</b> function only in the <b>ControlSource</b>
property of a text box, option group, check box or combo box. You
cannot call the <b>DDE</b> function from Visual Basic.</p>

<p>When you use the <b>DDE</b> function, the control becomes
read-only in Form view and Print Preview. For example, if you use
the <b>DDE</b> function in a text box, the text in the text box
cannot be edited. You must edit the text in the other
application. Because the <b>ControlSource</b> property is
read-only in Form view and Print Preview, changes to the control
must be made in Design view.</p>

<p>The maximum number of DDE conversations that can be open
simultaneously is determined by Microsoft Windows and your
computer&#146;s memory and resources. If the conversation
can&#146;t be initiated because <i>application</i> isn&#146;t
running or doesn&#146;t recognize <i>topic</i>, or if the maximum
number of conversations has already been reached, <b>DDE</b>
returns a <b>Null</b>.</p>

<p><b>Note</b> The other application may be configured to ignore
your request for a DDE conversation. If so, <b>DDE</b> returns a <b>Null</b>.
Similarly, you can set Microsoft Access to ignore requests from
other applications: click Options on the Tools menu, and on the
Advanced tab of the Options dialog box, under DDE Operations,
select Ignore DDE Requests.</p>

<p><b>Note</b> If you need to manipulate another
application&#146;s objects from Microsoft Access, you may want to
consider using OLE Automation.</p>

<p>The following table illustrates how the <b>DDE</b> function
behaves when you use it with each of the controls.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Control</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Remarks</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Text box</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The <i>item</i> argument can refer to
        text or numbers. If <i>item</i> refers to more than one
        piece of information, such as a named range in a
        Microsoft Excel worksheet that contains multiple cells, <b>DDE</b>
        returns the first entry. You could use the <b>DDE</b>
        function with a text box to display the data contained in
        a cell on the worksheet.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Combo box</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The <b>DDE</b> function fills the combo
        box with the information referred to by <i>item</i>. You
        can&#146;t enter data in the text portion of the box. You
        might use the <b>DDE</b> function with a combo box to
        display a list of states or countries that you maintain
        in a Microsoft Excel worksheet.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Option group</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The <b>OptionValue</b> property of each
        option button in an option group is set to a number.
        Usually, the first button value is 1, the second is 2,
        and so on. The number returned by the <b>DDE</b> function
        determines which option button will be selected.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">For example, if <b>DDE</b> returns 2,
        the second button will be selected. If <b>DDE</b> returns
        a value that doesn&#146;t match any of the <b>OptionValue</b>
        property settings, none of the buttons will be selected.
        If <i>item</i> refers to more than one piece of
        information, such as a named range in a Microsoft Excel
        worksheet that contains multiple cells, <b>DDE</b>
        returns the first entry.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Check box</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">If the <b>DDE</b> function returns 0,
        the check box will be cleared. If <b>DDE</b> returns a
        nonzero number, such as 1 or -1, the box will be
        selected. If <i>item</i> refers to text or to more than
        one piece of information, such as a named range in a
        Microsoft Excel worksheet that contains multiple cells,
        the check box will be unavailable.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec202"></a>See Also</h2>

<p><b>DDEExecute </b>Statement; <b>DDEInitiate</b> Function; <b>DDEPoke</b>
Statement; <b>DDERequest</b> Function; <b>DDESend</b> Function; <b>DDETerminate</b>
Statement; <b>DDETerminateAll</b> Statement; <b>Enabled</b>, <b>Locked</b>
Properties.</p>

<h2><a name="sec203"></a>Example</h2>

<p>This example establishes a DDE link with Microsoft Excel,
places some values into cells in the first row of a new
worksheet, and charts the values. First, the <b>DDEInitiate</b>
function opens a channel to begin the DDE conversation. Then, the
<b>DDEExecute</b> statement sends Microsoft Excel the command to
open a new worksheet, and the <b>DDERequest</b> function asks
Microsoft Excel for the name of the newly created worksheet. A
new channel is opened, and the <b>DDEPoke</b> statement sends to
Microsoft Excel the data to be charted. Finally, the <b>DDETerminate</b>
statement terminates the DDE link with Microsoft Excel, and the <b>DDETerminateAll</b>
statement terminates all active DDE links.</p>

<p class="spacing"><br>
</p>

<pre>On Error Resume Next                            ' Set up error handler.Chan, SheetName, I, TopicList            ' Declare variables.= DDEInitiate(&quot;Excel&quot;, &quot;System&quot;)        ' Establish spreadsheet
                                            ' link.Err Then                                    ' If error occurs, 
                                            ' spreadsheet
    Err = 0                                    ' isn't running. Reset 
                                            ' error and start
    I = Shell(&quot;Excel&quot;, 1)                    ' spreadsheet.
    If Err Then Exit Sub                        ' If another error, exit.
    Chan = DDEInitiate(&quot;Excel&quot;, &quot;System&quot;)    ' Establish spreadsheet 
                                            ' link.IfChan, &quot;[New(1)]&quot;                    ' Create new worksheet.= DDERequest(Chan, &quot;Selection&quot;)    ' Get topic list, worksheet
                                            ' name.= Left(TopicList, InStr(1, TopicList, &quot;!&quot;) - 1)Chan                            ' Terminate DDE link.= DDEInitiate(&quot;Excel&quot;, SheetName)         ' Establish link with new
                                            ' worksheet.I = 1 To 10                                ' Put some values into
    DDEPoke Chan, &quot;R1C&quot; &amp; I, I                ' first row.IChan, &quot;[Select(&quot;&quot;R1C1:R1C10&quot;&quot;)][New(2,2)]&quot;    ' Make chart.                                ' Terminate all links.
</pre>
</FONT></FONT></BODY>
</html>
