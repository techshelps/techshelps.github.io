<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending Keystrokes</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>Sending Keystrokes</H1><P CLASS="t">When you're operating in the Microsoft Windows operating system, the only way to communicate with applications that don't support OLE, OLE Automation, or DDE is by sending keystrokes using the <B>SendKeys</B> method.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">You can send keystrokes only to a Windows-based application that's running. MS-DOS–based applications and Macintosh applications don't accept keystrokes.</P>
<P></P>
<P CLASS="t">The <B>SendKeys</B> method is processed when your system is idle or when the <B>DoEvents</B> method is called. If the wait argument of the <B>SendKeys</B> method is <B>True</B>, Microsoft Excel waits for the keys to be processed before it returns control to the procedure; if the wait argument is <B>False</B>, the procedure continues to run without waiting for the keys to be processed. The following example sends keystrokes to the Calculator that add the numbers from 1 to 10 and then close the Calculator.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub DemoSendKeys()
    returnvalue = Shell("calc.exe", 1)
    AppActivate returnvalue
    For i = 1 To 10
        SendKeys i &amp; "{+}", True
        Next i
        SendKeys "=", True
        SendKeys "%{F4}", True
End Sub
</FONT></PRE>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">Keystrokes are sent to the active application. If the active application isn't the one you want to send keystrokes to, you need to activate it using the <B>AppActivate</B> statement. If the application you want to send keystrokes to isn't already running, start it using the <B>Shell</B> function. If you don't specifically activate another application, your DDE procedure will send keystrokes to itself.</P>
<P></P>
<P CLASS="t">To specify characters that aren't displayed when you press the key (such as ENTER or TAB), enclose the key code in braces ({}), and enclose the braces in double straight quotation marks. To specify a key to be used in combination with SHIFT, CTRL, or ALT, precede the braces with "+", "^", or "%", respectively. The following example sends the key combination ALT+F4.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">SendKeys "%{F4}", True
</FONT></PRE>
<P CLASS="t">For a complete list of key codes, see "SendKeys method" in Help.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">You cannot send keystrokes that generate interrupts instead of character codes; for example, you cannot send ALT+CTRL+DEL or print scrEEn.</P>
<P></P>
<P CLASS="t"></P></FONT>
</FONT></BODY></HTML>
