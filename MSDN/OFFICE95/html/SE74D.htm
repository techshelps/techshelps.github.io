<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACTIVE.CELL</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="ACTIVE.CELL function"><META NAME="MS-HKWD" CONTENT="cell references, external"><META NAME="MS-HKWD" CONTENT="external references, active cells"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>   ACTIVE.CELL</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Returns the reference of the active cell in the selection as an external reference.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>ACTIVE.CELL</B>( )</P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>If an object is selected, ACTIVE.CELL returns the #N/A error value.</LI><LI>If a chart window is active, ACTIVE.CELL returns the #REF! error value.</LI><LI>If you use ACTIVE.CELL in a function or operation, you will usually get the value contained in the active cell instead of its reference, because the reference is automatically converted to the contents of the reference. See the third example following.</LI><LI>If you use ACTIVE.CELL in a function that requires a reference argument, then Microsoft Excel does not convert the reference to a value.</LI><LI>If you want to work with the actual reference, use the REFTEXT function to convert the active-cell reference to text, which you can then store or manipulate (or convert back to a reference with TEXTREF). See the second example following.</LI></UL><P></P>
<P CLASS="nh"><B><B>Tip</B>    Use the following macro formula to verify that the current selection is a cell or range of cells:</B></P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">=ISREF(ACTIVE.CELL( ))</FONT></PRE>
<P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">The following macro formula assigns the name Sales to the active cell:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">SET.NAME("Sales", ACTIVE.CELL())
</FONT></PRE>
<P CLASS="t">In this example, note that "Sales" refers to a cell on the active worksheet, but the name itself exists only in the macro sheet's list of names. In other words, the preceding formula does not define a name on the worksheet.</P>
<P CLASS="t">The following macro formula puts the reference of the active cell into the cell named Temp:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA("="&amp;REFTEXT(ACTIVE.CELL()), Temp)
</FONT></PRE>
<P CLASS="t">The following macro formula checks the contents of the active cell. If the cell contains only the letter "c" or "s", the macro branches to an area named FinishRefresh:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">IF(OR(ACTIVE.CELL()="c", ACTIVE.CELL()="s"), GOTO(FinishRefresh))
</FONT></PRE>
<P CLASS="t">In Microsoft Excel for Windows, if the document in the active window is named SALES and A1 is the active cell, then:</P>
<P CLASS="t">ACTIVE.CELL() equals SALES!$A$1</P>
<P CLASS="t">In Microsoft Excel for the Macintosh, if the document in the active window is named SALES 1 and A1 is the active cell, then:</P>
<P CLASS="t">ACTIVE.CELL() equals 'SALES 1'!$A$1</P>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE7FA.HTM">SELECT</A>    Selects a cell, worksheet object, or chart item</P>
<P>List of <A class="normal" href="SE748.HTM">Information Functions</A></P></FONT>
</FONT></BODY></HTML>
