<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IF</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="controlling macro formulas"><META NAME="MS-HKWD" CONTENT="IF function"><META NAME="MS-HKWD" CONTENT="macro formulas, controlling"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    IF</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Used with ELSE, ELSE.IF, and END.IF to control which formulas in a macro are executed. There are two syntax forms of the IF function. The following syntax can be used on macro sheets only; use it when you want your macro to branch to a particular set of functions based on the outcome of a logical test. The worksheet form of this function can be used on worksheets and macro sheets.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>IF</B>(<B>logical_test</B>)</P>
<P CLASS="t">Logical_test    is a logical value that IF uses to determine which functions to carry out next—that is, where to branch.</P>
<UL><LI>If logical_test is TRUE, Microsoft Excel carries out the functions between the IF function and the next ELSE, ELSE.IF, or END.IF function. Instructions between ELSE.IF or ELSE and END.IF are not carried out.</LI><LI>If logical_test is FALSE, Microsoft Excel immediately branches to the next ELSE.IF, ELSE, or END.IF function.</LI><LI>If logical_test produces an error, the macro halts.</LI></UL><P></P>
<P CLASS="nh"><B><B>Tips</B></B></P>
<UL><LI>Use IF with ELSE, ELSE.IF, and END.IF when you want to perform multiple actions based on a condition. This method is preferable to using GOTO because it makes your macros more structured.</LI><LI>If your macro ends with an error at a cell containing this form of the IF function, make sure there is a corresponding END.IF function.</LI></UL><P></P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">The following macro runs the macro CompleteEntry if the user chooses OK:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">IF(ALERT("Are you done with this entry?", 1), CompleteEntry(), )</FONT></PRE>
<P></P>
<P CLASS="nh"><B><B>Tip</B>    You can indent formulas in a macro. To indent a formula, type as many spaces as you want between the equal sign and the first letter of the formula.</B></P>
<P></P>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE7C7.HTM">ELSE</A>    Specifies an action to take if an IF function returns FALSE</P>
<P><A class="normal" href="SE7C8.HTM">ELSE.IF</A>    Specifies an action to take if an IF or another ELSE.IF function returns FALSE</P>
<P><A class="normal" href="SE7CB.HTM">END.IF</A>    Ends a group of macro functions started with an IF statement</P>
<P><A class="normal" href="SE754.HTM">ERROR</A>    Specifies what action to take if an error occurs while a macro is running</P>
<P>List of <A class="normal" href="SE743.HTM">Control Functions</A></P></FONT>
</FONT></BODY></HTML>
