<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPIDetails</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H3 CLASS="h2">MAPIDetails</H3><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>MAPIDetails(</B><I>Session</I><B>, </B><I>UIParam</I><B>, </B><I>Recipients</I><B>, </B><I>RecipIndex</I><B>, </B><I>Flags</I><B>, </B><I>Reserved</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Displays a dialog box that provides the details of a recipient in a recipient list. Use the <I>RecipIndex</I> argument to specify which recipient to display. Use <B>MAPIQueryRecipientListCount</B> to determine the number of recipients in<BR>a list.</P>
<P CLASS="t">The dialog box cannot be suppressed. The caller can make the entry either modifiable or fixed. The call works only for recipients that have been resolved either as the recipients of read mail, resolved entries returned by <B>MAPIAddress</B>, or entries returned by <B>MAPIResolveName</B>.</P>
<P CLASS="t">The folder the entry belongs to determines the amount of information presented in the details dialog box. It contains at least the friendly name and address of the recipient.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="80pt" VALIGN="TOP"><COL WIDTH="268pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Session</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">An opaque session handle whose value represents a session <BR>with the messaging system. Session handles are returned by <B>MAPILogon</B> and invalidated by <B>MAPILogoff</B>. If the value is<BR>0 (zero), the messaging system sets up a session from a system default session (if one exists) or presents a log-in dialog box. In<BR>all cases, the messaging system returns to its state before the call. </P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>UIParam</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The parent window handle for the dialog box. A value of 0 (zero) specifies that any dialog box displayed is application modal.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Recipients</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A handle to the recipient list containing the entry whose details<BR>are to be displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>RecipIndex</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The index of the recipient to display. Recipients are numbered from 0 (zero) to <B>MAPIQueryRecipientListCount</B> minus 1.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Flags</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A bitmask of flags. Unspecified flags should always be set to<BR>0 (zero). Undocumented flags are reserved. The following flags<BR>are defined:</P>
<P CLASS="ct">MAPI_LOGON_UI&nbsp;=&nbsp;1<BR>MAPI_NEW_SESSION&nbsp;=&nbsp;2<BR>MAPI_AB_NOMODIFY&nbsp;=&nbsp;1024</P>
<P CLASS="tt">Set MAPI_LOGON_UI if the function should display a log-in dialog box (if required). When this flag is not set, the function does not display a dialog box and returns an error if the user is not logged in.</P>
<P CLASS="tt">Set MAPI_NEW_SESSION if you want to establish a session other than the current one. For instance, if a mail client is already running, another MAPI e-mail client can piggyback on the session created by the mail client application. Do not set this flag if you want the default session (if it still exists). If the session passed in <I>Session</I> is not 0 (zero), this flag is ignored.</P>
<P CLASS="tt">Set MAPI_AB_NOMODIFY if the details of the entry should not be modifiable even if the entry belongs to the personal address book.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Reserved</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Reserved for future use. This argument must be 0 (zero).</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The following table lists the possible return values of the <B>MAPIDetails</B> function and their meanings.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="35pt" VALIGN="TOP"><COL WIDTH="165pt" VALIGN="TOP"><COL WIDTH="146pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Value</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Name</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Meaning</B></P></FONT></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–21</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_AMBIGUOUS_RECIPIENT</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The recipient is not a resolved recipient. No dialog box was displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–2</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_FAILURE</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">One or more unspecified errors occurred while matching the message type. The call failed before message type matching could take place.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–5</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_INSUFFICIENT_MEMORY</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">There was insufficient memory<BR>to proceed. No dialog box was displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–3</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_LOGIN_FAILURE</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">There was no default log-in,<BR>and the user failed to log in successfully when the log-in dialog box was displayed. No dialog box was displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–26</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_NOT_SUPPORTED</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The operation was not supported by the underlying messaging system.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_USER_ABORT</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The user canceled the process.<BR>No dialog box was displayed.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">0</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">SUCCESS_SUCCESS</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The function returned successfully.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">The following example displays a standard Mail Address Book dialog box, then the details for the last recipient selected by the user. The user cannot modify the details.</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN
MAPI_LOGON_UI&nbsp;=&nbsp;1
Session&nbsp;=&nbsp;MAPILogon(0, "", "", MAPI_LOGON_UI, 0)
RecipList&nbsp;=&nbsp;MAPIAddress(Session, 0, "Address Book", 4, "", 0, 0)
RecipCount&nbsp;=&nbsp;MAPIQueryRecipientListCount(RecipList)
MAPI_AB_NOMODIFY&nbsp;=&nbsp;1024
result&nbsp;=&nbsp;MAPIDetails(Session, 0, RecipList, RecipCount - 1,\<BR>    MAPI_AB_NOMODIFY, 0)
result&nbsp;=&nbsp;MAPILogoff(Session, 0, 0, 0)
End Sub
</PRE></FONT></FONT></BODY></HTML>
