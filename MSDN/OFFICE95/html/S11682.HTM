<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DoEvents Function</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H1><A NAME="sec121"></A>DoEvents Function</H1><P CLASS="t">  </P>
<H2><A NAME="sec122"></A>Description</H2><P>Yields execution so that the operating system can process other events.</P>
<H2><A NAME="sec123"></A>Syntax</H2><P><B>DoEvents(</B> <B>)</B></P>
<H2><A NAME="sec124"></A>Remarks</H2><P>The <B>DoEvents</B> function returns the number of open forms in standalone versions of Visual Basic, such as Visual Basic, Standard Edition. <B>DoEvents</B> returns 0 in all other applications. </P>
<P><B>DoEvents</B> passes control to the operating system. Control is not returned until the operating system has finished processing the events in its queue and, for Microsoft Windows only, all keys in the <B>SendKeys</B> queue have been sent.</P>
<P>If parts of your code take up a lot of processor time, use <B>DoEvents</B> periodically to relinquish control to the operating system so that events, such as keyboard input and mouse clicks, can be processed without significant delay.</P>
<P CLASS="t">  </P>
<P CLASS="t"></P>
<P><B>Caution</B>   Make sure the procedure that has given up control with <B>DoEvents</B> is not executed again from a different part of your code before the first <B>DoEvents</B> call returns; this could cause unpredictable results. In addition, do not use <B>DoEvents</B> if other applications could possibly interact with your procedure in unforeseen ways during the time you have yielded control.</P>
<P CLASS="t"></P>
<P CLASS="t">  </P>
<H2><A NAME="sec125"></A>See Also</H2><P><B>SendKeys</B> Statement.</P>
<H2><A NAME="sec126"></A>Specifics (Microsoft Access)</H2><P>In Microsoft Access, the <B>DoEvents</B> function is ignored if you use it in:</P>
<SPAN CLASS="list"><UL><LI><SPAN CLASS="Symbol"></SPAN>    A user-defined function or a procedure that calculates a field in a query, form, or report.</LI><LI><SPAN CLASS="Symbol"></SPAN>    A user-defined function that creates a list to fill a combo box, a list box, or an OLE object.</LI></UL></SPAN><P>If you include the <B>DoEvents</B> function in any of these, Microsoft Access will not relinquish control to the operating system.</P>
<H2><A NAME="sec127"></A>Example</H2><P>This example uses the <B>DoEvents</B> function to cause execution to yield to the operating system once every 1000 iterations of the loop. <B>DoEvents</B> returns the number of open Visual Basic forms, but only when the host application is Visual Basic.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>' Create a variable to hold number of Visual Basic forms loaded 
' and visible.OpenFormsI = 1 To 150000    ' Start loop.
    If I Mod 1000 = 0 Then     ' If loop has repeated 1000 times.
        OpenForms = DoEvents    ' Yield to operating system.
    End IfI        ' Increment loop counter.
</PRE>
<P CLASS="t">  </P>
<P CLASS="t"> </P>
</FONT></FONT></BODY></HTML>
