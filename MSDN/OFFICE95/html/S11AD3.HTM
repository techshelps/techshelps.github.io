<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Loc Function</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H1><A NAME="sec18"></A>Loc Function</H1><P CLASS="t">  </P>
<H2><A NAME="sec19"></A>Description</H2><P>Returns the current read/write position within an open file.</P>
<H2><A NAME="sec20"></A>Syntax</H2><P><B>Loc(</B><I>filenumber</I><B>)</B></P>
<P>The <I>filenumber</I><I> </I>argument is any valid file number.</P>
<H2><A NAME="sec21"></A>Remarks</H2><P>The following describes the return value for each file access mode:</P>
<P CLASS="t">  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="278pt" VALIGN="TOP"></COLGROUP><TBODY><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>File Access</B></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Return Value</B></P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Random</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Number of the last record read from or written to the file.</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Sequential</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Current byte position in the file divided by 128. (Note that information returned by <B>Loc</B> for sequential files is neither used nor required.)</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Binary</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Position of the last byte read or written.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H2><A NAME="sec22"></A>See Also</H2><P><B>EOF</B> Function, <B>LOF</B> Function.</P>
<H2><A NAME="sec23"></A>Example</H2><P>This example uses the <B>Loc</B> function to return the current read/write position within an open file. This example assumes that TESTFILE is a text file with a few lines of sample data.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>Open "TESTFILE" For Binary As #1            ' Open file just created.While MyLocation &lt; LOF(1)                ' Loop until end of file.
    MyLine = MyLine &amp; Input(1, #1)        ' Read character into variable.
    MyLocation = Loc(1)                    ' Get current position within 
                                        ' file.
    ' Print to Debug window.
    Debug.Print MyLine; Tab; MyLocation#1                                    ' Close file.
</PRE>
<P CLASS="t">  </P>
<P CLASS="t"> </P>
</FONT></FONT></BODY></HTML>
