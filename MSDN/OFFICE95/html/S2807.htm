<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Bulletproofing</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H2 CLASS="h1">Bulletproofing</H2><P CLASS="t">Many macros are fragile initially: Everything must be just so, or they won't run properly. Fragile macros are fine if you're the only one who uses them. But if you're writing a macro others might use, you have to consider all the conditions in which someone might run it. <I>Bulletproofing</I> is the process of making a macro less dependent on a particular set of conditions. </P>
<P CLASS="t">The following is a checklist of questions to consider.</P>
<H3 CLASS="h6"><A NAME="sec0"></A>Where is the insertion point or selection when the macro begins?</H3><P CLASS="h">A macro that uses editing statements may not work correctly if the insertion point or selection is in a table or a frame. If the insertion point or selection is in a macro-editing window or a header, footer, footnote, or annotation pane, a macro may not run because many commands are not available. You can use the <B>SelInfo</B><B>()</B> function to determine whether the insertion point or selection is in a macro-editing window or a pane.</P>
<H3 CLASS="h6"><A NAME="sec1"></A>Is there a selection?</H3><P CLASS="h">Often, macros that are designed to help with editing assume that text is either selected or not selected. A bulletproofed macro would use the <B>SelType</B><B>()</B> function to test that assumption and quit if the selection were inappropriate.</P>
<H3 CLASS="h6"><A NAME="sec2"></A>Which view is the document in?</H3><P CLASS="h">A macro that runs properly in normal view may not work in outline view or page layout view.</P>
<P CLASS="t"></P>
<H3 CLASS="h6"><A NAME="sec3"></A>Is a window open?</H3><P CLASS="h">Most Word commands are unavailable when no document window is open.</P>
<H3 CLASS="h6"><A NAME="sec4"></A>What are the current Word settings?</H3><P CLASS="h">The settings in the Options dialog box (Tools menu) can often determine whether a macro runs properly. For example, a macro that pastes text onto or types over a selection depends on whether the Typing Replaces Selection check box on the Edit tab is selected. If a macro searches for or edits hidden text, hidden text must be visible; however, if a macro repaginates (or compiles an index or table of contents), page numbering may be thrown off if hidden text is visible. Use the WordBasic statements that control the Options dialog box to ensure the current settings are appropriate for your macro.</P>
<H3 CLASS="h6"><A NAME="sec5"></A>Could the macro trigger an auto macro?</H3><P CLASS="h">If the macro performs any of the actions that can trigger an auto macro (such as opening an existing document or creating a new one), it may be disrupted or perform unnecessary actions. You can disable auto macros using the <B>DisableAutoMacros</B> statement.</P>
<H3 CLASS="h6"><A NAME="sec6"></A>What if the user interrupts the macro?</H3><P CLASS="h">Usually, it's convenient to be able to cancel a macro by pressing the Esc key. But if a macro is carrying out a critical operation, canceling it could create problems. You can use the <B>DisableInput</B> statement to prevent the user from canceling a macro.</P>
<P></P>

<TABLE COLS="1" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="348pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="sbrh"><B>Bulletproofing and Speed</B></P>
<P CLASS="sbrt">Every bulletproofing precaution slows your macro down. For long, complex macros, the added robustness is well worth a slight delay at the start. For short, quick macros, however, speed may be critical — if they take too long, they're not worth using. Use your judgment as to what level of bulletproofing is appropriate for a given macro.</P>
<P CLASS="sbrh"><B></B></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P></FONT></FONT></BODY></HTML>
