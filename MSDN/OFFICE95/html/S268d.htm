<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLGetSchema</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H3 CLASS="h2">SQLGetSchema</H3><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SQLGetSchema(</B><I>ConnectNum</I><B>, </B><I>Type</I><B>, </B><I>Qualifier$</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Establishes a pseudo-query on a data source connection to provide information about the schema (structure) of the data source. After <B>SQLGetSchema</B> establishes a pseudo-query and returns a value describing the available information, use <B>SQLGetSchemaItem$</B> one or more times to return the available string or strings of information about the data source structure. <B>SQLGetSchema</B> works with the ODBC API functions SQLGetInfo and SQLTables to find the requested information; for complete information about these API functions, see the <I>Microsoft ODBC Programmer's Reference</I> in the Microsoft ODBC Software Development Kit version 2.10.</P>
<P CLASS="t">For a complete example macro using <B>SQLGetSchema</B>, see the third example macro described in "Using the ODBC Extensions" earlier in this appendix.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Arguments</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>ConnectNum</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The unique connection ID of the data source you want information about,<I> </I>returned by a previously executed <B>SQLOpen</B> function. If <I>ConnectNum </I>is not valid, <B>SQLGetSchema</B> returns 0 (zero).</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Type</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A value between 1 and 14 that specifies the type of information<BR>you want returned. For descriptions of the information that can be returned, see the table of return values, following.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Qualifier$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A text string used to qualify the search for the requested information. This string should be enclosed by quotation marks. Note that <I>Qualifier$</I> is only included for <I>Type</I> values of 3, 4, and 5. For other <I>Type</I> values, <I>Qualifier$</I> should be an empty string ("").</P>
<P CLASS="tt">If <I>Type</I> is 3, <I>Qualifier$</I> should be the name of a database in the current data source. <B>SQLGetSchema</B> will then only return the number of table owners in that database. If you specify an empty string (""), the function will return the number of all owners of all databases on <I>ConnectNum</I>.</P>
<P CLASS="tt">If <I>Type</I> is 4, <I>Qualifier$</I> should be both a database name and an owner name. The syntax of <I>Qualifier$</I> is "<I>Database</I><B>.</B><I>Owner</I>". <B>SQLGetSchema</B> will then return the number of tables that are located in the given database and owned by the given owner. If you specify an empty string (""), the function will return the number of all table names in all databases owned by all owners on <I>ConnectNum</I>.</P>
<P CLASS="tt">If <I>Type</I> is 5, <I>Qualifier$</I> should be the name of a table. Information about the columns in that table will be returned.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The numeric value returned by the <B>SQLGetSchema</B> function depends on the value of the <I>Type</I> argument that was passed, as described in the following table. Use <B>SQLGetSchemaItem$</B> one or more times to return the available string or strings, as indicated by the numeric return value of <B>SQLGetSchema</B>.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B><I>Type</I></B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Meaning of return value</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Number of available data sources. </P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">2</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Number of databases on the current connection.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">3</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Number of owners in a database on the current connection. This <I>Type</I> requires that a value be specified for <I>Qualifier$.</I></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">4</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Number of tables for a given owner and database on the current connection. This <I>Type</I> requires that a value be specified for <I>Qualifier$.</I></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">5</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Number describing a two-dimensional array listing the columns in<BR>a particular table and their data types. The return value is the total number of string values available. The odd-numbered items are the names of the columns. The even-numbered items are the data types of the columns. This <I>Type</I> requires that a value be specified for <I>Qualifier$.</I></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">6</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the user ID of the current user is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">7</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the name of the current database is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">8</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the name of the data source as given in the ODBC.INI file (Windows 3.<I>x</I>) or the registry (Windows 95 and Windows NT) is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">9</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the name of the data source DBMS (i.e. Oracle, SQL Server, etc.) is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">10</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the name of the server name for the data source is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">11</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the terminology used by the data source to refer to owners ( i.e. "owner", "Authorization ID", "Schema", etc.) is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">12</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the terminology used by the data source to refer to tables ( i.e. "table", "file", etc.) is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">13</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the terminology used by the data source to refer to qualifiers (i.e. "database" or "directory") is available.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">14</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If a non-error value, the terminology used by the data source to refer to procedures (i.e. "database procedure", "stored procedure", or "procedure") is available.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">The <B>SQLGetSchema</B> function should not overwrite the pending results of another query sent to the same data source. To avoid overwriting pending query results, establish a new connection to the data source using <B>SQLOpen,</B> and specify the resulting connection ID for <B>SQLGetSchema</B>.</P>
<P></P></FONT></FONT></BODY></HTML>
