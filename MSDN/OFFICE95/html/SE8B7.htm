<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UNREGISTER</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="code resources, unregistering"><META NAME="MS-HKWD" CONTENT="DLLs, unregistering"><META NAME="MS-HKWD" CONTENT="freeing memory"><META NAME="MS-HKWD" CONTENT="memory, freeing"><META NAME="MS-HKWD" CONTENT="UNREGISTER function"><META NAME="MS-HKWD" CONTENT="unregistering DLLs"><META NAME="MS-HKWD" CONTENT="unregistering, code resources"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    UNREGISTER</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Unregisters a previously registered dynamic link library (DLL) or code resource. You can use UNREGISTER to free memory that was allocated to a DLL or code resource when it was registered. There are two syntax forms of this function. Use syntax 1 when you want Microsoft Excel to unregister a function or code resource according to its use count. Use syntax 2 when you want Microsoft Excel to unregister a function or code resource regardless of the use count.</P>
<P CLASS="h"><B>Syntax 1</B></P>
<P CLASS="syn"><B>UNREGISTER</B>(<B>register_id</B>)</P>
<P CLASS="t">Register_id    is the register ID returned by the REGISTER or REGISTER.ID function, which corresponds to the function or code resource to be removed from memory.</P>
<P CLASS="t">Microsoft Excel counts the number of times you register a function or code resource. This number is called the use count. Each time you unregister a function or code resource, its use count is decremented by 1. When the use count equals 0, Microsoft Excel frees the allocated memory. Therefore, if you register a function or code resource more than once, you must use a corresponding number of UNREGISTER functions to ensure that it is completely unregistered.</P>
<P></P>
<P CLASS="nh"><B><B>Note</B>    Because Microsoft Excel for Windows and Microsoft Excel for the Macintosh use different types of code resources, UNREGISTER has a slightly different syntax form when used in each operating environment.</B></P>
<P></P>
<P CLASS="h"><B>Syntax 2a</B></P>
<P CLASS="t">For Microsoft Excel for Windows</P>
<P CLASS="syn"><B>UNREGISTER</B>(<B>module_text</B>)</P>
<P CLASS="h"><B>Syntax 2b</B></P>
<P CLASS="t">For Microsoft Excel for the Macintosh</P>
<P CLASS="syn"><B>UNREGISTER</B>(<B>file_text</B>)</P>
<P CLASS="t">Module_text or file_text    is text specifying the name of the dynamic link library (DLL) that contains the function (in Microsoft Excel for Windows) or the name of the file that contains the code resource (in Microsoft Excel for the Macintosh).</P>
<P CLASS="t">If you use this syntax of UNREGISTER, all functions in the DLL (or all code resources in the file) are immediately unregistered, regardless of the use count.</P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">Assuming that a REGISTER function in cell A5 of a macro sheet has already run (and has run only once), the following macro formula unregisters the corresponding function or code resource:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">UNREGISTER(A5)
</FONT></PRE>
<P CLASS="t">You could also use REGISTER.ID to return the register ID, instead of specifying a cell reference:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">UNREGISTER(REGISTER.ID("User", "GetTickCount")
</FONT></PRE>
<P CLASS="t">Assuming that you have registered several different functions from the USER.EXE DLL of Microsoft Windows, the following macro formula unregisters all functions in that DLL:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">UNREGISTER("User")</FONT></PRE>
<P></P>
<P CLASS="nh"><B>Tip    If you register a function or code resource, and use the optional function_text argument to specify a custom name that will appear in the Paste Function dialog box, this custom name will not be removed by the UNREGISTER function. To remove the custom name, use the SET.NAME function without its second argument</B></P>
<P></P>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE88A.HTM">REGISTER</A>    Registers a code resource</P>
<P>List of <A class="normal" href="SE746.HTM">DDE/External Functions</A></P></FONT>
</FONT></BODY></HTML>
