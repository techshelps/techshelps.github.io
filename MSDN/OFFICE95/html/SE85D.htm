<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SELECTION</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="current selection, returning information on"><META NAME="MS-HKWD" CONTENT="SELECTION function,"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    SELECTION</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Returns the reference or object identifier of the selection as an external reference. Use SELECTION to return information about the current selection for use in other macro formulas.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SELECTION</B>( )</P>
<P CLASS="t">If a cell or range of cells is selected, Microsoft Excel returns the corresponding external reference. If an object is selected, Microsoft Excel returns the object identifier listed in the following table.</P>
<P>Item selected    Identifier returned</P>
<P CLASS="tr">    </P>
<P>Imported graphic    Picture n</P>
<P>Linked graphic    Picture n</P>
<P>Chart picture    Picture n</P>
<P>Linked chart    Chart n</P>
<P>Range    Picture n</P>
<P>Linked range    Picture n</P>
<P>Text box    Text n</P>
<P>Button    Button n</P>
<P>Rectangle    Rectangle n</P>
<P>Oval    Oval n</P>
<P>Line    Line n</P>
<P>Arc    Arc n</P>
<P>Group    Group n</P>
<P>Freehand drawing or polygon    Drawing n</P>
<P CLASS="t"></P>
<P CLASS="t">SELECTION also returns the identifiers of chart items. The identifiers returned are the same as the identifiers you specify when you use the SELECT function. For a list of these identifiers, see the description of item_text in SELECT.</P>
<P CLASS="t">If you select cells and use the value returned by SELECTION in a function or operation, you usually get the value contained in the selection instead of its reference. References are automatically converted to the contents of the reference. If you want to work with the actual reference, use SET.NAME to assign a name to it, even if the reference refers to objects. See the last example following. You can also use the REFTEXT function to convert the reference to text, which you can then store or manipulate.</P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>If an object is selected, SELECTION returns the identifier of the object. If multiple objects are selected, it returns the identifiers of all the selected objects, as a string separated by commas.</LI><LI>If more than 1024 characters would be returned, SELECTION returns the #VALUE! error value.</LI></UL><P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">If the sheet in the active window is named SHEET1 in the workbook BOOK1, and if A1:A3 is the selection, then:</P>
<P CLASS="t">SELECTION() equals [BOOK1]SHEET1!A1:A3</P>
<P CLASS="t">The following macro formula moves the current selection one row down:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">SELECT(OFFSET(SELECTION(), 1, 0))
</FONT></PRE>
<P CLASS="t">The above formula is particularly useful for moving incrementally through a database to add or modify records.</P>
<P CLASS="t">The following macro formula defines the name "EntryRange" on the active sheet to refer to one row below the current selection on the active sheet:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">DEFINE.NAME("EntryRange", OFFSET(SELECTION(), 1, 0))
</FONT></PRE>
<P CLASS="t">The following macro formula defines the name "Objects" on your macro sheet to refer to the object names in the current multiple selection:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">SET.NAME("Objects", SELECTION())
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE74D.HTM">ACTIVE.CELL</A>    Returns the reference of the active cell</P>
<P><A class="normal" href="SE7FA.HTM">SELECT</A>    Selects a cell, graphic object, or chart</P>
<P>List of <A class="normal" href="SE748.HTM">Information Functions</A></P></FONT>
</FONT></BODY></HTML>
