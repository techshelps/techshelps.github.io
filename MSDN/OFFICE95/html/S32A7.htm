<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OnTime</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">OnTime</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>OnTime</B> <I>When</I>[<I>$</I>]<B>,</B><I> Name$ </I>[<B>,&nbsp;</B><I>Tolerance</I>]</P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Sets up a background timer that runs a macro at the time specified by <I>When</I>[<I>$</I>]<I>.</I> If Word is occupied at the specified time — for example, if a dialog box is displayed or Word is performing a large sort operation — the macro runs as soon as Word is idle.</P>
<P CLASS="t">If you close Word before <I>When</I>[<I>$</I>], the timer is canceled and is not reactivated when you start Word. To reset the timer each time you start Word — for example, if you want to automatically set an alarm macro at your next Word session (see the example in this entry) — name the macro that includes the <B>OnTime</B> instruction "AutoExec." For information about AutoExec and other auto macros, see<BR>Chapter 2, "Getting Started with Macros," in Part 1, "Learning WordBasic."</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="274pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>When</I>[<I>$</I>]</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The time the macro is to be run, expressed as text in a 24-hour format (<I>hours</I><B>:</B><I>minutes</I><B>:</B><I>seconds</I>) or as a serial number, a decimal representation of the date, time, or both<I>.</I> For more information on serial numbers, see <B>DateSerial</B><B>()</B>.</P>
<P CLASS="tt">When you specify the time as text, including <I>seconds </I>is optional. For example, 2:37 p.m. is expressed as "14:37" and 2:37 a.m. is expressed as "02:37" or "2:37." Midnight is "00:00:00."</P>
<P CLASS="tt">You can include a string representing the date before the time. There are several available date formats. You can control the default date format by choosing the International option in Control Panel (Windows) or by using a control panel such as Date &amp; Time (Macintosh). If the date is not specified, the macro runs at the first occurrence of the specified time.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Name$ </I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The name of the macro to be run. For the macro to run, it must be available both when the <B>OnTime</B> instruction is run and when the specified time has arrived. For this reason, it is best to specify a macro in the global template, NORMAL.DOT. The format <I>MacroName</I><B>.</B><I>SubroutineName</I> is not allowed.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Tolerance</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">If <I>Name$</I> has not yet started within <I>Tolerance </I>seconds after <I>When</I>,<I> </I>Word will not run the macro. If <I>Tolerance</I> is 0 (zero) or omitted, Word always runs the macro, regardless of how many seconds elapse before Word is idle and can run the macro.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">Word can run only one <B>OnTime</B> macro at a time. If you start a second, the first <B>OnTime</B> macro is canceled.</P>
<P></P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example sets up a simple alarm clock function in Word. The first macro in the example sets up the background timer.</P>
<P CLASS="spacing"><BR></P>
<PRE>'Alarm program: Prompts user to input time for alarm to sound
'Current time appears in title bar of input box
Sub MAIN
Alarm$&nbsp;=&nbsp;InputBox$("Time? (HH:mm:ss), 24hr", "Alarm " + Time$())
'Set background timer to run macro called Beeper
'No tolerance is set, so alarm will always sound
OnTime Alarm$, "Beeper" 
End Sub
</PRE>
<P CLASS="t">The following macro sounds an alarm and displays an alert message in response to the timer set up by the preceding macro. This macro must be named "Beeper" to work properly with the preceding macro.</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN                        'Beeper program
For count&nbsp;=&nbsp;1 To 7
    Beep
    Beep
    For TL&nbsp;=&nbsp;1 To 100        'Adds a delay between beeps
    Next
Next
MsgBox "Preset alarm sounded", "Beeper " + Time$(), 48
End Sub
</PRE>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>Date$</B><B>()</B>,<B> DateSerial</B><B>()</B>,<B> DateValue</B><B>()</B>,<B> Day</B><B>()</B>,<B> Month</B><B>()</B>,<B> Now</B><B>()</B>,<B> TimeValue</B><B>()</B>,<B> Today</B><B>()</B>,<B> Year</B><B>()</B></P></FONT></FONT></BODY></HTML>
