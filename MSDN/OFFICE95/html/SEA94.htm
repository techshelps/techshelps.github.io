<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OnSheetActivate and OnSheetDeactivate Properties</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>OnSheetActivate and OnSheetDeactivate Properties</H2><P CLASS="t">An OnSheetActivate event handler runs whenever the user switches to a sheet in an open workbook. Set the <B>OnSheetActivate</B> property for the <B>Application</B> object to run a procedure whenever the user switches to any sheet in the application. Set the <B>OnSheetActivate</B> property for a <B>Workbook</B> to run a procedure whenever the user switches to any sheet in a specific workbook. Set the <B>OnSheetActivate</B> property for a <B>Chart</B>, <B>DialogSheet</B>, <B>Module</B>, or <B>Worksheet</B> object to run a procedure whenever the user switches to a specific sheet in a workbook.</P>
<P CLASS="t">You can use <B>OnSheetActivate</B> to ensure that a toolbar that belongs to the workbook is displayed whenever the user switches to that workbook. For example, the following Auto_Open procedure in a workbook initiates trapping for the OnSheetActivate event for the workbook and runs a procedure that displays an Engineering Analysis toolbar whenever the user switches to the workbook.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub Auto_Open()
    ThisWorkbook.OnSheetActivate = "WBActivateHandler"
End Sub

Sub WBActivateHandler()
    If ActiveSheet.Name = "My_Data" Then
        Toolbars("EngAnalysisToolbar").Visible = True
    Else
        Toolbars("EngAnalysisToolbar").Visible = False
    End If
End Sub
</FONT></PRE>
<P CLASS="t">Another use for an OnSheetActivate procedure is to display a custom menu bar whenever the user switches to a sheet of a certain type. For example, if the user switches to a chart sheet, the built-in chart menu bar is displayed automatically. If you create a custom chart menu bar, Microsoft Excel doesn't display it unless you create a procedure that runs whenever the user switches to a chart sheet.</P>
<P CLASS="t">Similarly, an OnSheetDeactivate procedure runs whenever the user switches away from a sheet or workbook. OnSheetDeactivate procedures are useful for resetting a customized user interface — for example returning menu bars, toolbars, and view settings to their original states.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">The OnSheetActivate and OnSheetDeactivate event handlers don't run when you activate a sheet under program control.</P>
<P CLASS="nt">When you activate a workbook, the workbook becomes active before the OnSheetDeactivate procedure in the previous workbook runs. Therefore, using the <B>ActiveSheet</B> or <B>ActiveWorkbook</B> property in the OnSheetDeactivate handler may produce unpredictable results.</P>
<P></P></FONT>
</FONT></BODY></HTML>
