<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OnCalculate Property</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>OnCalculate Property</H2><P CLASS="t">An OnCalculate event handler runs immediately after a worksheet is recalculated. Use the <B>OnCalculate</B> property of the <B>Worksheet</B> object to associate a procedure with the recalculation of a single, specified worksheet. Use the <B>OnCalculate</B> property of the <B>Application</B> object to associate a procedure with the recalculation of any open worksheet.</P>
<P CLASS="t">For example, you might use an OnCalculate handler to update column widths when new data is recalculated, as shown in the following example.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub TrapCalculate()
    Application.OnCalculate = "FitColumns"
End Sub

Sub FitColumns()
    Columns("A:H").EntireColumn.AutoFit
End Sub
</FONT></PRE>
<P CLASS="t">If you've assigned a procedure to the <B>OnCalculate</B> property of the <B>Application</B> object, the procedure runs for any recalculated worksheet that doesn't have its own OnCalculate handler.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">The OnCalculate event handler doesn't run if you recalculate under program control. For example, the statement Application.Calculate recalculates all open workbooks, but it doesn't cause the OnCalculate event handler to run.</P>
<P></P></FONT>
</FONT></BODY></HTML>
