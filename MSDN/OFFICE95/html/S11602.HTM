<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Delete, BeforeDelConfirm, AfterDelConfirm Events -- Event Procedures</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h1><a name="sec308"></a>Delete, BeforeDelConfirm,
AfterDelConfirm Events -- Event Procedures</h1>

<h2><a name="sec309"></a>Description</h2>

<p>To create an event procedure that is run when a Delete,
BeforeDelConfirm, or AfterDelConfirm event occurs, set the <b>OnDelete</b>,
<b>BeforeDelConfirm</b>, or <b>AfterDelConfirm</b> property to
[Event Procedure], and click the Build button.</p>

<h2><a name="sec310"></a>Syntax</h2>

<p><b>Private Sub Form_Delete (</b>Cancel <b>As Integer)</b></p>

<p><b>Private Sub Form_BeforeDelConfirm (</b>Cancel <b>As Integer</b>,
Response <b>As)</b></p>

<p><b>Private Sub Form_AfterDelConfirm (</b>Status <b>As Integer)</b></p>

<p>The Delete event procedure uses the following argument.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Cancel </td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The setting determines if the Delete
        event occurs. Setting Cancel to <b>True</b> (-1) cancels
        the Delete event.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<p>The BeforeDelConfirm event procedure uses the following
arguments.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Cancel</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The setting determines if the
        BeforeDelConfirm event occurs. Setting Cancel to <b>True</b>
        (-1) cancels the BeforeDelConfirm event and prevents the
        delete confirm dialog box from being displayed. If the
        event is canceled, the original records are restored, but
        the AfterDelConfirm event still occurs. If Cancel is set
        to <b>True</b> (-1), the Response argument is ignored.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Setting Cancel is set to <b>False</b>
        (0), does not cancel the BeforeDelConfirm event and the
        value in the Response argument is used by Microsoft
        Access to determine the type of response to the delete
        event.</td>
    </tr>
    <tr>
        <td>Response</td>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
        <td>An intrinsic constant that determines whether
        Microsoft Access displays a dialog box asking if the
        record should be deleted. The Response argument can have
        the following constants.</td>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
    </tr>
</table>

<p class="spacing"><br>
</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acDataErrContinue</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Enables Microsoft Access to delete
        records without prompting the user.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acDataErrDisplay</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Displays the default message</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<p>The AfterDelConfirm event procedure uses the following
argument.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Status</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An intrinsic constant that determines
        whether a record has been deleted. The Status argument
        can be any the following constants: </td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acDeleteOK</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Indicates the deletion was successful.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acDeleteCancel</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Indicates the deletion was canceled in
        Visual Basic.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acDeleteUserCancel</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Indicates the deletion was canceled by
        the user.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec311"></a>Remarks</h2>

<p>The AfterDelConfirm event can&#146;t be canceled.</p>

<p>You can use these events to customize how records are deleted.
For example, when a user deletes a record, such as an employee
record, the Delete event occurs. You can place code in the Delete
event procedure to save the data from the Employee ID and Name
fields in a temporary buffer. When the BeforeDelConfirm event
occurs, you can prevent the delete confirm dialog box from being
displayed by setting the Response argument to <b>acDataErrContinue</b>.
This enables you to display a custom dialog box. When the
AfterDelConfirm event occurs and the Status<b> </b>argument is
set to <b>acDeleteOK</b>, you can do the actual delete in the
table and clear the record from the temporary buffer.</p>

<h2><a name="sec312"></a>See Also</h2>

<p>Delete, BeforeDelConfirm, AfterDelConfirm Events &#151;
Macros.</p>

<h2><a name="sec313"></a>Examples</h2>

<p>This example shows how you can prevent a user from deleting
records from a table.</p>

<p>To try this example, add the following code to the
Declarations section of a form that is based on an Employees
table. Switch to the form&#146;s Datasheet view and try to delete
a record.</p>

<p class="spacing"><br>
</p>

<pre>Private Sub Form_Delete (Cancel As Integer)
    Cancel = True
    MsgBox &quot;This record can't be deleted.&quot;Sub
</pre>

<p>The following example shows how you can use the
BeforeDelConfirm event procedure to suppress the default
confirmation dialog box and display a custom dialog box when a
record is deleted. It also shows how you can use the
AfterDelConfirm event procedure to display a message indicating
whether the deletion progressed in the usual way or whether it
was canceled in Visual Basic or by the user.</p>

<p>To try this example, add the following code to the
Declarations section of a form that is based on a table or query.</p>

<p class="spacing"><br>
</p>

<pre>Private Sub Form_BeforeDelConfirm (Cancel As Integer, _
        Response As Integer)
    ' Suppress default delete confirm dialog box.
    Response = acDataErrContinue
    ' Display custom dialog box.
    If MsgBox (&quot;Delete this record?&quot;, vbOKCancel) = vbCancel Then
        Cancel = True
    End IfSub
Sub Form_AfterDelConfirm (Status As Integer)
    Select Case Status
        Case acDeleteOK
            MsgBox &quot;Deletion occurred normally.&quot;
        Case acDeleteCancel
            MsgBox &quot;Programmer canceled the deletion.&quot;
        Case acDeleteUserCancel
            MsgBox &quot;User canceled the deletion.&quot;
    End SelectSub
</pre>
</FONT></FONT></BODY>
</html>
