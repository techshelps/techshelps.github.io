<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Nesting Control Structures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>Nesting Control Structures</H1><P CLASS="t">As the preceding example demonstrates, you can place control structures inside other control structures (for instance, an <B>If...Then</B> block within a <B>For Each...Next</B> loop within another <B>If...Then</B> block, and so on). A control structure placed inside another control structure is said to be <I>nested</I>.</P>
<P CLASS="t">The following example searches the range of cells you specify with an argument and counts the number of cells matching the value you specify.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Function CountValues(rangeToSearch, searchValue)
    If TypeName(rangeToSearch) &lt;&gt; "Range" Then
        MsgBox "You can search only a range of cells."
    Else
        For Each c in rangeToSearch.cells
            If c.Value = searchValue Then
                counter = counter + 1
            End If
        Next c
    End If
    CountValues = counter
End Function
</FONT></PRE>
<P CLASS="t">Notice that the first <B>End If</B> statement closes the inner <B>If...Then</B> block and that the last <B>End If</B> statement closes the outer <B>If...Then</B> block. Likewise, in nested <B>For...Next </B>and<B> For Each...Next</B> loops, the <B>Next </B>statements automatically apply to the nearest prior <B>For </B>or<B> For Each</B> statement. Nested <B>Do...Loop</B> structures work in a similar fashion, with the innermost <B>Loop</B> statement matching the innermost <B>Do</B> statement.</P></FONT>
</FONT></BODY></HTML>
