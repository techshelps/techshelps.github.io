<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Checking for Error Values</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Checking for Error Values</H2><P CLASS="t">Each error value you create must be associated with a specific error. After you've done this you can use the <B>IsError</B> function to test whether a particular error has occurred. You can test for specific user-defined error values the same way you test for specific built-in errors, using the <B>Select Case </B>statement or the <B>If...Then...Else</B> statement.</P>
<P CLASS="t">The following example uses the <B>CVErr</B> function to return an error value. The AreaOfCircle procedure asks for a radius value. The CheckData function checks the Radius variable and, if it isn't an acceptable number, converts it into one of two possible error values. In the AreaOfCircle procedure, the <B>IsError</B> function returns <B>True</B> if its argument is an error value. </P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Public NoRadius, NotANumber

Sub AreaOfCircle()
    Const PI = 3.14
    NoRadius = CVErr(50000)
    NotANumber = CVErr(50001)
    Radius = CheckData(InputBox("Enter the radius"))
    If IsError(Radius) Then
        Select Case Radius
            Case NoRadius
                MsgBox "Error: No radius given."
            Case NotANumber
                MsgBox "Error: Radius isn't a number."
            Case Else
                MsgBox "Unknown error."
        End Select
    Else        ' there's no error
        MsgBox "The area of the circle is " &amp; (PI * Radius ^ 2)
    End If
End Sub
Function CheckData(TheRadius)
    If Not IsNumeric(TheRadius) Then
        CheckData = NotANumber
    ElseIf TheRadius = 0 Then
        CheckData = NoRadius
    Else
        CheckData = TheRadius
    End If
End Function
</FONT></PRE>
<P CLASS="t">It's important to remember that if Visual Basic attempts to compare an error value with a number or other value in an expression, a run-time error will occur.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">If NoRadius = 50000 Then...    'Causes an error. Cannot compare error to a                             'number or other value.
</FONT></PRE>
<P CLASS="t">The following code doesn't cause an error because you can compare an error value with another error value.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">If NoRadius = CVErr(50000) Then...
</FONT></PRE>
<P CLASS="t">For more information about <B>IsError</B> or <B>CVErr</B>, see the appropriate topic in Help<I>.</I></P></FONT>
</FONT></BODY></HTML>
