<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Editing a Macro</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H2 CLASS="h1">Editing a Macro</H2><P CLASS="t">You can edit an existing macro or write a new macro from scratch using a macro-editing window. Macro-editing windows have several special properties:</P>
<UL><LI>    The Macro toolbar is displayed whenever you open a macro-editing window. This toolbar provides quick access to several commands for running and testing macros.</LI><LI>    When you run a macro in the macro-editing window, Word highlights any line containing certain kinds of errors.</LI><LI>    You can position the insertion point on a line containing a WordBasic instruction and get Help for that instruction by pressing F1 (Windows), or HELP or COMMAND+/ (Macintosh).</LI><LI>    Formatting is controlled by the Macro Text style. You can use this style to set character and paragraph formatting for text in all macro-editing windows.</LI></UL><P></P>
<P CLASS="t">To begin writing a new macro, choose Macro from the Tools menu, type a name for the macro in the Macro Name box, and then choose the Create button.</P>
<P CLASS="a">    <img src="ATR0210.gif"></P>
<P CLASS="t">When the macro-editing window appears, the instructions Sub MAIN and End Sub (between which all the other instructions must appear) are already on the screen with the insertion point positioned between them.</P>
<P CLASS="t">To open and edit an existing macro, select the one you want to edit from the list of&nbsp;macros in the Macro dialog box, and then choose the Edit button (the Create button becomes the Edit button when an existing macro is selected).</P>
<P CLASS="proch"><B> <FONT FACE="Symbol">Û</FONT>    To open the BoldItalic macro for editing</B></P>
<P CLASS="lt1"> <FONT FACE="Symbol">·</FONT>    From the Tools menu, choose the Macro command. Then select the BoldItalic macro and choose the Edit button.</P>
<P></P>
<H3 CLASS="h3"><A NAME="sec0"></A>Examining the Macro</H3><P CLASS="t">The Word macro recorder does not record keystrokes, as some macro recorders do; it records <I>actions</I>, which are translated into the Word macro language, WordBasic. So when you open a recorded macro in the macro-editing window, the window displays a series of WordBasic instructions.</P>
<P CLASS="a">    <img src="ATR0211.gif"></P>
<P CLASS="t">Consider the text of the BoldItalic macro, beginning with Sub MAIN and ending with End Sub. These two statements begin and end every WordBasic macro. "Sub" stands for <I>subroutine</I>, which is a subsection of a larger program. The larger program in this case is Word itself. From the perspective of WordBasic, a macro is a small task within a larger task — the task of running Word. "MAIN" indicates that this is the main subroutine of the macro. In the case of the BoldItalic macro, it's also the only subroutine in the macro.</P>
<P CLASS="t">Now consider the lines sandwiched between Sub MAIN and End Sub:</P>
<P CLASS="spacing"><BR></P>
<PRE>FormatFont .Points = "12", .Underline = 0, .Color = 0, .Strikethrough = 0, .Superscript = 0, .Subscript = 0, .Hidden = 0, .SmallCaps = 0, .AllCaps = 0, .Spacing = "0 pt", .Position = "0 pt", .Kerning = 0, .KerningMin = "", .Tab = "0", .Font = "Times New Roman", .Bold = 1, .Italic = 1
</PRE>
<P CLASS="t">These lines form a single <I>statement,</I> the <B>FormatFont</B> statement. A statement is a&nbsp;WordBasic instruction that tells the macro to do something. The <B>FormatFont</B> statement corresponds to the Font dialog box (Format menu). Each word in the statement that begins with a period corresponds to an option in the dialog box. These words, such as .Points, .Strikethrough, and .Hidden, are called <I>arguments</I> — they qualify the statement. (Note that if you recorded your macro on the Macintosh, the <B>FormatFont</B> statement includes two additional arguments—.Outline and .Shadow—that are valid only on the Macintosh.)</P>
<P CLASS="t">Every argument in a statement has a <I>value</I>, which corresponds to the setting of the option in the dialog box. For example, the Font dialog box contains several check boxes which can be either selected or cleared. Likewise, the WordBasic arguments that correspond to those check boxes can have one of two values. If the Strikethrough check box is selected, for example, the WordBasic argument would read .Strikethrough = 1. If the check box were not selected, the argument would read .Strikethrough = 0.</P>
<H3 CLASS="h3"><A NAME="sec1"></A>Editing the BoldItalic Macro</H3><P CLASS="t">The BoldItalic macro you recorded earlier in this chapter didn't work properly as&nbsp;it was recorded. The only thing you wanted the macro to do was apply bold and italic formatting. Unfortunately, it also applied other character formats such as font and font size. With the macro open in a macro-editing window, you can correct that problem by removing the irrelevant arguments from the <B>FormatFont</B> statement.</P>
<P CLASS="proch"><B> <FONT FACE="Symbol">Û</FONT>    To edit the FormatFont statement</B></P>
<P CLASS="lt1"> <FONT FACE="Symbol">·</FONT>    With the macro open in a macro-editing window, select and delete every argument except .Bold and .Italic.</P>
<P></P>
<P CLASS="t">The edited BoldItalic macro should look like this:</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN
FormatFont .Bold = 1, .Italic = 1
End Sub
</PRE>
<H3 CLASS="h3"><A NAME="sec2"></A>Getting Help on WordBasic</H3><P CLASS="t">In a macro-editing window, you can immediately get reference information about any WordBasic instruction by positioning the insertion point on the same line as the instruction and pressing F1 (Windows), or HELP or COMMAND+/ (Macintosh).</P>
<P CLASS="proch"><B> <FONT FACE="Symbol">Û</FONT>    To get Help for the FormatFont statement</B></P>
<P CLASS="lt1"> <FONT FACE="Symbol">·</FONT>    Position the insertion point anywhere in the <B>FormatFont</B> statement, and then press F1 (Windows), or HELP or COMMAND+/ (Macintosh).</P>
<P CLASS="a">    <img src="ATR0212.gif"></P>
<P CLASS="t">For many WordBasic instructions, Help provides examples you can copy. You can click Example in the Help topic to display the examples. You can choose the Copy button (Word version 6.0) or choose Copy from the shortcut menu (Word version 7.0) in the example window to copy the text of the code example onto the Clipboard. You can then paste the example into your own macro or document.</P>
<P CLASS="a">    <img src="ATR0213.gif"></P>
<P CLASS="t">You can also use the Help menu in Word to access Help topics about WordBasic. Help provides a language summary that groups WordBasic statements and functions by category, as well as information on predefined bookmarks and error messages. All the reference information contained in Part 2, "WordBasic Reference," is available in Help.</P>
<H3 CLASS="h3"><A NAME="sec3"></A>The Macro Toolbar</H3><P CLASS="t">Whenever you open a macro-editing window, the Macro toolbar is displayed, if it isn't displayed already.</P>
<P CLASS="a">    <img src="ATR0215.gif"></P>
<P CLASS="t">Many of the buttons on the toolbar are used for testing, but several of the buttons can be used for running and recording macros:</P>
<H4 CLASS="h6"><A NAME="sec4"></A>Active Macro</H4><P CLASS="h">This box lists the macros open in macro-editing windows. If more than one macro is open, you can use the Active Macro box to select which macro runs when you click the Start button.</P>
<H4 CLASS="h6"><A NAME="sec5"></A>Record</H4><P CLASS="h">Displays the Record Macro dialog box, so that you can begin recording a&nbsp;macro.</P>
<H4 CLASS="h6"><A NAME="sec6"></A>Record Next Command</H4><P CLASS="h">Records a single command or action in Word and inserts the resulting WordBasic instruction in the active macro-editing window (or the most recently active one, if a document window is active). For more information, see "The Record Next Command Button" later in this section.</P>
<H4 CLASS="h6"><A NAME="sec7"></A>Start</H4><P CLASS="h">Runs the macro selected in the Active Macro box. By default, this is the macro in the active macro-editing window (or the most recently active one, if a&nbsp;document window is active).</P>
<H4 CLASS="h6"><A NAME="sec8"></A>Macro</H4><P CLASS="h">Displays the Macro dialog box. Clicking this button is a shortcut for choosing the Macro command from the Tools menu.</P>
<P CLASS="t">For information on the Trace, Continue, Stop, Step, Step Subs, Show Variables, and Add/Remove REM buttons, see Chapter 6, "Debugging." For information on the Dialog Editor button, see Chapter 5, "Working with Custom Dialog Boxes."</P>
<H3 CLASS="h3"><A NAME="sec9"></A>Running the Macro from the Macro-Editing Window</H3><P CLASS="t">You can use the Start button on the Macro toolbar to run the macro in the active macro-editing window. Some macros, however, will not run unless a document window is active. For example, if you run the BoldItalic macro when its macro-editing window is active, an error occurs, because the Font command (Format menu) is not available when a macro-editing window is active.</P>
<P CLASS="a">    <img src="ATR0216.gif"></P>
<P CLASS="t">If you browse through the menus when a macro-editing window is active, you can&nbsp;see that many commands are unavailable&nbsp;—&nbsp;they are commands for tasks that aren't useful for editing macros.</P>
<P CLASS="t">If you have a document window open in addition to a macro-editing window, you can choose the Arrange All command from the Window menu to display both the document window and the macro-editing window. To run the BoldItalic macro now, you can just click in the document window to make it active, and then click the Start button on the Macro toolbar.</P>
<P CLASS="a">    <img src="ATR0217.gif"></P>
<H3 CLASS="h3"><A NAME="sec10"></A>Error Checking in the Macro-Editing Window</H3><P CLASS="t">Whenever you run a macro, Word automatically checks the <I>syntax</I> of each WordBasic command. In programming, syntax refers to the rules governing the spelling of arguments, the number of arguments, and so on. Word also checks to make sure the arguments have appropriate values. If a macro-editing window is open and Word discovers an instruction with a problem, it highlights the instruction and presents an error message.</P>
<P CLASS="t">To see how Word identifies syntax errors, you can alter the syntax of the BoldItalic macro. Try deleting the comma between the .Bold and .Italic arguments so that the <B>FormatFont</B> statement looks like the following:</P>
<P CLASS="spacing"><BR></P>
<PRE>FormatFont .Bold = 1 .Italic = 1
</PRE>
<P CLASS="t">Now try running the macro.</P>
<P CLASS="a">    <img src="ATR0218.gif"></P>
<P CLASS="t">Another common error is to type an argument without the period in front of it. It's&nbsp;easy to make these errors, but by highlighting the line containing the error, the&nbsp;macro-editing window helps you find them.</P>
<H3 CLASS="h3"><A NAME="sec11"></A>The Macro Text Style</H3><P CLASS="t">The Macro Text style determines the formatting of text in macro-editing windows. You can't apply direct formatting to text in a macro-editing window, but you can modify the Macro Text style. The Macro Text style is a special style that is stored in the Normal template. It affects every macro-editing window, regardless of whether the macro displayed in a macro-editing window is stored in&nbsp;the Normal template or in another template.</P>
<P CLASS="t">You use the Style command (Format menu) to modify the Macro Text style. A&nbsp;document window must be active when you choose the Style command; you&nbsp;cannot choose the Style command when a macro window is active. </P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">When you modify the Macro Text style, Word updates the style definition displayed in the Style dialog box (Format menu) only for the document that is active and for the Normal template. This means that when other documents and documents based on other templates are active, the Macro Text style definition displayed in the Style dialog box may not be current.</P>
<P CLASS="nt">To find out the current, correct style definition of Macro Text, create a document based on the Normal template. Choose Style from the Format menu, and then select the Macro Text style in the Styles list (if necessary, select All Styles in the List box to see the Macro Text style in the Styles list); the Description box will show the current style definition.</P>
<P></P>
<H3 CLASS="h3"><A NAME="sec12"></A>View Options for Macro-Editing Windows</H3><P CLASS="t">You can use the View tab in the Options dialog box to set view options for macro-editing windows. View options you set for macro-editing windows do not affect view options for document windows. For example, you can hide the status bar in macro-editing windows but not in document windows.</P>
<H3 CLASS="h3"><A NAME="sec13"></A>The Record Next Command Button</H3><P CLASS="t">Sometimes, you want to record one or two commands to insert into an existing macro you're working on, but you don't want to record a new macro. The Record Next Command button on the Macro toolbar provides this capability. When you have a macro-editing window open, you can use the Record Next Command button to record the next Word command you choose or action you take (such as&nbsp;scrolling through a document). Word inserts the equivalent WordBasic instruction at the insertion point in the macro-editing window.</P>
<P CLASS="t">If a macro window is active and you want to record a command that isn't available in macro-editing windows, switch to a document window before clicking the Record Next Command button. If you click the Record Next Command button and then switch to a document window, Word will record your&nbsp;switching windows rather than the command you want to record.</P>
<P></P>

<TABLE COLS="1" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="348pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="sbrh"><B>Stopping or Pausing a Macro</B></P>
<P CLASS="sbrt">When a macro is running, you can stop or pause it by pressing the ESC key. Word displays a message stating that the macro was interrupted. If the macro is open in a macro-editing window, you can click the Continue button on the Macro toolbar to continue running the macro, or you can press the ESC key again or click the Stop button on the Macro toolbar to stop the macro. If the macro is not open in a macro-editing window when you press the ESC key, Word simply stops the macro.</P>
<P CLASS="sbrh"><B></B></P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P></FONT></FONT></BODY></HTML>
