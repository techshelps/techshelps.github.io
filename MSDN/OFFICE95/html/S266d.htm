<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPISetMessageType</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H3 CLASS="h2">MAPISetMessageType</H3><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>MAPISetMessageType(</B><I>MessageType$</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Sets the message type of the current outbound message. Message types allow custom messages within Mail. You can use custom messages to associate messages with specific projects or applications. Messages can be interpersonal messages that appear in the user's Inbox, or interprocess communication messages that are invisible to the user. The <I>MessageType$</I> argument begins with "IPM." for interpersonal messages or with "IPC." for interprocess communication messages. The standard format for message types is "IPM.Vendor.Application" or "IPC.Vendor.Application."</P>
<P CLASS="t">Use <B>MAPIFindNext</B> to retrieve messages using the message type. This procedure is faster and more reliable than retrieving every message in the Inbox or searching for certain strings within the message subject or note text.</P>
<P CLASS="t">Message types are optional. For normal interpersonal messages, do not use <B>MAPISetMessageType</B>, or specify an empty string ("").</P>
<P CLASS="t">If your application generates IPC messages, you should provide users or administrators with a utility to find and delete outdated IPC messages in the Inbox. For an example, see <B>MAPIFindNext</B>.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>MessageType$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A string that is the message type</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">The following example sends a message with a custom message type.</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN
MAPI_LOGON_UI&nbsp;=&nbsp;1
Session&nbsp;=&nbsp;MAPILogon(0, "", "", MAPI_LOGON_UI, 0)
result&nbsp;=&nbsp;MAPISetRecipient(1, "Michael Ranwez", "")
result&nbsp;=&nbsp;MAPISetMessageType("IPM.Sample.Report")
result&nbsp;=&nbsp;MAPISendMail(Session, 0, "Monthly Summary",\
    "We will quickly satisfy all orders for clamps.", 0, 0)
result&nbsp;=&nbsp;MAPILogoff(Session, 0, 0, 0)
End Sub
</PRE></FONT></FONT></BODY></HTML>
