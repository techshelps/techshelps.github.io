<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ConvertFormula Method</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>ConvertFormula Method</H1><P CLASS="h"><B>Applies To</B></P>
<P CLASS="t"><B>Application </B>Object.</P>
<P CLASS="h"><B>Description</B></P>
<P CLASS="t">Converts cell references in a formula between the A1 and R1C1 reference styles, between relative and absolute references, or both.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><I>object</I>.<B>ConvertFormula(</B><B><I>formula</I></B>,<B><I> fromReferenceStyle</I></B>,<B><I> toReferenceStyle</I></B>,<B><I> toAbsolute</I></B>,<B><I> relativeTo</I></B><B>)</B></P>
<P CLASS="term1"><I>object</I></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. The <B>Application</B> object.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>formula</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. A string containing the formula that you want to convert. This must be a valid formula and it must begin with an equal sign.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>fromReferenceStyle</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Required. The reference style of the formula. May be either <B>xlA1</B> or <B>xlR1C1</B>.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>toReferenceStyle</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. The reference style you want returned. May be either <B>xlA1</B> or <B>xlR1C1</B>. If omitted, the reference style is not changed (the formula stays in the style specified by <B><I>fromReferenceStyle</I></B>).</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>toAbsolute</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. Specifies the converted reference type (one of <B>xlAbsolute</B>, <B>xlAbsRowRelColumn</B>, <B>xlRelRowAbsColumn</B>, or <B>xlRelative)</B>. If this argument is omitted, the reference type is not changed.</P>
</BLOCKQUOTE>
<P CLASS="term1"><B><I>relativeTo</I></B></P>
<BLOCKQUOTE>
<P CLASS="dt1">Optional. A <B>Range</B> object that contains one cell. This object determines the cell to which relative references relate.</P>
</BLOCKQUOTE>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example converts a SUM formula that contains R1C1-style references to an equivalent formula that contains A1-style references and then displays the result.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">inputFormula = "=SUM(R10C2:R15C2)"
MsgBox Application.ConvertFormula( _
    formula:=inputFormula, _
    fromReferenceStyle:=xlR1C1, _
    toReferenceStyle:=xlA1)
</FONT></PRE></FONT>
</FONT></BODY></HTML>
