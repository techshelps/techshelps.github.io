<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BeforeUpdate, AfterUpdate Events -- Event Procedures</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h1><a name="sec89"></a>BeforeUpdate, AfterUpdate Events -- Event
Procedures</h1>

<h2><a name="sec90"></a>Description</h2>

<p>To create an event procedure that is run when the BeforeUpdate
or AfterUpdate event occurs, set the <b>BeforeUpdate</b> or <b>AfterUpdate</b>
property to [Event Procedure], and click the Build button.</p>

<h2><a name="sec91"></a>Syntax</h2>

<p><b>Private Sub Form_BeforeUpdate (</b>Cancel<b> As
Integer)Private Sub </b><i>controlname</i><b>_BeforeUpdate (</b>Cancel<b>
As Integer)Private Sub Form_AfterUpdate ( )Private Sub </b><i>controlname</i><b>_AfterUpdate
( )</b></p>

<p>The BeforeUpdate event procedure uses the following argument.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>controlname</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string that is the name of the control
        affected by the BeforeUpdate event procedure.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Cancel</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The setting determines if the
        BeforeUpdate event occurs. Setting Cancel to <b>True</b>
        (-1) cancels the BeforeUpdate event</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<p>The AfterUpdate event procedure uses the following argument.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>controlname</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string that is the name of the control
        affected by the AfterUpdate event procedure.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec92"></a>Remarks</h2>

<p>You can&#146;t cancel the AfterUpdate event.</p>

<p>You can use an AfterUpdate event procedure to display a
different page in the form or move the focus to a particular
control or record. For example, when the user enters a value in a
Category control on a form, you can use the <b>GoToPage</b>
method in the AfterUpdate event procedure for the form to move
the focus to the page of the form that contains the controls for
that category.</p>

<h2><a name="sec93"></a>See Also</h2>

<p>BeforeUpdate, AfterUpdate Events &#151; Macros.</p>

<h2><a name="sec94"></a>Example</h2>

<p>This example shows how you can use a BeforeUpdate event
procedure to check whether a product name has already been
entered. After the user types a product name in the ProductName
box, the value is compared to the ProductName field in the
Products table. If there is a matching value in the Products
table, a message is displayed that informs the user that the
product has already been entered in the database.</p>

<p>To try the following example, add the following code to the
Declarations section of a form named Products that contains a
text box called ProductName.</p>

<p class="spacing"><br>
</p>

<pre>Private Sub ProductName_BeforeUpdate(Cancel As Integer)
    If (Not IsNull(DLookup(&quot;[ProductName]&quot;, &quot;Products&quot;, _
        &quot;[ProductName] ='&quot; &amp; Forms!Products!ProductName &amp; &quot;'&quot;))) Then
        MsgBox &quot;Product has already been entered in the database.&quot;
        Cancel = True
        Me!ProductName.Undo
    End IfSub</pre>
</FONT></FONT></BODY>
</html>
