<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>If...Then...Else Statement</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>If...Then...Else Statement</H1><P CLASS="h"><B>Description</B></P>
<P CLASS="t">Conditionally executes a group of statements, depending on the value of an expression.</P>
<P CLASS="h"><B>Syntax 1</B></P>
<P CLASS="syn"><B>If</B> <I>condition </I><B>Then</B> <I>statements </I>[<B>Else</B> <I>elsestatements </I>]</P>
<P CLASS="h"><B>Syntax 2</B></P>
<P CLASS="syn"><B>If</B> <I>condition </I><B>Then</B><BR>    [<I>statements</I>]<BR>[<B>ElseIf</B> <I>condition-n </I><B>Then</B><BR>    [<I>elseifstatements</I>]]<I> </I>. . .<BR>[<B>Else</B><BR>    [<I>elsestatements</I>]]<BR><B>End</B> <B>If</B></P>
<P CLASS="t">Syntax 1 has these parts:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="249pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Part</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>condition</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Numeric or string expression that evaluates <B>True</B> or <B>False</B>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>statements</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">One or more statements separated by colons; executed if <I>condition</I> is <B>True</B>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>elsestatements</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">One or more statements separated by colons; executed if <I>condition</I> is <B>False</B>.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">Syntax 2 has these parts:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="249pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="thf"><B>Part</B></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="th"><B>Description</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>condition</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Expression that is <B>True</B> or <B>False</B>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>statements</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">One or more statements executed if <I>condition</I> is <B>True</B>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>condition-n</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">Numeric or string expression that evaluates <B>True</B> or <B>False</B>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>elseifstatements</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">One or more statements executed if associated <I>condition-n</I> is <B>True</B>.</P></FONT></TD></TR><TR><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt"><I>elsestatements</I></P></FONT></TD><TD VALIGN="TOP">
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<P CLASS="tt">One or more statements executed if no previous <I>condition-n </I>expressions are <B>True</B>.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">You can use the single-line form (Syntax 1) for short, simple tests. However, the block form (Syntax 2) provides more structure and flexibility than the single-line form and is usually easier to read, maintain, and debug.</P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P CLASS="nt">With Syntax 1 it is possible to have multiple statements executed as the result of an <B>If</B>...<B>Then</B> decision, but they must all be on the same line and separated by colons, as in the following statement:</P>
<P CLASS="nt"><B>If A &gt; 10 Then A = A + 1 : B = B + A : C = C + B</B></P>
<P></P>
<P CLASS="t">When executing a block <B>If</B> (Syntax 2), <I>condition </I>is tested. If <I>condition</I> is <B>True</B>, the statements following <B>Then</B> are executed. If <I>condition</I> is <B>False</B>, each <B>ElseIf</B> condition (if any) is evaluated in turn. When a <B>True</B> condition is found, the statements immediately following the associated <B>Then</B> are executed. If none of the <B>ElseIf</B> conditions are <B>True</B> (or if there are no <B>ElseIf</B> clauses), the statements following <B>Else</B> are executed. After executing the statements following <B>Then</B> or <B>Else</B>, execution continues with the statement following <B>End If</B>.</P>
<P CLASS="t">The <B>Else</B> and <B>ElseIf</B> clauses are both optional. You can have as many <B>ElseIf</B> clauses as you want in a block <B>If</B>, but none can appear after an <B>Else</B> clause. Block <B>If</B> statements can be nested; that is, contained within one another.</P>
<P CLASS="t">What follows the <B>Then</B> keyword is examined to determine whether or not a statement is a block <B>If</B>. If anything other than a comment appears after <B>Then</B> on the same line, the statement is treated as a single-line <B>If</B> statement.</P>
<P CLASS="t">A block <B>If</B> statement must be the first statement on a line. The <B>Else</B>, <B>ElseIf</B>, and <B>End If</B> parts of the statement can have only a line number or line label preceding them. The block <B>If</B> must end with an <B>End If</B> statement.</P>
<P></P>
<P CLASS="nh"><B>Tip</B></P>
<P CLASS="nt"><B>Select Case</B> may be more useful when evaluating a single expression that has several possible actions.</P>
<P></P>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>Select</B> <B>Case</B> Statement.</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example shows uses of the <B>If</B>...<B>Then</B>...<B>Else</B> statement.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Number = 53    ' Initialize variable.
If Number &lt; 10 Then
    Digits = 1
ElseIf Number &lt; 100 Then
' Condition evaluates to True so the next statement is executed.
    Digits = 2
Else
    Digits = 3
End If
' Assign a value using the single line form of syntax.
If Digits = 1 Then MyString = "One" Else MyString = "More than one" 
</FONT></PRE>
<P CLASS="t">This example loops on cells A1:D10 on Sheet1. If one of the cells has a value less than 0.001, the code replaces the value with 0 (zero).</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">For Each c in Worksheets("Sheet1").Range("A1:D10")
    If c.Value &lt; .001 Then
        c.Value = 0
    End If
Next c
</FONT></PRE>
<P CLASS="t">This example loops on the range named "TestRange" and displays the number of empty cells in the range.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">numBlanks = 0
For Each c In Range("TestRange")
    If c.Value = "" Then
        numBlanks = numBlanks + 1
    End If
Next c
MsgBox "There are " &amp; numBlanks &amp; " empty cells in this range."
</FONT></PRE>
<P CLASS="t">This example sets the standard font to Arial (in Windows) or Geneva (on the Macintosh).</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">If Application.OperatingSystem Like "*Macintosh*" Then
    Application.StandardFont = "Geneva"
Else
    Application.StandardFont = "Arial"
End If
</FONT></PRE></FONT>
</FONT></BODY></HTML>
