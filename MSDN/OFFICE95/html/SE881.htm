<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ON.TIME</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="macros, running at specified times"><META NAME="MS-HKWD" CONTENT="ON.TIME function"><META NAME="MS-HKWD" CONTENT="running macros, at specified times"><META NAME="MS-HKWD" CONTENT="specific times, running macros at"><META NAME="MS-HKWD" CONTENT="specified times, running macros at"><META NAME="MS-HKWD" CONTENT="time, running macros at"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    ON.TIME</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Runs a macro at a specified time. Use ON.TIME to run a macro at a specific time of day or after a specified period has passed.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>ON.TIME</B>(<B>time, macro_text, </B>tolerance, insert_logical)</P>
<P CLASS="t">Time    is the time and date, given as a serial number, at which the macro is to be run. If time does not include a date (that is, if time is a serial number less than 1), the macro is run the next time time occurs.</P>
<P CLASS="t">Macro_text    is the name of, or an R1C1-style reference to, a macro to run at the specified time and every subsequent day at that time.</P>
<P CLASS="t">Tolerance    is the time and date, given as a serial number, that you are willing to wait until and still have the macro run. For example, if Microsoft Excel is not in Ready, Copy, Cut, or Find mode at time, because another macro is running, but is in Ready mode 15 seconds later, and tolerance is set to time plus 30 seconds, the macro specified by macro_text will run. If Microsoft Excel was not in Ready mode within 30 seconds, the macro would not run. If tolerance is omitted, it is assumed to be infinite.</P>
<P CLASS="t">Insert_logical    is a logical value specifying whether you want every day macro_text to run at time. Use insert_logical when you want to clear a previously set ON.TIME formula. If insert_logical is TRUE or omitted, the macro specified by macro_text is carried out at time. If insert_logical is FALSE and macro_text is not set to run at time, ON.TIME returns the #VALUE error value.</P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">The following macro formula runs a macro called Test at 5:00:00 P.M. every day when Microsoft Excel is in Ready mode:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.TIME("5:00:00 PM", "Test")
</FONT></PRE>
<P CLASS="t">The following macro formula runs a macro called Test 5 seconds after the formula is evaluated:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.TIME(NOW()+"00:00:05", "Test")
</FONT></PRE>
<P CLASS="t">The following macro formula runs a macro called Test 10 seconds after the formula is evaluated. If Microsoft Excel is not in Ready mode at that time (because it is in Edit mode, for example), the tolerance argument specifies 5 seconds of additional time to wait to run the macro. If Microsoft Excel is still not in Ready mode at that time, macro_text is not run.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.TIME(NOW()+"00:00:10", "Test", NOW()+"00:00:15")
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P>List of <A class="normal" href="SE744.HTM">Customizing Functions</A></P></FONT>
</FONT></BODY></HTML>
