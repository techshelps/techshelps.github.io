<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Performing Multiple Actions on an Object</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Performing Multiple Actions on an Object</H2><P CLASS="t">Procedures often need to perform several different actions on the same object. For example, you might need to set several properties for the same cell. One way to do this is to use several statements, as in the following example.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ActiveSheet.Cells(1, 1).Formula = "=SIN(180)"
ActiveSheet.Cells(1, 1).Font.Name = "Arial"
ActiveSheet.Cells(1, 1).Font.Bold = True
ActiveSheet.Cells(1, 1).Font.Size = 8
</FONT></PRE>
<P CLASS="t">Notice that all these statements use the same object reference. You can make this code easier to enter, easier to read, and more efficient by using the <B>With...End With</B> statement.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">With ActiveSheet.Cells(1, 1)
    .Formula = "=SIN(180)"
    .Font.Name = "Arial"
    .Font.Bold = True
    .Font.Size = 8
End With
</FONT></PRE>
<P CLASS="t">You can also nest <B>With...End With</B> statements. The following example shows how you can rewrite the preceding code using one <B>With...End With</B> statement nested inside another one.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">With ActiveSheet.Cells(1, 1)
    .Formula = "=SIN(180)"
    With .Font
        .Name = "Arial"
        .Bold = True
        .Size = 8
    End With
End With
</FONT></PRE>
<P CLASS="t">The object reference following the <B>With...End With</B> statement can be a reference to either a single object or a collection. The following example sets the font properties of all the text boxes on the active sheet.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">With ActiveSheet.TextBoxes
    .Font.Name = "Arial"
    .Font.Size = 8
End With
</FONT></PRE></FONT>
</FONT></BODY></HTML>
