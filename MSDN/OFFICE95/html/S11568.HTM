<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAvg Function</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<h1><a name="sec154"></a>DAvg Function</h1>

<h2><a name="sec155"></a>Description</h2>

<p>You can use the <b>DAvg</b> function to calculate the average
of a set of values in a specified set of records (domain). Use <b>DAvg</b>
in a macro or module, in a query expression, or in a calculated
control.</p>

<p>For example, you could use <b>DAvg</b> in the criteria<i> </i>row
of a select query on freight cost to restrict the results to only
those records for which the freight cost is above the average. Or
you could use an expression including <b>DAvg</b> in a calculated
control, and display the average value of previous orders next to
the value of a new order.</p>

<h2><a name="sec156"></a>Syntax</h2>

<p><b>DAvg(</b><i>expr</i>, <i>domain</i>[, <i>criteria</i>]<b>)</b></p>

<p>The <b>DAvg</b> function uses the following arguments.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>expr</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Expression that identifies the field
        containing the numeric data you want to average. It can
        be a string expression identifying a field in a table or
        query, or it can be an expression that performs a
        calculation on data in that field. You can include in <i>expr
        </i>the name of a table field, a control on a form, a
        constant, or a function. If <i>expr</i> includes a
        function, it can be either built-in or user-defined, but
        not another domain aggregate or SQL aggregate function.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>domain</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">String expression identifying the set of
        records that constitutes the domain. It can be a table
        name or a query name.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>criteria</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional string expression used to
        restrict the range of data on which <b>DAvg</b> is
        performed. For example, <i>criteria</i> is often
        equivalent to the WHERE clause in an SQL expression,
        without the word WHERE. If <i>criteria</i> is omitted, <b>DAvg</b>
        evaluates <i>expr </i>against the entire domain. Any
        field included in <i>criteria</i> must also be a field in
        <i>domain</i>; otherwise <b>DAvg</b> returns a <b>Null</b>.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<h2><a name="sec157"></a>Remarks</h2>

<p><b>DAvg</b> finds the average value of the field or expression
defined by <i>expr </i>in the table or query referred to by <i>domain</i>,
according to any restrictions specified by <i>criteria</i>.</p>

<p>Records containing <b>Null</b> values are not included in the
calculation of the average.</p>

<p>Whether you use <b>DAvg</b> in a macro or module, a query
expression, or a calculated control, you must construct the <i>criteria
</i>argument carefully to ensure that it will be evaluated
correctly.</p>

<p>You can use <b>DAvg</b> to specify criteria in the Criteria
row of a query. For example, suppose you want to view a list of
all products ordered in quantities above the average order
quantity. You could create a query on the Orders and Products
tables, and include the Product Name field and the Quantity
field, with the following expression in the Criteria row beneath
the Quantity field.</p>

<p class="spacing"><br>
</p>

<pre>&gt; DAvg(&quot;[Quantity]&quot;, &quot;Orders&quot;)
</pre>

<p>You can also use <b>DAvg</b> within a calculated field
expression in a query, or in the Update To row of an update
query.</p>

<p><b>Note</b> You can use either <b>DAvg</b> or <b>Avg</b> in a
calculated field expression in a totals query. If you use <b>DAvg</b>,
values are averaged before the data is grouped. If you use <b>Avg</b>,
the data is grouped before values in the field expression are
averaged.</p>

<p>Use <b>DAvg</b> in a calculated control when you need to
specify criteria<i> </i>to restrict the range of data on which <b>DAvg</b>
is performed. For example, to display the average cost of freight
for shipments sent to California, set the <b>ControlSource</b>
property of a text box to the following expression.</p>

<p class="spacing"><br>
</p>

<pre>= DAvg(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipRegion] = 'CA'&quot;)
</pre>

<p>If you simply want to average all records in <i>domain</i>,
use the <b>Avg</b> function.</p>

<p>You can use <b>DAvg</b> in a module or macro or in a
calculated control on a form if a field that you need to display
is not in the record source on which your form is based. For
example, suppose you have a form based on the Orders table, and
you want to include the Quantity field from the Order Details
table in order to display the average number of items ordered by
a particular customer. You can use <b>DAvg</b> to perform this
calculation and display the data on your form.</p>

<p><b>Note</b> <b>Tips</b></p>
<SPAN CLASS="list">
<ul>
    <li><SPAN CLASS="Symbol"></SPAN> If you use <b>DAvg</b> in a calculated control, you may
        want to place the control on the form header or footer so
        that the value for this control is not recalculated each
        time you move to a new record.</li>
    <li><SPAN CLASS="Symbol"></SPAN> If the data type of the field from which <i>expr </i>is
        derived is a number, <b>DAvg</b> returns a <b>Double</b>.
        If you use <b>DAvg</b> in a calculated control, include a
        data type conversion function in the expression to
        improve performance.</li>
    <li><SPAN CLASS="Symbol"></SPAN> Although you can use <b>DAvg</b> to determine the
        average of values in a field in a foreign table, it may
        be more efficient to create a query that contains all of
        the fields that you need, and then base your form or
        report on that query.</li>
</ul>
</SPAN>
<p><b>Note</b> Unsaved changes to records in <i>domain</i> are
not included when you use this function. If you want the <b>DAvg</b>
function to be based on the changed values, you must first save
the changes by choosing the Save Record command from the File
menu, moving the focus to another record, or using the <b>Update</b>
method.</p>

<h2><a name="sec158"></a>See Also</h2>

<p>Domain Aggregate Functions.</p>

<h2><a name="sec159"></a>Example</h2>

<p>This example returns the average freight cost for orders
shipped to the United Kingdom before January 1, 1995. The domain
is an Orders table. The <i>criteria</i> argument restricts the
resulting set of records to those for which ShipCountry equals UK
and ShippedDate is greater than 1-1-95. Note that the keyword <b>AND</b>
is included in the string to separate the multiple fields in the <i>criteria</i>
argument. All records included in the <b>DAvg</b> calculation
will have both of these criteria.</p>

<p class="spacing"><br>
</p>

<pre>Dim dblX As Double= DAvg(&quot;[Freight]&quot;, &quot;Orders&quot;, _
    &quot;[ShipCountry] = 'UK' AND [ShippedDate] &gt; #1-1-95#&quot;)
</pre>

<p>The next example calculates an average using a variable,
strCountry, in the criteria argument. Note that single quotation
marks (') are included in the string expressions, so that when
all of the strings are concatenated, the string literal UK will
be enclosed in single quotation marks. In this example, the
keyword <b>OR</b> is used to separate the multiple fields. This
example will return all records that have either or both
criteria.</p>

<p class="spacing"><br>
</p>

<pre>Dim dblX As Double, strCountry As String= &quot;UK&quot;= DAvg(&quot;[Freight]&quot;, &quot;Orders&quot;, _
    &quot;[ShipCountry] = '&quot; &amp; strCountry &amp; &quot;'OR [ShippedDate] &gt; #1-1-95#&quot;)
</pre>
</FONT></FONT></BODY>
</html>
