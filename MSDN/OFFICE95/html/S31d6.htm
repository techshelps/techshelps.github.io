<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetPrivateProfileString$()</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H1 CLASS="h2">GetPrivateProfileString$()</H1><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>GetPrivateProfileString$(</B><I>Section$</I><B>,</B> <I>KeyName$</I><B>,</B> <I>Filename$</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Returns a setting in a settings file, a file that your macros can use to store and retrieve settings. For example, you can store the name of the active document when you quit Word so that it can be reopened automatically the next time you start Word. In Windows, a settings file is a text file such as WIN.INI. On the Macintosh, a settings file is a resource file such as Word Settings (6).</P>
<P CLASS="t">In Windows 95 and Windows NT, you can use <B>GetPrivateProfileString$</B><B>()</B> to return a setting in the registry.</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Section$ </I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The name of the section in the settings file that contains <I>KeyName$</I>. In Windows, the section name appears between brackets before the associated keys (do not include the brackets with <I>Section$</I>).</P>
<P CLASS="tt">If you are using <B>GetPrivateProfileString$</B><B>()</B> in Windows 95 or Windows&nbsp;NT to return a setting in the registry, <I>Section$</I> should be the complete path to the key, including the root (for example, "HKEY_CURRENT_USER\Software\Microsoft\Word\7.0\Options").</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>KeyName$ </I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The key whose setting you want to retrieve. In a Windows settings file, the key name is followed by an equal sign (=) and the setting.</P>
<P CLASS="tt">If you are using <B>GetPrivateProfileString$</B><B>()</B> in Windows 95 or Windows&nbsp;NT to return a value from the registry, <I>KeyName$</I> should be the name of the value in the key specified by <I>Section$</I> (for example, "MessageBeeps").</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Filename$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The filename for the settings file. If a path is not specified, the Windows folder (Windows) or the Preferences folder (Macintosh) is assumed.</P>
<P CLASS="tt">If you are using <B>GetPrivateProfileString$</B><B>()</B> in Windows 95 or Windows&nbsp;NT to return a value from the registry, <I>Filename$</I> must be an empty string ("").</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">If a specified section, key, or file does not exist, <B>GetPrivateProfileString$</B><B>()</B> returns an empty string ("").</P>
<P CLASS="h"><B>Example</B></P>
<P CLASS="t">This example sets the variable artdir$ to the path specified by the PICTURE-PATH key in the [Microsoft Word] section of WINWORD6.INI and, if the setting exists, changes the current folder accordingly. The last two instructions display the Insert Picture dialog box (Picture command, Insert menu). On the Macintosh, substitute Word Settings (6) for WINWORD6.INI. In Windows 95 and Windows&nbsp;NT, substitute the full path to the Options key for "Microsoft Word," and substitute an empty string ("") for WINWORD6.INI.</P>
<P CLASS="spacing"><BR></P>
<PRE>artdir$&nbsp;=&nbsp;GetPrivateProfileString$("Microsoft Word", \
    "PICTURE-PATH", "WINWORD6.INI")
If artdir$ &lt;&gt; "" Then ChDir artdir$
Dim dlg As InsertPicture
x&nbsp;=&nbsp;Dialog(dlg)
</PRE>
<P CLASS="t">For another example, see <B>SetPrivateProfileString</B>.</P>
<P CLASS="h"><B>See Also</B></P>
<P CLASS="t"><B>GetProfileString$</B><B>()</B>,<B> SetPrivateProfileString</B>,<B> SetProfileString</B></P>
<P></P></FONT></FONT></BODY></HTML>
