<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ON.RECALC</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="macros, running on recalculation"><META NAME="MS-HKWD" CONTENT="ON.RECALC function"><META NAME="MS-HKWD" CONTENT="operations, running on recalculation"><META NAME="MS-HKWD" CONTENT="recalculations, running macros on"><META NAME="MS-HKWD" CONTENT="sheet recalculation, running macros on"><META NAME="MS-HKWD" CONTENT="worksheet recalculation, running macros on"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    ON.RECALC</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Runs a macro when a specific sheet is recalculated. Use ON.RECALC to perform an operation on a sheet each time the sheet is recalculated, such as checking that a certain condition is still being met.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>ON.RECALC</B>(sheet_text, macro_text)</P>
<P CLASS="t">Sheet_text    is the name of a sheet, given as text. If sheet_text is omitted, the macro is run whenever any open sheet not specified by a previous ON.RECALC formula is recalculated. Only one ON.RECALC formula can be run for each recalculation.</P>
<P CLASS="t">Macro_text    is the name of, or an R1C1-style reference to, a macro you want to run when the sheet specified by sheet_text is recalculated. The name or reference must be in text form. The macro will be run each time the sheet is recalculated until ON.RECALC is cleared. If macro_text is omitted, recalculating reverts to its normal behavior, and any macros assigned by previous ON.RECALC functions are turned off.</P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">A macro specified to be run by ON.RECALC is not run by actions taken by other macros. For example, a macro specified by ON.RECALC will not be run after the CALCULATE.NOW function is carried out, but will be run if you change data in a sheet set to calculate automatically or choose the Calc Now button in the Calculation panel of the Options dialog box, which appears when you choose the Options command from the Tools menu.</P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">In Microsoft Excel for Windows, the following macro formula specifies that the macro Printer on the macro sheet AUTOREPT.XLS be run when the worksheet named REPORT.XLS is recalculated:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.RECALC("REPORT.XLS", "AUTOREPT.XLS!Printer")
</FONT></PRE>
<P CLASS="t">In Microsoft Excel for the Macintosh, the following macro formula turns off ON.RECALC for the workbook named SALES:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.RECALC("SALES")
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE8C0.HTM">CALCULATE.DOCUMENT</A>    Calculates the active document only</P>
<P><A class="normal" href="SE7B3.HTM">CALCULATE.NOW</A>    Calculates all open documents immediately</P>
<P><A class="normal" href="SE7B4.HTM">CALCULATION</A>    Controls calculation settings</P>
<P><A class="normal" href="SE87E.HTM">ON.ENTRY</A>    Runs a macro when data is entered</P>
<P>List of <A class="normal" href="SE744.HTM">Customizing Functions</A></P>
<P CLASS="t"></P></FONT>
</FONT></BODY></HTML>
