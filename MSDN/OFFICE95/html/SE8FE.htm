<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>QUERY.GET.DATA</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="building, queries"><META NAME="MS-HKWD" CONTENT="creating, queries"><META NAME="MS-HKWD" CONTENT="queries, building"><META NAME="MS-HKWD" CONTENT="QUERY.GET.DATA function"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    QUERY.GET.DATA</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Builds a new query using the supplied information. The application Microsoft Query nor any dialog boxes are displayed. Equivalent to choosing the Get External Data command from the Data menu when the Microsoft Query Add-in is installed.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>QUERY.GET.DATA</B>(<B>connection_string</B>,<B> query_text</B>, keep_query_def, field_names, row_numbers, destination)<BR><B>QUERY.GET.DATA?</B>(connection_string, query_text, keep_query_def, field_names, row_numbers, destination)</P>
<P CLASS="t">Connection_string    supplies information, such as the data source name, user ID, and passwords, necessary to making a SQL connection to an external data source. For example: "DSN=Myserver; Server=server1; UID=dbayer; PWD=buyer1; Database=nwind".</P>
<P></P>
<UL><LI>You must define the data source name (DSN) used in connection_string before you try to connect to it.</LI><LI>You can enter connection_string as an array or a string. If connection_string exceeds 250 characters, you must enter it as an array.</LI><LI>If QUERY.GET.DATA is unable to access the data source using connection_string, it returns the #N/A error value.</LI></UL><P></P>
<P CLASS="t">Query_text    is the SQL language query to be executed on the data source.</P>
<P CLASS="t">Keep_query_def    is a logical value that, if TRUE or omitted, preserves the query definition. If FALSE, the query definition is lost and the data from the query no longer constitutes a data range.</P>
<P CLASS="t">Field_names    is a logical value that, if TRUE or omitted, places field names from Microsoft Query into the first row of the data range. If FALSE, the field names are discarded.</P>
<P CLASS="t">Row_numbers    is a logical value that, if TRUE, places row numbers from Microsoft Query into the first column in the data range. If FALSE or omitted, the row numbers are discarded.</P>
<P CLASS="t">Destination    is the location as a cell reference where you want the data placed. If destination is in a current data range then that data range is changed to reflect the new SQL statement. The default destination is the currently selected cell or range.</P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>If the information provided is not sufficient to create the query then the error value #REF! is returned.</LI><LI>If the Microsoft Query Tool is unavailable or can not be found, #N/A is returned.</LI><LI>If connection string is longer than 255 characters, the string will be truncated at the last semi-colon.</LI></UL><P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE8FF.HTM">QUERY.REFRESH</A>    Refreshes the data in a data range returned by the Microsoft Query tool</P>
<P>List of <A class="normal" href="SE742.HTM">Command-Equivalent Functions</A></P>
<P CLASS="t"></P></FONT>
</FONT></BODY></HTML>
