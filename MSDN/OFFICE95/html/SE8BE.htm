<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADD.TOOL</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="ADD.TOOL function"><META NAME="MS-HKWD" CONTENT="adding buttons to toolbars"><META NAME="MS-HKWD" CONTENT="buttons, adding to toolbars"><META NAME="MS-HKWD" CONTENT="toolbars, adding buttons"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    ADD.TOOL</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Adds one or more buttons to a toolbar.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>ADD.TOOL</B>(<B>bar_id, position, tool_ref</B>)</P>
<P CLASS="t">Bar_id    is either a number specifying one of the built-in toolbars or the name of a custom toolbar.</P>
<P>Bar_id    Built-in toolbar</P>
<P CLASS="tr">    </P>
<P>1    Standard</P>
<P>2    Formatting</P>
<P>3    Query and Pivot</P>
<P>4    Chart</P>
<P>5    Drawing</P>
<P>6    TipWizard</P>
<P>7    Forms</P>
<P>8    Stop Recording</P>
<P>9    Visual Basic</P>
<P>10    Auditing</P>
<P>11    WorkGroup</P>
<P>12    Microsoft</P>
<P>13    Full Screen</P>
<P></P>
<P CLASS="t">Position    specifies the position of the button within the toolbar. Position starts with 1 at the left side (if horizontal) or at the top (if vertical).</P>
<P CLASS="t">Tool_ref    is either a number specifying a built-in button or a reference to an area on the macro sheet that defines a custom button or set of buttons (or an array containing this information). For a complete list of built-in buttons and their corresponding numbers, see Appendix D, "Toolbar Buttons in Microsoft Excel," in the Microsoft Excel Visual Basic User's Guide.</P>
<P CLASS="t">For customized buttons, the following example shows the components of a button reference area on a macro sheet and defines custom tools. The range A1:I5 is a valid tool_ref. Row 1 refers to a built-in tool. Row 2 defines a gap. For this illustration, values are displayed instead of formulas so that text can wrap in cells.</P>
<UL><LI><img src="amfaddto.gif"></LI><LI>Tool_id is a number associated with the tool. A zero specifies a gap on the toolbar. To specify a custom button, use a name, or a number between 201 and 231. For a complete list of built-in buttons and their corresponding numbers, see Appendix D, "Toolbar Buttons in Microsoft Excel," in the Microsoft Excel Visual Basic User's Guide.</LI><LI>Macro is the name of, or a quoted R1C1-style reference to, the macro you want to run when the button is clicked.</LI><LI>Down is a logical value specifying the default image of the tool. If down is TRUE, the button appears depressed into the screen; if FALSE or omitted, it appears normal (up).</LI><LI>Enabled is a logical value specifying whether the button can be used. If enabled is TRUE, the button is enabled; if FALSE, it is disabled.</LI><LI>Face specifies a face associated with the tool. Face must be a reference to a picture-type object, for example "Picture 1". If face is omitted, Microsoft Excel uses the default face for the tool.</LI><LI>Status_text is the text, if any, that you want displayed in the status bar when the button is selected.</LI><LI>Balloon_text is the balloon help text, if any, associated with the tool. Balloon_text is available only in Microsoft Excel for the Macintosh using system software version 7.0 or later.</LI><LI>Help_topics is a reference to a topic in a Help file, in the form "filename!topic_number". Help_topics must be text. If help_topics is omitted, HELP displays the Contents topic for Microsoft Excel Help.</LI><LI>Tip_text is the text, if any, that you want displayed as a ToolTip when the mouse pointer moves over a tool button.</LI></UL><P></P>
<P CLASS="t">To indicate that a particular component of tool_ref is not used, clear the contents of the corresponding cell.</P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>If you do not want to reserve a section of your macro sheet to define the buttons, you can use an array as the tool_ref argument as shown in the following syntax:
<P CLASS="lt1"><B>ADD.TOOL</B>(<B>bar_id, </B>position, {<B>tool_id</B><B>1</B><B>, </B>macro1, down1, enabled1, face1, <BR>status_text1, balloon_text1, help_topics1;tool_id2, macro2, down2, enabled2, <BR>face2, status_text2, balloon_text2, help_topics2;...})</P></LI><LI>Picture objects can be created with the camera button or pasted in from another application. In Microsoft Excel for Windows, the graphic object must be either a Windows bitmap or picture object. In Microsoft Excel for the Macintosh, the object must be a picture object.</LI></UL><P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">The following macro formula adds a button to Toolbar5. The cell range B6:I6 contains tool_ref.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ADD.TOOL("Toolbar5", 6, B6:I6)
</FONT></PRE>
<P CLASS="t">The following macro formula adds the New Macro Sheet button to the fifth position on the Standard toolbar:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ADD.TOOL(1, 5, 6)</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE7A3.HTM">ADD.COMMAND</A>    Adds a command to a menu</P>
<P><A class="normal" href="SE7A5.HTM">ADD.TOOLBAR</A>    Creates a toolbar with the specified tools</P>
<P><A class="normal" href="SE7C1.HTM">DELETE.TOOL</A>    Deletes a button from a toolbar</P>
<P><A class="normal" href="SE7C2.HTM">DELETE.TOOLBAR</A>    Deletes custom toolbars</P>
<P><A class="normal" href="SE7F6.HTM">RESET.TOOLBAR</A>    Resets a built-in toolbar to its default initial setting</P>
<P>List of <A class="normal" href="SE744.HTM">Customizing Functions</A></P></FONT>
</FONT></BODY></HTML>
