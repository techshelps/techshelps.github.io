<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Control Focus</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Setting Control Focus</H2><P CLASS="t">One way to make dialogs friendly is to write a small piece of code that intelligently moves the focus when a control is selected.  This "AutoFocus" code is helpful in the case where the user clicks an option button and there is an associated edit box as in the example below:  </P>
<P CLASS="t"><img src="20499.gif"></P>
<P CLASS="t">After selecting the Bin Width option button, the next logical thing is to enter the width value.  Here's how to set up an event procedure that automatically sets the focus on the edit box for the bin width.  In the dialog editor, select the control the user will click on (in this case the option button.)  Next, click on the View Code button on the forms toolbar <img src="20500.gif">.  Excel starts the code editor and positions the cursor in the event procedure for the control.  The code in Example 5 below does two things.  The first two lines of the procedure make some help text visible to explain what the option button does.  The third line sets the focus on the edit box.  </P>
<P CLASS="t">There's a lot of talk about repetitive-motion injuries among computer users these days.  Small touches like this can make working with an application not just easier, but safer too.  </P>
<P>'</P>
<P>' OptionBinWidth_Click Macro</P>
<P>'</P>
<P>'</P>
<P>Sub OptionBinWidth_Click()</P>
<P>    DialogSheets("Wiz3").[BinCountHelp].Visible = False</P>
<P>    DialogSheets("Wiz3").[BinWidthHelp].Visible = True</P>
<P>    DialogSheets("Wiz3").Focus = _ DialogSheets("Wiz3").[EditBinValue].Name</P>
<P>End Sub</P>
<P>Example 5.  AutoFocus code example</P></FONT>
</FONT></BODY></HTML>
