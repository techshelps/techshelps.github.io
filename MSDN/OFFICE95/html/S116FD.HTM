<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Environ Function</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H1><A NAME="sec244"></A>Environ Function</H1><P CLASS="t">  </P>
<H2><A NAME="sec245"></A>Description</H2><P>Returns the string associated with an operating system environment variable.</P>
<H2><A NAME="sec246"></A>Syntax</H2><P><B>Environ(</B>{<I>envstring</I> | <I>number</I>}<B>)</B></P>
<P>The <B>Environ </B>function syntax has these named arguments:</P>
<P CLASS="t">  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="80pt" VALIGN="TOP"><COL WIDTH="288pt" VALIGN="TOP"></COLGROUP><TBODY><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Part</B></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Description</B></P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><I>envstring</I></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">String expression containing the name of an environment variable.</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><I>number</I></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Numeric expression corresponding to the<I> </I>numeric order of the environment string in the environment-string table. The <I>number</I> argument can be any numeric expression, but is rounded to a whole number before it is evaluated.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H2><A NAME="sec247"></A>Remarks</H2><P>If <I>envstring</I> can’t be found in the environment-string table, a zero-length string is returned. Otherwise, <B>Environ</B> returns the text assigned to the specified <I>envstring</I>; that is, the text following the equal sign in the environment-string table for that environment variable.</P>
<P>If you specify <I>number</I>, the string occupying that numeric position in the environment-string table is returned. In this case, <B>Environ</B> returns all of the text, including <I>envstring</I>. If there is no environment string in the specified position,<B> Environ</B> returns a zero-length string ("").</P>
<H2><A NAME="sec248"></A>Example</H2><P>This example uses the <B>Environ</B> function to supply the entry number and length of the PATH statement from the environment-string table.</P>
<P CLASS="t">  </P>
<P CLASS="spacing"><BR></P>
<PRE>Dim EnvString, Indx, Msg, PathLen    ' Declare variables.= 1                ' Initialize index to 1.
    EnvString = Environ(Indx)    ' Get environment 
                    ' variable.
    If Left(EnvString, 5) = "PATH=" Then    ' Check PATH entry.
        PathLen = Len(Environ("PATH"))    ' Get length.
        Msg = "PATH entry = " &amp; Indx &amp; " and length = " &amp; PathLen
        Exit Do
    Else
        Indx = Indx + 1    ' Not PATH entry,
    End If            ' so increment.Until EnvString = ""PathLen &gt; 0 Then
    MsgBox Msg        ' Display message.
    MsgBox "No PATH environment variable exists."If
</PRE>
<P CLASS="t">  </P>
<P CLASS="t"> </P>
</FONT></FONT></BODY></HTML>
