<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FORMULA.ARRAY</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="array formulas"><META NAME="MS-HKWD" CONTENT="FORMULA.ARRAY function"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    FORMULA.ARRAY</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Enters a formula as an array formula in the range specified or in the current selection. Equivalent to entering an array formula while pressing CTRL+SHIFT+ENTER in Microsoft Excel for Windows or COMMAND+ENTER in Microsoft Excel for the Macintosh.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>FORMULA.ARRAY</B>(<B>formula_text, </B>reference)</P>
<P CLASS="t">Formula_text    is the text you want to enter in the array. For more information on formula_text, see the first form of FORMULA.</P>
<P CLASS="t">Reference    specifies where formula_text is entered. It can be a reference to a cell on the active worksheet or an external reference to a named workbook. Reference must be a R1C1-style reference in text form. If reference is omitted, formula_text is entered in the active cell.</P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">If the selection is D25:E25, the following macro formula enters the array formula {=D22:E22+D23:E23} in the range D25:E25:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA.ARRAY("=R[-3]C:R[-3]C[1]+R[-2]C:R[-2]C[1]")
</FONT></PRE>
<P CLASS="t">Regardless of the selection, the following macro formula enters the array formula {=D22:E22+D23:E23} in the range D25:E25:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">FORMULA.ARRAY("=R[-3]C:R[-3]C[1]+R[-2]C:R[-2]C[1]", "R25C4:R25C5")
</FONT></PRE>
<P CLASS="t">To use FORMULA.ARRAY to put an array in a specific workbook, specify the name of the workbook as an external reference in the reference argument. Using "[SALES.XLS]North!R25C3:R25C4" as the reference argument in the preceding example would enter the array in cells C25:D25 on the worksheet named North in the workbook SALES.XLS. Using "SALES!R25C3:R25C4" as the reference argument would enter the array in the same cells in the worksheet named SALES.</P>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE7D8.HTM">FORMULA</A>    Enters values into a cell or range or onto a chart</P>
<P><A class="normal" href="SE7DC.HTM">FORMULA.FILL</A>    Enters a formula in the specified range</P>
<P>List of <A class="normal" href="SE742.HTM">Command-Equivalent Functions</A></P></FONT>
</FONT></BODY></HTML>
