<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddMenu Action</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<H1>AddMenu Action</h1>

<H2>Description</h2>

<p class="t">The AddMenu action can be used to:</p>
<SPAN CLASS="list">
<ul>
    <li><SPAN CLASS="Symbol"></SPAN> Create a custom menu bar for a form or report. The
        custom menu bar replaces the built-in menu bar for the
        form or report.</li>
    <li><SPAN CLASS="Symbol"></SPAN> Create a custom shortcut menu for a form, form control,
        or report. The custom shortcut menu replaces the built-in
        shortcut menu for the form, form control, or report.</li>
    <li><SPAN CLASS="Symbol"></SPAN> Create a global menu bar. The global menu bar replaces
        the built-in menu bar for all Microsoft Access windows,
        except where you have added a custom menu bar for a form
        or report.</li>
    <li><SPAN CLASS="Symbol"></SPAN> Create a global shortcut menu. The global shortcut menu
        replaces the built-in shortcut menu for all Microsoft
        Access windows, except where you have added a custom
        shortcut menu for a form, form control, or report.</li>
</ul>
</SPAN>
<H2>Setting</h2>

<p class="t">The AddMenu action uses the following arguments.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Action argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Menu Name</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the drop-down menu to add to
        the custom menu bar or global menu bar. This is a
        required argument for custom menu bars and global menu
        bars. This argument is ignored for custom shortcut menus
        and global shortcut menus.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Menu Macro Name</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the macro group that
        contains the macros for the menu&#146;s commands. This is
        a required argument.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">If you run a macro containing the
        AddMenu action in a library database, Microsoft Access
        looks for the macro group with this name in the current
        database only.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Status Bar Text</td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The text to display in the status bar
        when the menu is selected. This argument is ignored for
        custom shortcut menus and global shortcut menus.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<H2>Remarks</h2>

<p class="t">To create a custom menu bar, a custom shortcut menu,
a global menu bar, or a global shortcut menu, you must do the
following:</p>
<SPAN CLASS="list">
<ol>
    <li>Create a menu bar macro that contains an AddMenu action
        for each drop-down menu you want on the custom menu bar
        or global menu bar. For custom shortcut menus and global
        shortcut menus, the menu bar macro should contain just
        one AddMenu action.</li>
    <li>Assign commands to each drop-down menu by creating a
        macro group for each menu. Each command runs the set of
        actions defined by a macro in this macro group. For
        custom shortcut menus and global shortcut menus, create
        just one macro group, in which each macro contains the
        set of actions for one of the commands in the shortcut
        menu.</li>
    <li>Attach the menu bar macro to the appropriate Microsoft
        Access object: <ul>
            <li><SPAN CLASS="Symbol"></SPAN> For custom menu bars, enter the name of the menu
                bar macro in the <b>MenuBar</b> property for the
                form or report.</li>
            <li><SPAN CLASS="Symbol"></SPAN> For custom shortcut menus, enter the name of the
                menu bar macro in the <b>ShortcutMenuBar</b>
                property for the form, form control, or report.</li>
            <li><SPAN CLASS="Symbol"></SPAN> For global menu bars, click Startup on the Tools
                menu, then in the Startup dialog box enter the
                name of the menu bar macro in the Shortcut Menu
                Bar box.</li>
            <li><SPAN CLASS="Symbol"></SPAN> For global shortcut menus, click Startup on the
                Tools menu, then in the Startup dialog box enter
                the name of the menu bar macro in the Shortcut
                Menu Bar box.</li>
        </ul>
    </li>
</ol>
</SPAN>
<p class="nt"><b>Tip</b> You can use the Menu Builder to create
any of the custom or global menu bars and shortcut menus by
clicking the Build button next to the property box or Startup
dialog option box where you specify the menu bar macro. The Menu
Builder creates and names the menu bar macro and the macro groups
containing the actions for the menu commands and subcommands on
the menu you create. If you use the Menu Builder to create the
menu bar macro and the macro groups for the menus, you can also
use the Menu Builder to edit these macros and macro groups.</p>

<p class="nt">However, if you create the custom menu bar or
custom shortcut menu in the Macro window, you can&#146;t use the
Menu Builder to edit the menu bar macro and macro groups because
the Menu Builder places restrictions on the names it uses for the
menu bar macro and macro groups, and on the kinds of actions it
uses in the macros.</p>

<p class="nt">For global shortcut menus and custom shortcut
menus, add only one menu in the Menu Builder. Any additional
menus are ignored.</p>

<p class="t">Each menu on the menu bar requires a separate
AddMenu action.</p>

<p class="t">The custom and global menu bars and shortcut menus
replace the built-in menu bars and shortcut menus for the objects
they&#146;re attached to. If you want to retain certain Microsoft
Access commands to use on these menus, use the DoMenuItem action
to put the commands into the macro groups for the desired menus.</p>

<p class="t">You can run a macro from a menu command by using the
RunMacro action in the macro for the command.</p>

<p class="nt"><b>Note</b> AddMenu actions can be used only in a
menu bar macro specified by the <b>MenuBar</b> or <b>ShortcutMenuBar</b>
property of a form, form control, or report, or by the Menu Bar
box or Shortcut Menu Bar box in the Startup dialog box, available
by clicking Startup on the Tools menu. Menu bar macros should
contain only AddMenu actions.</p>

<p class="t">You can create a submenu for a custom menu or a
custom shortcut menu by using the AddMenu action in a macro group
specified by the Menu Macro Name argument. If you put an AddMenu
action in such a macro group, Microsoft Access creates a submenu
with the menu name and status bar text specified by the Menu Name
and Status Bar Text arguments for this AddMenu action. The
submenu contains the commands defined by the macros in the macro
group specified by the Menu Macro Name argument for the AddMenu
action. The Menu Name and Status Bar Text columns of such an
AddMenu action are ignored, since this action defines a submenu,
not a command on the top-level menu. You can create multiple
levels of submenus by using AddMenu actions in the macro groups
for each level of menu.</p>

<p class="t">Macro conditions are supported in the top-level menu
bar macro only. In other words, you can use a condition in a menu
bar macro to determine if a particular menu will be displayed on
the custom menu bar or global menu bar, but only for the menus on
the top level of the menu bar. You can&#146;t use conditions to
display or hide commands or submenus on the menus. You can also
use a condition to hide or show a custom shortcut menu or global
shortcut menu.</p>

<p class="nt"><b>Note</b> In Microsoft Access version 2.0, if you
used the AddMenu action to put the Add-Ins submenu on the File
menu of a custom menu bar, Microsoft Access automatically added
the appropriate Add-Ins submenu items to your custom menu. In
Microsoft Access for Windows 95, the Add-Ins submenu has moved to
the Tools menu. Microsoft Access adds the submenu items to this
menu as before. However, it will not add the submenu items to an
Add-Ins submenu on the File menu of a custom menu bar or global
menu bar. If you had an Add-Ins submenu on one or more of your
custom menu bars in version 2.0, you may want to rewrite your
macros and move the Add-Ins submenu to the Tools menu.</p>

<p class="t">The AddMenu action isn&#146;t available in Visual
Basic. You can, however, set the <b>MenuBar</b> or <b>ShortcutMenuBar</b>
property in Visual Basic to attach a custom menu bar or custom
shortcut menu to a form, form control, or report. You can set the
<b>StartupMenuBar</b> property (the programmatic equivalent of
setting the Menu Bar box) to create a global menu bar. You can
also set the <b>MenuBar</b> property of the <b>Application</b>
object to create a global menu bar. Similarly, you can set the <b>StartupShortcutMenuBar</b>
property (the programmatic equivalent of setting the Shortcut
Menu Bar box) or the <b>ShortcutMenuBar</b> property of the <b>Application</b>
object to create a global shortcut menu.</p>

<H2>See Also</h2>

<p class="t"><b>Application</b> Object, <b>Event</b> Properties, <b>MenuBar</b>
Property, <b>ShortcutMenuBar</b> Property, <b>StartupMenuBar</b>
Property, <b>StartupShortcutMenuBar</b> Property.</p>
</FONT></FONT></BODY>
</html>
