<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL.RETRIEVE.TO.FILE</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="files, query results in"><META NAME="MS-HKWD" CONTENT="query results"><META NAME="MS-HKWD" CONTENT="results, queries"><META NAME="MS-HKWD" CONTENT="retrieving, query results, to files"><META NAME="MS-HKWD" CONTENT="SQL.RETRIEVE.TO.FILE function"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    SQL.RETRIEVE.TO.FILE</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Retrieves all of the results from a previously executed query and places them in a file. The connection used must have already been established using the macro function SQL.OPEN. Also, a query must already have been executed using SQL.EXEC.QUERY and results must be pending.</P>
<P CLASS="t">If this function is not available, you must install the Microsoft ODBC add-in (XLODBC.XLA).</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SQL.RETRIEVE.TO.FILE</B>(<B>connection_num</B>, <B>destination</B>, col_names_logical, column_delimiter)</P>
<P CLASS="t">Connection_num    is the unique connection ID for a data source. The data source specified must have query results pending. Pending results were generated by a previous call to SQL.EXEC.QUERY on the same connection.</P>
<UL><LI>If there are no pending results on the connection SQL.RETRIEVE.TO.FILE returns the #N/A error value. The file is not affected.</LI><LI>If connection_num is not valid, SQL.RETRIEVE.TO.FILE returns the #VALUE! error value.</LI></UL><P></P>
<P CLASS="t">Destination    specifies the name and path of the file where the results should be placed. SQL.RETRIEVE.TO.FILE will open the specified file and fill it with the entire result set.</P>
<UL><LI>The format of the data in the file will be compatible with the Microsoft Excel ".CSV" format. The overall format will be that columns will be separated by the value in column_delimiter (see below) and the individual rows will be separated by a linefeed/carriage-return.</LI><LI>If the file specified by destination cannot be opened then the error value #N/A will be returned by SQL.RETRIEVE.TO.FILE.</LI><LI>If the file already exists its previous contents will be overwritten by SQL.RETRIEVE.TO.FILE.</LI></UL><P></P>
<P CLASS="t">Col_names_logical    is a logical value that, if TRUE, allows the column names to be returned as the first row of data. If FALSE or omitted, the column names will not be returned.</P>
<P CLASS="t">Column_delimiter    is the value that will be used to separate the elements in each row. If column_delimiter is omitted then a tab will be used. If another value is desired then it should be enclosed in quotation marks. Possible values for column_delimiter might be: "," or ";" or " ". The string "tab" can also be used to specify a tab separator (even though this is redundant, since a tab is the default).</P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>If SQL.RETRIEVE.TO.FILE is unable to retrieve the results on the specified connection then an error value will be returned. In such a case SQL.RETRIEVE.TO.FILE will place error information in memory for the SQL.ERROR function, if such information is available.</LI><LI>If SQL.RETRIEVE.TO.FILE is able to successfully return rows of results on the specified connection and place them in a file it will return the number of rows that were actually written to the file. If there were no results pending on the connection then SQL.RETRIEVE.TO.FILE  will return the #N/A error value and the file will not be created or modified.</LI><LI>Before calling SQL.RETRIEVE.TO.FILE a connection must be established with a data source using SQL.OPEN.</LI><LI>A successful call to SQL.OPEN returns a unique connection ID number, which can be used in a call to SQL.EXEC.QUERY to send a SQL language query. Following this call to SQL.EXEC.QUERY, SQL.RETRIEVE.TO.FILE uses the same connection ID number to retrieve query results and place them in a file.</LI></UL><P CLASS="h"><B>Example</B></P>
<P CLASS="t">SQL.RETRIEVE.TO.FILE(conn1,"C:\MSQUERY\RESULTS1.QRY",TRUE,",") retrieves the results of a previously executed query and places them in the file RESULTS1.QRY, with column names that are comma deliminated.</P>
<P></P>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE913.HTM">SQL.OPEN</A>    Establishes a connection with a data source</P>
<P><A class="normal" href="SE911.HTM">SQL.EXEC.QUERY</A>    Sends a query to a data source</P>
<P><A class="normal" href="SE90E.HTM">SQL.BIND</A>    Specifies storage for a result column</P>
<P><A class="normal" href="SE914.HTM">SQL.RETRIEVE</A>    Retrieves query results</P>
<P><A class="normal" href="SE912.HTM">SQL.GET.SCHEMA</A>    Gets information about a connected data source.</P>
<P><A class="normal" href="SE90F.HTM">SQL.CLOSE</A>    Closes a data source connection</P>
<P><A class="normal" href="SE910.HTM">SQL.ERROR</A>    Returns detailed errorinformation</P>
<P>List of <A class="normal" href="SE742.HTM">Command-Equivalent Functions</A></P>
<P CLASS="t"></P></FONT>
</FONT></BODY></HTML>
