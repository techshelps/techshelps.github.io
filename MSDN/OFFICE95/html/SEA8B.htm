<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Auto_Close Procedures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H2>Auto_Close Procedures</H2><P CLASS="t">An Auto_Close procedure runs just before the workbook containing the procedure closes. You can use this feature to restore menu bars, toolbars, and other elements of the user interface to their previous condition and to save and close the files that support an application.</P>
<P CLASS="t">You can also use an Auto_Close procedure to ensure an orderly disconnection from another application. For example, if your application uses Windows Terminal to download stock quotations from a remote information service, you probably want Terminal to log off from the service before you close the workbook, as shown in the following procedure.</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">Sub Auto_Close()
    MenuBars(xlWorksheet).Menus("Tools"). _
        MenuItems("My Analysis").Delete
    CloseLogFile            'Procedure: close transaction file.
    DisconnectService    'Procedure: disconnect info service.
End Sub
</FONT></PRE></FONT>
</FONT></BODY></HTML>
