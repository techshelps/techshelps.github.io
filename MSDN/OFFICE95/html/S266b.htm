<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPISendMail</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H3 CLASS="h2">MAPISendMail</H3><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>MAPISendMail(</B><I>Session</I><B>, </B><I>UIParam</I><B>, </B><I>Subject$</I><B>, </B><I>NoteText$</I><B>, </B><I>Flags</I><B>, </B><I>Reserved</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Sends a mail message, allowing greater flexibility than <B>MapiSendDocuments</B><BR>in message generation. This function sends the current outbound message as a standard mail message. It can, if you choose, prompt for user input with a dialog box or proceed without any user interaction.</P>
<P CLASS="t">You can optionally provide a list of subject or note text when you call <B>MAPISendMail</B>. The <B>MAPISendMail</B> function uses the recipients and file attachments that you previously specified with the <B>MAPISetRecipient</B>, <B>MAPISetRecipientList</B>, or <B>MAPISetAttachment</B> functions.</P>
<P CLASS="t">If you provide recipient names, file attachments, or note text, the function can send the files or note without prompting users. If the optional arguments are specified and a dialog box is requested with the MAPI_DIALOG flag, the arguments provide the initial values for the Send Note dialog box.</P>
<P CLASS="t">File attachments are copied to the message before the function returns; therefore, later changes to the files do not affect the contents of the message. The files must be closed when they are copied.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Session</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">An opaque session handle whose value represents a session with the messaging system. If the value is 0 (zero), the messaging system sets up a session either from a system default session (if one exists) or by presenting a log-in dialog box. In all cases, the messaging system returns to its state before the call.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>UIParam</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The parent window handle for the dialog box. A value of 0 (zero) specifies that any dialog box displayed is application modal.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Subject$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The subject text, limited to 256 characters. An empty string ("") indicates no subject text. Some implementations may truncate subject lines that are too long or contain carriage returns, linefeeds, or other control characters.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>NoteText$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A string containing the text of the message. An empty string ("") indicates no text. The implementation wraps lines as appropriate. Implementations may place limits on the size of the text. A return<BR>of MAPI_E_TEXT_TOO_LARGE is generated if this limit is exceeded.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Flags</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A bitmask of flags. Unspecified flags should always be set to<BR>0 (zero). Undocumented flags are reserved. The following flags<BR>are defined:</P>
<P CLASS="ct">MAPI_LOGON_UI&nbsp;=&nbsp;1<BR>MAPI_NEW_SESSION&nbsp;=&nbsp;2<BR>MAPI_DIALOG&nbsp;=&nbsp;8</P>
<P CLASS="tt">Set MAPI_LOGON_UI if the function should display a dialog box to prompt for log-in (if required). When this flag is not set, the function does not display a dialog box and returns an error if the user is not logged in.</P>
<P CLASS="tt">Set MAPI_NEW_SESSION if you want to establish a session other than the current one. For instance, if a mail client is already running, another MAPI e-mail client can piggyback on the session created by the mail client application. Do not set this flag if you want the default session (if it still exists). If the session passed in <I>Session</I> is not 0 (zero), this flag is ignored.</P>
<P CLASS="tt">Set MAPI_DIALOG if the function should display a dialog box to prompt the user for recipients and other sending options. When you do not set this flag, the function does not display a dialog box, but at least one recipient must be specified.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Reserved</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">Reserved for future use. This argument must be 0 (zero).</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The following table lists the possible return values of the <B>MAPISendMail</B> function and their meanings.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="35pt" VALIGN="TOP"><COL WIDTH="165pt" VALIGN="TOP"><COL WIDTH="146pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Value</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Name</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Meaning</B></P></FONT></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–21</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_AMBIGUOUS_RECIPIENT</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A recipient matched more than one of the recipient descriptor types, and MAPI_DIALOG was not set. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–11</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_ATTACHMENT_<BR>NOT_FOUND</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The specified attachment was not found. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–15</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_BAD_RECIPTYPE</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The type of a recipient was not MAPI_TO, MAPI_CC, or MAPI_BCC. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–4</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_DISK_FULL</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The disk was full. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–2</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_FAILURE</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">One or more unspecified errors occurred while sending the mail. No mail was sent.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="35pt" VALIGN="TOP"><COL WIDTH="165pt" VALIGN="TOP"><COL WIDTH="146pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Value</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Name</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Meaning</B></P></FONT></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–5</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_INSUFFICIENT_MEMORY</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">There was insufficient memory<BR>to proceed. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–19</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_INVALID_SESSION</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">An invalid session handle was used for the <I>Session</I> argument. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–3</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_LOGIN_FAILURE</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">There was no default log-in,<BR>and the user failed to log in successfully when the log-in dialog box was displayed. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–18</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_TEXT_TOO_LARGE</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The text in the message was too large to be sent. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–9</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_TOO_MANY_FILES</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">There were too many file attachments. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–10</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_TOO_MANY_RECIPIENTS</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">There were too many message recipients specified. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–8</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_TOO_MANY_SESSIONS</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The user had too many sessions open at once. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–14</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_E_UNKNOWN_RECIPIENT</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The recipient did not appear in the address list. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">–1</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">MAPI_USER_ABORT</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The user canceled the process from the send dialog box. No mail was sent.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">0</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">SUCCESS_SUCCESS</P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The function returned successfully.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">The following example sends a message to two unresolved recipients. <B>MAPISendMail</B> will return an error if the names cannot be resolved unambiguously.</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN
MAPI_LOGON_UI&nbsp;=&nbsp;1
Session&nbsp;=&nbsp;MAPILogon(0, "", "", MAPI_LOGON_UI, 0)
result&nbsp;=&nbsp;MAPISetRecipient(1, "Anne Gabor", "")
result&nbsp;=&nbsp;MAPISetRecipient(2, "Roger Selva", "")
result&nbsp;=&nbsp;MAPISendMail(Session, 0, "Monthly Summary",\
    "We will quickly satisfy all orders for clamps.", 0, 0)
result&nbsp;=&nbsp;MAPILogoff(Session, 0, 0, 0)
End Sub
</PRE>
<P CLASS="t">The following example prepares a message for sending to two recipients, then displays the Send Note dialog box to allow the user to modify, cancel, or send the message.</P>
<P CLASS="spacing"><BR></P>
<PRE>Sub MAIN
MAPI_LOGON_UI&nbsp;=&nbsp;1
Session&nbsp;=&nbsp;MAPILogon(0, "", "", MAPI_LOGON_UI, 0)
Dim MessageID$
result&nbsp;=&nbsp;MAPISetRecipient(1, "Phillipe Tran", "AF:TBU/WGAM/PHILT")
result&nbsp;=&nbsp;MAPISetRecipient(1, "Patricia Loren", "AF:TBU/WGAM/PATL")
MAPI_DIALOG&nbsp;=&nbsp;8
result&nbsp;=&nbsp;MAPISendMail(Session, 0, "Monthly Summary",\
    "We will quickly satisfy all orders for clamps.", MAPI_DIALOG, 0)
result&nbsp;=&nbsp;MAPILogoff(Session, 0, 0, 0)
End Sub
</PRE></FONT></FONT></BODY></HTML>
