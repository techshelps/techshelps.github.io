<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CurrentObjectType, CurrentObjectName Properties</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<H1>CurrentObjectType, CurrentObjectName Properties</h1>

<h2><a name="sec281"></a>Applies To</h2>

<p><b>Application</b> Object.</p>

<h2><a name="sec282"></a>Description</h2>

<p>You can use the <b>CurrentObjectType</b> and<b>
CurrentObjectName</b> properties together with the <b>Application</b>
object to determine the type of the active database object
(table, query, form, report, macro, or module) and the name of
the active database object.</p>

<h2><a name="sec283"></a>Setting</h2>

<p>The <b>CurrentObjectType</b> property is set by Microsoft
Access to one of the following Microsoft Access intrinsic
constants.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Setting</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acTable</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a table.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acQuery</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a query.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acForm</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a form.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acReport</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a report.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acMacro</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a macro.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><b>acModule</b></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a module.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<p>The <b>CurrentObjectName</b> property is set by Microsoft
Access to a string expression containing the name of the active
object.</p>

<p>These property settings are available only in Visual Basic and
are read-only in all views.</p>

<h2><a name="sec284"></a>Remarks</h2>

<p>The following conditions determine which object is considered
the active object:</p>
<SPAN CLASS="list">
<ul>
    <li><SPAN CLASS="Symbol"></SPAN> If the user chooses the property sheet, toolbar, menu,
        palette, or the field list of an object, the <b>CurrentObjectType</b>
        and <b>CurrentObjectName</b> properties return the type
        and name of the underlying object.</li>
    <li><SPAN CLASS="Symbol"></SPAN> If the user chooses a pop-up form, the <b>CurrentObjectType</b>
        and <b>CurrentObjectName</b> properties refer to the
        pop-up form itself, not the form from which it was
        opened.</li>
    <li><SPAN CLASS="Symbol"></SPAN> If the active object is the Database window, the <b>CurrentObjectType</b>
        and <b>CurrentObjectName</b> properties return the item
        selected in the Database window.</li>
    <li><SPAN CLASS="Symbol"></SPAN> If no object is selected, the <b>CurrentObjectType</b>
        property returns <b>True</b> (-1), and the <b>CurrentObjectName</b>
        property returns a zero-length string (&quot; &quot;).</li>
    <li><SPAN CLASS="Symbol"></SPAN> If the current state is ambiguous (the active object
        isn&#146;t a table, query, form, report, macro, or
        module) &#151; for example, if a dialog box has the focus
        &#151; the <b>CurrentObjectType</b> property returns <b>True</b>,
        and the <b>CurrentObjectName</b> property returns the
        dialog box name.</li>
</ul>
</SPAN>
<p>You can use these properties with the <b>SysCmd</b> function
to determine the active object and its state (for example, if the
object is open, new, or has been changed but not saved).</p>

<h2><a name="sec285"></a>See Also</h2>

<p><b>Application</b> Object, <b>SysCmd</b> Function.</p>

<h2><a name="sec286"></a>Example</h2>

<p>The following example uses the <b>CurrentObjectType</b> and <b>CurrentObjectName</b>
properties with the <b>SysCmd</b> function to determine if the
active object is the Products form and if this form is open and
has been changed but not saved. If these conditions are true, the
form is saved and then closed.</p>

<p class="spacing"><br>
</p>

<pre>Sub CheckProducts()
    Dim intState As Integer
    Dim intCurrentType As Integer
    Dim strCurrentName As String
    intCurrentType = Application.CurrentObjectType
    strCurrentName = Application.CurrentObjectName
    If intCurrentType = acForm And strCurrentName = &quot;Products&quot; Then
        intState = SysCmd(acSysCmdGetObjectState, intCurrentType, _
                strCurrentName)
        ' Products form changed but not saved.
        If intState = acObjStateDirty + acObjStateOpen Then
            ' Close Products form and save changes.
            DoCmd.Close intCurrentType, strCurrentName, acYes
        End If
    End IfSub
</pre>
</FONT></FONT></BODY>
</html>
