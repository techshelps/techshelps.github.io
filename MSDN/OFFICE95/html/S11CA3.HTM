<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenQuery Action</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H1><A NAME="sec230"></A>OpenQuery Action</H1><P CLASS="t">  </P>
<H2><A NAME="sec231"></A>Description</H2><P>You can use the OpenQuery action to open a select or crosstab query in Datasheet view, Design view, or Print Preview. This action runs an action query. You can also select a data entry mode for the query.</P>
<H2><A NAME="sec232"></A>Setting</H2><P>The OpenQuery action uses the following arguments.</P>
<P CLASS="t">  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="118pt" VALIGN="TOP"><COL WIDTH="250pt" VALIGN="TOP"></COLGROUP><TBODY><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Action argument</B></P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t"><B>Description</B></P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Query Name</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The name of the query to open. The Query Name box in the Action Arguments section of the Macro window shows all queries in the current database. This is a required argument.</P>
<P CLASS="t">If you run a macro containing the OpenQuery action in a library database, Microsoft Access looks for the query with this name first in the library database, then in the current database.</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">View</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The view in which the query will open. Click Datasheet, Design, or Print Preview in the View box. The default is Datasheet.</P></TD></TR><TR><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">Data Mode</P></TD><td VALIGN="TOP">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P CLASS="t">The data entry mode for the query. This applies only to queries opened in Datasheet view. Click Add (the user can add new records but can’t edit existing records), Edit (the user can edit existing records and add new records), or Read Only (the user can only view records). The default is Edit.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H2><A NAME="sec233"></A>Remarks</H2><P>If you click Datasheet for the View argument, Microsoft Access displays the result set if the query is a select, crosstab, union, or pass-through query whose <B>ReturnsRecords</B> property is set to Yes; and it runs the query if it’s an action, data-definition, or pass-through query whose <B>ReturnsRecords</B> property is set to No.</P>
<P>The OpenQuery action is similar to choosing the Open button or Design button in the Database window after selecting a query in the Queries tab. With this action you can select additional options.</P>
<P></P>
<P CLASS="t">  </P>
<P><B>Tip</B>   You can select a query in the Database window and drag it to a macro action row. This automatically creates an OpenQuery action that opens the query in Datasheet view.</P>
<P CLASS="t">  </P>
<P></P>
<P>Switching to Design view while the query is open removes the Data Mode argument setting for the query. This setting isn’t in effect even if the user returns to Datasheet view.</P>
<P></P>
<P CLASS="t">  </P>
<P><B>Tip</B>   If you don’t want to display the system messages that normally appear when an action query is run (indicating it is an action query and showing how many records will be affected), you can use the SetWarnings action to suppress the display of these messages.</P>
<P CLASS="t">  </P>
<P></P>
<P>To run the OpenQuery action in Visual Basic, use the <B>OpenQuery</B> method of the <B>DoCmd</B> object.</P>
<H2><A NAME="sec234"></A>See Also</H2><P><B>OpenQuery</B> Method, RunSQL Action, SetWarnings Action</P>
<P CLASS="t"> </P>
</FONT></FONT></BODY></HTML>
