<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLOpen</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">


<FONT FACE="ARIAL,HELVETICA" SIZE="2"><H3 CLASS="h2">SQLOpen</H3><P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>SQLOpen(</B><I>Connect$</I><B>, </B><I>Output$</I><B>, </B><I>DriverPrompt</I><B>)</B></P>
<P CLASS="h"><B>Remarks</B></P>
<P CLASS="t">Establishes a connection with a data source. A connection established with <B>SQLOpen</B> can be used throughout a macro until the connection is closed with <B>SQLClose</B>. Note that <B>SQLOpen</B> can prompt the user for additionally needed connection information.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Connect$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">The information necessary to establish a connection to a data source. Note that any data-source name that is used in <I>Connect$</I> must be an existing data-source name defined with ODBC Setup or the ODBC Administration Utility. For more information on how to define data-source names, see "Setting Up Data Sources" earlier in this appendix.</P>
<P CLASS="tt">Note that <I>Connect$</I> should follow the format described in the Help file for the appropriate ODBC driver. This string may require the data-source name, one or more user IDs, one or more passwords, and any other information necessary to successfully connect to the particular DBMS.</P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>Output$</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A predefined string variable where you want the completed connection string to be placed. If <I>Output$</I> is omitted, a completed connection string will not be returned.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="thf"><B>Argument</B></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="th"><B>Explanation</B></P></FONT></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tr"></P></FONT></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt"><I>DriverPrompt</I></P></FONT></TD><TD VALIGN="TOP"><FONT FACE="ARIAL,HELVETICA" SIZE="2"><P CLASS="tt">A number from 1 to 4 specifying if, and how, the driver should display prompts. This sets the fDriverCompletion flag in the ODBC API SQLDriverConnect function.</P>
<P CLASS="tt">1    Always display a dialog box. The flag is set to SQL_DRIVER_PROMPT.</P>
<P CLASS="tt">2    Display a dialog box only if there is not enough information to connect. The driver uses information from the connection string and from the data source specification as its defaults. The flag is set to SQL_DRIVER_COMPLETE.</P>
<P CLASS="tt">3    Same as 2, but the driver grays and disables any unnecessary prompts. The flag is set to SQL_DRIVER_COMPLETE_REQUIRED.</P>
<P CLASS="tt">4    If the connection string is unsuccessful, do not display a dialog box. The flag is set to SQL_DRIVER_NOPROMPT.</P></FONT></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">If the connection is successfully established, <B>SQLOpen</B> returns a connection<BR>ID number. Use the connection ID number with other functions to reference that connection.</P>
<P CLASS="t">If <B>SQLOpen</B> is unable to connect with the information provided, it returns the error value 0 (zero). In such cases, and if more information is available, <B>SQLOpen</B> places error information in memory for the error functions to return,<BR>if such information is available.</P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">This example uses <B>SQLOpen</B> to create a connection to a Microsoft Access data source without displaying unnecessary prompts.</P>
<P CLASS="spacing"><BR></P>
<PRE>connect_num = SQLOpen("mydata.mdb", output_string$, 2)
</PRE>
<P CLASS="t">The following example uses <B>SQLOpen</B> with a complex <I>Connect$</I>.</P>
<P CLASS="spacing"><BR></P>
<PRE>connect_num = SQLOpen("DSN = MyServer; UID = dbayer; PWD = 123; \
    Database = pubs", output_string$, 1)
</PRE></FONT></FONT></BODY></HTML>
