<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ON.KEY</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><META NAME="MS-HKWD" CONTENT="key combinations, running macros on"><META NAME="MS-HKWD" CONTENT="keystrokes, running macros on"><META NAME="MS-HKWD" CONTENT="macros, running on key combinations"><META NAME="MS-HKWD" CONTENT="ON.KEY function"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><body bgcolor="#FFFFFF" link=#003399 vlink=#996699>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><FONT FACE="Verdana, Arial, Hevetica" SIZE="2">

<H1>    ON.KEY</H1><P CLASS="t">Macro Sheets Only</P>
<P CLASS="t">Runs a specified macro when a particular key or key combination is pressed.</P>
<P CLASS="h"><B>Syntax</B></P>
<P CLASS="syn"><B>ON.KEY</B>(<B>key_text, </B>macro_text)</P>
<P CLASS="t">Key_text    can specify any single key, or any key combined with ALT, CTRL, or SHIFT, or any combination of those keys (in Microsoft Excel for Windows) or COMMAND, CTRL, OPTION, or SHIFT or any combination of those keys (in Microsoft Excel for the Macintosh). Each key is represented by one or more characters, such as "a" for the character a, or "{ENTER}" for the ENTER key.</P>
<P CLASS="t">To specify characters that aren't displayed when you press the key, such as ENTER or TAB, use the codes shown in the following table. Each code in the table represents one key on the keyboard.</P>
<P>Key    Code</P>
<P CLASS="tr">    </P>
<P>BACKSPACE    "{BACKSPACE}" or "{BS}"</P>
<P>BREAK    "{BREAK}"</P>
<P>CAPS LOCK    "{CAPSLOCK}"</P>
<P>CLEAR    "{CLEAR}"</P>
<P>DELETE or DEL    "{DELETE}" or "{DEL}"</P>
<P>DOWN    "{DOWN}"</P>
<P>END    "{END}"</P>
<P>ENTER (numeric keypad)    "{ENTER}"</P>
<P>ENTER    "~" (tilde)</P>
<P>ESC    "{ESCAPE} or {ESC}"</P>
<P>HELP    "{HELP}"</P>
<P>HOME    "{HOME}"</P>
<P>INS    "{INSERT}"</P>
<P>LEFT    "{LEFT}"</P>
<P>NUM LOCK    "{NUMLOCK}"</P>
<P>PAGE DOWN    "{PGDN}"</P>
<P>PAGE UP    "{PGUP}"</P>
<P>RETURN    "{RETURN}"</P>
<P>RIGHT    "{RIGHT}"</P>
<P>SCROLL LOCK    "{SCROLLLOCK}"</P>
<P>TAB    "{TAB}"</P>
<P>UP    "{UP}"</P>
<P>F1 through F15    "{F1}" through "{F15}"</P>
<P CLASS="t"></P>
<P CLASS="t">In Microsoft Excel for Windows, you can also specify keys combined with SHIFT and/or CTRL and/or ALT. In Microsoft Excel for the Macintosh, you can also specify keys combined with SHIFT and/or CTRL and/or OPTION and/or COMMAND. To specify a key combined with another key or keys, use the following table.</P>
<P>To combine with    Precede the key code by</P>
<P CLASS="tr">    </P>
<P>SHIFT    "+" (plus sign)</P>
<P>CTRL    "^" (caret)</P>
<P>ALT or OPTION    "%" (percent sign)</P>
<P>COMMAND    "*" (asterisk)</P>
<P CLASS="t"></P>
<P CLASS="t">To assign a macro to one of the special characters (+, ^, %, and so on), enclose the character in brackets. For example, ON.KEY("^{+}", "InsertItem") assigns a macro named InsertItem to the key sequence CTRL+PLUS SIGN.</P>
<P CLASS="t">Macro_text    is the name of a macro that you want to run when key_text is pressed. The reference must be in text form.</P>
<UL><LI>If macro_text is "" (empty text), nothing happens when key_text is pressed. This form of ON.KEY disables the normal meaning of keystrokes in Microsoft Excel.</LI><LI>If macro_text is omitted, key_text reverts to its normal meaning in Microsoft Excel, and any special key assignments made with previous ON.KEY functions are cleared.</LI></UL><P></P>
<P CLASS="h"><B>Remarks</B></P>
<UL><LI>ON.KEY remains in effect until you clear it or quit Microsoft Excel. You can clear ON.KEY by specifying key_text and omitting the macro_text argument.</LI><LI>If the macro sheet containing macro_text is closed when you press key_text, an error is returned.</LI><LI>If another macro is running when you press key_text, macro_text will not run.</LI></UL><P></P>
<P CLASS="h"><B>Examples</B></P>
<P CLASS="t">Suppose you wanted the key combination SHIFT+CTRL+RIGHT to run the macro Print. You use the following macro formula:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.KEY("+^{RIGHT}", "Print")
</FONT></PRE>
<P CLASS="t">To return SHIFT+CTRL+RIGHT to its normal meaning, you would use the following macro formula:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.KEY("+^{RIGHT}")
</FONT></PRE>
<P CLASS="t">To disable SHIFT+CTRL+RIGHT altogether, you would use the following macro formula:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="Courier" SIZE="2">ON.KEY("+^{RIGHT}", "")
</FONT></PRE>
<P CLASS="h"><B>Related Functions</B></P>
<P><A class="normal" href="SE815.HTM">CANCEL.KEY</A>    Disables macro interruption</P>
<P><A class="normal" href="SE754.HTM">ERROR</A>    Specifies what action to take if an error is encountered while a macro is running</P>
<P><A class="normal" href="SE899.HTM">SEND.KEYS</A>    Sends a key sequence to an application</P>
<P>List of <A class="normal" href="SE744.HTM">Customizing Functions</A></P></FONT>
</FONT></BODY></HTML>
