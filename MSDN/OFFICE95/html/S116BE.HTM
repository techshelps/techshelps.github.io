<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso8859-1">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DVar, DVarP Functions</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">

<FONT FACE="Verdana, Arial, Hevetica" SIZE="2"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<H1>DVar, DVarP Functions</h1>

<h2><a name="sec182"></a>Description</h2>

<p>You can use the <b>DVar</b> and <b>DVarP</b> functions to
estimate variance across a set of values in a specified set of
records (domain). Use <b>DVar</b> and <b>DVarP</b> in a macro or
module, in a query expression, or in a calculated control on a
form or report.</p>

<p>Use <b>DVarP</b> to evaluate variance across a population, and
<b>DVar</b> to evaluate variance across a population sample.</p>

<p>For example, you could use the <b>DVar</b> function to
calculate the variance across a set of students&#146; test
scores.</p>

<h2><a name="sec183"></a>Syntax</h2>

<p><b>DVar(</b><i>expr</i>, <i>domain</i>[, <i>criteria</i>]<b>)DVarP(</b><i>expr</i>,
<i>domain</i>[, <i>criteria</i>]<b>)</b></p>

<p>The <b>DVar</b> and <b>DVarP</b> functions use the following
arguments.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</b></td>
        <td><b>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</b></td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>expr</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Expression that identifies the numeric
        field on which you want to find the variance. It can be a
        string expression identifying a field from a table or
        query, or it can be an expression that performs a
        calculation on data in that field. You can include in <i>expr
        </i>the name of a table field, a control on a form, a
        constant, or a function. If <i>expr </i>includes a
        function, it can be either built-in or user-defined, but
        not another domain aggregate or SQL aggregate function.
        Any field included in <i>expr </i>must be a numeric
        field.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>domain</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">String expression identifying the set of
        records that constitutes the domain. It can be a table
        name or a query name.</td>
    </tr>
    <tr>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><i>criteria</i></td>
        <td valign="top">
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional string expression used to
        restrict the range of data on which <b>DVar</b> or <b>DVarP</b>
        is performed. For example, <i>criteria</i> is often
        equivalent to the WHERE clause in an SQL expression,
        without the word WHERE. If <i>criteria</i> is omitted, <b>DVar</b>
        and <b>DVarP</b> evaluate <i>expr </i>against the entire
        domain. Any field included in <i>criteria</i> must also
        be a field in <i>domain</i>; otherwise <b>DVar</b> and <b>DVarP</b>
        return a <b>Null</b>.</td>
    </tr>
</TBODY></table>

<p class="spacing"><br>
</p>

<p><b>DVar</b> and <b>DVarP</b> find the variance of a set of
values defined by <i>expr</i> in the table or query referred to
by <i>domain</i>, according to any restrictions specified by <i>criteria</i>.</p>

<p>If <i>domain</i> refers to fewer than two records or if fewer
than two records satisfy <i>criteria</i>, <b>DVar</b> and <b>DVarP</b>
return a <b>Null</b>, indicating that a variance can&#146;t be
calculated.</p>

<p>Whether you use <b>DVar</b> or <b>DVarP</b> in a macro or
module, a query expression, or a calculated control, you must
construct the <i>criteria</i> argument carefully to ensure that
it will be evaluated correctly.</p>

<p>You can use <b>DVar</b> and <b>DVarP</b> to specify criteria
in the Criteria row of a select query; in a calculated field
expression in a query; or in the Update To row of an update
query.</p>

<p><b>Note</b> You can use <b>DVar</b> and <b>DVarP</b> or <b>Var</b>
and <b>VarP</b> in a calculated field expression in a totals
query. If you use<b> DVar</b> or <b>DVarP</b>, values are
calculated before data is grouped. If you use <b>Var</b> or <b>VarP</b>,
the data is grouped before values in the field expression are
evaluated.</p>

<p>Use <b>DVar</b> and <b>DVarP</b> in a calculated control when
you need to specify <i>criteria </i>to restrict the range of data
on which the function is performed. For example, to display a
variance for orders to be shipped to California, set the <b>ControlSource</b>
property of a text box to the following expression.</p>

<p class="spacing"><br>
</p>

<pre>= DVar(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipRegion] = 'CA'&quot;)
</pre>

<p>If you simply want to find the standard deviation across all
records in <i>domain</i>, use the <b>Var</b> or <b>VarP</b>
function.</p>

<p><b>Note</b> Unsaved changes to records in <i>domain</i> are
not included when you use these functions. If you want the <b>DVar</b>
or <b>DVarP</b> function to be based on the changed values, you
must first save the changes by choosing the Save Record command
from the File menu, moving the focus to another record, or using
the <b>Update</b> method.</p>

<h2><a name="sec184"></a>See Also</h2>

<p>Domain Aggregate Functions.</p>

<h2><a name="sec185"></a>Example</h2>

<p>This example returns estimates of the variance for a
population and a population sample for orders shipped to the
United Kingdom. The domain is an Orders table. The <i>criteria</i>
argument restricts the resulting set of records to those for
which ShipCountry equals UK.</p>

<p class="spacing"><br>
</p>

<pre>Dim dblX As Double, dblY As Double
' Sample estimate.= DVar(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipCountry] = 'UK'&quot;)
' Population estimate.= DVarP(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipCountry] = 'UK'&quot;)
</pre>

<p>The next example returns estimates using a variable,
strCountry, in the <i>criteria </i>argument. Note that single
quotation marks (') are included in the string expression, so
that when the strings are concatenated, the string literal UK
will be enclosed in single quotation marks.</p>

<p class="spacing"><br>
</p>

<pre>Dim strCountry As String, dblX As Double= &quot;UK&quot;= DVar(&quot;[Freight]&quot;, &quot;Orders&quot;, &quot;[ShipCountry] = '&quot; _
    &amp; strCountry &amp; &quot;'&quot;)</pre>
</FONT></FONT></BODY>
</html>
