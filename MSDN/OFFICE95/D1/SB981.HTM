<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CompactDatabase Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>CompactDatabase Method</H2>Applies To</P>
<B>DBEngine </B>Object.</P>
Description</P>
Copies, compacts, and gives you the option of changing the version, collating order, and encryption of a closed database.</P>
Syntax</P>
<B>DBEngine.CompactDatabase </B><I>olddb</I>, <I>newdb</I> [, <I>locale </I>[, <I>options</I> [, <SPAN CLASS="Symbol">ú</SPAN>;<B>pwd=</B><I>password</I>]]]</P>
<P></P>
The <B>CompactDatabase</B> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="233pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Part</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><I>olddb</I></P></TD><TD VALIGN="TOP">A string expression that identifies an existing, closed database. It can be a full path and filename, such as "C:\MYDB.mdb". If the filename has an extension, you must specify it. If your network supports it, you can also specify a network path, such as "\\MYSERVER\MYSHARE\MYDIR\MYDB.mdb".</P></TD></TR><TR><TD VALIGN="TOP"><I>newdb</I></P></TD><TD VALIGN="TOP">A string expression that is the full path of the compacted database that you're creating. You can also specify a network path as with <I>olddb</I>. You can't use the <I>newdb</I> argument to specify the same database file as <I>olddb</I>.</P></TD></TR><TR><TD VALIGN="TOP"><I>locale</I></P></TD><TD VALIGN="TOP">A string expression used to specify collating order for creating <I>newdb</I>, as specified in Settings. If you omit this argument, the locale of <I>newdb</I> is the same as <I>olddb</I>.</P></TD></TR><TR><TD VALIGN="TOP"><I>options</I></P></TD><TD VALIGN="TOP">An integer that indicates one or more options, as specified in Settings. You can combine options by summing the corresponding constants.</P></TD></TR><TR><TD VALIGN="TOP"><I>password</I></P></TD><TD VALIGN="TOP">An optional string argument containing a password, if the database is password protected. The string ";pwd=" must precede the actual password.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
Settings</P>
You can use one of the following constants for the <I>locale</I> argument to specify the <B>CollatingOrder</B> property for string comparisons of text.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="233pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Constant</P></TD><TD VALIGN="TOP">Collating order</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangGeneral</B></P></TD><TD VALIGN="TOP">English, German, French, Portuguese, Italian, and Modern Spanish</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangArabic</B></P></TD><TD VALIGN="TOP">Arabic</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangCyrillic</B></P></TD><TD VALIGN="TOP">Russian </P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangCzech</B></P></TD><TD VALIGN="TOP">Czech</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangDutch</B></P></TD><TD VALIGN="TOP">Dutch</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangGreek</B></P></TD><TD VALIGN="TOP">Greek</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangHebrew</B></P></TD><TD VALIGN="TOP">Hebrew</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangHungarian</B></P></TD><TD VALIGN="TOP">Hungarian</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangIcelandic</B></P></TD><TD VALIGN="TOP">Icelandic</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangNordic</B></P></TD><TD VALIGN="TOP">Nordic languages (Microsoft Jet database engine version 1.0 only)</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangNorwdan</B></P></TD><TD VALIGN="TOP">Norwegian and Danish</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="233pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Constant</P></TD><TD VALIGN="TOP">Collating order</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangPolish</B></P></TD><TD VALIGN="TOP">Polish</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangSpanish </B></P></TD><TD VALIGN="TOP">Traditional Spanish </P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangSwedfin</B></P></TD><TD VALIGN="TOP">Swedish and Finnish</P></TD></TR><TR><TD VALIGN="TOP"><B>dbLangTurkish</B></P></TD><TD VALIGN="TOP">Turkish</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
You can use one of the following constants in the <I>options</I> argument to specify whether to encrypt or to decrypt the database as it's compacted.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="233pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Constant</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>dbEncrypt</B></P></TD><TD VALIGN="TOP">Encrypt the database while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><B>dbDecrypt</B></P></TD><TD VALIGN="TOP">Decrypt the database while compacting.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
If you omit an encryption constant or if you include both <B>dbDecrypt</B> and <B>dbEncrypt</B>, newdb will have the same encryption as olddb.</P>
You can use one of the following constants in the <I>options</I> argument to specify the version of the data format for the compacted database. This constant affects only the version of the data format of <I>newdb</I> and doesn't affect the version of any Microsoft Access-defined objects, such as forms and reports.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="233pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Constant</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>dbVersion10</B></P></TD><TD VALIGN="TOP">Creates a database that uses the Microsoft Jet database engine version 1.0 while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><B>dbVersion11</B></P></TD><TD VALIGN="TOP">Creates a database that uses the Jet database engine version 1.1 while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><B>dbVersion20</B></P></TD><TD VALIGN="TOP">Creates a database that uses the Jet database engine version 2.0 while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><B>dbVersion30</B></P></TD><TD VALIGN="TOP">Creates a database that uses the Jet database engine version 3.0 while compacting.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
You can specify only one version constant. If you omit a version constant, <I>newdb</I> will have the same version as <I>olddb</I>. You can compact <I>newdb </I>only to a version that is the same or later than that of <I>olddb</I>.</P>
Remarks</P>
As you change data in a database, the database file can become fragmented and use more disk space than necessary. Periodically, you can compact your database to defragment the database file. The compacted database is usually smaller and often runs faster. You can also choose to change the collating order, the encryption, or the version of the data format while you copy and compact the database.</P>
The <B>CompactDatabase</B> method copies all the data and the security permissions settings from the database specified by <I>olddb</I> to the database specified by <I>newdb</I>. In the process, the data in the compacted database is organized contiguously to recover disk space.</P>
<P></P>
You must close <I>olddb</I> before you compact it. In a multiuser environment, other users can't have <I>olddb</I> open while you're compacting it. If <I>olddb </I>isn't closed or isn't available for exclusive use, an error occurs.</P>
Because <B>CompactDatabase</B> creates a copy of the database, you must have enough disk space for both the original and the duplicate databases. The compact operation fails if there isn't enough disk space available. The <I>newdb </I>duplicate database doesn't have to be on the same disk as <I>olddb</I>. After successfully compacting a database, you can delete the <I>olddb</I> file and rename the compacted <I>newdb </I>file to the original filename.</P>
See Also</P>
<B>CollatingOrder </B>Property,<B> CreateDatabase </B>Method,<B> Database </B>Object.</P>
Specifics (Microsoft Access)</P>
The <B>CompactDatabase</B> method won't completely convert a Microsoft Access database from one version to another. Only the data format is converted. Microsoft Access-defined objects, such as forms and reports, aren't converted.</P>
Use the Convert Database command on the File menu to convert Microsoft Access databases from an earlier version to the current version.</P>
Example</P>
This example uses <B>CompactDatabase</B> to compact a database and keeps a backup copy of the original database. The new database has the same locale as the source database, but is encrypted.</P>
<BR></P>
<PRE>DBEngine.CompactDatabase "C:\Biblio.mdb","C:\BibNew.mdb","",dbEncrypt
...
Kill "C:\Biblio.BAK"
Name "C:\Biblio.mdb" As "C:\BIBLIO.BAK"
Name "C:\BibNew.mdb" As "C:\Biblio.mdb"
</PRE>
This example copies a database named Northwind.mdb and keeps a new, compacted copy named COPY.NEW. The new database is encrypted.</P>
<BR></P>
<PRE>DBEngine.CompactDatabase "C:\Northwind.mdb", "C:\Copy.NEW","",dbEncrypt

</PRE>
</P></BODY>
</HTML>
