<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RepairDatabase Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>RepairDatabase Method</H2>Applies To</P>
<B>DBEngine </B>Object.</P>
Description</P>
Attempts to repair a corrupted database that accesses the Microsoft Jet database engine.</P>
<P></P>
Syntax</P>
<B>DBEngine.RepairDatabase </B><I>dbname</I></P>
The <I>dbname</I> placeholder represents a string expression that is the path and filename for an existing Jet engine database file. If you omit the path, only the current directory is searched. If your system supports the uniform naming convention (UNC), you can also specify a network path, such as: "\\MYSERVER\MYSHARE\MYDIR\MYDB.mdb".</P>
Remarks</P>
You must close the database specified by <I>dbname</I> before you repair it. In a multiuser environment, other users can't have <I>dbname</I> open while you're repairing it. If <I>dbname </I>isn't closed or isn't available for exclusive use, an error occurs.</P>
This method attempts to repair a database that was marked as possibly corrupt by an incomplete write operation. This can occur if an application using the Jet database engine is closed unexpectedly because of a power outage or computer hardware problem. The database won't be marked as possibly corrupt if you use the <B>Close</B> method or if you quit your application in a usual way.</P>
The <B>RepairDatabase</B> method also attempts to validate all system tables and all indexes. Any data that can't be repaired is discarded. If the database can't be repaired, a trappable error occurs.</P>
When you attempt to open or compact a corrupted database, a trappable error usually occurs. In some situations, however, a corrupted database may not be detected, and no error occurs. It's a good idea to provide your users with a way to use the <B>RepairDatabase</B> method in your application if their database behaves unpredictably.</P>
Some types of databases can become corrupted if a user ends an application without closing <B>Database</B> or <B>Recordset </B>objects<B> </B>and the Jet database engine; Microsoft Windows or MS-DOS&reg; doesn't have a chance to flush data caches. To avoid corrupt databases, establish procedures for closing applications and shutting down systems that ensure that all cached pages are saved to the database. In some cases, power supplies that can't be interrupted may be necessary to prevent accidental data loss during power fluctuations.</P>
<P></P>
Tip</P>
After repairing a database, it's also a good idea to compact it using the <B>CompactDatabase</B> method to defragment the file and to recover disk space.</P>
<P></P>
See Also</P>
<B>Close </B>Method,<B> CompactDatabase </B>Method,<B> Database </B>Object.</P>
Example</P>
This example attempts to repair a database named Northwind.mdb.</P>
<BR></P>
<PRE>DBEngine.RepairDatabase "C:\Northwind.mdb"
</PRE>
<P></P></BODY>
</HTML>
