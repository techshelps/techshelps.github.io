<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">

<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Execute Method</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->




<H2>

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Execute Method</h2>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Applies To</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>Database </b>Object,<b>
QueryDef </b>Object.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Description</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Runs an action query or
executes an SQL statement on a specified <b>Database</b> object.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Syntax</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<i>database</i><b>.Execute </b><i>source</i>[,
<i>options</i>] </p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<i>querydef</i><b>.Execute </b>[<i>options</i>]
</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

For a <b>Database</b> object,
the <b>Execute</b> method syntax has these parts.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Part</strong></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Description</strong></td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<i>database</i></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

The name of the <b>Database</b>
        object on which the query will run.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<i>source</i></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

The SQL statement
        or <b>QueryDef</b> object.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<i>options</i></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

An integer constant
        that determines the data integrity characteristics of the
        query, as specified in Settings.</td>
    </tr>
</table>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

For a <b>QueryDef</b> object,
the <b>Execute</b> method syntax has these parts.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Part</strong></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Description</strong></td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<i>querydef</i></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

The name of the <b>QueryDef</b>
        object whose <b>SQL</b> property setting specifies the
        SQL statement to execute.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<i>options</i></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

An integer constant
        that determines the data integrity characteristics of the
        query, as specified in Settings.</td>
    </tr>
</table>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Settings</strong></p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

You can use the following
constants for the <i>options</i> part.</p>

<table border="0" cellpadding="7" cols="2">
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Constant</strong></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Description</strong></td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>dbDenyWrite</b></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Deny write
        permission to other users.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>dbInconsistent</b></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

(Default)
        Inconsistent updates.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>dbConsistent</b></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Consistent updates.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>dbSQLPassThrough</b></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

SQL pass-through.
        Causes the SQL statement to be passed to an ODBC database
        for processing.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>dbFailOnError</b></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Rolls back updates
        if an error occurs.</td>
    </tr>
    <tr>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>dbSeeChanges</b></td>
        <TD valign="top">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Generates a
        run-time error if another user is changing data you are
        editing.</td>
    </tr>
    

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

</TBODY>
</table>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Remarks</strong></p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

The <b>Execute</b> method is
valid only for action queries. If you use <b>Execute</b> with
another type of query, an error occurs. Because an action query
doesn't return any records, <b>Execute</b> doesn't return a
recordset.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Tips</strong></p>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<SPAN CLASS="list">

<ul>
    <li>

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Given a syntactically correct SQL
        statement and proper permissions, the <b>Execute</b>
        method won't fail &#151; even if not a single row can be
        modified or deleted. Therefore, always use the <b>dbFailOnError</b>
        option when using the <b>Execute</b> method to run an
        update or delete query. This option generates a trappable
        error and rolls back all successful changes if any of the
        records affected are locked and can't be updated or
        deleted.</li>
    <li>

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

For best performance, especially in
        a multiuser environment, nest the <b>Execute</b> method
        inside a transaction: Use the <b>BeginTrans</b> method on
        the current <b>Workspace</b> object, then use the <b>Execute</b>
        method, and complete the transaction by using the <b>CommitTrans
        </b>method on the <b>Workspace</b>. This saves changes on
        disk and frees any locks placed while the query was
        running.</li>
</ul>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

</SPAN>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Use the <b>RecordsAffected</b>
property of the <b>Database</b> or <b>QueryDef</b> object to
determine the number of records affected by the most recent <b>Execute</b>
method. For example, <b>RecordsAffected</b> contains the number
of records deleted, updated, or inserted when executing an action
query. When you use the <b>Execute</b> method to run a <b>Querydef</b>,
the <b>RecordsAffected</b> property of the <b>QueryDef</b> object
is set to the number of records affected.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

If both <b>dbInconsistent</b>
and <b>dbConsistent</b> are included or if neither is included,
the result is the default.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

Using <b>Execute</b> on a query
that selects records produces an error.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>Execute</b> doesn't return a
recordset.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>See Also</strong></p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<b>RecordsAffected </b>Property.</p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Example</strong></p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

This example uses a <b>Data</b>
control to execute an action query that updates all titles that
have no value in the ISBN column in the Titles table. If there is
an error, all changes are rolled back. </p>

<br>
</p>

<pre>Dim strSQL as String
strSQL = &quot;DELETE FROM Titles WHERE ISBN IS NULL&quot;
dbsBiblio.Execute strSQL, dbFailOnError
</pre>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<strong>Example (Microsoft
Access)</strong></p>



	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

The following example executes
an action query and prints the number of records affected.</p>

<br>
</p>

<pre>Sub RecordsUpdated()
    Dim dbs As Database, qdf As QueryDef
    Dim strSQL As String
    
    ' Return Database variable pointing to current database.
    Set dbs = CurrentDb
    strSQL = &quot;UPDATE Employees SET Title = &quot; &amp; _
        &quot;'Senior Sales Representative' &quot; &amp; _
            &quot;WHERE Title = 'Sales Representative';&quot;
    ' Create new QueryDef.
    Set qdf = dbs.CreateQueryDef(&quot;UpdateTitles&quot;, strSQL)
    ' Execute QueryDef.
    qdf.Execute
    Debug.Print qdf.RecordsAffected
End Sub
</pre>
</BODY>

</html>
