<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">

<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Move Method</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->




<H2>Move Method</h2>

Applies To</p>

Dynaset-Type <b>Recordset </b>Object,<b> Recordset </b>Object,<b>
</b>Snapshot-Type <b>Recordset </b>Object,<b> </b>Table-Type <b>Recordset
</b>Object.</p>

Description</p>

Moves the position of the current record in a <b>Recordset</b>
object.</p>

Syntax</p>

<i>recordset</i><b>.Move </b><i>rows</i>[, <i>start</i>]</p>

The <b>Move</b> method syntax has these parts.</p>

<table border="0" cellpadding="7" cols="2">
<COLGROUP><COL WIDTH="70pt" VALIGN="TOP"><COL WIDTH="278pt" VALIGN="TOP"></COLGROUP><TBODY>    <tr>
        <TD valign="top">Part</td>
        <TD valign="top">Description</td>
    </tr>
    <tr>
        <TD valign="top" colspan="2">&nbsp;</td>
    </tr>
    <tr>
        <TD valign="top"><i>recordset</i></td>
        <TD valign="top">The name of the <b>Recordset</b> object
        whose current record position is being moved.</td>
    </tr>
    <tr>
        <TD valign="top"><i>rows</i></td>
        <TD valign="top">A signed <b>Long</b> value specifying
        the number of rows the position will move. If <i>rows</i>
        is greater than 0, the position is moved forward (toward
        the end of the file). If <i>rows</i> is less than 0, the
        position is moved backward (toward the beginning of the
        file).</td>
    </tr>
    <tr>
        <TD valign="top"><i>start</i></td>
        <TD valign="top">A <b>String</b> value identifying a
        bookmark. If <i>start </i>is specified, the move begins
        relative to this bookmark. If <i>start </i>is not
        specified, <b>Move</b> begins from the current record.</td>
    </tr>
</TBODY></table>

<br>
</p>

Remarks</p>

If using <b>Move</b> would move the position of the
current record to a position before the first record, the
position is moved to the beginning-of-file (BOF) position. If the
<b>Recordset</b> contains no records and its <b>BOF</b> property
is set to <b>True</b>, using this method to move backward
produces a trappable run-time error. If either the <b>BOF</b> or <b>EOF</b>
property is <b>True</b> and you attempt to use the <b>Move</b>
method without a valid bookmark, a trappable error is triggered.</p>

If using <b>Move</b> would move the position of the
current record to a position after the last record, the position
is moved to the end-of-file (EOF) position. If the <b>Recordset </b>is
based on a query, then this approach forces the query to be run
on the specified number of rows. If the <b>Recordset</b> contains
no records and its <b>EOF</b> property is set to <b>True</b>,
then using this method to move forward produces a trappable
run-time error.</p>

Notes</p>
<SPAN CLASS="list">
<ul>
    <li>When you use <b>Move</b> on a forward-only scrolling
        snapshot, the <i>rows</i> argument must be a positive
        integer and bookmarks aren't allowed. This means you can
        only move forward.</li>
    <li>To make the first, last, next, or previous record in a <b>Recordset
        </b>the current record, use the <b>MoveFirst</b>, <b>MoveLast</b>,
        <b>MoveNext</b>, or <b>MovePrevious</b> method.</li>
</ul>
</SPAN>
See Also</p>

<b>BOF</b>,<b> EOF </b>Properties;<b> Bookmark </b>Property;<b>
MoveFirst</b>,<b> MoveLast</b>,<b> MoveNext</b>,<b> MovePrevious </b>Methods.</p>

Specifics (Microsoft Access)</p>

When you use a bookmark in a Microsoft Access
module, you must include an <b>Option Compare Binary</b>
statement in the Declarations section of the module. A bookmark
is a <b>Variant</b> array of <b>Byte</b> data, so the string
comparison method for the module must be binary. If a bookmark is
evaluated with a text-based string comparison method, such as the
<b>Option Compare Text</b> statement or the default setting for
the <b>Option Compare Database</b> statement, the current record
may be set to an incorrect record.</p>

Example</p>

This example creates a function that moves the
current record position in a <b>Recordset</b> forward or back a
specified number of records and provides an optional offset.</p>

<br>
</p>

<pre>Sub MoveRelative (lngDistance As Long, strDirection As String, _
    rstTarget As Recordset, varRelativeMark As Variant)
    Dim strHere As String
    strHere = rstTarget.Bookmark
    strDirection = UCase(strDirection)
    Select Case strDirection
        Case &quot;FWD&quot;:  lngDistance = Abs(lngDistance)
        Case &quot;BACK&quot;: lngDistance = Abs(lngDistance) * -1
        Case Else: MsgBox &quot;Incorrect calling argument&quot;
    End Select
    If UCase(varRelativeMark) = &quot;HERE&quot; Then</pre>

<br>
</p>

<pre>        rstTarget.Move lngDistance    ' Move current record position.
    Else
        ' Move relative to bookmark.
        rstTarget.Move lngDistance, varRelativeMark
    End If
    ' Move may not have been completed.
    If rstTarget.EOF Or rstTarget.BOF Then Beep
End Sub
</pre>

Example (Microsoft Access)</p>

The following example uses the <b>Move</b> method to
move forward two rows in a <b>Recordset</b> object.</p>

<br>
</p>

<pre>Sub MoveForward()
    Dim dbs As Database, rst As Recordset
    Dim strCriteria As String

    ' Return Database variable pointing to current database.
    Set dbs = CurrentDb
    ' Open Dynaset-Type Recordset object.
    Set rst = dbs.OpenRecordset(&quot;SELECT * FROM Orders &quot; &amp; _
        &quot;ORDER BY [ShipCountry];&quot;)
    rst.MoveFirst
    ' Check number of records in Recordset object.
    If rst.RecordCount &gt; 2 Then
        ' Move forward two rows.
        rst.Move 2
        Debug.Print rst!ShipCountry
    End If
End Sub
</pre>

Example (Microsoft Excel)</p>

This example prompts the user to select a record
number. The example then copies the selected record from the
Customer recordset in the NWINDEX.MDB database onto Sheet1.</p>

<br>
</p>

<pre>Dim db As Database, rs As Recordset
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; &quot;\NWINDEX.MDB&quot;)
Set rs = db.OpenRecordset(&quot;SELECT [CUSTMR_ID], [CONTACT], [REGION] &quot; _
    &amp; &quot;FROM Customer&quot;)
Sheets(&quot;Sheet1&quot;).Activate
aDistance = Application.InputBox(&quot;What record # you want to copy&quot;, Type:=2)
If aDistance = False Then    ' user cancelled InputBox
    Exit Sub
End If
rs.MoveFirst
rs.Move aDistance
For i = 0 To 2
    ActiveCell.Offset(, i).Value = rs.Fields(i).Value
Next
rs.Close
db.Close</pre>
</BODY>

</html>
