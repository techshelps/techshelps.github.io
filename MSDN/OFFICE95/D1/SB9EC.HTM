<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RecordsAffected Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>RecordsAffected Property</H2>Applies To</P>
<B>Database </B>Object,<B> QueryDef </B>Object.</P>
Description</P>
Returns the number of records affected by the most recently invoked <B>Execute</B> method.</P>
Return Values</P>
The return value is an integer from 0 to the number of records affected by the most recently invoked <B>Execute</B> method on either a <B>Database</B> or <B>QueryDef</B> object. The data type is <B>Long</B>.</P>
Remarks</P>
The <B>RecordsAffected</B> property contains the number of records deleted, updated, or inserted when running an action query. When you use the <B>Execute</B> method to run a <B>QueryDef</B> object, the <B>RecordsAffected</B> property setting is the number of records affected.</P>
<P></P>
Note</P>
The <B>RecordsAffected</B> property setting is the same as the value returned by the <B>ExecuteSQL</B> method.</P>
<P></P>
Example</P>
This example prints the number of records updated by an action query.</P>
<BR></P>
<PRE>Dim dbsBiblio As Database, lngResults As Long
Set dbsBiblio =  DBEngine.Workspaces(0).OpenDatabase("Biblio.mdb")
dbsBiblio.Execute "Update Titles Set [Year Published] = 1994 " _<BR>    &amp; " WHERE Title = 'To Kill an SQL Query' "
lngResults = dbsBiblio.RecordsAffected
Debug.Print lngResults &amp; " records were changed."
dbsBiblio.Close
</PRE>
Example (Microsoft Access)</P>
The following example prints the number of records updated by an action query.</P>
<BR></P>
<PRE>Sub RecordsUpdated()
    Dim dbs As Database, qdf As QueryDef
    Dim strSQL As String
    
    ' Return Database variable that points to current database.
    Set dbs = CurrentDb
    strSQL = "UPDATE Employees SET Title = " &amp; _<BR>        "'Senior Sales Representative' " &amp; _ <BR>        "WHERE Title = 'Sales Representative';"
    ' Create new QueryDef.
    Set qdf = dbs.CreateQueryDef("UpdateTitles", strSQL)
    ' Execute QueryDef object.
    qdf.Execute
    Debug.Print qdf.RecordsAffected
End Sub
<B></B></PRE>
<P></P></BODY>
</HTML>
