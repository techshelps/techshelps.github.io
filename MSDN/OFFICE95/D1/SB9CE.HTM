<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LockEdits Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>LockEdits Property</H2>Applies To</P>
Dynaset-Type <B>Recordset </B>Object,<B> Recordset </B>Object,<B> </B>Table-Type <B>Recordset </B>Object.</P>
Description</P>
Sets or returns a value indicating the locking that is in effect during editing.</P>
Settings and Return Values</P>
The setting or return value is a Boolean expression that indicates the type of locking. The data type is Boolean.</P>
The possible settings or return values are:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="249pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Setting/Value</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>True</B> (-1)</P></TD><TD VALIGN="TOP">(Default) Pessimistic locking is in effect. The 2K page containing the record you're editing is locked as soon as you use the <B>Edit</B> method.</P></TD></TR><TR><TD VALIGN="TOP"><B>False</B> (0)</P></TD><TD VALIGN="TOP">Optimistic locking is in effect for editing. The 2K page containing the record is not locked until the <B>Update</B> method is executed.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
Remarks</P>
You can use the <B>LockEdits</B> property with dynaset- and Table-Type <B>Recordset</B> objects.</P>
If a page is locked, no other user can edit records on the same page. If you set <B>LockEdits</B> to <B>True</B> and another user already has the page locked, an error occurs when you use the <B>Edit</B> method. Other users can read data from locked pages.</P>
If you set the <B>LockEdits</B> property to <B>False</B> and later use <B>Update</B> method while the page is locked by another user, an error occurs. To see the changes made to your record by another user, set the <B>Bookmark</B> property of your <B>Recordset</B> object to itself. This approach results in your changes being lost.</P>
When working with ODBC data sources, the <B>LockEdits</B> property is always set to <B>False</B>, or optimistic locking. The Microsoft Jet database engine has no control over the locking mechanisms used in external database servers.</P>
See Also</P>
<B>Bookmark </B>Property;<B> Close </B>Method;<B> FindFirst</B>,<B> FindLast</B>,<B> FindNext</B>,<B> FindPrevious </B>Methods;<B> IsolateODBCTrans </B>Property;<B> MoveFirst</B>,<B> MoveLast</B>,<B> MoveNext</B>,<B> MovePrevious </B>Methods.</P>
<P></P>
Example</P>
This example opens a Dynaset-Type <B>Recordset</B> and sets its <B>LockEdits</B> property to <B>False</B>. This enables optimistic locking so other users can change the database records at any time. Your application triggers a trappable error if the data changes before you use the <B>Update</B> method.</P>
<BR></P>
<PRE>Sub ShowLockStatus()
Dim dbsNorthwind As Database, rstCustomers As Recordset

Set dbsNorthwind =  DBEngine.Workspaces(0).OpenDatabase("Northwind.mdb")
Set rstCustomers = dbsNorthwind.OpenRecordset("Customers", dbOpenDynaset)
rstCustomers.LockEdits = True
OnError Goto ErrorHandler
rstCustomers.Edit    ' Start editing.
    On Error GoTo 0
    rstCustomers.CancelUpdate
    rstCustomers.Close
    dbsNorthwind.Close
    Exit Sub

ErrorHandler:
    If Err = 3197 Then
        Debug.Print "data changed"
        Resume Next
    Else
        Debug.Print "some other error"
        Resume Next
    End If
End Sub 
</PRE>
Example (Microsoft Access)</P>
The following example opens a Dynaset-Type <B>Recordset</B> object and sets its <B>LockEdits</B> property to <B>False</B> (0). This enables optimistic locking so other users can change the database records at any time. Microsoft Access triggers a trappable error if the data changes before you use the <B>Update</B> method.</P>
<BR></P>
<PRE>Sub ShowLockStatus()
    Dim dbs As Database, rst As Recordset

    ' Return Database variable that points to current database.
    Set dbs = CurrentDb
    Set rst = dbs.OpenRecordset("Customers", dbOpenDynaset)
    rst.LockEdits = False
    On Error Goto ErrorHandler
    ' Enable editing.
    rst.Edit
    .                    ' Change records.
    .
    .
    rst.Update            ' Try to post changes.
    rst.Close</PRE>
<P></P>
<BR></P>
<PRE>    Exit Sub
    ErrorHandler:
        If Err.Number = 3197 Then
            MsgBox "Data changed by another user."
            Resume Next
        Else
            MsgBox "Some other error."
        End If
End Sub
</PRE>
Example (Microsoft Excel)</P>
This example locks the Customer recordset in the NWINDEX.MDB database before updating the value in the CUSTMR_ID field of the first record with the value in cell A1 on Sheet1. Locking the recordset ensures that no other user modifies the record while it is being updated.</P>
To create the NWINDEX.MDB database, run the Microsoft Excel example for the <B>CreateDatabase </B>method.</P>
<BR></P>
<PRE>Dim db As Database, rs As Recordset
Sheets("Sheet1").Cells(1, 1).Value = "ACRIM"
databasePath = Application.Path &amp; "\NWINDEX.MDB"
Set db = DBEngine.Workspaces(0).OpenDatabase(databasePath)
Set rs = db.OpenRecordset("Customer")
valueToAdd = Sheets("Sheet1").Cells(1, 1).Value
rs.LockEdits = False
rs.Edit
rs.fields("CUSTMR_ID").Value = valueToAdd
rs.Update
MsgBox "The new value of CUSTMR_ID is " &amp; rs.fields("CUSTMR_ID").Value
rs.Close
db.Close
</PRE>
</P></BODY>
</HTML>
