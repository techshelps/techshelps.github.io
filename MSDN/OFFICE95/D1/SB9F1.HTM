<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RegisterDatabase Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>RegisterDatabase Method</H2>Applies To</P>
<B>DBEngine </B>Object.</P>
Description</P>
Enters connection information for an ODBC data source in the ODBC.INI file. The ODBC driver needs connection information when the Microsoft Jet database engine opens the data source during a session.</P>
Syntax</P>
<B>DBEngine.RegisterDatabase </B><I>dbname</I>, <I>driver</I>, <I>silent</I>, <I>attributes</I></P>
The <B>RegisterDatabase</B> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="70pt" VALIGN="TOP"><COL WIDTH="278pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Part</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><I>dbname</I></P></TD><TD VALIGN="TOP">A string expression that is the name used in the <B>OpenDatabase</B> method that refers to a block of descriptive information about the data source. For example, if the data source is an ODBC remote database, it could be the name of the server.</P></TD></TR><TR><TD VALIGN="TOP"><I>driver</I></P></TD><TD VALIGN="TOP">A string expression that is the name of the ODBC driver. This isn't the name of the ODBC driver DLL file. For example, SQL Server is a driver name, but SQLSRVR.dll is the name of a DLL file. You must have ODBC and the appropriate driver already installed.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="70pt" VALIGN="TOP"><COL WIDTH="278pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Part</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><I>silent</I></P></TD><TD VALIGN="TOP">A numeric expression that is <B>True</B> if you don't want to display the ODBC driver dialog boxes that prompt for driver-specific information or <B>False</B> if you do want to display the ODBC driver dialog boxes. If <I>silent</I> is <B>True</B>, <I>attributes</I> must contain all the necessary driver-specific information or the dialog boxes are displayed anyway.</P></TD></TR><TR><TD VALIGN="TOP"><I>attributes</I></P></TD><TD VALIGN="TOP">A string expression that is a list of keywords to be added to the ODBC.INI file. The keywords are in a carriage-return–delimited string.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
Remarks</P>
If the database is already registered (connection information is already entered) in the ODBC.INI file when you use the <B>RegisterDatabase</B> method, the connection information is updated.</P>
In 32-bit installations, most of the ODBC registration information is maintained in the Windows registration database and not in the ODBC.INI file.</P>
If the <B>RegisterDatabase</B> method fails for any reason, no changes are made to the ODBC.INI file, and an error occurs.</P>
For more information about ODBC drivers such as SQL Server, see the Help file provided with the driver.</P>
You are encouraged to use the Windows Control Panel ODBC setup icon to add new data sources, or to make changes to existing entries. However, if you choose to use the <B>RegisterDatabase</B> method, you are encouraged to set the <I>silent</I> option to <B>True</B>.</P>
See Also</P>
<B>Database </B>Object,<B> OpenDatabase </B>Method.</P>
Example</P>
This example registers a SQL Server data source named PtLudlow and then opens the database MySQLDb on that server. </P>
Using the Windows ODBC control panel icon is the preferred way to create, modify, or delete data source names. </P>
<BR></P>
<PRE>Dim dbsLudlow As Database
Dim strAttribs As String
' Build keywords string.
strAttribs = "Description=SQL Server on server PtLudlow" &amp; _<BR>    Chr$(13) &amp; "OemToAnsi=No" &amp; Chr$(13) &amp; "Network=DBNMP3" &amp; _<BR>    Chr$(13) &amp; "Address=\\PTLUDLOW\PIPE\SQL\QUERY" &amp; Chr$(13) &amp; _<BR>    "Database=MySQLDb"
' Update ODBC.INI.
DBEngine.RegisterDatabase "PtLudlow", "SQL Server 32", True, strAttribs
' Open the database.
Set dbsLudlow = DBEngine.Workspaces(0).OpenDatabase("PtLudlow", _<BR>    False, False, "ODBC;")
</PRE>
<P></P></BODY>
</HTML>
