<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PercentPosition Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>PercentPosition Property</H2>Applies To</P>
<B>Recordset </B>Object,<B> </B>Snapshot-Type <B>Recordset </B>Object,<B> </B>Table-Type <B>Recordset </B>Object.</P>
Description</P>
Sets or returns a value that indicates or changes the approximate location of the current record in the <B>Recordset</B> object based on a percentage of the records in the <B>Recordset</B>.</P>
Settings and Return Values</P>
The setting or return value is a number between 0.0 and 100.00. The data type is <B>Single</B>.</P>
Remarks</P>
To indicate or change the approximate position of the current record in a <B>Recordset</B> object, you can check or set the <B>PercentPosition</B> property. When working with a dynaset- or Snapshot-Type <B>Recordset</B> object, first populate the <B>Recordset</B> object by moving to the last record before you set or check the <B>PercentPosition</B> property. If you use the <B>PercentPosition</B> property before fully populating the <B>Recordset</B> object, the amount of movement is relative to the number of records accessed as indicated by the <B>RecordCount</B> property setting. You can move to the last record using <B>MoveLast</B> method.</P>
<P></P>
Note</P>
Using the <B>PercentPosition</B> property to move the current record to a specific record in a <B>Recordset</B> object isn't recommended — the <B>Bookmark</B> property is better suited for this task.</P>
<P></P>
Once you set the <B>PercentPosition</B> property to a value, the record at the approximate position corresponding to that value becomes current, and the <B>PercentPosition</B> property is reset to a value that reflects the approximate position of the current record. For example, if your <B>Recordset</B> object contains only five records, and you set its <B>PercentPosition</B> property value to 77, the value returned from the <B>PercentPosition</B> property may be 80, not 77.</P>
<P></P>
The <B>PercentPosition</B> property applies to all three types of <B>Recordset</B> objects, including tables without indexes. The only exceptions are that it does not apply to forward-only scrolling snapshots), or on a <B>Recordset</B> object opened from a pass-through query against a remote database.</P>
You can use the <B>PercentPosition</B> property with a scroll bar on a form or text box to indicate the location of the current record in a <B>Recordset</B> object.</P>
See Also</P>
<B>Bookmark </B>Property;<B> Index </B>Property;<B> Move </B>Method;<B> MoveFirst</B>,<B> MoveLast</B>,<B> MoveNext</B>,<B> MovePrevious </B>Methods.</P>
Example</P>
This example displays the current position of a record in a <B>Recordset</B> in a message box.</P>
<BR></P>
<PRE>Dim dbsNorthwind As Database, rstEmployees As Recordset
Set dbsNorthwind =  DBEngine.Workspaces(0).OpenDatabase("Northwind.mdb")
' Open table.
Set rstEmployees = dbsNorthwind.OpenRecordset("Employees")
' Set current index.
rstEmployees.Index = "Last Name"    
...
...    ' Move among the records.
...
' Display current position.
MsgBox("Current position is " &amp; rstEmployees.PercentPosition &amp; " %.")
</PRE>
Example (Microsoft Access)</P>
The following example expresses the current position of a record in a recordset as a percent, then displays it in a message box.</P>
<BR></P>
<PRE>Sub PercentOfRecords()
    Dim dbs As Database, rstProducts As Recordset
    Dim strInput As String, strSQL As String

    strSQL = "SELECT * FROM Products ORDER BY ProductName;"
    ' Return Database variable that points to current database.
    Set dbs = CurrentDb
    ' Open table.
    Set rstProducts = dbs.OpenRecordset(strSQL, dbOpenDynaset)
    ' Populate recordset.
    rstProducts.MoveLast
    ' Return to start of recordset.
    rstProducts.MoveFirst
    ' Prompt user to input name of product.
    strInput = InputBox("Please enter the full product name.")
    ' Find first occurrence.
    rstProducts.FindFirst "[ProductName] = '" &amp; strInput &amp; "'"
    ' Display current position as a percent.
    MsgBox("The current position in the Recordset is " &amp; _<BR>        rstProducts.PercentPosition &amp; "%.")
End Sub</PRE>
<P></P>
<BR></P>
<PRE></PRE>
Example (Microsoft Excel)</P>
This example selects and changes records in the Customer recordset in the NWINDEX.MDB database, and then it copies the recordset onto Sheet1. The status bar shows the percentage of records changed.</P>
To create the NWINDEX.MDB database, run the Microsoft Excel example for the <B>CreateDatabase </B>method.</P>
<BR></P>
<PRE>Dim db As Database, rs As Recordset, sQLText as String
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; "\NWINDEX.MDB")
sQLText = "SELECT [CON_TITLE], [CONTACT], [COMPANY] FROM Customer " _<BR>    &amp; "WHERE [CON_TITLE] = 'Owner';"
Set rs = db.OpenRecordset(sQLText, dbOpenDynaset)
rs.MoveFirst
Sheets("Sheet1").Activate
Do While Not rs.EOF
    rs.Edit
    rs.Fields("CON_TITLE").Value = "Account Excecutive"
    rs.Update
    Application.StatusBar = rs.PercentPosition &amp; "% of the" _<BR>        &amp; " records have been replaced."
    rs.MoveNext
Loop
Application.StatusBar = "Done"
rs.MoveFirst
numberOfRows = ActiveCell.CopyFromRecordset(rs)
MsgBox numberOfRows &amp; " Records have been changed"
rs.Close
db.Close
</PRE>
</P></BODY>
</HTML>
