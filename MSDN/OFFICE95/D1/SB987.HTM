<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CopyQueryDef Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>CopyQueryDef Method</H2>Applies To</P>
Dynaset-Type<B> Recordset </B>Object,<B> Recordset </B>Object,<B> </B>Snapshot-Type<B> Recordset </B>Object.</P>
Description</P>
Returns a <B>QueryDef</B> object which is a copy of the <B>QueryDef</B> used to create the <B>Recordset</B> object represented by the<I> object</I> placeholder.</P>
Syntax</P>
Set &lt;<I>querydefobject</I>&gt; = &lt;<I>object</I>&gt;.<B>CopyQueryDef</B></P>
The<I> &lt;querydefobject&gt; </I>is an object variable declared as a <B>QueryDef</B>.</P>
Remarks</P>
You must first open a <B>Recordset</B> with the <B>OpenRecordset</B> method before using the <B>CopyQueryDef</B> method. <B>CopyQueryDef</B> creates a new <B>QueryDef</B> that is a duplicate of the <B>QueryDef</B> used to create the <B>Recordset</B>. If a <B>QueryDef</B> wasn't used to create this <B>Recordset</B>, you'll see a message that the feature is not available. </P>
See Also</P>
<B>QueryDef </B>Object.</P>
<P></P>
Example (Microsoft Access)</P>
The following example uses the <B>CopyQueryDef</B> method to return a copy of a <B>QueryDef</B> object representing an Invoices query, and prints the <B>SQL</B> property of that <B>QueryDef</B> object.</P>
<BR></P>
<PRE>Sub GetQueryDefCopy()
    Dim dbs As Database, rst As Recordset
    Dim qdfOriginal As QueryDef, qdfCopy As QueryDef

    ' Return Database variable pointing to current database.
    Set dbs = CurrentDb
    ' Return QueryDef variable pointing to Invoices query.
    Set qdfOriginal = dbs.QueryDefs!Invoices
    ' Open dynaset-type Recordset object.
    Set rst = qdfOriginal.OpenRecordset
    ' Get copy of original QueryDef object.
    Set qdfCopy = rst.CopyQueryDef
    ' Print value of SQL property for copy.
    Debug.Print qdfCopy.SQL
End Sub
</PRE>
</P></BODY>
</HTML>
