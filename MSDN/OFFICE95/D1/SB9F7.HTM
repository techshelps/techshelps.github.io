<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">

<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Requery Method</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->




<H2>Requery Method</h2>

Applies To</p>

Dynaset-Type <b>Recordset </b>Object,<b> Recordset </b>Object,<b>
</b>Snapshot-Type <b>Recordset </b>Object.</p>

Description</p>

Updates the data in a <b>Recordset</b> object by
re-executing the query on which the object is based.</p>

Syntax</p>

<i>object</i><b>.Requery </b>[<b>NewQuerydef</b>]</p>

The <b>Requery</b> method syntax has the following
parts.</p>

<table border="0" cellpadding="7" cols="2">
<COLGROUP><COL WIDTH="85pt" VALIGN="TOP"><COL WIDTH="263pt" VALIGN="TOP"></COLGROUP><TBODY>    <tr>
        <TD valign="top">Part</td>
        <TD valign="top">Description</td>
    </tr>
    <tr>
        <TD valign="top" colspan="2">&nbsp;</td>
    </tr>
    <tr>
        <TD valign="top"><i>object</i></td>
        <TD valign="top">The name of an existing table-type <b>Recordset</b>
        object that has a defined index as specified by the <b>Recordset</b>
        object's <b>Index</b> property.</td>
    </tr>
    <tr>
        <TD valign="top"><i>NewQuerydef</i></td>
        <TD valign="top">A <b>Querydef</b> object, which is an
        optional parameter.</td>
    </tr>
</TBODY></table>

<br>
</p>

Remarks</p>

Use this method to make sure that a <b>Recordset</b>
contains the most recent data. This method re-populates the
current <b>Recordset</b> by either using the currrent query
parameters or the new ones supplied by the <b>NewQuerydef</b>
argument.</p>
<SPAN CLASS="list">
<ul>
    <li>If the original <b>Querydef</b> is supplied, then the <b>Recordset</b>
        is requeried using the parameters specified by the <b>Querydef</b>
        (for example, <i>myquerydef.OpenRecordset()</i>).</li>
    <li>If a <b>Querydef</b> was not used to create the
        recordset, or if a different <b>Querydef</b> is specified
        than what was originally used to create the <b>Recordset</b>,
        then the <b>Recordset</b> is essentially re-created from
        scratch.</li>
</ul>
</SPAN>
When you use <b>Requery</b>, all changes made to the
data in the underlying table by other users are displayed in the <b>Recordset</b>,
and the first record in the <b>Recordset</b> becomes the current
record.</p>

You can't use the <b>Requery</b> method on dynaset-
or snapshot-type <b>Recordset</b> objects whose <b>Restartable</b>
property is set to <b>False</b>,<b> </b>nor can you use it on a
table-type<b> Recordset</b>. However, if you supply the optional <b>NewQueryDef
</b>argument, the <b>Restartable</b> property is ignored.</p>

If both the <b>BOF</b> and <b>EOF</b> property
settings of the <b>Recordset</b> object are <b>True</b> after you
use the <b>Requery</b> method, the query didn't return any
records and the <b>Recordset</b> will contain no data.</p>

See Also</p>

<b>BOF</b>,<b> EOF </b>Properties;<b> QueryDef </b>Object,<b>
Requery </b>Method.</p>

Example</p>

This example determines the <b>Restartable </b>property
setting of a dynaset-type <b>Recordset</b> and then uses the <b>Requery</b>
method on the <b>Recordset</b>.</p>

<br>
</p>

<pre>Dim dbsNorthwind As Database, rstChangeOften As Recordset
Set dbsNorthwind =  DBEngine.Workspaces(0).OpenDatabase(&quot;Northwind.mdb&quot;)
Set rstChangeOften = dbsNorthwind.OpenRecordset _
    (&quot;Table That Changes Often&quot;, dbOpenDynaset)
If rstChangeOften.Restartable = True Then
    rstChangeOften.Requery
End If
dbsNorthwind.Close
</pre>

Example (Microsoft Access)</p>

The following example checks the <b>Restartable</b>
property setting of a dynaset-type <b>Recordset</b> object and
then uses the <b>Requery</b> method on the <b>Recordset</b>
object.</p>

<br>
</p>

<pre>Sub RequerySource()
    Dim dbs As Database, rstOrders As Recordset

    ' Return Database variable that points to current database.
    Set dbs = CurrentDb
    Set rstOrders = dbs.OpenRecordset(&quot;Orders&quot;, dbOpenDynaset)
    If rstOrders.Restartable = True Then
        rstOrders.Requery
    Else
        rstOrders.Close
    End If
End Sub
</pre>
</BODY>

</html>
