<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">

<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Updatable Property</title>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->




<H2>Updatable Property</h2>

Applies To</p>

<b>Database </b>Object,<b> </b>Dynaset-Type <b>Recordset
</b>Object,<b> QueryDef </b>Object,<b> Recordset </b>Object,<b> </b>Snapshot-Type
<b>Recordset </b>Object,<b> </b>Table-Type<b> Recordset </b>Object,<b>
TableDef </b>Object.</p>

Description</p>

Returns a value that indicates whether changes can
be made to a data access object. <b>True</b> (-1) indicates that
the object can be changed or updated. (Snapshot-type <b>Recordset</b>
objects always return <b>False</b> (0).)</p>

Remarks</p>

Depending on the object, if the <b>Updatable</b>
property setting is <b>True</b>, the specified:</p>
<SPAN CLASS="list">
<ul>
    <li><b>Database</b> object can be changed.</li>
    <li><b>QueryDef</b> object query definition can be changed.</li>
    <li><b>Recordset</b> object records can be updated.</li>
    <li><b>TableDef</b> object table definition can be changed.</li>
</ul>
</SPAN>
You can use the <b>Updatable</b> property with all <b>Recordset</b>
objects.</p>

The <b>Updatable</b> property setting is always <b>True</b>
for a newly created <b>TableDef</b> object and <b>False</b> for
an attached <b>TableDef</b> object. A new <b>TableDef</b> object
can be appended only to a database for which the current user has
write permission.</p>

Many types of objects can contain fields that can't
be updated. For example, you can create a dynaset-type <b>Recordset</b>
object in which only some fields can be changed. These fields can
be fixed or contain data that increments automatically, or the
dynaset can result from a query that combines updatable and
nonupdatable tables.</p>

If the object contains only nonupdatable fields, the
value of the <b>Updatable</b> property is <b>False</b>. When one
or more fields are updatable, the property's value is <b>True</b>.
You can edit only the updatable fields. A trappable error occurs
if you try to assign a new value to a nonupdatable field.</p>

The <b>Updatable</b> property of a <b>QueryDef</b>
object is set to <b>True</b> if the query definition can be
updated, even if the resulting <b>Recordset</b> object isn't
updatable.</p>

Because an updatable object can contain nonupdatable
fields, check the <b>Fields</b> collection of a <b>Recordset</b>
object to check the <b>DataUpdatable</b> property of each field
before you edit a record in the <b>Recordset</b> object.</p>

See Also</p>

<b>Field </b>Object.</p>

Example</p>

This example adds a record to a <b>Recordset</b>
object if the object's <b>Updatable</b> property setting is <b>True</b>.</p>

<br>
</p>

<pre>Dim dbsNorthwind As Database, rstUnknown As Recordset
Set dbsNorthwind =  DBEngine.Workspaces(0).OpenDatabase(&quot;Northwind.mdb&quot;)</pre>

<br>
</p>

<pre>Set rstUnknown = dbsNorthwind.OpenRecordset(&quot;Unfamiliar Table&quot;)
If rstUnknown.Updatable = True Then
    rstUnknown.AddNew
    rstUnknown(&quot;MyField&quot;) = &quot;Some new data&quot;
    rstUnknown.Update
End If
dbsNorthwind.Close
</pre>

Example (Microsoft Access)</p>

The following example adds a record to a <b>Recordset</b>
object if the object's <b>Updatable</b> property setting is <b>True</b>.</p>

<br>
</p>

<pre>Sub UpdateData()
    Dim dbs As Database, rstUnknown As Recordset

    ' Return Database variable that points to current database.
    Set dbs = CurrentDb
    Set rstUnknown = dbs.OpenRecordset(&quot;Unfamiliar Table&quot;)
    ' Check Updatable property before adding new record.
    If rstUnknown.Updatable = True Then
        With rstUnknown
            .AddNew
            !SomeField = &quot;Some new data&quot;
            .Update
        End With
    End If
    dbs.Close
End Sub
</pre>

Example (Microsoft Excel)</p>

This example prompts the user to select a cell that
contains a value for the CONTACT field of the Customer recordset
in the NWINDEX.MDB database. The example then checks to see
whether the recordset can be updated. If so, the example adds a
new record to the recordset, using the value in the selected
cell.</p>

To create the NWINDEX.MDB database, run the
Microsoft Excel example for the <b>CreateDatabase </b>method.</p>

<br>
</p>

<pre>Dim db As Database, rs As Recordset
Sheets(&quot;Sheet1&quot;).Activate
cellToCopy = Application.InputBox(&quot;What cell value do you want&quot; _
    &amp; &quot; to update as contact?&quot;, Type:=8)
If cellToCopy = False Then    ' user cancelled InputBox
    Exit Sub
End If
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; &quot;\NWINDEX.MDB&quot;)
Set rs = db.OpenRecordset(&quot;Customer&quot;)
If rs.Updatable = True Then
    rs.AddNew
    rs(&quot;CONTACT&quot;) = cellToCopy
    rs.Update
    rs.MoveLast</pre>

<br>
</p>

<pre>    MsgBox &quot;The new contact is &quot; &amp; rs(&quot;CONTACT&quot;).Value
Else
    MsgBox &quot;The recordset cannot be modified.&quot;
End If
rs.Close
db.Close
</pre>
</BODY>

</html>
