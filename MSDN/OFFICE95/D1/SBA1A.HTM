<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ALL, DISTINCT, DISTINCTROW, TOP Predicates</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>>


	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>ALL, DISTINCT, DISTINCTROW, TOP Predicates</H2>Description</P>
Specifies records selected with SQL queries.</P>
Syntax</P>
SELECT [ALL | DISTINCT | DISTINCTROW | [TOP <I>n</I> [PERCENT]]]<BR>    FROM <I>table</I></P>
A SELECT statement containing these predicates has the following parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="256pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Part</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">ALL</P></TD><TD VALIGN="TOP">Assumed if you don't include one of the predicates. The Microsoft Jet database engine selects all of the records that meet the conditions in the SQL statement. The following two examples are equivalent and return all records from the Employees table:</P>
<BR></P>
<PRE>SELECT ALL *<BR>FROM Employees<BR>ORDER BY EmployeeID;

SELECT *<BR>FROM Employees<BR>ORDER BY EmployeeID;
</PRE></TD></TR><TR><TD VALIGN="TOP">DISTINCT</P></TD><TD VALIGN="TOP">Omits records that contain duplicate data in the selected fields. To be included in the results of the query, the values for each field listed in the SELECT statement must be unique. For example, several employees listed in an Employees table may have the same last name. If two records contain Smith in the Last Name field, the following SQL statement returns only one record that contains Smith:</P>
<BR></P>
<PRE>SELECT DISTINCT<BR>LastName<BR>FROM Employees;
</PRE>
If you omit DISTINCT, this query returns both Smith records.</P>
If the SELECT clause contains more than one field, the combination of values from all fields must be unique for a given record to be included in the results.</P>
The output of a query that uses DISTINCT isn't updatable and doesn't reflect subsequent changes made by other users.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="256pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Part</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">DISTINCTROW</P></TD><TD VALIGN="TOP">Omits data based on entire duplicate records, not just duplicate fields. For example, you could create a query that joins the Customers and Orders tables on the Customer ID field. The Customers table contains no duplicate Customer ID fields, but the Orders table does because each customer can have many orders. The following SQL statement shows how you can use DISTINCTROW to produce a list of companies that have at least one order but without any details about those orders:</P>
<BR></P>
<PRE>SELECT DISTINCTROW CompanyName<BR>FROM Customers INNER JOIN Orders<BR>ON Customers.CustomerID = Orders.CustomerID<BR>ORDER BY CompanyName;
</PRE>
If you omit DISTINCTROW, this query produces multiple rows for each company that has more than one order.</P>
DISTINCTROW has an effect only when you select fields from some, but not all, of the tables used in the query. DISTINCTROW is ignored if your query includes only one table, or if you output fields from all tables.</P></TD></TR><TR><TD VALIGN="TOP">TOP</P></TD><TD VALIGN="TOP">Returns a certain number of records that fall at the top or the bottom of a range specified by an ORDER BY clause. Suppose you want the names of the top 25 students from the class of 1994:</P>
<BR></P>
<PRE>SELECT TOP 25<BR>FirstName, LastName<BR>FROM Students<BR>WHERE GraduationYear = 1994<BR>ORDER BY GradePointAverage DESC;
</PRE>
If you don't include the ORDER BY clause, the query will return an arbitrary set of 25 records from the Students table that satisfy the WHERE clause.</P>
The TOP predicate doesn't choose between equal values. In the preceding example, if the twenty-fifth and twenty-sixth highest grade point averages are the same, the query will return 26 records.</P>
</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="256pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Part</P></TD><TD VALIGN="TOP">Description</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">TOP</P></TD><TD VALIGN="TOP">You can also use the PERCENT reserved word to return a certain percentage of records that fall at the top or the bottom of a range specified by an ORDER BY clause. Suppose that, instead of the top 25 students, you want the bottom 10 percent of the class:</P>
<BR></P>
<PRE>SELECT TOP 10 PERCENT<BR>FirstName, LastName<BR>FROM Students<BR>WHERE GraduationYear = 1994<BR>ORDER BY GradePointAverage ASC;</PRE>
</P>
The ASC predicate specifies a return of bottom values. The value that follows TOP must be an unsigned <B>Integer</B>.</P>
TOP doesn't affect the query's updatability.</P></TD></TR><TR><TD VALIGN="TOP"><I>table</I></P></TD><TD VALIGN="TOP">The name of the table from which records are retrieved.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
Specifics (Microsoft Access)</P>
In Microsoft Access, using DISTINCT is equivalent to setting the <B>UniqueValues</B> property to Yes on the query property sheet in query Design view.</P>
Using DISTINCTROW is equivalent to setting the <B>UniqueRecords</B> property to Yes (the default value) in the query property sheet in query Design view.</P>
Using TOP is equivalent to setting the <B>TopValues</B> property on the query property sheet in query Design view, or entering a value in the Top Values list box on the toolbar in the Query window.</P>
Using the PERCENT reserved word is equivalent to using the percent sign (%) with the <B>TopValues</B> property or in the Top Values list box.</P>
Example</P>
The following examples use two hypothetical tables, Customers and Orders.</P>
<H3><A NAME="sec0"></A>Customers Table</H3>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">First name</P></TD><TD VALIGN="TOP">Customer ID</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">Bob</P></TD><TD VALIGN="TOP">1</P></TD></TR><TR><TD VALIGN="TOP">Adam</P></TD><TD VALIGN="TOP">2</P></TD></TR><TR><TD VALIGN="TOP">Beverly</P></TD><TD VALIGN="TOP">3</P></TD></TR><TR><TD VALIGN="TOP">Bob</P></TD><TD VALIGN="TOP">4</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<H3><A NAME="sec1"></A>Orders Table</H3>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Customer ID</P></TD><TD VALIGN="TOP">Order ID</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">1</P></TD><TD VALIGN="TOP">1</P></TD></TR><TR><TD VALIGN="TOP">1</P></TD><TD VALIGN="TOP">2</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Customer ID</P></TD><TD VALIGN="TOP">Order ID</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">2</P></TD><TD VALIGN="TOP">3</P></TD></TR><TR><TD VALIGN="TOP">2</P></TD><TD VALIGN="TOP">4</P></TD></TR><TR><TD VALIGN="TOP">2</P></TD><TD VALIGN="TOP">5</P></TD></TR><TR><TD VALIGN="TOP">4</P></TD><TD VALIGN="TOP">6</P></TD></TR><TR><TD VALIGN="TOP">4</P></TD><TD VALIGN="TOP">7</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<BR></P>
<PRE>SELECT ALL FirstName FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID;
</PRE>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Result</P></TD><TD VALIGN="TOP">Updatable</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">Bob<BR>Bob<BR>Adam<BR>Adam<BR>Adam<BR>Bob<BR>Bob</P></TD><TD VALIGN="TOP">Yes</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<BR></P>
<PRE>SELECT DISTINCT FirstName FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID;
</PRE>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Result</P></TD><TD VALIGN="TOP">Updatable</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">Bob<BR>Adam</P></TD><TD VALIGN="TOP">No</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<BR></P>
<PRE>SELECT DISTINCTROW FirstName FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID;
</PRE>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Result</P></TD><TD VALIGN="TOP">Updatable</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">Bob<BR>Adam<BR>Bob</P></TD><TD VALIGN="TOP">Yes</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<BR></P>
<PRE>SELECT TOP 5 FirstName FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID ORDER BY Orders.OrderID;
</PRE>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Result</P></TD><TD VALIGN="TOP">Updatable</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">Bob<BR>Bob<BR>Adam<BR>Adam<BR>Adam</P></TD><TD VALIGN="TOP">Yes</P></TD></TR></TBODY></TABLE>
<BR></P><BR></P>
<PRE></PRE>
<P></P></BODY>
</HTML>
