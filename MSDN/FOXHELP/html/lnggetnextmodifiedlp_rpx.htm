<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GETNEXTMODIFIED( ) Function Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lnggetnextmodifiedlp_rpx"></a><sup></sup>GETNEXTMODIFIED(&nbsp;) Function Example</b></p>
<p>
The following example demonstrates how you can use GETNEXTMODIFIED(&nbsp;) to determine which records in a table have been changed. MULTILOCKS is set to ON, a requirement for table buffering. The <code>customer</code> table in the <code>testdata</code> database is opened, and CURSORSETPROP(&nbsp;) is then used to set the buffering mode to optimistic table buffering (5).</p>
<p>
SKIP is issued to move the record pointer to the second record, and the <code>cust_id</code> field is modified with REPLACE. GETNEXTMODIFIED(0) is used to display the record number of the next modified record (2, the second record), starting from the beginning of the table. TABLEREVERT(&nbsp;) is used to return the table to its original state, and GETNEXTMODIFIED(0) is used again to display the record number of the next modified record (0, indicating that no records have been modified).</p>
<pre><code>CLOSE DATABASES
CLEAR

OPEN DATABASE SYS (HOME(2) + 'data\testdata')
SET MULTILOCKS ON&nbsp; &amp;&amp; Allow table buffering
USE Customer&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; Open customer table
=CURSORSETPROP("Buffering", 5, "customer")&nbsp; &amp;&amp; Enable table buffering

SKIP&nbsp; &amp;&amp; Move record pointer to the second record

* Change field contents
REPLACE cust_id WITH "***"

* Call MESSAGEBOX function with results of GETNEXTMODIFIED
=MESSAGEBOX("Record " + ALLTRIM(STR(<span class=cfe><b>GETNEXTMODIFIED</b></span>(0))) + ;
 &nbsp; " has changed.",0,"Results")

* Revert table and display results with MESSAGEBOX
=TABLEREVERT(.T.)&nbsp; &amp;&amp; Discard all table changes
nChange=<span class=cfe><b>GETNEXTMODIFIED</b></span>(0)
IF nChange=0
 &nbsp; =MESSAGEBOX("Record(s) have been reverted.",0,"Results")
ELSE
 &nbsp; =MESSAGEBOX("Record " + ALLTRIM(STR(<span class=cfe><b>GETNEXTMODIFIED</b></span>(0))) + ;
 &nbsp;&nbsp; " has changed.",0,"Results")
ENDIF
</code></pre>
</BODY>
</HTML>
