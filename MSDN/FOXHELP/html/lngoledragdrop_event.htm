<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLEDragDrop Event</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngoledragdrop_event"></a><sup></sup>OLEDragDrop Event</h1>
<p>
<a href="lngoledragdrop_eventat.htm">Applies To</a> &nbsp; <a href="lngoledragdrop_eventsa.htm">See Also</a></p>
<p>
Occurs when data is dropped on a drop target and the drop target's OLEDropMode property is set to 1 – Enabled.</p>
<p class=label>
<b>Syntax</b></p>
<p>
PROCEDURE <i>Object</i>.OLEDragDrop<br>
LPARAMETERS <i>oDataObject</i>, <i>nEffect</i>, <i>nButton</i>, <i>nShift</i>,<br>
 &nbsp; <i>nXCoord</i>, <i>nYCoord</i></p>
<p class=label>
<b>Settings</b></p>
<p class=dt>
<i>oDataObject</i></p>
<p class=indent>
An object reference to OLE drag-and-drop DataObject, used with the GetData and GetFormat methods to return data and data formats in the DataObject.</p>
<p class=dt>
<i>nEffect</i></p>
<p class=indent>
A value passed to the OLECompleteDrag event, indicating the action performed when data is dropped on the drop target. <i>nEffect</i> is initially a value that indicates the OLE drag-and-drop operations supported by the drag source. Within the OLEDragDrop event you can change the value of <i>nEffect</i> which is passed to the OLECompleteDrag event. If you change the value of <i>nEffect</i>, be sure to include NODEFAULT in the event code to prevent the default behavior. The following table lists the values for <i>nEffect</i> that you can pass to the OLECompleteDrag event with a description of each action.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=18%><i>nEffect</i></td>
<td class=label width=32%><b>Foxpro.h constant</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=18%>0</td>
<td width=32%>DROPEFFECT_NONE</td>
<td width=50%>Drop target did not accept the data or the drop operation was canceled.</td>
</tr>
<tr valign=top>
<td width=18%>1</td>
<td width=32%>DROPEFFECT_COPY</td>
<td width=50%>Data was copied from the drag source to the drop target.</td>
</tr>
<tr valign=top>
<td width=18%>2</td>
<td width=32%>DROPEFFECT_MOVE</td>
<td width=50%>Data was moved from the drag source to the drop target.</td>
</tr>
<tr valign=top>
<td width=18%>4</td>
<td width=32%>DROPEFFECT_LINK</td>
<td width=50%>Data was linked from the drag source to the drop target.</td>
</tr>
</table><br>
<p class=dt>
<i>nButton</i></p>
<p class=indent>
Contains a number that specifies which mouse button was released to drop the data on the target: 1 (left), 2 (right), or 4 (middle).</p>
<p class=dt>
<i>nShift</i></p>
<p class=indent>
Contains a number specifying the state of modifier keys when the mouse was released to drop the data on the drop target. The valid modifier keys are the SHIFT, CTRL, and ALT keys. The values returned in <i>nShift</i> for individual modifier keys are listed in the following table.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=18%><i>nShift</i></td>
<td class=label width=82%><b>Modifier key</b></td>
</tr>
<tr valign=top>
<td width=18%>1</td>
<td width=82%>SHIFT</td>
</tr>
<tr valign=top>
<td width=18%>2</td>
<td width=82%>CTRL</td>
</tr>
<tr valign=top>
<td width=18%>4</td>
<td width=82%>ALT</td>
</tr>
</table><br>
<p class=tl>
If more than one modifier key is held down when the mouse is pressed, the <i>nShift</i> argument contains the sum of the values for the modifier keys. For example, if the user holds CTRL while releasing the mouse button, the <i>nShift</i> argument contains 2. But If the user holds CTRL+ALT while releasing the mouse button, the <i>nShift</i> argument contains 6.</P><p class=dt>
<i>nXCoord</i>, <i>nYCoord</i></p>
<p class=indent>
Contains the horizontal (<i>nXCoord</i>) and vertical (<i>nYCoord</i>) position of the mouse pointer within the Form when the mouse button was released to drop the data on the drop target. These coordinates are expressed in terms of the Form's coordinate system in the unit of measurement specified by the <i>ScaleMode</i> property of the Form.</p>
<p class=label>
<b>Remarks</b></p>
<p>
OLEDragDrop is a drop target event that only occurs when the OLEDropMode property for the control or object is set to 1 – Enabled. This event does not occur if the OLEDropMode property is set to 0 – Disabled or 2 – Pass to Container.</p>
<p>
If you perform your own drop processing in the OleDragDrop event, include NODEFAULT to prevent the default drop from occuring. In this case, you must then set the resulting <i>nEffect</i> value.</p>
</BODY>
</HTML>
