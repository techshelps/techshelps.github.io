<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Visual FoxPro HWND Control</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngvisual_foxpro_hwnd_control"></a><sup></sup>Visual FoxPro HWND Control</h1>
<p>
<a href="lngvisual_foxpro_hwnd_controlsa.htm">See Also</a></p>
<p>
Visual FoxPro includes the HWND ActiveX control (Foxhwnd.ocx) which you can add to and distribute with your applications. ActiveX controls are added to a form in an application with the Visual FoxPro <a href="ctlole_container_control.htm">OLE container control</a>.</p>
<p>
The HWND ActiveX control provides a window in which other ActiveX controls (such as the Microsoft Multimedia ActiveX control) can display images. Unlike the Visual FoxPro Image control, the HWND ActiveX control can be used to display icon and Windows metafiles.</p>
<p>
The following table lists the properties, events, and methods available for the HWND ActiveX control.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Property, Event, or Method</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=50%>Appearance Property</td>
<td width=50%>Specifies the appearance of the HWND control. Available at design time and run time.<p>
The Appearance property can have the following values:</p>
<p>
0 - (Default) Flat.</p>
<p>
1 - 3-dimensional.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>BackColor Property</td>
<td width=50%>Specifies the background color of the HWND control. Available at design time and run time.<p>
The BackColor property is a single numeric color value. For more information about color values that can be assigned to the BackColor property, see the Visual FoxPro <a href="lngbackcolor_forecolor_properties.htm">BackColor, ForeColor Properties</a> topic in Help.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>BorderStyle Property</td>
<td width=50%>Specifies the border style of the HWND control. Available at design time and run time.<p>
The BorderStyle property can have the following values:</p>
<p>
0 - (Default) No border.</p>
<p>
1 - Single line border.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>Picture Property</td>
<td width=50%>Specifies a picture object reference for the image displayed in the HWND control. Available at design time and run time.<p>
Use <a href="lngloadpicturelp_rp.htm">LOADPICTURE(&nbsp;)</a> to create an object reference for a bitmap, icon, or Windows meta file.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>HWnd Property</td>
<td width=50%>Contains the handle to the window of the HWND control. Read-only at runtime.</td>
</tr>
<tr valign=top>
<td width=50%>Click Event</td>
<td width=50%>Occurs when the user presses and releases the left mouse button while the pointer is over the HWND control.</td>
</tr>
<tr valign=top>
<td width=50%>DblClick Event</td>
<td width=50%>Occurs when the user presses and releases the left mouse button twice in quick succession over the HWND control.</td>
</tr>
<tr valign=top>
<td width=50%>KeyDown Event</td>
<td width=50%>Occurs when the user presses a key when the HWND control has the focus. Two parameters, <i>keycode</i> and <i>shift</i>, are passed to the KeyDown event.<p>
<i>Keycode </i>Contains a number which identifies the key pressed. For a list of codes for special keys and key combinations, see <a href="lnginkeylp_rp.htm">INKEY(&nbsp;)</a>.</p>
<p>
<i>Shift </i>Sets a bit if the key is pressed. This parameter is the sum of the bits, with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2). These bits correspond to the values 1, 2, and 4, respectively. This parameter indicates the state of these keys. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys is pressed. For example, if both CTRL and ALT are pressed, the value of <i>shift</i> is 6.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>KeyPress Event</td>
<td width=50%>Occurs when the user presses and releases a key when the HWND control has the focus. One parameter, <i>keyascii</i>, is passed to the KeyPress event.<p>
<i>Keyascii </i>Contains a number which identifies the key pressed and released. For a list of codes for special keys and key combinations, see <a href="lnginkeylp_rp.htm">INKEY(&nbsp;)</a>.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>KeyUp Event</td>
<td width=50%>Occurs when the user releases a key when the HWND control has the focus.<p>
Two parameters, <i>keycode</i> and <i>shift</i>, are passed to the KeyUp event.</p>
<p>
<i>Keycode </i>Contains a number which identifies the key released. For a list of codes for special keys and key combinations, see <a href="lnginkeylp_rp.htm">INKEY(&nbsp;)</a>.</p>
<p>
<i>Shift </i>Sets a bit if the key is released. This parameter is the sum of the bits, with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2 ). These bits correspond to the values 1, 2, and 4, respectively. This parameter indicates the state of these keys. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys is pressed. For example, if both CTRL and ALT are pressed, the value of <i>shift</i> is 6.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>MouseDown Event</td>
<td width=50%>Occurs when the user presses a mouse button while the pointer is over the HWND control.<p>
Four parameters, <i>button</i>, <i>shift</i>, <i>x</i>, and <i>y</i>, are passed to the MouseDown event.</p>
<p>
<i>Button</i> Contains a number which specifies which button was pressed to trigger the event: 1 (left), 2 (right), or 4 (middle).</p>
<p>
<i>Shift</i> Contains a number which specifies the state of the SHIFT, CTRL, and ALT keys when the button specified in the <i>button</i> argument was pressed.</p>
<p>
A bit is set if the key is down. The <i>shift</i> argument is the sum of the bits, with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2). These bits correspond to the values 1, 2, and 4, respectively. The <i>shift</i> parameter indicates the state of these keys. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys are pressed. For example, if both CTRL and ALT are pressed, the value of <i>shift</i> is 6.</p>
<p>
<i>x</i>, <i>y</i> Contains the current horizontal (<i>x</i>) and vertical (<i>y</i>) position of the mouse pointer within the Form. These coordinates are always expressed in terms of the Form's coordinate system specified, in the unit of measurement specified ScaleMode property setting.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>MouseMove Event</td>
<td width=50%>Occurs when the user moves the mouse over the HWND control. The MouseMove event is triggered continually as the mouse pointer moves across the HWND control.<p>
Four parameters, <i>button</i>, <i>shift</i>, <i>x</i>, and <i>y</i>, are passed to the MouseMove event.</p>
<p>
<i>Button</i> Contains a number which specifies the state of the mouse buttons as a sum of bits: 1 (left), 2 (right), or 4 (middle).</p>
<p>
<i>Shift</i> Contains a number which specifies the state of the SHIFT, CTRL, and ALT keys: 1 (SHIFT), 2 (CTRL), 4 (ALT). A bit is set if the key is down. The <i>shift</i> parameter is the sum of the bits, with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2). These bits correspond to the values 1, 2, and 4, respectively. <i>shift</i> indicates the state of these keys. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys are pressed. For example, if both CTRL and ALT are pressed, the value of <i>shift</i> is 6.</p>
<p>
<i>x</i>, <i>y</i> Contains the current horizontal (<i>x</i>) and vertical (<i>y</i>) position of the mouse pointer within the form. These coordinates are always expressed in terms of the form's coordinate system specified, in the unit of measurement specified ScaleMode property setting.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>MouseUp Event</td>
<td width=50%>Occurs when the user releases a mouse button while the pointer is over the HWND control.<p>
Four parameters, <i>button</i>, <i>shift</i>, <i>x</i>, and <i>y</i>, are passed to the MouseUp event.</p>
<p>
<i>Button</i> Contains a number which specifies which button was released to trigger the event: 1 (left), 2 (right), or 4 (middle).</p>
<p>
<i>Shift</i> Contains a number which specifies the state of the SHIFT, CTRL, and ALT keys when the button specified in the <i>button</i> argument was released.</p>
<p>
A bit is set if the key is down. The <i>shift</i> argument is the sum of the bits, with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2). These bits correspond to the values 1, 2, and 4, respectively. The <i>shift</i> parameter indicates the state of these keys. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys are pressed. For example, if both CTRL and ALT are pressed, the value of <i>shift</i> is 6.</p>
<p>
<i>x</i>, <i>y</i> Contains the current horizontal (<i>x</i>) and vertical (<i>y</i>) position of the mouse pointer within the form. These coordinates are always expressed in terms of the form's coordinate system specified, in the unit of measurement specified ScaleMode property setting.</p>
</td>
</tr>
<tr valign=top>
<td width=50%>Paint Event</td>
<td width=50%>Occurs when the HWND control requires repainting. The RestoreDisplay method is typically executed in the Paint event code.</td>
</tr>
<tr valign=top>
<td width=50%>RestoreDisplay Method</td>
<td width=50%>Restores the image stored to memory with the SaveDisplay method.</td>
</tr>
<tr valign=top>
<td width=50%>SaveDisplay Method</td>
<td width=50%>Save the currently displayed image to memory.<p>
Note that if a toolbar or a form with the AlwaysOnTop property set to true (.T.) is over the HWND control when the SaveDisplay method is executed, the image of the toolbar or form is saved with the image in the HWND control.</p>
</td>
</tr>
</table><br>
<p>
For additional information about adding ActiveX controls to your applications, see Chapter 16, <a href="dgadding_ole.htm">Adding OLE</a>, in the <i>Programmer’s Guide</i>.</p>
</BODY>
</HTML>
