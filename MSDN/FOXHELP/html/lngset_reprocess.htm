<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SET REPROCESS Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngset_reprocess"></a><sup></sup>SET REPROCESS Command</h1>
<p>
<a href="lngset_reprocesssa.htm">See Also</a></p>
<p>
Specifies how many times and for how long Visual FoxPro attempts to lock a file or record after an unsuccessful locking attempt.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SET REPROCESS TO <i>nAttempts</i> [SECONDS] | TO AUTOMATIC</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
TO <i>nAttempts</i> [SECONDS]</p>
<p class=indent>
Specifies the number of times Visual FoxPro attempts to lock a record or file after an initial unsuccessful attempt. The default value is 0, the maximum value is 32,000.</p>
<p class=tl>
SECONDS specifies that Visual FoxPro attempts to lock a file or record for <i>nAttempts</i> seconds. It's available only when <i>nAttempts</i> is greater than zero.</P><p class=tl>
For example, if <i>nAttempts</i> is 30, Visual FoxPro attempts to lock a record or file up to 30 times. If you also include SECONDS (<code>SET REPROCESS TO 30 SECONDS</code>), Visual FoxPro continuously attempts to lock a record or file for up to 30 seconds.</P><p class=tl>
A system message ("Waiting for lock ... ") appears if SET STATUS is set to ON.</P><p class=tl>
If an ON ERROR routine is in effect and attempts by a command to lock the record or file are unsuccessful, the ON ERROR routine is executed. However, if a function attempts the lock, an ON ERROR routine isn't executed and the function returns false (.F.).</P><p class=tl>
If an ON ERROR routine isn't in effect, a command attempts to lock the record or file, and the lock can't be placed, an appropriate alert appears (for example, "Record is in use by another"). If a function attempts to place the lock, the alert isn't displayed and the function returns false (.F.).</P><p class=tl>
If <i>nAttempts</i> is 0 (the default value) and you issue a command or function that attempts to lock a record or file, Visual FoxPro tries to lock the record or file indefinitely. Visual FoxPro displays the system message, "Attempting to lock... Press Escape to Cancel," while attempting to lock the record or file. The lock is placed and the system message is cleared if the record or file becomes available for locking while you wait. If a function attempted to place the lock, the function returns true (.T.).</P><p class=tl>
If you press ESC in response to the system message, an appropriate alert appears (for example, "Record is in use by another"). If a function attempts to place the lock, the alert isn't displayed and the function returns false (.F.).</P><p class=tl>
If an ON ERROR routine is in effect and a command is attempting to lock the record or file, the ON ERROR routine takes precedence over additional attempts to lock the record or file. The ON ERROR routine is immediately executed. Visual FoxPro does not attempt additional record or file locks and does not display the system message.</P><p class=tl>
If <i>nAttempts</i> is –1, Visual FoxPro attempts to lock the record or file indefinitely. You can't cancel the locking attempts by pressing the ESC key, and an ON ERROR routine isn't executed.</P><p class=tl>
Setting <i>nAttempts</i> to -2 is equivalent to using the TO AUTOMATIC clause.</P><p class=tl>
Visual FoxPro displays the "Waiting for lock ... " system message only if SET STATUS is set to ON.</P><p class=tl>
If a lock has been placed by another user on the record or file you are attempting to lock, you must wait until the user releases the lock.</P><p class=dt>
TO AUTOMATIC</p>
<p class=indent>
Specifies that Visual FoxPro attempts to lock the record or file indefinitely (equivalent to setting <i>nAttempts</i> to <code>–2</code>). This clause is similar to setting <i>nAttempts</i> to -1, except that it includes the facility to quit the attempt to lock a record or file.</p>
<p class=tl>
The "Attempting to lock ... Press Escape to Cancel" system message appears while Visual FoxPro attempts to lock the record or file. The lock is placed and the system message is cleared if the record or file becomes available for locking while you wait. If a function is used to place the lock, the function returns true (.T.).</P><p class=tl>
If an ON ERROR routine isn't in effect and you press ESC in response to the system message, an appropriate alert appears (for example, "Record is in use by another"). If a function attempts to place the lock, the alert isn't displayed and the function returns false (.F.).</P><p class=tl>
If an ON ERROR routine is in effect and ESC is pressed, the ON ERROR routine is executed. If a function attempts to place the lock, an ON ERROR routine isn't executed and the function returns false (.F.).</P><p class=tl>
For more information about record and file locking and sharing tables on a network, see Chapter 17, <a href="dgprogramming_for_shared_access.htm">Programming for Shared Access</a>, in the <i>Programmer's Guide</i>.</P><p class=label>
<b>Remarks</b></p>
<p>
The first attempt to lock a record or file isn't always successful. Frequently, a record or file is locked by another user on the network. SET REPROCESS determines whether Visual FoxPro makes additional attempts to lock the record or file when the initial attempt is unsuccessful. You can specify either how many times additional attempts are made or for how long the attempts are made. An ON ERROR routine affects how unsuccessful lock attempts are handled.</p>
<p>
SET REPROCESS is scoped to the current data session.</p>
</BODY>
</HTML>
