<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ON SELECTION MENU Command Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lngon_selection_menux"></a><sup></sup>ON SELECTION MENU Command Example</b></p>
<p>
In the following example, ON SELECTION MENU is used to execute a procedure when a menu title is chosen from the Visual FoxPro system menu bar.</p>
<p>
The current system menu bar is saved to memory with SET SYSMENU SAVE and all system menu titles are removed with SET SYSMENU TO.</p>
<p>
DEFINE PAD creates several system menu titles. When you choose a menu title, the <code>choice</code> procedure assigned to the menu bar with ON SELECTION MENU executes. The <code>choice</code> procedure displays the name of the menu title you choose and the name of the menu bar. If you choose the Exit menu title, the original Visual FoxPro system menu is restored.</p>
<pre><code>*** Name this program ONMENU.PRG ***
CLEAR
SET SYSMENU SAVE
SET SYSMENU TO
DEFINE PAD padSys OF _MSYSMENU PROMPT '\&lt;System' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+S, ''
DEFINE PAD padEdit OF _MSYSMENU PROMPT '\&lt;Edit' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+E, ''
DEFINE PAD padRecord OF _MSYSMENU PROMPT '\&lt;Record' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+R, ''
DEFINE PAD padWindow OF _MSYSMENU PROMPT '\&lt;Window' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+W, ''
DEFINE PAD padReport OF _MSYSMENU PROMPT 'Re\&lt;ports' COLOR SCHEME 3 KEY ALT+P, ''
DEFINE PAD padExit OF _MSYSMENU PROMPT 'E\&lt;xit' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+X, ''
<span class=cfe><b>ON SELECTION MENU</b></span> _MSYSMENU ;
 &nbsp; DO choice IN onmenu WITH PAD( ), MENU( )
PROCEDURE choice
PARAMETER gcPad, gcMenu
WAIT WINDOW 'You chose ' + gcPad + ;
 &nbsp; ' from menu ' + gcMenu NOWAIT
IF gcPad = 'PADEXIT'
 &nbsp; SET SYSMENU TO DEFAULT
ENDIF
</code></pre>
</BODY>
</HTML>
