<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_DBLock( ) API Library Routine Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lng_dblocklp_rpx"></a><sup></sup>_DBLock(&nbsp;) API Library Routine Example</b></p>
<p>
The following example provides two API functions you can call from Visual FoxPro: XRLOCK(&nbsp;), which locks the current record of the current work area; and XFLOCK(&nbsp;), which locks the table open in the current work area. XRLOCK(&nbsp;) calls _DBLock( – 1, DBL_RECORD(&nbsp;)), and XFLOCK(&nbsp;) calls _DBLock( – 1, DBL_FILE(&nbsp;)).</p>
<h4>Visual FoxPro Code</h4>
<pre><code>SET LIBRARY TO DBLOCK&nbsp; 
DO CreateTest
USE Test SHARED
GO 2
= XRLOCK()
LIST STAT&nbsp; &amp;&amp; shows that record #2 is locked
= XFLOCK()
LIST STAT&nbsp; &amp;&amp; shows that whole DBF is locked

PROCEDURE CreateTest

CREATE TABLE test (ABC C(20))
APPEND BLANK
REPLACE ABC WITH "Golly month of"
APPEND BLANK
REPLACE ABC WITH "A twelfth of"
APPEND BLANK
REPLACE ABC WITH "Hello, world"
APPEND BLANK
REPLACE ABC WITH "When in the"
GO TOP

RETURN
</code></pre>
<h4>C Code</h4>
<pre><code>#include &lt;pro_ext.h&gt;

FAR xLockRecord(ParamBlk FAR *parm)
{
 &nbsp; <span class=cfe><b>_DBLock(</b></span>-1, DBL_RECORD<span class=cfe><b>)</b></span>;
}

FAR xLockFile(ParamBlk FAR *parm)
{
 &nbsp; <span class=cfe><b>_DBLock(</b></span>-1, DBL_FILE<span class=cfe><b>)</b></span>;
}

FoxInfo myFoxInfo[] =
{
 &nbsp; {"XRLOCK", (FPFI) xLockRecord, 0, ""},
 &nbsp; {"XFLOCK", (FPFI) xLockFile, 0, ""},
};

FoxTable _FoxTable =
{
 &nbsp; (FoxTable FAR *) 0, sizeof(myFoxInfo)/sizeof(FoxInfo), myFoxInfo
};
</code></pre>
</BODY>
</HTML>
