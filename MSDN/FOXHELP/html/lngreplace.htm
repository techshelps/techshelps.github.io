<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>REPLACE Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngreplace"></a><sup></sup>REPLACE Command</h1>
<p>
<a href="lngreplacex.htm">Example</a> &nbsp; <a href="lngreplacesa.htm">See Also</a></p>
<p>
Updates table records.</p>
<p class=label>
<b>Syntax</b></p>
<p>
REPLACE <i>FieldName1</i> WITH <i>eExpression1</i> [ADDITIVE]<br>
 &nbsp; [, <i>FieldName2</i> WITH <i>eExpression2</i> [ADDITIVE]] ... <br>
 &nbsp; [<i>Scope</i>] [FOR <i>lExpression1</i>] [WHILE <i>lExpression2</i>]<br>
 &nbsp; [IN <i>nWorkArea</i> | <i>cTableAlias</i>]<br>
 &nbsp; [NOOPTIMIZE]</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>FieldName1</i> WITH <i>eExpression1</i> [, <i>FieldName2</i> WITH <i>eExpression2</i> ... ]</p>
<p class=indent>
Specifies that the data in <i>FieldName1</i> be replaced with the value of the expression <i>eExpression1</i>; that the data in <i>FieldName2</i> be replaced with the value of the expression <i>eExpression2</i>; and so on.</p>
<p class=tl>
When the expression value is longer than the width of a numeric field, REPLACE forces the value to fit by carrying out the following steps:</P><ol>
<li>
First, REPLACE truncates decimal places and rounds the remaining decimal portion of the field.<br><br></li>
<li>
If the value still doesn't fit, REPLACE stores the field contents using scientific notation.<br><br></li>
<li>
If the value still doesn't fit, REPLACE replaces the field contents with asterisks.</li>
</ol>
<p class=dt>
ADDITIVE</p>
<p class=indent>
Appends to the end of the memo fields replacements to memo fields. ADDITIVE applies to replacements in memo fields only. If you omit ADDITIVE, the memo field is overwritten with the value of the expression.</p>
<p class=dt>
<i>Scope</i></p>
<p class=indent>
Specifies a range of records to replace. Only the records that fall within the range are replaced. The scope clauses are: ALL, NEXT <i>nRecords</i>, RECORD <i>nRecordNumber</i>, and REST. For more information on scope clauses, see <a href="tblscope_clauses.htm">Scope Clauses</a> or <a href="lngoverview_of_the_language.htm">Overview of the Language</a>.</p>
<p class=tl>
The default scope for REPLACE is the current record (NEXT 1).</P><p class=dt>
FOR <i>lExpression1</i></p>
<p class=indent>
Specifies that the designated fields be replaced only in records for which <i>lExpression1</i> evaluates to true (.T.). Including FOR lets you conditionally replace records, filtering out those you don't want replaced.</p>
<p class=tl>
Rushmore optimizes REPLACE FOR if <i>lExpression1</i> is an optimizable expression. For best performance, use an optimizable expression in the FOR clause. </P><p class=tl>
For more information, see <a href="lngset_optimize.htm">SET OPTIMIZE</a> and "Understanding Rushmore Technology" in Chapter 15, <a href="dgoptimizing_applications.htm">Optimizing Applications</a>, in the <i>Programmer's Guide</i>.</P><p class=dt>
WHILE <i>lExpression2</i></p>
<p class=indent>
Specifies a condition whereby fields are replaced for as long as the logical expression <i>lExpression2</i> evaluates to true (.T.).</p>
<p class=dt>
IN <i>nWorkArea</i></p>
<p class=indent>
Specifies the work area of the table in which records are updated.</p>
<p class=dt>
IN <i>cTableAlias</i></p>
<p class=indent>
Specifies the alias of the table in which records are updated.</p>
<p class=tl>
If you omit <i>nWorkArea</i> and <i>cTableAlias</i>, records are updated in the table in the currently selected work area.</P><p class=dt>
NOOPTIMIZE</p>
<p class=indent>
Prevents Rushmore optimization.</p>
<p class=tl>
For more information, see <a href="lngset_optimize.htm">SET OPTIMIZE</a> and "Understanding Rushmore Technology" in Chapter 15, <a href="dgoptimizing_applications.htm">Optimizing Applications</a>, in the <i>Programmer's Guide</i>.</P><p class=label>
<b>Remarks</b></p>
<p>
REPLACE replaces data in a field with the value in an expression. Fields in unselected work areas must be prefaced with their alias.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If the IN clause is omitted, no replacement occurs if the record pointer is at the end of the file in the current work area and you specify a field in another work area.</p>
</BODY>
</HTML>
