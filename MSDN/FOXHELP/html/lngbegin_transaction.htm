<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BEGIN TRANSACTION Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngbegin_transaction"></a><sup></sup>BEGIN TRANSACTION Command</h1>
<p>
<a href="lngbegin_transactionx.htm">Example</a> &nbsp; <a href="lngbegin_transactionsa.htm">See Also</a></p>
<p>
Begins a transaction. Transactions are supported only for tables in a database. See <a href="lngcreate_database.htm">CREATE DATABASE</a> and <a href="lngadd_table.htm">ADD TABLE</a> for information on how to create and add tables to a database.</p>
<p class=label>
<b>Syntax</b></p>
<p>
BEGIN TRANSACTION</p>
<p class=label>
<b>Remarks</b></p>
<p>
To save any modifications you made and end the transaction, issue END TRANSACTION. If the transaction fails (the server fails, the workstation fails, or you exit Visual FoxPro without committing the transaction) or if you issue ROLLBACK, the file or files in the transaction are restored to their original state.</p>
<p>
Transactions can be nested five levels deep. An error is generated if you attempt a sixth level of nesting.</p>
<p>
When you modify records in a table that is part of a transaction, other users on the network do not have access (read or write) to the records until you end the transaction.</p>
<p>
When other users on the network try to access records you have modified, they must wait until you end your transaction. They receive the message "Record not available ... please wait" until the records become available. Because of this, it is important to keep the length of the transaction to a minimum or conduct the transaction during times when others do not need access.</p>
<p>
The following commands and functions are not supported during a transaction:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=48%><b>Commands and functions</b></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%>ADD TABLE</td>
<td width=52%>DELETE CONNECTION</td>
</tr>
<tr valign=top>
<td width=48%>APPEND PROCEDURES</td>
<td width=52%>DELETE DATABASE</td>
</tr>
<tr valign=top>
<td width=48%>CLEAR ALL</td>
<td width=52%>DELETE TRIGGER</td>
</tr>
<tr valign=top>
<td width=48%>CLOSE ALL<sup>1</sup></td>
<td width=52%>DELETE VIEW</td>
</tr>
<tr valign=top>
<td width=48%>CLOSE DATABASES<sup>1</sup></td>
<td width=52%>MODIFY CONNECTION</td>
</tr>
<tr valign=top>
<td width=48%>COPY INDEXES</td>
<td width=52%>MODIFY DATABASE</td>
</tr>
<tr valign=top>
<td width=48%>COPY PROCEDURES</td>
<td width=52%>MODIFY PROCEDURE</td>
</tr>
<tr valign=top>
<td width=48%>CREATE CONNECTION</td>
<td width=52%>MODIFY VIEW</td>
</tr>
<tr valign=top>
<td width=48%>CREATE DATABASE</td>
<td width=52%>REMOVE TABLE</td>
</tr>
<tr valign=top>
<td width=48%>CREATE TRIGGER</td>
<td width=52%>RENAME TABLE</td>
</tr>
<tr valign=top>
<td width=48%>CREATE VIEW</td>
<td width=52%>REQUERY( )</td>
</tr>
<tr valign=top>
<td width=48%>CREATE SQL VIEW</td>
<td width=52%></td>
</tr>
</table><br>
<p class=mini>
<sup>1</sup> If CLOSE ALL is issued while a transaction is in progress, all tables in all open databases are closed. However, the databases remain open. Issuing CLOSE DATABASES within a transaction closes all tables in the current database, but the database remains open.</p>
<p>
Also, the following commands and functions cannot be issued for a specific table participating in a transaction:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=48%><b>Commands and functions</b></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%>ALTER TABLE</td>
<td width=52%>MODIFY STRUCTURE</td>
</tr>
<tr valign=top>
<td width=48%>CREATE TABLE</td>
<td width=52%>PACK</td>
</tr>
<tr valign=top>
<td width=48%>CURSORSETPROP( )</td>
<td width=52%>REINDEX</td>
</tr>
<tr valign=top>
<td width=48%>DELETE TAG</td>
<td width=52%>TABLEREVERT( )</td>
</tr>
<tr valign=top>
<td width=48%>INDEX</td>
<td width=52%>ZAP</td>
</tr>
<tr valign=top>
<td width=48%>INSERT</td>
<td width=52%></td>
</tr>
</table><br>
</BODY>
</HTML>
