<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ON BAR Command Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lngon_barx"></a><sup></sup>ON BAR Command Example</b></p>
<p>
The following example demonstrates a system of cascading submenus. A menu bar named <code>mnuDinner</code> is created with two menu bar titles. Each title uses ON PAD to activate the menu named <code>popMainCourse</code> or <code>popDessert</code>. The menus named <code>popMainCourse</code> and <code>popDessert</code> each have additional menus named <code>popBurger</code>, <code>popPizza</code> and <code>popPie</code> assigned to their item lists with three ON BAR commands. The <code>popOlives</code> and <code>popPie</code> items have additional menus assigned with two ON BAR commands.</p>
<p>
When you make a selection, ON SELECTION POPUP ALL executes a procedure named <code>yourchoice</code> that activates a window and displays your choice. The choice is determined with POPUP(&nbsp;) and PROMPT(&nbsp;), which return the name of the menu and the contents (text) of the menu item.</p>
<pre><code>DEFINE WINDOW wOrder FROM 10,0 TO 13,39
DEFINE MENU mnuDinner
DEFINE PAD padOne OF mnuDinner PROMPT '\&lt;Main Course' KEY ALT+M, ''
DEFINE PAD padTwo OF mnuDinner PROMPT '\&lt;Dessert'&nbsp;&nbsp; KEY ALT+D, ''
ON PAD padOne OF mnuDinner ACTIVATE POPUP popMainCourse
ON PAD padTwo OF mnuDinner ACTIVATE POPUP dessert
DEFINE POPUP popMainCourse MARGIN MESSAGE ;
 &nbsp; 'We have burgers and pizza today'
DEFINE BAR 1 OF popMainCourse PROMPT '\&lt;Hamburgers'
DEFINE BAR 2 OF popMainCourse PROMPT '\&lt;Pizza'
<span class=cfe><b>ON BAR</b></span> 1 <span class=cfe><b>OF</b></span> popMainCourse <span class=cfe><b>ACTIVATE POPUP</b></span> burger 
<span class=cfe><b>ON BAR</b></span> 2 <span class=cfe><b>OF</b></span> popMainCourse <span class=cfe><b>ACTIVATE POPUP</b></span> pizza 
DEFINE POPUP burger MARGIN MESSAGE ;
 &nbsp; 'What would you like on your burger?'
DEFINE BAR 1 OF burger PROMPT '\&lt;Ketchup'
DEFINE BAR 2 OF burger PROMPT '\&lt;Mustard'
DEFINE BAR 3 OF burger PROMPT '\&lt;Onions'
DEFINE BAR 4 OF burger PROMPT '\&lt;Pickles'
DEFINE POPUP pizza MARGIN MESSAGE ;
 &nbsp; 'Here are the available toppings'
DEFINE BAR 1 OF pizza PROMPT '\&lt;Anchovies'
DEFINE BAR 2 OF pizza PROMPT '\&lt;Green Peppers'
DEFINE BAR 3 OF pizza PROMPT '\&lt;Olives'
DEFINE BAR 4 OF pizza PROMPT '\&lt;Pepperoni'
<span class=cfe><b>ON BAR</b></span> 3 <span class=cfe><b>OF</b></span> pizza <span class=cfe><b>ACTIVATE POPUP</b></span> olives 
DEFINE POPUP olives MARGIN
DEFINE BAR 1 OF olives PROMPT '\&lt;Black' MESSAGE 'Black olives?'
DEFINE BAR 2 OF olives PROMPT '\&lt;Green' MESSAGE 'Green olives?'
DEFINE POPUP dessert MARGIN MESSAGE 'Our dessert offerings'
DEFINE BAR 1 OF dessert PROMPT '\&lt;Brownies'
DEFINE BAR 2 OF dessert PROMPT '\&lt;Cookies'
DEFINE BAR 3 OF dessert PROMPT '\&lt;Ice Cream'
DEFINE BAR 4 OF dessert PROMPT '\&lt;Pie'
<span class=cfe><b>ON BAR</b></span> 4 OF dessert <span class=cfe><b>ACTIVATE POPUP</b></span> pie 
DEFINE POPUP pie MARGIN MESSAGE 'What kind of pie?'
DEFINE BAR 1 OF pie PROMPT '\&lt;Blueberry'
DEFINE BAR 2 OF pie PROMPT '\&lt;Cherry'
DEFINE BAR 3 OF pie PROMPT '\&lt;Peach'
DEFINE BAR 4 OF pie PROMPT '\&lt;Rhubarb'
ON SELECTION POPUP ALL DO yourchoice
ACTIVATE MENU mnuDinner
PROCEDURE yourchoice
ACTIVATE WINDOW wOrder 
CLEAR
DO CASE
 &nbsp; CASE POPUP( ) = 'BURGER'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 0,0 SAY 'A ' + POPUP( ) + ' order:'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 1,0 SAY 'You ordered a burger with ' + LOWER(PROMPT( ))
 &nbsp; CASE POPUP( ) = 'PIZZA'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 0,0 SAY 'A ' + POPUP( ) + ' order:'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 1,0 SAY 'You ordered a pizza with ' + LOWER(PROMPT( ))
 &nbsp; CASE POPUP( ) = 'OLIVES'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 0,0 SAY 'A ' + POPUP( ) + ' order:'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 1,0 SAY 'You ordered a pizza with ' ;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + LOWER(PROMPT( )) + ' olives'
 &nbsp; CASE POPUP( ) = 'DESSERT'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 0,0 SAY 'A ' + POPUP( ) + ' order:'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 1,0 SAY 'You ordered ' + LOWER(PROMPT( )) + ' for dessert'
 &nbsp; CASE POPUP( ) = 'PIE'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 0,0 SAY 'A ' + POPUP( ) + ' order:'
 &nbsp;&nbsp;&nbsp;&nbsp; @ 1,0 SAY 'You ordered ' + LOWER(PROMPT( )) + ' pie'
ENDCASE
WAIT WINDOW
DEACTIVATE WINDOW wOrder
RETURN
</code></pre>
</BODY>
</HTML>
