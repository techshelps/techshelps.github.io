<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FUNCTION Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngfunction"></a><sup></sup>FUNCTION Command</h1>
<p>
<a href="lngfunctionx.htm">Example</a> &nbsp; <a href="lngfunctionsa.htm">See Also</a></p>
<p>
Identifies the start of a definition for a user-defined function.</p>
<p class=label>
<b>Syntax</b></p>
<p>
FUNCTION <i>FunctionName</i><br>
 &nbsp; <i>Commands</i><br>
 &nbsp; [RETURN [<i>eExpression</i>]]<br>
ENDFUNC</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>FunctionName</i></p>
<p class=indent>
In Visual FoxPro, function names can be up to 254 characters long.</p>
<p class=tl>
To distinguish a program file name with more than 10 characters from a function beginning with the same 10 characters in these two products, surround the program file name with quotation marks or include an extension after the program file name.</P><p class=label>
<b>Remarks</b></p>
<p>
In many programs, certain routines are frequently repeated. Defining commonly used routines as separate functions reduces program size and complexity and facilitates program maintenance.</p>
<p>
FUNCTION <i>FunctionName</i> is a statement within a program. It designates the beginning of a function in a program and identifies the function by name.</p>
<p>
FUNCTION <i>FunctionName</i> is followed by a series of Visual FoxPro commands that make up the function. You can include <a href="lngreturn.htm">RETURN</a> anywhere in the function to return control to the calling program or to another program, and to define a value returned by the user-defined function. If you do not include a RETURN command, an implicit RETURN is automatically executed when the function quits. If the RETURN command does not include a return value (or if an implicit RETURN is executed), Visual FoxPro assigns .T. (True) as the return value.</p>
<p>
The function ends with the ENDFUNC command. This command is optional; the function quits when it encounters another FUNCTION command, a PROCEDURE command, or the end of the program file.</p>
<p>
Comments can be placed on the same line after FUNCTION and ENDFUNC. These comments are ignored during compilation and program execution.</p>
<p>
You cannot have normal executable program code included in a program file after user-defined functions; only user-defined functions, procedures, and class definitions can follow the first FUNCTION or PROCEDURE command in the file.</p>
<p>
When you issue DO with a function name, Visual FoxPro searches for the function in a specific order as follows:
<ol>
<li>
Visual FoxPro searches the file containing the DO command.<br><br></li>
<li>
If the function isn't found there, Visual FoxPro searches the open procedure files. Procedure files are opened with SET PROCEDURE.<br><br></li>
<li>
If the function isn't found in an open procedure file, Visual FoxPro searches the programs in the execution chain. Program files are searched from the most recently executed program through the first program executed.<br><br></li>
<li>
If the function is still not found, Visual FoxPro searches for a stand-alone program. If a matching program file is found, the program is executed. Otherwise, Visual FoxPro generates an error message.</li>
</ol>
<p>
Include the IN clause in DO to execute a function in a specific file.</p>
<p>
By default, parameters are passed to functions by value. For information on passing parameters to functions by reference, see <a href="lngset_udfparms.htm">SET UDFPARMS</a>. A maximum of 27 parameters can be passed to a function. Parameters can be passed to a function by including a PARAMETERS or LPARAMETERS statement in the function, or by placing a list of parameters immediately after FUNCTION <i>FunctionName</i>. Enclose the list of parameters in a set of parentheses, and separate the parameters with commas.</p>
</BODY>
</HTML>
