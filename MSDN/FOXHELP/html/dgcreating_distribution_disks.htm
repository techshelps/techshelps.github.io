<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Distribution Disks</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="dgcreating_distribution_disks"></a><sup></sup>Chapter 26: Creating Distribution Disks</h1>
<p>
After you’ve designed and tested an application, you can use the Setup Wizard to create a setup routine and distribution disks for your application. If you plan to distribute your application in more than one disk format, the Setup Wizard creates routines and disks for all the formats you specify.</p>
<p>
For detailed information on preparing an application for distribution, see Chapter 25, <a href="dgbuilding_an_application_for_distribution.htm">Building an Application for Distribution</a>. For more information on creating an application, see Chapter 13, <a href="dgcompiling_an_application.htm">Compiling an Application</a>.</p>
<p>
This chapter outlines how to create distribution disks, including:</p>
<ul type=disc>
<li>
<a href="#dgunderstanding_the_distribution_process">Understanding the Distribution Process</a></li>
<li>
<a href="#dgusing_the_setup_wizard">Using the Setup Wizard</a></li>
</ul>

<h2><a name="dgunderstanding_the_distribution_process"></a>Understanding the Distribution Process</h2>
<p>
When you distribute an application, you copy all your application and support files to a distribution medium, commonly disks, and provide a method for users to install the application on their computers. Because copying and installing the right files can be complicated, use the Project Manager and the Setup Wizard to streamline this process.</p>
<p>
In the <a href="wndproject_manager.htm">Project Manager</a>, you create and manage your application files and identify the files that you want to distribute.</p>
<p>
With the <a href="wizsetup_wizard.htm">Setup Wizard</a>, you create one or more sets of distributable disks that contain a setup routine for your application. To simplify the task of creating a setup routine, the Setup Wizard asks you a series of questions about your application and how you would like the setup routine to appear. When you answer the questions, the Setup Wizard creates a customized setup routine for you.</p>
<p>
Each time you run the Setup Wizard, the options you select for that distribution tree are recorded. That way, the next time you run the Setup Wizard, the process is even simpler.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you just copy your application’s files to a user’s machine, the application might not function properly. Windows setup routines, such as the one created by the Setup Wizard, require version checking and registration of various DLL and ActiveX files. To ensure proper installation, use the <a href="wizsetup_wizard.htm">Setup Wizard</a>. For more information, see <a href="#dgthe_setup_wizard">The Setup Wizard</a> later in this chapter.</p>
<h3>The Distribution Tree</h3>
<p>
Before you create disks with the Setup Wizard, you must create a directory structure, or distribution tree, that contains all the distribution files as you’d like them to appear on your user’s hard drive. Place all the files that you want to be on your distribution disks into this distribution tree.</p>
<p class=label>
<b>Mapping the distribution tree to the disk images</b></p>
<p>
<img src="afd26001.gif" border=0></p>
<p>
This distribution tree can assume almost any form. However, your application or executable file must reside in the root directory of the tree.</p>
<p>
Many Visual FoxPro applications require additional resource files. For example, you might want to include a configuration or Help file. If you need to add a resource file and haven't included it in your project, place the file in the application directory structure.</p>
<p>
The following table lists some typical files that are placed in the application directory.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=47%><b>If you are</b></td>
<td class=label width=53%><b>Add these files to your application directory</b></td>
</tr>
<tr valign=top>
<td width=47%>Applying a custom configuration to your application</td>
<td width=53%>Config.fpw or other configuration file</td>
</tr>
<tr valign=top>
<td width=47%>Supplying custom settings for your application</td>
<td width=53%>Foxuser.dbf and<br>
Foxuser.fpt</td>
</tr>
<tr valign=top>
<td width=47%>Distributing Visual FoxPro fonts</td>
<td width=53%>Foxfont<br>
Foxprint</td>
</tr>
<tr valign=top>
<td width=47%>Distributing a support library</td>
<td width=53%><i>LibraryName</i>.ocx or <i>LibraryName</i>.fll</td>
</tr>
<tr valign=top>
<td width=47%>Including a locale-specific resource file</td>
<td width=53%>Vfp6raaa.dll, where “aaa” is the three-letter language code.</td>
</tr>
</table><br>
<p>
When you run the Setup Wizard, it creates a separate distribution directory for each disk format you specify. These directories contain all the necessary files for your disk images.</p>
<p>
For example, if you specify both 1.44-MB and Netsetup disk images, the Setup Wizard creates two subdirectories called DISK144 and NETSETUP. If your application requires four distribution disks, the Setup Wizard creates four subdirectories named DISK1, DISK2, DISK3, and DISK4 in the DISK144 directory.</p>
<p class=indent>
<B><b>Important</b></B>&nbsp;&nbsp;&nbsp;Because the Setup Wizard creates two new subdirectories on your hard disk, be sure you have enough disk space for three uncompressed copies of your application.</p>

<h3><a name="dgthe_setup_wizard"></a>The Setup Wizard</h3>
<p>
The <a href="wizsetup_wizard.htm">Setup Wizard</a> creates a setup routine for your application, which includes a Setup.exe file, some information files, and the compressed or uncompressed application files (stored in .cab files). The end result is a set of files that can be put onto diskettes, a network, or a web site. Users can then install your application the way they install any Windows application. While they're installing your application, users will see options that you specify when using the Setup Wizard.</p>
<p>
After you create the distribution tree, use the Setup Wizard to create a set of disk image subdirectories containing all the files needed to install your application. You copy the files from these subdirectories to create the distribution disks for your application.</p>
<p>
The Setup Wizard performs the following steps:
<ol>
<li>
Creates a file called Wzsetup.ini that contains your Setup Wizard choices for this distribution tree.<br><br></li>
<li>
Ensures all the files needed to run your distributed application are included with the application.<br><br></li>
<li>
Copies the compressed files into subdirectories it creates in the distribution disk directory.<br><br></li>
<li>
Creates setup files in the specified image directories, including Setup.inf and Setup.stf that specify installation parameters for the setup routine.<br><br></li>
<li>
Creates files named Dkcontrl.dbf and Dkcontrl.cdx in your distribution tree. These files contain statistical information about how files were compressed and assigned to disk subdirectories.</li>
</ol>

<h2><a name="dgusing_the_setup_wizard"></a>Using the Setup Wizard</h2>
<p>
Use the <a href="wizsetup_wizard.htm">Setup Wizard</a> to create distribution disks from the files in your distribution tree. The Setup Wizard enables you to create new setup routines or use information in the distribution tree as defaults.</p>
<p>
The Setup Wizard requires a working directory called Distrib.src. If this is the first time you are using the Setup Wizard, or if for some reason the Distrib.src directory is in a location different from where the Setup Wizard is looking for it, you will see a message indicating that the directory cannot be found.</p>
<p class=label>
<b>To create a setup routine and distribution directory</b>
<ol>
<li>
From the <b>Tools</b> menu, choose <b>Wizards</b>.<br><br></li>
<li>
From the <b>Wizards</b> submenu, choose <b>Setup</b>.<br><br></li>
<li>
If the Setup Wizard prompts you to create or locate the Distrib.src directory, confirm that you want to create it, or choose <b>Locate</b> and specify the location of the directory.</li>
</ol>
<p>
For details about the options available in each screen of the Setup Wizard click the Help button in that screen or press F1.</p>
<h3>Specifying the Distribution Tree</h3>
<p>
To specify the distribution tree, use <a href="wizsetup_wizard_step_1.htm">Step 1</a> of the Setup Wizard. You should identify the distribution tree directory that you created to model the user installation of your application files.</p>
<p>
The Setup Wizard expects the specified directory to contain all files and subdirectories you want to create in a user’s environment. The Setup Wizard uses this directory as the source for files that it will compress into the disk image directory.</p>
<p>
The Setup Wizard records the options you set for each distribution tree and uses them as default values the next time you create a setup routine from the same distribution tree.</p>
<h3>Selecting Optional Components</h3>
<p>
To specify the optional components your application uses or supports, use <a href="wizsetup_wizard_step_2.htm">Step 2</a> of the Setup Wizard. For example, if you want to make your application available using the run-time version of Visual FoxPro, choose Visual FoxPro Runtime so that the Setup Wizard includes the necessary runtime support file (Vfp6r.dll). If you're making your application available as an Automation server, choose that option.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If your application includes an Automation server, the Setup program will register it automatically on the user’s computer when the user installs the application.</p>
<h3>Specifying Disk Images</h3>
<p>
To specify the different disk types that your application can be loaded from, use <a href="wizsetup_wizard_step_3.htm">Step 3</a> of the Setup Wizard.</p>
<p>
The Setup Wizard asks you to specify the different types of disks that your application can be loaded from. You can choose any or all of the following options:</p>
<ul type=disc>
<li>
1.44 MB (3.5 inch ) disks</li>
<li>
Compress Wetsetup</li>
<li>
Uncompressed Netsetup</li>
</ul>
<p>
The Setup Wizard also prompts you for the name of a distribution subdirectory containing disk images for each type of disk you specify. You can create the disk image directory before you run the Setup Wizard, or you can let the Setup Wizard create the directory for you.</p>
<p>
If you select one of the Netsetup options, the Setup Wizard creates a single directory that will contain all the files.</p>
<h3>Customizing Distributed Installation Dialog Boxes</h3>
<p>
To customize the distributed installation dialog boxes, use <a href="wizsetup_wizard_step_4.htm">Step 4</a> of the Setup Wizard.</p>
<p>
The Setup Wizard asks you to specify the setup routine dialog box titles and the contents of the copyright statement.</p>
<p>
The Setup Wizard creates installation dialog boxes with the title you specify.</p>
<h3>Specifying a Post-Setup Action</h3>
<p>
To specify a program or action that Setup should run when the installation is finished, use <a href="wizsetup_wizard_step_4.htm">Step 4</a> of the Setup Wizard. Typical post-setup actions might be to display a readme file or launch the setup process for a related product.</p>
<p>
The Setup Wizard asks you to specify the name of the executable. Enter the complete command line required to run the executable, including the full path of the executable, the name of any files to pass to the program, and any command-line switches.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The program that you specify must exist on the user’s system, or an error will result.</p>
<h3>Identifying Default File Destinations</h3>
<p>
To identify the default destinations for your application files, use <a href="wizsetup_wizard_step_5.htm">Step 5</a> of the Setup Wizard.</p>
<p>
The Setup Wizard asks you to specify:</p>
<ul type=disc>
<li>
The default name of the directory in which the installation program will place your application on a user’s machine.</li>
<li>
The default program group in which to place the startup icon for your application on a user’s machine.</li>
</ul>
<p>
The setup routine will place your application in the directory folder you specify and the default application icon (or any icon you specify) in the named program group.</p>
<p>
You can specify whether the completed setup routine will enable the user to modify either the default program group or both the default destination directory and program group.</p>
<h3>Reviewing the File Summary</h3>
<p>
To display the results of all your choices, use <a href="wizsetup_wizard_step_6.htm">Step 6</a> of the Setup Wizard.</p>
<p>
The Setup Wizard displays a summary of your files and the results of all your choices and allows you to make changes in file names, file destinations, and other specifications.</p>
<h3>Finishing the Setup Wizard Process</h3>
<p>
To start creating the setup routine for your application, choose Finish in <a href="wizsetup_wizard_step_7.htm">Step 7</a> of the Setup Wizard. In this step you can also can also create a dependency (.dep) file that allows you to use other setup utilities to install your application.</p>
<p>
When you choose Finish, the Setup Wizard performs the following steps:</p>
<ul type=disc>
<li>
It records the configuration for use the next time you create distribution disks from the same distribution tree.</li>
<li>
It launches the process of creating the application disk images.</li>
</ul>
<p>
After the Setup Wizard creates the disk images you specified, you can copy the images to master disks, then copy and combine the disks with the rest of your distribution package. After you create a set of master disks, you can delete the disk image directories. </p>
</BODY>
</HTML>
