<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DEFINE BAR Command Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lngdefine_barx"></a><sup></sup>DEFINE BAR Command Example</b></p>
<p>
The following example uses DEFINE BAR to create items on menus. The current system menu bar is first saved to memory with SET SYSMENU SAVE, and then all system menu titles are removed with SET SYSMENU TO.</p>
<p>
Two new system menu titles are created with DEFINE PAD, and DEFINE POPUP is used to create a drop-down menu for each menu title. DEFINE BAR is used to create items on each of the menus. When a menu title is chosen, ON PAD uses ACTIVATE POPUP to activate the corresponding menu.</p>
<p>
When an item is chosen from a menu, ON SELECTION POPUP uses PROMPT(&nbsp;) and POPUP(&nbsp;) to pass the item number and menu name to the CHOICE procedure. CHOICE displays the prompt of the chosen item and the name of the menu containing the item. If Exit is chosen from the Card Info menu, the original Visual FoxPro system menu is restored.</p>
<pre><code>*** Name this program DEFINBAR.PRG ***
CLEAR
SET SYSMENU SAVE
SET SYSMENU TO
DEFINE PAD convpad OF _MSYSMENU PROMPT '\&lt;Conversions' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+C, ''
DEFINE PAD cardpad OF _MSYSMENU PROMPT 'Card \&lt;Info' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+I, ''
ON PAD convpad OF _MSYSMENU ACTIVATE POPUP conversion
ON PAD cardpad OF _MSYSMENU ACTIVATE POPUP cardinfo
DEFINE POPUP conversion MARGIN RELATIVE COLOR SCHEME 4
<span class=cfe><b>DEFINE BAR</b></span> 1 <span class=cfe><b>OF</b></span> conversion <span class=cfe><b>PROMPT</b></span> 'Ar\&lt;ea'<span class=cfe><b> KEY </b></span>CTRL+E, '^E'
<span class=cfe><b>DEFINE BAR</b></span> 2 <span class=cfe><b>OF</b></span> conversion <span class=cfe><b>PROMPT</b></span> '\&lt;Length' ;
 &nbsp; <span class=cfe><b>KEY</b></span> CTRL+L, '^L'
<span class=cfe><b>DEFINE BAR</b></span> 3 <span class=cfe><b>OF</b></span> conversion <span class=cfe><b>PROMPT</b></span> 'Ma\&lt;ss' ;
 &nbsp; <span class=cfe><b>KEY</b></span> CTRL+S, '^S'
<span class=cfe><b>DEFINE BAR</b></span> 4 <span class=cfe><b>OF</b></span> conversion <span class=cfe><b>PROMPT</b></span> 'Spee\&lt;d' ;
 &nbsp; <span class=cfe><b>KEY</b></span> CTRL+D, '^D'
<span class=cfe><b>DEFINE BAR</b></span> 5 <span class=cfe><b>OF</b></span> conversion <span class=cfe><b>PROMPT</b></span> '\&lt;Temperature' ;
 &nbsp; <span class=cfe><b>KEY</b></span> CTRL+T, '^T'
<span class=cfe><b>DEFINE BAR</b></span> 6 <span class=cfe><b>OF</b></span> conversion <span class=cfe><b>PROMPT</b></span> 'T\&lt;ime' ;
 &nbsp; <span class=cfe><b>KEY</b></span> CTRL+I, '^I'
<span class=cfe><b>DEFINE BAR</b></span> 7 <span class=cfe><b>OF</b></span> conversion <span class=cfe><b>PROMPT</b></span> 'Volu\&lt;me' ;
 &nbsp; <span class=cfe><b>KEY</b></span> CTRL+M, '^M'
ON SELECTION POPUP conversion;
 &nbsp; DO choice IN definbar WITH PROMPT( ), POPUP( )
DEFINE POPUP cardinfo MARGIN RELATIVE COLOR SCHEME 4
<span class=cfe><b>DEFINE BAR</b></span> 1 <span class=cfe><b>OF</b></span> cardinfo <span class=cfe><b>PROMPT</b></span> '\&lt;View Charges' ;
 &nbsp; <span class=cfe><b>KEY</b></span> ALT+V, ''
<span class=cfe><b>DEFINE BAR</b></span> 2 <span class=cfe><b>OF</b></span> cardinfo <span class=cfe><b>PROMPT</b></span> 'View \&lt;Payments' ;
 &nbsp; <span class=cfe><b>KEY</b></span> ALT+P, ''
<span class=cfe><b>DEFINE BAR</b></span> 3 <span class=cfe><b>OF</b></span> cardinfo <span class=cfe><b>PROMPT</b></span> 'Vie\&lt;w Users' <span class=cfe><b>KEY</b></span> ALT+W, ''
<span class=cfe><b>DEFINE BAR</b></span> 4 <span class=cfe><b>OF</b></span> cardinfo <span class=cfe><b>PROMPT</b></span> '\-'
<span class=cfe><b>DEFINE BAR</b></span> 5 <span class=cfe><b>OF</b></span> cardinfo <span class=cfe><b>PROMPT</b></span> '\&lt;Charges '
<span class=cfe><b>DEFINE BAR</b></span> 6 <span class=cfe><b>OF</b></span> cardinfo <span class=cfe><b>PROMPT</b></span> '\-'
<span class=cfe><b>DEFINE BAR</b></span> 7 <span class=cfe><b>OF</b></span> cardinfo <span class=cfe><b>PROMPT</b></span> 'E\&lt;xit '
ON SELECTION POPUP cardinfo;
 &nbsp; DO choice IN definbar WITH PROMPT( ), POPUP( )
PROCEDURE choice
PARAMETERS mprompt, mpopup
WAIT WINDOW 'You chose ' + mprompt + ;
 &nbsp; ' from popup ' + mpopup NOWAIT
IF mprompt = 'Exit'
 &nbsp; SET SYSMENU TO DEFAULT
ENDIF
</code></pre>
</BODY>
</HTML>
