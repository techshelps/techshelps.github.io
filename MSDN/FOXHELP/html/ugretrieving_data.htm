<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving Data</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="ugretrieving_data"></a><sup></sup>Chapter 4: Retrieving Data</h1>
<p>
When you need answers quickly, use the Query Designer to retrieve the information stored in your tables and views. For example, you might need to know the answers to questions like:</p>
<ul type=disc>
<li>
What customer name and address is associated with a particular ID number?</li>
<li>
How many orders are outstanding?</li>
<li>
How many customers have overdue balances?</li>
<li>
Which region or salesperson has the best sales record?</li>
</ul>
<p>
With the Query Designer, you can search for records that meet the criteria you specify. You can also order and group the records as needed, and create reports, tables, and graphs based on the results. </p>
<p>
This chapter describes how to create and work with simple read-only queries based on tables (.dbf files) or views. For information about working with multitable local queries or remote data, see Chapter 6, <a href="ugquerying_and_updating_multiple_tables.htm">Querying and Updating Multiple Tables</a>, For information about creating views, see Chapter 5, <a href="ugupdating_data_with_views.htm">Updating Data with Views</a>. </p>
<p>
This chapter discusses:</p>
<ul type=disc>
<li>
<a href="#ugcreating_a_query">Creating a Query</a></li>
<li>
<a href="#ugdefining_your_results">Defining Your Results</a></li>
<li>
<a href="#ugorganizing_your_results">Organizing Your Results</a><br><br></li>
<li>
<a href="#ugrunning_your_query">Running Your Query</a></li>
<li>
<a href="#ugcustomizing_queries">Customizing Queries</a></li>
</ul>

<h2><a name="ugcreating_a_query"></a>Creating a Query</h2>
<p>
You may want to create queries for various reasons: to organize information for a report, to answer a quick question, or to see any relevant subset of your data. Whatever your aim, the basic process of creating a query is the same.</p>
<p>
Using the <a href="wndquery_designer.htm">Query Designer</a>, you select the table or view you want information from, specify the criteria to extract records from the table or view, and then direct the results of your query to the type of output you want, such as a browse window, report, table, label, and so on. When you’ve created a query you want to keep, you can save it by giving it a name. Queries are stored as files with a .qpr extension.</p>
<p class=label>
<b>The query design process</b></p>
<p>
<img src="afu04008.gif" border=0></p>
<p>
After you have decided what information you need to find, and what table or view it is stored in, you’ll go through the following general steps when creating queries:
<ol>
<li>
Start creating the query with a query wizard or the <a href="wndquery_designer.htm">Query Designer</a>.<br><br></li>
<li>
Select the table or view that holds the information you want to retrieve.<br><br></li>
<li>
Define your query results by choosing which fields you want, the order you want the fields to appear, and the records you want.<br><br></li>
<li>
Organize your query results by ordering and grouping the rows in the results.<br><br></li>
<li>
Choose the type of output you want for the query: table, report, browse, and so on.<br><br></li>
<li>
Run and verify the query.</li>
</ol>
<h3>Using a Query Wizard</h3>
<p>
If you want help creating a query quickly, use one of the Visual FoxPro query wizards. A query wizard asks you in which tables or views you want to search for information, and sets up a query based on your answers to a series of questions.</p>
<p>
For more information about the query wizards, press F1 for Help while you are using the wizard.</p>
<p class=label>
<b>To create a query with a wizard</b>
<ol>
<li>
In the <b>Project Manager</b>, select the <b>Data</b> tab and choose <b>Queries</b>.<br><br></li>
<li>
Choose <b>New</b>.<br><br></li>
<li>
Choose the <b>Query Wizard</b> button.<br><br></li>
<li>
Select the type of query you want to create.<br><br></li>
<li>
Follow the instructions on the wizard screens.</li>
</ol>
<p>
You can also choose <b>Wizards</b> on the <b>Tools</b> menu to start a wizard.</p>
<h3>Starting the Query Designer</h3>
<p>
If you don’t want to use a query wizard, you can use the Query Designer to create your query. You can start the Query Designer from the Project Manager or from the File menu.</p>
<p class=label>
<b>To start the Query Designer</b>
<ol>
<li>
In the <b>Project Manager</b>, select the <b>Data</b> tab.<br><br></li>
<li>
Select <b>Queries</b>.<br><br></li>
<li>
Choose <b>New</b>.<br><br></li>
<li>
Choose <b>New Query</b>.</li>
</ol>
<p>
You can also start the Query Designer by choosing <b>New</b> from the <b>File</b> menu, selecting the <b>Query</b> option, and selecting <b>New File</b>.</p>
<p>
When you create a new query, you will be prompted to select a table or view from the current database or from a free table.</p>
<p class=label>
<b>Selecting a table or view to query</b></p>
<p>
<img src="afu04010.gif" border=0></p>
<p>
After you select a table or view, Visual FoxPro displays the Query Designer window. </p>
<p class=label>
<b>The Query Designer window</b></p>
<p>
<img src="afu04011.gif" border=0></p>
<p>
You can easily change to a different table or view.</p>
<p class=label>
<b>To use a different table or view</b>
<ol>
<li>
Select the current table and choose the <b>Remove Table</b> button on the <b>Query Designer</b> toolbar.<br><br></li>
<li>
From the <b>Query Designer</b> toolbar, choose the <b>Add</b> button, and then select the table or view you want.</li>
</ol>

<h2><a name="ugdefining_your_results"></a>Defining Your Results</h2>
<p>
After you have opened the Query Designer and selected the table or view that contains the information you want, you can define your results. At a minimum, you need to select the fields you want. You can also define your results by setting the order the selected fields appear and setting filters to select which records appear.</p>
<h3>Selecting Fields You Want</h3>
<p>
Before you can run a query, you must select some fields to include in the results. In some cases, you might want to use all the fields from the table or view. At other times, you might want to focus the query on a few selected fields, such as fields you want to include in a report.</p>
<p>
Be sure to include any fields you might want to use to sort or group the results of your query. When you select the fields, you can also set the order they appear in your output.</p>
<p>
Use the <a href="cmdquery_and_view_designers_fields_tab.htm">Fields tab</a> in the lower pane of the Query Designer to select the fields you want to include in the results of your query.</p>
<p class=label>
<b>The Fields tab in the Query Designer</b></p>
<p>
<img src="afu04012.gif" border=0></p>
<p class=label>
<b>To add a field to the query output</b>
<ul type=disc>
<li>
Select the name of the field and choose <b>Add</b>.<p class=tl>
-or-</P></li>
<li>
Drag the field name to the <b>Selected fields</b> box.</li>
</ul>
<h4>Selecting All Fields for Output</h4>
<p>
You can select all of the fields by name or use the asterisk wild card. If you select the fields by name, the exact names of the fields are included in the query. If you run the query after adding fields to the table, the new fields are not included in the results.</p>
<p>
If you use the wild card, the asterisk is included in the query and includes all fields that are in the table at the time of the query. If the table structure has changed since the query was created, the new fields also appear in the query results.</p>
<p class=label>
<b>To add all available fields to a query at once</b>
<ul type=disc>
<li>
Choose <b>Add All </b>to add fields by name.<p class=tl>
-or-</P></li>
<li>
Drag the asterisk at the top of the table into the <b>Selected fields</b> box.</li>
</ul>
<h4>Displaying an Alias for a Field</h4>
<p>
You can make your query results easier to read and understand by adding a descriptive caption to a results field. For example, you might want to display the word “SumMaxOrd” at the top of the results column instead of the field name or expression, SUM(MaxOrdAmount).</p>
<p class=label>
<b>To add an alias for a field</b>
<ol>
<li>
In the <b>Functions and expressions</b> box, type the field name, and then type <b>AS</b> and the alias, as in this example:<pre><code>SUM(maxorderamt) AS SumMaxOrd
</code></pre>
</li>
<li>
Choose <b>Add</b> to place the field with the alias in the <b>Selected fields</b> box.</li>
</ol>
<h3>Setting the Order for Output Fields</h3>
<p>
The order that fields appear in the Fields tab determines the order of the columns of information in your query output.</p>
<p class=label>
<b>Setting the order of output columns</b></p>
<p>
<img src="afu04013.gif" border=0></p>
<p class=label>
<b>To change the column order of the query output</b>
<ul type=disc>
<li>
Drag the mover box, located to the left of a field name, up or down.</li>
</ul>
<p>
If you want to change the order that rows of information will be sorted, use the <a href="cmdquery_and_view_designers_order_by_tab.htm">Order By tab</a> instead.</p>
<h3>Selecting the Records You Want</h3>
<p>
Selecting the records you want to find is the key step that determines the results of your query. With the <a href="cmdquery_and_view_designers_filter_tab.htm">Filter tab</a> in the Query Designer, you can formulate the WHERE clause of a select statement to tell Visual FoxPro which records to search for and retrieve.</p>
<p>
You may want to find a specific subset of data to include in a report or other output: for example, all customers with outstanding balances, all customers in a specific region or postal code, and so on. To see only the records you want, enter a value or range of values to compare the records against.</p>
<p>
In Visual FoxPro, you use the <a href="cmdquery_and_view_designers_filter_tab.htm">Filter tab</a> to specify which field you want to use for selecting records, choose a comparison criterion, and enter an example of the value you want the field to be compared to.</p>
<p class=label>
<b>Defining criteria for query results</b></p>
<p>
<img src="afu04014.gif" border=0></p>
<p class=label>
<b>To specify a filter</b>
<ol>
<li>
From the <b>Field Name</b> list, choose a field you want to use as the basis for selecting records.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;You can’t use General or Memo fields in a filter.</p></li>
<li>
From the <b>Criteria</b> list, choose the type of comparison to use.<br><br></li>
<li>
Enter the comparison criterion in the <b>Example</b> box.<ul type=disc>
<li>
Use quotation marks only if the string is the same as the name of a field in a table in the query; otherwise, do not enclose character strings in quotation marks.<br><br></li>
<li>
If you use dates, do not enclose them in braces.<br><br></li>
<li>
Place a period before and after a logical literal (.T.).<br><br></li>
<li>
If you enter a field name from a table in the query, Visual FoxPro will recognize it as a field.</li>
</ul>
</li>
<li>
If you want capitalization to be ignored in searches on character data, select the <b>Case</b> button.</li>
</ol>
<p>
If you want to reverse the meaning of a logical operator, select the Not button. For example, if you want to find customers in all regions <i>except</i> Washington, use the selection expression in the following example:</p>
<pre><code>Customer.region Not Like WA
</code></pre>
<p>
To further tune your search, you can add more filters in the Filter tab. For more information, see the section, <a href="#ugfine_tuning_your_search">Fine-Tuning Your Search</a>, later in this chapter.</p>
<p>
If you are using more than one table or view in your query, you can expand the records you select by the join type you choose. For more information about joins, see Chapter 8, <a href="dgcreating_views.htm">Creating Views</a>, in the <i>Programmer’s Guide</i>.</p>

<h2><a name="ugorganizing_your_results"></a>Organizing Your Results</h2>
<p>
With the output of your query defined, you can now organize the records that appear in your results by ordering and grouping on the output fields. If you want, you can also filter the groups that appear in your results.</p>
<h3>Ordering Query Results</h3>
<p>
Ordering determines the order in which records or rows will be sorted when they appear in the output of your query. For example, you could sort records by State and then by City, or sort them in ascending order based on the outstanding account balance.</p>
<p>
Use the <a href="cmdquery_and_view_designers_order_by_tab.htm">Order By</a> tab to set the sort order for your query. The sort order determines the order in which rows or records will appear in your query output.</p>
<p>
First select the fields you want to use from the Selected Fields box and move them to the Ordering Criteria box. Then arrange the fields in the order you want them to appear in the query results.</p>
<p class=label>
<b>To set ordering criteria</b>
<ol>
<li>
In the <b>Selected fields</b> box, select a field name.<br><br></li>
<li>
Choose <b>Add</b>.</li>
</ol>
<p class=label>
<b>To remove ordering criteria</b>
<ol>
<li>
Select one or more fields that you want to remove.<br><br></li>
<li>
Choose <b>Remove</b>.</li>
</ol>
<p>
The order in which fields appear in the Ordering criteria box determines the order of importance when the query results are sorted. The first field determines the primary sort order.</p>
<p>
For example, if the first field in the Ordering criteria box is <code>Customer.region</code> and the second field in the Ordering criteria box is <code>Customer.city</code>, the results will be ordered by <code>Customer.region</code>. If more than one record in the customer table has the same <code>region</code> field value, these records are additionally ordered by <code>Customer.city</code>.</p>
<p class=label>
<b>Setting sort order with the Order By tab</b></p>
<p>
<img src="afu04015.gif" border=0></p>
<p>
To adjust the importance of a sort order field, use the button to the left of the field to drag the field to the desired location in the Ordering criteria box.</p>
<p>
You can sort in ascending or descending order by setting the buttons in the Order options area. Each order field appears in the Output fields box on the Filter tab with an up arrow or down arrow next to it, indicating whether the sort on that field is to be made in ascending or descending order.</p>
<h3>Grouping Query Results</h3>
<p>
Grouping consolidates or gathers similar records into one record so you can perform calculations based on groups of records. For example, you might want to find the sum of all orders to a specific region. Instead of looking at all the records individually, you can group all the records from the same region into one record, and get the sum of all the orders from that region. To control how records are grouped, use the <a href="cmdquery_and_view_designers_group_by_tab.htm">Group By tab</a> in the Query Designer.</p>
<p>
Grouping is most useful when used in conjunction with an aggregate function, such as SUM, COUNT, AVG, and so on.</p>
<p>
For example, suppose you want to see the total dollar amount of orders for each customer ID number in your orders table. You need to group all the order records for a given customer ID into one record, and find the sum of the order amounts.</p>
<p>
You first use the Fields tab to add the expression SUM(Orders.order_net) to the output of your query, then use the Group By tab to group the results by customer ID number. The results show total net orders for each customer:</p>
<p class=label>
<b>Setting Group By options</b></p>
<p>
<img src="afu04016.gif" border=0></p>
<p class=label>
<b>To set grouping options</b>
<ol>
<li>
In the <b>Fields</b> tab, type the expression in the <b>Functions and expressions</b> box.<p class=tl>
-or-</P><p class=tl>
Choose the dialog button to use the <b>Expression Builder</b> to enter an expression in the <b>Functions and expressions</b> box.</P></li>
<li>
Choose the <b>Add</b> button to place the expression in the <b>Selected fields</b> box.<br><br></li>
<li>
In the <b>Group By</b> tab, add the expression to group results by.</li>
</ol>
<p>
You can also set a filter on the grouped results.</p>
<h3>Selecting the Groups You Want</h3>
<p>
To set a filter on grouped or consolidated records rather than on individual records, choose Having on the Group By tab. You can use a field name, an aggregate function on a field name, or another expression in the Field Name box.</p>
<p>
Building on the previous example, you could use the query that shows total sales by customer number, then use the Having button to restrict the output to customers having more than $50,000 in net orders:</p>
<p class=label>
<b>Setting criteria for a group</b></p>
<p>
<img src="afu04026.gif" border=0></p>
<p class=label>
<b>To set a Having option on a group</b>
<ol>
<li>
In the <b>Group By</b> tab, choose <b>Having</b>.<br><br></li>
<li>
In the <b>Having</b> dialog box, select a function and field name in the Field Name field.<br><br></li>
<li>
Choose <b>OK</b>.</li>
</ol>

<h2><a name="ugrunning_your_query"></a>Running Your Query</h2>
<p>
When you have finished designing your query, you can start the query by choosing the Run button. Visual FoxPro executes the SQL select statement you built with the Query Designer, and sends the results to a <a href="wndbrowse_window.htm">Browse window</a>.</p>
<p class=label>
<b>To run a query</b>
<ul type=disc>
<li>
In the <b>Project Manager</b>, select the name of the query, then choose <b>Run</b>.</li>
</ul>
<p>
If you want your results to go to a different destination, you can direct your results to a form, table, report, or other destinations. If you like to know what the SQL statement looks like, you can view the SQL statement that you built.</p>
<p>
For more information, see <a href="lngselect___sql.htm">SELECT - SQL</a>.</p>
<h3>Directing the Results of Your Query</h3>
<p>
You can send the results of your query to different destinations. If you have not selected an output destination, the results of your query will be shown in a Browse window.</p>
<p>
When you choose Query Destination on the Query menu, or choose the Query Destination button on the Query toolbar, the <a href="cmdquery_destination_dialog_box.htm">Destination dialog box</a> displays, so you can choose where to send your query results.</p>
<p class=label>
<b>To choose a query destination</b>
<ol>
<li>
From the <b>Query Designer</b> toolbar, choose <b>Query Destination</b>.<br><br></li>
<li>
In the <b>Query Destination</b> dialog box, choose an output destination, and fill out any additional fields as required.<p class=label>
<b>Choosing a query destination</b>
<p>
<img src="afu04018.gif" border=0></P></li>
</ol>
<p>
Use this table to choose the destination for your query output.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=59%><b>If you want to</b></td>
<td class=label width=41%><b>Choose this output option</b></td>
</tr>
<tr valign=top>
<td width=59%>Display the results of your query in a Browse window </td>
<td width=41%>Browse</td>
</tr>
<tr valign=top>
<td width=59%>Save the results of your query in a temporary read-only table with the name you assign it</td>
<td width=41%>Cursor</td>
</tr>
<tr valign=top>
<td width=59%>Save the results of your query as a table with the name you assign it</td>
<td width=41%>Table</td>
</tr>
<tr valign=top>
<td width=59%>Make the query results available for use with Microsoft Graph, a separate application included with Visual FoxPro</td>
<td width=41%>Graph</td>
</tr>
<tr valign=top>
<td width=59%>Display the results of your query in the main Visual FoxPro window, or in the currently active output window</td>
<td width=41%>Screen</td>
</tr>
<tr valign=top>
<td width=59%>Send the output to a report file (.frx)</td>
<td width=41%>Report</td>
</tr>
<tr valign=top>
<td width=59%>Sends the output to a label file (.lbx)</td>
<td width=41%>Label</td>
</tr>
</table><br>
<p>
Many of the options have additional choices you can make to affect the results. For example, the Report option lets you open a report file and customize the report before printing, or you can choose a Report Wizard to help you create the report. For more information, see Chapter 7, <a href="ugdesigning_reports_and_labels.htm">Designing Reports and Labels</a>.</p>
<h3>Verifying Your Query</h3>
<p>
If you want to make sure the query is properly defined, you can view the SQL statement built by the Query Designer. Also, you can add comments to the query describing its purpose. The comments you add appear in the SQL window.</p>
<h4>Viewing Your SQL Statement</h4>
<p>
At any time while you are creating your query, you can see the SQL statement your query is building by choosing View SQL from the Query menu or by choosing the SQL button on the toolbar.</p>
<p>
A read-only window displays the SQL statement. You can copy the text in the window and paste it into the Command window or incorporate it into a program.</p>
<p class=label>
<b>To see the SQL statement for your query</b>
<ul type=disc>
<li>
In the <b>Query Designer</b> toolbar, choose the <b>SQL</b> button.</li>
</ul>
<p class=label>
<b>The SQL statement for a query</b></p>
<p>
<img src="afu04019.gif" border=0></p>
<h4>Adding a Comment to Your Query</h4>
<p>
If you want to identify your query in some manner, or add notes about it, you can add comments to your query that will help identify it and its purpose.</p>
<p class=label>
<b>To add a comment to a query</b>
<ol>
<li>
From the <b>Query</b> menu, choose <b>Comments</b>.<br><br></li>
<li>
In the <b>Comment</b> box, type any notes you want to make about the query.<br><br></li>
<li>
Choose <b>OK</b>.<p class=label>
<b>Adding comments to your query</b>
<p>
<img src="afu04020.gif" border=0></P></li>
</ol>
<p>
Comments you enter appear at the top of the SQL window, preceded by an asterisk.</p>

<h2><a name="ugcustomizing_queries"></a>Customizing Queries</h2>
<p>
Other options available with the Query Designer make it easy to further customize your queries. You can use filters to expand or narrow your search. You can also add expressions to perform calculations or functions on the data in your fields.</p>

<h3><a name="ugfine_tuning_your_search"></a>Fine-Tuning Your Search</h3>
<p>
You might find that you want more control over the results returned by a query. For example, you might want to find records that meet more than one criterion, such as customers from a given state who have outstanding balances greater than $1,000. Or, you might need to retrieve records that meet either one criterion or another: customers from Washington or from California. In either case, you need to add more statements to the Filter tab.</p>
<p>
In Visual FoxPro, filter statements are automatically combined with a logical AND when you enter them in successive rows in the Filter tab. If you want to retrieve records that meet two or more alternative conditions, you can insert a logical OR operator between rows with the Add Or button.</p>
<h4>Narrowing Your Search</h4>
<p>
If you want your query to retrieve only records that meet more than one criterion, list the criteria on separate lines in the Filter tab. Criteria in a series are combined with an implicit AND statement, so that only records that meet all the criteria listed will be retrieved.</p>
<p>
For example, suppose you are searching an employee table, and you want to see all the Sales Representatives in the United Kingdom. You would enter the two conditions you are searching for on separate lines:</p>
<p class=label>
<b>Combining two filters</b></p>
<p>
<img src="afu04021.gif" border=0></p>
<p class=label>
<b>To set AND conditions</b>
<ul type=disc>
<li>
Enter filters in the <b>Filter</b> tab, and choose <b>AND</b> in the <b>Logical</b> column.</li>
</ul>
<h4>Expanding Your Search</h4>
<p>
If you want your query to retrieve records that meet any of a series of filters, combine filters by inserting OR conditions between them.</p>
<p>
For example, you might want to search for customers who live in Washington or California:</p>
<p class=label>
<b>Adding an OR between two filters</b></p>
<p>
<img src="afu04022.gif" border=0></p>
<p class=label>
<b>To set OR conditions</b>
<ul type=disc>
<li>
Select a filter, and then choose <b>OR</b> in the <b>Logical</b> column.</li>
</ul>
<h4>Combining Conditions</h4>
<p>
You can also combine AND and OR conditions to select specific sets of records.</p>
<p>
For example, you might want to retrieve records for customers from Washington or California who have maximum order amounts larger than $5,000.</p>
<p class=label>
<b>Combining different filters</b></p>
<p>
<img src="afu04023.gif" border=0></p>
<h4>Eliminating Duplicate Records from a Query</h4>
<p>
Duplicate records are records in which every field of the result matches. If you want to remove duplicate records from the query results, select the No Duplicates box on the Miscellaneous tab. Otherwise, make sure the No Duplicates box is cleared.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If No Duplicates is selected, the word DISTINCT precedes the fields in the SELECT portion of the SELECT command.</p>
<h4>Retrieving a Number or Percentage of Top Records</h4>
<p>
You can specify how many or what percentage of records with the highest or lowest values in a particular field you want the query to return. For example, the query can display those records with the 10 highest or lowest values in a specific field or the records with the highest or lowest 10 percent of values in the field.</p>
<p>
Using the Top setting on the Miscellaneous tab, you can either set a number or a percentage of records you want to see. To set whether you are choosing the top or bottom, you set the sort order for your query to either descending to see the top or ascending to see the bottom.</p>
<p class=label>
<b>To retrieve a number or percentage of top records</b>
<ol>
<li>
In the <b>Order By</b> tab, select the field you want to retrieve top values for, then choose <b>Descending</b> to display the highest values or <b>Ascending</b> to display the lowest values. If you are sorting on additional fields, place them after the top values field in the order by list.<br><br></li>
<li>
In the <b>Miscellaneous</b> tab, type the number for the percentage or the number of highest or lowest values you want retrieved in the <b>Number of records</b> box. To display a percentage, choose <b>Percent</b>.<br><br></li>
<li>
If you do not want duplicate records included in the number or percentage, choose <b>No duplicates</b>.</li>
</ol>
<h3>Adding Expressions to a Query</h3>
<p>
You can create more flexible and powerful queries if you incorporate expressions, either in a filter or as result fields.</p>
<h4>Adding Expressions to Results</h4>
<p>
You can also include functions and expressions in the output of your query, using the box at the bottom of the Fields tab. If you want to name the field holding the expression, you can add an alias.</p>
<p>
For example, you might want your query results to include the sum of all order amounts with the alias <code>Total</code>:</p>
<pre><code>SUM(orders.order_amt) AS Total
</code></pre>
<p class=label>
<b>Creating an expression to include in your query results</b></p>
<p>
<img src="afu04024.gif" border=0></p>
<p>
You can type an expression directly into the box or use the <a href="wndexpression_builder_dialog_box.htm">Expression Builder</a> on the <a href="cmdquery_and_view_designers_fields_tab.htm">Fields tab</a>.</p>
<p class=label>
<b>To add an expression to your query output</b>
<ol>
<li>
In the <b>Fields</b> tab, type the expression in the <b>Functions and Expressions</b> box.<p class=tl>
-or-</P><p class=tl>
Choose the dialog button to use the <b>Expression Builder</b> and enter an expression in the <b>Functions and expressions</b> box.</P></li>
<li>
Choose the <b>Add</b> button to place the expression in the <b>Selected fields</b> box.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Null values are ignored in calculations. For more information on null values in expressions, search for “Null Values”.</p></li>
</ol>
<h4>Filtering with Expressions</h4>
<p>
Instead of simply searching for records that match one or more fields, you can use an expression to combine two fields, or perform a calculation based on a field and search for records that match the combined or calculated field.</p>
<p>
You can type expressions directly into the Example box. If you want some help, you can use the Expression Builder, which is available from the dialog button next to the Expressions and Functions box in the Fields tab.</p>
<p>
For example, using the Orders table, you might want to check total discounts for a customer by combining order amount and order discount in an expression like the following:</p>
<pre><code>Orders.order_amt * Orders.order_dsc
</code></pre>
<p class=label>
<b>Creating an expression in the Expression Builder</b></p>
<p>
<img src="afu04025.gif" border=0></p>
</BODY>
</HTML>
