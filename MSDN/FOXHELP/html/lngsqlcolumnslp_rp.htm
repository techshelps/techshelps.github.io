<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLCOLUMNS( ) Function</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngsqlcolumnslp_rp"></a><sup></sup>SQLCOLUMNS(&nbsp;) Function</h1>
<p>
<a href="lngsqlcolumnslp_rpx.htm">Example</a> &nbsp; <a href="lngsqlcolumnslp_rpsa.htm">See Also</a></p>
<p>
Stores a list of column names and information about each column for the specified data source table to a Visual FoxPro cursor.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLCOLUMNS(<i>nConnectionHandle</i>, <i>TableName</i><br>
 &nbsp;&nbsp; [, "FOXPRO" | "NATIVE"] [, <i>CursorName</i>])</p>
<p class=label>
<b>Returns</b></p>
<p>
Numeric</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>nConnectionHandle</i></p>
<p class=indent>
Active connection handle.</p>
<p class=dt>
<i>TableName</i></p>
<p class=indent>
Specifies the name of the table from which the column names are returned. <i>TableName</i> can contain the wildcard characters ? and *. The question mark (?) matches any single character and the asterisk (*) matches any number of characters.</p>
<p class=dt>
FOXPRO | NATIVE</p>
<p class=indent>
Specifies the format for the column information in the result set. Be sure to enclose FOXPRO or NATIVE in quotation marks. The NATIVE format option stores column information for tables in the same format as the data source. The FOXPRO format option stores the column information in the same format as that used for the Visual FoxPro table or cursor that would be created if you imported the data source table into Visual FoxPro. If you omit FOXPRO or NATIVE, the format option defaults to FOXPRO.</p>
<p class=tl>
The following table shows the columns in the result set for the FOXPRO format.</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=40%><b>Column name</b></td>
<td class=label width=60%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=40%>Field_name</td>
<td width=60%>Column name</td>
</tr>
<tr valign=top>
<td width=40%>Field_type</td>
<td width=60%>Column data type</td>
</tr>
<tr valign=top>
<td width=40%>Field_len</td>
<td width=60%>Column length</td>
</tr>
<tr valign=top>
<td width=40%>Field_dec</td>
<td width=60%>Number of decimal places</td>
</tr>
</table><br>
<p class=tl>
The following table shows the columns in the result set for the NATIVE format. In NATIVE format, depending on the data source, additional columns not listed in the following table may be included in the result set.</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=40%><b>Column name</b></td>
<td class=label width=60%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=40%>Table_qualifier</td>
<td width=60%>Table qualifier identifier</td>
</tr>
<tr valign=top>
<td width=40%>Table_owner</td>
<td width=60%>Table owner identifier</td>
</tr>
<tr valign=top>
<td width=40%>Table_name</td>
<td width=60%>Table identifier</td>
</tr>
<tr valign=top>
<td width=40%>Column_name</td>
<td width=60%>Column identifier</td>
</tr>
<tr valign=top>
<td width=40%>Data_type</td>
<td width=60%>Column data type</td>
</tr>
<tr valign=top>
<td width=40%>Type_name</td>
<td width=60%>Column data type name</td>
</tr>
<tr valign=top>
<td width=40%>Precision</td>
<td width=60%>Precision of the column </td>
</tr>
<tr valign=top>
<td width=40%>Length</td>
<td width=60%>Transfer size of the data</td>
</tr>
<tr valign=top>
<td width=40%>Scale</td>
<td width=60%>Scale of the column</td>
</tr>
<tr valign=top>
<td width=40%>Radix</td>
<td width=60%>Base for Numeric type</td>
</tr>
<tr valign=top>
<td width=40%>Nullable</td>
<td width=60%>Supports null values</td>
</tr>
<tr valign=top>
<td width=40%>Remarks</td>
<td width=60%>Description of the column</td>
</tr>
</table><br>
<p class=tl>
If the table you specify with <i>TableName</i> doesn't exist and the format is set to NATIVE, SQLCOLUMNS( ) returns true (.T.) and creates an empty table or cursor. If the table you specify with <i>TableName</i> doesn't exist and the format is set to FOXPRO, SQLCOLUMNS( ) returns false (.F.).</P><p class=dt>
<i>CursorName</i></p>
<p class=indent>
Specifies the name of the Visual FoxPro cursor for the result set. If you don't include a cursor name, Visual FoxPro uses the default name SQLRESULT.</p>
<p class=label>
<b>Remarks</b></p>
<p>
SQLCOLUMNS(&nbsp;) returns 1 if the cursor is successfully created, 0 if SQLCOLUMNS(&nbsp;) is still executing,&nbsp; – 1 if a connection level error occurs, and&nbsp; – 2 if an environment level error occurs.</p>
<p>
SQLCOLUMNS(&nbsp;) is one of the four functions that you can execute either synchronously or asynchronously. The Asynchronous setting of SQLSETPROP(&nbsp;) determines if these functions execute synchronously or asynchronously. In asynchronous mode, you must call SQLCOLUMNS(&nbsp;) repeatedly until a value other than false (.F.) (still executing) is returned.</p>
</BODY>
</HTML>
