<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDEExecute( ) Function</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngddeexecutelp_rp"></a><sup></sup>DDEExecute(&nbsp;) Function</h1>
<p>
<a href="lngddeexecutelp_rpx.htm">Example</a> &nbsp; <a href="lngddeexecutelp_rpsa.htm">See Also</a></p>
<p>
Sends a command to another application, using dynamic data exchange (DDE).</p>
<p class=label>
<b>Syntax</b></p>
<p>
DDEExecute(<i>nChannelNumber</i>, <i>cCommand</i> [, <i>cUDFName</i>])</p>
<p class=label>
<b>Returns</b></p>
<p>
Logical</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>nChannelNumber</i></p>
<p class=indent>
Specifies the channel number.</p>
<p class=dt>
<i>cCommand</i></p>
<p class=indent>
Specifies the command you want to send to the other application. The format of the command is determined by the application you are sending it to. Consult the application's documentation for the correct syntax.</p>
<p class=dt>
<i>cUDFName</i></p>
<p class=indent>
Allows asynchronous command execution requests. If you omit <i>cUDFName</i>, a client application waits for the period specified with DDESetOption(&nbsp;). If you specify a user-defined function with <i>cUDFName</i>, client program execution continues immediately after the command execution request is made.</p>
<p class=tl>
When the server application finishes executing the command, the user-defined function you specify with <i>cUDFName</i> is executed. The user-defined function is passed six parameters in the order shown in the following table.</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=26%><b>Parameter</b></td>
<td class=label width=74%><b>Contents</b></td>
</tr>
<tr valign=top>
<td width=26%>Channel Number</td>
<td width=74%>The channel number of the server application.</td>
</tr>
<tr valign=top>
<td width=26%>Action</td>
<td width=74%>XACTCOMPLETE (successful execution).<br>
XACTFAIL (failed command execution).</td>
</tr>
<tr valign=top>
<td width=26%>Item</td>
<td width=74%>The item name; for example, R1C1 for a Microsoft Excel worksheet cell.</td>
</tr>
<tr valign=top>
<td width=26%>Data</td>
<td width=74%>The new data (REQUEST) or data passed (POKE or EXECUTED).</td>
</tr>
<tr valign=top>
<td width=26%>Format</td>
<td width=74%>The data format; for example, CF_TEXT.</td>
</tr>
<tr valign=top>
<td width=26%>Transaction Number</td>
<td width=74%>The transaction number returned by DDEExecute(&nbsp;).</td>
</tr>
</table><br>
<p class=tl>
Use DDEAbortTrans(&nbsp;) to cancel an uncompleted transaction. If the transaction fails, you can use DDELastError(&nbsp;) to determine why it failed.</P><p class=tl>
When you include <i>cUDFName</i>, DDEExecute(&nbsp;) doesn't return a logical value. Instead, a transaction number is returned; if an error occurs, –1 is returned.</P><p class=label>
<b>Remarks</b></p>
<p>
The command sent with DDEExecute(&nbsp;) must be understood by the application. Before you can execute the command, you must establish a channel to the server application with DDEInitiate(&nbsp;).</p>
<p>
For example, Microsoft Excel has an extensive set of macro commands, including DDE commands that let you request data from Visual FoxPro from within Microsoft Excel. If you establish a channel to Microsoft Excel, you can then use DDEExecute(&nbsp;) to send macro commands to Microsoft Excel from within Visual FoxPro.</p>
<p>
If the receiving application successfully executes the command, DDEExecute(&nbsp;) returns true (.T.). If the receiving application cannot successfully execute the command or if the channel number you include is not valid, DDEExecute(&nbsp;) returns false (.F.). If the optional asynchronous user-defined function <i>cUDFName</i> is included, a transaction number is returned. If an error occurs, DDEExecute(&nbsp;) returns –1.</p>
</BODY>
</HTML>
