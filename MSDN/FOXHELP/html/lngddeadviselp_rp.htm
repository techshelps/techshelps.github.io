<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDEAdvise( ) Function</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngddeadviselp_rp"></a><sup></sup>DDEAdvise(&nbsp;) Function</h1>
<p>
<a href="lngddeadviselp_rpx.htm">Example</a> &nbsp; <a href="lngddeadviselp_rpsa.htm">See Also</a></p>
<p>
Creates a notify link or an automatic link used in a dynamic data exchange (DDE).</p>
<p class=label>
<b>Syntax</b></p>
<p>
DDEAdvise(<i>nChannelNumber</i>, <i>cItemName</i>, <i>cUDFName</i>, <i>nLinkType</i>)</p>
<p class=label>
<b>Returns</b></p>
<p>
Logical</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>nChannelNumber</i></p>
<p class=indent>
Specifies the channel number.</p>
<p class=dt>
<i>cItemName</i></p>
<p class=indent>
Specifies the item name. For example, Microsoft Excel uses row and column notation to refer to cells in a worksheet. The item name R1C1 designates the cell in the first row and first column of the worksheet.</p>
<p class=dt>
<i>cUDFName</i></p>
<p class=indent>
Specifies the user-defined function that is executed when a notify link or an automatic link is established and the item <i>cItemName</i> is modified. When the user-defined function is executed, it is passed the following six parameters in the order given below:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=26%><b>Parameter</b></td>
<td class=label width=74%><b>Contents</b></td>
</tr>
<tr valign=top>
<td width=26%>Channel Number</td>
<td width=74%>The channel number of the server application.</td>
</tr>
<tr valign=top>
<td width=26%>Action</td>
<td width=74%>ADVISE or TERMINATE.</td>
</tr>
<tr valign=top>
<td width=26%>Item</td>
<td width=74%>The item name; for example, R1C1 for a Microsoft Excel worksheet cell.</td>
</tr>
<tr valign=top>
<td width=26%>Data</td>
<td width=74%>The new data (automatic link) or the empty string (notify link).</td>
</tr>
<tr valign=top>
<td width=26%>Format</td>
<td width=74%>The data format; for example, CF_TEXT.</td>
</tr>
<tr valign=top>
<td width=26%>Advise Status</td>
<td width=74%>The link type (0 = manual, 1 = notify, 2 = automatic).</td>
</tr>
</table><br>
<p class=tl>
The user-defined function should have six parameters in its LPARAMETER or PARAMETER statement to accept the values passed from the server application. If a notify link is established, the user-defined function is executed and the empty string is passed in the Data parameter. You can issue DDERequest(&nbsp;) later to retrieve the data. If an automatic link is established, the user-defined function is executed and the data is passed in the Data parameter.</P><p class=tl>
The Action parameter contains ADVISE when the link is being updated by the server. The user-defined function is called, and the Action parameter contains TERMINATE when the link is closed by the client or server.</P><p class=tl>
Any value returned by the user-defined function is ignored.</P><p class=dt>
<i>nLinkType</i></p>
<p class=indent>
Specifies the link type in the following way:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=26%><b>nLinkType</b></td>
<td class=label width=74%><b>Link type</b></td>
</tr>
<tr valign=top>
<td width=26%>0</td>
<td width=74%>Manual</td>
</tr>
<tr valign=top>
<td width=26%>1</td>
<td width=74%>Notify</td>
</tr>
<tr valign=top>
<td width=26%>2</td>
<td width=74%>Automatic</td>
</tr>
</table><br>
<p class=tl>
You can turn off notification from the server application by specifying 0 for <i>nLinkType</i>. If the item changes, the user-defined function isn't executed.</P><p class=label>
<b>Remarks</b></p>
<p>
DDEAdvise(&nbsp;) is used to create a notify link or an automatic link to an item name in a server application. When a notify link is created with DDEAdvise(&nbsp;), the server application notifies Visual FoxPro that the item name has been modified. If an automatic link is created, the server application notifies Visual FoxPro that the item name has been modified and passes the new data to Visual FoxPro.</p>
<p>
Before you can create a link, you must establish a channel to the server application with DDEInitiate(&nbsp;).</p>
<p>
You can also use DDEAdvise(&nbsp;) to turn off notification from the server.</p>
<p>
DDEAdvise(&nbsp;) returns a true value (.T.) if it executes successfully; otherwise, it returns false (.F.).</p>
</BODY>
</HTML>
