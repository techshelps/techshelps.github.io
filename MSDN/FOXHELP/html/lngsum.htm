<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SUM Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngsum"></a><sup></sup>SUM Command</h1>
<p>
<a href="lngsumx.htm">Example</a> &nbsp; <a href="lngsumsa.htm">See Also</a></p>
<p>
Totals all or specified numeric fields in the currently selected table.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SUM [<i>eExpressionList</i>]<br>
 &nbsp; [<i>Scope</i>] [FOR <i>lExpression1</i>] [WHILE <i>lExpression2</i>]<br>
 &nbsp; [TO <i>MemVarNameList</i> | TO ARRAY <i>ArrayName</i>]<br>
 &nbsp; [NOOPTIMIZE]</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>eExpressionList</i></p>
<p class=indent>
Specifies one or more fields or field expressions to total. If you omit the field expression list, all numeric fields are totaled.</p>
<p class=dt>
<i>Scope</i></p>
<p class=indent>
Specifies a range of records to include in the total. The scope clauses are: ALL, NEXT <i>nRecords</i>, RECORD <i>nRecordNumber</i>, and REST. For more information on scope clauses, see the <a href="tblscope_clauses.htm">Scope Clauses</a> or <a href="lngoverview_of_the_language.htm">Overview of the Language</a> online topics.</p>
<p class=tl>
The default scope for SUM is ALL records.</P><p class=dt>
FOR <i>lExpression1</i></p>
<p class=indent>
Specifies that only the records for which the logical condition <i>lExpression1</i> evaluates to true (.T.) are included in the total. Including FOR lets you conditionally total records, filtering out undesired records.</p>
<p class=tl>
Rushmore optimizes a SUM&nbsp;...&nbsp;FOR command if <i>lExpression1</i> is an optimizable expression. For best performance, use an optimizable expression in the FOR clause. </P><p class=tl>
For more information on Rushmore optimization, see <a href="lngset_optimize.htm">SET OPTIMIZE</a> and "Using Rushmore to Speed Data Access" in Chapter 15, <a href="dgoptimizing_applications.htm">Optimizing Applications</a>, in the <i>Programmer's Guide</i>.</P><p class=dt>
WHILE <i>lExpression2</i></p>
<p class=indent>
Specifies a condition whereby records from the current table are included in the total for as long as the logical expression <i>lExpression2</i> evaluates to true (.T.).</p>
<p class=dt>
TO <i>MemVarNameList</i></p>
<p class=indent>
Stores each total to a variable. If you specify a variable in <i>MemVarNameList</i> that doesn't exist, Visual FoxPro automatically creates it. Separate the variable names in the list with commas.</p>
<p class=dt>
TO ARRAY <i>ArrayName</i></p>
<p class=indent>
Stores totals to a variable array. If the array you specify in SUM doesn't exist, Visual FoxPro automatically creates it. If the array exists and is too small to contain all the totals, the size of the array is automatically increased to accommodate the totals.</p>
<p class=dt>
NOOPTIMIZE</p>
<p class=indent>
Disables Rushmore optimization of SUM. </p>
<p class=indent>
For more information, see <a href="lngset_optimize.htm">SET OPTIMIZE</a> and "Using Rushmore to Speed Data Access" in Chapter 15, <a href="dgoptimizing_applications.htm">Optimizing Applications</a>, in the <i>Programmer's Guide</i>.</p>
</BODY>
</HTML>
