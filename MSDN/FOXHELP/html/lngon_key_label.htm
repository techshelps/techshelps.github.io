<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ON KEY LABEL Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngon_key_label"></a><sup></sup>ON KEY LABEL Command</h1>
<p>
<a href="lngon_key_labelx.htm">Example</a> &nbsp; <a href="lngon_key_labelsa.htm">See Also</a></p>
<p>
Specifies a command that executes when you press a specific key or key combination or click the mouse button.</p>
<p class=label>
<b>Syntax</b></p>
<p>
ON KEY [LABEL <i>KeyLabelName</i>] [<i>Command</i>]</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
LABEL <i>KeyLabelName</i></p>
<p class=indent>
Specifies the key label name assigned to the key. The <i>KeyLabelName</i> is the letter or digit on the key or a special name assigned to the key. The following table lists the special key label names.</p>
<p class=label>
<b>Visual FoxPro key label assignments</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=40%><b>For this key</b></td>
<td class=label width=60%><b>Specify this </b><i>KeyLabelName</i><b> value</b></td>
</tr>
<tr valign=top>
<td width=40%><img src="arrowl.gif" border=0></td>
<td width=60%>LEFTARROW</td>
</tr>
<tr valign=top>
<td width=40%><img src="arrowr.gif" border=0></td>
<td width=60%>RIGHTARROW</td>
</tr>
<tr valign=top>
<td width=40%><img src="arrowu.gif" border=0></td>
<td width=60%>UPARROW</td>
</tr>
<tr valign=top>
<td width=40%><img src="arrowd.gif" border=0></td>
<td width=60%>DNARROW</td>
</tr>
<tr valign=top>
<td width=40%>HOME</td>
<td width=60%>HOME</td>
</tr>
<tr valign=top>
<td width=40%>END</td>
<td width=60%>END</td>
</tr>
<tr valign=top>
<td width=40%>PAGE UP</td>
<td width=60%>PGUP</td>
</tr>
<tr valign=top>
<td width=40%>PAGE DOWN</td>
<td width=60%>PGDN</td>
</tr>
<tr valign=top>
<td width=40%>DEL</td>
<td width=60%>DEL</td>
</tr>
<tr valign=top>
<td width=40%>BACKSPACE</td>
<td width=60%>BACKSPACE</td>
</tr>
<tr valign=top>
<td width=40%>SPACEBAR</td>
<td width=60%>SPACEBAR</td>
</tr>
<tr valign=top>
<td width=40%>INS</td>
<td width=60%>INS</td>
</tr>
<tr valign=top>
<td width=40%>TAB</td>
<td width=60%>TAB</td>
</tr>
<tr valign=top>
<td width=40%>SHIFT+TAB</td>
<td width=60%>BACKTAB</td>
</tr>
<tr valign=top>
<td width=40%>ENTER</td>
<td width=60%>ENTER</td>
</tr>
<tr valign=top>
<td width=40%>F1 to F12</td>
<td width=60%>F1, F2, F3 ... </td>
</tr>
<tr valign=top>
<td width=40%>CTRL+F1 to CTRL+F12</td>
<td width=60%>CTRL+F1, CTRL+F2 ... </td>
</tr>
<tr valign=top>
<td width=40%>SHIFT+F1 to SHIFT+F12</td>
<td width=60%>SHIFT+F1, SHIFT+F2 ... </td>
</tr>
<tr valign=top>
<td width=40%>ALT+F1 to ALT+F12</td>
<td width=60%>ALT+F1, ALT+F2, ALT+F3 ... </td>
</tr>
<tr valign=top>
<td width=40%>ALT+0 to ALT+9</td>
<td width=60%>ALT+0, ALT+1, ALT+2 ... </td>
</tr>
<tr valign=top>
<td width=40%>ALT+A to ALT+Z</td>
<td width=60%>ALT+A, ALT+B, ALT+C ... </td>
</tr>
<tr valign=top>
<td width=40%>CTRL+LEFT ARROW</td>
<td width=60%>CTRL+LEFTARROW</td>
</tr>
<tr valign=top>
<td width=40%>CTRL+RIGHT ARROW</td>
<td width=60%>CTRL+RIGHTARROW</td>
</tr>
<tr valign=top>
<td width=40%>CTRL+HOME</td>
<td width=60%>CTRL+HOME</td>
</tr>
<tr valign=top>
<td width=40%>CTRL+END</td>
<td width=60%>CTRL+END</td>
</tr>
<tr valign=top>
<td width=40%>CTRL+PAGE UP</td>
<td width=60%>CTRL+PGUP</td>
</tr>
<tr valign=top>
<td width=40%>CTRL+PAGE DOWN</td>
<td width=60%>CTRL+PGDN</td>
</tr>
<tr valign=top>
<td width=40%>CTRL+A TO CTRL+Z</td>
<td width=60%>CTRL+A, CTRL+B, CTRL+C ... </td>
</tr>
<tr valign=top>
<td width=40%>CTRL+0</td>
<td width=60%>CTRL+0</td>
</tr>
<tr valign=top>
<td width=40%>RIGHT MOUSE BUTTON</td>
<td width=60%>RIGHTMOUSE</td>
</tr>
<tr valign=top>
<td width=40%>LEFT MOUSE BUTTON</td>
<td width=60%>LEFTMOUSE</td>
</tr>
<tr valign=top>
<td width=40%>MOUSE BUTTON</td>
<td width=60%>MOUSE</td>
</tr>
<tr valign=top>
<td width=40%>ESC</td>
<td width=60%>ESC</td>
</tr>
</table><br>
<p class=dt>
<i>Command</i></p>
<p class=indent>
Specifies the command that executes when you press the specified key or key combination or click the mouse button.</p>
<p class=tl>
You can include parameter or parameter expressions with the command that you assign to the key, as in the following example:</P><pre><code>ON KEY LABEL ALT+V WAIT WINDOW "Version: " + VERSION()
</code></pre>
<p class=tl>
You can include variables in the assignment, but they must be public. For example:</P><pre><code>PUBLIC message
message = "Default drive: " + SYS(5)
ON KEY LABEL ALT+D WAIT WINDOW message
</code></pre>
<p class=label>
<b>Remarks</b></p>
<p>
ON KEY LABEL typically uses DO to execute a procedure.</p>
<p>
ON KEY LABEL executes the command immediately during the execution of READ, BROWSE, EDIT, CHANGE, and user-defined menus. If a program is executing when you press the key or click the mouse button, Visual FoxPro executes the current program line and then executes the ON KEY LABEL command. Any ON KEY LABEL key assignments created in a program remain in effect after the program is run. You can also create key assignments in the Command window.</p>
<p>
To restore the behavior of a specific key to normal, issue ON KEY LABEL <i>KeyLabelName</i>. To restore all keys to their default behavior, issue ON KEY.</p>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;To prevent recursive calls during the execution of an ON KEY LABEL procedure, include PUSH KEY CLEAR early in the procedure to disable all active ON KEY LABEL commands. Issue POP KEY at the end of the procedure to enable the ON KEY LABEL commands.</p>
<p>
The ON KEY LABEL key assignments aren't in effect in the Visual FoxPro system menu bar, system menus, dialog boxes, alerts, and so on. The key assignments are effective in the Visual FoxPro system windows — the Visual FoxPro text editor, the Command window, the Trace window, and so on.</p>
<p>
Unlike ON KEY, there can be multiple active ON KEY LABEL commands. For example, you can assign a command to each of the arrow keys and a mouse button.</p>
<p>
Executing an ON KEY LABEL resets PARAMETERS(&nbsp;) to 0. For more information, see <a href="lngparameterslp_rp.htm">PARAMETERS(&nbsp;)</a>.</p>
<p>
In Visual FoxPro, certain events cannot be trapped because they are under the control of Windows. In particular, ON KEY LABEL MOUSE, ON KEY LABEL LEFTMOUSE, and ON KEY LABEL RIGHTMOUSE are not executed when you click a Windows control such as a Control menu, scroll bar, or the like. Also, CTRL+0 is supported in ON KEY LABEL in Visual FoxPro, allowing you to redefine the key combination used to enter a null value into a field.</p>
<p>
Note that ON KEY LABEL operates outside of the scope of a form; the KeyPress event can be used within forms to execute code when a key is pressed.</p>
</BODY>
</HTML>
