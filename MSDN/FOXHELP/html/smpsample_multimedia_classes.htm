<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sample Multimedia Classes</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="smpsample_multimedia_classes"></a>Sample Multimedia Classes</h1>
<p>
Two of the classes (SoundPlayer and VideoFrame) and in the Visual FoxPro Samples\Classes\Samples.vcx class library allow you to use the MCI (Multimedia Command Interface) to play multimedia files.</p>
<p>
The documentation for the MCI commands is in Chapter 7 of the Windows SDK <i>Multimedia Programmer's Reference</i>.</p>
<h2>Sound Player Class</h2>
<p>
This class can be used to play a non-visual multimedia file, such as a .WAV audio file. It allows you to specify the file to be played, and then provides built-in methods to easily play the media file.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=28%><b>Property</b></td>
<td class=label width=72%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%>AutoOpen</td>
<td width=72%>Specifies whether the sound file should be automatically opened and displayed when the object is instantiated. The default value is true (.T.).</td>
</tr>
<tr valign=top>
<td width=28%>AutoPlay</td>
<td width=72%>Specifies whether the sound file should be automatically played when it is opened. The default value is true (.T.).</td>
</tr>
<tr valign=top>
<td width=28%>AutoRepeat</td>
<td width=72%>Specifies whether the sound file plays continuously.&nbsp; The default value is false (.F.).</td>
</tr>
<tr valign=top>
<td width=28%>ControlSource</td>
<td width=72%>Specifies the column that contains the sound file reference. If empty, the class expects a static file name to be in the SoundFile property.</td>
</tr>
<tr valign=top>
<td width=28%>MCIAlias</td>
<td width=72%>Specifies the alias to be used by MCI. If left empty, the alias defaults to the Name<b> </b>property of the class.&nbsp; Normally this can be left empty, but if the user wants to play the same sound file twice at the same time, a different alias would need to be specified for each.</td>
</tr>
<tr valign=top>
<td width=28%>SoundFile</td>
<td width=72%>Holds the name of a sound file to play, for example “<code>C:\WINDOWS\CHIMES.WAV</code>“</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=28%><b>Method</b></td>
<td class=label width=72%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%>OpenSound</td>
<td width=72%>Opens the sound file.</td>
</tr>
<tr valign=top>
<td width=28%>PlaySound</td>
<td width=72%>Plays the sound file. The file must be opened with the OpenSound method before it can be played.</td>
</tr>
<tr valign=top>
<td width=28%>PauseSound</td>
<td width=72%>Pauses the playing of a sound file. Play can be continued by calling the PlaySound method.</td>
</tr>
<tr valign=top>
<td width=28%>SetPosition</td>
<td width=72%>Allows the user to specify the position of the media file.&nbsp; It can be executed at any time after the file has been opened.&nbsp; Valid values are "Start," "End," or a specific millisecond into the sound.</td>
</tr>
<tr valign=top>
<td width=28%>CloseSound</td>
<td width=72%>Closes the sound file and releases all resources associated with it.</td>
</tr>
</table><br>
<h2>VideoFrame Class</h2>
<p>
The VideoFrame class can be used to play a visual multimedia file, such as a video for Windows file. This class allows you to position and size the video to be played, and then provides built-in methods to easily play the media file.</p>
<p>
For an example of using this class, see Video.scx in the Visual FoxPro Samples\Solution\Forms folder.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=28%><b>Property</b></td>
<td class=label width=72%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%>AutoOpen</td>
<td width=72%>Specifies whether the video file should automatically opened and displayed when the object is instantiated.&nbsp; The default value is true (.T.).</td>
</tr>
<tr valign=top>
<td width=28%>AutoPlay</td>
<td width=72%>Specifies whether the video file should automatically play when it is opened. The default value is true (.T.).</td>
</tr>
<tr valign=top>
<td width=28%>AutoRepeat</td>
<td width=72%>Specifies whether the video file will loop the video.&nbsp; Setting this to .T. will cause the video to play continuously. The default value is false (.F.).</td>
</tr>
<tr valign=top>
<td width=28%>ControlSource</td>
<td width=72%>Specifies a Field that contains the video file reference.&nbsp; If empty, the class expects a static file name to be in the VideoFile property.</td>
</tr>
<tr valign=top>
<td width=28%>MCIalias</td>
<td width=72%>Specifies the alias to be used by MCI. If left empty, the alias defaults to the Name<b> </b>property of the class.&nbsp; Normally this can be left empty, but if the user wants to play the same video file twice at the same time, a different alias would need to be specified for each.</td>
</tr>
<tr valign=top>
<td width=28%>VideoFile</td>
<td width=72%>Holds the name of a video file to play, for example:&nbsp; "<code>C:\VFP\SAMPLES\SOLUTION\FORMS\FOX.AVI</code>"</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=28%><b>Method</b></td>
<td class=label width=72%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%>CloseVideo</td>
<td width=72%>Closes the video file and releases all resources associated with it.</td>
</tr>
<tr valign=top>
<td width=28%>DoMCI</td>
<td width=72%>Called by the other methods to execute MCI commands.&nbsp; It can also be called by a user to execute a specific MCI command.</td>
</tr>
<tr valign=top>
<td width=28%>OpenVideo</td>
<td width=72%>Opens the video file and shows the first frame.</td>
</tr>
<tr valign=top>
<td width=28%>PauseVideo</td>
<td width=72%>Pauses a playing video.&nbsp; The video can be restarted by using the PlayVideo<b> </b>method</td>
</tr>
<tr valign=top>
<td width=28%>PlayVideo</td>
<td width=72%>Plays the video file.&nbsp; The video file must be opened in the OpenVideo method before it can be played.</td>
</tr>
<tr valign=top>
<td width=28%>SetPosition</td>
<td width=72%>Allows the user to specify the position of the media file.&nbsp; It can be executed at any time after the video file has been opened.&nbsp; Valid values are "Start", "End", or a specific millisecond into the video.</td>
</tr>
</table><br>
</BODY>
</HTML>
