<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DragDrop Event</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngdragdrop_event"></a><sup></sup>DragDrop Event</h1>
<p>
<a href="lngdragdrop_eventat.htm">Applies To</a> &nbsp; <a href="lngdragdrop_eventsa.htm">See Also</a></p>
<p>
Occurs when a drag-and-drop operation is completed.</p>
<p class=label>
<b>Syntax</b></p>
<p>
PROCEDURE <i>Object.</i>DragDrop<br>
LPARAMETERS [<i>nIndex,</i>] <i>oSource</i>, <i>nXCoord</i>, <i>nYCoord</i></p>
<p class=label>
<b>Arguments</b></p>
<p>
You must include an LPARAMETERS or PARAMETERS statement in the event procedure and specify a name for each parameter. Visual FoxPro passes the DragDrop event three or four parameters in the following order:</p>
<p class=dt>
<i>nIndex</i></p>
<p class=indent>
Uniquely identifies a control if it is in a control array.</p>
<p class=dt>
<i>oSource</i></p>
<p class=indent>
References the control being dragged. You can refer to properties and methods of the control with this parameter.</p>
<p class=dt>
<i>nXCoord</i>, <i>nYCoord</i></p>
<p class=indent>
Contains the current horizontal (<i>nXCoord</i>) and vertical (<i>nYCoord</i>) coordinates of the mouse pointer within the target form or control. These coordinates are always expressed in terms of the target's coordinate system in the unit of measurement determined by the ScaleMode property.</p>
<p class=label>
<b>Remarks</b></p>
<p>
A drag-and-drop operation is completed when a control is dragged over another control or form and the mouse button is released, or when the Drag method with its <i>nAction</i> argument set to 2 (Drop) is called for the control.</p>
<p>
Use a DragDrop event to control what happens after a drag operation is complete. For example, you can move the source control to a new location or copy a file from one location to another.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The DragDrop event involves two objects, a control being dragged and a target object. The DragDrop event is triggered for the target object, not the control being dragged.</p>
<p class=indent>
Use the DragMode property and Drag method to specify how dragging is to be initiated. Once dragging is initiated, you can handle events that precede a DragDrop event with a DragOver event.</p>
</BODY>
</HTML>
