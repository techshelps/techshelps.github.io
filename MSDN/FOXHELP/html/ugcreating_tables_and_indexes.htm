<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Tables and Indexes</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="ugcreating_tables_and_indexes"></a><sup></sup>Chapter 2: Creating Tables and Indexes</h1>
<p>
Tables are the basic units you use for working with data and creating relational databases and applications. You might need to work with information currently stored in tables, customize existing tables, or create your own custom tables to store data. To order your data and speed up processing, you can use indexes.</p>
<p>
This chapter shows how to work with and modify existing tables, and how to create new tables with Visual FoxPro, either with assistance from the Table Wizard, or using the Table Designer directly. For information about importing table information from other applications, see Chapter 9, <a href="ugimporting_and_exporting_data.htm">Importing and Exporting Data</a>. For information about the additional properties of tables available when they are incorporated into a database, see Chapter 3, <a href="ugcollecting_tables_into_a_database.htm">Collecting Tables into a Database</a>. For more information about indexes, see Chapter 7, <a href="dgworking_with_tables.htm">Working with Tables</a>, in the <i>Programmer’s Guide</i>.</p>
<p>
This chapter discusses:</p>
<ul type=disc>
<li>
<a href="#ugcreating_a_new_table">Creating a New Table</a></li>
<li>
<a href="#ugstoring_and_viewing_information_in_tables">Storing and Viewing Information in Tables</a></li>
<li>
<a href="#ugmodifying_tables">Modifying Tables</a></li>
<li>
<a href="#ugcustomizing_tables">Customizing Tables</a></li>
<li>
<a href="#ugordering_data_using_indexes">Ordering Data Using Indexes</a></li>
<li>
<a href="#ugcreating_an_index">Creating an Index</a></li>
<li>
<a href="#ugusing_indexes">Using Indexes</a></li>
</ul>

<h2><a name="ugcreating_a_new_table"></a>Creating a New Table</h2>
<p>
When you need to create a new table, you can get assistance from the <a href="wiztable_wizard.htm">Table Wizard</a>, or use the <a href="wndtable_designer.htm">Table Designer</a> and set up a table with the fields you need.</p>
<p>
Remember these main points when you set up a table:</p>
<ul type=disc>
<li>
Make the data type for a field match the kind of information you are going to store in it. For more information, see the following section, “Choosing a Data Type.”</li>
<li>
Make the field wide enough to accommodate the information it will display.</li>
<li>
Set an appropriate number of decimal places for Numeric or Float fields.</li>
<li>
Check NULL if you want the field to accept .NULL. as a <a href="glsnull_value.htm">value</a>.</li>
</ul>

<h3><a name="ugchoosing_a_data_type"></a> Choosing a Data Type</h3>
<p>
Each field in your table holds a particular type of data. You can set the data type of a field to any of the types in the following table.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=21%><b>Data Type</b></td>
<td class=label width=43%><b>Description</b></td>
<td class=label width=36%><b>Example</b></td>
</tr>
<tr valign=top>
<td width=21%><a href="concharacter_data_type.htm">Character</a></td>
<td width=43%>Alphanumeric text</td>
<td width=36%>A customer’s address</td>
</tr>
<tr valign=top>
<td width=21%><a href="concurrency_data_type.htm">Currency</a></td>
<td width=43%>Monetary units</td>
<td width=36%>Purchase price</td>
</tr>
<tr valign=top>
<td width=21%><a href="connumeric_data_type.htm">Numeric</a></td>
<td width=43%>Integer or decimal numbers</td>
<td width=36%>Quantity of items ordered</td>
</tr>
<tr valign=top>
<td width=21%><a href="confloat_field_type.htm">Float</a></td>
<td width=43%>Same as Numeric</td>
<td width=36%></td>
</tr>
<tr valign=top>
<td width=21%><a href="condate_data_type.htm">Date</a></td>
<td width=43%>Month, day, and year</td>
<td width=36%>Date an order was placed</td>
</tr>
<tr valign=top>
<td width=21%><a href="condatetime_data_type.htm">DateTime</a></td>
<td width=43%>Month, day, year, hours, minutes, and seconds</td>
<td width=36%>Date and time an employee arrived at work</td>
</tr>
<tr valign=top>
<td width=21%><a href="condouble_field_type.htm">Double</a></td>
<td width=43%>Double-precision number</td>
<td width=36%>Data from experiments that require a high degree of precision</td>
</tr>
<tr valign=top>
<td width=21%><a href="coninteger_field_type.htm">Integer</a></td>
<td width=43%>Non-decimal numeric values (whole numbers)</td>
<td width=36%>Line number in an order</td>
</tr>
<tr valign=top>
<td width=21%><a href="conlogical_data_type.htm">Logical</a></td>
<td width=43%>True or False</td>
<td width=36%>Whether or not an order has been filled</td>
</tr>
<tr valign=top>
<td width=21%><a href="conmemo_field_type.htm">Memo</a></td>
<td width=43%>Alphanumeric text of an indeterminate length</td>
<td width=36%>Notes about phone calls in a phone log</td>
</tr>
<tr valign=top>
<td width=21%><a href="congeneral_field_type.htm">General</a></td>
<td width=43%>OLE</td>
<td width=36%>Microsoft Excel worksheet</td>
</tr>
<tr valign=top>
<td width=21%>Character (Binary)</td>
<td width=43%>Same as Character but values aren’t translated when the code page changes</td>
<td width=36%>User passwords stored in a table and used in different countries</td>
</tr>
<tr valign=top>
<td width=21%>Memo (Binary)</td>
<td width=43%>Same as Memo but values aren’t translated when the code page changes</td>
<td width=36%>A logon script used in different countries</td>
</tr>
</table><br>
<h3>Using the Table Wizard</h3>
<p>
Whenever you want to create a new table, you can use the <a href="wiztable_wizard.htm">Table Wizard</a> to help you set it up. The wizard will ask you a series of questions and build a table for you based on your answers.</p>
<p class=label>
<b>To create a table with a wizard</b>
<ol>
<li>
In the <b>Project Manager</b>, select the <b>Data</b> tab and select <b>Free Tables</b>.<br><br></li>
<li>
Choose <b>New</b>.<br><br></li>
<li>
Choose the <b>Table Wizard</b> button.<br><br></li>
<li>
Follow the instructions on the wizard screens.</li>
</ol>
<p>
You can also access the Table Wizard from the menu by choosing New from the File menu, selecting Table, and selecting the Table Wizard option.</p>
<p>
If you base your table on a database, you can use styles, field mappings, or a primary key, and establish or use relationships in the database tables.</p>
<h3>Starting the Table Designer</h3>
<p>
If you want to create your own table without using a wizard, use Tables in the Project Manager Data tab or choose New from the File menu, select Table, and choose New File.</p>
<p class=label>
<b>Starting a new table in the Table Designer</b></p>
<p>
<img src="afu01007.gif" border=0></p>
<p>
If you want to create a table to add to a database, open a database before creating a new table, and the new table will automatically become part of the database. You can also add it later. For more information about database tables, see Chapter 3, <a href="ugcollecting_tables_into_a_database.htm">Collecting Tables into a Database</a>.</p>
<p class=label>
<b>To create a new table</b>
<ol>
<li>
In the <b>Project Manager</b>, choose <b>Tables</b> under <b>Databases</b>, or choose <b>Free Tables</b>.<br><br></li>
<li>
Choose <b>New</b>, and then choose <b>New Table</b>.<br><br></li>
<li>
In the <b>Create</b> dialog box, enter a name for the table and choose <b>Save</b>.<br><br></li>
<li>
On the <b>Fields</b> tab of the <b>Table Designer</b>, type the name for the first field in the <b>Name</b> field.<br><br></li>
<li>
In the <b>Type</b> field, select a field type from the list.<br><br></li>
<li>
In the <b>Width</b> column, set the width of the column in characters.<br><br></li>
<li>
If <b>Type</b> is <b>Numeric</b> or <b>Float</b>, set the number of decimal places to display in the <b>Decimal</b> box.<br><br></li>
<li>
If you want to add an index to the field, select a sort order in the <b>Index</b> column.<br><br></li>
<li>
If you want the field to accept the input of null values, select <b>NULL</b>.</li>
</ol>
<p>
You can choose to begin entering records immediately, or open the table later when ready to enter records.</p>
<p class=label>
<b>To add records to a table</b>
<ol>
<li>
In the <b>Project Manager</b>, select the name of the table.<br><br></li>
<li>
Choose <b>Browse</b>.<br><br></li>
<li>
From the <b>View</b> menu, choose <b>Append Mode</b>.<br><br></li>
<li>
Enter new record changes in the <b>Browse</b> window.<p class=tl>
If you prefer to view each field on a separate line, switch to Edit mode by choosing <b>Edit</b> from the <b>View</b> menu.</P></li>
</ol>

<h2><a name="ugstoring_and_viewing_information_in_tables"></a>Storing and Viewing Information in Tables</h2>
<p>
Tables store your data in a row and column format, similar to a spreadsheet. Each row represents a record, and each column represents the fields in the records.</p>
<p class=label>
<b>Rows and columns in tables</b></p>
<p>
<img src="afu01008.gif" border=0></p>
<p>
You can create two types of tables in Visual FoxPro: database tables, which have been incorporated as part of a database, and free tables, which are independent of any database.</p>

<h3><a name="ugviewing_the_contents_of_a_table"></a>Viewing the Contents of a Table</h3>
<p>
The quickest way to see the contents of a table is to look at it in a <a href="wndbrowse_window.htm">Browse window</a>. The Browse window displays the contents of the table as a series of rows and columns you can scroll through. To familiarize yourself with some typical tables, you can browse the sample tables in the Visual Studio …\Samples\Vfp98\Data directory.</p>
<p class=label>
<b>To browse a table</b>
<ol>
<li>
From the <b>File</b> menu, choose <b>Open</b> and select the name of the table you want to view.<br><br></li>
<li>
From the <b>View</b> menu, choose <b>Browse</b>.</li>
</ol>
<p>
You can also select the name of a table in the Project Manager, and choose the Browse button.</p>
<p>
For example, open the Customer table in the Visual Studio …\Samples\Vfp98\Data directory.</p>
<p class=label>
<b>Table in a Browse window</b></p>
<p>
<img src="afu01009.gif" border=0></p>
<p>
For easier data entry, you can place a Browse window into Edit mode. In Edit mode, the column names are displayed on the left side of the window.</p>
<p class=label>
<b>To change the Browse window to Edit mode</b>
<ul type=disc>
<li>
From the <b>View</b> menu, choose <b>Edit</b>.<p class=label>
<b>Table in Edit mode</b>
<p>
<img src="afu02001.gif" border=0></P></li>
</ul>
<p>
In either mode, you can scroll through records, search for specific records, and make changes directly to the contents of the table.</p>
<h3>Moving Around in a Table</h3>
<p>
Use the scroll bars to move through the table and display different fields and records. You can also use the arrow keys and the TAB key to move around.</p>
<p class=label>
<b>To see different records</b>
<ol>
<li>
From the <b>Table</b> menu, choose <b>Go to Record</b>.<br><br></li>
<li>
In the submenu, choose <b>Top</b>, <b>Bottom</b>, <b>Next</b>, <b>Previous</b>, or <b>Record #</b>.<br><br></li>
<li>
If you choose <b>Record #</b>, enter the record number you want to see in the <b>Go to Record</b> dialog box, and choose <b>Go To</b>.</li>
</ol>
<h3>Editing Fields</h3>
<p>
To change the current information in a <a href="concharacter_data_type.htm">Character</a>, <a href="connumeric_data_type.htm">Numeric</a>, <a href="conlogical_data_type.htm">Logical</a>, <a href="condate_data_type.htm">Date</a>, or <a href="condatetime_data_type.htm">DateTime</a> field, either place the cursor in the field and edit the information, or select the entire field and begin typing the new information.</p>
<p>
To edit the information in a <a href="conmemo_field_type.htm">Memo</a> field, double-click the field in the Browse window or press CTRL+PGDN. An editing window opens with the contents of the memo field.</p>
<p>
A <a href="congeneral_field_type.htm">General</a> field contains an embedded or linked OLE object. You can edit this object by double-clicking the General field in the Browse window and either editing the document directly (as with a Microsoft Word document or a Microsoft Excel worksheet) or double-clicking on the object to open the parent application (as with a Microsoft Paint object).</p>
<h3>Adding New Records to a Table</h3>
<p>
To quickly add new records to a table, you can place the Browse or Edit windows into Append mode. In Append mode, a blank set of fields appears at the bottom of the file, so you can fill them in to create a new record.</p>
<p class=label>
<b>To add a new blank record</b>
<ul type=disc>
<li>
From the <b>View</b> menu, select <b>Append Mode</b>.</li>
</ul>
<p>
Fill in the fields in the new record, tabbing from field to field. A new record is created at the bottom of the file as you complete each record.</p>
<p class=label>
<b>Append Mode for a Browse window</b></p>
<p>
<img src="afu02002.gif" border=0></p>
<h3>Deleting Records</h3>
<p>
Deleting records from a table is a two-step process in Visual FoxPro. First, you mark the records for deletion by clicking the box to the left of each record.</p>
<p class=label>
<b>Records marked for deletion</b></p>
<p>
<img src="afu02003.gif" border=0></p>
<p>
Marking the records does not delete them. To actually remove the records, you choose Remove Deleted Records from the Table menu. This process deletes the records you marked, and consolidates the remaining records in the table. Removing the deleted records closes the table, so you must re-open it to continue working.</p>
<p class=label>
<b>To delete records from a table</b>
<ol>
<li>
Mark the records you want to delete by clicking in the left column.<br><br></li>
<li>
From the <b>Table</b> menu, choose <b>Remove Deleted Records</b>.<br><br></li>
<li>
Choose <b>Yes</b> in response to the prompt that asks if you want to pack the table.</li>
</ol>
<p>
You can also select a group of records for deletion by setting conditions in the Delete dialog box. Choose Delete Records from the Table menu to enter deletion criteria.</p>
<p class=label>
<b>Delete dialog box</b></p>
<p>
<img src="afu02004.gif" border=0></p>
<p>
Choose the Scope button to set the range of records to be deleted.</p>
<p>
If you can describe a set of records you want to delete, you can build an expression based on that description. Choose the FOR button to bring up the Expression Builder so you can build an expression. For example, using the expression <b>FOR Country = 'UK'</b> selects all the records from the UK and marks them for deletion.</p>
<h3>Customizing a Browse Window</h3>
<p>
To customize the Browse window to fit your needs, you can rearrange or change the width of columns, turn the grid lines on or off, and split the Browse window into two panes.</p>

<h4><a name="ugrearranging_columns"></a>Rearranging Columns</h4>
<p>
You can rearrange the columns of the Browse window into the order you want. This does not affect the actual structure of the table.</p>
<p class=label>
<b>To rearrange the columns in a Browse window</b>
<ul type=disc>
<li>
Drag a column heading to a new location.<p class=tl>
-or-</P></li>
<li>
From the <b>Table</b> menu, choose <b>Move Field</b>, and use the LEFT ARROW or RIGHT ARROW keys to move the column. Press ENTER when you are done.</li>
</ul>

<h4><a name="ugchanging_column_widths"></a>Changing Column Widths</h4>
<p>
You can also change the width of a column in a Browse window. This resizing does not affect the field length or the structure of the table.</p>
<p>
If you want to change the actual length of the fields, modify the structure of the table using the <a href="wndtable_designer.htm">Table Designer</a> (see <a href="#ugmodifying_tables">Modifying Tables</a> later in this chapter).</p>
<p class=label>
<b>To change the width of a column</b>
<ul type=disc>
<li>
Position the pointer in the column heading between two field names, and drag the pointer to resize the column.<p class=tl>
-or-</P></li>
<li>
Select a field, and from the <b>Table</b> menu, choose <b>Size Field</b>, and use the LEFT ARROW or RIGHT ARROW keys to resize the column. Press ENTER when done.</li>
</ul>

<h4><a name="ugturning_grid_lines_on_and_off"></a>Turning Grid Lines On and Off</h4>
<p>
You can also turn off the grid lines in a Browse window.</p>
<p class=label>
<b>To turn grid lines on or off</b>
<ul type=disc>
<li>
From the <b>View</b> menu, choose <b>Gridlines</b>.</li>
</ul>

<h4><a name="ugsplitting_a_browse_window"></a>Splitting a Browse Window</h4>
<p>
You may find it useful to split the Browse window so that you can look at two different areas in the table, or look at the same records in Browse and Edit modes simultaneously.</p>
<p class=label>
<b>Split Browse window</b></p>
<p>
<img src="afu02005.gif" border=0></p>
<p class=label>
<b>To split a Browse window</b>
<ol>
<li>
Place the pointer on the split bar at the bottom left corner of the view.<br><br></li>
<li>
Drag the split bar to the right to divide the <b>Browse</b> window into two panes.<p class=tl>
-or-</P></li>
<li>
From the <b>Table</b> menu, choose <b>Resize Partitions</b>.<br><br></li>
<li>
Press the RIGHT ARROW key to move the split bar.<br><br></li>
<li>
Press ENTER.</li>
</ol>
<p class=label>
<b>To resize the panes of a split Browse window</b>
<ol>
<li>
Place the pointer on the split bar.<br><br></li>
<li>
Drag the split bar to the right or left to change the relative size of the panes.<p class=tl>
-or-</P></li>
<li>
From the <b>Table</b> menu, choose <b>Resize Partitions</b>.<br><br></li>
<li>
Press the LEFT ARROW or RIGHT ARROW key to move the split bar.<br><br></li>
<li>
Press ENTER.</li>
</ol>
<p>
By default, the two panes of the browse window are linked; that is, as you select different records in one pane, the change is reflected in the other. If you want to detach the two panes so that they function independently, (that is, so that scrolling one pane does not affect the other) clear the Link Partitions command on the Table menu.</p>

<h2><a name="ugmodifying_tables"></a>Modifying Tables</h2>
<p>
When you need to make changes to the structure of an existing table, use the <a href="wndtable_designer.htm">Table Designer</a>. With the Table Designer, you can add and delete fields, set data types and widths for fields, and view and set the indexes which sort the contents of the table.</p>
<p>
If the table you are modifying is part of a database, additional database-specific field and table properties are available. Use of these properties is covered in Chapter 3, <a href="ugcollecting_tables_into_a_database.htm">Collecting Tables into a Database</a>.</p>
<p class=label>
<b>To modify a table</b>
<ul type=disc>
<li>
In the <b>Project Manager</b>, select the name of a table and choose <b>Modify</b>.</li>
</ul>
<p>
The structure of the table is displayed in the Table Designer.</p>
<p class=label>
<b>Table Designer shows current table structure</b></p>
<p>
<img src="afu02006.gif" border=0></p>
<p class=label>
<b>To add a field to a table</b>
<ol>
<li>
In the <b>Table Designer</b>, choose <b>Insert</b>.<br><br></li>
<li>
In the <b>Name</b> column, type the name of the new field.<br><br></li>
<li>
In the <b>Type</b> column, select a data type for the field.<br><br></li>
<li>
In the <b>Width</b> column, set or enter a width for the field.<br><br></li>
<li>
If the field has a type of <b>Numeric</b> or <b>Float</b>, set the number of decimal places in the <b>Decimal</b> column.<br><br></li>
<li>
If you want the table to accept null values, select the <b>NULL</b> column.<br><br></li>
<li>
Choose <b>OK</b>.<br><br></li>
<li>
Choose <b>Yes</b> to make the table structure changes.</li>
</ol>
<p class=label>
<b>To delete a field from a table</b>
<ul type=disc>
<li>
Select the field and choose <b>Delete</b>.</li>
</ul>

<h2><a name="ugcustomizing_tables"></a>Customizing Tables</h2>
<p>
You can customize your tables so that only certain records are displayed by setting a filter on the table. You can also restrict access to certain fields in a table by setting a field filter, which allows you to select which fields to display.</p>
<h3>Filtering a Table</h3>
<p>
If you want to see only records of a certain type, you can set a filter to limit the records shown in the Browse window. Filtering is useful when, for example, you want to restrict the browse to show only sales above a certain amount, or employees in a range of hire dates.</p>
<p>
To set a filter, use the Work Area Properties dialog box, available through the Properties command on the Table menu.</p>
<p class=label>
<b>Work Area Properties dialog box</b></p>
<p>
<img src="afu02007.gif" border=0></p>
<p class=label>
<b>To set a filter on a table</b>
<ol>
<li>
Browse the table you want to filter.<br><br></li>
<li>
From the <b>Table</b> menu, choose <b>Properties</b>.<br><br></li>
<li>
In the <b>Work Area Properties</b> dialog box, enter your filter expression directly in the <b>Data filter</b> box.<p class=tl>
-or-</P></li>
</ol>
<ul type=disc>
<li>
Choose the dialog button under <b>Data Filter</b>, and in the <b>Expression Builder</b>, create an expression to select the records you want to see and choose <b>OK</b>.</li>
</ul>
<p>
When you browse the table, you see only records that are selected by the filter expression.</p>
<p>
For example, using the Customers table from the Visual Studio …\Samples\Vfp98\Data directory, you could focus on customers residing in the United States by entering the following expression in the Data Filter box:</p>
<pre><code>Customer.Country = "USA"
</code></pre>
<p class=label>
<b>Results of filtering a table</b></p>
<p>
<img src="afu02008.gif" border=0></p>
<h3>Restricting Access to Fields</h3>
<p>
If you want to keep certain fields from displaying when tables are browsed or used in a form, you can set a field filter to restrict access to those fields. You select the fields you want to display, which leaves the remaining fields inaccessible.</p>
<p class=label>
<b>To set a field filter</b>
<ol>
<li>
From the <b>Table</b> menu, choose <b>Properties</b>.<br><br></li>
<li>
In the <b>Work Area Properties</b> dialog box, under <b>Allow access to</b>, select <b>Only fields specified by 'field filter'</b> and choose <b>Field Filter</b>.<br><br></li>
<li>
In the <b>Field Picker</b> dialog box, add the fields you want to the <b>Selected fields</b> column and choose <b>OK</b>.<p class=label>
<b>Field filter and its effect on a Browse window</b>
<p>
<img src="afu02009.gif" border=0></P></li>
</ol>
<p>
When you browse the table, only fields you selected in the field filter are displayed.</p>
<p>
For more information about customizing and working with tables, see Chapter 7, <a href="dgworking_with_tables.htm">Working with Tables</a>, in the <i>Programmer’s Guide</i>.</p>

<h2><a name="ugordering_data_using_indexes"></a>Ordering Data Using Indexes</h2>
<p>
Once you create a table, you can order the data to speed up data retrieval by using indexes. With indexes, you can quickly process your records for displaying, querying, or printing. You can also select records, control whether duplicate values are entered in a field, and support relationships between tables.</p>
<p>
You can use indexes to increase the speed that records are sorted or searched for display or printing. Indexes are also important for creating relationships between tables in a database.</p>
<p>
Indexes in Visual FoxPro are like book indexes: a list of page numbers that points the reader to specific pages in a book. Likewise, a table index is a list of record numbers that points to specific records to process and determines the processing order for the records.</p>
<p class=label>
<b>A table index stores a list of pointers to records.</b></p>
<p>
<img src="afu02013.gif" border=0></p>
<p>
For example, you can look at the records in the Customer table in alphabetical order by company name, prepare them for a mailing list in order by postal code, or organize them to speed up searches. The index does not change the order that data is stored in your table; it changes the order that Visual FoxPro uses to read each record.</p>
<p>
You can create more than one index for a table, each representing a different order for processing your records. The indexes you create are stored in a <a href="glsstructural_compound_index.htm">compound structural index file</a> that is opened and updated whenever the table is used. The name for the index file is the same as its associated table and has a .cdx file extension.</p>
<p>
Indexes are so easy to create, you might be tempted to define one for every field. However, indexes that you use only rarely can slow performance. Other types of index files are better for storing indexes you don’t use regularly. For more information about the other kinds of index files available to you, see Chapter 7, <a href="dgworking_with_tables.htm">Working with Tables</a>, in the <i>Programmer’s Guide</i>.</p>

<h2><a name="ugcreating_an_index"></a>Creating an Index</h2>
<p>
Once you have a table, you can create an index on a field or on an expression. To use indexes efficiently, create indexes on fields you often use in filters on tables, in queries, in views, or for reports. If you place an index on a field that isn't useful for filtering or querying, such as a street address, your filter might slow down processing.</p>
<p class=label>
<b>To create an index</b>
<ol>
<li>
In the <b>Project Manager</b>, select the table you want to add an index to, then choose <b>Modify</b>.<br><br></li>
<li>
In the <b>Table Designer</b>, select the <b>Indexes</b> tab.<p class=label>
<b>The Indexes tab in the Table Designer</b>
<p>
<img src="afu02014.gif" border=0></P></li>
<li>
In the <b>Name</b> box, type a name for the index.<br><br></li>
<li>
From the <b>Type</b> list, select an index type.<p class=tl>
For more information about index types, see the following section, <a href="#ugchoosing_an_index_type">Choosing an Index Type</a>.</P></li>
<li>
In the <b>Expression</b> box, type the name of the field you want to order the records by.<p class=tl>
-or-</P><p class=tl>
Build an expression by choosing the dialog button at the end of the box to display the <b>Expression Builder</b>.</P><p class=tl>
For information about adding multiple fields to your index expression, see the following section, <a href="#ugordering_by_multiple_fields">Ordering by Multiple Fields</a>.</P></li>
<li>
If you want to select records, enter a filter expression in the <b>Filter</b> box or select the button at the end of the box to build an expression.<p class=tl>
For more information about using a filtered index, see the section, <a href="#ugfiltering_records">Filtering Records</a>, later in this chapter.</P></li>
<li>
Choose <b>OK</b>.</li>
</ol>
<p>
Once you create an index for the table, you can use it to order your records.</p>
<p class=label>
<b>To order records using an index</b>
<ol>
<li>
In the <b>Project Manager</b>, select the table with the index you created.<br><br></li>
<li>
Choose <b>Browse</b>.<br><br></li>
<li>
From the <b>Table</b> menu, choose <b>Properties</b>.<br><br></li>
<li>
In the <b>Index order</b> box, select the index you want to use.<br><br></li>
<li>
Choose <b>OK</b>.</li>
</ol>
<p>
The table appears in the Browse window, displaying the records in the order your index specifies. You can also order the results of queries or reports by running them while the index is selected.</p>

<h3><a name="ugchoosing_an_index_type"></a>Choosing an Index Type</h3>
<p>
You can choose one of four types of indexes:</p>
<ul type=disc>
<li>
Primary</li>
<li>
Candidate</li>
<li>
Regular</li>
<li>
Unique</li>
</ul>
<p>
<a href="glsprimary_index.htm">Primary indexes</a> ensure only unique values are entered into a field and determine the order in which the records are processed. You can create one primary index for each table if the table is included in a database. If the table already has a primary index, add a candidate index.</p>
<p>
<a href="glscandidate_index.htm">Candidate indexes</a> also enforce unique values and determine the order in which the records are processed, like a primary index. You can have multiple candidate indexes per table in both database and free tables.</p>
<p>
<a href="glsregular_index.htm">Regular indexes</a> determine the order in which records are processed but allow duplicate values to be entered into a field. You can add more than one regular index to a table.</p>
<p>
For compatibility with previous versions, you can also create a <a href="glsunique_index.htm">unique index</a> that selects and orders a subset of records based on the first occurrence of a value in the field you specify. If you want to select records this way, you might want to create a query or view instead. For more information about queries or views, see Chapter 4, <a href="ugretrieving_data.htm">Retrieving Data</a>, or Chapter 5, <a href="ugupdating_data_with_views.htm">Updating Data with Views</a>.</p>

<h3><a name="ugordering_by_multiple_fields"></a>Ordering by Multiple Fields</h3>
<p>
To increase the speed of queries or views that have filters on more than one field, you can order your records by specifying multiple fields in the index expression. The fields are evaluated in the same order they appear in the expression. If you create an index expression using numeric fields, the index orders the records by the sum of the fields, not the fields themselves.</p>
<p class=label>
<b>To order records using multiple fields</b>
<ol>
<li>
In the <b>Project Manager</b>, select the table you want to add an index to and choose <b>Modify</b>.<br><br></li>
<li>
In the <b>Indexes</b> tab, enter a name and type for the index.<br><br></li>
<li>
In the <b>Expression</b> box, enter an expression that lists the fields you want to order by.<p class=tl>
For example, you might want to order the records by country, postal code within the country, and the company name within the postal code. You can use a plus sign (+) to create the index expression from character fields.</P><pre><code>customer.country + customer.postalcode + customer.company
</code></pre>
<p class=tl>
Notice that the field that changes the least is the first one in the list.</P></li>
<li>
Choose <b>OK</b>.</li>
</ol>
<p>
If you want to use fields of different data types, you can convert the non-character fields to characters by enclosing the field with <code>STR( )</code>. For example, you can try ordering the records by the Maximum Order Amount field, then by the company name. In this expression, <code>maxordamt</code> is a Currency field and <code>company</code> is a Character field.</p>
<pre><code>STR(customer.maxordamt,20,4) + customer.company
</code></pre>

<h3><a name="ugfiltering_records"></a>Filtering Records</h3>
<p>
You can control which records are included in the index by adding a filter expression.</p>
<p class=label>
<b>To filter records</b>
<ol>
<li>
In the <b>Project Manager</b>, select the table you want to add an index to and choose <b>Modify</b>.<br><br></li>
<li>
In the <b>Indexes</b> tab, create or select an index.<br><br></li>
<li>
In the <b>Filter</b> box, enter a filter expression.<p class=tl>
For example, try creating a filter that selects only the records for customers in Canada:</P><pre><code>customer.country = "Canada"
</code></pre>
</li>
<li>
Choose <b>OK</b>.</li>
</ol>

<h2><a name="ugusing_indexes"></a>Using Indexes</h2>
<p>
You can improve performance by creating and using indexes for recurring tasks such as ordering your records or supporting table relationships. You can accomplish several tasks depending on the type of index you create.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=51%><b>If you want to</b></td>
<td class=label width=49%><b>Use</b></td>
</tr>
<tr valign=top>
<td width=51%>Order the records to increase the speed they are displayed, queried, or printed</td>
<td width=49%>A <a href="glsregular_index.htm">regular</a>, <a href="glscandidate_index.htm">candidate</a>, or <a href="glsprimary_index.htm">primary</a> index.</td>
</tr>
<tr valign=top>
<td width=51%>Control entry of duplicate values in a field and order the records</td>
<td width=49%>A <a href="glsprimary_index.htm">primary</a> or <a href="glscandidate_index.htm">candidate</a> index for a database table or a candidate index for a free table.</td>
</tr>
</table><br>
<h3>Ordering Your Records</h3>
<p>
You can order your records by a field name or another index expression. The index evaluates the expression to determine the order that the records should appear, then stores a list of pointers to the records for processing in that order.</p>
<p class=label>
<b>To create an index for ordering records</b>
<ol>
<li>
In the <b>Project Manager</b>, select the table you want to add an index to and choose <b>Modify</b>.<br><br></li>
<li>
In the <b>Indexes</b> tab, enter a name and type for the index.<br><br></li>
<li>
In the <b>Expression</b> column, type the field name you want to use to order the records.<p class=tl>
-or-</P><p class=tl>
Type an expression you want to use to order the records or build an expression by choosing the button at the end of the box to display the <b>Expression Builder</b>.</P></li>
<li>
If you want the records to appear in descending order, select the arrow button to the left of the index name.<p class=tl>
The arrow on the button points down for descending order and up for ascending.</P></li>
<li>
Choose <b>OK</b>.</li>
</ol>
<h3>Controlling Entry of Duplicate Values in a Field</h3>
<p>
You might want to control entry of duplicate values in a field. For example, each customer should have a unique value in the Cust_ID field of the Customer table.</p>
<p class=label>
<b>An index can enforce entering unique values into a field.</b></p>
<p>
<img src="afu02015.gif" border=0></p>
<p>
You can use the field as a key field that uniquely identifies a record. If your table is part of a database, you can use either a primary or candidate index. If your table is a free table or already has a primary index, you must use a candidate index.</p>
<p class=label>
<b>To create an index that enforces unique values in a field</b>
<ol>
<li>
In the <b>Project Manager</b>, select the table you want to add an index to and choose <b>Modify</b>.<br><br></li>
<li>
In the <b>Indexes</b> tab, create an index.<br><br></li>
<li>
In the <b>Type</b> column, select <b>Primary</b> or <b>Candidate</b>.<br><br></li>
<li>
Choose <b>OK</b>.</li>
</ol>
</BODY>
</HTML>
