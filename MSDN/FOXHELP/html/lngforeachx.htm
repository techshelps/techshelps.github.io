<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FOR EACH…ENDFOR Command Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lngforeachx"></a><sup></sup>FOR EACH&nbsp;…&nbsp;ENDFOR Command Examples</b></p>
<p>
The following examples demonstrate how FOR EACH is used to enumerate elements in a Visual FoxPro array, an OLE array, and a set command buttons assigned to an object array.</p>
<p>
In the following example, a Visual FoxPro variable array is created and FOR EACH is used to display the contents of each element in the array.</p>
<pre><code>DIMENSION cMyArray(3)
cMyArray[1] = 'A'
cMyArray[2] = 'B'
cMyArray[3] = 'C'

FOR EACH cMyVar IN cMyArray
 &nbsp; ? cMyVar
ENDFOR
</code></pre>
<p>
In the following example, an instance of Microsoft Excel is created, and a new workbook is added. FOR EACH is used to display the name of each worksheet in the workbook. This example requires that Microsoft Excel be properly installed on the machine on which the example is run.</p>
<pre><code>oExcel = CREATE("Excel.Application")
oExcel.Workbooks.ADD

FOR EACH oMyVar IN oExcel.sheets
 &nbsp; ? oMyVar.name
NEXT oMyVar
</code></pre>
<p>
In the following example, five command buttons are placed on a form. FOR EACH is used to display the buttons on the form and specify the captions, font styles and positions of each button.</p>
<pre><code>PUBLIC oMyObject
oMyObject = CREATEOBJECT("frmTest")
oMyObject.SHOW

DEFINE CLASS frmTest AS FORM
Height = 200
DIMENSION MyArray[5]
 &nbsp; PROCEDURE Init

 &nbsp;&nbsp;&nbsp;&nbsp; FOR i = 1 to 5
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; THIS.AddObject('THIS.MyArray[i]',;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'COMMANDBUTTON')
 &nbsp;&nbsp;&nbsp;&nbsp; ENDFOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 

 &nbsp;&nbsp;&nbsp;&nbsp; ****** FOR EACH - NEXT ******
 &nbsp;&nbsp;&nbsp;&nbsp; FOR EACH oButton IN THIS.MyArray
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oButton.Visible = .T.
 &nbsp;&nbsp;&nbsp;&nbsp; NEXT
 &nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp; ****** FOR EACH - NEXT element&nbsp; ******
 &nbsp;&nbsp;&nbsp;&nbsp; FOR EACH oButton IN THIS.MyArray
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oButton.FontBold = .T.
 &nbsp;&nbsp;&nbsp;&nbsp; NEXT obutton

 &nbsp;&nbsp;&nbsp;&nbsp; j = 1
 &nbsp;&nbsp;&nbsp;&nbsp; ****** FOR EACH - ENDFOR ******
 &nbsp;&nbsp;&nbsp;&nbsp; FOR EACH oButton IN THIS.MyArray
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oButton.top = j * 30
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = j + 1
 &nbsp;&nbsp;&nbsp;&nbsp; ENDFOR&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp; ****** FOR EACH - ENDFOR element ******
 &nbsp;&nbsp;&nbsp;&nbsp; FOR EACH oButton IN THIS.MyArray
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oButton.FontItalic = .T.
 &nbsp;&nbsp;&nbsp;&nbsp; ENDFOR obutton
 &nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp; j = 1
 &nbsp;&nbsp;&nbsp;&nbsp; ****** EXIT&nbsp; ******
 &nbsp;&nbsp;&nbsp;&nbsp; FOR EACH oButton IN THIS.MyArray
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oButton.Caption = "test" + str(j)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = j+1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF j &gt; 3 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EXIT
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENDIF
 &nbsp;&nbsp;&nbsp;&nbsp; NEXT
 &nbsp;&nbsp;&nbsp;&nbsp; 
 &nbsp;&nbsp;&nbsp;&nbsp; j = 1
 &nbsp;&nbsp;&nbsp;&nbsp; ****** LOOP&nbsp; ******
 &nbsp;&nbsp;&nbsp;&nbsp; FOR EACH oButton IN THIS.MyArray
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF j &gt; 3
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LOOP
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENDIF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = j + 1
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oButton.Left = 25
 &nbsp;&nbsp;&nbsp;&nbsp; NEXT
 &nbsp; ENDPROC
ENDDEFINE
</code></pre>
</BODY>
</HTML>
