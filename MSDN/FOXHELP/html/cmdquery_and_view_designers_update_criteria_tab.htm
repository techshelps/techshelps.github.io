<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Update Criteria Tab, View Designer</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="cmdquery_and_view_designers_update_criteria_tab"></a><sup></sup>Update Criteria Tab, View Designer</h1>
<p>
<a href="cmdquery_and_view_designers_update_criteria_tabsa.htm">See Also</a></p>
<p>
Specifies conditions for sending changes in the view to the original records in the tables used in the view. This tab is only displayed in the <a href="wndquery_designer.htm">View Designer</a>.</p>
<h3>Tab Options</h3>
<p class=dt>
<b>Table</b></p>
<p class=indent>
Specifies which tables used in the view can accept changes. The list shows the tables that have fields in the <b>Selected</b> fields list of the <a href="cmdquery_and_view_designers_fields_tab.htm">Fields</a> tab.</p>
<p class=dt>
<b>Reset Key</b></p>
<p class=indent>
Selects the primary key field from each table as the key fields for the view and places a check mark under the key symbol in the <b>Field</b> name list for each primary key field. Key fields are used for matching the changes in the view to the original record in the table.</p>
<p class=dt>
<b>Update All</b></p>
<p class=indent>
Selects all fields other than the key fields for updating and places a check mark under the pencil symbol in the <b>Field</b> name list.</p>
<p class=dt>
<b>Send SQL Updates</b></p>
<p class=indent>
Specifies whether changes to the records in the view are actually sent to the original tables. For more information, see "Combining Local and Remote Data in a View" in Chapter 6, <a href="ugquerying_and_updating_multiple_tables.htm">Querying and Updating Multiple Tables</a>, in the <i>User's Guide</i>.</p>
<p class=dt>
<b>Field Name Pane</b></p>
<p class=indent>
Shows the fields that you have selected for output and, therefore, are available to update.
<ul type=disc>
<li>
<b>Key Field (marked with a key symbol)</b>&nbsp;&nbsp;&nbsp;Specifies whether the field is a key field.<br><br></li>
<li>
<b>Updatable (marked with a pencil symbol)</b>&nbsp;&nbsp;&nbsp;Specifies whether the field is updatable.<br><br></li>
<li>
<b>Field Name</b>&nbsp;&nbsp;&nbsp;Displays the name of the output fields available to mark as key fields or updatable.</li>
</ul>
<h4>SQL WHERE Clause Includes</h4>
<p>
Controls which fields are added to the WHERE clause to detect update conflicts on the server when the changes to the view are sent to the original tables. </p>
<p>
A conflict is based on a comparison between the old values in the view, OLDVAL( ), and the current values in the original table, CURVAL( ). If the values are equal, the original table is considered unchanged and no conflict exists. If they are not equal, a conflict exists and the data source returns an error.</p>
<p>
The error returned for a conflict between the old value and the current value is Error 1585 "Record has been modified by another" or Error 1494 "Update conflict. Use TABLEUPDATE() to force the update or TABLEREVERT() to rollback".</p>
<p class=dt>
<b>Key Fields Only</b></p>
<p class=indent>
Sets the WHERE clause to detect a conflict if a key field has been changed in the original table. Changes made by another user to any other field in the original record of the table are not compared.</p>
<p class=dt>
<b>Key and Updatable Fields</b></p>
<p class=indent>
Sets the WHERE clause to detect a conflict if another user changed any of the fields that were updatable.</p>
<p class=dt>
<b>Key and Modified Fields</b></p>
<p class=indent>
Sets the WHERE clause to detect a conflict if the key field or one of the modified fields in the record in the original table has changed since the view was first retrieved (default).</p>
<p class=dt>
<b>Key and Timestamp</b></p>
<p class=indent>
Sets the WHERE clause to detect a conflict if the timestamp of the record on the original table has changed since it was first retrieved. This option is only available if the remote table has a timestamp column.</p>
<h4>Update Using</h4>
<p>
Specifies how updates are performed on the back-end server.</p>
<p class=dt>
<b>SQL DELETE then INSERT</b></p>
<p class=indent>
Deletes the record from the original table, and then creates a new record from the modified record in the view.</p>
<p class=dt>
<b>SQL UPDATE</b></p>
<p class=indent>
Uses the changes in the fields of the view to modify the fields in the original table.</p>
</BODY>
</HTML>
