<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CommandTargetQuery Event</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngcommandtargetquery_event"></a><sup></sup>CommandTargetQuery Event</h1>
<p>
<a href="lngcommandtargetquery_eventat.htm">Applies To</a> &nbsp; <a href="lngcommandtargetquery_eventsa.htm">See Also</a></p>
<p>
Occurs when an Active Document host updates its user interface.</p>
<p class=label>
<b>Syntax</b></p>
<p>
PROCEDURE <i>Object</i>.CommandTargetQuery<br>
[LPARAMETERS <i>aCommands</i>, <i>nCommandTextFlag</i>, <i>cCommandTextOut</i>]</p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>aCommands</i></p>
<p class=indent>
A two-dimensional array containing a list of commands supported by the Active Document host.</p>
<p class=indent>
The first column of the array contains numeric values that correspond to the commands supported by the Active Document host. For a list of the commands and their numeric values, see the <i>nCommandID</i> parameter in <a href="lngcommandtargetexec_event.htm">CommandTargetExec Event</a>.</p>
<p class=indent>
The second column of the array contains numeric values that correspond to the support status for each of the commands. The following table lists the values that the second column can contain and the corresponding support status for the commands.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=8%><b>Value</b></td>
<td class=label width=27%><b>FOXPRO.H Constant</b></td>
<td class=label width=65%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=8%>0</td>
<td width=27%>CMDF_NOTSUPPORTED</td>
<td width=65%>The command is not supported by this object.</td>
</tr>
<tr valign=top>
<td width=8%>1</td>
<td width=27%>CMDF_SUPPORTED</td>
<td width=65%>The command is supported by this object.</td>
</tr>
<tr valign=top>
<td width=8%>2</td>
<td width=27%>CMDF_ENABLED</td>
<td width=65%>The command is available and enabled.</td>
</tr>
<tr valign=top>
<td width=8%>4</td>
<td width=27%>CMDF_LATCHED</td>
<td width=65%>The command is an on-off toggle and is currently on.</td>
</tr>
<tr valign=top>
<td width=8%>8</td>
<td width=27%>CMDF_NINCHED</td>
<td width=65%>The command is an on-off toggle but the state cannot be determined because the attribute of this command is found in both on and off states in the relevant selection. This state corresponds to an “indeterminate” state of a 3-state check box, for example.</td>
</tr>
</table><br>
<p class=indent>
The second column of the array initially contains zero for each command. Your event code should store a value to the second column to indicate the level of support provided by the Active Document for each command. You can add any combination of these values together to specify additional levels of support. For example, your Active Document procedure for a command is supported (1), and available and enabled (2), store 3 (1 + 2) to the second column for the corresponding command.</p>
<p class=dt>
<i>nCommandTextFlag</i></p>
<p class=indent>
A parameter passed from the Active Document host to the CommandTargetExec event. <i>nCommandTextFlag</i> indicates the type of command information to pass to the Active Document host via the <i>cCommandTextOut</i> parameter. The following table lists the values for <i>nCommandTextFlag</i> and the corresponding command information to pass to the Active Document host.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=27%><b><i>nCommandTextFlag</i></b></td>
<td class=label width=73%><b>Command Information</b></td>
</tr>
<tr valign=top>
<td width=27%>0</td>
<td width=73%>No extra information is requested.</td>
</tr>
<tr valign=top>
<td width=27%>1</td>
<td width=73%>The Active Document should provide the localized name for the command.</td>
</tr>
<tr valign=top>
<td width=27%>2</td>
<td width=73%>The Active Document should provide a localized status bar string for the command.</td>
</tr>
</table><br>
<p class=dt>
<i>cCommandTextOut</i></p>
<p class=indent>
A parameter passed from the CommandTargetExec event to Active Document host. <i>cCommandTextOut</i> is the text that is displayed for a command, usually in the Active Document host’s status bar. <i>cCommandTextOut</i> applies to the command in the first row of the array.</p>
<p class=label>
<b>Remarks</b></p>
<p>
The CommandTargetQuery event lets you notify an Active Document’s host which commands the Active Document can support, and what type of support is available for each command. You can also specify the text that is displayed when a command (typically a menu item) is selected.</p>
<p>
Visual FoxPro utilizes the IOleCommandTarget interface for the CommandTargetExec and CommandTargetQuery events. Search for IOleCommandTarget in the MSDN library for additional information about how these events are implemented.</p>
<p>
Note that Internet Explorer versions 3 and 4 typically don’t request the command text via <i>cCommandTextOut</i>. Therefore, <i>nCommandTextFlag</i> is typically zero and <i>cCommandTextOut</i> typically contains the null value. These parameters are included for future compatibility with the IOleCommandTarget interface, and can be safely ignored in your applications.</p>
</BODY>
</HTML>
