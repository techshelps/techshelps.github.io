<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeyPress Event</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngkeypress_event"></a><sup></sup>KeyPress Event</h1>
<p>
<a href="lngkeypress_eventat.htm">Applies To</a> &nbsp; <a href="lngkeypress_eventsa.htm">See Also</a></p>
<p>
Occurs when the user presses and releases a key.</p>
<p class=label>
<b>Syntax</b></p>
<p>
PROCEDURE <i>Object.</i>KeyPress<br>
LPARAMETERS [<i>nIndex</i>,] <i>nKeyCode</i>, <i>nShiftAltCtrl</i></p>
<p>
-or-</p>
<p>
LPARAMETERS <i>nKeyCode</i>, <i>nShiftAltCtrl</i></p>
<p class=label>
<b>Parameters</b></p>
<p>
You must include an LPARAMETERS or PARAMETERS statement in the event procedure and specify a name for each parameter.</p>
<p class=dt>
<i>nIndex</i></p>
<p class=indent>
Uniquely identifies a control if it is in a control array.</p>
<p class=dt>
<i>nKeyCode</i></p>
<p class=indent>
Contains a number which identifies the key pressed. For a list of codes for special keys and key combinations, see <a href="lnginkeylp_rp.htm">INKEY(&nbsp;)</a>.</p>
<p class=dt>
<i>nShiftAltCtrl</i></p>
<p class=indent>
Sets a bit if a modifier key is held down while the key identified in <i>nKeyCode</i> is pressed.</p>
<p class=tl>
The valid modifier keys are the SHIFT, CTRL, and ALT keys.</P><p class=tl>
The values returned in <i>nShiftAltCtrl</i> for individual modifier keys are listed in the following table.</P><p class=label>
<b>Modifier key values for </b><i>nShiftAltCtrl</i></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>Key</b></td>
<td class=label width=62%><b>Value</b></td>
</tr>
<tr valign=top>
<td width=38%>SHIFT</td>
<td width=62%>1</td>
</tr>
<tr valign=top>
<td width=38%>CTRL</td>
<td width=62%>2</td>
</tr>
<tr valign=top>
<td width=38%>ALT</td>
<td width=62%>4</td>
</tr>
</table><br>
<p class=tl>
This parameter is the sum of the bits, with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2 ).</P><p class=tl>
These bits correspond to the values 1, 2, and 4, respectively. This parameter indicates the state of these keys. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys is pressed. For example, if both CTRL and ALT are pressed, the value of <i>nShiftAltCtrl</i> is 6. </P><p class=label>
<b>Remarks</b></p>
<p>
The object with the focus receives the event.</p>
<p>
A form can receive the KeyPress event in three special cases:
<ul type=disc>
<li>
The form contains no controls, or none of its controls is visible and enabled.<br><br></li>
<li>
The form's KeyPreview property is set to true (.T.). The form receives the KeyPress event first and then the control with focus receives the event.<br><br></li>
<li>
If a control on the form cannot process a keystroke (for example, when Tab is pressed to move the focus to the next control).</li>
</ul>
<p>
A KeyPress event is useful for intercepting keystrokes entered in a control. It enables you to immediately test keystrokes for validity or to format characters as they are typed. Use the KeyPreview property to create global keyboard-handling routines.</p>
<p>
The KeyPress event does not occur for any combination of keys with the ALT key.</p>
</BODY>
</HTML>
