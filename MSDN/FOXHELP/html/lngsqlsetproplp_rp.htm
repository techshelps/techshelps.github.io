<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLSETPROP( ) Function</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngsqlsetproplp_rp"></a><sup></sup>SQLSETPROP(&nbsp;) Function</h1>
<p>
<a href="lngsqlsetproplp_rpx.htm">Example</a> &nbsp; <a href="lngsqlsetproplp_rpsa.htm">See Also</a></p>
<p>
Specifies settings for an active connection.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SQLSETPROP(<i>nConnectionHandle</i>, <i>cSetting</i> [, <i>eExpression</i>])</p>
<p class=label>
<b>Returns</b></p>
<p>
Numeric</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>nConnectionHandle</i></p>
<p class=indent>
Specifies the connection handle to the data source returned by SQLCONNECT(&nbsp;).</p>
<p class=dt>
<i>cSetting</i></p>
<p class=indent>
Specifies the setting. The following table lists the values for <i>cSetting.</i></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=26%><b>Setting</b></td>
<td class=label width=74%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=26%>Asynchronous</td>
<td width=74%>Specifies whether result sets are returned synchronously (false (.F.), the default), or asynchronously (true (.T.)).<br>
Read-Write.</td>
</tr>
<tr valign=top>
<td width=26%>BatchMode</td>
<td width=74%>Specifies whether SQLEXEC(&nbsp;) returns result sets all at once (true (.T.), the default), or individually with SQLMORERESULTS(&nbsp;) (false (.F.)).<br>
Read-Write.</td>
</tr>
<tr valign=top>
<td width=26%>ConnectBusy </td>
<td width=74%>Contains true (.T.) if a shared connection is busy; otherwise contains false (.F.).<br>
Read-Only.</td>
</tr>
<tr valign=top>
<td width=26%>ConnectString</td>
<td width=74%>The login connection string.<br>
Read-Only.</td>
</tr>
<tr valign=top>
<td width=26%>ConnectTimeOut</td>
<td width=74%>Specifies the time to wait (in seconds) before returning a connection time-out error. If you specify 0, the wait is indefinite and a time-out error is never returned. ConnectTimeOut can be 0 to 600. The default is 15.<br>
Read-Write.</td>
</tr>
<tr valign=top>
<td width=26%>DataSource</td>
<td width=74%>The name of the data source as defined in the ODBC.INI file.<br>
Read-Write.</td>
</tr>
<tr valign=top>
<td width=26%>DispLogin</td>
<td width=74%>Contains a numeric value that determines when the ODBC Login dialog box is displayed. DispLogin may assume the following values:<p>
1 or DB_PROMPTCOMPLETE (from FOXPRO.H).<br>
1 is the default.</p>
<p>
2 or DB_PROMPTALWAYS (from FOXPRO.H).</p>
<p>
3 or DB_PROMPTNEVER (from FOXPRO.H).</p>
<p>
If 1 or DB_PROMPTCOMPLETE is specified, Visual FoxPro displays the ODBC Login dialog box only if any required information is missing.</p>
<p>
If 2 or DB_PROMPTALWAYS is specified, the ODBC Login dialog box is always displayed, allowing you to change settings before connecting.</p>
<p>
If 3 or DB_PROMPTNEVER is specified, the ODBC Login dialog box isn't displayed and Visual FoxPro generates an error if the required login information isn't available.<br>
Read-Write.</p>
</td>
</tr>
<tr valign=top>
<td width=26%>DispWarnings</td>
<td width=74%>Specifies if error messages are displayed (true (.T.)) or are not displayed (false (.F.), the default).<br>
Read-Write.</td>
</tr>
<tr valign=top>
<td width=26%>IdleTimeout</td>
<td width=74%>The idle timeout interval in seconds. Active connections are deactivated after the specified time interval. The default value is 0 (wait indefinitely).<br>
Read-Write.</td>
</tr>
<tr valign=top>
<td width=26%>ODBChdbc</td>
<td width=74%>The internal ODBC connection handle which may be used by external library files (FLL files) to call ODBC.<br>
Read-Only.</td>
</tr>
<tr valign=top>
<td width=26%>ODBChstmt</td>
<td width=74%>The internal ODBC statement handle which may be used by external library files (FLL files) to call ODBC.<br>
Read-Only.</td>
</tr>
<tr valign=top>
<td width=26%>PacketSize</td>
<td width=74%>The size of the network packet used by the connection. Adjusting this value can improve performance. The default value is 4096 bytes (4K).<br>
Read-Write</td>
</tr>
<tr valign=top>
<td width=26%>Password</td>
<td width=74%>The connection password.<br>
Read-Only.</td>
</tr>
<tr valign=top>
<td width=26%>QueryTimeOut</td>
<td width=74%>Specifies the time to wait (in seconds) before returning a general time-out error. If you specify 0 (the default), the wait is indefinite and a time-out error is never returned. QueryTimeOut can be 0 to 600.<br>
Read-Write.</td>
</tr>
<tr valign=top>
<td width=26%>Transactions</td>
<td width=74%>Contains a numeric value that determines how the connection manages transactions on the remote table. Transactions may assume the following values:<p>
1 or DB_TRANSAUTO (from FOXPRO.H).<br>
1 is the default. Transaction processing for the remote table is automatically handled.</p>
<p>
2 or DB_TRANSMANUAL (from FOXPRO.H). Transaction processing is handled manually through <a href="lngsqlcommitlp_rp.htm">SQLCOMMIT(&nbsp;)</a> and <a href="lngsqlrollbacklp_rp.htm">SQLROLLBACK(&nbsp;)</a>.<br>
Read-Write.</p>
</td>
</tr>
<tr valign=top>
<td width=26%>UserId</td>
<td width=74%>The user identification.<br>
Read-Only.</td>
</tr>
<tr valign=top>
<td width=26%>WaitTime</td>
<td width=74%>The amount of time in milliseconds that elapses before Visual FoxPro checks if the SQL statement has completed executing. The default is 100 milliseconds.<br>
Read-Write.</td>
</tr>
</table><br>
<p class=dt>
<i>eExpression</i></p>
<p class=indent>
Specifies the value for the setting you designate with <i>cSetting</i>. If you omit <i>eExpression</i>, the default value is restored for the setting.</p>
<p class=label>
<b>Remarks</b></p>
<p>
SQLSETPROP(&nbsp;) returns 1 if it is successful; otherwise, it returns&nbsp; – 1 if a connection level error occurs or&nbsp; – 2 if an environment level error occurs.</p>
<p>
Use SQLSETPROP(&nbsp;) to specify settings at the connection level. To specify Visual FoxPro default settings at the environment level, include 0 as the connection handle.</p>
<p>
The ConnectTimeOut option can be set only at the Visual FoxPro level and has no equivalent at the connection level. You can set all other options at either the connection or the Visual FoxPro level. Each option set at the Visual FoxPro level serves as a default value for subsequent connections.</p>
<p>
Use SQLGETPROP(&nbsp;) to return the current value for a specified setting.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The ODBC login dialog must be disabled to support SQL pass through with Microsoft Transaction Server. Use SQLSETPROP(<i>cConnectionHandle</i>, 'DispLogin', 3) to disable the ODBC login dialog. The ODBC login dialog can also be disabled in the <a href="wndconnection_designer.htm">Connection Designer</a>.</p>
</BODY>
</HTML>
