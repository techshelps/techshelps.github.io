<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Changing Converted Screens to Visual FoxPro Forms</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="conchanging_converted_screens_to_visual_foxpro_forms"></a><sup></sup>Changing Converted Screens to Visual FoxPro Forms</h1>
<p>
<a href="conchanging_converted_screens_to_visual_foxpro_formssa.htm">See Also</a></p>
<p>
Converted FoxPro 2.6 screens run in a compatibility mode provided by the <a href="lngwindowtype_property.htm">WindowType</a> property. To understand how the Visual FoxPro architecture supports the screens in READ compatibility mode, see <a href="conoverview_of_read_compatibility_architecture.htm">Overview of READ Compatibility Architecture.</a></p>
<p>
The following table describes the basic feature mapping in converted screens.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=48%><b>FoxPro 2.6 screen feature</b></td>
<td class=label width=52%><b>Visual FoxPro feature</b></td>
</tr>
<tr valign=top>
<td width=48%>Screen set</td>
<td width=52%><a href="ctlformset_object.htm">Form set</a></td>
</tr>
<tr valign=top>
<td width=48%>Screen</td>
<td width=52%><a href="ctlform_object.htm">Form</a> contained in a form set</td>
</tr>
<tr valign=top>
<td width=48%><a href="lngread.htm">READ</a> level</td>
<td width=52%><a href="ctlpage_object.htm">Page</a> contained in a <a href="ctlpageframe_control.htm">page frame</a></td>
</tr>
<tr valign=top>
<td width=48%>READ screen mode</td>
<td width=52%>WindowType property = 2</td>
</tr>
<tr valign=top>
<td width=48%>READ MODAL screen mode</td>
<td width=52%>WindowType property = 3</td>
</tr>
</table><br>
<p>
You can change converted screens to run directly from the .SCX file. To remove the need for the .spr file created during conversion, you might need to change any files that call the converted screen. You might also need to move code from the .SPR file to the converted screen (.scx file). </p>
<p>
You can change converted FoxPro 2.6 screens to the Visual FoxPro event model.</p>
<p class=label>
<b>To change converted screens to Visual FoxPro forms</b>
<ol>
<li>
Change the WindowType property from 2 (Read) to 0 (Modeless), or from 3 (Read Modal) to 1 (Modal).<p class=atl>
<B><b>Note</b></B> When you make this change, the <a href="conform_sets_and_their_properties_and_events.htm">READ compatibility properties and events</a> are no longer available and the WindowType setting cannot be changed back.</p></li>
<li>
If you have a single form, move form set event code to the matching or appropriate form events and remove the form set.<br><br></li>
<li>
Move code from the READ-compatibility events to the form events and methods that are now available, taking event firing sequences into account. For more information on the event firing sequence, see “The Visual FoxPro Event Sequence” in Chapter 4, <a href="dgunderstanding_the_event_model.htm">Understanding the Event Model,</a> in the <i>Developer’s Guide</i>.<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=48%><b>Read-compatibility events</b></td>
<td class=label width=52%><b>Form events and methods</b></td>
</tr>
<tr valign=top>
<td width=48%><a href="lngreadactivate_event.htm">ReadActivate</a> event<br>
<a href="lngreaddeactivate_event.htm">ReadDeactivate</a> event<br>
<a href="lngreadshow_event.htm">ReadShow</a> event<br>
<a href="lngreadvalid_event.htm">ReadValid</a> event<br>
<a href="lngreadwhen_event.htm">ReadWhen</a> event</td>
<td width=52%><a href="lngactivate_event.htm">Activate</a> event<br>
<a href="lngload_event.htm">Load</a> event<br>
<a href="lngshow_method.htm">Show</a> method<br>
<a href="lngdeactivate_event.htm">Deactivate</a> event</td>
</tr>
</table>
</li>
<li>
<a href="conremoving_pages_and_page_frames.htm">Remove page and page frame controls</a> that are extraneous.<br><br></li>
<li>
Process parameters in the <a href="lnginit_event.htm">Init</a> event of the form instead of the screen Load event.<br><br></li>
<li>
Replace preprocessor constants that mapped to property settings with the evaluated value.<br><br></li>
<li>
Property settings in Visual FoxPro are not preprocessed. They must contain actual values or expressions that can be evaluated at run time. Method and event code is preprocessed, and constants defined there will be evaluated correctly.<br><br></li>
<li>
Adjust scoping of variables in events or methods, which are private by default, by using the <a href="lngpublic.htm">PUBLIC,</a> <a href="lngprivate.htm">PRIVATE,</a> or <a href="lnglocal.htm">LOCAL</a> commands or by adding properties to the form.<p class=tl>
For details on scoping, see <a href="tblscope_of_data_containers.htm">Scope of Data Containers.</a></P></li>
<li>
To run the form directly, move code from the generated .SPR file to appropriate methods in the form.</li>
</ol>
<p class=indent>
<B><b>Note</b></B> The Visual FoxPro 3.0 defaults in the FontSize, FontBold, and ColorSource properties differ from the Visual FoxPro, version 5.0 and later defaults in the same properties.</p>
<p>
For more information, see <a href="ovrconverting_visual_foxpro_3.0_files.htm">Converting Visual FoxPro 3.0 Files.</a> Also see <a href="tblscope_of_data_containers.htm">Scope of Data Containers,</a> and <a href="dgunderstanding_the_event_model.htm#dgtracking_event_sequences">Tracking Event Sequences.</a></p>
</BODY>
</HTML>
