<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_DBSeek( ) API Library Routine</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lng_dbseeklp_rp"></a><sup></sup>_DBSeek(&nbsp;) API Library Routine</h1>
<p>
<a href="lng_dbseeklp_rpsa.htm">See Also</a> &nbsp; <a href="lng_dbseeklp_rpx.htm">Example</a></p>
<p>
Searches an indexed table in the current work area for the first record whose index key matches the value <i>val</i>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>long _DBSeek</b>(<b>Value FAR </b><i>*val</i>)<br>
<b>Value FAR </b><i>*val</i>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Sought value. */</p>
<p class=label>
<b>Remarks</b></p>
<p>
If _DBSeek(&nbsp;) finds a matching record, it moves the record pointer to the matching record and returns the record number. The match must be exact unless you SET EXACT is set to OFF. If _DBSeek(&nbsp;) doesn't find a matching record, it returns 0. If no match is found and SET NEAR is set to ON, the record pointer is positioned immediately after the closest matching record. If SET NEAR is set to OFF, the record pointer is positioned at the end of the file.</p>
<p>
If the matching record is an added buffered record that has not been committed, the value returned by _DBSeek(&nbsp;) differs from the value returned by RECNO(&nbsp;). RECNO(&nbsp;) returns a negative value, indicating the record is buffered. The value returned by _DBSeek(&nbsp;) is one greater than the number of records in the table plus the number of buffered records before the matching record.</p>
<p>
If an error occurs, _DBSeek(&nbsp;) returns a negative integer whose absolute value is a Visual FoxPro error number.</p>
<p>
When seeking a numeric field, <i>val</i> must be set to ev_type 'N', even if that field has no decimal digits.&nbsp; If <i>val</i> has an ev_type of 'I', _DBSeek( ) will return the internal error number -302, "Data type mismatch".</p>
<p>
For more information on how to create an API library and integrate it with Visual FoxPro, see Chapter 28, <a href="dgaccessing_the_visual_foxpro_api.htm">Accessing the Visual FoxPro API</a>, in the <i>Programmer's Guide</i>.</p>
</BODY>
</HTML>
