<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>(Untitled)</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lngbarlp_rpx"></a>BAR( ) Function Example</b></p>
<p>
The following example uses BAR( ) to pass the number of a menu item to a procedure. The current system menu bar is saved to memory with SET SYSMENU SAVE, and then all system menu titles are removed with SET SYSMENU TO.</p>
<p>
Two menu titles are created with DEFINE PAD; DEFINE POPUP is used to create a menu for each menu title. DEFINE BAR is used to create items on each menu. When you choose a menu title, ON PAD uses ACTIVATE POPUP to activate the corresponding menu.</p>
<p>
When you choose an item from a menu, ON SELECTION POPUP uses BAR( ) and POPUP( ) to pass the item number and menu title to the <code>choice</code> procedure. The <code>choice</code> procedure displays the number of the chosen item and the name of the menu containing the item, and the original Visual FoxPro system menu is restored with SET SYSMENU TO DEFAULT.</p>
<pre><code>*** Name this program BAR_EXAM.PRG ***
CLEAR
SET SYSMENU SAVE
SET SYSMENU TO
DEFINE PAD padConv OF _MSYSMENU ;
 &nbsp; PROMPT '\&lt;Conversions' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+C, ''
DEFINE PAD padCard OF _MSYSMENU ;
 &nbsp; PROMPT 'Card \&lt;Info' COLOR SCHEME 3 ;
 &nbsp; KEY ALT+I, ''
ON PAD padConv OF _MSYSMENU ACTIVATE POPUP popConv
ON PAD padCard OF _MSYSMENU ACTIVATE POPUP popCard
DEFINE POPUP popConv MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF popConv PROMPT 'Ar\&lt;ea' KEY CTRL+E, '^E'
DEFINE BAR 2 OF popConv PROMPT '\&lt;Length' ;
 &nbsp; KEY CTRL+L, '^L'
DEFINE BAR 3 OF popConv PROMPT 'Ma\&lt;ss' ;
 &nbsp; KEY CTRL+S, '^S'
DEFINE BAR 4 OF popConv PROMPT 'Spee\&lt;d' ;
 &nbsp; KEY CTRL+D, '^D'
DEFINE BAR 5 OF popConv PROMPT '\&lt;Temperature' ;
 &nbsp; KEY CTRL+T, '^T'
DEFINE BAR 6 OF popConv PROMPT 'T\&lt;ime' ;
 &nbsp; KEY CTRL+I, '^I'
DEFINE BAR 7 OF popConv PROMPT 'Volu\&lt;me' ;
 &nbsp; KEY CTRL+M, '^M'
*** Here is where the POPCONV menu uses the BAR( ) function
*** to pass a bar number to the procedure called choice below.
ON SELECTION POPUP popConv;
 &nbsp; DO choice IN bar_exam WITH <span class=cfe><b>BAR( )</b></span>, POPUP( )
DEFINE POPUP popCard MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF popCard PROMPT '\&lt;View Charges' ;
 &nbsp; KEY ALT+V, ''
DEFINE BAR 2 OF popCard PROMPT 'View \&lt;Payments' ;
 &nbsp; KEY ALT+P, ''
DEFINE BAR 3 OF popCard PROMPT 'Vie\&lt;w Users' ;
 &nbsp; KEY ALT+W, ''
DEFINE BAR 4 OF popCard PROMPT '\-'
DEFINE BAR 5 OF popCard PROMPT '\&lt;Charges ';
 &nbsp; KEY ALT+C
DEFINE BAR 6 OF popCard PROMPT '\-'
DEFINE BAR 7 OF popCard PROMPT 'E\&lt;xit ';
 &nbsp; KEY ALT+X
*** Here is where the POPCARD menu uses the BAR( ) function
*** to pass a bar number to the procedure called choice below.
ON SELECTION POPUP popCard;
 &nbsp; DO choice IN bar_exam WITH <span class=cfe><b>BAR( )</b></span>, POPUP( )
*** The procedure choice uses the gnBar parameter
*** to contain the value passed by the BAR( ) function.
PROCEDURE choice
PARAMETERS gnBar, gcPopup
WAIT WINDOW 'You chose bar #' + LTRIM(STR(gnBar)) + ;
 &nbsp; ' from popup ' + gcPopup NOWAIT
SET SYSMENU TO DEFAULT
</code></pre>
</BODY>
</HTML>
