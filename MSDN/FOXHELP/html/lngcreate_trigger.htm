<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CREATE TRIGGER Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngcreate_trigger"></a><sup></sup>CREATE TRIGGER Command</h1>
<p>
<a href="lngcreate_triggerx.htm">Example</a> &nbsp; <a href="lngcreate_triggersa.htm">See Also</a></p>
<p>
Creates a Delete, Insert, or Update trigger for a table.</p>
<p class=label>
<b>Syntax</b></p>
<p>
CREATE TRIGGER ON <i>TableName</i><br>
 &nbsp; FOR DELETE | INSERT | UPDATE AS <i>lExpression</i></p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>TableName</i></p>
<p class=indent>
Specifies the table in the current database for which a trigger is created.</p>
<p class=dt>
FOR DELETE | INSERT | UPDATE</p>
<p class=indent>
Specifies the type of trigger Visual FoxPro creates.</p>
<p class=tl>
If a trigger of the type you specify already exists and SET SAFETY is ON, Visual FoxPro asks you if you'd like to overwrite the existing trigger. If SET SAFETY is OFF, the existing trigger is automatically overwritten.</P><p class=dt>
AS <i>lExpression</i></p>
<p class=indent>
Specifies the logical expression evaluated when the trigger occurs. <i>lExpression</i> can be a user-defined function or a stored procedure that returns a logical value. Stored procedures are created for a table with MODIFY PROCEDURE.</p>
<p class=tl>
A user-defined function or a stored procedure can use AERROR(&nbsp;) to determine the name of the table for which the trigger occurred and the trigger type.</P><p class=tl>
If <i>lExpression</i> evaluates to true (.T.), the command or event that caused the trigger to occur is executed.</P><p class=tl>
If <i>lExpression</i> evaluates to false (.F.), the command or event that caused the trigger to occur isn't executed. If an ON ERROR procedure is in effect, the ON ERROR procedure is executed instead of the command or event. If an ON ERROR procedure is not in effect, the command or event isn't executed and Visual FoxPro generates an error message.</P><p class=label>
<b>Remarks</b></p>
<p>
Use CREATE TRIGGER to trap for events that cause records in a table to be deleted, added, or changed. Delete, Insert, or Update triggers can be created only for a table that has been added to a database. Use CREATE DATABASE to create a database, and ADD TABLE to add a table to a database.</p>
<p>
The following lists describe the events that cause a Delete, Insert, or Update trigger to occur.</p>
<h3>Delete Trigger</h3>
<ul type=disc>
<li>
DELETE is issued.<br><br></li>
<li>
A record is marked for deletion from the Table Menu in a Browse window or Edit window.<br><br></li>
<li>
Note that issuing ZAP does not cause the Delete trigger to occur.</li>
</ul>
<h3>Insert Trigger</h3>
<ul type=disc>
<li>
APPEND FROM is issued.<br><br></li>
<li>
APPEND FROM ARRAY is issued.<br><br></li>
<li>
APPEND BLANK is issued.<br><br></li>
<li>
A record is appended from the Table Menu in a Browse window or Edit window.<br><br></li>
<li>
IMPORT is issued.<br><br></li>
<li>
INSERT – SQL is issued.<br><br></li>
<li>
RECALL is issued.<br><br></li>
<li>
A record is recalled from the Table Menu in a Browse window or Edit window.</li>
</ul>
<h3>Update Trigger</h3>
<ul type=disc>
<li>
GATHER is issued.<br><br></li>
<li>
REPLACE is issued.<br><br></li>
<li>
REPLACE FROM ARRAY is issued.<br><br></li>
<li>
UPDATE – SQL is issued.<br><br></li>
<li>
Other event that causes a record to be modified, such as when a Form changes the contents of a field.</li>
</ul>
<p>
The following rules apply to triggers created with CREATE TRIGGER:
<ul type=disc>
<li>
INSERT cannot be issued for a table with a trigger. However, INSERT – SQL can be used.<br><br></li>
<li>
Issuing PACK doesn't cause any triggers to occur.<br><br></li>
<li>
Issuing ZAP doesn't cause a Delete trigger to occur.<br><br></li>
<li>
No trigger occurs if you update a record marked for deletion.<br><br></li>
<li>
A trigger may not occur immediately, depending on the current buffering mode:</li>
</ul>
<p>
If table buffering is in effect, the Update trigger occurs when TABLEUPDATE(&nbsp;) is issued and each buffered record is updated in the table.</p>
</BODY>
</HTML>
