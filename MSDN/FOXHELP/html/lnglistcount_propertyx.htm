<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ListCount Property Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lnglistcount_propertyx"></a><sup></sup>ListCount Property Example</b></p>
<p>
The following example creates a list box. The source of the items that appear in the list box items is an array; the array is specified with the RowSourceType and RowSource properties.</p>
<p>
ListCount is used to cycle through all of the items specified by the List property of the ComboBox or ListBox.</p>
<p>
The MultiSelect property for the list box is set to true (.T.), allowing you to make multiple selections from the list box. The ListCount property is used within a FOR&nbsp;...&nbsp;ENDFOR loop to display the item or items you choose in the list box. The Selected and List properties are used to determine the items you chose.</p>
<pre><code>CLEAR

DIMENSION gaMyListArray(10)
FOR gnCount = 1 to 10&nbsp; &amp;&amp; Fill the array with letters
 &nbsp; STORE REPLICATE(CHR(gnCount+64),6) TO gaMyListArray(gnCount)
ENDFOR

frmMyForm = CREATEOBJECT('Form')&nbsp; &amp;&amp; Create a Form
frmMyForm.Closable = .f.&nbsp; &amp;&amp; Disable the Control menu box 

frmMyForm.Move(150,10)&nbsp; &amp;&amp; Move the form

frmMyForm.AddObject('cmbCommand1','cmdMyCmdBtn')&nbsp; &amp;&amp; Add "Quit" Command button
frmMyForm.AddObject('lstListBox1','lstMyListBox')&nbsp; &amp;&amp; Add list box control

frmMyForm.lstListBox1.RowSourceType = 5&nbsp; &amp;&amp; Specifies an array
frmMyForm.lstListBox1.RowSource = 'gaMyListArray' &amp;&amp; Array containing listbox items

frmMyForm.cmbCommand1.Visible =.T.&nbsp; &amp;&amp; "Quit" Command button visible
frmMyForm.lstListBox1.Visible =.T.&nbsp; &amp;&amp; "List Box visible

frmMyForm.SHOW&nbsp; &amp;&amp; Display the form
READ EVENTS&nbsp; &amp;&amp; Start event processing

DEFINE CLASS cmdMyCmdBtn AS CommandButton&nbsp; &amp;&amp; Create Command button
 &nbsp; Caption = '\&lt;Quit'&nbsp; &amp;&amp; Caption on the Command button
 &nbsp; Cancel = .T.&nbsp; &amp;&amp; Default Cancel Command button (Esc)
 &nbsp; Left = 125&nbsp; &amp;&amp; Command button column
 &nbsp; Top = 210&nbsp; &amp;&amp; Command button row
 &nbsp; Height = 25&nbsp; &amp;&amp; Command button height

 &nbsp; PROCEDURE Click
 &nbsp;&nbsp;&nbsp;&nbsp; CLEAR EVENTS&nbsp; &amp;&amp; Stop event processing, close Form
 &nbsp;&nbsp;&nbsp;&nbsp; CLEAR&nbsp; &amp;&amp; Clear main Visual FoxPro window
ENDDEFINE

DEFINE CLASS lstMyListBox AS ListBox&nbsp; &amp;&amp; Create ListBox control
 &nbsp; Left = 10&nbsp; &amp;&amp; List Box column
 &nbsp; Top = 10&nbsp; &amp;&amp; List Box row
 &nbsp; MultiSelect = .T.&nbsp; &amp;&amp; Allow selecting more than 1 item

PROCEDURE Click
 &nbsp; ACTIVATE SCREEN
 &nbsp; CLEAR
 &nbsp; ? "Selected items:"
 &nbsp; ? "---------------"
 &nbsp; FOR nCnt = 1 TO ThisForm.lstListBox1.<span class=cfe><b>ListCount</b></span>
 &nbsp;&nbsp;&nbsp;&nbsp; IF ThisForm.lstListBox1.Selected(nCnt)&nbsp; &amp;&amp; Is item selected?
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? SPACE(5) + ThisForm.lstListBox1.List(nCnt) &amp;&amp; Show item
 &nbsp;&nbsp;&nbsp;&nbsp; ENDIF
 &nbsp; ENDFOR

ENDDEFINE
</code></pre>
</BODY>
</HTML>
