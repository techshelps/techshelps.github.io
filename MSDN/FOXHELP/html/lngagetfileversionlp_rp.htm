<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AGETFILEVERSION( ) Function</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngagetfileversionlp_rp"></a><sup></sup>AGETFILEVERSION(&nbsp;) Function</h1>
<p>
<a href="lngagetfileversionlp_rpsa.htm">See Also</a></p>
<p>
Creates an array containing information about files with Windows version resources such as .exe, .dll, and .fll files, or automation servers created in Visual FoxPro.</p>
<p class=label>
<b>Syntax</b></p>
<p>
AGETFILEVERSION(<i>ArrayName</i>, <i>cFileName</i>)</p>
<p class=label>
<b>Returns</b></p>
<p>
Numeric</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>ArrayName</i></p>
<p class=indent>
Specifies the name of the array in which the file information is placed. If the array you specify doesn't exist, Visual FoxPro automatically creates the array. If the array exists and isn't large enough to contain the file information, Visual FoxPro automatically increases the size of the array. If the array is larger than necessary, Visual FoxPro truncates the array.</p>
<p class=tl>
The following table lists the contents of each element of the array.</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=23%><b>Element</b></td>
<td class=label width=77%><b>Contents</b></td>
</tr>
<tr valign=top>
<td width=23%>1</td>
<td width=77%>Comments</td>
</tr>
<tr valign=top>
<td width=23%>2</td>
<td width=77%>Company Name</td>
</tr>
<tr valign=top>
<td width=23%>3</td>
<td width=77%>File Description</td>
</tr>
<tr valign=top>
<td width=23%>4</td>
<td width=77%>File Version</td>
</tr>
<tr valign=top>
<td width=23%>5</td>
<td width=77%>Internal Name</td>
</tr>
<tr valign=top>
<td width=23%>6</td>
<td width=77%>Legal Copyright</td>
</tr>
<tr valign=top>
<td width=23%>7</td>
<td width=77%>Legal Trademarks</td>
</tr>
<tr valign=top>
<td width=23%>8</td>
<td width=77%>Original File Name</td>
</tr>
<tr valign=top>
<td width=23%>9</td>
<td width=77%>Private Build</td>
</tr>
<tr valign=top>
<td width=23%>10</td>
<td width=77%>Product Name</td>
</tr>
<tr valign=top>
<td width=23%>11</td>
<td width=77%>Product Version</td>
</tr>
<tr valign=top>
<td width=23%>12</td>
<td width=77%>Special Build</td>
</tr>
<tr valign=top>
<td width=23%>13</td>
<td width=77%>OLE Self Registration (contains "OLESelfRegister" if the file supports self-registration; otherwise contains the empty string)</td>
</tr>
<tr valign=top>
<td width=23%>14</td>
<td width=77%>Language (derived from the Translation Code)</td>
</tr>
<tr valign=top>
<td width=23%>15</td>
<td width=77%>Translation Code<p>
For example, you can use the following code to determine the Locale ID for the Visual FoxPro executable file:</p>
<pre><code>DIMENSION aFiles[1]
AGETFILEVERSION(aFiles,"VFP6.EXE")
? EVAL("0x"+LEFT(aFiles[15],4))
** Returns 1033 for US version</code></pre>
</td>
</tr>
</table><br>
<p class=dt>
<i>cFileName</i></p>
<p class=indent>
Specifies the name file for which information is placed in the array. The class library name you specify is displayed in the File name text box. An error is generated if the class library you specify doesn't exist.</p>
<p class=label>
<b>Remarks</b></p>
<p>
AGETFILEVERSION(&nbsp;) is typically used to get information about files with Windows version resources such as .exe, .dll, and .fll files, or automation servers created in Visual FoxPro. You must specify a value for at least one item in the EXE Version dialog Box for a Visual FoxPro automation server to have Windows version resources. </p>
<p>
AGETFILEVERSION(&nbsp;) returns the number of elements in the array. If the file you specify doesn’t contain Windows version resources, zero is returned and the array (if already created) remains unchanged.</p>
<p>
The minimum number of characters to which AGETFILEVERSION(&nbsp;) can be abbreviated is 5 characters.</p>
</BODY>
</HTML>
