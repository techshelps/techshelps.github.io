<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TOTAL Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngtotal"></a><sup></sup>TOTAL Command</h1>
<p>
<a href="lngtotalsa.htm">See Also</a></p>
<p>
Computes totals for numeric fields in the currently selected table.</p>
<p class=label>
<b>Syntax</b></p>
<p>
TOTAL TO <i>TableName</i> <br>
ON <i>FieldName</i><br>
 &nbsp; [FIELDS <i>FieldNameList</i>]<br>
 &nbsp; [<i>Scope</i>]<br>
 &nbsp; [FOR <i>lExpression1</i>]<br>
 &nbsp; [WHILE <i>lExpression2</i>]<br>
 &nbsp; [NOOPTIMIZE]</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>TableName</i></p>
<p class=indent>
Specifies the name of the table that will contain the totals. If the specified table doesn't exist, Visual FoxPro creates it. If the table exists and SET SAFETY is ON, Visual FoxPro asks if you would like to overwrite the existing table. If SET SAFETY is OFF, you aren't prompted, and the output table is overwritten.</p>
<p class=dt>
<i>FieldName</i></p>
<p class=indent>
Specifies the field on which the totals are grouped. The table must be sorted on this field, or an open index or index tag must have this field as its key expression.</p>
<p class=dt>
FIELDS <i>FieldNameList</i></p>
<p class=indent>
Specifies the fields to be totaled. Separate the field names in the list with commas. If you omit the FIELDS clause, all numeric fields are totaled by default.</p>
<p class=dt>
<i>Scope</i></p>
<p class=indent>
Specifies a range of records to total. The scope clauses are: ALL, NEXT <i>nRecords</i>, RECORD <i>nRecordNumber</i>, and REST. For more information on scope clauses, see the <a href="tblscope_clauses.htm">Scope Clauses</a> or <a href="lngoverview_of_the_language.htm">Overview of the Language</a> online topics.</p>
<p class=tl>
The default scope for TOTAL is ALL records.</P><p class=dt>
FOR <i>lExpression1</i></p>
<p class=indent>
Specifies a condition whereby only the records that satisfy the logical condition <i>lExpression1</i> are included in the totals.</p>
<p class=tl>
Rushmore optimizes a query created with TOTAL&nbsp;...&nbsp;FOR if <i>lExpression1</i> is an optimizable expression. For best performance, use an optimizable expression in the FOR clause. </P><p class=tl>
For more information, see <a href="lngset_optimize.htm">SET OPTIMIZE</a> and "Understanding Rushmore Technology" in Chapter 15, <a href="dgoptimizing_applications.htm">Optimizing Applications</a>, in the <i>Programmer's Guide</i>.</P><p class=dt>
WHILE <i>lExpression2</i></p>
<p class=indent>
Specifies a condition whereby records from the current table are included in the totals for as long as the logical expression <i>lExpression2</i> evaluates to true (.T.).</p>
<p class=dt>
NOOPTIMIZE</p>
<p class=indent>
Disables Rushmore optimization of TOTAL.</p>
<p class=indent>
For more information, see <a href="lngset_optimize.htm">SET OPTIMIZE</a> and "Understanding Rushmore Technology" in Chapter 15, <a href="dgoptimizing_applications.htm">Optimizing Applications</a>, in the <i>Programmer's Guide</i>.</p>
<p class=label>
<b>Remarks</b></p>
<p>
The table in the currently selected work area must be sorted or indexed. A separate total is calculated for each set of records with a common field value or unique index key value. The results are placed into records in a second table. One record is created in the second table for each common field value or unique index key value.</p>
<p>
Numeric overflow can occur if the numeric fields in the second table aren't wide enough to contain the totals. Visual FoxPro conserves the most significant portions of the totals when numeric overflow occurs. When a field is too small to accept a total:
<ul type=disc>
<li>
Decimal places are truncated, and the remaining decimal portion of the total is rounded.<br><br></li>
<li>
If the total still doesn't fit, scientific notation is used if the total field contains seven or more digits.<br><br></li>
<li>
Finally, asterisks replace the field contents.</li>
</ul>
</BODY>
</HTML>
