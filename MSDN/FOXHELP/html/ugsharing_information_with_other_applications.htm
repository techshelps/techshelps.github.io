<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sharing Information with Other Applications</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="ugsharing_information_with_other_applications"></a><sup></sup>Chapter 10: Sharing Information with Other Applications</h1>
<p>
With Visual FoxPro, you can employ the strengths of other applications by sharing information with them. You can copy and paste data between applications, create mail merges using data from Visual FoxPro tables, link or embed data from other applications, and import or export data between applications. By sharing information, you can save time and avoid errors. For example, instead of entering results from Microsoft<sup>®</sup> Excel in a table, you can copy the results from Microsoft Excel or link to Microsoft Excel to get the results automatically.</p>
<p>
For details on importing or exporting, see Chapter 9, <a href="ugimporting_and_exporting_data.htm">Importing and Exporting Data</a>. For information about <a href="glsole_automation.htm">Automation</a>, see Chapter 16, <a href="dgadding_ole.htm">Adding OLE</a>, in&nbsp; the <i>Programmer’s Guide</i>.</p>
<p>
This chapter discusses:</p>
<ul type=disc>
<li>
<a href="#ugsharing_information_quickly">Sharing Information Quickly</a></li>
<li>
<a href="#ugsharing_information_dynamically">Sharing Information Dynamically</a></li>
</ul>

<h1><a name="ugsharing_information_quickly"></a>Sharing Information Quickly</h1>
<p>
You can quickly share data between Visual FoxPro and other applications or data sources by copying and pasting data. You can also use the <a href="wizmail_merge_wizard.htm">Mail Merge Wizard</a> to expedite mass mailings.</p>
<h3>Copying and Pasting Data</h3>
<p>
If you want to share small amounts of data quickly and easily, but don’t want to share entire files, select the data manually, cut or copy it, and then paste it wherever you want it. For example, copy selected data from a form and then paste it into a Microsoft Word document, or copy selected cells from a Microsoft Excel worksheet and then paste them into a <a href="congeneral_field_type.htm">General field</a> in a table. You can even copy and paste data into mail messages and send the messages from within Visual FoxPro.</p>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;To share entire files, link or embed them. For details about linking and embedding, see <a href="#ugsharing_information_dynamically">Sharing Information Dynamically</a>, later in this chapter.</p>
<p class=label>
<b>To paste data from another application into a General field</b>
<ol>
<li>
Copy the data to the <a href="glsclipboard.htm">Clipboard</a>.<br><br></li>
<li>
Open and browse the table containing the General field in which you want to paste the data.<br><br></li>
<li>
Double-click the General field.<br><br></li>
<li>
Embed the data by choosing <b>Paste</b> or <b>Paste Special</b> from the <b>Edit</b> menu.<p class=tl>
-or-</P><p class=tl>
Link to the data by choosing <b>Paste Special</b> from the <b>Edit</b> menu and then selecting <b>Paste Link</b> in the <b>Paste Special</b> dialog box.</P><p class=label>
<b>Paste Special dialog box</b>
<p>
<img src="afu10001.gif" border=0></P></li>
</ol>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;You can save disk space when linking or embedding by selecting the <b>Display As Icon</b> check box. When this is selected, Visual FoxPro displays the icon instead of the data.</p>
<h3>Creating Mail Merges</h3>
<p>
A common way of sharing data is to mail letters created from addresses stored in Visual FoxPro and templates stored in Microsoft Word. With Visual FoxPro, you can create a Word document containing data from a Visual FoxPro table by using the <a href="wizmail_merge_wizard.htm">Mail Merge Wizard</a>.</p>
<p class=label>
<b>To use the Mail Merge Wizard</b>
<ol>
<li>
From the <b>Tools</b> menu, choose <b>Wizards</b>.<br><br></li>
<li>
From the submenu, choose <b>Mail Merge</b>.<br><br></li>
<li>
Follow the directions in the wizard.</li>
</ol>

<h3><a name="howsending_mail_from_visual_foxpro"></a>Sending Mail from Visual FoxPro</h3>
<p>
If you have a mail program installed, you can send mail from Visual FoxPro.</p>
<p class=label>
<b>To send mail</b>
<ul type=disc>
<li>
From the <b>File</b> menu, choose <b>Send</b>.<p class=tl>
Your electronic mail program displays a dialog box in which you can compose and send a mail message.</P></li>
</ul>
<p>
You can also send mail from an application by using the MAPI Session Control and MAPI Messages Control For more information on these controls, see the <a href="lngactivex_controls_overview.htm">ActiveX Controls Overview</a>.</p>

<h1><a name="ugsharing_information_dynamically"></a>Sharing Information Dynamically</h1>
<p>
In Visual FoxPro, you can dynamically include data from other applications and still have those applications maintain the data by linking or embedding it in your application. For example, you can link or embed a Word document in a <a href="congeneral_field_type.htm">General field</a> or you can link or embed a Microsoft Excel worksheet on a form.</p>
<p>
When you dynamically link data, it is stored in its source file, not in your Visual FoxPro table or form. The table or form stores only the location of the source and displays a representation of the linked data. Linked data is updated when the source file changes and retains a connection to its source file, unless you break the connection (see <a href="#ugchanging_or_breaking_links_to_data_in_tables">Changing or Breaking Links to Data</a> later in the chapter).</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Files with an .avi extension are always linked.</p>
<p>
When you dynamically embed data, it is stored only in your table or form. This data does not retain a connection to its source file. If changes are made to the source file, they do not appear in your Visual FoxPro application.</p>
<p class=label>
<b>Embedding and linking data</b></p>
<p>
<img src="afu10002.gif" border=0></p>
<p>
Create links when:</p>
<ul type=disc>
<li>
Data or graphics are likely to change.</li>
<li>
Your application necessarily includes the latest version available.</li>
<li>
The source files are available for updating on your computer or across a network.</li>
<li>
The source files must be shared with other applications.</li>
</ul>
<p>
Embed data or graphics when:</p>
<ul type=disc>
<li>
You don’t need to have the most current versions in your application.</li>
<li>
The embedded data need not be included in more than one application.</li>
<li>
The source files would not be available for updating if they were linked.</li>
</ul>
<p>
Use the following guidelines to decide on linking or embedding:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>To</b></td>
<td class=label width=26%><b>Use this method</b></td>
<td class=label width=36%><b>Details</b></td>
</tr>
<tr valign=top>
<td width=38%>Create applications you can use on other computers or edit, even if the source files are not present.</td>
<td width=26%>Embed the data.</td>
<td width=36%>To edit the data, all applications from which the data come must be installed on the computer.</td>
</tr>
<tr valign=top>
<td width=38%>Include data that might not always be available, such as data stored on a <a href="glsserver.htm">server</a>.</td>
<td width=26%>Embed the data.</td>
<td width=36%>All the necessary information is included with the embedded data.</td>
</tr>
<tr valign=top>
<td width=38%>Include a very large file, such as a video or sound clip.</td>
<td width=26%>Create a link to the source file.</td>
<td width=36%>Your application stores only the link, keeping the size of the application manageable.</td>
</tr>
<tr valign=top>
<td width=38%>Include data that is maintained separately in its source application.</td>
<td width=26%>Create a link to the source application.</td>
<td width=36%>Your application reflects any changes made to the source application.</td>
</tr>
</table><br>
<p>
The following sections describe how to add data to tables, add data to forms, change or break links to data, display linked or embedded data from tables, and edit linked or embedded data.</p>
<h3>Inserting Data in Tables</h3>
<p>
You can include data from other applications in a Visual FoxPro table by inserting the data into <a href="congeneral_field_type.htm">General</a> fields. For example, if you have pictures of products, you can include them in a table containing other product information by inserting them into a General field.</p>
<p class=label>
<b>To insert data into a General field</b>
<ol>
<li>
Open and browse the appropriate table.<br><br></li>
<li>
Double-click the General field in which you want to insert the data.<br><br></li>
<li>
From the <b>Edit</b> menu, choose <b>Insert Object</b>.<p class=tl>
The <b>Insert Object</b> dialog box appears, listing the types of data you can insert into the field.</P><p class=label>
<b>Insert Object dialog box</b>
<p>
<img src="afu10003.gif" border=0></P></li>
<li>
To create data of your own, select <b>Create New</b> and then choose the appropriate type of data.<p class=tl>
-or-</P><p class=tl>
To use existing data, select <b>Create from File</b>. Then, type the name of the file containing the data, or choose <b>Browse</b> and select the appropriate file. If you want to link to the file, select <b>Link</b>.</P><p class=label>
<b>Insert Object dialog box</b>
<p>
<img src="afu10004.gif" border=0></P></li>
</ol>

<h4><a name="ugchanging_or_breaking_links_to_data_in_tables"></a>Changing or Breaking Links to Data in Tables</h4>
<p>
After linking to some data, you might want to use a different data source, or you might want to embed rather than link. To change the data source, you must change the link; and to embed, you must break the link.</p>
<p class=label>
<b>To change the link to data in a General field</b>
<ol>
<li>
Open and browse the appropriate table.<br><br></li>
<li>
Double-click the General field containing the data whose link you want to change.<br><br></li>
<li>
From the <b>Edit</b> menu, choose <b>Links</b>. The <b>Links</b> dialog box appears.<p class=label>
<b>Links dialog box</b>
<p>
<img src="afu10005.gif" border=0></P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Choose <b>Automatic</b> to automatically update data any time it changes in the source application, or <b>Manual</b> if you want to manually update data.</p></li>
<li>
In the <b>Links</b> dialog box, choose <b>Change Source</b>.<p class=tl>
The <b>Change Source</b> dialog box appears.</P><p class=label>
<b>Change Source dialog box</b>
<p>
<img src="afu10006.gif" border=0></P></li>
<li>
Specify the new data source and choose <b>OK</b>.<br><br></li>
<li>
In the <b>Links</b> dialog box, choose <b>Close</b> to complete the change.</li>
</ol>
<p class=label>
<b>To break a link to data in a General field</b>
<ol>
<li>
Open and browse the appropriate table.<br><br></li>
<li>
Double-click the General field containing the data whose link you want to break.<br><br></li>
<li>
From the <b>Edit</b> menu, choose <b>Links</b>.<br><br></li>
<li>
In the <b>Links</b> dialog box, choose <b>Break Link</b>.<br><br></li>
<li>
Choose <b>Close</b>.</li>
</ol>
<p>
When the link is broken, the data becomes static.</p>
<h3>Displaying Embedded or Linked Data on Forms</h3>
<p>
You can enhance the design of forms by linking or embedding data such as Word documents or Microsoft Excel worksheets. Similarly, you can enhance reports by displaying linked or embedded data from General fields. For details, see “Adding a General Field” in Chapter 7, <a href="ugdesigning_reports_and_labels.htm">Designing Reports and Labels</a>.</p>
<p class=label>
<b>To link or embed data on a form</b></p>
<p>
<img src="b017.gif" border=0>
<ol>
<li>
Create or open a form.<br><br></li>
<li>
On the <a href="tlsform_controls_toolbar.htm">Form Controls toolbar</a>, select the <b>OLE Container Control</b> button and drag to size on the form.<p class=tl>
The <b>Insert Object</b> dialog box appears, listing the types of files you can link or embed.</P></li>
<li>
Create a new file by selecting <b>Create New</b>.<p class=tl>
-or-</P><p class=tl>
Use an existing file by selecting <b>Create from File</b>. Type the name of the file containing the data or choose <b>Browse</b> and select the appropriate file. Additionally, if you want to link to the file, select <b>Link</b>.</P></li>
</ol>
<h4>Changing or Breaking Links to Data on Forms</h4>
<p>
You change or break a link to data displayed on a form by using the <b>Links</b> command on the <b>Edit</b> menu.</p>
<p class=label>
<b>To change a link to data on a form</b>
<ol>
<li>
Open the appropriate form.<br><br></li>
<li>
Select the object whose link you want to change.<br><br></li>
<li>
From the <b>Edit</b> menu, choose <b>Links</b>.<br><br></li>
<li>
In the <b>Links</b> dialog box, choose <b>Change Source</b>.<br><br></li>
<li>
In the <b>Change Source</b> dialog box, specify the new data source and choose <b>OK</b>.<br><br></li>
<li>
In the <b>Links</b> dialog box, choose <b>Close</b> to complete the change.</li>
</ol>
<p class=label>
<b>To break a link to data on a form</b>
<ol>
<li>
Open the appropriate form.<br><br></li>
<li>
Select the object whose link you want to break.<br><br></li>
<li>
From the <b>Edit</b> menu, choose <b>Links</b>.<br><br></li>
<li>
In the <b>Links</b> dialog box, choose <b>Break Link</b>.<br><br></li>
<li>
Choose <b>Close</b>.</li>
</ol>
<p>
When the link is broken, the data becomes static.</p>
<h3>Displaying Embedded or Linked Data from Tables</h3>
<p>
On a form or report, you can display linked or embedded data from <a href="congeneral_field_type.htm">General fields</a> in a table. For example, suppose you have a product table in which each record includes a General field containing a brochure (a Word document) about a product. On a form, you could display selected information from the records — including the brochure describing the product.</p>
<p class=label>
<b>To display data from a General field on a form</b></p>
<p>
<img src="b017a.gif" border=0>
<ol>
<li>
In the <a href="wndform_designer.htm">Form Designer</a>, add an <b>OLE Bound</b> control to your form.<p class=tl>
On the form, Visual FoxPro creates an object through which you can view the data at <a href="glsrun_time.htm">run time</a>.</P></li>
<li>
Specify the General field that contains the data by setting the object’s <a href="lngcontrolsource_property.htm">ControlSource property</a>.<p class=tl>
For example, if the table name is <code>Inventory</code> and the General field name is <code>Current</code>, then set the ControlSource property to <b>Inventory.Current</b>.</P></li>
<li>
On the form, add buttons or menu commands for browsing the General field specified in the ControlSource property.</li>
</ol>
<p class=label>
<b>To display data from a General field on a report</b>
<ul type=disc>
<li>
Add a General field to the report.<p class=tl>
For details, see “Adding a General Field” in Chapter 7, <a href="ugdesigning_reports_and_labels.htm">Designing Reports and Labels</a>.</P></li>
</ul>
<h4>Including Data in a Report</h4>
<p>
When creating a report, you can link or embed pictures or icons directly into the report from an outside source using the image container. Other forms of data, such as Word documents or Microsoft Excel spreadsheets, can be included only if they were previously linked or embedded into a General field in a Visual FoxPro table. For more information, see Chapter 7, <a href="ugdesigning_reports_and_labels.htm">Designing Reports and Labels</a>.</p>
<h3>Editing OLE Objects in Forms and Tables</h3>
<p>
You can edit linked or embedded data in a table or form while designing the table or form. In addition, you can edit the data in a form while running the form. The following procedures describe the ways you can edit data.</p>
<p class=label>
<b>To edit data in a General field in a table</b>
<ol>
<li>
Open and browse the appropriate table.<br><br></li>
<li>
Go to the record containing the <a href="congeneral_field_type.htm">General field</a> you want to edit.<br><br></li>
<li>
Double-click the General field to display the editing window.<br><br></li>
<li>
In the editing window, double-click to edit the data.</li>
</ol>
<p class=label>
<b>To edit embedded or linked objects on a form while designing the form</b>
<ol>
<li>
Select the object representing the data.<br><br></li>
<li>
With the mouse pointer over the object, click the right mouse button.<br><br></li>
<li>
From the <a href="glsshortcut_menu.htm">shortcut menu</a>, choose the object type, and then choose <b>Edit or Open</b>.</li>
</ol>
<p class=label>
<b>To edit objects or data from General fields on a form while running the form</b>
<ol>
<li>
From the <b>Edit</b> menu, select the object.<p class=tl>
For example, if the object is a Microsoft Excel worksheet, select <b>Spreadsheet Object</b> from the <b>Edit</b> menu.</P><p class=atl>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;You can also right-click on the object if its AutoVerbMenu property is set to True. Choose the object type, and then choose <b>Edit or Open.</b></p></li>
<li>
To edit the object visually, choose <b>Edit</b> from the submenu.<p class=tl>
-or-</P><p class=tl>
To edit the object in a separate window, choose <b>Open</b> from the submenu.</P><p class=atl>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;If you change the data in an object while running a form, Visual FoxPro saves the changes only if the data is linked or is associated with an <a href="ctlole_bound_control.htm">OLE Bound control</a>. Changes associated with an <a href="ctlole_container_control.htm">OLE Container control</a> are not saved.</p><p class=label>
<b>Editing visually</b>
<p>
<img src="afu10007.gif" border=0></P></li>
</ol>
<p>
If you edit in the Visual FoxPro window, menus from the application you’re using replace or merge with Visual FoxPro menus. For example, if you’re using Microsoft Excel, the Excel Edit menu replaces the Visual FoxPro Edit menu. However, the Visual FoxPro File, Program, and Window menus are not replaced.</p>
<h4>Replacing Linked or Embedded Data with Static Data</h4>
<p>
You can replace linked or embedded data with stand-alone bitmaps by using the application that created the data.</p>
<p class=label>
<b>To replace linked or embedded data with a bitmap</b>
<ol>
<li>
Start the application that created the data by choosing the object containing the data.<br><br></li>
<li>
In the application, copy the object’s presentation to the <a href="glsclipboard.htm">Clipboard</a>.<p class=tl>
For example, if the application has a <b>Copy Picture</b> command, use it to copy the object’s presentation.</P></li>
<li>
From the <b>Edit</b> menu in Visual FoxPro, choose <b>Paste Special</b>.<br><br></li>
<li>
In the <b>Paste Special</b> dialog box, choose <b>Paste Option</b>.<br><br></li>
<li>
Choose the <b>Picture (Metafile)</b> option.</li>
</ol>
</BODY>
</HTML>
