<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SET ORDER Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngset_order"></a><sup></sup>SET ORDER Command</h1>
<p>
<a href="lngset_ordersa.htm">See Also</a></p>
<p>
Designates a controlling index file or tag for a table.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SET ORDER TO<br>
 &nbsp; [<i>nIndexNumber</i> | <i>IDXIndexFileName</i> | [TAG] <i>TagName</i> [OF <i>CDXFileName</i>] <br>
 &nbsp; [IN <i>nWorkArea</i> | <i>cTableAlias</i>] <br>
 &nbsp; [ASCENDING | DESCENDING]]</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>nIndexNumber</i></p>
<p class=indent>
Specifies the number of the controlling index file or tag. <i>nIndexNumber</i> refers to the index files as they are listed in USE or SET INDEX. Open .idx files are numbered first in the order in which they appear in USE or SET INDEX. Tags in the structural .cdx file (if one exists) are then numbered in the order in which they were created. Finally, tags in any open independent .cdx files are numbered in the order in which they were created.</p>
<p class=tl>
The following example illustrates how different index file types and tags are numbered. (The file names are for illustration only and don't necessarily exist.) A table named <code>video.dbf</code> is opened with three indexes (<code>title.idx</code>, <code>costs.cdx</code>, and <code>rating.idx</code>) in the first work area with this command:</P><pre><code>USE video INDEX title.idx, costs.cdx, rating.idx IN 1
</code></pre>
<p class=tl>
The <code>video</code> table has a structural compound index file (<code>video.cdx</code>) with two tags, <code>NUMBERSOLD</code> and <code>YEARSOLD</code>. The structural .cdx file is automatically opened when <code>video</code> is opened.</P><p class=tl>
Since .idx files are numbered first, issue SET ORDER TO 1 to make <code>title.idx</code> the controlling index and SET ORDER TO 2 to make <code>rating.idx</code> the controlling index:</P><pre><code>SET ORDER TO 1
Controlling index: C:\FOX30\TITLE.IDX 
SET ORDER TO 2
Controlling index: C:\FOX30\RATING.IDX 
</code></pre>
<p class=tl>
The tags in <code>video.cdx</code> are numbered next:</P><pre><code>SET ORDER TO 3
Controlling index: C:\FOX30\VIDEO.CDX&nbsp; Tag: NUMBERSOLD 
SET ORDER TO 4
Controlling index: C:\FOX30\VIDEO.CDX&nbsp; Tag: YEARSOLD 
</code></pre>
<p class=tl>
Finally, the tags in the independent&nbsp; file, <code>costs.cdx</code>, are numbered:</P><pre><code>SET ORDER TO 5
Controlling index: C:\FOX30\COSTS.CDX&nbsp; Tag: RENTALCOST
SET ORDER TO 6
Controlling index: C:\FOX30\COSTS.CDX&nbsp; Tag: BUYCOST
</code></pre>
<p class=tl>
<i>nIndexNumber</i> can also be 0. If you issue SET ORDER TO 0, all index files remain open and are updated when records are added, deleted or modified. However, the records in the table are displayed and accessed in record number order and not in an indexed order. Issuing SET ORDER TO without additional arguments is identical to issuing SET ORDER TO 0.</P><p class=tl>
If <i>nIndexNumber</i> is greater than the number of .idx files and .cdx file tags, Visual FoxPro generates an error message.</P><p class=dt>
<i>IDXIndexFileName</i></p>
<p class=indent>
Specifies an .idx file as the controlling index file.</p>
<p class=dt>
[TAG] <i>TagName</i> [OF <i>CDXFileName</i>]</p>
<p class=indent>
Specifies a tag of a .cdx file as the controlling tag. The tag name can be from a structural .cdx file or any open independent .cdx file.</p>
<p class=tl>
If identical tag names exist in open independent .cdx files, use OF <i>CDXFileName</i> to specify the .cdx file containing the tag.</P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The .idx file takes precedence if duplicate .idx file and tag names exist.</p><p class=dt>
IN <i>nWorkArea</i> | <i>cTableAlias</i></p>
<p class=indent>
Designates a controlling index file or tag for a table open in a work area other than the currently selected work area. <i>nWorkArea</i> specifies the work area number and <i>cTableAlias</i> specifies the alias for a table.</p>
<p class=dt>
ASCENDING | DESCENDING</p>
<p class=indent>
Displays and allows access to table records in ascending or descending order. Including ASCENDING or DESCENDING doesn't change the index file or tag in any way.</p>
<p class=label>
<b>Remarks</b></p>
<p>
A table can have many index files open simultaneously. However, only one single-index (.idx) file (the controlling index file) or tag from a compound index (.cdx) file (the controlling tag) determines the order in which the records in a table are displayed or accessed. SET ORDER lets you designate the controlling index file or tag. Certain commands (SEEK, for example) use the controlling index file or tag to search for records.</p>
<p>
You can open index files with a table by including the INDEX clause in the USE command. If a table has an associated structural .cdx file, that file is automatically opened with the table. After a table has been opened, you can open and close index files for the table using SET INDEX.</p>
<p>
By default, SET ORDER designates the controlling index or controlling tag for the table open in the currently selected work area.</p>
</BODY>
</HTML>
