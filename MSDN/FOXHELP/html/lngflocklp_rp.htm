<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FLOCK( ) Function</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngflocklp_rp"></a><sup></sup>FLOCK(&nbsp;) Function</h1>
<p>
<a href="lngflocklp_rpx.htm">Example</a> &nbsp; <a href="lngflocklp_rpsa.htm">See Also</a></p>
<p>
Attempts to lock the current or specified table.</p>
<p class=label>
<b>Syntax</b></p>
<p>
FLOCK([<i>nWorkArea</i> | <i>cTableAlias</i>])</p>
<p class=label>
<b>Returns</b></p>
<p>
Logical</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>nWorkArea</i></p>
<p class=indent>
Specifies the work area of the table that FLOCK(&nbsp;) attempts to lock.</p>
<p class=tl>
FLOCK(&nbsp;) returns false (.F.) if a table isn't open in the work area you specify.</P><p class=dt>
<i>cTableAlias</i></p>
<p class=indent>
Specifies the alias of the table that FLOCK(&nbsp;) attempts to lock.</p>
<p class=tl>
Microsoft Visual FoxPro generates an error message if you specify a table alias that doesn't exist.</P><p class=label>
<b>Remarks</b></p>
<p>
FLOCK(&nbsp;) returns true (.T.) if the table is successfully locked and returns false (.F.) if the table or a record in the table is already locked by another user.</p>
<p>
If you omit the optional arguments, FLOCK(&nbsp;) attempts to lock the table open in the currently selected work area.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If FLOCK(&nbsp;) fails to lock a table, it returns false (.F.) and does not generate an error. As a result, you can't use FLOCK(&nbsp;) to trigger an ON ERROR routine.</p>
<p>
When a table is locked, the table is available for both read and write access by the user who placed the lock. Other users on the network have read-only access to the table. For information on how to lock a table and prevent access to it by other users, see <a href="lngset_exclusive.htm">SET EXCLUSIVE</a> and <a href="lnguse.htm">USE</a>.</p>
<p>
A table remains locked until it is unlocked by the user who placed the lock. The table can be unlocked by issuing UNLOCK, closing the table, or quitting Visual FoxPro. Tables can be closed with USE, CLEAR ALL, or CLOSE DATABASES.</p>
<p>
By default, FLOCK(&nbsp;) attempts to lock a table once. Use SET REPROCESS to automatically retry a table lock when the first attempt fails. SET REPROCESS determines the number of lock attempts, or the length of time during which lock attempts are made when the initial lock attempt is unsuccessful. For more information, see <a href="lngset_reprocess.htm">SET REPROCESS</a>.</p>
<p>
You can establish relations between two or more tables with SET RELATION. Placing a file lock on a table that is related to one or more tables doesn't place a file lock on the related tables. You must explicitly place and remove locks on the related tables.</p>
<p>
For additional information about record and file locking and sharing tables on a network, see Chapter 17, "Programming for Shared Access," in the <i>Programmer's Guide</i>.</p>
<p>
For additional information about record and file locking and sharing tables on a network, see Chapter 17, <a href="dgprogramming_for_shared_access.htm">Programming for Shared Access</a>, in the <i>Programmer's Guide</i>.</p>
</BODY>
</HTML>
