<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SET TEXTMERGE Command</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngset_textmerge"></a><sup></sup>SET TEXTMERGE Command</h1>
<p>
<a href="lngset_textmergesa.htm">See Also</a></p>
<p>
Enables or disables the evaluation of fields, variables, array elements, functions, or expressions that are surrounded by text-merge delimiters, and lets you specify text-merge output.</p>
<p class=label>
<b>Syntax</b></p>
<p>
SET TEXTMERGE<br>
 &nbsp; [ON | OFF]<br>
 &nbsp; [TO [<i>FileName</i>] [ADDITIVE]]<br>
 &nbsp; [WINDOW <i>WindowName</i>]<br>
 &nbsp; [SHOW | NOSHOW]</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
ON</p>
<p class=indent>
Specifies that any fields, variables, array elements, functions, or expressions surrounded by the text-merge delimiters be evaluated and output when placed after \ or \\, or between TEXT and ENDTEXT.</p>
<p class=tl>
The following short program example demonstrates how the contents of the variable <code>gcTodayDate</code> and the DATE(&nbsp;) and TIME(&nbsp;) functions are evaluated when SET TEXTMERGE is set to ON. The variable <code>gcTodayDate</code>, DATE(&nbsp;), and TIME(&nbsp;) are evaluated because they are enclosed by the text-merge delimiters and SET TEXTMERGE is set to ON.</P><pre><code>CLEAR
SET TALK OFF
STORE 'Today is: ' TO gcTodayDate
SET TEXTMERGE ON
\&lt;&lt;gcTodayDate&gt;&gt;
\\&lt;&lt;DATE(&nbsp;)&gt;&gt;
\The time is:
\\ &lt;&lt;TIME(&nbsp;)&gt;&gt;
</code></pre>
<p class=tl>
Here is the output from the program above when run on January 1:</P><pre><code>Today is: 01/01/98
The time is: 10:55:19
</code></pre>
<p class=dt>
OFF</p>
<p class=indent>
(Default) Specifies that any fields, variables, array elements, functions, or expressions be literally output along with the text-merge delimiters surrounding them. Note the difference in output when SET TEXTMERGE is set to OFF in the previous example:</p>
<pre><code>CLEAR
SET TALK OFF
STORE 'Today is: ' TO gcTodayDate
SET TEXTMERGE OFF
\&lt;&lt;gcTodayDate&gt;&gt;
\\&lt;&lt;DATE(&nbsp;)&gt;&gt;
\The time is:
\\ &lt;&lt;TIME(&nbsp;)&gt;&gt;
</code></pre>
<p class=tl>
Here is the output from this program:</P><pre><code>&lt;&lt;gcTodayDate&gt;&gt;&lt;&lt;DATE(&nbsp;)&gt;&gt;
The time is: &lt;&lt;TIME(&nbsp;)&gt;&gt;
</code></pre>
<p class=dt>
TO [<i>FileName</i>]</p>
<p class=indent>
Specifies that output from \, \\, and TEXT&nbsp;...&nbsp;ENDTEXT be directed to a text file rather than the main Visual FoxPro window, which is the default. You can also direct the output to a text file by including <i>FileName</i>. If a file with that name doesn't exist, a new file is created. If a file with the same name already exists and SET SAFETY is set to ON, you are given the option of overwriting the existing file.</p>
<p class=tl>
The text file is opened as a low-level file, and its file handle is stored to the _TEXT system variable. You can close the file by issuing SET TEXTMERGE TO without additional arguments. If the file handle of another file was previously stored in _TEXT, that file is closed.</P><p class=dt>
ADDITIVE</p>
<p class=indent>
Specifies that output from \, \\, and TEXT&nbsp;...&nbsp;ENDTEXT be appended to an existing file keyword.</p>
<p class=tl>
For more information on directing text-merge output to a file, see <a href="lng_text.htm">_TEXT</a>.</P><p class=dt>
WINDOW <i>WindowName</i></p>
<p class=indent>
Specifies that output from \, \\, and TEXT&nbsp;...&nbsp;ENDTEXT be directed to a user-defined window rather than the main Visual FoxPro window, which is the default. <i>WindowName</i> specifies the name of the window to which you want to direct output. The window must be created with DEFINE WINDOW before output can be sent to it. The window doesn't have to be active or visible.</p>
<p class=dt>
SHOW | NOSHOW</p>
<p class=indent>
(Default) SHOW displays text-merge output.</p>
<p class=tl>
NOSHOW suppresses display of text-merge output.</P><p class=tl>
By default, output generated by \, \\, and TEXT&nbsp;...&nbsp;ENDTEXT is sent to the main Visual FoxPro window or an active user-defined window.</P><p class=label>
<b>Remarks</b></p>
<p>
The \, \\, and TEXT&nbsp;...&nbsp;ENDTEXT commands are used to merge text with the contents of tables, variables, array elements, and the results of functions and expressions. If a field, variable, array element, function, or expression is surrounded by text-merge delimiters (by default, &lt;&lt; and &gt;&gt;), it can be evaluated and merged with text. This text-merge capability lets you produce letters, programs, and templates that create programs.</p>
<p>
SET TEXTMERGE determines how fields, variables, array elements, functions, or expressions surrounded by text-merge delimiters are evaluated. It also lets you direct text-merge output to the main Visual FoxPro window, a user-defined window, or a file.</p>
<p>
Memo fields can be used to nest merged text. If a memo field contains field names, variables, array elements, functions, or expressions surrounded by the current text-merge delimiters, these are evaluated and output with the contents of the memo field. The memo field name must also be enclosed in text-merge delimiters.</p>
</BODY>
</HTML>
