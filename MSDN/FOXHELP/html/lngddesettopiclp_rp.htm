<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDESetTopic( ) Function</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lngddesettopiclp_rp"></a><sup></sup>DDESetTopic(&nbsp;) Function</h1>
<p>
<a href="lngddesettopiclp_rpx.htm">Example</a> &nbsp; <a href="lngddesettopiclp_rpsa.htm">See Also</a></p>
<p>
Creates or releases a topic name from a service name in a dynamic data exchange (DDE) conversation.</p>
<p class=label>
<b>Syntax</b></p>
<p>
DDESetTopic(<i>cServiceName</i>, <i>cTopicName</i> [, <i>cUDFName</i>])</p>
<p class=label>
<b>Returns</b></p>
<p>
Logical</p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>cServiceName</i></p>
<p class=indent>
Specifies the service name. Additional service names can be created with DDESetService(&nbsp;).</p>
<p class=dt>
<i>cTopicName</i></p>
<p class=indent>
Specifies the topic name to create or release. If you include <i>cUDFName</i>, DDESetTopic(&nbsp;) creates the topic name <i>cTopicName</i>. If you omit <i>cUDFName</i>, the topic name <i>cTopicName</i> is released. If <i>cTopicName</i> is an empty string, the user-defined function specified with <i>cUDFName</i> is executed for any topic name that isn't explicitly declared.</p>
<p class=dt>
<i>cUDFName</i></p>
<p class=indent>
Specifies the name of the user-defined function executed when a client application makes a request to the topic name. If you omit <i>cUDFName</i>, the topic name <i>cTopicName</i> is released from the service name.</p>
<p class=tl>
When the user-defined function is executed, it is passed the following six parameters in the order given below:</P><table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=35%><b>Parameter</b></td>
<td class=label width=65%><b>Contents</b></td>
</tr>
<tr valign=top>
<td width=35%>Channel Number</td>
<td width=65%>The client channel number.</td>
</tr>
<tr valign=top>
<td width=35%>Action</td>
<td width=65%>ADVISE, EXECUTE, INITIATE, POKE, REQUEST, or TERMINATE.</td>
</tr>
<tr valign=top>
<td width=35%>Item</td>
<td width=65%>The item name; for example, R1C1 for a Microsoft Excel worksheet cell.</td>
</tr>
<tr valign=top>
<td width=35%>Data</td>
<td width=65%>Data from the client.</td>
</tr>
<tr valign=top>
<td width=35%>Format</td>
<td width=65%>The data format; for example, CF_TEXT.</td>
</tr>
<tr valign=top>
<td width=35%>Advise Status</td>
<td width=65%>The link type (0 = manual, 2 = notify or automatic).</td>
</tr>
</table><br>
<p class=tl>
The values of the Item, Data, and Advise Status parameters depend on the Action parameter. The following table lists the Action parameter values and the values contained in the Item, Data, and Advise Status parameters. A dash (–) indicates that the parameter value is the empty string.</P><table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Action value</b></td>
<td class=label width=23%><b>Item value</b></td>
<td class=label width=26%><b>Data value</b></td>
<td class=label width=26%><b>Advise status</b></td>
</tr>
<tr valign=top>
<td width=25%>INITIATE</td>
<td width=23%>–</td>
<td width=26%>Topic name</td>
<td width=26%>–</td>
</tr>
<tr valign=top>
<td width=25%>TERMINATE</td>
<td width=23%>–</td>
<td width=26%>–</td>
<td width=26%>–</td>
</tr>
<tr valign=top>
<td width=25%>POKE</td>
<td width=23%>Item name</td>
<td width=26%>New data</td>
<td width=26%>–</td>
</tr>
<tr valign=top>
<td width=25%>REQUEST</td>
<td width=23%>Item name</td>
<td width=26%>–</td>
<td width=26%>–</td>
</tr>
<tr valign=top>
<td width=25%>EXECUTE</td>
<td width=23%>–</td>
<td width=26%>New command</td>
<td width=26%>–</td>
</tr>
<tr valign=top>
<td width=25%>ADVISE</td>
<td width=23%>Item name</td>
<td width=26%>–</td>
<td width=26%>Link type</td>
</tr>
</table><br>
<p class=tl>
If the user-defined function successfully handles the client request, the user-defined function should return true (.T.). If the request can't be handled or an error occurs, the user-defined function should return false (.F.). If false is returned when the Action parameter value is INITIATE, the client topic name request is rejected. If false is returned when the value is POKE, REQUEST, or EXECUTE, the request is ignored. If false is returned when the value is ADVISE, the client request for a notify or automatic link is rejected.</P><p class=label>
<b>Remarks</b></p>
<p>
After a topic name is created, any client requests to the topic name cause Visual FoxPro to execute the user-defined function specified with <i>cUDFName</i>. The user-defined function is passed a set of parameters whose values are determined by the client request. The user-defined function return value is passed to the client with DDEPoke(&nbsp;). The return value is a logical value indicating whether the topic name can provide the service requested by the client.</p>
<p>
DDESetTopic(&nbsp;) returns true (.T.) if it successfully creates or releases the topic name. It returns false (.F.) if the topic name cannot be created or released. Use DDELastError(&nbsp;) to determine why a topic name cannot be created or released.</p>
</BODY>
</HTML>
