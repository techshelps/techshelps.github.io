<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_DBUnlock( ) API Library Routine Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lng_dbunlocklp_rpx"></a><sup></sup>_DBUnlock(&nbsp;) API Library Routine Example</b></p>
<p>
The following example uses _DBUnlock(&nbsp;) to unlock all records of the table open in the current work area. The Visual FoxPro code demonstrates _DBUnlock(&nbsp;) and verifies that it's working properly.</p>
<h4>Visual FoxPro Code</h4>
<pre><code>SET LIBRARY TO DBUNLOCK
DO CreateTest
USE Test SHARED
GO 2
= XRLOCK()
LIST STAT&nbsp; &amp;&amp; shows that record #2 is locked
= XUNLOCK()
LIST STAT&nbsp; &amp;&amp; shows no records are locked
= XFLOCK()
LIST STAT&nbsp; &amp;&amp; shows that whole DBF is locked
= XUNLOCK()
LIST STAT&nbsp; &amp;&amp; shows no records are locked

PROCEDURE CreateTest

CREATE TABLE test (ABC C(20))
APPEND BLANK
REPLACE ABC WITH "Golly month of"
APPEND BLANK
REPLACE ABC WITH "A twelfth of"
APPEND BLANK
REPLACE ABC WITH "Hello, world"
APPEND BLANK
REPLACE ABC WITH "When in the"
GO TOP

RETURN
</code></pre>
<h4>C Code</h4>
<pre><code>#include &lt;pro_ext.h&gt;

FAR xLockRecord(ParamBlk FAR *parm)
{
 &nbsp; _DBLock(-1, DBL_RECORD);
}
FAR xLockFile(ParamBlk FAR *parm)
{
 &nbsp; _DBLock(-1, DBL_FILE);
}
FAR xUnLockFile(ParamBlk FAR *parm)
{
 &nbsp; <span class=cfe><b>_DBUnLock(</b></span>-1<span class=cfe><b>)</b></span>;
}
FoxInfo myFoxInfo[] = {
 &nbsp; {"XRLOCK",&nbsp; (FPFI) xLockRecord, 0, ""},
 &nbsp; {"XFLOCK",&nbsp; (FPFI) xLockFile, 0, ""},
 &nbsp; {"XUNLOCK", (FPFI) xUnLockFile, 0, ""},
};
FoxTable _FoxTable = {
 &nbsp; (FoxTable FAR *) 0, sizeof(myFoxInfo)/sizeof(FoxInfo), myFoxInfo
};
FoxTable _FoxTable = {
 &nbsp; (FoxTable FAR *) 0, sizeof(myFoxInfo)/sizeof(FoxInfo), myFoxInfo
};
</code></pre>
</BODY>
</HTML>
