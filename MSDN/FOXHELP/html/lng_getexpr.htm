<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_GETEXPR System Memory Variable</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<h1><a name="lng_getexpr"></a><sup></sup>_GETEXPR System Variable</h1>
<p>
<a href="lng_getexprsa.htm">See Also</a></p>
<p>
Specifies the program that is executed when you issue the GETEXPR command or invoke the Expression Builder dialog box from within Visual FoxPro.</p>
<p class=label>
<b>Syntax</b></p>
<p>
_GETEXPR = <i>ProgramName</i></p>
<p class=label>
<b>Arguments</b></p>
<p class=dt>
<i>ProgramName</i></p>
<p class=indent>
Specifies a program that is executed when you issue the GETEXPR command or invoke the Expression Builder dialog box from within Visual FoxPro. If your program is in a directory other than the current default directory, include a path with the program name.</p>
<p class=label>
<b>Remarks</b></p>
<p>
_GETEXPR contains the empty string by default; the empty string indicates that the standard Visual FoxPro Expression Builder dialog box is displayed when the GETEXPR command is executed or when you invoke the Expression Builder dialog box from within Visual FoxPro.</p>
<p>
You can create your own Expression Builder program that is executed when the GETEXPR command is executed or when you invoke the Expression Builder dialog box from within Visual FoxPro. Your Expression Builder program must contain an LPARAMETERS or PARAMETERS statement as the first executable line of the program to accept four parameters that Visual FoxPro passes to the program. The parameters are listed below in the order they passed:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Parameter</b></td>
<td class=label width=75%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=25%><i>cExpressionType</i></td>
<td width=75%>Specifies the expression type.</td>
</tr>
<tr valign=top>
<td width=25%><i>cErrorMessageText</i></td>
<td width=75%>Specifies the error message displayed if the expression isn't valid.</td>
</tr>
<tr valign=top>
<td width=25%><i>cDefaultExpression</i></td>
<td width=75%>Specifies the initial default expression in the Expression Builder.</td>
</tr>
<tr valign=top>
<td width=25%><i>cCaptionText</i></td>
<td width=75%>Specifies the caption that appears in the Expression Builder.</td>
</tr>
</table><br>
<p>
For example, the following could be the first executable line of your Expression Builder program:</p>
<pre><code>LPARAMETERS cExpressionType, cErrorMessageText, ;
 &nbsp; cDefaultExpression, cCaptionText
</code></pre>
<p>
If your Expression Builder program is executed when the Expression Builder dialog box is invoked from within Visual FoxPro, the first three parameters contain the empty string and the fourth parameter contains <i>cCaptionText</i>, the caption that appears in the Expression Builder.</p>
<p>
Note that the Visual FoxPro Expression Builder is a modal dialog. Your Expression Builder program should set its form properties to the following values to create a modal dialog:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>Form property</b></td>
<td class=label width=75%><b>Property value</b></td>
</tr>
<tr valign=top>
<td width=25%>AlwaysOnTop</td>
<td width=75%>True (.T.)</td>
</tr>
<tr valign=top>
<td width=25%>Desktop</td>
<td width=75%>True (.T.)</td>
</tr>
<tr valign=top>
<td width=25%>WindowType</td>
<td width=75%>1 – Modal</td>
</tr>
</table><br>
</BODY>
</HTML>
