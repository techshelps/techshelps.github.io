<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_WScroll( ) API Library Routine Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lng_wscrolllp_rpx"></a><sup></sup>_WScroll(&nbsp;) API Library Routine Example</b></p>
<p>
The following example opens a window and draws a rectangular pattern of Xs. This rectangle is also the scroll rectangle. First, the example scrolls the rectangle up two positions and to the left two positions. Next, it scrolls the rectangle down by four positions and to the right four positions.</p>
<h4>Visual FoxPro Code</h4>
<pre><code>SET LIBRARY TO WSCROLL 
</code></pre>
<h4>C Code</h4>
<pre><code>#include &lt;pro_ext.h&gt;

FAR WScrollEx(ParamBlk FAR *parm)
{
 &nbsp; WHANDLE wh;
 &nbsp; Point pos;
 &nbsp; Rect rect;

 &nbsp; wh = _WOpen(2,2,20,70,WEVENT | CLOSE,WINDOW_SCHEME,(Scheme FAR *) 0,
 &nbsp;&nbsp;&nbsp;&nbsp; WO_SYSTEMBORDER);
 &nbsp; _WShow(wh);

 &nbsp; rect.top&nbsp;&nbsp; = 6;
 &nbsp; rect.left&nbsp;&nbsp; = 6;
 &nbsp; rect.bottom = 12;
 &nbsp; rect.right&nbsp;&nbsp; = 12;

 &nbsp; for (pos.v = rect.top; pos.v &lt; rect.bottom; pos.v++)
 &nbsp; {
 &nbsp;&nbsp;&nbsp;&nbsp; for (pos.h = rect.left; pos.h &lt; rect.right; pos.h++)
 &nbsp;&nbsp;&nbsp;&nbsp; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _WPosCursor(wh, pos);
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _WPutChr(wh, 'X');
 &nbsp;&nbsp;&nbsp;&nbsp; }
 &nbsp; }
 &nbsp; _Execute("WAIT WINDOW 'Press any key to <span class=cfe><b>_WScroll(</b></span>wh,rect,-2,-2<span class=cfe><b>)</b></span>'");
 &nbsp; <span class=cfe><b>_WScroll(</b></span>wh, rect, -2, -2<span class=cfe><b>)</b></span>;
 &nbsp; _Execute("WAIT WINDOW 'Press any key to <span class=cfe><b>_WScroll(</b></span>wh,rect,+4,+4<span class=cfe><b>)</b></span>'");
 &nbsp; <span class=cfe><b>_WScroll(</b></span>wh, rect, +4, +4<span class=cfe><b>)</b></span>;
}

FoxInfo myFoxInfo[] = {
 &nbsp; {"ONLOAD", (FPFI) WScrollEx, CALLONLOAD, ""},
};
FoxTable _FoxTable = {
 &nbsp; (FoxTable FAR *) 0, sizeof(myFoxInfo)/sizeof(FoxInfo), myFoxInfo
};
</code></pre>
</BODY>
</HTML>
