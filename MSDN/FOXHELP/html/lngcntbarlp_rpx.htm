<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CNTBAR( ) Function Example</title>
<style>
<link disabled rel=stylesheet href=/stylesheets/msdn_ie3.css>
<style type="text/css">
@import url(/stylesheets/msdn_ie4.css);
</style></HEAD>
<BODY>

<p class=label>
<b><a name="lngcntbarlp_rpx"></a><sup></sup>CNTBAR(&nbsp;) Function Example</b></p>
<p>
In the following program example, named CNTBAR.PRG, a menu title is added to the system menu. The menu <code>popEnv</code> is created with four menu items. The program places a mark character by each item when the item is selected. CNTBAR(&nbsp;) is used within a loop to initially display marks next to the appropriate menu items.</p>
<pre><code>*** You must name this program CNTBAR.PRG ***
CLEAR
SET TALK OFF
DEFINE PAD padEnv OF _MSYSMENU PROMPT 'E\&lt;nvironment';
 &nbsp; KEY ALT+R, 'ALT+R'
ON PAD padEnv OF _MSYSMENU ACTIVATE POPUP popEnv
DEFINE POPUP popEnv MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF popEnv PROMPT '\&lt;Status Bar'
DEFINE BAR 2 OF popEnv PROMPT '\&lt;Clock'
DEFINE BAR 3 OF popEnv PROMPT '\&lt;Extended Video'
DEFINE BAR 4 OF popEnv PROMPT 'St\&lt;icky'
ON SELECTION POPUP popEnv DO enviropop IN cntbar.prg
FOR i = 1 TO <span class=cfe><b>CNTBAR(</b></span>'popEnv'<span class=cfe><b>)</b></span>
 &nbsp; DO CASE
 &nbsp;&nbsp;&nbsp;&nbsp; CASE PRMBAR('popEnv', i) = 'Status Bar'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF _WINDOWS or _MAC
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR i OF popEnv TO SET('STATUS BAR') = 'ON'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ELSE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR i OF popEnv TO SET('STATUS') = 'ON'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENDIF
 &nbsp;&nbsp;&nbsp;&nbsp; CASE PRMBAR('popEnv', i) = 'Clock'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR i OF popEnv TO&nbsp; SET('CLOCK') = 'ON'
 &nbsp;&nbsp;&nbsp;&nbsp; CASE PRMBAR('popEnv', i) = 'Extended Video'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR i OF popEnv TO&nbsp; SROW( ) &gt; 25
 &nbsp;&nbsp;&nbsp;&nbsp; CASE PRMBAR('popEnv', i) = 'Sticky'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR i OF popEnv TO&nbsp; SET('STICKY') = 'ON'
 &nbsp; ENDCASE
ENDFOR
PROCEDURE enviropop
DO CASE
 &nbsp; CASE PROMPT() = 'Status'
 &nbsp;&nbsp;&nbsp;&nbsp; IF mrkbar('popEnv', BAR( ))
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DO CASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _WINDOWS OR _MAC
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET STATUS BAR OFF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _DOS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET STATUS OFF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OTHERWISE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENDCASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .F.
 &nbsp;&nbsp;&nbsp;&nbsp; ELSE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DO CASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _WINDOWS OR _MAC
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET STATUS BAR ON
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _DOS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET STATUS ON
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OTHERWISE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENDCASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .T.
 &nbsp;&nbsp;&nbsp;&nbsp; ENDIF
CASE PROMPT( ) = 'Clock'
 &nbsp; IF mrkbar('popEnv', BAR( ))
 &nbsp;&nbsp;&nbsp;&nbsp; SET CLOCK OFF
 &nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .F.
 &nbsp; ELSE
 &nbsp;&nbsp;&nbsp;&nbsp; DO CASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _WINDOWS OR _MAC
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET STATUS BAR ON
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET CLOCK STATUS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _DOS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET CLOCK ON
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OTHERWISE
 &nbsp;&nbsp;&nbsp;&nbsp; ENDCASE
 &nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .T.
 &nbsp; ENDIF
CASE PROMPT( ) = 'Extended Video'
 &nbsp; IF MRKBAR('popEnv', BAR( ))
 &nbsp;&nbsp;&nbsp;&nbsp; SET DISPLAY TO VGA25
 &nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .F.
 &nbsp; ELSE
 &nbsp;&nbsp;&nbsp;&nbsp; SET DISPLAY TO VGA50
 &nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .T.
 &nbsp; ENDIF
CASE PROMPT( ) = 'Sticky'
 &nbsp; IF MRKBAR('popEnv', BAR( ))
 &nbsp;&nbsp;&nbsp;&nbsp; DO CASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _WINDOWS OR _MAC
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WAIT WINDOW 'STICKY is always on in this Visual FoxPro version'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _DOS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET STICKY OFF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OTHERWISE
 &nbsp;&nbsp;&nbsp;&nbsp; ENDCASE
 &nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .F.
 &nbsp; ELSE
 &nbsp;&nbsp;&nbsp;&nbsp; DO CASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _WINDOWS OR _MAC
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WAIT WINDOW 'STICKY is always ON in Visual FoxPro'
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE _DOS
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET STICKY ON
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OTHERWISE
 &nbsp;&nbsp;&nbsp;&nbsp; ENDCASE
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET MARK OF BAR BAR( ) OF popEnv TO .T.
 &nbsp; ENDIF
ENDCASE
</code></pre>
</BODY>
</HTML>
