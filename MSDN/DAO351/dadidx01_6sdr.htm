<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>What's New in DAO?</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="daidxwhatsnewindao"></a>What's New in DAO?</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daidxWhatsNewInDAOC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daidxWhatsNewInDAOS">
</object></p>
<p>
DAO 3.5 introduces a new client/server connection mode, called "<a href="dadefn03_0ek4.htm">ODBCDirect</a>." ODBCDirect establishes a connection directly to an <a href="dadefn02_01id.htm">ODBC data source</a>, without loading the <a href="dadefn01_29k5.htm">Microsoft Jet database engine</a> into memory, and is useful in situations where specific features of ODBC are required.</p>
<p>
For <a href="dadefn03_157p.htm">Microsoft Jet databases</a>, there are also new interfaces to expose Microsoft Jet's new partial replication feature.</p>
<p class=indent>
<b>Note</b> You can send DAO queries to a variety of different database servers with ODBCDirect, and different servers will recognize slightly different dialects of SQL. Therefore, context-sensitive Help is no longer provided for Microsoft Jet SQL, although online Help for Microsoft Jet SQL is still included through the Help menu. Be sure to check the appropriate reference documentation for the SQL dialect of your database server when using either ODBCDirect connections or pass-through queries in Microsoft Jet-connected client/server applications.</p>
<h1>New DAO 3.5 Interfaces for ODBCDirect</h1>
<ul type=disc>
<li>
<a href="dadobj05_8xbi.htm">Connection</a> object — A connection to an <u>ODBC </u>database.<br><br></li>
<li>
<a href="dameth05_2fxo.htm">Cancel</a> method (on <b>Connection</b>, <b>QueryDef</b>, and <b>Recordset</b> objects) — Cancels execution of an asynchronous operation.<br><br></li>
<li>
<a href="dameth05_7vp0.htm">NextRecordset</a> method (on <b>Recordset</b> objects) — Retrieves the next set of records, if any, returned by a query that returned multiple sets of records in an <b>OpenRecordset</b><u> </u>call, and indicates whether it successfully retrieved another set of records.<br><br></li>
<li>
<a href="dameth05_5nvy.htm">OpenConnection</a> method (on <b>Workspace</b> objects) — Opens a <b>Connection</b><u> </u>object on an <u>ODBC data source.</u><br><br></li>
<li>
<a href="daprop08_4sj8.htm">BatchCollisionCount</a> property (on <b>Recordset</b> objects) — Returns the number of records that did not complete during the last <a href="dadefn03_9euf.htm">batch update</a>.<br><br></li>
<li>
<a href="daprop08_9aib.htm">BatchCollisions</a> property (on <b>Recordset</b> objects) — Returns an array of bookmarks indicating the rows that generated <a href="dadefn03_3s8e.htm">collisions</a> in the last batch update.<br><br></li>
<li>
<a href="daprop08_8axx.htm">BatchSize</a> property (on <b>Recordset</b> objects) — Sets or returns the number of statements sent back to the server in each batch.<br><br></li>
<li>
<a href="daprop08_22em.htm">Connection</a> property (on <b>Database</b> and <b>Recordset</b> objects) — Returns the <b>Connection</b> object that corresponds to the <b>Database</b>, or that owns the <b>Recordset</b>.<br><br></li>
<li>
<a href="daprop08_24o5.htm">Database</a> property (on <b>Connection</b> objects) — Returns the name of the <b>Database</b> object that corresponds to the <b>Connection</b>.<br><br></li>
<li>
<a href="daprop08_2n5e.htm">DefaultCursorDriver</a> property (on <b>Workspace</b> objects) — Sets or returns the type of cursor driver used for ODBCDirect <b>Recordset</b> objects.<br><br></li>
<li>
<a href="daprop08_6llx.htm">DefaultType</a> property (on <b>DBEngine</b> object) — Indicates what type of workspace (Microsoft Jet or <u>ODBCDirect</u>) will be created by the next <b>CreateWorkspace</b> method call.<br><br></li>
<li>
<a href="daprop08_5kxa.htm">Direction</a> property (on <b>Parameter</b> objects) — Indicates whether a <b>Parameter</b> object represents an input parameter, an output parameter, or both, or if the parameter is the return value from a stored procedure.<br><br></li>
<li>
<a href="daprop08_8cc3.htm">MaxRecords</a> property (on <b>QueryDef</b> objects) — Sets or returns the maximum number of records to return from a query.<br><br></li>
<li>
<a href="daprop08_1eat.htm">OriginalValue</a> property (on <b>Field</b> objects) — Returns the value of a <b>Field</b> in the database that existed when the last batch update began.<br><br></li>
<li>
<a href="daprop08_063p.htm">Prepare</a> property (on <b>QueryDef</b> objects) — Returns a value that indicates whether the query should be prepared on the server as a temporary stored procedure with the ODBC <b>SQLPrepare</b> function prior to execution, or just executed using the ODBC <b>SQLExecDirect</b> function.<br><br></li>
<li>
<a href="daprop08_57hv.htm">RecordStatus</a> property (on <b>Recordset</b> objects) — Returns a value that indicates the update status of the current record if it is part of a batch update.<br><br></li>
<li>
<a href="daprop08_686f.htm">StillExecuting</a> property (on <b>Connection</b>, <b>QueryDef</b>, and <b>Recordset</b> objects) — Returns a value indicating whether or not an asynchronous operation has finished executing.<br><br></li>
<li>
<a href="daprop08_1cdv.htm">UpdateOptions</a> property (on <b>Recordset</b> objects) — Returns a value that indicates how the WHERE clause is constructed for each record during a batch update, and how the update should be executed.<br><br></li>
<li>
<a href="daprop08_6obp.htm">VisibleValue</a> property (on <b>Recordset</b> objects) — Returns a value currently in the database that is newer than the <b>OriginalValue</b> property as determined by a batch update conflict.</li>
</ul>
<h1>New Capabilities with ODBCDirect</h1>
<p class=label>
<b>Server Connections</b></p>
<p>
Available only in the ODBCDirect object model, the new <b>Connection</b> object contains information about a connection to an ODBC data source, such as the server name, the data source name, and so on. It is similar to a <b>Database</b> object, and will look very familiar if you've ever opened a <b>Database</b> object on an ODBC data source. In fact, a <b>Connection</b> object and a <b>Database </b>object represent different references to the same object, and new properties on each of these two object types allow you to obtain a reference to the other corresponding object, which simplifies the task of converting existing ODBC client applications that use Microsoft Jet to use ODBCDirect instead.</p>
<p class=label>
<b>Batch Updates</b></p>
<p>
A new batch update cursor is available for client applications that need to work with a cursor without holding locks on the server or issue update requests one record at a time. Instead, the client stores update information on many records in a local buffer (or "batch"), and then issues a batch update.</p>
<p>
Because of the time lag between opening a <b>Recordset</b> and sending a batch of updates from that <b>Recordset</b> back to the server, other users have an opportunity to change the original data before your changes are sent to the server, so your changes "collide" with another user's changes. Several new features are available to help you determine where such collisions have occurred, following a batch update, and give you some options for resolving them.</p>
<p class=label>
<b>Asynchronous Method Execution</b></p>
<p>
The <b>Execute</b>, <b>MoveLast</b>, <b>OpenConnection</b>, and <b>OpenRecordset</b> methods feature the <b>dbRunAsync</b> option. This allows the client application to do other tasks (such as loading forms, and so on) while the method is executing. You can also poll to see whether the task is complete, and terminate an asynchronous task.</p>
<p class=label>
<b>Client Support for ODBC Cursors</b></p>
<p>
Four different <b>Recordset</b> types support the following ODBC cursor types:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=563>
<tr valign=top>
<td class=label width=40%><b>ODBC Cursor</b></td>
<td class=label width=60%><b>Recordset type</b></td>
</tr>
<tr valign=top>
<td width=40%>Dynamic</td>
<td width=60%><b>dbOpenDynamic</b> (New in DAO 3.5)</td>
</tr>
<tr valign=top>
<td width=40%>Dynaset</td>
<td width=60%><b>dbOpenDynaset</b></td>
</tr>
<tr valign=top>
<td width=40%>Forward-Only</td>
<td width=60%><b>dbOpenForwardOnly</b> (New in DAO 3.5)</td>
</tr>
<tr valign=top>
<td width=40%>Static</td>
<td width=60%><b>dbOpenSnapshot</b></td>
</tr>
</table><br>
<h1>New DAO 3.5 Interfaces for the Microsoft Jet Database Engine</h1>
<ul type=disc>
<li>
<a href="dameth06_627g.htm">PopulatePartial</a> method (on <b>Database</b> objects) — Synchronizes any changes in a partial replica with the full <a href="rpldef_73j5.htm">replica</a>, clears all records in the partial replica, and then repopulates the <a href="rpldef_2hb5.htm">partial replica</a> based on the current replica filters.<br><br></li>
<li>
<a href="dameth05_5jn2.htm">SetOption</a> method (on <b>DBEngine</b> object) — Overrides the registry values for the <u>Microsoft Jet database engine for the duration of the current instance of DAO.</u><br><br></li>
<li>
<a href="daprop08_24th.htm">FieldSize</a> property (on <b>Field</b> objects) — Replaces the <b>FieldSize</b> method. Syntactically, their usage is the same, so this will not require changes to your existing code.<br><br></li>
<li>
<a href="daprop08_8cc3.htm">MaxRecords</a> property (on <b>QueryDef</b> objects) — Sets or returns the maximum number of records to return from a query.<br><br></li>
<li>
<a href="daprop07_73qq.htm">ReplicaFilter</a> property (on <b>TableDef</b> objects) — Returns a value that indicates which subset of records is replicated to that table from a full replica.<br><br></li>
<li>
<a href="daprop07_0p7l.htm">PartialReplica</a> property (on <b>Relation</b> objects) — Indicates which <b>Relation</b> object should be considered when populating a partial replica from a full replica.</li>
</ul>
<h1>New Capabilities with the Microsoft Jet Database Engine</h1>
<p class=label>
<b>Partial Replication</b></p>
<p>
Version 3.5 of the Microsoft Jet database engine allows users to replicate portions of a table instead of the whole table (only row restrictions are permitted, not columns). There are two types of filters used in a partial replica — Boolean and relationship. Boolean filters select only rows that meet a certain criteria to limit the rows in a table that are replicated. DAO represents this filter with the <b>ReplicaFilter</b> property on a <b>TableDef</b>. Relationship filters enforce a relationship between partially replicated tables to limit the rows in a table that are replicated. With DAO, you can set the <b>PartialReplica</b> property on a <b>Relation</b> which allows that <b>Relation</b> to be used in partial replication.</p>
<p class=label>
<b>New Recordset Type</b></p>
<p>
In DAO 3.5, <b>dbOpenForwardOnly</b> is a new<i> type</i> argument for the <b>OpenRecordset</b> method. This new <b>Recordset</b> type behaves in the same way as a DAO 3.0 snapshot-type <b>Recordset</b> opened with the <b>dbForwardOnly</b> option.</p>
<p class=label>
<b>Run-time Registry Override</b></p>
<p>
The new <b>SetOption</b> method allows you to override Microsoft Jet Registry settings at run time. This lets you fine tune Microsoft Jet query performance, timeout delays, and so on.</p>
</font></BODY>
</HTML>
