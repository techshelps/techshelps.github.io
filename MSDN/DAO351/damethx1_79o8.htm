<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Seek Method Example (DAO/Microsoft Jet)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="damthseekx"></a>Seek Method Example</b></p>
<p>
This example demonstrates the <b>Seek</b> method by allowing the user to search for a product based on an ID number.</p>
<pre><code>Sub SeekX()

   Dim dbsNorthwind As Database
   Dim rstProducts As Recordset
   Dim intFirst As Integer
   Dim intLast As Integer
   Dim strMessage As String
   Dim strSeek As String
   Dim varBookmark As Variant

   Set dbsNorthwind = OpenDatabase("Northwind.mdb")
   ' You must open a table-type Recordset to use an index, 
   ' and hence the Seek method.
   Set rstProducts = _
      dbsNorthwind.OpenRecordset("Products", dbOpenTable)

   With rstProducts
      ' Set the index.
      .Index = "PrimaryKey"

      ' Get the lowest and highest product IDs.
      .MoveLast
      intLast = !ProductID
      .MoveFirst
      intFirst = !ProductID

      Do While True
         ' Display current record information and ask user 
         ' for ID number.
         strMessage = "Product ID: " &amp; !ProductID &amp; vbCr &amp; _
            "Name: " &amp; !ProductName &amp; vbCr &amp; vbCr &amp; _
            "Enter a product ID between " &amp; intFirst &amp; _
            " and " &amp; intLast &amp; "."
         strSeek = InputBox(strMessage)

         If strSeek = "" Then Exit Do

         ' Store current bookmark in case the Seek fails.
         varBookmark = .Bookmark

         .<i>Seek</i> "=", Val(strSeek)

         ' Return to the current record if the Seek fails.
         If .NoMatch Then
            MsgBox "ID not found!"
            .Bookmark = varBookmark
         End If
      Loop

      .Close
   End With

   dbsNorthwind.Close

End Sub</code></pre>
</font></BODY>
</HTML>
