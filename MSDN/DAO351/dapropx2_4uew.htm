<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeepLocal Property Example (DAO/Microsoft Jet)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="daprokeeplocalx"></a>KeepLocal Property Example</b></p>
<p>
The following example appends the <b>KeepLocal</b> property to the properties collection of a document object for the Utilities module in the Northwind database. You set this property on an object (such as a table) before a database is made replicable. When the database is converted to a <a href="rpldef_3sj6.htm">Design Master</a><b>, </b>the object you specified to remain local will not be dispersed to other members of the replica set. Adjust the path to Northwind.mdb as appropriate to its location on your computer.</p>
<pre><code>Sub KeepLocalNWObjectX()

   Dim dbsNorthwind As Database
   Dim docTemp As Document
   Dim prpTemp As Property

   Set dbsNorthwind = OpenDatabase("Northwind.mdb")
   Set docTemp = dbsNorthwind.Containers("Modules"). _
      Documents("Utility Functions")
   Set prpTemp = doc.CreateProperty("<span class=cfe><b>KeepLocal</b></span>", _
      dbText, "T")
   docTemp.Properties.Append prpTemp
   dbsNorthwind.Close

End Sub
</code></pre>
<p>
The following code sets the <b>KeepLocal</b> property on the specified <b>TableDef</b> object to <code>"T"</code>. If the <b>KeepLocal</b> property doesn't exist, it is created and appended to the table's <b>Properties</b> collection, and given a value of <code>"T"</code>.</p>
<pre><code>Sub SetKeepLocal(tdfTemp As TableDef)

   On Error GoTo ErrHandler

   tdfTemp.Properties("<span class=cfe><b>KeepLocal</b></span>") = "T"

   On Error GoTo 0

   Exit Sub

ErrHandler:

   Dim prpNew As Property

   If Err.Number = 3270 Then
      Set prpNew = tdfTemp.CreateProperty("<span class=cfe><b>KeepLocal</b></span>", _
         dbText, "T")
      tdfTemp.Properties.Append prpNew
   Else
      MsgBox "Error " &amp; Err &amp; ": " &amp; Error
   End If

End Sub
</code></pre>
</font></BODY>
</HTML>
