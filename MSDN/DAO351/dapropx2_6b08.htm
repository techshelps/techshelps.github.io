<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Database Property Example (DAO/ODBCDirect)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="daprodatabasex"></a>Database Property Example</b></p>
<p>
This example uses the <b>Database</b> property to show how code that used to access ODBC data through the <a href="dadefn01_29k5.htm">Microsoft Jet database engine</a> can be converted to use ODBCDirect <b>Connection</b> objects.</p>
<p>
The OldDatabaseCode procedure uses a <a href="dadefn03_88f9.htm">Microsoft Jet-connected data source</a> to access an ODBC database.</p>
<pre><code>Sub OldDatabaseCode()

<b>   </b>Dim wrkMain As Workspace
<b>   </b>Dim dbsPubs As Database
<b>   </b>Dim prpLoop As Property

<b>   </b>' Create Microsoft Jet Workspace object.
<b>   </b>Set wrkMain = CreateWorkspace("", "admin", "", dbUseJet)

<b>   </b>' Open a Database object based on information in
<b>   </b>' the connect string.
<b>   </b>Set dbsPubs = wrkMain.OpenDatabase("Publishers", _
<b>      </b>dbDriverNoPrompt, False, _
<b>      </b>"ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

<b>   </b>' Enumerate the Properties collection of the Database 
   ' object.
<b>   </b>With dbsPubs
<b>      </b>Debug.Print "Database properties for " &amp; _
<b>         </b>.Name &amp; ":"

<b>      </b>On Error Resume Next
<b>      </b>For Each prpLoop In .Properties
<b>         </b>If prpLoop.Name = "Connection" Then
<b>            </b>' Property actually returns a Connection object.
<b>            </b>Debug.Print "&nbsp; Connection[.Name] = " &amp; _
<b>               </b>.Connection.Name
<b>         </b>Else
<b>            </b>Debug.Print "&nbsp; " &amp; prpLoop.Name &amp; " = " &amp; _
<b>               </b>prpLoop
<b>         </b>End If
<b>      </b>Next prpLoop
<b>      </b>On Error GoTo 0

<b>   </b>End With

<b>   </b>dbsPubs.Close
<b>   </b>wrkMain.Close

End Sub
</code></pre>
<p>
The NewDatabaseCode example opens a <b>Connection</b> object in an <a href="dadefn03_6izp.htm">ODBCDirect workspace</a>. It then assigns the <b>Database</b> property of the <b>Connection</b> object to an <a href="dadefn02_3h7p.htm">object variable</a> with the same name as the data source in the old procedure. None of the subsequent code has to be changed as long as it doesn't use any features specific to <a href="dadefn03_4wth.htm">Microsoft Jet workspaces</a>.</p>
<pre><code>Sub NewDatabaseCode()

<b>   </b>Dim wrkMain As Workspace
<b>   </b>Dim conPubs As Connection
<b>   </b>Dim dbsPubs As Database
<b>   </b>Dim prpLoop As Property

<b>   </b>' Create ODBCDirect Workspace object instead of Microsoft 
   ' Jet Workspace object.
<b>   </b>Set wrkMain = CreateWorkspace("", "admin", "", dbUseODBC)

<b>   </b>' Open Connection object based on information in
<b>   </b>' the connect string.
<b>   </b>Set conPubs = wrkMain.OpenConnection("Publishers", _
<b>      </b>dbDriverNoPrompt, False, _
<b>      </b>"ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")
<b>   </b>' Assign the Database property to the same object 
   ' variable as in the old code.
<b>   </b>Set dbsPubs = conPubs.<span class=cfe><b>Database</b></span>

<b>   </b>' Enumerate the Properties collection of the Database 
   ' object. From this point on, the code is the same as the 
   ' old example.
<b>   </b>With dbsPubs
<b>      </b>Debug.Print "Database properties for " &amp; _
<b>         </b>.Name &amp; ":"

<b>      </b>On Error Resume Next
<b>      </b>For Each prpLoop In .Properties
<b>         </b>If prpLoop.Name = "Connection" Then
<b>            </b>' Property actually returns a Connection object.
<b>            </b>Debug.Print "&nbsp; Connection[.Name] = " &amp; _
<b>               </b>.Connection.Name
<b>         </b>Else
<b>            </b>Debug.Print "&nbsp; " &amp; prpLoop.Name &amp; " = " &amp; _
<b>               </b>prpLoop
<b>         </b>End If
<b>      </b>Next prpLoop
<b>      </b>On Error GoTo 0

<b>   </b>End With

<b>   </b>dbsPubs.Close
<b>   </b>wrkMain.Close

End Sub
</code></pre>
</font></BODY>
</HTML>
