<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UpdateOptions Property (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="daproupdateoptions"></a>UpdateOptions Property</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daproUpdateOptionsC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daproUpdateOptionsX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daproUpdateOptionsA">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daproUpdateOptionsS">
</object></p>
<p>
Sets or returns a value that indicates how the WHERE clause is constructed for each record during a <a href="dadefn03_9euf.htm">batch update</a>, and whether the batch update should use an UPDATE statement or a DELETE followed by an INSERT (<a href="dadefn03_6izp.htm">ODBCDirect workspaces</a> only).</p>
<p class=label>
<b>Settings And Return Values</b></p>
<p>
The setting or return value is a <a href="dadefn01_9kh1.htm">Long</a> that can be any of the following constants:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Constant</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=50%><b>dbCriteriaKey</b></td>
<td width=50%>(Default) Uses just the key column(s) in the where clause.</td>
</tr>
<tr valign=top>
<td width=50%><b>dbCriteriaModValues</b></td>
<td width=50%>Uses the key column(s) and all updated columns in the where clause.</td>
</tr>
<tr valign=top>
<td width=50%><b>dbCriteriaAllCols</b></td>
<td width=50%>Uses the key column(s) and all the columns in the where clause.</td>
</tr>
<tr valign=top>
<td width=50%><b>dbCriteriaTimeStamp</b></td>
<td width=50%>Uses just the timestamp column if available (will generate a run-time error if no timestamp column is in the result set).</td>
</tr>
<tr valign=top>
<td width=50%><b>dbCriteriaDeleteInsert</b></td>
<td width=50%>Uses a set of DELETE and INSERT statements for each modified row.</td>
</tr>
<tr valign=top>
<td width=50%><b>dbCriteriaUpdate</b></td>
<td width=50%>(Default) Uses an UPDATE statement for each modified row.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
When a batch-mode <a href="dameth04_299h.htm">Update</a> is executed, DAO and the <a href="dadefn03_9svt.htm">client batch cursor library</a> create a series of SQL UPDATE statements to make the needed changes. An SQL WHERE clause is created for each update to isolate the records that are marked as changed by the <a href="daprop08_57hv.htm">RecordStatus</a> property. Because some remote servers use triggers or other ways to enforce referential integrity, is it often important to limit the fields being updated to just those affected by the change. To do this, set the <b>UpdateOptions</b> property to one of the constants <b>dbCriteriaKey</b>, <b>dbCriteriaModValues</b>, <b>dbCriteriaAllCols</b>, or <b>dbCriteriaTimeStamp</b>. This way, only the absolute minimum amount of trigger code is executed. As a result, the update operation is executed more quickly, and with fewer potential errors.</p>
<p>
You can also concatenate either of the constants <b>dbCriteriaDeleteInsert</b> or <b>dbCriteriaUpdate</b> to determine whether to use a set of SQL DELETE and INSERT statements or an SQL UPDATE statement for each update when sending batched modifications back to the server. In the former case, two separate operations are required to update the record. In some cases, especially where the remote system implements DELETE, INSERT, and UPDATE triggers, choosing the correct <b>UpdateOptions</b> property setting can significantly impact performance.</p>
<p>
If you don't specify any constants, <b>dbCriteriaUpdate</b> and <b>dbCriteriaKey</b> will be used.</p>
<p>
Newly added records will always generate INSERT statements and deleted records will always generate DELETE statements, so this property only applies to how the cursor library updates modified records.</p>
</font></BODY>
</HTML>
