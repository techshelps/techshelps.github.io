<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NoMatch Property Example (DAO/Microsoft Jet)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="dapronomatchx"></a>NoMatch Property Example</b></p>
<p>
This example uses the <b>NoMatch</b> property to determine whether a <b>Seek</b> and a <b>FindFirst</b> were successful, and if not, to give appropriate feedback. The SeekMatch and FindMatch procedures are required for this procedure to run.</p>
<pre><code>Sub NoMatchX()

   Dim dbsNorthwind As Database
   Dim rstProducts As Recordset
   Dim rstCustomers As Recordset
   Dim strMessage As String
   Dim strSeek As String
   Dim strCountry As String
   Dim varBookmark As Variant

   Set dbsNorthwind = OpenDatabase("Northwind.mdb")
   ' Default is dbOpenTable; required if Index property will 
   ' be used.
   Set rstProducts = dbsNorthwind.OpenRecordset("Products")

   With rstProducts
      .Index = "PrimaryKey"

      Do While True
         ' Show current record information; ask user for 
         ' input.
         strMessage = "NoMatch with Seek method" &amp; vbCr &amp; _
            "Product ID: " &amp; !ProductID &amp; vbCr &amp; _
            "Product Name: " &amp; !ProductName &amp; vbCr &amp; _
            "NoMatch = " &amp; .<i>NoMatch</i> &amp; vbCr &amp; vbCr &amp; _
            "Enter a product ID."
         strSeek = InputBox(strMessage)
         If strSeek = "" Then Exit Do

         ' Call procedure that seeks for a record based on 
         ' the ID number supplied by the user.
         SeekMatch rstProducts, Val(strSeek)
      Loop

      .Close
   End With

   Set rstCustomers = dbsNorthwind.OpenRecordset( _
      "SELECT CompanyName, Country FROM Customers " &amp; _
      "ORDER BY CompanyName", dbOpenSnapshot)

   With rstCustomers

      Do While True
         ' Show current record information; ask user for 
         ' input.
         strMessage = "NoMatch with FindFirst method" &amp; _
            vbCr &amp; "Customer Name: " &amp; !CompanyName &amp; _
            vbCr &amp; "Country: " &amp; !Country &amp; vbCr &amp; _
            "NoMatch = " &amp; .<i>NoMatch</i> &amp; vbCr &amp; vbCr &amp; _
            "Enter country on which to search."
         strCountry = Trim(InputBox(strMessage))
         If strCountry = "" Then Exit Do

         ' Call procedure that finds a record based on 
         ' the country name supplied by the user.
         FindMatch rstCustomers, _
            "Country = '" &amp; strCountry &amp; "'"
      Loop

      .Close
   End With

   dbsNorthwind.Close

End Sub

Sub SeekMatch(rstTemp As Recordset, _
   intSeek As Integer)

   Dim varBookmark As Variant
   Dim strMessage As String

   With rstTemp
      ' Store current record location.
      varBookmark = .Bookmark
      .Seek "=", intSeek

      ' If Seek method fails, notify user and return to the 
      ' last current record.
      If .<i>NoMatch</i> Then
         strMessage = _
            "Not found! Returning to current record." &amp; _
            vbCr &amp; vbCr &amp; "NoMatch = " &amp; .<i>NoMatch</i>
         MsgBox strMessage
         .Bookmark = varBookmark
      End If

   End With

End Sub

Sub FindMatch(rstTemp As Recordset, _
   strFind As String)

   Dim varBookmark As Variant
   Dim strMessage As String

   With rstTemp
      ' Store current record location.
      varBookmark = .Bookmark
      .FindFirst strFind

      ' If Find method fails, notify user and return to the 
      ' last current record.
      If .<i>NoMatch</i> Then
         strMessage = _
            "Not found! Returning to current record." &amp; _
            vbCr &amp; vbCr &amp; "NoMatch = " &amp; .<i>NoMatch</i>
         MsgBox strMessage
         .Bookmark = varBookmark
      End If

   End With

End Sub</code></pre>
</font></BODY>
</HTML>
