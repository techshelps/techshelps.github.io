<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ConflictTable Property Example (DAO/Microsoft Jet)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="daproconflicttablex"></a>ConflictTable Property Example</b></p>
<p>
This example uses the <b>ConflictTable</b> property to report the table names that had conflicts during synchronization.</p>
<pre><code>Sub ConflictTableX()

   Dim dbsNorthwind As Database
   Dim tdfTest As TableDef

   Set dbsNorthwind = OpenDatabase("Northwind.mdb")

   ' Enumerate TableDefs collection and check ConflictTable
   ' property of each.
   For Each tdfTest In dbsNorthwind.TableDefs
      If tdfTest.<span class=cfe><b>ConflictTable</b></span> &lt;&gt; "" Then _
         Debug.Print tdfTest.Name &amp; " had a conflict."
   Next tdfTest

   dbsNorthwind.Close

End Sub
</code></pre>
<p>
This example opens a <b>Recordset</b> from the <a href="rpldef_8hr9.htm">conflict table</a> and one from the table that caused the conflict. It then processes the records in these tables, <b>using the RequiredDate field to copy information from one table to the other depending on which record was more recently updated.</b></p>
<pre><code>Sub ConflictTableX2(dbsResolve As Database)

   Dim tdfTest As TableDef
   Dim rstSource As Recordset
   Dim rstConflict As Recordset
   Dim fldLoop As Field

   Set tdfTest = dbsResolve.TableDefs("Orders")

   If tdfTest.<span class=cfe><b>ConflictTable</b></span> &lt;&gt; "" Then

      Set rstSource = dbsResolve.OpenRecordset( _
         tdfTest.Name, dbOpenTable)
      Set rstConflict = dbsResolve.OpenRecordset( _
         tdfTest.ConflictTable, dbOpenTable)
      rstSource.Index = "[d_Guid]"
      rstConflict.MoveFirst

      Do Until rstConflict.EOF
         rstSource.Seek "=", rstConflict![s_Guid]
         If Not rstSource.NoMatch Then
            If rstSource!RequiredDate &lt; _
                  rstConflict!RequiredDate Then
               On Error Resume Next
                  For Each fldLoop in rstConflict.Fields
                     fldLoop = rstSource(fldLoop.Name)
                  Next fldLoop
               On Error Goto 0
            End If
         End If
         rstConflict.Delete
         rstConflict.MoveNext
      Loop

      rstConflict.Close
      rstSource.Close
   End If

End Sub
</code></pre>
</font></BODY>
</HTML>
