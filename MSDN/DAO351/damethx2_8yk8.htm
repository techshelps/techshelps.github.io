<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenRecordset Method Example (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="damthopenrecordsetx"></a>OpenRecordset Method Example</b></p>
<p>
This example uses the <b>OpenRecordset</b> method to open five different <b>Recordset</b> objects and display their contents. The OpenRecordsetOutput procedure is required for this procedure to run.</p>
<pre><code>Sub OpenRecordsetX()

   Dim wrkJet As Workspace
   Dim wrkODBC As Workspace
   Dim dbsNorthwind As Database
   Dim conPubs As Connection
   Dim rstTemp As Recordset
   Dim rstTemp2 As Recordset

   ' Open Microsoft Jet and ODBCDirect workspaces, Microsoft 
   ' Jet database, and ODBCDirect connection.
   Set wrkJet = CreateWorkspace("", "admin", "", dbUseJet)
   Set wrkODBC = CreateWorkspace("", "admin", "", dbUseODBC)
   Set dbsNorthwind = wrkJet.OpenDatabase("Northwind.mdb")
   Set conPubs = wrkODBC.OpenConnection("", , , _
      "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

   ' Open five different Recordset objects and display the 
   ' contents of each.

   Debug.Print "Opening forward-only-type recordset " &amp; _
      "where the source is a QueryDef object..."
   Set rstTemp = dbsNorthwind.<span class=cfe><b>OpenRecordset</b></span>( _
      "Ten Most Expensive Products", dbOpenForwardOnly)
   OpenRecordsetOutput rstTemp

   Debug.Print "Opening read-only dynaset-type " &amp; _
      "recordset where the source is an SQL statement..."
   Set rstTemp = dbsNorthwind.<span class=cfe><b>OpenRecordset</b></span>( _
      "SELECT * FROM Employees", dbOpenDynaset, dbReadOnly)
   OpenRecordsetOutput rstTemp

   ' Use the Filter property to retrieve only certain 
   ' records with the next OpenRecordset call.
   Debug.Print "Opening recordset from existing " &amp; _
      "Recordset object to filter records..."
   rstTemp.Filter = "LastName &gt;= 'M'"
   Set rstTemp2 = rstTemp.<span class=cfe><b>OpenRecordset</b></span>()
   OpenRecordsetOutput rstTemp2

   Debug.Print "Opening dynamic-type recordset from " &amp; _
      "an ODBC connection..."
   Set rstTemp = conPubs.<span class=cfe><b>OpenRecordset</b></span>( _
      "SELECT * FROM stores", dbOpenDynamic)
   OpenRecordsetOutput rstTemp

   ' Use the StillExecuting property to determine when the 
   ' Recordset is ready for manipulation.
   Debug.Print "Opening snapshot-type recordset based " &amp; _
      "on asynchronous query to ODBC connection..."
   Set rstTemp = conPubs.<span class=cfe><b>OpenRecordset</b></span>("publishers", _
      dbOpenSnapshot, dbRunAsync)
   Do While rstTemp.StillExecuting
      Debug.Print "&nbsp; [still executing...]"
   Loop
   OpenRecordsetOutput rstTemp

   rstTemp.Close
   dbsNorthwind.Close
   conPubs.Close
   wrkJet.Close
   wrkODBC.Close

End Sub

Sub OpenRecordsetOutput(rstOutput As Recordset)

   ' Enumerate the specified Recordset object.
   With rstOutput
      Do While Not .EOF
         Debug.Print , .Fields(0), .Fields(1)
         .MoveNext
      Loop
   End With

End Sub
</code></pre>
</font></BODY>
</HTML>
