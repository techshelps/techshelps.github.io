<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CompactDatabase Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="damthcompactdatabase"></a>CompactDatabase Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthCompactDatabaseC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthCompactDatabaseX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthCompactDatabaseA">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthCompactDatabaseS">
</object> </p>
<p>
Copies and compacts a closed database, and gives you the option of changing its version, collating order, and encryption. (<a href="dadefn03_4wth.htm">Microsoft Jet workspaces</a> only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>DBEngine.CompactDatabase </b><i>olddb</i>, <i>newdb</i>, <i>locale</i>, <i>options</i>, <i>password</i></p>
<p>
The <b>CompactDatabase</b> method syntax has these parts.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=25%><b>Part</b></td>
<td class=label width=75%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=25%><i>olddb</i></td>
<td width=75%>A <a href="dadefn02_54rp.htm">String</a> that identifies an existing, closed database. It can be a full path and file name, such as <code>"C:\db1.mdb"</code>. If the file name has an extension, you must specify it. If your network supports it, you can also specify a network path, such as <code>"\\server1\share1\dir1\db1.mdb"</code>.</td>
</tr>
<tr valign=top>
<td width=25%><i>newdb</i></td>
<td width=75%>A <b>String</b> that is the file name (and path) of the compacted database that you're creating. You can also specify a network path. You can't use the <i>newdb</i> argument to specify the same database file as <i>olddb</i>.</td>
</tr>
<tr valign=top>
<td width=25%><i>locale</i></td>
<td width=75%>Optional. A <a href="dadefn02_282t.htm">Variant</a> that is a <a href="dadefn02_75pq.htm">string expression</a> that specifies a collating order for creating <i>newdb</i>, as specified in Settings. If you omit this argument, the locale of <i>newdb</i> is the same as <i>olddb</i>.</td>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%>You can also create a password for <i>newdb</i> by concatenating the password string (starting with <code>";pwd="</code>) with a constant in the <i>locale</i> argument, like this:</td>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%><code>dbLangSpanish &amp; ";pwd=NewPassword"</code></td>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%>If you want to use the same <i>locale</i> as <i>olddb</i> (the default value), but specify a new password, simply enter a password string for <i>locale</i>:</td>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%><code>";pwd=NewPassword"</code></td>
</tr>
<tr valign=top>
<td width=25%><i>options</i></td>
<td width=75%>Optional. A constant or combination of constants that indicates one or more options, as specified in Settings. You can combine options by summing the corresponding constants.</td>
</tr>
<tr valign=top>
<td width=25%><i>password</i></td>
<td width=75%>Optional. A <b>Variant</b> that is a string expression containing a password, if the database is password protected. The string <code>";pwd="</code> must precede the actual password. If you include a password setting in <i>locale</i>, this setting is ignored.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
You can use one of the following constants for the <i>locale</i> argument to specify the <a href="daprop01_0dv6.htm">CollatingOrder</a> property for string comparisons of text.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=42%><b>Constant</b></td>
<td class=label width=58%><b>Collating order</b></td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangGeneral</b></td>
<td width=58%>English, German, French, Portuguese, Italian, and Modern Spanish</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangArabic</b></td>
<td width=58%>Arabic</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangChineseSimplified</b></td>
<td width=58%>Simplified Chinese</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangChineseTraditional</b></td>
<td width=58%>Traditional Chinese</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangCyrillic</b></td>
<td width=58%>Russian</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangCzech</b></td>
<td width=58%>Czech</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangDutch</b></td>
<td width=58%>Dutch</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangGreek</b></td>
<td width=58%>Greek</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangHebrew</b></td>
<td width=58%>Hebrew</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangHungarian</b></td>
<td width=58%>Hungarian</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangIcelandic</b></td>
<td width=58%>Icelandic</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangJapanese</b></td>
<td width=58%>Japanese</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangKorean</b></td>
<td width=58%>Korean</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangNordic</b></td>
<td width=58%>Nordic languages (Microsoft Jet database engine version 1.0 only)</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangNorwDan</b></td>
<td width=58%>Norwegian and Danish</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangPolish</b></td>
<td width=58%>Polish</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangSlovenian</b></td>
<td width=58%>Slovenian</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangSpanish</b></td>
<td width=58%>Traditional Spanish</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangSwedFin</b></td>
<td width=58%>Swedish and Finnish</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangThai</b></td>
<td width=58%>Thai</td>
</tr>
<tr valign=top>
<td width=42%><b>dbLangTurkish</b></td>
<td width=58%>Turkish</td>
</tr>
</table><br>
<p>
You can use one of the following constants in the <i>options</i> argument to specify whether to encrypt or to decrypt the database while it's compacted.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=25%><b>Constant</b></td>
<td class=label width=75%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=25%><b>dbEncrypt</b></td>
<td width=75%>Encrypt the database while compacting.</td>
</tr>
<tr valign=top>
<td width=25%><b>dbDecrypt</b></td>
<td width=75%>Decrypt the database while compacting.</td>
</tr>
</table><br>
<p>
If you omit an encryption constant or if you include both <b>dbDecrypt</b> and <b>dbEncrypt</b>, <i>newdb</i> will have the same encryption as <i>olddb.</i></p>
<p>
You can use one of the following constants in the <i>options</i> argument to specify the version of the data format for the compacted database. This constant affects only the version of the data format of <i>newdb</i> and doesn't affect the version of any Microsoft Access-defined objects, such as forms and reports.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=25%><b>Constant</b></td>
<td class=label width=75%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=25%><b>dbVersion10</b></td>
<td width=75%>Creates a database that uses the <a href="dadefn01_29k5.htm">Microsoft Jet database engine</a> version 1.0 file format while compacting.</td>
</tr>
<tr valign=top>
<td width=25%><b>dbVersion11</b></td>
<td width=75%>Creates a database that uses the Microsoft Jet database engine version 1.1 file format while compacting.</td>
</tr>
<tr valign=top>
<td width=25%><b>dbVersion20</b></td>
<td width=75%>Creates a database that uses the Microsoft Jet database engine version 2.0 file format while compacting.</td>
</tr>
<tr valign=top>
<td width=25%><b>dbVersion30</b></td>
<td width=75%>Creates a database that uses the Microsoft Jet database engine version 3.0 file format (compatible with version 3.5) while compacting.</td>
</tr>
</table><br>
<p>
You can specify only one version constant. If you omit a version constant, <i>newdb</i> will have the same version as <i>olddb</i>. You can compact <i>newdb</i> only to a version that is the same or later than that of <i>olddb</i>.</p>
<p class=label>
<b>Remarks</b></p>
<p>
As you change data in a database, the database file can become fragmented and use more disk space than is necessary. Periodically, you can use the <b>CompactDatabase</b> method to compact your database to defragment the database file. The compacted database is usually smaller and often runs faster. You can also change the collating order, the encryption, or the version of the data format while you copy and compact the database.</p>
<p>
You must close <i>olddb</i> before you compact it. In a multiuser environment, other users can't have <i>olddb</i> open while you're compacting it. If <i>olddb</i> isn't closed or isn't available for <a href="dadefn01_2kth.htm">exclusive</a> use, an error occurs.</p>
<p>
Because <b>CompactDatabase</b> creates a copy of the database, you must have enough disk space for both the original and the duplicate databases. The compact operation fails if there isn't enough disk space available. The <i>newdb</i> duplicate database doesn't have to be on the same disk as <i>olddb</i>. After successfully compacting a database, you can delete the <i>olddb</i> file and rename the compacted <i>newdb</i> file to the original file name.</p>
<p>
The <b>CompactDatabase</b> method copies all the data and the security <a href="dadefn02_08mm.htm">permission</a> settings from the database specified by <i>olddb</i> to the database specified by <i>newdb</i>.</p>
<p>
If you use <b>CompactDatabase</b> to convert a version 1.<i>x</i> database to version 2.5 or 3.<i>x</i>, only applications using version Microsoft Jet 2.5 or 3.<i>x</i> can open the converted database.</p>
<p class=indent>
<B><b>Note</b></B> In an <a href="dadefn03_6izp.htm">ODBCDirect workspace</a>, using the <b>CompactDatabase</b> method doesn't return an error, but instead loads the Microsoft Jet database engine into memory.</p>
<p class=indent>
<B><b>Caution</b></B> Because the <b>CompactDatabase</b> method doesn't convert Microsoft Access objects, you shouldn't use <b>CompactDatabase</b> to convert a database containing such objects. To convert a database containing Microsoft Access objects, on the <b>Tools</b> menu, point to <b>Database Utilities</b>, and then click <b>Convert Database</b>.</p>
</font></BODY>
</HTML>
