<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset Object, Recordsets Collection Example (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="daobjrecordsetx"></a>Recordset Object, Recordsets Collection Example</b></p>
<p>
This example demonstrates <b>Recordset</b> objects and the <b>Recordsets</b> collection by opening four different types of <b>Recordsets</b>, enumerating the <b>Recordsets</b> collection of the current <b>Database</b>, and enumerating the <b>Properties</b> collection of each <b>Recordset</b>.</p>
<pre><code>Sub RecordsetX()

   Dim dbsNorthwind As Database
   Dim rstTable As Recordset
   Dim rstDynaset As Recordset
   Dim rstSnapshot As Recordset
   Dim rstForwardOnly As Recordset
   Dim rstLoop As Recordset
   Dim prpLoop As Property

   Set dbsNorthwind = OpenDatabase("Northwind.mdb")

   With dbsNorthwind

      ' Open one of each type of Recordset object.
      Set rstTable = .OpenRecordset("Categories", _
         dbOpenTable)
      Set rstDynaset = .OpenRecordset("Employees", _
         dbOpenDynaset)
      Set rstSnapshot = .OpenRecordset("Shippers", _
         dbOpenSnapshot)
      Set rstForwardOnly = .OpenRecordset _ 
         ("Employees", dbOpenForwardOnly)

      Debug.Print "Recordsets in Recordsets " &amp; _
         "collection of dbsNorthwind"

      ' Enumerate Recordsets collection.
      For Each rstLoop In .Recordsets

         With rstLoop
            Debug.Print "&nbsp; " &amp; .Name

            ' Enumerate Properties collection of each
            ' Recordset object. Trap for any 
            ' properties whose values are invalid in 
            ' this context.
            For Each prpLoop In .Properties
               On Error Resume Next
               If prpLoop &lt;&gt; "" Then Debug.Print _
                  "&nbsp;&nbsp;&nbsp; " &amp; prpLoop.Name &amp; _
                  " = " &amp; prpLoop
               On Error GoTo 0
            Next prpLoop

         End With

      Next rstLoop

      rstTable.Close
      rstDynaset.Close
      rstSnapshot.Close
      rstForwardOnly.Close

      .Close
   End With

End Sub</code></pre>
</font></BODY>
</HTML>
