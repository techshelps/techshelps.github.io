<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Execute Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="damthexecute"></a>Execute Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthExecuteC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthExecuteX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthExecuteA">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="damthExecuteS">
</object> </p>
<p>
Runs an <a href="dadefn01_72pl.htm">action query</a> or executes an <a href="dadefn02_5gj8.htm">SQL statement</a> on a specified <a href="dadobj05_8xbi.htm">Connection</a> or <a href="dadobj01_1gh1.htm">Database</a> object.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>.Execute source</b>,<b> options</b></p>
<p>
<i>querydef</i><b>.Execute options</b></p>
<p>
The <b>Execute</b> method syntax has these parts.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=25%><b>Part</b></td>
<td class=label width=75%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=25%><i>object</i></td>
<td width=75%>A <b>Connection</b> or <b>Database</b> object variable on which the query will run.</td>
</tr>
<tr valign=top>
<td width=25%><i>querydef</i></td>
<td width=75%>An object variable that represents the <a href="dadobj03_3t0m.htm">QueryDef</a> object whose <a href="daprop04_2zho.htm">SQL</a> property setting specifies the SQL statement to execute.</td>
</tr>
<tr valign=top>
<td width=25%><b>source</b></td>
<td width=75%>A <a href="dadefn02_54rp.htm">String</a> that is an SQL statement or the <a href="daprop03_1llx.htm">Name</a> property value of a <b>QueryDef</b> object.</td>
</tr>
<tr valign=top>
<td width=25%><b>options</b></td>
<td width=75%>Optional. A constant or combination of constants that determines the data integrity characteristics of the query, as specified in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
You can use the following constants for <i>options</i>.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=34%><b>Constant</b></td>
<td class=label width=66%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=34%><b>dbDenyWrite</b></td>
<td width=66%>Denies write permission to other users (<a href="dadefn03_4wth.htm">Microsoft Jet workspaces</a> only).</td>
</tr>
<tr valign=top>
<td width=34%><b>dbInconsistent</b></td>
<td width=66%>(Default) Executes <a href="dadefn01_9ng4.htm">inconsistent</a> updates (Microsoft Jet workspaces only).</td>
</tr>
<tr valign=top>
<td width=34%><b>dbConsistent</b></td>
<td width=66%>Executes <a href="dadefn01_1n1w.htm">consistent</a> updates (Microsoft Jet workspaces only).</td>
</tr>
<tr valign=top>
<td width=34%><b>dbSQLPassThrough</b></td>
<td width=66%>Executes an SQL pass-through query. Setting this option passes the SQL statement to an <a href="dadefn02_6eoz.htm">ODBC</a> database for processing (Microsoft Jet workspaces only).</td>
</tr>
<tr valign=top>
<td width=34%><b>dbFailOnError</b></td>
<td width=66%>Rolls back updates if an error occurs (Microsoft Jet workspaces only).</td>
</tr>
<tr valign=top>
<td width=34%><b>dbSeeChanges</b></td>
<td width=66%>Generates a run-time error if another user is changing data you are editing (Microsoft Jet workspaces only).</td>
</tr>
<tr valign=top>
<td width=34%><b>dbRunAsync</b></td>
<td width=66%>Executes the query <a href="dadefn03_3x15.htm">asynchronously</a> (<a href="dadefn03_0ek4.htm">ODBCDirect</a> <b>Connection</b> and <b>QueryDef</b> objects only).</td>
</tr>
<tr valign=top>
<td width=34%><b>dbExecDirect</b></td>
<td width=66%>Executes the statement without first calling <b>SQLPrepare</b> ODBC API function (ODBCDirect <b>Connection</b> and <b>QueryDef</b> objects only).</td>
</tr>
</table><br>
<p class=indent>
<B><b>Note</b></B> The constants <b>dbConsistent</b> and <b>dbInconsistent</b> are mutually exclusive. You can use one or the other, but not both in a given instance of <b>OpenRecordset</b>. Using both <b>dbConsistent</b> and <b>dbInconsistent</b> causes an error.</p>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>Execute</b> method is valid only for action queries. If you use <b>Execute</b> with another type of query, an error occurs. Because an action query doesn't return any records, <b>Execute</b> doesn't return a <a href="dadobj03_0tdg.htm">Recordset</a>. (Executing an SQL pass-through query in an ODBCDirect workspace will not return an error if a <b>Recordset</b> isn't returned.)</p>
<p>
Use the <a href="daprop03_6td0.htm">RecordsAffected</a> property of the <b>Connection</b>, <b>Database</b>, or <b>QueryDef</b> object to determine the number of records affected by the most recent <b>Execute</b> method. For example, <b>RecordsAffected</b> contains the number of records deleted, updated, or inserted when executing an action query. When you use the <b>Execute</b> method to run a query, the <b>RecordsAffected</b> property of the <b>QueryDef</b> object is set to the number of records affected.</p>
<p>
In a Microsoft Jet workspace, if you provide a syntactically correct SQL statement and have the appropriate permissions, the <b>Execute</b> method won't fail — even if not a single row can be modified or deleted. Therefore, always use the <b>dbFailOnError</b> option when using the <b>Execute</b> method to run an update or delete query. This option generates a run-time error and rolls back all successful changes if any of the records affected are locked and can't be updated or deleted.</p>
<p>
In earlier versions of the Microsoft Jet Database Engine, SQL statements were automatically embedded in implicit transactions. If part of a statement executed with <b>dbFailOnError</b> failed, the entire statement would be rolled back. To improve performance, these implicit transactions were removed starting with version 3.5. If you are updating older DAO code, be sure to consider using explicit transactions around <b>Execute</b> statements.</p>
<p>
For best performance in a Microsoft Jet workspace, especially in a multiuser environment, nest the <b>Execute</b> method inside a <a href="dadefn02_9rfy.htm">transaction</a>. Use the <a href="dameth01_27eb.htm">BeginTrans</a> method on the current <a href="dadobj04_4xet.htm">Workspace</a> object, then use the <b>Execute</b> method, and complete the transaction by using the <a href="dameth01_27eb.htm">CommitTrans</a> method on the <b>Workspace</b>. This saves changes on disk and frees any locks placed while the query is running.</p>
<p>
In an <a href="dadefn03_6izp.htm">ODBCDirect workspace</a>, if you include the optional <b>dbRunAsync</b> constant, the query runs asynchronously. To determine whether an asynchronous query is still executing, check the value of the <a href="daprop08_686f.htm">StillExecuting</a> property on the object from which the <b>Execute</b> method was called. To terminate execution of an asynchronous <b>Execute</b> method call, use the <a href="dameth05_2fxo.htm">Cancel</a> method.</p>
</font></BODY>
</HTML>
