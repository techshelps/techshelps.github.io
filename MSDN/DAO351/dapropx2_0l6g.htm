<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connect and SourceTableName Properties Example (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="daprosourcetablenamex"></a>Connect and SourceTableName Properties Example</b></p>
<p>
This example uses the <b>Connect</b> and <b>SourceTableName</b> properties to link various external tables to a Microsoft Jet database. The ConnectOutput procedure is required for this procedure to run.</p>
<pre><code>Sub ConnectX()

   Dim dbsTemp As Database
   Dim strMenu As String
   Dim strInput As String

   ' Open a Microsoft Jet database to which you will link
   ' a table.
   Set dbsTemp = OpenDatabase("DB1.mdb")

   ' Build menu text.
   strMenu = "Enter number for data source:" &amp; vbCr
   strMenu = strMenu &amp; _
      " 1. Microsoft Jet database" &amp; vbCr
   strMenu = strMenu &amp; _
      " 2. Microsoft FoxPro 3.0 table" &amp; vbCr
   strMenu = strMenu &amp; _
      " 3. dBASE table" &amp; vbCr
   strMenu = strMenu &amp; _
      " 4. Paradox table" &amp; vbCr
   strMenu = strMenu &amp; _
      " M. (see choices 5-9)"

   ' Get user's choice.
   strInput = InputBox(strMenu)

   If UCase(strInput) = "M" Then

      ' Build menu text.
      strMenu = "Enter number for data source:" &amp; vbCr
      strMenu = strMenu &amp; _
         " 5. Microsoft Excel spreadsheet" &amp; vbCr
      strMenu = strMenu &amp; _
         " 6. Lotus spreadsheet" &amp; vbCr
      strMenu = strMenu &amp; _
         " 7. Comma-delimited text (CSV)" &amp; vbCr
      strMenu = strMenu &amp; _
         " 8. HTML table" &amp; vbCr
      strMenu = strMenu &amp; _
         " 9. Microsoft Exchange folder"

      ' Get user's choice.
      strInput = InputBox(strMenu)

   End If

   ' Call the ConnectOutput procedure. The third argument
   ' will be used as the Connect string, and the fourth
   ' argument will be used as the SourceTableName.
   Select Case Val(strInput)
      Case 1
         ConnectOutput dbsTemp, _
            "JetTable", _
            ";DATABASE=C:\My Documents\Northwind.mdb", _
            "Employees"
      Case 2
         ConnectOutput dbsTemp, _
            "FoxProTable", _
            "FoxPro 3.0;DATABASE=C:\FoxPro30\Samples", _
            "Q1Sales"
      Case 3
         ConnectOutput dbsTemp, _
            "dBASETable", _
            "dBase IV;DATABASE=C:\dBASE\Samples", _
            "Accounts"
      Case 4
         ConnectOutput dbsTemp, _
            "ParadoxTable", _
            "Paradox 3.X;DATABASE=C:\Paradox\Samples", _
            "Accounts"
      Case 5
         ConnectOutput dbsTemp, _
            "ExcelTable", _
            "Excel 5.0;" &amp; _
               "DATABASE=C:\Excel\Samples\Q1Sales.xls", _
            "January Sales"
      Case 6
         ConnectOutput dbsTemp, _
            "LotusTable", _
            "Lotus WK3;" &amp; _
               "DATABASE=C:\Lotus\Samples\Sales.xls", _
            "THIRDQTR"
      Case 7
         ConnectOutput dbsTemp, _
            "CSVTable", _
            "Text;DATABASE=C:\Samples", _
            "Sample.txt"
      Case 8
         ConnectOutput dbsTemp, _
            "HTMLTable", _
            "HTML Import;DATABASE=http://" &amp; _
               "www.server1.com/samples/page1.html", _
            "Q1SalesData"
      Case 9
         ConnectOutput dbsTemp, _
            "ExchangeTable", _
            "Exchange 4.0;MAPILEVEL=" &amp; _
               "Mailbox - Michelle Wortman (Exchange)" &amp; _
               "|People\Important;", _
            "Jerry Wheeler"
   End Select

   dbsTemp.Close

End Sub

Sub ConnectOutput(dbsTemp As Database, _
   strTable As String, strConnect As String, _
   strSourceTable As String)

   Dim tdfLinked As TableDef
   Dim rstLinked As Recordset
   Dim intTemp As Integer

   ' Create a new TableDef, set its Connect and
   ' SourceTableName properties based on the passed
   ' arguments, and append it to the TableDefs collection.
   Set tdfLinked = dbsTemp.CreateTableDef(strTable)

   tdfLinked.<span class=cfe><b>Connect</b></span> = strConnect
   tdfLinked.<span class=cfe><b>SourceTableName</b></span> = strSourceTable
   dbsTemp.TableDefs.Append tdfLinked

   Set rstLinked = dbsTemp.OpenRecordset(strTable)

   Debug.Print "Data from linked table:"

   ' Display the first three records of the linked table.
   intTemp = 1
   With rstLinked
      Do While Not .EOF And intTemp &lt;= 3
         Debug.Print , .Fields(0), .Fields(1)
         intTemp = intTemp + 1
         .MoveNext
      Loop
      If Not .EOF Then Debug.Print , "[additional records]"
      .Close
   End With

   ' Delete the linked table because this is a demonstration.
   dbsTemp.TableDefs.Delete strTable

End Sub
</code></pre>
</font></BODY>
</HTML>
