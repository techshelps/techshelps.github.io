<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MakeSignature</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_makesignature"></a>MakeSignature</h1>
<p>
The <b>MakeSignature</b> function generates a cryptographic checksum of the message, and also includes sequencing information to prevent message loss or insertion. <b>MakeSignature</b> allows the application to choose between several cryptographic algorithms, if supported by the chosen mechanism. The <b>MakeSignature</b> function uses the security context referenced by the context handle.</p>
<pre><code><b>SECURITY_STATUS MakeSignature(
  PCtxtHandle</b><i> phContext</i><b>,  </b>// context to use
<b>  ULONG</b><i> fQOP</i><b>,             </b>// quality of protection
<b>  PSecBufferDesc</b><i> pMessage</i><b>,  </b>// message to sign
<b>  ULONG</b><i> MessageSeqNo      </i>// message sequence number
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>phContext</i></dt>
<dd>
Handle to the context to use for the message.</dd>
<dt>
<i>fQOP</i></dt>
<dd>
Specifies package-specific flags that indicate the quality of protection. A security package can use this parameter to enable the selection of cryptographic algorithms. </dd>
<dt>
<i>pMessage</i></dt>
<dd>
Pointer to a <b>SecBufferDesc</b> structure. On input, the structure references one or more <b>SecBuffer</b> structures that contain the message to be signed. The function does not process buffers with the SECBUFFER_READONLY attribute.
<p>
The <b>SecBufferDesc</b> structure also references a <b>SecBuffer</b> structure of type SECBUFFER_TOKEN that receives the signature. 
</dd>
<dt>
<i>MessageSeqNo</i></dt>
<dd>
Specifies a sequence number that the transport application assigned to the message. If the transport application does not maintain sequence numbers, this parameter is zero.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is SEC_E_OK.</p>
<p>
If the function fails, the return value is a nonzero error code.</p>
<h4>Remarks</h4>
<p>
The <b>MakeSignature</b> function generates a signature that is based on the message and the session key for the context. </p>
<p>
If the transport application created the security context to support sequence detection and the caller provides a sequence number, the function includes this information in the signature. This protects against reply, insertion, and suppression of messages. The security package will incorporate the sequence number passed down from the transport application.</p>
<h4>See Also</h4>
<p>
<a href="issp_0t45.htm"><b>VerifySignature</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
