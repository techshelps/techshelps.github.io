<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetDPB_GetSetRootDirClus (FAT32)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="funcs_0000000101002000"></a>SetDPB_GetSetRootDirClus (FAT32) </h1>
<p>
[Windows 95 only.]</p>
<p>
Allows the first cluster of the root directory of a FAT32 drive to be read and changed. This call is invalid on FAT12 and FAT16 drives. </p>
<p>
This sub-function is called when the SetDPB_Function field of the <a href="fat32_6uk0.htm">SDPDFormatStruc (FAT32)</a> structure is set to 4. </p>
<h4>Parameters</h4>
<dl>
<dt>
<i>SetDPB_Value1</i> </dt>
<dd>
This field in the SPDPFormatStruc specifies the SET behavior. If the value is 0xFFFFFFFF, then no changes are made and the current root directory first cluster number is returned in SetDPB_Value2. 
<p>
The value is range checked. It must be &gt;=2 and &lt;= the maximum valid cluster number for the drive. 
</dd>
<dt>
<i>SetDPB_Value2</i> </dt>
<dd>
This field in the SPDPFormatStruc is used as a return field where the previous root directory first cluster is held. When SetDPB_Value1 is 0xFFFFFFFF, the previous cluster is also the current root directory cluster. </dd>
</dl>
<h4>Return Values</h4>
<p>
If the function is unsuccessful, the function sets the carry flag and returns ERROR_GEN_FAILURE (error code 31) to AX. Receiving ERROR_GEN_FAILURE as the return value indicates that a disk error occurred during the attempt to write. In this case, the DPB mirror property is changed, but not properly written to disk. If the function fails, it is recommended that the caller re-write the value returned to SetDBP_Value2 to attempt to undo the change. </p>
<h4>Remarks</h4>
<p>
Since the start cluster of the root directory is also stored in the BPB of the boot sector(s) of the drive, this call re-writes these boot sectors as a side effect. </p>
<p>
Note that the device driver may also contain these values as part of its current device parameters. This call will have no effect on the FAT Mirror properties held by the device driver. Because of this, it is recommended to immediately follow the set form of the call with a SetDeviceParameters Generic IOCTL call. This sets the current BPB that the BuildBPB routine of the device returns. </p>
<p>
The assembler calling sequence for all Int 21h 7304h sub-functions is almost identical. See the main listing for a sample. (<a href="fat32_719s.htm">Int 21h Function 7304h Set_DPBForFormat (FAT32)</a>) </p>
<p>&nbsp;</p></body>
</HTML>
