<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Int 21h Function 6Ch (FAT32)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="funcs_0000000101001800"></a>Int 21h Function 6Ch (FAT32) </h1>
<p>
[Windows 95 only.]</p>
<p>
Opens or creates a file that has the given name and attributes. </p>
<pre><code>mov ah, 6Ch             ; Extended Open/Create
mov bx, ModeAndFlags    ; See below
mov cx, Attributes      ; See below
mov dx, Action          ; See below
mov si, seg Filename    ; See below
mov ds, si
mov si, offset Filename
int 21h

jc error_handler        ; Carry set means error

mov [Handle], ax        ; file handle
mov [ActionTaken], cx   ; action taken to open file
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ModeAndFlags</i> </dt>
<dd>
A combination of access mode, sharing mode, and open flags. This parameter can be a combination of one value from the access and sharing modes and any combination of open flags: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Access mode</th>
<th align=left width=68%>Meaning </th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_READONLY (0000h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file for reading only. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_WRITEONLY (0001h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file for writing only. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_READWRITE (0002h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file for reading and writing. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>0003h </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Reserved; do not use. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_RO_NOMODLASTACCESS (0004h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file for reading only without modifying the file's last access date. </td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Sharing mode</th>
<td width=68%>Meaning </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_COMPATIBLE (0000h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file in compatibility mode, allowing any process on a given computer to open the file any number of times. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYREADWRITE (0010h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file and denies both read and write access to other processes. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYWRITE (0020h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file and denies write access to other processes. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYREAD (0030h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file and denies read access to other processes. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYNONE (0040h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Opens the file without denying read or write access to other processes, but no process may open the file in compatibility mode. </td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Open flags </th>
<th align=left width=68%>Meaning </th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NOINHERIT (0080h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>Child processes created with Load and Execute Program (Interrupt 21h Function 4B00h) do not inherit the file handle. If the handle is needed by a child process, the parent process must pass the handle value to the child process. If this flag is not set, child processes inherit the file handle. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>EXTENDED_SIZE (1000h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>The file is opened in extended mode. This allows access to files up to 4GB minus 2 bytes. Access includes open and create functions. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NOCRITERR (2000h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>If a critical error occurs while MS-DOS is opening this file, Critical-Error Handler (Interrupt 24h) is not called. Instead, MS-DOS simply returns an error value to the program. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>   OPEN_FLAGS_COMMIT (4000h) </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%>After each write operation, MS-DOS commits the file (flushes the contents of the cache buffer to disk). </td>
</tr>
</table><br>

</dd>
<dt>
<i>Attributes</i> </dt>
<dd>
Attributes for files that are created or truncated. This parameter may be a combination of these values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td colspan=2 width=100%>FILE_ATTRIBUTE_NORMAL (0000h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The file can be read from or written to. This value is valid only if used alone. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FILE_ATTRIBUTE_READONLY (0001h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The file can be read from, but not written to. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FILE_ATTRIBUTE_HIDDEN (0002h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The file is hidden and does not appear in an ordinary directory listing. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FILE_ATTRIBUTE_SYSTEM (0004h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The file is part of the operating system or is used exclusively by it. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FILE_ATTRIBUTE_VOLUME (0008h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The name specified by Filename is used as the volume label for the current medium. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FILE_ATTRIBUTE_ARCHIVE (0020h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The file is an archive file. Applications use this value to mark files for backup or removal. </td>
</tr>
</table><br>

</dd>
<dt>
<i>Action</i> </dt>
<dd>
Action to take it the file exists or does not exist. This parameter can be a limited combination of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td colspan=2 width=100%>FILE_CREATE (0010h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>Creates a new file if it does not already exist or fails if the file already exists. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FILE_OPEN (0001h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>Opens the file. The function fails if the file does not exist. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FILE_TRUNCATE (0002h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>Opens the file and truncates it to zero length (replaces the existing file). The function fails if the file does not exist. </td>
</tr>
</table><br>


<p>
Note that valid combinations of the above values are limited to FILE_CREATE combined with FILE_OPEN or FILE_CREATE combined with FILE_TRUNCATE. 
</dd>
<dt>
<i>Filename</i> </dt>
<dd>
Address of a null-terminated string specifying the name of the file to be opened or created. The name must be in the standard MS-DOS 8.3 filename format. The string must be a valid path for the volume associated with the given drive. </dd>
</dl>
<h4>Return Values</h4>
<p>
If the function is successful, clears the carry flag, copies the file handle to the AX register, and sets CX to one of the following values. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=10%></td>
<td width=90%>ACTION_OPENED (0001h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>ACTION_CREATED_OPENED (0002h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>ACTION_REPLACED_OPENED (0003h) </td>
</tr>
</table><br>
<p>
Otherwise, sets the carry flag and sets the AX register to one of the following error values. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=10%></td>
<td width=90%>ERROR_INVALID_FUNCTION (0001h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>ERROR_FILE_NOT_FOUND (0002h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>ERROR_PATH_NOT_FOUND (0003h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>ERROR_TOO_MANY_OPEN_FILES (0004h) </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>ERROR_ACCESS_DENIED (0005h) </td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
This function does not support long filenames. If the specified name is too long, this function truncates the name to the standard 8.3 format following the same naming scheme that the system uses when creating an alias for a long filename. </p>
<p>
A file on a remote directory-that is, a directory on the network-cannot be opened, unless appropriate permissions for the directory exist. </p>
<p>&nbsp;</p></body>
</HTML>
