<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Int 21h Function 440Dh Minor Code 71h (FAT32)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="funcs_0000000101001700"></a>Int 21h Function 440Dh Minor Code 71h (FAT32) </h1>
<p>
[Windows 95 only.]</p>
<p>
Retrieves the first cluster of the specified file or directory. This function is only supported by Windows 95. It will fail if called under MS-DOS. To call this function, the caller must hold a level 3 lock on the drive. </p>
<pre><code>mov ax, 440Dh            ; Generic IOCTL
mov bx, CharSet          ; See below
mov ch, DeviceCat        ; See below
mov cl, 71h              ; Get first cluster
mov dx, seg PathName     ; See below  
mov ds, dx
mov dx, offset PathName  
int 21h

jc error_handler         ; Carry set means error
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>CharSet</i> </dt>
<dd>
The character set of PathName. This parameter must be one of these values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>BCS_WANSI (0) </td>
<td width=57%>Windows ANSI character set </td>
</tr>
<tr valign=top>
<td width=43%>BCS_OEM (1) </td>
<td width=57%>Current OEM character set </td>
</tr>
<tr valign=top>
<td width=43%>BCS_UNICODE (2) </td>
<td width=57%>Unicode character set </td>
</tr>
</table><br>

</dd>
<dt>
<i>DeviceCat</i> </dt>
<dd>
Specifies a FAT16, FAT12 or FAT32 drive. 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>08h </td>
<td width=57%>FAT32, FAT16, or FAT12 drive. </td>
</tr>
<tr valign=top>
<td width=43%>48h </td>
<td width=57%>FAT32, FAT16, or FAT12 drive. This value is supported on Windows 95 OEM Service Release 2 and later. </td>
</tr>
</table><br>


<p>
<b>Note:</b> Because this call may be implemented in the device driver, the 48h form of this call may fail on FAT16 or FAT12 media. Therefore, applications making the 48h form of this call must fall back on the 08h form if the 48h call fails. 
</dd>
<dt>
<i>PathName</i> </dt>
<dd>
Address of a null-terminated string containing the path of the file or directory to retrieve the first cluster for. </dd>
</dl>
<h4>Return Values</h4>
<p>
If the function is successful, clears the carry flag and sets DX:AX to the first cluster number. Otherwise, sets the carry flag and returns either the ERROR_INVALID_FUNCTION or ERROR_ACCESS_DENIED value in AX. </p>
<h4>Remarks</h4>
<p>
The first cluster of a file is the first cluster of the FAT cluster chain describing the data associated with the file. The first cluster of a directory is the first cluster of the FAT cluster chain associated with the directory. The first cluster is the cluster that contains the "." and ".." entries. The Get First Cluster function finds any file or directory regardless of attribute (system, hidden, or read-only). It does not find volume labels. </p>
<p>
It is the calling application's responsibility to check to see if the returned cluster number is valid. The following code fragment checks for a valid cluster number and sets a flag accordingly. Note that the maxClus variable is a DWORD that represents the maximum legal cluster number computed from the drive parameters. </p>
<pre><code>if((MAKELONG(regAX,regDX) &lt; 2L) || (MAKELONG(regAX,regDX) &gt; maxClus))
    bInvalidNum = TRUE;
else
    bInvalidNum = FALSE;
</code></pre>
<p>&nbsp;</p></body>
</HTML>
