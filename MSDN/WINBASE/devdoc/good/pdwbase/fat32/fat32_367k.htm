<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Int 21h Function 440Dh Minor Code 70h (FAT32)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="funcs_0000000101001600"></a>Int 21h Function 440Dh Minor Code 70h (FAT32) </h1>
<p>
[Windows 95 only.]</p>
<p>
Retrieves the current lock level and permissions on the specified drive. </p>
<pre><code>mov ax, 440Dh        ; generic IOCTL
mov bl, DriveNum     ; see below
mov ch, DeviceCat    ; see below
mov cl, 70h          ; Get Current Lock State
int 21h
 
jc error_handler
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>DriveNum</i> </dt>
<dd>
Drive to retrieve lock information about. This parameter can be 0 for the default drive, 1 for A, 2 for B, and so on. </dd>
<dt>
<i>DeviceCat</i> </dt>
<dd>
Specifies a FAT16, FAT12 or FAT32 drive. 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=43%>08h </td>
<td width=57%>FAT32, FAT16, or FAT12 drive. </td>
</tr>
<tr valign=top>
<td width=43%>48h </td>
<td width=57%>FAT32, FAT16, or FAT12 drive. This value is supported on Windows 95 OEM Service Release 2 and later. </td>
</tr>
</table><br>


<p>
<b>Note:</b> Because this call may be implemented in the device driver, the 48h form of this call may fail on FAT16 or FAT12 media. Therefore, applications making the 48h form of this call must fall back on the 08h form if the 48h call fails. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Clears the carry flag and sets the AX and CX registers to these values if successful: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=10%>AX </td>
<td width=90%>Current lock level. It may be either 0, 1, 2 or 3. If the volume is not locked, AX contains - 1 </td>
</tr>
<tr valign=top>
<td width=10%>CX </td>
<td width=90%>Lock permissions. The bits have the following form: </td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=11%>Bit </th>
<th align=left width=89%>Meaning </th>
</tr>
<tr valign=top>
<td width=11%>0 </td>
<td width=89%>0 = Write operations are failed. </td>
</tr>
<tr valign=top>
<td width=11%>0 </td>
<td width=89%>1 = Write operations are allowed, unless they are blocked by the lock level. </td>
</tr>
<tr valign=top>
<td width=11%>1 </td>
<td width=89%>0 = New file mapping are allowed, unless they are blocked by the lock level. </td>
</tr>
<tr valign=top>
<td width=11%>1 </td>
<td width=89%>1 = New file mapping are failed. </td>
</tr>
<tr valign=top>
<td width=11%>2 </td>
<td width=89%>1 = The volume is locked for formatting. </td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=10%></td>
<td width=90%></td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The lock level and the permissions determine the kind of access processes other than the lock owner have to the volume while it is locked. The following operations are allowed by processes other than lock owner at each lock level: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Level </th>
<th align=left width=59%>Operations </th>
</tr>
<tr valign=top>
<td width=41%>0 </td>
<td width=59%>Read operations, write operations, and new file mappings are failed. </td>
</tr>
<tr valign=top>
<td width=41%>1 </td>
<td width=59%>Read operations are allowed. Write operations and new file mappings are either allowed or failed based on permissions. </td>
</tr>
<tr valign=top>
<td width=41%>2 </td>
<td width=59%>Read operations are allowed. Write operations and new file mappings are either failed or blocked based on permissions. </td>
</tr>
<tr valign=top>
<td width=41%>3 </td>
<td width=59%>Read operations are blocked. Write operations and new file mappings are either failed or blocked based on permissions. </td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
