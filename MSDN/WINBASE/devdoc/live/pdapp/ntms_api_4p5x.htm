<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetNtmsMediaComplete</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_setntmsmediacomplete"></a>SetNtmsMediaComplete</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>SetNtmsMediaComplete</b> function marks a piece of logical media as complete. </p>
<pre><code><b>DWORD WINAPI SetNtmsMediaComplete(
</b>  <b>HANDLE</b> <i>hSession</i><b>,</b> 
  <b>LPNTMS_GUID</b> <i>lpMediaId</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSession</i></dt>
<dd>
Handle to the session returned by the <a href="ntms_api_3kq6.htm"><b>OpenNtmsSession</b></a> function.</dd>
<dt>
<i>lpMediaId</i></dt>
<dd>
Specifies the unique identifier of a piece of logical media.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_ACCESS_DENIED</dt>
<dd>
NTMS_MODIFY_ACCESS to either media's media pool is denied Other security errors are also possible, but they would indicate a security subsystem error.</dd>
<dt>
ERROR_DATABASE_FAILURE</dt>
<dd>
The database is inaccessible or damaged.</dd>
<dt>
ERROR_DATABASE_FULL</dt>
<dd>
The database is full.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
The session handle is invalid or missing.</dd>
<dt>
ERROR_INVALID_MEDIA</dt>
<dd>
The media identifier is invalid.</dd>
<dt>
ERROR_INVALID_MEDIA_POOL</dt>
<dd>
The media pool for the media is invalid.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
The media identifier is missing.</dd>
<dt>
ERROR_INVALID_STATE</dt>
<dd>
The media is not in the allocated state or is currently mounted.</dd>
<dt>
ERROR_NOT_ENOUGH_MEMORY</dt>
<dd>
An allocation failure occurred during processing.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function was successful.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>SetNtmsMediaComplete</b> function marks the specified medium as Complete. An application marks the medium as Complete when the application is no longer going to write to the medium. Complete media cannot be mounted with the NTMS_MOUNT_WRITE flag. For many applications, the date and time when the medium is marked Complete indicates which media can be safely removed from a library.</p>
<p>
The <b>SetNtmsMediaComplete</b> function is typically used when an application reaches the end of media. Media that is mounted or in use cannot be marked as complete.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ntmsapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use ntmsapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntms_api_5nz9.htm#_zaw_media_services_functions">Media Services Functions</a>, <a href="ntms_api_11k1.htm"><b>MountNtmsMedia</b></a></p>
<p>&nbsp;</p></body>
</HTML>
