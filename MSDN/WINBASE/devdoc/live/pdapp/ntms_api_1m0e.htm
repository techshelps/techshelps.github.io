<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NTMS_LIBRARYINFORMATION</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_ntms_libraryinformation"></a>NTMS_LIBRARYINFORMATION</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>NTMS_LIBRARYINFORMATION</b> data structure defines properties specific to a library object.</p>
<pre><code>typedef struct _NTMS_LIBRARYINFORMATION {
    DWORD      LibraryType;
    NTMS_GUID  CleanerSlot;
    NTMS_GUID  CleanerSlotDefault;
    BOOL       LibrarySupportsDriveCleaning;
    BOOL       BarCodeReaderInstalled;
    DWORD      InventoryMethod;
    DWORD      dwCleanerUsesRemaining;
    DWORD      FirstDriveNumber;
    DWORD      dwNumberOfDrives;
    DWORD      FirstSlotNumber;
    DWORD      dwNumberOfSlots;
    DWORD      FirstDoorNumber;
    DWORD      dwNumberOfDoors;
    DWORD      FirstPortNumber;
    DWORD      dwNumberOfPorts;
    DWORD      FirstChangerNumber;
    DWORD      dwNumberOfChangers;
    DWORD      dwNumberOfMedia;
    DWORD      dwNumberOfMediaTypes;
    DWORD      dwNumberOfLibRequests;
    GUID       Reserved;
    BOOL       AutoRecovery
} NTMS_LIBRARYINFORMATION;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>LibraryType</b></dt>
<dd>
Library type object. This can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=57%>Value</th>
<th align=left width=43%>Meaning</th>
</tr>
<tr valign=top>
<td width=57%>NTMS_LIBRARYTYPE_ONLINE</td>
<td width=43%>A robotic element that automates the mounting and dismounting of media into one or more drives. </td>
</tr>
<tr valign=top>
<td width=57%>NTMS_LIBRARYTYPE_STANDALONE</td>
<td width=43%>A standalone drive that is modeled as a library with one drive in RSM. </td>
</tr>
<tr valign=top>
<td width=57%>NTMS_LIBRARYTYPE_OFFLINE</td>
<td width=43%>Media that is not in an online library is in an offline library. There is one offline library unit per RSM system. </td>
</tr>
<tr valign=top>
<td width=57%>NTMS_LIBRARYTYPE_UNKNOWN</td>
<td width=43%>Library type cannot be determined.</td>
</tr>
</table><br>

</dd>
<dt>
<b>CleanerSlot</b></dt>
<dd>
For each online library, this represents the slot that was assigned to the cleaner cartridge. If this member is NULL, there is no cleaner slot defined for this library.</dd>
<dt>
<b>CleanerSlotDefault</b></dt>
<dd>
Represents a libraries' default or preferred cleaner slot. If NULL, there is not a preferred slot.</dd>
<dt>
<b>LibrarySupportsDriveCleaning</b></dt>
<dd>
Used by drives that require cleaning under robotics control. If TRUE, automatic drive cleaning operations are enabled. </dd>
<dt>
<b>BarCodeReaderInstalled</b></dt>
<dd>
Returns TRUE if a bar code reader is installed in a library; otherwise returns FALSE.</dd>
<dt>
<b>InventoryMethod</b></dt>
<dd>
The default or user-selected method for performing inventory of this online library. (This member is writable.) This can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>NTMS_INVENTORY_FAST</td>
<td width=52%>If the library has a bar-code reader installed, this value causes a bar-code inventory to be performed. If the library does not have a bar-code reader, this flag causes a differential inventory to be performed (slots which transitioned from empty to full are classified). </td>
</tr>
<tr valign=top>
<td width=48%>NTMS_INVENTORY_OMID</td>
<td width=52%>A full inventory involves mounting each partition in a library and reading the on-media identification from the media. This type of inventory can be very time consuming for some library units. </td>
</tr>
<tr valign=top>
<td width=48%>NTMS_INVENTORY_NONE</td>
<td width=52%>After the library door is closed, no inventory is performed. Inventory might be required if a mount label-check fails. </td>
</tr>
</table><br>

</dd>
<dt>
<b>dwCleanerUsesRemaining</b></dt>
<dd>
Number of uses remaining on the cleaner in the library. This member is zero if no cleaner is present or if the library does not support cleaning.</dd>
<dt>
<b>FirstDriveNumber</b></dt>
<dd>
Number of the first drive in the online library.</dd>
<dt>
<b>dwNumberOfDrives</b></dt>
<dd>
Number of drives in the online library.</dd>
<dt>
<b>FirstSlotNumber</b></dt>
<dd>
Number of the first slot in the online library.</dd>
<dt>
<b>dwNumberOfSlots</b></dt>
<dd>
Number of slots in the online library.</dd>
<dt>
<b>FirstDoorNumber</b></dt>
<dd>
Number of the first access door in the online library.</dd>
<dt>
<b>dwNumberOfDoors</b></dt>
<dd>
Number of access doors in the online library.</dd>
<dt>
<b>FirstPortNumber</b></dt>
<dd>
Number of the first insert/eject port in the online library.</dd>
<dt>
<b>dwNumberOfPorts</b></dt>
<dd>
Number of insert/eject ports in the online library.</dd>
<dt>
<b>FirstChangerNumber</b></dt>
<dd>
Number of the first changer in the online library.</dd>
<dt>
<b>dwNumberOfChangers</b></dt>
<dd>
Number of changers in the online library.</dd>
<dt>
<b>dwNumberOfMedia</b></dt>
<dd>
Number of media in the online or offline library.</dd>
<dt>
<b>dwNumberOfMediaTypes</b></dt>
<dd>
Number of media types supported by the library.</dd>
<dt>
<b>dwNumberOfLibRequests</b></dt>
<dd>
Number of current library requests.</dd>
<dt>
<b>Reserved</b></dt>
<dd>
Reserved.</dd>
<dt>
<b>AutoRecovery</b></dt>
<dd>
If set a full inventory will be performed if a mount fails. The failure may be either hardware or label mismatch. For ATAPI CD libraries, <b>AutoRecovery</b> cannot be disabled. The default is true. Large library owners should disable this feature.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For offline libraries, only <b>LibraryType</b> and <b>dwNumberOfMedia</b> are reported. All other values should be ignored.</p>
<p>
The <b>NTMS_LIBRARYINFORMATION</b> data structure is included in the <b>NTMS_OBJECTINFORMATION</b> structure used for the <b>GetNtmsObjectInformation</b> and <b>SetNtmsObjectInformation</b> functions.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ntmsapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use ntmsapi.lib.</p>
<p>&nbsp;</p></body>
</HTML>
