<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DeleteNtmsMediaType</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_deletentmsmediatype"></a>DeleteNtmsMediaType</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>DeleteNtmsMediaType</b> function deletes the specified media type relation from the specified library provided that the library does not contain any physical media objects of the specified media type (offline included). </p>
<pre><code><b>DWORD DeleteNtmsMediaType(
</b>  <b>HANDLE</b> <i>hSession</i><b>,</b>
  <b>LPNTMS_GUID</b> <i>lpMediaTypeId</i><b>,</b>
  <b>LPNTMS_GUID</b> <i>lpLibId</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSession</i></dt>
<dd>
Handle to the session returned by the <a href="ntms_api_3kq6.htm"><b>OpenNtmsSession</b></a> function.</dd>
<dt>
<i>lpMediaTypeId</i></dt>
<dd>
Specifies the unique identifier of a media type to delete from a library.</dd>
<dt>
<i>lpLibId</i></dt>
<dd>
Specifies the unique identifier of the library from which to delete the media type.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_ACCESS_DENIED</dt>
<dd>
NTMS_MODIFY_ACCESS to media's media pool is denied.</dd>
<dt>
ERROR_DATABASE_FAILURE</dt>
<dd>
The database is inaccessible or damaged.</dd>
<dt>
ERROR_DATABASE_FULL</dt>
<dd>
The database is full.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
The session handle is bad or missing.</dd>
<dt>
ERROR_INVALID_LIBRARY</dt>
<dd>
The library ID is invalid.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
The media type or library ID is missing.</dd>
<dt>
ERROR_NOT_ENOUGH_MEMORY</dt>
<dd>
An allocation failure occurred during processing.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function was successful.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If there are no physical media objects of the specified media type in the RSM system and there are no library objects that contain the specified media type relation in the RSM system, the system media pools for that media type will be deleted. Inability to delete the system media pools does not cause the <b>DeleteNtmsMediaType</b> function to fail. This call requires the caller to have NTMS_CONTROL_ACCESS rights to the library object.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ntmsapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use ntmsapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntms_api_5nz9.htm#_zaw_media_services_functions">Media Services Functions</a>, <a href="ntms_api_63c5.htm"><b>AddNtmsMediaType</b></a></p>
<p>&nbsp;</p></body>
</HTML>
