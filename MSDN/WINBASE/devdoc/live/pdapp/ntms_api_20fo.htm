<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ReserveNtmsCleanerSlot</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_reserventmscleanerslot"></a>ReserveNtmsCleanerSlot</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>ReserveNtmsCleanerSlot</b> function reserves a single slot in an online library unit for a drive cleaner cartridge. </p>
<pre><code><b>DWORD WINAPI ReserveNtmsCleanerSlot(
</b>  <b>HANDLE</b> <i>hSession</i><b>,</b> 
  <b>LPNTMS_GUID</b> <i>lpLibrary</i><b>,</b>
  <b>LPNTMS_GUID</b> <i>lpSlot</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSession</i></dt>
<dd>
Handle to the session returned by the <a href="ntms_api_3kq6.htm"><b>OpenNtmsSession</b></a> function.</dd>
<dt>
<i>lpLibrary</i></dt>
<dd>
Specifies the unique identifier of the library to set the cleaner slot.</dd>
<dt>
<i>lpSlot</i></dt>
<dd>
Specifies the unique identifier of the slot that is to be reserved for a cleaner cartridge. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_ALREADY_RESERVED</dt>
<dd>
Either this slot or another slot in the library has already been reserved for cleaning. To change the cleaner cartridge slot, the currently reserved cleaner slot must be released first, using the <b>ReleaseNtmsCleanerSlot</b> function.</dd>
<dt>
ERROR_ DEVICE_NOT_AVAILABLE</dt>
<dd>
The library is not currently connected.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
The value specified in the <i>hSession</i> parameter is invalid.</dd>
<dt>
ERROR_INVALID_SLOT</dt>
<dd>
Unable to retrieve the slot definition from the database.</dd>
<dt>
ERROR_NOT_CONNECTED</dt>
<dd>
Unable to connect to the RSM service.</dd>
<dt>
ERROR_SLOT_FULL</dt>
<dd>
A cleaner slot is not reserved. The slot specified has media in it. Reservation can only be performed on an empty slot. </dd>
<dt>
ERROR_SLOT_NOT_PRESENT</dt>
<dd>
A cleaner slot is not reserved. The slot specified is currently not installed in the library. This error occurs if at least one cartridge magazine is missing from the library. </dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function was successful.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The slot reserved with the <b>ReserveNtmsCleanerSlot</b> function must be present and empty. The library must not already have a slot reserved for a cleaner cartridge. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ntmsapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use ntmsapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntms_api_5nz9.htm#_zaw_cleaner_management_functions">Cleaner Management Functions</a>, <a href="ntms_api_7hlx.htm"><b>CleanNtmsDrive</b></a>, <a href="ntms_api_2t2q.htm"><b>EjectNtmsCleaner</b></a>, <a href="ntms_api_79de.htm"><b>InjectNtmsCleaner</b></a>, <a href="ntms_api_70vo.htm"><b>ReleaseNtmsCleanerSlot</b></a></p>
<p>&nbsp;</p></body>
</HTML>
