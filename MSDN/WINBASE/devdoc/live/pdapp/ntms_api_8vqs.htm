<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EnumerateNtmsObject</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_enumeratentmsobject"></a>EnumerateNtmsObject</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>EnumerateNtmsObject</b> function enumerates the RSM objects contained in the <i>lpContainerId</i> parameter. </p>
<pre><code><b>DWORD WINAPI EnumerateNtmsObject(
</b>  <b>HANDLE</b> <i>hSession</i><b>,</b> 
  <b>LPNTMS_GUID</b> <i>lpContainerId</i><b>,</b>
  <b>LPNTMS_GUID</b> <i>lpList</i><b>,</b>
  <b>LPDWORD</b> <i>lpdwListSize</i><b>,</b>
  <b>DWORD</b> <i>dwType</i><b>,</b>
  <b>DWORD</b> <i>dwOptions</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSession</i></dt>
<dd>
Handle to the session returned by the <a href="ntms_api_3kq6.htm"><b>OpenNtmsSession</b></a> function.</dd>
<dt>
<i>lpContainerId</i></dt>
<dd>
Specifies the unique identifier of the RSM object container. The type of object identified depends on the type of object being requested. Can be set to Library, Media Pool, Partition ID, Physical Media, Logical Media, or NULL. Set this parameter to NULL to enumerate all objects of the type specified by the <i>dwType</i> parameter.</dd>
<dt>
<i>lpList</i></dt>
<dd>
Buffer for the array of libraries, drives, media or other RSM object IDs.</dd>
<dt>
<i>lLpdwListSize</i></dt>
<dd>
Pointer to a DWORD that specifies the maximum number of IDs the function can return through the <i>lpList</i> parameter. At return time, the number of IDs in <i>lpList</i> is returned in <i>lpdwListSize</i>A</dd>
<dt>
<i>dwType</i></dt>
<dd>
Specifies the type of objects that you are enumerating in the container. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>NTMS_CHANGER</td>
<td width=52%>Lists changers contained in the library specified by the <i>lpContainerId</i> parameter or all the changers supported by RSM if a NULL container ID is supplied. Available when <i>lpContainerID</i> is set to NULL or Library.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_DRIVE</td>
<td width=52%>Lists drives contained in a specific library specified by the <i>lpContainerId</i> parameter or all the drives supported by RSM if a NULL container ID is supplied. Available when <i>lpContainerID</i> is set to NULL or Library.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_CHANGER_TYPE</td>
<td width=52%>Lists changer types supported by RSM. The <i>lpContainerId</i> parameter must be NULL.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_COMPUTER</td>
<td width=52%>Specifies the current computer object. The <i>lpContainerId</i> parameter must be NULL.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_DRIVE_TYPE</td>
<td width=52%>Lists drive types supported by RSM. The <i>lpContainerId</i> parameter must be NULL.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_IEDOOR</td>
<td width=52%>Lists access doors contained in a library specified by the <i>lpContainerId</i> parameter or all the doors supported by RSM if a NULL container ID is specified. Available when <i>lpContainerID</i> is set to NULL or Library.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_IEPORT</td>
<td width=52%>Lists insert/eject ports contained in a library specified by the <i>lpContainerId</i> parameter or all the insert/eject ports supported by RSM if a NULL container ID is supplied. Available when <i>lpContainerID</i> is set to NULL or Library.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_LIBRARY</td>
<td width=52%>Lists the library objects. These include the physical library units and the offline library. The <i>lpContainerId</i> parameter must be NULL.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_LIBREQUEST</td>
<td width=52%>Lists library active requests (or work items) queued to the library specified by the <i>lpContainerId</i> parameter or all the library work items queued within RSM if a NULL container ID is supplied. Available when <i>lpContainerID</i> is set to NULL or Library.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_LOGICAL_MEDIA</td>
<td width=52%>Specifies a logical media object. This is a medium allocated to an application that might contain more than one partition or piece of physical media. Available when <i>lpContainerID</i> is set to NULL, Media Pool, or Partition ID.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_MEDIA_POOL</td>
<td width=52%>Specifies a media pool object that contains logical and/or physical media, and configuration parameters to manage them. If NULL is specified as a container ID, only the top-level names are returned. Available when <i>lpContainerID</i> is set to NULL or Media Pool.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_MEDIA_TYPE</td>
<td width=52%>Specifies a media type object that contains the attributes of a type of medium that is supported by RSM. Enumerating with a NULL will give all possible media types, not just those available on the current server. Available when <i>lpContainerID</i> is set to NULL or Library.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_OPREQUEST</td>
<td width=52%>Lists operator requests that are on this RSM server. The <i>lpContainerId</i> parameter must be NULL.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_PARTITION</td>
<td width=52%>Specifies a partition on a piece of physical media. The piece of physical media can contain multiple physical partitions (for example, an optical disk contains two sides). Available when <i>lpContainerID</i> is set to NULL, Physical Media, Logical Media, or Media Pool.</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_PHYSICAL_MEDIA</td>
<td width=52%>Specifies a piece of physical media (a tape, optical disk, CD-ROM, or magnetic cartridge). A piece of physical media can contain multiple physical partitions (for example, sides of an optical disk).<p>
The container ID contains NULL to get all the physical media, a media pool, logical media, or a library. Available when <i>lpContainerID</i> is set to NULL, Media Pool, or Library</p>
</td>
</tr>
<tr valign=top>
<td width=48%>NTMS_STORAGESLOT</td>
<td width=52%>Lists media slots contained in a library specified by the <i>lpContainerId</i> parameter or all the storage slots supported by RSM if a NULL container ID is supplied. Available when <i>lpContainerID</i> is set to NULL or Library.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwOptions</i></dt>
<dd>
Option flags. Reserved and must be set to 0.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
The list-size pointer is missing or the object type is invalid.</dd>
<dt>
ERROR_INSUFFICIENT_BUFFER</dt>
<dd>
The buffer provided is too small to return all the entries available. The list is truncated and the actual size is returned in <i>lpdwListSize</i>.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
The session handle is invalid or missing.</dd>
<dt>
ERROR_NOT_ENOUGH_MEMORY</dt>
<dd>
An allocation failure occurred during processing.</dd>
<dt>
ERROR_OBJECT_NOT_FOUND</dt>
<dd>
No objects match the search criteria.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function was successful.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Security functions are also available to get and set specific access rights on RSM objects.</p>
<p>
If the available number of IDs specified in the <i>lpdwListSize</i> parameter is greater than the current buffer size, <i>lpdwListSize</i> returns the number of IDs required. The application should then allocate a larger buffer and try again.</p>
<p>
Since it is possible for IDs to be added by another process, it is possible for a subsequent function with a resized list to get an error indicating that the list is too small. To avoid this, specify a list in the <i>lpdwListSize</i> parameter that is slightly larger than the required length.</p>
<p>
If the <i>lpContainerId</i> parameter is set to NULL, RSM enumerates top-level objects (such as libraries).</p>
<p>
If more than one object is listed, the object may be enumerated from more than one container. The NULL container is the highest-level container and enumerates all objects in a system. For example, you can enumerate media in a particular library or all media in the system.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ntmsapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use ntmsapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntms_api_5nz9.htm#_zaw_object_management_functions">Object Management Functions</a>, <a href="ntms_api_9fe4.htm"><b>CreateNtmsMediaPool</b></a>, <a href="ntms_api_1k8e.htm"><b>GetNtmsObjectInformation</b></a>, <a href="ntms_api_6e5q.htm"><b>SetNtmsObjectInformation</b></a></p>
<p>&nbsp;</p></body>
</HTML>
