<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MountNtmsMedia</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_mountntmsmedia"></a>MountNtmsMedia</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MountNtmsMedia</b> function synchronously mounts one or more pieces of media.</p>
<pre><code><b>DWORD WINAPI MountNtmsMedia(
</b>  <b>HANDLE</b> <i>hSession</i><b>,</b>
  <b>LPNTMS_GUID</b> <i>lpMediaId</i><b>,</b> 
  <b>LPNTMS_GUID</b> <i>lpDriveId</i><b>,</b>
  <b>DWORD</b> <i>dwCount</i><b>,</b>
  <b>DWORD</b> <i>dwOptions</i><b>,</b>
  <b>DWORD</b> <i>dwPriority</i><b>,</b>
  <b>DWORD</b> <i>dwTimeout</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSession</i></dt>
<dd>
Handle to the session returned by the <a href="ntms_api_3kq6.htm"><b>OpenNtmsSession</b></a> function.</dd>
<dt>
<i>lpMediaId</i></dt>
<dd>
Specifies an array of unique identifiers of logical media or partitions.</dd>
<dt>
<i>lpDriveId</i></dt>
<dd>
Specifies an array of drive identifiers that corresponds to the list of media in the <i>IpMediaId</i> parameter. This array either supplies a list of drives to mount media into or returns the list of drives that media is mounted into on operation completion. See the NTMS_MOUNT_SPECIFIC_DRIVE value below. If the <b>MountNtmsMedia</b> function times out prior to the completion of the mount, RSM does not return the list of drives.</dd>
<dt>
<i>dwCount</i></dt>
<dd>
Specifies the number of media identifiers and drive identifiers passed in the <i>lpMediaId</i> and <i>lpDriveId</i> parameters. Note that <i>lpMediaId</i> and <i>lpDriveId</i> must point to the first element of equal-length arrays.</dd>
<dt>
<i>dwOptions</i></dt>
<dd>
This parameter can be one or more of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=63%>Value</th>
<th align=left width=37%>Meaning</th>
</tr>
<tr valign=top>
<td width=63%>NTMS_MOUNT_SPECIFIC_DRIVE</td>
<td width=37%>Mount the media into the specific drives provided in the <i>lpDriveId</i> parameter.</td>
</tr>
<tr valign=top>
<td width=63%>NTMS_MOUNT_READ</td>
<td width=37%>Mount the media for read access. Use this value to mount read-only media.</td>
</tr>
<tr valign=top>
<td width=63%>NTMS_MOUNT_WRITE</td>
<td width=37%>Mount the media for write access. Use this flag to prevent RSM from mounting Completed media. This value can be combined with NTMS_MOUNT_READ for read/write access.<p>
RSM cannot mount Completed media if this flag is selected.</p>
</td>
</tr>
<tr valign=top>
<td width=63%>NTMS_MOUNT_ERROR_NOT_AVAILABLE</td>
<td width=37%>This value returns an error if the media or a drive is not available.</td>
</tr>
<tr valign=top>
<td width=63%>NTMS_MOUNT_ERROR_OFFLINE</td>
<td width=37%>Do not issue an operator request to mount offline media. Return an error if the media specified is not currently in an online library.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwPriority</i></dt>
<dd>
Specifies the priority of the mount used by RSM to allow access to drives. Priorities range from -15 to 15, with 15 the highest priority and 0 is the default. This parameter can also take one of the following constants. An application should pass NTMS_PRIORITY_NORMAL unless a special mount priority is required.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%>Value</th>
<th align=left width=48%>Meaning</th>
</tr>
<tr valign=top>
<td width=52%>NTMS_PRIORITY_NORMAL</td>
<td width=48%>Mounts that are not time critical.</td>
</tr>
<tr valign=top>
<td width=52%>NTMS_PRIORITY_LOW</td>
<td width=48%>Mounts performed as a background activity.</td>
</tr>
<tr valign=top>
<td width=52%>NTMS_PRIORITY_HIGH</td>
<td width=48%>Mounts that are time critical.</td>
</tr>
<tr valign=top>
<td width=52%>NTMS_PRIORITY_LOWEST</td>
<td width=48%>Lowest priority mount.</td>
</tr>
<tr valign=top>
<td width=52%>NTMS_PRIORITY_HIGHEST</td>
<td width=48%>Highest priority mount.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwTimeout</i></dt>
<dd>
Specifies the maximum time, in milliseconds, allowed to mount the specified media. Set this parameter to INFINITE to wait as long as the mount takes.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_ACCESS_DENIED</dt>
<dd>
NTMS_USE_ACCESS to the media pool or library that contains the media is denied; other security errors are also possible but they would indicate a security subsystem error.</dd>
<dt>
ERROR_BUSY</dt>
<dd>
The media or drives are busy.</dd>
<dt>
ERROR_CANCELED</dt>
<dd>
The request was canceled by the <b>CloseNtmsSession</b> function.</dd>
<dt>
ERROR_DATABASE_FAILURE</dt>
<dd>
The database is inaccessible or damaged.</dd>
<dt>
ERROR_DATABASE_FULL</dt>
<dd>
The database is full.</dd>
<dt>
ERROR_DRIVE_MEDIA_MISMATCH</dt>
<dd>
The media and drive specified are not in the same library.</dd>
<dt>
ERROR_INVALID_DRIVE</dt>
<dd>
At least one of the specified drives is not valid.</dd>
<dt>
ERROR_INVALID_LIBRARY</dt>
<dd>
The library that contains the drives or media is not valid.</dd>
<dt>
ERROR_INVALID_MEDIA</dt>
<dd>
One or more of the media specified is not valid, or there are duplicate media IDs in list of media.</dd>
<dt>
ERROR_INVALID_STATE</dt>
<dd>
An unexpected media or device state occurred during mount.</dd>
<dt>
ERROR_MEDIA_OFFLINE</dt>
<dd>
The media is offline and cannot be mounted.</dd>
<dt>
ERROR_NOT_ENOUGH_MEMORY </dt>
<dd>
A memory allocation failure occurred during processing.</dd>
<dt>
ERROR_REQUEST_REFUSED</dt>
<dd>
The user canceled the request through the user interface.</dd>
<dt>
ERROR_RESOURCE_DISABLED</dt>
<dd>
One or more resources required to perform the mount are disabled.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The media has been mounted and is ready for use.</dd>
<dt>
ERROR_TIMEOUT </dt>
<dd>
The time-out event expired while attempting to acquire one or more required resources. The mount request has been canceled.</dd>
<dt>
ERROR_WRITE_PROTECT</dt>
<dd>
The media state is set to Completed and the NTMS_MOUNT_WRITE value was specified.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MountNtmsMedia</b> function queues a request to mount the specified media, then waits for the number of milliseconds specified in the <i>dwTimeout</i> parameter for the mount to complete or for an error to be detected. If RSM cannot complete the mount operation before <i>dwTimeout</i> expires, NTMS cancels the request and returns an errorIf the specified media is in an offline library, the application might be blocked for an extended period of time. You can use the <b>GetNtmsObjectInformation</b> function to determine the current location of the specified medium. You can also use the NTMS_MOUNT_ERROR_OFFLINE value to generate an immediate error instead of an operator request when the media is offline.</p>
<p>
If the specified medium is in use or a drive is not available, the process blocks up to the time-out value and returns ERROR_BUSY. If the NTMS_MOUNT_ERROR_NOT_AVAILABLE value is specified, the function returns an immediate error when a resource (media or drive) is not available.</p>
<p>
The time-out value of INFINITE can be used to make the function synchronous. When a non-zero time-out value is specified in the <i>dwTimeout</i> parameter, RSM waits for all the media specified in <i>lpMediaId</i> to become available. If the specified time elapses before all the media is available, the <b>MountNtmsMedia</b> function returns an error and cancels the request. The application can examine the status returned and resubmit the request if desired.</p>
<p>
When multiple media to be mounted are specified with a single call, all the specified media must be in a single library. If any of the specified media are offline, none of the media will be mounted until all the media are online.</p>
<p>
At the completion of the mount the drive state (for example, fix or variable mode) is not defined. The application must set up the drive.</p>
<p>
The <b>CloseNtmsSession</b> function can be used to cancel a mount that is pending. The default behavior is:</p>
<p class=indent1>
If the specified medium is offline, RSM posts an operator request to mount the media and the <b>MountNtmsMedia</b> function waits for the period of time specified in the <i>dwTimeout</i> parameter. </p>
<p class=indent1>
If a the specified medium is online, RSM requests the mount. </p>
<p class=indent1>
If a drive or media is not available, RSM pends the request and the <b>MountNtmsMedia</b> function waits for the period of time specified in the <i>dwTimeout</i> parameter. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ntmsapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use ntmsapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntms_api_5nz9.htm#_zaw_media_services_functions">Media Services Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
