<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FSCTL_ALLOW_EXTENDED_DASD_IO</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_fsctl_allow_extended_dasd_io"></a>FSCTL_ALLOW_EXTENDED_DASD_IO</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>FSCTL_ALLOW_EXTENDED_DASD_IO</b> operation signals the file system driver not to perform any I/O boundary checks on partition read or write calls. Instead, boundary checks are performed by the device driver. To perform this operation, call the <a href="devio_9quk.htm"><b>DeviceIoControl</b></a> function with the following parameters.</p>
<pre><code><b>BOOL DeviceIoControl(
</b>  (<b>HANDLE</b>)<i> hDevice</i>,        // handle to device of interest
  <i>FSCTL_ALLOW_EXTENDED_DASD_IO</i>,  // <i>dwIoControlCode</i>, control code of
                           // operation to perform
  <i>NULL</i>,                    // <i>lpInBuffer</i> is not used; must be NULL
  <i>0</i>,                       // <i>nInBufferSize</i> is not used; must be zero
  <i>NULL</i>,                    // <i>lpOutBuffer</i> is not used; must be NULL
  <i>0</i>,                       // <i>nOutBufferSize</i> is not used;
                           // must be zero
  (<b>LPDWORD</b>)<i> lpBytesReturned</i>,   // pointer to variable to receive
                           // output byte count
  (<b>LPOVERLAPPED</b>)<i> lpOverlapped</i>  // pointer to <b>OVERLAPPED</b> structure
                           // for asynchronous operation
<b>);</b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDevice</i></dt>
<dd>
Handle to the logical volume (partition) on which extended read or write operations are to be allowed. To obtain a device handle, call the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function with the FILE_SHARE_READ and FILE_SHARE_WRITE flags in the <i>dwShareMode</i> parameter. The process must have Administrator privileges to read from or write to the partition.</dd>
<dt>
<i>dwIoControlCode</i></dt>
<dd>
Control code for the operation. This value identifies the specific operation to be performed and the type of device on which to perform it. Use <b>FSCTL_ALLOW_EXTENDED_DASD_IO</b> for this operation.</dd>
<dt>
<i>lpInBuffer</i></dt>
<dd>
Pointer to the input buffer. Not used; must be NULL.</dd>
<dt>
<i>nInBufferSize</i></dt>
<dd>
Size, in bytes, of the input buffer. Not used; must be zero.</dd>
<dt>
<i>lpOutBuffer</i></dt>
<dd>
Pointer to the output buffer. Not used; must be NULL.</dd>
<dt>
<i>nOutBuffer</i></dt>
<dd>
Size, in bytes, of the output buffer. Not used; must be zero.</dd>
<dt>
<i>lpBytesReturned</i></dt>
<dd>
Pointer to a <b>DWORD</b> variable.
<p>
If <i>lpOverlapped</i> is NULL (nonoverlapped I/O), <i>lpBytesReturned</i> is used internally and cannot be NULL.

<p>
If <i>lpOverlapped</i> is not NULL (overlapped I/O), <i>lpBytesReturned</i> can be NULL.
</dd>
<dt>
<i>lpOverlapped</i></dt>
<dd>
Pointer to an <a href="synchro_8tf6.htm"><b>OVERLAPPED</b></a> structure. 
<p>
If <i>hDevice</i> was opened with the FILE_FLAG_OVERLAPPED flag, this parameter must point to a valid <b>OVERLAPPED</b> structure. In this case, <b>DeviceIoControl</b> is performed as an overlapped (asynchronous) operation. If the device was opened with the FILE_FLAG_OVERLAPPED flag and <i>lpOverlapped</i> is NULL, the function fails in unpredictable ways.

<p>
If <i>hDevice</i> was opened without specifying the FILE_FLAG_OVERLAPPED flag, this parameter is ignored and the <b>DeviceIoControl</b> function does not return until the operation has been completed, or until an error occurs.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the operation succeeds, <b>DeviceIoControl</b> returns a nonzero value.</p>
<p>
If the operation fails, <b>DeviceIoControl</b> returns zero. To get extended error information, call <b>GetLastError</b>.</p>
<h4>Remarks</h4>
<p>
A call using the <b>FSCTL_ALLOW_EXTENDED_DASD_IO </b>control code should only be used with great caution by programmers familiar with the underlying structure of a hard drive and file system. Improper use or inaccurate checking in subsequent write operations to the partition can result in damage to data on the partition, or destruction of the entire partition.</p>
<p>
The <b>FSCTL_ALLOW_EXTENDED_DASD_IO </b>operation, an extended Direct Access to Storage Device (DASD) operation, is used to signal the file system driver not to perform any I/O boundary checks on read or write calls made with the specified handle. <b>FSCTL_ALLOW_EXTENDED_DASD_IO</b> allows access to hidden sectors, a part of the partition that might exist between the first sector of the partition (the boot parameter block) and the first useful sector of the partition. <b>FSCTL_ALLOW_EXTENDED_DASD_IO</b> also allows access to lost clusters, which might exist between the last useful cluster and the end of the partition.</p>
<p>
I/O requests after a <b>FSCTL_ALLOW_EXTENDED_DASD_IO </b>operation are passed directly to the device driver. If these subsequent calls request data beyond the partition boundary, the driver causes them to fail.</p>
<p>
For the implications of overlapped I/O on an <b>FSCTL_ALLOW_EXTENDED_DASD_IO </b>operation, see the Remarks section of <a href="devio_9quk.htm"><b>DeviceIoControl</b></a>.</p>
<p>
To obtain a handle to a partition, pass in the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> parameter <i>lpFileName</i> a value of the following form:</p>
<pre><code>\\.\<i>X</i>:
</code></pre>
<p>
where <i>X</i> is the drive letter.</p>
<p>
The application calling <b>CreateFile </b>must also specify the FILE_SHARE_READ and FILE_SHARE_WRITE flags in the <i>dwShareMode</i> parameter of <b>CreateFile</b>. For more information, see the Disk Devices section in <b>CreateFile</b>. </p>
<p>
To determine the partition structure of the drive and to determine if Windows NT recognizes the partition, use the <a href="devio_5xdg.htm"><b>IOCTL_DISK_GET_DRIVE_LAYOUT</b></a><b> </b>operation. For similar information on a single partition, use the <a href="devio_0nsf.htm"><b>IOCTL_DISK_GET_PARTITION_INFO</b></a> operation. To determine the size of a cluster, use the <a href="filesio_8bso.htm"><b>GetDiskFreeSpaceEx</b></a> or <a href="filesio_2pt1.htm"><b>GetDiskFreeSpace</b></a> function, as appropriate.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winioctl.h.</p>
<h4>See Also</h4>
<p>
<a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <a href="devio_9quk.htm"><b>DeviceIoControl</b></a>, <a href="filesio_2pt1.htm"><b>GetDiskFreeSpace</b></a>, <a href="filesio_8bso.htm"><b>GetDiskFreeSpaceEx</b></a>, <a href="devio_5xdg.htm"><b>IOCTL_DISK_GET_DRIVE_LAYOUT</b></a>, <a href="devio_0nsf.htm"><b>IOCTL_DISK_GET_PARTITION_INFO</b></a>, <a href="synchro_8tf6.htm"><b>OVERLAPPED</b></a></p>
<p>&nbsp;</p></body>
</HTML>
