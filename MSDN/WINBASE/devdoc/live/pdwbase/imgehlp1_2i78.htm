<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ImageLoad</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_imageload"></a>ImageLoad</h1>
<p>
The <b>ImageLoad</b> function maintains a list of loaded DLLs.</p>
<pre><code><b>PLOADED_IMAGE ImageLoad(
  IN LPSTR</b><i> DllName</i><b>, </b>
<b>  IN LPSTR</b><i> DllPath  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>DllName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the image that is loaded.</dd>
<dt>
<i>DllPath</i></dt>
<dd>
Pointer to a null-terminated string that specifies the path used to locate the image if the name provided cannot be found. If NULL is used, then the search path rules set forth in the <a href="filesio_13vs.htm"><b>SearchPath</b></a> function apply.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a pointer to a <a href="imgehlp1_4836.htm"><b>LOADED_IMAGE</b></a> structure. </p>
<p>
If the function fails, the return value is NULL. To retrieve extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
The <b>ImageLoad</b> function is used to maintain a list of loaded DLLs. If the image has already been loaded, the prior <b>LOADED_IMAGE</b> is returned. Otherwise, the new image is added to the list. </p>
<p>
The <b>LOADED_IMAGE</b> structure <i>must</i> be deallocated by the <a href="imgehlp1_29es.htm"><b>ImageUnload</b></a> function.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in imagehlp.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use imagehlp.lib.</p>
<h4>See Also</h4>
<p>
<a href="imgehlp1_3hzz.htm">PE Image Helper (ImageHlp) Overview</a>, <a href="imgehlp1_7ub7.htm">Image Access</a>, <a href="imgehlp1_29es.htm"><b>ImageUnload</b></a>, <a href="imgehlp1_4836.htm"><b>LOADED_IMAGE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
