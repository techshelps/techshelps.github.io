<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DdeCreateDataHandle</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ddecreatedatahandle"></a>DdeCreateDataHandle</h1>
<p>
The <b>DdeCreateDataHandle</b> function creates a dynamic data exchange (DDE) object and fills the object with data from the specified buffer. A DDE application uses this function during transactions that involve passing data to the partner application. </p>
<pre><code><b>HDDEDATA DdeCreateDataHandle(
  DWORD</b><i> idInst</i><b>, </b>// instance identifier
<b>  LPBYTE</b><i> pSrc</i><b>,  </b>// pointer to source buffer
<b>  DWORD</b><i> cb</i><b>,     </b>// length of DDE object
<b>  DWORD</b><i> cbOff</i><b>,  </b>// offset from beginning of source buffer
<b>  HSZ</b><i> hszItem</i><b>,  </b>// handle to item name string
<b>  UINT</b><i> wFmt</i><b>,    </b>// clipboard data format
<b>  UINT</b><i> afCmd</i>    // creation flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>idInst</i></dt>
<dd>
Specifies the application instance identifier obtained by a previous call to the <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a> function. </dd>
<dt>
<i>pSrc</i></dt>
<dd>
Pointer to a buffer that contains data to be copied to the DDE object. If this parameter is NULL, no data is copied to the object. </dd>
<dt>
<i>cb</i></dt>
<dd>
Specifies the amount of memory, in bytes, to copy from the buffer pointed to by <i>pSrc</i>. (include the terminating NULL, if the data is a string). If this parameter is zero, the <i>pSrc</i> parameter is ignored. </dd>
<dt>
<i>cbOff</i></dt>
<dd>
Specifies an offset, in bytes, from the beginning of the buffer pointed to by the <i>pSrc</i> parameter. The data beginning at this offset is copied from the buffer to the DDE object. </dd>
<dt>
<i>hszItem</i></dt>
<dd>
Handle to the string that specifies the data item corresponding to the DDE object. This handle must have been created by a previous call to the <a href="ddemlib_85et.htm"><b>DdeCreateStringHandle</b></a> function. If the data handle is to be used in an XTYP_EXECUTE transaction, this parameter must be 0L. </dd>
<dt>
<i>wFmt</i></dt>
<dd>
Specifies the standard clipboard format of the data. </dd>
<dt>
<i>afCmd</i></dt>
<dd>
Specifies the creation flags. This parameter can be HDATA_APPOWNED, which specifies that the server application calling the <b>DdeCreateDataHandle</b> function owns the data handle this function creates. This flag enables the application to share the data handle with other Dynamic Data Exchange Management Library (DDEML) applications rather than creating a separate handle to pass to each application. If this flag is specified, the application must eventually free the shared memory object associated with the handle by using the <a href="ddemlib_23fp.htm"><b>DdeFreeDataHandle</b></a> function. If this flag is not specified, the handle becomes invalid in the application that created the handle after the data handle is returned by the application's DDE callback function or is used as a parameter in another DDEML function. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a data handle.</p>
<p>
If the function fails, the return value is 0L. </p>
<h4>Errors</h4>
<p>
The <a href="ddemlib_89bm.htm"><b>DdeGetLastError</b></a> function can be used to get the error code, which may be one of the following values: </p>
<p>
DMLERR_DLL_NOT_INITIALIZED<br>
DMLERR_INVALIDPARAMETER<br>
DMLERR_MEMORY_ERROR<br>
DMLERR_NO_ERROR</p>
<h4>Remarks</h4>
<p>
Any unfilled locations in the DDE object are undefined. </p>
<p>
After a data handle has been used as a parameter in another DDEML function or has been returned by a DDE callback function, the handle may be used only for read access to the DDE object identified by the handle. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ddeml.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library Overview</a>, <a href="ddemlib_1nn7.htm">Dynamic Data Exchange Management Functions</a>, <a href="ddemlib_1ba9.htm"><b>DdeAccessData</b></a>, <a href="ddemlib_85et.htm"><b>DdeCreateStringHandle</b></a>, <a href="ddemlib_23fp.htm"><b>DdeFreeDataHandle</b></a>, <a href="ddemlib_7xi9.htm"><b>DdeGetData</b></a>, <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
