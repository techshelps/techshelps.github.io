<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COMMPROP</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_commprop_str"></a>COMMPROP</h1>
<p>
The <b>COMMPROP</b> structure is used by the <a href="commun_4f8z.htm"><b>GetCommProperties</b></a> function to return information about a given communications driver. </p>
<pre><code>typedef struct _COMMPROP { 
    WORD  wPacketLength;       // packet size, in bytes 
    WORD  wPacketVersion;      // packet version 
    DWORD dwServiceMask;       // services implemented 
    DWORD dwReserved1;         // reserved 
    DWORD dwMaxTxQueue;        // max Tx bufsize, in bytes 
    DWORD dwMaxRxQueue;        // max Rx bufsize, in bytes 
    DWORD dwMaxBaud;           // max baud rate, in bps 
    DWORD dwProvSubType;       // specific provider type 
    DWORD dwProvCapabilities;  // capabilities supported 
    DWORD dwSettableParams;    // changeable parameters 
    DWORD dwSettableBaud;      // allowable baud rates 
    WORD  wSettableData;       // allowable byte sizes 
    WORD  wSettableStopParity; // stop bits/parity allowed 
    DWORD dwCurrentTxQueue;    // Tx buffer size, in bytes 
    DWORD dwCurrentRxQueue;    // Rx buffer size, in bytes 
    DWORD dwProvSpec1;         // provider-specific data 
    DWORD dwProvSpec2;         // provider-specific data 
    WCHAR wcProvChar[1];       // provider-specific data 
} COMMPROP; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>wPacketLength</b></dt>
<dd>
Specifies the size, in bytes, of the entire data packet, regardless of the amount of data requested. </dd>
<dt>
<b>wPacketVersion</b></dt>
<dd>
Specifies the version of the structure. </dd>
<dt>
<b>dwServiceMask</b></dt>
<dd>
Specifies a bitmask indicating which services are implemented by this provider. The SP_SERIALCOMM value is always specified for communications providers, including modem providers. </dd>
<dt>
<b>dwReserved1</b></dt>
<dd>
Reserved; do not use. </dd>
<dt>
<b>dwMaxTxQueue</b></dt>
<dd>
Specifies the maximum size, in bytes, of the driver's internal output buffer. A value of zero indicates that no maximum value is imposed by the serial provider. </dd>
<dt>
<b>dwMaxRxQueue</b></dt>
<dd>
Specifies the maximum size, in bytes, of the driver's internal input buffer. A value of zero indicates that no maximum value is imposed by the serial provider. </dd>
<dt>
<b>dwMaxBaud</b></dt>
<dd>
Specifies the maximum allowable baud rate, in bits per second (bps). This member can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=26%><b>Value</b></td>
<th align=left width=74%>Meaning</th>
</tr>
<tr valign=top>
<td width=26%>BAUD_075</td>
<td width=74%>75 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_110</td>
<td width=74%>110 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_134_5</td>
<td width=74%>134.5 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_150</td>
<td width=74%>150 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_300</td>
<td width=74%>300 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_600</td>
<td width=74%>600 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_1200</td>
<td width=74%>1200 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_1800</td>
<td width=74%>1800 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_2400</td>
<td width=74%>2400 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_4800</td>
<td width=74%>4800 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_7200</td>
<td width=74%>7200 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_9600</td>
<td width=74%>9600 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_14400</td>
<td width=74%>14400 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_19200</td>
<td width=74%>19200 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_38400</td>
<td width=74%>38400 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_56K</td>
<td width=74%>56K bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_57600</td>
<td width=74%>57600 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_115200</td>
<td width=74%>115200 bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_128K</td>
<td width=74%>128K bps</td>
</tr>
<tr valign=top>
<td width=26%>BAUD_USER</td>
<td width=74%>Programmable baud rates available</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwProvSubType</b></dt>
<dd>
Specifies the specific communications provider type: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=40%><b>Value</b></td>
<th align=left width=60%>Meaning</th>
</tr>
<tr valign=top>
<td width=40%>PST_FAX</td>
<td width=60%>FAX device</td>
</tr>
<tr valign=top>
<td width=40%>PST_LAT</td>
<td width=60%>LAT protocol</td>
</tr>
<tr valign=top>
<td width=40%>PST_MODEM</td>
<td width=60%>Modem device</td>
</tr>
<tr valign=top>
<td width=40%>PST_NETWORK_BRIDGE</td>
<td width=60%>Unspecified network bridge</td>
</tr>
<tr valign=top>
<td width=40%>PST_PARALLELPORT</td>
<td width=60%>Parallel port</td>
</tr>
<tr valign=top>
<td width=40%>PST_RS232</td>
<td width=60%>RS-232 serial port</td>
</tr>
<tr valign=top>
<td width=40%>PST_RS422</td>
<td width=60%>RS-422 port</td>
</tr>
<tr valign=top>
<td width=40%>PST_RS423</td>
<td width=60%>RS-423 port</td>
</tr>
<tr valign=top>
<td width=40%>PST_RS449</td>
<td width=60%>RS-449 port</td>
</tr>
<tr valign=top>
<td width=40%>PST_SCANNER</td>
<td width=60%>Scanner device</td>
</tr>
<tr valign=top>
<td width=40%>PST_TCPIP_TELNET</td>
<td width=60%>TCP/IP Telnet® protocol</td>
</tr>
<tr valign=top>
<td width=40%>PST_UNSPECIFIED</td>
<td width=60%>Unspecified</td>
</tr>
<tr valign=top>
<td width=40%>PST_X25</td>
<td width=60%>X.25 standards</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwProvCapabilities</b></dt>
<dd>
Specifies a bitmask indicating the capabilities offered by the provider. This member can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=39%><b>Value</b></td>
<th align=left width=61%>Meaning</th>
</tr>
<tr valign=top>
<td width=39%>PCF_16BITMODE</td>
<td width=61%>Special 16-bit mode supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_DTRDSR</td>
<td width=61%>DTR (data-terminal-ready)/DSR (data-set-ready) supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_INTTIMEOUTS</td>
<td width=61%>Interval time-outs supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_PARITY_CHECK</td>
<td width=61%>Parity checking supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_RLSD</td>
<td width=61%>RLSD (receive-line-signal-detect) supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_RTSCTS</td>
<td width=61%>RTS (request-to-send)/CTS (clear-to-send) supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_SETXCHAR</td>
<td width=61%>Settable XON/XOFF supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_SPECIALCHARS</td>
<td width=61%>Special character support provided</td>
</tr>
<tr valign=top>
<td width=39%>PCF_TOTALTIMEOUTS</td>
<td width=61%>Total (elapsed) time-outs supported</td>
</tr>
<tr valign=top>
<td width=39%>PCF_XONXOFF</td>
<td width=61%>XON/XOFF flow control supported</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwSettableParams</b></dt>
<dd>
Specifies a bitmask indicating the communications parameter that can be changed. This member can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=34%><b>Value</b></td>
<th align=left width=66%>Meaning</th>
</tr>
<tr valign=top>
<td width=34%>SP_BAUD</td>
<td width=66%>Baud rate</td>
</tr>
<tr valign=top>
<td width=34%>SP_DATABITS</td>
<td width=66%>Data bits</td>
</tr>
<tr valign=top>
<td width=34%>SP_HANDSHAKING</td>
<td width=66%>Handshaking (flow control)</td>
</tr>
<tr valign=top>
<td width=34%>SP_PARITY</td>
<td width=66%>Parity</td>
</tr>
<tr valign=top>
<td width=34%>SP_PARITY_CHECK</td>
<td width=66%>Parity checking</td>
</tr>
<tr valign=top>
<td width=34%>SP_RLSD</td>
<td width=66%>RLSD (receive-line-signal-detect)</td>
</tr>
<tr valign=top>
<td width=34%>SP_STOPBITS</td>
<td width=66%>Stop bits</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwSettableBaud</b></dt>
<dd>
Specifies a bitmask indicating the baud rates that can be used. For values, see the <b>dwMaxBaud</b> member. </dd>
<dt>
<b>wSettableData</b></dt>
<dd>
Specifies a bitmask indicating the number of data bits that can be set. This member can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=27%><b>Value</b></td>
<th align=left width=73%>Meaning</th>
</tr>
<tr valign=top>
<td width=27%>DATABITS_5</td>
<td width=73%>5 data bits</td>
</tr>
<tr valign=top>
<td width=27%>DATABITS_6</td>
<td width=73%>6 data bits</td>
</tr>
<tr valign=top>
<td width=27%>DATABITS_7</td>
<td width=73%>7 data bits</td>
</tr>
<tr valign=top>
<td width=27%>DATABITS_8</td>
<td width=73%>8 data bits</td>
</tr>
<tr valign=top>
<td width=27%>DATABITS_16</td>
<td width=73%>16 data bits</td>
</tr>
<tr valign=top>
<td width=27%>DATABITS_16X</td>
<td width=73%>Special wide path through serial hardware lines</td>
</tr>
</table><br>

</dd>
<dt>
<b>wSettableStopParity</b></dt>
<dd>
Specifies a bitmask indicating the stop bit and parity settings that can be selected. This member can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=29%><b>Value</b></td>
<th align=left width=71%>Meaning</th>
</tr>
<tr valign=top>
<td width=29%>STOPBITS_10</td>
<td width=71%>1 stop bit</td>
</tr>
<tr valign=top>
<td width=29%>STOPBITS_15</td>
<td width=71%>1.5 stop bits</td>
</tr>
<tr valign=top>
<td width=29%>STOPBITS_20</td>
<td width=71%>2 stop bits</td>
</tr>
<tr valign=top>
<td width=29%>PARITY_NONE</td>
<td width=71%>No parity</td>
</tr>
<tr valign=top>
<td width=29%>PARITY_ODD</td>
<td width=71%>Odd parity</td>
</tr>
<tr valign=top>
<td width=29%>PARITY_EVEN</td>
<td width=71%>Even parity</td>
</tr>
<tr valign=top>
<td width=29%>PARITY_MARK</td>
<td width=71%>Mark parity</td>
</tr>
<tr valign=top>
<td width=29%>PARITY_SPACE</td>
<td width=71%>Space parity</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwCurrentTxQueue</b></dt>
<dd>
Specifies the size, in bytes, of the driver's internal output buffer. A value of zero indicates that the value is unavailable. </dd>
<dt>
<b>dwCurrentRxQueue</b></dt>
<dd>
Specifies the size, in bytes, of the driver's internal input buffer. A value of zero indicates that the value is unavailable. </dd>
<dt>
<b>dwProvSpec1</b></dt>
<dd>
Specifies provider-specific data. Applications should ignore this member unless they have detailed information about the format of the data required by the provider.
<p>
Set this member to COMMPROP_INITIALIZED before calling the <b>GetCommProperties</b> function to indicate that the <b>wPacketLength</b> member is already valid.
</dd>
<dt>
<b>dwProvSpec2</b></dt>
<dd>
Specifies provider-specific data. Applications should ignore this member unless they have detailed information about the format of the data required by the provider.</dd>
<dt>
<b>wcProvChar</b></dt>
<dd>
Specifies provider-specific data. Applications should ignore this member unless they have detailed information about the format of the data required by the provider.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The contents of the <b>dwProvSpec1</b>, <b>dwProvSpec2</b>, and <b>wcProvChar</b> members depend on the provider subtype (specified by the <b>dwProvSubType</b> member).</p>
<p>
If the provider subtype is PST_MODEM, these members are used as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td class=indent1 width=29%><b>Value</b></td>
<th align=left width=71%>Meaning</th>
</tr>
<tr valign=top>
<td width=29%><b>dwProvSpec1</b></td>
<td width=71%>Not used.</td>
</tr>
<tr valign=top>
<td width=29%><b>dwProvSpec2</b></td>
<td width=71%>Not used.</td>
</tr>
<tr valign=top>
<td width=29%><b>wcProvChar </b></td>
<td width=71%>Contains a <a href="commun_3xf6.htm"><b>MODEMDEVCAPS</b></a> structure.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.</p>
<h4>See Also</h4>
<p>
<a href="commun_4m7n.htm">Communications Overview</a>, <a href="commun_0cab.htm">Communication Structures</a>, <a href="commun_4f8z.htm"><b>GetCommProperties</b></a></p>
<p>&nbsp;</p></body>
</HTML>
