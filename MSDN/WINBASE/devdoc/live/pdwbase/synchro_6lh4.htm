<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MsgWaitForMultipleObjectsEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_msgwaitformultipleobjectsex"></a>MsgWaitForMultipleObjectsEx</h1>
<p>
The <b>MsgWaitForMultipleObjectsEx</b> function returns when one of the following occurs: 
<ul>
<li>
Either any one or all of the specified objects are in the signaled state. The array of objects can include input event objects, which you specify using the <i>dwWakeMask</i> parameter. </li>
<li>
An I/O completion routine or asynchronous procedure call (APC) is queued to the thread. </li>
<li>
The time-out interval elapses. </li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;<b>MsgWaitForMultipleObjectsEx</b> does not return if there is unread input of the specified type in the message queue after the thread has called a function to check the queue, unless you use the MWMO_INPUTAVAILABLE flag. This is because functions such as <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_peekmessage">
</object><a href=JavaScript:alink_1.Click()><b>PeekMessage</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getmessage">
</object><a href=JavaScript:alink_2.Click()><b>GetMessage</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getqueuestatus">
</object><a href=JavaScript:alink_3.Click()><b>GetQueueStatus</b></a>, and <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_waitmessage">
</object><a href=JavaScript:alink_4.Click()><b>WaitMessage</b></a> check the queue and then change the state information for the queue so that the input is no longer considered new. A subsequent call to <b>MsgWaitForMultipleObjectsEx</b> will not return until new input of the specified type arrives, unless you use the MWMO_INPUTAVAILABLE flag. If this flag is not used, the existing unread input (received prior to the last time the thread checked the queue) is ignored. </p>
<pre><code><b>DWORD MsgWaitForMultipleObjectsEx(
  DWORD</b><i> nCount</i><b>,          </b>// number of handles in handle array
<b>  LPHANDLE</b><i> pHandles</i><b>,     </b>// pointer to an object-handle array
<b>  DWORD</b><i> dwMilliseconds</i><b>,  </b>// time-out interval in milliseconds
<b>  DWORD</b><i> dwWakeMask</i><b>,      </b>// type of input events to wait for
<b>  DWORD</b><i> dwFlags</i>          // wait flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>nCount</i></dt>
<dd>
Specifies the number of object handles in the array pointed to by <i>pHandles</i>. The maximum number of object handles is MAXIMUM_WAIT_OBJECTS minus one.</dd>
<dt>
<i>pHandles</i></dt>
<dd>
Pointer to an array of object handles. For a list of the object types whose handles you can specify, see the Remarks section later in this topic. The array can contain handles to multiple types of objects. 
<p>
<b>Windows NT:</b> The handles must have SYNCHRONIZE access. For more information, see <a href="accctrl_6gdv.htm">Standard Access Rights</a>. 
</dd>
<dt>
<i>dwMilliseconds</i></dt>
<dd>
Specifies the time-out interval, in milliseconds. The function returns if the interval elapses, even if the conditions specified by the <i>dwWakeMask</i> and <i>dwFlags</i> parameters are not met. If <i>dwMilliseconds</i> is zero, the function tests the states of the specified objects and returns immediately. If <i>dwMilliseconds</i> is INFINITE, the function's time-out interval never elapses. </dd>
<dt>
<i>dwWakeMask</i></dt>
<dd>
Specifies input types for which an input event object handle will be added to the array of object handles. This parameter can be any combination of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%>Value</th>
<th align=left width=61%>Meaning</th>
</tr>
<tr valign=top>
<td width=39%>QS_ALLEVENTS</td>
<td width=61%>An input, WM_TIMER, WM_PAINT, WM_HOTKEY, or posted message is in the queue. </td>
</tr>
<tr valign=top>
<td width=39%>QS_ALLINPUT</td>
<td width=61%>Any message is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_ALLPOSTMESSAGE</td>
<td width=61%>A posted message (other than those listed here) is in the queue. </td>
</tr>
<tr valign=top>
<td width=39%>QS_HOTKEY</td>
<td width=61%>A <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_hotkey">
</object><a href=JavaScript:alink_5.Click()>WM_HOTKEY</a> message is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_INPUT</td>
<td width=61%>An input message is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_KEY</td>
<td width=61%>A <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_keyup">
</object><a href=JavaScript:alink_6.Click()>WM_KEYUP</a>, <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_keydown">
</object><a href=JavaScript:alink_7.Click()>WM_KEYDOWN</a>, <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_syskeyup">
</object><a href=JavaScript:alink_8.Click()>WM_SYSKEYUP</a>, or <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_syskeydown">
</object><a href=JavaScript:alink_9.Click()>WM_SYSKEYDOWN</a> message is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_MOUSE</td>
<td width=61%>A <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_mousemove">
</object><a href=JavaScript:alink_10.Click()>WM_MOUSEMOVE</a> message or mouse-button message (<object id=alink_11 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_lbuttonup">
</object><a href=JavaScript:alink_11.Click()>WM_LBUTTONUP</a>, <object id=alink_12 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_rbuttondown">
</object><a href=JavaScript:alink_12.Click()>WM_RBUTTONDOWN</a>, and so on) is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_MOUSEBUTTON</td>
<td width=61%>A mouse-button message (<object id=alink_13 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_lbuttonup">
</object><a href=JavaScript:alink_13.Click()>WM_LBUTTONUP</a>, <object id=alink_14 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_rbuttondown">
</object><a href=JavaScript:alink_14.Click()>WM_RBUTTONDOWN</a>, and so on) is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_MOUSEMOVE</td>
<td width=61%>A <object id=alink_15 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_mousemove">
</object><a href=JavaScript:alink_15.Click()>WM_MOUSEMOVE</a> message is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_PAINT</td>
<td width=61%>A <object id=alink_16 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_paint">
</object><a href=JavaScript:alink_16.Click()>WM_PAINT</a> message is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_POSTMESSAGE</td>
<td width=61%>A posted message (other than those just listed) is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_SENDMESSAGE</td>
<td width=61%>A message sent by another thread or application is in the queue.</td>
</tr>
<tr valign=top>
<td width=39%>QS_TIMER</td>
<td width=61%>A <a href="timers_1w6q.htm">WM_TIMER</a> message is in the queue.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Specifies the wait type. This parameter can be any combination of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>0</td>
<td width=56%>The function returns when any one of the objects is signaled. The return value indicates the object whose state caused the function to return.</td>
</tr>
<tr valign=top>
<td width=44%>MWMO_WAITALL</td>
<td width=56%>The function returns when all objects in the <i>pHandles</i> array are signaled at the same time.</td>
</tr>
<tr valign=top>
<td width=44%>MWMO_ALERTABLE</td>
<td width=56%>The function also returns if an APC has been queued to the thread with <a href="synchro_3dk3.htm"><b>QueueUserAPC</b></a>.</td>
</tr>
<tr valign=top>
<td width=44%>MWMO_INPUTAVAILABLE</td>
<td width=56%><b>Windows 98, Windows NT 5.0 and later:</b> The function returns if input exists for the queue, even if the input has been seen (but not removed) using a call to another function, such as <object id=alink_17 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_peekmessage">
</object><a href=JavaScript:alink_17.Click()><b>PeekMessage</b></a>.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value indicates the event that caused the function to return. The successful return value is one of the following: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=58%>Value</th>
<th align=left width=42%>Meaning</th>
</tr>
<tr valign=top>
<td width=58%>WAIT_OBJECT_0 to<br>
 (WAIT_OBJECT_0 + <i>nCount</i> - 1)</td>
<td width=42%>If the MWMO_WAITALL flag is used, the return value indicates that the state of all specified objects is signaled. Otherwise, the return value minus WAIT_OBJECT_0 indicates the <i>pHandles</i> array index of the object that caused the function to return.</td>
</tr>
<tr valign=top>
<td width=58%>WAIT_OBJECT_0 + <i>nCount</i></td>
<td width=42%>New input of the type specified in the <i>dwWakeMask</i> parameter is available in the thread's input queue. Functions such as <object id=alink_18 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_peekmessage">
</object><a href=JavaScript:alink_18.Click()><b>PeekMessage</b></a>, <object id=alink_19 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getmessage">
</object><a href=JavaScript:alink_19.Click()><b>GetMessage</b></a>, <object id=alink_20 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getqueuestatus">
</object><a href=JavaScript:alink_20.Click()><b>GetQueueStatus</b></a>, and <object id=alink_21 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_waitmessage">
</object><a href=JavaScript:alink_21.Click()><b>WaitMessage</b></a> mark messages in the queue as old messages. Therefore, after you call one of these functions, a subsequent call to <b>MsgWaitForMultipleObjectsEx</b> will not return until new input of the specified type arrives. <p>
This value is also returned upon the occurrence of a system event that requires the thread's action, such as foreground activation. Therefore, <b>MsgWaitForMultipleObjectsEx</b> can return even though no appropriate input is available and even if <i>dwWaitMask</i> is set to 0. If this occurs, call <b>PeekMessage</b> or <b>GetMessage</b> to process the system event before trying the call to <b>MsgWaitForMultipleObjectsEx</b> again. </p>
</td>
</tr>
<tr valign=top>
<td width=58%>WAIT_ABANDONED_0 to <br>
(WAIT_ABANDONED_0 + <i>nCount</i> - 1)</td>
<td width=42%>If the MWMO_WAITALL flag is used, the return value indicates that the state of all specified objects is signaled and at least one of the objects is an abandoned mutex object. Otherwise, the return value minus WAIT_ABANDONED_0 indicates the <i>pHandles</i> array index of an abandoned mutex object that caused the function to return.</td>
</tr>
<tr valign=top>
<td width=58%>WAIT_IO_COMPLETION</td>
<td width=42%>The wait was ended by a user-mode asynchronous procedure call (APC) queued to the thread.</td>
</tr>
<tr valign=top>
<td width=58%>WAIT_TIMEOUT</td>
<td width=42%>The time-out interval elapsed, but the conditions specified by the <i>dwFlags</i> and <i>dwWakeMask</i> parameters were not met.</td>
</tr>
</table><br>
<p>
If the function fails, the return value is 0xFFFFFFFF. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
The <b>MsgWaitForMultipleObjectsEx</b> function determines whether the conditions specified by <i>dwWakeMask</i> and <i>dwFlags </i>have been met. If the conditions have not been met, the calling thread enters an efficient wait state. The thread uses very little processor time while waiting for one of the conditions to be met or for the time-out interval to elapse. </p>
<p>
Before returning, a wait function modifies the state of some types of synchronization objects. Modification occurs only for the object or objects whose signaled state caused the function to return. For example, the system decreases the count of a semaphore object by one. When <i>dwFlags</i> is zero, and multiple objects are in the signaled state, the function chooses one of the objects to satisfy the wait; the states of the objects not selected are unaffected. </p>
<p>
The <b>MsgWaitForMultipleObjectsEx</b> function can specify handles of any of the following object types in the <i>pHandles</i> array: 
<ul>
<li>
Change notification</li>
<li>
Console input</li>
<li>
Event</li>
<li>
Job</li>
<li>
Mutex</li>
<li>
Process</li>
<li>
Semaphore</li>
<li>
Thread</li>
<li>
Waitable timer</li>
</ul>
<p>
For more information, see <a href="synchro_5gqb.htm">Synchronization Objects</a>.</p>
<p>
The QS_ALLPOSTMESSAGE and QS_POSTMESSAGE flags differ in when they are cleared. QS_POSTMESSAGE is cleared when you call <b>GetMessage</b> or <b>PeekMessage</b>, whether or not you are filtering messages. QS_ALLPOSTMESSAGE is cleared when you call <b>GetMessage</b> or <b>PeekMessage</b> without filtering messages (<i>wMsgFilterMin</i> and <i>wMsgFilterMax</i> are 0). This can be useful when you call <b>PeekMessage</b> multiple times to get messages in different ranges. </p>
<p>
<b>Windows CE:</b> Windows CE does not support the QS_HOTKEY value for the <i>dwWakeMask</i> parameter or the MWMO_WAITALL and MWMO_ALERTABLE flags for the <i>dwFlags</i> parameter.</p>
<p>
The <b>MsgWaitForMultipleObjectsEx</b> function copies the handle table, adds to it the message queue event, and calls <b>WaitForMultipleObjects</b>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="synchro_4q3y.htm">Synchronization Overview</a>, <a href="synchro_08z7.htm">Synchronization Functions</a>, <a href="synchro_9kj6.htm"><b>CancelWaitableTimer</b></a>, <a href="synchro_8ub8.htm"><b>CreateEvent</b></a>,<b> <a href="filesio_7wmd.htm">CreateFile</a></b>,<b> <a href="synchro_1a2g.htm">CreateMutex</a></b>,<b> <a href="prothred_9dpv.htm">CreateProcess</a></b>,<b> <a href="prothred_8b38.htm">CreateRemoteThread</a></b>,<b> <a href="synchro_9zol.htm">CreateSemaphore</a></b>,<b> <a href="prothred_4084.htm">CreateThread</a></b>,<b> <a href="synchro_51o2.htm">CreateWaitableTimer</a></b>, <a href="filesio_9hgu.htm"><b>FindFirstChangeNotification</b></a>,<b> <object id=alink_22 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getqueuestatus">
</object><a href=JavaScript:alink_22.Click()>GetQueueStatus</a></b>, <a href="conchar_7k9x.htm"><b>GetStdHandle</b></a>,<b> <a href="synchro_2esz.htm">MsgWaitForMultipleObjects</a></b>,<b> <a href="synchro_5myc.htm">OpenEvent</a></b>,<b> <a href="synchro_82pk.htm">OpenMutex</a></b>,<b> <a href="prothred_478z.htm">OpenProcess</a></b>,<b> <a href="synchro_3y3p.htm">OpenSemaphore</a></b>, <a href="synchro_0lv6.htm"><b>OpenWaitableTimer</b></a>, <a href="synchro_1ylw.htm"><b>PulseEvent</b></a>, <a href="synchro_3dk3.htm"><b>QueueUserAPC</b></a>,<b> <a href="synchro_4f78.htm">ResetEvent</a></b>,<b> <a href="synchro_8ut0.htm">SetEvent</a></b>,<b> <a href="synchro_6f1u.htm">SetWaitableTimer</a></b></p>
<p>&nbsp;</p></body>
</HTML>
