<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Directory Operations</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_directory_operations"></a>Directory Operations</h2>
<p>
When an application creates a new file, the operating system adds it to the specified directory. Each directory can have any number of files, up to the physical limit of the disk. An application can create new directories and delete existing directories by using the <a href="filesio_4sft.htm"><b>CreateDirectory</b></a>, <a href="filesio_9veg.htm"><b>CreateDirectoryEx</b></a>, and <a href="filesio_6oe1.htm"><b>RemoveDirectory</b></a> functions. An application cannot delete a directory unless it is empty. </p>
<p>
The directory at the end of the active path is called the current directory; it is the directory in which the active application started, unless explicitly changed. An application can determine which directory is current by using the <a href="filesio_6g6x.htm"><b>GetCurrentDirectory</b></a> function. An application can change the current directory by using the <a href="filesio_3fg9.htm"><b>SetCurrentDirectory</b></a> function. </p>
<p>
<b>Windows NT:</b> You can obtain a handle to a directory by calling the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function with the FILE_FLAG_BACKUP_SEMANTICS flag set, as follows:</p>
<pre><code>hDir = CreateFile (
    DirName,
    GENERIC_READ,
    FILE_SHARE_READ|FILE_SHARE_DELETE,
    NULL,
    OPEN_EXISTING,
    FILE_FLAG_BACKUP_SEMANTICS,
    NULL
);
 </code></pre>
<p>
You can pass a directory handle to the following functions:</p>
<p>
<a href="tapeback_5t0k.htm"><b>BackupRead</b></a><br>
<a href="tapeback_1fhn.htm"><b>BackupSeek</b></a><br>
<a href="tapeback_3bl1.htm"><b>BackupWrite</b></a><br>
<a href="filesio_2jtx.htm"><b>GetFileInformationByHandle</b></a><br>
<a href="filesio_05id.htm"><b>GetFileSize</b></a><br>
<a href="time_5r51.htm"><b>GetFileTime</b></a><br>
<a href="filesio_75ut.htm"><b>GetFileType</b></a><br>
<a href="filesio_97av.htm"><b>ReadDirectoryChangesW</b></a><br>
<a href="time_33qd.htm"><b>SetFileTime</b></a></p>
<p>&nbsp;</p></body>
</HTML>
