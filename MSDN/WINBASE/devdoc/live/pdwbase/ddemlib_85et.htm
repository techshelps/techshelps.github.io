<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DdeCreateStringHandle</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ddecreatestringhandle"></a>DdeCreateStringHandle</h1>
<p>
The <b>DdeCreateStringHandle</b> function creates a handle that identifies the string pointed to by the <i>psz</i> parameter. A dynamic data exchange (DDE) client or server application can pass the string handle as a parameter to other Dynamic Data Exchange Management Library (DDEML) functions. </p>
<pre><code><b>HSZ DdeCreateStringHandle(
  DWORD</b><i> idInst</i><b>,  </b>// instance identifier
<b>  LPTSTR</b><i> psz</i><b>,    </b>// pointer to null-terminated string
<b>  int</b><i> iCodePage</i>  // code page identifier
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>idInst</i></dt>
<dd>
Specifies the application instance identifier obtained by a previous call to the <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a> function. </dd>
<dt>
<i>psz</i></dt>
<dd>
Pointer to a buffer that contains the null-terminated string for which a handle is to be created. This string may be up to 255 characters. The reason for this limit is that DDEML string management functions are implemented using global atoms.</dd>
<dt>
<i>iCodePage</i></dt>
<dd>
Specifies the code page used to render the string. This value should be either CP_WINANSI (the default code page) or CP_WINUNICODE, depending on whether the ANSI or Unicode version of <b>DdeInitialize</b> was called by the client application. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a string handle.</p>
<p>
If the function fails, the return value is 0L. </p>
<h4>Errors</h4>
<p>
The <a href="ddemlib_89bm.htm"><b>DdeGetLastError</b></a> function can be used to get the error code, which may be one of the following values: </p>
<p>
DMLERR_INVALIDPARAMETER<br>
DMLERR_NO_ERROR<br>
DMLERR_SYS_ERROR</p>
<h4>Remarks</h4>
<p>
The value of a string handle is not related to the case of the string it identifies. </p>
<p>
When an application either creates a string handle or receives one in the callback function and then uses the <a href="ddemlib_34yt.htm"><b>DdeKeepStringHandle</b></a> function to keep it, the application must free that string handle when it is no longer needed. </p>
<p>
An instance-specific string handle cannot be mapped from string handle to string and back to string handle. This is shown in the following example, in which the <a href="ddemlib_0n6v.htm"><b>DdeQueryString</b></a> function creates a string from a string handle and <b>DdeCreateStringHandle</b> creates a string handle from that string, but the two handles are not the same: </p>
<pre><code>DWORD idInst; 
DWORD cb; 
HSZ hszInst, hszNew; 
PSZ pszInst; 
 
DdeQueryString(idInst, hszInst, pszInst, cb, CP_WINANSI); 
hszNew = DdeCreateStringHandle(idInst, pszInst, CP_WINANSI); 
// hszNew != hszInst ! 
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ddeml.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library Overview</a>, <a href="ddemlib_1nn7.htm">Dynamic Data Exchange Management Functions</a>, <a href="ddemlib_1ba9.htm"><b>DdeAccessData</b></a>, <a href="ddemlib_2z77.htm"><b>DdeCmpStringHandles</b></a>, <a href="ddemlib_9sdh.htm"><b>DdeFreeStringHandle</b></a>, <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a>, <a href="ddemlib_34yt.htm"><b>DdeKeepStringHandle</b></a>, <a href="ddemlib_0n6v.htm"><b>DdeQueryString</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
