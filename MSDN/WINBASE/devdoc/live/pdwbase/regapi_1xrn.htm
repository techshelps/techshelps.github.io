<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening, Creating, and Closing Keys</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_opening.2c_.creating.2c_.and_closing_keys"></a>Opening, Creating, and Closing Keys</h2>
<p>
Before an application can add data to the registry, it must create or open a key. To create or open a key, an application always refers to the key as a subkey of a currently open key. The following predefined keys are always open: <b>HKEY_LOCAL_MACHINE</b>, <b>HKEY_CLASSES_ROOT</b>, <b>HKEY_USERS</b>, and <b>HKEY_CURRENT_USER</b>. An application uses the <a href="regapi_0h15.htm"><b>RegOpenKey</b></a> or <a href="regapi_7yns.htm"><b>RegOpenKeyEx</b></a> function to open a key and the <a href="regapi_7zy1.htm"><b>RegCreateKey</b></a> or <a href="regapi_1woo.htm"><b>RegCreateKeyEx</b></a> function to create a key. </p>
<p>
An application can use the <a href="regapi_5fax.htm"><b>RegCloseKey</b></a> function to close a key and write the data it contains into the registry. <b>RegCloseKey</b> does not necessarily write the data to the registry before returning; it can take as much as several seconds for the cache to be flushed to the hard disk. If an application must explicitly write registry data to the hard disk, it can use the <a href="regapi_6x89.htm"><b>RegFlushKey</b></a> function. <b>RegFlushKey</b>, however, uses many system resources and should be called only when absolutely necessary. </p>
<p>&nbsp;</p></body>
</HTML>
