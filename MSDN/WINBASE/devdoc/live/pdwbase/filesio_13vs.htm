<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SearchPath</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_searchpath"></a>SearchPath</h1>
<p>
The <b>SearchPath</b> function searches for the specified file. </p>
<pre><code><b>DWORD SearchPath(
  LPCTSTR</b><i> lpPath</i><b>,      </b>// pointer to search path
<b>  LPCTSTR</b><i> lpFileName</i><b>,  </b>// pointer to filename
<b>  LPCTSTR</b><i> lpExtension</i><b>, </b>// pointer to extension
<b>  DWORD</b><i> nBufferLength</i><b>, </b>// size, in characters, of buffer
<b>  LPTSTR</b><i> lpBuffer</i><b>,     </b>// pointer to buffer for found filename
<b>  LPTSTR</b><i> *lpFilePart</i>   // pointer to pointer to file component
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpPath</i></dt>
<dd>
Pointer to a null-terminated string that specifies the path to be searched for the file. If this parameter is NULL, the function searches for a matching file in the following directories in the following sequence: 
<ol>
<li>
The directory from which the application loaded. </li>
<li>
The current directory. </li>
<li>
<b>Windows 95:</b> The Windows system directory. Use the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsystemdirectory">
</object><a href=JavaScript:alink_1.Click()><b>GetSystemDirectory</b></a> function to get the path of this directory.<p>
<b>Windows NT:</b> The 32-bit Windows system directory. Use the <b>GetSystemDirectory</b> function to get the path of this directory. The name of this directory is SYSTEM32.
</li>
<li>
<b>Windows NT:</b> The 16-bit Windows system directory. There is no Win32 function that obtains the path of this directory, but it is searched. The name of this directory is SYSTEM.</li>
<li>
The Windows directory. Use the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getwindowsdirectory">
</object><a href=JavaScript:alink_2.Click()><b>GetWindowsDirectory</b></a> function to get the path of this directory. </li>
<li>
The directories that are listed in the PATH environment variable. </li>
</ol>
</dd>
<dt>
<i>lpFileName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the file to search for. </dd>
<dt>
<i>lpExtension</i></dt>
<dd>
Pointer to a null-terminated string that specifies an extension to be added to the filename when searching for the file. The first character of the filename extension must be a period (.). The extension is added only if the specified filename does not end with an extension. 
<p>
If a filename extension is not required or if the filename contains an extension, this parameter can be NULL. 
</dd>
<dt>
<i>nBufferLength</i></dt>
<dd>
Specifies the length, in characters, of the buffer that receives the valid path and filename. </dd>
<dt>
<i>lpBuffer</i></dt>
<dd>
Pointer to the buffer for the valid path and filename of the file found. </dd>
<dt>
<i>lpFilePart</i></dt>
<dd>
Pointer to the address (within <i>lpBuffer</i>) of the last component of the valid path and filename, which is the address of the character immediately following the final backslash (\) in the path. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the value returned is the length, in characters, of the string copied to the buffer, not including the terminating null character. If the return value is greater than <i>nBufferLength</i>, the value returned is the size of the buffer required to hold the path. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="filesio_2xm7.htm">File I/O Overview</a>, <a href="filesio_3n5f.htm">File Functions</a>, <a href="filesio_4qcl.htm"><b>FindFirstFile</b></a>, <a href="filesio_4ndx.htm"><b>FindNextFile</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsystemdirectory">
</object><a href=JavaScript:alink_3.Click()><b>GetSystemDirectory</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getwindowsdirectory">
</object><a href=JavaScript:alink_4.Click()><b>GetWindowsDirectory</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
