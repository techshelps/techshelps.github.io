<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LookupAccountSid</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lookupaccountsid"></a>LookupAccountSid</h1>
<p>
The <b>LookupAccountSid</b> function accepts a security identifier (SID) as input. It retrieves the name of the account for this SID and the name of the first domain on which this SID is found. </p>
<pre><code><b>BOOL LookupAccountSid(
  LPCTSTR</b><i> lpSystemName</i><b>, </b>// address of string for system name
<b>  PSID</b><i> Sid</i><b>,             </b>// address of security identifier
<b>  LPTSTR</b><i> Name</i><b>,          </b>// address of string for account name
<b>  LPDWORD</b><i> cbName</i><b>,       </b>// address of size account string
<b>  LPTSTR</b><i> ReferencedDomainName</i><b>,</b>
<b>                        </b>// address of string for referenced domain
<b>  LPDWORD</b><i> cbReferencedDomainName</i><b>,</b>
<b>                        </b>// address of size domain string
<b>  PSID_NAME_USE</b><i> peUse</i>   // address of structure for SID type
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpSystemName</i></dt>
<dd>
Pointer to a null-terminated string specifying the system. This string can be the name of a remote computer. If this string is NULL, the SID is looked up on the local system. </dd>
<dt>
<i>Sid</i></dt>
<dd>
Pointer to a <a href="accctrl_5lyq.htm"><b>SID</b></a> structure for which the account name is looked up. </dd>
<dt>
<i>Name</i></dt>
<dd>
Pointer to a buffer receiving a null-terminated string representing the account name corresponding to the <i>Sid</i> parameter. </dd>
<dt>
<i>cbName</i></dt>
<dd>
Pointer to a <b>DWORD</b> variable. On input, this value specifies the size, in bytes (ANSI version) or characters (Unicode version), of the <i>Name</i> buffer. If the function fails because the buffer is too small, this variable receives the required buffer size, including the terminating null character.</dd>
<dt>
<i>ReferencedDomainName</i></dt>
<dd>
Pointer to a buffer that will receive a null-terminated string giving the name of the domain where the account name was found. 
<p>
For Windows NT systems, the domain name returned for most accounts in the local computer's security database is the computer's name as of the last start of the system. Backslashes are excluded. If the computer's name changes, the old name continues to be returned as the domain name until the system is restarted. 

<p>
For Windows NT Server systems, the domain name returned for most accounts in the local computer's security database is the name of the domain for which the Windows NT Server is a domain controller. 

<p>
Some accounts are predefined by the system. The domain name returned for these accounts is BUILTIN. 
</dd>
<dt>
<i>cbReferencedDomainName</i></dt>
<dd>
Pointer to a <b>DWORD</b> variable. On input, this value specifies the size, in bytes (ANSI version) or characters (Unicode version), of the <i>ReferencedDomainName</i> buffer. If the function fails because the buffer is too small, this variable receives the required buffer size, including the terminating null character.</dd>
<dt>
<i>peUse</i></dt>
<dd>
Pointer to an <a href="accctrl_0x9u.htm"><b>SID_NAME_USE</b></a> enumerated type indicating the type of the account when the function returns. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
The <b>LookupAccountSid</b> function attempts to find a name for the specified security identifier by first checking a list of well-known SIDs. If the supplied SID does not correspond to a well-known SID, the function checks built-in and administratively defined local accounts. Next, the function checks the primary domain. Security identifiers not recognized by the primary domain are checked against the trusted domains corresponding to their SID prefixes. </p>
<p>
<b>LookupAccountSid</b> fails and <b>GetLastError</b> returns ERROR_NONE_MAPPED if it cannot find an account name for the SID. This can occur if a network timeout prevents the function from finding the name. It also occurs for SIDs that have no corresponding account name, such as a logon SID that identifies a logon session.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="accctrl_2hf0.htm">Access Control Overview</a>, <a href="accctrl_6cmr.htm">Access Control Functions</a>, <a href="accctrl_6ysk.htm"><b>EqualPrefixSid</b></a>, <a href="accctrl_9v39.htm"><b>LookupAccountName</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
