<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetThreadExecutionState</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setthreadexecutionstate"></a>SetThreadExecutionState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>SetThreadExecutionState</b> function enables applications to inform the system that it is in use, thereby preventing the system from entering the sleeping power state while the application is running. </p>
<pre><code><b>EXECUTION_STATE SetThreadExecutionState(
  EXECUTION_STATE</b><i> esFlags  </i>// execution requirements
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>esFlags</i></dt>
<dd>
Specifies the thread's execution requirements. This parameter can be one or more of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Flag</th>
<th align=left width=56%>Description</th>
</tr>
<tr valign=top>
<td width=44%>ES_SYSTEM_REQUIRED</td>
<td width=56%>Informs the system that the thread is performing some operation that is not normally detected as activity by the system. </td>
</tr>
<tr valign=top>
<td width=44%>ES_DISPLAY_REQUIRED</td>
<td width=56%>Informs the system that the thread is performing some operation that is not normally detected as display activity by the system. </td>
</tr>
<tr valign=top>
<td width=44%>ES_CONTINUOUS</td>
<td width=56%>Informs the system that the state being set should remain in effect until the next call that uses ES_CONTINUOUS and one of the other state flags is cleared. </td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the previous thread execution state. </p>
<p>
If the function fails, the return value is NULL. </p>
<h4>Remarks</h4>
<p>
Activities that are automatically detected include local keyboard or mouse input, server activity, and changing window focus. Activities that are not automatically detected include disk or CPU activity and video display. </p>
<p>
Calling <b>SetThreadExecutionState</b> with ES_SYSTEM_REQUIRED prevents the system from putting the computer in the sleeping state by resetting the system idle timer. Calling <b>SetThreadExecutionState</b> with ES_DISPLAY_REQUIRED prevents the system from turning off the display by resetting the display idle timer. Calling <b>SetThreadExecutionState</b> without ES_CONTINUOUS simply resets the idle timer; to keep the display or system in the working state, the thread must call <b>SetThreadExecutionState</b> periodically. </p>
<p>
To run properly on a power-managed computer, applications such as fax servers, answering machines, backup agents, and network management applications must use ES_SYSTEM_REQUIRED | ES_CONTINUOUS when they process events. Multimedia applications, such as video players and presentation applications, must use ES_DISPLAY_REQUIRED when they display video for long periods of time without user input. Applications such as word processors, spreadsheets, browsers, and games do not need to call <b>SetThreadExecutionState</b>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="power_0sj8.htm">Power Management Overview</a>, <a href="power_2c4z.htm">Power Management Functions</a>, <a href="power_4wv9.htm"><b>SetSystemPowerState</b></a>, <a href="power_0304.htm">WM_POWERBROADCAST</a></p>
<p>&nbsp;</p></body>
</HTML>
