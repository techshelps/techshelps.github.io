<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetAuditedPermissionsFromAcl</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getauditedpermissionsfromacl"></a>GetAuditedPermissionsFromAcl</h1>
<p>
The <b>GetAuditedPermissionsFromAcl</b> function returns the audited access rights for a specified trustee. The audited rights are based on the access-control entries (ACEs) of a specified access-control list (ACL). The audited access rights indicate the types of access attempts that cause the system to generate an audit record in the system event log. The audited rights include those that the <a href="accctrl_4h6a.htm"><b>ACL</b></a> specifies for the trustee or for any groups of which the trustee is a member. In determining the audited rights, the function does not consider the security privileges held by the trustee.</p>
<pre><code><b>DWORD GetAuditedPermissionsFromAcl(
  PACL</b><i> pacl</i><b>,  </b>// ACL to get trustee's audited rights from
<b>  PTRUSTEE</b><i> pTrustee</i><b>,</b>
<b>              </b>// trustee to get rights for
<b>  PACCESS_MASK</b><i> pSuccessfulAuditedRights</i><b>,</b>
<b>              </b>// receives rights audited for successful access
<b>  PACCESS_MASK</b><i> pFailedAuditRights</i>
<i>              </i>// receives rights audited for failed access
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pacl</i></dt>
<dd>
Pointer to an ACL from which to get the trustee's audited access rights. </dd>
<dt>
<i>pTrustee</i></dt>
<dd>
Pointer to a <a href="accctrl_6hki.htm"><b>TRUSTEE</b></a> structure that identifies the trustee. A trustee can be a user, group, or program (such as a Win32 service). You can use a name or a security identifier (<a href="accctrl_5lyq.htm"><b>SID</b></a>) to identify a trustee. </dd>
<dt>
<i>pSuccessfulAuditedRights</i></dt>
<dd>
Pointer to an <a href="accctrl_1vci.htm"><b>ACCESS_MASK</b></a> variable that receives a set of access rights. The system generates an audit record when the trustee successfully uses any of these access rights. </dd>
<dt>
<i>pFailedAuditRights</i></dt>
<dd>
Pointer to an <b>ACCESS_MASK</b> variable that receives a set of access rights based on the access-control entries in the specified ACL. The system generates an audit record when the trustee fails in an attempt to use any of these rights. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a nonzero error code defined in WINERROR.H. </p>
<h4>Remarks</h4>
<p>
The <b>GetAuditedPermissionsFromAcl</b> function checks all system-audit ACEs in the ACL to determine the audited rights for the trustee. For all ACEs that specify audited rights for a group, <b>GetAuditedPermissionsFromAcl</b> enumerates the members of the group to determine whether the trustee is a member. The function returns an error if it cannot enumerate the members of a group.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in aclapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="acctlnt4_0h7w.htm">Windows NT 4.0 Access Control Overview</a>, <a href="acctlnt4_0vzn.htm">Windows NT 4.0 Access-Control Functions</a>, <a href="accctrl_1vci.htm"><b>ACCESS_MASK</b></a>, <a href="accctrl_7bhu.htm"><b>ACE</b></a>, <a href="accctrl_4h6a.htm"><b>ACL</b></a>, <a href="acctlnt4_6s6k.htm"><b>GetEffectiveRightsFromAcl</b></a>, <a href="accctrl_5lyq.htm"><b>SID</b></a>, <a href="acctrlow_66ia.htm"><b>SYSTEM_AUDIT_ACE</b></a>, <a href="accctrl_6hki.htm"><b>TRUSTEE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
