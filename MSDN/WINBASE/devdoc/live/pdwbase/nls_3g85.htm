<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Time and Date</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_time_and_date"></a>Time and Date</h2>
<p>
You can retrieve strings for any given time or date in a format that is appropriate for the current locale by using the <a href="nls_6at0.htm"><b>GetTimeFormat</b></a> and <a href="nls_5w6s.htm"><b>GetDateFormat</b></a> functions.</p>
<p>
For <b>GetTimeFormat</b>, the time values in the <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> structure pointed to by <i>lpTime</i> must be valid. The function checks each of the time values to determine that it is within the appropriate range of values. If any of the time values are outside the correct range, the function fails, and sets the last-error to ERROR_INVALID_PARAMETER. </p>
<p>
The function ignores the date portions of the <b>SYSTEMTIME</b> structure pointed to by <i>lpTime</i>: <b>wYear</b>, <b>wMonth</b>, <b>wDayOfWeek</b>, and <b>wDay</b>. </p>
<p>
If a time marker exists and the TIME_NOTIMEMARKER flag is not set, the function localizes the time marker based on the specified locale identifier. Examples of time markers are "AM" and "PM" for US English, "de." and "du." for Mexican Spanish. </p>
<p>
If TIME_NOMINUTESORSECONDS or TIME_NOSECONDS is specified, the function removes the separator(s) preceding the minutes and/or seconds element(s). </p>
<p>
If TIME_NOTIMEMARKER is specified, the function removes the separator(s) preceding and following the time marker. </p>
<p>
If TIME_FORCE24HOURFORMAT is specified, the function displays any existing time marker, unless the TIME_NOTIMEMARKER flag is also set. </p>
<p>
The function does not include milliseconds as part of the formatted time string. </p>
<p>
To use the LOCALE_NOUSEROVERRIDE flag, <i>lpFormat</i> must be NULL. </p>
<p>
No errors are returned for a bad format string. The function simply forms the best time string that it can. If more than two hour, minute, second, or time marker format pictures are passed in, then the function defaults to two. For example, the only time marker pictures that are valid are L"t" and L"tt" (the 'L' indicates a Unicode (16-bit characters) string). If L"ttt" is passed in, the function assumes L"tt". </p>
<p>
For <a href="nls_5w6s.htm"><b>GetDateFormat</b></a>, the date values in the <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> structure pointed to by <i>lpDate</i> must be valid. The function checks each of the date values: year, month, day, and day of week. If the day of the week is incorrect, the function uses the correct value, and returns no error. If any of the other date values are outside the correct range, the function fails, and sets the last-error to ERROR_INVALID_PARAMETER. </p>
<p>
The day name, abbreviated day name, month name, and abbreviated month name are all localized based on the given locale identifier. The function ignores the time portions of the <b>SYSTEMTIME</b> structure pointed to by <i>lpDate</i>: <b>wHour</b>, <b>wMinute</b>, <b>wSecond</b>, and <b>wMilliseconds</b>. </p>
<p>
The flag DATE_USE_ALT_CALENDAR will always use the format defined as the default format for that alternate calendar, rather than using any user overrides.  The user overrides will only be used in the event that there is no default format for the alternate calendar specified.</p>
<p>
The DATE_SHORTDATE and DATE_LONGDATE flag options are mutually exclusive. If neither one is specified and <i>lpFormat</i> is NULL, then DATE_SHORTDATE is the default. </p>
<p>
If the <i>lpFormat</i> parameter is not NULL, the <i>dwFlags</i> parameter must be zero. None of the flags make sense when the format string is specified. </p>
<p>
No errors are returned for a bad format string. The function simply forms the best date string that it can. For example, the only year pictures that are valid are L"yyyy" and L"yy" (the 'L' indicates a Unicode (16-bit characters) string). If L"y" is passed in, the function  assumes L"yy". If L"yyy" is passed in, the function assumes L"yyyy". If more than 4 date (L"dddd") or 4 month (L"MMMM") pictures are passed in, then the function defaults to L"dddd" or L"MMMM". </p>
<p>
Any text that should remain in its exact form in the date string should be enclosed within single quotes in the date format picture. The single quote may also be used as an escape character to allow the single quote itself to be displayed in the date string. However, the escape sequence must be enclosed within two single quotes.  For example, to display the date as "May '93", the format string would be:  L"MMMM ''''yy " The first and last single quotes are the enclosing quotes.  The second and third single quotes are the escape sequence to allow the single quote to be displayed before the century.</p>
<p>&nbsp;</p></body>
</HTML>
