<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Execute Transaction</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_execute_transaction"></a>Execute Transaction</h3>
<p>
A client can use the <a href="ddemlib_9339.htm">XTYP_EXECUTE</a> transaction to cause a server to execute a command or a series of commands. </p>
<p>
To execute a server command, the client first creates a buffer that contains a command string for the server to execute and then passes either a pointer to the buffer or a data handle identifying the buffer when it calls <a href="ddemlib_1gha.htm"><b>DdeClientTransaction</b></a>. Other required parameters include the conversation handle, the item name string handle, the format specification, and the XTYP_EXECUTE transaction type. An application that creates a data handle for passing execute data must specify NULL for the <i>hszItem</i> parameter of the <a href="ddemlib_0tt1.htm"><b>DdeCreateDataHandle</b></a> function and zero for the <i>uFmt</i> parameter. </p>
<p>
The DDEML passes the XTYP_EXECUTE transaction to the server's DDE callback function and specifies the format name, conversation handle, topic name, and data handle identifying the command string. If the server supports the command, it should use the <a href="ddemlib_1ba9.htm"><b>DdeAccessData</b></a> function to obtain a pointer to the command string, execute the command, and then return DDE_FACK. If the server does not support the command or cannot complete the transaction, it should return DDE_FNOTPROCESSED. The server should return DDE_FBUSY if it is too busy to complete the transaction. </p>
<p>
In general, a server's callback function should process the XTYP_EXECUTE transaction before returning with the following exceptions: 
<ol>
<li>
When the command passed with the <a href="ddemlib_9339.htm">XTYP_EXECUTE</a> transaction requests the server to terminate, the server should not terminate until its callback function returns from processing XTYP_EXECUTE. </li>
<li>
If the server must perform an operation, such as processing a dialog box or a DDE transaction that might cause DDEML recursion problems, the server should return the CBR_BLOCK return code to block the execute transaction, perform the operation, and then resume processing the execute transaction. </li>
</ol>
<p>
When <a href="ddemlib_1gha.htm"><b>DdeClientTransaction</b></a> returns, the client can use the <i>lpdwResult</i> parameter to access the transaction status flag. If the flag is DDE_FBUSY, the client should send the transaction again later. </p>
<p>
If a server does not support the <a href="ddemlib_9339.htm">XTYP_EXECUTE</a> transaction, it should specify the CBF_FAIL_EXECUTES filter flag in the <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a> function. Doing so prevents the DDEML from sending the transaction to the server. </p>
<p>&nbsp;</p></body>
</HTML>
