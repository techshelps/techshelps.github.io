<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Process Connection to a Window Station</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_process_connection_to_a_window_station"></a>Process Connection to a Window Station</h2>
<p>
A process automatically establishes a connection to a window station and desktop when it first calls a USER32 or GDI32 function (other than the window station or desktop functions) that must go to the Win32 server. The Win32 server determines the window station to which a process connects according to the following rules:
<ol>
<li>
If the process has called the <a href="winsta_34tq.htm"><b>SetProcessWindowStation</b></a> function, it connects to the window station specified in that call.</li>
<li>
If the process did not call <b>SetProcessWindowStation</b>, it connects to the window station inherited from the parent process.</li>
<li>
If the process did not call <b>SetProcessWindowStation</b> and did not inherit a window station, the Win32 server attempts to open for MAXIMUM_ALLOWED access and connect to a window station as follows:<ol type=a>
<li>
If a window station name was specified in the <b>lpDesktop</b> member of the <a href="prothred_7sdu.htm"><b>STARTUPINFO</b></a> structure that was passed to the <a href="prothred_9dpv.htm"><b>CreateProcess</b></a> function when the process was created, the process connects to the specified window station.</li>
<li>
Otherwise, if the process is running in the logon session of the interactive user, the process connects to the interactive window station.</li>
<li>
If the process is running in a noninteractive logon session, the window station name is formed based on the logon session identifier and an attempt is made to open that window station. If the open operation fails because this window station does not exist, Win32 tries to create the window station and a default desktop. </li>
</ol>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
