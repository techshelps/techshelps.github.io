<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DdeNameService</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ddenameservice"></a>DdeNameService</h1>
<p>
The <b>DdeNameService</b> function registers or unregisters the service names a dynamic data exchange (DDE) server supports. This function causes the system to send <a href="ddemlib_7lf6.htm">XTYP_REGISTER</a> or <a href="ddemlib_8yeq.htm">XTYP_UNREGISTER</a> transactions to other running <a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library</a> (DDEML) client applications. </p>
<p>
A server application should call this function to register each service name that it supports and to unregister names it previously registered but no longer supports. A server should also call this function to unregister its service names just before terminating. </p>
<pre><code><b>HDDEDATA DdeNameService(
  DWORD</b><i> idInst</i><b>,  </b>// instance identifier
<b>  HSZ</b><i> hsz1</i><b>,      </b>// handle to service name string
<b>  HSZ</b><i> hsz2</i><b>,      </b>// reserved
<b>  UINT</b><i> afCmd</i>     // service name flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>idInst</i></dt>
<dd>
Specifies the application instance identifier obtained by a previous call to the <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a> function. </dd>
<dt>
<i>hsz1</i></dt>
<dd>
Handle to the string that specifies the service name the server is registering or unregistering. An application that is unregistering all of its service names should set this parameter to 0L. </dd>
<dt>
<i>hsz2</i></dt>
<dd>
Reserved; should be set to 0L. </dd>
<dt>
<i>afCmd</i></dt>
<dd>
Specifies the service name flags. This parameter can be one of the following flags: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Flag</th>
<th align=left width=67%>Meaning</th>
</tr>
<tr valign=top>
<td width=33%>DNS_REGISTER</td>
<td width=67%>Registers the error code service name.</td>
</tr>
<tr valign=top>
<td width=33%>DNS_UNREGISTER</td>
<td width=67%>Unregisters the error code service name. If the <i>hsz1</i> parameter is 0L, all service names registered by the server will be unregistered.</td>
</tr>
<tr valign=top>
<td width=33%>DNS_FILTERON</td>
<td width=67%>Turns on service name initiation filtering. The filter prevents a server from receiving XTYP_CONNECT transactions for service names it has not registered. This is the default setting for this filter.</td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=67%>If a server application does not register any service names, the application cannot receive XTYP_WILDCONNECT transactions.</td>
</tr>
<tr valign=top>
<td width=33%>DNS_FILTEROFF</td>
<td width=67%>Turns off service name initiation filtering. If this flag is specified, the server receives an XTYP_CONNECT transaction whenever another DDE application calls the <a href="ddemlib_9i9g.htm"><b>DdeConnect</b></a> function, regardless of the service name.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the funcion succeeds, it returns a nonzero value. That value is not a true HDDEDATA value, merely a Boolean indicator of success. The function is typed HDDEDATA to allow for possible future expansion of the function and a more sophisticated return value. </p>
<p>
If the function fails, the return value is 0L. </p>
<h4>Errors</h4>
<p>
The <a href="ddemlib_89bm.htm"><b>DdeGetLastError</b></a> function can be used to get the error code, which may be one of the following values: </p>
<p>
DMLERR_DLL_NOT_INITIALIZED<br>
DMLERR_DLL_USAGE<br>
DMLERR_INVALIDPARAMETER<br>
DMLERR_NO_ERROR</p>
<h4>Remarks</h4>
<p>
The service name identified by the <i>hsz1</i> parameter should be a base name (that is, the name should contain no instance-specific information). The system generates an instance-specific name and sends it along with the base name during the XTYP_REGISTER and XTYP_UNREGISTER transactions. The receiving applications can then connect to the specific application instance. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ddeml.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library Overview</a>, <a href="ddemlib_1nn7.htm">Dynamic Data Exchange Management Functions</a>, <a href="ddemlib_9i9g.htm"><b>DdeConnect</b></a>, <a href="ddemlib_052s.htm"><b>DdeConnectList</b></a>, <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a>, <a href="ddemlib_7lf6.htm">XTYP_REGISTER</a>, <a href="ddemlib_8yeq.htm">XTYP_UNREGISTER</a> </p>
<p>&nbsp;</p></body>
</HTML>
