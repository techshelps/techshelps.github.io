<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Querying the Event Log</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_querying_the_event_log"></a>Querying the Event Log</h2>
<p>
If you want to find out how many event records are in the event log, use the <a href="eventlog_746r.htm"><b>GetNumberOfEventLogRecords</b></a> function. The following example displays the number of event records in the <b>Application</b> event log and the <b>System</b> event log. It opens the logs using the <a href="eventlog_3elj.htm"><b>OpenEventLog</b></a> function and obtains the number of records using <b>GetNumberOfEventLogRecords</b>.</p>
<pre><code>void DisplayEventCount()
{
    HANDLE h;
    DWORD cRecords; 

    // Open the System log. 
 
    h = OpenEventLog(NULL,  // uses local computer 
             "System");     // source name 
    if (h == NULL) 
        ErrorExit("Could not open the System event log."); 
 
    // Get the number of records in the System event log. 
 
    if (!GetNumberOfEventLogRecords(h, &amp;cRecords)) 
        ErrorExit("Could not get the number of records."); 
 
    printf("There are %d records in the System event log.\n", 
        cRecords); 
 
    CloseEventLog(h); 
 
    // Open the Application log. 
 
    h = OpenEventLog(NULL,    // uses local computer  
             "Application");  // source name 
    if (h == NULL) 
        ErrorExit("Could not open the Application event log."); 
 
    // Get the number of records in the Application event log. 
 
    if (!GetNumberOfEventLogRecords(h, &amp;cRecords)) 
        ErrorExit("Could not get number of records."); 
 
    printf("There are %d records in the Application event log.\n", 
        cRecords); 
 
    CloseEventLog(h); 
} 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
