<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LZOpenFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lzopenfile"></a>LZOpenFile</h1>
<p>
The <b>LZOpenFile</b> function creates, opens, reopens, or deletes the specified file. </p>
<pre><code><b>INT LZOpenFile(
  LPTSTR</b><i> lpFileName</i><b>,       </b>// address of name of file to be opened
<b>  LPOFSTRUCT</b><i> lpReOpenBuf</i><b>,  </b>// address of open file structure
<b>  WORD</b><i> wStyle</i>              // action to take
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpFileName</i></dt>
<dd>
Pointer to a string that specifies the name of a file. </dd>
<dt>
<i>lpReOpenBuf</i></dt>
<dd>
Pointer to the <a href="filesio_2vw2.htm"><b>OFSTRUCT</b></a> structure that is to receive information about the file when the file is first opened. The structure can be used in subsequent calls to the <b>LZOpenFile</b> function to refer to the open file. 
<p>
The <b>szPathName</b> member of this structure contains characters from the original equipment manufacturer (OEM) character set. 
</dd>
<dt>
<i>wStyle</i></dt>
<dd>
Specifies the action to take. This parameter can be a combination of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=42%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=42%>OF_CANCEL</td>
<td width=58%>Ignored. In the Win32-based application programming interface (API), the OF_PROMPT style produces a dialog box containing a <b>Cancel</b> button.</td>
</tr>
<tr valign=top>
<td width=42%>OF_CREATE</td>
<td width=58%>Directs <b>LZOpenFile</b> to create a new file. If the file already exists, it is truncated to zero length.</td>
</tr>
<tr valign=top>
<td width=42%>OF_DELETE</td>
<td width=58%>Deletes the file.</td>
</tr>
<tr valign=top>
<td width=42%>OF_EXIST</td>
<td width=58%>Opens the file and then closes it to test for a file's existence.</td>
</tr>
<tr valign=top>
<td width=42%>OF_PARSE</td>
<td width=58%>Fills the <b>OFSTRUCT</b> structure but carries out no other action.</td>
</tr>
<tr valign=top>
<td width=42%>OF_PROMPT</td>
<td width=58%>Displays a dialog box if the requested file does not exist. The dialog box informs the user that the system cannot find the file, and it contains <b>Retry</b> and <b>Cancel</b> buttons. Clicking the <b>Cancel</b> button directs <b>LZOpenFile</b> to return a <i>file not found</i> error message.</td>
</tr>
<tr valign=top>
<td width=42%>OF_READ</td>
<td width=58%>Opens the file for reading only.</td>
</tr>
<tr valign=top>
<td width=42%>OF_READWRITE</td>
<td width=58%>Opens the file for reading and writing.</td>
</tr>
<tr valign=top>
<td width=42%>OF_REOPEN</td>
<td width=58%>Opens the file using information in the reopen buffer.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_NONE</td>
<td width=58%>Opens the file without denying other processes read or write access to the file. <b>LZOpenFile</b> fails if the file has been opened in compatibility mode by any other process.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_READ</td>
<td width=58%>Opens the file and denies other processes read access to the file. <b>LZOpenFile</b> fails if the file has been opened in compatibility mode or has been opened for read access by any other process.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_WRITE</td>
<td width=58%>Opens the file and denies other processes write access to the file. <b>LZOpenFile</b> fails if the file has been opened in compatibility mode or has been opened for write access by any other process.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_EXCLUSIVE</td>
<td width=58%>Opens the file in exclusive mode, denying other processes both read and write access to the file. <b>LZOpenFile</b> fails if the file has been opened in any other mode for read or write access, even by the current process.</td>
</tr>
<tr valign=top>
<td width=42%>OF_WRITE</td>
<td width=58%>Opens the file for writing only.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds and the value specified by the <i>wStyle</i> parameter is not OF_READ, the return value is a handle identifying the file. If the file is compressed and opened with <i>wStyle</i> set to OF_READ, the return value is a special file handle. </p>
<p>
If the function fails, the return value is an LZERROR_* code. These codes have values less than zero. There is no extended error information for this function; do not call <b>GetLastError</b>.</p>
<p>
<b>Note</b>&nbsp;&nbsp;<b>LZOpenFile</b> calls neither <b>SetLastError</b> nor <b>SetLastErrorEx</b>; thus, its failure does not affect a thread's last-error code. </p>
<p>
Here is a list of the LZERROR_* codes that <b>LZOpenFile</b> can return upon failure: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%>Value</th>
<th align=left width=61%>Meaning</th>
</tr>
<tr valign=top>
<td width=39%>LZERROR_BADINHANDLE</td>
<td width=61%>The handle identifying the source file is not valid. The file cannot be read.</td>
</tr>
<tr valign=top>
<td width=39%>LZERROR_GLOBALLOC</td>
<td width=61%>The maximum number of open compressed files has been exceeded or local memory cannot be allocated.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
If the <i>wStyle</i> parameter is the OF_READ flag (or OF_READ and any of the OF_SHARE_ flags) and the file is compressed, <b>LZOpenFile</b> calls the <a href="datadcmp_2x84.htm"><b>LZInit</b></a> function, which performs the required initialization for the decompression operations. </p>
<p>
The handle this function returns is compatible only with the functions in LZEXPAND.DLL; it should not be used for other file operations. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lzexpand.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use lz32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="datadcmp_3qm1.htm">Data Decompression Library Overview</a>, <a href="datadcmp_5h4j.htm">Data Decompression Library Functions</a>, <a href="datadcmp_8skl.htm"><b>LZClose</b></a>, <a href="datadcmp_2x84.htm"><b>LZInit</b></a>, <a href="datadcmp_2otg.htm"><b>LZRead</b></a></p>
<p>&nbsp;</p></body>
</HTML>
