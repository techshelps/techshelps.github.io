<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Terminating a Process</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_terminating_a_process"></a>Terminating a Process</h3>
<p>
A process executes until one of the following events occurs: 
<ul>
<li>
Any thread of the process calls the <a href="prothred_8dv7.htm"><b>ExitProcess</b></a> function. This terminates all threads of the process. </li>
<li>
The primary thread of the process returns. The primary thread can avoid terminating other threads by explicitly calling <a href="prothred_531g.htm"><b>ExitThread</b></a> before it returns. One of the remaining threads can still call <b>ExitProcess</b> to ensure that all threads are terminated. </li>
<li>
The last thread of the process terminates. </li>
<li>
Any thread calls the <a href="prothred_1bg3.htm"><b>TerminateProcess</b></a> function with a handle to the process. This terminates all threads of the process, without allowing them to clean up or save data. </li>
<li>
For console processes, the default handler function calls <a href="prothred_8dv7.htm"><b>ExitProcess</b></a> when the console receives a ctrl+c or ctrl+break signal. All console processes attached to the console receive these signals. Detached processes and GUI processes are not affected by ctrl+c or ctrl+break signals. For more information, see <a href="conchar_599u.htm"><b>SetConsoleCtrlHandler</b></a>. </li>
<li>
The user shuts down the system or logs off. Use the <a href="prothred_13eb.htm"><b>SetProcessShutdownParameters</b></a> function to specify shutdown parameters, such as when a process should terminate relative to the other processes in the system. The <a href="prothred_4s4z.htm"><b>GetProcessShutdownParameters</b></a> function retrieves the current shutdown priority of the process and other shutdown flags. </li>
</ul>
<p>
When a process is terminated, all threads of the process are terminated immediately with no chance to run additional code. This means that the process does not execute code in termination handler blocks. For more information, see <a href="structex_03xj.htm">Structured Exception Handling</a>. </p>
<p>
The <a href="prothred_4k6r.htm"><b>GetExitCodeProcess</b></a> function returns the termination status of a process. While a process is executing, its termination status is STILL_ACTIVE. When a process terminates, its termination status changes from STILL_ACTIVE to the exit code of the process. The exit code is either the value specified in the call to <a href="prothred_8dv7.htm"><b>ExitProcess</b></a> or <a href="prothred_1bg3.htm"><b>TerminateProcess</b></a>, or the value returned by the main or <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_winmain">
</object><a href=JavaScript:alink_1.Click()><b>WinMain</b></a> function of the process. If a process is terminated due to a fatal exception, the exit code is the value of the exception that caused the termination. In addition, this value is used as the exit code for all the threads that were executing when the exception occurred. </p>
<p>
When a process terminates, the state of the process object becomes signaled, releasing any threads that had been waiting for the process to terminate. For more about synchronization, see <a href="prothred_3ng3.htm">Synchronizing Execution of Multiple Threads</a>. </p>
<p>
Open handles to files or other resources are closed automatically when a process terminates. However, the objects themselves exist until all open handles to them are closed. This means that an object remains valid after a process closes, if another process has a handle to it. </p>
<p>
If a process is terminated by <a href="prothred_8dv7.htm"><b>ExitProcess</b></a>, the system calls the entry-point function of each attached DLL with a value indicating that the process is detaching from the DLL. DLLs are not notified when a process is terminated by <a href="prothred_1bg3.htm"><b>TerminateProcess</b></a>. For more information about DLLs, see <a href="dll_512r.htm">Dynamic-Link Libraries</a>. </p>
<p>
<b>Warning</b>&nbsp;&nbsp;The <b>TerminateProcess</b> function should be used only in extreme circumstances, since it does not allow threads to clean up or save data and does not notify attached DLLs. If you need to have one process terminate another process, the following steps provide a better solution:
<ul>
<li>
Have both processes call the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_registerwindowmessage">
</object><a href=JavaScript:alink_2.Click()><b>RegisterWindowMessage</b></a> function to create a private message.</li>
<li>
One process can terminate the other process by broadcasting the private message using the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_broadcastsystemmessage">
</object><a href=JavaScript:alink_3.Click()><b>BroadcastSystemMessage</b></a> function as follows:<pre><code>BroadcastSystemMessage( 
    BSF_IGNORECURRENTTASK, // do not send message to this process
    BSM_APPLICATIONS,      // broadcast only to applications
    <i>private message,</i>       // message registered in previous step
    wParam,                // message-specific value
    lParam );              // message-specific value
 </code></pre>
</li>
<li>
The process receiving the private message calls <a href="prothred_8dv7.htm"><b>ExitProcess</b></a> to terminate its execution. </li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;When the system is terminating a process, it does not terminate any child processes that the process has created. </p>
<p>&nbsp;</p></body>
</HTML>
