<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhOpenQuery (VB)</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhopenquery_vb_"></a>PdhOpenQuery (VB)</h1>
<p>
The Visual Basic <a href="pdhref_1bax.htm"><b>PdhOpenQuery</b></a> function creates and initializes a unique query structure that is used to manage the collection of performance data.</p>
<pre><code><b>PdhOpenQuery(
  ByRef QueryHandle as</b><i> Long)  </i>
<b>as Long</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>QueryHandle</i><b> </b></dt>
<dd>
A variable that is cleared (equals 0) before the function is called and, if the function is successful, contains the unique ID of the query that is created and opened. This handle is used in the subsequent calls to other PDH functions to identify the query.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns a <b>Long</b> integer equal to ERROR_SUCCESS and a new handle in the <i>QueryHandle</i><b> </b>variable.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhdefs.txt. The following are possible error values:
<dl>
<dt>
PDH_INVALID_ARGUMENT</dt>
<dd>
The argument is invalid or incorrect.</dd>
<dt>
PDH_MEMORY_ALLOCATION_FAILURE</dt>
<dd>
A temporary memory buffer could not be allocated.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
