<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhCloseQuery (VB)</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhclosequery_vb_"></a>PdhCloseQuery (VB)</h1>
<p>
The Visual Basic <a href="pdhref_55kp.htm"><b>PdhCloseQuery</b></a> function closes the specified query and all counters related to that query. All resources allocated for the query and its counters are freed. The handles of counters added to this query should be deleted or zeroed and not used after the query they belong to is deleted.</p>
<pre><code><b>PdhCloseQuery(
  ByVal QueryHandle as</b><i> Long)  </i>
<b>as Long</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>QueryHandle</i><b> </b></dt>
<dd>
The ID of the query to close and delete. Closing a query closes all the counters associated with the query. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns a <b>Long</b> integer equal to ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhdefs.txt. The following is a possible error value:
<dl>
<dt>
PDH_INVALID_HANDLE</dt>
<dd>
The handle is invalid.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
