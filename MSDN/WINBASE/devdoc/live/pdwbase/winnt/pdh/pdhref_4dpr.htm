<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhGetCounterInfo</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhgetcounterinfo"></a>PdhGetCounterInfo</h1>
<p>
The <b>PdhGetCounterInfo</b> function retrieves information about a counter, such as data size, counter type, path, and user-supplied data values.</p>
<pre><code><b>PDH_STATUS PdhGetCounterInfo(
  IN HQUERY</b><i> hCounter</i><b>,        </b>// handle of the counter
<b>  IN BOOLEAN</b><i> bRetrieveExplainText</i><b>,</b>
<b>                             </b>// TRUE to retrieve explain text
<b>  IN LPDWORD</b><i> pdwBufferSize</i><b>,  </b>// pointer to size of <i>lpBuffer</i>
<b>  IN PPDH_COUNTER_INFO</b><i> lpBuffer  </i>// buffer for counter information
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hCounter</i></dt>
<dd>
The handle of the counter from which to retrieve the information.</dd>
<dt>
<i>bRetrieveExplainText</i></dt>
<dd>
Determines whether explain text is retrieved. If you set this parameter to TRUE, then the explain text for the counter is retrieved. If you set this parameter to FALSE, the field in the returned buffer is NULL.</dd>
<dt>
<i>pdwBufferSize</i></dt>
<dd>
A pointer to the size, in bytes, of the buffer passed in <i>lpBuffer</i>. If the counter requires a buffer larger than is indicated by <i>pdwBufferSize</i>, then <b>PdhGetCounterInfo</b> will return the required buffer size in this field. If the function succeeds, then this field will contain the size of the data returned in <i>lpBuffer</i>. If the size is zero, then no data will be returned in the buffer (in fact, <i>lpBuffer</i> can be NULL); and the size, in bytes, will be returned in the <b>DWORD</b>.</dd>
<dt>
<i>lpBuffer</i></dt>
<dd>
A pointer to the data buffer to receive the counter information. The buffer returned is variable-length, because the string data is appended to the end of the fixed-format portion of the structure. This is done so that all data is returned in a single buffer allocated by the caller.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhmsg.h. The following are possible error values:
<dl>
<dt>
PDH_INVALID_ARGUMENT</dt>
<dd>
An argument is not correct or is incorrectly formatted.</dd>
<dt>
PDH_INVALID_HANDLE</dt>
<dd>
The counter handle is not valid.</dd>
<dt>
PDH_MORE_DATA</dt>
<dd>
The buffer supplied is not large enough to receive the requested data.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a>, , <a href="pdhref_3fjm.htm"><b>PDH_COUNTER_INFO</b></a></p>
<p>&nbsp;</p></body>
</HTML>
