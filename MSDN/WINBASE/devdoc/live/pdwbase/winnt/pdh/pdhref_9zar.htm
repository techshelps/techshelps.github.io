<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhEnumObjects</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhenumobjects"></a>PdhEnumObjects</h1>
<p>
The <b>PdhEnumObjects</b> function returns a list of objects available on the specified machine.</p>
<pre><code><b>PDH_STATUS PdhEnumObjects(
  IN LPCTSTR</b><i> szReserved</i><b>,    </b>// reserved
<b>  IN LPCTSTR</b><i> szMachineName</i><b>,  </b>// machine name
<b>  IN LPTSTR</b><i> mszObjectList</i><b>,  </b>// buffer for objects
<b>  IN LPDWORD</b><i> pcchBufferLength</i><b>,  </b>// size of buffer
<b>  IN DWORD</b><i> dwDetailLevel</i><b>,   </b>// detail level
<b>  IN BOOL</b><i> bRefresh          </i>// refresh flag for connected machines
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szReserved</i></dt>
<dd>
Reserved. Must be NULL.</dd>
<dt>
<i>szMachineName</i></dt>
<dd>
The name of the machine on which to list the objects. If the machine specified is not in the list of currently connected machines, the PDH will try to connect to the machine and add it to the list.</dd>
<dt>
<i>mszObjectList</i></dt>
<dd>
The buffer allocated by the calling function that is to receive the MULTI_SZ list of objects available on the specified machine. This parameter may be NULL if the value of the <b>DWORD</b> pointed to by <i>pcchBufferLength</i> is 0.</dd>
<dt>
<i>pcchBufferLength</i></dt>
<dd>
A pointer to the <b>DWORD</b> containing the size, in characters, of the available buffer on entry and the size of the returned buffer on exit. If the buffer size on entry is zero, then no data is returned in the <i>mszObjectList</i> buffer, and that parameter may be NULL. However, the size of the buffer required, in characters, is returned in the <b>DWORD</b> pointed to by <i>pcchBufferLength</i>. The size returned includes both terminating NULL characters of the MULTI_SZ string.</dd>
<dt>
<i>dwDetailLevel</i></dt>
<dd>
The detail level of the performance items to return. All items that are of the specified detail level or less will be returned.</dd>
<dt>
<i>bRefresh</i></dt>
<dd>
Indicates that a new list of objects should be obtained from the specified machine. If the machine is not currently connected by the PDH, then this flag is ignored and the list is refreshed automatically.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhmsg.h. The following are possible error values:
<dl>
<dt>
PDH_MORE_DATA</dt>
<dd>
There are more entries available to return than there is room in the buffer. Some entries might be returned in the buffer, however.</dd>
<dt>
PDH_INSUFFICIENT_BUFFER</dt>
<dd>
The buffer provided is not large enough to contain any data.</dd>
<dt>
PDH_INVALID_ARGUMENT</dt>
<dd>
A required argument is invalid or a reserved argument is not NULL.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When you request a required buffer size, the <i>bRefresh</i> flag should be FALSE for all subsequent calls to this function. Otherwise, the size might not be valid. </p>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a>, , <a href="pdhref_4wv9.htm"><b>PdhConnectMachine</b></a>, <a href="pdhref_5ctv.htm"><b>PdhEnumMachines</b></a></p>
<p>&nbsp;</p></body>
</HTML>
