<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhConnectMachine</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhconnectmachine"></a>PdhConnectMachine</h1>
<p>
The <b>PdhConnectMachine</b> function connects to the specified machine, and creates and initializes a machine entry in the PDH DLL.</p>
<pre><code><b>PDH_STATUS PdhConnectMachine(
  IN LPCTSTR</b><i> szMachineName  </i>// machine to browse
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szMachineName</i></dt>
<dd>
The name of the machine to browse.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhmsg.h. The following are possible error values:
<dl>
<dt>
PDH_CSTATUS_NO_MACHINE</dt>
<dd>
Unable to connect to the specified machine. Could be caused by the machine not being on, not running Windows NT, not being connected to the network, or having the permissions set on the registry to not allow remote connections or remote performance monitoring by the user.</dd>
<dt>
PDH_MEMORY_ALLOCATION_FAILURE</dt>
<dd>
Unable to allocate a dynamic memory block. Occurs when there is a serious memory shortage in the system due to too many applications running on the system or an insufficient memory paging file.
</dd>
</dl>
<h4>Remarks</h4>
<p>
An application can call <b>PdhConnectMachine</b> to establish a connection to a remote machine at a more convenient time than when the application opens a query and adds counters.</p>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a>, , <a href="pdhref_5ctv.htm"><b>PdhEnumMachines</b></a></p>
<p>&nbsp;</p></body>
</HTML>
