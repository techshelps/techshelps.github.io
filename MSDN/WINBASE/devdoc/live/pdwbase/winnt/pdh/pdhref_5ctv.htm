<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhEnumMachines</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhenummachines"></a>PdhEnumMachines</h1>
<p>
The <b>PdhEnumMachines</b> function returns a list of the names of the machines that have been opened previously by the PDH DLL. The machines listed include those that are currently connected and online, as well as those that are offline or not returning performance data. For information about how to connect to a machine, see <a href="pdhref_4wv9.htm"><b>PdhConnectMachine</b></a>.</p>
<pre><code><b>PDH_STATUS PdhEnumMachines(
  IN LPCTSR</b><i> szReserved</i><b>,        </b>// reserved
<b>  IN LPTSTR</b><i> mszMachineNameList</i><b>,  </b>// list of connected machines
<b>  IN LPDWORD</b><i> pcchBufferLength  </i>// pointer to buffer length
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szReserved</i></dt>
<dd>
Reserved. Must be NULL.</dd>
<dt>
<i>mszMachineNameList</i></dt>
<dd>
The buffer, allocated by the calling function, to receive the list of MULTI_SZ strings of machines to which the PDH DLL is currently connected. This parameter may be NULL if the value in the <b>DWORD</b> referenced by <i>pcchBufferLength</i> is 0.</dd>
<dt>
<i>pcchBufferLength</i></dt>
<dd>
A pointer to the <b>DWORD</b> containing the size, in characters, of the available buffer on entry and the size of the returned buffer on exit. If the buffer size on entry is zero, then no data is returned in the <i>mszMachineNameList</i> buffer (and the pointer may be NULL), and the size of the buffer required, in characters, is returned in the <b>DWORD</b> pointed to by <i>pcchBufferLength</i>. The size returned includes both terminating NULL characters of the MULTI_SZ string.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhmsg.h. The following are possible error values:
<dl>
<dt>
PDH_MORE_DATA</dt>
<dd>
More data is available then the current buffer can hold. Some entries may be returned in the <i>mszMachinenameList</i> buffer.</dd>
<dt>
PDH_INSUFFICIENT_BUFFER</dt>
<dd>
The buffer provided is not large enough to contain any data.</dd>
<dt>
PDH_INVALID_ARGUMENT</dt>
<dd>
A required argument is invalid or a reserved argument is not NULL.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a>, , <a href="pdhref_4wv9.htm"><b>PdhConnectMachine</b></a></p>
<p>&nbsp;</p></body>
</HTML>
