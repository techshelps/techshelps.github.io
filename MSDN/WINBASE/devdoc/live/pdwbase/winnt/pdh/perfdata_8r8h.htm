<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Collecting Performance Data</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_collecting_performance_data"></a>Collecting Performance Data</h2>
<p>
PDH functions work with queries and counters. A <i>query</i> is a set of performance counters that are grouped together so that you can collect their data at the same time. A <i>counter</i> is a performance data item stored in the Windows NT registry. </p>
<p>
The counter names used by PDH are expressed as counter paths. A <i>counter path</i> uses a collection of hierarchical elements to describe a counter. In the same way that a file path includes drives, directories, subdirectories, and file names, a counter path includes machines, objects, instances, and counter names. The syntax for a counter path is:</p>
<p>
\\Machine\PerfObject(ParentInstance/ObjectInstance#InstanceIndex)\Counter</p>
<p>
The \\Machine component is optional; it specifies the name of the machine. If you do not supply this component, PDH uses the local machine name. Therefore, a single path string works on any machine that supports the counter. </p>
<p>
The \PerfObject component is required; it specifies the performance object that contains the performance counter. These objects are listed in the PDH browse dialog box (see <a href="pdhref_9vn7.htm"><b>PdhBrowseCounters</b></a>) and in the Performance Monitor <b>Add To Chart</b> dialog box, in the <b>Objects</b> combo box. If this object has a variable list of instances, then you must also specify an instance string. </p>
<p>
The (ParentInstance/ObjectInstance#InstanceIndex) component is only required if the object supports multiple instances. If the instance supports a variable list of instances, then you must specify an instance string. The format of the string depends on the object type. If the object has simple instances, then the format is just the instance name enclosed in parentheses. For example:</p>
<pre><code>(Explorer)
 </code></pre>
<p>
If the instance of this object requires a parent instance name as well, then the parent instance name must come before the object instance, and be separated by a forward slash character. For example:</p>
<pre><code>(Explorer/0)
 </code></pre>
<p>
If the object has multiple instances that have the same name string, they can be indexed sequentially by specifying the instance index prefixed by a pound sign. Instance indexes are 0-based, so all instances have an implicit "0" index. For example:</p>
<pre><code>(Explorer/0#1)
 </code></pre>
<p>
The \Counter component is required; it specifies the performance counter. The counter names are displayed in the PDH browse dialog box and in the Performance Monitor <b>Add To Chart</b> dialog box, in the <b>Counters</b> list box. The counters associated with the selected object are displayed. </p>
<p>
The following are two common counters in the PDH counter path format:</p>
<pre><code>\Processor(0)\% Processor Time
\System\% Total Processor Time
 </code></pre>
<p>
For more information on counters, see <a href="perfdata_4p6b.htm">Performance Objects and Counters</a>. </p>
<p>
A query can contain one or more counters, and a counter can be contained in more than one query. To use PDH, you must create queries and add counters to them, as shown in the following sections.
<ul>
<li>
<a href="perfdata_9u61.htm">Creating a query</a></li>
<li>
<a href="perfdata_323l.htm">Collecting data</a></li>
<li>
<a href="perfdata_0qg1.htm">Displaying data</a></li>
<li>
<a href="perfdata_4g2p.htm">Displaying statistical data</a></li>
<li>
<a href="perfdata_2my6.htm">Ending data collection</a></li>
</ul>
<p>&nbsp;</p></body>
</HTML>
