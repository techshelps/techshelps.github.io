<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Checking PDH Return Values</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_checking_pdh_return_values"></a>Checking PDH Return Values</h2>
<p>
The return value of PDH functions indicates the success or error of the function call, which is distinct from the status of the counter data. Always check the <b>CStatus</b> member of a counter value returned in the PDH structures to ensure that the data returned is valid before you use it. If the value of the <b>CStatus</b> member does not indicate success, do not use the data. The following are the possible status values for counters: 
<dl>
<dt>
PDH_CSTATUS_NO_MACHINE</dt>
<dd>
PDH was unable to connect to the machine specified in the counter path. If this status is returned when the counter is being added, the counter is not completely initialized. Each time the query is updated, PDH retries the connection. When the connection is established, normal data collection resumes.</dd>
<dt>
PDH_CSTATUS_NO_OBJECT</dt>
<dd>
The specified machine was found, but no matching performance object was found on that machine. If this status is returned when the counter is being added, the specified counter is not included in the query. If this status is returned by an active counter, the data for that counter is invalid. Each time the data is requested, PDH tries to obtain this counter data.</dd>
<dt>
PDH_CSTATUS_NO_INSTANCE</dt>
<dd>
The specified instance was not found in the object. If this status is returned while the counter is being added to the query, the counter is successfully added to the query, but no data is available until the specific instance appears and a successful status is returned.</dd>
<dt>
PDH_CSTATUS_NO_COUNTER</dt>
<dd>
The specified counter was not found in the specified object. If this status is returned when the counter is being added, then the counter is not added to the query. If this status is returned after a data update, the data for that counter is invalid. Each time the data is requested, PDH tries to obtain this counter data. </dd>
<dt>
PDH_CSTATUS_INVALID_DATA</dt>
<dd>
The counter was successfully found, but the data returned is not valid. One possible cause for this value is when the data of a normally increasing counter is less than the previous value. Another possible cause is a system timer that is not correct. </dd>
<dt>
PDH_CSTATUS_VALID_DATA</dt>
<dd>
The data for the counter was returned successfully, but is unchanged from the last time the counter was read.</dd>
<dt>
PDH_CSTATUS_NEW_DATA</dt>
<dd>
The data for the counter was returned successfully and is different from the last time the counter was read. PDH_CSTATUS_NEW_DATA can be returned on a rate counter even if the resulting rate is the same as the last sample. This is because the raw data value that is used in the determination of this status value has changed, not the computed rate.</dd>
<dt>
PDH_CSTATUS_NO_COUNTERNAME</dt>
<dd>
No counter path was specified.</dd>
<dt>
PDH_CSTATUS_BAD_COUNTERNAME</dt>
<dd>
The counter path format is incorrect.
</dd>
</dl>
<p>&nbsp;</p></body>
</HTML>
