<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhEnumObjectItems</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhenumobjectitems"></a>PdhEnumObjectItems</h1>
<p>
The <b>PdhEnumObjectItems</b> function returns the available counters and instances provided by the specified object on the specified machine.</p>
<pre><code><b>PDH_STATUS PdhEnumObjectItems(
  IN LPCTSTR</b><i> szReserved</i><b>,  </b>// reserved
<b>  IN LPCTSTR</b><i> szMachineName</i><b>,  </b>// machine name
<b>  IN LPCTSTR</b><i> szObjectName</i><b>,  </b>// object name
<b>  IN LPTSTR</b><i> mszCounterList</i><b>,  </b>// buffer for object's counters
<b>  IN LPDWORD</b><i> pcchCounterListLength</i><b>,</b>
<b>                          </b>// size of counter list buffer
<b>  IN LPTSTR</b><i> mszInstanceList</i><b>,  </b>// buffer for object's instances
<b>  IN LPDWORD</b><i> pcchInstanceListLength</i><b>,</b>
<b>                          </b>// size of instance list buffer
<b>  IN DWORD</b><i> dwDetailLevel</i><b>,  </b>// detail level
<b>  IN DWORD</b><i> dwFlags        </i>// formatting flag
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szReserved</i></dt>
<dd>
Reserved. Must be NULL.</dd>
<dt>
<i>szMachineName</i></dt>
<dd>
The name of the machine on which to list the object items. If the machine specified is not in the list of currently connected machines, the PDH will try to connect to it.</dd>
<dt>
<i>szObjectName</i></dt>
<dd>
The name of the object on the specified machine from which the items are to be listed.</dd>
<dt>
<i>mszCounterList</i></dt>
<dd>
The buffer allocated by the calling function that is to receive the MULTI_SZ list of performance counters provided by the specified object on the specified machine. This parameter can be NULL if the value of the <b>DWORD</b> referenced by <i>pcchCounterListLength</i> is 0.</dd>
<dt>
<i>pcchCounterListLength</i></dt>
<dd>
A pointer to a <b>DWORD</b> containing the size, in characters, of the available buffer, and which returns the size of the buffer used. If the buffer size on entry is zero, then no data is returned in the <i>mszCounterList</i> buffer, and the size of the buffer required is returned in the <b>DWORD</b> pointed to by <i>pdwCounterListLength</i>. The size returned includes both terminating NULL characters of the MULTI_SZ string.</dd>
<dt>
<i>mszInstanceList</i></dt>
<dd>
The buffer allocated by the calling function that is to receive the MULTI_SZ list of the instances of the specified object on the specified machine. This argument can be NULL if the value of the <b>DWORD</b> pointed to by <i>pcchCounterListLength</i> is 0.</dd>
<dt>
<i>pcchInstanceListLength</i></dt>
<dd>
A pointer to the <b>DWORD</b> containing the size, in characters, of the available buffer, and which returns the size of the buffer used. If the buffer size on entry is zero, then no data is returned in the <i>mszInstanceList</i> buffer, and the size of the buffer required is returned in the <b>DWORD</b> pointed to by <i>pcchInstanceListLength</i>. The size returned includes both terminating NULL characters of the MULTI_SZ string. If the specified object does not support variable instances, then the returned value will be 0. If the specified object does support variable instances, but does not currently have any instances, then the value returned in this <b>DWORD</b> will be 2, which is the size, in characters, of an empty MULTI_SZ list string.</dd>
<dt>
<i>dwDetailLevel</i></dt>
<dd>
The detail level of the performance items to return. All items that are of the specified detail level or less will be returned.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Must be 0.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhmsg.h. The following are possible error values:
<dl>
<dt>
PDH_MORE_DATA</dt>
<dd>
There are more entries available to return than there is room in the buffer. Some entries might be returned in the buffer, however.</dd>
<dt>
PDH_INSUFFICIENT_BUFFER</dt>
<dd>
The buffer provided is not large enough to contain any data.</dd>
<dt>
PDH_INVALID_ARGUMENT</dt>
<dd>
A required argument is invalid or a reserved argument is not NULL.</dd>
<dt>
PDH_MEMORY_ALLOCATION_FAILURE</dt>
<dd>
A required temporary buffer could not be allocated.</dd>
<dt>
PDH_CSTATUS_NO_MACHINE</dt>
<dd>
The specified machine is offline or unavailable.</dd>
<dt>
PDH_CSTATUS_NO_OBJECT</dt>
<dd>
The specified object could not be found on the specified machine.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a>, , <a href="pdhref_4wv9.htm"><b>PdhConnectMachine</b></a>, <a href="pdhref_9zar.htm"><b>PdhEnumObjects</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
