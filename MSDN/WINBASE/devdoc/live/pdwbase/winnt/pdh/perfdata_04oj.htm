<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Other Registry Entries</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_creating_other_registry_entries"></a>Creating Other Registry Entries</h3>
<p>
To obtain the performance data for some applications (those that return counters using the <a href="../../devio_9quk.htm"><b>DeviceIOControl</b></a> function), it is necessary to use the <a href="../../filesio_7wmd.htm"><b>CreateFile</b></a> function to open the device associated with the application. In this case, the name specified in <a href="../../filesio_7wmd.htm"><b>CreateFile</b></a> must also be installed in the DOS Devices node of the registry, as shown here:</p>
<pre><code>HKEY_LOCAL_MACHINE
    \SYSTEM
        \CurrentControlSet
            \Control
                \Session Manager
                    \DOS Devices
 </code></pre>
<p>
Applications that manage multiple device instances with performance data for each device, must put a <b>Linkage</b> key in the its <b>Services</b> key. The <b>Linkage</b> key contains an <b>Export</b> value whose data is a list of the device names. For example, a system with two Etherlink cards could have the following registry entries:</p>
<pre><code>HKEY_LOCAL_MACHINE
    \SYSTEM
        \CurrentControlSet
            \Services
                \Elnkii
                    \Linkage
                        Export = "\Device\Elnk01" "\Device\Elnk02"
                    \Performance
                        Library = "ElnkStat.dll"
                        Open = "OpenElnkStats"
                        Collect = "GetElnkStats"
                        Close = "CloseElnkStats"
                \Elnk01
                    \Linkage
                    \Parameters
                \Elnk02
                    \Linkage
                    \Parameters
 </code></pre>
<p>
When the system calls the Open function in an application's performance DLL, its argument is a string containing the list of device names from the application's Export value, if it is present. The Open function can then use these names to determine the devices for which to collect performance data.</p>
<p>&nbsp;</p></body>
</HTML>
