<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhMakeCounterPath</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhmakecounterpath"></a>PdhMakeCounterPath</h1>
<p>
The <b>PdhMakeCounterPath</b> function creates a full counter path using the members specified in the structure passed in the parameter list.</p>
<pre><code><b>PDH_STATUS PdhMakeCounterPath(
  IN PDH_COUNTER_PATH_ELEMENTS</b><i> *pCounterPathElements</i><b>,</b>
<b>                              </b>// counter path elements
<b>  IN LPTSTR</b><i> szFullPathBuffer</i><b>,  </b>// path string buffer
<b>  IN LPDWORD</b><i> pcchBufferSize</i><b>,  </b>// size of buffer
<b>  IN DWORD</b><i> dwFlags            </i>// reserved
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>*pCounterPathElements</i></dt>
<dd>
Pointer to a <a href="pdhref_5ucy.htm"><b>PDH_COUNTER_PATH_ELEMENTS</b></a> structure that contains the individual members that are to make up the path. The following table indicates which members are required and which are optional:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Member</th>
<th align=left width=52%>Required or Optional</th>
</tr>
<tr valign=top>
<td width=48%><b>LPTSTR</b> <b>szMachineName</b></td>
<td width=52%>optional</td>
</tr>
<tr valign=top>
<td width=48%><b>LPTSTR</b> <b>szObjectName</b></td>
<td width=52%>required</td>
</tr>
<tr valign=top>
<td width=48%><b>LPTSTR</b> <b>szInstanceName</b></td>
<td width=52%>optional</td>
</tr>
<tr valign=top>
<td width=48%><b>LPTSTR</b> <b>szParentInstance</b></td>
<td width=52%>optional</td>
</tr>
<tr valign=top>
<td width=48%><b>DWORD</b> <b>dwInstanceIndex</b></td>
<td width=52%>optional<br>
((<b>DWORD</b>)–1 if no index)</td>
</tr>
<tr valign=top>
<td width=48%><b>LPTSTR</b> <b>szCounterName</b></td>
<td width=52%>required</td>
</tr>
</table><br>


<p>
If a required member is not present, then no path string will be constructed. If the <b>szMachineName</b> member is NULL, then no machine name will be included in the path (a generic path will be created). If the instance name argument is NULL, then no instance reference will be inserted into the path string and the <b>szParentInstance</b> and the <b>dwInstanceIndex</b> members will be ignored.
</dd>
<dt>
<i>szFullPathBuffer</i></dt>
<dd>
The buffer allocated by the caller that will receive the full path string created by this function.</dd>
<dt>
<i>pcchBufferSize</i></dt>
<dd>
A pointer to the <b>DWORD</b> containing the size, in bytes, of the available buffer, and which returns with the size of the buffer used. If the buffer size on entry is zero, then no data is returned in the <i>szFullPathBuffer</i> buffer, however, the size of the buffer required is returned in the <b>DWORD</b>. The size returned includes the terminating NULL character of the string.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Reserved. Must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhmsg.h.</p>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a>, , <a href="pdhref_5ucy.htm"><b>PDH_COUNTER_PATH_ELEMENTS</b></a>, <a href="pdhref_33l4.htm"><b>PdhParseCounterPath</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
