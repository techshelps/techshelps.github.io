<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PdhParseInstanceName</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pdhparseinstancename"></a>PdhParseInstanceName</h1>
<p>
The <b>PdhParseInstanceName</b> function parses the elements of an instance string and returns them in the buffers supplied by the caller.</p>
<pre><code><b>PDH_STATUS PdhParseInstanceName(
  IN LPCTSTR</b><i> szInstanceString</i><b>,       </b>// instance string
<b>  IN LPTSTR</b><i> szInstanceName</i><b>,          </b>// parsed instance name
<b>  IN LPDWORD</b><i> pcchInstanceNameLength</i><b>, </b>// length of name
<b>  IN LPTSTR</b><i> szParentName</i><b>,            </b>// name of parent index
<b>  IN LPDWORD</b><i> pcchParentNameLength</i><b>,   </b>// length of parent name
<b>  IN LPDWORD</b><i> lpIndex                 </i>// instance index
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szInstanceString</i></dt>
<dd>
A pointer to the string containing the instance substring to parse into individual components. This string can contain the following formats, and is less than MAX_PATH characters in length:
<p>
instance<br>
instance#index<br>
parent/instance<br>
parent/instance#index
</dd>
<dt>
<i>szInstanceName</i></dt>
<dd>
A pointer to the buffer that will receive the instance name parsed from the instance string. This pointer can be NULL if the <b>DWORD</b> referenced by the <i>pcchInstanceNameLength</i> parameter is 0.</dd>
<dt>
<i>pcchInstanceNameLength</i></dt>
<dd>
A pointer to the <b>DWORD</b> that contains the length of the <i>szInstanceName</i> buffer. If the value of this <b>DWORD</b> is 0, then the buffer size required to hold the instance name will be returned.</dd>
<dt>
<i>szParentName</i></dt>
<dd>
A pointer to the buffer that will receive the name of the parent index if one is specified. This parameter can be NULL if the value of the <b>DWORD</b> referenced by the <i>pcchParentNameLength</i> parameter is 0.</dd>
<dt>
<i>pcchParentNameLength</i></dt>
<dd>
A pointer to the <b>DWORD</b> that contains the length of the <i>szParentName</i> buffer. If the value of this <b>DWORD</b> is 0, then the buffer size required to hold the instance name will be returned.</dd>
<dt>
<i>lpIndex</i></dt>
<dd>
A pointer to the <b>DWORD</b> that will receive the index value of the instance. If an index entry is not present in the string, then this value will be 0. This argument can be NULL if this information is not needed.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a PDH error status defined in pdhmsg.h. The following are possible error values:
<dl>
<dt>
PDH_INVALID_ARGUMENT</dt>
<dd>
An argument is invalid or incorrect.</dd>
<dt>
PDH_INSUFFICIENT_BUFFER</dt>
<dd>
One or both of the string buffers supplied is not large enough for the strings to be returned.</dd>
<dt>
PDH_INVALID_INSTANCE</dt>
<dd>
The instance string is incorrectly formatted, exceeds MAX_PATH characters in length, or cannot be parsed.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="perfdata_4982.htm">Performance Data Helper Overview</a>, <a href="perfdata_5bzn.htm">Performance Data Functions</a>, , <a href="pdhref_38iw.htm"><b>PdhMakeCounterPath</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
