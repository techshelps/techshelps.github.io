<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How the DLL Interfaces with a Performance Monitor Application</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_how_the_dll_interfaces_with_a_performance_monitor_application"></a>How the DLL Interfaces with a Performance Monitor Application</h3>
<p>
An application retrieves performance data by specifying <b>HKEY_PERFORMANCE_DATA</b> in a call to the <a href="../../regapi_3wzc.htm"><b>RegQueryValueEx</b></a> function. If successful, <b>RegQueryValueEx</b> fills a buffer of the application with the requested performance data.</p>
<p>
The first time an application calls <b>RegQueryValueEx</b>, or if the application uses the <a href="../../regapi_0h15.htm"><b>RegOpenKey</b></a> function to open <b>HKEY_PERFORMANCE_DATA</b>, the system calls the Open function for each application with the correct registry entries. This gives each performance DLL an opportunity to initialize its performance data structures. Then, if the Open function returns successfully (or if there is no Open function), the system calls the Collect function. Subsequent calls to <b>RegQueryValueEx</b> cause the system to call the Collect function.</p>
<p>
When the application has finished collecting performance data, it specifies <b>HKEY_PERFORMANCE_DATA</b> in a call to the <a href="../../regapi_5fax.htm"><b>RegCloseKey</b></a> function. This causes the system to call the Close function for each application. The performance DLLs are then unloaded.</p>
<p>
<b>Note</b>&nbsp;&nbsp;It is possible for multiple programs to collect performance data at the same time. The system calls Open and Close functions only once for each application requesting performance data. For remote measurement, the system limits access to these routines to one thread at a time, so synchronization is not a problem. However, for local measurement, because multiple processes may be making simultaneous calls, you must prevent any conflicts from multiple concurrent requests for data.</p>
<p>&nbsp;</p></body>
</HTML>
