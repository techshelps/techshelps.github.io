<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The HKEY_PERFORMANCE_DATA Key</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_the_hkey_performance_data_key"></a>The HKEY_PERFORMANCE_DATA Key</h2>
<p>
The performance data is accessed through the registry key <b>HKEY_PEFORMANCE_DATA</b>. Each software component creates keys for its objects and counters when it is installed and writes counter data while it is executing. You can access this data as you would access any other registry data, using the <a href="../../regapi_59mb.htm">registry functions</a>. However, although you use the registry to collect performance data, the data is not stored in the registry database. Instead, calling the registry functions with the <b>HKEY_PEFORMANCE_DATA</b> key<b> </b>causes the system to collect the data from the appropriate system object managers. </p>
<p>
To obtain performance data from the local system, use the <a href="../../regapi_3wzc.htm"><b>RegQueryValueEx</b></a> function, with the <b>HKEY_PERFORMANCE_DATA</b> key. The first call opens the key; you do not need to explicitly open the key first. However, be sure to use the <a href="../../regapi_5fax.htm"><b>RegCloseKey</b></a> function to close the handle to the key when you are finished obtaining performance data. The user cannot install or remove a software component while its performance data is in use. </p>
<p>
To obtain performance data from a remote system, you must use the <a href="../../regapi_803d.htm"><b>RegConnectRegistry</b></a> function, with the computer name of the remote system and the <b>HKEY_PERFORMANCE_DATA</b> key. This call retrieves a key representing the performance data for the remote system. To retrieve the data, call <b>RegQueryValueEx</b> using this key, rather than the <b>HKEY_PERFORMANCE_DATA</b> key. </p>
<p>&nbsp;</p></body>
</HTML>
