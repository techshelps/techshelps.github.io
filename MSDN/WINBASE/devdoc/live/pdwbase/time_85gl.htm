<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetLocalTime</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setlocaltime"></a>SetLocalTime</h1>
<p>
The <b>SetLocalTime</b> function sets the current local time and date. </p>
<pre><code><b>BOOL SetLocalTime(
  CONST SYSTEMTIME</b><i> *lpSystemTime</i>   // address of local time to set
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpSystemTime</i></dt>
<dd>
Pointer to a <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> structure that contains the current local date and time. 
<p>
The <b>wDayOfWeek</b> member of the <b>SYSTEMTIME</b> structure is ignored. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
<b>Windows NT:</b> The system uses UTC internally. Therefore, when you call <b>SetLocalTime</b>, Windows NT uses the current time zone information, including the Daylight Saving Time setting, to perform the conversion. Note that Windows NT uses the Daylight Saving Time setting of the current time, not the new time you are setting. Therefore, calling <b>SetLocalTime</b> again, now that the Daylight Saving Time setting is set for the new time, will guarantee the correct result. </p>
<p>
<b>Windows NT:</b> The <b>SetLocalTime</b> function fails if the calling process does not have the SE_SYSTEMTIME_NAME privilege. This privilege is disabled by default. Use the <a href="accctrl_6xbn.htm"><b>AdjustTokenPrivileges</b></a> function to enable this privilege and again to disable it after the time has been set. For more information about security privileges, see <a href="accctrl_42pf.htm">Privileges</a>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="time_4jol.htm">Time Overview</a>, <a href="time_4po3.htm">Time Functions</a>, <a href="accctrl_6xbn.htm"><b>AdjustTokenPrivileges</b></a>, <a href="time_7rj9.htm"><b>GetLocalTime</b></a>, <a href="time_56p1.htm"><b>GetSystemTime</b></a>, <a href="time_660k.htm"><b>SetSystemTimeAdjustment</b></a>, <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
