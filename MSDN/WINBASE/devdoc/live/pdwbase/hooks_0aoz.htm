<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>JournalPlaybackProc</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_journalplaybackproc"></a>JournalPlaybackProc</h1>
<p>
The <b>JournalPlaybackProc</b> hook procedure is an application-defined or library-defined callback function used with the <a href="hooks_7vaw.htm"><b>SetWindowsHookEx</b></a> function. Typically, an application uses this function to play back a series of mouse and keyboard messages recorded previously by the <a href="hooks_4t9f.htm"><b>JournalRecordProc</b></a> hook procedure. As long as a <b>JournalPlaybackProc</b> hook procedure is installed, regular mouse and keyboard input is disabled. </p>
<p>
The <b>HOOKPROC</b> type defines a pointer to this callback function. <b>JournalPlaybackProc</b> is a placeholder for the application-defined or library-defined function name. </p>
<pre><code><b>LRESULT CALLBACK JournalPlaybackProc(
  int</b><i> code</i><b>,       </b>// hook code
<b>  WPARAM</b><i> wParam</i><b>,  </b>// undefined
<b>  LPARAM</b><i> lParam</i>   // address of message being processed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>code</i></dt>
<dd>
Specifies a code the hook procedure uses to determine how to process the message. This parameter can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=35%>Value</th>
<th align=left width=65%>Meaning</th>
</tr>
<tr valign=top>
<th align=left width=35%>HC_GETNEXT</th>
<td width=65%>The hook procedure must copy the current mouse or keyboard message to the <a href="hooks_5zhu.htm"><b>EVENTMSG</b></a> structure pointed to by the <i>lParam</i> parameter. </td>
</tr>
<tr valign=top>
<th align=left width=35%>HC_NOREMOVE</th>
<td width=65%>An application has called the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_peekmessage">
</object><a href=JavaScript:alink_1.Click()><b>PeekMessage</b></a> function with <i>wRemoveMsg</i> set to PM_NOREMOVE, indicating that the message is not removed from the message queue after <b>PeekMessage</b> processing. </td>
</tr>
<tr valign=top>
<th align=left width=35%>HC_SKIP</th>
<td width=65%>The hook procedure must prepare to copy the next mouse or keyboard message to the <a href="hooks_5zhu.htm"><b>EVENTMSG</b></a> structure pointed to by <i>lParam</i>. Upon receiving the HC_GETNEXT code, the hook procedure must copy the message to the structure. </td>
</tr>
<tr valign=top>
<th align=left width=35%>HC_SYSMODALOFF</th>
<td width=65%>A system-modal dialog box has been destroyed. The hook procedure must resume playing back the messages.</td>
</tr>
<tr valign=top>
<th align=left width=35%>HC_SYSMODALON</th>
<td width=65%>A system-modal dialog box is being displayed. Until the dialog box is destroyed, the hook procedure must stop playing back messages.</td>
</tr>
</table><br>


<p>
If <i>code</i> is less than zero, the hook procedure must pass the message to the <a href="hooks_57aw.htm"><b>CallNextHookEx</b></a> function without further processing and should return the value returned by <b>CallNextHookEx</b>. 
</dd>
<dt>
<i>wParam</i></dt>
<dd>
Specifies a NULL value. </dd>
<dt>
<i>lParam</i></dt>
<dd>
Pointer to an <a href="hooks_5zhu.htm"><b>EVENTMSG</b></a> structure that represents a message being processed by the hook procedure. This parameter is valid only when the <i>code</i> parameter is HC_GETNEXT. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
To have the system wait before processing the message, the return value must be the amount of time, in clock ticks, that the system should wait. (This value can be computed by calculating the difference between the <b>time</b> members in the current and previous input messages.) To process the message immediately, the return value should be zero. The return value is used only if the hook code is HC_GETNEXT; otherwise, it is ignored. </p>
<h4>Remarks</h4>
<p>
A <b>JournalPlaybackProc</b> hook procedure should copy an input message to the <i>lParam</i> parameter. The message must have been previously recorded by using a <a href="hooks_4t9f.htm"><b>JournalRecordProc</b></a> hook procedure, which should not modify the message. </p>
<p>
To retrieve the same message over and over, the hook procedure can be called several times with the <i>code</i> parameter set to HC_GETNEXT without an intervening call with <i>code</i> set to HC_SKIP. </p>
<p>
If <i>code</i> is HC_GETNEXT and the return value is greater than zero, the system sleeps for the number of milliseconds specified by the return value. When the system continues, it calls the hook procedure again with <i>code</i> set to HC_GETNEXT to retrieve the same message. The return value from this new call to <b>JournalPlaybackProc</b> should be zero; otherwise, the system will go back to sleep for the number of milliseconds specified by the return value, call <b>JournalPlaybackProc</b> again, and so on. The system will appear to be hung. </p>
<p>
Unlike most other global hook procedures, the <b>JournalRecordProc</b> and <b>JournalPlaybackProc</b> hook procedures are always called in the context of the thread that set the hook. </p>
<p>
After the hook procedure returns control to the system, the message continues to be processed. If <i>code</i> is HC_SKIP, the hook procedure must prepare to return the next recorded event message on its next call. </p>
<p>
Install the <b>JournalPlaybackProc</b> hook procedure by specifying the <a href="hooks_0h7v.htm">WH_JOURNALPLAYBACK hook</a> type and the address of the hook procedure in a call to the <a href="hooks_7vaw.htm"><b>SetWindowsHookEx</b></a> function. </p>
<p>
If the user presses ctrl+esc or ctrl+alt+del during journal playback, the system stops the playback, unhooks the journal playback procedure, and posts a <a href="hooks_6g8c.htm">WM_CANCELJOURNAL</a> message to the journaling application. </p>
<p>
If the hook procedure returns a message in the range WM_KEYFIRST to WM_KEYLAST, the following conditions apply:
<ul>
<li>
The <i>paramL</i> member of the EVENTMSG structure specifies the virtual key code of the key that was pressed.</li>
<li>
The <i>paramH</i> member of the EVENTMSG structure specifies the scan code.</li>
<li>
There's no way to specify a repeast count. The event is always taken to represent one key event.</li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>User-defined.</p>
<h4>See Also</h4>
<p>
<a href="hooks_9rg3.htm">Hooks Overview</a>, <a href="hooks_31bn.htm">Hook Functions</a>, <a href="hooks_57aw.htm"><b>CallNextHookEx</b></a>, <a href="hooks_5zhu.htm"><b>EVENTMSG</b></a>, <a href="hooks_4t9f.htm"><b>JournalRecordProc</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_peekmessage">
</object><a href=JavaScript:alink_2.Click()><b>PeekMessage</b></a>, <a href="hooks_7vaw.htm"><b>SetWindowsHookEx</b></a>, <a href="hooks_6g8c.htm">WM_CANCELJOURNAL</a> </p>
<p>&nbsp;</p></body>
</HTML>
