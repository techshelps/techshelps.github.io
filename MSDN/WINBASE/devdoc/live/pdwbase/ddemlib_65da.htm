<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Poke Transaction</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_poke_transaction"></a>Poke Transaction</h3>
<p>
A client can send unsolicited data to a server by using <a href="ddemlib_1gha.htm"><b>DdeClientTransaction</b></a> to send an <a href="ddemlib_90v9.htm">XTYP_POKE</a> transaction to a server's callback function. </p>
<p>
The client application first creates a buffer that contains the data to send to the server and then passes a pointer to the buffer as a parameter to <b>DdeClientTransaction</b>. Alternatively, the client can use the <a href="ddemlib_0tt1.htm"><b>DdeCreateDataHandle</b></a> function to obtain a data handle that identifies the data and then pass the handle to <b>DdeClientTransaction</b>. In either case, the client also specifies the topic name, item name, and data format when it calls <b>DdeClientTransaction</b>. </p>
<p>
The DDEML passes the XTYP_POKE transaction to the server, specifying the topic name, item name, and data format that the client requested. To accept the data item and format, the server should return DDE_FACK. To reject the data, the server should return DDE_FNOTPROCESSED. If the server is too busy to accept the data, the server should return DDE_FBUSY. </p>
<p>
When <b>DdeClientTransaction</b> returns, the client can use the <i>lpdwResult</i> parameter to access the transaction-status flag. If the flag is DDE_FBUSY, the client should send the transaction again later. </p>
<p>
If a server does not support the <a href="ddemlib_90v9.htm">XTYP_POKE</a> transaction, it should specify the CBF_FAIL_POKES filter flag in <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a>. This flag prevents the DDEML from sending this transaction to the server. </p>
<p>&nbsp;</p></body>
</HTML>
