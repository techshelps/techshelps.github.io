<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetMessageWaitingIndicator</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setmessagewaitingindicator"></a>SetMessageWaitingIndicator</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>SetMessageWaitingIndicator</b> function updates the computer's message waiting indicator. Applications use this feature while the computer is in a low power state to indicate to the user that new e-mail, fax, or voice messages have arrived. </p>
<pre><code><b>BOOL SetMessageWaitingIndicator(
  HANDLE</b><i> hIndicator</i><b>,</b><i>  </i>// application-defined 32-bit value
  <b>ULONG</b> <i>cmsg</i>          // number of messages waiting
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hIndicator</i></dt>
<dd>
Handle to the message indicator device. The handle is obtained by calling the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function on the \\.\MessageIndicator device </dd>
<dt>
<i>cmsg</i></dt>
<dd>
The current number of messages the application has waiting. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the computer does not have a message waiting indicator, the function returns zero. Otherwise, it returns a nonzero value. </p>
<h4>Remarks</h4>
<p>
The system tracks calls to <b>SetMessageWaitingIndicator</b> on a per-handle basis. It combines the number specified in the <i>cmsg</i> parameter with the current value of the message-waiting indicator and displays the result. If the process exits, either normally or abnormally, the system automatically closes all handles. This reduces the value of the indicator by the amount specified in the application's last call to <b>SetMessageWaitingIndicator</b>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="power_0sj8.htm">Power Management Overview</a>, <a href="power_2c4z.htm">Power Management Functions</a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <a href="power_923p.htm"><b>GetDevicePowerState</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
