<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetShortPathName</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getshortpathname"></a>GetShortPathName</h1>
<p>
The <b>GetShortPathName</b> function obtains the short path form of a specified input path. </p>
<pre><code><b>DWORD GetShortPathName(
  LPCTSTR</b><i> lpszLongPath</i><b>,  </b>// pointer to a null-terminated path string
<b>  LPTSTR</b><i> lpszShortPath</i><b>,  </b>// pointer to a buffer to receive the 
                         // null-terminated short form of the path
<b>  DWORD</b><i> cchBuffer</i>        // specifies the size of the buffer pointed 
                         // to by <i>lpszShortPath</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszLongPath</i></dt>
<dd>
Pointer to a null-terminated path string. The function obtains the short form of this path.</dd>
<dt>
<i>lpszShortPath</i></dt>
<dd>
Pointer to a buffer to receive the null-terminated short form of the path specified by <i>lpszLongPath</i>.</dd>
<dt>
<i>cchBuffer</i></dt>
<dd>
Specifies the size, in characters, of the buffer pointed to by <i>lpszShortPath</i>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the length, in characters, of the string copied to <i>lpszShortPath</i>, not including the terminating null character.</p>
<p>
If the function fails due to the <i>lpszShortPath</i> buffer being too small to contain the short path string, the return value is the size, in characters, of the short path string. You need to call the function with a short path buffer that is at least as large as the short path string. </p>
<p>
If the function fails for any other reason, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
When an application calls this function and specifies a path on a volume that does not support 8.3 aliases, the function fails with ERROR_INVALID_PARAMETER if the path is longer than 67 bytes.</p>
<p>
The path specified by <i>lpszLongPath</i> does not have to be a fully qualified path or a long path. The short form may be longer than the specifed path. </p>
<p>
If the specified path is already in its short form, there is no need for any conversion, and the function simply copies the specified path to the buffer for the short path. </p>
<p>
You can set <i>lpszShortPath</i> to the same value as <i>lpszLongPath</i>; in other words, you can set the buffer for the short path to the address of the input path string. </p>
<p>
You can obtain the long name of a file from the short name by calling the <b>FindFirstFile</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="filesio_2xm7.htm">File I/O Overview</a>, <a href="filesio_3n5f.htm">File Functions</a>, <a href="filesio_79gl.htm"><b>GetFullPathName</b></a>, <a href="filesio_4qcl.htm"><b>FindFirstFile</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
