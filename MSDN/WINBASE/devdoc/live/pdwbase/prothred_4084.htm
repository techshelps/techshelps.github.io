<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateThread</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createthread"></a>CreateThread</h1>
<p>
The <b>CreateThread</b> function creates a thread to execute within the address space of the calling process. </p>
<pre><code><b>HANDLE CreateThread(
  LPSECURITY_ATTRIBUTES</b><i> lpThreadAttributes</i><b>,  </b>// pointer to security attributes
<b>  DWORD</b><i> dwStackSize</i><b>,                         </b>// initial thread stack size
<b>  LPTHREAD_START_ROUTINE</b><i> lpStartAddress</i><b>,     </b>// pointer to thread function
<b>  LPVOID</b><i> lpParameter</i><b>,                        </b>// argument for new thread
<b>  DWORD</b><i> dwCreationFlags</i><b>,                     </b>// creation flags
<b>  LPDWORD</b><i> lpThreadId</i>                         // pointer to receive thread ID
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpThreadAttributes</i></dt>
<dd>
Pointer to a <a href="accctrl_8gs2.htm"><b>SECURITY_ATTRIBUTES</b></a> structure that determines whether the returned handle can be inherited by child processes. If <i>lpThreadAttributes</i> is NULL, the handle cannot be inherited. 
<p>
<b>Windows NT:</b> The <b>lpSecurityDescriptor</b> member of the structure specifies a security descriptor for the new thread. If <i>lpThreadAttributes</i> is NULL, the thread gets a default security descriptor. 
</dd>
<dt>
<i>dwStackSize</i></dt>
<dd>
Specifies the initial commit size of the stack, in bytes. The system rounds this value to the nearest page. If this value is zero, or is smaller than the default commit size, the default is to use the same size as the calling thread. For more information, see <a href="prothred_0b8l.htm">Thread Stack Size</a>. </dd>
<dt>
<i>lpStartAddress</i></dt>
<dd>
Pointer to the application-defined function of type LPTHREAD_START_ROUTINE to be executed by the thread and represents the starting address of the thread. For more information on the thread function, see <a href="prothred_9wkj.htm"><b>ThreadProc</b></a>. </dd>
<dt>
<i>lpParameter</i></dt>
<dd>
Specifies a single 32-bit parameter value passed to the thread. </dd>
<dt>
<i>dwCreationFlags</i></dt>
<dd>
Specifies additional flags that control the creation of the thread. If the CREATE_SUSPENDED flag is specified, the thread is created in a suspended state, and will not run until the <a href="prothred_59no.htm"><b>ResumeThread</b></a> function is called. If this value is zero, the thread runs immediately after creation. At this time, no other values are supported.</dd>
<dt>
<i>lpThreadId</i></dt>
<dd>
Pointer to a 32-bit variable that receives the thread identifier. 
<p>
<b>Windows NT:</b> If this parameter is NULL, the thread identifier is not returned.

<p>
<b>Windows 95 and Windows 98:</b> This parameter may not be NULL. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a handle to the new thread.</p>
<p>
If the function fails, the return value is NULL. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<p>
<b>Windows 95 and Windows 98:</b> <b>CreateThread</b> succeeds only when it is called in the context of a 32-bit program. A 32-bit DLL cannot create an additional thread when that DLL is being called by a 16-bit program.</p>
<h4>Remarks</h4>
<p>
The new thread handle is created with THREAD_ALL_ACCESS to the new thread. If a security descriptor is not provided, the handle can be used in any function that requires a thread object handle. When a security descriptor is provided, an access check is performed on all subsequent uses of the handle before access is granted. If the access check denies access, the requesting process cannot use the handle to gain access to the thread.  </p>
<p>
The thread execution begins at the function specified by the <i>lpStartAddress</i> parameter. If this function returns, the <b>DWORD</b> return value is used to terminate the thread in an implicit call to the <a href="prothred_531g.htm"><b>ExitThread</b></a> function. Use the <a href="prothred_9350.htm"><b>GetExitCodeThread</b></a> function to get the thread's return value. </p>
<p>
The <b>CreateThread</b> function may succeed even if <i>lpStartAddress</i> points to data, code, or is not accessible. If the start address is invalid when the thread runs, an exception occurs, and the thread terminates. Thread termination due to a invalid start address is handled as an error exit for the thread's process. This behavior is similar to the asynchronous nature of <b>CreateProcess</b>, where the process is created even if it refers to invalid or missing dynamic-link libraries (DLLs). </p>
<p>
The thread is created with a thread priority of THREAD_PRIORITY_NORMAL. Use the <a href="prothred_9uk9.htm"><b>GetThreadPriority</b></a> and <a href="prothred_9f5l.htm"><b>SetThreadPriority</b></a> functions to get and set the priority value of a thread. </p>
<p>
When a thread terminates, the thread object attains a signaled state, satisfying any threads that were waiting on the object. </p>
<p>
The thread object remains in the system until the thread has terminated and all handles to it have been closed through a call to <a href="handobj_289x.htm"><b>CloseHandle</b></a>. </p>
<p>
The <a href="prothred_8dv7.htm"><b>ExitProcess</b></a>, <a href="prothred_531g.htm"><b>ExitThread</b></a>, <b>CreateThread</b>, <a href="prothred_8b38.htm"><b>CreateRemoteThread</b></a> functions, and a process that is starting (as the result of a call by <b>CreateProcess</b>) are serialized between each other within a process. Only one of these events can happen in an address space at a time. This means that the following restrictions hold: 
<ul>
<li>
During process startup and DLL initialization routines, new threads can be created, but they do not begin execution until DLL initialization is done for the process. </li>
<li>
Only one thread in a process can be in a DLL initialization or detach routine at a time. </li>
<li>
<b>ExitProcess</b> does not return until no threads are in their DLL initialization or detach routines. </li>
</ul>
<p>
A thread that uses functions from the C run-time libraries should use the <b>beginthread</b> and <b>endthread</b> C run-time functions for thread management rather than <b>CreateThread</b> and <b>ExitThread</b>. Failure to do so results in small memory leaks when <b>ExitThread</b> is called. </p>
<p>
<b>Windows CE:</b> The <i>lpThreadAttributes</i> parameter must be set to NULL. The <i>dwStackSize</i> parameter must be zero. Only zero or CREATE_SUSPENDED values are supported for the <i>dwCreationFlags</i> parameter.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.01 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="prothred_86sz.htm">Processes and Threads Overview</a>, <a href="prothred_3mgj.htm">Process and Thread Functions</a>, <a href="handobj_289x.htm"><b>CloseHandle</b></a>, <a href="prothred_9dpv.htm"><b>CreateProcess</b></a>, <a href="prothred_8b38.htm"><b>CreateRemoteThread</b></a>, <a href="prothred_8dv7.htm"><b>ExitProcess</b></a>, <a href="prothred_531g.htm"><b>ExitThread</b></a>, <a href="prothred_9350.htm"><b>GetExitCodeThread</b></a>, <a href="prothred_9uk9.htm"><b>GetThreadPriority</b></a>, <a href="prothred_59no.htm"><b>ResumeThread</b></a>, <a href="prothred_9f5l.htm"><b>SetThreadPriority</b></a>, <a href="accctrl_8gs2.htm"><b>SECURITY_ATTRIBUTES</b></a>, <a href="prothred_9wkj.htm"><b>ThreadProc</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
