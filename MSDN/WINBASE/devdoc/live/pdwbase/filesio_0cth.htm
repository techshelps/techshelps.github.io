<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_openfile"></a>OpenFile</h1>
<p>
The <b>OpenFile</b> function creates, opens, reopens, or deletes a file. </p>
<p>
This function is provided for compatibility with 16-bit versions of Windows. In particular, the <b>OpenFile</b> function cannot open a named pipe. Win32-based applications should use the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function. </p>
<pre><code><b>HFILE OpenFile(
  LPCSTR</b><i> lpFileName</i><b>,        </b>// pointer to the filename
  <b>LPOFSTRUCT</b> <i>lpReOpenBuff</i><b>,</b>  // pointer to the file information struct
<b>  UINT</b><i> uStyle               </i>// specifies the action and attributes
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpFileName</i></dt>
<dd>
Pointer to a null-terminated string that names the file to be opened. The string must consist of characters from the Windows 3.<i>x</i> character set. The <b>OpenFile</b> function does not support Unicode filenames. </dd>
<dt>
<i>lpReOpenBuff</i></dt>
<dd>
Pointer to the <a href="filesio_2vw2.htm"><b>OFSTRUCT</b></a> structure that receives information about the file when it is first opened. The structure can be used in subsequent calls to the <b>OpenFile</b> function to refer to the open file. 
<p>
The <b>OFSTRUCT</b> structure contains a pathname string member whose length is limited to OFS_MAXPATHNAME characters. OFS_MAXPATHNAME is currently defined to be 128. Because of this, you cannot use the <b>OpenFile</b> function to open a file whose path length exceeds 128 characters. The <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function does not have such a path length limitation. 
</dd>
<dt>
<i>uStyle</i></dt>
<dd>
Specifies the action to take. The following values can be combined by using the bitwise OR operator: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=42%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=42%>OF_CANCEL</td>
<td width=58%>Ignored. In the Win32 application programming interface (API), the OF_PROMPT style produces a dialog box containing a Cancel button.</td>
</tr>
<tr valign=top>
<td width=42%>OF_CREATE</td>
<td width=58%>Creates a new file. If the file already exists, it is truncated to zero length.</td>
</tr>
<tr valign=top>
<td width=42%>OF_DELETE</td>
<td width=58%>Deletes the file.</td>
</tr>
<tr valign=top>
<td width=42%>OF_EXIST</td>
<td width=58%>Opens the file and then closes it. Used to test for a file's existence.</td>
</tr>
<tr valign=top>
<td width=42%>OF_PARSE</td>
<td width=58%>Fills the <b>OFSTRUCT</b> structure but carries out no other action.</td>
</tr>
<tr valign=top>
<td width=42%>OF_PROMPT</td>
<td width=58%>Displays a dialog box if the requested file does not exist. The dialog box informs the user that the system cannot find the file, and it contains <b>Retry</b> and <b>Cancel</b> buttons. Choosing the <b>Cancel</b> button directs <b>OpenFile</b> to return a file-not-found error message.</td>
</tr>
<tr valign=top>
<td width=42%>OF_READ</td>
<td width=58%>Opens the file for reading only.</td>
</tr>
<tr valign=top>
<td width=42%>OF_READWRITE</td>
<td width=58%>Opens the file for reading and writing.</td>
</tr>
<tr valign=top>
<td width=42%>OF_REOPEN</td>
<td width=58%>Opens the file using information in the reopen buffer.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_COMPAT</td>
<td width=58%>For MS-DOS–based file systems using the Win32 API, opens the file with compatibility mode, allowing any process on a specified computer to open the file any number of times. Other efforts to open with any other sharing mode fail. <p>
<b>Windows NT:</b> This flag is mapped to the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function's FILE_SHARE_READ | FILE_SHARE_WRITE flags.</p>
</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_NONE</td>
<td width=58%>Opens the file without denying read or write access to other processes. On MS-DOS-based file systems using the Win32 API, if the file has been opened in compatibility mode by any other process, the function fails. <p>
<b>Windows NT:</b> This flag is mapped to the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function's FILE_SHARE_READ | FILE_SHARE_WRITE flags.</p>
</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_READ</td>
<td width=58%>Opens the file and denies read access to other processes. On MS-DOS-based file systems using the Win32 API, if the file has been opened in compatibility mode or for read access by any other process, the function fails.  <b>Windows NT:</b> This flag is mapped to the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function's FILE_SHARE_WRITE flag.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_WRITE</td>
<td width=58%>Opens the file and denies write access to other processes. On MS-DOS-based file systems using the Win32 API, if the file has been opened in compatibility mode or for write access by any other process, the function fails.  <p>
<b>Windows NT:</b> This flag is mapped to the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function's FILE_SHARE_READ flag.</p>
</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_EXCLUSIVE</td>
<td width=58%>Opens the file with exclusive mode, denying both read and write access to other processes. If the file has been opened in any other mode for read or write access, even by the current process, the function fails.</td>
</tr>
<tr valign=top>
<td width=42%>OF_VERIFY</td>
<td width=58%>Verifies that the date and time of the file are the same as when it was previously opened. This is useful as an extra check for read-only files.</td>
</tr>
<tr valign=top>
<td width=42%>OF_WRITE</td>
<td width=58%>Opens the file for writing only.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value specifies a file handle.</p>
<p>
If the function fails, the return value is HFILE_ERROR. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
If the <i>lpFileName</i> parameter specifies a filename and extension only, this function searches for a matching file in the following directories, in the order shown: 
<ol>
<li>
The directory from which the application loaded. </li>
<li>
The current directory. </li>
<li>
<b>Windows 95:</b> The Windows system directory. Use the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsystemdirectory">
</object><a href=JavaScript:alink_1.Click()><b>GetSystemDirectory</b></a> function to get the path of this directory.<p>
<b>Windows NT:</b> The 32-bit Windows system directory. Use the <b>GetSystemDirectory</b> function to get the path of this directory. The name of this directory is SYSTEM32.
</li>
<li>
<b>Windows NT:</b> The 16-bit Windows system directory. There is no Win32 function that obtains the path of this directory, but it is searched. The name of this directory is SYSTEM.</li>
<li>
The Windows directory. Use the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getwindowsdirectory">
</object><a href=JavaScript:alink_2.Click()><b>GetWindowsDirectory</b></a> function to get the path of this directory. </li>
<li>
The directories that are listed in the PATH environment variable. </li>
</ol>
<p>
The <i>lpFileName</i> parameter cannot contain wildcard characters.</p>
<p>
The 32-bit <b>OpenFile</b> function does not support the OF_SEARCH flag supported by the 16-bit Windows <b>OpenFile </b>function. The OF_SEARCH flag directs the system to search for a matching file even when the filename includes a full path. To search for a file in a Win32-based application, use the <b>SearchPath</b> function.</p>
<p>
To close the file after use, call the <b>_lclose</b> function. </p>
<h4>See Also</h4>
<p>
<a href="filesio_2xm7.htm">File I/O Overview</a>, <a href="filesio_3n5f.htm">File Functions</a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsystemdirectory">
</object><a href=JavaScript:alink_3.Click()><b>GetSystemDirectory</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getwindowsdirectory">
</object><a href=JavaScript:alink_4.Click()><b>GetWindowsDirectory</b></a>, <a href="filesio_36sl.htm"><b>_lclose</b></a>, <a href="filesio_2vw2.htm"><b>OFSTRUCT</b></a>, <a href="filesio_13vs.htm"><b>SearchPath</b></a></p>
<p>&nbsp;</p></body>
</HTML>
