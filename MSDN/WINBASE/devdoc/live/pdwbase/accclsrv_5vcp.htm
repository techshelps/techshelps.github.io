<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreatePrivateObjectSecurity</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createprivateobjectsecurity"></a>CreatePrivateObjectSecurity</h1>
<p>
The <b>CreatePrivateObjectSecurity</b> function allocates and initializes a self-relative security descriptor for a new private object. A protected server calls this function when it creates a new private object. </p>
<pre><code><b>BOOL CreatePrivateObjectSecurity(
  PSECURITY_DESCRIPTOR</b><i> ParentDescriptor</i><b>,</b>
<b>                           </b>// pointer to parent directory SD
<b>  PSECURITY_DESCRIPTOR</b><i> CreatorDescriptor</i><b>,</b>
<b>                           </b>// pointer to creator SD
<b>  PSECURITY_DESCRIPTOR</b><i> *NewDescriptor</i><b>,</b>
<b>                           </b>// pointer to pointer to new SD
  <b>BOOL</b> <i>IsDirectoryObject</i><b>,</b>  // container flag for new SD
<b>  HANDLE</b><i> Token</i><b>,            </b>// handle to client's access token
<b>  PGENERIC_MAPPING</b><i> GenericMapping</i> 
                           // pointer to access-rights structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ParentDescriptor</i></dt>
<dd>
Pointer to the security descriptor for the parent directory in which a new object is being created. If there is no parent directory, this parameter can be NULL. </dd>
<dt>
<i>CreatorDescriptor</i></dt>
<dd>
Pointer to a security descriptor provided by the creator of the object. If the object's creator does not explicitly pass security information for the new object, this parameter is intended to be NULL. </dd>
<dt>
<i>lppsdNew</i></dt>
<dd>
Pointer to a variable that receives a pointer to the newly allocated self-relative security descriptor. The caller must call the <a href="accclsrv_4ozd.htm"><b>DestroyPrivateObjectSecurity</b></a> function to free this security descriptor.</dd>
<dt>
<i>IsDirectoryObject</i></dt>
<dd>
Specifies whether the new object is a container. A value of TRUE indicates the object contains other objects, such as a directory. </dd>
<dt>
<i>Token</i></dt>
<dd>
Identifies the access token for the client process on whose behalf the object is being created. If this is an impersonation token, it must be at SecurityIdentification level or higher. For a full description of the SecurityIdentification impersonation level, see the <a href="accclsrv_1rsi.htm"><b>SECURITY_IMPERSONATION_LEVEL</b></a> enumerated type  
<p>
A client token is used to retrieve default security information for the new object, such as its default owner, primary group, and discretionary access-control list. The token must be open for TOKEN_QUERY access. 
</dd>
<dt>
<i>GenericMapping</i></dt>
<dd>
Pointer to a <a href="accclsrv_29rm.htm"><b>GENERIC_MAPPING</b></a> structure that specifies the mapping from each generic right to specific rights for the object. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
If a system access-control list, or <b>SACL</b>, is specified in the <a href="accctrl_6i5u.htm"><b>SECURITY_DESCRIPTOR</b></a> specified by <i>CreatorDescriptor</i>, <i>Token</i> must have the SE_SECURITY_NAME privilege enabled, and the caller's token must have the SE_AUDIT_NAME privilege enabled. The <b>CreatePrivateObjectSecurity</b> function performs access/privilege checks to ensure this, and may generate audits during the process. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="accclsrv_64vg.htm">Client/Server Access Control Overview</a>, <a href="accclsrv_0hv7.htm">Client/Server Access Control Functions</a>, <a href="accclsrv_4ozd.htm"><b>DestroyPrivateObjectSecurity</b></a>, <a href="accclsrv_29rm.htm"><b>GENERIC_MAPPING</b></a>, <a href="accclsrv_87p5.htm"><b>GetPrivateObjectSecurity</b></a>, <a href="accctrl_2jvy.htm"><b>GetTokenInformation</b></a>, <a href="accctrl_0zam.htm"><b>OpenProcessToken</b></a>, <a href="accctrl_6i5u.htm"><b>SECURITY_DESCRIPTOR</b></a>, <a href="accclsrv_1rsi.htm"><b>SECURITY_IMPERSONATION_LEVEL</b></a>, <a href="accclsrv_31mh.htm"><b>SetPrivateObjectSecurity</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
