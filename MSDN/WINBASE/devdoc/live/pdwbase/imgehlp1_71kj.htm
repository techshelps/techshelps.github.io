<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ImageEnumerateCertificates</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_imageenumeratecertificates"></a>ImageEnumerateCertificates</h1>
<p>
The <b>ImageEnumerateCertificates</b> function is used to return information about the certificates currently contained in an image file.</p>
<pre><code><b>BOOL ImageEnumerateCertificates(
  IN HANDLE</b><i> FileHandle</i><b>,         </b>
<b>  IN DWORD</b><i> TypeFilter</i><b>,          </b>
<b>  OUT PDWORD</b><i> CertificateCount</i><b>,  </b>
<b>  IN OUT PDWORD Indices</b><i> OPTIONAL</i><b>,  </b>
<b>  IN OUT DWORD IndexCount</b><i> OPTIONAL  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>FileHandle</i></dt>
<dd>
Handle to the image file to be examined. This handle must be opened for FILE_READ_DATA access.</dd>
<dt>
<i>TypeFilter</i> </dt>
<dd>
Specifies a DICE certificate section type  to be used as a filter when returning certificate information. DICE_SECTION_TYPE_ANY should be passed for information on all section types present in the image.</dd>
<dt>
<i>CertificateCount</i></dt>
<dd>
Receives the number of certificates in the image containing sections of the type specified by the <i>TypeFilter </i>parameter. If none are found, this parameter is zero .</dd>
<dt>
<i>Indices</i></dt>
<dd>
Optionally provides a buffer to use to return an array of indices to the certificates containing sections of the specified type. No ordering should be assumed for the index values, nor are they guaranteed to be contiguous when DICE_SECTION_TYPE_ANY is queried.</dd>
<dt>
<i>IndexCount</i></dt>
<dd>
Specifies the length, in double-words, of the <i>Indices </i>buffer. This parameter will be examined whenever <i>Indices</i> is present. If <i>CertificateCount</i> is greater than <i>IndexCount</i>, <i>Indices</i> will be filled in with the first <i>IndexCount</i> sections found in the image and an appropriate warning will be returned.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is TRUE.</p>
<p>
If the function fails, the return value is FALSE. To retrieve extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
The <b>ImageEnumerateCertificates</b> function returns information about the certificates currently contained in an image file. It has filtering capabilities which allow certificates containing sections of any single type (or of any type) to be returned.</p>
<p>
After the indices of interesting certificates are discovered, they can be passed to the <a href="imgehlp1_0l41.htm"><b>ImageGetCertificateData</b></a> function to obtain the actual bodies of the certificates.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in imagehlp.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use imagehlp.lib.</p>
<h4>See Also</h4>
<p>
<a href="imgehlp1_3hzz.htm">PE Image Helper (ImageHlp) Overview</a>, <a href="imgehlp1_8s1l.htm">Image Integrity</a>, <a href="imgehlp1_0l41.htm"><b>ImageGetCertificateData</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
