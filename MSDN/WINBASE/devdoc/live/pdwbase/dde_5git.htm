<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WM_DDE_EXECUTE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wm_dde_execute"></a>WM_DDE_EXECUTE</h1>
<p>
A DDE client application posts a WM_DDE_EXECUTE message to a DDE server application to send a string to the server to be processed as a series of commands. The server application is expected to post a <a href="dde_678r.htm">WM_DDE_ACK</a> message in response. </p>
<pre><code>WM_DDE_EXECUTE 
wParam = (WPARAM) hwnd;        // handle of posting application 
lParam = (LPARAM) hCommands;   // handle to global object 
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hwnd</i></dt>
<dd>
Value of <i>wParam</i>. Handle to the client window posting the message. </dd>
<dt>
<i>hCommands</i></dt>
<dd>
Value of <i>lParam</i>. Contains a global memory object that references an ANSI or Unicode command string, depending on the types of windows involved in the conversation. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The command string is a null-terminated string consisting of one or more <i>opcode</i> strings enclosed in single brackets ([ ]). </p>
<p>
Each <i>opcode</i> string has the following syntax, where the <i>parameters</i> list is optional: </p>
<p>
<i>opcode parameters</i> </p>
<p>
The <i>opcode</i> is any application-defined single token. It cannot include spaces, commas, parentheses, brackets, or quotation marks. </p>
<p>
The <i>parameters</i> list can contain any application-defined value or values. Multiple parameters are separated by commas, and the entire parameter list is enclosed in parentheses. Parameters cannot include commas or parentheses except inside a quoted string. If a bracket or parenthesis character is to appear in a quoted string, it need not be doubled, as was the case under the old rules. </p>
<p>
Following are some valid command strings: </p>
<pre><code>[connect][download(query1,results.txt)][disconnect] 
[query("sales per employee for each district")] 
[open("sample.xlm")][run("r1c1")] 
[quote_case("This is a "" character")] 
[bracket_or_paren_case("()s or []s should be no problem.")] 
 </code></pre>
<p>
Note that, under the old rules, parentheses and brackets had to be doubled, as follows: </p>
<pre><code>[bracket_or_paren_case("(())s or [[]]s should be no problem.")] 
 </code></pre>
<p>
Servers should be able to parse commands in either form. </p>
<p>
Unicode execute strings should be used only when both the client and server window handles cause the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_iswindowunicode">
</object><a href=JavaScript:alink_1.Click()><b>IsWindowUnicode</b></a> function to return TRUE. </p>
<p class=indent1>
<b>Posting</b> </p>
<p>
The client application posts the WM_DDE_EXECUTE message by calling the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_postmessage">
</object><a href=JavaScript:alink_2.Click()><b>PostMessage</b></a> function, not the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_sendmessage">
</object><a href=JavaScript:alink_3.Click()><b>SendMessage</b></a> function. </p>
<p>
The client application allocates <i>hCommands</i> by calling the <a href="memman_66qr.htm"><b>GlobalAlloc</b></a> function with the GMEM_DDESHARE option. </p>
<p>
When processing the <a href="dde_678r.htm">WM_DDE_ACK</a> message that the server posts in reply to a WM_DDE_EXECUTE message, the client application must delete the <i>hCommands</i> object sent back in the WM_DDE_ACK message. </p>
<p class=indent1>
<b>Receiving</b> </p>
<p>
The server application posts the WM_DDE_ACK message to respond positively or negatively. The server should reuse the <i>hCommands</i> object. </p>
<p>
Unless specified otherwise by a sub-protocol, the server should not post the WM_DDE_ACK message until all the actions specified by the execute command string are completed. The one exception to this rule is when the string causes the server to terminate the conversation. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dde.h.</p>
<h4>See Also</h4>
<p>
<a href="dde_4oit.htm">Dynamic Data Exchange Overview</a>, <a href="dde_7voz.htm">Dynamic Data Exchange Messages</a>, <a href="memman_66qr.htm"><b>GlobalAlloc</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_iswindowunicode">
</object><a href=JavaScript:alink_4.Click()><b>IsWindowUnicode</b></a>, <a href="dde_059p.htm"><b>PackDDElParam</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_postmessage">
</object><a href=JavaScript:alink_5.Click()><b>PostMessage</b></a>, <a href="dde_54q5.htm"><b>ReuseDDElParam</b></a>, <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_sendmessage">
</object><a href=JavaScript:alink_6.Click()><b>SendMessage</b></a>, <a href="dde_0g19.htm"><b>UnpackDDElParam</b></a>, <a href="dde_678r.htm">WM_DDE_ACK</a> </p>
<p>&nbsp;</p></body>
</HTML>
