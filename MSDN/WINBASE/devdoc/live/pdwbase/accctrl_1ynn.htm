<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Controlling Access to an Object's Properties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_controlling_access_to_an_object_s_properties"></a>Controlling Access to an Object's Properties</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DACL of a directory service (DS) object can contain a hierarchy of ACEs, as follows:
<ol>
<li>
ACEs that protect the object itself </li>
<li>
<a href="accctrl_17zn.htm">Object-specific ACEs</a> that protect a specified property set on the object </li>
<li>
Object-specific ACEs that protect a specified property on the object </li>
</ol>
<p>
Within this hierarchy, the rights granted or denied at a higher level apply also to the lower levels. For example, if an object-specific ACE on a property set grants a trustee the DS_READ_PROPERTY right, the trustee has implicit read access to all the properties of that property set. Similarly, an ACE on the object itself that grants DS_READ_PROPERTY access gives the trustee read access to all of the object's properties. </p>
<p>
The following illustration shows the tree of a hypothetical DS object and its property sets and properties.</p>
<p>
<img src="images/accctrl2.gif" border=0></p>
<p>
Suppose you want to allow the following access to the properties of this DS object:
<ul>
<li>
Allow Group A read/write access to all of the object's properties, including Property D. </li>
<li>
Allow everyone else read/write access to all properties except Property D.</li>
</ul>
<p>
To do this, set the ACEs in the object's DACL as shown in the following table. </p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=15%><br>
Trustee</th>
<th align=left width=17%>Object GUID</th>
<th align=left width=24%><br>
ACE Type</th>
<th align=left width=44%>Provider-Independent <br>
Access Rights</th>
</tr>
<tr valign=top>
<td width=15%>Group A</td>
<td width=17%>None</td>
<td width=24%>Access-allowed ACE</td>
<td width=44%>ACTRL_DS_READ_PROP | ACTRL_DS_WRITE_PROP</td>
</tr>
<tr valign=top>
<td width=15%>Everyone </td>
<td width=17%>Property Set 1</td>
<td width=24%>Access-allowed object ACE</td>
<td width=44%>ACTRL_DS_READ_PROP | ACTRL_DS_WRITE_PROP</td>
</tr>
<tr valign=top>
<td width=15%>Everyone </td>
<td width=17%>Property C</td>
<td width=24%>Access-allowed object ACE</td>
<td width=44%>ACTRL_DS_READ_PROP | ACTRL_DS_WRITE_PROP</td>
</tr>
</table><br>
<p>
The ACE for Group A does not have an object GUID, which means that it allows access to all the object's properties. The object-specific ACE for Property Set 1 allows everyone access to Properties A and B. The other object-specific ACE allows everyone access to Property C. Note that although this DACL does not have any access-denied ACEs, it implicitly denies Property D access to everyone except Group A.</p>
<p>
When a user tries to access an object's property, the system checks the ACEs in order until the requested access is explicitly granted, denied, or there are no more ACEs, in which case, access is implicitly denied. The system evaluates:
<ul>
<li>
ACEs that apply to the object itself</li>
<li>
Object-specific ACEs that apply to the property set that contains the property being accessed</li>
<li>
Object-specific ACEs that apply to the property being accessed</li>
</ul>
<p>
The system ignores object-specific ACEs that apply to other property sets or properties.</p>
<p>&nbsp;</p></body>
</HTML>
