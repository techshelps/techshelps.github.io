<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetLastError</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setlasterror"></a>SetLastError</h1>
<p>
The <b>SetLastError</b> function sets the last-error code for the calling thread. </p>
<pre><code><b>VOID SetLastError(
  DWORD</b><i> dwErrCode</i>   // per-thread error code
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwErrCode</i></dt>
<dd>
Specifies the last-error code for the thread. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
Error codes are 32-bit values (bit 31 is the most significant bit). Bit 29 is reserved for application-defined error codes; no system error code has this bit set. If you are defining an error code for your application, set this bit to indicate that the error code has been defined by your application and to ensure that your error code does not conflict with any system-defined error codes. </p>
<p>
This function is intended primarily for dynamic-link libraries (DLLs). Calling this function after an error occurs lets the DLL emulate the behavior of a Win32 function. </p>
<p>
Most Win32 functions call <b>SetLastError </b>when they fail. Function failure is typically indicated by a return value error code such as FALSE, NULL, 0xFFFFFFFF, or –1. Some functions call <b>SetLastError </b>under conditions of success; those cases are noted in each function's reference page.</p>
<p>
Applications can retrieve the value saved by this function by using the <a href="errors_3uwi.htm"><b>GetLastError</b></a> function. The use of <b>GetLastError</b> is optional; an application can call it to find out the specific reason for a function failure. </p>
<p>
The last-error code is kept in thread local storage so that multiple threads do not overwrite each other's values. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="errors_8qr7.htm">Errors Overview</a>, <a href="errors_24mr.htm">Error Functions</a>, <a href="errors_3uwi.htm"><b>GetLastError</b></a>, <a href="errors_8ng8.htm"><b>SetLastErrorEx</b></a>, <a href="prothred_6azp.htm"><b>TlsGetValue</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
