<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MapAndLoad</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mapandload"></a>MapAndLoad</h1>
<p>
The <b>MapAndLoad</b> function maps an image and preloads data from the mapped file.</p>
<pre><code><b>BOOL MapAndLoad(
  IN LPSTR</b><i> ImageName</i><b>,             </b>
<b>  IN LPSTR</b><i> DllPath</i><b>,               </b>
<b>  OUT PLOADED_IMAGE</b><i> LoadedImage</i><b>,  </b>
<b>  IN BOOL</b><i> DotDll</i><b>,                 </b>
<b>  IN BOOL</b><i> ReadOnly                </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ImageName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the image that is loaded.</dd>
<dt>
<i>DllPath</i></dt>
<dd>
Pointer to a null-terminated string that specifies the path used to locate the image if the name provided cannot be found. If NULL is used, then the search path rules set forth in the <a href="filesio_13vs.htm"><b>SearchPath</b></a> function apply.</dd>
<dt>
<i>LoadedImage</i></dt>
<dd>
Pointer to a <a href="imgehlp1_4836.htm"><b>LOADED_IMAGE</b></a> structure that receives information about the image after it is loaded.</dd>
<dt>
<i>DotDll</i></dt>
<dd>
Specifies the default extension, if the image name does not contain a file extension. If the value is TRUE, a .DLL extension is used. If the value is FALSE, then an .EXE extension is used.</dd>
<dt>
<i>ReadOnly</i></dt>
<dd>
Specifies the access mode. If this value is TRUE, the file is mapped for read-access only. If the value is FALSE, the file is mapped for read and write access.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is TRUE.</p>
<p>
If the function fails, the return value is FALSE. To retrieve extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
The <b>MapAndLoad</b> function maps an image and preloads data from the mapped file. The corresponding function, <a href="imgehlp1_00mc.htm"><b>UnMapAndLoad</b></a>, <i>must</i> be used to deallocate all resources that are allocated by the <b>MapAndLoad</b> function<i>.</i></p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in imagehlp.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use imagehlp.lib.</p>
<h4>See Also</h4>
<p>
<a href="imgehlp1_3hzz.htm">PE Image Helper (ImageHlp) Overview</a>, <a href="imgehlp1_7ub7.htm">Image Access</a>, <a href="imgehlp1_4836.htm"><b>LOADED_IMAGE</b></a>, <a href="imgehlp1_00mc.htm"><b>UnMapAndLoad</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
