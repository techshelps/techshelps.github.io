<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_lopen</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32__lopen"></a>_lopen</h1>
<p>
The <b>_lopen</b> function opens an existing file and sets the file pointer to the beginning of the file. This function is provided for compatibility with 16-bit versions of Windows. Win32-based applications should use the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function. </p>
<pre><code><b>HFILE _lopen(
  LPCSTR</b><i> lpPathName</i><b>,  </b>// pointer to name of file to open
<b>  int</b><i> iReadWrite</i>      // file access mode
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpPathName</i></dt>
<dd>
Pointer to a null-terminated string that names the file to open. The string must consist of characters from the ANSI character set. </dd>
<dt>
<i>iReadWrite</i></dt>
<dd>
Specifies the modes in which to open the file. This parameter consists of one access mode and an optional share mode. The access mode must be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=30%>Value</th>
<th align=left width=70%>Meaning</th>
</tr>
<tr valign=top>
<td width=30%>OF_READ</td>
<td width=70%>Opens the file for reading only.</td>
</tr>
<tr valign=top>
<td width=30%>OF_READWRITE</td>
<td width=70%>Opens the file for reading and writing.</td>
</tr>
<tr valign=top>
<td width=30%>OF_WRITE</td>
<td width=70%>Opens the file for writing only.</td>
</tr>
</table><br>


<p>
The share mode can be one of the following values: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=42%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_COMPAT</td>
<td width=58%>Opens the file in compatibility mode, enabling any process on a given computer to open the file any number of times. If the file has been opened by using any of the other share modes, _<b>lopen</b> fails.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_NONE</td>
<td width=58%>Opens the file without denying other processes read or write access to the file. If the file has been opened in compatibility mode by any other process, <b>_lopen</b> fails.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_READ</td>
<td width=58%>Opens the file and denies other processes read access to the file. If the file has been opened in compatibility mode or for read access by any other process, <b>_lopen</b> fails.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_DENY_WRITE</td>
<td width=58%>Opens the file and denies other processes write access to the file. If the file has been opened in compatibility mode or for write access by any other process, <b>_lopen</b> fails.</td>
</tr>
<tr valign=top>
<td width=42%>OF_SHARE_EXCLUSIVE</td>
<td width=58%>Opens the file in exclusive mode, denying other processes both read and write access to the file. If the file has been opened in any other mode for read or write access, even by the current process, <b>_lopen</b> fails.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a file handle.</p>
<p>
If the function fails, the return value is HFILE_ERROR. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>See Also</h4>
<p>
<a href="filesio_2xm7.htm">File I/O Overview</a>, <a href="filesio_3n5f.htm">File Functions</a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
