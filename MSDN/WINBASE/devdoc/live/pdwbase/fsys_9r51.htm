<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDiskQuotaControl::AddUserName</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_idiskquotacontrol_addusername"></a>IDiskQuotaControl::AddUserName</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Adds a new quota entry on the volume for the specified user. The user is identified by domain and account name.</p>
<pre><code><b>HRESULT AddUserName(
</b>  <b>LPWSTR</b> <i>pszDomain</i><b>,</b>
  <b>LPWSTR</b> <i>pszName</i><b>,</b>
  <b>DWORD</b> <i>fNameResolution</i><b>,</b>
  <b>PDISKQUOTA_USER</b> <i>*ppUser</i>
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pszDomain</i></dt>
<dd>
Pointer to the user's domain name string.</dd>
<dt>
<i>pszName</i></dt>
<dd>
Pointer to the user's account name string. If <i>pszDomain</i> points to an empty string, <i>pszName</i> must point to a fully qualified "Domain\Account" string.</dd>
<dt>
<i>fNameResolution</i></dt>
<dd>
Indicates how the user account information is to be obtained. The volume's quota information identifies users by SID. The user account information (such as domain name, account name, and full name) must be obtained from the network domain controller, or the local computer if it is not on a network. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Value</th>
<th align=left width=68%>Meaning</th>
</tr>
<tr valign=top>
<td width=32%>DISKQUOTA_USERNAME_RESOLVE_NONE</td>
<td width=68%>Do not resolve user account information.</td>
</tr>
<tr valign=top>
<td width=32%>DISKQUOTA_USERNAME_RESOLVE_SYNC</td>
<td width=68%>Resolve user account information synchronously. <b>AddUserName</b> returns when the information is resolved. If the information exists in the disk quota SID cache, it is returned immediately. Otherwise, the method must locate the information. This can take several seconds.</td>
</tr>
<tr valign=top>
<td width=32%>DISKQUOTA_USERNAME_RESOLVE_ASYNC</td>
<td width=68%>Resolve user account information asynchronously. <b>AddUserName</b> returns immediately. The caller must implement the <a href="fsys_83jn.htm"><b>IDiskQuotaEvents</b></a> interface to receive notification when the information is available. If the information was cached during a previous request, notification occurs as soon as the object is serviced. Otherwise, the method obtains the information from the network domain controller, then notifies <b>IDiskQuotaEvents</b>.</td>
</tr>
</table><br>

</dd>
<dt>
<i>ppUser</i></dt>
<dd>
Pointer to receive the <a href="fsys_3noy.htm"><b>IDiskQuotaUser</b></a> interface pointer to the newly created quota user object.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method returns one of the following values. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>S_OK</td>
<td width=56%>Success.</td>
</tr>
<tr valign=top>
<td width=44%>E_OUTOFMEMORY</td>
<td width=56%>Insufficient memory.</td>
</tr>
<tr valign=top>
<td width=44%>S_FALSE</td>
<td width=56%>User already exists. Not added.</td>
</tr>
<tr valign=top>
<td width=44%>E_POINTER</td>
<td width=56%>Pointer parameter was NULL.</td>
</tr>
<tr valign=top>
<td width=44%>DQC_E_USER_UNKNOWN</td>
<td width=56%>The specified user is unknown.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The NTFS file system automatically creates a user quota entry when a user first writes to the volume. Entries that are created automatically are assigned the default warning threshold and hard quota limit values for the volume. This method allows you to create a user quota entry before a user has written information to the volume. Therefore, you can pre-assign a warning threshold or hard quota limit value different than the volume default settings.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dskquota.h.</p>
<h4>See Also</h4>
<p>
<a href="fsys_4jeb.htm">File Systems Overview</a>, <a href="fsys_5ir7.htm">File System Interfaces</a>, <a href="fsys_6bvw.htm"><b>IDiskQuotaControl</b></a></p>
<p>&nbsp;</p></body>
</HTML>
