<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automatically Starting Services</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_automatically_starting_services"></a>Automatically Starting Services</h3>
<p>
During system boot, the SCM starts all auto-start services and the services on which they depend. For example, if an auto-start service depends on a demand-start service, the demand-start service is also started automatically. The load order is determined by the following:
<ol>
<li>
The order of groups in the load ordering group list, <b>ServiceGroupOrder</b>, in the following registry key:<p>
<b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control</b>
</li>
<li>
The order of services within a group specified in the tags order vector, <b>GroupOrderList</b>, in the following registry key<p>
<b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control</b>
</li>
<li>
The dependencies listed for each service. </li>
</ol>
<p>
When the boot is complete, the system executes the boot verification program specified by <b>BootVerificationProgram</b> value of the following registry key:</p>
<p>
<b>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control</b></p>
<p>
By default, this value is not set. The system simply reports that the boot was successful after the first user has logged on. You can supply a boot verification program that checks the system for problems and reports the boot status to the SCM using the <a href="services_52cz.htm"><b>NotifyBootConfigStatus</b></a> function. </p>
<p>
After a successful boot, the system saves a clone of the database in the last-known-good (LKG) configuration. The system can restore this copy of the database if changes made to the active database cause the system reboot to fail. The following is the registry key for this database, </p>
<p>
<b>HKEY_LOCAL_MACHINE\SYSTEM\ControlSetXXX\Services</b></p>
<p>
where XXX is the value saved in the following registry key value: <b>HKEY_LOCAL_MACHINE\System\Select\LastKnownGood</b>.</p>
<p>
If an auto-start service with a SERVICE_ERROR_CRITICAL error control level fails to start, the SCM reboots the machine using the LKG configuration. If the LKG configuration is already being used, the boot fails. </p>
<p>&nbsp;</p></body>
</HTML>
