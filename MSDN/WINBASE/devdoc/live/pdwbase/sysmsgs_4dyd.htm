<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Processing a Request to Remove a Device</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_processing_a_request_to_remove_a_device"></a>Processing a Request to Remove a Device</h2>
<p>
An application receives a <a href="sysmsgs_1qzp.htm">DBT_DEVICEQUERYREMOVE</a> message when a component in the system has decided to remove a given device. When the application receives this message, it should determine whether it is using the given device and either cancel or prepare for the removal. In the following example, the application processes the message by checking the type of device that is to be removed. </p>
<pre><code>PDEV_BROADCAST_HDR pdbch;
PDEV_BROADCAST_VOLUME pdbcv;

case WM_DEVICECHANGE:
    pdbch = (PDEV_BROADCAST_HDR) lParam;
    switch (pdbch-&gt;dbch_devicetype) 
    {
        case DBT_DEVTYP_VOLUME:
            pdbcv = (PDEV_BROADCAST_VOLUME) pdbch;
            if (pdbcv-&gt;dbcv_flags == DBTF_MEDIA) 
                // pdbcv-&gt;dbcv_unitmask identifies which logical drive
            return TRUE;
        default:
            return TRUE;
    }
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
