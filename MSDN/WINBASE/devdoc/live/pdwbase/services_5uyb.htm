<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetServiceBits</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setservicebits"></a>SetServiceBits</h1>
<p>
The <b>SetServiceBits</b> function registers a service type with the service control manager and the Server service. The Server service can then announce the registered service type as one it currently supports. The <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_netservergetinfo">
</object><a href=JavaScript:alink_1.Click()><b>NetServerGetInfo</b></a> and <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_netserverenum">
</object><a href=JavaScript:alink_2.Click()><b>NetServerEnum</b></a> functions obtain a specified machine's supported service types.</p>
<p>
A service type is represented as a set of bit flags; the <b>SetServiceBits</b> function sets or clears combinations of those bit flags.</p>
<pre><code><b>BOOL SetServiceBits(
  SERVICE_STATUS_HANDLE</b><i> hServiceStatus</i><b>,</b>
<b>                    </b>// service status handle
<b>  DWORD</b><i> dwServiceBits</i><b>,</b>
<b>                    </b>// service type bits to set or clear
<b>  BOOL</b><i> bSetBitsOn</i><b>,  </b>// flag to set or clear the service type bits
<b>  BOOL</b><i> bUpdateImmediately</i>
<i>                    </i>// flag to announce server type immediately
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hServiceStatus</i></dt>
<dd>
A handle to the information structure for a service. A service obtains the handle by calling the <a href="services_7t0y.htm"><b>RegisterServiceCtrlHandler</b></a> function. </dd>
<dt>
<i>dwServiceBits</i></dt>
<dd>
A set of bit flags that specifies a service type.
<p>
Certain bit flags (0xC00F3F7B) are reserved for use by Microsoft. The <b>SetServiceBits</b> function fails with the error ERROR_INVALID_DATA if any of these bit flags are set in <i>dwServiceBits</i>. The following 18 bit flags are reserved for use by Microsoft:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Reserved Bit Flag</th>
<th align=left width=45%>Value</th>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_WORKSTATION</td>
<td width=45%>0x00000001</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_SERVER</td>
<td width=45%>0x00000002</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_DOMAIN_CTRL</td>
<td width=45%>0x00000008</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_DOMAIN_BAKCTRL</td>
<td width=45%>0x00000010</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_TIME_SOURCE</td>
<td width=45%>0x00000020</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_AFP</td>
<td width=45%>0x00000040</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_DOMAIN_MEMBER</td>
<td width=45%>0x00000100</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_PRINTQ_SERVER</td>
<td width=45%>0x00000200</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_DIALIN_SERVER</td>
<td width=45%>0x00000400</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_XENIX_SERVER</td>
<td width=45%>0x00000800</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_SERVER_UNIX </td>
<td width=45%>0x00000800</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_NT</td>
<td width=45%>0x00001000</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_WFW</td>
<td width=45%>0x00002000</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_POTENTIAL_BROWSER</td>
<td width=45%>0x00010000</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_BACKUP_BROWSER</td>
<td width=45%>0x00020000</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_MASTER_BROWSER</td>
<td width=45%>0x00040000</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_DOMAIN_MASTER</td>
<td width=45%>0x00080000</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_LOCAL_LIST_ONLY</td>
<td width=45%>0x40000000</td>
</tr>
<tr valign=top>
<td width=55%>SV_TYPE_DOMAIN_ENUM</td>
<td width=45%>0x80000000</td>
</tr>
</table><br>


<p>
Certain bit flags (0x00300084) are defined by Microsoft, but are not specifically reserved for systems software. The following are these four bit flags:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%>Bit Flag Constant</th>
<th align=left width=48%>Value</th>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_SV_TYPE_SQLSERVER</td>
<td width=48%>0x00000004</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_NOVELL</td>
<td width=48%>0x00000080</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DOMAIN_CTRL</td>
<td width=48%>0x00100000</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DOMAIN_BAKCTRL</td>
<td width=48%>0x00200000</td>
</tr>
</table><br>


<p>
Certain bit flags (0x3FC0C000) are not defined by Microsoft, and their use is not coordinated by Microsoft. Developers of applications that use these bits should be aware that other applications can also use them, thus creating a conflict. The following are these 10 bit flags:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=51%>Value</th>
<th align=left width=49%>Value</th>
</tr>
<tr valign=top>
<td width=51%>0x00004000</td>
<td width=49%>0x02000000</td>
</tr>
<tr valign=top>
<td width=51%>0x00008000</td>
<td width=49%>0x04000000</td>
</tr>
<tr valign=top>
<td width=51%>0x00400000</td>
<td width=49%>0x08000000</td>
</tr>
<tr valign=top>
<td width=51%>0x00800000</td>
<td width=49%>0x10000000</td>
</tr>
<tr valign=top>
<td width=51%>0x01000000</td>
<td width=49%>0x20000000</td>
</tr>
</table><br>

</dd>
<dt>
<i>bSetBitsOn</i></dt>
<dd>
Specifies whether the function is to set or clear the bit flags that are set in <i>dwServiceBit.</i> If this value is TRUE, the bits are to be set. If this value is FALSE, the bits are to be cleared.</dd>
<dt>
<i>bUpdateImmediately</i></dt>
<dd>
Specifies whether the Server service is to perform an immediate update, announcing the new service type. If this value is TRUE, the update is to be performed immediately. If this value is FALSE, the update will not be performed immediately.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmserver.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="services_0p0z.htm">Services Overview</a>, <a href="services_2uwj.htm">Service Functions</a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_netservergetinfo">
</object><a href=JavaScript:alink_3.Click()><b>NetServerGetInfo</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_netserverenum">
</object><a href=JavaScript:alink_4.Click()><b>NetServerEnum</b></a>, <a href="services_7t0y.htm"><b>RegisterServiceCtrlHandler</b></a>, <a href="services_90oj.htm"><b>SetServiceStatus</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
