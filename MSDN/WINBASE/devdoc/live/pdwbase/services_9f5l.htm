<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Service Security</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_service_security"></a>Service Security</h2>
<p>
When a process uses the <a href="services_4c36.htm"><b>OpenSCManager</b></a> function to open a handle to a database of installed services, it can request different types of access. The system performs a security check before granting the requested access. All processes are permitted the following access to the database:
<ul>
<li>
SC_MANAGER_CONNECT </li>
<li>
SC_MANAGER_ENUMERATE_SERVICE </li>
<li>
SC_MANAGER_QUERY_LOCK_STATUS </li>
</ul>
<p>
This enables any process to open a handle to the SCManager object that it can use in calls to the <a href="services_8isl.htm"><b>OpenService</b></a>, <a href="services_8cvn.htm"><b>EnumServicesStatus</b></a>, and <a href="services_1jg3.htm"><b>QueryServiceLockStatus</b></a> functions. Only processes with Administrator privileges are able to open handles to the SCManager object that can be used by the <a href="services_3p9h.htm"><b>CreateService</b></a> and <a href="services_5uw5.htm"><b>LockServiceDatabase</b></a> functions. </p>
<p>
When a process uses the <b>OpenService</b> function, the system performs an access check. The type of access permitted to different users depends on the <a href="accctrl_6i5u.htm"><b>SECURITY_DESCRIPTOR</b></a> structure associated with the service object. The SCM creates a service object's security descriptor when the service is installed by the <b>CreateService</b> function. You can use the <a href="acctrlow_1vcp.htm"><b>QueryServiceObjectSecurity</b></a> and <a href="acctrlow_2jcp.htm"><b>SetServiceObjectSecurity</b></a> functions to query and set the security descriptor of a service object. The default security descriptor of a service object permits the following access: 
<ul>
<li>
All users have SERVICE_QUERY_CONFIG, SERVICE_QUERY_STATUS, SERVICE_ENUMERATE_DEPENDENTS, SERVICE_INTERROGATE, and SERVICE_USER_DEFINED_CONTROL access. </li>
<li>
Members of the Power Users group and the LocalSystem account have SERVICE_START, SERVICE_PAUSE_CONTINUE, and SERVICE_STOP access, plus the access rights granted to all users. </li>
<li>
Members of the Administrators and System Operators groups have SERVICE_ALL_ACCESS access. </li>
</ul>
<p>&nbsp;</p></body>
</HTML>
