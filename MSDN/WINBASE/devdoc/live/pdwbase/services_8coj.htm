<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>QueryServiceStatus</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_queryservicestatus"></a>QueryServiceStatus</h1>
<p>
The <b>QueryServiceStatus</b> function retrieves the current status of the specified service. </p>
<pre><code><b>BOOL QueryServiceStatus(
  SC_HANDLE</b><i> hService</i><b>,  </b>// handle of service
<b>  LPSERVICE_STATUS</b><i> lpServiceStatus</i> 
                       // address of service status structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hService</i></dt>
<dd>
Handle to the service. This handle is returned by the <a href="services_8isl.htm"><b>OpenService</b></a> or the <a href="services_3p9h.htm"><b>CreateService</b></a> function, and it must have SERVICE_QUERY_STATUS access. </dd>
<dt>
<i>lpServiceStatus</i></dt>
<dd>
Pointer to a <a href="services_9s36.htm"><b>SERVICE_STATUS</b></a> structure in which the status information is returned. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Errors</h4>
<p>
The following error codes can be set by the service control manager. Other error codes can be set by the registry functions that are called by the service control manager. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=42%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=42%>ERROR_ACCESS_DENIED</td>
<td width=58%>The specified handle was not opened with SERVICE_QUERY_STATUS access.</td>
</tr>
<tr valign=top>
<td width=42%>ERROR_INVALID_HANDLE</td>
<td width=58%>The specified handle is invalid.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>QueryServiceStatus</b> function returns the most recent service status information reported to the service control manager. If the service just changed its status, it may not have updated the service control manager yet. Applications can find out the current service status by interrogating the service directly using the <a href="services_3fs5.htm"><b>ControlService</b></a> function with the SERVICE_CONTROL_INTERROGATE control code. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winsvc.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="services_0p0z.htm">Services Overview</a>, <a href="services_2uwj.htm">Service Functions</a>, <a href="services_3fs5.htm"><b>ControlService</b></a>, <a href="services_3p9h.htm"><b>CreateService</b></a>, <a href="services_8isl.htm"><b>OpenService</b></a>, <a href="services_9s36.htm"><b>SERVICE_STATUS</b></a>, <a href="services_90oj.htm"><b>SetServiceStatus</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
