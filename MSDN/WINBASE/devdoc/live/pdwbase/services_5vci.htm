<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>QUERY_SERVICE_CONFIG</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_query_service_config_str"></a>QUERY_SERVICE_CONFIG</h1>
<p>
The <b>QUERY_SERVICE_CONFIG</b> structure is used by the <a href="services_7yjr.htm"><b>QueryServiceConfig</b></a> function to return configuration information about an installed service. </p>
<pre><code>typedef struct _QUERY_SERVICE_CONFIG { // qsc 
    DWORD dwServiceType; 
    DWORD dwStartType; 
    DWORD dwErrorControl; 
    LPTSTR lpBinaryPathName; 
    LPTSTR lpLoadOrderGroup; 
    DWORD dwTagId; 
    LPTSTR lpDependencies; 
    LPTSTR lpServiceStartName; 
    LPTSTR lpDisplayName; 
} QUERY_SERVICE_CONFIG, LPQUERY_SERVICE_CONFIG; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>dwServiceType</b></dt>
<dd>
The value returned includes one of the following service type flags to indicate the type of service. In addition, for a SERVICE_WIN32 service, the SERVICE_INTERACTIVE_PROCESS flag might be set, indicating that the service process can interact with the desktop.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Value</th>
<th align=left width=47%>Meaning</th>
</tr>
<tr valign=top>
<th align=left width=53%>SERVICE_WIN32_OWN_PROCESS</th>
<td width=47%>A service type flag that indicates a Win32 service that runs in its own process.</td>
</tr>
<tr valign=top>
<th align=left width=53%>SERVICE_WIN32_SHARE_PROCESS</th>
<td width=47%>A service type flag that indicates a Win32 service that shares a process with other services.</td>
</tr>
<tr valign=top>
<th align=left width=53%>SERVICE_KERNEL_DRIVER</th>
<td width=47%>A service type flag that indicates a device driver.</td>
</tr>
<tr valign=top>
<th align=left width=53%>SERVICE_FILE_SYSTEM_DRIVER</th>
<td width=47%>A service type flag that indicates a file system driver.</td>
</tr>
<tr valign=top>
<th align=left width=53%>SERVICE_INTERACTIVE_PROCESS </th>
<td width=47%>A flag that indicates a Win32 service process that can interact with the desktop.</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwStartType</b></dt>
<dd>
Specifies when to start the service. One of the following values is specified: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>SERVICE_BOOT_START</td>
<td width=56%>Specifies a device driver started by the system loader. This value is valid only if the service type is SERVICE_KERNEL_DRIVER or SERVICE_FILE_SYSTEM_DRIVER.</td>
</tr>
<tr valign=top>
<td width=44%>SERVICE_SYSTEM_START</td>
<td width=56%>Specifies a device driver started by the <b>IoInitSystem</b> function. This value is valid only if the service type is SERVICE_KERNEL_DRIVER or SERVICE_FILE_SYSTEM_DRIVER.</td>
</tr>
<tr valign=top>
<td width=44%>SERVICE_AUTO_START</td>
<td width=56%>Specifies a device driver or Win32 service started by the service control manager automatically during system startup.</td>
</tr>
<tr valign=top>
<td width=44%>SERVICE_DEMAND_START</td>
<td width=56%>Specifies a device driver or Win32 service started by the service control manager when a process calls the <a href="services_8ox1.htm"><b>StartService</b></a> function.</td>
</tr>
<tr valign=top>
<td width=44%>SERVICE_DISABLED</td>
<td width=56%>Specifies a device driver or Win32 service that can no longer be started.</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwErrorControl</b></dt>
<dd>
Specifies the severity of the error if this service fails to start during startup, and determines the action taken by the startup program if failure occurs. One of the following values can be specified: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Value</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>SERVICE_ERROR_IGNORE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>The startup (boot) program logs the error but continues the startup operation.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>SERVICE_ERROR_NORMAL</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>The startup program logs the error and displays a message box pop-up but continues the startup operation.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>SERVICE_ERROR_SEVERE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>The startup program logs the error. If the last-known good configuration is being started, the startup operation continues. Otherwise, the system is restarted with the last-known-good configuration.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>SERVICE_ERROR_CRITICAL</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>The startup program logs the error, if possible. If the last-known good configuration is being started, the startup operation fails. Otherwise, the system is restarted with the last-known good configuration.</td>
</tr>
</table><br>

</dd>
<dt>
<b>lpBinaryPathName</b></dt>
<dd>
Pointer to a null-terminated string that contains the fully qualified path to the service binary file. </dd>
<dt>
<b>lpLoadOrderGroup</b></dt>
<dd>
Pointer to a null-terminated string that names the load ordering group of which this service is a member. If the pointer is NULL or if it points to an empty string, the service does not belong to a group. The registry has a list of load ordering groups located at:
<p>
HKEY_LOCAL_MACHINE\System<br>
\CurrentControlSet\Control\ServiceGroupOrder. 

<p>
The startup program uses this list to load groups of services in a specified order with respect to the other groups in the list. You can place a service in a group so that another service can depend on the group. 

<p>
The order in which a service starts is determined by the following criteria: 

<ol>
<li>
The order of groups in the registry's load-ordering group list. Services in groups in the load-ordering group list are started first, followed by services in groups not in the load-ordering group list and then services that do not belong to a group. </li>
<li>
The service's dependencies listed in the <i>lpszDependencies</i> parameter and the dependencies of other services dependent on the service. </li>
</ol>
</dd>
<dt>
<b>dwTagId</b></dt>
<dd>
Specifies a unique tag value for this service in the group specified by the <i>lpLoadOrderGroup</i> parameter. A value of zero indicates that the service has not been assigned a tag. You can use a tag for ordering service startup within a load order group by specifying a tag order vector in the registry located at:
<p>
HKEY_LOCAL_MACHINE\System\CurrentControlSet<br>
\Control\GroupOrderList 

<p>
Tags are only evaluated for SERVICE_KERNEL_DRIVER and SERVICE_FILE_SYSTEM_DRIVER type services that have SERVICE_BOOT_START or SERVICE_SYSTEM_START start types. 
</dd>
<dt>
<b>lpDependencies</b></dt>
<dd>
Pointer to an array of null-separated names of services or load ordering groups that must start before this service. The array is doubly null-terminated. If the pointer is NULL or if it points to an empty string, the service has no dependencies. If a group name is specified, it must be prefixed by the SC_GROUP_IDENTIFIER (defined in the WINSVC.H file) character to differentiate it from a service name, because services and service groups share the same name space. Dependency on a service means that this service can only run if the service it depends on is running. Dependency on a group means that this service can run if at least one member of the group is running after an attempt to start all members of the group. </dd>
<dt>
<b>lpServiceStartName</b></dt>
<dd>
Pointer to a null-terminated string. If the service type is SERVICE_WIN32_OWN_PROCESS or SERVICE_WIN32_SHARE_PROCESS, this name is the account name in the form of "DomainName\Username", which the service process will be logged on as when it runs. If the account belongs to the built-in domain, ".\Username" can be specified. If NULL is specified, the service will be logged on as the LocalSystem account. 
<p>
If the service type is SERVICE_KERNEL_DRIVER or SERVICE_FILE_SYSTEM_DRIVER, this name is the driver object name (that is, \FileSystem\Rdr or \Driver\Xns) which the input and output (I/O) system uses to load the device driver. If NULL is specified, the driver is run with a default object name created by the I/O system based on the service name. 
</dd>
<dt>
<b>lpDisplayName</b></dt>
<dd>
Pointer to a null-terminated string that is to be used by user interface programs to identify the service. This string has a maximum length of 256 characters. The name is case-preserved in the service control manager. Display name comparisons are always case-insensitive. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The configuration information for a service is initially specified when the service is created by a call to the <b>CreateService</b> function. The information can be modified by calling the <b>ChangeServiceConfig</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winsvc.h.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined as Unicode and ANSI structures.</p>
<h4>See Also</h4>
<p>
<a href="services_0p0z.htm">Services Overview</a>, <a href="services_0ofn.htm">Service Structures</a>, <a href="services_5gh3.htm"><b>ChangeServiceConfig</b></a>, <a href="services_3p9h.htm"><b>CreateService</b></a>, <a href="services_7yjr.htm"><b>QueryServiceConfig</b></a>, <a href="services_8ox1.htm"><b>StartService</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
