<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ClearEventLog</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_cleareventlog"></a>ClearEventLog</h1>
<p>
The <b>ClearEventLog</b> function clears the specified event log, and optionally saves the current copy of the logfile to a backup file. </p>
<pre><code><b>BOOL ClearEventLog(
  HANDLE</b><i> hEventLog</i><b>,          </b>// handle to event log
<b>  LPCTSTR</b><i> lpBackupFileName</i>   // name of backup file
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hEventLog</i></dt>
<dd>
Handle to the event log to be cleared. This handle is returned by the <a href="eventlog_3elj.htm"><b>OpenEventLog</b></a> function. </dd>
<dt>
<i>lpBackupFileName</i></dt>
<dd>
Pointer to the null-terminated string specifying the name of a file in which a current copy of the event logfile will be placed. If this file already exists, the function fails. 
<p>
If the <i>lpBackupFileName</i> parameter is NULL, the current event logfile is not backed up. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero. The specified event log has been backed up (if <i>lpBackupFileName</i> is not NULL) and then cleared.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. The <b>ClearEventLog</b> function fails if the event log is empty or a file already exists with the same name as <i>lpBackupFileName</i>. </p>
<h4>Remarks</h4>
<p>
After this function returns, any handles that reference the cleared event log cannot be used to read the log. </p>
<p>
The <b>ClearEventLog</b> function is used to optionally back up an existing logfile of the module represented by <i>hEventLog</i>. The function backs up the logfile to another file, and then clears the existing logfile. The caller must have write permission for the path specified, and must also have permission to clear the current logfile. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="eventlog_2tbb.htm">Event Logging Overview</a>, <a href="eventlog_622b.htm">Event Logging Functions</a>, <a href="eventlog_3elj.htm"><b>OpenEventLog</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
