<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DdeConnectList</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ddeconnectlist"></a>DdeConnectList</h1>
<p>
The <b>DdeConnectList</b> function establishes a conversation with all server applications that support the specified service name and topic name pair. An application can also use this function to obtain a list of conversation handles by passing the function an existing conversation handle. The <a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library</a> removes the handles of any terminated conversations from the conversation list. The resulting conversation list contains the handles of all currently established conversations that support the specified service name and topic name. </p>
<pre><code><b>HCONVLIST DdeConnectList(
  DWORD</b><i> idInst</i><b>,         </b>// instance identifier
<b>  HSZ</b><i> hszService</i><b>,       </b>// handle to service name string
<b>  HSZ</b><i> hszTopic</i><b>,         </b>// handle to topic name string
<b>  HCONVLIST</b><i> hConvList</i><b>,  </b>// handle to conversation list
<b>  PCONVCONTEXT</b><i> pCC</i>      // pointer to structure with context data
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>idInst</i></dt>
<dd>
Specifies the application instance identifier obtained by a previous call to the <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a> function. </dd>
<dt>
<i>hszService</i></dt>
<dd>
Handle to the string that specifies the service name of the server application with which a conversation is to be established. If this parameter is 0L, the system attempts to establish conversations with all available servers that support the specified topic name. </dd>
<dt>
<i>hszTopic</i></dt>
<dd>
Handle to the string that specifies the name of the topic on which a conversation is to be established. This handle must have been created by a previous call to the <a href="ddemlib_85et.htm"><b>DdeCreateStringHandle</b></a> function. If this parameter is 0L, the system will attempt to establish conversations on all topics supported by the selected server (or servers). </dd>
<dt>
<i>hConvList</i></dt>
<dd>
Handle to the conversation list to be enumerated. This parameter should be 0L if a new conversation list is to be established. </dd>
<dt>
<i>pCC</i></dt>
<dd>
Pointer to the <a href="ddemlib_4auq.htm"><b>CONVCONTEXT</b></a> structure that contains conversation-context information. If this parameter is NULL, the server receives the default <b>CONVCONTEXT</b> structure during the XTYP_CONNECT or XTYP_WILDCONNECT transaction. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the handle to a new conversation list.</p>
<p>
If the function fails, the return value is 0L. The handle to the old conversation list is no longer valid. </p>
<h4>Errors</h4>
<p>
The <a href="ddemlib_89bm.htm"><b>DdeGetLastError</b></a> function can be used to get the error code, which may be one of the following values: </p>
<p>
DMLERR_DLL_NOT_INITIALIZED<br>
DMLERR_INVALID_PARAMETER<br>
DMLERR_NO_CONV_ESTABLISHED<br>
DMLERR_NO_ERROR<br>
DMLERR_SYS_ERROR</p>
<h4>Remarks</h4>
<p>
An application must free the conversation list handle returned by the <b>DdeConnectList</b> function, regardless of whether any conversation handles within the list are active. To free the handle, an application can call <b>DdeDisconnectList</b>. </p>
<p>
All members of the default <b>CONVCONTEXT</b> structure are set to zero except <b>cb</b>, specifying the size of the structure, and <b>iCodePage</b>, specifying CP_WINANSI (the default code page) or CP_WINUNICODE, depending on whether the ANSI or Unicode version of the <b>DdeInitialize</b> function was called by the client application. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ddeml.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library Overview</a>, <a href="ddemlib_1nn7.htm">Dynamic Data Exchange Management Functions</a>, <a href="ddemlib_4auq.htm"><b>CONVCONTEXT</b></a>, <a href="ddemlib_9i9g.htm"><b>DdeConnect</b></a>, <a href="ddemlib_85et.htm"><b>DdeCreateStringHandle</b></a>, <a href="ddemlib_72yc.htm"><b>DdeDisconnect</b></a>, <a href="ddemlib_3vzo.htm"><b>DdeDisconnectList</b></a>, <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a>, <a href="ddemlib_5i2a.htm"><b>DdeQueryNextServer</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
