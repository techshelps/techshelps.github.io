<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetDateFormat</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getdateformat"></a>GetDateFormat</h1>
<p>
The <b>GetDateFormat</b> function formats a date as a date string for a specified locale. The function formats either a specified date or the local system date.</p>
<pre><code><b>int GetDateFormat(
  LCID</b><i> Locale</i><b>,               </b>// locale for which date is to be formatted
<b>  DWORD</b><i> dwFlags</i><b>,             </b>// flags specifying function options
<b>  CONST SYSTEMTIME</b><i> *lpDate</i><b>,  </b>// date to be formatted
<b>  LPCTSTR</b><i> lpFormat</i><b>,          </b>// date format string
<b>  LPTSTR</b><i> lpDateStr</i><b>,          </b>// buffer for storing formatted string
<b>  int</b><i> cchDate</i>                // size of buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Locale</i></dt>
<dd>
Specifies the locale for which the date string is to be formatted. If <i>lpFormat</i> is NULL, the function formats the string according to the date format for this locale. If <i>lpFormat</i> is not NULL, the function uses the locale only for information not specified in the format picture string (for example, the locale's day and month names).
<p>
This parameter can be a locale identifier created by the <a href="nls_7qck.htm"><b>MAKELCID</b></a> macro, or one of the following predefined values:

<table cellspacing=4 cols=4>
<tr valign=top>
<td width=49%>LOCALE_SYSTEM_DEFAULT</td>
<td colspan=2 width=50%>Default system locale.</td>
</tr>
<tr valign=top>
<td width=49%>LOCALE_USER_DEFAULT</td>
<td colspan=2 width=50%>Default user locale.</td>
</tr>
<tr valign=top>
<td colspan=2 width=50%>LOCALE_NEUTRAL</td>
<td colspan=2 width=50%>Default language-neutral locale.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
A set of bit flags that specify various function options. If <i>lpFormat</i> is non-NULL, this parameter must be zero.
<p>
If <i>lpFormat</i> is NULL, you can specify a combination of the following flags: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Flag</th>
<th align=left width=55%>Meaning</th>
</tr>
<tr valign=top>
<td width=45%>LOCALE_NOUSEROVERRIDE </td>
<td width=55%>If set, the function formats the string using the system default date format for the specified locale. If not set, the function formats the string using any user overrides to the locale's default date format.</td>
</tr>
<tr valign=top>
<td width=45%>DATE_SHORTDATE</td>
<td width=55%>Use the short date format. This is the default. Cannot be used with DATE_LONGDATE or DATE_YEARMONTH. </td>
</tr>
<tr valign=top>
<td width=45%>DATE_LONGDATE</td>
<td width=55%>Use the long date format. Cannot be used with DATE_SHORTDATE or DATE_YEARMONTH. </td>
</tr>
<tr valign=top>
<td width=45%>DATE_YEARMONTH</td>
<td width=55%>Use the year/month format. Cannot be used with DATE_SHORTDATE or DATE_LONGDATE.</td>
</tr>
<tr valign=top>
<td width=45%>DATE_USE_ALT_CALENDAR</td>
<td width=55%>Use the alternate calendar, if one exists, to format the date string. If this flag is set, the function uses the default format for that alternate calendar, rather than using any user overrides. The user overrides will be used only in the event that there is no default format for the specified alternate calendar.</td>
</tr>
<tr valign=top>
<td width=45%>DATE_LTRREADING</td>
<td width=55%>Adds marks for left-to-right reading order layout. Cannot be used with DATE_RTLREADING.</td>
</tr>
<tr valign=top>
<td width=45%>DATE_RTLREADING</td>
<td width=55%>Adds marks for right-to left reading order layout. Cannot be used with DATE_LTRREADING</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpDate</i></dt>
<dd>
Pointer to a <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> structure that contains the date information to be formatted. If this pointer is NULL, the function uses the current local system date. </dd>
<dt>
<i>lpFormat</i></dt>
<dd>
Pointer to a format picture string to use to form the date string. If <i>lpFormat</i> is NULL, the function uses the date format of the specified locale.
<p>
Use the following elements to construct a format picture string. If you use spaces to separate the elements in the format string, these spaces will appear in the same location in the output string. The letters must be in uppercase or lowercase as shown in the table (for example, "MM" not "mm"). Characters in the format string that are enclosed in single quotation marks will appear in the same location and unchanged in the output string.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Picture</th>
<th align=left width=75%>Meaning</th>
</tr>
<tr valign=top>
<td width=25%>d</td>
<td width=75%>Day of month as digits with no leading zero for single-digit days.</td>
</tr>
<tr valign=top>
<td width=25%>dd</td>
<td width=75%>Day of month as digits with leading zero for single-digit days.</td>
</tr>
<tr valign=top>
<td width=25%>ddd</td>
<td width=75%>Day of week as a three-letter abbreviation. The function uses the LOCALE_SABBREVDAYNAME value associated with the specified locale.</td>
</tr>
<tr valign=top>
<td width=25%>dddd</td>
<td width=75%>Day of week as its full name. The function uses the LOCALE_SDAYNAME value associated with the specified locale.</td>
</tr>
<tr valign=top>
<td width=25%>M</td>
<td width=75%>Month as digits with no leading zero for single-digit months.</td>
</tr>
<tr valign=top>
<td width=25%>MM</td>
<td width=75%>Month as digits with leading zero for single-digit months.</td>
</tr>
<tr valign=top>
<td width=25%>MMM</td>
<td width=75%>Month as a three-letter abbreviation. The function uses the LOCALE_SABBREVMONTHNAME value associated with the specified locale.</td>
</tr>
<tr valign=top>
<td width=25%>MMMM</td>
<td width=75%>Month as its full name. The function uses the LOCALE_SMONTHNAME value associated with the specified locale.</td>
</tr>
<tr valign=top>
<td width=25%>y</td>
<td width=75%>Year as last two digits, but with no leading zero for years less than 10.</td>
</tr>
<tr valign=top>
<td width=25%>yy</td>
<td width=75%>Year as last two digits, but with leading zero for years less than 10.</td>
</tr>
<tr valign=top>
<td width=25%>yyyy</td>
<td width=75%>Year represented by full four digits.</td>
</tr>
<tr valign=top>
<td width=25%>gg</td>
<td width=75%>Period/era string. The function uses the CAL_SERASTRING value associated with the specified locale. This element is ignored if the date to be formatted does not have an associated era or period string.</td>
</tr>
</table><br>


<p>
For example, to get the date string

<p class=indent1>
"Wed, Aug 31 94"</p>

<p>
use the following picture string:

<p class=indent1>
"ddd',' MMM dd yy"</p>
</dd>
<dt>
<i>lpDateStr</i></dt>
<dd>
Pointer to a buffer that receives the formatted date string.</dd>
<dt>
<i>cchDate</i></dt>
<dd>
Specifies the size, in bytes (ANSI version) or characters (Unicode version), of the <i>lpDateStr</i> buffer. If <i>cchDate</i> is zero, the function returns the number of bytes or characters required to hold the formatted date string, and the buffer pointed to by <i>lpDateStr</i> is not used.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the number of bytes (ANSI version) or characters (Unicode version) written to the <i>lpDateStr</i> buffer, or if the <i>cchDate</i> parameter is zero, the number of bytes or characters required to hold the formatted date string. The count includes the terminating null.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. <b>GetLastError</b> may return one of the following error codes: </p>
<p>
ERROR_INSUFFICIENT_BUFFER<br>
ERROR_INVALID_FLAGS<br>
ERROR_INVALID_PARAMETER</p>
<h4>Remarks</h4>
<p>
The day name, abbreviated day name, month name, and abbreviated month name are all localized based on the given locale identifier. </p>
<p>
The date values in the <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> structure pointed to by <i>lpDate</i> must be valid. The function checks each of the date values: year, month, day, and day of week. If the day of the week is incorrect, the function uses the correct value, and returns no error. If any of the other date values are outside the correct range, the function fails, and sets the last-error to ERROR_INVALID_PARAMETER. </p>
<p>
The function ignores the time portions of the <b>SYSTEMTIME</b> structure pointed to by <i>lpDate</i>: <b>wHour</b>, <b>wMinute</b>, <b>wSecond</b>, and <b>wMilliseconds</b>. </p>
<p>
The DATE_SHORTDATE and DATE_LONGDATE flag options are mutually exclusive. If neither one is specified and <i>lpFormat</i> is NULL, then DATE_SHORTDATE is the default. </p>
<p>
No errors are returned for a bad format string. The function simply forms the best date string that it can. For example, the only year pictures that are valid are L"yyyy" and L"yy" (the 'L' indicates a Unicode (16-bit characters) string). If L"y" is passed in, the function  assumes L"yy". If L"yyy" is passed in, the function assumes L"yyyy". If more than 4 date (L"dddd") or 4 month (L"MMMM") pictures are passed in, then the function defaults to L"dddd" or L"MMMM". </p>
<p>
Any text that should remain in its exact form in the date string should be enclosed within single quotation marks in the date format picture. The single quotation mark may also be used as an escape character to allow the single quotation mark itself to be displayed in the date string. However, the escape sequence must be enclosed within two single quotation marks. For example, to display the date as "May '93", the format string would be:  L"MMMM ''''yy" The first and last single quotation marks are the enclosing quotation marks. The second and third single quotation marks are the escape sequence to allow the single quotation mark to be displayed before the century.</p>
<p>
<b>Windows CE:</b> The <i>Locale</i> parameter is ignored and the system locale is always used. The <i>Locale</i> parameter should be set to LOCALE_SYSTEM_DEFAULT to ensure compatibility with future versions of Windows CE.</p>
<p>
Windows CE does not support the following flags for the <i>dwFlags</i> parameter:</p>
<p class=indent1>
LOCALE_NOUSEROVERRIDE</p>
<p class=indent1>
DATE_USE_ALT_CALENDAR</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnls.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="nls_19f8.htm">National Language Support Overview</a>, <a href="nls_8d0z.htm">National Language Support Functions</a>, <a href="nls_6at0.htm"><b>GetTimeFormat</b></a>, <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
