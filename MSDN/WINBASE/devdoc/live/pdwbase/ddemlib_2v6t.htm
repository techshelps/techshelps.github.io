<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DdeInitialize</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ddeinitialize"></a>DdeInitialize</h1>
<p>
The <b>DdeInitialize</b> function registers an application with the <a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library</a> (DDEML). An application must call this function before calling any other DDEML function. </p>
<pre><code><b>UINT DdeInitialize(
  LPDWORD</b><i> pidInst</i><b>,          </b>// pointer to instance identifier
<b>  PFNCALLBACK</b><i> pfnCallback</i><b>,  </b>// pointer to callback function
<b>  DWORD</b><i> afCmd</i><b>,              </b>// set of command and filter flags
<b>  DWORD</b><i> ulRes</i>               // reserved
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pidInst</i></dt>
<dd>
Pointer to the application instance identifier. At initialization, this parameter should point to 0. If the function succeeds, this parameter points to the instance identifier for the application. This value should be passed as the <i>idInst</i> parameter in all other DDEML functions that require it. If an application uses multiple instances of the DDEML dynamic-link library (DLL), the application should provide a different callback function for each instance. 
<p>
If <i>pidInst</i> points to a nonzero value, reinitialization of the DDEML is implied. In this case, <i>pidInst</i> must point to a valid application-instance identifier. 
</dd>
<dt>
<i>pfnCallback</i></dt>
<dd>
Pointer to the application-defined dynamic data exchange (DDE) callback function. This function processes DDE transactions sent by the system. For more information, see the <a href="ddemlib_7wob.htm"><b>DdeCallback</b></a><b> </b>callback function. </dd>
<dt>
<i>afCmd</i></dt>
<dd>
Specifies a set of APPCMD_, CBF_, and MF_ flags. The APPCMD_ flags provide special instructions to <b>DdeInitialize</b>. The CBF_ flags specify filters that prevent specific types of transactions from reaching the callback function. The MF_ flags specify the types of DDE activity that a DDE monitoring application monitors. Using these flags enhances the performance of a DDE application by eliminating unnecessary calls to the callback function. 
<p>
This parameter can be a combination of the following filter flags: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=51%>Flag</th>
<th align=left width=49%>Meaning</th>
</tr>
<tr valign=top>
<td width=51%>APPCLASS_MONITOR</td>
<td width=49%>Makes it possible for the application to monitor DDE activity in the system. This flag is for use by DDE monitoring applications. The application specifies the types of DDE activity to monitor by combining one or more monitor flags with the APPCLASS_MONITOR flag. For details, see the following Remarks section.</td>
</tr>
<tr valign=top>
<td width=51%>APPCLASS_STANDARD</td>
<td width=49%>Registers the application as a standard (nonmonitoring) DDEML application.</td>
</tr>
<tr valign=top>
<td width=51%>APPCMD_CLIENTONLY</td>
<td width=49%>Prevents the application from becoming a server in a DDE conversation. The application can only be a client. This flag reduces consumption of resources by the DDEML. It includes the functionality of the CBF_FAIL_ALLSVRXACTIONS flag.</td>
</tr>
<tr valign=top>
<td width=51%>APPCMD_FILTERINITS</td>
<td width=49%>Prevents the DDEML from sending XTYP_CONNECT and XTYP_WILDCONNECT transactions to the application until the application has created its string handles and registered its service names or has turned off filtering by a subsequent call to the <a href="ddemlib_2gth.htm"><b>DdeNameService</b></a> or <b>DdeInitialize</b> function. This flag is always in effect when an application calls <b>DdeInitialize</b> for the first time, regardless of whether the application specifies the flag. On subsequent calls to <b>DdeInitialize</b>, not specifying this flag turns off the application's service-name filters, but specifying it turns on the application's service name filters.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_FAIL_ALLSVRXACTIONS</td>
<td width=49%>Prevents the callback function from receiving server transactions. The system returns DDE_FNOTPROCESSED to each client that sends a transaction to this application. This flag is equivalent to combining all CBF_FAIL_ flags.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_FAIL_ADVISES</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_7nqs.htm">XTYP_ADVSTART</a> and <a href="ddemlib_478w.htm">XTYP_ADVSTOP</a> transactions. The system returns DDE_FNOTPROCESSED to each client that sends an XTYP_ADVSTART or XTYP_ADVSTOP transaction to the server.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_FAIL_CONNECTIONS</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_5xh0.htm">XTYP_CONNECT</a> and <a href="ddemlib_5390.htm">XTYP_WILDCONNECT</a> transactions.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_FAIL_EXECUTES</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_9339.htm">XTYP_EXECUTE</a> transactions. The system returns DDE_FNOTPROCESSED to a client that sends an XTYP_EXECUTE transaction to the server.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_FAIL_POKES</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_90v9.htm">XTYP_POKE</a> transactions. The system returns DDE_FNOTPROCESSED to a client that sends an XTYP_POKE transaction to the server.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_FAIL_REQUESTS</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_73g4.htm">XTYP_REQUEST</a> transactions. The system returns DDE_FNOTPROCESSED to a client that sends an XTYP_REQUEST transaction to the server.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_FAIL_SELFCONNECTIONS</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_5xh0.htm">XTYP_CONNECT</a> transactions from the application's own instance. This flag prevents an application from establishing a DDE conversation with its own instance. An application should use this flag if it needs to communicate with other instances of itself but not with itself.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_SKIP_ALLNOTIFICATIONS</td>
<td width=49%>Prevents the callback function from receiving any notifications. This flag is equivalent to combining all CBF_SKIP_ flags.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_SKIP_CONNECT_CONFIRMS</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_3pbh.htm">XTYP_CONNECT_CONFIRM</a> notifications.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_SKIP_DISCONNECTS</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_60tw.htm">XTYP_DISCONNECT</a> notifications.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_SKIP_REGISTRATIONS</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_7lf6.htm">XTYP_REGISTER</a> notifications.</td>
</tr>
<tr valign=top>
<td width=51%>CBF_SKIP_UNREGISTRATIONS</td>
<td width=49%>Prevents the callback function from receiving <a href="ddemlib_8yeq.htm">XTYP_UNREGISTER</a> notifications.</td>
</tr>
<tr valign=top>
<td width=51%>MF_CALLBACKS</td>
<td width=49%>Notifies the callback function whenever a transaction is sent to any DDE callback function in the system.</td>
</tr>
<tr valign=top>
<td width=51%>MF_CONV</td>
<td width=49%>Notifies the callback function whenever a conversation is established or terminated.</td>
</tr>
<tr valign=top>
<td width=51%>MF_ERRORS</td>
<td width=49%>Notifies the callback function whenever a DDE error occurs.</td>
</tr>
<tr valign=top>
<td width=51%>MF_HSZ_INFO</td>
<td width=49%>Notifies the callback function whenever a DDE application creates, frees, or increments the usage count of a string handle or whenever a string handle is freed as a result of a call to the <a href="ddemlib_346d.htm"><b>DdeUninitialize</b></a> function.</td>
</tr>
<tr valign=top>
<td width=51%>MF_LINKS</td>
<td width=49%>Notifies the callback function whenever an advise loop is started or ended.</td>
</tr>
<tr valign=top>
<td width=51%>MF_POSTMSGS</td>
<td width=49%>Notifies the callback function whenever the system or an application posts a DDE message.</td>
</tr>
<tr valign=top>
<td width=51%>MF_SENDMSGS</td>
<td width=49%>Notifies the callback function whenever the system or an application sends a DDE message.</td>
</tr>
</table><br>

</dd>
<dt>
<i>ulRes</i></dt>
<dd>
Reserved; must be set to zero. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is DMLERR_NO_ERROR. </p>
<p>
If the function fails, the return value is one of the following values: </p>
<p>
DMLERR_DLL_USAGE<br>
DMLERR_INVALIDPARAMETER<br>
DMLERR_SYS_ERROR</p>
<h4>Remarks</h4>
<p>
An application that uses multiple instances of the DDEML must not pass DDEML objects between instances. </p>
<p>
A DDE monitoring application should not attempt to perform DDE operations (establish conversations, issue transactions, and so on) within the context of the same application instance. </p>
<p>
A synchronous transaction fails with a DMLERR_REENTRANCY error if any instance of the same task has a synchronous transaction already in progress. </p>
<p>
The CBF_FAIL_ALLSVRACTIONS flag causes the DDEML to filter all server transactions and can be changed by a subsequent call to <b>DdeInitialize</b>. The APPCMD_CLIENTONLY flag prevents the DDEML from creating key resources for the server and cannot be changed by a subsequent call to <b>DdeInitialize</b>. </p>
<p>
There is an ANSI version and a Unicode version of <b>DdeInitialize</b>. The version called determines the type of the window procedures used to control DDE conversations (ANSI or Unicode), and the default value for the <b>iCodePage</b> member of the <b>CONVCONTXT</b> structure (CP_WINANSI or CP_WINUNICODE). </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ddeml.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library Overview</a>, <a href="ddemlib_1nn7.htm">Dynamic Data Exchange Management Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
