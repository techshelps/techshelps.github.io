<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>QueryServiceConfig2</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_queryserviceconfig2"></a>QueryServiceConfig2</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>QueryServiceConfig2</b> function retrieves the optional configuration parameters of the specified service.</p>
<pre><code><b>BOOL QueryServiceConfig2(
</b>  <b>SC_HANDLE</b> <i>hService</i>,
  <b>DWORD</b> <i>dwInfoLevel</i><b>,</b>
  <b>LPBYTE</b> <i>lpBuffer</i>,
  <b>DWORD</b> <i>cbBufSize</i>,
  <b>LPDWORD</b> <i>pcbBytesNeeded</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hService</i></dt>
<dd>
Handle to the service. This handle is returned by the <a href="services_8isl.htm"><b>OpenService</b></a> or <a href="services_3p9h.htm"><b>CreateService</b></a> function and must have the SERVICE_CHANGE_CONFIG access right. </dd>
<dt>
<i>dwInfoLevel</i></dt>
<dd>
Specifies the configuration information to query. This parameter can have one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Value</th>
<th align=left width=45%>Meaning</th>
</tr>
<tr valign=top>
<td width=55%>SERVICE_CONFIG_DESCRIPTION</td>
<td width=45%>The <i>lpBuffer</i> parameter is a pointer to a <a href="services_2fle.htm"><b>SERVICE_DESCRIPTION</b></a> structure. </td>
</tr>
<tr valign=top>
<td width=55%>SERVICE_CONFIG_FAILURE_ACTIONS</td>
<td width=45%>The <i>lpBuffer</i> parameter is a pointer to a <a href="services_22nm.htm"><b>SERVICE_FAILURE_ACTIONS</b></a> structure.</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpBuffer</i></dt>
<dd>
Pointer to the structure in which the service configuration information is returned, plus the strings to which its members point. The format of this data depends on the value of the <i>dwInfoLevel</i> parameter.</dd>
<dt>
<i>cbBufSize</i></dt>
<dd>
Specifies the size, in bytes, of the structure pointed to by the <i>lpBuffer</i> parameter. </dd>
<dt>
<i>pcbBytesNeeded</i></dt>
<dd>
Pointer to a variable that receives the number of bytes needed to return the configuration information, if the function fails.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
The <b>QueryServiceConfig2</b> function returns the optional configuration information stored in the service control manager database for the specified service. You can change this configuration information by using the <a href="services_9aeq.htm"><b>ChangeServiceConfig2</b></a> function. </p>
<p>
You can change and query additional configuration information using the <a href="services_5gh3.htm"><b>ChangeServiceConfig</b></a> and <a href="services_7yjr.htm"><b>QueryServiceConfig</b></a> functions, respectively. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winsvc.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="services_0p0z.htm">Services Overview</a>, <a href="services_2uwj.htm">Service Functions</a>, <a href="services_5gh3.htm"><b>ChangeServiceConfig</b></a>, <a href="services_9aeq.htm"><b>ChangeServiceConfig2</b></a>, <a href="services_3p9h.htm"><b>CreateService</b></a>, <a href="services_8isl.htm"><b>OpenService</b></a>, <a href="services_7yjr.htm"><b>QueryServiceConfig</b></a>, <a href="services_2fle.htm"><b>SERVICE_DESCRIPTION</b></a>, <a href="services_22nm.htm"><b>SERVICE_FAILURE_ACTIONS</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
