<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MultiByteToWideChar</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_multibytetowidechar"></a>MultiByteToWideChar</h1>
<p>
The <b>MultiByteToWideChar</b> function maps a character string to a wide-character (Unicode) string. The character string mapped by this function is not necessarily from a multibyte character set. </p>
<pre><code><b>int MultiByteToWideChar(
  UINT</b><i> CodePage</i><b>,         </b>// code page
<b>  DWORD</b><i> dwFlags</i><b>,         </b>// character-type options
<b>  LPCSTR</b><i> lpMultiByteStr</i><b>, </b>// address of string to map
<b>  int</b><i> cchMultiByte</i><b>,      </b>// number of bytes in string
<b>  LPWSTR</b><i> lpWideCharStr</i><b>,  </b>// address of wide-character buffer
<b>  int</b><i> cchWideChar</i>        // size of buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>CodePage</i></dt>
<dd>
Specifies the code page to be used to perform the conversion. This parameter can be given the value of any code page that is installed or available in the system. You can also specify one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=30%>Value</th>
<th align=left width=70%>Meaning</th>
</tr>
<tr valign=top>
<td width=30%>CP_ACP</td>
<td width=70%>ANSI code page</td>
</tr>
<tr valign=top>
<td width=30%>CP_MACCP</td>
<td width=70%>Macintosh code page</td>
</tr>
<tr valign=top>
<td width=30%>CP_OEMCP</td>
<td width=70%>OEM code page</td>
</tr>
<tr valign=top>
<td width=30%>CP_SYMBOL</td>
<td width=70%>Symbol code page (42)</td>
</tr>
<tr valign=top>
<td width=30%>CP_THREAD_ACP</td>
<td width=70%>The current thread's ANSI code page</td>
</tr>
<tr valign=top>
<td width=30%>CP_UTF7</td>
<td width=70%>Translate using UTF-7</td>
</tr>
<tr valign=top>
<td width=30%>CP_UTF8</td>
<td width=70%>Translate using UTF-8</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
A set of bit flags that indicate whether to translate to precomposed or composite wide characters (if a composite form exists), whether to use glyph characters in place of control characters, and how to deal with invalid characters. You can specify a combination of the following flag constants:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=42%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=42%>MB_PRECOMPOSED</td>
<td width=58%>Always use precomposed characters — that is, characters in which a base character and a nonspacing character have a single character value. This is the default translation option. Cannot be used with MB_COMPOSITE.</td>
</tr>
<tr valign=top>
<td width=42%>MB_COMPOSITE</td>
<td width=58%>Always use composite characters — that is, characters in which a base character and a nonspacing character have different character values. Cannot be used with MB_PRECOMPOSED.</td>
</tr>
<tr valign=top>
<td width=42%>MB_ERR_INVALID_CHARS</td>
<td width=58%>If the function encounters an invalid input character, it fails and <b>GetLastError</b> returns ERROR_NO_UNICODE_TRANSLATION. </td>
</tr>
<tr valign=top>
<td width=42%>MB_USEGLYPHCHARS</td>
<td width=58%>Use glyph characters instead of control characters.</td>
</tr>
</table><br>


<p>
A composite character consists of a base character and a nonspacing character, each having different character values. A precomposed character has a single character value for a base/non-spacing character combination. In the character <i>è</i>, the <i>e</i> is the base character and the accent grave mark is the nonspacing character. 

<p>
The function's default behavior is to translate to the precomposed form. If a precomposed form does not exist, the function attempts to translate to a composite form.

<p>
The flags MB_PRECOMPOSED and MB_COMPOSITE are mutually exclusive. The MB_USEGLYPHCHARS flag and the MB_ERR_INVALID_CHARS can be set regardless of the state of the other flags.
</dd>
<dt>
<i>lpMultiByteStr</i></dt>
<dd>
Points to the character string to be converted. </dd>
<dt>
<i>cchMultiByte</i></dt>
<dd>
Specifies the size in bytes of the string pointed to by the <i>lpMultiByteStr</i> parameter. If this value is –1, the string is assumed to be null terminated and the length is calculated automatically. </dd>
<dt>
<i>lpWideCharStr</i></dt>
<dd>
Points to a buffer that receives the translated string. </dd>
<dt>
<i>cchWideChar</i></dt>
<dd>
Specifies the size, in wide characters, of the buffer pointed to by the <i>lpWideCharStr</i> parameter. If this value is zero, the function returns the required buffer size, in wide characters, and makes no use of the <i>lpWideCharStr</i> buffer. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, and <i>cchWideChar</i> is nonzero, the return value is the number of wide characters written to the buffer pointed to by <i>lpWideCharStr</i>. </p>
<p>
If the function succeeds, and <i>cchWideChar</i> is zero, the return value is the required size, in wide characters, for a buffer that can receive the translated string. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. <b>GetLastError</b> may return one of the following error codes:</p>
<p>
ERROR_INSUFFICIENT_BUFFER<br>
ERROR_INVALID_FLAGS<br>
ERROR_INVALID_PARAMETER<br>
ERROR_NO_UNICODE_TRANSLATION</p>
<h4>Remarks</h4>
<p>
The <i>lpMultiByteStr</i> and <i>lpWideCharStr</i> pointers must not be the same. If they are the same, the function fails, and <b>GetLastError</b> returns the value ERROR_INVALID_PARAMETER. </p>
<p>
The function fails if MB_ERR_INVALID_CHARS is set and it encounters an invalid character in the source string.  An invalid character is one that would translate to the default character if MB_ERR_INVALID_CHARS was not set, but is not the default character in the source string, or when a lead byte is found in a string and there is no valid trail byte for DBCS strings. When an invalid character is found, and MB_ERR_INVALID_CHARS is set, the function returns 0 and sets <b>GetLastError </b>with the error ERROR_NO_UNICODE_TRANSLATION.</p>
<p>
<b>Windows CE:</b> Windows CE does not support the CP_UTF7 and CP_UTF8 values for the <i>CodePage</i> parameter.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnls.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="unicode_6bqr.htm">Unicode and Character Sets Overview</a>, <a href="unicode_19mb.htm">Unicode and Character Set Functions</a>, <a href="unicode_2bj9.htm"><b>WideCharToMultiByte</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
