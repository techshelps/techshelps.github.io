<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>System Wake_up Events</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_system_wake_up_events"></a>System Wake-up Events</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Your application can restore an On-Now capable computer that is in a sleeping state to the working state by using a scheduled time or a device event. This is known as a <i>wake-up event</i>. Use a <a href="synchro_04tv.htm">waitable timer object</a> to specify the time at which the system should wake. To create the object, use the <a href="synchro_51o2.htm"><b>CreateWaitableTimer</b></a> function. To set the timer, use the <a href="synchro_6f1u.htm"><b>SetWaitableTimer</b></a> function. The <i>pDueTime</i> parameter specifies when the timer will be signaled. To specify that the system should wake when the timer is signaled, set the <i>fResume</i> parameter to TRUE. </p>
<p>
Use the <a href="power_33qo.htm"><b>RequestDeviceWakeup</b></a> function to enable the device's wake-up capability. You can have the system awaken after a modem ring, network request, or other device-based event. Your application should provide an interface for the user to specify the device wake-up, then use <b>RequestDeviceWakeup</b>. </p>
<p>
When the system wakes automatically because of an event (other than power switch or user activity), the system automatically sets its idle timer to at least 1 minute. This timer allows applications to call the <a href="power_3rz9.htm"><b>SetThreadExecutionState</b></a> function to indicate that they are busy. This enables the system to shut down without affecting the user. The following criteria determine whether a system shutdown is needed: 
<ul>
<li>
If the system wakes automatically, it shuts down as soon as the last job is completed, as indicated by the process calling <b>SetThreadExecutionState</b>. </li>
<li>
If the system wakes automatically, but the user provides new input while the event is handled, the system does not shut down when the last job finishes. </li>
<li>
If the system is on and the user is active, the system does not enter the sleeping state.</li>
<li>
If the system is on, no applications are busy, and the user is inactive for a long time, the system enters the sleeping state when the timer expires. </li>
</ul>
<p>
When the system wakes automatically, the system sends the <a href="power_5mar.htm">PBT_APMRESUMEAUTOMATIC</a> message to all applications. Because the user is not present, most applications should do nothing. Event-handling applications, such as fax servers, should handle their events. If you wish to determine whether the system is in this state, call the <a href="power_8wbn.htm"><b>IsSystemResumeAutomatic</b></a> function.</p>
<p>
If the system wakes due to user activity after sending PBT_APMRESUMEAUTOMATIC, the system sends the <a href="power_0aqs.htm">PBT_APMRESUMESUSPEND</a> message and turns on the display. Your application should reopen files that it closed when the system entered the sleeping state, and it should prepare for user input. </p>
<p>
If an application called <a href="power_4wv9.htm"><b>SetSystemPowerState</b></a> with <i>fForce</i> set to TRUE, no applications will receive the <a href="power_7ip0.htm">PBT_APMQUERYSUSPEND</a> message when the system enters the sleeping state. If the system is carrying out a critical suspension, no applications will receive the PBT_APMQUERYSUSPEND or <a href="power_9ias.htm">PBT_APMSUSPEND</a> message; they will receive only the <a href="power_586k.htm">PBT_APMRESUMECRITICAL</a> message. </p>
<p>&nbsp;</p></body>
</HTML>
