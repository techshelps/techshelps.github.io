<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RegEnumKey</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_regenumkey"></a>RegEnumKey</h1>
<p>
The <b>RegEnumKey</b> function enumerates subkeys of the specified open registry key. The function retrieves the name of one subkey each time it is called. This function is provided for compatibility with Windows version 3.1. Win32-based applications should use the <a href="regapi_4854.htm"><b>RegEnumKeyEx</b></a> function. </p>
<pre><code><b>LONG RegEnumKey(
  HKEY</b><i> hKey</i><b>,     </b>// handle to key to query
<b>  DWORD</b><i> dwIndex</i><b>, </b>// index of subkey to query
<b>  LPTSTR</b><i> lpName</i><b>, </b>// address of buffer for subkey name
<b>  DWORD</b><i> cbName</i>   // size of subkey buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hKey</i></dt>
<dd>
Handle to a currently open key or one of the following predefined reserved handle values: 
<p>
<b>HKEY_CLASSES_ROOT</b><br>
<b>HKEY_CURRENT_CONFIG</b><br>
<b>HKEY_CURRENT_USER</b><br>
<b>HKEY_LOCAL_MACHINE</b><br>
<b>HKEY_USERS<br>
Windows NT:</b> <b>HKEY_PERFORMANCE_DATA</b> <br>
<b>Windows 95 and Windows 98:</b> <b>HKEY_DYN_DATA</b> 

<p>
The keys returned are relative to the key identified by <i>hKey</i>. 
</dd>
<dt>
<i>dwIndex</i></dt>
<dd>
Specifies the index of the subkey to retrieve. This value should be zero for the first call to the <b>RegEnumKey</b> function and then incremented for subsequent calls. 
<p>
Because subkeys are not ordered, any new subkey will have an arbitrary index. This means that the function may return subkeys in any order. 
</dd>
<dt>
<i>lpName</i></dt>
<dd>
Pointer to a buffer that receives the name of the subkey, including the terminating null character. This function copies only the name of the subkey, not the full key hierarchy, to the buffer. </dd>
<dt>
<i>cbName</i></dt>
<dd>
Specifies the size, in characters, of the buffer pointed to by the <i>lpName</i> parameter, in characters. To determine the required buffer size, use the <a href="regapi_5xkp.htm"><b>RegQueryInfoKey</b></a> function to determine the size of the largest subkey for the key identified by the <i>hKey</i> parameter. The maximum required buffer size is (MAX_PATH + 1) characters. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a nonzero error code defined in WINERROR.H. You can use the <a href="strings_0sdh.htm"><b>FormatMessage</b></a> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</p>
<h4>Remarks</h4>
<p>
To enumerate subkeys, an application should initially call the <b>RegEnumKey</b> function with the <i>dwIndex</i> parameter set to zero. The application should then increment the <i>dwIndex</i> parameter and call the <b>RegEnumKey</b> function until there are no more subkeys (until the function returns ERROR_NO_MORE_ITEMS). </p>
<p>
The application can also set <i>dwIndex</i> to the index of the last key on the first call to the function and decrement the index until the subkey with index 0 is enumerated. To retrieve the index of the last subkey, use the <a href="regapi_5xkp.htm"><b>RegQueryInfoKey</b></a>. </p>
<p>
While an application is using the <b>RegEnumKey</b> function, it should not make calls to any registration functions that might change the key being queried. </p>
<p>
The key identified by the <i>hKey</i> parameter must have been opened with KEY_ENUMERATE_SUB_KEYS access (KEY_READ access includes KEY_ENUMERATE_SUB_KEYS access). To open the key, use the <b>RegCreateKeyEx</b> or <b>RegOpenKeyEx</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winreg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="regapi_9bzt.htm">Registry Overview</a>, <a href="regapi_59mb.htm">Registry Functions</a>, <a href="regapi_5fax.htm"><b>RegCloseKey</b></a>, <a href="regapi_1woo.htm"><b>RegCreateKeyEx</b></a>, <a href="regapi_1po9.htm"><b>RegDeleteKey</b></a>, <a href="regapi_4854.htm"><b>RegEnumKeyEx</b></a>, <a href="regapi_7yns.htm"><b>RegOpenKeyEx</b></a>, <a href="regapi_5xkp.htm"><b>RegQueryInfoKey</b></a>, <a href="regapi_05np.htm"><b>RegQueryValue</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
