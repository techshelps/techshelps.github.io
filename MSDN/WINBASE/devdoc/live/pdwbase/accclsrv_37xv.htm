<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LookupSecurityDescriptorParts</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lookupsecuritydescriptorparts"></a>LookupSecurityDescriptorParts</h1>
<p>
The <b>LookupSecurityDescriptorParts</b> function retrieves security information from a self-relative security descriptor. </p>
<pre><code><b>DWORD LookupSecurityDescriptorParts(
  PTRUSTEE</b><i> *pOwner</i><b>,  </b>// receives the owner SID from the security 
                     // descriptor
<b>  PTRUSTEE</b><i> *pGroup</i><b>,  </b>// receives the group SID from the security 
                     // descriptor
<b>  PULONG</b><i> cCountOfAccessEntries</i><b>,</b>
<b>                     </b>// receives number of access-control entries
<b>  PEXPLICIT_ACCESS</b><i> *pListOfAccessEntries</i><b>,</b>
<b>                     </b>// receives an array of DACL access-control 
                     // entries
<b>  PULONG</b><i> cCountOfAuditEntries</i><b>,</b>
<b>                     </b>// receives number of audit-control entries
<b>  PEXPLICIT_ACCESS</b><i> *pListOfAuditEntries</i><b>,</b>
<b>                     </b>// receives an array of SACL audit-control 
                     // entries
<b>  PSECURITY_DESCRIPTOR</b><i> pSD</i>
<i>                     </i>// pointer to the security descriptor
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pOwner</i></dt>
<dd>
Pointer to a variable that receives a pointer to a <a href="accctrl_6hki.htm"><b>TRUSTEE</b></a> structure. The function looks up the name associated with the owner <a href="accctrl_5lyq.htm">SID</a> in the <i>pSD</i> security descriptor, and returns a pointer to the name in the <b>ptstrName</b> member of the <b>TRUSTEE</b> structure. The function sets the <b>TrusteeForm</b> member to TRUSTEE_IS_NAME. 
<p>
This parameter can be NULL if you are not interested in the name of the owner.
</dd>
<dt>
<i>pGroup</i></dt>
<dd>
Pointer to a variable that receives a pointer to a <b>TRUSTEE</b> structure. The function looks up the name associated with the primary group SID of the security descriptor, and returns a pointer to the name in the <b>ptstrName</b> member of the <b>TRUSTEE</b> structure. The function sets the <b>TrusteeForm</b> member to TRUSTEE_IS_NAME. 
<p>
This parameter can be NULL if you are not interested in the name of the group.
</dd>
<dt>
<i>cCountOfAccessEntries</i></dt>
<dd>
Pointer to a <b>ULONG</b> that receives the number of <a href="acctlnt4_1xf6.htm"><b>EXPLICIT_ACCESS</b></a> structures returned in the <i>pListOfAccessEntries</i> array<i>. </i>This parameter can be NULL only if the <i>pListOfAccessEntries</i> parameter is also NULL. </dd>
<dt>
<i>pListOfAccessEntries</i></dt>
<dd>
Pointer to a variable that receives a pointer to an array of <b>EXPLICIT_ACCESS</b> structures that describe the ACEs in the DACL of the security descriptor. The <a href="accctrl_6hki.htm"><b>TRUSTEE</b></a> structure in these <b>EXPLICIT_ACCESS</b> structures use the TRUSTEE_IS_NAME form. For a description of how an array of <b>EXPLICIT_ACCESS</b> structures describes the ACEs in an <a href="accctrl_4h6a.htm">ACL</a>, see the <a href="acctlnt4_17os.htm"><b>GetExplicitEntriesFromAcl</b></a> function. If this parameter is NULL, the <i>cCountOfAccessEntries</i> parameter must also be NULL. </dd>
<dt>
<i>cCountOfAuditEntries</i></dt>
<dd>
Pointer to a <b>ULONG</b> that receives the number of <b>EXPLICIT_ACCESS</b> structures returned in the <i>pListOfAuditEntries</i> array<i>. </i>This parameter can be NULL only if the <i>pListOfAuditEntries</i> parameter is also NULL. </dd>
<dt>
<i>pListOfAuditEntries</i></dt>
<dd>
Pointer to a variable that receives a pointer to an array of <b>EXPLICIT_ACCESS</b> structures that describe the ACEs in the SACL of the security descriptor. The <b>TRUSTEE</b> structure in these <b>EXPLICIT_ACCESS</b> structures uses the TRUSTEE_IS_NAME form. If this parameter is NULL, the <i>cCountOfAuditEntries</i> parameter must also be NULL. </dd>
<dt>
<i>pSD</i></dt>
<dd>
Pointer to an existing self-relative security descriptor from which the function retrieves security information. A self-relative security descriptor stores a <a href="accctrl_6i5u.htm"><b>SECURITY_DESCRIPTOR</b></a> structure and associated security information in a contiguous block of memory. This differs from an absolute security descriptor, which contains pointers to the associated security information.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a nonzero error code defined in WINERROR.H. </p>
<h4>Remarks</h4>
<p>
The <b>LookupSecurityDescriptorParts</b> function retrieves the names of the owner and primary group of the security descriptor. It also returns descriptions of the access-control entries in the DACL and audit-control entries in the SACL of the security descriptor.</p>
<p>
The parameters other than <i>pSD</i> can be NULL if you are not interested in the information. If you do not want information about the DACL, both <i>pListOfAccessEntries</i> and <i>cCountOfAccessEntries</i> must be NULL. If you do not want information about the SACL, both <i>pListOfAuditEntries</i> and <i>cCountOfAuditEntries</i> must be NULL. Similarly, if you do want DACL or SACL information, both of the corresponding parameters must be non-NULL.</p>
<p>
You must call the <b>LocalFree</b> function to free any buffers returned by the <i>pOwner</i>, <i>pGroup</i>, <i>pListOfAccessEntries</i>, or <i>pListOfAuditEntries</i> parameters.</p>
<p>
The <b>LookupSecurityDescriptorParts</b> function is intended for trusted servers that implement or expose security on their own objects. The function works with a self-relative security descriptor suitable for serializing into a stream and storing to disk, as a trusted server might require. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in aclapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="accclsrv_64vg.htm">Client/Server Access Control Overview</a>, <a href="accclsrv_0hv7.htm">Client/Server Access Control Functions</a>, <a href="accctrl_7bhu.htm"><b>ACE</b></a>, <a href="accctrl_4h6a.htm"><b>ACL</b></a>, <a href="acctlnt4_1xf6.htm"><b>EXPLICIT_ACCESS</b></a>, <a href="memman_2339.htm"><b>LocalFree</b></a>, <a href="accctrl_6i5u.htm"><b>SECURITY_DESCRIPTOR</b></a>, <a href="acctlnt4_17os.htm"><b>GetExplicitEntriesFromAcl</b></a>, <a href="accctrl_5lyq.htm"><b>SID</b></a>, <a href="accctrl_6hki.htm"><b>TRUSTEE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
