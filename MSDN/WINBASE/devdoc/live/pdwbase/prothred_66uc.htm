<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Terminating a Thread</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_terminating_a_thread"></a>Terminating a Thread</h3>
<p>
A thread executes until one of the following events occurs: 
<ul>
<li>
The thread calls the <a href="prothred_531g.htm"><b>ExitThread</b></a><b> </b>function. </li>
<li>
Any thread of the process calls the <a href="prothred_8dv7.htm"><b>ExitProcess</b></a> function. </li>
<li>
The thread function returns. </li>
<li>
Any thread calls the <a href="prothred_7h2c.htm"><b>TerminateThread</b></a> function with a handle to the thread. </li>
<li>
Any thread calls the <a href="prothred_1bg3.htm"><b>TerminateProcess</b></a> function with a handle to the process. </li>
</ul>
<p>
The <a href="prothred_9350.htm"><b>GetExitCodeThread</b></a> function returns the termination status of a thread. While a thread is executing, its termination status is STILL_ACTIVE. When a thread terminates, its termination status changes from STILL_ACTIVE to the exit code of the thread. The exit code is either the value specified in the call to <b>ExitThread</b>, <b>ExitProcess</b>, <b>TerminateThread</b>, or <b>TerminateProcess</b>, or the value returned by the thread function. </p>
<p>
When a thread terminates, the state of the thread object changes to signaled, releasing any other threads that had been waiting for the thread to terminate. For more about synchronization, see <a href="prothred_3ng3.htm">Synchronizing Execution of Multiple Threads</a>. </p>
<p>
If a thread is terminated by <a href="prothred_531g.htm"><b>ExitThread</b></a>, the system calls the entry-point function of each attached DLL with a value indicating that the thread is detaching from the DLL (unless you call the <a href="dll_6v77.htm"><b>DisableThreadLibraryCalls</b></a> function). If a thread is terminated by <a href="prothred_8dv7.htm"><b>ExitProcess</b></a>, the DLL entry-point functions are invoked once, to indicate that the process is detaching. DLLs are not notified when a thread is terminated by <a href="prothred_7h2c.htm"><b>TerminateThread</b></a> or <a href="prothred_1bg3.htm"><b>TerminateProcess</b></a>. For more information about DLLs, see <a href="dll_512r.htm">Dynamic-Link Libraries</a>. </p>
<p>
<b>Warning</b>&nbsp;&nbsp;The <b>TerminateThread</b> and <b>TerminateProcess</b> functions should be used only in extreme circumstances, since they do not allow threads to clean up, do not notify attached DLLs, and do not free the initial stack. The following steps provide a better solution: 
<ul>
<li>
Create an event object using the <a href="synchro_8ub8.htm"><b>CreateEvent</b></a> function. </li>
<li>
Create the threads. </li>
<li>
Each thread monitors the event state by calling the <a href="synchro_4ldg.htm"><b>WaitForSingleObject</b></a> function. Use a wait time-out interval of zero. </li>
<li>
Each thread terminates its own execution when the event is set to the signaled state (<b>WaitForSingleObject</b> returns WAIT_OBJECT_0). </li>
</ul>
<p>&nbsp;</p></body>
</HTML>
