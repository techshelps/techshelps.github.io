<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateJobObject</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createjobobject"></a>CreateJobObject</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CreateJobObject</b> function creates a job object. </p>
<pre><code><b>HANDLE</b> <b>CreateJobObject(</b>
  <b>LPSECURITY</b>_<b>ATTRIBUTES</b> <i>lpJobAttributes</i>,
  <b>LPCTSTR</b> <i>lpName</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpJobAttributes</i></dt>
<dd>
Pointer to a <a href="accctrl_8gs2.htm"><b>SECURITY_ATTRIBUTES</b></a> structure that specifies the security descriptor for the job object and determines whether child processes can inherit the returned handle. If <i>lpJobAttributes</i> is NULL, the job object gets a default security descriptor and the handle cannot be inherited. </dd>
<dt>
<i>lpName</i></dt>
<dd>
Pointer to a null-terminated string specifying the name of the job object. The name is limited to MAX_PATH characters, and can contain any character except the backslash (\) character. Name comparison is case-sensitive. 
<p>
If <i>lpName</i> is NULL, the job object is created without a name.

<p>
If <i>lpName</i> matches the name of an existing event, semaphore, mutex, waitable timer, or file-mapping object, the function fails and the <a href="errors_3uwi.htm"><b>GetLastError</b></a> function returns ERROR_INVALID_HANDLE. This occurs because these objects share the same name space.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a handle to the job object. The handle provides full access to the job object. If the object existed before the function call, the function returns a handle to the existing job object and <a href="errors_3uwi.htm"><b>GetLastError</b></a> returns ERROR_ALREADY_EXISTS.</p>
<p>
If the function fails, the return value is NULL. To get extended error information, call <b>GetLastError</b>. </p>
<h4>Remarks</h4>
<p>
When a job object is created, its accounting information is initialized to zero, all limits are inactive, and there are no associated processes. To associate a process with a job object, use the <a href="prothred_9tbo.htm"><b>AssignProcessToJobObject</b></a> function. To set limits for a job object, use the <a href="prothred_3lbo.htm"><b>SetInformationJobObject</b></a> function. To query accounting information, use the <a href="prothred_0xbo.htm"><b>QueryInformationJobObject</b></a> function. </p>
<p>
To close a job object handle, use the <a href="handobj_289x.htm"><b>CloseHandle</b></a> function. The job object is destroyed when its last handle has been closed. If there are running processes still associated with the job object when it is destroyed, they will continue to run even after the job object is destroyed.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prothred_86sz.htm">Processes and Threads Overview</a>, <a href="prothred_3mgj.htm">Process and Thread Functions</a>, <a href="prothred_9tbo.htm"><b>AssignProcessToJobObject</b></a>, <a href="handobj_289x.htm"><b>CloseHandle</b></a>, <a href="prothred_0xbo.htm"><b>QueryInformationJobObject</b></a>, <a href="accctrl_8gs2.htm"><b>SECURITY_ATTRIBUTES</b></a>, <a href="prothred_3lbo.htm"><b>SetInformationJobObject</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
