<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateTapePartition</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createtapepartition"></a>CreateTapePartition</h1>
<p>
The <b>CreateTapePartition</b> function reformats a tape. </p>
<pre><code><b>DWORD CreateTapePartition(
  HANDLE</b><i> hDevice</i><b>,           </b>// handle to open device
<b>  DWORD</b><i> dwPartitionMethod</i><b>,  </b>// type of new partition
<b>  DWORD</b><i> dwCount</i><b>,            </b>// number of new partitions to create
<b>  DWORD</b><i> dwSize</i>              // size of new partition, in megabytes
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDevice</i></dt>
<dd>
Identifies the device where the new partition is to be created. This handle is created by using the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function. </dd>
<dt>
<i>dwPartitionMethod</i></dt>
<dd>
Specifies the type of partition to create. To determine what type of partitions your device supports, see the documentation for your hardware. This parameter can have one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Value</th>
<th align=left width=51%>Description</th>
</tr>
<tr valign=top>
<td width=49%>TAPE_FIXED_PARTITIONS</td>
<td width=51%>Partitions the tape based on the device's default definition of partitions. The <i>dwCount</i> and <i>dwSize</i> parameters are ignored.</td>
</tr>
<tr valign=top>
<td width=49%>TAPE_INITIATOR_PARTITIONS</td>
<td width=51%>Partitions the tape into the number and size of partitions specified by <i>dwCount</i> and <i>dwSize</i>, respectively, except for the last partition. The size of the last partition is the remainder of the tape.</td>
</tr>
<tr valign=top>
<td width=49%>TAPE_SELECT_PARTITIONS</td>
<td width=51%>Partitions the tape into the number of partitions specified by <i>dwCount</i>. The <i>dwSize</i> parameter is ignored. The size of the partitions is determined by the device's default partition size. For more specific information, refer to the documentation for your tape device.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwCount</i></dt>
<dd>
Specifies the number of partitions to create. The <a href="tapeback_110z.htm"><b>GetTapeParameters</b></a> function provides the maximum number of partitions a tape can support. </dd>
<dt>
<i>dwSize</i></dt>
<dd>
Specifies the size, in megabytes, of each partition. This value is ignored if the <i>dwPartitionMethod</i> parameter is TAPE_SELECT_PARTITIONS. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NO_ERROR.</p>
<p>
If the function fails, it may return one of the following error codes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Error</th>
<th align=left width=45%>Description</th>
</tr>
<tr valign=top>
<td width=55%>ERROR_BEGINNING_OF_MEDIA</td>
<td width=45%>An attempt to access data before the beginning-of-medium marker failed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_BUS_RESET</td>
<td width=45%>A reset condition was detected on the bus.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_END_OF_MEDIA</td>
<td width=45%>The end-of-tape marker was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_FILEMARK_DETECTED</td>
<td width=45%>A filemark was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_SETMARK_DETECTED</td>
<td width=45%>A setmark was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_NO_DATA_DETECTED</td>
<td width=45%>The end-of-data marker was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_PARTITION_FAILURE</td>
<td width=45%>The tape could not be partitioned.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_INVALID_BLOCK_LENGTH</td>
<td width=45%>The block size is incorrect on a new tape in a multivolume partition.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_DEVICE_NOT_PARTITIONED</td>
<td width=45%>The partition information could not be found when a tape was being loaded.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_MEDIA_CHANGED</td>
<td width=45%>The tape that was in the drive has been replaced or removed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_NO_MEDIA_IN_DRIVE</td>
<td width=45%>There is no media in the drive.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_NOT_SUPPORTED</td>
<td width=45%>The tape driver does not support a requested function.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_UNABLE_TO_LOCK_MEDIA</td>
<td width=45%>An attempt to lock the ejection mechanism failed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_UNABLE_TO_UNLOAD_MEDIA</td>
<td width=45%>An attempt to unload the tape failed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_WRITE_PROTECT</td>
<td width=45%>The media is write protected.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
Creating partitions reformats the tape. All previous information recorded on the tape is destroyed. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="tapeback_0rlc.htm">Tape Backup Overview</a>, <a href="tapeback_1rw3.htm">Tape Backup Functions</a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <a href="tapeback_110z.htm"><b>GetTapeParameters</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
