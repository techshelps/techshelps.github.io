<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Menu Differences</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win95_menu_differences"></a>Menu Differences</h1>
<p>
A 16-bit version 3.<i>x</i> application that creates or loads a menu is considered to be the owner of the menu. However, when the application exits, the menu is "orphaned" until no 16-bit version components for Windows version 3.<i>x</i> remain. For 16-bit version 4.0 applications and all 32-bit applications, the application that creates the menu is the owner, and the menu is destroyed as soon as the application exits. Unlike graphics device interface (GDI) objects, there is no way to change the ownership of a menu.</p>
<p>
In a version 3.<i>x</i> application, the Close command cannot be deleted from the System menu of an multiple document interface (MDI) child window. In a version 4.0 application, the Close command can be deleted.</p>
<p>
Windows 95 increases the width of hierarchical, owner-drawn menu items in a version 3.<i>x</i> application. Some applications rely on this increased width and use it to include icons that simulate toolbars. In a version 4.0 application, Windows 95 does not automatically increase the width of hierarchical, owner-drawn menu items.</p>
<p>
The <i>wParam</i> parameter of the WM_MENUSELECT message is interpreted differently depending on the subsystem version number of the application and whether the application is written for 16 or 32 bits:
<ul>
<li>
In a 16-bit version 3.<i>x</i> application, the <i>wParam</i> parameter is the handle of the pop-up menu if the selected item activates a pop-up menu.</li>
<li>
In a 16-bit version 4.0 application, <i>wParam</i> is the identifier of the menu item, regardless of whether the item activates a pop-up menu. </li>
<li>
In a 32-bit application (both subsystem versions), the low-order word of <i>wParam</i> is the identifier of the menu item or, if the item activates a pop-up menu, the index of the pop-up menu. This high-order word contains the menu flags.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
