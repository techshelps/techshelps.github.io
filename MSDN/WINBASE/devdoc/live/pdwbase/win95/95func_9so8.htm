<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interrupt 21h Function 440Dh Minor Code 70h</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win95_interrupt_21h_function_440dh_minor_code_70h"></a>Interrupt 21h Function 440Dh Minor Code 70h</h1>
<p>
Retrieves the current lock level and permissions on the specified drive. </p>
<pre><code>mov ax, 440Dh        ; generic IOCTL
mov bl, DriveNum     ; see below
mov ch, 08h          ; device category (must be 08h)
mov cl, 70h          ; Get Current Lock State
int 21h

jc error
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>DriveNum</i></dt>
<dd>
Drive to retrieve lock information about. This parameter can be 0 for the default drive, 1 for A, 2 for B, and so on.
</dd>
</dl>
<h4>Return Value</h4>
<p>
Clears the carry flag and sets the AX and CX registers to these values if successful:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=7%>AX</td>
<td width=93%>Current lock level. It may be either  0, 1, 2 or 3. If the volume is not locked, AX contains  – 1</td>
</tr>
<tr valign=top>
<td width=7%>CX</td>
<td width=93%>Lock permissions. The bits have the following form:</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=8%><b>Bit</b></td>
<th align=left width=92%>Meaning</th>
</tr>
<tr valign=top>
<td width=8%>0</td>
<td width=92%>0 = Write operations are failed.</td>
</tr>
<tr valign=top>
<td width=8%>0</td>
<td width=92%>1 = Write operations are allowed, unless they are blocked by the lock level.</td>
</tr>
<tr valign=top>
<td width=8%>1</td>
<td width=92%>0 = New file mapping are allowed, unless they are blocked by the lock level.</td>
</tr>
<tr valign=top>
<td width=8%>1</td>
<td width=92%>1 = New file mapping are failed.</td>
</tr>
<tr valign=top>
<td width=8%>2</td>
<td width=92%>1 = The volume is locked for formatting.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The lock level and the permissions determine the kind of access processes other than the lock owner have to the volume while it is locked. The following operations are allowed by processes other than lock owner at each lock level:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=14%>Level </th>
<th align=left width=86%>Operations </th>
</tr>
<tr valign=top>
<td width=14%>0</td>
<td width=86%>Read operations, write operations, and new file mappings are failed.</td>
</tr>
<tr valign=top>
<td width=14%>1</td>
<td width=86%>Read operations are allowed. Write operations and new file mappings are either allowed or failed based on permissions.</td>
</tr>
<tr valign=top>
<td width=14%>2</td>
<td width=86%>Read operations are allowed. Write operations and new file mappings are either failed or blocked based on permissions.</td>
</tr>
<tr valign=top>
<td width=14%>3</td>
<td width=86%>Read operations are blocked. Write operations and new file mappings are either failed or blocked based on permissions.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
