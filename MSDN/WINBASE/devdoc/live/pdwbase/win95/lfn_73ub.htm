<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>File Searches</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win95_file_searches"></a>File Searches</h2>
<p>
You can search directories for selected files by using Find First File and Find Next File (Interrupt 21h Functions 714Eh and 714Fh). These functions search for and return information about files having long filenames and aliases (filenames in the standard 8.3 format). The functions return information in a <a href="../filesio_4xv6.htm"><b>WIN32_FIND_DATA</b></a> structure, which contains both the filename and the corresponding alias, if any.</p>
<p>
Unlike MS-DOS Find First File (Interrupt 21h Function 4Eh), the long filename version of Find First File allocates internal storage for the search operations and returns a handle that identifies the storage. This handle is used with Find Next File. To make sure the internal storage is freed, you must use Find Close (<a href="95func_67jc.htm">Interrupt 21h Function 71A1h</a>) to end the search. </p>
<p>
You pass the Delete File (<a href="95func_29bc.htm">Interrupt 21h Function 7141h</a>) and Find First File functions a filename, which may contain wildcard characters, such as an asterisk (*) or question mark (?). Because Find First File, Find Next File, and Delete File examine long filenames and aliases during the search, some wildcard searches may yield unexpected results. For example, if the system has generated the alias <i>LONGFI~1</i> for the long filename <i>LongFileName</i>, a search for names that match the <i>*1</i> pattern would always return the <i>LongFileName</i> file, even though that name does not end with a <i>1</i>. Searches are not case-sensitive. For example, a search for names that match the *mid* pattern will yield the same results as that for the *MID* pattern. In general, you should check both names returned in the <b>WIN32_FIND_DATA</b> structure to determine which of them matched the pattern. </p>
<p>
Wildcard searches are more flexible in Windows 95 than in MS-DOS. In the preceding examples, <i>*1</i> finds the filenames that end in a <i>1</i> and <i>*mid*</i> finds filenames that contain the characters <i>mid</i>. In MS-DOS and in Windows 95 searching on real-mode FAT directories, all characters after the first <i>*</i> are ignored. </p>
<p>&nbsp;</p></body>
</HTML>
