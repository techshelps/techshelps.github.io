<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Asynchronous Operations and VxDs</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_asynchronous_operations_and_vxds_pt"></a>Asynchronous Operations and VxDs</h2>
<p>
You can direct a VxD to process a control code asynchronously. In an asynchronous operation, the <a href="../devio_9quk.htm"><b>DeviceIoControl</b></a> function returns immediately, regardless of whether the VxD has finished processing the control code. Asynchronous operation allows an application to continue while the VxD processes the control code in the background. You request an asynchronous operation by specifying the address of an <a href="../synchro_8tf6.htm"><b>OVERLAPPED</b></a> structure in the <b>DeviceIoControl</b> function. The <b>hDevice</b> member of <b>OVERLAPPED</b> specifies the handle of an event that the system sets to the signaled state when the VxD has completed the operation. </p>
<p>
Asynchronous (overlapped) operations are useful for lengthy operations, such as formatting a disk. To perform an asynchronous operation, you must specify the FILE_FLAG_OVERLAPPED value when calling <a href="../filesio_7wmd.htm"><b>CreateFile</b></a> to obtain a device handle. When calling <b>DeviceIoControl</b>, you must specify the address of an <b>OVERLAPPED</b> structure in the <i>lpOverlapped</i> parameter and the handle of a manual reset event in the <b>hEvent</b> member of the structure. The system ignores all other members. </p>
<p>
If <a href="../devio_9quk.htm"><b>DeviceIoControl</b></a> completes the operation before returning, it returns TRUE; otherwise, it returns FALSE. When the operation is finished, the system signals the manual reset event. You should call <a href="../synchro_75v8.htm"><b>GetOverlappedResult</b></a> when the thread that called <b>DeviceIoControl</b> needs to wait (that is, stop executing) until the operation has finished. </p>
<p>&nbsp;</p></body>
</HTML>
