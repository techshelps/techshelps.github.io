<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateToolhelp32Snapshot</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createtoolhelp32snapshot"></a>CreateToolhelp32Snapshot</h1>
<p>
Takes a snapshot of the processes and the heaps, modules, and threads used by the processes.</p>
<pre><code><b>HANDLE WINAPI CreateToolhelp32Snapshot(
  DWORD</b><i> dwFlags</i><b>,       </b>
<b>  DWORD</b><i> th32ProcessID  </i>
<b>);</b>
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwFlags</i></dt>
<dd>
Specifies portions of the system to include in the snapshot. This parameter can be one of the following:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Value</th>
<th align=left width=60%>Meaning</th>
</tr>
<tr valign=top>
<td width=40%>TH32CS_INHERIT</td>
<td width=60%>Indicates that the snapshot handle is to be inheritable.</td>
</tr>
<tr valign=top>
<td width=40%>TH32CS_SNAPALL</td>
<td width=60%>Equivalent to specifying TH32CS_SNAPHEAPLIST, TH32CS_SNAPMODULE, TH32CS_SNAPPROCESS, and TH32CS_SNAPTHREAD.</td>
</tr>
<tr valign=top>
<td width=40%>TH32CS_SNAPHEAPLIST</td>
<td width=60%>Includes the heap list of the specified  process in the snapshot.</td>
</tr>
<tr valign=top>
<td width=40%>TH32CS_SNAPMODULE</td>
<td width=60%>Includes the module list of the specified  process in the snapshot.</td>
</tr>
<tr valign=top>
<td width=40%>TH32CS_SNAPPROCESS</td>
<td width=60%>Includes the process list in the snapshot.</td>
</tr>
<tr valign=top>
<td width=40%>TH32CS_SNAPTHREAD</td>
<td width=60%>Includes the thread list in the snapshot.</td>
</tr>
</table><br>

</dd>
<dt>
<i>th32ProcessID</i></dt>
<dd>
Specifies the process identifier. This parameter can be zero to indicate the current process. This parameter is used when the TH32CS_SNAPHEAPLIST or TH32CS_SNAPMODULE value is specified. Otherwise, it is ignored.
</dd>
</dl>
<h4>Return Value</h4>
<p>
Returns an open handle to the specified snapshot if successful or  – 1 otherwise. </p>
<h4>Remarks</h4>
<p>
The snapshot taken by this function is examined by the other tool help functions to provide their results. Access to the snapshot is read only. The snapshot handle acts like an object handle and is subject to the same rules regarding which processes and threads it is valid in. </p>
<p>
To retrieve an extended error status code generated by this function, use the <a href="../errors_3uwi.htm"><b>GetLastError</b></a> function.</p>
<p>
To destroy the snapshot, use the <a href="../handobj_289x.htm"><b>CloseHandle</b></a> function.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in tlhelp32.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="toolhelp_5pfd.htm">Tool Help Library Overview</a>, <a href="toolhelp_6wz7.htm">Tool Help Functions</a> </p>
<p>&nbsp;</p></body>
</HTML>
