<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interrupt 21h Function 6Ch</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win95_interrupt_21h_function_6ch"></a>Interrupt 21h Function 6Ch</h1>
<p>
Opens or creates a file having the given name and attributes. </p>
<pre><code>mov ah, 6Ch             ; Extended Open/Create
mov bx, ModeAndFlags    ; see below
mov cx, Attributes      ; see below
mov dx, Action          ; action to take
mov si, seg Filename    ; see below
mov ds, si
mov si, offset Filename
int 21h

jc error
mov [Handle], ax        ; file handle
mov [ActionTaken], cx   ; action taken to open file
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ModeAndFlags</i></dt>
<dd>
Combination of access mode, sharing mode, and open flags. This parameter can be one value each from the access and sharing modes and any combination of open flags:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Access mode</th>
<th align=left width=80%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_READONLY (0000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for reading only.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_WRITEONLY (0001h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for writing only.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_READWRITE (0002h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for reading and writing.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>0003h</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Reserved; do not use.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_RO_NOMODLASTACCESS (0004h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for reading only without modifying the file's last access date.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Sharing mode</th>
<th align=left width=80%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_COMPATIBLE (0000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file with compatibility mode, allowing any process on a given computer to open the file any number of times.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYREADWRITE (0010h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file and denies both read and write access to other processes. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYWRITE (0020h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file and denies write access to other processes. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYREAD (0030h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file and denies read access to other processes.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYNONE (0040h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file without denying read or write access to other processes, but no process may open the file with compatibility mode.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Open flags</th>
<th align=left width=80%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NOINHERIT (0080h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>If this flag is set, a child process created with Load and Execute Program (Interrupt 21h Function 4B00h) does not inherit the file handle. If the handle is needed by the child process, the parent process must pass the handle value to the child process. If this flag is not set, child processes inherit the file handle.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NOCRITERR (2000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>If a critical error occurs while MS-DOS is opening this file, Critical-Error Handler (Interrupt 24h) is not called. Instead, MS-DOS simply returns an error value to the program.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_COMMIT (4000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>After each write operation, MS-DOS commits the file (flushes the contents of the cache buffer to disk).</td>
</tr>
</table><br>

</dd>
<dt>
<i>Attributes</i></dt>
<dd>
Attributes for files that are created or truncated. This parameter may be a combination of these values: 

<table cellspacing=4 cols=2>
<tr valign=top>
<td colspan=2 width=100%>_A_NORMAL (0000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file can be read from or written to. This value is valid only if used alone.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_RDONLY (0001h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file can be read from, but not written to.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_HIDDEN (0002h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file is hidden and does not appear in an ordinary directory listing.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_SYSTEM (0004h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file is part of the operating system or is used exclusively by it.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_VOLID (0008h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The name specified by <i>Filename </i>is used as the volume label for the current medium.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_ARCH (0020h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file is an archive file. Applications use this value to mark files for backup or removal.</td>
</tr>
</table><br>

</dd>
<dt>
<i>Action</i></dt>
<dd>
Action to take it the file exists or does not exist. This parameter can be a combination of these values:

<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%>FILE_CREATE (0010h)</td>
<td width=65%>Creates a new file if it does not already exist or fails if the file already exists.</td>
</tr>
<tr valign=top>
<td width=35%>FILE_OPEN (0001h)</td>
<td width=65%>Opens the file. The function fails if the file does not exist.</td>
</tr>
<tr valign=top>
<td width=35%>FILE_TRUNCATE (0002h)</td>
<td width=65%>Opens the file and truncates it to zero length (replaces the existing file). The function fails if the file does not exist.</td>
</tr>
</table><br>


<p>
The only valid combinations are FILE_CREATE combined with FILE_OPEN or FILE_CREATE combined with FILE_TRUNCATE.
</dd>
<dt>
<i>Filename</i></dt>
<dd>
Address of a null-terminated string specifying the name of the file to be opened or created. The name must be in the standard MS-DOS 8.3 filename format. The string must be a valid path for the volume associated with the given drive.
</dd>
</dl>
<h4>Return Value</h4>
<p>
Clears the carry flag, copies the file handle to the AX register, and sets CX to one of the following values if successful:</p>
<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%>ACTION_OPENED (0001h)</td>
</tr>
<tr valign=top>
<td width=100%>ACTION_CREATED_OPENED (0002h)</td>
</tr>
<tr valign=top>
<td width=100%>ACTION_REPLACED_OPENED (0003h)</td>
</tr>
</table><br>
<p>
Otherwise, this function sets the carry flag and sets the AX register to one of the following error values:</p>
<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%>ERROR_INVALID_FUNCTION (0001h)</td>
</tr>
<tr valign=top>
<td width=100%>ERROR_FILE_NOT_FOUND (0002h)</td>
</tr>
<tr valign=top>
<td width=100%>ERROR_PATH_NOT_FOUND (0003h)</td>
</tr>
<tr valign=top>
<td width=100%>ERROR_TOO_MANY_OPEN_FILES (0004h)</td>
</tr>
<tr valign=top>
<td width=100%>ERROR_ACCESS_DENIED (0005h)</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
This function does not support long filenames. If the specified name is too long, this function truncates the name to the standard 8.3 format following the same naming scheme that the system uses when creating an alias for a long filename.</p>
<p>
A file on a remote directory — that is, a directory on the network — cannot be opened, unless appropriate permissions for the directory exist. </p>
<p>&nbsp;</p></body>
</HTML>
