<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interrupt 21h Function 716Ch</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win95_interrupt_21h_function_716ch"></a>Interrupt 21h Function 716Ch</h1>
<p>
Creates or opens a file.</p>
<pre><code>mov ax, 716Ch          ; Create or Open File
mov bx, ModeAndFlags   ; see below
mov cx, Attributes     ; see below
mov dx, Action         ; see below
mov si, seg Filename   ; see below
mov ds, si
mov si, offset Filename
mov di, AliasHint      ; see below
int 21h

jc error
mov [Handle], ax       ; file handle
mov [ActionTaken], cx  ; action taken to open file
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ModeAndFlags</i></dt>
<dd>
Combination of access mode, sharing mode, and open flags. This parameter can be one value each from the access and sharing modes and any combination of open flags:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Access mode</th>
<th align=left width=80%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_READONLY (0000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for reading only.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_WRITEONLY (0001h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for writing only.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_READWRITE (0002h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for reading and writing.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>0003h</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Reserved; do not use.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_ACCESS_RO_NOMODLASTACCESS (0004h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file for reading only without modifying the file's last access date.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Sharing mode</th>
<th align=left width=80%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_COMPATIBLE (0000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file with compatibility mode, allowing any process on a given computer to open the file any number of times.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYREADWRITE (0010h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file and denies both read and write access to other processes. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYWRITE (0020h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file and denies write access to other processes. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYREAD (0030h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file and denies read access to other processes.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_SHARE_DENYNONE (0040h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>Opens the file without denying read or write access to other processes, but no process may open the file for compatibility access.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Open flags</th>
<th align=left width=80%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NOINHERIT (0080h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>If this flag is set, a child process created with Load and Execute Program (Interrupt 21h Function 4B00h) does not inherit the file handle. If the handle is needed by the child process, the parent process must pass the handle value to the child process. If this flag is not set, child processes inherit the file handle.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NO_BUFFERING (0100h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file is to be opened with no intermediate buffering or caching done by the system. Read and write operations access the disk directly. All reads and writes to the file must be done at file positions that are multiples of the disk sector size, in bytes, and the number of bytes read or written should also be a multiple of the sector size. Applications can determine the sector size, in bytes, with the Get Disk Free Space function (Interrupt 21h, Function 36h).</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NO_COMPRESS (0200h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file should not be compressed on a volume that performs file compression. If the volume does not perform file compression, this flag is ignored. This flag is valid only on file creation and is ignored on file open. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_ALIAS_HINT (0400h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The number in the DI register is to be used as the numeric tail for the alias (short filename). For more information, see <i>AliasHint </i>below.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_NOCRITERR (2000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>If a critical error occurs while MS-DOS is opening this file, Critical-Error Handler (Interrupt 24h) is not called. Instead, MS-DOS simply returns an error value to the program.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>OPEN_FLAGS_COMMIT (4000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>After each write operation, MS-DOS commits the file (flushes the contents of the cache buffer to disk).</td>
</tr>
</table><br>

</dd>
<dt>
<i>Attributes</i></dt>
<dd>
Attributes for files that are created or truncated. This parameter may be a combination of these values:

<table cellspacing=4 cols=2>
<tr valign=top>
<td colspan=2 width=100%>_A_NORMAL (0000h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file can be read from or written to. This value is valid only if used alone.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_RDONLY (0001h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file can be read from, but not written to.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_HIDDEN (0002h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file is hidden and does not appear in an ordinary directory listing.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_SYSTEM (0004h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file is part of the operating system or is used exclusively by it.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_VOLID (0008h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The name specified by <i>Filename </i>is used as the volume label for the current medium and is restricted to the standard 8.3 format. For information about an alternative way to set the volume label, see Set Media ID (Interrupt 21h Function 440Dh Minor Code 46h) in the <i>Microsoft MS-DOS Programmer's Reference</i>.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>_A_ARCH (0020h)</td>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%>The file is an archive file. Applications use this value to mark files for backup or removal.</td>
</tr>
</table>
</dd>
<dt>
<i>Action</i></dt>
<dd>
Action to take it the file exists or if it does not exist. This parameter can be a combination of these values:
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=39%>FILE_CREATE (0010h)</td>
<td width=61%>Creates a new file if it does not already exist. The function fails if the file already exists.</td>
</tr>
<tr valign=top>
<td width=39%>FILE_OPEN (0001h)</td>
<td width=61%>Opens the file. The function fails if the file does not exist.</td>
</tr>
<tr valign=top>
<td width=39%>FILE_TRUNCATE (0002h)</td>
<td width=61%>Opens the file and truncates it to zero length (replaces the existing file). The function fails if the file does not exist.</td>
</tr>
</table><br>


<p>
The only valid combinations are FILE_CREATE combined with FILE_OPEN or FILE_CREATE combined with FILE_TRUNCATE. 
</dd>
<dt>
<i>Filename</i></dt>
<dd>
Address of a null-terminated string specifying the name of the file to be opened or created. The string must be a valid path for the volume associated with the given drive. Long filenames are allowed.</dd>
<dt>
<i>AliasHint</i></dt>
<dd>
Number that is used in the numeric tail for the alias (short filename). A numeric tail, which consists of the tilde character (~) followed a number, is appended to the end of a filename. The system constructs the alias from the first few characters of the long filename followed by the numeric tail. The system starts with the number 1 in the numeric tail. If that filename is in use, it uses the number 2. It continues in this fashion until a unique name is found. To override the default numbering scheme, you must specify the OPEN_FLAGS_ALIAS_HINT value when you create the file in addition to specifying this parameter. If a filename already exists with the specified numeric tail, the system uses the default numbering scheme. You should specify a number for this parameter, not the tilde character.
</dd>
</dl>
<h4>Return Value</h4>
<p>
Clears carry flag, copies the file handle to the AX register, and sets the CX register to one of the following values if successful: </p>
<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%>ACTION_OPENED (0001h)</td>
</tr>
<tr valign=top>
<td width=100%>ACTION_CREATED_OPENED (0002h)</td>
</tr>
<tr valign=top>
<td width=100%>ACTION_REPLACED_OPENED (0003h)</td>
</tr>
</table><br>
<p>
Otherwise, the function sets the carry flag and sets the AX register to an error value.</p>
<h4>Remarks</h4>
<dl>
<dt>
A file on a remote directory — that is, a directory on the network — cannot be opened, created, or modified, unless the appropriate permissions for the directory exist.</dt>
</dl>
<p>&nbsp;</p></body>
</HTML>
