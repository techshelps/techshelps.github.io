<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interrupt 21h Function 7160h Minor Code 2h</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win95_interrupt_21h_function_7160h_minor_code_2h"></a>Interrupt 21h Function 7160h Minor Code 2h</h1>
<p>
Retrieves the complete path in its long filename form for the specified file or path. The function returns the long name for all directories in the path.</p>
<pre><code>mov ax, 7160h 
mov cl, 2                  ; Get Long Path Name
mov ch, SubstExpand        ; see below
mov si, seg SourcePath     ; see below
mov ds, si
mov si, offset SourcePath
mov di, seg DestPath       ; see below
mov es, di
mov di, offset DestPath
int 21h
jc  error
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>SubstExpand</i></dt>
<dd>
Flag that indicates if the returned path should contain a SUBST drive letter or the path associated with the SUBST drive. Zero is specified to indicate that the returned path should contain the path associated with the SUBST drive, and 80h is specified to indicate that the returned path should contain the SUBST drive letter.</dd>
<dt>
<i>SourcePath</i></dt>
<dd>
Address of a null-terminated string that names the file or path to retrieve the complete long path for. Either the long filename or the short form is acceptable as the source string.</dd>
<dt>
<i>DestPath</i></dt>
<dd>
Address of the buffer that receives the complete path. The buffer should be large enough to contain the largest possible Windows 95 path (260 characters, including the drive letter, colon, leading backslash, and terminating null character).
</dd>
</dl>
<h4>Return Value</h4>
<p>
Clears the carry flag, modifies the AX register, and returns the complete long path in the given buffer if successful. Otherwise, the function sets the carry flag and sets the AX register to an error value. </p>
<h4>Remarks</h4>
<p>
Relative paths containing the characters "." and ".." in <i>SourcePath</i> are fully expanded. Since this function performs validation, <i>SourcePath</i> must contain either a valid filename or path.</p>
<p>&nbsp;</p></body>
</HTML>
