<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RegisterEventSource</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_registereventsource"></a>RegisterEventSource</h1>
<p>
The <b>RegisterEventSource</b> function returns a registered handle to an event log. </p>
<pre><code><b>HANDLE RegisterEventSource(
  LPCTSTR</b><i> lpUNCServerName</i><b>,  </b>// server name for source
<b>  LPCTSTR</b><i> lpSourceName</i>   // source name for registered handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpUNCServerName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the Universal Naming Convention (UNC) name of the server on which this operation is to be performed. If this parameter is NULL, the operation is performed on the local computer. </dd>
<dt>
<i>lpSourceName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the source referenced by the returned handle. The source name must be a subkey of a logfile entry under the <b>EventLog</b> key in the registry. For example, WinApp is a valid source name if the registry has the following key: 
<pre><code>HKEY_LOCAL_MACHINE 
  System 
    CurrentControlSet 
      Services 
        EventLog 
          Application 
            WinApp 
          Security 
          System 
 </code></pre>
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a handle that can be used with the <a href="eventlog_756c.htm"><b>ReportEvent</b></a> function.</p>
<p>
If the function fails, the return value is NULL. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
If the source name cannot be found, the event logging service uses the <b>Application</b> logfile; it does not create a new source. Events are reported for the source, however, there are no message and category message files specified for looking up descriptions of the event identifiers for the source. </p>
<p>
To close the handle to the event log, call the <a href="eventlog_3yn9.htm"><b>DeregisterEventSource</b></a> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="eventlog_2tbb.htm">Event Logging Overview</a>, <a href="eventlog_622b.htm">Event Logging Functions</a>, <a href="eventlog_3yn9.htm"><b>DeregisterEventSource</b></a>, <a href="eventlog_756c.htm"><b>ReportEvent</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
