<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ObjectOpenAuditAlarm</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_objectopenauditalarm"></a>ObjectOpenAuditAlarm</h1>
<p>
The <b>ObjectOpenAuditAlarm</b> function generates audit messages when a client application attempts to gain access to an object or to create a new one. Alarms are not supported in the current version of Windows NT. </p>
<pre><code><b>BOOL ObjectOpenAuditAlarm(
  LPCTSTR</b><i> SubsystemName</i><b>,  </b>// address of string for subsystem name
<b>  LPVOID</b><i> HandleId</i><b>,        </b>// address of handle identifier
<b>  LPTSTR</b><i> ObjectTypeName</i><b>,  </b>// address of string for object type
<b>  LPTSTR</b><i> ObjectName</i><b>,      </b>// address of string for object name
<b>  PSECURITY_DESCRIPTOR</b><i> pSecurityDescriptor</i><b>,</b>
<b>                          </b>// address of security descriptor
<b>  HANDLE</b><i> ClientToken</i><b>,     </b>// handle of client's access token
<b>  DWORD</b><i> DesiredAccess</i><b>,    </b>// mask for desired access rights
<b>  DWORD</b><i> GrantedAccess</i><b>,    </b>// mask for granted access rights
<b>  PPRIVILEGE_SET</b><i> Privileges</i><b>,  </b>// address of privileges
<b>  BOOL</b><i> ObjectCreation</i><b>,    </b>// flag for object creation
<b>  BOOL</b><i> AccessGranted</i><b>,     </b>// flag for results
<b>  LPBOOL</b><i> GenerateOnClose</i>   // address of flag for audit generation
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>SubsystemName</i></dt>
<dd>
Pointer to a null-terminated string specifying the name of the subsystem calling the function. This string appears in any audit message that the function generates.</dd>
<dt>
<i>HandleId</i></dt>
<dd>
Pointer to a unique 32-bit value representing the client's handle of the object. If the access is denied, this parameter is ignored. </dd>
<dt>
<i>ObjectTypeName</i></dt>
<dd>
Pointer to a null-terminated string specifying the type of object to which the client is requesting access. This string appears in any audit message that the function generates.</dd>
<dt>
<i>ObjectName</i></dt>
<dd>
Pointer to a null-terminated string specifying the name of the object to which the client is requesting access. This string appears in any audit message that the function generates.</dd>
<dt>
<i>pSecurityDescriptor</i></dt>
<dd>
Pointer to the <a href="accctrl_6i5u.htm"><b>SECURITY_DESCRIPTOR</b></a> structure for the object being accessed. </dd>
<dt>
<i>ClientToken</i></dt>
<dd>
Identifies an access token representing the client requesting the operation. This handle must be obtained by opening the token of a thread impersonating the client. The token must be open for TOKEN_QUERY access. </dd>
<dt>
<i>DesiredAccess</i></dt>
<dd>
Specifies the desired access mask. This mask must have been previously mapped by the <b>MapGenericMask</b> function to contain no generic access rights. </dd>
<dt>
<i>GrantedAccess</i></dt>
<dd>
Specifies an access mask indicating which access rights are granted. This access mask is intended to be the same value set by one of the access-checking functions in its <i>GrantedAccess</i> parameter. Examples of access-checking functions include <b>AccessCheckAndAuditAlarm</b> and <b>AccessCheck</b>. </dd>
<dt>
<i>Privileges</i></dt>
<dd>
Pointer to a <a href="accclsrv_9ss2.htm"><b>PRIVILEGE_SET</b></a> structure that specifies the set of privileges required for the access attempt. This parameter can be NULL. </dd>
<dt>
<i>ObjectCreation</i></dt>
<dd>
Specifies a flag that determines whether the application creates a new object when access is granted. When this flag is TRUE, the application creates a new object; when it is FALSE, the application opens an existing object. </dd>
<dt>
<i>AccessGranted</i></dt>
<dd>
Specifies a flag indicating whether access was granted or denied in a previous call to an access-checking function, such as <b>AccessCheck</b>. If access was granted, this flag is TRUE. If not, it is FALSE. </dd>
<dt>
<i>GenerateOnClose</i></dt>
<dd>
Pointer to a flag set by the audit-generation routine when the function returns. This flag must be passed to the <b>ObjectCloseAuditAlarm</b> function when the object handle is closed. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <b>GetLastError</b>. </p>
<h4>Remarks</h4>
<p>
The <b>ObjectOpenAuditAlarm</b> function requires the calling application to have the SE_AUDIT_NAME privilege enabled. The test for this privilege is always performed against the primary token of the calling process, not the impersonation token of the thread. This allows the calling process to impersonate a client during the call. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="accclsrv_64vg.htm">Client/Server Access Control Overview</a>, <a href="accclsrv_0hv7.htm">Client/Server Access Control Functions</a>, <a href="accclsrv_5jjf.htm"><b>AccessCheck</b></a>, <a href="accclsrv_5ze5.htm"><b>AccessCheckAndAuditAlarm</b></a>, <a href="accclsrv_27xg.htm"><b>AreAllAccessesGranted</b></a>, <a href="accclsrv_6o84.htm"><b>AreAnyAccessesGranted</b></a>, <a href="accclsrv_8757.htm"><b>MapGenericMask</b></a>, <a href="accclsrv_2vvx.htm"><b>ObjectCloseAuditAlarm</b></a>, <a href="accclsrv_0xd9.htm"><b>ObjectDeleteAuditAlarm</b></a>, <a href="accclsrv_6gdp.htm"><b>ObjectPrivilegeAuditAlarm</b></a>, <a href="accclsrv_9vhn.htm"><b>PrivilegeCheck</b></a>, <a href="accclsrv_68od.htm"><b>PrivilegedServiceAuditAlarm</b></a>, <a href="accclsrv_9ss2.htm"><b>PRIVILEGE_SET</b></a>, <a href="accctrl_6i5u.htm"><b>SECURITY_DESCRIPTOR</b></a></p>
<p>&nbsp;</p></body>
</HTML>
