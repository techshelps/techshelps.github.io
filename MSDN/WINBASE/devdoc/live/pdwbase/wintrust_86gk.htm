<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WinVerifyTrust</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_winverifytrust"></a>WinVerifyTrust</h1>
<p>
The <b>WinVerifyTrust</b> function performs a specified verification action on a specified subject. The function passes the inquiry to the trust provider, if any, that supports the action identifier.  </p>
<pre><code><b>LONG WinVerifyTrust(
  HWND</b><i> hwnd</i><b>,        </b>// handle to a window for interacting with the user
<b>  GUID</b><i> *ActionID</i><b>,   </b>// pointer to a trust provider action identifier
<b>  LPVOID</b><i> ActionData </i>// pointer to a buffer containing action-specific data
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hwnd</i></dt>
<dd>
Handle to the caller's window. The trust provider can use this value to determine whether it can interact with the user. However, trust providers typically perform verification actions with input from the user.
<p>
This parameter can be one of the following values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=42%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=42%>INVALID_HANDLE_VALUE</td>
<td width=58%>There is no interactive user. The trust provider performs the verification action without the user's assistance. </td>
</tr>
<tr valign=top>
<td width=42%>Zero</td>
<td width=58%>The trust provider can use the interactive desktop to display its user interface. </td>
</tr>
<tr valign=top>
<td width=42%>A valid window handle</td>
<td width=58%>A trust provider can treat any value other than INVALID_HANDLE_VALUE or zero as a valid window handle that it can use to interact with the user. </td>
</tr>
</table><br>

</dd>
<dt>
<i>ActionID</i></dt>
<dd>
Pointer to a <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_guid">
</object><a href=JavaScript:alink_1.Click()><b>GUID</b></a> structure that identifies an action, and implicitly, the trust provider that supports the action identifier. This value indicates the type of verification action to perform on the subject identified by the <i>ActionData</i> parameter.
<p>
The WinTrust service is designed to work with trust providers implemented by third parties. Each trust provider provides its own unique set of action identifiers. For information about the action identifiers supported by a trust provider, see the documentation for that trust provider. 

<p>
For example, Microsoft provides a Software Publisher Trust Provider that can establish the trustworthiness of software being downloaded from a public network, such as the internet. The Software Publisher Trust Provider supports the following action identifiers. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=19%>Value</th>
<th align=left width=81%>Description</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>WIN_SPUB_ACTION_TRUSTED_PUBLISHER</td>
</tr>
<tr valign=top>
<td width=19%></td>
<td width=81%>The <i>ActionData</i> parameter is a pointer to a <b>WIN_SPUB_TRUSTED_PUBLISHER_DATA</b> structure. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>WIN_SPUB_ACTION_NT_ACTIVATE_IMAGE</td>
</tr>
<tr valign=top>
<td width=19%></td>
<td width=81%>The <i>ActionData</i> parameter is a pointer to a <b>WIN_TRUST_ACTDATA_CONTEXT_WITH_SUBJECT</b> structure. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>WIN_SPUB_ACTION_PUBLISHED_SOFTWARE</td>
</tr>
<tr valign=top>
<td width=19%></td>
<td width=81%>The <i>ActionData</i> parameter is a pointer to a <b>WIN_TRUST_ACTDATA_CONTEXT_WITH_SUBJECT</b> structure. </td>
</tr>
</table><br>

</dd>
<dt>
<i>ActionData</i></dt>
<dd>
Pointer to a buffer that contains information that the trust provider needs to process the specified action identifier. Typically, the data in the buffer includes information that identifies the subject that the trust provider must evaluate. 
<p>
The format of the data depends on the action identifier. For information about the data required for a specific action identifier, see the documentation for the trust provider that supports that action. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the trust provider verifies that the subject is trusted for the specified action, the return value is ERROR_SUCCESS.</p>
<p>
Otherwise, the return value is the status code returned by the trust provider. For example, a trust provider might indicate that the subject is not trusted, or is trusted but with limitations or warnings. The return value can be a trust-provider-specific value described in the documentation for an individual trust provider, or it can be one of the following error codes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=59%>Value</th>
<th align=left width=41%>Meaning</th>
</tr>
<tr valign=top>
<td width=59%>TRUST_E_SUBJECT_NOT_TRUSTED</td>
<td width=41%>The subject failed the specified verification action. Most trust providers return a more detailed error code that describes the reason for the failure.</td>
</tr>
<tr valign=top>
<td width=59%>TRUST_E_PROVIDER_UNKNOWN</td>
<td width=41%>The trust provider is not recognized on this system.</td>
</tr>
<tr valign=top>
<td width=59%>TRUST_E_ACTION_UNKNOWN</td>
<td width=41%>The trust provider does not support the specified action.</td>
</tr>
<tr valign=top>
<td width=59%>TRUST_E_SUBJECT_FORM_UNKNOWN</td>
<td width=41%>The trust provider does not support the form specified for the subject.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>WinVerifyTrust</b> function enables applications to invoke a trust provider to verify that a specified subject satisfies the criteria of a specified verification operation. The <i>ActionID</i> parameter identifies the verification operation, and the <i>ActionData</i> parameter identifies the subject. A trust provider is a DLL registered with WinTrust. When you call <b>WinVerifyTrust</b>, the WinTrust service forwards the call to the registered trust provider, if there is one, that supports the specified action identifier.</p>
<p>
For example, the Software Publisher Trust Provider can verify that an executable image file comes from a trusted software publisher and that the file has not been modified since it was published. In this case, the <i>ActionData</i> parameter specifies the name of the file and the type of file, such as a Microsoft Portable Executable image file or a Java class file.</p>
<p>
Each trust provider supports a specific set of actions that it can evaluate. Each action has a globally unique identifier (<b>GUID</b>) that identifies it. A trust provider can support any number of action identifiers, but two trust providers cannot support the same action identifier. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use wintrust.lib.</p>
<h4>See Also</h4>
<p>
<a href="wintrust_5vlg.htm">WinTrust Overview</a>, <a href="wintrust_6037.htm">WinTrust Functions</a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_guid">
</object><a href=JavaScript:alink_2.Click()><b>GUID</b></a>, <a href="wintrust_7q7m.htm"><b>WIN_TRUST_ACTDATA_CONTEXT_WITH_SUBJECT</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
