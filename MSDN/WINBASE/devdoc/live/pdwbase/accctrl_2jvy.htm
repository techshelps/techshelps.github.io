<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetTokenInformation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_gettokeninformation"></a>GetTokenInformation</h1>
<p>
The <b>GetTokenInformation</b> function retrieves a specified type of information about an access token. The calling process must have appropriate access rights to obtain the information. </p>
<pre><code><b>BOOL GetTokenInformation(
  HANDLE</b><i> TokenHandle</i><b>,       </b>// handle of access token
<b>  TOKEN_INFORMATION_CLASS</b><i> TokenInformationClass</i><b>,</b>
<b>                            </b>// type of information to retrieve
<b>  LPVOID</b><i> TokenInformation</i><b>,  </b>// address of retrieved information
<b>  DWORD</b><i> TokenInformationLength</i><b>,</b>
<b>                            </b>// size of information buffer
<b>  PDWORD</b><i> ReturnLength</i>       // address of required buffer size
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>TokenHandle</i></dt>
<dd>
Identifies an access token from which information is retrieved. If <i>TokenInformationClass</i> specifies TokenSource, the handle must have TOKEN_QUERY_SOURCE access. For all other <i>TokenInformationClass</i> values, the handle must have TOKEN_QUERY access. </dd>
<dt>
<i>TokenInformationClass</i></dt>
<dd>
Specifies a value from the <a href="accctrl_6xde.htm"><b>TOKEN_INFORMATION_CLASS</b></a> enumerated type identifying the type of information the function retrieves. </dd>
<dt>
<i>TokenInformation</i></dt>
<dd>
Pointer to a buffer the function fills with the requested information. The structure put into this buffer depends upon the type of information specified by the <i>TokenInformationClass</i> parameter, as shown in the following list: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Token Information Class</th>
<th align=left width=60%>Structure Returned</th>
</tr>
<tr valign=top>
<td width=40%>TokenUser</td>
<td width=60%>The buffer receives a <a href="accctrl_18qa.htm"><b>TOKEN_USER</b></a> structure containing the token's user account. </td>
</tr>
<tr valign=top>
<td width=40%>TokenGroups</td>
<td width=60%>The buffer receives a <a href="accctrl_2eia.htm"><b>TOKEN_GROUPS</b></a> structure containing the group accounts associated with the token.</td>
</tr>
<tr valign=top>
<td width=40%>TokenPrivileges</td>
<td width=60%>The buffer receives a <a href="accctrl_5436.htm"><b>TOKEN_PRIVILEGES</b></a> structure containing the token's privileges.</td>
</tr>
<tr valign=top>
<td width=40%>TokenOwner</td>
<td width=60%>The buffer receives a <a href="accctrl_86ia.htm"><b>TOKEN_OWNER</b></a> structure containing the default owner SID for newly created objects.</td>
</tr>
<tr valign=top>
<td width=40%>TokenPrimaryGroup</td>
<td width=60%>The buffer receives a <a href="accctrl_0oz6.htm"><b>TOKEN_PRIMARY_GROUP</b></a> structure containing the default primary group SID for newly created objects. </td>
</tr>
<tr valign=top>
<td width=40%>TokenDefaultDacl</td>
<td width=60%>The buffer receives a <a href="accctrl_8m42.htm"><b>TOKEN_DEFAULT_DACL</b></a> structure containing the default DACL for newly created objects. </td>
</tr>
<tr valign=top>
<td width=40%>TokenSource</td>
<td width=60%>The buffer receives a <a href="accctrl_07zm.htm"><b>TOKEN_SOURCE</b></a> structure containing the source of the token. TOKEN_QUERY_SOURCE access is needed to retrieve this information.</td>
</tr>
<tr valign=top>
<td width=40%>TokenType</td>
<td width=60%>The buffer receives a <a href="accctrl_1r3m.htm"><b>TOKEN_TYPE</b></a> value indicating whether the token is a primary or impersonation token. </td>
</tr>
<tr valign=top>
<td width=40%>TokenImpersonationLevel</td>
<td width=60%>The buffer receives a <a href="accclsrv_1rsi.htm"><b>SECURITY_IMPERSONATION_LEVEL</b></a> value indicating the impersonation level of the token. If the access token is not an impersonation token, the function fails.</td>
</tr>
<tr valign=top>
<td width=40%>TokenStatistics</td>
<td width=60%>The buffer receives a <a href="accctrl_7n5e.htm"><b>TOKEN_STATISTICS</b></a> structure containing various token statistics.</td>
</tr>
<tr valign=top>
<td width=40%>TokenRestrictedSids</td>
<td width=60%>The buffer receives a <a href="accctrl_2eia.htm"><b>TOKEN_GROUPS</b></a> structure containing the list of restricting SIDs in a <a href="accctrl_9d9v.htm">restricted token</a>.</td>
</tr>
</table><br>

</dd>
<dt>
<i>TokenInformationLength</i></dt>
<dd>
Specifies the size, in bytes, of the buffer pointed to by the <i>TokenInformation</i> parameter. </dd>
<dt>
<i>ReturnLength</i></dt>
<dd>
Pointer to a variable receiving the actual number of bytes needed for the buffer pointed to by the <i>TokenInformation</i> parameter. If this value is larger than the value specified in the <i>TokenInformationLength</i> parameter, the function fails and stores no data in the buffer. 
<p>
If the value of the TokenInformationClass parameter is <b>TokenDefaultDacl</b> and the token has no default DACL, the function sets the variable pointed to by <i>ReturnLength</i> to <b>sizeof</b>(<b>TOKEN_DEFAULT_DACL</b>) and sets the <b>DefaultDacl</b> member of the <b>TOKEN_DEFAULT_DACL</b> structure to NULL.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="accctrl_2hf0.htm">Access Control Overview</a>, <a href="accctrl_6cmr.htm">Access Control Functions</a>, <a href="accctrl_4iur.htm"><b>AdjustTokenGroups</b></a>,<b> <a href="accctrl_6xbn.htm">AdjustTokenPrivileges</a></b>,<b> <a href="accctrl_0zam.htm">OpenProcessToken</a></b>,<b> <a href="accctrl_8bam.htm">OpenThreadToken</a></b>,<b> <a href="accctrl_9j5a.htm">SetTokenInformation</a></b>, <a href="accclsrv_1rsi.htm"><b>SECURITY_IMPERSONATION_LEVEL</b></a>, <a href="accctrl_8m42.htm"><b>TOKEN_DEFAULT_DACL</b></a>, <a href="accctrl_2eia.htm"><b>TOKEN_GROUPS</b></a>, <a href="accctrl_6xde.htm"><b>TOKEN_INFORMATION_CLASS</b></a>, <a href="accctrl_86ia.htm"><b>TOKEN_OWNER</b></a>, <a href="accctrl_0oz6.htm"><b>TOKEN_PRIMARY_GROUP</b></a>, <a href="accctrl_5436.htm"><b>TOKEN_PRIVILEGES</b></a>, <a href="accctrl_07zm.htm"><b>TOKEN_SOURCE</b></a>, <a href="accctrl_7n5e.htm"><b>TOKEN_STATISTICS</b></a>, <a href="accctrl_1r3m.htm"><b>TOKEN_TYPE</b></a>, <a href="accctrl_18qa.htm"><b>TOKEN_USER</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
