<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenService</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_openservice"></a>OpenService</h1>
<p>
The <b>OpenService</b> function opens a handle to an existing service. </p>
<pre><code><b>SC_HANDLE OpenService(
  SC_HANDLE</b><i> hSCManager</i><b>,  </b>// handle to service control manager 
                         // database
<b>  LPCTSTR</b><i> lpServiceName</i><b>, </b>// pointer to name of service to start
<b>  DWORD</b><i> dwDesiredAccess</i>  // type of access to service
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSCManager</i></dt>
<dd>
Handle to the service control manager database. The <a href="services_4c36.htm"><b>OpenSCManager</b></a> function returns this handle. </dd>
<dt>
<i>lpServiceName</i></dt>
<dd>
Pointer to a null-terminated string that names the service to open. The maximum string length is 256 characters. The service control manager database preserves the case of the characters, but service name comparisons are always case insensitive. Forward-slash (/) and backslash (\) are invalid service name characters. </dd>
<dt>
<i>dwDesiredAccess</i></dt>
<dd>
Specifies the access to the service. Before granting the requested access, the system checks the access token of the calling process against the discretionary access-control list of the security descriptor associated with the service object. 
<p>
The STANDARD_RIGHTS_REQUIRED constant enables the following service object access types: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Standard rights</th>
<th align=left width=54%>Description</th>
</tr>
<tr valign=top>
<td width=46%>DELETE</td>
<td width=54%>Enables calling of the <a href="services_2ujp.htm"><b>DeleteService</b></a> function to delete the service.</td>
</tr>
<tr valign=top>
<td width=46%>READ_CONTROL</td>
<td width=54%>Enables calling of the <a href="acctrlow_1vcp.htm"><b>QueryServiceObjectSecurity</b></a> function to query the security descriptor of the service object.</td>
</tr>
<tr valign=top>
<td width=46%>WRITE_DAC|WRITE_OWNER</td>
<td width=54%>Enables calling of the <a href="acctrlow_2jcp.htm"><b>SetServiceObjectSecurity</b></a> function to modify the security descriptor of the service object.</td>
</tr>
</table><br>


<p>
You can specify any or all of the following service object access types: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=59%>Access</th>
<th align=left width=41%>Description</th>
</tr>
<tr valign=top>
<td width=59%>SERVICE_ALL_ACCESS</td>
<td width=41%>Includes STANDARD_RIGHTS_REQUIRED in addition to all of the access types listed in this table.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_CHANGE_CONFIG</td>
<td width=41%>Enables calling of the <a href="services_5gh3.htm"><b>ChangeServiceConfig</b></a> function to change the service configuration.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_ENUMERATE_DEPENDENTS</td>
<td width=41%>Enables calling of the <a href="services_094j.htm"><b>EnumDependentServices</b></a> function to enumerate all the services dependent on the service.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_INTERROGATE</td>
<td width=41%>Enables calling of the <a href="services_3fs5.htm"><b>ControlService</b></a> function to ask the service to report its status immediately.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_PAUSE_CONTINUE</td>
<td width=41%>Enables calling of the <b>ControlService</b> function to pause or continue the service.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_QUERY_CONFIG</td>
<td width=41%>Enables calling of the <a href="services_7yjr.htm"><b>QueryServiceConfig</b></a> function to query the service configuration.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_QUERY_STATUS</td>
<td width=41%>Enables calling of the <a href="services_8coj.htm"><b>QueryServiceStatus</b></a> function to ask the service control manager about the status of the service.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_START</td>
<td width=41%>Enables calling of the <a href="services_8ox1.htm"><b>StartService</b></a> function to start the service.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_STOP</td>
<td width=41%>Enables calling of the <a href="services_3fs5.htm"><b>ControlService</b></a> function to stop the service.</td>
</tr>
<tr valign=top>
<td width=59%>SERVICE_USER_DEFINED_CONTROL</td>
<td width=41%>Enables calling of the <b>ControlService</b> function to specify a user-defined control code.</td>
</tr>
</table><br>


<p>
You can specify any of the following generic access types: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Generic access</th>
<th align=left width=66%>Service access</th>
</tr>
<tr valign=top>
<td width=34%>GENERIC_READ</td>
<td width=66%>Combines the following access types: STANDARD_RIGHTS_READ, SERVICE_QUERY_CONFIG, SERVICE_QUERY_STATUS, and SERVICE_ENUMERATE_DEPENDENTS.</td>
</tr>
<tr valign=top>
<td width=34%>GENERIC_WRITE</td>
<td width=66%>Combines the following access types: STANDARD_RIGHTS_WRITE and SERVICE_CHANGE_CONFIG.</td>
</tr>
<tr valign=top>
<td width=34%>GENERIC_EXECUTE</td>
<td width=66%>Combines the following access types: STANDARD_RIGHTS_EXECUTE, SERVICE_START, SERVICE_STOP, SERVICE_PAUSE_CONTINUE, SERVICE_INTERROGATE, and SERVICE_USER_DEFINED_CONTROL.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a handle to the service.</p>
<p>
If the function fails, the return value is NULL. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Errors</h4>
<p>
The following error codes can be set by the service control manager. Others can be set by the registry functions that are called by the service control manager. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Error code</th>
<th align=left width=47%>Meaning</th>
</tr>
<tr valign=top>
<td width=53%>ERROR_ACCESS_DENIED</td>
<td width=47%>The specified service control manager database handle does not have access to the service.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_INVALID_HANDLE</td>
<td width=47%>The specified handle is invalid.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_INVALID_NAME</td>
<td width=47%>The specified service name is invalid.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_SERVICE_DOES_NOT_EXIST</td>
<td width=47%>The specified service does not exist.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The returned handle is only valid for the process that called <b>OpenService</b>. It can be closed by calling the <b>CloseServiceHandle</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winsvc.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="services_0p0z.htm">Services Overview</a>, <a href="services_2uwj.htm">Service Functions</a>, <a href="services_5gh3.htm"><b>ChangeServiceConfig</b></a>, <a href="services_3fs5.htm"><b>ControlService</b></a>, <a href="services_3p9h.htm"><b>CreateService</b></a>, <a href="services_2ujp.htm"><b>DeleteService</b></a>, <a href="services_094j.htm"><b>EnumDependentServices</b></a>, <a href="services_4c36.htm"><b>OpenSCManager</b></a>, <a href="services_7yjr.htm"><b>QueryServiceConfig</b></a>, <a href="acctrlow_1vcp.htm"><b>QueryServiceObjectSecurity</b></a>, <a href="services_8coj.htm"><b>QueryServiceStatus</b></a>, <a href="acctrlow_2jcp.htm"><b>SetServiceObjectSecurity</b></a>, <a href="services_8ox1.htm"><b>StartService</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
