<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetServiceStatus</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setservicestatus"></a>SetServiceStatus</h1>
<p>
The <b>SetServiceStatus</b> function updates the service control manager's status information for the calling service. </p>
<pre><code><b>BOOL SetServiceStatus(
  SERVICE_STATUS_HANDLE</b><i> hServiceStatus~</i><b>,</b>
<b>                                     </b>// service status handle
<b>  LPSERVICE_STATUS</b><i> lpServiceStatus</i>   // address of status structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hServiceStatus~</i></dt>
<dd>
Specifies a handle to the service control manager's status information structure for the current service. This handle is returned by the <a href="services_7t0y.htm"><b>RegisterServiceCtrlHandler</b></a> function. </dd>
<dt>
<i>lpServiceStatus</i></dt>
<dd>
Pointer to the <a href="services_9s36.htm"><b>SERVICE_STATUS</b></a> structure the contains the latest status information for the calling service. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Errors</h4>
<p>
The following error codes can be set by the service control manager. Other error codes can be set by the registry functions that are called by the service control manager. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Value</th>
<th align=left width=59%>Meaning</th>
</tr>
<tr valign=top>
<td width=41%>ERROR_INVALID_HANDLE</td>
<td width=59%>The specified handle is invalid.</td>
</tr>
<tr valign=top>
<td width=41%>ERROR_INVALID_DATA</td>
<td width=59%>The specified service status structure is invalid.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
A <a href="services_61pq.htm"><b>ServiceMain</b></a> function first calls the <b>RegisterServiceCtrlHandler</b> function to get the service's SERVICE_STATUS_HANDLE. Then it immediately calls the <b>SetServiceStatus</b> function to notify the service control manager of its SERVICE_START_PENDING status. </p>
<p>
When a service receives a control request, the service's <a href="services_18oi.htm"><b>Handler</b></a> function must call <b>SetServiceStatus</b>, even if the service's status did not change. A service can also use this function at any time and by any thread of the service to notify the service control manager of status changes. Examples of such unsolicited status updates include: 
<ul>
<li>
Checkpoint updates that occur when the service is in transition from one state to another (that is, SERVICE_START_PENDING). </li>
<li>
Fatal error updates that occur when the service must stop due to a recoverable error. </li>
</ul>
<p>
A service can call this function only after it has called <b>RegisterServiceCtrlHandler</b> to get a service status handle. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winsvc.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="services_0p0z.htm">Services Overview</a>, <a href="services_2uwj.htm">Service Functions</a>, <a href="services_18oi.htm"><b>Handler</b></a>, <a href="services_7t0y.htm"><b>RegisterServiceCtrlHandler</b></a>, <a href="services_9s36.htm"><b>SERVICE_STATUS</b></a>, <a href="services_61pq.htm"><b>ServiceMain</b></a>, <a href="services_5uyb.htm"><b>SetServiceBits</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
