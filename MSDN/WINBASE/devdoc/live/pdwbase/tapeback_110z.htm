<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetTapeParameters</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_gettapeparameters"></a>GetTapeParameters</h1>
<p>
The <b>GetTapeParameters</b> function retrieves information that describes the tape or the tape drive. </p>
<pre><code><b>DWORD GetTapeParameters(
  HANDLE</b><i> hDevice</i><b>,            </b>// handle of open device
<b>  DWORD</b><i> dwOperation</i><b>,         </b>// type of information requested
<b>  LPDWORD</b><i> lpdwSize</i><b>,          </b>// address of returned information
<b>  LPVOID</b><i> lpTapeInformation</i>   // tape media or drive information
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDevice</i></dt>
<dd>
Identifies the device about which information is sought. This handle is created by using the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function. </dd>
<dt>
<i>dwOperation</i></dt>
<dd>
Specifies the type of information requested. This parameter must be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=54%>Value</th>
<th align=left width=46%>Description</th>
</tr>
<tr valign=top>
<td width=54%>GET_TAPE_MEDIA_INFORMATION</td>
<td width=46%>Retrieves information about the tape in the tape device.</td>
</tr>
<tr valign=top>
<td width=54%>GET_TAPE_DRIVE_INFORMATION</td>
<td width=46%>Retrieves information about the tape device.</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpdwSize</i></dt>
<dd>
Points to a variable that receives the size, in bytes, of the buffer specified by the <i>lpTapeInformation</i> parameter. If the buffer is too small, this parameter receives the required size. </dd>
<dt>
<i>lpTapeInformation</i></dt>
<dd>
Points to a structure that contains the requested information. If the <i>dwOperation</i> parameter is GET_TAPE_MEDIA_INFORMATION, <i>lpTapeInformation</i> points to a <a href="tapeback_31pu.htm"><b>TAPE_GET_MEDIA_PARAMETERS</b></a> structure. 
<p>
If <i>dwOperation</i> is GET_TAPE_DRIVE_INFORMATION, <i>lpTapeInformation</i> points to a <a href="tapeback_7oc2.htm"><b>TAPE_GET_DRIVE_PARAMETERS</b></a> structure. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NO_ERROR. </p>
<p>
If the function fails, the return value is one of the following error codes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Error code</th>
<th align=left width=45%>Description</th>
</tr>
<tr valign=top>
<td width=55%>ERROR_BEGINNING_OF_MEDIA</td>
<td width=45%>An attempt to access data before the beginning-of-medium marker failed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_BUS_RESET</td>
<td width=45%>A reset condition was detected on the bus.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_END_OF_MEDIA</td>
<td width=45%>The end-of-tape marker was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_FILEMARK_DETECTED</td>
<td width=45%>A filemark was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_SETMARK_DETECTED</td>
<td width=45%>A setmark was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_NO_DATA_DETECTED</td>
<td width=45%>The end-of-data marker was reached during an operation.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_PARTITION_FAILURE</td>
<td width=45%>The tape could not be partitioned.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_INVALID_BLOCK_LENGTH</td>
<td width=45%>The block size is incorrect on a new tape in a multivolume partition.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_DEVICE_NOT_PARTITIONED</td>
<td width=45%>The partition information could not be found when a tape was being loaded.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_MEDIA_CHANGED</td>
<td width=45%>The tape that was in the drive has been replaced or removed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_NO_MEDIA_IN_DRIVE</td>
<td width=45%>There is no media in the drive.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_NOT_SUPPORTED</td>
<td width=45%>The tape driver does not support a requested function.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_UNABLE_TO_LOCK_MEDIA</td>
<td width=45%>An attempt to lock the ejection mechanism failed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_UNABLE_TO_UNLOAD_MEDIA</td>
<td width=45%>An attempt to unload the tape failed.</td>
</tr>
<tr valign=top>
<td width=55%>ERROR_WRITE_PROTECT</td>
<td width=45%>The media is write protected.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The block size range values (maximum and minimum) returned by the <b>GetTapeParameters</b> function called with the <i>dwOperation</i> parameter set to the GET_TAPE_DRIVE_INFORMATION value will indicate system limits, not drive limits. However, it is the tape drive device and the media present in the drive that determine the true block size limits. Thus, an application may not be able to set all the block sizes mentioned in the range obtained by specifying GET_TAPE_DRIVE_INFORMATION in <i>dwOperation. </i></p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="tapeback_0rlc.htm">Tape Backup Overview</a>, <a href="tapeback_1rw3.htm">Tape Backup Functions</a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <a href="tapeback_0lmb.htm"><b>SetTapeParameters</b></a>, <a href="tapeback_7oc2.htm"><b>TAPE_GET_DRIVE_PARAMETERS</b></a>, <a href="tapeback_31pu.htm"><b>TAPE_GET_MEDIA_PARAMETERS</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
