<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Inheritance</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_inheritance"></a>Inheritance</h3>
<p>
A child process can inherit several properties and resources from its parent process. You can also prevent a child process from inheriting properties from its parent process. The following can be inherited: 
<ul>
<li>
Open handles returned by the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function. This includes handles to files, console input buffers, console screen buffers, named pipes, serial communication devices, and mailslots. </li>
<li>
Open handles to process, thread, mutex, event, semaphore, named-pipe, anonymous-pipe, and file-mapping objects. </li>
<li>
Environment variables. </li>
<li>
The current directory. </li>
<li>
The console, unless the process is detached or a new console is created. A child console process also inherits the parent's standard handles, as well as access to the input buffer and the active screen buffer. </li>
</ul>
<p>
The child process does not inherit the following: 
<ul>
<li>
Priority class. </li>
<li>
Handles returned by <a href="memman_2fxf.htm"><b>LocalAlloc</b></a>, <a href="memman_66qr.htm"><b>GlobalAlloc</b></a>, <a href="memman_5z6t.htm"><b>HeapCreate</b></a>, and <a href="memman_6krn.htm"><b>HeapAlloc</b></a>. </li>
<li>
Pseudo handles, as in the handles returned by the <a href="prothred_58kz.htm"><b>GetCurrentProcess</b></a> or <a href="prothred_8mn8.htm"><b>GetCurrentThread</b></a><b> </b>function. These handles are valid only for the calling process. </li>
<li>
DLL module handles returned by the <a href="dll_1o8p.htm"><b>LoadLibrary</b></a><b> </b>function. </li>
<li>
GDI or USER handles, such as <b>HBITMAP</b> or <b>HMENU</b>. </li>
</ul>
<h4>Inheriting Handles</h4>
<p>
To cause a handle to be inherited, you must do two things:
<ul>
<li>
Specify that the handle is to be inherited when you create, open, or duplicate the handle.</li>
<li>
Specify that inheritable handles are to be inherited when you call the <a href="prothred_9dpv.htm"><b>CreateProcess</b></a> function.</li>
</ul>
<p>
This allows a child process to inherit some of its parent's handles, but not inherit others. For example, creation functions such as <b>CreateProcess</b> and <a href="filesio_7wmd.htm"><b>CreateFile</b></a> take a security attributes argument that determines whether the handle can be inherited. Open functions such as <a href="synchro_82pk.htm"><b>OpenMutex</b></a> and <a href="synchro_5myc.htm"><b>OpenEvent</b></a> take a handle inheritance flag that determines whether the handle can be inherited. The <a href="handobj_2pyd.htm"><b>DuplicateHandle</b></a> function takes a handle inheritance flag that determines whether the handle can be inherited. </p>
<p>
When a child process is created, the <i>fInheritHandles</i> parameter of <a href="prothred_9dpv.htm"><b>CreateProcess</b></a> determines whether the inheritable handles of the parent process are inherited by the child process. An inherited handle refers to the same object in the child process as it does in the parent process. It also has the same value and access privileges. Therefore, when one process changes the state of the object, the change affects both processes. To use a handle, the child process must retrieve the handle value and "know" the object to which it refers. Usually, the parent process communicates this information to the child process through its command line, environment block, or some form of <a href="ipc_57qr.htm">interprocess communication</a>. </p>
<p>
The <b>DuplicateHandle</b> function is useful if a process has an inheritable open handle that you do not want to be inherited by the child process. In this case, use <b>DuplicateHandle</b> to open a duplicate of the handle that cannot be inherited, then use the <a href="handobj_289x.htm"><b>CloseHandle</b></a> function to close the inheritable handle. You can also use the <b>DuplicateHandle</b> function to open an inheritable duplicate of a handle that cannot be inherited. </p>
<h4>Inheriting Environment Variables</h4>
<p>
A child process inherits the environment variables of its parent process by default. However, <a href="prothred_9dpv.htm"><b>CreateProcess</b></a> enables the parent process to specify a different block of environment variables. For more information, see <a href="prothred_89f7.htm">Environment Variables</a>. </p>
<h4>Inheriting the Current Directory</h4>
<p>
The <a href="filesio_6g6x.htm"><b>GetCurrentDirectory</b></a> function retrieves the current directory of the calling process. A child process inherits the current directory of its parent process by default. However, <b>CreateProcess</b> enables the parent process to specify a different current directory for the child process. To change the current directory of the calling process, use the <a href="filesio_3fg9.htm"><b>SetCurrentDirectory</b></a> function. </p>
<p>&nbsp;</p></body>
</HTML>
