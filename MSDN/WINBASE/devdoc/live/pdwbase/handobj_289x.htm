<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CloseHandle</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_closehandle"></a>CloseHandle</h1>
<p>
The <b>CloseHandle</b> function closes an open object handle. </p>
<pre><code><b>BOOL CloseHandle(
  HANDLE</b><i> hObject</i>   // handle to object to close
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hObject</i></dt>
<dd>
Handle to an open object. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
The <b>CloseHandle</b> function closes handles to the following objects: 
<ul>
<li>
Communications device</li>
<li>
Console input</li>
<li>
Console screen buffer </li>
<li>
Event </li>
<li>
File </li>
<li>
File mapping </li>
<li>
Job</li>
<li>
Mailslot</li>
<li>
Mutex </li>
<li>
Named pipe </li>
<li>
Process </li>
<li>
Semaphore </li>
<li>
Socket</li>
<li>
Thread </li>
<li>
Token </li>
</ul>
<p>
<b>CloseHandle</b> invalidates the specified object handle, decrements the object's handle count, and performs object retention checks. After the last handle to an object is closed, the object is removed from the system. </p>
<p>
Closing a thread handle does not terminate the associated thread. To remove a thread object, you must terminate the thread, then close all handles to the thread.</p>
<p>
Use <b>CloseHandle</b> to close handles returned by calls to the <b>CreateFile</b> function. Use <b>FindClose</b> to close handles returned by calls to the <b>FindFirstFile</b> function.</p>
<p>
Closing an invalid handle raises an exception. This includes closing a handle twice, not checking the return value and closing an invalid handle, and using <b>CloseHandle</b> on a handle returned by <b>FindFirstFile</b>.</p>
<p>
<b>Windows CE:</b> Windows CE does not support closing handles to the following objects:
<ul>
<li>
Console input or output </li>
<li>
File mapping</li>
<li>
Named pipe </li>
<li>
Semaphore </li>
<li>
Token </li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="handobj_8y2b.htm">Handles and Objects Overview</a>, <a href="handobj_4pdf.htm">Handle and Object Functions</a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <a href="filesio_5n8l.htm"><b>DeleteFile</b></a>, <a href="filesio_45d1.htm"><b>FindClose</b></a>, <a href="filesio_4qcl.htm"><b>FindFirstFile</b></a></p>
<p>&nbsp;</p></body>
</HTML>
