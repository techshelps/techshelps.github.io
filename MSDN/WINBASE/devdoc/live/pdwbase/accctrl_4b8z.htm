<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Access Tokens</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_access_tokens"></a>Access Tokens</h2>
<p>
An access token is an object that describes the security context of a process or thread. The information in a token includes the identity and privileges of the user account associated with the process or thread. When a user logs on, the system verifies the user's password by comparing it with information stored in a security database. If the password is authenticated, the system produces an access token. Every process executed on behalf of this user has a copy of this access token.</p>
<p>
The system uses an access token to identify the user when a thread interacts with a <a href="accctrl_499v.htm">securable object</a> or tries to perform a system task that requires privileges. Access tokens contain the following information: 
<ul>
<li>
The <a href="accctrl_38yn.htm">security identifier (SID)</a> for the user's account</li>
<li>
SIDs for the groups of which the user is a member</li>
<li>
A logon SID that identifies the current logon session</li>
<li>
A list of the <a href="accctrl_42pf.htm">privileges</a> held by either the user or the user's groups </li>
<li>
An owner SID </li>
<li>
The SID for the primary group </li>
<li>
The default <a href="accctrl_1jj3.htm">DACL</a> that the system uses when the user creates a securable object without specifying a security descriptor</li>
<li>
The source of the access token </li>
<li>
Whether the token is a primary or <a href="accclsrv_690u.htm">impersonation</a> token </li>
<li>
An optional list of <a href="accctrl_9d9v.htm">restricting SIDs</a> </li>
<li>
Current impersonation levels </li>
<li>
Other statistics </li>
</ul>
<p>
Every process has a primary token that describes the security context of the user account associated with the process. By default, the system uses the primary token when a thread of the process interacts with a securable object. However, a thread can impersonate a client account. This allows the thread to interact with securable objects using the client's security context. A thread that is impersonating a client has both a primary token and an impersonation token. Use the <a href="accctrl_0zam.htm"><b>OpenProcessToken</b></a> function to retrieve a handle to the primary token of a process. Use the <a href="accctrl_8bam.htm"><b>OpenThreadToken</b></a> function to retrieve a handle to the impersonation token of a thread. For more information, see <a href="accclsrv_690u.htm">Impersonation</a>. </p>
<p>
You can use the following functions to manipulate access tokens. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Function</th>
<th align=left width=67%>Description</th>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_4iur.htm"><b>AdjustTokenGroups</b></a><b> </b></td>
<td width=67%>Changes the group information in an access token.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_6xbn.htm"><b>AdjustTokenPrivileges</b></a><b> </b></td>
<td width=67%>Enables or disables the privileges in an access token. It does not grant new privileges or revoke existing ones.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_0oxc.htm"><b>CheckTokenMembership</b></a></td>
<td width=67%>Determines whether a specified SID is enabled in a specified access token.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_1h9q.htm"><b>CreateRestrictedToken</b></a></td>
<td width=67%>Creates a new token that is a restricted version of an existing token. The restricted token can have disabled SIDs, deleted privileges, and a list of restricting SIDs.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_91da.htm"><b>DuplicateToken</b></a></td>
<td width=67%>Creates a new impersonation token that duplicates an existing token.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_9vso.htm"><b>DuplicateTokenEx</b></a></td>
<td width=67%>Creates a new primary token or impersonation token that duplicates an existing token.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_2jvy.htm"><b>GetTokenInformation</b></a><b> </b></td>
<td width=67%>Retrieves information about a token. </td>
</tr>
<tr valign=top>
<td width=33%><b><u>IsTokenRestricted</u> </b></td>
<td width=67%>Determines whether a token has a list of restricting SIDs.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_0zam.htm"><b>OpenProcessToken</b></a><b> </b></td>
<td width=67%>Retrieves a handle to the primary access token for a process.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_8bam.htm"><b>OpenThreadToken</b></a><b> </b></td>
<td width=67%>Retrieves a handle to the impersonation access token for a thread.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_5z5a.htm"><b>SetThreadToken</b></a></td>
<td width=67%>Assigns or removes an impersonation token for a thread.</td>
</tr>
<tr valign=top>
<td width=33%><a href="accctrl_9j5a.htm"><b>SetTokenInformation</b></a><b> </b></td>
<td width=67%>Changes a token's owner, primary group, or default DACL.</td>
</tr>
</table><br>
<p>
The access token functions use the following structures to describe the components of an access token.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Structure</th>
<th align=left width=54%>Specifies</th>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_03qq.htm"><b>TOKEN_CONTROL</b></a></td>
<td width=54%>Information that identifies an access token.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_8m42.htm"><b>TOKEN_DEFAULT_DACL</b></a></td>
<td width=54%>The default DACL that the system uses in the security descriptors of new objects created by a thread using this access token.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_2eia.htm"><b>TOKEN_GROUPS</b></a></td>
<td width=54%>Specifies the SIDs and attributes of the group SIDs in an access token.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_86ia.htm"><b>TOKEN_OWNER</b></a></td>
<td width=54%>The default owner SID for the security descriptors of new objects.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_0oz6.htm"><b>TOKEN_PRIMARY_GROUP</b></a></td>
<td width=54%>The default primary group SID for the security descriptors of new objects.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_5436.htm"><b>TOKEN_PRIVILEGES</b></a></td>
<td width=54%>The privileges associated with an access token and whether the privileges are enabled.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_07zm.htm"><b>TOKEN_SOURCE</b></a></td>
<td width=54%>The source of an access token.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_7n5e.htm"><b>TOKEN_STATISTICS</b></a></td>
<td width=54%>Statistics associated with an access token.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_18qa.htm"><b>TOKEN_USER</b></a></td>
<td width=54%>The SID of the user associated with an access token.</td>
</tr>
</table><br>
<p>
The access token functions use the following enumeration types.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Enumeration Type</th>
<th align=left width=54%>Specifies</th>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_6xde.htm"><b>TOKEN_INFORMATION_CLASS</b></a></td>
<td width=54%>Identifies the type of information being set or retrieved from an access token.</td>
</tr>
<tr valign=top>
<td width=46%><a href="accctrl_1r3m.htm"><b>TOKEN_TYPE</b></a></td>
<td width=54%>Identifies an access token as a primary or impersonation token.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
