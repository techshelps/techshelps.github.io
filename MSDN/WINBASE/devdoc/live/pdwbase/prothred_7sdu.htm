<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>STARTUPINFO</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_startupinfo_str"></a>STARTUPINFO</h1>
<p>
The <b>STARTUPINFO</b> structure is used with the <a href="prothred_9dpv.htm"><b>CreateProcess</b></a> function to specify main window properties if a new window is created for the new process. For graphical user interface (GUI) processes, this information affects the first window created by the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createwindow">
</object><a href=JavaScript:alink_1.Click()><b>CreateWindow</b></a> function and shown by the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_showwindow">
</object><a href=JavaScript:alink_2.Click()><b>ShowWindow</b></a> function. For console processes, this information affects the console window if a new console is created for the process. A process can use the <a href="prothred_2x9r.htm"><b>GetStartupInfo</b></a> function to retrieve the <b>STARTUPINFO</b> structure specified when the process was created. </p>
<pre><code>typedef struct _STARTUPINFO { // si 
    DWORD   cb; 
    LPTSTR  lpReserved; 
    LPTSTR  lpDesktop; 
    LPTSTR  lpTitle; 
    DWORD   dwX; 
    DWORD   dwY; 
    DWORD   dwXSize; 
    DWORD   dwYSize; 
    DWORD   dwXCountChars; 
    DWORD   dwYCountChars; 
    DWORD   dwFillAttribute; 
    DWORD   dwFlags; 
    WORD    wShowWindow; 
    WORD    cbReserved2; 
    LPBYTE  lpReserved2; 
    HANDLE  hStdInput; 
    HANDLE  hStdOutput; 
    HANDLE  hStdError; 
} STARTUPINFO, *LPSTARTUPINFO; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cb</b></dt>
<dd>
Specifies the size, in bytes, of the structure. </dd>
<dt>
<b>lpReserved</b></dt>
<dd>
Reserved. Set this member to NULL before passing the structure to <b>CreateProcess</b>. </dd>
<dt>
<b>lpDesktop</b></dt>
<dd>
<b>Windows NT:</b> Pointer to a zero-terminated string that specifies either the name of the desktop only or the name of both the desktop and window station for this process. A backslash in the string pointed to by <b>lpDesktop</b> indicates that the string includes both desktop and window station names. If <b>lpDesktop</b> is NULL, the new process inherits the desktop and window station of its parent process. If <b>lpDesktop</b> is an empty string, the process does not inherit the desktop and window station of its parent process; instead, the system determines if a new desktop and window station need to be created. If the impersonated user already has a desktop, the system will use the existing desktop. </dd>
<dt>
<b>lpTitle</b></dt>
<dd>
For console processes, this is the title displayed in the title bar if a new console window is created. If NULL, the name of the executable file is used as the window title instead. This parameter must be NULL for GUI or console processes that do not create a new console window. </dd>
<dt>
<b>dwX, dwY</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USEPOSITION. Specifies the x and y offsets, in pixels, of the upper left corner of a window if a new window is created. The offsets are from the upper left corner of the screen. For GUI processes, the specified position is used the first time the new process calls <b>CreateWindow</b> to create an overlapped window if the <i>x</i> parameter of <b>CreateWindow</b> is CW_USEDEFAULT. </dd>
<dt>
<b>dwXSize, dwYSize</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USESIZE. Specifies the width (<b>dwXSize</b>) and height (<b>dwYSize</b>), in pixels, of the window if a new window is created. For GUI processes, this is used only the first time the new process calls <b>CreateWindow</b> to create an overlapped window if the <i>nWidth</i> parameter of <b>CreateWindow</b> is CW_USEDEFAULT. </dd>
<dt>
<b>dwXCountChars, dwYCountChars</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USECOUNTCHARS. For console processes, if a new console window is created, <b>dwXCountChars </b>specifies the screen buffer width in character columns, and <b>dwYCountChars</b> specifies the screen buffer height in character rows. These values are ignored in GUI processes. </dd>
<dt>
<b>dwFillAttribute</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USEFILLATTRIBUTE. Specifies the initial text and background colors if a new console window is created in a console application. These values are ignored in GUI applications. This value can be any combination of the following values: FOREGROUND_BLUE, FOREGROUND_GREEN, FOREGROUND_RED, FOREGROUND_INTENSITY, BACKGROUND_BLUE, BACKGROUND_GREEN, BACKGROUND_RED, and BACKGROUND_INTENSITY. For example, the following combination of values produces red text on a whilte background:
</dd>
</dl>
<pre><code>FOREGROUND_RED | BACKGROUND_RED | BACKGROUND_GREEN | BACKGROUND_BLUE
 </code></pre>
<dl>
<dt>
<b>dwFlags</b></dt>
<dd>
This is a bit field that determines whether certain <b>STARTUPINFO</b> members are used when the process creates a window. Any combination of the following values can be specified: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=50%>Value</th>
<th align=left width=50%>Meaning</th>
</tr>
<tr valign=top>
<td width=50%>STARTF_USESHOWWINDOW</td>
<td width=50%>If this value is not specified, the <b>wShowWindow</b> member is ignored.</td>
</tr>
<tr valign=top>
<td width=50%>STARTF_USEPOSITION</td>
<td width=50%>If this value is not specified, the <b>dwX</b> and <b>dwY</b> members are ignored.</td>
</tr>
<tr valign=top>
<td width=50%>STARTF_USESIZE</td>
<td width=50%>If this value is not specified, the <b>dwXSize</b> and <b>dwYSize</b> members are ignored.</td>
</tr>
<tr valign=top>
<td width=50%>STARTF_USECOUNTCHARS</td>
<td width=50%>If this value is not specified, the <b>dwXCountChars</b> and <b>dwYCountChars</b> members are ignored.</td>
</tr>
<tr valign=top>
<td width=50%>STARTF_USEFILLATTRIBUTE</td>
<td width=50%>If this value is not specified, the <b>dwFillAttribute</b> member is ignored.</td>
</tr>
<tr valign=top>
<td width=50%>STARTF_FORCEONFEEDBACK</td>
<td width=50%>If this value is specified, the cursor is in feedback mode for two seconds after <b>CreateProcess</b> is called. If during those two seconds the process makes the first GUI call, the system gives five more seconds to the process. If during those five seconds the process shows a window, the system gives five more seconds to the process to finish drawing the window.</td>
</tr>
<tr valign=top>
<td width=50%></td>
<td width=50%>The system turns the feedback cursor off after the first call to <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getmessage">
</object><a href=JavaScript:alink_3.Click()><b>GetMessage</b></a>, regardless of whether the process is drawing.</td>
</tr>
<tr valign=top>
<td width=50%></td>
<td width=50%>For more information on feedback, see the following Remarks section.</td>
</tr>
<tr valign=top>
<td width=50%>STARTF_FORCEOFFFEEDBACK</td>
<td width=50%>If specified, the feedback cursor is forced off while the process is starting. The normal cursor is displayed. For more information on feedback, see the following Remarks section.</td>
</tr>
<tr valign=top>
<td width=50%>STARTF_USESTDHANDLES</td>
<td width=50%>If this value is specified, sets the standard input of the process, standard output, and standard error handles to the handles specified in the <b>hStdInput</b>, <b>hStdOutput</b>, and <b>hStdError</b> members of the <b>STARTUPINFO</b> structure. The <b>CreateProcess</b> function's <i>fInheritHandles</i> parameter must be set to TRUE for this to work properly.</td>
</tr>
<tr valign=top>
<td width=50%></td>
<td width=50%>If this value is not specified, the <b>hStdInput</b>, <b>hStdOutput</b>, and <b>hStdError</b> members of the <b>STARTUPINFO</b> structure are ignored.</td>
</tr>
</table><br>

</dd>
<dt>
<b>wShowWindow</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USESHOWWINDOW. The <b>wshowWindow</b> member can be any of the SW_ constants defined in WINUSER.H. For GUI processes, <b>wShowWindow</b> specifies the default value the first time <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_showwindow">
</object><a href=JavaScript:alink_4.Click()><b>ShowWindow</b></a> is called. The <i>nCmdShow</i> parameter of <b>ShowWindow</b> is ignored. In subsequent calls to <b>ShowWindow</b>, the <b>wShowWindow</b> member is used if the <i>nCmdShow</i> parameter of <b>ShowWindow</b> is set to SW_SHOWDEFAULT.  </dd>
<dt>
<b>cbReserved2</b></dt>
<dd>
Reserved; must be zero. </dd>
<dt>
<b>lpReserved2</b></dt>
<dd>
Reserved; must be NULL. </dd>
<dt>
<b>hStdInput</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USESTDHANDLES. Specifies a handle that will be used as the standard input handle to the process if STARTF_USESTDHANDLES is specified. </dd>
<dt>
<b>hStdOutput</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USESTDHANDLES. Specifies a handle that will be used as the standard output handle to the process if STARTF_USESTDHANDLES is specified. </dd>
<dt>
<b>hStdError</b></dt>
<dd>
Ignored unless <b>dwFlags</b> specifies STARTF_USESTDHANDLES. Specifies a handle that will be used as the standard error handle to the process if STARTF_USESTDHANDLES is specified. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
If a GUI process is being started and neither STARTF_FORCEONFEEDBACK or STARTF_FORCEOFFFEEDBACK is specified, the process feedback cursor is used. A GUI process is one whose subsystem is specified as "windows." </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined as Unicode and ANSI structures.</p>
<h4>See Also</h4>
<p>
<a href="prothred_86sz.htm">Processes and Threads Overview</a>, <a href="prothred_9nzn.htm">Process and Thread Structures</a>, <a href="prothred_9dpv.htm"><b>CreateProcess</b></a>, <a href="prothred_6pf6.htm"><b>CreateProcessAsUser</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createwindow">
</object><a href=JavaScript:alink_5.Click()><b>CreateWindow</b></a>, <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getmessage">
</object><a href=JavaScript:alink_6.Click()><b>GetMessage</b></a>, <a href="prothred_2x9r.htm"><b>GetStartupInfo</b></a>, <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_peekmessage">
</object><a href=JavaScript:alink_7.Click()><b>PeekMessage</b></a>, <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_showwindow">
</object><a href=JavaScript:alink_8.Click()><b>ShowWindow</b></a>, <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_winmain">
</object><a href=JavaScript:alink_9.Click()><b>WinMain</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
