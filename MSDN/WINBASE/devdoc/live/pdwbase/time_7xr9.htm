<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Local Time</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_local_time"></a>Local Time</h2>
<p>
While the system uses UTC-based time internally, your applications will generally display the <i>local time —</i><i> </i>the date and time of day for your time zone. Therefore, to ensure correct results, you must be aware of whether a function expects to receive a UTC-based time or a local time, and whether the function returns a UTC-based time or a local time. </p>
<p>
You can retrieve the local time by using the <a href="time_7rj9.htm"><b>GetLocalTime</b></a> function. <b>GetLocalTime</b> converts the system time to a local time based on the current time-zone settings and copies the result to a <a href="time_6sfm.htm"><b>SYSTEMTIME</b></a> structure. You can set the system time by using the <a href="time_85gl.htm"><b>SetLocalTime</b></a> function. <b>SetLocalTime</b> assumes you have specified a local time and converts to UTC before setting the system time. </p>
<p>
<b>Windows NT:</b> When you call <b>SetLocalTime</b>, Windows NT uses the current time zone information, including the Daylight Saving Time setting, to perform the conversion. Note that Windows NT uses the Daylight Saving Time setting of the current time, not the new time you are setting. Therefore, to ensure the correct result, call <b>SetLocalTime</b> again, now that the Daylight Saving Time setting is set for the new time. </p>
<p>
The current time-zone settings control how the system converts between UTC and local time. You can retrieve the current time-zone settings by using the <a href="time_3lim.htm"><b>GetTimeZoneInformation</b></a> function. The function copies the setting to a <a href="time_8bqq.htm"><b>TIME_ZONE_INFORMATION</b></a> structure and returns a value indicating whether local time is currently in standard or daylight-savings time. You can set the time-zone settings by using the <a href="time_7ory.htm"><b>SetTimeZoneInformation</b></a> function.</p>
<p>
To convert a UTC-based time stored in a <b>SYSTEMTIME</b> structure to a local time, use the <a href="time_138l.htm"><b>SystemTimeToTzSpecificLocalTime</b></a> function. <b>SystemTimeToTzSpecifcLocalTime</b> uses the current settings for the time zone and daylight saving time. Therefore, if it is daylight saving time, this function will take daylight saving time into account, even if the time you are converting is in standard time. </p>
<p>&nbsp;</p></body>
</HTML>
