<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UserHandleGrantAccess</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_userhandlegrantaccess"></a>UserHandleGrantAccess</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>UserHandleGrantAccess</b> function grants or denies access to a USER handle to a job that has a user-interface restriction. When access is granted, all processes associated with the job can subsequently recognize and use the handle. When access is denied, the processes can no longer use the handle. For more information see <a href="handobj_5y7n.htm"><b>User Objects</b></a>.</p>
<pre><code><b>BOOL UserHandleGrantAccess(
</b>  <b>HANDLE</b> <i>hUserHandle</i><b>,</b>
  <b>HANDLE</b> <i>hJob</i><b>,</b><i> </i>
<b>  BOOL </b><i>bGrant</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hUserHandle</i></dt>
<dd>
A USER handle.</dd>
<dt>
<i>hJob</i></dt>
<dd>
Handle to the job object to be granted access to the USER handle. The <a href="prothred_0yic.htm"><b>CreateJobObject</b></a> or <a href="prothred_4wxg.htm"><b>OpenJobObject</b></a> function returns this handle. This handle must have the JOB_OBJECT_LIMIT_USER_INTERACTION access right.</dd>
<dt>
<i>bGrant</i></dt>
<dd>
Specifies whether access is to be denied or granted to <i>hUserHandle</i>. If <i>bGrant</i> is TRUE, all processes associated with the job can recognize and use the handle. If <i>bGrant</i> is FALSE, the processes can no longer use the handle. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
The <b>UserHandleGrantAccess</b> function can be called only from a process not associated with the job object specified by the <i>hJob</i> parameter. The USER handle must not be owned by a process or thread associated with the job object. </p>
<p>
To create user-interface restrictions, call the <a href="prothred_3lbo.htm"><b>SetInformationJobObject</b></a> function with the JobObjectBasicUIRestrictions job object information class. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="prothred_86sz.htm">Processes and Threads Overview</a>, <a href="prothred_3mgj.htm">Process and Thread Functions</a>, <a href="prothred_0yic.htm"><b>CreateJobObject</b></a>, <a href="prothred_4wxg.htm"><b>OpenJobObject</b></a>, <a href="prothred_3lbo.htm"><b>SetInformationJobObject</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
