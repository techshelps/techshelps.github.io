<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Named Pipe Type, Read, and Wait Modes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_named_pipe_type_read_and_wait_modes"></a>Named Pipe Type, Read, and Wait Modes</h3>
<p>
The pipe server specifies the pipe type, read, and wait modes in the <i>dwPipeMode</i> parameter of the <a href="pipes_4w6d.htm"><b>CreateNamedPipe</b></a> function. Pipe clients can specify these pipe modes for their pipe handles using the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function. </p>
<h4>Type Mode</h4>
<p>
The type mode of a pipe determines how data is written to a named pipe. Data can be transmitted through a named pipe as either a stream of bytes or as a stream of messages. The pipe server specifies the pipe type when calling <a href="pipes_4w6d.htm"><b>CreateNamedPipe</b></a> to create an instance of a named pipe. The type modes must be the same for all instances of a pipe. </p>
<p>
To create a byte-type pipe, specify PIPE_TYPE_BYTE or use the default value. The data is written to the pipe as a stream of bytes, and the system does not differentiate between the bytes written in different write operations. </p>
<p>
To create a message-type pipe, specify PIPE_TYPE_MESSAGE. The system treats the bytes written in each write operation to the pipe as a message unit. The system always performs write operations on message-type pipes as if write-through mode were enabled. </p>
<h4>Read Mode</h4>
<p>
The read mode of a pipe determines how data is read from a named pipe. The pipe server specifies the initial read mode for a pipe handle when calling <a href="pipes_4w6d.htm"><b>CreateNamedPipe</b></a>. Data can be read in byte-read mode or message-read mode. A handle to a byte-type pipe can be in byte-read mode only. A handle to a message-type pipe can be in either byte-read or message-read mode. For a message-type pipe, the read mode can be different for server and client handles to the same pipe instance. </p>
<p>
To create the pipe handle in byte-read mode, specify PIPE_READMODE_BYTE or use the default value. Data is read from the pipe as a stream of bytes. A read operation is completed successfully when all available bytes in the pipe are read or when the specified number of bytes is read. </p>
<p>
To create the pipe handle in message-read mode, specify PIPE_READMODE_MESSAGE. Data is read from the pipe as a stream of messages. A read operation is completed successfully only when the entire message is read. If the specified number of bytes to read is less than the size of the next message, the function reads as much of the message as possible before returning zero (the <a href="errors_3uwi.htm"><b>GetLastError</b></a> function returns ERROR_MORE_DATA). The remainder of the message can be read using another read operation. </p>
<p>
For a pipe client, a pipe handle returned by <a href="filesio_7wmd.htm"><b>CreateFile</b></a> is always in byte-read mode initially. Both pipe clients and pipe servers can use the <a href="pipes_81r9.htm"><b>SetNamedPipeHandleState</b></a> function to change the read mode of a pipe handle. </p>
<h4>Wait Mode</h4>
<p>
The wait mode of a pipe handle determines how the <a href="filesio_39id.htm"><b>ReadFile</b></a>, <a href="filesio_3kkl.htm"><b>WriteFile</b></a>, and <a href="pipes_3885.htm"><b>ConnectNamedPipe</b></a> functions handle lengthy operations. In blocking-wait mode, the functions wait indefinitely for a process on the other end of the pipe to complete an operation. In nonblocking-wait mode, the functions return immediately in situations that would otherwise require an indefinite wait. </p>
<p>
A <b>ReadFile</b> operation is affected by the wait mode of a pipe handle when the pipe is empty. With a blocking-wait handle, the operation is not completed successfully until data is available from a thread writing to the other end of the pipe. Using a nonblocking-wait handle, the function returns zero immediately, and the <a href="errors_3uwi.htm"><b>GetLastError</b></a> function returns ERROR_NO_DATA. </p>
<p>
A <a href="filesio_3kkl.htm"><b>WriteFile</b></a> operation is affected by the wait mode of a pipe handle when there is insufficient space in the pipe's buffer. With a blocking-wait handle, the write operation cannot succeed until sufficient space is created in the buffer by a thread reading from the other end of the pipe. With a nonblocking-wait handle, the write operation returns a nonzero value immediately, without writing any bytes (for a message-type pipe) or after writing as many bytes as the buffer holds (for a byte-type pipe). </p>
<p>
A <a href="pipes_3885.htm"><b>ConnectNamedPipe</b></a> operation is affected by the wait mode of a pipe handle when there is no client connected or waiting to connect to the pipe instance. With a blocking-wait handle, the connect operation does not succeed until a pipe client connects to the pipe instance by calling either the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> or <a href="pipes_1aed.htm"><b>CallNamedPipe</b></a><b> </b>function. With a nonblocking-wait handle, the connect operation returns zero immediately, and the <b>GetLastError</b> function returns ERROR_PIPE_LISTENING. </p>
<p>
By default, all named pipe handles returned by the <a href="pipes_4w6d.htm"><b>CreateNamedPipe</b></a> or <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function are created with blocking-wait mode enabled. To create the pipe in nonblocking-wait mode, the pipe server specifies PIPE_NOWAIT when calling <b>CreateNamedPipe</b>. </p>
<p>
Both pipe clients and pipe servers can change a pipe handle's wait mode by specifying either PIPE_WAIT or PIPE_NOWAIT in a call to the <a href="pipes_81r9.htm"><b>SetNamedPipeHandleState</b></a> function. </p>
<p>
<b>Note</b>&nbsp;&nbsp;The nonblocking-wait mode is supported for compatibility with Microsoft® LAN Manager version 2.0. This mode should not be used to achieve overlapped input and output (I/O) with named pipes. Overlapped I/O should be used instead, because it enables time-consuming operations to run in the background after the function returns. For more information about overlapped I/O, see <a href="pipes_3bn8.htm">Synchronous and Overlapped Input and Output</a>. </p>
<p>&nbsp;</p></body>
</HTML>
