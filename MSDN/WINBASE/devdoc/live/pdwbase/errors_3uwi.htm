<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetLastError</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getlasterror"></a>GetLastError</h1>
<p>
The <b>GetLastError</b> function returns the calling thread's last-error code value. The last-error code is maintained on a per-thread basis. Multiple threads do not overwrite each other's last-error code. </p>
<pre><b><code>DWORD GetLastError(VOID)
 </code></b></pre>
<h4>Parameters</h4>
<p>
This function has no parameters. </p>
<h4>Return Values</h4>
<p>
The return value is the calling thread's last-error code value. Functions set this value by calling the <a href="errors_48tu.htm"><b>SetLastError</b></a> function. The <b>Return Value</b> section of each reference page notes the conditions under which the function sets the last-error code. </p>
<p>
<b>Windows 95 and Windows 98:</b> Because <b>SetLastError</b> is a 32-bit function only, Win32 functions that are actually implemented in 16-bit code do not set the last-error code. You should ignore the last-error code when you call these functions. They include window management functions, GDI functions, and Multimedia functions. </p>
<h4>Remarks</h4>
<p>
You should call the <b>GetLastError </b>function immediately when a function's return value indicates that such a call will return useful data. That is because some functions call <b>SetLastError</b>(0) when they succeed, wiping out the error code set by the most recently failed function. </p>
<p>
Most functions in the Win32 API that set the thread's last error code value set it when they fail; a few functions set it when they succeed. Function failure is typically indicated by a return value error code such as FALSE, NULL, 0xFFFFFFFF, or –1. Some functions call <b>SetLastError </b>under conditions of success; those cases are noted in each function's reference page.</p>
<p>
Error codes are 32-bit values (bit 31 is the most significant bit). Bit 29 is reserved for application-defined error codes; no system error code has this bit set. If you are defining an error code for your application, set this bit to one. That indicates that the error code has been defined by an application, and ensures that your error code does not conflict with any error codes defined by the system. </p>
<p>
To obtain an error string for system error codes, use the <b>FormatMessage</b> function. For a complete list of error codes, see <a href="../pdref/errlist_9rqr.htm">Error Codes</a> or the SDK header file WINERROR.H.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="errors_8qr7.htm">Errors Overview</a>, <a href="errors_24mr.htm">Error Functions</a>, <a href="strings_0sdh.htm"><b>FormatMessage</b></a><b>, <a href="errors_48tu.htm">SetLastError</a></b>, <a href="errors_8ng8.htm"><b>SetLastErrorEx</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
