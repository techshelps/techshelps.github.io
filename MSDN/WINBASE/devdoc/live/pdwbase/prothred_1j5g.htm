<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AttachThreadInput</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_attachthreadinput"></a>AttachThreadInput</h1>
<p>
The <b>AttachThreadInput</b> function attaches the input processing mechanism of one thread to that of another thread. </p>
<pre><code><b>BOOL AttachThreadInput(
  DWORD</b><i> idAttach</i><b>,    </b>// thread to attach
<b>  DWORD</b><i> idAttachTo</i><b>,  </b>// thread to attach to
<b>  BOOL</b><i> fAttach</i>       // attach or detach
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>idAttach</i></dt>
<dd>
Specifies the identifier of the thread to be attached to another thread. The thread to be attached cannot be a system thread.</dd>
<dt>
<i>idAttachTo</i></dt>
<dd>
Specifies the identifier of the thread to be attached to. This thread cannot be a system thread. 
<p>
A thread cannot attach to itself. Therefore, <i>idAttachTo</i> cannot equal <i>idAttach</i>.
</dd>
<dt>
<i>fAttach</i></dt>
<dd>
Specifies whether to attach or detach the threads. If this parameter is TRUE, the two threads are attached. If the parameter is FALSE, the threads are detached. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. There is no extended error information; do not call <b>GetLastError</b>.</p>
<h4>Remarks</h4>
<p>
Windows created in different threads typically process input independently of each other. That is, they have their own input states (focus, active, capture windows, key state, queue status, and so on), and they are not synchronized with the input processing of other threads. By using the <b>AttachThreadInput</b> function, a thread can attach its input processing to another thread. This also allows threads to share their input states, so they can call the <b>SetFocus</b> function to set the keyboard focus to a window of a different thread. This also allows threads to get key-state information. These capabilities are not generally possible. </p>
<p>
The <b>AttachThreadInput</b> function fails if either of the specified threads does not have a message queue. The system creates a thread's message queue when the thread makes its first call to one of the Win32 USER or GDI functions. The <b>AttachThreadInput</b> function also fails if a journal record hook is installed. Journal record hooks attach all input queues together.</p>
<p>
Note that key state, which can be ascertained by calls to the <b>GetKeyState</b> or <b>GetKeyboardState</b> function, is reset after a call to <b>AttachThreadInput</b>. </p>
<p>
<b>Windows NT:</b> You cannot attach a thread to a thread in another desktop.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="prothred_86sz.htm">Processes and Threads Overview</a>, <a href="prothred_3mgj.htm">Process and Thread Functions</a>, <a href="prothred_4nfo.htm"><b>GetCurrentThreadId</b></a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getkeystate">
</object><a href=JavaScript:alink_1.Click()><b>GetKeyState</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getkeyboardstate">
</object><a href=JavaScript:alink_2.Click()><b>GetKeyboardState</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getwindowthreadprocessid">
</object><a href=JavaScript:alink_3.Click()><b>GetWindowThreadProcessId</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_setfocus">
</object><a href=JavaScript:alink_4.Click()><b>SetFocus</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
