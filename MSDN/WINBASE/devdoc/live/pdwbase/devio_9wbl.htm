<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FSCTL_SET_ZERO_DATA</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_fsctl_set_zero_data"></a>FSCTL_SET_ZERO_DATA</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>FSCTL_SET_ZERO_DATA</b> operation fills a specified range of a file with zeroes. If the file is sparse or compressed, NTFS may deallocate disk space within the file. This operation sets the range of bytes to zeroes without extending the file size. To perform this operation, call the <a href="devio_9quk.htm"><b>DeviceIoControl</b></a><b> </b>function with the following parameters.</p>
<pre><code><b>BOOL DeviceIoControl(
</b>  (<b>HANDLE</b>) <i>hDevice</i>,        // handle to a file
  <i>FSCTL_SET_ZERO_DATA</i>,     // <i>dwIoControlCode,</i> control code of
                           // operation to perform
  (<b>LPVOID</b>) <i>lpInBuffer</i>,     // pointer to buffer with input data
  (<b>DWORD</b>) <i>nInBufferSize</i>,   // size, in bytes, of <i>lpInBuffer</i>
  NULL,                    // <i>lpOutBuffer</i> is not used; must be NULL
  0,                       // <i>nOutBufferSize</i> is not used;
                           // must be zero
  (<b>LPDWORD</b>)<i> lpBytesReturned</i>,   // pointer to variable to receive
                           // output byte count
  (<b>LPOVERLAPPED</b>) <i>lpOverlapped</i>  // pointer to <b>OVERLAPPED</b> structure
                           // for asynchronous operation
<b>);</b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDevice</i></dt>
<dd>
Handle to the file on which the operation is to be performed. The file must be on an NTFS 5.0 file system or later. Call the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function to obtain a file handle. This operation cannot be called with any object other than a file.</dd>
<dt>
<i>dwIoControlCode</i></dt>
<dd>
Control code for the operation. This value identifies the specific operation to be performed and the type of device on which the operation is to be performed. Use <b>FSCTL_SET_ZERO_DATA</b> for this operation.</dd>
<dt>
<i>lpInBuffer</i></dt>
<dd>
Pointer to a <a href="devio_4gky.htm"><b>FILE_ZERO_DATA_INFORMATION</b></a> structure that specifies the range of the file to set to zeroes. The <b>FileOffset</b> member is the byte offset of the first byte to set to zeroes, and the <b>BeyondFinalZero</b> member is the byte offset of the first byte beyond the last zeroed byte. </dd>
<dt>
<i>nInBufferSize</i></dt>
<dd>
Size, in bytes, of the input buffer.</dd>
<dt>
<i>lpOutBuffer</i></dt>
<dd>
Pointer to the output buffer. Not used; must be NULL</dd>
<dt>
<i>nOutBufferSize</i></dt>
<dd>
Size, in bytes, of the output buffer. Not used; must be zero.</dd>
<dt>
<i>lpBytesReturned</i></dt>
<dd>
Pointer to a DWORD variable.
<p>
If <i>lpOverlapped</i> is NULL (nonoverlapped I/O), <i>lpBytesReturned</i> is used internally and cannot be NULL.

<p>
If <i>lpOverlapped</i> is not NULL (overlapped I/O), <i>lpBytesReturned</i> can be NULL.
</dd>
<dt>
<i>lpOverlapped</i></dt>
<dd>
Pointer to an <a href="synchro_8tf6.htm"><b>OVERLAPPED</b></a> structure. 
<p>
If <i>hDevice</i> was opened with the FILE_FLAG_OVERLAPPED flag, this parameter must point to a valid <b>OVERLAPPED</b> structure. In this case, <a href="devio_9quk.htm"><b>DeviceIoControl</b></a> is performed as an overlapped (asynchronous) operation. If the device was opened with the FILE_FLAG_OVERLAPPED flag and <i>lpOverlapped</i> is NULL, the function fails in unpredictable ways.

<p>
If <i>hDevice</i> was opened without specifying the FILE_FLAG_OVERLAPPED flag, this parameter is ignored and the <b>DeviceIoControl</b> function does not return until the operation has been completed, or until an error occurs. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the operation succeeds, <a href="devio_9quk.htm"><b>DeviceIoControl</b></a> returns a nonzero value.</p>
<p>
If the operation fails, <b>DeviceIoControl</b> returns zero. For extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
For the implications of overlapped I/O on this operation, see the Remarks section of the DeviceIoControl topic. </p>
<p>
If you use the <b>WriteFile</b> function to write zeroes to a sparse file, the file system allocates disk space for the data that you are writing. If you use the <b>FSCTL_SET_ZERO_DATA</b> operation to write zeroes to a sparse file and the zeroed region is large enough, the file system may not allocate disk space.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winioctl.h.</p>
<h4>See Also</h4>
<p>
<a href="devio_23ec.htm">Device Input and Output Overview</a>, <a href="devio_5gqb.htm">Device Input and Output Operations</a>, <a href="devio_9quk.htm"><b>DeviceIoControl</b></a>, <a href="devio_4gky.htm"><b>FILE_ZERO_DATA_INFORMATION</b></a>, <a href="devio_056b.htm"><b>FSCTL_QUERY_ALLOCATED_RANGES</b></a>, <a href="devio_5351.htm"><b>FSCTL_SET_SPARSE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
