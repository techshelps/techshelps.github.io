<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DdeCallback</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ddecallback"></a>DdeCallback</h1>
<p>
The <b>DdeCallbackProc</b> function is an application-defined callback function used with the <a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library</a> (DDEML) functions. It processes dynamic data exchange (DDE) transactions. The <b>PFNCALLBACK</b> type defines a pointer to this callback function. <b>DdeCallback</b> is a placeholder for the application-defined function name. </p>
<pre><code><b>HDDEDATA CALLBACK DdeCallback(
  UINT</b><i> uType</i><b>,     </b>// transaction type
<b>  UINT</b><i> uFmt</i><b>,      </b>// clipboard data format
<b>  HCONV</b><i> hconv</i><b>,    </b>// handle to the conversation
<b>  HSZ</b><i> hsz1</i><b>,       </b>// handle to a string
<b>  HSZ</b><i> hsz2</i><b>,       </b>// handle to a string
<b>  HDDEDATA</b><i> hdata</i><b>, </b>// handle to a global memory object
<b>  DWORD</b><i> dwData1</i><b>,  </b>// transaction-specific data
<b>  DWORD</b><i> dwData2</i>   // transaction-specific data
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>uType</i></dt>
<dd>
Specifies the type of the current transaction. This parameter consists of a combination of transaction class flags and transaction type flags. The following table describes each of the transaction classes and provides a list of the transaction types in each class. For information about a specific transaction type, see the individual description of that type. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Class</th>
<th align=left width=59%>Meaning</th>
</tr>
<tr valign=top>
<td width=41%>XCLASS_BOOL</td>
<td width=59%>A DDE callback function should return TRUE or FALSE when it finishes processing a transaction that belongs to this class. The XCLASS_BOOL transaction class consists of the following types:</td>
</tr>
<tr valign=top>
<td width=41%> </td>
<td width=59%><br>
XTYP_ADVSTART<br>
XTYP_CONNECT<br>
</td>
</tr>
<tr valign=top>
<td width=41%>XCLASS_DATA</td>
<td width=59%>A DDE callback function should return a DDE handle, the CBR_BLOCK return code, or NULL when it finishes processing a transaction that belongs to this class. The XCLASS_DATA transaction class consists of the following types:</td>
</tr>
<tr valign=top>
<td width=41%> </td>
<td width=59%><br>
XTYP_ADVREQ<br>
XTYP_REQUEST<br>
XTYP_WILDCONNECT<br>
</td>
</tr>
<tr valign=top>
<td width=41%>XCLASS_FLAGS</td>
<td width=59%>A DDE callback function should return DDE_FACK, DDE_FBUSY, or DDE_FNOTPROCESSED when it finishes processing a transaction that belongs to this class. The XCLASS_FLAGS transaction class consists of the following types:</td>
</tr>
<tr valign=top>
<td width=41%> </td>
<td width=59%><br>
XTYP_ADVDATA<br>
XTYP_EXECUTE<br>
XTYP_POKE<br>
</td>
</tr>
<tr valign=top>
<td width=41%>XCLASS_NOTIFICATION</td>
<td width=59%>The transaction types that belong to this class are for notification purposes only. The return value from the callback function is ignored. The XCLASS_NOTIFICATION transaction class consists of the following types:<p>
XTYP_ADVSTOP<br>
XTYP_CONNECT_CONFIRM<br>
XTYP_DISCONNECT<br>
XTYP_ERROR<br>
XTYP_MONITOR<br>
XTYP_REGISTER<br>
XTYP_XACT_COMPLETE<br>
XTYP_UNREGISTER</p>
</td>
</tr>
</table><br>

</dd>
<dt>
<i>uFmt</i></dt>
<dd>
Specifies the format in which data is sent or received. </dd>
<dt>
<i>hconv</i></dt>
<dd>
Handle to the conversation associated with the current transaction. </dd>
<dt>
<i>hsz1</i></dt>
<dd>
Handle to a string. The meaning of this parameter depends on the type of the current transaction. For the meaning of this parameter, see the description of the transaction type. </dd>
<dt>
<i>hsz2</i></dt>
<dd>
Handle to a string. The meaning of this parameter depends on the type of the current transaction. For the meaning of this parameter, see the description of the transaction type. </dd>
<dt>
<i>hdata</i></dt>
<dd>
Handle to DDE data. The meaning of this parameter depends on the type of the current transaction. For the meaning of this parameter, see the description of the transaction type. </dd>
<dt>
<i>dwData1</i></dt>
<dd>
Specifies transaction-specific data. For the meaning of this parameter, see the description of the transaction type. </dd>
<dt>
<i>dwData2</i></dt>
<dd>
Specifies transaction-specific data. For the meaning of this parameter, see the description of the transaction type. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
The return value depends on the transaction class. For more information about the return values, see descriptions of the individual transaction types. </p>
<h4>Remarks</h4>
<p>
The callback function is called asynchronously for transactions that do not involve the creation or termination of conversations. An application that does not frequently accept incoming messages will have reduced DDE performance because the DDEML uses messages to initiate transactions. </p>
<p>
An application must register the callback function by specifying a pointer to the function in a call to the <b>DdeInitialize</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ddeml.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>User-defined.</p>
<h4>See Also</h4>
<p>
<a href="ddemlib_743d.htm">Dynamic Data Exchange Management Library Overview</a>, <a href="ddemlib_1nn7.htm">Dynamic Data Exchange Management Functions</a>, <a href="ddemlib_8wtn.htm"><b>DdeEnableCallback</b></a>, <a href="ddemlib_2v6t.htm"><b>DdeInitialize</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
