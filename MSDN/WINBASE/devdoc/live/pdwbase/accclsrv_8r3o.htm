<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetAccessPermissionsForObject</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getaccesspermissionsforobject"></a>GetAccessPermissionsForObject</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>GetAccessPermissionsForObject</b> function determines the access rights supported by a specified object. </p>
<pre><code><b>DWORD GetAccessPermissionsForObject(
  LPCTSTR</b><i> lpObject</i><b>,    </b>// name of the object
<b>  SE_OBJECT_TYPE</b><i> ObjectType</i><b>,</b>
<b>                       </b>// type of object
<b>  LPCTSTR</b><i> lpProvider</i><b>,  </b>// name of provider to handle request
<b>  PULONG</b><i> pcEntries</i><b>,    </b>// receives number of entries in the array
<b>  PACTRL_ACCESS_INFO</b><i> *ppAccessInfoList</i><b>,</b>
<b>                       </b>// receives an array of access information
<b>  PULONG</b><i> pfAccessFlags </i>// receives access flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpObject</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the object for which to get the list of supported access rights. For descriptions of the string formats for the different object types, see <a href="accctrl_90xe.htm"><b>SE_OBJECT_TYPE</b></a>. </dd>
<dt>
<i>ObjectType</i></dt>
<dd>
Specifies a value from the <b>SE_OBJECT_TYPE</b> enumeration that indicates the type of object named by the <i>lpObject</i> parameter.</dd>
<dt>
<i>lpProvider</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the provider to handle the request. If this parameter is NULL, the system determines the proper provider to handle the request.</dd>
<dt>
<i>pcEntries</i></dt>
<dd>
Pointer to a <b>ULONG</b> value that receives the number of entries returned in the <i>ppAccessInfoList</i> array.</dd>
<dt>
<i>ppAccessInfoList</i></dt>
<dd>
Pointer to a variable that receives a pointer to an array of <a href="accctrl_5piq.htm"><b>ACTRL_ACCESS_INFO</b></a> structures. Each entry identifies an access right supported by the object. Call the <a href="memman_2339.htm"><b>LocalFree</b></a> function to free the returned buffer.</dd>
<dt>
<i>pfAccessFlags</i></dt>
<dd>
Pointer to a <b>ULONG</b> value that can receive the following access flag.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=15%>Value</th>
<th align=left colspan=2 width=85%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=79%>ACTRL_ACCESS_SUPPORTS_OBJECT_ENTRIES</td>
<td width=21%></td>
</tr>
<tr valign=top>
<td width=15%></td>
<td colspan=2 width=85%>The object's provider supports setting access-control entries on the object's properties, and it also supports propagating inherited entries to child objects.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>
If the function fails, the return value can be one of the following error codes. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=50%>Value</th>
<th align=left width=50%>Meaning</th>
</tr>
<tr valign=top>
<td width=50%>ERROR_BAD_PROVIDER</td>
<td width=50%>The <i>lpProvider</i> parameter specified an invalid provider name.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_INVALID_PARAMETER</td>
<td width=50%>An invalid parameter was specified.</td>
</tr>
<tr valign=top>
<td width=50%>ERROR_NOT_ENOUGH_MEMORY</td>
<td width=50%>A memory allocation failed.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>GetAccessPermissionsForObject</b> function returns an array of <a href="accctrl_5piq.htm"><b>ACTRL_ACCESS_INFO</b></a> structures to indicate the access rights an object supports. For example, the array for an SE_FILE_OBJECT object type might include the following access rights and string descriptions.</p>
<pre><code>{ACTRL_SYNCHRONIZE, "Synchronize"},
{ACTRL_CHANGE_OWNER, "Change Owner"},
{ACTRL_CHANGE_ACCESS, "Change Access"},
…
{ACTRL_FILE_READ, "Read File"},
{ACTRL_FILE_WRITE, "Write File"}
…</code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in aclapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="accclsrv_64vg.htm">Client/Server Access Control Overview</a>, <a href="accclsrv_0hv7.htm">Client/Server Access Control Functions</a>, <a href="accctrl_5piq.htm"><b>ACTRL_ACCESS_INFO</b></a>, <a href="accctrl_90xe.htm"><b>SE_OBJECT_TYPE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
