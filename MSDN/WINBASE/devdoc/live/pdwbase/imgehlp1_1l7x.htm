<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MapFileAndCheckSum</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mapfileandchecksum"></a>MapFileAndCheckSum</h1>
<p>
The <b>MapFileAndCheckSum</b> function computes the checksum of the specified file.</p>
<pre><code><b>ULONG MapFileAndCheckSum(
  IN LPTSTR</b><i> Filename</i><b>,      </b>
<b>  OUT LPDWORD</b><i> HeaderSum</i><b>,  </b>
<b>  OUT LPDWORD</b><i> CheckSum    </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Filename</i></dt>
<dd>
Pointer to a null-terminated string that specifies the filename of the file for which the checksum is to be computed.</dd>
<dt>
<i>HeaderSum</i></dt>
<dd>
Pointer to a variable that receives the original checksum from the image file, or zero if there is an error.</dd>
<dt>
<i>CheckSum</i></dt>
<dd>
Pointer to the variable that receives the computed checksum.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is CHECKSUM_SUCCESS.</p>
<p>
If the function fails, the return value is one of the following:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=51%>Value</th>
<th align=left width=49%>Meaning</th>
</tr>
<tr valign=top>
<td width=51%>CHECKSUM_OPEN_FAILURE </td>
<td width=49%>Could not open the file.</td>
</tr>
<tr valign=top>
<td width=51%>CHECKSUM_MAP_FAILURE </td>
<td width=49%>Could not create the file mapping for the file.</td>
</tr>
<tr valign=top>
<td width=51%>CHECKSUM_MAPVIEW_FAILURE </td>
<td width=49%>Could not map a view of the file.</td>
</tr>
<tr valign=top>
<td width=51%>CHECKSUM_UNICODE_FAILURE </td>
<td width=49%>Could not convert the filename to UNICODE.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>MapFileAndCheckSum</b> function computes a new checksum for the file and returns it in the <i>CheckSum</i> parameter. This function is used by any application that creates or modifies an executable image. Checksums are required for Windows NT kernel mode drivers and some system DLLs. The linker computes the original checksum at link time, if you use the appropriate linker switch. For more details, see your linker documentation.</p>
<p>
It is recommended that all images have valid checksums. It is the caller's responsibility to place the newly computed checksum into the mapped image and update the on-disk image of the file.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in imagehlp.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use imagehlp.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="imgehlp1_3hzz.htm">PE Image Helper (ImageHlp) Overview</a>, <a href="imgehlp1_9coj.htm">ImageHlp Image Modification Functions</a>, <a href="imgehlp1_1ecl.htm"><b>CheckSumMappedFile</b></a></p>
<p>&nbsp;</p></body>
</HTML>
