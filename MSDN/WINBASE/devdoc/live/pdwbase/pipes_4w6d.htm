<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateNamedPipe</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createnamedpipe"></a>CreateNamedPipe</h1>
<p>
The <b>CreateNamedPipe</b> function creates an instance of a named pipe and returns a handle for subsequent pipe operations. A named pipe server process uses this function either to create the first instance of a specific named pipe and establish its basic attributes or to create a new instance of an existing named pipe. </p>
<pre><code><b>HANDLE CreateNamedPipe(
  LPCTSTR</b><i> lpName</i><b>,         </b>// pointer to pipe name
  <b>DWORD</b> <i>dwOpenMode</i><b>,</b>       // pipe open mode
<b>  DWORD</b><i> dwPipeMode</i><b>,       </b>// pipe-specific modes
<b>  DWORD</b><i> nMaxInstances</i><b>,    </b>// maximum number of instances
<b>  DWORD</b><i> nOutBufferSize</i><b>,   </b>// output buffer size, in bytes
<b>  DWORD</b><i> nInBufferSize</i><b>,    </b>// input buffer size, in bytes
<b>  DWORD</b><i> nDefaultTimeOut</i><b>,  </b>// time-out time, in milliseconds
<b>  LPSECURITY_ATTRIBUTES</b><i> lpSecurityAttributes</i>  // pointer to security attributes
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpName</i></dt>
<dd>
Pointer to the null-terminated string that uniquely identifies the pipe. The string must have the following form: 
<p>
<b>\\.\pipe\</b><i>pipename</i>

<p>
The <i>pipename</i> part of the name can include any character other than a backslash, including numbers and special characters. The entire pipe name string can be up to 256 characters long. Pipe names are not case sensitive. 
</dd>
<dt>
<i>dwOpenMode</i></dt>
<dd>
Specifies the pipe access mode, the overlapped mode, the write-through mode, and the security access mode of the pipe handle. 
<p>
<b>CreateNamedPipe</b> fails if <i>dwOpenMode</i> specifies any flags other than those listed in the following tables.

<p>
This parameter must specify one of the following pipe access mode flags. The same mode must be specified for each instance of the pipe: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Mode</th>
<th align=left width=59%>Description</th>
</tr>
<tr valign=top>
<td width=41%>PIPE_ACCESS_DUPLEX</td>
<td width=59%>The pipe is bidirectional; both server and client processes can read from and write to the pipe. This mode gives the server the equivalent of GENERIC_READ | GENERIC_WRITE access to the pipe. The client can specify GENERIC_READ or GENERIC_WRITE, or both, when it connects to the pipe using the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> function.</td>
</tr>
<tr valign=top>
<td width=41%>PIPE_ACCESS_INBOUND</td>
<td width=59%>The flow of data in the pipe goes from client to server only. This mode gives the server the equivalent of GENERIC_READ access to the pipe. The client must specify GENERIC_WRITE access when connecting to the pipe.</td>
</tr>
<tr valign=top>
<td width=41%>PIPE_ACCESS_OUTBOUND</td>
<td width=59%>The flow of data in the pipe goes from server to client only. This mode gives the server the equivalent of GENERIC_WRITE access to the pipe. The client must specify GENERIC_READ access when connecting to the pipe.</td>
</tr>
</table><br>


<p>
This parameter can also include either or both of the following flags, which enable write-through mode and overlapped mode. These modes can be different for different instances of the same pipe. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Mode</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>FILE_FLAG_WRITE_THROUGH</td>
<td width=52%>Write-through mode is enabled. This mode affects only write operations on byte-type pipes and, then, only when the client and server processes are on different computers. If this mode is enabled, functions writing to a named pipe do not return until the data written is transmitted across the network and is in the pipe's buffer on the remote computer. If this mode is not enabled, the system enhances the efficiency of network operations by buffering data until a minimum number of bytes accumulate or until a maximum time elapses.</td>
</tr>
<tr valign=top>
<td width=48%>FILE_FLAG_OVERLAPPED</td>
<td width=52%>Overlapped mode is enabled. If this mode is enabled, functions performing read, write, and connect operations that may take a significant time to be completed can return immediately. This mode enables the thread that started the operation to perform other operations while the time-consuming operation executes in the background. For example, in overlapped mode, a thread can handle simultaneous input and output (I/O) operations on multiple instances of a pipe or perform simultaneous read and write operations on the same pipe handle. If overlapped mode is not enabled, functions performing read, write, and connect operations on the pipe handle do not return until the operation is finished. The <a href="filesio_0660.htm"><b>ReadFileEx</b></a> and <a href="filesio_8r08.htm"><b>WriteFileEx</b></a> functions can only be used with a pipe handle in overlapped mode. The <a href="filesio_39id.htm"><b>ReadFile</b></a>, <a href="filesio_3kkl.htm"><b>WriteFile</b></a>, <a href="pipes_3885.htm"><b>ConnectNamedPipe</b></a>, and <a href="pipes_7plx.htm"><b>TransactNamedPipe</b></a> functions can execute either synchronously or as overlapped operations.</td>
</tr>
</table><br>


<p>
This parameter can include any combination of the following security access mode flags. These modes can be different for different instances of the same pipe. They can be specified without concern for what other <i>dwOpenMode</i> modes have been specified. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Mode</th>
<th align=left width=54%>Description</th>
</tr>
<tr valign=top>
<td width=46%>WRITE_DAC</td>
<td width=54%>The caller will have write access to the named pipe's discretionary access control list (ACL).</td>
</tr>
<tr valign=top>
<td width=46%>WRITE_OWNER</td>
<td width=54%>The caller will have write access to the named pipe's owner.</td>
</tr>
<tr valign=top>
<td width=46%>ACCESS_SYSTEM_SECURITY</td>
<td width=54%>The caller will have write access to the named pipe's SACL. For more information, see <a href="accctrl_1jj3.htm">Access-Control Lists (ACLs)</a> and <a href="accctrl_92b8.htm">SACL Access Right</a>.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwPipeMode</i></dt>
<dd>
Specifies the type, read, and wait modes of the pipe handle. 
<p>
One of the following type mode flags can be specified. The same type mode must be specified for each instance of the pipe. If you specify zero, the parameter defaults to byte-type mode. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Mode</th>
<th align=left width=59%>Description</th>
</tr>
<tr valign=top>
<td width=41%>PIPE_TYPE_BYTE</td>
<td width=59%>Data is written to the pipe as a stream of bytes. This mode cannot be used with PIPE_READMODE_MESSAGE.</td>
</tr>
<tr valign=top>
<td width=41%>PIPE_TYPE_MESSAGE</td>
<td width=59%>Data is written to the pipe as a stream of messages. This mode can be used with either PIPE_READMODE_MESSAGE or PIPE_READMODE_BYTE.</td>
</tr>
</table><br>


<p>
One of the following read mode flags can be specified. Different instances of the same pipe can specify different read modes. If you specify zero, the parameter defaults to byte-read mode. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Mode</th>
<th align=left width=54%>Description</th>
</tr>
<tr valign=top>
<td width=46%>PIPE_READMODE_BYTE</td>
<td width=54%>Data is read from the pipe as a stream of bytes. This mode can be used with either PIPE_TYPE_MESSAGE or PIPE_TYPE_BYTE.</td>
</tr>
<tr valign=top>
<td width=46%>PIPE_READMODE_MESSAGE</td>
<td width=54%>Data is read from the pipe as a stream of messages. This mode can be only used if PIPE_TYPE_MESSAGE is also specified.</td>
</tr>
</table><br>


<p>
One of the following wait mode flags can be specified. Different instances of the same pipe can specify different wait modes. If you specify zero, the parameter defaults to blocking mode. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Mode</th>
<th align=left width=75%>Description</th>
</tr>
<tr valign=top>
<td width=25%>PIPE_WAIT</td>
<td width=75%>Blocking mode is enabled. When the pipe handle is specified in the <a href="filesio_39id.htm"><b>ReadFile</b></a>, <a href="filesio_3kkl.htm"><b>WriteFile</b></a>, or <a href="pipes_3885.htm"><b>ConnectNamedPipe</b></a> function, the operations are not completed until there is data to read, all data is written, or a client is connected. Use of this mode can mean waiting indefinitely in some situations for a client process to perform an action.</td>
</tr>
<tr valign=top>
<td width=25%>PIPE_NOWAIT</td>
<td width=75%>Nonblocking mode is enabled. In this mode, <b>ReadFile</b>, <b>WriteFile</b>, and <b>ConnectNamedPipe</b> always return immediately. Note that nonblocking mode is supported for compatibility with Microsoft LAN Manager version 2.0 and should not be used to achieve asynchronous I/O with named pipes.</td>
</tr>
</table><br>

</dd>
<dt>
<i>nMaxInstances</i></dt>
<dd>
Specifies the maximum number of instances that can be created for this pipe. The same number must be specified for all instances. Acceptable values are in the range 1 through PIPE_UNLIMITED_INSTANCES. If this parameter is PIPE_UNLIMITED_INSTANCES, the number of pipe instances that can be created is limited only by the availability of system resources. </dd>
<dt>
<i>nOutBufferSize</i></dt>
<dd>
Specifies the number of bytes to reserve for the output buffer. For a discussion on sizing named pipe buffers, see the following Remarks section. </dd>
<dt>
<i>nInBufferSize</i></dt>
<dd>
Specifies the number of bytes to reserve for the input buffer. For a discussion on sizing named pipe buffers, see the following Remarks section. </dd>
<dt>
<i>nDefaultTimeOut</i></dt>
<dd>
Specifies the default time-out value, in milliseconds, if the <a href="pipes_7z6t.htm"><b>WaitNamedPipe</b></a> function specifies NMPWAIT_USE_DEFAULT_WAIT. Each instance of a named pipe must specify the same value. </dd>
<dt>
<i>lpSecurityAttributes</i></dt>
<dd>
Pointer to a <a href="accctrl_8gs2.htm"><b>SECURITY_ATTRIBUTES</b></a> structure that specifies a security descriptor for the new named pipe and determines whether child processes can inherit the returned handle. If <i>lpSecurityAttributes</i> is NULL, the named pipe gets a default security descriptor and the handle cannot be inherited.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a handle to the server end of a named pipe instance. </p>
<p>
If the function fails, the return value is INVALID_HANDLE_VALUE. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. The return value is ERROR_INVALID_PARAMETER if <i>nMaxInstances</i> is greater than PIPE_UNLIMITED_INSTANCES. </p>
<h4>Remarks</h4>
<p>
To create an instance of a named pipe by using <b>CreateNamedPipe</b>, the user must have FILE_CREATE_PIPE_INSTANCE access to the named pipe object. If a new named pipe is being created, the access control list (ACL) from the security attributes parameter defines the discretionary access control for the named pipe. </p>
<p>
All instances of a named pipe must specify the same pipe type (byte-type or message-type), pipe access (duplex, inbound, or outbound), instance count, and time-out value. If different values are used, this function fails and <b>GetLastError</b> returns ERROR_ACCESS_DENIED. </p>
<p>
The input and output buffer sizes are advisory. The actual buffer size reserved for each end of the named pipe is either the system default, the system minimum or maximum, or the specified size rounded up to the next allocation boundary. </p>
<p>
The pipe server should not perform a blocking read operation until the pipe client has started. Otherwise, a race condition can occur. This typically occurs when initialization code, such as the C run-time, needs to lock and examine inherited handles. </p>
<p>
An instance of a named pipe is always deleted when the last handle to the instance of the named pipe is closed. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="pipes_2vqr.htm">Pipes Overview</a>, <a href="pipes_0tmb.htm">Pipe Functions</a>, <a href="pipes_3885.htm"><b>ConnectNamedPipe</b></a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <a href="filesio_39id.htm"><b>ReadFile</b></a>, <a href="filesio_0660.htm"><b>ReadFileEx</b></a>, <a href="accctrl_8gs2.htm"><b>SECURITY_ATTRIBUTES</b></a>, <a href="pipes_7plx.htm"><b>TransactNamedPipe</b></a>, <a href="pipes_7z6t.htm"><b>WaitNamedPipe</b></a>, <a href="filesio_3kkl.htm"><b>WriteFile</b></a>, <a href="filesio_8r08.htm"><b>WriteFileEx</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
