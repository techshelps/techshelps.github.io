<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetNamedPipeHandleState</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getnamedpipehandlestate"></a>GetNamedPipeHandleState</h1>
<p>
The <b>GetNamedPipeHandleState</b> function retrieves information about a specified named pipe. The information returned can vary during the lifetime of an instance of the named pipe. </p>
<pre><code><b>BOOL GetNamedPipeHandleState(
  HANDLE</b><i> hNamedPipe</i><b>,             </b>// handle to named pipe
  <b>LPDWORD</b> <i>lpState</i><b>,</b>               // pointer to pipe state flags state
<b>  LPDWORD</b><i> lpCurInstances</i><b>,        </b>// pointer to number of current pipe instances
<b>  LPDWORD</b><i> lpMaxCollectionCount</i><b>,  </b>// pointer to maximum collection count 
<b>  LPDWORD</b><i> lpCollectDataTimeout</i><b>,  </b>// pointer to time before remote transmission
<b>  LPTSTR</b><i> lpUserName</i><b>,             </b>// pointer to user name of client process
<b>  DWORD</b><i> nMaxUserNameSize</i>         // size, in characters, of user name buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hNamedPipe</i></dt>
<dd>
Handle to the named pipe for which information is wanted. The handle must have GENERIC_READ access to the named pipe. 
<p>
<b>Windows NT:</b> This parameter can also be a handle to an anonymous pipe, as returned by the <a href="pipes_43j9.htm"><b>CreatePipe</b></a> function. 
</dd>
<dt>
<i>lpState</i></dt>
<dd>
Pointer to a 32-bit variable that indicates the current state of the handle. This parameter can be NULL if this information is not needed. Either or both of the following values can be specified: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Value</th>
<th align=left width=54%>Meaning</th>
</tr>
<tr valign=top>
<td width=46%>PIPE_NOWAIT</td>
<td width=54%>The pipe handle is in nonblocking mode. If this flag is not specified, the pipe handle is in blocking mode.</td>
</tr>
<tr valign=top>
<td width=46%>PIPE_READMODE_MESSAGE</td>
<td width=54%>The pipe handle is in message-read mode. If this flag is not specified, the pipe handle is in byte-read mode.</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpCurInstances</i></dt>
<dd>
Pointer to a 32-bit variable that receives the number of current pipe instances. This parameter can be NULL if this information is not required. </dd>
<dt>
<i>lpMaxCollectionCount</i></dt>
<dd>
Pointer to a 32-bit variable that receives the maximum number of bytes to be collected on the client's computer before transmission to the server. This parameter must be NULL if the specified pipe handle is to the server end of a named pipe or if client and server processes are on the same computer. This parameter can be NULL if this information is not required. </dd>
<dt>
<i>lpCollectDataTimeout</i></dt>
<dd>
Pointer to a 32-bit variable that receives the maximum time, in milliseconds, that can pass before a remote named pipe transfers information over the network. This parameter must be NULL if the specified pipe handle is to the server end of a named pipe or if client and server processes are on the same computer. This parameter can be NULL if this information is not required. </dd>
<dt>
<i>lpUserName</i></dt>
<dd>
Pointer to a buffer that receives the null-terminated string containing the user name string of the client application. This parameter must be NULL if the specified pipe handle is to the client end of a named pipe. This parameter can be NULL if this information is not required. </dd>
<dt>
<i>nMaxUserNameSize</i></dt>
<dd>
Specifies the size, in characters, of the buffer specified by the <i>lpUserName</i> parameter. This parameter is ignored if <i>lpUserName</i> is NULL. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
The <b>GetNamedPipeHandleState</b> function returns successfully even if all of the pointers passed to it are NULL. </p>
<p>
To set the pipe handle state, use the <b>SetNamedPipeHandleState</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="pipes_2vqr.htm">Pipes Overview</a>, <a href="pipes_0tmb.htm">Pipe Functions</a>, <a href="pipes_81r9.htm"><b>SetNamedPipeHandleState</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
