<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetEntriesInAcl</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setentriesinacl"></a>SetEntriesInAcl</h1>
<p>
The <b>SetEntriesInAcl</b> function creates a new access-control list (ACL) by merging new access-control or audit-control information into an existing <a href="accctrl_4h6a.htm">ACL</a>.</p>
<pre><code><b>DWORD SetEntriesInAcl(
  ULONG </b><i>cCountOfExplicitEntries</i><b>,</b>
<b>                 </b>// number of entries in the list
<b>  PEXPLICIT_ACCESS </b><i>pListOfExplicitEntries</i><b>,</b>
<b>                 </b>// pointer to list of entries with new access data
<b>  PACL </b><i>OldAcl</i><b>,   </b>// pointer to the original ACL
<b>  PACL </b><i>*NewAcl   </i>// receives a pointer to the new ACL
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cCountOfExplicitEntries</i></dt>
<dd>
Specifies the number of <a href="acctlnt4_1xf6.htm"><b>EXPLICIT_ACCESS</b></a> structures in the <i>pListOfExplicitEntries array. </i></dd>
<dt>
<i>pListOfExplicitEntries</i></dt>
<dd>
Pointer to an array of <b>EXPLICIT_ACCESS</b> structures that describe the access control information to merge into the existing ACL.</dd>
<dt>
<i>OldAcl</i></dt>
<dd>
Pointer to the existing ACL. This parameter can be NULL, in which case, the function creates a new ACL based on the <b>EXPLICIT_ACCESS</b> entries.</dd>
<dt>
<i>NewAcl</i></dt>
<dd>
Pointer to a variable that receives a pointer to the new ACL. If the function succeeds, you must call the <a href="memman_2339.htm"><b>LocalFree</b></a> function to free the returned buffer.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>
If the function fails, the return value is a nonzero error code defined in WINERROR.H. </p>
<h4>Remarks</h4>
<p>
Each entry in the array of <b>EXPLICIT_ACCESS</b> structures specifies access-control or audit-control information for a specified trustee. A trustee can be a user, group, or other SID value, such as a logon identifier or logon type (for instance, a Win32 service or batch job). You can use a name or a security identifier (<a href="accctrl_5lyq.htm">SID</a>) to identify a trustee. </p>
<p>
You can use the <b>SetEntriesInAcl</b> function to modify the list of ACEs in a DACL or a SACL. A DACL controls access to an object, and a SACL controls the system's auditing of attempts to access to an object. Note that <b>SetEntriesInAcl</b> does not prevent you from mixing access-control and audit-control information in the same <a href="accctrl_4h6a.htm">ACL</a>; however, the resulting ACL will contain meaningless entries. </p>
<p>
For a DACL, the <b>grfAccessMode</b> member of the <a href="acctlnt4_1xf6.htm"><b>EXPLICIT_ACCESS</b></a> structure specifies whether to allow, deny, or revoke access rights for the trustee. This member can specify one of the following values from the <a href="acctlnt4_0e42.htm"><b>ACCESS_MODE</b></a> enumeration.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=29%>Value</th>
<th align=left width=71%>Meaning</th>
</tr>
<tr valign=top>
<td width=29%>GRANT_ACCESS</td>
<td width=71%>Creates a new access-allowed ACE that combines the specified rights with any existing rights of the trustee. The new ACE replaces any existing access-allowed ACE for the trustee. The function also modifies or deletes any existing access-denied ACE for the trustee that denies the specified rights.</td>
</tr>
<tr valign=top>
<td width=29%>SET_ACCESS</td>
<td width=71%>Similar to GRANT_ACCESS except that the new access-allowed ACE allows only the specified rights, discarding any existing rights. This flag also removes any existing access-denied ACE for the trustee.</td>
</tr>
<tr valign=top>
<td width=29%>DENY_ACCESS</td>
<td width=71%>Creates a new access-denied ACE that replaces any existing access-denied ACE for the trustee. The new ACE denies the specified rights in addition to any currently denied rights of the trustee. The function also modifies or deletes any existing access-allowed ACE for the trustee that allows the specified rights.</td>
</tr>
<tr valign=top>
<td width=29%>REVOKE_ACCESS</td>
<td width=71%>Removes any existing ACEs for the specified trustee. The function ignores the rights specified in the <b>grfAccessPermissions</b> member of the <b>EXPLICIT_ACCESS</b> structure.</td>
</tr>
</table><br>
<p>
The <b>SetEntriesInAcl</b> function places any new access-denied ACEs at the beginning of the list of ACEs for the new <a href="accctrl_4h6a.htm">ACL</a>. It places any new access-allowed ACEs just before any existing access-allowed ACEs. </p>
<p>
For a SACL, the <b>grfAccessMode</b> member of the <a href="acctlnt4_1xf6.htm"><b>EXPLICIT_ACCESS</b></a> structure can specify the following values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Value</th>
<th align=left width=66%>Meaning</th>
</tr>
<tr valign=top>
<td width=34%>REVOKE_ACCESS</td>
<td width=66%>Removes any existing ACEs for the specified trustee. The function ignores the rights specified in the <b>grfAccessPermissions</b> member of the <b>EXPLICIT_ACCESS</b> structure.</td>
</tr>
<tr valign=top>
<td width=34%>SET_AUDIT_SUCCESS</td>
<td width=66%>Creates a new system-audit ACE that replaces any existing system-audit ACE for the trustee. The new ACE generates audit messages when the specified trustee successfully uses the specified access rights. The new ACE combines the specified rights with any existing audited access rights for the trustee. You can combine this value with SET_AUDIT_FAILURE.</td>
</tr>
<tr valign=top>
<td width=34%>SET_AUDIT_FAILURE</td>
<td width=66%>Creates a new system-audit ACE that replaces any existing system-audit ACE for the trustee. The new ACE generates audit messages for failed attempts to use the specified access rights. The new ACE combines the specified rights with any existing audited access rights for the trustee. You can combine this value with SET_AUDIT_SUCCESS.</td>
</tr>
</table><br>
<p>
The <b>SetEntriesInAcl</b> function places any new system-audit ACEs at the beginning of the list of ACEs for the new ACL. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in aclapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="acctlnt4_0h7w.htm">Windows NT 4.0 Access Control Overview</a>, <a href="acctlnt4_0vzn.htm">Windows NT 4.0 Access-Control Functions</a>, <a href="acctrlow_22r6.htm"><b>ACCESS_ALLOWED_ACE</b></a>, <a href="acctrlow_7she.htm"><b>ACCESS_DENIED_ACE</b></a>, <a href="accctrl_4h6a.htm"><b>ACL</b></a>, <a href="acctlnt4_1xf6.htm"><b>EXPLICIT_ACCESS</b></a>, <a href="memman_2339.htm"><b>LocalFree</b></a>, <a href="acctrlow_66ia.htm"><b>SYSTEM_AUDIT_ACE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
