<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ConnectNamedPipe</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_connectnamedpipe"></a>ConnectNamedPipe</h1>
<p>
The <b>ConnectNamedPipe</b> function enables a named pipe server process to wait for a client process to connect to an instance of a named pipe. A client process connects by calling either the <a href="filesio_7wmd.htm"><b>CreateFile</b></a> or <a href="pipes_1aed.htm"><b>CallNamedPipe</b></a><b> </b>function. </p>
<pre><code><b>BOOL ConnectNamedPipe(
  HANDLE</b><i> hNamedPipe</i><b>,          </b>// handle to named pipe to connect
<b>  LPOVERLAPPED</b><i> lpOverlapped</i>   // pointer to overlapped structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hNamedPipe</i></dt>
<dd>
Handle to the server end of a named pipe instance. This handle is returned by the <a href="pipes_4w6d.htm"><b>CreateNamedPipe</b></a> function. </dd>
<dt>
<i>lpOverlapped</i></dt>
<dd>
Pointer to an <a href="synchro_8tf6.htm"><b>OVERLAPPED</b></a> structure.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <a href="errors_3uwi.htm"><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
A named pipe server process can use <b>ConnectNamedPipe</b> with a newly created pipe instance. It can also be used with an instance that was previously connected to another client process; in this case, the server process must first call the <a href="pipes_7bl1.htm"><b>DisconnectNamedPipe</b></a> function to disconnect the handle from the previous client before the handle can be reconnected to a new client. Otherwise, <b>ConnectNamedPipe</b> returns zero, and <b>GetLastError</b> returns ERROR_NO_DATA if the previous client has closed its handle or ERROR_PIPE_CONNECTED if it has not closed its handle. </p>
<p>
The behavior of <b>ConnectNamedPipe</b> depends on two conditions: whether the pipe handle's wait mode is set to blocking or nonblocking and whether the function is set to execute synchronously or in overlapped mode. A server initially specifies a pipe handle's wait mode in the <a href="pipes_4w6d.htm"><b>CreateNamedPipe</b></a> function, and it can be changed by using the <a href="pipes_81r9.htm"><b>SetNamedPipeHandleState</b></a> function. </p>
<p>
If <i>hNamedPipe</i> was opened with FILE_FLAG_OVERLAPPED, the <i>lpOverlapped</i> parameter must not be NULL. It must point to a valid <b>OVERLAPPED</b> structure. If <i>hNamedPipe</i> was opened with FILE_FLAG_OVERLAPPED and <i>lpOverlapped</i> is NULL, the function can incorrectly report that the connect operation is complete.</p>
<p>
If <i>hNamedPipe</i> was created with FILE_FLAG_OVERLAPPED and <i>lpOverlapped</i> is not NULL, the <a href="synchro_8tf6.htm"><b>OVERLAPPED</b></a> structure pointed to by <i>lpOverlapped</i> must contain a handle to a manual-reset event object (which the server can create by using the <a href="synchro_8ub8.htm"><b>CreateEvent</b></a> function). </p>
<p>
If <i>hNamedPipe</i> was not opened with FILE_FLAG_OVERLAPPED, the function does not return until a client is connected or an error occurs. Successful synchronous operations result in the function returning a nonzero value if a client connects after the function is called. If a client connects before the function is called, the function returns zero and <b>GetLastError</b> returns ERROR_PIPE_CONNECTED. This can happen if a client connects in the interval between the call to <b>CreateNamedPipe</b> and the call to <b>ConnectNamedPipe</b>. In this situation, there is a good connection between client and server, even though the function returns zero.</p>
<p>
The server process can use any of the <a href="synchro_5vqr.htm">wait functions</a>  or <a href="prothred_0o8o.htm"><b>SleepEx</b></a> — to determine when the state of the event object is signaled, and it can then use the <a href="synchro_75v8.htm"><b>GetOverlappedResult</b></a> function to determine the results of the <b>ConnectNamedPipe</b> operation. </p>
<p>
If the specified pipe handle is in nonblocking mode, <b>ConnectNamedPipe</b> always returns immediately. In nonblocking mode, <b>ConnectNamedPipe</b> returns a nonzero value the first time it is called for a pipe instance that is disconnected from a previous client. This indicates that the pipe is now available to be connected to a new client process. In all other situations when the pipe handle is in nonblocking mode, <b>ConnectNamedPipe</b> returns zero. In these situations, <b>GetLastError</b> returns ERROR_PIPE_LISTENING if no client is connected, ERROR_PIPE_CONNECTED if a client is connected, and ERROR_NO_DATA if a previous client has closed its pipe handle but the server has not disconnected. Note that a good connection between client and server exists only after the ERROR_PIPE_CONNECTED error is received. </p>
<p>
<b>Note</b>&nbsp;&nbsp;Nonblocking mode is supported for compatibility with Microsoft LAN Manager version 2.0, and it should not be used to achieve asynchronous input and output (I/O) with named pipes. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.</p>
<h4>See Also</h4>
<p>
<a href="pipes_2vqr.htm">Pipes Overview</a>, <a href="pipes_0tmb.htm">Pipe Functions</a>, <a href="pipes_1aed.htm"><b>CallNamedPipe</b></a>, <a href="synchro_8ub8.htm"><b>CreateEvent</b></a>, <a href="filesio_7wmd.htm"><b>CreateFile</b></a>, <a href="pipes_4w6d.htm"><b>CreateNamedPipe</b></a>, <a href="pipes_7bl1.htm"><b>DisconnectNamedPipe</b></a>, <a href="synchro_75v8.htm"><b>GetOverlappedResult</b></a>, <a href="pipes_81r9.htm"><b>SetNamedPipeHandleState</b></a>, <a href="prothred_0o8o.htm"><b>SleepEx</b></a>, <a href="synchro_8tf6.htm"><b>OVERLAPPED</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
