<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Console Application Issues</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_console_application_issues"></a>Console Application Issues</h2>
<p>
The 8-bit console functions use the OEM code page. All other functions use the ANSI code page by default. This means that strings returned by the console functions may not be processed correctly by the other functions and vice versa. For example, if <b>FindFirstFileA</b> returns a string that contains certain extended ANSI characters, <b>WriteConsoleA</b> will not display the string properly. </p>
<p>
The best long-term solution for a console application is to use Unicode. Barring that solution, a console application should use the <a href="filesio_5xv1.htm"><b>SetFileApisToOEM</b></a> function. That function changes relevant file functions so that they produce OEM character set strings rather than ANSI character set strings. </p>
<p>
The following are the file functions: </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=31%><a href="filesio_0b72.htm"><b>_lopen</b></a></td>
<td width=33%><a href="filesio_2m3p.htm"><b>GetDriveType</b></a></td>
<td width=36%><a href="dll_1o8p.htm"><b>LoadLibrary</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="filesio_0x9h.htm"><b>CopyFile</b></a></td>
<td width=33%><a href="filesio_9pgz.htm"><b>GetFileAttributes</b></a></td>
<td width=36%><a href="dll_4abc.htm"><b>LoadLibraryEx</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="filesio_4sft.htm"><b>CreateDirectory</b></a></td>
<td width=33%><a href="filesio_79gl.htm"><b>GetFullPathName</b></a></td>
<td width=36%><a href="filesio_4zqd.htm"><b>MoveFile</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="filesio_7wmd.htm"><b>CreateFile</b></a></td>
<td width=33%><a href="dll_0ysl.htm"><b>GetModuleFileName</b></a></td>
<td width=36%><a href="filesio_9oe0.htm"><b>MoveFileEx</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="prothred_9dpv.htm"><b>CreateProcess</b></a></td>
<td width=33%><a href="dll_5plx.htm"><b>GetModuleHandle</b></a></td>
<td width=36%><a href="filesio_0cth.htm"><b>OpenFile</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="filesio_5n8l.htm"><b>DeleteFile</b></a></td>
<td width=33%><object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsystemdirectory">
</object><a href=JavaScript:alink_1.Click()><b>GetSystemDirectory</b></a></td>
<td width=36%><a href="filesio_6oe1.htm"><b>RemoveDirectory</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="filesio_4qcl.htm"><b>FindFirstFile</b></a></td>
<td width=33%><a href="filesio_72qt.htm"><b>GetTempFileName</b></a></td>
<td width=36%><a href="filesio_13vs.htm"><b>SearchPath</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="filesio_4ndx.htm"><b>FindNextFile</b></a></td>
<td width=33%><a href="filesio_78fc.htm"><b>GetTempPath</b></a></td>
<td width=36%><a href="filesio_3fg9.htm"><b>SetCurrentDirectory</b></a> </td>
</tr>
<tr valign=top>
<td width=31%><a href="filesio_6g6x.htm"><b>GetCurrentDirectory</b></a></td>
<td width=33%><a href="fsys_6wfi.htm"><b>GetVolumeInformation</b></a></td>
<td width=36%><a href="filesio_9a2b.htm"><b>SetFileAttributes</b></a> </td>
</tr>
<tr valign=top>
<td width=31%> <a href="filesio_2pt1.htm"><b>GetDiskFreeSpace</b></a></td>
<td width=33%><object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getwindowsdirectory">
</object><a href=JavaScript:alink_2.Click()><b>GetWindowsDirectory</b></a></td>
<td width=36%></td>
</tr>
</table><br>
<p>
When dealing with command lines, a console application should obtain the command line in Unicode form and convert it to OEM form, using the relevant  character-to-OEM functions. Note, also, that <b>argv</b> uses the ANSI character set. </p>
<p>&nbsp;</p></body>
</HTML>
