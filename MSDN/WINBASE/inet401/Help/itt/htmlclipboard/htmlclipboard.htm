<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HTML Clipboard Format</TITLE>

<META NAME="Description" CONTENT="HTML Clipboard Format">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="bk_clipboard"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="HTML Clipboard Format"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="HTML Clipboard Format"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Internet_Tools_amp_Technologies>
</object><A STYLE="color:black" HREF=JavaScript:hhal_3.Click()>Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B>
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_HIT_LOGGING_INFO>
</object><A STYLE="color:black" HREF=JavaScript:hhal_4.Click()>HIT_LOGGING_INFO</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B>
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Hyperlinks>
</object><A  STYLE="color:black" HREF=JavaScript:hhal_5.Click()>Hyperlinks</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><A NAME="ch_htmlclipboard">HTML Clipboard Format</A></H1>

<P>The requirements for transferring HTML text by means of the clipboard differ depending on scenario. This article is concerned with cutting and pasting fragments of an HTML document. There may be requirements for transferring entire HTML documents through the clipboard; however, this article is driven by a requirement to transfer fragments of selected HTML text. As such, a method that required the entire HTML document to be copied to the clipboard is seen as too heavyweight.

<P>The CF_HTML clipboard format allows a fragment of raw HTML text and its context to be stored on the clipboard as ASCII. This allows the context of the HTML fragment, which consists of all preceding surrounding tags, to be examined by an application so that the surrounding tags of the HTML fragment can be noted with their attributes. Although it is up to applications to decide how to interpret such fragments, some basic guidelines are included here based on IE4/MSHTML implementations.

<P>The official name of the clipboard (the string used by RegisterClipboardFormat) is <B>HTML Format</B>.

<P><A CLASS=tctop HREF="htmlclipboard.htm#Description"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Description</A><BR>
<P><A CLASS=tctop HREF="htmlclipboard.htm#Scenarios"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Scenarios</A><BR>
<!--************************************************************--><H2><A NAME="Description">Description</A></H2>
<P>CF_HTML is entirely text format (to be, among other things, in the HTML spirit, and uses UTF-8) and includes a <I>description</I>, an optional <I>context</I>, and, within the context, the <I>fragment</I>.

<P>The following is an example of a clipboard:

<PRE>Version:0.9
    StartHTML:71
    EndHTML:170
    StartFragment:140
    EndFragment:160
    <B>StartSelection:140</B>
    <B>EndSelection:160</B>
    &lt;!DOCTYPE&gt;
    &lt;HTML&gt;
    &lt;HEAD&gt;
    &lt;TITLE&gt; The HTML Clipboard&lt;/TITLE&gt;
    &lt;BASE HREF="http://sample/specs"&gt; 
    &lt;/HEAD&gt;
    &lt;BODY&gt;
    &lt;UL&gt;
    &lt;!--StartFragment --&gt;
    <B>&lt;LI&gt; The Fragment &lt;/LI&gt;</B>
    &lt;!--EndFragment --&gt;
    &lt;/UL&gt;
    &lt;/BODY&gt;
    &lt;/HTML&gt;
</PRE>
<P>The description includes the clipboard version number and offsets, indicating where the context and the fragment start and end. The description is a list of ASCII text keywords (min/maj is not meaningful) followed by a string and separated by a colon (:).

<P><B>Version</B>: vv version number of the clipboard. 
 Starting version is 0.9. <BR>
 <B>StartHTML</B>: bytecount from the beginning of the clipboard to 
 the start of the context, or -1 if no context.<BR>
 <B>EndHTML</B>: bytecount from the beginning of the clipboard to 
 the end of the context, or -1 if no context.<BR>
 <B>StartFragment</B>: bytecount from the beginning of the 
 clipboard to the start of the fragment.<BR>
 <B>EndFragment</B>: bytecount from the beginning of the clipboard 
 to the end of the fragment.<BR>
 <B>StartSelection</B>: bytecount from the 
 beginning of the clipboard to the start of the selection. <BR>
 <B>EndSelection</B>: bytecount from the beginning of the clipboard 
 to the end of the selection. <BR>
 


<P>The StartSelection and EndSelection keywords are optional and must both be omitted if you do not want the application to generate this information.


<P>Other information of this kind could be added here later, since the HTML starts at the StartHTMLoffset. For example, multiple pairs of StartFragment / EndFragment could be added later to support noncontiguous selection of fragments.


<P>For the convenience of the programs generating the bytecounts, bytecounts could be left padded by zeros. For example, programs generating the bytecounts could arbitrarily affect ten (10) zeros to each keyword (StartHTML: 0000000000) and then, when the exact StartHTML bytecount is known (say, 71), the program can replace the appropriate number of zeros by the bytecount (StartHTML: 0000000071).


<P>The only character set supported by the clipboard is Unicode in its UTF-8 encoding. Because the first characters of UTF-8 and ASCII match, the description is always ASCII, but the bytes of the context (starting at StartHTML) could be using any other characters coded in UTF-8.

<P>End of lines in the clipboard format header could be CR or CR/LF or LF.


<P>The fragment contains pure, valid HTML representing the area the user has selected (to Copy, for example). This contains the selected text plus the opening tags and attributes of any element that has an end tag within the selected text, and end tags at the end of the fragment for any start tag included. This is all information required for basic pasting of an HTML fragment.

<P>The fragment should be preceded and followed by the HTML comments &lt;!--StartFragment--&gt; and &lt;!--EndFragment--&gt; (no space allowed between the !-- and the text) to conveniently indicate where the fragment starts and ends. Thus the start and end of the fragment are indicated by the presence of these comments and by StartFragment and EndFragment byte counts in the description. Tools are expected to produce this information. This redundancy has been introduced to be able to rapidly find the start of the fragment (from the byte count) and mark the 
position of the fragment directly in the HTML tree.


<P>The selection indicates inside the fragment the exact HTML area the user has selected (to Copy, for example). This adds more information to the fragment by indicating the exact selected text, without the opening tags and end tags that have been added to ensure the fragment is well-formed HTML. 

<P>The selection is optional, as sufficient information is included in the fragment for basic pasting. If the selection is not stored, both StartSelection and EndSelection are not stored in the header.


<P>The context is a valid, complete HTML document. This article contains the fragment and all preceding surrounding tags (start and end tags; these preceding surrounding tags represent all the parent nodes of the fragment, until the HTML node). The article also contains the complete HEAD, and allows the BASE and TITLE elements, for example, to be included so this additional information can be obtained. An application copying a fragment of HTML to the clipboard can choose to create a BASE element to include in the context if such an element is not already present so that partial URLs in the fragment can be resolved.


<P>The context is optional, as sufficient information is included in the fragment for basic pasting of an HTML fragment to take place. If the context is not stored, the fragment only is stored and the StartHTML=EndHTML=-1.


<H2><A NAME="Scenarios">Scenarios</A></H2>
<P>The following scenarios describe how the IE4/MSHTML HTML editor handles HTML cut and paste; other applications may or may not follow these scenarios. The clipboard format described here is intended to allow flexibility for how an application chooses to function. (These scenarios show only good HTML, that is, no overlapping tags.)

<OL><LI>Simple Fragment of HTML.
 <UL><LI>HTML text: <BR>
 &lt;BODY&gt;This is normal &lt;B&gt;This is bold 
 &lt;/B&gt;&lt;I&gt;&lt;B&gt;This is bold italic &lt;/B&gt;This 
 is italic &lt;/I&gt;&lt;/BODY&gt;<LI>Appears as: <BR>
 This is normal <B>This is bold </B><B>This is 
 bold italic</B><I> This is italic</I><LI>The text between the ** is selected and copied to the 
 clipboard: <BR>
 This is normal <B> This is </B>**<B>bold 
 </B><B>This is bold italic</B><I> 
 This</I>**<I> is italic</I><LI>This is what will be on the clipboard (note this is IE4/MSHTML's 
 interpretation):<BR>
 Version:0.9<BR>
 StartHTML:71<BR>
 EndHTML:160<BR>
 StartFragment:130<BR>
 EndFragment:150<BR>
 <B>StartSelection:130</B><BR>
 <B>EndSelection:150</B><BR>
 &lt;!DOCTYPE ...&gt;<BR>
 &lt;HTML&gt; <BR>
 &lt;BODY&gt; <BR>
 &lt;!--StartFragment--&gt; <BR>
 <B>&lt;B&gt;bold &lt;/B&gt;&lt;I&gt;&lt;B&gt;This 
 is bold italic &lt;/B&gt;This&lt;/I&gt; </B><BR>
 &lt;!--EndFragment--&gt; <BR>
 &lt;/BODY&gt; <BR>
 &lt;/HTML&gt;<LI>In this scenario only the BODY tag and the HTML tag appear 
 in the context as it precedes the selected fragment. Note that 
 start tags and end tags are included in the context. The selection, as delimited by StartSelection and 
 EndSelection, is shown in bold. </UL>
<LI>Fragment of a table in HTML.
 <UL><LI>HTML text:<BR>
 &lt;BODY&gt;&lt;TABLE BORDER&gt;&lt;TR&gt;&lt;TH 
 ROWSPAN=2&gt;Head1&lt;/TH&gt;&lt;TD&gt;Item 1&lt;/TD&gt; 
 &lt;TD&gt;Item 2&lt;/TD&gt; &lt;TD&gt;Item 3&lt;/TD&gt; 
 &lt;TD&gt;Item 4&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;Item 
 5&lt;/TD&gt; &lt;TD&gt;Item 6&lt;/TD&gt; &lt;TD&gt;Item 
 7&lt;/TD&gt; &lt;TD&gt;Item 
 8&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TH&gt;Head2&lt;/TH&gt;&lt;TD&gt;Item 
 9&lt;/TD&gt; &lt;TD&gt;Item 10&lt;/TD&gt; &lt;TD&gt;Item 
 11&lt;/TD&gt; &lt;TD&gt;Item 
 12&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/BODY&gt;
 <LI>Appears as:
 
<TABLE>
<TABLE>
<TR><TH ROWSPAN=2>Head1</TH><TD>Item 1</TD> <TD>Item 2</TD> <TD>Item 3</TD> <TD>Item 4</TD></TR>
<TR><TD>Item 5</TD> <TD>Item 6</TD> <TD>Item 7</TD> <TD>Item 8</TD></TR>
<TR><TH>Head2</TH><TD>Item 9</TD> <TD>Item 10</TD> <TD>Item 11</TD> <TD>Item 12</TD></TR>
</TABLE><BR CLEAR=ALL>
</TABLE>
<LI>The Item 6, Item7, Item 10, and Item 11 elements of the table are selected as a block and copied to the clipboard.<LI>This is what will be on the clipboard (note this is IE4/MSHTML's interpretation): <BR>
 &lt;!DOCTYPE ...&gt;<BR>
 &lt;HTML&gt;&lt;BODY&gt;&lt;TABLE BORDER&gt; <BR>
 &lt;!--StartFragment--&gt;<BR>
 <B>&lt;TR&gt;&lt;TD&gt;Item 6&lt;/TD&gt; 
 &lt;TD&gt;Item 7&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;Item 
 10&lt;/TD&gt; &lt;TD&gt;Item 11&lt;/TD&gt;&lt;/TR&gt;</B><BR>
 &lt;!--EndFragment--&gt;<BR>
 &lt;/TABLE&gt;<BR>
 &lt;/BODY&gt;&lt;/HTML&gt;<BR>
 The selection, as delimited by StartSelection 
 and EndSelection, is shown in bold.</UL>
<LI>Pasting a fragment of an ordered list into plain text.
 <UL><LI>HTML text:<BR>
 &lt;BODY&gt;&lt;OL TYPE = a&gt;&lt;LI&gt;Item 1&lt;LI&gt;Item 
 2&lt;LI&gt;Item 3&lt;LI&gt;Item 4&lt;LI&gt;Item 5&lt;LI&gt;Item 
 6&lt;/OL&gt;&lt;/BODY&gt;
 <LI>Appears as:
 <OL><LI>Item 1<LI>Item 2<LI>Item 3<LI>Item 4<LI>Item 5<LI>Item 6</OL>
<LI>The user selects and copies items 3 through 5 to the clipboard.
<BR>The following HTML is in the clipboard: <BR>
 &lt;DOCTYPE...&gt;&lt;HTML&gt;&lt;BODY&gt;&lt;OL TYPE = 
 a&gt;<BR>
 &lt;!-- StartFragment--&gt;<BR>
 <B>&lt;LI&gt;Item 3&lt;LI&gt;Item 4&lt;LI&gt;Item 
 5 </B><BR>
 &lt;!-- EndFragment--&gt; <BR>
 &lt;/OL&gt;&lt;/BODY&gt;&lt;/HTML&gt;<BR>
 The selection, as delimited by StartSelection 
 and EndSelection, is show in bold.
 <LI>If this fragment is now pasted into an empty document, the 
 following HTML will be created:
<BR>&lt;BODY&gt;&lt;OL TYPE = a&gt;&lt;LI&gt;Item 3&lt;LI&gt;Item 
 4&lt;LI&gt;Item 5&lt;/OL&gt;&lt;/BODY&gt;
 <LI>Appearing as:
 <OL><LI>Item 3<LI>Item 4<LI>Item 5</OL>
</UL>
<LI>Pasting a partially selected region.
 <UL><LI>HTML text:<BR>
 &lt;P&gt; IE4/MSHTML is a WYSIWYG Editor that supports 
 :&lt;UL&gt;&lt;LI&gt;Cut&lt;LI&gt;Copy&lt;LI&gt;Paste<BR>
 &lt;/UL&gt; &lt;P&gt;This is a Great Tool !<LI>Appears as:<BR>
 IE4/MSHTML is a WYSIWYG Editor that supports :<BR>
 
 <UL><LI>Cut<LI>Copy<LI>Paste</UL>
<LI>The user selects from "WYSIWYG" 
 until "Cop".<BR>
 The following HTML is in the 
 clipboard: <BR>
 &lt;DOCTYPE...&gt;&lt;HTML&gt;&lt;BODY&gt;<BR>
 &lt;!-- StartFragment--&gt;<BR>
 &lt;P&gt;<BR>
 <B>WYSIWYG Editor, which supports</B><BR>
 <B>&lt;UL&gt;&lt;LI&gt;Cut&lt;LI&gt;Cop </B><BR>
 &lt;/UL&gt;<BR>
 &lt;!-- EndFragment--&gt; <BR>
 &lt;/BODY&gt;&lt;/HTML&gt;<BR>
 The selection, as delimited by StartSelection 
 and EndSelection, is shown in bold.
 </UL>
<UL><LI>The user selects from "opy" until 
 "Great".<BR>
 The following HTML is in the 
 clipboard: <BR>
 &lt;DOCTYPE...&gt;&lt;HTML&gt;&lt;BODY&gt;<BR>
 &lt;!-- StartFragment--&gt;<BR>
 &lt;UL&gt;&lt;LI&gt;<BR>
 <B>opy&lt;LI&gt;Paste&lt;/UL&gt;&lt;P&gt; This is 
 a Great </B><BR>
 &lt;/P&gt;<BR>
 &lt;!-- EndFragment--&gt; <BR>
 &lt;/BODY&gt;&lt;/HTML&gt;<BR>
 The selection, as delimited by StartSelection 
 and EndSelection, is shown in bold.
 </UL>
</OL>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>