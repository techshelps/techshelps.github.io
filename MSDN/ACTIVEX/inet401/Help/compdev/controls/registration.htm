<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registering an ActiveX Object as the Player for a Media Type</TITLE>

<META NAME=MS-HKWD CONTENT="Registering an ActiveX Object as the Player for a Media Type">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_register"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Registering an ActiveX Object as the Player for a Media Type"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbarc.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Registering an ActiveX Object as the Player for a Media Type"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="controls.htm#bk_activex_controls">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="palettes.htm">Palette Management for ActiveX Objects</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../containers/containers.htm">ActiveX Control Containers</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>Registering an ActiveX Object as the Player for a Media Type</h1>

<P>This topic describes how to register an ActiveX&#153; object as the viewer or player for a particular media type (MIME). This registration is <I>essential</I> for Microsoft&#174; Internet Explorer to launch the correct player when interpreting the standard HTML A HREF tag or the Netscape-introduced EMBED tag. Without this registration, it is impossible to guess what application to use to display or play an unknown media file. The registration process associates an ActiveX object with a given MIME type or file-name extension so that Internet Explorer or any other ActiveX control container can launch the correct player for files of that type. Internet Explorer first tries to find a match for the correct media type; if that is not possible, it uses the file-name extension.

<!--************************************************************--><h2><A NAME="What_Information_Nee">What Information Needs To Be Registered</A></h2>

<P>An ActiveX object has four pieces of identifying information:

<UL>
<LI><B>The class identifier (CLSID) of the object.</B> This is a globally unique identifier (GUID). The examples below use this CLSID: 
<PRE>{01234567-89AB-CDEF-0123-456789ABCDEF}
</PRE>
<LI><B>The ProgId of the object.</B> This is a textual program identifier. The examples use FooCorp.BarControl.
<LI><B>The MIME type for media types the object understands.</B> Note that not all ActiveX objects are viewers or players for media types, so not every object needs to be associated with a MIME type. The examples use the MIME type application/foobar.
<LI><B>The file extension for media types the object understands.</B> Note that not all ActiveX objects are viewers or players for media types, so not every object needs to be associated with a file extension. The examples use the extension .foo.
</UL>
<h3><A NAME="Step_1__Registering_">Step 1: Registering the CLSID for the ActiveX Object</A></h3>

<P>All ActiveX/COM objects must be entered in the registry so COM (Component Object Model) knows how to instantiate the object servers from the appropriate executable file. For full details on this registration process, see the COM Specification or OLE Reference (in the Platform SDK). A simple in-proc server would enter information such as the following in the registry.
<PRE>HKEY_CLASSES_ROOT\CLSID\
    {01234567-89AB-CDEF-0123-456789ABCDEF}\
        InProcServer32        DLL File location
        ProgId                FooCorp.BarControl
        ......
</PRE>

<P>To see an example, run Regedit.exe and look under HKEY_CLASSES_ROOT\CLSID.

<P><B>Note</B>  For an ActiveX control to act as a full-frame viewer (for HTML A HREF tags) or as an embedded viewer (for EMBED tags), it is also necessary to include the CONTROL keyword in the registry settings for the control.
<PRE>HKEY_CLASSES_ROOT\CLSID\
    {01234567-89AB-CDEF-0123-456789ABCDEF}\
        Control               (value not set)
</PRE>

<P>It is also possible to register an ActiveX control as a full-frame viewer so it is used as the viewer/player when following A HREF links to a particular media type. To mark an ActiveX control as capable of full-frame display, use the following registry setting:
<PRE>HKEY_CLASSES_ROOT\CLSID\
    {01234567-89AB-CDEF-0123-456789ABCDEF}\
        EnableFullPane\
           .foo
</PRE>

<P><B>Note</B>  A requirement of this EnableFullPane registration process is to register the control as the viewer for the .foo file extension as described below.<h3><A NAME="Step_2__Associating_">Step 2: Associating the Object's CLSID with a ProgId</A></h3>

<P>To associate a given ActiveX object with data types, it is first necessary to associate the object CLSID with a ProgId (program identifier). This is explained fully in the COM Specification or OLE Reference pages (Platform SDK), and is illustrated in the following simple example for defining the new ProgId, FooCorp.BarControl.

<PRE>HKEY_CLASSES_ROOT\
    FooCorp.BarControl\
        CLSID                 {01234567-89AB-CDEF-0123-456789ABCDEF}
</PRE>

<P>Also under the ProgId key it is possible to register shell commands to be used to edit or open files for this ProgId, as in the following example:
<PRE>HKEY_CLASSES_ROOT\FooCorp.BarControl\
    Shell\Open\
        Command               c:\Program Files\foobar.exe %1
</PRE>
<h3><A NAME="Step_3__Associating_">Step 3: Associating the Object with a MIME Type</A></h3>

<P>It is possible to associate an ActiveX object as a viewer for various media types. The following keys must be entered in the registry to associate a given ActiveX object with a given media type, application/foobar.

<PRE>HKEY_CLASSES_ROOT\
    MIME\Database\Content Type\
        application/foobar\
            Extension         .foo
            CLSID             {01234567-89AB-CDEF-0123-456789ABCDEF}
</PRE>

<P><B>Note</B>  Neither the Extension nor the CLSID key is necessary. One key associates the MIME type with a file extension; the other associates it with the CLSID of an ActiveX object.<h3><A NAME="Step_4__Associating_">Step 4: Associating the File Extension with a ProgId and Optionally with a MIME Type</A></h3>

<P>If an ActiveX control container such as Microsoft Internet Explorer does not have a (server-provided) MIME type to choose a viewer for a new data type, the data file-name extension is used to find the appropriate ActiveX object to understand the new media format. If the file-name extension is associated with a MIME type, the MIME-CLSID mapping is used to pick the object. Otherwise, the extension-ProgId mapping is used. The example below shows how to associate a three-letter file extension with a MIME type and a ProgId, although the MIME association is optional.

<PRE>HKEY_CLASSES_ROOT\
    .foo\
        (Default)             FooCorp.BarControl
        Content Type          application/foobar
</PRE>
<!--***********************************************************************--><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
