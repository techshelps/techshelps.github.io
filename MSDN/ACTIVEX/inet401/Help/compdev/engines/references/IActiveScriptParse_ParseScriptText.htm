<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IActiveScriptParse::ParseScriptText</TITLE>

<META NAME=MS-HKWD CONTENT="IActiveScriptParse::ParseScriptText">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="IActiveScriptParse__"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IActiveScriptParse::ParseScriptText"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbarc.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IActiveScriptParse::ParseScriptText"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../engines.htm#ch_script_engine">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IActiveScriptParse_InitNew.htm">IActiveScriptParse::InitNew</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="enumerations.htm">Enumerations</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>IActiveScriptParse::ParseScriptText</h1>

<PRE>HRESULT ParseScriptText(
    LPCOLESTR pstrCode,          // address of scriptlet text
    LPCOLESTR pstrItemName,      // address of item name
    IUnknown *punkContext,       // address of debugging context
    LPCOLESTR pstrDelimiter,     // address of end-of-scriptlet delimiter
    DWORD dwSourceContextCookie, // application-defined value for debugging
    ULONG ulStartingLineNumber,  // starting line of the script
    DWORD dwFlags,               // scriptlet flags
    VARIANT *pvarResult,         // address of buffer for results
    EXCEPINFO *pexcepinfo        // address of buffer for error data
);
</PRE>

<P>Parses the given code scriptlet, adding declarations into the name space and evaluating code as appropriate.

<UL>
<LI>Returns one of the following values:
<TABLE>
<TR><TD>S_OK
 </TD><TD>Success.
</TD></TR><TR><TD>DISP_E_EXCEPTION
 </TD><TD>An exception occurred in the processing of the scriptlet. The <I>pexcepinfo</I> parameter contains information about the exception.
</TD></TR><TR><TD>E_INVALIDARG
 </TD><TD>An argument was invalid.
</TD></TR><TR><TD>E_POINTER
 </TD><TD>An invalid pointer was specified.
</TD></TR><TR><TD>E_NOTIMPL
 </TD><TD>This method is not supported. The scripting engine does not support run-time evaluation of expressions or statements.
</TD></TR><TR><TD>E_UNEXPECTED
 </TD><TD>The call was not expected (for example, the scripting engine is in the uninitialized or closed state, or the SCRIPTTEXT_ISEXPRESSION flag was set and the scripting engine is in the initialized state). 
</TD></TR><TR><TD>OLESCRIPT_E_SYNTAX
 </TD><TD>An unspecified syntax error occurred in the scriptlet.
</TD></TR></TABLE>
</UL>
<DL><DT><I>pstrCode</I>
 </DT><DD>[in] Address of the scriptlet text to evaluate. The interpretation of this string depends on the scripting language.
</DD><DT><I>pstrItemName</I>
 </DT><DD>[in] Address of the item name that gives the context in which the scriptlet is to be evaluated. If this parameter is NULL, the code is evaluated in the scripting engine's global context.
</DD><DT><I>punkContext</I>
 </DT><DD>[in] Address of the context object. This object is reserved for use in a debugging environment, where such a context may be provided by the debugger to represent an active run-time context. If this parameter is NULL, the engine uses <I>pstrItemName</I> to identify the context.
</DD><DT><I>pstrDelimiter</I>
 </DT><DD>[in] Address of the end-of-scriptlet delimiter. When <I>pstrCode</I> is parsed from a stream of text, the host typically uses a delimiter, such as two single quotation marks ("), to detect the end of the scriptlet. This parameter specifies the delimiter that the host used, allowing the scripting engine to provide some conditional primitive preprocessing (for example, replacing a single quotation mark ['] with two single quotation marks for use as a delimiter). Exactly how (and if) the scripting engine makes use of this information depends on the scripting engine. Set this parameter to NULL if the host did not use a delimiter to mark the end of the scriptlet.
</DD><DT><I>dwSourceContextCookie</I>
 </DT><DD>[in] Application-defined value that is used for debugging purposes.
</DD><DT><I>ulStartingLineNumber</I>
 </DT><DD>[in] Zero-based value that specifies which line the parsing will begin at.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags associated with the scriptlet. Can be a combination of these values:
 <TABLE>
<TR><TD>SCRIPTTEXT_ISEXPRESSION
 </TD><TD>If the distinction between a computational expression and a statement is important but syntactically ambiguous in the script language, this flag specifies that the scriptlet is to be interpreted as an expression, rather than as a statement or list of statements. By default, statements are assumed unless the correct choice can be determined from the syntax of the scriptlet text.
 </TD></TR><TR><TD>SCRIPTTEXT_ISPERSISTENT
 </TD><TD>Indicates that the code added during this call should be saved if the scripting engine is saved (for example, through a call to <B>IPersist*::Save</B>), or if the scripting engine is reset by way of a transition back to the initialized state.
 </TD></TR><TR><TD>SCRIPTTEXT_ISVISIBLE
 </TD><TD>Indicates that the script text should be visible (and, therefore, callable by name) as a global method in the name space of the script.
 </TD></TR></TABLE>
</DD><DT><I>pvarResult</I>
 </DT><DD>[out] Address of a buffer that receives the results of scriptlet processing, or NULL if the caller expects no result (that is, the SCRIPTTEXT_ISEXPRESSION value is not set).
</DD><DT><I>pexcepinfo</I>
 </DT><DD>[out] Address of a structure that receives exception information. This structure is filled if <B>IActiveScriptParse::ParseScriptText</B> returns DISP_E_EXCEPTION.
</DD></DL>

<P>If the scripting engine is in the initialized state, no code will actually be evaluated during this call; rather, such code is queued and executed when the scripting engine is transitioned into (or through) the started state. Because execution is not allowed in the initialized state, it is an error to call this method with the SCRIPTTEXT_ISEXPRESSION flag when in the initialized state.

<P>The scriptlet can be an expression, a list of statements, or anything allowed by the script language. For example, this method is used in the evaluation of the HTML &lt;SCRIPT&gt; tag, which allows statements to be executed as the HTML page is being constructed, rather than just compiling them into the script state.

<P>The code passed to this method must be a valid, complete portion of code. For example, in VBScript it is illegal to call this method once with <B>Sub Function(x)</B> and then a second time with <B>End Sub</B>. The parser must not wait for the second call to complete the subroutine, but rather must generate a parse error because a subroutine declaration was started but not completed.

<P>For more information about script states, see <A HREF="../engines.htm#Engine_States">Script Engine States</A>.
<!-- *************************************************************** --><!-- *************************************************************** --><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
