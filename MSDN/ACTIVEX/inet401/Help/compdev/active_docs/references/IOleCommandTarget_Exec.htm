<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleCommandTarget::Exec</TITLE>

<META NAME=MS-HKWD CONTENT="IOleCommandTarget::Exec">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="IOleCommandTarget_Exec"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IOleCommandTarget::Exec"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbarc.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IOleCommandTarget::Exec"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="references.htm#ch_ax_make">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IOleCommandTarget.htm">IOleCommandTarget</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IOleCommandTarget_QueryStatus.htm">IOleCommandTarget::QueryStatus</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>IOleCommandTarget::Exec</h1>

<PRE>HRESULT Exec(
    const GUID *pguidCmdGroup,
    DWORD nCmdID,
    DWORD nCmdExecOpt,
    VARIANTARG *pvaIn,
    VARIANTARG *pvaOut
   );
</PRE>

<P>Executes a specified command or displays help for a command.
<UL>
<LI>Returns one of the following values: 
<TABLE>
<TR><TD>S_OK
 </TD><TD>Success.
</TD></TR><TR><TD>E_FAIL
 </TD><TD>The command failed.
</TD></TR><TR><TD>E_UNEXPECTED 
 </TD><TD>The command was executed at a time when the object was not expecting the command.
</TD></TR><TR><TD>OLECMDERR_CANCELED
 </TD><TD>The user canceled the execution of the command.
</TD></TR><TR><TD>OLECMDERR_DISABLED
 </TD><TD>The command identified by <I>nCmdID</I> is currently disabled and cannot be executed.
</TD></TR><TR><TD>OLECMDERR_E_NOTSUPPORTED
 </TD><TD>The <I>nCmdID</I> parameter does not identify a valid command in the <I>pguidCmdGroup</I> group.
</TD></TR><TR><TD>OLECMDERR_E_UNKNOWNGROUP
 </TD><TD>The <I>pguidCmdGroup</I> parameter is not NULL but does not specify a recognized command group.
</TD></TR><TR><TD>OLECMDERR_NOHELP
 </TD><TD>The caller has asked for help on the command identified by <I>nCmdID</I>, but no help is available.
</TD></TR></TABLE>
</UL>
<DL><DT><I>pguidCmdGroup</I>
 </DT><DD>[unique][in] Address of a globally unique identifier (GUID) of the command group; can be NULL to specify the standard group. 
</DD><DT><I>nCmdID</I>
 </DT><DD>[in] Identifier of the command to be executed. This command must belong to the group specified in the <I>pguidCmdGroup</I> parameter.
</DD><DT><I>nCmdExecOpt</I>
 </DT><DD>[in] Values taken from the <A HREF="OLECMDEXECOPT.htm#OLECMDEXECOPT">OLECMDEXECOPT</A> enumeration, which describes how the object should execute the command.
</DD><DT><I>pvaIn</I>
 </DT><DD>[unique][in] Address of a
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>VARIANTARG</A> structure containing input arguments. Can be NULL.
</DD><DT><I>pvaOut</I>
 </DT><DD>[unique][in,out] Address of a
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>VARIANTARG</A> structure to receive command output. Can be NULL.
</DD></DL>

<P>The list of input and output arguments of a command and how they are packaged is unique to each command. Such information should be documented with the specification of the command group. (See the description of OLECMDID_ZOOM in the <A HREF="OLECMDID.htm#OLECMDID">OLECMDID</A> enumeration.) In the absence of any specific information, the command is assumed to take no arguments and have no return value. 

<P><B>Notes to Callers</B>

<P>The <I>pguidCmdGroup</I> and <I>nCmdID</I> parameters together uniquely identify the command to invoke. The <I>nCmdExecOpt</I> parameter specifies the exact action to be taken. (For more details, see the <A HREF="OLECMDEXECOPT.htm#OLECMDEXECOPT">OLECMDEXECOPT</A> enumeration.)

<P>Most commands neither take arguments nor return values. For such commands, the caller can pass NULL in <I>pvaIn</I> and <I>pvaOut</I>. For commands that expect one or more input values, the caller can declare and initialize a
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>VARIANTARG</A> structure and pass a pointer to that structure in <I>pvaIn</I>. If the input to the command is a single value, the argument can be stored directly in the <B>VARIANTARG</B> structure and passed to the function. If the command expects multiple arguments, those arguments must be packaged appropriately within the <B>VARIANTARG</B> structure, using one of the supported variant types (such as the <A HREF="../../idispatchex/references/IDispatch.htm#IDispatch">IDispatch</A> interface or the
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>SAFEARRAY</A> data type). 

<P>If a command returns one or more arguments, the caller is expected to declare a
<object id="hhal_7" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_7.Click()>VARIANTARG</A>, initialize it to VT_EMPTY, and pass its address in <I>pvaOut</I>. If the command returns a single value, the object can store that value directly in <I>pvaOut</I>. If the command has multiple output values, it will package those in some way appropriate for the <B>VARIANTARG</B>. 

<P>Because <I>pvaIn</I> and <I>pvaOut</I> are both caller-allocated, stack variables are permitted for both the caller and the object receiving the call. For commands that take zero or one argument on input and return zero or one value, no additional memory allocation is necessary. Most of the types supported by
<object id="hhal_8" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_8.Click()>VARIANTARG</A> do not require memory allocation. Exceptions include
<object id="hhal_9" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_9.Click()>SAFEARRAY</A> and
<object id="hhal_10" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_10.Click()>BSTR</A>. For a complete list, see the OLE documentation in the Microsoft&#174; Platform SDK.

<P><B>Notes to Implementers</B>

<P>A command target must implement this function; E_NOTIMPL is not a valid return value.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
