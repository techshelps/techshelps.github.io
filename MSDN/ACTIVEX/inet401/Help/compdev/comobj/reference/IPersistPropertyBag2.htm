<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The IPersistPropertyBag2 Interface</TITLE>

<META NAME=MS-HKWD CONTENT="The IPersistPropertyBag2 Interface">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="IPersistPropertyBag2"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="The IPersistPropertyBag2 Interface"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbarc.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="The IPersistPropertyBag2 Interface"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="interfaces.htm#ref_comobj_interfaces">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IPropertyBag_Write.htm">IPropertyBag::Write</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IPersistPropertyBag2_InitNew.htm">IPersistPropertyBag2::InitNew</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>The IPersistPropertyBag2 Interface</h1>

<P>The <B>IPersistPropertyBag2</B> interface works in conjunction with the <A HREF="IPropertyBag2.htm#IPropertyBag2">IPropertyBag2</A> and <A HREF="IErrorLog.htm#IErrorLog">IErrorLog</A> interfaces to define an individual property-based persistence mechanism. This interface is similar to <A HREF="IPersistPropertyBag.htm#IPersistPropertyBag">IPersistPropertyBag</A>, but allows the object to support property bags that implement <B>IPropertyBag2</B>. 

<P>Whereas a mechanism like
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>IPersistStream</A> gives an object an
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>IStream</A> in which to store its binary data, <B>IPersistPropertyBag2</B> provides an object with an <A HREF="IPropertyBag2.htm#IPropertyBag2">IPropertyBag2</A> interface through which it can save and load individual properties. The implementor of <B>IPropertyBag2</B> can then save those properties in whatever way it chooses, such as name/value pairs in a text file. Errors encountered in the process (on either side) are recorded in an "error log" through <A HREF="IErrorLog.htm#IErrorLog">IErrorLog</A>. This error reporting mechanism work on a per-property basis instead of an "all properties as a whole" basis through just the return value of
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>IPersist*::Load</A> or
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>IPersist*::Save</A>.

<P>When requesting a persistent property bag interface, a property bag that supports <A HREF="IPropertyBag2.htm#IPropertyBag2">IPropertyBag2</A> will attempt to obtain the object's <B>IPersistPropertyBag2</B> interface before attempting to obtain the object's <A HREF="IPersistPropertyBag.htm#IPersistPropertyBag">IPersistPropertyBag</A> interface. This allows objects that support either interface to communicate with the property bag.

<P><B>IDL:</B>
<PRE>
[object, uuid(22F55881-280B-11d0-A8A9-00A0C90C2004), pointer_default(unique)]
interface IPersistPropertyBag2 : IPersist
    {
    typedef [unique] IPersistPropertyBag2 *LPPERSISTPROPERTYBAG2;

    HRESULT InitNew();

    HRESULT Load(
        [in]IPropertyBag2 * pPropBag,
        [in]IErrorLog * pErrLog);

    HRESULT Save(
        [in]IPropertyBag2 * pPropBag,
        [in]BOOL fClearDirty,
        [in]BOOL fSaveAllProperties);

    HRESULT IsDirty();
    }
</PRE>

<P>The basic mechanism is that a container tells the object to save or load its properties through <B>IPersistPropertyBag2</B>. For each property, the object calls the container's <A HREF="IPropertyBag2.htm#IPropertyBag2">IPropertyBag2</A> interface passed to the <A HREF="IPersistPropertyBag.htm#IPersistPropertyBag">IPersistPropertyBag</A> members. <A HREF="IPropertyBag2_Write.htm#IPropertyBag2::Write">IPropertyBag2::Write</A> saves a property in whatever place the container wants to put it, and <A HREF="IPropertyBag2_Read.htm#IPropertyBag2::Read">IPropertyBag2::Read</A> retrieves a property.

<P>This protocol is essentially a means of sequentially communicating individual property values from the object to the container, which is useful for doing save-as-text operations and the like. The object gives the container the choice of the format in which each property is saved, while retaining itself the decision as to which properties are saved or loaded.

<P><A CLASS=tctop HREF="IPersistPropertyBag2_InitNew.htm#IPersistPropertyBag2::InitNew"><IMG SRC="../../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">IPersistPropertyBag2::InitNew</A><BR>

<P><A CLASS=tctop HREF="IPersistPropertyBag2_IsDirty.htm#IPersistPropertyBag2::IsDirty"><IMG SRC="../../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">IPersistPropertyBag2::IsDirty</A><BR>

<P><A CLASS=tctop HREF="IPersistPropertyBag2_Load.htm#IPersistPropertyBag2::Load"><IMG SRC="../../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">IPersistPropertyBag2::Load</A><BR>

<P><A CLASS=tctop HREF="IPersistPropertyBag2_Save.htm#IPersistPropertyBag2::Save"><IMG SRC="../../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">IPersistPropertyBag2::Save</A><BR>
<!--********************************************************************--><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
