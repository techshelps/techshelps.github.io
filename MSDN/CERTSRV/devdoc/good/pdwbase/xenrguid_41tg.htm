<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the Certificate Request</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_xen_creating_the_certificate_request"></a>Creating the Certificate Request</h2>
<p>
The process of creating a certificate request involves collecting certain information from the requester. Usually, this is done through some sort of user interface (UI), although it could conceivably be taken directly from a database without the need for a UI. The required information is set by the policy of the certifying authority (CA). An example of the required information might be as follows:</p>
<p>
Common Name<br>
Unit Name<br>
Company Name<br>
City<br>
State<br>
Country</p>
<p>
The following code is a simple example of how to use Visual Basic Script and HTML in a Web page to generate input for the CEC, and then to request a certificate. This example uses the default property values of the CEC object, and expects to find the xenroll.dll in the same directory.</p>
<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Enrollment HTML Page&lt;/TITLE&gt;

&lt;OBJECT
    classid="clsid:43F8F289-7A20-11D0-8F06-00C04FC295E1"
    CODEBASE="xenroll.dll"
    id=Enroll
    &gt;
&lt;/OBJECT&gt;

&lt;SCRIPT LANGUAGE="VBSCRIPT"&gt;

    sub CertRequestSub

    '-----------------------------------------------------------------
    ' Create the data string.
    '-----------------------------------------------------------------
    DNName = "CN="  &amp; document.CertRequest.CN.value &amp; _
         ",OU=" &amp; document.CertRequest.OU.value &amp; _
         ",O="  &amp; document.CertRequest.O.value  &amp; _
         ",L="  &amp; document.CertRequest.L.value  &amp; _
         ",S="  &amp; document.CertRequest.S.value  &amp; _
         ",C="  &amp; document.CertRequest.C.value

    '-----------------------------------------------------------------
    ' Create the PKCS10 message and put the keys in HKEY_CURRENT_USER 
    ' on Local Machine.
    '-----------------------------------------------------------------

    document.data.Request.value = _
    Enroll.CreatePKCS10(DNName, "1.3.6.1.4.1.311.2.1.21")

    '-----------------------------------------------------------------
    ' Request the certificate.
    '-----------------------------------------------------------------

    document.data.submit()

    end sub

&lt;/SCRIPT&gt;

&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;FORM NAME="data" ACTION="scripts/certhtm.dll" METHOD=POST&gt;
    &lt;INPUT TYPE="HIDDEN" NAME="Request"&gt;
    &lt;INPUT TYPE="HIDDEN" NAME="Server" VALUE="keithv2\Your Name"&gt;
&lt;/FORM&gt;

&lt;CENTER&gt;
&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;FONT SIZE=5 COLOR=Maroon&gt;&lt;I&gt;&lt;B&gt;
Certificate Enrollment
&lt;/B&gt;&lt;/I&gt;&lt;/FONT&gt;
&lt;HR COLOR=Maroon WIDTH=75%&gt;
&lt;FORM NAME="CertRequest"&gt;
&lt;TABLE&gt;
&lt;CAPTION ALIGN=LEFT VALIGN=TOP&gt; Please Enter: &lt;/CAPTION&gt;
&lt;!-- Collect the data. --&gt;
&lt;TR&gt;&lt;TD&gt;Your Common Name:&lt;TD&gt;&lt;INPUT TYPE="TEXT" SIZE=32 NAME="CN"&gt;
&lt;TR&gt;&lt;TD&gt;Your Unit Name:&lt;TD&gt;&lt;INPUT TYPE="TEXT" SIZE=32 NAME="OU"&gt;
&lt;TR&gt;&lt;TD&gt;Your Company Name:&lt;TD&gt;&lt;INPUT TYPE="TEXT" SIZE=32 NAME="O"&gt;
&lt;TR&gt;&lt;TD&gt;Your City:&lt;TD&gt;&lt;INPUT TYPE="TEXT" SIZE=32 NAME="L"&gt;
&lt;TR&gt;&lt;TD&gt;Your State:&lt;TD&gt;&lt;INPUT TYPE="TEXT" SIZE=32 NAME="S"&gt;
&lt;TR&gt;&lt;TD&gt;Your Country:&lt;TD&gt;&lt;INPUT TYPE="TEXT" SIZE=32 NAME="C"&gt;

&lt;!-- Run the CertRequestSub subroutine. --&gt;

&lt;TR&gt;&lt;TD ALIGN=center&gt;&lt;INPUT TYPE="BUTTON" NAME="Request" value="Request Cert" onClick="CertRequestSub" language="VBScript"&gt;

&lt;!-- Clear the input data. --&gt;

&lt;TD ALIGN=center&gt;&lt;INPUT TYPE="RESET" NAME="Reset" value="Cancel"&gt;
&lt;/TABLE&gt; &lt;BR&gt;
&lt;/FORM&gt;

&lt;HR COLOR=Maroon WIDTH=75%&gt;
&lt;/CENTER&gt;

&lt;/BODY&gt;
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
