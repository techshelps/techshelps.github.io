<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>acceptPKCS7</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_xen_acceptpkcs7"></a>acceptPKCS7</h1>
<p>
This method accepts and processes a base64 encoded PKCS #7 (in BSTR form) containing a certificate. The PKCS #7 is input as a parameter.</p>
<p>
The <b>acceptPKCS7</b> method takes one parameter, a base64 encoded PKCS #7 (in BSTR form) that contains a certificate and the chain of certificates, possibly up to the root, identifying the issuer of the certificate. The certificate and the associated keys generated for it are put in the MY store. A root certificate is placed in the ROOT store and the rest of the chain of certificates are placed in the Certification Authority (CA) store. If any ROOT certificates found in the PKCS #7 are accepted, Crypt32 will notify the user that a ROOT is being added to his store. The user has the option of declining the ROOT certificate. This will not cause Certificate Enrollment Control to fail acceptance.</p>
<p>
By default the system stores MY, CA, ROOT, and REQUEST are used for storing the certificates. However the stores to use may be specified by assigning the following properties before calling this method:</p>
<p>
<a href="xenrref_3llx.htm"><b>MyStoreName</b></a><b><br>
<a href="xenrref_6ilh.htm">CAStoreName</a><br>
<a href="xenrref_2kkl.htm">RootStoreName</a><br>
<a href="xenrref_1bqd.htm">RequestStoreName</a> (a Certificate Enrollment defined system store)</b></p>
<pre><code><b>[VB] void acceptPKCS7(
  BSTR</b><i> PKCS7</i>
<b>);</b>
 
<b>[C++] HRESULT acceptPKCS7</b> <b>(</b>
<b>  BSTR</b><i> PKCS7 </i>// in
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<b>[VB][C++] </b><i>PKCS7 </i></dt>
<dd>
The base64 encoded PKCS #7 containing the certificate and the chain of certificates, possibly up to the root, identifying the issuer of the certificate.
</dd>
</dl>
<h4>Return Values</h4>
<p>
<b>acceptPKCS7</b> returns nothing. However, an error will be thrown on failure.</p>
<p>&nbsp;</p></body>
</HTML>
