<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>acceptFilePKCS7</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_xen_acceptfilepkcs7"></a>acceptFilePKCS7</h1>
<p>
The <b>acceptFilePKCS7</b> method accepts and processes a base64 encoded PKCS #7 (in BSTR form) containing a certificate. The BSTR is stored in a file.</p>
<p>
The <b>acceptFilePKCS7</b> method takes one parameter, a file containing the base64 encoded PKCS #7 (in BSTR form). It contains a certificate and the chain of certificates, possibly up to the root, identifying the issuer of the certificate. The certificate and the associated keys are put in the MY store. A root certificate is placed in the ROOT store and the rest of the chain of certificates are placed in the Certification Authority (CA) store. If any ROOT certificates are found in the PKCS #7, Crypt32 will notify the user that a ROOT is being added to his store. The user has the option of declining the ROOT certificate. This will not cause Certificate Enrollment Control to fail acceptance.</p>
<p>
The only difference between this method and the <b>acceptPKCS7</b> method is that the PKCS 7 to be processed is stored in a file for <b>acceptFilePKCS7</b>, where as <a href="xenrref_55yv.htm"><b>acceptPKCS7</b></a> receives the PKCS 7 to be processed directly as a BSTR parameter.</p>
<pre><code><b>[VB] void acceptFilePKCS7(
  BSTR</b><i> wszPKCS10FileName</i>
<b>);</b>
 
<b>[C++] HRESULT acceptFilePKCS7</b> <b>(</b>
<b>  BSTR</b><i> wszPKCS10FileName</i><b>    </b>// in
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<b>[VB][C++] </b><i>wszPKCS10FileName</i><b>  </b></dt>
<dd>
Specifies the name of the file where the BSTR containing the base64 encoded PKCS #7.
</dd>
</dl>
<h4>Return Values</h4>
<p>
<b>acceptFilePKCS7</b> returns nothing. However, an error will be triggeredon failure.</p>
<h4>Remarks</h4>
<p>
By default the system stores MY, CA, ROOT, and REQUEST are used for storing the certificates. However the stores to use may be specified by assigning the following properties before calling this method:</p>
<p class=indent1>
<a href="xenrref_3llx.htm"><b>MyStoreName</b></a><b><br>
<a href="xenrref_6ilh.htm">CAStoreName</a><br>
<a href="xenrref_2kkl.htm">RootStoreName</a><br>
<a href="xenrref_1bqd.htm">RequestStoreName</a> (a Certificate Enrollment defined system store)</b></p>
<p>&nbsp;</p></body>
</HTML>
