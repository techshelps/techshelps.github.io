<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Default Extension Handler</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_certsrv_default_extension_handler"></a>Default Extension Handler</h2>
<p>
Microsoft® Certificate Server includes a default extension handler, CertEnc.dll, that provides routines for encoding the most commonly used extensions and data types such as IA5String, PrintableString, etc. These data types aren't among the default data types available from the policy module.</p>
<p>
The non-default data types are supported by a number of ICertEncodeXXX interfaces exported by CertEnc.dll. Each interface provides an <b>Encode</b> method that returns an ASN encoded certificate extension to the policy module in a binary format. The policy module can then set the extension in a certificate by calling the <a href="appprog_6g1a.htm"><b>ICertServerPolicy::SetCertificateExtension</b></a> method. Here is an example written in Microsoft Visual Basic® that demonstrates how a policy module can encode a string array and use it to set a certificate extension:</p>
<pre><code>Private Const szOID_TEST1 As String = "0.1.2.3.4.5.6.0"

Set StringArray = New CCertEncodeStringArray
Dim Extension As String

StringArray.Reset 3, CERT_RDN_IA5_STRING
StringArray.SetValue 0, "VB Test String 1"
StringArray.SetValue 1, "VB Test String 2"
StringArray.SetValue 2, "VB Test String 3"

Extension = StringArray.Encode

CertServer.SetCertificateExtension _
        szOID_TEST1, _
        PROPTYPE_BINARY, _
        EXTENSION_DISABLE_FLAG, _
        Extension
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
