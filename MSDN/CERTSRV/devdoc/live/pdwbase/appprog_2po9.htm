<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ICertServerPolicy::GetCertificateProperty</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_certsrv_icertserverpolicy_getcertificateproperty"></a>ICertServerPolicy::GetCertificateProperty</h1>
<p>
The <b>GetCertificateProperty</b> method returns a named property from a certificate.</p>
<pre><code><b>[VB] VARIANT GetCertificateProperty(
  BSTR</b><i> strPropertyName</i><b>,  </b>
<b>  long</b><i> PropertyType      </i>
<b>);</b>
 
<b>[JAVA] com.ms.Variant GetCertificateProperty(</b>
<b>  java.lang.String</b><i> strPropertyName</i><b>,  </b>
<b>  int</b><i> PropertyType                   </i>
<b>);</b>
 
<b>[C++] HRESULT GetCertificateProperty(</b>
<b>  BSTR const</b><i> strPropertyName</i><b>,  </b>// in
<b>  LONG</b><i> PropertyType</i><b>,           </b>// in
<b>  VARIANT </b><i>*pvarPropertyValue   </i>// out, return value
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<b>[VB][JAVA][C++]</b> <i>strPropertyName</i></dt>
<dd>
Specifies the named property to retrieve. There are a stock set of certificate properties that are always valid, referred to as the Name Properties. Other properties valid for certificates include the Certifcate Properties listed below.
<p>
<b>Name Properties</b>

<p>
These properties can refer to the subject name or the issuer name by prepending Subject or Issuer to the property. For example, Subject.OrgUnit would refer to the subject's organizational unit.


<p>
<b>Note</b>&nbsp;&nbsp;Only Subject name properties are supported in this release (do not prepend Issuer to a property name.)


<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Property Name</th>
<th align=left width=21%>Data Type</th>
<th align=left width=48%>Description</th>
</tr>
<tr valign=top>
<td width=31%>DistinguishedName</td>
<td width=21%>String</td>
<td width=48%>Full X.400 DN Name</td>
</tr>
<tr valign=top>
<td width=31%>RawName</td>
<td width=21%>Binary</td>
<td width=48%>ASN.1 Encoded DN</td>
</tr>
<tr valign=top>
<td width=31%>Country</td>
<td width=21%>String</td>
<td width=48%>X.500 2-character country code (for example US for United States or CA for Canada)</td>
</tr>
<tr valign=top>
<td width=31%>Organization</td>
<td width=21%>String</td>
<td width=48%>Legal name of organization</td>
</tr>
<tr valign=top>
<td width=31%>OrgUnit</td>
<td width=21%>String</td>
<td width=48%>Name of sub-organization or department</td>
</tr>
<tr valign=top>
<td width=31%>CommonName</td>
<td width=21%>String</td>
<td width=48%>Fully qualified hostname/path used in DNS (Domain Name System) lookups (for example, host.company.com)</td>
</tr>
<tr valign=top>
<td width=31%>StreetAddress</td>
<td width=21%>String</td>
<td width=48%>Street address or PO Box</td>
</tr>
<tr valign=top>
<td width=31%>Locality</td>
<td width=21%>String</td>
<td width=48%>Name of city</td>
</tr>
<tr valign=top>
<td width=31%>State</td>
<td width=21%>String</td>
<td width=48%>Full name of state or province (for example, California)</td>
</tr>
<tr valign=top>
<td width=31%>Title</td>
<td width=21%>String</td>
<td width=48%>Title of individual who requested the certificate (optional)</td>
</tr>
<tr valign=top>
<td width=31%>GivenName</td>
<td width=21%>String</td>
<td width=48%>First name of individual</td>
</tr>
<tr valign=top>
<td width=31%>Initials</td>
<td width=21%>String</td>
<td width=48%>Initials of individual (optional)</td>
</tr>
<tr valign=top>
<td width=31%>Surname</td>
<td width=21%>String</td>
<td width=48%>Last name of individual</td>
</tr>
<tr valign=top>
<td width=31%>DomainComponent</td>
<td width=21%>String</td>
<td width=48%>Component of a DNS (Domain Name System) name</td>
</tr>
<tr valign=top>
<td width=31%>E-Mail</td>
<td width=21%>String</td>
<td width=48%>E-mail address</td>
</tr>
</table><br>


<p>
All of the above properties except DistinguishedName, RawName, and Country support multi-valued syntax using an ANSI punctuation character as the separator, which by default must be a comma. The separator character is specified by the HKEY_LOCAL_MACHINE\SYSTEM\\CurrentControlSet\Services\CertSVC\Configuration\&lt;<i>CA Name</i>&gt;\SubjectNameSeparator (REG_SZ) entry in the system registry. This entry is set to a single character string containing a comma, by default. The first character of this string must be an ANSI punctation character to enable the multi-valued syntax. If some other character appears first, or if the registry entry is empty or missing, then multi-valued syntax is disabled.


<p>
<b>Note</b>&nbsp;&nbsp;The RawName property is only accessible by <b>ICertServerPolicy::GetCertificateProperty</b> if the certificate is requested using a non-KeyGen certificate request. For KeyGen requests, the RawName property does not exist in the certirficate until it is added after the policy module has finished processing the request and the certificate is issued. The RawName property can always be read by <a href="appprog_7rzt.htm"><b>ICertServerExit::GetCertificateProperty</b></a>.


<p>
<b>Certificate Properties</b>

<p>
The following properties are unique to certificates and can be read by <b>ICertServerPolicy::GetCertificateProperty</b>.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=34%>Property Name</th>
<th align=left width=25%>Data Type</th>
<th align=left width=41%>Description</th>
</tr>
<tr valign=top>
<td width=34%>RequestID</td>
<td width=25%>Signed long</td>
<td width=41%>Internal request ID</td>
</tr>
<tr valign=top>
<td width=34%>NotBefore</td>
<td width=25%>Date / Time</td>
<td width=41%>Certificate start validity date</td>
</tr>
<tr valign=top>
<td width=34%>NotAfter</td>
<td width=25%>Date / Time</td>
<td width=41%>Certificate expiration date</td>
</tr>
<tr valign=top>
<td width=34%>RawPublicKey</td>
<td width=25%>Binary</td>
<td width=41%>Subject key</td>
</tr>
<tr valign=top>
<td width=34%>PublicKeyAlgorithm</td>
<td width=25%>String</td>
<td width=41%>Subject key algorithm Object ID (OID)</td>
</tr>
<tr valign=top>
<td width=34%>RawPublicKeyAlgorithmParameters</td>
<td width=25%>Binary</td>
<td width=41%>Subject key algorithm parameters</td>
</tr>
</table><br>


<p>
<b>Note</b>&nbsp;&nbsp;There are additional certificate properties that cannot be accessed by <b>ICertServerPolicy::GetCertificateProperty</b>. These properties are not set until after the policy module returns VR_INSTANT_OK and the certificate is issued. See <a href="appprog_7rzt.htm"><b>ICertServerExit::GetCertificateProperty</b></a> for a complete list of all the properties in an issued certificate.

</dd>
<dt>
<b>[VB][JAVA][C++] </b><i>PropertyType</i></dt>
<dd>
Specifies the property type. The type can be one of the following types.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=58%>Type Specifier</th>
<th align=left width=42%>Data Type</th>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_LONG</td>
<td width=42%>Signed long data</td>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_DATE</td>
<td width=42%>Date / Time</td>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_BINARY</td>
<td width=42%>Binary data</td>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_STRING</td>
<td width=42%>String data</td>
</tr>
</table><br>

</dd>
<dt>
<b>[C++]</b> <i>pvarPropertyValue</i></dt>
<dd>
Points to the return value. See Return Value.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns the requested property value.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later (or version 4.0 with the Windows NT 4.0 Option Pack).<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in certif.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use certidl.lib.</p>
<p>&nbsp;</p></body>
</HTML>
