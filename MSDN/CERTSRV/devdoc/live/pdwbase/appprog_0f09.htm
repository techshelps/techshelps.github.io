<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ICertServerPolicy::GetRequestProperty</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_certsrv_icertserverpolicy_getrequestproperty"></a>ICertServerPolicy::GetRequestProperty</h1>
<p>
The <b>GetRequestProperty</b> method returns a named property from a request. Note that the request is used to hold all associated states for the request and the eventual granted certificate that is not a part of the certificate. Thus, data such as revocation times and disposition data are kept in the request data object.</p>
<pre><code><b>[VB] VARIANT GetRequestProperty(
  BSTR</b><i> strPropertyName</i><b>,  </b>
<b>  long</b><i> PropertyType      </i>
<b>);</b>
 
<b>[JAVA] com.ms.Variant GetRequestProperty(</b>
<b>  java.lang.String</b><i> strPropertyName</i><b>,  </b>
<b>  int</b><i> PropertyType                   </i>
<b>);</b>
 
<b>[C++] HRESULT GetRequestProperty(</b>
<b>  BSTR const</b><i> strPropertyName</i><b>,  </b>// in
<b>  LONG</b><i> PropertyType</i><b>,           </b>// in
<b>  VARIANT </b><i>*pvarPropertyValue   </i>// out, return value
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<b>[VB][JAVA][C++]</b> <i>strPropertyName</i></dt>
<dd>
Specifies the named property to retrieve. There are a stock set of request properties that are always valid, referred to as the Name Properties. Other properties valid for certificate requests include the Request Properties and Netscape Request Properties also listed below.
<p>
<b>Name Properties</b>

<p>
These properties can refer to the subject name or the issuer name by prepending Subject or Issuer to the property. For example, Subject.OrgUnit would refer to the subject's organizational unit.


<p>
<b>Note</b>&nbsp;&nbsp;Only Subject name properties are supported in this release (do not prepend Issuer to a property name.)


<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Property Name</th>
<th align=left width=20%>Data Type</th>
<th align=left width=49%>Description</th>
</tr>
<tr valign=top>
<td width=31%>DistinguishedName</td>
<td width=20%>String</td>
<td width=49%>Full X.400 DN Name</td>
</tr>
<tr valign=top>
<td width=31%>RawName</td>
<td width=20%>Binary</td>
<td width=49%>ASN.1 Encoded DN</td>
</tr>
<tr valign=top>
<td width=31%>Country</td>
<td width=20%>String</td>
<td width=49%>X.500 2-character country code (for example US for United States or CA for Canada)</td>
</tr>
<tr valign=top>
<td width=31%>Organization</td>
<td width=20%>String</td>
<td width=49%>Legal name of organization</td>
</tr>
<tr valign=top>
<td width=31%>OrgUnit</td>
<td width=20%>String</td>
<td width=49%>Name of sub-organization or department</td>
</tr>
<tr valign=top>
<td width=31%>CommonName</td>
<td width=20%>String</td>
<td width=49%>Fully qualified hostname/path used in DNS (Domain Name System) lookups (for example, host.company.com)</td>
</tr>
<tr valign=top>
<td width=31%>StreetAddress</td>
<td width=20%>String</td>
<td width=49%>Street address or PO Box</td>
</tr>
<tr valign=top>
<td width=31%>Locality</td>
<td width=20%>String</td>
<td width=49%>Name of city</td>
</tr>
<tr valign=top>
<td width=31%>State</td>
<td width=20%>String</td>
<td width=49%>Full name of state or province (for example, California)</td>
</tr>
<tr valign=top>
<td width=31%>Title</td>
<td width=20%>String</td>
<td width=49%>Title of individual who requested the certificate (optional)</td>
</tr>
<tr valign=top>
<td width=31%>GivenName</td>
<td width=20%>String</td>
<td width=49%>First name of individual</td>
</tr>
<tr valign=top>
<td width=31%>Initials</td>
<td width=20%>String</td>
<td width=49%>Initials of individual (optional)</td>
</tr>
<tr valign=top>
<td width=31%>Surname</td>
<td width=20%>String</td>
<td width=49%>Last name of individual</td>
</tr>
<tr valign=top>
<td width=31%>DomainComponent</td>
<td width=20%>String</td>
<td width=49%>Component of a DNS (Domain Name System) name</td>
</tr>
<tr valign=top>
<td width=31%>E-Mail</td>
<td width=20%>String</td>
<td width=49%>E-mail address</td>
</tr>
</table><br>


<p>
All of the above properties except DistinguishedName, RawName, and Country support multi-valued syntax using an ANSI punctuation character as the separator, which by default must be a comma. The separator character is specified by the HKEY_LOCAL_MACHINE\SYSTEM\\CurrentControlSet\Services\CertSVC\Configuration\&lt;<i>CA Name</i>&gt;\SubjectNameSeparator (REG_SZ) entry in the system registry. This entry is set to a single character string containing a comma, by default. The first character of this string must be an ANSI punctation character to enable the multi-valued syntax. If some other character appears first, or if the registry entry is empty or missing, then multi-valued syntax is disabled.


<p>
<b>Note</b>&nbsp;&nbsp;The RawName property does not exist in KeyGen requests, but can be read by <a href="appprog_44ft.htm"><b>ICertServerExit::GetRequestProperty</b></a> after the policy module has finished processing the request.


<p>
<b>Request Properties</b>

<p>
The following properties are unique to requests and can be accessed by <b>ICertServerPolicy::GetRequestProperty</b>.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=36%>Property Name</th>
<th align=left width=20%>Data Type</th>
<th align=left width=44%>Description</th>
</tr>
<tr valign=top>
<td width=36%>RequestID</td>
<td width=20%>Signed long</td>
<td width=44%>Internal requestID</td>
</tr>
<tr valign=top>
<td width=36%>RawRequest</td>
<td width=20%>Binary</td>
<td width=44%>Raw request bytes</td>
</tr>
<tr valign=top>
<td width=36%>RequestAttributes</td>
<td width=20%>String</td>
<td width=44%>Attribute string (may be truncated)</td>
</tr>
<tr valign=top>
<td width=36%>RequestType</td>
<td width=20%>Signed long</td>
<td width=44%>Indicates PKCS10 or KeyGen request</td>
</tr>
<tr valign=top>
<td width=36%>Status</td>
<td width=20%>Signed long</td>
<td width=44%>Current server status</td>
</tr>
<tr valign=top>
<td width=36%>SubmittedWhen</td>
<td width=20%>Date / Time</td>
<td width=44%>When arrived</td>
</tr>
<tr valign=top>
<td width=36%>RequesterName</td>
<td width=20%>String</td>
<td width=44%>Login name of requester</td>
</tr>
</table><br>


<p>
The RequestType property can be set to one of the following values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Format Value Flags</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>CR_IN_PKCS10 </td>
<td width=52%>PKCS 10 request </td>
</tr>
<tr valign=top>
<td width=48%>CR_IN_KEYGEN </td>
<td width=52%>Keygen request</td>
</tr>
</table><br>



<p>
<b>Note</b>&nbsp;&nbsp;There are additional request properties that cannot be accessed by <b>ICertServerPolicy::GetRequestProperty</b>. These properties are not set until after the policy module finishes processing the request. See <a href="appprog_44ft.htm"><b>ICertServerExit::GetRequestProperty</b></a> for a complete list of all the request properties.


<p>
<b>Netscape Request Properties</b>

<p>
The following properties are unique to Netscape &lt;KEYGEN&gt; style requests.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Property Name</th>
<th align=left width=16%>Type</th>
<th align=left width=51%>Description</th>
</tr>
<tr valign=top>
<td width=33%>Challenge</td>
<td width=16%>String</td>
<td width=51%>Challenge returned by Navigator</td>
</tr>
<tr valign=top>
<td width=33%>ExpectedChallenge</td>
<td width=16%>String</td>
<td width=51%>Challenge issued by server</td>
</tr>
</table><br>


<p>
In addition, other properties may be set by a specific request type, request extensions, or by named attributes set in the header of a request.
</dd>
<dt>
<b>[VB][JAVA][C++] </b><i>PropertyType</i></dt>
<dd>
Specifies the property type. The type can be one of the following types.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=58%>Type Specifier</th>
<th align=left width=42%>Data Type</th>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_LONG</td>
<td width=42%>Signed long data</td>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_DATE</td>
<td width=42%>Date / Time</td>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_BINARY</td>
<td width=42%>Binary data</td>
</tr>
<tr valign=top>
<td width=58%>PROPTYPE_STRING</td>
<td width=42%>String data</td>
</tr>
</table><br>

</dd>
<dt>
<b>[C++]</b> <i>pvarPropertyValue</i></dt>
<dd>
Points to the return value. See Return Value.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns the requested property value.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later (or version 4.0 with the Windows NT 4.0 Option Pack).<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in certif.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use certidl.lib.</p>
<p>&nbsp;</p></body>
</HTML>
