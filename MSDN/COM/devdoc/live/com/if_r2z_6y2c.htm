<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IViewObjectEx::GetNaturalExtent</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iviewobjectex_getnaturalextent"></a>IViewObjectEx::GetNaturalExtent</h2>
<p>
Provides sizing hints from the container for the object to use as the user resizes it.</p>
<pre><code><b>HRESULT GetNaturalExtent(
  DWORD</b><i> dwAspect</i><b>,</b>   //Requested drawing aspect
<b>  LONG</b><i> lindex</i><b>,</b>      //Portion of object for draw operation
<b>  DVTARGETDEVICE*</b><i> ptd</i><b>,</b> 
                    //Pointer to structure describing target device
<b>  HDC</b><i> hicTargetDev</i><b>,</b> 
                    //Information context for <i>ptd</i>
<b>  DVEXTENTINFO*</b><i> pExtentInfo</i><b>,</b> 
                    //Structure specifying sizing data
<b>  LPSIZEL*</b><i> pSizel</i><b>,</b>  //Pointer to sizing data returned by object
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwAspect</i></dt>
<dd>
[in] Requested drawing aspect. It can be any of the values from the <a href="enums_08j8.htm"><b>DVASPECT</b></a> enumeration.</dd>
<dt>
<i>lindex</i></dt>
<dd>
[in] Indicates the portion of the object that is of interest for the draw operation. Its interpretation varies depending on the value in the <i>dwAspect</i> parameter. See the <a href="enums_08j8.htm"><b>DVASPECT</b></a> enumeration for more information.</dd>
<dt>
<i>ptd</i></dt>
<dd>
[in] Pointer to the target device structure that describes the device for which the object is to be rendered. If NULL, the view should be rendered for the default target device (typically the display). A value other than NULL is interpreted in conjunction with <i>hicTargetDev</i> and <i>hdcDraw</i>. For example, if <i>hdcDraw</i> specifies a printer as the device context, the <i>ptd</i> parameter points to a structure describing that printer device. The data may actually be printed if <i>hicTargetDev</i> is a valid value or it may be displayed in print preview mode if <i>hicTargetDev</i> is NULL.</dd>
<dt>
<i>hicTargetDev</i></dt>
<dd>
[in] Specifies the information context for the target device indicated by the <i>ptd</i> parameter from which the object can extract device metrics and test the device's capabilities. If <i>ptd</i> is NULL; the object should ignore the value in the <i>hicTargetDev</i> parameter.</dd>
<dt>
<i>pExtentInfo</i></dt>
<dd>
[in] Pointer to <a href="structs_05bj.htm"><b>DVEXTENTINFO</b></a> structure that specifies the sizing data.</dd>
<dt>
<i>pSizel</i></dt>
<dd>
[out] Pointer to sizing data returned by the object. The returned sizing data is set to -1 for any dimension that was not adjusted. That is if <i>cx</i> is -1 then the width was not adjusted, if <i>cy</i> is -1 then the height was not adjusted. If E_FAIL is returned indicating no size was adjusted then psizel may be NULL.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The sizing hints were successfully returned.</dd>
<dt>
E_FAIL</dt>
<dd>
This method is not implemented for the specified <i>dwAspect</i>, or the size was not adjusted.</dd>
<dt>
E_NOTIMPL</dt>
<dd>
This method was not implemented.
</dd>
</dl>
<h4>Remarks</h4>
<p>
There are two general approaches to sizing a control. The first approach gives the control responsibility for sizing itself; the second approach gives the container responsibility for sizing the control. The first approach is called autosizing. There are two alternatives involved in the second approach: content sizing and integral sizing.</p>
<p>
The <b>IViewObjectEx::GetNaturalExtent</b> method supports both content and integral sizing. In content sizing, the container passes the <a href="structs_05bj.htm"><b>DVEXTENTINFO</b></a> structure to the object into which the object returns a suggested size. In integral sizing, the container passes a preferred size to the object in <b>DVEXTENTINFO</b>, and the object actually adjusts its height. Integral sizing is used when the user rubberbands a new size in design mode.</p>
<p>
Autosizing typically occurs with objects such as the Label control which resizes if the autosize property was enabled and the associated text changed. Autosizing is handled differently depending on the state of the object.</p>
<p>
If the object is inactive, the following occurs:
<ol>
<li>
The object calls <a href="if_o_5bg4.htm"><b>IOleClientSite::RequestNewObjectLayout</b></a>.</li>
<li>
The container calls <a href="if_o_9ypg.htm"><b>IOleObject::GetExtent</b></a> and retrieves the new extents</li>
<li>
The container calls <a href="if_o_38ms.htm"><b>IOleObject::SetExtent</b></a> and adjusts the new extents.</li>
</ol>
<p>
If the object is active, the following occurs:
<ol>
<li>
The object calls <a href="if_o_8mcl.htm"><b>IOleInPlaceSite::OnPosRectChange</b></a> to specify that it requires resizing.</li>
<li>
The container calls <a href="if_o_4sc3.htm"><b>IOleInPlaceObject::SetObjectRects</b></a> and specifies the new size.</li>
</ol>
<p>
The values of the <i>dwAspect</i> parameter can be one of the following <a href="enums_08j8.htm"><b>DVASPECT</b></a> enumeration values:
<dl>
<dt>
DVASPECT_CONTENT</dt>
<dd>
Provide a representation of the control so it can be displayed as an embedded object inside of a container. This value is typically specified for compound document objects. The presentation can be provided for the screen or printer.</dd>
<dt>
DVASPECT_DOCPRINT</dt>
<dd>
Provide a representation of the control on the screen as though it were printed to a printer using the Print command from the File menu. The described data may represent a sequence of pages..</dd>
<dt>
DVASPECT_ICON</dt>
<dd>
Provide an iconic representation of the control.</dd>
<dt>
DVASPECT_THUMBNAIL</dt>
<dd>
Provide a thumbnail representation of an object so it can be displayed in a browsing tool. The thumbnail is approximately a 120 by 120 pixel, 16-color (recommended) device-independent bitmap potentially wrapped in a metafile.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="enums_08j8.htm"><b>DVASPECT</b></a>, <a href="structs_05bj.htm"><b>DVEXTENTINFO</b></a>, <a href="if_o_5bg4.htm"><b>IOleClientSite::RequestNewObjectLayout</b></a>, <a href="if_o_4sc3.htm"><b>IOleInPlaceObject::SetObjectRects</b></a>, <a href="if_o_8mcl.htm"><b>IOleInPlaceSite::OnPosRectChange</b></a>, <a href="if_o_9ypg.htm"><b>IOleObject::GetExtent</b></a>, <a href="if_o_38ms.htm"><b>IOleObject::SetExtent</b></a>, </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
