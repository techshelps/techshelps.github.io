<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistStorage::SaveCompleted</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipersiststorage_savecompleted"></a>IPersistStorage::SaveCompleted</h2>
<p>
Notifies the object that it can revert from NoScribble or HandsOff mode, in which it must not write to its storage object, to Normal mode, in which it can. The object enters NoScribble mode when it receives an <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a> call.</p>
<pre><code><b>HRESULT SaveCompleted(
  IStorage</b><i> *pStgNew  </i>//Pointer to the current storage object
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>pStgNew</i></dt>
<dd>
[in]<b>IStorage</b> pointer to the new storage object, if different from the storage object prior to saving. This pointer can be NULL if the current storage object does not change during the save operation. If the object is in HandsOff mode, this parameter must be non-NULL.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
The object was successfully returned to Normal mode.</dd>
<dt>
E_OUTOFMEMORY </dt>
<dd>
The object remained in HandsOff mode or NoScribble mode due to a lack of memory. Typically, this error occurs when the object is not able to open the necessary streams and storage objects in <i>pStgNew</i>.</dd>
<dt>
E_INVALIDARG </dt>
<dd>
The <i>pStgNew</i> parameter is not valid. Typically, this error occurs if <i>pStgNew</i> is NULL when the object is in HandsOff mode.</dd>
<dt>
E_UNEXPECTED</dt>
<dd>
The object is in Normal mode, and there was no previous call to <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a> or <a href="if_p2q_1z1h.htm"><b>IPersistStorage::HandsOffStorage</b></a>. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method notifies an object that it can revert to Normal mode and can once again write to its storage object. The object exits NoScribble mode or HandsOff mode.</p>
<p>
If the object is reverting from HandsOff mode, the <i>pStgNew</i> parameter must be non-NULL. In HandsOffFromNormal mode, this parameter is the new storage object that replaces the one that was revoked by the <b>IPersistStorage::HandsOffStorage</b> method. The data in the storage object is a copy of the data from the revoked storage object. In HandsOffAfterSave mode, the data is the same as the data that was most recently saved. It is not the same as the data in the revoked storage object.</p>
<p>
If the object is reverting from NoScribble mode, the <i>pStgNew</i> parameter can be NULL or non-NULL. If NULL, the object once again has access to its storage object. If it is not NULL, the component object should simulate receiving a call to its <a href="if_p2q_1z1h.htm"><b>IPersistStorage::HandsOffStorage</b></a> method. If the component object cannot simulate this call, its container must be prepared to actually call the <b>IPersistStorage::HandsOffStorage</b> method.</p>
<p>
The <b>IPersistStorage::SaveCompleted</b> method must recursively call any nested objects that are loaded or running.</p>
<p>
If this method returns an error code, the object is not returned to Normal mode. Thus, the container object can attempt different save strategies.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_7s6d.htm"><b>IAdviseSink::OnSave</b></a>, <a href="if_o_6izq.htm"><b>IOleObject::Close</b></a>, <a href="if_p2q_1z1h.htm"><b>IPersistStorage::HandsOffStorage</b></a>, <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a>, <a href="if_r2z_2ztx.htm"><b>IRootStorage::SwitchToFile</b></a></p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
