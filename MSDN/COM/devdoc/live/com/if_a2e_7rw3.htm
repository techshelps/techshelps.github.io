<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAccessControl::GrantAccessRights</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iaccesscontrol_grantaccessrights"></a>IAccessControl::GrantAccessRights</h2>
<p>
Merges the new ACTRL_ACCESS list with the existing access rights on the object.</p>
<pre><code><b>HRESULT GrantAccessRights(
  PACTRL_ACCESSW</b><i> pAccessList  </i>//Pointer to the access list
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pAccessList</i></dt>
<dd>
[in] Pointer to the ACTRL_ACCESSW list.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Merging the new ACTRL_ACCESSW list with the existing access rights ensures that the object will have at least the indicated access rights. This merging consists of adding the supplied access before any of the existing rights. None of the existing rights are removed.</p>
<p>
Following a merge, the access rights on an object are as follows:</p>
<p class=indent1>
[New Access Denied] [Old Access Denied] [New Access Allowed]</p>
<p class=indent2>
[Old Access Allowed]</p>
<p>
<b>GrantAccessRights</b> uses the ACTRL_ACCESSW structure, which contains a list of access lists to write to the object. The ACTRL_ACCESSW list takes an optional property name. In the case of Windows NT objects, this property name is the string representation of the property GUID. For interfaces that do not take an ACTRL_ACCESSW parameter, an optional property name parameter is provided.</p>
<p>
ACTRL_ACCESSW is defined as follows:</p>
<pre><code>typedef struct 
    {
        ULONG                   cEntries; //# of prop access lists
        PACTRL_PROPERTY_ENTRYW  pPropertyAccessList; //pointer to 
                                //property access lists to write to 
                                //the object
    } ACTRL_ACCESSW, *PACTRL_ACCESSW, ACTRL_AUDITW, *P ACTRL_AUDITW
 </code></pre>
<p>
The <i>pPropertyAccessList</i> member points to an ACTRL_PROPERTY_ENTRYW structure, defined as follows:</p>
<pre><code>typedef struct _ACTRL_PROPERTY_ENTRYW
    {
        LPWSTR                     lpProperty; //pointer to prop name
        PACTRL_ACCESS_ENTRY_LISTW  pAccessEntryList; //pointer to the
                                   // access entry list (may be NULL)
        ULONG                      fListFlags; //property entry info
    } ACTRL_PROPERTY_ENTRYW, *PACTRL_PROPERTY_ENTRYW
 </code></pre>
<p>
The <i>pAccessEntryList</i> points to an ACTRL_ACCESS_ENTRY_LISTW structure, which is defined as follows:</p>
<pre><code>typedef struct _ACTRL_ACCESS_ENTRY_LISTW
    {
        ULONG                  cEntries; //number of entries
        PACTRL_ACCESS_ENTRYW    pAccessList; //pointer to entry list
    } ACTRL_ACCESS_ENTRY_LISTW, *PACTRL_ACCESS_ENTRY_LISTW
 </code></pre>
<p>
The <i>pAccessList</i> member points to an ACTRL_ACCESS_ENTRY structure, which is defined as follows:</p>
<pre><code>typedef struct _ACTRL_ACCESS_ENTRYW
    {
        TRUSTEE_W        Trustee;            //the trustee
        ULONG            fAccessFlags;       //access entry flags
        ACCESS_RIGHTS    Access;             //access rights
        ACCESS_RIGHTS    ProvSpecificAccess; //provider-specific
                                             // access rights
        INHERIT_FLAGS    Inheritance;        //inheritance 
        LPWSTR           lpInheritProperty;  //option-inheritance type
    } ACTRL_ACCESS_ENTRYW, *PACTRL_ACCESS_ENTRYW;
 </code></pre>
<p>
The currently supported <i>fAccessFlags</i> flags are:</p>
<pre><code>ACTRL_ACCESS_ALLOWED     0x00000001
    ACTRL_ACCESS_DENIED      0x00000002
 </code></pre>
<p>
The system-supplied implementation of <b>GrantAccessRights</b> (CLSID_DCOMAccessControl) requires that the <i>cEntries </i>member of the ACTRL_ACCESSW structure be set to exactly 1. In addition, the <i>lpProperty</i> member of the ACTRL_PROPERTY_ENTRYW structure must be NULL. </p>
<p>
COM formats all character strings as UNICODE. For computers running Windows 95, you must convert all ANSI strings to UNICODE before passing them to <b>GrantAccessRights</b>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Available as a Windows 95 redistributable.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleext.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_3ypf.htm"><b>IAccessControl::GetAllAccessRights</b></a>, <a href="if_a2e_4a2b.htm"><b>IAccessControl::SetAccessRights</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
