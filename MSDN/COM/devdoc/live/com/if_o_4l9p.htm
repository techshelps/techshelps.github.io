<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleUndoManager::DiscardFrom</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleundomanager_discardfrom"></a>IOleUndoManager::DiscardFrom</h2>
<p>
Instructs the undo manager to discard the specified undo unit and all undo units below it on the undo or redo stack.</p>
<pre><code><b>HRESULT DiscardFrom(
  IOleUndoUnit*</b><i> pUU</i>   //Pointer to undo unit to be discarded
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pUU</i></dt>
<dd>
[in] Pointer to undo unit to be discarded. This parameter can be NULL to discard the entire undo or redo stack.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The specified undo unit was successfully discarded.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
The specified undo unit was not found in the stacks.</dd>
<dt>
E_UNEXPECTED</dt>
<dd>
The undo manager is disabled.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The undo manager first searches the undo stack for the given unit, and if not found there searches the redo stack. Once found, the given unit and all below it on the same stack are discarded. The undo unit may be a child of a parent unit contained by the undo manager, as determined by calling <b>IOleParentUndoUnit::FindUnit</b>. If it is a child unit, then the root unit containing the given unit and all units below it on the appropriate stack are discarded.</p>
<p>
If there is an open parent unit and <b>DiscardFrom(NULL)</b> is called, the undo manager should immediately release and discard the open parent unit without calling the <b>Close</b> method first. When the object that opened the parent unit attempts to close it, <a href="if_o_66g5.htm"><b>IOleUndoManager::Close</b></a> will return S_FALSE. If <i>pUU</i> is not NULL, then any open parent units should be left open.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_2eus.htm"><b>IOleParentUndoUnit::FindUnit</b></a>, <a href="if_o_66g5.htm"><b>IOleUndoManager::Close</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
