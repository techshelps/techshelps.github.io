<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Persistent Property Sets</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_persistent_property_sets"></a>Persistent Property Sets</h1>
<p>
While the kind of run-time properties that Automation and ActiveX Controls offer are important, they do not directly address the need to store information with objects persistently stored in the file system. These entities could include files (structured, compound, etc.), directories, and summary catalogs. COM provides both a standard serialized format for these persistent properties, and a set of interfaces and functions that allow you to create and manipulate the property sets and their properties.</p>
<p>
Persistent properties are stored as sets, and one or more sets may be associated with a file system entity. These persistent property sets are intended to be used to store data that is suited to being represented as a collection of fine-grained values. They are not intended to be used as a large data base. They can be used to store summary information about an object on the system, which can then be accessed by any other object that understands how to interpret that property set.</p>
<p>
Previous versions of COM specified very little with respect to properties and their usage, but did define a serialized format that allowed developers to store properties and property sets in an <b>IStorage</b> instance. The property identifiers and semantics of a single property set, used for summary information about a document, was also defined. At that time, it was necessary to create and manipulate that structure directly as a data stream. For information on the property set serialized data format structure, refer to <a href="propsets_2d2s.htm"><b>OLE Serialized Property Set Format</b></a>.</p>
<p>
Now, however, COM defines two primary interfaces to manage property sets:
<ul>
<li>
<a href="if_p2q_80md.htm"><b>IPropertyStorage</b></a> </li>
<li>
<a href="if_p2q_8g4l.htm"><b>IPropertySetStorage</b></a> </li>
</ul>
<p>
It is no longer necessary to deal with the serialized format directly when these interfaces are implemented on an object that supports the <a href="if_r2z_9b8l.htm"><b>IStorage</b></a> interface (such as compound files). Writing properties through <b>IPropertySetStorage</b> and <b>IPropertyStorage</b> creates data that exactly conforms to the COM property set format, as viewed through <b>IStorage</b> methods. The converse is also true—properties written to the COM property set format using <b>IStorage</b> are visible through <b>IPropertySetStorage</b> and <b>IPropertyStorage</b> (although you cannot expect to write to IStream and have the properties through <b>IPropertyStorage</b> immediately available, or vice versa).</p>
<p>
The <b>IPropertySetStorage</b> interface defines methods that create and manage property sets. The <b>IPropertyStorage</b> interface directly manipulates the properties within a property set. By calling the methods of these interfaces, an application developer can manage whatever property sets are appropriate for a given file system entity. Use of these interfaces provides one tuned reading and writing implementation for properties, rather than having an implementation in each application, which could suffer performance bottlenecks such as incessant seeking. You can implement the interfaces to enhance performance, so properties can be read and written more quickly by, for example, more efficient caching. Furthermore, <b>IPropertyStorage</b> and <b>IPropertySetStorage</b> make it possible to manipulate properties on entities that do not support <b>IStorage</b>, although in general, most applications will not do so. </p>
<p>&nbsp;</p></body>
</HTML>
