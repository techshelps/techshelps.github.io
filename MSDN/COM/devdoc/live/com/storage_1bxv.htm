<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Performance Characteristics</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_performance_characteristics"></a>Performance Characteristics</h2>
<p>
A call to the COM compound file implementation of <b>IPropertySetStorage</b> interface to create a property set causes either a stream or storage to be created through a call to <a href="if_r2z_9wz1.htm"><b>IStorage::CreateStream</b></a> or <a href="if_r2z_8vfp.htm"><b>IStorage::CreateStorage</b></a>. A default property set is created in memory, but not flushed to disk. When there is a call to <a href="if_p2q_0bj9.htm"><b>IPropertyStorage::WriteMultiple</b></a>, it operates within the buffer.</p>
<p>
When a property set is opened, <b>IStorage::OpenStream</b> or <b>IStorage::OpenStorage</b> is used. The <i>entire </i>property set stream is read into contiguous memory. <a href="if_p2q_6xd1.htm"><b>IPropertyStorage::ReadMultiple</b></a> operations then operate by reading the memory buffer. Therefore, the first access is expensive in terms of time (because of disk reads) but subsequent accesses are very efficient. Writes may be slightly more expensive because SetSize operations on the underlying stream may be required to guarantee that disk space is available if data is added.</p>
<p>
No guarantees are made as to whether <b>IPropertyStorage::WriteMultiple</b> will flush updates. In general, the client should assume that<b> IPropertyStorage::WriteMultiple</b> only updates the in memory buffer. To flush data, <b>IPropertyStorage::Commit</b> or <b>IPropertyStorage::Release</b> (last release) should be called.</p>
<p>
This design means that <b>WriteMultiple</b> may succeed but the data is not actually persistently written.</p>
<p>
<b>Note</b>&nbsp;&nbsp;This size of the property set stream may not exceed 256K bytes.</p>
<p>&nbsp;</p></body>
</HTML>
