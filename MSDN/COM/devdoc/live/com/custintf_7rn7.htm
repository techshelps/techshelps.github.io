<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interface Design Rules</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_interface_design_rules"></a>Interface Design Rules</h1>
<p>
This section is a short summary of interface design rules and guidelines. Some of these rules are specific to the COM architecture, while others are restrictions imposed by the interface design language, MIDL. For details of COM interface design, see Anatomy of an IDL File.</p>
<p>
By definition, an object is not a COM object unless it implements either the <a href="if_r2z_9dwu.htm"><b>IUnknown</b></a> interface or an interface that is derived from <b>IUnknown</b>. In addition, the following rules apply to all interfaces implemented on a COM object:
<ul>
<li>
They must have a unique interface identifier (IID).</li>
<li>
They must be immutable. Once they are created and published, no part of their definition may change.</li>
<li>
All interface methods must return an <b>HRESULT</b> so the portions of the system that handle remote processing can report RPC errors.</li>
<li>
All string parameters in interface methods must be Unicode.</li>
<li>
Your data types must be remotable. If you cannot convert a data type to a remotable type, you will have to create your own marshaling and unmarshaling routines. Also, <b>LPVOID</b>, or void * has no meaning on a remote machine. Use a pointer to <b>IUnknown</b>, if necessary.</li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;The current implementation of MIDL does not handle function overloading or multiple inheritance. </p>
<h4>Other Interface Design Considerations</h4>
<p>
Use pointers to data very carefully. To re-create the data in the address space of the process that is called, the RPC run time must know the exact size of the data. If, for example, a <b>CHAR *</b> parameter points to a buffer of characters rather than to a single character, the data cannot be correctly re-created. Use the syntax available with MIDL to accurately describe the data structures represented by your type definitions.</p>
<p>
Initialization is essential for pointers that are embedded in arrays and structures and passed across process boundaries. Uninitialized pointers may work when passed to a program in the same process space, but proxies and stubs assume that all pointers are initialized with valid addresses or are null.</p>
<p>
Be careful when aliasing pointers (allowing pointers to point to the same piece of memory). If the aliasing is intentional, these pointers should be declared aliased in the IDL file. Pointers declared as nonaliased should never alias each other.</p>
<p>
Pay attention to how you allocate and free memory. Remember that, unless you explicitly tell a COM object (by using the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_allocate">
</object><a href=JavaScript:alink_1.Click()><b>allocate</b></a> attribute) not to free a data structure that was created during an out-of-process call, that structure will be destroyed when the call completes. Also, consider the potentially destructive overhead created by inefficient allocation of data structures that now need to be marshaled and unmarshaled.</p>
<p>
Finally, be careful when defining your HRESULT return values so that you don't create error codes that conflict with COM-defined FACILITY_ITF codes (values between 0x0000 and 0x01FF are reserved), or that conflict with other HRESULTs with the same value. Whenever possible, use the universal COM success and failure return values, and use an <b>out</b> parameter, rather than an HRESULT, to return information specific to the function call.</p>
<p>
For more information on defining interfaces see <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_interface_definitions_and_type_libraries">
</object><a href=JavaScript:alink_2.Click()>Interface Definitions and Type Libraries</a> in the MIDL Programmer's Guide.</p>
<p>&nbsp;</p></body>
</HTML>
