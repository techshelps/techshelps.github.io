<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Property ID One</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_property_id_one"></a>Property ID 1</h2>
<p>
Property ID 1 is reserved as an indicator of which code page (Windows) or Script (Macintosh) to use when interpreting the strings in the property set. All string values in the property set must be stored with the same code page. The originating operating system value in the property set header (PROPERTYSETHEADER::dwOSVer) determines whether the code page indicator corresponds to a Windows code page or Macintosh script.</p>
<p>
When an application that is not the author of a property set changes a property of type string in the set, it should examine the code page indicator and take one of the following actions:
<ul>
<li>
Write the string in the format specified by the code page indicator.</li>
<li>
Replace and rewrite to change the code page.</li>
</ul>
<p>
If an application cannot understand this indicator, it should not modify the property. All creators of property sets must write a code page indicator; however, if the code page indicator is not present, the prevailing code page on the reader's machine must be assumed.</p>
<p>
<b>Note</b>&nbsp;&nbsp;If the <b>IPropertySetStorage</b> interface is used to create a property set, the code page indicator is automatically written.</p>
<p>
Possible values for the code page are given in the Win32 API (see the <b>GetACP</b> function) and <i>Inside Macintosh Volume VI, </i>§<i>14-111</i>. For example, the code page US ANSI is represented by 0x04E4 (1252 in decimal) while the code page for Unicode is 0x04B0 (1200 in decimal).</p>
<p>
It is recommended that the Unicode code page be used whenever possible, and use VT_LPWSTR instead of VT_LPSTR to avoid multibyte &lt;-&gt; Unicode conversions during storage and retrieval. Using the same code page for all property sets is the only way to achieve interoperable property sets on a worldwide basis. In either the Unicode or non-Unicode code page, note that the count at the start of a VT_LPSTR or VT_BSTR is a <b>byte</b> count and not a <b>character</b> count. This byte count includes the one or two zero bytes at the end of the string (the string's NULL terminator).</p>
<p>
Property ID 1 is a VT_12 type and thus starts with a DWORD containing the value VT_12 followed by a USHORT indicating the code page.</p>
<p>&nbsp;</p></body>
</HTML>
