<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleLink::SetSourceMoniker</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iolelink_setsourcemoniker"></a>IOleLink::SetSourceMoniker</h2>
<p>
Specifies the new link source of a linked object using a moniker. </p>
<pre><code><b>HRESULT SetSourceMoniker(
  IMoniker</b><i> *pmk</i><b>,  </b>//Pointer to a moniker identifying new link source
<b>  REFCLSID</b><i> rclsid </i>//CLSID of link source
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pmk</i></dt>
<dd>
[in] Pointer to the <b>IMoniker</b> interface on a moniker that identifies the new link source of the linked object. A value of NULL breaks the link. </dd>
<dt>
<i>rclsid</i></dt>
<dd>
[in] Specifies the CLSID of the link source that the linked object should use to access information about the linked object when it is not bound. 
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The moniker was set successfully.
</dd>
</dl>
<h4>Remarks</h4>
<h5>Notes to Callers</h5>
<p>
Your container application can call <b>IOleLink::SetSourceMoniker</b> when the end user changes the source of a link or breaks a link. Note that this requires your container to use the <a href="api2_8hb9.htm"><b>MkParseDisplayName</b></a> function to create a moniker out of the display name that the end user enters. If you'd rather have the linked object perform the parsing, your container can call <b>IOleLink::SetSourceDisplayName</b> instead of <b>IOleLink::SetSourceMoniker</b>. </p>
<p>
The end user changes the source of a link or breaks a link using the Links dialog box. If you use the <a href="api3_4yib.htm"><b>OleUIEditLinks</b></a> function to display the Links dialog box, you must implement the <b>IOleUILinkContainer</b> interface. The dialog box calls your implementations of <b>IOleUILinkContainer::SetLinkSource</b> and <b>IOleUILinkContainer::CancelLink</b>; your implementation of these methods can call <b>IOleLink::SetSourceMoniker</b>. </p>
<p>
If the linked object is currently bound to its link source, the linked object's implementation of <b>IOleLink::SetSourceMoniker</b> closes the link before changing the moniker.</p>
<h5>Notes on Provided Implementation</h5>
<p>
The <b>IOleLink</b> contract does not specify how the linked object stores or uses the link source moniker. The provided implementation stores the absolute moniker specified when the link is created or when the moniker is changed; it then computes and stores a relative moniker. Future implementations might manage monikers differently to provide better moniker tracking. The absolute moniker provides the complete path to the link source. The linked object uses this absolute moniker and the moniker of the compound document to compute a relative moniker that identifies the link source relative to the compound document that contains the link.</p>
<pre><code>pmkCompoundDoc-&gt;RelativePathTo(pmkAbsolute, ppmkRelative) 
 </code></pre>
<p>
When binding to the link source, the linked object first tries to bind using the relative moniker. If that fails, it tries to bind the absolute moniker. </p>
<p>
When the linked object successfully binds using either the relative or the absolute moniker, it automatically updates the other moniker. The linked object also updates both monikers when it is bound to the link source and it receives a rename notification through the <a href="if_a2e_73fp.htm"><b>IAdviseSink::OnRename</b></a> method. A container application can also use the <b>IOleLink::SetSourceDisplayName</b> method to change a link's moniker.</p>
<p>
The linked object's implementation of <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a> saves both the relative and the absolute moniker.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_2x0y.htm"><b>IOleLink::GetSourceMoniker</b></a>, <a href="if_o_7ew5.htm"><b>IOleLink::SetSourceDisplayName</b></a>, <a href="if_o_9bg2.htm"><b>IOleUILinkContainer</b></a>, <a href="api3_4yib.htm"><b>OleUIEditLinks</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
