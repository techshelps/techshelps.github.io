<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using IConnectionPoint</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_using_iconnectionpoint"></a>Using IConnectionPoint</h2>
<p>
Once the client has a pointer to a connection point, it can then perform several operations as expressed through <b>IConnectionPoint</b>. First, <b>GetConnectionInterface</b>, as noted above, retrieves the outgoing interface IID supported by the connection point. When used in conjunction with <b>IEnumConnectionPoints, </b>this method allows the client to examine the IIDs of all outgoing interfaces supported on the connectable object.</p>
<p>
Second, a client can navigate from the connection point back to the connectable object's <b>IConnectionPointContainer</b> interface through the <b>GetConnectionPointContainer</b> method.</p>
<p>
Third, the most interesting methods for the client are <b>Advise</b> and <b>Unadvise</b>. When a client wishes to connect its own sink object to the connectable object, the client passes the sink's <b>IUnknown</b> pointer (or any other interface pointer on the same object) to <b>Advise</b>. The connection point queries the sink for the specific outgoing interface that is expected. If that interface is available on the sink, the connection point then stores the interface pointer. From this point until <b>Unadvise</b> is called, the connectable object will make calls to the sink through this interface when events occur. To disconnect the sink from the connection point, the client passes a key returned from <b>Advise</b> to the <b>Unadvise</b> method. <b>Unadvise</b> must call <b>Release</b> on the sink interface.</p>
<p>
Finally, a client can ask a connection point to enumerate all the connections that exist to it through <b>EnumConnections</b>. This method creates an enumerator object (with a separate reference count) returning an <b>IEnumConnections</b> pointer to it. The client must call <b>Release</b> when the enumerator is no longer needed. Additionally, the enumerator returns a series of <b>CONNECTDATA</b> structures, one for each connection. Each structure describes one connection using the <b>IUnknown</b> pointer of the sink as well as the connection key originally returned from <b>Advise</b>. When done with these sink interface pointers, the client must call <b>IUnknown::Release</b> on each pointer returned in a <b>CONNECTDATA</b> structure.</p>
<p>&nbsp;</p></body>
</HTML>
