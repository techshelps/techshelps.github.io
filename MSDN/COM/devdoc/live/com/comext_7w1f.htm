<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GUID Creation and Optimizations</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_guid_creation_and_optimizations"></a>GUID Creation and Optimizations</h2>
<p>
Because a CLSID, like an interface identifier (IID), is a GUID, no other class, no matter who writes it, has a duplicate CLSID. Server implementers generally obtain CLSIDs through the <a href="api1_05r8.htm"><b>CoCreateGUID</b></a><i> </i>function in COM. This function is guaranteed to produce unique CLSIDs, so server implementors across the world can independently develop and deploy their software without fear of accidental collision with software written by others.</p>
<p>
Using unique CLSIDs avoids the possibility of name collisions among classes because CLSIDs are in no way connected to the names used in the underlying implementation. So, for example, two different vendors can write classes called "StackClass," but each would have a unique CLSID and therefore could not be confused.</p>
<p>
COM frequently must map GUIDs (IIDs and CLSIDs) to some arbitrarily large set of other values. As an application developer, you can help speed up such searches, and thereby enhance system performance, by generating the GUIDs for your application as a block of consecutive values.</p>
<p>
The most efficient way to generate a block of consecutive GUIDs is to run the uuidgen utility using the /n switch, which generates a block of UUIDs, each of whose first DWORD value is incremented by one. (For more information on using the uuidgen utility, see "<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_rpc_the_uuidgen_utility">
</object><a href=JavaScript:alink_1.Click()>The uuidgen Utility</a>.")</p>
<p>
For example, if you were to type</p>
<pre><code>uuidgen -n5 -s &gt;guids.txt 
 </code></pre>
<p>
the uuidgen utility would generate a block of UUIDs similar to the following:</p>
<pre><code>{12340001-4980-1920-6788-123456789012} 
{12340002-4980-1920-6788-123456789012} 
{12340003-4980-1920-6788-123456789012} 
{12340004-4980-1920-6788-123456789012} 
{12340005-4980-1920-6788-123456789012} 
 </code></pre>
<p>
One method for generating and tracking GUIDs for an entire project begins with generating a block of some arbitrarily large number of UUIDs — say, 500. For example, if you were to type</p>
<pre><code>uuidgen -n500 -s &gt;guids.txt 
 </code></pre>
<p>
the utility would generate 500 consecutive UUIDs and write them to the specified text file. You could then check this file into your source tree, providing a single repository for all GUIDs to be used in a project. As people require GUIDs for their portions of the project, they can check out the file, take however many GUIDs they need, marking them as taken and leaving a note about where in the code or "spec" they are using them.</p>
<p>
In addition to improving system performance, generating blocks of consecutive GUIDs in this way has the following benefits:
<ul>
<li>
A central file containing all GUIDs for an application makes it easy to keep track of which GUIDs are for what and which people are using them.</li>
<li>
A block of consecutive GUIDs associated with a particular application helps developers and testers recognize internal GUIDs during debugging and makes it easier to find them in the system registry because they are stored sequentially.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
