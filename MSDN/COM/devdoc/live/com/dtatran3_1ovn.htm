<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Data Transfer Interfaces</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_data_transfer_interfaces"></a>Data Transfer Interfaces</h1>
<p>
The <a href="if_a2e_24z8.htm"><b>IDataObject</b></a><b> </b>interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes. When obtaining data, a caller can specify the format in which it wants to render the data. The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</p>
<p>
By itself, <b>IDataObject</b> supplies all the tools you need to implement Microsoft® Windows® clipboard transfers or compound document transfers in your applications. If you also want to support drag and drop transfers, you need to implement the <a href="if_a2e_12jp.htm"><b>IDropSource</b></a> and <a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a><b> interfaces</b>along with <b>IDataObject</b>.</p>
<p>
The <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interface combined with OLE clipboard APIs provide all the capabilities of the Microsoft® Win32® clipboard APIs. Using both the platform's clipboard APIs and OLE's is usually redundant and unnecessary. Suppliers of data that support either drag and drop transfers or OLE compound documents <i>must</i> implement the <b>IDataObject</b> interface. If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement <b>IDataObject</b> and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later. You may also want to implement <b>IDataObject</b> in order to utilize transfer media other than global memory.</p>
<p>
The following table summarizes which ones to use, depending on what types of data transfer you want to support:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>If You Want to Support</th>
<th align=left width=52%>You Must Use</th>
</tr>
<tr valign=top>
<td width=48%>Compound documents</td>
<td width=52%><a href="if_a2e_24z8.htm"><b>IDataObject</b></a></td>
</tr>
<tr valign=top>
<td width=48%>Drag and drop transfers</td>
<td width=52%><a href="if_a2e_24z8.htm"><b>IDataObject</b></a>, <a href="if_a2e_12jp.htm"><b>IDropSource</b></a>, <a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a>, <a href="api2_5now.htm"><b>DoDragDrop</b></a> (or the equivalent)</td>
</tr>
<tr valign=top>
<td width=48%>Windows clipboard transfers using global memory exclusively</td>
<td width=52%>Windows clipboard APIs</td>
</tr>
<tr valign=top>
<td width=48%>Windows clipboard transfers using exchange mediums other than global memory.</td>
<td width=52%><a href="if_a2e_24z8.htm"><b>IDataObject</b></a></td>
</tr>
<tr valign=top>
<td width=48%>Clipboard transfers now but drag and drop or compound documents later</td>
<td width=52%><a href="if_a2e_24z8.htm"><b>IDataObject</b></a> and the interfaces and function listed above for "Drag and drop transfers"</td>
</tr>
</table><br>
<p>
When a user initiates a data transfer operation, the source application creates an instance of <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> and through it makes the data available in one or more formats. In a clipboard transfer, the application calls the <a href="api3_55r8.htm"><b>OleSetClipboard</b></a> function to pass a data-object pointer to OLE. (<b>OleSetClipboard</b> also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the <a href="api2_5now.htm"><b>DoDragDrop</b></a> function instead. </p>
<p>
On the receiving side of the transfer, the destination receives the <b>IDataObject</b> pointer either as an argument to an invocation of <a href="if_a2e_9oog.htm"><b>IDropTarget::Drop</b></a> or by calling the <a href="api3_4rtw.htm"><b>OleGetClipboard</b></a> function, depending on whether the transfer is by means of drag and drop or the clipboard. Having obtained this pointer, the destination calls <a href="if_a2e_6xyb.htm"><b>IDataObject::EnumFormatEtc</b></a> to learn what formats are available for retrieval and on what types of media they can be obtained. Armed with this information, the receiving application requests the data with a call to <a href="if_a2e_1jz5.htm"><b>IDataObject::GetData</b></a>. </p>
<p>&nbsp;</p></body>
</HTML>
