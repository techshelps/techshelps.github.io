<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Surrogate Sharing</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_com_surrogate_sharing"></a>Surrogate Sharing</h3>
<p>
DLL servers will share a surrogate if they have matching security identities and share the same AppID value.</p>
<p>
DLL servers are loaded, by default, into their own surrogate process. To load other DLL servers into an existing surrogate, so it supports more than one DLL servers, there are two requirements:
<ol>
<li>
The DLL servers must have the same AppID value.</li>
<li>
The security context of the DLL servers must be the same.</li>
</ol>
<p>
If two dll servers are to be launched under different security identities, they must be in different surrogates, regardless of whether or not their AppID's match.</p>
<p>
Following is an example of administering surrogate sharing with AppIDs:</p>
<pre><code>AppID
        {12345678-0000-0000-0000-abcdabcdabcd}
            @DllSurrogate    REG_SZ
    CLSID
        {12345678-0000-0000-0000-000000000001}
            @AppId    REG_SZ    {12345678-0000-0000-0000-abcdabcdabcd}
            InProcServer32
    @    REG_SZ    c:\myapp\comp1.dll
        {12345678-0000-0000-0000-000000000002}
            @AppId    REG_SZ    {12345678-0000-0000-0000-abcdabcdabcd}
            InProcServer32
    @    REG_SZ    c:\myapp\comp2.dll
 </code></pre>
<p>
The two CLSIDs for DLL components comp1.dll and comp2.dll have been configured to share an AppID.  The AppID specifies that the DLL server can be loaded in a surrogate by specifying the <b>DllSurrogate</b> named-value.  In this example the <b>DllSurrogate</b> named-value is an empty string, indicating that the default system implementation of the DLL surrogate should be used.</p>
<p>&nbsp;</p></body>
</HTML>
