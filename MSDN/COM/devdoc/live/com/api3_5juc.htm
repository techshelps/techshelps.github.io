<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleUIInsertObject</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleuiinsertobject"></a>OleUIInsertObject</h1>
<p>
Invokes the standard Insert Object dialog box, which allows the user to select an object source and class name, as well as the option of displaying the object as itself or as an icon.</p>
<pre><code><b>UINT OleUIInsertObject(
  LPOLEUIINSERTOBJECT</b><i> lpIO  </i>//Pointer to the in-out structure
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>lpIO</i></dt>
<dd>
[in] Pointer to the in-out <a href="structs_2f02.htm"><b>OLEUIINSERTOBJECT</b></a> structure for this dialog box.
</dd>
</dl>
<h4>Return Values</h4>
<p>
<i>Standard Success/Error Definitions</i>
<dl>
<dt>
OLEUI_FALSE</dt>
<dd>
Unknown failure (unused).</dd>
<dt>
OLEUI_SUCCESS</dt>
<dd>
No error, same as OLEUI_OK.</dd>
<dt>
OLEUI_OK</dt>
<dd>
The user pressed the OK button.</dd>
<dt>
OLEUI_CANCEL</dt>
<dd>
The user pressed the Cancel button.
</dd>
</dl>
<p>
<i>Standard Field Validation Errors</i>
<dl>
<dt>
OLEUI_ERR_STANDARDMIN</dt>
<dd>
Errors common to all dialog boxes lie in the range OLEUI_ERR_STANDARDMIN to OLEUI_ERR_STANDARDMAX. This value allows the application to test for standard messages in order to display error messages to the user.</dd>
<dt>
OLEUI_ERR_STRUCTURENULL</dt>
<dd>
The pointer to an OLEUIXXX structure passed into the function was NULL.</dd>
<dt>
OLEUI_ERR_STRUCTUREINVALID</dt>
<dd>
Insufficient permissions for read or write access to an OLEUIXXX structure.</dd>
<dt>
OLEUI_ERR_CBSTRUCTINCORRECT</dt>
<dd>
The <i>cbstruct</i> value is incorrect.</dd>
<dt>
OLEUI_ERR_HWNDOWNERINVALID</dt>
<dd>
The <i>hWndOwner</i> value is invalid. </dd>
<dt>
OLEUI_ERR_LPSZCAPTIONINVALID</dt>
<dd>
The <i>lpszCaption</i> value is invalid. </dd>
<dt>
OLEUI_ERR_LPFNHOOKINVALID</dt>
<dd>
The <i>lpfnHook </i>value is invalid.</dd>
<dt>
OLEUI_ERR_HINSTANCEINVALID</dt>
<dd>
The <i>hInstance</i> value is invalid.</dd>
<dt>
OLEUI_ERR_LPSZTEMPLATEINVALID</dt>
<dd>
The <i>lpszTemplate</i> value is invalid.</dd>
<dt>
OLEUI_ERR_HRESOURCEINVALID</dt>
<dd>
The <i>hResource</i> value is invalid.
</dd>
</dl>
<p>
<i>Initialization Errors</i>
<dl>
<dt>
OLEUI_ERR_FINDTEMPLATEFAILURE</dt>
<dd>
Unable to find the dialog box template.</dd>
<dt>
OLEUI_ERR_LOADTEMPLATEFAILURE</dt>
<dd>
Unable to load the dialog box template.</dd>
<dt>
OLEUI_ERR_DIALOGFAILURE</dt>
<dd>
Dialog box initialization failed.</dd>
<dt>
OLEUI_ERR_LOCALMEMALLOC</dt>
<dd>
A call to <b>LocalAlloc</b> or the standard <i>IMalloc</i> allocator failed.</dd>
<dt>
OLEUI_ERR_GLOBALMEMALLOC</dt>
<dd>
A call to <b>GlobalAlloc</b> or the standard <i>IMalloc</i> allocator failed.</dd>
<dt>
OLEUI_ERR_LOADSTRING</dt>
<dd>
Unable to <b>LoadString</b> localized resources from the library.</dd>
<dt>
OLEUI_ERR_OLEMEMALLOC</dt>
<dd>
A call to the standard <i>IMalloc</i> allocator failed.
</dd>
</dl>
<p>
<i>Function Specific Errors </i>
<dl>
<dt>
OLEUI_ERR_STANDARDMAX</dt>
<dd>
Errors common to all dialog boxes lie in the range OLEUI_ERR_STANDARDMIN to OLEUI_ERR_STANDARDMAX. This value allows the application to test for standard messages in order to display error messages to the user.</dd>
<dt>
OLEUI_IOERR_LPSZFILEINVALID</dt>
<dd>
The <i>lpszFile</i> value is invalid or user has insufficient write access permissions.. This <i>lpszFile</i> member points to the name of the file linked to or inserted. </dd>
<dt>
OLEUI_IOERR_LPFORMATETCINVALID</dt>
<dd>
The <i>lpFormatEtc</i> value is invalid. This member identifies the desired format. </dd>
<dt>
OLEUI_IOERR_PPVOBJINVALID</dt>
<dd>
The <i>ppvOjb</i> value is invalid. This member points to the location where the pointer for the object is returned. </dd>
<dt>
OLEUI_IOERR_LPIOLECLIENTSITEINVALID</dt>
<dd>
The <i>lpIOleClientSite</i> value is invalid. This member points to the client site for the object.</dd>
<dt>
OLEUI_IOERR_LPISTORAGEINVALID</dt>
<dd>
The <i>lpIStorage</i> value is invalid. This member points to the storage to be used for the object.</dd>
<dt>
OLEUI_IOERR_SCODEHASERROR</dt>
<dd>
The <i>sc</i> member of <i>lpIO</i> has additional error information. </dd>
<dt>
OLEUI_IOERR_LPCLSIDEXCLUDEINVALID</dt>
<dd>
The <i>lpClsidExclude</i> value is invalid. This member contains the list of CLSIDs to exclude. </dd>
<dt>
OLEUI_IOERR_CCHFILEINVALID</dt>
<dd>
The <i>cchFile</i> or <i>lpszFile </i>value is invalid. The <i>cchFile</i> member specifies the size of the <i>lpszFile</i> buffer. The <i>lpszFile </i> member points to the name of the file linked to or inserted.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>OleUIInsertObject</b> allows the user to select the type of object to be inserted from a list box containing the object applications registered on the user's system. To populate that list box, <b>OleUIInsertObject</b> traverses the registry, adding every object server it finds that meets the following criteria:
<ul>
<li>
The registry entry does not include the <b>NotInsertable</b> key.</li>
<li>
The registry entry includes an OLE 1.0 style <b>Protocol\\StdFileEditing\\Server</b> key.</li>
<li>
The registry entry includes the <b>Insertable</b> key.</li>
<li>
The object's CLSID is not included in the list of objects to exclude (the <i>lpClsidExclude</i> member of<b> OLEUIINSERTOBJECT</b>).</li>
</ul>
<p>
By default, <b>OleUIInsertObject</b> does not validate object servers, however, if the IOF_VERIFYSERVEREXIST flag is included in the <i>dwFlags</i> member of the <b>OLEUIINSERTOBJECT</b> structure, <b>OleUIInsertObject</b> verifies that the server exists. If it does not exist, then the server's object is not added to the list of available objects. Server validation is a time-extensive operation and is a significant performance factor. </p>
<p>
To free an HMETAFILEPICT returned from the Insert Object or Paste Special dialog box, delete the attached metafile on the handle, as follows:</p>
<pre><code>void FreeHmetafilepict(HMETAFILEPICT hmfp) 
{ 
    if (hmfp != NULL) 
        { 
        LPMETAFILEPICT pmfp = GlobalLock(hmfp); 
 
        DeleteMetaFile(pmfp-&gt;hMF); 
        GlobalUnlock(hmfp); 
        GlobalFree(hmfp); 
        } 
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oledlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in oledlg.dll.</p>
<h4>See Also</h4>
<p>
<a href="structs_2f02.htm"><b>OLEUIINSERTOBJECT</b></a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_openfile">
</object><a href=JavaScript:alink_1.Click()><b>OpenFile</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_deletemetafile">
</object><a href=JavaScript:alink_2.Click()><b>DeleteMetaFile</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalunlock">
</object><a href=JavaScript:alink_3.Click()><b>GlobalUnlock</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalfree">
</object><a href=JavaScript:alink_4.Click()><b>GlobalFree</b></a> in Win32 </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
