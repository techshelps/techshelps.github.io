<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMessageFilter::MessagePending</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_imessagefilter_messagepending"></a>IMessageFilter::MessagePending</h2>
<p>
A client-based method called by COM when a Windows message appears in a COM application's message queue while the application is waiting for a reply to a remote call. Handling input while waiting for an outgoing call to finish can introduce complications. The application should determine whether to process the message without interrupting the call, continue waiting, or cancel the operation. </p>
<pre><code><b>DWORD MessagePending(
  HTASK</b><i> threadIDCallee</i><b>,  </b>//Called applications task handle
<b>  DWORD</b><i> dwTickCount</i><b>,     </b>//Elapsed tick count
<b>  DWORD</b><i> dwPendingType    </i>//Call type
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>threadIDCallee</i></dt>
<dd>
[in] Task handle of the called application that has not yet responded.</dd>
<dt>
<i>dwTickCount</i></dt>
<dd>
[in] Number of ticks since the call was made. It is calculated from the Windows <b>GetTickCount</b> function.</dd>
<dt>
<i>dwPendingType</i></dt>
<dd>
[in] Type of call made during which a message or event was received. Valid values are from the enumeration <a href="enums_8wdh.htm"><b>PENDINGTYPE</b></a> (where PENDINGTYPE_TOPLEVEL means the outgoing call was not nested within a call from another application and PENDINTGYPE_NESTED means the outgoing call was nested within a call from another application).
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
PENDINGMSG_CANCELCALL</dt>
<dd>
Cancel the outgoing call. This should be returned only under extreme conditions. Canceling a call that has not replied or been rejected can create orphan transactions and lose resources. COM fails the original call and returns RPC_E_CALL_CANCELLED.</dd>
<dt>
PENDINGMSG_WAITNOPROCESS</dt>
<dd>
Continue waiting for the reply and do not dispatch the message unless it is a task-switching or window-activation message. A subsequent message will trigger another call to <b>IMessageFilter::MessagePending</b>. Leaving messages or events in the queue enables them to be processed normally, if the outgoing call is completed. Note that returning PENDINGMSG_WAITNOPROCESS can cause the message queue to fill. </dd>
<dt>
PENDINGMSG_WAITDEFPROCESS</dt>
<dd>
Because of the increased resources available in 32-bit systems, you are unlikely to get this return value. It now indicates the same state as PENDINGMSG_WAITNOPROCESS. 
<p>
Keyboard and mouse messages are no longer dispatched, as was done with PENDINGMSG_WAITDEFPROCESS. However there are some cases where mouse and keyboard messages could cause the system to deadlock, and in these cases, mouse and keyboard messages are discarded. WM_PAINT messages are dispatched. Task-switching and activation messages are handled as before.

</dd>
</dl>
<h4>Remarks</h4>
<p>
COM calls <b>IMessageFilter::MessagePending</b> after an application has made a COM method call and a Windows message occurs before the call has returned. A Windows message is sent, for example, when the user selects a menu command or double-clicks an object. Before COM makes the <b>IMessageFilter::MessagePending </b>call, it calculates the elapsed time since the original COM method call was made. COM delivers the elapsed time in the <i>dwTickCount</i> parameter. In the meantime, COM does not remove the message from the queue.</p>
<p>
Windows messages that appear in the caller's queue should remain in the queue until sufficient time has passed to ensure that the messages are probably not the result of typing ahead, but are, instead, an attempt to get attention. Set the delay with the <i>dwTickCount</i> parameter — a two- or three-second delay is recommended. If that amount of time passes and the call has not been completed, the caller should flush the messages from the queue, and the OLE UI busy dialog box should be displayed offering the user the choice of retrying the call (continue waiting) or switching to the task identified by the <i>threadIDCallee </i>parameter. This ensures that:
<ul>
<li>
If calls are completed in a reasonable amount of time, type ahead will be treated correctly.</li>
<li>
If the callee does not respond, type ahead is not misinterpreted and the user is able to act to solve the problem. For example, OLE 1 servers can queue up requests without responding when they are in modal dialog boxes.</li>
</ul>
<p>
Handling input while waiting for an outgoing call to finish can introduce complications. The application should determine whether to process the message without interrupting the call, continue waiting, or cancel the operation. </p>
<p>
When there is no response to the original COM call, the application can cancel the call and restore the COM object to a consistent state by calling <a href="if_r2z_56no.htm"><b>IStorage::Revert</b></a> on its storage. The object can be released when the container can shut down. However, canceling a call can create orphaned operations and resource leaks. Canceling should be used <i>only</i> as a last resort. It is strongly recommended that applications not allow such calls to be canceled.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_r2z_56no.htm"><b>IStorage::Revert</b></a>, <a href="if_r2z_56no.htm"><b>IStorage::Revert</b></a>, <a href="api3_7qyh.htm"><b>OleUIBusy</b></a>, <a href="structs_0d0y.htm"><b>OLEUIBUSY</b></a>, In the <i>WIN32 SDK</i>: <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_gettickcount">
</object><a href=JavaScript:alink_1.Click()><b>GetTickCount</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
