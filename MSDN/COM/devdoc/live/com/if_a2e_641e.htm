<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IClassFactory2</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_iclassfactory2"></a>IClassFactory2</h1>
<p>
The <b>IClassFactory2</b> interface enables a class factory object, in any sort of object server, to control object creation through licensing. This interface is an extension to <a href="if_a2e_9mk9.htm"><b>IClassFactory</b></a>. This extension enables a class factory executing on a licensed machine to provide a license key that can be used later to create an object instance on an unlicensed machine. Such considerations are important for objects like controls that are used to build applications on a licensed machine. Subsequently, the application built must be able to run on an unlicensed machine. The license key gives only that one client application the right to instantiate objects through <b>IClassFactory2</b> when a full machine license does not exist.</p>
<h5>When to Implement</h5>
<p>
Implement this interface on a class factory object if you need to control object creation through a license. A class that supports licensing should be marked in an object's type information with the <b>[licensed]</b> attribute on the object's <b>coclass</b> entry.</p>
<p>
The <b>CreateInstance</b> method inherited from <b>IClassFactory</b> is allowed to return CLASS_E_NOTLICENSED to indicate that object creation is controlled through licensing. The caller can create an instance of this object only through <b>IClassFactory2::CreateInstanceLic</b> if the caller has a license key obtained from <b>IClassFactory2::RequestLicKey</b>. Otherwise, no object creation is allowed.</p>
<h5>When to Use</h5>
<p>
Use this interface to create licensed objects or to obtain a license key that can be used in later creations.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IUnknown Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=55%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=55%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=55%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IClassFactory Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_5k11.htm"><b>CreateInstance</b></a></td>
<td width=55%>Creates an uninitialized object.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_38vm.htm"><b>LockServer</b></a></td>
<td width=55%>Locks object application open in memory.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IClassFactory2 Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_5wbz.htm"><b>GetLicInfo</b></a></td>
<td width=55%>Fills a <b>LICINFO</b> structure with information on the licensing capabilities of this class factory.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_4jax.htm"><b>RequestLicKey</b></a></td>
<td width=55%>Creates and returns a license key that the caller can save and use later in calls to <b>IClassFactory2::CreateInstanceLic</b>.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_8tk3.htm"><b>CreateInstanceLic</b></a></td>
<td width=55%>Creates an instance of the licensed object given a license key from <b>IClassFactory2::RequestLicKey</b>.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_9mk9.htm"><b>IClassFactory</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
