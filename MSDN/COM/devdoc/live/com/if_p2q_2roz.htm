<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IProgressNotify::OnProgress</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iprogressnotify_onprogress"></a>IProgressNotify::OnProgress</h2>
<p>
Notifies registered objects and applications of the progress of a downloading operation.</p>
<pre><code><b>HRESULT OnProgress(
  DWORD</b><i> dwProgressCurrent</i><b>,  </b>//Amount of data available
<b>  DWORD</b><i> dwProgressMaximum</i><b>,  </b>//Total amount of data to be downloaded
<b>  BOOL</b><i> fAccurate</i><b>,           </b>//Reliability of notifications
<b>  BOOL</b><i> fOwner               </i>//Ownership of blocking behavior
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwProgressCurrent</i></dt>
<dd>
[in] The amount of data available.</dd>
<dt>
<i>dwProgressMaximum</i></dt>
<dd>
[in] The total amount of data to be downloaded.</dd>
<dt>
<i>fAccurate</i></dt>
<dd>
[in] Values in <i>dwProgressCurrent</i> and <i>dwProgressMaximum</i> are either reliable (TRUE) or unreliable (FALSE). The FALSE value indicates that control structures for determining the actual position of, or amount of, data yet to be downloaded are not available.</dd>
<dt>
<i>fOwner</i></dt>
</dl>
<p>
[in] Indicates whether this <b>OnProgress</b> call can control the blocking behavior of the operation. If TRUE, the caller can use return values from <b>OnProgress</b> to block (STG_S_BLOCK), retry (STG_S_RETRYNOW), or monitor (STG_S_MONITORING) the operation. If FALSE, the return value from <b>OnProgress</b> has no influence on blocking behavior.</p>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_OUTOFMEMORY, E_UNEXPECTED, E_INVALIDARG, and E_FAIL, as well as the following:
<dl>
<dt>
STG_S_RETRYNOW</dt>
<dd>
The caller is to retry the operation immediately. (This value is most useful for applications that do blocking from within the callback routine.)</dd>
<dt>
STG_S_BLOCK</dt>
<dd>
The caller is to block the download and retry the call as needed to determine if additional data is available. This is the default behavior if no sinks are registered on the connection point.</dd>
<dt>
STG_S_MONITORING</dt>
<dd>
The callback recipient reliquishes control of the downloading process to one of the other objects or applications that have registered progress notification sinks on the same stream. This is useful if the notification sink is interested only in gathering statistics.</dd>
<dt>
E_PENDING</dt>
<dd>
Data is currently unavailable. The caller is to try again after some desired interval. The notification sink returns this value if the asynchronous storage is to operate in nonblocking mode.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Sinks may be inherited by any substorage or substream of a given storage. If no sink is registered, the thread will block until the requested data becomes available, or the download is canceled by the downloader.</p>
<p>
Where multiple objects or applications have registered progress notification sinks on a single stream, only one of them can control the behavior of a download. Ownership of the download goes to:
<ol>
<li>
The first sink to register with the storage or stream.<ol>
<li>
Any advise skinks that may have been inherited from the parent storage (if the storage was created with ASYNC_MODE_COMPATIBILITY.</li>
</ol>
</li>
</ol>
<p>
Any one of the sinks can relinquish control to the next connection point by returning STG_S_MONITORING to the connection point making the current caller. Once a connection point obtains control (through receiving STG_S_BLOCK or STG_S_RETRYNOW), all subsequent connection points calling <b>IProgressNotify::OnProgress </b>will set <i>fOwner</i>  to FALSE.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<p>&nbsp;</p></body>
</HTML>
