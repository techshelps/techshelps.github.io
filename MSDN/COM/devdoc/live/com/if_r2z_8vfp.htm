<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IStorage::CreateStorage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_istorage_createstorage"></a>IStorage::CreateStorage</h2>
<p>
Creates and opens a new storage object nested within this storage object.</p>
<pre><code><b>HRESULT CreateStorage(
  const WCHAR *</b><i> pwcsName</i><b>,</b> 
                    //Points to the name of the new storage object
<b>  DWORD</b><i> grfMode</i><b>,    </b>//Access mode for the new storage object
<b>  DWORD</b><i> reserved1</i><b>,  </b>//Reserved; must be zero
<b>  DWORD</b><i> reserved2</i><b>,  </b>//Reserved; must be zero
<b>  IStorage **</b><i> ppstg </i>//Points to new storage object
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pwcsName</i></dt>
<dd>
[in] Points to a wide character string that contains the name of the newly created storage object. This name can be used later to reopen the storage object.</dd>
<dt>
<i>grfMode</i></dt>
<dd>
[in] Specifies the access mode to use when opening the newly created storage object. See the <a href="enums_1ktp.htm"><b>STGM</b></a> enumeration values for descriptions of the possible values.</dd>
<dt>
<i>reserved1</i></dt>
<dd>
[in] Reserved for future use; must be zero.</dd>
<dt>
<i>reserved2</i></dt>
<dd>
[in] Reserved for future use; must be zero.</dd>
<dt>
<i>ppstg</i></dt>
<dd>
[out] When successful, points to the location of the <b>IStorage</b> pointer to the newly-created storage object. This parameter is set to NULL if an error occurs.</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The storage object was created successfully.</dd>
<dt>
E_PENDING</dt>
<dd>
Asynchronous Storage only: Part or all of the necessary data is currently unavailable. For more information see <a href="if_f2n_5xdf.htm"><b>IFillLockBytes</b></a> and <a href="asyncstg_86cl.htm">Asynchronous Storage</a>.</dd>
<dt>
STG_E_ACCESSDENIED</dt>
<dd>
Insufficient permissions to create storage object.</dd>
<dt>
STG_E_FILEALREADYEXISTS</dt>
<dd>
The name specified for the storage object already exists in the storage object and the <i>grfmode</i> flag includes the flag STGM_FAILIFTHERE.</dd>
<dt>
STG_E_INSUFFICIENTMEMORY</dt>
<dd>
The storage object was not created due to a lack of memory.</dd>
<dt>
STG_E_INVALIDFLAG</dt>
<dd>
The value specified for the <i>grfMode</i> flag is not a valid <a href="enums_1ktp.htm"><b>STGM</b></a> enumeration value.</dd>
<dt>
STG_E_INVALIDFUNCTION</dt>
<dd>
The specified combination of <i>grfMode</i> flags is not supported.</dd>
<dt>
STG_E_INVALIDNAME</dt>
<dd>
Invalid value for <i>pwcsName</i>.</dd>
<dt>
STG_E_INVALIDPOINTER</dt>
<dd>
The pointer specified for the storage object was invalid.</dd>
<dt>
STG_E_INVALIDPARAMETER</dt>
<dd>
One of the parameters was invalid.</dd>
<dt>
STG_E_REVERTED</dt>
<dd>
The storage object has been invalidated by a revert operation above it in the transaction tree.</dd>
<dt>
STG_E_TOOMANYOPENFILES</dt>
<dd>
The storage object was not created because there are too many open files.</dd>
<dt>
STG_S_CONVERTED</dt>
<dd>
The existing stream with the specified name was replaced with a new storage object containing a single stream called CONTENTS. The new storage object will be added.</dd>
</dl>
<h4>Remarks</h4>
<p>
If a storage with the name specified in the <i>pwcsName</i> parameter already exists within the parent storage object, and the <i>grfMode</i> parameter includes the STGM_CREATE flag, the existing storage is replaced by the new one. If the <i>grfMode</i> parameter includes the STGM_CONVERT flag, the existing element is converted to a stream object named CONTENTS and the new storage object is created containing the CONTENTS stream object. The destruction of the old element and the creation of the new storage object are both subject to the transaction mode on the parent storage object.</p>
<p>
If a storage object with the same name already exists and <i>grfMode</i> is set to STGM_FAILIFTHERE, this method fails with the return value STG_E_FILEALREADYEXISTS.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_r2z_954e.htm"><b>IStorage - Compound File Implementation</b></a>, <a href="if_r2z_182t.htm"><b>IStorage::OpenStorage</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
