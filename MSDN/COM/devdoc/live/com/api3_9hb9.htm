<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleSave</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_olesave"></a>OleSave</h1>
<p>
Saves an object opened in transacted mode into the specified storage object.</p>
<pre><code><b>WINOLEAPI OleSave(
  IPersistStorage *</b><i> pPS</i><b>,</b>   //Pointer to the object to be saved
<b>  IStorage *</b><i> pStg</i><b>,         </b>//Pointer to the destination storage to 
                           // which <i>pPS</i> is saved
<b>  BOOL</b><i> fSameAsLoad         </i>//Whether the object was loaded from <i>pstg</i> 
                           // or not
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pPS</i></dt>
<dd>
[in] Pointer to the <b>IPersistStorage</b> interface on the object to be saved.</dd>
<dt>
<i>pStg</i></dt>
<dd>
[in] Pointer to the <b>IStorage</b> interface on the destination storage object to which the object indicated in <i>pPS</i> is to be saved.</dd>
<dt>
<i>fSameAsLoad</i></dt>
<dd>
[in] TRUE indicates that <i>pStg</i> is the same storage object from which the object was loaded or created; FALSE indicates that <i>pstg</i> was loaded or created from a different storage object.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
The object was successfully saved.</dd>
<dt>
STG_E_MEDIUMFULL</dt>
<dd>
The object could not be saved due to lack of disk space.
</dd>
</dl>
<p>
This function can also return any of the error values returned by the <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a> method.</p>
<h4>Remarks</h4>
<p>
The <b>OleSave</b> helper function handles the common situation in which an object is open in transacted mode and is then to be saved into the specified storage object which uses the OLE-provided compound file implementation. Transacted mode means that changes to the object are buffered until either of the <b>IStorage</b> methods <b>Commit</b> or <b>Revert</b> is called. Callers can handle other situations by calling the <b>IPersistStorage</b> and <a href="if_r2z_9b8l.htm"><b>IStorage</b></a> interfaces directly.</p>
<p>
<b>OleSave</b> does the following:
<ol>
<li>
Calls the <b>IPersistStorage::GetClassID</b> method to get the CLSID of the object.</li>
<li>
Writes the CLSID to the storage object using the <a href="api4_6smf.htm"><b>WriteClassStg</b></a> function. </li>
<li>
Calls the <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a> method to save the object.</li>
<li>
If there were no errors on the save; calls the <a href="if_r2z_11h0.htm"><b>IStorage::Commit</b></a> method to commit the changes.</li>
</ol>
<p>
<b>Note</b>&nbsp;&nbsp;Static objects are saved into a stream called CONTENTS. Static metafile objects get saved in "placeable metafile format" and static DIB data gets saved in "DIB file format." These formats are defined to be the OLE standards for metafile and DIB. All data transferred using an <a href="if_r2z_4x7x.htm"><b>IStream</b></a> interface or a file (that is, via <a href="if_a2e_7iat.htm"><b>IDataObject::GetDataHere</b></a>) must be in these formats. Also, all objects whose default file format is a metafile or DIB must write their data into a CONTENTS stream using these standard formats.</p>
<p>
<b>Windows CE:</b> Passing into this function any invalid and, under some circumstances, NULL pointers will result in unexpected termination of the application. For more information about handling exceptions, see Programming Considerations.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Use version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="if_r2z_9b8l.htm"><b>IStorage</b></a>,<b> <a href="if_p2q_8crp.htm">IPersistStorage</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
