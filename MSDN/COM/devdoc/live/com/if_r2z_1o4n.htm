<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRunnableObject::LockRunning</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_irunnableobject_lockrunning"></a>IRunnableObject::LockRunning</h2>
<p>
Locks an already running object into its running state or unlocks it from its running state.</p>
<pre><code><b>HRESULT LockRunning(
  BOOL</b><i> fLock</i><b>,</b>   //Flag indicating whether object is locked
<b>  BOOL</b><i> fLastUnlockCloses</i>
<i>                </i>//Flag indicating whether to close object
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>fLock</i></dt>
<dd>
[in] TRUE locks the object into its running state. FALSE unlocks the object from its running state.</dd>
<dt>
<i>fLastUnlockCloses</i></dt>
<dd>
[in] TRUE specifies that if the connection being released is the last external lock on the object, the object should close. FALSE specifies that the object should remain open until closed by the user or another process.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_FAIL, E_INVALIDARG, E_OUTOFMEMORY and E_UNEXPECTED, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
If the value of <i>fLock</i> is TRUE, the object was successfully locked; if the value of <i>fLock </i>is FALSE, the object was successfully unlocked.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Most implementations of <b>IRunnableObject::LockRunning</b> call <a href="api1_5ajw.htm"><b>CoLockObjectExternal</b></a>.</p>
<p>
<a href="api3_6yg7.htm"><b>OleLockRunning</b></a><b> </b>is a helper function that conveniently repackages the functionality offered by <b>IRunnableObject::LockRunning</b>. With the release of OLE 2.01, the implementation of <b>OleLockRunning</b> was changed to call <b>QueryInterface</b>, ask for <a href="if_r2z_4u2c.htm"><b>IRunnableObject</b></a>, and then call <b>IRunnableObject::LockRunning</b>. In other words, you can use the interface and the helper function interchangeably.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="api1_5ajw.htm"><b>CoLockObjectExternal</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
