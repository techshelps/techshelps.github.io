<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleCreateLinkFromData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_olecreatelinkfromdata"></a>OleCreateLinkFromData</h1>
<p>
Creates a linked object from a data transfer object retrieved either from the clipboard or as part of an OLE drag-and-drop operation.</p>
<pre><code><b>WINOLEAPI OleCreateLinkFromData(
  LPDATAOBJECT</b><i> pSrcDataObj</i><b>,  </b>//Pointer to data transfer objectt
<b>  REFIID</b><i> riid</i><b>,               </b>//Reference to the identifier of the 
                             // interface to be used to communicate 
                             // with the new object
<b>  DWORD</b><i> renderopt</i><b>,           </b>//OLERENDER value
<b>  LPFORMATETC</b><i> pFormatEtc</i><b>,    </b>//Pointer to a FORMATETC structure
<b>  LPOLECLIENTSITE</b><i> pClientSite</i><b>,  </b>//Pointer to an interface
<b>  LPSTORAGE</b><i> pStg</i><b>,            </b>//Pointer to the object storage
<b>  LPVOID FAR*</b><i> ppvObj         </i>//Address of output variable that 
                             // receives the interface pointer 
                             // requested in <i>riid</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pSrcDataObj</i></dt>
<dd>
[in] Pointer to the <b>IDataObject</b> interface on the data transfer object from which the linked object is to be created.</dd>
<dt>
<i>riid</i></dt>
<dd>
[in] Reference to the identifier of interface the caller later uses to communicate with the new object (usually <b>IID_IOleObject</b>, defined in the OLE headers as the interface identifier for <b>IOleObject</b>).</dd>
<dt>
<i>renderopt</i></dt>
<dd>
[in] Value from the enumeration <a href="enums_38s2.htm"><b>OLERENDER</b></a> that indicates the locally cached drawing or data-retrieval capabilities the newly created object is to have. Additional considerations are described in the following Remarks section.</dd>
<dt>
<i>pFormatEtc</i></dt>
<dd>
[in] Pointer to a value from the enumeration <b>OLERENDER</b> that indicates the locally cached drawing or data-retrieval capabilities the newly created object is to have. The <b>OLERENDER</b> value chosen affects the possible values for the <i>pFormatEtc</i> parameter.</dd>
<dt>
<i>pClientSite</i></dt>
<dd>
[in] Pointer to an instance of <b>IOleClientSite</b>, the primary interface through which the object will request services from its container. May be NULL.</dd>
<dt>
<i>pStg</i></dt>
<dd>
[in] Pointer to the <a href="if_r2z_9b8l.htm"><b>IStorage</b></a> interface on the storage object. This parameter may not be NULL.</dd>
<dt>
<i>ppvObj</i></dt>
<dd>
[out] Address of pointer variable that receives the interface pointer requested in <i>riid</i>. Upon successful return, *<i>ppvObj</i> contains the requested interface pointer on the newly created object.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The linked object was created successfully.</dd>
<dt>
CLIPBRD_E_CANT_OPEN</dt>
<dd>
Not able to open the clipboard. </dd>
<dt>
OLE_E_CANT_GETMONIKER</dt>
<dd>
Not able to extract the object's moniker. </dd>
<dt>
OLE_E_CANT_BINDTOSOURCE</dt>
<dd>
Not able to bind to source. Binding is necessary to get the cache's initialization data.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The<b> OleCreateLinkFromData</b> function is used to implement either a paste-link or a drag-link operation. Its operation is similar to that of the <a href="api3_1h0h.htm"><b>OleCreateFromData</b></a> function, except that it creates a link, and looks for different data formats. If the CF_LINKSOURCE format is not present, and either the FileName or FileNameW clipboard format is present in the data transfer object, <b>OleCreateLinkFromData</b> creates a package containing the link to the indicated file.</p>
<p>
You use the <i>renderopt</i> and <i>pFormatetc</i> parameters to control the caching capability of the newly created object. For general information on how to determine what is to be cached, refer to the<b> <a href="enums_38s2.htm">OLERENDER</a></b> enumeration for a description of the interaction between <i>renderopt </i>and <i>pFormatetc</i>. There are, however, some additional specific effects of these parameters on the way <b>OleCreateLinkFromData</b> initializes the cache, as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>OLERENDER_DRAW, OLERENDER_FORMAT</td>
<td width=52%>If the presentation information is in the other formats in the source data object, this information is used. If the information is not present, the cache is initially empty, but will be filled the first time the object is run. No other formats are cached in the newly created object.</td>
</tr>
<tr valign=top>
<td width=48%>OLERENDER_NONE, OLERENDER_ASIS</td>
<td width=52%>Nothing is to be cached in the newly created object.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_0n3f.htm"><b>OleCreateLink</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
