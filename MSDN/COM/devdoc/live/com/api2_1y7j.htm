<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MonikerRelativePathTo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_monikerrelativepathto"></a>MonikerRelativePathTo</h1>
<p>
Provides a moniker that, when composed onto the end of the first specified moniker (or one with a similar structure), yields the second specified moniker. This function is intended for use only by <a href="if_f2n_30j3.htm"><b>IMoniker::RelativePathTo</b></a> implementations.</p>
<pre><code><b>WINOLEAPI MonikerRelativePathTo(
  LPMONIKER</b><i> pmkSrc</i><b>,  </b>//Pointer to the source identified by the 
                     // moniker
<b>  LPMONIKER</b><i> pmkDest</i><b>, </b>//Pointer to the destination identified by the 
                     // moniker
<b>  LPMONIKER FAR *</b><i> ppmkRelPath</i><b>,</b>
<b>                     </b>//Address of output variable that receives the 
                     // IMoniker interface pointer
<b>  BOOL</b><i> dwReserved    </i>//Reserved; must be non-zero
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pmkSrc</i></dt>
<dd>
[in] Pointer to the <b>IMoniker</b> interface on the moniker that, when composed with the relative moniker to be created, produces <i>pmkDest</i>. This moniker identifies the "source" of the relative moniker to be created.</dd>
<dt>
<i>pmkDest</i></dt>
<dd>
[in] Pointer to the <b>IMoniker</b> interface on the moniker to be expressed relative to <i>pmkSrc</i>. This moniker identifies the destination of the relative moniker to be created.</dd>
<dt>
<i>ppmkRelPath</i></dt>
<dd>
[out] Address of <b>IMoniker</b>* pointer variable that receives the interface pointer to the new relative moniker. When successful, the function has called <a href="if_r2z_3rja.htm"><b>IUnknown::AddRef</b></a> on the moniker and the caller is responsible for calling <a href="if_r2z_59np.htm"><b>IUnknown::Release</b></a>. If an error occurs, the interface pointer value is NULL.</dd>
<dt>
<i>dwReserved</i></dt>
<dd>
[in] Reserved; must be non-zero.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return value E_INVALIDARG, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
A meaningful relative path has been returned.</dd>
<dt>
MK_S_HIM</dt>
<dd>
The only form of the relative path is the other moniker.</dd>
<dt>
MK_E_NOTBINDABLE</dt>
<dd>
Indicates that <i>pmkSrc</i> is a relative moniker, such as an item moniker, and must be composed with the moniker of its container before a relative path can be determined.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Call <b>MonikerRelativePathTo</b> only in the implementation of <a href="if_f2n_30j3.htm"><b>IMoniker::RelativePathTo</b></a> if you are implementing a new moniker class.</p>
<p>
Your implementation of <b>IMoniker::RelativePathTo</b> should first check whether the other moniker is of a type you recognize and handle in a special way. If not, you should call <b>MonikerRelativePathTo</b>, passing itself as <i>pmkThis</i> and the other moniker as <i>pmkOther</i>. <b>MonikerRelativePathTo</b> correctly handles the cases where either moniker is a generic composite.</p>
<p>
You should call this function only if <i>pmkSrc</i> and <i>pmkDest</i> are both absolute monikers, where an absolute moniker is either a file moniker or a generic composite whose leftmost component is a file moniker, and where the file moniker represents an absolute path. Do not call this function on relative monikers.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_30j3.htm"><b>IMoniker::RelativePathTo</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
