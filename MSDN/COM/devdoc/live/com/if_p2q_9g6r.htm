<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPropertyStorage::ReadPropertyNames</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipropertystorage_readpropertynames"></a>IPropertyStorage::ReadPropertyNames</h2>
<p>
Retrieves any existing string names for the specified property identifiers. </p>
<pre><code><b>HRESULT ReadPropertyNames(
  ULONG</b><i> cpropid</i><b>,         </b>//Number of elements in rgpropid
<b>  PROPID const </b><i> rgpropid[]</i><b>,  </b>//Property identifiers for which names 
                             //are to be retrieved
<b>  LPWSTR</b><i> rglpwstrName[]  </i>//Array of returned string names
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cpropid</i></dt>
<dd>
[in] Number of elements on input of the array <i>rgpropid</i>. May legally be zero, though this is a no-op, reading no property names.</dd>
<dt>
<i>rgpropid</i>[]</dt>
<dd>
[in] Array of property identifiers for which names are to be retrieved.</dd>
<dt>
<i>rglpwstrName</i>[]</dt>
<dd>
[in, out] Caller-allocated array of size cpropid of LPWSTRs. On return, the implementation fills in this array. A given entry contains either the corresponding string name of a property identifier or NULL if the property identifier has no string name. 
<p>
Each LPWSTR member of the array should be freed using <b>CoTaskMemFree</b>.

</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return value E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
One or more string names were retrieved and all members of <i>rglpwstrName</i> are valid (either NULL or a valid LPWSTR).</dd>
<dt>
S_FALSE</dt>
<dd>
No string names were retrieved because none of the requested property identifiers have string names presently associated with them in this property storage object (this result does not address whether the given property identifiers presently exist in the set).</dd>
<dt>
STG_E_INVALIDHEADER</dt>
<dd>
The property name dictionary was not found.</dd>
<dt>
STG_E_READFAULT</dt>
<dd>
Error reading the storage.</dd>
<dt>
STG_E_ACCESSDENIED</dt>
<dd>
The requested access to the property storage object has been denied. No string names were retrieved.</dd>
<dt>
STG_E_INSUFFICIENTMEMORY</dt>
<dd>
There is not sufficient memory to perform this operation. No string names were retrieved.</dd>
<dt>
STG_E_INVALIDPARAMETER</dt>
<dd>
A parameter is invalid. No string names were retrieved.</dd>
<dt>
HRESULT_FROM_WIN32(ERROR_NO_UNICODE_TRANSLATION)</dt>
<dd>
There was a failed attempt to translate a Unicode string to or from Ansi.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For each property identifier in the list of property identifiers supplied in the <i>rgpropid</i> array, <b>IPropertyStorage::ReadPropertyNames</b> retrieves the corresponding string name, if there is one. String names are created either by specifying the names in calls to <b>IPropertyStorage::WriteMultiple</b> when you are creating the property, or through a call to <b>IPropertyStorage::WritePropertyNames</b>. In any case, the string name is optional; all properties must have a property identifier.</p>
<p>
String names mapped to property identifiers must be unique within the set. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_p2q_5esz.htm"><b>IPropertyStorage::WritePropertyNames</b></a>, <a href="if_p2q_0bj9.htm"><b>IPropertyStorage::WriteMultiple</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
