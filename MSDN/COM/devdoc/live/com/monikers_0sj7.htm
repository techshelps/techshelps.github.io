<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Composite Monikers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_composite_monikers"></a>Composite Monikers</h2>
<p>
One of the most useful features of monikers is that you can concatenate or <i>compose</i> monikers together. A composite moniker is a moniker that is a composition of other monikers, and can determine the relation between the parts. This lets you assemble the complete path to an object given two or more monikers that are the equivalent of partial paths. You can compose monikers of the same class (like two file monikers) or of different classes (like a file moniker and an item moniker). If you were to write your own moniker class, you could also compose your monikers with file or item monikers. The basic advantage of a composite is that it gives you one piece of code to implement every possible moniker that is a combination of simpler monikers. That reduces tremendously the need for specific custom moniker classes.</p>
<p>
Because monikers of different classes can be composed with one another, monikers provide the ability to join multiple namespaces. The file system defines a common namespace for objects stored as files because all applications understand a file-system path name. Similarly, a container object also defines a private namespace for the objects that it contains, because no container understands the names generated by another container. Monikers allow these name spaces to be joined because file monikers and item monikers can be composed. A moniker client can search the namespace for <i>all objects</i> using a single mechanism. The client simply calls <a href="if_f2n_7o6s.htm"><b>IMoniker::BindToObject</b></a> on the moniker, and the moniker code handles the rest. A call to <a href="if_f2n_1tb9.htm"><b>IMoniker::GetDisplayName</b></a> on a composite creates a name using the concatenation of all the individual monikers' display names.</p>
<p>
Furthermore, because you can write your own moniker class, moniker composition allows you to add customized extensions to the namespace for objects. </p>
<p>
Sometimes two monikers of specific classes can be combined in a special way. For example, a file moniker representing an incomplete path and another file moniker representing a relative path can be combined to form a single file moniker representing the complete path. For example, the file monikers <b>c:\work\art</b> could be composed with the relative file moniker <b>..\backup\myfile.doc</b> to equal <b>c:\work\backup\myfile.doc</b>. This is an example of "non-generic" composition.</p>
<p>
"Generic" composition, on the other hand, permits the connection of any two monikers, no matter what their classes. For example, you could compose an item moniker onto a file moniker, though not, of course, the other way around.</p>
<p>
Because a non-generic composition depends on the class of the monikers involved, its details are defined by a the implementation of a particular moniker class. You can define new types of non-generic compositions if you write a new moniker class. By contrast, generic compositions are defined by OLE. Monikers created as a result of generic composition are called generic composite monikers.</p>
<p>
These three classes — file monikers, item monikers, and generic composite monikers — all work together, and they are the most commonly used classes of monikers. </p>
<p>
Moniker clients should call <a href="if_f2n_8cx4.htm"><b>IMoniker::ComposeWith</b></a> to create a composite on moniker with another. The moniker it is called on internally decides whether it can do a generic or non-generic composition. If the moniker implementation determines that a generic composition is usable, OLE provides the <a href="api2_4zc5.htm"><b>CreateGenericComposite</b></a> API function to facilitate this.</p>
<p>&nbsp;</p></body>
</HTML>
