<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OBJECTDESCRIPTOR</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_objectdescriptor"></a>OBJECTDESCRIPTOR</h1>
<p>
The <b>OBJECTDESCRIPTOR</b> structure is the data structure used for the CF_OBJECTDESRIPTOR and CF_LINKSRCDESCRIPTOR file formats. These formats provide user interface information during data transfer operations, for example, the Paste Special dialog box or target feedback information during drag-and-drop operations.</p>
<pre><code>typedef struct tagOBJECTDESCRIPTOR 
{ 
    ULONG  cbSize; 
    CLSID  clsid; 
    DWORD  dwDrawAspect; 
    SIZEL  sizel; 
    POINTL pointl; 
    DWORD  dwStatus; 
    DWORD  dwFullUserTypeName; 
    DWORD  dwSrcOfCopy; 
    /* variable sized string data may appear here */ 
} OBJECTDESCRIPTOR;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbSize</b></dt>
<dd>
Size of structure in bytes.</dd>
<dt>
<b>clsid</b></dt>
<dd>
CLSID of the object being transferred. The <b>clsid</b> is used to obtain the icon for the Display As Icon option in the Paste Special dialog box and is applicable only if the Embed Source or Embedded Object formats are offered. If neither is offered, the value of <b>clsid</b> should be CLSID_NULL. The <b>clsid</b> can be retrieved by the source by loading the object and calling the <b>IOleObject::GetUserClassID</b> method. Note that for link objects, this value is not the same as the value returned by the <a href="if_p2q_1yn8.htm"><b>IPersist::GetClassID</b></a> method.</dd>
<dt>
<b>dwDrawAspect</b></dt>
<dd>
Display aspect of the object. Typically, this value is DVASPECT_CONTENT or DVASPECT_ICON. If the source application did not draw the object originally, the <b>dwDrawAspect</b> field contains a zero value (which is not the same as DVASPECT_CONTENT).</dd>
<dt>
<b>sizel</b></dt>
<dd>
True extent of the object (without cropping or scaling) in HIMETRIC units. Setting this field is optional. The value can be (0,0) for applications that do not draw the object being transferred. This field is used primarily by targets of drag-and-drop operations, so they can give appropriate feedback to the user.</dd>
<dt>
<b>pointl</b></dt>
<dd>
Offset in HIMETRIC units from the upper-left corner of the object where a drag-and-drop operation was initiated. This field is only meaningful for a drag-and-drop transfer operation since it corresponds to the point where the mouse was clicked to initiate the drag-and-drop operation. The value is (0,0) for other transfer situations, such as a Clipboard copy and paste.</dd>
<dt>
<b>dwStatus</b></dt>
<dd>
Copy of the status flags for the object. These flags are defined by the <a href="enums_6gtf.htm"><b>OLEMISC</b></a> enumeration. If an embedded object is being transferred, they are returned by calling the <b>IOleObject::GetMiscStatus</b> method.</dd>
<dt>
<b>dwFullUserTypeName</b></dt>
<dd>
Offset for finding the full user type name of the object being transferred. It specifies the offset, in bytes, from the beginning of the <b>OBJECTDESCRIPTOR</b> data structure to the null-terminated string that specifies the full user type name of the object being transferred. The value is zero if the string is not present. This string is used by the destination of a data transfer to create labels in the Paste Special dialog box. The destination application must be able to handle the cases when this string is omitted.</dd>
<dt>
<b>dwSrcOfCopy</b></dt>
<dd>
Offset, in bytes, from the beginning of the data structure to the null-terminated string that specifies the source of the transfer. The <b>dwSrcOfCopy</b> field is typically implemented as the display name of the temporary moniker that identifies the data source. The value for <b>dwSrcOfCopy</b> is displayed in the Source line of the Paste Special dialog box. A zero value indicates that the string is not present. If <b>dwSrcOfCopy</b> is zero, the string "Unknown Source" is displayed in the Paste Special dialog box.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_24z8.htm"><b>IDataObject</b></a>, <a href="structs_14v7.htm"><b>FORMATETC</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
