<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the System-Supplied Surrogate</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_using_the_system_supplied_surrogate"></a>Using the System-Supplied Surrogate</h2>
<p>
To use the system-supplied surrogate for your DLL server, register the DLL specifying an empty string or NULL for the <a href="reg_6xyd.htm"><b>DllSurrogate</b></a> named-value in the registry. When an activation request for a DLL server so designated comes to COM, COM launches the default surrogate process and the requested DLL (by specifying the CLSID on the launch command line internally) at the same time to avoid a separate call. (For information on running more than one DLL server in a surrogate process, see <a href="comext_2cbr.htm">Surrogate Sharing</a>). </p>
<p>
The default implementation of the surrogate process is a mixed-threading model style pseudo-COM server. When multiple DLL servers are loaded into a single surrogate process, this process ensures that each DLL server is instantiated using the threading model specified in the registry for that server. All loaded free-threaded servers will live together in the multi threaded apartment, while each apartment-threaded server will reside in a single-threaded apartment. If a DLL server supports both threading models COM will choose multi-threading.</p>
<p>
This surrogate process is written so that COM handles both the unloading of DLL servers and terminating the surrogate process.</p>
<p>
The system-provided surrogate will work very well for most developers, as well as being very easy to use. However, those developers with special considerations may decide that a custom surrogate is necessary. For more information, see <a href="comext_2dlx.htm">Writing a Custom Surrogate</a>.</p>
<p>&nbsp;</p></body>
</HTML>
