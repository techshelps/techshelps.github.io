<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleLink::BindToSource</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iolelink_bindtosource"></a>IOleLink::BindToSource</h2>
<p>
Activates the connection to the link source by binding the moniker stored within the linked object. </p>
<pre><code><b>HRESULT BindToSource(
  DWORD</b><i> bindflags</i><b>,</b>
<b>                 </b>//Flag in case CLSID of link source is different
<b>  IBindCtx</b><i> *pbc  </i>//Pointer to bind context to be used
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>bindflags</i></dt>
<dd>
[in] Specifies how to proceed if the link source has a different CLSID from the last time it was bound. If this parameter is zero and the CLSIDs are different, the method fails and returns OLE_E_CLASSDIFF. If the OLELINKBIND_EVENIFCLASSDIFF value from the <a href="enums_2y5g.htm"><b>OLELINKBIND</b></a> enumeration is specified and the CLSIDs are different, the method binds successfully and updates the CLSID stored in the linked object.</dd>
<dt>
<i>pbc</i></dt>
<dd>
[in] Pointer to the <b>IBindCtx</b> interface on the bind context to be used in this binding operation. This parameter can be NULL. The bind context caches objects bound during the binding process, contains parameters that apply to all operations using the bind context, and provides the means by which the binding implementation should retrieve information about its environment. For more information, see <a href="if_a2e_06bc.htm"><b>IBindCtx</b></a>. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The link source is bound.</dd>
<dt>
OLE_E_CLASSDIFF</dt>
<dd>
The link source was not bound because its CLSID has changed. This error is returned only if the OLELINKBIND_EVENIFCLASSDIFF flag is not specified in the <i>bindflags</i> parameter.</dd>
<dt>
MK_E_NOOBJECT</dt>
<dd>
The link source could not be found or (if the link source's moniker is a composite) some intermediate object identified in the composite could not be found.</dd>
<dt>
E_UNSPEC</dt>
<dd>
The link's moniker is NULL.</dd>
<dt>
<b>CreateBindCtx</b> errors</dt>
<dd>
Binding the moniker might require calling this function; therefore, this method may return errors generated by this function. 
</dd>
</dl>
<h4>Remarks</h4>
<h5>Notes to Callers</h5>
<p>
Typically, your container application does not need to call the <b>IOleLink::BindToSource</b> method directly. When it's necessary to activate the connection to the link source, your container typically calls <b>IOleObject::DoVerb</b>, <b>IOleObject::Update</b>, or <b>IOleLink::Update</b>. The linked object's implementation of these methods calls <b>IOleLink::BindToSource</b>. Your container can also call the <a href="api3_1yni.htm"><b>OleRun</b></a> function, which — when called on a linked object — calls <b>IOleLink::BindToSource</b>. </p>
<p>
In each of the examples listed previously, in which <b>IOleLink::BindToSource</b> is called indirectly, the <i>bindflags</i> parameter is set to zero. Consequently, these calls can fail with the OLE_E_CLASSDIFF error if the class of the link source is different from what it was the last time the linked object was bound. This could happen, for example, if the original link source was an embedded Lotus spreadsheet that an end user had subsequently converted (using the Change Type dialog box) to an Excel spreadsheet.</p>
<p>
If you want your container to bind even though the link source now has a different CLSID, you can call <b>IOleLink::BindToSource</b> directly and specify OLELINKBIND_EVENIFCLASSDIFF for the <i>bindflags</i> parameter. This call binds to the link source and updates the link object's CLSID. Alternatively, your container can delete the existing link and use the <a href="api3_0n3f.htm"><b>OleCreateLink</b></a> function to create a new linked object. </p>
<h5>Notes on Provided Implementation </h5>
<p>
The linked object caches the interface pointer to the link source acquired during binding.</p>
<p>
The linked object's <b>IOleLink::BindToSource</b> implementation first tries to bind using a moniker consisting of the compound document's moniker composed with the link source's relative moniker. If successful, it updates the link's absolute moniker. Otherwise, it tries to bind using the absolute moniker, updating the relative moniker if successful.</p>
<p>
If <b>IOleLink::BindToSource</b> binds to the link source, it calls the compound document's <b>IOleContainer::LockContainer</b> implementation to keep the containing compound document alive while the link source is running. <b>IOleLink::BindToSource</b> also calls the <b>IOleObject::Advise</b> and <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a> implementations of the link source to set up advisory connections. The <b>IOleLink::UnbindSource</b> implementation unlocks the container and deletes the advisory connections.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a>, <a href="if_o_8gxe.htm"><b>IOleContainer::LockContainer</b></a>, <a href="if_o_72w5.htm"><b>IOleLink::Update</b></a>, <a href="if_o_10yt.htm"><b>IOleLink::UnbindSource</b></a>, <a href="if_o_1gh1.htm"><b>IOleObject::Advise</b></a>, <a href="if_o_8ogy.htm"><b>IOleObject::DoVerb</b></a>, <a href="if_o_50th.htm"><b>IOleObject::Update</b></a>, <a href="api3_1yni.htm"><b>OleRun</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
