<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleObject::SetMoniker</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleobject_setmoniker"></a>IOleObject::SetMoniker</h2>
<p>
Notifies an object of its container's moniker, the object's own moniker relative to the container, or the object's full moniker. </p>
<pre><code><b>HRESULT SetMoniker(
  DWORD</b><i> dwWhichMoniker</i><b>,  </b>//Value specifying moniker being set
<b>  IMoniker</b><i> *pmk          </i>//Pointer to moniker
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwWhichMoniker</i></dt>
<dd>
[in] Value specifying which moniker is passed in <i>pmk</i>. Values are from the enumeration <a href="enums_0pij.htm"><b>OLEWHICHMK</b></a>.</dd>
<dt>
<i>pmk</i></dt>
<dd>
[in] Pointer to where to return the moniker.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return value E_FAIL, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
Moniker successfully set.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A container that supports links to embedded objects must be able to inform an embedded object when its moniker has changed. Otherwise, subsequent attempts by link clients to bind to the object will fail. The <b>IOleObject::SetMoniker</b> method provides one way for a container to communicate this information.</p>
<p>
The container can pass either its own moniker, an object's moniker relative to the container, or an object's full moniker. In practice, if a container passes anything other than an object's full moniker, each object calls the container back to request assignment of the full moniker, which the object requires to register itself in the running object table.</p>
<p>
The moniker of an object relative to its container is stored by the object handler as part of the object's persistent state. The moniker of the object's container, however, must not be persistently stored inside the object because the container can be renamed at any time.</p>
<h5>Notes to Callers</h5>
<p>
A container calls <b>IOleObject::SetMoniker</b> when the container has been renamed, and the container's embedded objects currently or can potentially serve as link sources. Containers call <b>SetMoniker</b> mainly in the context of linking because an embedded object is already aware of its moniker. Even in the context of linking, calling this method is optional because objects can call <b>IOleClientSite::GetMoniker</b> to force assignment of a new moniker.</p>
<h5>Note to Implementers</h5>
<p>
Upon receiving a call to <b>SetMoniker</b>, an object should register its full moniker in the running object table and send OnRename notification to all advise sinks that exist for the object.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="api2_1ktu.htm"><b>CreateItemMoniker</b></a>, <a href="if_a2e_73fp.htm"><b>IAdviseSink::OnRename</b></a>, <a href="if_o_8o1e.htm"><b>IOleClientSite::GetMoniker</b></a>, <a href="if_o_18aa.htm"><b>IOleObject::GetMoniker</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
