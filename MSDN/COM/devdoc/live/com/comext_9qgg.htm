<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NTLMSSP</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_com_ntlmssp"></a>NTLMSSP</h3>
<p>
NTLMSSP, whose authentication service identifier is RPC_C_AUTHN_WINNT, is a security support provider that is available on all versions of DCOM. It uses the NTLM (Windows NT LAN Manager) protocol for authentication. NTLM never actually transmits the user's password to the server during authentication. Therefore, the server cannot use the password during impersonation to access network resources that the user would have access to. Only local resources can be accessed. </p>
<p>
NTLM works both locally and cross machine. That is, if the client and server are on different machines, NTLM can still make sure the client is who it claims to be. </p>
<p>
With NTLM, the client's identity is represented by a domain name, user name, and a password or token. When a server calls <a href="api1_0dro.htm"><b>CoQueryClientBlanket</b></a>, the client's domain name and user name are returned. However, when a server calls <a href="api1_6mwk.htm"><b>CoImpersonateClient</b></a>, the client's token is returned. If there is no trust relationship between client and server, and if the server has a local account with the same name and password as the client, that account will be used to represent the client.</p>
<p>
NTLM supports mutual authentication cross thread and cross process on Windows NT 5.0 (locally only). If the client specifies the principal name of the server in the form domain\user in a call to <b>SetBlanket</b>, the server's identity must match that principal name or the call will fail. If the client specifies NULL, the server's identity will not be checked. </p>
<p>
On Windows NT 4.0, NTLM supports the impersonation levels <i>identify</i> and <i>impersonate</i>. In Windows NT 4.0, if a server has a process token that has used its one machine hop and it attempts to make a secure call to the client using a connection-oriented protocol, NTLM will allow the call to succeed. The call will use the NULL session as the server's identity, and the call will appear to be secure when it is not. With Windows NT 5.0, NTLM additionally supports the <i>delegate </i>impersonation level cross thread and cross process (locally only).</p>
<p>&nbsp;</p></body>
</HTML>
