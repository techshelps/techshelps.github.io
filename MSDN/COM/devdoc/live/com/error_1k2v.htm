<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Macros for Error Handling</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_using_macros_for_error_handling"></a>Using Macros for Error Handling</h1>
<p>
COM defines a number of macros that make it easier to work with SCODEs on 16-bit platforms and <b>HRESULT</b>s on both platforms. Some of the macros and functions below convert return values of different data types and are quite useful in code that runs only on 16-bit platforms, code that runs on both 16-bit and 32-bit platforms, and 16-bit code that is being ported to a 32-bit platform. These same macros are meaningless in 32-bit environments and are available to provide compatibility and make porting easier. Newly written code should use the <b>HRESULT</b> macros and functions.</p>
<p>
The error handling macros are listed below:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Macro</th>
<th align=left width=63%>Description</th>
</tr>
<tr valign=top>
<td width=37%><a href="api2_7yw5.htm"><b>GetScode</b></a></td>
<td width=63%>(Obsolete) Returns an SCODE given an <b>HRESULT</b>.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api3_2pr9.htm"><b>ResultFromScode</b></a></td>
<td width=63%>(Obsolete) Returns an <b>HRESULT</b> given an SCODE.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api3_5s6s.htm"><b>PropagateResult</b></a></td>
<td width=63%>(Obsolete) Generates an <b>HRESULT</b> to return to a function in cases where an error is being returned from an internally called function.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_67sk.htm"><b>MAKE_HRESULT</b></a></td>
<td width=63%>Returns an <b>HRESULT</b> given an SCODE that represents an error.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_8u05.htm"><b>MAKE_SCODE</b></a></td>
<td width=63%>Returns an SCODE given an <b>HRESULT</b>.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_23xh.htm"><b>HRESULT_CODE</b></a></td>
<td width=63%>Extracts the error code part of the <b>HRESULT</b>.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_8vw9.htm"><b>HRESULT_FACILITY</b></a></td>
<td width=63%>Extracts the facility from the <b>HRESULT</b>.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_0f3t.htm"><b>HRESULT_SEVERITY</b></a></td>
<td width=63%>Extracts the severity bit from the SEVERITY.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api4_3lut.htm"><b>SCODE_CODE</b></a></td>
<td width=63%>Extracts the error code part of the SCODE.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api4_1v5l.htm"><b>SCODE_FACILITY</b></a></td>
<td width=63%>Extracts the facility from the SCODE.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api4_3ed5.htm"><b>SCODE_SEVERITY</b></a></td>
<td width=63%>Extracts the severity field from the SCODE.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api4_85gk.htm"><b>SUCCEEDED</b></a></td>
<td width=63%>Tests the severity of the SCODE or <b>HRESULT</b> - returns TRUE if the severity is zero and FALSE if it is one.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_28bo.htm"><b>FAILED</b></a></td>
<td width=63%>Tests the severity of the SCODE or <b>HRESULT</b> - returns TRUE if the severity is one and FALSE if it is zero.</td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_0l6a.htm"><b>IS_ERROR</b></a></td>
<td width=63%>Provides a generic test for errors on any status value. </td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_1wl0.htm"><b>FACILITY_NT_BIT</b></a></td>
<td width=63%>Defines bits so macros are guaranteed to work. </td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_975e.htm"><b>HRESULT_FROM_WIN32</b></a></td>
<td width=63%>Maps a Win32 error value into an <b>HRESULT</b>. This assumes that Win32 errors fall in the range -32K to 32K. </td>
</tr>
<tr valign=top>
<td width=37%><a href="api2_5gqc.htm"><b>HRESULT_FROM_NT</b></a></td>
<td width=63%>Maps an NT status value into an <b>HRESULT</b>.</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;Calling <a href="api2_67sk.htm"><b>MAKE_HRESULT</b></a> for S_OK verification carries a performance penalty. You should not routinely use <a href="api2_67sk.htm"><b>MAKE_HRESULT</b></a><b> </b>for successful results.</p>
<p>&nbsp;</p></body>
</HTML>
