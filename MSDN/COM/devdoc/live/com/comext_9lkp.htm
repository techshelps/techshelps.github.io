<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing IClassFactory</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_implementing_iclassfactory"></a>Implementing IClassFactory</h2>
<p>
When a client uses a CLSID to request the creation of an object instance, the first step is creation of a class object, an intermediate object that contains an implementation of the methods of the <a href="if_a2e_9mk9.htm"><b>IClassFactory</b></a> interface. While COM provides several instance creation functions, the first step in the implementation of these functions is the creation of a class object. </p>
<p>
As a result, all servers must implement the methods of the <b>IClassFactory</b> interface. This interface contains two methods: <b>CreateInstance</b> and <b>LockServer</b>. <b>CreateInstance</b> must create an uninitialized instance of the object, and return a pointer to a requested interface on the object.</p>
<p>
The <b>LockServer</b> method just increments the reference count on the class object to ensure that the server stays in memory, and does not shut down before the client is ready for it to do so.</p>
<p>
To enable a server to be responsible for its own licensing, COM defines <b>IClassFactory2</b>, which inherits its definition from <b>IClassFactory</b>. Thus, a server implementing <b>IClassFactory2</b> must, by definition, implement the methods of <b>IClassFactory</b>. For more information on <b>IClassFactory2</b>, see <a href="comext_394i.htm"><b>Licensing and IClassFactory2</b></a>.</p>
<p>
COM also provides helper functions for implementing out-of-process servers. For more information, see <a href="comext_3ib7.htm">Out-of-process Server Implementation Helpers</a>.</p>
<p>&nbsp;</p></body>
</HTML>
