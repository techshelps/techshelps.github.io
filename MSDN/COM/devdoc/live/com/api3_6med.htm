<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleInitialize</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleinitialize"></a>OleInitialize</h1>
<p>
Initializes the COM library on the current apartment, identifies the concurrency model as single-thread apartment (STA), and enables additional functionality described in the Remarks section below. Applications must initialize the COM library before they can call COM library functions other than <a href="api1_2qlf.htm"><b>CoGetMalloc</b></a> and memory allocation functions. </p>
<p>
Applications that do not require the additional functionality enabled by <b>OleInitialize</b> should call <a href="api1_5iyg.htm"><b>CoInitializeEx</b></a> instead of <b>OleInitialize</b>. </p>
<pre><code><b>WINOLEAPI OleInitialize(
  LPVOID</b><i> pvReserved  </i>//Reserved; must be NULL.
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>pvReserved</i></dt>
<dd>
[in] Reserved; must be NULL.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_INVALIDARG, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following: 
<dl>
<dt>
S_OK </dt>
<dd>
The COM library and additional functionality were initialized successfully on this apartment.</dd>
<dt>
S_FALSE</dt>
<dd>
The COM library is already initialized on this apartment.</dd>
<dt>
OLE_E_WRONGCOMPOBJ</dt>
<dd>
The versions of COMPOBJ.DLL and OLE2.DLL on your machine are incompatible with each other.</dd>
<dt>
RPC_E_CHANGED_MODE</dt>
<dd>
A previous call to <a href="api1_5iyg.htm"><b>CoInitializeEx</b></a> specified the concurrency model for this apartment as multithread apartment (MTA). 
</dd>
</dl>
<h4>Remarks</h4>
<p>
Applications that use the following functionality must call <b>OleInitialize</b> before calling any other function in the COM library:
<ul>
<li>
Clipboard</li>
<li>
Drag and drop</li>
<li>
Object linking and embedding (OLE)</li>
<li>
In-place activation</li>
</ul>
<p>
<b>OleInitialize</b> calls <b>CoInitializeEx</b> internally to initialize the COM library on the current apartment. Because OLE operations are not thread-safe, <b>OleInitialize</b> specifies the concurrency model as single-thread apartment. </p>
<p>
Once the concurrency model for an apartment is set, it cannot be changed. A call to <b>OleInitialize</b> on an apartment that was previously initialized as multithreaded will fail and return RPC_E_CHANGED_MODE. </p>
<p>
You need to initialize the COM library on an apartment before you call any of the library functions except <a href="api1_2qlf.htm"><b>CoGetMalloc</b></a>, to get a pointer to the standard allocator, and the memory allocation functions.</p>
<p>
Typically, the COM library is initialized on an apartment only once. Subsequent calls will succeed, as long as they do not attempt to change the concurrency model of the apartment, but will return S_FALSE. To close the COM library gracefully, each successful call to <b>OleInitialize</b>, including those that return S_FALSE, must be balanced by a corresponding call to <a href="api3_6ztx.htm"><b>OleUninitialize</b></a>.</p>
<p>
If <b>OleInitialize</b> returns OLE_E_WRONGCOMPOBJ, either COMPOBJ.DLL or OLE2.DLL has been updated to a version that is incompatible with the other file. To correct this problem, replace both of these files with versions for your operating system from the same release of the Platform SDK. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also </h4>
<p>
<a href="api3_6ztx.htm"><b>OleUninitialize</b></a>,<b> <a href="api1_36qt.htm">CoInitialize</a></b>, <a href="api1_5iyg.htm"><b>CoInitializeEx</b></a></p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
