<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAdviseSink</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_iadvisesink"></a>IAdviseSink</h1>
<p>
The <b>IAdviseSink</b> interface enables containers and other objects to receive notifications of data changes, view changes, and compound-document changes occurring in objects of interest. Container applications, for example, require such notifications to keep cached presentations of their linked and embedded objects up-to-date. Calls to <b>IAdviseSink</b> methods are asynchronous, so the call is sent and then the next instruction is executed without waiting for the call's return.</p>
<p>
For an advisory connection to exist, the object that is to receive notifications must implement <b>IAdviseSink</b>, and the objects in which it is interested must implement <a href="if_o_1gh1.htm"><b>IOleObject::Advise</b></a> and <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a>. In-process objects and handlers may also implement <a href="if_r2z_5qxx.htm"><b>IViewObject::SetAdvise</b></a>. Objects implementing <b>IOleObject </b>must support all reasonable advisory methods. To simplify advisory notifications, OLE supplies implementations of the <a href="if_a2e_125u.htm"><b>IDataAdviseHolder</b></a> and <a href="if_o_1gdu.htm"><b>IOleAdviseHolder</b></a>, which keep track of advisory connections and send notifications to the proper sinks through pointers to their IAdviseSink interfaces. <b>IViewObject</b> (and its advisory methods) is implemented in the default handler.</p>
<p>
As shown in the following table, an object that has implemented an advise sink registers its interest in receiving certain types of notifications by calling the appropriate method:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Call This Method</th>
<th align=left width=55%>To Register for These Notifications</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_o_1gh1.htm"><b>IOleObject::Advise</b></a></td>
<td width=55%>When a document is saved, closed, or renamed.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a></td>
<td width=55%>When a document's data changes.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_5qxx.htm"><b>IViewObject::SetAdvise</b></a></td>
<td width=55%>When a document's presentation changes.</td>
</tr>
</table><br>
<p>
When an event occurs that applies to a registered notification type, the object application calls the appropriate <b>IAdviseSink</b> method. For example, when an embedded object closes, it calls the <a href="if_a2e_5sth.htm"><b>IAdviseSink::OnClose</b></a> method to notify its container. These notifications are asynchronous, occurring after the events that trigger them.</p>
<h5>When to Implement</h5>
<p>
Objects, such as container applications and compound documents, implement <b>IAdviseSink</b> to receive notification of changes in data, presentation, name, or state of their linked and embedded objects. Implementers register for one or more types of notification, depending on their needs.</p>
<p>
Notifications of changes to an embedded object originate in the server and flow to the container by way of the object handler. If the object is a linked object, the OLE link object intercepts the notifications from the object handler and notifies the container directly. All containers, the object handler, and the OLE link object register for OLE notifications. The typical container also registers for view notifications. Data notifications are usually sent to the OLE link object and object handler.</p>
<h5>When to Use</h5>
<p>
Servers call the methods of <b>IAdviseSink</b> to notify objects with which they have an advisory connection of changes in an object's data, view, name, or state. </p>
<p>
<b>Note</b>&nbsp;&nbsp;OLE does not permit synchronous calls in the implementation of asynchronous methods, so you cannot make synchronous calls within any of the the <b>IAdviseSink</b> interface's methods. For example, an implementation of <a href="if_a2e_2tgl.htm"><b>IAdviseSink::OnDataChange</b></a> cannot contain a call to <a href="if_a2e_1jz5.htm"><b>IDataObject::GetData</b></a>. </p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IUnknown Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=55%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=55%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=55%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IAdviseSink Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_2tgl.htm"><b>OnDataChange</b></a></td>
<td width=55%>Advises that data has changed.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_1bj9.htm"><b>OnViewChange</b></a></td>
<td width=55%>Advises that view of object has changed.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_73fp.htm"><b>OnRename</b></a></td>
<td width=55%>Advises that name of object has changed.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_7s6d.htm"><b>OnSave</b></a></td>
<td width=55%>Advises that object has been saved to disk.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_a2e_5sth.htm"><b>OnClose</b></a></td>
<td width=55%>Advises that object has been closed.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_9mgi.htm"><b>IAdviseSink2</b></a>, <a href="if_a2e_125u.htm"><b>IDataAdviseHolder</b></a>, <a href="if_o_1gdu.htm"><b>IOleAdviseHolder</b></a>, <a href="if_o_1gh1.htm"><b>IOleObject::Advise</b></a>, <a href="if_o_7vol.htm"><b>IOleObject::Unadvise</b></a>, <a href="if_o_1cpx.htm"><b>IOleObject::EnumAdvise</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
