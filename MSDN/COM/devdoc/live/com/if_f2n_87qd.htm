<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IHttpNegotiate::OnResponse</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ihttpnegotiate_onresponse"></a>IHttpNegotiate::OnResponse</h2>
<p>
Allows the client of a bind operation to examine the response headers, optionally, terminate the bind operation, and add HTTP headers to a request before resending the request.</p>
<pre><code><b>HRESULT OnResponse(
  DWORD </b><i> dwResponseCode</i><b>,  </b>//HTTP response code received
<b>  LPCWSTR </b><i> szResponseHeaders</i><b>,</b>
<b>                          </b>//Response headers from the HTTP server
<b>  LPCWSTR </b><i> szRequestHeaders</i><b>,  </b>//HTTP headers provided by the bind 
                              //clients
<b>  LPWSTR *</b><i> pszAdditionalResquestHeaders</i>
<i>                          </i>//Optional additional HTTP headers
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>dwResponseCode</i></dt>
<dd>
[in] HTTP response code returned in response to a previous HTTP request. See the HTTP specification for information about these codes.</dd>
<dt>
<i>szResponseHeaders</i></dt>
<dd>
[in] Response headers from the HTTP server. See the HTTP specification for more information.</dd>
<dt>
<i>szRequestHeaders</i></dt>
<dd>
[in] If <i>dwResponseCode</i> indicates an error, contains HTTP request headers that will be used when the request is sent again.</dd>
<dt>
<i>pszAdditionalRequestHeaders</i></dt>
<dd>
[out] If <i>dwResponseCode</i> indicates an error, contains optional, additional headers to add before the request is sent again. If the specified header value conflicts with existing values in <i>szRequestHeaders</i>, then the new headers take precedence. If <i>pszAdditionalRequestHeaders</i> is set to NULL, no headers are added to the HTTP request.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The operation was successful. If the <i>dwResponseCode</i> indicates an error, any <i>szAdditionalRequestHeaders</i> are appended and the request is sent again.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
The parameter is invalid.</dd>
<dt>
E_ABORT</dt>
<dd>
Terminate the HTTP transaction.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The URL moniker calls this method when it has received a response to an HTTP request. If the <i>dwResponseCode</i> indicates a success, the client can examine the response headers and can optionally abort the bind operation. If the <i>dwResponseCode</i> indicates a failure, the client can add HTTP headers to the request before it is sent again.</p>
<p>
Note that if multiple clients have registered on the bind context for a given bind operation, more than one of these clients can provide an <b>IHttpNegotiate</b> callback interface. Every client providing this callback receives notifications. Each one is given a chance to add HTTP headers or to abort the HTTP transaction. In such cases, the last client to receive callback notification is the client driving the download operation, and it will dictate the final decision.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in urlmon.h.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_23am.htm"><b>IHttpNegotiate::BeginningTransaction</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
