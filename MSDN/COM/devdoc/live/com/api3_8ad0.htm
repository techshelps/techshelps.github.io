<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleDoAutoConvert</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oledoautoconvert"></a>OleDoAutoConvert</h1>
<p>
Automatically converts an object to a new class if automatic conversion for that object class is set in the registry.</p>
<pre><code><b>WINOLEAPI OleDoAutoConvert(
  IStorage *</b><i> pStg</i><b>,</b>   //Pointer to storage object to be converted
<b>  LPCLSID</b><i> pClsidNew  </i>//Pointer to new CLSID of converted object
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pStg</i></dt>
<dd>
[in] Pointer to the <a href="if_r2z_9b8l.htm"><b>IStorage</b></a> interface on the storage object to be converted.</dd>
<dt>
<i>pClsidNew</i></dt>
<dd>
[out] Pointserto the new CLSID for the object being converted. If there was no automatic conversion, this may be the same as the original class.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_INVALIDARG, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
No conversion is needed or a conversion was successfully completed.</dd>
<dt>
REGDB_E_KEYMISSING</dt>
<dd>
The function cannot read a key from the registry.
</dd>
</dl>
<p>
This function can also return any of the error values returned by the <a href="api3_3lys.htm"><b>OleGetAutoConvert</b></a> function. When accessing storage and stream objects, see the <a href="if_r2z_182t.htm"><b>IStorage::OpenStorage</b></a> and <a href="if_r2z_7x65.htm"><b>IStorage::OpenStream</b></a> methods for possible errors. When it is not possible to determine the existing CLSID or when it is not possible to update the storage object with new information, see the <a href="if_r2z_4x7x.htm"><b>IStream</b></a> interface for other error return values.</p>
<h4>Remarks</h4>
<p>
The <b>OleDoAutoConvert</b> function automatically converts an object if automatic conversion has previously been specified in the registry by the <a href="api3_82k4.htm"><b>OleSetAutoConvert</b></a> function. Object conversion means that the object is permanently associated with a new CLSID. Automatic conversion is typically specified by the setup program for a new version of an object application, so that objects created by its older versions can be automatically updated.</p>
<p>
A container application that supports object conversion should call <b>OleDoAutoConvert</b> each time it loads an object. If the container uses the <a href="api3_1cmc.htm"><b>OleLoad</b></a> helper function, it need not call <b>OleDoAutoConvert</b> explicitly because <b>OleLoad</b> calls it internally.</p>
<p>
<b>OleDoAutoConvert</b> first determines whether any conversion is required by calling the <a href="api3_3lys.htm"><b>OleGetAutoConvert</b></a> function, which, if no conversion is required, returns S_OK. If the object requires conversion, <b>OleDoAutoConvert</b> modifies and converts the storage object by activating the new object application. The new object application reads the existing data format, but saves the object in the new native format for the object application.</p>
<p>
If the object to be automatically converted is an OLE 1 object, the ItemName string is stored in a stream called "\1Ole10ItemName." If this stream does not exist, the object's item name is NULL.</p>
<p>
The storage object must be in the unloaded state when <b>OleDoAutoConvert</b> is called.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_82k4.htm"><b>OleSetAutoConvert</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
