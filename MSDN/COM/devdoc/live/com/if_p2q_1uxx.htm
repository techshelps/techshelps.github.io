<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPropertySetStorage::Create</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipropertysetstorage_create"></a>IPropertySetStorage::Create</h2>
<p>
Creates and opens a new property set in the property set storage object.</p>
<pre><code><b>HRESULT Create(
  REFFMTID</b><i> fmtid</i><b>, </b>//Format identifier of the property set to be 
                  //created
<b>  CLSID *</b><i> pclsid</i><b>, </b>//Pointer to initial CLSID for this property set
<b>  DWORD</b><i> grfFlags</i><b>, </b>//PROPSETFLAG values
<b>  DWORD</b><i> grfMode</i><b>,  </b>//Storage mode of new property set
<b>  IPropertyStorage**</b><i> ppPropStg</i>
<i>                  </i>//Address of output variable that receives the 
                  //IPropertyStorage interface pointer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>fmtid</i></dt>
<dd>
[in] Format identifier of the property set to be created.</dd>
<dt>
<i>pclsid</i> </dt>
<dd>
[in] Pointer to the initial CLSID for this property set. May be NULL, in which case it is set to all zeroes.</dd>
<dt>
<i>grfFlags</i></dt>
<dd>
[in] Values from the PROPSETFLAG enumeration.</dd>
<dt>
<i>grfMode</i></dt>
<dd>
[in] Access mode in which the newly created property set is to be opened, taken from certain values of the <b>STGM</b> enumeration, as described in the Remarks.</dd>
<dt>
<i>ppPropStg</i></dt>
<dd>
[out] Address of <b>IPropertyStorage</b>* pointer variable that receives the interface pointer to the new property storage sub-object.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return value E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The property set was created.</dd>
<dt>
STG_E_FILEALREADYEXISTS</dt>
<dd>
A property set of the indicated name already exists, and STGM_CREATE was not specified.</dd>
<dt>
STG_E_ACCESSDENIED</dt>
<dd>
The requested access to the property storage object has been denied.</dd>
<dt>
STG_E_INSUFFICIENTMEMORY</dt>
<dd>
There is not sufficient memory to perform this operation.</dd>
<dt>
STG_E_INVALIDPARAMETER</dt>
<dd>
A parameter is invalid.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>IPropertySetStorage::Create</b> creates and opens a new property set sub-object (supporting the <b>IPropertyStorage</b> interface) contained in this property set storage object. The property set automatically contains code page and locale ID properties. These are set to the current system default, and the current user default, respectively.</p>
<p>
The <i>grfFlags</i> parameter is a combination of values taken from the enumeration <a href="enums_4exz.htm"><b>PROPSETFLAG</b></a>.</p>
<p>
The <i>grfMode</i> parameter specifies the access mode in which the newly created set is to be opened. Values for this parameter are as in the like-named parameter to <b>IPropertySetStorage::Open,</b> with the addition of the following values:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%>Value</th>
<th align=left width=61%>Meaning</th>
</tr>
<tr valign=top>
<td width=39%>STGM_FAILIFTHERE</td>
<td width=61%>If another property set with the specified <i>fmtid</i> already exists, the call fails. This is the default action; that is, unless STGM_CREATE is specified, STGM_FAILIFTHERE is implied.</td>
</tr>
<tr valign=top>
<td width=39%>STGM_CREATE</td>
<td width=61%>If another property set with the specified <i>fmtid</i> already exists, it is removed and replaced with this new one.</td>
</tr>
<tr valign=top>
<td width=39%>STGM_DIRECT</td>
<td width=61%>Open the property set without an additional level of transaction nesting. This is the default (the behavior if neither STGM_DIRECT nor STGM_TRANSACTED is specified).</td>
</tr>
<tr valign=top>
<td width=39%>STGM_TRANSACTED</td>
<td width=61%>Open the property set with an additional level of transaction nesting (beyond the transaction, if any, on this property set storage). This is possible only when you specify PROPSETFLAG_NONSIMPLE in the <i>grfFlags</i> parameter. Changes in the property set must be committed with <a href="if_p2q_00ms.htm"><b>IPropertyStorage::Commit</b></a> before they are visible to the transaction on this property set storage.</td>
</tr>
<tr valign=top>
<td width=39%>STGM_READ</td>
<td width=61%>Read access is desired on the property set. Read permission is required on the property set storage.</td>
</tr>
<tr valign=top>
<td width=39%>STGM_WRITE</td>
<td width=61%>Write access is desired on the property set. Write permission is not required on the property set storage; however, such write permission is required for changes in the storage to be committed.</td>
</tr>
<tr valign=top>
<td width=39%>STGM_READWRITE</td>
<td width=61%>Read-write access is desired on the property set. Note that this flag is not the binary OR of the values STGM_READ and STGM_WRITE.</td>
</tr>
<tr valign=top>
<td width=39%>STGM_SHARE_EXCLUSIVE</td>
<td width=61%>Prevents others from subsequently opening the property set either in STGM_READ or STGM_WRITE mode.</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;The only access mode supported by <b>Create</b> is STGM_SHARE_EXCLUSIVE. To use the resulting property set in an access mode other than STGM_SHARE_EXCLUSIVE, the caller should close the stream and then re-open it with a call to <b>IPropertySetStorage::Open</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_p2q_7s1a.htm"><b>IPropertySetStorage::Open</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
