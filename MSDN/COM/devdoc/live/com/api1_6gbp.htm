<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoUnmarshalInterface</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_counmarshalinterface"></a>CoUnmarshalInterface</h1>
<p>
Initializes a newly created proxy using data written into the stream by a previous call to the <a href="api1_8205.htm"><b>CoMarshalInterface</b></a> function, and returns an interface pointer to that proxy. </p>
<pre><code><b>STDAPI CoUnmarshalInterface(
  IStream *</b><i> pStm</i><b>,  </b>//Pointer to the stream
<b>  REFIID</b><i> riid</i><b>,     </b>//Reference to the identifier of the interface
<b>  void **</b><i> ppv      </i>//Address of output variable that receives the 
                   // interface pointer requested in <i>riid</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pStm</i></dt>
<dd>
[in] Pointer to the stream from which the interface is to be unmarshaled.</dd>
<dt>
<i>riid</i></dt>
<dd>
[in] Reference to the identifier of the interface to be unmarshaled.</dd>
<dt>
<i>ppv</i></dt>
<dd>
[out] Address of pointer variable that receives the interface pointer requested in <i>riid</i>. Upon successful return, *<i>ppv</i> contains the requested interface pointer for the unmarshaled interface.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return value E_FAIL, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The interface pointer was unmarshaled successfully.</dd>
<dt>
STG_E_INVALIDPOINTER</dt>
<dd>
<i>pStm</i> is an invalid pointer.</dd>
<dt>
CO_E_NOTINITIALIZED</dt>
<dd>
The <a href="api1_36qt.htm"><b>CoInitialize</b></a> or <a href="api3_6med.htm"><b>OleInitialize</b></a> function was not called on the current thread before this function was called.</dd>
<dt>
CO_E_OBJNOTCONNECTED</dt>
<dd>
The object application has been disconnected from the remoting system (for example, as a result of a call to the <a href="api1_4mk4.htm"><b>CoDisconnectObject</b></a> function).</dd>
<dt>
REGDB_E_CLASSNOTREG</dt>
<dd>
An error occurred reading the registration database.</dd>
<dt>
E_NOINTERFACE</dt>
<dd>
The final <b>QueryInterface</b> of this function for the requested interface returned E_NOINTERFACE.</dd>
<dt>
<b>CoCreateInstance</b> errors</dt>
<dd>
An error occurred when creating the handler.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>CoUnmarshalInterface</b> function performs the following tasks:
<ol>
<li>
Reads from the stream the CLSID to be used to create an instance of the proxy.</li>
<li>
Gets an <a href="if_f2n_6sh8.htm"><b>IMarshal</b></a> pointer to the proxy that is to do the unmarshaling. If the object uses COM's default marshaling implementation, the pointer thus obtained is to an instance of the generic proxy object. If the marshaling is occurring between two threads in the same process, the pointer is to an instance of the in-process free threaded marshaler. If the object provides its own marshaling code, <b>CoUnmarshalInterface</b> calls the <a href="api1_1nad.htm"><b>CoCreateInstance</b></a> function, passing the CLSID it read from the marshaling stream. <b>CoCreateInstance</b> creates an instance of the object's proxy and returns an <b>IMarshal</b> interface pointer to the proxy.</li>
<li>
Using whichever <b>IMarshal</b> interface pointer it has acquired, the function then calls <a href="if_f2n_3icl.htm"><b>IMarshal::UnmarshalInterface</b></a> and, if appropriate, <a href="if_f2n_74v5.htm"><b>IMarshal::ReleaseMarshalData</b></a>. </li>
</ol>
<p>
The primary caller of this function is COM itself, from within interface proxies or stubs that unmarshal an interface pointer. There are, however, some situations in which you might call <a href="#_com_counmarshalinterface"><b>CoUnmarshalInterface</b></a>. For example, if you are implementing a stub, your implementation would call <b>CoUnmarshalInterface</b> when the stub receives an interface pointer as a parameter in a method call.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api1_8205.htm"><b>CoMarshalInterface</b></a>, <a href="if_f2n_3icl.htm"><b>IMarshal::UnmarshalInterface</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
