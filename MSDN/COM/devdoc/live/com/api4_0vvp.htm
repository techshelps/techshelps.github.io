<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>URLDownLoadToFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_urldownloadtofile"></a>URLDownLoadToFile</h1>
<p>
Downloads bits from the Internet and saves them to a file. The client can optionally be notified of progress by means of a notification callback.</p>
<pre><code><b>HRESULT URLDownloadToFile(
  LPUNKNOWN</b><i> pCaller</i><b>,  </b>// Caller's controlling <a href="if_r2z_9dwu.htm">IUnknown</a>
<b>  LPCWSTR</b><i> szURL</i><b>,      </b>// Pointer to URL to be downloaded
<b>  LPCTSTR</b><i> szFileName</i><b>, </b>// Pointer to file name
<b>  DWORD</b><i> dwResv</i><b>,       </b>// Reserved for future use
<b>  LPBINDSTATUSCALLBACK</b><i> lpfnCB</i>
<i>                      </i>// Caller's <a href="if_a2e_0vxn.htm">IBindStatusCallback</a>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pCaller</i></dt>
<dd>
[in] Pointer to the caller's controlling <b>IUnknown</b>. If the caller is not an ActiveX component, this value may be set to NULL.</dd>
<dt>
<i>szURL</i></dt>
<dd>
[out] Pointer to the URL to be downloaded. Cannot be NULL.</dd>
<dt>
<i>szFileName</i></dt>
<dd>
[out] Pointer to the name of the file returned by this function. The user should pass a buffer to be filled and, preferably, use MAX_PATH to allocate the maximum path size.</dd>
<dt>
<i>dwResv</i></dt>
<dd>
[in] Reserved for future use; must be zero.</dd>
<dt>
<i>lpfnCB</i></dt>
<dd>
[in] Pointer to the caller's <b>IBindStatusCallback</b> interface. Can be NULL.</dd>
</dl>
<h4>Return Values</h4>
<p>
This function returns the same values as <b>IBindHost::MonikerBindToStorage</b>.</p>
<h4>Remarks</h4>
<p>
<b>URLDownloadToFile</b> calls the caller's <b>IBindStatusCallback</b> interface to provide notifications during the binding process. In particular, <b>URLDownloadToFile</b> calls <a href="if_a2e_35ir.htm"><b>IBindStatusCallback::OnProgress</b></a> to report the ongoing status of the download. The caller does not need not implement any of the notification callbacks for the function to succeed, but doing so allows the client to receive notifications, if interested, and also allows downloads to be canceled by returning E_ABORT from the <b>OnProgress</b> call.</p>
<p>
If <i>pCaller</i> is non-NULL, the caller is a COM object that is contained in another component, such as an ActiveX Control in the context of an HTML page. In this case, the function attempts the download in the context of the ActiveX client framework and allows the caller's container to receive callbacks on the progress of the download.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in urlmon.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_0vxn.htm"><b>IBindStatusCallback</b></a>, <a href="if_a2e_35ir.htm"><b>IBindStatusCallback::OnProgress</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
