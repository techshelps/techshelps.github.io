<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistFile::IsDirty</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipersistfile_isdirty"></a>IPersistFile::IsDirty</h2>
<p>
Checks an object for changes since it was last saved to its current file.</p>
<pre><b><code>HRESULT IsDirty(<i>void</i>);
 </code></b></pre>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
The object has changed since it was last saved.</dd>
<dt>
S_FALSE </dt>
<dd>
The object has not changed since the last save.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method checks whether an object has changed since it was last saved. Call it to determine whether an object should be saved before closing it. The dirty flag for an object is conditionally cleared in the <a href="if_p2q_8twl.htm"><b>IPersistFile::Save</b></a> method.</p>
<h5>Notes to Callers</h5>
<p>
OLE does not call <b>IPersistFile::IsDirty</b>. Applications would not call it unless they are also saving an object to a file.</p>
<p>
You should treat any error return codes as an indication that the object has changed. Unless this method explicitly returns S_FALSE, assume that the object must be saved.</p>
<h5>Notes to Implementers</h5>
<p>
An object with no contained objects simply checks its dirty flag to return the appropriate result.</p>
<p>
A container with one or more contained objects must maintain an internal dirty flag that is set when any of its contained objects has changed since it was last saved. To do this, the container should maintain an advise sink by implementing the <a href="if_a2e_6pnv.htm"><b>IAdviseSink</b></a> interface. Then, the container can register each link or embedding for data change notifications with a call to <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a>. Then, the container can set its internal dirty flag when it receives an <a href="if_a2e_2tgl.htm"><b>IAdviseSink::OnDataChange</b></a> notification. If the container does not register for data change notifications, the <b>IPersistFile::IsDirty</b> implementation would call <a href="if_p2q_85x5.htm"><b>IPersistStorage::IsDirty</b></a> for each of its contained objects to determine whether they have changed.</p>
<p>
The container can clear its dirty flag whenever it is saved, as long as the file to which the object is saved is the current working file after the save. Therefore, the dirty flag would be cleared after a successful "Save" or "Save As" operation, but not after a "Save A Copy As . . ." operation. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_2tgl.htm"><b>IAdviseSink::OnDataChange</b></a>, <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a>, <a href="if_p2q_85x5.htm"><b>IPersistStorage::IsDirty</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
