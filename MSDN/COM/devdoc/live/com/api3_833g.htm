<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleUIPasteSpecial</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleuipastespecial"></a>OleUIPasteSpecial</h1>
<p>
Invokes the standard Paste Special dialog box, allowing the user to select the format of the clipboard object to be pasted or paste-linked.</p>
<pre><code><b>UINT OleUIPasteSpecial(*
  LPOLEUIPASTESPECIAL</b><i> lpPS  </i>//Pointer to the in-out structure for 
                            // this dialog box
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>lpPS</i></dt>
<dd>
[in] Pointer to the in-out <b>OLEUIPASTESPECIAL</b> structure for this dialog box.
</dd>
</dl>
<h4>Return Values</h4>
<p>
<i>Standard Success/Error Definitions</i>
<dl>
<dt>
OLEUI_FALSE</dt>
<dd>
Unknown failure (unused).</dd>
<dt>
OLEUI_SUCCESS</dt>
<dd>
No error, same as OLEUI_OK.</dd>
<dt>
OLEUI_OK</dt>
<dd>
The user pressed the OK button.</dd>
<dt>
OLEUI_CANCEL</dt>
<dd>
The user pressed the Cancel button.
</dd>
</dl>
<p>
<i>Standard Field Validation Errors</i>
<dl>
<dt>
OLEUI_ERR_STANDARDMIN</dt>
<dd>
Errors common to all dialog boxes lie in the range OLEUI_ERR_STANDARDMIN to OLEUI_ERR_STANDARDMAX. This value allows the application to test for standard messages in order to display error messages to the user.</dd>
<dt>
OLEUI_ERR_STRUCTURENULL</dt>
<dd>
The pointer to an OLEUIXXX structure passed into the function was NULL.</dd>
<dt>
OLEUI_ERR_STRUCTUREINVALID</dt>
<dd>
Insufficient permissions for read or write access to an OLEUIXXX structure.</dd>
<dt>
OLEUI_ERR_CBSTRUCTINCORRECT</dt>
<dd>
The <i>cbstruct</i> value is incorrect.</dd>
<dt>
OLEUI_ERR_HWNDOWNERINVALID</dt>
<dd>
The <i>hWndOwner</i> value is invalid. </dd>
<dt>
OLEUI_ERR_LPSZCAPTIONINVALID</dt>
<dd>
The <i>lpszCaption</i> value is invalid. </dd>
<dt>
OLEUI_ERR_LPFNHOOKINVALID</dt>
<dd>
The <i>lpfnHook </i>value is invalid.</dd>
<dt>
OLEUI_ERR_HINSTANCEINVALID</dt>
<dd>
The <i>hInstance</i> value is invalid.</dd>
<dt>
OLEUI_ERR_LPSZTEMPLATEINVALID</dt>
<dd>
The <i>lpszTemplate</i> value is invalid.</dd>
<dt>
OLEUI_ERR_HRESOURCEINVALID</dt>
<dd>
The <i>hResource</i> value is invalid.
</dd>
</dl>
<p>
<i>Initialization Errors</i>
<dl>
<dt>
OLEUI_ERR_FINDTEMPLATEFAILURE</dt>
<dd>
Unable to find the dialog box template.</dd>
<dt>
OLEUI_ERR_LOADTEMPLATEFAILURE</dt>
<dd>
Unable to load the dialog box template.</dd>
<dt>
OLEUI_ERR_DIALOGFAILURE</dt>
<dd>
Dialog box initialization failed.</dd>
<dt>
OLEUI_ERR_LOCALMEMALLOC</dt>
<dd>
A call to <b>LocalAlloc</b> or the standard <i>IMalloc</i> allocator failed.</dd>
<dt>
OLEUI_ERR_GLOBALMEMALLOC</dt>
<dd>
A call to <b>GlobalAlloc</b> or the standard <i>IMalloc</i> allocator failed.</dd>
<dt>
OLEUI_ERR_LOADSTRING</dt>
<dd>
Unable to <b>LoadString</b> localized resources from the library.</dd>
<dt>
OLEUI_ERR_OLEMEMALLOC</dt>
<dd>
A call to the standard <i>IMalloc</i> allocator failed.
</dd>
</dl>
<p>
<i>Function Specific Errors </i>
<dl>
<dt>
OLEUI_ERR_STANDARDMAX</dt>
<dd>
Errors common to all dialog boxes lie in the range OLEUI_ERR_STANDARDMIN to OLEUI_ERR_STANDARDMAX. This value allows the application to test for standard messages in order to display error messages to the user.</dd>
<dt>
OLEUI_IOERR_SRCDATAOBJECTINVALID</dt>
<dd>
The <i>lpSrcDataObject</i> field of <b>OLEUIPASTESPECIAL</b> is invalid.</dd>
<dt>
OLEUI_IOERR_ARRPASTEENTRIESINVALID </dt>
<dd>
The <i>arrPasteEntries </i>field of <b>OLEUIPASTESPECIAL</b> is invalid.</dd>
<dt>
OLEUI_IOERR_ARRLINKTYPESINVALID</dt>
<dd>
The <i>arrLinkTypes </i>field of <b>OLEUIPASTESPECIAL</b> is invalid.</dd>
<dt>
OLEUI_PSERR_CLIPBOARDCHANGED</dt>
<dd>
The clipboard contents changed while the dialog box was displayed.</dd>
<dt>
OLEUI_PSERR_GETCLIPBOAARDFAILED</dt>
<dd>
The <i>lpSrcDataObj</i> member is incorrect.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The design of the Paste Special dialog box assumes that if you are willing to permit a user to link to an object, you are also willing to permit the user to embed that object. For this reason, if any of the OLEUIPASTE_LINKTYPE flags associated with the <a href="enums_0b6v.htm"><b>OLEUIPASTEFLAG</b></a> enumeration are set, then the OLEUIPASTE_PASTE flag must also be set in order for the data formats to appear in the Paste Special dialog box.</p>
<p>
The text displayed in the Source field of the standard Paste Special dialog box, which is implemented in OLEDLG32.DLL, is the null-terminated string whose offset in bytes is specified in the <i>dwSrcofCopy</i> field of the <a href="structs_61bm.htm"><b>OBJECTDESCRIPTOR</b></a> structure for the object to be pasted. If an OBJECTDESCRIPTOR structure is not available for this object, the dialog box displays whatever text may be associated with <b>CF_LINKSOURCEDESCRIPTOR</b>. If neither structure is available, the dialog box looks for CF_FILENAME. If CF_FILENAME is not found, the dialog box displays the string "Unknown Source".</p>
<p>
To free an HMETAFILEPICT returned from the Insert Object or Paste Special dialog box, delete the attached metafile on the handle, as follows:</p>
<pre><code>void FreeHmetafilepict(HMETAFILEPICT hmfp) 
{ 
    if (hmfp != NULL) 
        { 
        LPMETAFILEPICT pmfp = GlobalLock(hmfp); 
 
        DeleteMetaFile(pmfp-&gt;hMF); 
        GlobalUnlock(hmfp); 
        GlobalFree(hmfp); 
        } 
}  // FreeHmetafilepict 
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oledlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in oledlg.dll.</p>
<h4>See Also</h4>
<p>
<a href="enums_0b6v.htm"><b>OLEUIPASTEFLAG</b></a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_deletemetafile">
</object><a href=JavaScript:alink_1.Click()><b>DeleteMetaFile</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalunlock">
</object><a href=JavaScript:alink_2.Click()><b>GlobalUnlock</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalfree">
</object><a href=JavaScript:alink_3.Click()><b>GlobalFree</b></a> in Win32 </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
