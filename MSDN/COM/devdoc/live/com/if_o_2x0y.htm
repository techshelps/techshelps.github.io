<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleLink::GetSourceMoniker</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iolelink_getsourcemoniker"></a>IOleLink::GetSourceMoniker</h2>
<p>
Retrieves the moniker identifying the link source of a linked object.</p>
<pre><code><b>HRESULT GetSourceMoniker(
  IMoniker</b><i> **ppmk  </i>//Address of output variable that receives the 
                   // IMoniker interface pointer
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>ppmk</i></dt>
<dd>
[out] Address of <b>IMoniker</b>* pointer variable that receives the interface pointer to an absolute moniker that identifies the link source. When successful, the implementation must call <a href="if_r2z_3rja.htm"><b>IUnknown::AddRef</b></a> on *<i>ppmk</i>; it is the caller's responsibility to call <a href="if_r2z_59np.htm"><b>IUnknown::Release</b></a>. If an error occurs the implementation must set *<i>ppmk</i> to NULL. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The moniker was returned successfully.</dd>
<dt>
MK_E_UNAVAILABLE</dt>
<dd>
No moniker is available.
</dd>
</dl>
<h4>Remarks</h4>
<h5>Notes to Callers</h5>
<p>
Your container application can call <b>IOleLink::GetSourceMoniker</b> to display the current source of a link in the Links dialog box. Note that this requires your container to use the <a href="if_f2n_1tb9.htm"><b>IMoniker::GetDisplayName</b></a> method to get the display name of the moniker. If you'd rather get the display name directly, your container can call <b>IOleLink::GetSourceDisplayName</b> instead of <b>IOleLink::GetSourceMoniker</b>.</p>
<p>
If you use the <a href="api3_4yib.htm"><b>OleUIEditLinks</b></a> function to display the Links dialog box, you must implement the <b>IOleUILinkContainer</b> interface. The dialog box calls your implementations of <b>IOleUILinkContainer::GetLinkSource</b> to get the string it should display. Your implementation of that method can call <b>IOleLink::GetSourceMoniker</b>. </p>
<h5>Notes on Provided Implementation </h5>
<p>
The linked object stores both an absolute and a relative moniker for the link source. If the relative moniker is non-NULL and a moniker is available for the compound document, <b>IOleLink::GetSourceMoniker</b> returns the moniker created by composing the relative moniker onto the end of the compound document's moniker. Otherwise, it returns the absolute moniker or, if an error occurs, NULL.</p>
<p>
The container specifies the absolute moniker when it calls one of the <a href="api3_0n3f.htm"><b>OleCreateLink</b></a> functions to create a link. The application can call <b>IOleLink::SetSourceMoniker</b> or <b>IOleLink::SetSourceDisplayName</b> to change the absolute moniker. In addition, the linked object automatically updates the monikers whenever it successfully binds to the link source, or when it is bound to the link source and it receives a rename notification through the <a href="if_a2e_73fp.htm"><b>IAdviseSink::OnRename</b></a> method.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_7ew5.htm"><b>IOleLink::SetSourceDisplayName</b></a>, <a href="if_o_4saa.htm"><b>IOleLink::SetSourceMoniker</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
