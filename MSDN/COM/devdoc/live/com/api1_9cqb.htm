<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoTreatAsClass</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_cotreatasclass"></a>CoTreatAsClass</h1>
<p>
Establishes or removes an emulation, in which objects of one class are treated as objects of a different class.</p>
<pre><code><b>STDAPI CoTreatAsClass(
  REFCLSID</b><i> clsidOld</i><b>,</b> 
                     //CLSID for the original object to be emulated
<b>  REFCLSID</b><i> clsidNew  </i>//CLSID for the new object that emulates the 
                     // original
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>clsidOld</i></dt>
<dd>
[in] CLSID of the object to be emulated.</dd>
<dt>
<i>clsidNew</i></dt>
<dd>
[in] CLSID of the object that should emulate the original object. This replaces any existing emulation for <i>clsidOld</i>. Can be CLSID_NULL, in which case any existing emulation for <i>clsidOld </i>is removed.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return value E_INVALIDARG, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The emulation was successfully established or removed.</dd>
<dt>
REGDB_E_CLASSNOTREG</dt>
<dd>
The <i>clsidOld</i> parameter is not properly registered in the registration database.</dd>
<dt>
REGDB_E_READREGDB</dt>
<dd>
Error reading from registration database.</dd>
<dt>
REGDB_E_WRITEREGDB</dt>
<dd>
Error writing to registration database.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This function sets the <b>TreatAs</b> entry in the registry for the specified object, allowing the object to be emulated by another application. Emulation allows an application to open and edit an object of a different format, while retaining the original format of the object. After this entry is set, whenever any function like <a href="api1_6yb8.htm"><b>CoGetClassObject</b></a> specifies the object's original CLSID (<i>clsidOld</i>), it is transparently forwarded to the new CLSID (<i>clsidNew</i>), thus launching the application associated with the <b>TreatAs</b> CLSID. When the object is saved, it can be saved in its native format, which may result in loss of edits not supported by the original format. </p>
<p>
You would call <b>CoTreatAsClass</b> in two situations if your application supports emulation:
<ul>
<li>
In response to an end-user request (through a conversion dialog box) that a specified object be treated as an object of a different class (an object created under one application be run under another application, while retaining the original format information).</li>
<li>
In a setup program, to register that one class of objects be treated as objects of a different class.</li>
</ul>
<p>
An example of the first case is that an end user might wish to edit a spreadsheet created by one application using a different application that can read and write the spreadsheet format of the original application. For an application that supports emulation, <b>CoTreatAsClass</b> can be called to implement a Treat As option in a conversion dialog box.</p>
<p>
An example of the use of <b>CoTreatAsClass</b> in a setup program would be in an updated version of an application. When the application is updated, the objects created with the earlier version can be activated and treated as objects of the new version, while retaining the previous format information. This would allow you to give the user the option to convert when they save, or to save it in the previous format, possibly losing format information not available in the older version.</p>
<p>
One result of setting an emulation is that when you enumerate verbs, as in the <b>IOleObject::EnumVerbs</b> method implementation in the default handler, this would enumerate the verbs from <i>clsidNew</i> instead of <i>clsidOld</i>.</p>
<p>
To ensure that existing emulation information is removed when you install an application, your setup programs should call <b>CoTreatAsClass</b>, setting the <i>clsidNew</i> parameter to CLSID_NULL to remove any existing emulation for the classes they install.</p>
<p>
If there is no CLSID assigned to the <b>AutoTreatAs</b> key in the registry, setting <i>clsidNew</i> and <i>clsidOld</i> to the same value removes the <b>TreatAs</b> entry, so there is no emulation. If there is a CLSID assigned to the <b>AutoTreatAs</b> key, that CLSID is assigned to the <b>TreatAs</b> key.</p>
<p>
The <b>CoTreatAsClass</b> function does not validate whether an appropriate registry entry for <i>clsidNew</i> currently exists.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api1_95f7.htm"><b>CoGetTreatAsClass</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
