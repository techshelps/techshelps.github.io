<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPicture::get_hPal</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipicture_get_hpal"></a>IPicture::get_hPal</h2>
<p>
Returns a copy of the palette currently used by the picture object.</p>
<pre><code><b>HRESULT get_hPal(
  OLE_HANDLE*</b><i> phpal  </i>//Receives a pointer to palette handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>phpal</i></dt>
<dd>
[out] Pointer to the caller's <b>OLE_HANDLE</b> variable to receive the palette handle. The variable is set to NULL on failure.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_FAIL and E_OUTOFMEMORY, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The handle was returned successfully.</dd>
<dt>
S_FALSE</dt>
<dd>
This picture has no palette. The parameter *<i>phpal</i> is set to NULL.</dd>
<dt>
E_POINTER</dt>
<dd>
The address in <i>phpal</i> is not valid. For example, it may be NULL.
</dd>
</dl>
<h4>Remarks</h4>
<h5>Notes to Callers</h5>
<p>
If the picture object has ownership of the picture, it also has ownership of the palette and will destroy it when the object is itself destroyed. Otherwise the caller owns the palette. The <i>fOwn</i> parameter to <a href="api3_22wk.htm"><b>OleCreatePictureIndirect</b></a> determines ownership. <a href="api3_936t.htm"><b>OleLoadPicture</b></a> sets <i>fOwn</i> to TRUE to indicate that the picture object owns the palette.</p>
<p>
</p>
<p>
</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<p>&nbsp;</p></body>
</HTML>
