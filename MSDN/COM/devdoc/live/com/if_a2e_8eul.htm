<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IBindCtx::RegisterObjectParam</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ibindctx_registerobjectparam"></a>IBindCtx::RegisterObjectParam</h2>
<p>
Stores an <b>IUnknown</b> pointer on the specified object under the specified key in the bind context's string-keyed table of pointers. The method must call <a href="if_r2z_3rja.htm"><b>IUnknown::AddRef</b></a> on the stored pointer. </p>
<pre><code><b>HRESULT RegisterObjectParam(
  LPOLESTR</b><i> pszKey</i><b>,  </b>//Pointer to the key to be used
<b>  IUnknown</b><i> *punk    </i>//Pointer to the object to be associated with 
                    // the key
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pszKey</i></dt>
<dd>
[in] Pointer to a zero-terminated wide character string (two bytes per character) containing the key under which the object is being registered. Key string comparison is case-sensitive.</dd>
<dt>
<i>punk</i></dt>
<dd>
[in] Pointer to the <b>IUnknown</b> interface on the object that is to be registered.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return value E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
The pointer was successfully registered under the specified string.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A bind context maintains a table of interface pointers, each associated with a string key. This enables communication between a moniker implementation and the caller that initiated the binding operation. One party can store an interface pointer under a string known to both parties so that the other party can later retrieve it from the bind context. </p>
<p>
Binding operations subsequent to the use of this method can use <a href="if_a2e_9o6l.htm"><b>IBindCtx::GetObjectParam</b></a> to retrieve the stored pointer. </p>
<h5>Notes to Callers</h5>
<p>
<b>IBindCtx::RegisterObjectParam</b> is useful to those implementing a new moniker class (through an implementation of <b>IMoniker</b>) and to moniker clients (those who use monikers to bind to objects).</p>
<p>
In implementing a new moniker class, you call this method when an error occurs during moniker binding to inform the caller of the cause of the error. The key that you would obtain with a call to this method would depend on the error condition. The following lists common moniker binding errors, describing for each the keys that would be appropriate:
<dl>
<dt>
MK_E_EXCEEDEDDEADLINE</dt>
<dd>
If a binding operation exceeds its deadline because a given object is not running, you should register the object's moniker using the first unused key from the list: "ExceededDeadline", "ExceededDeadline1", "ExceededDeadline2", etc. If the caller later finds the moniker in the Running Object Table, the caller can retry the binding operation.</dd>
<dt>
MK_E_CONNECTMANUALLY</dt>
<dd>
The "ConnectManually" key indicates a moniker whose binding requires assistance from the end user. The caller can retry the binding operation after showing the moniker's display name to request that the end user manually connect to the object. Common reasons for this error are that a password is needed or that a floppy needs to be mounted.</dd>
<dt>
E_CLASSNOTFOUND</dt>
<dd>
The "ClassNotFound" key indicates a moniker whose class could not be found (the server for the object identified by this moniker could not be located). If this key is used for an OLE compound-document object, the caller can use <a href="if_f2n_1kx1.htm"><b>IMoniker::BindToStorage</b></a> to bind to the object, and then try to carry out a Treat As... or Convert To... operation to associate the object with a different server. If this is successful, the caller can retry the binding operation.
</dd>
</dl>
<p>
If you're a moniker client with detailed knowledge of the implementation of the moniker you're using, you can also call this method to pass private information to that implementation. </p>
<p>
You can define new strings as keys for storing pointers. By convention, you should use key names that begin with the string form of the CLSID of the moniker class (see the <a href="api4_4hwk.htm"><b>StringFromCLSID</b></a> function). </p>
<p>
If the <i>pszKey</i> parameter matches the name of an existing key in the bind context's table, the new object replaces the existing object in the table. </p>
<p>
When you register an object using this method, the object is not released until one of the following occurs:
<ul>
<li>
It is replaced in the table by another object with the same key.</li>
<li>
It is removed from the table by a call to <a href="if_a2e_7c4t.htm"><b>IBindCtx::RevokeObjectParam</b></a>.</li>
<li>
The bind context is released. All registered objects are released when the bind context is released.</li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_9o6l.htm"><b>IBindCtx::GetObjectParam</b></a>, <a href="if_a2e_7c4t.htm"><b>IBindCtx::RevokeObjectParam</b></a>, <a href="if_a2e_1iul.htm"><b>IBindCtx::EnumObjectParam</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
