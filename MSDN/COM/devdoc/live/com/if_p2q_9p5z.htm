<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistPropertyBag</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ipersistpropertybag"></a>IPersistPropertyBag</h1>
<p>
The <b>IPersistPropertyBag</b> interface works in conjunction with <a href="if_p2q_19uv.htm"><b>IPropertyBag</b></a> and <a href="if_a2e_8ucn.htm"><b>IErrorLog</b></a> to define an individual property-based persistence mechanism. Whereas a mechanism like <b>IPersistStream</b> gives an object an <b>IStream</b> in which to store its binary data, <b>IPersistPropertyBag</b> provides an object with an <b>IPropertyBag</b> interface through which it can save and load individual properties. The implementer of <b>IPropertyBag</b> can then save those properties<i> </i>in whatever way it chooses, such as name/value pairs in a text file. Errors encountered in the process (on either side) are recorded in an error log through <b>IErrorLog</b>. This error reporting mechanism work on a per-property basis instead of an all properties as a whole basis through just the return value of <b>IPersist*::Load</b> or <b>IPersist*::Save</b>.</p>
<p>
The basic mechanism is that a container tells the object to save or load its properties through <b>IPersistPropertyBag</b>. For each property, the object calls the container's <b>IPropertyBag</b> interface passed to the <b>IPersistPropertyBag</b> methods. <b>IPropertyBag::Write</b> saves a property in whatever place the container wants to put it, and <b>IPropertyBag::Read</b> retrieves a property.</p>
<p>
This protocol is essentially a means of sequentially communicating individual property values from the object to the container, which is useful for doing save-as-text operations and the like. The object gives the container the choice of the format in which each property is saved, while retaining itself the decision as to which properties are saved or loaded.</p>
<h5>When to Implement</h5>
<p>
An object implements this interface to enable saving its properties persistently.</p>
<h5>When to Use</h5>
<p>
A container calls the methods on this interface to instruct an object to load and save its properties to the supplied property bag.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%><a href="if_r2z_9dwu.htm">IUnknown</a> Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=55%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=55%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=55%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%><a href="if_p2q_3lbo.htm">IPersist</a> Method</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_1yn8.htm"><b>GetClassID</b></a></td>
<td width=55%>Returns the class identifier (CLSID) for the component object.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IPersistPropertyBag Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_5t4n.htm"><b>InitNew</b></a></td>
<td width=55%>Called by the container when the control is initialized to initialize the property bag.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_1ijo.htm"><b>Load</b></a></td>
<td width=55%>Called by the container to load the control's properties.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_9n8l.htm"><b>Save</b></a></td>
<td width=55%>Called by the container to save the object's properties.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_8ucn.htm"><b>IErrorLog</b></a>, <a href="if_p2q_19uv.htm"><b>IPropertyBag</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
