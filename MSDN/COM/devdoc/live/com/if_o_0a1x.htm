<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleObject::GetUserType</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleobject_getusertype"></a>IOleObject::GetUserType</h2>
<p>
Retrieves the user-type name of an object for display in user-interface elements such as menus, list boxes, and dialog boxes.</p>
<pre><code><b>HRESULT GetUserType(
  DWORD</b><i> dwFormOfType</i><b>,  </b>//Specifies form of type name
<b>  LPOLESTR</b><i> *pszUserType</i>
<i>                       </i>//Address of output variable that receives a 
                       // pointer to the requested user type string
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwFormOfType</i></dt>
<dd>
[in] Value specifying the form of the user-type name to be presented to users. Valid values are obtained from the <a href="enums_5085.htm"><b>USERCLASSTYPE</b></a> enumeration.</dd>
<dt>
<i>pszUserType</i></dt>
<dd>
[out] Address of <b>LPOLESTR</b> pointer variable that receives a pointer to the user type string. The caller must free *<i>pszUserType</i> using the current <a href="if_f2n_5h5v.htm"><b>IMalloc</b></a> instance. If an error occurs, the implementation must set *<i>pszUserType</i> to NULL.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The object's user-type name is successfully returned.</dd>
<dt>
OLE_S_USEREG</dt>
<dd>
Delegate to the default handler's implementation using the registry to provide the requested information. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
Containers call <b>IOleObject::GetUserType</b> in order to represent embedded objects in list boxes, menus, and dialog boxes by their normal, user-recognizable names. Examples include "Word Document," "Excel Chart," and "Paintbrush Object." The information returned by <b>IOleObject::GetUserType</b> is the user-readable equivalent of the binary class identifier returned by <a href="if_o_1ctg.htm"><b>IOleObject::GetUserClassID</b></a>.</p>
<h5>Notes to Callers</h5>
<p>
The default handler's implementation of <b>IOleObject::GetUserType</b> uses the object's class identifier (the <i>pClsid</i> parameter returned by <b>IOleObject::GetUserClassID</b>) and the <i>dwFormOfType</i> parameter together as a key into the registry. If an entry is found that matches the key exactly, then the user type specified by that entry is returned. If only the CLSID part of the key matches, then the lowest-numbered entry available (usually the full name) is used. If the CLSID is not found, or there are no user types registered for the class, the user type currently found in the object's storage is used.</p>
<p>
You should not cache the string returned from <b>GetUserType.</b> Instead, call this method each and every time the string is needed. This guarantees correct results when the embedded object is being converted from one type into another without the caller's knowledge. Calling this method is inexpensive because the default handler implements it using the registry.</p>
<h5>Notes to Implementers</h5>
<p>
You can use the implementation provided by the default handler by returning OLE_S_USEREG as your application's implementation of this method. If the user type name is an empty string, the message "Unknown Object" is returned.</p>
<p>
You can call the OLE helper function <a href="api3_8uhx.htm"><b>OleRegGetUserType</b></a> to return the appropriate user type.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_3xyr.htm"><b>IOleObject::SetHostNames</b></a>, <a href="if_o_1ctg.htm"><b>IOleObject::GetUserClassID</b></a>, <a href="api3_8uhx.htm"><b>OleRegGetUserType</b></a>, <a href="api3_1tuv.htm"><b>ReadFmtUserTypeStg</b></a>, <a href="enums_5085.htm"><b>USERCLASSTYPE</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
