<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IViewObjectEx::GetViewStatus</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iviewobjectex_getviewstatus"></a>IViewObjectEx::GetViewStatus</h2>
<p>
Returns information about the opacity of the object, and what drawing aspects are supported.</p>
<pre><code><b>HRESULT GetViewStatus(
  DWORD*</b><i> pdwStatus</i><b>,  </b>//Pointer to the view status
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pdwStatus</i></dt>
<dd>
[out] Pointer to the view status. This information is returned as a combination of the <a href="enums_3d0z.htm"><b>VIEWSTATUS</b></a> enumeration values.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The view status was successfully returned. This method should never fail or return an error code.
</dd>
</dl>
<h4>Remarks</h4>
<p>
In order to optimize the drawing process, the container needs to be able to determine whether an object is opaque and whether it has a solid background. It is not necessary to redraw objects that are entirely covered by a completely opaque object. Other operations, such as scrolling for example, can also be highly optimized if an object is opaque and has a solid background.</p>
<p>
The <b>IViewObjectEx::GetViewStatus</b> method returns whether the object is entirely opaque or not (VIEWSTATUS_OPAQUE bit) and whether its background is solid (VIEWSTATUS_SOLIDBKGND bit). This information may change in time. An object may be opaque at a given time and become totally or partially transparent later on, for example, because of a change of the BackStyle property. An object should notify its sites when it changes using <a href="if_a2e_2opx.htm"><b>IAdviseSinkEx::OnViewStatusChange</b></a> so the sites can cache this information for high speed access.</p>
<p>
Objects not supporting <b>IViewObjectEx</b> are considered to be always transparent.</p>
<p>
The <b>IViewObjectEx::GetViewStatus</b> method also returns a combination of bits indicating which aspects are supported.</p>
<p>
If a given drawing aspect is not supported, all <b>IViewObjectEx</b> methods taking a drawing aspect as an input parameter should fail and return E_INVALIDARG. The <b>IViewObjectEx::GetViewStatus</b> method allows the container to get back information about all drawing aspects in one quick call. Normally the set of supported drawing aspects should not change with time. However, if this was not the case, an object should notify its container using <b>IAdviseSinkEx::OnViewStatusChange</b>.</p>
<p>
Which drawing aspects are supported is independent of whether the object is opaque, partially transparent, or totally transparent. In particular, a transparent object that does not support DVASPECT_TRANSPARENT should be drawn correctly during the back to front pass using DVASPECT_CONTENT. However, this is likely to result in more flicker.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_2opx.htm"><b>IAdviseSinkEx::OnViewStatusChange</b></a>, <a href="enums_3d0z.htm"><b>VIEWSTATUS</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
