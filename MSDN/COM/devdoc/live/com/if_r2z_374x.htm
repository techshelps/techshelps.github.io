<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IROTData::GetComparisonData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_irotdata_getcomparisondata"></a>IROTData::GetComparisonData</h2>
<p>
Retrieves data from a moniker that can be used to test the moniker for equality against another moniker.</p>
<pre><code><b>HRESULT GetComparisonData(
  byte</b><i> *pbData</i><b>,  </b>//Pointer to a buffer that receives the comparison 
                 //data
<b>  ULONG</b><i> cbMax</i><b>,   </b>//Length of buffer
<b>  ULONG</b><i> *pcbData </i>//Pointer to the length of the comparison data
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pbData</i></dt>
<dd>
[out] Pointer to a buffer that receives the comparison data.</dd>
<dt>
<i>cbMax</i></dt>
<dd>
[in] Length of the buffer specified in <i>ppvData</i>. </dd>
<dt>
<i>pcbData</i></dt>
<dd>
[out] Pointer to the length of the comparison data.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return value E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
The comparison data was successfully returned.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IROTData::GetComparisonData</b> method is primarily called by the Running Object Table (ROT). The comparison data returned by the method is tested for binary equality against the comparison data returned by another moniker. The <i>pcbData</i> parameter enables the ROT to locate the end of the data returned. </p>
<h5>Notes to Implementers</h5>
<p>
The comparison data that you return must uniquely identify the moniker, while still being as short as possible. The comparison data should include information about the internal state of the moniker, as well as the moniker's CLSID. For example, the comparison data for a file moniker would include the path name stored within the moniker, as well as the CLSID of the file moniker implementation. This makes it possible to distinguish two monikers that happen to store similar state information but are instances of different moniker classes. </p>
<p>
The comparison data for a moniker cannot exceed 2048 bytes in length. For composite monikers, the total length of the comparison data for all of its components cannot exceed 2048 bytes; consequently, if your moniker can be a component within a composite moniker, the comparison data you return must be significantly less than 2048 bytes. </p>
<p>
If your comparison data is longer than the value specified by the <i>cbMax</i> parameter, you must return an error. Note that when <b>IROTData::GetComparisionData</b> is called on the components of a composite moniker, the value of <i>cbMax</i> becomes smaller for each moniker in sequence. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_8otu.htm"><b>IMoniker</b></a>, <a href="if_r2z_8go5.htm"><b>IRunningObjectTable</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
