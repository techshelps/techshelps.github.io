<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DROPEFFECT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_dropeffect"></a>DROPEFFECT</h1>
<p>
The <a href="api2_5now.htm"><b>DoDragDrop</b></a> function and many of the methods in the <a href="if_a2e_12jp.htm"><b>IDropSource</b></a> and <a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a> interfaces pass information about the effects of a drag-and-drop operation in a <b>DROPEFFECT</b> enumeration.</p>
<p>
Valid drop-effect values are the result of applying the OR operation to the values contained in the <b>DROPEFFECT</b> enumeration:</p>
<pre><code>typedef enum tagDROPEFFECT 
{ 
    DROPEFFECT_NONE   = 0, 
    DROPEFFECT_COPY   = 1, 
    DROPEFFECT_MOVE   = 2, 
    DROPEFFECT_LINK   = 4, 
    DROPEFFECT_SCROLL = 0x80000000 
}DROPEFFECT; 
 </code></pre>
<p>
These values have the following meaning:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>DROPEFFECT name</th>
<th align=left width=19%>Value</th>
<th align=left width=48%>Description</th>
</tr>
<tr valign=top>
<td width=33%>DROPEFFECT_NONE</td>
<td width=19%>0</td>
<td width=48%>Drop target cannot accept the data.</td>
</tr>
<tr valign=top>
<td width=33%>DROPEFFECT_COPY</td>
<td width=19%>1</td>
<td width=48%>Drop results in a copy. The original data is untouched by the drag source.</td>
</tr>
<tr valign=top>
<td width=33%>DROPEFFECT_MOVE</td>
<td width=19%>2</td>
<td width=48%>Drag source should remove the data.</td>
</tr>
<tr valign=top>
<td width=33%>DROPEFFECT_LINK</td>
<td width=19%>4</td>
<td width=48%>Drag source should create a link to the original data.</td>
</tr>
<tr valign=top>
<td width=33%>DROPEFFECT_SCROLL</td>
<td width=19%>0x80000000</td>
<td width=48%>Scrolling is about to start or is currently occurring in the target. This value is used in addition to the other values.</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;Your application should always mask values from the <b>DROPEFFECT</b> enumeration to ensure compatibility with future implementations. Presently, only four of the 32-bit positions in a <b>DROPEFFECT</b> have meaning. In the future, more interpretations for the bits will be added. Drag sources and drop targets should carefully mask these values appropriately before comparing. They should never compare a <b>DROPEFFECT</b> against, say, DROPEFFECT_COPY by:</p>
<pre><code>if (dwDropEffect == DROPEFFECT_COPY)... 
 </code></pre>
<p>
Instead, the application should always mask for the value or values being sought:</p>
<pre><code>if (dwDropEffect &amp; DROPEFFECT_COPY) == DROPEFFECT_COPY)... 
 </code></pre>
<p>
or</p>
<pre><code>if (dwDropEffect &amp; DROPEFFECT_COPY)... 
 </code></pre>
<p>
This allows for the definition of new drop effects, while preserving backwards compatibility with existing code.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 3.1 and later. <br>
&nbsp;&nbsp;<b>Windows:</b> Use Windows 95 and later. <br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="api2_5now.htm"><b>DoDragDrop</b></a>, <a href="if_a2e_12jp.htm"><b>IDropSource</b></a>, <a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
