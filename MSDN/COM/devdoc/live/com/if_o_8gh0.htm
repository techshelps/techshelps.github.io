<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleUndoUnit::OnNextAdd</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleundounit_onnextadd"></a>IOleUndoUnit::OnNextAdd</h2>
<p>
Notifies the last undo unit in the collection that a new unit has been added.</p>
<pre><b><code>HRESULT OnNextAdd(void);
 </code></b></pre>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Implementations of this method always return S_OK. The HRESULT return type is provided only for remotability.
</dd>
</dl>
<h4>Remarks</h4>
<p>
An object can create an undo unit for an action and add it to the undo manager but can continue inserting data into it through private interfaces. When the undo unit receives a call to this method, it communicates back to the creating object that the context has changed. Then, the creating object stops inserting data into the undo unit.</p>
<p>
The parent undo unit calls this method on its most recently added child undo unit to notify the child unit that the context has changed and a new undo unit has been added.</p>
<p>
For example, this method is used for supporting fuzzy actions, like typing, which do not have a clear point of termination but instead are terminated only when something else happens.</p>
<p>
This method may not always be called if the undo manager or an open parent unit chooses to discard the unit by calling <b>Release</b> instead. Any connection which feeds data to the undo unit behind the scenes through private interfaces should not <b>AddRef</b> the undo unit.</p>
<h5>Note to Implementers</h5>
<p>
Note that parent units merely delegate this method to their most recently added child unit. A parent unit should terminate communication through any private interfaces when it is closed. A parent unit knows it is being closed when it receives S_FALSE from calling <b>IOleParentUndoUnit::Close</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_5msl.htm"><b>IOleParentUndoUnit::Close</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
