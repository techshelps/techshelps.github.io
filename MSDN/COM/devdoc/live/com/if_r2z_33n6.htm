<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRunningObjectTable::Register</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_irunningobjecttable_register"></a>IRunningObjectTable::Register</h2>
<p>
Registers an object and its identifying moniker in the Running Object Table (ROT). </p>
<pre><code><b>HRESULT Register(
  DWORD</b><i> grfFlags</i><b>,           </b>//Registration options
<b>  IUnknown</b><i> *punkObject</i><b>,     </b>//Pointer to the object being registered
<b>  IMoniker</b><i> *pmkObjectName</i><b>,  </b>//Pointer to the moniker of the object 
                            // being registered
<b>  DWORD</b><i> *pdwRegister        </i>//Pointer to the value identifying the 
                            // registration
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>grfFlags</i></dt>
<dd>
[in] Specifies whether the ROT's reference to <i>punkObject</i> is weak or strong and controls access to the object through its entry in the ROT. For details, see the Remarks section below.  </dd>
<dt>
<i>punkObject</i></dt>
<dd>
[in] Pointer to the object that is being registered as running.</dd>
<dt>
<i>pmkObjectName</i></dt>
<dd>
[in] Pointer to the moniker that identifies <i>punkObject</i>.</dd>
<dt>
<i>pdwRegister</i></dt>
<dd>
[out] Pointer to a 32-bit value that can be used to identify this ROT entry in subsequent calls to <a href="if_r2z_5ew5.htm"><b>IRunningObjectTable::Revoke</b></a> or <a href="if_r2z_0xph.htm"><b>IRunningObjectTable::NoteChangeTime</b></a>. The caller cannot specify NULL for this parameter. If an error occurs, <i>*pdwRegister</i> is set to zero.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG and E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
The object was successfully registered.</dd>
<dt>
MK_S_MONIKERALREADYREGISTERED</dt>
<dd>
The moniker/object pair was successfully registered, but that another object (possibly the same object) has already been registered with the same moniker.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method registers a pointer to an object under a moniker that identifies the object. The moniker is used as the key when the table is searched with <a href="if_r2z_1c1g.htm"><b>IRunningObjectTable::GetObject</b></a>. </p>
<p>
The <i>grfFlags </i>parameter accepts two flag settings:
<ul>
<li>
ROTFLAGS_REGISTRATIONKEEPSALIVE. When set, indicates a strong registration for the object. </li>
<li>
ROTFLAGS_ALLOWANYCLIENT. When set, any client can connect to the running object through its entry in the ROT. When not set, only clients in the window station that registered the object can connect to it. </li>
</ul>
<p>
When an object is registered, the ROT always calls <a href="if_r2z_3rja.htm"><b>AddRef</b></a> on the object. For a weak registration (ROTFLAGS_REGISTRATIONKEEPSALIVE not set), the ROT will release the object whenever the last strong reference to the object is released. For a strong registration (ROTFLAGS_REGISTRATIONKEEPSALIVE set), the ROT prevents the object from being destroyed until the object's registration is explicitly revoked. </p>
<p>
A server registered as either <a href="reg_2tgl.htm"><b>LocalService</b></a> or <a href="reg_7nar.htm"><b>RunAs</b></a> can set the ROTFLAGS_ALLOWANYCLIENT flag in its call to <b>Register</b> to allow any client to connect to it. A server setting this bit must have its executable name in the <a href="reg_33y1.htm"><b>AppID</b></a> section of the registry that refers to the AppID for the executable. An "activate as activator" server (not registered as <b>LocalService</b> or <b>RunAs</b>) must not set this flag in its call to <b>Register</b>. For details on installing services, see <a href="comext_47ec.htm">Installing as a Win32 Service or User Account</a>.</p>
<p>
Registering a second object with the same moniker, or re-registering the same object with the same moniker, creates a second entry in the ROT. In this case, <b>Register</b> returns MK_S_MONIKERALREADYREGISTERED. Each call to <b>Register</b> must be matched by a call to <a href="if_r2z_5ew5.htm"><b>IRunningObjectTable::Revoke</b></a> because even duplicate entries have different <i>pdwRegister</i> identifiers. A problem with duplicate registrations is that there is no way to determine which object will be returned if the moniker is specified in a subsequent call to <a href="if_r2z_64br.htm"><b>IRunningObjectTable::IsRunning</b></a>. </p>
<h5>Notes to Callers</h5>
<p>
If you're a moniker provider (that is, you hand out monikers identifying your objects to make them accessible to others), you must call the <b>Register</b> method to register your objects when they begin running. You must also call this method if you rename your objects while they are loaded. </p>
<p>
The most common type of moniker provider is a compound-document link source. This includes server applications that support linking to their documents (or portions of a document) and container applications that support linking to embeddings within their documents. Server applications that do not support linking can also use the ROT to cooperate with container applications that support linking to embeddings.</p>
<p>
If you're writing a server application, you should register an object with the ROT when it begins running, typically in your implementation of <b>IOleObject::DoVerb</b>. The object must be registered under its full moniker, which requires getting the moniker of its container document using <b>IOleClientSite::GetMoniker</b>. You should also revoke and re-register the object in your implementation of <b>IOleObject::SetMoniker</b>, which is called if the container document is renamed. </p>
<p>
If you're writing a container application that supports linking to embeddings, you should register your document with the ROT when it is loaded. If your document is renamed, you should revoke and re-register it with the ROT and call <b>IOleObject::SetMoniker</b> for any embedded objects in the document to give them an opportunity to re-register themselves. </p>
<p>
Objects registered in the ROT must be explicitly revoked when the object is no longer running or when its moniker changes. This revocation is important because there is no way for the system to automatically remove entries from the ROT. You must cache the identifier that is written through <i>pdwRegister</i> and use it in a call to <a href="if_r2z_5ew5.htm"><b>IRunningObjectTable::Revoke</b></a> to revoke the registration. For a strong registration, a strong reference is released when the object's registration is revoked. </p>
<p>
The system's implementation of <b>IRunningObjectTable::Register</b> calls <a href="if_f2n_79d1.htm"><b>IMoniker::Reduce</b></a> on the <i>pmkObjectName</i> parameter to ensure that the moniker is fully reduced before registration. If an object is known by more than one fully reduced moniker, it should be registered under all such monikers.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_79d1.htm"><b>IMoniker::Reduce</b></a>, <a href="if_o_8o1e.htm"><b>IOleClientSite::GetMoniker</b></a>, <a href="if_o_0vjm.htm"><b>IOleObject::SetMoniker</b></a>, <a href="if_r2z_64br.htm"><b>IRunningObjectTable::IsRunning</b></a>, <a href="if_r2z_5ew5.htm"><b>IRunningObjectTable::Revoke</b></a> </p>
<p>
<a href="comext_47ec.htm">Installing as a Win32 Service or User Account</a></p>
<p>&nbsp;</p></body>
</HTML>
