<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPicture::get_CurDC</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipicture_get_curdc"></a>IPicture::get_CurDC</h2>
<p>
Returns the handle of the current device context. This property is valid only for bitmap pictures.</p>
<pre><code><b>HRESULT get_CurDC(
  HDC*</b><i> phdcOut  </i>//Receives a pointer to device context
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>phdcOut</i></dt>
<dd>
[out] Pointer to the caller's variable to receive the device context.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return value E_FAIL, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The device context was returned successfully.</dd>
<dt>
E_POINTER</dt>
<dd>
The address in <i>phdcOut</i> is not valid. For example, it may be NULL.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <i>CurDC</i> property and the <a href="if_p2q_5s9x.htm"><b>IPicture::SelectPicture</b></a> method exist to circumvent restrictions in Windows; specifically, that an object can only be selected into exactly one device context at a time. In some cases, a picture object may be permanently selected into a particular device context (for example, a control may use a certain picture for a background). To use this picture property elsewhere, it must be temporarily deselected from its old device context, selected into the new device context for the operation, then reselected back into the old device context. The <b>IPicture::get_CurDC</b> method returns the device context handle into which the picture is currently selected. The <b>IPicture::SelectPicture</b> method selects the picture into a new device context, returning the old device context and the picture's GDI handle. The caller should select the picture back into the old device context when the caller is done with it, as is normal for Windows code.</p>
<h5>Notes to Callers</h5>
<p>
The caller always owns any device contexts passed between it and the picture object. Since the picture object maintains a copy of the HDC, the caller should use a memory device context (created with the Win32 function <b>CreateCompatibleDC</b>) and not a screen device context (from <b>GetDC</b>, <b>CreateDC</b>, or <b>BeginPaint</b>), because the screen device contexts are a limited system resource.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_p2q_5s9x.htm"><b>IPicture::SelectPicture</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
