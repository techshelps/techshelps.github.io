<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Type Indicators</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_type_indicators"></a>Type Indicators</h2>
<p>
After the table of Property Identifiers/Offset Pairs comes the actual properties. Each property is stored as a DWORD type, followed by the data value.</p>
<p>
Type indicators and their associated values are described in the PROPVARIANT structure reference page.</p>
<p>
All Type/Value pairs must begin on a 32-bit boundary. Thus, values may be followed with null bytes to align the subsequent pair on a 32-bit boundary. Given a count of bytes, the following code will calculate how many bytes are needed to align on a 32-bit boundary:</p>
<pre><code>cbAdd = (((cbCurrent + 3) &gt;&gt; 2) &lt;&lt; 2) - cbCurrent ; 
 </code></pre>
<p>
Within a vector of values, each repetition of a simple scalar value smaller than 32 bits must align with its natural alignment rather than with a 32-bit alignment. In practice, this is only significant for types VT_UI1, VTUI2, VT_I2, and VT_BOOL (which have one- or two-byte natural alignment). All other types have four-byte natural alignment. Some types (VT_R8, etc.) actually have 8-byte natural alignment, but are stored as if they have 4-byte alignment. Therefore, a property value with type indicator VT_I2 | VT_VECTOR would be:
<ul>
<li>
A DWORD element count, followed by</li>
<li>
A sequence of packed two-byte integers with no padding between them.</li>
</ul>
<p>
Note that any 32-bit counts or property types that are stored as a part of a vector property element must also be 32-bit aligned.</p>
<p>
A property value of type identifier VT_LPSTR | VT_VECTOR would be:
<ul>
<li>
A DWORD element count (<b>DWORD</b> <i>cElems</i>), followed by</li>
<li>
A sequence of strings (<b>char</b> <i>rgch</i>[]), each of which is preceded by a length count DWORD and may be followed by null padding to round to a 32-bit boundary.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
