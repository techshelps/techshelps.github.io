<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Controls Registry Information</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_activex_controls_registry_information"></a>ActiveX Controls Registry Information</h2>
<p>
For 32-bit controls, there are a number of registry entries and flags that are used. Additionally, controls can support component categories to classify the features they provide.</p>
<p>
Registry keys related to controls are italicized in the following list:</p>
<pre><code>HKEY_CLASSES_ROOT 
    CLSID 
      {class id of control} 
          ProgID = identifier 
          InprocServer32 = &lt;filename&gt;.DLL 
          <i>DefaultIcon</i> = &lt;filename&gt;.&lt;ext&gt;,resourceID
          <i>ToolboxBitmap32</i> = &lt;filename&gt;.&lt;ext&gt;,resourceID 
          <i>Control</i> 
          verb 
              <i>n = &amp;Properties...</i> 
          <i>MiscStatus = 0</i> 
          TypeLib = {typelib ID for the object} 
          <i>Version = version number</i> 
 </code></pre>
<p>
The <b>DefaultIcon</b> entry is used to identify an icon to be displayed when the control is minimized to an icon. The Windows API function <b>ExtractIcon</b> is used to get the icon from the .DLL or .EXE file specified.</p>
<p>
The <b>ToolboxBitmap32</b> entry identifies the module name and resource identifier for a 16*15 bitmap to use for the face of a toolbar or toolbox button. The standard Windows icon size is too large to be used for this purpose. This entry specifically supports control containers that have a design mode in which one selects controls and places them on a form being designed. For example, in Visual Basic, the control's icon is displayed in the Visual Basic toolbox during design mode.</p>
<p>
The <b>Control</b> entry marks an object as a control. This entry is often used by containers to fill in dialog boxes. The container uses this sub-key to determine whether to include an object in a dialog box that displays controls.</p>
<p>
The <b>Insertable</b> sub-key can also be used with controls, depending on whether the object can act only as an in-place embedded object with no special control features. Objects marked with <b>Insertable</b> appear in the Insert Object dialog box of their container. The <b>Insertable</b> entry generally means that the control has been tested with non-control containers.</p>
<p>
Both the <b>Insertable</b> and the <b>Control</b> sub-keys are optional. A control can omit the <b>Insertable</b> sub-key if it not designed to work with older containers that do not understand controls. A control can omit the <b>Control</b> key if it is only designed to work with a specific container and thus does not wish to be inserted in other containers.</p>
<p>
Controls should have a <b>Properties</b> verb, OLEIVERB_PROPERTIES, along with any other verbs they support. The <b>Properties</b> verb, as well as the standard verb OLEIVERB_PRIMARY, instructs the control to display its property sheet. The Properties verb is displayed as the Properties item on the container's menu when the control is active. This way, the control can display its own property page allowing some useful functionality to the end user, even if the container does not handle controls.</p>
<p>
A control defines the <b>MiscStatus</b> key to describe itself to potential containers. The bits take on the values from <b>OLEMISC</b>, and controls add several values to this enumeration. See the <a href="enums_6gtf.htm"><b>OLEMISC</b></a> enumeration values for more information. The client can obtain this information by calling <b>IOleObject::GetMiscStatus</b> without having to instantiate the control first.</p>
<p>
Finally, <b>Version</b> describes the version of the control which should match the version of the type library associated with this control.</p>
<p>
Also in the type information for a control, the attribute <b>control</b> marks a <b>coclass </b>entry as describing a control.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
