<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RunAs</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_runas"></a>RunAs</h2>
<p>
Configures a class to run under a specific user account when activated by a remote client without being written as a Win32 service. To do this, the RunAs named-value is set for the class to a user-name and optionally a password. These are then used when the Service Control Manager launches its local server process.</p>
<h4>Registry Entry</h4>
<p>
<b>HKEY_LOCAL_MACHINE\SOFTWARE\Classes</b>\<b>APPID\<br>
</b>                                    <b>{</b><i>AppID_value</i><b>}\RunAs = </b><i>value</i></p>
<h4>Remarks</h4>
<p>
The <i>value</i> specifies the user name, and must either of the form <i>username</i>, <i>domain</i><b>\</b><i>username</i>, or the string <b>Interactive User</b>.</p>
<p>
Classes configured to <b>RunAs</b> a particular user may not be registered under any other identity, so calls to <a href="api1_6kz8.htm"><b>CoRegisterClassObject</b></a> with this CLSID will fail unless the process was launched by COM on behalf of an actual activation request.</p>
<p>
The user-name is taken from the <b>RunAs</b> named-value under the class's <b>AppID</b> key. If the user-name is "Interactive User", the server is run in the identity of the user currently logged on and is connected to the interactive desktop.</p>
<p>
Otherwise, the password is retrieved from a secret and safe portion of the registry available only to administrators of the machine and to the system. The user-name and password are then used to create a logon-session  in which the server is run. When launched in this way, the user  runs with its own <i>desktop</i> and <i>window-station</i>, and does not share window-handles, the clipboard, or other UI elements with the interactive user or other user running in other user accounts.</p>
<p>
To establish a password for a <b>RunAs</b> class, you must use the DCOMCNFG administrative tool installed in the system directory.</p>
<p>
For <b>RunAs</b> identities used by DCOM servers, the user account specified in the value must have the rights to log on as a batch job. This right can be added using the NT User Manager, under Policies-User Rights. Click on the <i>Show Advanced User Rights</i> box, select <i>log on as a batch job</i>, and add the <b>RunAs</b> user account. </p>
<p>
The <b>RunAs</b> value is not used for servers configured to be run as services.  COM services that wish to run under an identity other than <b>LocalSystem</b> should set the appropriate user name and password using the services control panel applet.</p>
<h4>See Also</h4>
<p>
<a href="comext_05pv.htm"><b>Registering COM Servers</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
