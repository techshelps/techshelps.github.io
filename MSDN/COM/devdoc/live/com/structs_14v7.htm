<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FORMATETC</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_formatetc"></a>FORMATETC</h1>
<p>
The <b>FORMATETC</b> structure is a generalized Clipboard format. It is enhanced to encompass a target device, the aspect or view of the data, and a storage medium indicator. Where one might expect to find a Clipboard format, OLE uses a <b>FORMATETC</b> data structure instead. This structure is used as a parameter in OLE functions and methods that require data format information.</p>
<pre><code>typedef struct tagFORMATETC 
{ 
    CLIPFORMAT      cfFormat; 
    DVTARGETDEVICE  *ptd; 
    DWORD           dwAspect; 
    LONG            lindex; 
    DWORD           tymed; 
}FORMATETC, *LPFORMATETC;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cfFormat</b></dt>
<dd>
Particular clipboard format of interest. There are three types of formats recognized by OLE:
<ul>
<li>
Standard interchange formats, such as CF_TEXT.</li>
<li>
Private application formats understood only by the application offering the format, or by other applications offering similar features.</li>
<li>
OLE formats, which are used to create linked or embedded objects.</li>
</ul>
</dd>
<dt>
<b>ptd</b></dt>
<dd>
Pointer to a <a href="structs_0en9.htm"><b>DVTARGETDEVICE</b></a> structure containing information about the target device for which the data is being composed. A NULL value is used whenever the specified data format is independent of the target device or when the caller doesn't care what device is used. In the latter case, if the data requires a target device, the object should pick an appropriate default device (often the display for visual components). Data obtained from an object with a NULL target device, such as most metafiles, is independent of the target device. The resulting data is usually the same as it would be if the user chose the Save As command from the File menu and selected an interchange format.</dd>
<dt>
<b>dwAspect</b></dt>
<dd>
One of the <a href="enums_08j8.htm"><b>DVASPECT</b></a> enumeration constants that indicate how much detail should be contained in the rendering. A single clipboard format can support multiple aspects or views of the object. Most data and presentation transfer and caching methods pass aspect information. For example, a caller might request an object's iconic picture, using the metafile clipboard format to retrieve it. Note that only one <b>DVASPECT</b> value can be used in <b>dwAspect</b>. That is, <b>dwAspect</b> cannot be the result of a BOOLEAN OR operation on several <b>DVASPECT</b> values.</dd>
<dt>
<b>lindex</b></dt>
<dd>
Part of the aspect when the data must be split across page boundaries. The most common value is -1, which identifies all of the data. For the aspects DVASPECT_THUMBNAIL and DVASPECT_ICON, <b>lindex</b> is ignored.</dd>
<dt>
<b>tymed</b></dt>
<dd>
One of the <a href="enums_986c.htm"><b>TYMED</b></a> enumeration constants which indicate the type of storage medium used to transfer the object's data. Data can be transferred using whatever medium makes sense for the object. For example, data can be passed using global memory, a disk file, or structured storage objects. For more information, see the <b>TYMED</b> enumeration.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>FORMATETC</b> structure is used by methods in the data transfer and presentation interfaces as a parameter specifying the data being transferred. For example, the <a href="if_a2e_1jz5.htm"><b>IDataObject::GetData</b></a> method uses the <b>FORMATETC</b> structure to indicate exactly what kind of data the caller is requesting. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="enums_08j8.htm"><b>DVASPECT</b></a>, <a href="if_a2e_125u.htm"><b>IDataAdviseHolder</b></a>, <a href="if_a2e_24z8.htm"><b>IDataObject</b></a>, <a href="if_a2e_7kyr.htm"><b>IEnumFORMATETC</b></a>, <a href="if_o_5tgl.htm"><b>IOleCache</b></a>, <a href="api3_6y5h.htm"><b>OleCreate</b></a>, <a href="api3_1h0h.htm"><b>OleCreateFromData</b></a>, <a href="api3_0dsx.htm"><b>OleCreateLinkFromData</b></a>, <a href="api3_9skh.htm"><b>OleCreateStaticFromData</b></a>, <a href="api3_0n3f.htm"><b>OleCreateLink</b></a>, <a href="api3_5v51.htm"><b>OleCreateLinkToFile</b></a>, <a href="api3_3eg5.htm"><b>OleCreateFromFile</b></a>, <a href="structs_14dd.htm"><b>STATDATA</b></a>, <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a>, <a href="enums_986c.htm"><b>TYMED</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
