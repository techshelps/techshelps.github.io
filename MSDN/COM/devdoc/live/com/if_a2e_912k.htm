<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAccessControl</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_iaccesscontrol"></a>IAccessControl</h1>
<p>
The <a href="#_com_iaccesscontrol"><b>IAccessControl</b></a> interface enables the management of access to objects and properties on the objects. </p>
<p>
For Windows NT storage and Directory Service objects, the <a href="#_com_iaccesscontrol"><b>IAccessControl</b></a> interface makes use of the access providers as used by the Win32 Access Control APIs (ACCESS5). Other implementations will be responsible for converting from the given access information format into the required format.</p>
<h5>When to Implement</h5>
<p>
Distributed COM provides an implementation of the <a href="#_com_iaccesscontrol"><b>IAccessControl</b></a> interface. To get a pointer to this implementation, call <a href="api1_1nad.htm"><b>CoCreateInstance</b></a>, specifying <b>CLSID_DCOMAccessControl</b> as the CLSID.</p>
<p>
This implementation supports the <a href="if_p2q_3lbo.htm"><b>IPersist</b></a> interface to save the state of your access control object.</p>
<p>
<b>NOTE</b>&nbsp;&nbsp;</p>
<p>
If you decide to implement <b>IAccessControl</b> and pass your implementation to <a href="api1_8ayh.htm"><b>CoInitializeSecurity</b></a>, you must ensure that it is completely thread-safe, because COM can call it on any thread, at any time.</p>
<p>
<b>When to Use</b>&nbsp;&nbsp;Call methods of the <a href="#_com_iaccesscontrol"><b>IAccessControl</b></a> interface to manage access to objects and properties on the objects, and to get access information. Its primary use is when you set process-wide security with a call to <a href="api1_8ayh.htm"><b>CoInitializeSecurity</b></a>, specifying EOAC_ACCESS_CONTROL as the capability flag, and providing a pointer to an instance of <b>IAccessControl</b> as the first (<i>pVoid</i>) parameter. COM then calls its methods to determine access rights.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>IUnknown Methods</th>
<th align=left width=59%>Description</th>
</tr>
<tr valign=top>
<td width=41%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=59%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=59%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=59%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>IAccessControl Methods</th>
<th align=left width=59%>Description</th>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_7rw3.htm"><b>GrantAccessRights</b></a></td>
<td width=59%>Merges the new ACTRL_ACCESS list with the existing access rights on the object</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_4a2b.htm"><b>SetAccessRights</b></a></td>
<td width=59%>Replaces existing access rights with the specified list</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_7q5u.htm"><b>SetOwner</b></a></td>
<td width=59%>Sets an item's owner or group</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_43n7.htm"><b>RevokeAccessRights</b></a></td>
<td width=59%>Removes explicit entries for the list of trustees</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_3ypf.htm"><b>GetAllAccessRights</b></a></td>
<td width=59%>Gets the entire list of access rights and/or the owner and group for the object</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_3c84.htm"><b>IsAccessAllowed</b></a></td>
<td width=59%>Determines if the trustee has access to the object/property</td>
</tr>
</table><br>
<p>
</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Available as a Windows 95 redistributable.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleext.h.</p>
<h4>See Also</h4>
<p>
<a href="api1_8ayh.htm"><b>CoInitializeSecurity</b></a>, <a href="comext_2v3t.htm"><b>Setting Process-wide Security with CoInitializeSecurity</b></a></p>
<p>&nbsp;</p></body>
</HTML>
