<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleInPlaceObjectWindowless::OnWindowMessage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleinplaceobjectwindowless_onwindowmessage"></a>IOleInPlaceObjectWindowless::OnWindowMessage</h2>
<p>
Dispatches a message from a container to a windowless object that is in-place active.</p>
<pre><code><b>HRESULT OnWindowMessage(
  UINT</b><i> msg</i><b>,</b>           //Message Identifier as provided by Windows
<b>  WPARAM</b><i> wParam</i><b>,</b>      //Message parameter as provided by Windows
<b>  LPARAM</b><i> lParam</i><b>,</b>      //Message parameter as provided by Windows
<b>  LRESULT*</b><i> plResult</i>   //Pointer to message result code
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>msg</i></dt>
<dd>
[in] Identifier for the window message provided to the container by Windows.</dd>
<dt>
<i>wParam</i></dt>
<dd>
[in] Parameter for the window message provided to the container by Windows.</dd>
<dt>
<i>lParam</i></dt>
<dd>
[in] Parameter for the window message provided to the container by Windows.</dd>
<dt>
<i>plResult</i></dt>
<dd>
[out] Pointer to result code for the window message as defined in the Windows API.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The window message was successfully dispatched to the windowless object.</dd>
<dt>
S_FALSE</dt>
<dd>
The windowless object did not process the window message. The container should call the <b>DefWindowProc</b> for the message or process the message itself as described below.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A container calls this method to send window messages to a windowless object that is in-place active. The container should dispatch messages according to the following guidelines:
<ul>
<li>
For the following messages, the container should first dispatch the message to the windowless object that has captured the mouse, if any. Otherwise, the container should dispatch the message to the windowless object under the mouse cursor. If there is no such object, the container is free to process the message for itself.<table cellspacing=4 cols=2>
<tr valign=top>
<td width=51%>WM_MOUSEMOVE</td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=51%>WM_SETCURSOR</td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=51%>WM_<i>X</i>BUTTONDOWN</td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=51%>WM_<i>X</i>BUTTONUP</td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=51%>WM_<i>X</i>BUTTONDBLCLK</td>
<td width=49%></td>
</tr>
</table><br>
</li>
<li>
For the following messages, the container should dispatch the message to the windowless object with the keyboard focus.<table cellspacing=4 cols=2>
<tr valign=top>
<td width=51%>WM_KEYDOWN</td>
<td width=49%>WM_SYSKEYUP</td>
</tr>
<tr valign=top>
<td width=51%>WM_KEYUP</td>
<td width=49%>WM_SYSDEADCHAR</td>
</tr>
<tr valign=top>
<td width=51%>WM_CHAR</td>
<td width=49%>WM_IME<i>xxx</i></td>
</tr>
<tr valign=top>
<td width=51%>WM_DEADCHAR</td>
<td width=49%>WM_HELP</td>
</tr>
<tr valign=top>
<td width=51%>WM_SYSKEYDOWN</td>
<td width=49%>WM_CANCELMODE</td>
</tr>
</table><br>
</li>
<li>
For all other messages, the container should process the message on its own.</li>
</ul>
<p>
The windowless object can return S_FALSE to this method to indicate that it did not process the message. Then, the container either performs the default behavior for the message by calling the Windows API function <b>DefWindowProc</b>, or processes the message itself.</p>
<p>
The container must pass the following window messages to the default window procedure:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>WM_MOUSEMOVE</td>
<td width=50%>WM_DEADCHAR</td>
</tr>
<tr valign=top>
<td width=50%>WM_<i>X</i>BUTTON<i>xxx</i></td>
<td width=50%>WM_SYSKEYUP</td>
</tr>
<tr valign=top>
<td width=50%>WM_KEYDOWN</td>
<td width=50%>WM_SYSCHAR</td>
</tr>
<tr valign=top>
<td width=50%>WM_KEYUP</td>
<td width=50%>WM_SYSDEADCHAR</td>
</tr>
<tr valign=top>
<td width=50%>WM_CHAR</td>
<td width=50%>WM_IME<i>xxx</i></td>
</tr>
</table><br>
<p>
The container must process the following window messages as its own:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>WM_SETCURSOR</td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%>WM_CONTEXTMENU</td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%>WM_HELP</td>
<td width=50%></td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;For WM_SETCURSOR, the container can either set the cursor itself or do nothing.</p>
<p>
Objects can also use <b>IOleInPlaceSiteWindowless::OnDefWindowMessage</b> to explicitly invoke the default message processing from the container. In the case of the WM_SETCURSOR message, this allows an object to take action if the container does not set the cursor.</p>
<p>
All coordinates passed to the object in <i>wParam</i> and <i>lParam</i> are specified as client coordinates of the containing window.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_5l5x.htm"><b>IOleInPlaceSiteWindowless::SetCapture</b></a>, <a href="if_o_9wh1.htm"><b>IOleInPlaceSiteWindowless::OnDefWindowMessage</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
