<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IViewObject::Draw</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iviewobject_draw"></a>IViewObject::Draw</h2>
<p>
Draws a representation of an object onto the specified device context. </p>
<pre><code><b>HRESULT Draw(
  DWORD</b><i> dwAspect</i><b>,   </b>//Aspect to be drawn
<b>  LONG</b><i> lindex</i><b>,      </b>//Part of the object of interest in the draw 
                    //operation
<b>  void *</b><i> pvAspect</i><b>,  </b>//Pointer to DVASPECTINFO structure or NULL
<b>  DVTARGETDEVICE *</b><i> ptd</i><b>,</b>
<b>                    </b>//Pointer to target device in a structure
<b>  HDC</b><i> hicTargetDev</i><b>, </b>//Information context for the target device
<b>  HDC</b><i> hdcDraw</i><b>,      </b>//Device context on which to draw
<b>  const LPRECTL</b><i> lprcBounds</i><b>,</b>
<b>                    </b>//Pointer to the rectangle in which the object 
                    //is drawn
<b>  const LPRECTL</b><i> lprcWBounds</i><b>,</b>
<b>                    </b>//Pointer to the window extent and window origin 
                    //when drawing a metafile
<b>  BOOL (*) (DWORD)</b><i> pfnContinue</i><b>,</b>
<b>                    </b>//Pointer to the callback function for canceling 
                    //or continuing the drawing
<b>  DWORD</b><i> dwContinue  </i>//Value to pass to the callback function
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwAspect</i></dt>
<dd>
[in] Specifies the aspect to be drawn, that is, how the object is to be represented. Representations include content, an icon, a thumbnail, or a printed document. Valid values are taken from the enumerations <a href="enums_08j8.htm"><b>DVASPECT</b></a> and <a href="enums_567m.htm"><b>DVASPECT2</b></a>. Note that newer objects and containers that support optimized drawing interfaces support the <b>DVASPECT2</b> enumeration values. Older objects and containers that do not support optimized drawing interfaces may not support <b>DVASPECT2</b>. Windowless objects allow only DVASPECT_CONTENT, DVASPECT_OPAQUE, and DVASPECT_TRANSPARENT.</dd>
<dt>
<i>lindex</i></dt>
<dd>
[in] Portion of the object that is of interest for the draw operation. Its interpretation varies depending on the value in the <i>dwAspect</i> parameter. See the <b>DVASPECT</b> enumeration for more information.</dd>
<dt>
<i>pvAspect</i></dt>
<dd>
[in] Pointer to additional information in a <a href="structs_904v.htm"><b>DVASPECTINFO</b></a> structure that enables drawing optimizations depending on the aspect specified. Note that newer objects and containers that support optimized drawing interfaces support this parameter as well. Older objects and containers that do not support optimized drawing interfaces always specify NULL for this parameter.</dd>
<dt>
<i>ptd</i></dt>
<dd>
[in] Pointer to the <a href="structs_0en9.htm"><b>DVTARGETDEVICE</b></a> structure that describes the device for which the object is to be rendered. If NULL, the view should be rendered for the default target device (typically the display). A value other than NULL is interpreted in conjunction with <i>hicTargetDev</i> and <i>hdcDraw</i>. For example, if <i>hdcDraw</i> specifies a printer as the device context, the <i>ptd</i> parameter points to a structure describing that printer device. The data may actually be printed if <i>hicTargetDev</i> is a valid value or it may be displayed in print preview mode if <i>hicTargetDev</i> is NULL.</dd>
<dt>
<i>hicTargetDev</i></dt>
<dd>
[in] Information context for the target device indicated by the <i>ptd</i> parameter from which the object can extract device metrics and test the device's capabilities. If <i>ptd</i> is NULL; the object should ignore the value in the <i>hicTargetDev</i> parameter. </dd>
<dt>
<i>hdcDraw</i></dt>
<dd>
[in] Device context on which to draw. For a windowless object, the <i>hdcDraw</i> parameter should be in MM_TEXT mapping mode with its logical coordinates matching the client coordinates of the containing window. For a windowless object, the device context should be in the same state as the one normally passed by a WM_PAINT message.</dd>
<dt>
<i>lprcBounds</i></dt>
<dd>
[in] Pointer to a <b>RECTL </b>structure specifying the rectangle on <i>hdcDraw</i> and in which the object should be drawn. This parameter controls the positioning and stretching of the object. This parameter should be NULL to draw a windowless in-place active object. In every other situation, NULL is not a legal value and should result in an E_INVALIDARG error code. If the container passes a non-NULL value to a windowless object, the object should render the requested aspect into the specified device context and rectangle. A container can request this from a windowless object to render a second, non-active view of the object or to print the object.</dd>
<dt>
<i>lprcWBounds</i></dt>
<dd>
[in] If <i>hdcDraw</i> is a metafile device context, pointer to a <b>RECTL</b> structure specifying the bounding rectangle in the underlying metafile. The rectangle structure contains the window extent and window origin. These values are useful for drawing metafiles. The rectangle indicated by <i>lprcBounds</i> is nested inside this <i>lprcWBounds</i> rectangle; they are in the same coordinate space.
<p>
If <i>hdcDraw</i> is not a metafile device context; <i>lprcWBounds</i> will be NULL.
</dd>
<dt>
<i>pfnContinue</i></dt>
<dd>
[in] Pointer to a callback function that the view object should call periodically during a lengthy drawing operation to determine whether the operation should continue or be canceled. This function returns TRUE to continue drawing. It returns FALSE to stop the drawing in which case <b>IViewObject::Draw</b> returns DRAW_E_ABORT.</dd>
<dt>
<i>dwContinue</i></dt>
<dd>
[in] Value to pass as a parameter to the function pointed to by the <i>pfnContinue</i> parameter. Typically, <i>dwContinue</i> is a pointer to an application-defined structure needed inside the callback function. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG and E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
The object was drawn successfully.</dd>
<dt>
OLE_E_BLANK </dt>
<dd>
No data to draw from.</dd>
<dt>
DRAW_E_ABORT</dt>
<dd>
Draw operation aborted.</dd>
<dt>
VIEW_E_DRAW</dt>
<dd>
Error in drawing.</dd>
<dt>
DV_E_LINDEX</dt>
<dd>
Invalid value for <i>lindex</i>; currently only -1 is supported.</dd>
<dt>
DV_E_DVASPECT</dt>
<dd>
Invalid value for <i>dwAspect</i>. </dd>
<dt>
OLE_E_INVALIDRECT</dt>
<dd>
Invalid rectangle.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A container application issues a call to <b>IViewObject::Draw</b> to create a representation of a contained object. This method draws the specified piece (<i>lindex</i>) of the specified view (<i>dwAspect</i> and <i>pvAspect</i>) on the specified device context (<i>hdcDraw</i>). Formatting, fonts, and other rendering decisions are made on the basis of the target device specified by the <i>ptd</i> parameter.</p>
<p>
There is a relationship between the <i>dwDrawAspect</i> value and the <i>lprcbounds</i> value. The <i>lprcbounds</i> value specifies the rectangle on <i>hdcDraw</i> into which the drawing is to be mapped. For DVASPECT_THUMBNAIL, DVASPECT_ICON, and DVASPECT_SMALLICON, the object draws whatever it wants to draw, and it maps it into the space given in the best way. Some objects might scale to fit while some might scale to fit but preserve the aspect ratio. In addition, some might scale so the drawing appears at full width, but the bottom is cropped. The container can suggest a size via <b>IOleObject::SetExtent</b>, but it has no control over the rendering size. In the case of DVASPECT_CONTENT, the <b>Draw</b> implementation should either use the extents given by <b>IOleObject::SetExtent</b> or use the bounding rectangle given in the <i>lprcBounds</i> parameter.</p>
<p>
For newer objects that support optimized drawing techniques and for windowless objects, this method should be used as follows:
<ul>
<li>
New drawing aspects are supported in <i>dwAspect</i> as defined in <a href="enums_567m.htm"><b>DVASPECT2</b></a>.</li>
<li>
The <i>pvAspect</i> parameter can be used to pass additional information allowing drawing optimizations through the <a href="structs_904v.htm"><b>DVASPECTINFO</b></a> structure.</li>
<li>
The <b>Draw</b> method can be called to redraw a windowless in-place active object by setting the <i>lrpcBounds</i> parameter to NULL. In every other situation, NULL is an illegal value and should result in an E_INVALIDARG error code. A windowless object uses the rectangle passed by the activation verb or calls <b>IOleInPlaceSite::SetObjectRects</b> instead of using this parameter. If the container passes a non-NULL value to a windowless object, the object should render the requested aspect into the specified device context and rectangle. A container can request this from a windowless object to render a second, non-active view of the object or to print the object. See the <a href="if_o_1y2b.htm"><b>IOleInPlaceSiteWindowless</b></a> interface for more information on drawing windowless objects.</li>
<li>
For windowless objects, the <i>dwAspect</i> parameter only allows the DVASPECT_CONTENT, DVASPECT_OPAQUE, and DVASPECT_TRANSPARENT aspects.</li>
<li>
For a windowless object, the <i>hdcDraw</i> parameter should be in MM_TEXT mapping mode with its logical coordinates matching the client coordinates of the containing window. For a windowless object, the device context should be in the same state as the one normally passed by a WM_PAINT message.</li>
</ul>
<p>
To maintain compatibility with older objects and containers that do not support drawing optimizations, all objects, rectangular or not, are required to maintain an origin and a rectangular extent. This allows the container to still consider all its embedded objects as rectangles and to pass them appropriate rendering rectangles in <b>IViewObjectEx::Draw</b>.</p>
<p>
An object's extent depends on the drawing aspect. For non-rectangular objects, the extent should be the size of a rectangle covering the entire aspect. By convention, the origin of an object is the top-left corner of the rectangle of the DVASPECT_CONTENT aspect. In other words, the origin always coincides with the top-left corner of the rectangle maintained by the object's site, even for a non-rectangular object.</p>
<h5>Note to Callers</h5>
<p>
The value of <i>hicTargetDevice</i> is typically an information context for the target device. However, it may be a full device context instead.</p>
<h5>Note to Implementers</h5>
<p>
If you are writing an object handler (such as the default handler) that implements <b>IViewObject::Draw</b> by playing a metafile, you have to treat <b>SetPaletteEntries</b> metafile records in a special way because of Windows' behavior. The Windows function <b>PlayMetaFile</b> sets these palette entries to the foreground. You must override this default by setting them to the background palette. Use <b>EnumMetaFile</b> to do this. Enhanced metafiles are always recorded with the background palette so there is no need to do it manually.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="enums_08j8.htm"><b>DVASPECT</b></a>, <a href="enums_567m.htm"><b>DVASPECT2</b></a>, <a href="structs_904v.htm"><b>DVASPECTINFO</b></a>, <a href="if_o_1y2b.htm"><b>IOleInPlaceSiteWindowless</b></a>, <a href="api3_6nxz.htm"><b>OleDraw</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
