<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Managing Memory Allocation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_managing_memory_allocation"></a>Managing Memory Allocation</h1>
<p>
In COM, many, if not most, interface methods and APIs are called by code written by one programming organization and implemented by code written by another. Many of the parameters and return values of these functions are of types that can be passed around by value. Sometimes, however, it is necessary to pass data structures for which this is not the case, so it is necessary for both caller and called to have a compatible allocation and de-allocation policy. COM defines a universal convention for memory allocation, both because it is more reasonable than defining case-by-case rules, and so the COM remote procedure call implementation can correctly manage memory.</p>
<p>
The methods of COM interface always provide memory management of pointers to the interface by calling the <b>AddRef</b> and <b>Release</b> functions found in the <a href="if_r2z_9dwu.htm"><b>IUnknown</b></a><i> </i>interface, from which all other COM interfaces derive (refer to <a href="com_1vxv.htm">Rules for Managing Reference Counts</a> for more information). This section describes only how to allocate memory for parameters that are not passed by value — <i>not</i> pointers to interfaces, but more mundane things like strings, pointers to structures, etc.</p>
<p>
For more information, see the following:
<ul>
<li>
<a href="com_04aa.htm"><b>The OLE Memory Allocator</b></a> </li>
<li>
<a href="com_3rub.htm"><b>Memory Management Rules</b></a> </li>
<li>
<a href="com_9c37.htm"><b>Debugging Memory Allocations</b></a> </li>
</ul>
<p>&nbsp;</p></body>
</HTML>
