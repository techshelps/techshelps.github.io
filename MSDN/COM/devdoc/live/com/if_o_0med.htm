<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleCache::Cache</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iolecache_cache"></a>IOleCache::Cache</h2>
<p>
Specifies the format and other data to be cached inside an embedded object.</p>
<pre><code><b>HRESULT Cache(
  FORMATETC *</b><i> pFormatetc</i><b>,  </b>//Pointer to the format and data to be 
                           // cached
<b>  DWORD</b><i> advf</i><b>,            </b>//Flags that control the caching
<b>  DWORD *</b><i> pdwConnection  </i>//Pointer to the connection for future 
                         // calls to uncache
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pFormatetc</i></dt>
<dd>
[in] Pointer to the format and other data to be cached. View caching is specified by passing a zero clipboard format in <i>pFormatetc</i>.</dd>
<dt>
<i>advf</i></dt>
<dd>
[in] Contains a group of flags that control the caching. Valid values can be derived by using an OR operation on the values in the <a href="enums_923q.htm"><b>ADVF</b></a> enumeration. When used in this context, for a cache, these values have specific meanings, which are outlined in the Remarks. Refer to the <b>ADVF</b> enumeration for a more detailed description.</dd>
<dt>
<i>pdwConnection</i></dt>
<dd>
[out] Pointer to a returned DWORD token that identifies this connection and can later be used to turn caching off (by passing it to <a href="if_o_549x.htm"><b>IOleCache::Uncache</b></a>). If this value is zero, the connection was not established. The OLE-provided implementation uses nonzero numbers for connection identifiers.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
Requested data or view successfully cached. </dd>
<dt>
CACHE_S_FORMATETC_NOTSUPPORTED</dt>
<dd>
The cache was created, but the object application does not support the specified format. Cache creation succeeds even if the format is not supported, allowing the caller to fill the cache. If, however, the caller does not need to keep the cache, call <b>IOleCache::UnCache</b>.</dd>
<dt>
CACHE_S_SAMECACHE</dt>
<dd>
A cache already exists for the <a href="structs_14v7.htm"><b>FORMATETC</b></a> passed to <b>IOleCache::Uncache</b>.<b> </b>In this case, the new advise flags are assigned to the cache, and the previously assigned connection identifier is returned.</dd>
<dt>
DV_E_LINDEX</dt>
<dd>
Invalid value for <i>lindex</i>; currently only -1 is supported.</dd>
<dt>
DV_E_TYMED</dt>
<dd>
The value is not valid for <i>pFormatetc-&gt;tymed</i>. </dd>
<dt>
DV_E_DVASPECT</dt>
<dd>
The value is not valid for<i> pFormatetc-&gt;dwAspect</i>. </dd>
<dt>
DV_E_CLIPFORMAT</dt>
<dd>
The value is not valid for <i>pFormatetc-&gt;cfFormat</i>.</dd>
<dt>
CO_E_NOTINITIALIZED</dt>
<dd>
The cache's storage is not initialized.</dd>
<dt>
DV_E_DVTARGETDEVICE</dt>
<dd>
The value is not valid for <i>pFormatetc-&gt;ptd</i>.</dd>
<dt>
OLE_E_STATIC</dt>
<dd>
The cache is for a static object and it already has a cache node. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>IOleCache::Cache</b> can specify either data caching or view (presentation) caching. To specify data caching, a valid data format must be passed in <i>pFormatetc</i>. For view caching, the cache object itself decides on the format to cache, so a caller would pass a zero data format in <i>pFormatetc</i> as follows: </p>
<pre><code>pFormatetc-&gt;cfFormat == 0 
 </code></pre>
<p>
A custom object handler can choose not to store data in a given format. Instead, it can synthesize it on demand when requested.</p>
<p>
The <i>advf</i> value specifies a member of the <a href="enums_923q.htm">ADVF</a> enumeration. When one of these values (or an OR'd combination of more than one value) is used in this context, these values mean the following:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>ADVF Value</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>ADVF_NODATA</td>
<td width=52%>The cache is not to be updated by changes made to the running object. Instead, the container will update the cache by explicitly calling <b>IOleCache::SetData</b>, <a href="if_a2e_438h.htm"><b>IDataObject::SetData</b></a>, or <b>IOleCache2::UpdateCache</b>. This flag is usually used when the iconic aspect of an object is being cached.</td>
</tr>
<tr valign=top>
<td width=48%>ADVF_ONLYONCE</td>
<td width=52%>Update the cache one time only. After the update is complete, the advisory connection between the object and the cache is disconnected. The source object for the advisory connection calls the <b>IAdviseSink::Release</b> method. </td>
</tr>
<tr valign=top>
<td width=48%>ADVF_PRIMEFIRST</td>
<td width=52%>The object is not to wait for the data or view to change before updating the cache. OR'd with ADVF_ONLYONCE, this parameter provides an asynchronous <b>GetData</b> call.</td>
</tr>
<tr valign=top>
<td width=48%>ADVFCACHE_NOHANDLER</td>
<td width=52%>Synonym for ADVFCACHE_FORCEBUILTIN.</td>
</tr>
<tr valign=top>
<td width=48%>ADVFCACHE_FORCEBUILTIN</td>
<td width=52%>Used by DLL object applications and object handlers that draw their objects to cache presentation data to ensure that there is a presentation in the cache. This ensures that the data can be retrieved even when the object or handler code is not available.</td>
</tr>
<tr valign=top>
<td width=48%>ADVFCACHE_ONSAVE</td>
<td width=52%>Updates the cached representation only when the object containing the cache is saved. The cache is also updated when the OLE object changes from the running state back to the loaded state (because a subsequent save operation would require running the object again).</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="enums_923q.htm"><b>ADVF</b></a>,<b> <a href="if_o_549x.htm">IOleCache::Uncache</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
