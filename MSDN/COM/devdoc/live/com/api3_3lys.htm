<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleGetAutoConvert</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_olegetautoconvert"></a>OleGetAutoConvert</h1>
<p>
Determines whether the registry is set for objects of a specified CLSID to be automatically converted to another CLSID, and if so, retrieves the new CLSID.</p>
<pre><code><b>WINOLEAPI OleGetAutoConvert(
  REFCLSID</b><i> clsidOld</i><b>,</b>   //CLSID of the object to be converted
<b>  LPCLSID</b><i> pClsidNew    </i>//Pointer to new CLSID for object being 
                       // converted
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>clsidOld</i></dt>
<dd>
[in] CLSID for an object to determine whether that CLSID is set for automatic conversion.</dd>
<dt>
<i>pClsidNew</i></dt>
<dd>
[out] Pointer to where the new CLSID, if any, is written. If auto-conversion for <i>clsidOld</i> is not set in the registry, <i>clsidOld</i> is written to that location. The <i>pClsidNew</i> parameter is never NULL.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_INVALIDARG, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
IA value was successfully returned through the <i>pclsidNew</i> parameter.</dd>
<dt>
REGDB_E_CLASSNOTREG</dt>
<dd>
The <i>clsidOld</i> CLSID is not properly registered in the registry.</dd>
<dt>
REGDB_E_READREGDB</dt>
<dd>
Error reading the registry.</dd>
<dt>
REGDB_E_KEYMISSING</dt>
<dd>
Auto-convert is not active or there was no registry entry for the <i>clsidOld</i> parameter.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>OleGetAutoConvert</b> function returns the AutoConvertTo entry in the registry for the specified object. The AutoConvertTo subkey specifies whether objects of a given CLSID are to be automatically converted to a new CLSID. This is usually used to convert files created by older versions of an application to the current version. If there is no AutoConvertTo entry, this function returns the value of <i>clsidOld</i>. </p>
<p>
The <a href="api3_8ad0.htm"><b>OleDoAutoConvert</b></a> function calls <b>OleGetAutoConvert</b> to determine if the object specified is to be converted. A container application that supports object conversion should call <b>OleDoAutoConvert</b> each time it loads an object. If the container uses the <a href="api3_1cmc.htm"><b>OleLoad</b></a> helper function, it need not call <b>OleDoAutoConvert</b> explicitly because <b>OleLoad</b> calls it internally.</p>
<p>
To set up automatic conversion of a given class, you can call the <a href="api3_82k4.htm"><b>OleSetAutoConvert</b></a> function (typically in the setup program of an application installation). This function uses the AutoConvertTo subkey to tag a class of objects for automatic conversion to a different class of objects. This is a subkey of the CLSID key, and contains the following information:</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_82k4.htm"><b>OleSetAutoConvert</b></a>,<b> <a href="api3_8ad0.htm">OleDoAutoConvert</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
