<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPicture</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ipicture"></a>IPicture</h1>
<p>
The <b>IPicture</b> interface manages a picture object and its properties. Picture objects provide a language-neutral abstraction for bitmaps, icons, and metafiles. As with the standard font object, the system provides a standard implementation of the picture object. Its primary interfaces are <b>IPicture</b> and <a href="if_p2q_0als.htm"><b>IPictureDisp</b></a>, the latter being derived from <b>IDispatch</b> to provide access to the picture's properties through Automation. A picture object is created with <a href="api3_22wk.htm"><b>OleCreatePictureIndirect</b></a>. </p>
<p>
The picture object also supports the outgoing interface <a href="if_p2q_4gh7.htm"><b>IPropertyNotifySink</b></a><b>,</b> so a client can determine when picture properties change. Since the picture object supports at least one outgoing interface, it also implements <a href="if_a2e_5h2q.htm"><b>IConnectionPointContainer</b></a> and its associated interfaces for this purpose.</p>
<p>
The picture object also supports <a href="if_p2q_02b1.htm"><b>IPersistStream</b></a> so it can save and load itself from an instance of <a href="if_r2z_4x7x.htm"><b>IStream</b></a>. An object that uses a picture object internally would normally save and load the picture as part of the object's own persistence handling. The function <a href="api3_936t.htm"><b>OleLoadPicture</b></a> simplifies the creation of a picture object based on stream contents.</p>
<h5>When to Implement</h5>
<p>
Typically, you use the OLE-provided picture object, which provides the <b>IPicture</b> and <b>IPictureDisp</b> interfaces for you. The <b>IPicture</b> interface is the primary interface implemented by the OLE-provided picture object. It allows the caller to manage picture properties and to use that picture in graphical rendering. Each property in the <b>IPicture</b> interface includes a get_<i>PropertyName</i> method if the property supports read access and a put_<i>PropertyName</i> method if the property supports write access. Most of the properties support only read access with the exception of hPal.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=21%><br>
Property</th>
<th align=left width=31%><br>
Type</th>
<th align=left width=13%>Access Allowed</th>
<th align=left width=35%><br>
Description</th>
</tr>
<tr valign=top>
<td width=21%>HANDLE</td>
<td width=31%>OLE_HANDLE (int)</td>
<td width=13%>R</td>
<td width=35%>The Windows GDI handle of the picture</td>
</tr>
<tr valign=top>
<td width=21%>hPal</td>
<td width=31%>OLE_HANDLE (int)</td>
<td width=13%>RW</td>
<td width=35%>The Windows handle of the palette used by the picture</td>
</tr>
<tr valign=top>
<td width=21%>Type</td>
<td width=31%>short</td>
<td width=13%>R</td>
<td width=35%>The type of picture (see below)</td>
</tr>
<tr valign=top>
<td width=21%>Width</td>
<td width=31%>OLE_XSIZE_HIMETRIC (long)</td>
<td width=13%>R</td>
<td width=35%>The width of the picture</td>
</tr>
<tr valign=top>
<td width=21%>Height</td>
<td width=31%>OLE_YSIZE_HIMETRIC (long)</td>
<td width=13%>R</td>
<td width=35%>The height of the picture</td>
</tr>
<tr valign=top>
<td width=21%>CurDC</td>
<td width=31%>HDC</td>
<td width=13%>R</td>
<td width=35%>The current device context</td>
</tr>
<tr valign=top>
<td width=21%>KeepOriginalFormat</td>
<td width=31%>BOOL</td>
<td width=13%>RW</td>
<td width=35%>If TRUE, the picture object maintains the entire original state of the picture in memory. If FALSE, any state not applicable to the user's machine is discarded</td>
</tr>
<tr valign=top>
<td width=21%>Attributes</td>
<td width=31%>DWORD</td>
<td width=13%>R</td>
<td width=35%>Miscellaneous bit attributes of the picture (see below)</td>
</tr>
</table><br>
<h5>When to Use</h5>
<p>
Use this interface to change the properties of a picture object.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IUnknown Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=55%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=55%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=55%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>IPicture Methods</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_3vtx.htm"><b>get_Handle</b></a></td>
<td width=55%>Returns the Windows GDI handle of the picture managed within this picture object.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_9yjw.htm"><b>get_Hpal</b></a></td>
<td width=55%>Returns a copy of the palette currently used by the picture object.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_86zp.htm"><b>get_Type</b></a></td>
<td width=55%>Returns the current type of the picture.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_2a5k.htm"><b>get_Width</b></a></td>
<td width=55%>Returns the current width of the picture in the picture object.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_4fas.htm"><b>get_Height</b></a></td>
<td width=55%>Returns the current height of the picture in the picture object.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_7wky.htm"><b>Render</b></a></td>
<td width=55%>Draws the specified portion of the picture onto the specified device context, positioned at the specified location.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_2758.htm"><b>set_Hpal</b></a></td>
<td width=55%>Sets the current palette of the picture.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_917n.htm"><b>get_CurDC</b></a></td>
<td width=55%>Returns the current device context into which this picture is selected.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_5s9x.htm"><b>SelectPicture</b></a></td>
<td width=55%>Selects a bitmap picture into a given device context, returning the device context in which the picture was previously selected as well as the picture's GDI handle.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_9bg4.htm"><b>get_KeepOriginalFormat</b></a></td>
<td width=55%>Returns the current value of the picture object's KeepOriginalFormat property.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_06gk.htm"><b>put_KeepOriginalFormat</b></a></td>
<td width=55%>Sets the picture object's KeepOriginalFormat property.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_9e78.htm"><b>PictureChanged</b></a></td>
<td width=55%>Notifies the picture object that its picture resource changed.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_7hwl.htm"><b>SaveAsFile</b></a></td>
<td width=55%>Saves the picture's data into a stream in the same format that it would save itself into a file.</td>
</tr>
<tr valign=top>
<td width=45%><a href="if_p2q_9zxv.htm"><b>get_Attributes</b></a></td>
<td width=55%>Returns the current set of the picture's bit attributes.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_p2q_3p2m.htm"><b>IPicture - Ole Implementation</b></a>, <a href="if_p2q_0als.htm"><b>IPictureDisp</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
