<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLEUICONVERT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleuiconvert_str"></a>OLEUICONVERT</h1>
<p>
The <b>OLEUICONVERT</b> structure contains information that the OLE User Interface Library uses to initialize the Convert dialog box, and space for the library to return information when the dialog box is dismissed. </p>
<pre><code>typedef struct tagOLEUICONVERT 
{ 
// These IN fields are standard across all OLEUI dialog functions. 
    DWORD          cbStruct 
    DWORD          dwFlags 
    HWND           hWndOwner 
    LPCSTR         lpszCaption 
    LPFNOLEUIHOOK  lpfnHook 
    LPARAM         lCustData 
    HINSTANCE      hInstance 
    LPCSTR         lpszTemplate 
    HRSRC          hResource 
 
// Specifics for OLEUICONVERT. 
    CLSID    clsid; 
    CLSID    clsidConvertDefault; 
    CLSID    clsidActivateDefault; 
    CLSID    clsidNew; 
    DWORD    dvAspect; 
    WORD     wFormat; 
    BOOL     fIsLinkedObject; 
    HGLOBAL  hMetaPict; 
    LPTSTR   lpszUserType; 
    BOOL     fObjectsIconChanged; 
    LPTSTR   lpszDefLabel 
    UINT     cClsidExclude 
    LPCLSID  lpClsidExclude 
} OLEUICONVERT, *POLEUICONVERT, FAR *LPOLEUICONVERT; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbStruct</b></dt>
<dd>
Size of the structure, in bytes. This field must be filled on input.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
On input, this field specifies the initialization and creation flags. On exit, it specifies the user's choices. It may be a combination of the following flags:
<dl>
<dt>
CF_SHOWHELPBUTTON</dt>
<dd>
Dialog box will display a Help button. This flag is set on input.</dd>
<dt>
CF_SETCONVERTDEFAULT</dt>
<dd>
Class whose CLSID is specified by <b>clsidConvertDefault</b> will be used as the default selection. This selection appears in the class listbox when the Convert To radio button is selected. This flag is set on input.</dd>
<dt>
CF_SETACTIVATEDEFAULT</dt>
<dd>
Class whose CLSID is specified by <b>clsidActivateDefault</b> will be used as the default selection. This selection appears in the class listbox when the Activate As radio button is selected. This flag is set on input.</dd>
<dt>
CF_SELECTCONVERTTO</dt>
<dd>
On input, this flag specifies that Convert To will be initially selected (default behavior). This flag is set on output if Convert To was selected when the user dismissed the dialog box.</dd>
<dt>
CF_SELECTACTIVATEAS</dt>
<dd>
On input, this flag specifies that Activate As will be initially selected. This flag is set on output if Activate As was selected when the user dismissed the dialog box.</dd>
<dt>
CF_DISABLEDISPLAYASICON</dt>
<dd>
The Display As Icon button will be disabled on initialization.</dd>
<dt>
CF_DISABLEACTIVATEAS</dt>
<dd>
The Activate As radio button will be disabled on initialization.</dd>
<dt>
CF_HIDECHANGEICON</dt>
<dd>
The Change Icon button will be hidden in the Convert dialog box. </dd>
<dt>
CF_CONVERTONLY</dt>
<dd>
The Activate As radio button will be disabled in the Convert dialog box. </dd>
</dl>
</dd>
<dt>
<b>hWndOwner</b></dt>
<dd>
Window that owns the dialog box. It should not be NULL.</dd>
<dt>
<b>lpszCaption</b></dt>
<dd>
Pointer to a string to be used as the title of the dialog box. If NULL, then the library uses Convert.</dd>
<dt>
<b>lpfnHook</b></dt>
<dd>
Pointer to a hook function that processes messages intended for the dialog box. The hook function must return zero to pass a message that it didn't process back to the dialog box procedure in the library. The hook function must return a non-zero value to prevent the library's dialog box procedure from processing a message it has already processed. </dd>
<dt>
<b>lCustData</b></dt>
<dd>
Application-defined data that the library passes to the hook function pointed to by the <b>lpfnHook</b> member. The library passes a pointer to the <b>OLEUICONVERT</b> structure in the <i>lParam</i> parameter of the WM_INITDIALOG message; this pointer can be used to retrieve the <b>lCustData</b> member. </dd>
<dt>
<b>hInstance</b></dt>
<dd>
Instance that contains a dialog box template specified by the <b>lpszTemplate</b> member. This member is ignored if the <b>lpszTemplate</b> member is NULL or invalid. </dd>
<dt>
<b>lpszTemplate</b></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the resource file for the dialog box template that is to be substituted for the library's Convert dialog box template. </dd>
<dt>
<b>hResource</b></dt>
<dd>
Resource handle for a custom dialog box. If this member is NULL, then the library uses the standard Convert dialog box template, or if it is valid, the template named by the <b>lpszTemplate</b> member.</dd>
<dt>
<b>clsid</b></dt>
<dd>
The CLSID of the object to be converted or activated. This member is set on input.</dd>
<dt>
<b>clsidConvertDefault</b></dt>
<dd>
The CLSID to use as the default class when Convert To is selected. This member is ignored if the <b>dwFlags</b> member does not include CF_SETCONVERTDEFAULT. This member is set on input.</dd>
<dt>
<b>clsidActivateDefault</b></dt>
<dd>
The CLSID to use as the default class when Activate As is selected. This member is ignored if the <b>dwFlags</b> member does not include CF_SETACTIVATEDEFAULT. This member is set on input. </dd>
<dt>
<b>clsidNew</b></dt>
<dd>
The CLSID of the selected class. This member is set on output.</dd>
<dt>
<b>dvAspect</b></dt>
<dd>
Aspect of the object. This must be either DVASPECT_CONTENT or DVASPECT_ICON. If <b>dvAspect</b> is DVASPECT_ICON on input, then the Display As Icon box is checked and the object's icon is displayed. This member is set on input and output.</dd>
<dt>
<b>wFormat</b></dt>
<dd>
Data format of the object to be converted or activated.</dd>
<dt>
<b>fIsLinkedObject</b></dt>
<dd>
TRUE if the object is linked. This member is set on input.</dd>
<dt>
<b>hMetaPict</b></dt>
<dd>
The METAFILEPICT containing the iconic aspect. This member is set on input and output.</dd>
<dt>
<b>lpszUserType</b></dt>
<dd>
Pointer to the User Type name of the object to be converted or activated. If this value is NULL, then the dialog box will retrieve the User Type name from the registry. This string is freed on exit.</dd>
<dt>
<b>fObjectsIconChanged</b></dt>
<dd>
TRUE if the object's icon changed. (that is, if <a href="api3_6tv2.htm"><b>OleUIChangeIcon</b></a> was called and not canceled.). This member is set on output.</dd>
<dt>
<b>lpszDefLabel</b></dt>
<dd>
Pointer to the default label to use for the icon. If NULL, the short user type name will be used. If the object is a link, the caller should pass the Display Name of the link source. This is freed on exit. </dd>
<dt>
<b>cClsidExclude</b></dt>
<dd>
Number of CLSIDs in <b>lpClsidExclude</b>.</dd>
<dt>
<b>lpClsidExclude</b></dt>
<dd>
Pointer to the list of CLSIDs to exclude from the list. 
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oledlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in oledlg.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_3ywk.htm"><b>OleUIConvert</b></a>, <a href="api3_6tv2.htm"><b>OleUIChangeIcon</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
