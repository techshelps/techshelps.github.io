<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleFlushClipboard</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleflushclipboard"></a>OleFlushClipboard</h1>
<p>
Carries out the clipboard shutdown sequence. It also releases the <b>IDataObject</b> pointer that was placed on the clipboard by the <a href="api3_55r8.htm"><b>OleSetClipboard</b></a> function.</p>
<pre><b><code>WINOLEAPI OleFlushClipboard( );
 </code></b></pre>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The clipboard has been flushed.</dd>
<dt>
CLIPBRD_E_CANT_OPEN</dt>
<dd>
The Windows <b>OpenClipboard</b> function used within <b>OleFlushClipboard</b> failed.</dd>
<dt>
CLIPBRD_E_CANT_CLOSE</dt>
<dd>
The Windows <b>CloseClipboard</b> function used within <b>OleFlushClipboard</b> failed.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>OleFlushClipboard</b> renders the data from a data object onto the clipboard and releases the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> pointer to the data object. While the application that put the data object on the clipboard is running, the clipboard holds only a pointer to the data object, thus saving memory. If you are writing an application that acts as the source of a clipboard operation, you can call the <b>OleFlushClipboard</b> function when your application is closed, such as when the user exits from your application. Calling <b>OleFlushClipboard </b>enables pasting and paste-linking of OLE objects after application shutdown.</p>
<p>
Before calling <b>OleFlushClipboard</b>, you can easily determine if your data is still on the clipboard with a call to the <a href="api3_882s.htm"><b>OleIsCurrentClipboard</b></a> function.</p>
<p>
<b>OleFlushClipboard</b> leaves all formats offered by the data transfer object, including the OLE 1 compatibility formats, on the clipboard so they are available after application shutdown. In addition to OLE 1 compatibility formats, these include all formats offered on a global handle medium (all except for TYMED_FILE) and formatted with a NULL target device. For example, if a data-source application offers a particular clipboard format (say cfFOO) on an <b>IStorage</b> object, and calls the <a href="#_com_oleflushclipboard"><b>OleFlushClipboard</b></a> function, the storage object is copied into memory and the <i>hglobal</i> memory handle is put on the Clipboard. </p>
<p>
To retrieve the information on the clipboard, you can call the <b>OleGetClipboard</b> function from another application, which creates a default data object, and the <i>hglobal</i> from the clipboard again becomes a storage object. Furthermore, the <a href="structs_14v7.htm"><b>FORMATETC</b></a> enumerator and the <a href="if_a2e_9wtd.htm"><b>IDataObject::QueryGetData</b></a> method would all correctly indicate that the original clipboard format (cfFOO) is again available on a TYMED_ISTORAGE.</p>
<p>
To empty the clipboard, call the <a href="api3_55r8.htm"><b>OleSetClipboard</b></a> function specifying a NULL value for its parameter. The application should call this when it closes if there is no need to leave data on the clipboard after shutdown, or if data will be placed on the clipboard using the standard Windows clipboard functions.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<b>OleGetClipboard</b>,<b> <a href="api3_55r8.htm">OleSetClipboard</a></b>,<b> <a href="api3_882s.htm">OleIsCurrentClipboard</a></b>,<b> <a href="if_a2e_24z8.htm">IDataObject</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
