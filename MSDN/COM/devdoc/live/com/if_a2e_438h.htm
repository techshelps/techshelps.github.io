<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDataObject::SetData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_idataobject_setdata"></a>IDataObject::SetData</h2>
<p>
Called by an object containing a data source to transfer data to the object that implements this method.</p>
<pre><code><b>HRESULT SetData(
  FORMATETC *</b><i> pFormatetc</i><b>,  </b>//Pointer to the FORMATETC structure
<b>  STGMEDIUM *</b><i> pmedium</i><b>,     </b>//Pointer to STGMEDIUM structure
<b>  BOOL</b><i> fRelease            </i>//Indicates which object owns the storage 
                           // medium after the call is completed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pFormatetc</i></dt>
<dd>
[in] Pointer to the FORMATETC structure defining the format used by the data object when interpreting the data contained in the storage medium.</dd>
<dt>
<i>pmedium</i></dt>
<dd>
[in] Pointer to the STGMEDIUM structure defining the storage medium in which the data is being passed.</dd>
<dt>
<i>fRelease</i></dt>
<dd>
[in] If TRUE, the data object called, which implements <b>IDataObject::SetData</b>, owns the storage medium after the call returns. This means it must free the medium after it has been used by calling the <a href="api3_1rxp.htm"><b>ReleaseStgMedium</b></a> function. If FALSE, the caller retains ownership of the storage medium and the data object called uses the storage medium for the duration of the call only.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_FAIL, E_INVALIDARG, E_UNEXPECTED, and E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
Data was successfully transferred.</dd>
<dt>
E_NOTIMPL</dt>
<dd>
This method is not implemented for the data object.</dd>
<dt>
DV_E_LINDEX</dt>
<dd>
Invalid value for <i>lindex</i>; currently, only -1 is supported.</dd>
<dt>
DV_E_FORMATETC</dt>
<dd>
Invalid value for <i>pFormatetc</i>.</dd>
<dt>
DV_E_TYMED</dt>
<dd>
Invalid <i>tymed</i> value.</dd>
<dt>
DV_E_DVASPECT</dt>
<dd>
Invalid <i>dwAspect</i> value.</dd>
<dt>
OLE_E_NOTRUNNING</dt>
<dd>
Object application is not running.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>IDataObject::SetData</b> allows another object to attempt to send data to the implementing data object. A data object implements this method if it supports receiving data from another object. If it does not support this, it should be implemented to return E_NOTIMPL. </p>
<p>
The caller allocates the storage medium indicated by the <i>pmedium</i>, in which the data is passed. The data object called does not take ownership of the data until it has successfully received it and no error code is returned. The value of the <i>fRelease</i> parameter indicates the ownership of the medium after the call returns. FALSE indicates the caller still owns the medium, and the data object only has the use of it during the call; TRUE indicates that the data object now owns it and must release it when it is no longer needed.</p>
<p>
The type of medium (<a href="enums_986c.htm">TYMED</a>) specified in the <i>pformatetc</i> and <i>pmedium</i> parameters must be the same. For example, one cannot be an hGlobal (global handle) and the other a stream.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_1jz5.htm"><b>IDataObject::GetData</b></a>, <a href="structs_14v7.htm"><b>FORMATETC</b></a>, <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
