<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoSwitchCallContext</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_coswitchcallcontext"></a>CoSwitchCallContext</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Switches the call context object used by <a href="api1_2rqs.htm"><b>CoGetCallContext</b></a>. </p>
<pre><code><b>HRESULT CoSwitchCallContext(
  IUnknown</b><i> *pNewObject</i><b>,</b>    //Pointer to an interface on the new call context
<b>  IUnknown **</b><i>ppOldObject   </i>//Address of output variable that receives a 
                           // pointer to the old call context object
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pNewObject</i></dt>
<dd>
[in] A pointer to an interface on the new call context object. COM will keep a reference to the pointer until <b>CoSwitchCallContext</b> is called with another object. It may be NULL if you are calling <b>CoSwitchCallContext</b> to switch back to the original call context and there was no original call context.</dd>
<dt>
<i>ppOldObject</i></dt>
<dd>
[out] Address of pointer variable that receives a pointer to the call context object of the call currently in progress. This value is returned so that the original call context can be restored by the custom marshaller. The returned pointer will be NULL if there was no call in progress.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
Success. </dd>
<dt>
E_OUT_OF_MEMORY</dt>
<dd>
</dd>
</dl>
<h4>Remarks</h4>
<p>
Custom marshallers call <b>CoSwitchCallContext</b> to change the call context object used by <a href="api1_2rqs.htm"><b>CoGetCallContext</b></a>. Before dispatching an arriving call, custom marshallers call <b>CoSwitchCallContext</b>, specifying the new context object. After sending a reply, they must restore the original call context by calling <b>CoSwitchCallContext</b> again, this time passing a pointer to the original context object. </p>
<p>
Call context objects provided by custom marshallers should support <b>IServerSecurity</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="if_r2z_3w55.htm"><b>IServerSecurity</b></a>, <a href="comext_47fx.htm"><b>Security in COM</b></a>, <a href="api1_2rqs.htm"><b>CoGetCallContext</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
