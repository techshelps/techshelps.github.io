<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleSetClipboard</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_olesetclipboard"></a>OleSetClipboard</h1>
<p>
Places a pointer to a specific data object onto the clipboard. This makes the data object accessible to the <a href="api3_4rtw.htm"><b>OleGetClipboard</b></a> function.</p>
<pre><code><b>WINOLEAPI OleSetClipboard(
  IDataObject *</b><i> pDataObj  </i>//Pointer to the data object being copied 
                          // or cut
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>pDataObj</i></dt>
<dd>
[in] Pointer to the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interface on the data object from which the data to be placed on the clipboard can be obtained. This parameter can be NULL; in which case the clipboard is emptied.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The<b> IDataObject</b> pointer was placed on the clipboard. </dd>
<dt>
CLIPBRD_E_CANT_OPEN</dt>
<dd>
The Windows <b>OpenClipboard</b> function used within <b>OleSetClipboard</b> failed.</dd>
<dt>
CLIPBRD_E_CANT_EMPTY</dt>
<dd>
The Windows <b>EmptyClipboard</b> function used within <b>OleSetClipboard</b> failed.</dd>
<dt>
CLIPBRD_E_CANT_CLOSE</dt>
<dd>
The Windows <b>CloseClipboard</b> function used within <b>OleSetClipboard</b> failed.</dd>
<dt>
CLIPBRD_E_CANT_SET</dt>
<dd>
The Windows <b>SetClipboard</b> function used within <b>OleSetClipboard</b> failed.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If you are writing an application that can act as the source of a clipboard operation, you must do the following:
<ol>
<li>
Create a data object (on which is the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interface) for the data being copied or cut to the clipboard. This object should be the same object used in OLE drag-and-drop operations.</li>
<li>
Call <b>OleSetClipboard</b> to place the <b>IDataObject</b> pointer onto the clipboard, so it is accessible to the <a href="api3_4rtw.htm"><b>OleGetClipboard</b></a> function. <b>OleSetClipboard</b> also calls the <b>IUnknown::AddRef</b> method on your data object.</li>
<li>
If you wish, release the data object once you have placed it on the clipboard to free the <b>IUnknown::AddRef</b> counter in your application.</li>
<li>
If the user is cutting data (deleting it from the document and putting it on to the clipboard), remove the data from the document.</li>
</ol>
<p>
All formats are offered on the clipboard using delayed rendering (the clipboard contains only a pointer to the data object unless a call to <b>OleFlushClipboard</b> renders the data onto the clipboard). The formats necessary for OLE 1 compatibility are synthesized from the OLE 2 formats that are present and are also put on the clipboard.</p>
<p>
The<b> OleSetClipboard</b> function assigns ownership of the clipboard to an internal OLE window handle. The reference count of the data object is increased by 1, to enable delayed rendering. The reference count is decreased by a call to the <a href="api3_123o.htm"><b>OleFlushClipboard</b></a> function or by a subsequent call to <b>OleSetClipboard</b> specifying NULL as the parameter value (which clears the clipboard).</p>
<p>
When an application opens the clipboard (either directly or indirectly by calling the Win32 <b>OpenClipboard</b> function), the clipboard cannot be used by any other application until it is closed. If the clipboard is currently open by another application, <b>OleSetClipboard </b>fails. The internal OLE window handle satisfies WM_RENDERFORMAT messages by delegating them to the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> implementation on the data object that is on the clipboard.</p>
<p>
Specifying NULL as the parameter value for <b>OleSetClipboard</b> empties the current clipboard. If the contents of the clipboard are the result of a previous <b>OleSetClipboard</b> call and the clipboard has been released, the <b>IDataObject</b> pointer that was passed to the previous call is released. The clipboard owner should use this as a signal that the data it previously offered is no longer on the clipboard.</p>
<p>
If you need to leave the data on the clipboard after your application is closed, you should call <b>OleFlushClipboard</b> instead of <b>OleSetClipboard</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_123o.htm"><b>OleFlushClipboard</b></a>, <a href="api3_4rtw.htm"><b>OleGetClipboard</b></a>, <a href="api3_882s.htm"><b>OleIsCurrentClipboard</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
