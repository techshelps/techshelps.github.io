<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DoDragDrop</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_dodragdrop"></a>DoDragDrop</h1>
<p>
Carries out an OLE drag and drop operation.</p>
<pre><code><b>WINOLEAPI DoDragDrop(
  IDataObject *</b><i> pDataObject</i><b>,  </b>//Pointer to the data object
<b>  IDropSource *</b><i> pDropSource</i><b>,  </b>//Pointer to the source
<b>  DWORD</b><i> dwOKEffect</i><b>,           </b>//Effects allowed by the source
<b>  DWORD *</b><i> pdwEffect           </i>//Pointer to effects on the source
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pDataObject</i></dt>
<dd>
[in] Pointer to the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interface on a data object that contains the data being dragged.</dd>
<dt>
<i>pDropSource</i></dt>
<dd>
[in] Pointer to an implementation of the <a href="if_a2e_12jp.htm"><b>IDropSource</b></a><b> </b>interface, which is used to communicate with the source during the drag operation.</dd>
<dt>
<i>dwOKEffect</i></dt>
<dd>
[in] Effects the source allows in the OLE drag-and-drop operation. Most significant is whether it permits a move. The <i>dwOKEffect</i> and <i>pdwEffect</i> parameters obtain values from the <a href="enums_6bas.htm"><b>DROPEFFECT</b></a> enumeration. For a list of values, see <b>DROPEFFECT</b>.</dd>
<dt>
<i>pdwEffect</i></dt>
<dd>
[out] Pointer to a value that indicates how the OLE drag-and-drop operation affected the source data. The <i>pdwEffect</i> parameter is set only if the operation is not canceled.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return value E_OUTOFMEMORY, as well as the following:
<dl>
<dt>
DRAGDROP_S_DROP</dt>
<dd>
The OLE drag-and-drop operation was successful.</dd>
<dt>
DRAGDROP_S_CANCEL</dt>
<dd>
The OLE drag-and-drop operation was canceled. </dd>
<dt>
E_UNSPEC</dt>
<dd>
Unexpected error occurred.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If you are developing an application that can act as a data source for an OLE drag-and-drop operation, you must call <b>DoDragDrop</b> when you detect that the user has started an OLE drag-and-drop operation.</p>
<p>
The <b>DoDragDrop</b> function enters a loop in which it calls various methods in the <a href="if_a2e_12jp.htm"><b>IDropSource</b></a> and <a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a> interfaces. (For a successful drag-and-drop operation, the application acting as the data source must also implement <b>IDropSource</b>, while the target application must implement <b>IDropTarget</b>.)
<ol>
<li>
The <b>DoDragDrop</b> function determines the window under the current cursor location. It then checks to see if this window is a valid drop target.</li>
<li>
If the window is a valid drop target, <b>DoDragDrop</b> calls <a href="if_a2e_5ovm.htm"><b>IDropTarget::DragEnter</b></a>. This method supplies an effect code indicating what would happen if the drop actually occurred. For a list of valid drop effects, see the <a href="enums_6bas.htm"><b>DROPEFFECT</b></a> enumeration.</li>
<li>
<b>DoDragDrop</b> calls <a href="if_a2e_6lkb.htm"><b>IDropSource::GiveFeedback</b></a> with the effect code so that the drop source interface can provide appropriate visual feedback to the user. The <i>pDropSource</i> pointer passed into <b>DoDragDrop</b> specifies the appropriate <b>IDropSource</b> interface.</li>
<li>
<b>DoDragDrop</b> tracks mouse cursor movements and changes in the keyboard or mouse button state.<ul>
<li>
If the user moves out of a window, <b>DoDragDrop</b> calls <a href="if_a2e_0mw5.htm"><b>IDropTarget::DragLeave</b></a>.</li>
<li>
If the mouse enters another window, <b>DoDragDrop</b> determines if that window is a valid drop target and then calls <a href="if_a2e_5ovm.htm"><b>IDropTarget::DragEnter</b></a> for that window.</li>
<li>
If the mouse moves but stays within the same window, <b>DoDragDrop</b> calls <a href="if_a2e_8zle.htm"><b>IDropTarget::DragOver</b></a>.</li>
</ul>
</li>
<li>
If there is a change in the keyboard or mouse button state, <b>DoDragDrop</b> calls <a href="if_a2e_5ew7.htm"><b>IDropSource::QueryContinueDrag</b></a> and determines whether to continue the drag, to drop the data, or to cancel the operation based on the return value.<ul>
<li>
If the return value is S_OK, <b>DoDragDrop</b> first calls <b>IDropTarget::DragOver</b> to continue the operation. This method returns a new effect value and <b>DoDragDrop</b> then calls <a href="if_a2e_6lkb.htm"><b>IDropSource::GiveFeedback</b></a> with the new effect so appropriate visual feedback can be set. For a list of valid drop effects, see the <a href="enums_6bas.htm"><b>DROPEFFECT</b></a> enumeration. <b>IDropTarget::DragOver</b> and <b>IDropSource::GiveFeedback</b> are paired so that as the mouse moves across the drop target, the user is given the most up-to-date feedback on the mouse's position.</li>
<li>
If the return value is DRAGDROP_S_DROP, <b>DoDragDrop</b> calls <a href="if_a2e_9oog.htm"><b>IDropTarget::Drop</b></a>. The <b>DoDragDrop</b> function returns the last effect code to the source, so the source application can perform the appropriate operation on the source data, for example, cut the data if the operation was a move.</li>
<li>
If the return value is DRAGDROP_S_CANCEL, the <b>DoDragDrop</b> function calls <a href="if_a2e_0mw5.htm"><b>IDropTarget::DragLeave</b></a>.</li>
</ul>
</li>
</ol>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_12jp.htm"><b>IDropSource</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
