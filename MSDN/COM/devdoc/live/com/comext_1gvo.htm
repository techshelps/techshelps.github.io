<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting a Pointer to an Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_getting_a_pointer_to_an_object"></a>Getting a Pointer to an Object</h1>
<p>
Because COM does not have a strict class model, there are several ways to instantiate or to get a pointer to an interface on an object. There are, in fact, four methods through which a client obtains its first interface pointer to a given object:
<ul>
<li>
Call a COM Library API function that creates an object of a pre-determined type — that is, the function will only return a pointer to one specific interface for a specific object class.</li>
<li>
Call a COM Library API function that can create an object based on a class identifier (CLSID) and that returns any type of interface pointer requested.</li>
<li>
Call a method of some interface that creates another object (or connects to an existing one) and returns an interface pointer on that separate object.</li>
<li>
Implement an object with an interface through which other objects pass their interface pointer to the client directly. </li>
</ul>
<p>
For information on getting pointers to other interfaces on an object once you have the first one, see <a href="com_02b8.htm"><b>QueryInterface: Navigating in an Object</b></a>.</p>
<p>
There are numerous COM functions that return pointers to specific interface implementations, such as <b>CoGetMalloc</b>, which retrieves a pointer to the standard COM memory allocator. Most of these are helper functions, which retrieve a pointer to an COM implementation of an interface on an object, as does <b>CoGetMalloc</b>. Most of these functions are described in the specific area they are related to, such as storage or data transfer.</p>
<p>
There are several functions that, given a CLSID, a client can call to create an object instance and get a pointer to it. All of these functions are based on the function <a href="api1_6yb8.htm"><b>CoGetClassObject</b></a>, which creates a class object and supplies a pointer to an interface that allows you to create instances of that class. While there must be information that says which system the server resides on, there is no need for that information to be contained in the client. The client needs to know only the CLSID, and never the absolute path of the server code. For more information, see <a href="comext_4otw.htm"><b>Creating an Object through a Class Object</b></a>.</p>
<p>
Among the many interface methods that return a pointer to a separate object are several that create and return a pointer to an enumerator object, which allows you to determine how many items of a given type an object maintains. COM defines interfaces for enumerating a wide variety of items, such as strings, several structures important in various COM technologies, monikers, and <a href="if_r2z_9dwu.htm"><b>IUnknown</b></a> interface pointers. The typical way to create an enumerator instance and get a pointer to its interface is to call a method from another interface. For example, the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interface defines two methods, <b>EnumDAdvise</b> and <b>EnumFormatEtc</b>, that return pointers to interfaces on two different enumeration objects. There are many other examples in COM of methods that return pointers to objects, such as the OLE Compound Document interface <a href="if_o_2fs5.htm"><b>IOleObject::GetClientSite</b></a>, which, when called on the embedded or linked object, returns a pointer to the container object's implementation of <a href="if_o_444l.htm"><b>IOleClientSite</b></a>.</p>
<p>
The fourth way to get a pointer to an object is used when two objects, such as an OLE Compound Document container and server, need bi-directional communication. Each implements an object containing an interface method to which other objects can pass interface pointers. In the case of containers and servers, each object then passes its pointer to the other object. The implementing object, which is also the client of the created object, can then call the method and get the pointer that was passed.</p>
<p>&nbsp;</p></body>
</HTML>
