<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleObject::InitFromData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleobject_initfromdata"></a>IOleObject::InitFromData</h2>
<p>
Initializes a newly created object with data from a specified data object, which can reside either in the same container or on the Clipboard.</p>
<pre><code><b>HRESULT InitFromData(
  IDataObject</b><i> *pDataObject</i><b>,  </b>//Pointer to data object
<b>  BOOL</b><i> fCreation</i><b>,            </b>//Specifies how object is created
<b>  DWORD</b><i> dwReserved           </i>//Reserved
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pDataObject</i></dt>
<dd>
[in] Pointer to the <b>IDataObject</b> interface on the data object from which the initialization data is to be obtained. This parameter can be NULL, which indicates that the caller wants to know if it is worthwhile trying to send data; that is,<i> </i>whether the container is capable of initializing an object from data passed to it. The data object to be passed can be based on either the current selection within the container document or on data transferred to the container from an external source.</dd>
<dt>
<i>fCreation</i></dt>
<dd>
[in] TRUE indicates the container is inserting a new object inside itself and initializing that object with data from the current selection; FALSE indicates a more general programmatic data transfer, most likely from a source other than the current selection.</dd>
<dt>
<i>dwReserved</i></dt>
<dd>
[in] Reserved for future use; must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
If <i>pDataObject </i>is not NULL, the object successfully attempted to initialize itself from the provided data; if <i>pDataObject</i> is NULL, the object is able to attempt a successful initialization.</dd>
<dt>
S_FALSE</dt>
<dd>
If <i>pDataObject</i> is not NULL, the object made no attempt to initialize itself; if <i>pDataObject</i> is NULL, the object cannot attempt to initialize itself from the data provided.</dd>
<dt>
E_NOTIMPL</dt>
<dd>
The object does not support <b>InitFromData</b>.</dd>
<dt>
OLE_E_NOTRUNNING </dt>
<dd>
The object is not running and therefore cannot perform the operation.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method enables a container document to insert within itself a new object whose content is based on a current data selection within the container. For example, a spreadsheet document may want to create a graph object based on data in a selected range of cells.</p>
<p>
Using this method, a container can also replace the contents of an embedded object with data transferred from another source. This provides a convenient way of updating an embedded object.</p>
<h5>Notes to Callers</h5>
<p>
Following initialization, the container should call <b>IOleObject::GetMiscStatus</b> to check the value of the <b>OLEMISC_INSERTNOTREPLACE</b> bit. If the bit is on, the new object inserts itself following the selected data. If the bit is off, the new object replaces the selected data.</p>
<h5>Notes to Implementers</h5>
<p>
A container specifies whether to base a new object on the current selection by passing either TRUE or FALSE to the <i>fCreation</i> parameter.</p>
<p>
If <i>fCreation</i> is TRUE, the container is attempting to create a <i>new</i> instance of an object, initializing it with the selected data specified by the data object.</p>
<p>
If <i>fCreation</i> is FALSE, the caller is attempting to replace the object's current contents with that pointed to by <i>pDataObject</i>. The usual constraints that apply to an object during a paste operation should be applied here. For example, if the type of the data provided is unacceptable, the object should fail to initialize and return S_FALSE.</p>
<p>
If the object returns S_FALSE, it cannot initialize itself from the provided data.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_601f.htm"><b>IOleObject::GetMiscStatus</b></a>, <a href="if_a2e_438h.htm"><b>IDataObject::SetData</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
