<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleUndoManager::UndoTo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleundomanager_undoto"></a>IOleUndoManager::UndoTo</h2>
<p>
Instructs the undo manager to invoke undo actions back through the undo stack, down to and including the specified undo unit.</p>
<pre><code><b>HRESULT UndoTo(
  IOleUndoUnit*</b><i> pUU</i>   //Pointer to the top level unit to undo
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pUU</i></dt>
<dd>
[in] Pointer to the top level unit to undo. If this parameter is NULL, the most recently added top level unit is used.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The specified undo unit was successfully invoked to perform its undo action.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
The specified undo unit is not on the undo stack.</dd>
<dt>
E_ABORT</dt>
<dd>
Both the undo attempt and the rollback attempt failed. The undo manager should never propagate the E_ABORT obtained from a contained undo unit. Instead, it should map any E_ABORT values returned from other undo units to E_FAIL.</dd>
<dt>
E_UNEXPECTED</dt>
<dd>
The undo manager is disabled.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method calls the <b>IOleUndoUnit::Do</b> method on each top-level undo unit. Then, it releases that undo unit.</p>
<p>
Note that the specified undo unit must be a top-level unit, typically retrieved through <b>IOleUndoManager::EnumUndoable</b>.</p>
<p>
In case an error is returned from the undo unit, the undo manager needs to attempt to rollback the state of the document to recover from the error by performing actions on the redo stack.</p>
<p>
No matter what the success of the rollback, the undo manager should always clear both stacks before returning the error.</p>
<p>
If the undo manager has called the <b>Do</b> method on more than one top-level unit, it should only rollback the unit that returned the error. The top-level units that succeeded should not be rolled back.</p>
<p>
The undo manager must also keep track of whether or not units were added to the opposite stack so it won't attempt rollback if nothing was added. See the <b>IOleUndoManager</b> interface for detailed description of error handling.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_75gl.htm"><b>IOleUndoManager::EnumUndoable</b></a>, <a href="if_o_6dm7.htm"><b>IOleUndoManager::RedoTo</b></a>, <a href="if_o_7w1b.htm"><b>IOleUndoUnit::Do</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
