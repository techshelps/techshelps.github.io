<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleCreateFromData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_olecreatefromdata"></a>OleCreateFromData</h1>
<p>
Creates an embedded object from a data transfer object retrieved either from the clipboard or as part of an OLE drag-and-drop operation. It is intended to be used to implement a paste from an OLE drag-and-drop operation.</p>
<pre><code><b>WINOLEAPI OleCreateFromData(
  LPDATAOBJECT</b><i> pSrcDataObj</i><b>,  </b>//Pointer to the data transfer object
<b>  REFIID</b><i> riid</i><b>,               </b>//Reference to the identifier of the 
                             // interface to be used to communicate 
                             // with the new object
<b>  DWORD</b><i> renderopt</i><b>,           </b>//Value from OLERENDER
<b>  LPFORMATETC</b><i> pFormatEtc</i><b>,    </b>//Pointer to value from FORMATETC, 
                             // depending on renderopt
<b>  LPOLECLIENTSITE</b><i> pClientSite</i><b>,  </b>//Pointer to interface
<b>  LPSTORAGE</b><i> pStg</i><b>,            </b>//Pointer to storage of object
<b>  LPVOID FAR*</b><i> ppvObj         </i>//Address of output variable that 
                             // receives the interface pointer 
                             // requested in <i>riid</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pSrcDataObj</i></dt>
<dd>
[in] Pointer to the <b>IDataObject</b> interface on the data transfer object that holds the data from which the object is created.</dd>
<dt>
<i>riid</i></dt>
<dd>
[in] Reference to the identifier of the interface the caller later uses to communicate with the new object (usually <b>IID_IOleObject</b>, defined in the OLE headers as the interface identifier for <b>IOleObject</b>).</dd>
<dt>
<i>renderopt</i></dt>
<dd>
[in] Value from the enumeration <a href="enums_38s2.htm"><b>OLERENDER</b></a> that indicates the locally cached drawing or data-etrieval capabilities the newly created object is to have. Additional considerations are described in the following Remarks section.</dd>
<dt>
<i>pFormatEtc</i></dt>
<dd>
[in] Pointer to a value from the enumeration <b>OLERENDER</b> that indicates the locally cached drawing or data-retrieval capabilities the newly created object is to have. The <b>OLERENDER </b>value chosen affects the possible values for the <i>pFormatEtc</i> parameter.</dd>
<dt>
<i>pClientSite</i></dt>
<dd>
[in] Pointer to an instance of <b>IOleClientSite</b>, the primary interface through which the object will request services from its container. May be NULL.</dd>
<dt>
<i>pStg</i></dt>
<dd>
[in] Pointer to the <b>IStorage</b> interface on the storage object. This parameter may not be NULL.</dd>
<dt>
<i>ppvObj</i></dt>
<dd>
[out] Address of pointer variable that receives the interface pointer requested in <i>riid</i>. Upon successful return, *<i>ppvObj</i> contains the requested interface pointer on the newly created object. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The embedded object was created successfully.</dd>
<dt>
OLE_E_STATIC</dt>
<dd>
Indicates OLE can create only a static object.</dd>
<dt>
DV_E_FORMATETC</dt>
<dd>
No acceptable formats are available for object creation.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>OleCreateFromData</b> function creates an embedded object from a data transfer object supporting the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interface. The data object in this case is either the type retrieved from the clipboard with a call to the <a href="api3_4rtw.htm"><b>OleGetClipboard</b></a> function or is part of an OLE drag-and-drop operation (the data object is passed to a call to <a href="if_a2e_9oog.htm"><b>IDropTarget::Drop</b></a>).</p>
<p>
If either the FileName or FileNameW clipboard format (CF_FILENAME) is present in the data transfer object, and CF_EMBEDDEDOBJECT or CF_EMBEDSOURCE do not exist, <b>OleCreateFromData</b> first attempts to create a package containing the indicated file. Generally, it takes the first available format. The Microsoft Windows NT File Manager places these formats on the clipboard when the user selects the File/Copy To Clipboard menu command. </p>
<p>
If <b>OleCreateFromData</b> cannot create a package, it tries to create an object using the CF_EMBEDDEDOBJECT format. If that format is not available, <b>OleCreateFromData</b> tries to create it with the CF_EMBEDSOURCE format. If neither of these formats is available and the data transfer object supports the <a href="if_p2q_8crp.htm"><b>IPersistStorage</b></a> interface, <b>OleCreateFromData</b> calls the object's <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a><b> </b>to have the object save itself.</p>
<p>
If an existing linked object is selected, then copied, it appears on the clipboard as just another embeddable object. Consequently, a paste operation that invokes <b>OleCreateFromData</b> may create a linked object. After the paste operation, the container should call the <b>QueryInterface </b>function, requesting <b>IID_IOleLink</b> (defined in the OLE headers as the interface identifier for <b>IOleLink</b>), to determine if a linked object was created.</p>
<p>
Use the <i>renderopt</i> and <i>pFormatetc</i> parameters to control the caching capability of the newly created object. For general information about using the interaction of these parameters to determine what is to be cached, refer to the<b> <a href="enums_38s2.htm">OLERENDER</a></b> enumeration. There are, however, some additional specific effects of these parameters on the way <b>OleCreateFromData</b> initializes the cache.</p>
<p>
When <b>OleCreateFromData</b> uses either the CF_EMBEDDEDOBJECT or the CF_EMBEDSOURCE clipboard format to create the embedded object, the main difference between the two is where the cache-initialization data is stored:
<ul>
<li>
CF_EMBEDDEDOBJECT indicates that the source is an existing embedded object. It already has in its cache the appropriate data, and OLE uses this data to initialize the cache of the new object. </li>
<li>
CF_EMBEDSOURCE indicates that the source data object contains the cache-initialization information in formats other than CF_EMBEDSOURCE. <b>OleCreateFromData</b> uses these to initialize the cache of the newly embedded object. </li>
</ul>
<p>
The <i>renderopt</i> values affect cache initialization as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=35%>Value</th>
<th align=left width=65%>Description</th>
</tr>
<tr valign=top>
<td width=35%>OLERENDER_DRAW &amp; OLERENDER_FORMAT</td>
<td width=65%>If the presentation information to be cached is currently present in the appropriate cache-initialization pool, it is used. (Appropriate locations are in the source data object cache for CF_EMBEDDEDOBJECT, and in the other formats in the source data object for CF_EMBEDSOURCE.) If the information is not present, the cache is initially empty, but will be filled the first time the object is run. No other formats are cached in the newly created object.</td>
</tr>
<tr valign=top>
<td width=35%>OLERENDER_NONE</td>
<td width=65%>Nothing is to be cached in the newly created object. If the source has the CF_EMBEDDEDOBJECT format, any existing cached data that has been copied is removed.</td>
</tr>
<tr valign=top>
<td width=35%>OLERENDER_ASIS</td>
<td width=65%>If the source has the CF_EMBEDDEDOBJECT format, the cache of the new object is to contain the same cache data as the source object. For CF_EMBEDSOURCE, nothing is to be cached in the newly created object. <p>
This option should be used by more sophisticated containers. After this call, such containers would call <b>IOleCache::Cache</b> and <b>IOleCache::Uncache</b> to set up exactly what is to be cached. For CF_EMBEDSOURCE, they would then also call <b>IOleCache::InitCache</b>.</p>
</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_6y5h.htm"><b>OleCreate</b></a>, <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
