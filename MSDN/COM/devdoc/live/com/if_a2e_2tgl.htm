<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAdviseSink::OnDataChange</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iadvisesink_ondatachange"></a>IAdviseSink::OnDataChange</h2>
<p>
Called by the server to notify a data object's currently registered advise sinks that data in the object has changed.</p>
<pre><code><b>void OnDataChange(
  FORMATETC *</b><i> pFormatetc</i><b>,  </b>//Pointer to format information
<b>  STGMEDIUM *</b><i> pStgmed  </i>//Pointer to storage medium
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pFormatetc</i></dt>
<dd>
[in] Pointer to the <a href="structs_14v7.htm"><b>FORMATETC</b></a> structure, which describes the format, target device, rendering, and storage information of the calling data object.</dd>
<dt>
<i>pStgmed</i></dt>
<dd>
[in] Pointer to the <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> structure, which defines the storage medium (global memory, disk file, storage object, stream object, GDI object, or undefined) and ownership of that medium for the calling data object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Object handlers and containers of link objects implement <b>IAdviseSink::OnDataChange </b>to take appropriate steps when notified that data in the object has changed. They also must call <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a> to set up advisory connections with the objects in whose data they are interested. (See <b>IDataObject::DAdvise</b> for more information on how to specify an advisory connection for data objects.)</p>
<p>
Containers that take advantage of OLE's caching support do not need to register for data-change notifications, because the information necessary to update the container's presentation of the object, including any changes in its data, are maintained in the object's cache.</p>
<h5>Notes to Implementers</h5>
<p>
If you implement <b>IAdviseSink::OnDataChange </b>for a container, remember that this method is asynchronous and that making synchronous calls within asynchronous methods is not valid. Therefore, you cannot call <a href="if_a2e_1jz5.htm"><b>IDataObject::GetData</b></a><b> </b>to obtain the data you need to update your object. Instead, you either post an internal message, or invalidate the rectangle for the changed data by calling <b>InvalidateRect</b> and waiting for a WM_PAINT message, at which point you are free to get the data and update the object.</p>
<p>
The data itself, which is valid only for the duration of the call, is passed using the storage medium pointed to by <i>pStgmed.</i> Since the caller owns the medium, the advise sink should not free it. Also, if <i>pStgmed</i> points to an <a href="if_r2z_9b8l.htm"><b>IStorage</b></a> or <a href="if_r2z_4x7x.htm"><b>IStream</b></a> interface, the sink must not increment the reference count.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
