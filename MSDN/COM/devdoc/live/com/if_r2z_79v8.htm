<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IViewObject::GetColorSet</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iviewobject_getcolorset"></a>IViewObject::GetColorSet</h2>
<p>
Returns the logical palette that the object will use for drawing in its <a href="if_r2z_799z.htm"><b>IViewObject::Draw</b></a> method with the corresponding parameters. </p>
<pre><code><b>HRESULT GetColorSet(
  DWORD</b><i> dwAspect</i><b>,   </b>//How the object is to be represented
<b>  LONG</b><i> lindex</i><b>,      </b>//Part of the object of interest in the draw 
                    //operation
<b>  void *</b><i> pvAspect</i><b>,  </b>//Always NULL
<b>  DVTARGETDEVICE *</b><i> ptd</i><b>,</b>
<b>                    </b>//Pointer to target device in a structure
<b>  HDC</b><i> hicTargetDev</i><b>, </b>//Information context for the target device
<b>  LOGPALETTE **</b><i> ppColorSet</i>
<i>                    </i>//Address of output variable that receives a 
                    //pointer to the requested LOGPALETTE structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwAspect</i></dt>
<dd>
[in] Specifies how the object is to be represented. Representations include content, an icon, a thumbnail, or a printed document. Valid values are taken from the enumeration <a href="enums_08j8.htm"><b>DVASPECT</b></a>. See the <b>DVASPECT</b> enumeration for more information.</dd>
<dt>
<i>lindex</i></dt>
<dd>
[in] Portion of the object that is of interest for the draw operation. Its interpretation varies with <i>dwAspect.</i> See the <b>DVASPECT</b> enumeration for more information.</dd>
<dt>
<i>pvAspect</i></dt>
<dd>
[in] Pointer to additional information about the view of the object specified in <i>dwAspect</i>. Since none of the current aspects support additional information, <i>pvAspect</i> must always be NULL.</dd>
<dt>
<i>ptd</i></dt>
<dd>
[in] Pointer to the <a href="structs_0en9.htm"><b>DVTARGETDEVICE</b></a> structure that describes the device for which the object is to be rendered. If NULL, the view should be rendered for the default target device (typically the display). A value other than NULL is interpreted in conjunction with <i>hicTargetDev</i> and <i>hdcDraw</i>. For example, if <i>hdcDraw</i> specifies a printer as the device context, <i>ptd</i> points to a structure describing that printer device. The data may actually be printed if <i>hicTargetDev</i> is a valid value or it may be displayed in print preview mode if <i>hicTargetDev</i> is NULL.</dd>
<dt>
<i>hicTargetDev</i></dt>
<dd>
[in] Information context for the target device indicated by the <i>ptd</i> parameter from which the object can extract device metrics and test the device's capabilities. If <i>ptd</i> is NULL, the object should ignore the <i>hicTargetDev</i> parameter. </dd>
<dt>
<i>ppColorSet</i></dt>
<dd>
[out] Address of <b>LOGPALETTE</b> pointer variable that receives a pointer to the <b>LOGPALETTE</b> structure. The <b>LOGPALETTE</b> structure contains the set of colors that would be used if <a href="if_r2z_799z.htm"><b>IViewObject::Draw</b></a> were called with the same parameters for <i>dwAspect</i>, <i>lindex</i>, <i>pvAspect</i>, <i>ptd</i>, and <i>hicTargetDev</i>. If *<i>ppColorSet</i> is NULL, the object does not use a palette.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG and E_UNEXPECTED, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
The set of colors was returned successfully.</dd>
<dt>
S_FALSE</dt>
<dd>
Set of colors is empty or the object will not give out the information.</dd>
<dt>
OLE_E_BLANK</dt>
<dd>
No presentation data for object.</dd>
<dt>
DV_E_LINDEX</dt>
<dd>
Invalid value for <i>lindex</i>; currently only -1 is supported.</dd>
<dt>
DV_E_DVASPECT</dt>
<dd>
Invalid value for <i>dwAspect</i>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The<b> IViewObject::GetColorSet</b> method recursively queries any nested objects and returns a color set that represents the union of all colors requested. The color set eventually percolates to the top-level container that owns the window frame. This container can call <b>IViewObject::GetColorSet</b> on each of its embedded objects to obtain all the colors needed to draw the embedded objects. The container can use the color sets obtained in conjunction with other colors it needs for itself to set the overall color palette.</p>
<p>
The OLE-provided implementation of <b>IViewObject::GetColorSet</b> looks at the data it has on hand to draw the picture. If CF_DIB is the drawing format, the palette found in the bitmap is used. For a regular bitmap, no color information is returned. If the drawing format is a metafile, the object handler enumerates the metafile looking for a CreatePalette metafile record. If one is found, the handler uses it as the color set.</p>
<h5>Note to Implementers</h5>
<p>
Object applications that rely on the default handler for drawing and that use metafiles for doing so should provide a SetPaletteEntries record when they generate their metafiles. If a SetPaletteEntries record is not found, the default object handler returns S_FALSE.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="enums_08j8.htm"><b>DVASPECT</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
