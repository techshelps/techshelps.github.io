<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDataObject::GetData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_idataobject_getdata"></a>IDataObject::GetData</h2>
<p>
Called by a data consumer to obtain data from a source data object. The <b>GetData</b> method renders the data described in the specified <a href="structs_14v7.htm"><b>FORMATETC</b></a> structure and transfers it through the specified <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> structure. The caller then assumes responsibility for releasing the <b>STGMEDIUM</b> structure.</p>
<pre><code><b>HRESULT GetData(
  FORMATETC *</b><i> pFormatetc</i><b>,  </b>//Pointer to the FORMATETC structure
<b>  STGMEDIUM *</b><i> pmedium  </i>//Pointer to the STGMEDIUM structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pFormatetc</i></dt>
<dd>
[in] Pointer to the FORMATETC structure that defines the format, medium, and target device to use when passing the data. It is possible to specify more than one medium by using the Boolean OR operator, allowing the method to choose the best medium among those specified. </dd>
<dt>
<i>pmedium</i></dt>
<dd>
[out] Pointer to the <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> structure that indicates the storage medium containing the returned data through its <i>tymed</i> member, and the responsibility for releasing the medium through the value of its <i>punkOuter</i> member. If <i>punkForRelease</i> is NULL, the receiver of the medium is responsible for releasing it; otherwise, <i>punkForRelease</i> points to the <b>IUnknown</b> on the appropriate object so its <b>Release</b> method can be called. The medium must be allocated and filled in by <b>IDataObject::GetData</b>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG, E_UNEXPECTED, and E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
Data was successfully retrieved and placed in the storage medium provided.</dd>
<dt>
DV_E_LINDEX</dt>
<dd>
Invalid value for <i>lindex</i>; currently, only -1 is supported.</dd>
<dt>
DV_E_FORMATETC</dt>
<dd>
Invalid value for <i>pFormatetc</i>.</dd>
<dt>
DV_E_TYMED</dt>
<dd>
Invalid <i>tymed</i> value.</dd>
<dt>
DV_E_DVASPECT</dt>
<dd>
Invalid <i>dwAspect</i> value.</dd>
<dt>
OLE_E_NOTRUNNING</dt>
<dd>
Object application is not running.</dd>
<dt>
STG_E_MEDIUMFULL</dt>
<dd>
An error occurred when allocating the medium.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A data consumer calls <b>IDataObject::GetData</b> to retrieve data from a data object, conveyed through a storage medium (defined through the STGMEDIUM structure). </p>
<h5>Notes to Callers</h5>
<p>
You can specify more than one acceptable <a href="enums_986c.htm"><b>TYMED</b></a> medium with the Boolean OR operator. <b>IDataObject::GetData</b> must choose from the OR'd values the medium that best represents the data, do the allocation, and indicate responsibility for releasing the medium.</p>
<p>
Data transferred across a stream extends from position zero of the stream pointer through to the position immediately before the current stream pointer (that is, the stream pointer position upon exit).</p>
<h5>Notes to Implementers</h5>
<p>
<b>IDataObject::GetData</b> must check all fields in the <a href="structs_14v7.htm"><b>FORMATETC</b></a> structure. It is important that <b>IDataObject::GetData</b> render the requested aspect and, if possible, use the requested medium. If the data object cannot comply with the information specified in the <b>FORMATETC</b>, the method should return DV_E_FORMATETC. If an attempt to allocate the medium fails, the method should return STG_E_MEDIUMFULL. It is important to fill in all of the fields in the <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> structure. </p>
<p>
Although the caller can specify more than one medium for returning the data, <b>IDataObject::GetData</b> can supply only one medium. If the initial transfer fails with the selected medium, this method can be implemented to try one of the other media specified before returning an error.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_7iat.htm"><b>IDataObject::GetDataHere</b></a>, <a href="if_a2e_438h.htm"><b>IDataObject::SetData</b></a>, <a href="structs_14v7.htm"><b>FORMATETC</b></a>, <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
