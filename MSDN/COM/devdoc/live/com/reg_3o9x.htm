<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActivateAtStorage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_activateatstorage"></a>ActivateAtStorage</h2>
<p>
Servers can install this named-value on client machines. When this value is not overridden by certain parameters passed to distributed COM activation API functions, the <b>ActivateAtStorage</b> named-value configures the client to instantiate objects on the same machine as the persistent state they are using or from which they are initialized. </p>
<h4>Registry Entry</h4>
<p>
<b>HKEY_LOCAL_MACHINE\SOFTWARE\Classes</b>\<b>APPID\<br>
</b>                                    <b>{</b><i>AppID_value</i><b>}\ActivateAtStorage</b> = <i>value</i></p>
<h4>Remarks</h4>
<p>
The <b>ActivateAtStorage</b> named-value can be set by the server to configure the client to instantiate its objects on the same machine as the persistent state used or from which the objects are initialized. The value is a REG_SZ; any value beginning with <b>Y</b> or <b>y</b> means that <b>ActivageAtStorage</b> should be used.</p>
<p>
When a value is set for <b>ActivateAtStorage</b>, this becomes the default behavior in calls to the <a href="api1_765h.htm"><b>CoGetInstanceFromFile</b></a> and <a href="api1_192d.htm"><b>CoGetInstanceFromIStorage</b></a> functions, as well as to the file moniker implementation of <a href="if_f2n_7o6s.htm"><b>IMoniker::BindToObject</b></a>.</p>
<p>
In all of these calls, specifying a <b>COSERVERINFO</b> structure overrides the setting of <b>ActivateAtStorage</b> for the duration of the function call. The caller can pass COSERVERINFO information to <b>IMoniker::BindToObject</b> through the <b>BIND_OPTS2</b> structure.</p>
<p>
The value set for <b>ActivateAtStorage</b> is also the default behavior when CLSCTX_REMOTE_SERVER is specified if no registry information for the class is installed on the client's machine. Client applications written to take advantage of <b>ActivateAtStorage</b> may therefore require less administration.</p>
<p>
The <b>ActivateAtStorage</b> capability provides a transparent way to allow clients to locate running objects on the same machine as the data that they use. This reduces network traffic, because the object performs local file-system calls instead of calls across the network.</p>
<h4>See Also</h4>
<p>
<a href="api1_765h.htm"><b>CoGetInstanceFromFile</b></a>, <a href="api1_192d.htm"><b>CoGetInstanceFromIStorage</b></a>, <a href="if_f2n_7o6s.htm"><b>IMoniker::BindToObject</b></a>, <a href="structs_34vj.htm"><b>COSERVERINFO</b></a> structure, <a href="enums_152w.htm"><b>CLSCTX</b></a>, <a href="comext_05pv.htm"><b>Registering COM Servers</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
