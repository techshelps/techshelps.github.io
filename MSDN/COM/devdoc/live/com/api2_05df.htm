<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetHGlobalFromILockBytes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_gethglobalfromilockbytes"></a>GetHGlobalFromILockBytes</h1>
<p>
Retrieves a global memory handle to a byte array object created using the <a href="api2_3rn0.htm"><b>CreateILockBytesOnHGlobal</b></a> function.</p>
<pre><code><b>WINOLEAPI GetHGlobalFromILockBytes(
  ILockBytes *</b><i> pLkbyt</i><b>,</b>   //Points to the byte array object
<b>  HGLOBAL *</b><i> phglobal     </i>//Points to the current memory handle for 
                         // the specified byte array
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pLkbyt</i></dt>
<dd>
[in] Points to the <b>ILockBytes</b> interface on the byte array object previously created by a call to the <a href="api2_3rn0.htm"><b>CreateILockBytesOnHGlobal</b></a> function.</dd>
<dt>
<i>phglobal</i></dt>
<dd>
[out] Points to the current memory handle used by the specified byte array object.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
Indicates the handle was returned successfully.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
Indicates invalid value specified for the <i>pLkbyt</i> parameter. It can also indicate that the byte array object passed in is not one created by the <a href="api2_3rn0.htm"><b>CreateILockBytesOnHGlobal</b></a> function.
</dd>
</dl>
<h4>Remarks</h4>
<p>
After a call to <a href="api2_3rn0.htm"><b>CreateILockBytesOnHGlobal</b></a>, which creates a byte array object on global memory, <b>GetHGlobalFromILockBytes </b>retrieves a pointer to the handle of the global memory underlying the byte array object. The handle this function returns might be different from the original handle due to intervening calls to the <b>GlobalRealloc</b> function.</p>
<p>
The contents of the returned memory handle can be written to a clean disk file, and then opened as a storage object using the <a href="api4_0hb9.htm"><b>StgOpenStorage</b></a> function.</p>
<p>
This function only works within the same process from which the byte array was created.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api4_0hb9.htm"><b>StgOpenStorage</b></a>, <a href="api2_3rn0.htm"><b>CreateILockBytesOnHGlobal</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
