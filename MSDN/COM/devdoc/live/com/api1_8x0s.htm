<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoGetStaticMarshal</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_cogetstaticmarshal"></a>CoGetStaticMarshal</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Creates a stub manager, also called a marshaler, aggregates the marshaler in a server object, and creates a map of interface pointer IDs (IPIDs) to interface IDs. </p>
<pre><code><b>WINOLEAPI CoGetStaticMarshal(
</b>  <b>IUnknown</b> *<i>pUnkControl</i><b>,</b>  //Server object
  <b>DWORD</b> <i>dwFlags</i><b>,</b>          //Reserved for future use
  <b>ULONG</b> <i>cItfs</i><b>,</b>            //Size of <i>arIIDs </i>and <i>arIPIDs</i>
  <b>IID</b> **<i>arIIDs</i><b>,</b>           //Array of IIDs
  <b>UUID</b> **<i>arIPIDs</i><b>,</b>         //Corresponding array of IPIDs
  <b>ULONG</b> <i>cBindings</i><b>,</b>        //Size of <i>pBindings</i>
  <b>LPUNKNOWN</b> *<i>pBindings</i><b>,</b>   //Array of COM binding objects
  <b>IUnknown</b> **<i>ppUnkInner</i>   //Marshaler
<b>);</b>
</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pUnkControl</i></dt>
<dd>
Pointer to the controlling <b>IUnknown</b> interface on the server object that aggregates the marshaler. </dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Reserved for future use; must be 0.</dd>
<dt>
<i>cItfs</i></dt>
<dd>
Number of elements in the <i>arIIDs</i> and <i>arIPIDs </i>arrays. </dd>
<dt>
<i>arIIDs</i></dt>
<dd>
Array of IDs of interfaces exposed on the server object. </dd>
<dt>
<i>arIPIDs</i></dt>
<dd>
Array of static IPIDs on the server object, which correspond to the IIDs in <i>arIIDs</i>. </dd>
<dt>
<i>cBindings</i></dt>
<dd>
Size of the <i>arBindings </i>array. </dd>
<dt>
<i>pBindings</i></dt>
<dd>
Array of COM binding objects, each of which describes an endpoint. </dd>
<dt>
<i>ppUnkInner</i></dt>
<dd>
Address of a pointer to the <a href="if_r2z_9dwu.htm"><b>IUnknown</b></a> interface on the marshaler. <a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a> calls for the <a href="if_f2n_6sh8.htm"><b>IMarshal</b></a> interface should be made through this pointer.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_FAIL, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The marshaler was created and the interfaces were mapped. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The server object calls <b>CoGetStaticMarshal</b> when it is created. <b>CoGetStaticMarshal</b> creates a stub manager and aggregates it into the server object. The server object is responsible for delegating <b>IMarshal</b> method calls to this stub manager. </p>
<p>
<b>CoGetStaticMarshal</b> also maps an array of static interface pointer IDs (IPIDs) to a corresponding array of interface IDs (IIDs). In this mapping, an IPID identifies a specific instance of the interface on the server that corresponds to the interface specified by the corresponding IID. </p>
<p>
Endpoints must be specified by passing an array of COM binding objects in the <i>pBindings </i>parameter. An endpoint on a process and an IPID identifying an interface pointer are sufficient to fully identify an object. Because static IPIDs do not change, the resulting proxy can marshal calls without requesting interface pointers from the server object, resulting in fewer network round trips and faster performance for each marshaled call. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_8fdz.htm"><b>IComBinding</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
