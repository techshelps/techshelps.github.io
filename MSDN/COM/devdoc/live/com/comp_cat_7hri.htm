<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Component Categories Manager Implementation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_component_categories_manager_implementation"></a>Component Categories Manager Implementation</h1>
<p>
As the number of available components grows, it becomes increasingly difficult to manage these components. Many components offer similar functionality, both in terms of the interfaces they expose as well as the tasks they perform.</p>
<p>
In many situations, it is necessary to enumerate the components that can be used in a certain context. Examples of this are the Insert Object dialog box used in OLE Compound Documents and the Insert Control dialog box used in OLE Controls. These dialog boxes list all components that fulfill (or claim to fulfill) the interface contracts for compound documents or controls. These existing categories (OLE Document, OLE Control) do not imply an exact interface signature. OLE Documents have to expose a certain set of core interfaces (for example, <b>IOleObject</b> or <b>IPersistStorage</b>), but can also expose additional interfaces such as <b>IOleLink</b>.</p>
<p>
In the past, components have been tagged by adding a human-readable name ("Insertable", "Control", and so on) as a sub-key to the HKEY_CLASSES_ROOT\CLSID\{...} key corresponding to the component. This works well for a central definition of categories, but runs the danger of name collisions when many independent parties define new categories. As in other areas of COM, the solution to providing an extensible name space lies in the use of globally unique identifiers (GUIDs). Instead of using a human-readable name, a unique number (CATID) is assigned to each category.</p>
<p>
Another limitation with the existing categorization is that it is limited to expressing the capabilities of the component itself. Many components require certain capabilities from the containers. When such a component is inserted into a container, the insertion can fail or behave unexpectedly, even though the component fulfills the contracts implied by one of its categories. To enumerate the components that can be used successfully in certain situations, both the capabilities of the component and the container must be considered.</p>
<p>
Because of these considerations, the following changes were made to the existing categorization:
<ul>
<li>
Categories are indicated by using CATIDs that are globally unique identifiers.</li>
<li>
Under the Components sub-key of the HKEY_CLASSES_ROOT\CLSID Registry key, two separate sub-keys, "Implemented Categories" and "Required Categories", were developed. These sub-keys contain the lists of CATIDs that are provided by the component or that the container of the component must provide.</li>
</ul>
<p>
To ease managing the component categories, categories are listed in a central place in the Registry: HKEY_CLASSES_ROOT\Component Categories. This key lists the installed categories with both their CATID and localized, human-readable names.</p>
<p>&nbsp;</p></body>
</HTML>
