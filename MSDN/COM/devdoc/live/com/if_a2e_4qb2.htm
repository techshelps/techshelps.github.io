<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IEnumSTATPROPSETSTG-Compound File Implementation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ienumstatpropsetstg_compound_file_implementation"></a>IEnumSTATPROPSETSTG-Compound File Implementation</h1>
<p>
The compound file implementation of <b>IEnumSTATPROPSETSTG</b> interface is used to enumerate through an array of <a href="structs_6u07.htm"><b>STATPROPSETSTG</b></a> structures, which contain statistical information about the properties managed by the compound file implementation of <b>IPropertySetStorage</b>, which is associated with a current compound file storage object. </p>
<h5>When to Use</h5>
<p>
Call the methods of <b>IEnumSTATPROPSETSTG</b> to enumerate STATPROPSETSTG structures, each of which provides information about one of the property sets associated with the compound file storage object.</p>
<h4>Remarks</h4>
<dl>
<dt>
<b>IEnumSTATPROPSETSTG::Next</b></dt>
</dl>
<p>
Gets the next one or more <a href="structs_6u07.htm"><b>STATPROPSETSTG</b></a> structures (the number is specified by the <i>celt</i> parameter). The <b>STATPROPSETSTG</b> elements provided through a call to the compound file implementation of <b>IEnumSTATPROPSETSTG::Next</b> follow these rules:
<ul>
<li>
If <b>IEnumSTATPROPSETSTG::Next</b> cannot provide STATPROPSETSTG.fmtid, zeros are written to that member. This occurs when the property set does not have a predefined name (such as \005SummaryInformation) and is not a legal value. </li>
<li>
The DocumentSummaryInformation property set is special, in that it may have two property set sections. This property set is described in the section titled <a href="propsets_1yr8.htm">The DocumentSummaryInformation Property Set</a>. The second section is referred to as the User-Defined Properties. Each section is identified with a unique Format ID. When <b>IPropertySetStorage::Enum</b> is used to enumerate property sets, the User-Defined Property Set will not be enumerated.</li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;If you always create a property set using <b>IPropertySetStorage::Create</b>, then, since a "Character GUID" is created for the storage name, <b>IEnumSTATPROPSETSTG::Next</b> will return a nonzero, valid format identifier for the property set[STATPROPSETSTG.fmtid].</p>
<ul>
<li>
The STATPROPSETSTG.grfFlags member does not necessarily reflect whether the property set is ANSI or not. If PROPSETFLAG_ANSI is set, the property set is definitely ANSI. If PROPSETFLAG_ANSI is clear, the property set could be either Unicode or non-Unicode, because it is not possible to tell whether it is ANSI without opening it.</li>
<li>
The STATPROPSETSTG.grfFlags member does reflect whether the property set is simple or not, so the setting of the PROPSETFLAG_NONSIMPLE flag is always valid.</li>
<li>
If <b>IEnumSTATPROPSETSTG::Next</b> cannot provide STATPROPSETSTG.clsid, it is set to all zeroes (CLSID_NULL). In the OLE compound file implementation, this occurs when the property set is simple (the PROPSETFLAG_NONSIMPLE flag is not set), or is non-simple but the CLSID was not explicitly set. For non-simple property sets, the CLSID that is received is the one that is maintained by the underlying <b>IStorage</b>.</li>
<li>
If <b>IEnumSTATPROPSETSTG::Next</b> cannot provide the time fields [<i>ctime</i>, <i>mtime</i>, <i>atime</i>], each non-supported time will be set to zeroes. In the OLE compound file implementation, getting these values depends on retrieving them from the underlying <b>IStorage</b> implementation.</li>
</ul>
<dl>
<dt>
<b>IEnumSTATPROPSETSTG::Skip</b></dt>
<dd>
Skips the number of elements specified in <i>celt</i>. Returns S_OK if the specified number of elements are skipped, returns S_FALSE if fewer elements than requested are skipped. In any other case, returns the appropriate error.</dd>
<dt>
<b>IEnumSTATPROPSETSTG::Reset</b></dt>
<dd>
Sets the cursor to the beginning of the enumeration. If successful, returns S_OK, otherwise, returns STG_E_INVALIDHANDLE.</dd>
<dt>
<b>IEnumSTATPROPSETSTG::Clone</b></dt>
<dd>
Copies the current enumeration state of this enumerator.
</dd>
</dl>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
