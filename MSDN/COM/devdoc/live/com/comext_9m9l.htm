<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Turning Off Activation Security</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_com_turning_off_activation_security"></a>Turning Off Activation Security</h3>
<p>
Normally, activation uses default security settings. However, you can control activation security by specifying a <a href="structs_56gf.htm"><b>COAUTHINFO</b></a> structure, which is a member of the <a href="structs_34vj.htm"><b>COSERVERINFO</b></a> structure that is passed to the activation functions. If the client specifies an authentication level of RPC_C_AUTHN_LEVEL_NONE in the <b>COAUTHINFO</b> structure, authentication is not attempted. Otherwise, secure activation is attempted, and if authentication fails, activation fails.</p>
<p>
If the client does not specify an explicit <b>COAUTHINFO </b>structure and instead sets the pointer to NULL, COM will attempt to authenticate the client. If it cannot authenticate the client, COM checks the launch permission security descriptor to see if there is a NULL DACL or an ACL that allows access to Everyone. If this check succeeds, the server is launched. So, even if the client does not specify a <b>COAUTHINFO </b>structure, unsecure activation may take place when the server allows it.</p>
<p>
Why would a client want to turn activation security off explicitly even though unsecure activation will eventually take place if the server allows it? Explicitly turning activation security off increases performance when the client does not want or need security checks. </p>
<p>
Both of the following things must be done to explicitly turn off activation security: 
<ul>
<li>
The client must specify an authentication level of RPC_C_AUTHN_LEVEL_NONE in the <b>COAUTHINFO</b> structure that is a member of the <b>COSERVERINFO</b> structure supplied to the activation function. </li>
<li>
The server must specify <b>Everyone</b> for <b>Default Launch Permissions</b>. The recommended way to perform this task is to use Dcomcnfg.exe as follows:<ol>
<li>
Run Dcomcnfg.exe.</li>
<li>
On the <b>Applications</b> page, select the application that represents the server. Click the <b>Properties</b> button (or double-click the selected application).</li>
<li>
On the <b>Security</b> property page, select the <b>Use Custom Launch Permissions</b> button.</li>
<li>
Click the <b>Edit</b> button in the <b>Launch Permissions</b> area.</li>
<li>
In the <b>Registry Value Permissions</b> dialog box, choose the <b>Add</b> button.</li>
<li>
Select the entry for <b>Everyone</b> in the list box.</li>
<li>
In the <b>Type of Access</b> list box, choose <b>Allow Launch</b>.</li>
<li>
Click the <b>OK</b> button.</li>
</ol>
</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
