<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistStream</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ipersiststream"></a>IPersistStream</h1>
<p>
The <b>IPersistStream</b> interface provides methods for saving and loading objects that use a simple serial stream for their storage needs. The <b>IPersistStream</b> interface inherits its definition from the <a href="if_p2q_3lbo.htm"><b>IPersist</b></a> interface, and so the includes the <b>GetClassID</b> method of <b>IPersist</b>.</p>
<p>
One way in which it is used is to support OLE moniker implementations. Each of the OLE-provided moniker interfaces provides an <b>IPersistStream</b> implementation through which the moniker saves or loads itself. An instance of the OLE generic composite moniker class calls the <b>IPersistStream</b> methods of its component monikers to load or save the components in the proper sequence in a single stream.</p>
<p>
OLE containers with embedded and linked component objects do not use this interface; they use the <a href="if_p2q_8crp.htm"><b>IPersistStorage</b></a> interface instead.</p>
<h5>When to Implement</h5>
<p>
Implement the <b>IPersistStream</b> interface on objects that are to be saved to a simple stream. Some objects of this type are monikers and some OLE controls, although generally, controls use the <a href="if_p2q_64dw.htm"><b>IPersistStreamInit</b></a> interface, which has the same methods as IPersistStream, with one added method, <a href="if_p2q_19vb.htm"><b>IPersistStreamInit::InitNew</b></a>. The <a href="if_f2n_8otu.htm"><b>IMoniker</b></a> interface is derived from the <b>IPersistStream</b> interface, so you must implement the <b>IPersistStream</b> interface if you are implementing a new moniker class.</p>
<h5>When to Use</h5>
<p>
Call methods of <b>IPersistStream</b> from a container application to save or load objects that are contained in a simple stream. When used to save or load monikers, typical applications do not call the methods directly, but allow the default link handler to make the calls to save and load the monikers that identify the link source. These monikers are stored in a stream in the storage for the linked object. If you are writing a custom link handler for your class of objects, you would call the methods of <b>IPersistStream</b> to implement the link handler.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%><a href="if_r2z_9dwu.htm">IUnknown</a> Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=52%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=52%>Increments the reference count.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=52%>Decrements the reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%><a href="if_p2q_3lbo.htm">IPersist</a> Method</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_1yn8.htm"><b>GetClassID</b></a></td>
<td width=52%>Returns the class identifier (CLSID) for the component object.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>IPersistStream Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_8lmh.htm"><b>IsDirty</b></a></td>
<td width=52%>Checks the object for changes since it was last saved.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_54f8.htm"><b>Load</b></a></td>
<td width=52%>Initializes an object from the stream where it was previously saved.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_3945.htm"><b>Save</b></a></td>
<td width=52%>Saves an object into the specified stream and indicates whether the object should reset its dirty flag.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_9xko.htm"><b>GetSizeMax</b></a></td>
<td width=52%>Return the size in bytes of the stream needed to save the object.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_8otu.htm"><b>IMoniker</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
