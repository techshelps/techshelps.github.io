<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistStorage::Load</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipersiststorage_load"></a>IPersistStorage::Load</h2>
<p>
Loads an object from its existing storage.</p>
<pre><code><b>HRESULT Load(
  IStorage</b><i> *pStg  </i>//Pointer to existing storage for the object
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>pStg</i></dt>
<dd>
[in] <b>IStorage</b> pointer to the existing storage from which the object is to be loaded. 
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The object was successfully loaded.</dd>
<dt>
CO_E_ALREADYINITIALIZED</dt>
<dd>
The object has already been initialized by a previous call to the <b>IPersistStorage::Load</b> method or the <a href="if_p2q_7hyv.htm"><b>IPersistStorage::InitNew</b></a> method.</dd>
<dt>
E_OUTOFMEMORY</dt>
<dd>
The object was not loaded due to lack of memory.</dd>
<dt>
E_FAIL</dt>
<dd>
The object was not loaded due to some reason besides a lack of memory.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method initializes an object from an existing storage. The object is placed in the loaded state if this method is called by the container application. If called by the default handler, this method places the object in the running state.</p>
<p>
Either the default handler or the object itself can hold onto the <a href="if_r2z_9b8l.htm"><b>IStorage</b></a> pointer while the object is loaded or running.</p>
<h5>Notes to Callers</h5>
<p>
Rather than calling <b>IPersistStorage::Load</b> directly, you typically call the <a href="api3_1cmc.htm"><b>OleLoad</b></a> helper function which does the following:
<ol>
<li>
Create an uninitialized instance of the object class</li>
<li>
Query the new instance for the <a href="if_p2q_8crp.htm"><b>IPersistStorage</b></a> interface</li>
<li>
Call <b>IPersistStorage::Load</b> to initialize the object from the existing storage</li>
</ol>
<p>
You also call this method indirectly when you call the <a href="api3_1h0h.htm"><b>OleCreateFromData</b></a> function or the <a href="api3_3eg5.htm"><b>OleCreateFromFile</b></a> function to insert an object into a compound file (as in a drag-and-drop or clipboard paste operation).</p>
<p>
The container should cache the <b>IPersistStorage</b> pointer for use in later operations on the object.</p>
<h5>Notes to Implementers</h5>
<p>
Your implementation should perform the following steps to load an object: 
<ol>
<li>
Open the object's streams in the storage object, and read the necessary data into the object's internal data structures.</li>
<li>
Clear the object's dirty flag.</li>
<li>
Call the <b>IPersistStorage::AddRef</b> method and cache the passed in storage pointer.</li>
<li>
Keep open and cache the pointers to any streams or storages that the object will need to save itself to this storage.</li>
<li>
Perform any other default initialization required for the object.</li>
</ol>
<p>
Steps 3 and 4 are particularly important for ensuring that the object can save itself in low memory situations. Holding onto pointers to the storage and stream interfaces guarantees that a save operation to this storage will not fail due to insufficient memory.</p>
<p>
Your implementation of this method should return the CO_E_ALREADYINITIALIZED error code if it receives a call to either the <a href="if_p2q_7hyv.htm"><b>IPersistStorage::InitNew</b></a> method or the <b>IPersistStorage::Load</b> method after it is already initialized.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="api2_8quf.htm"><b>GetConvertStg</b></a>, <a href="if_p2q_7hyv.htm"><b>IPersistStorage::InitNew</b></a>, <a href="api3_1cmc.htm"><b>OleLoad</b></a>, <a href="api3_1tuv.htm"><b>ReadFmtUserTypeStg</b></a>, <a href="api4_3i3r.htm"><b>SetConvertStg</b></a>, <a href="api4_4kx3.htm"><b>WriteFmtUserTypeStg</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
