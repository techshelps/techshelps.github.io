<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Compound File Optimization</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_compound_file_optimization"></a>Compound File Optimization</h1>
<p>
Asynchronous storage enables applications to precisely lay out their compound files so that data is available in the order in which applications will need it. If an application requires only part of its data to display a first page of information, this data can be placed at the beginning of the file, even if it logically resides at the end of a stream. Data from different streams can be interleaved. Audio and video data, for example, can be interleaved so that subsequent read operations retrieve both simultaneously, a requirement for multimedia applications.</p>
<p>
New applications can optimize their compound files programmatically by calling the <a href="api4_82n9.htm"><b>StgOpenLayoutDocfile</b></a> API function. This function calls the <a href="if_f2n_47fp.htm"><b>ILayoutStorage</b></a> interface, which is implemented by the root storage of the new compound files implementation. <b>ILayoutStorage</b> has member functions for scripting the layout of data, monitoring downloads to determine the order in which data is accessed, and rewriting the compound file to match the layout specified by scripting or determined by monitoring. The call to rewrite a file must occur before releasing the last pointer to the root storage of the file. Otherwise, the file will not be altered.</p>
<p>
Legacy applications can optimize their compound files by using the Docfile Layout Tool (<i>dflayout.exe</i>) included in the Win32 SDK. This capability, combined with a blocking storage enable legacy applications to progressively download and render their data.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
