<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleLoad</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleload"></a>OleLoad</h1>
<p>
Loads into memory an object nested within a specified storage object.</p>
<pre><code><b>WINOLEAPI OleLoad(
  IStorage *</b><i> pStg</i><b>,</b>   //Pointer to the storage object from which to 
                     // load
<b>  REFIID</b><i> riid</i><b>,</b>       //Reference to the identifier of the interface
<b>  IOleClientSite *</b><i> pClientSite</i><b>,</b> 
                     //Pointer to the client site for the object
<b>  LPVOID *</b><i> ppvObj    </i>//Address of output variable that receives the 
                     // interface pointer requested in <i>riid</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pStg</i></dt>
<dd>
[in] Pointer to the <b>IStorage</b> interface on the storage object from which to load the specified object.</dd>
<dt>
<i>riid</i></dt>
<dd>
[in] Reference to the identifier of the interface that the caller wants to use to communicate with the object once it is loaded.</dd>
<dt>
<i>pClientSite</i></dt>
<dd>
[in] Pointer to the <b>IOleClientSite</b> interface on the client site object being loaded.</dd>
<dt>
<i>ppvObj</i></dt>
<dd>
[out] Address of pointer variable that receives the interface pointer requested in <i>riid</i>. Upon successful return, *<i>ppvObj</i> contains the requested interface pointer on the newly loaded object.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return value E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK </dt>
<dd>
The object was loaded successfully.</dd>
<dt>
E_NOINTERFACE</dt>
<dd>
The object does not support the specified interface.
</dd>
</dl>
<p>
This function can return any of the error values returned by the <a href="if_p2q_34pw.htm"><b>IPersistStorage::Load</b></a> method.</p>
<h4>Remarks</h4>
<p>
OLE containers load objects into memory by calling this function. When calling the <b>OleLoad</b> function, the container application passes in a pointer to the open storage object in which the nested object is stored. Typically, the nested object to be loaded is a child storage object to the container's root storage object. Using the OLE information stored with the object, the object handler (usually, the default handler) attempts to load the object. On completion of the <b>OleLoad</b> function, the object is said to be in the loaded state with its object application not running.</p>
<p>
Some applications load all of the object's native data. Containers often defer loading the contained objects until required to do so. For example, until an object is scrolled into view and needs to be drawn, it does not need to be loaded.</p>
<p>
The <b>OleLoad</b> function performs the following steps:
<ol>
<li>
If necessary, performs an automatic conversion of the object (see the <a href="api3_8ad0.htm"><b>OleDoAutoConvert</b></a> function).</li>
<li>
Gets the CLSID from the open storage object by calling the <a href="if_r2z_3ook.htm"><b>IStorage::Stat</b></a> method.</li>
<li>
Calls the <a href="api1_1nad.htm"><b>CoCreateInstance</b></a> function to create an instance of the handler. If the handler code is not available, the default handler is used (see the <a href="api3_22sy.htm"><b>OleCreateDefaultHandler</b></a> function).</li>
<li>
Calls the <b>IOleObject::SetClientSite</b> method with the <i>pClientSite</i> parameter to inform the object of its client site.</li>
<li>
Calls the <b>QueryInterface</b> method for the <a href="if_p2q_8crp.htm"><b>IPersistStorage</b></a> interface. If successful, the <a href="if_p2q_34pw.htm"><b>IPersistStorage::Load</b></a> method is invoked for the object.</li>
<li>
Queries and returns the interface identified by the <i>riid</i> parameter.</li>
</ol>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_5iw7.htm"><b>ReadClassStg</b></a>,<b> <a href="if_a2e_5k11.htm">IClassFactory::CreateInstance</a></b>,<b> <a href="if_p2q_34pw.htm">IPersistStorage::Load</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
