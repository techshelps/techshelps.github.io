<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Asynchronous Compound Files</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_asynchronous_compound_files"></a>Asynchronous Compound Files</h1>
<p>
Asynchronous Compound Files, the system-provided implementation of asynchronous storage enables the efficient downloading of compound files from the Internet in general and the Web in particular. The basic architecture of Asynchronous Compound Files is shown in the following diagram.</p>
<p>
<img src="images/asy_stor.gif" border=0></p>
<p>
The Asynchronous Compound Files implementation can work with new asynchronous moniker types that understand Internet protocols and can bind to an object identified by a Universal Resource Locator (URL). Such a moniker would return an asynchronous <a href="if_r2z_4x7x.htm"><b>IStream</b></a> or <a href="if_r2z_9b8l.htm"><b>IStorage</b></a> pointer from the client's call to <a href="if_f2n_1kx1.htm"><b>IMoniker::BindToStorage</b></a>.</p>
<p>
Compound Files in general are implemented on top of a byte array object, an abstraction of a file that represents an object's data as a flat byte array. The byte array object exposes its functionality through the <a href="if_f2n_9q9f.htm"><b>ILockBytes</b></a> interface. If a byte array supports nonblocking asynchronous storage, it returns E_PENDING to the compound-file implementation, which in turn propagates the error back to the caller.</p>
<p>
To keep track of the data available during a download, a byte array that supports asynchronous storage exposes the <a href="if_f2n_5xdf.htm"><b>IFillLockBytes</b></a> interface on a wrapper object provided by the system specifically for this purpose. The downloading code provided by an asynchronous moniker calls this interface to fill the byte array asynchronously, as data is available. The wrapper object also exposes an <b>ILockBytes</b> interface, which the Asynchronous Compound Files implementation uses to read and write data from and to the array.</p>
<p>
Asynchronous storage and stream objects provide a connection point for the <a href="if_p2q_1b7d.htm"><b>IProgressNotify</b></a> interface, which is implemented by the asynchronous moniker's downloading code. The Asynchronous Compound Files implementation calls <b>IProgressNotify</b> to provide the downloader with information about the status of the downloading operation.</p>
<p>&nbsp;</p></body>
</HTML>
