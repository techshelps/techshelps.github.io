<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The COM Library</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_the_com_library"></a>The COM Library</h1>
<p>
Any process that uses COM must both initialize and uninitialize the COM library. In addition to being a specification, COM also implements some important services in this library. Provided as a set of DLLs and EXEs (primarily OLE32.DLL and RPCSS.EXE) in Microsoft® Windows®, the COM library includes:
<ul>
<li>
A small number of fundamental API functions that facilitate the creation of COM applications, both client and server. For clients, COM supplies basic functions for creating objects. For servers, COM supplies the means of exposing their objects.</li>
<li>
Implementation-locator services through which COM determines from a unique class identifier (CLSID) which server implements that class and where that server is located. This service includes support for a level of indirection, usually a system registry, between the identity of an object class and the packaging of the implementation such that clients are independent of the packaging, which can change in the future.</li>
<li>
Transparent remote procedure calls when an object is running in a local or remote server.</li>
<li>
A standard mechanism to allow an application to control how memory is allocated within its process, particularly memory that needs to be passed between cooperating objects such that it can be freed properly.</li>
</ul>
<p>
To use basic COM services, all COM threads of execution in clients and out-of-process servers must call either the <a href="api1_36qt.htm"><b>CoInitialize</b></a> or the <a href="api1_5iyg.htm"><b>CoInitializeEx</b></a> function before calling any other COM function except memory allocation calls. <b>CoInitializeEx</b> replaces the other function, adding a parameter that allows you to specify the threading model of the thread — either apartment-threaded or free-threaded. A call to <b>CoInitialize</b> simply sets the threading model to apartment-threaded. OLE Compound Document applications call the <a href="api3_6med.htm"><b>OleInitialize</b></a> function, which calls <b>CoInitializeEx</b> and also does some initialization required for compound documents. Since this is true, threads that call <b>OleInitialize</b> cannot be free-threaded. For information on threading in clients and servers, refer to <a href="com_98mr.htm"><b>Processes and Threads</b></a>.</p>
<p>
In-process servers do not call the initialization functions, because they are being loaded into a process that has already done so. As a result, in-process servers must set their threading model in the registry under the <a href="reg_5n8y.htm"><b>InprocServer32</b></a> key. For detailed information on threading issues in in-process servers, refer to <a href="com_1ik3.htm"><b>In-Process Server Threading Issues</b></a>.</p>
<p>
It is also important to uninitialize the library. For each call to <b>CoInitialize</b> or <b>CoInitializeEx</b>, there must be a corresponding call to <a href="api1_7vqd.htm"><b>CoUninitialize</b></a>. For each call to <b>OleInitialize</b>, there must be a corresponding call to <a href="api3_6ztx.htm"><b>OleUninitialize</b></a>. </p>
<p>
In-process servers can assume that the process they are being loaded into has already performed these steps.</p>
<p>&nbsp;</p></body>
</HTML>
