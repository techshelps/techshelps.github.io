<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistFile::GetCurFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipersistfile_getcurfile"></a>IPersistFile::GetCurFile</h2>
<p>
Retrieves either the absolute path to the object's current working file or, if there is no current working file, the object's default filename prompt.</p>
<pre><code><b>HRESULT GetCurFile(
  LPOLESTR</b><i> *ppszFileName  </i>//Pointer to the path for the current file 
                          //or the default save prompt
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>ppszFileName</i></dt>
<dd>
[out]Points to the location of a pointer to a zero-terminated string containing the path for the current file or the default filename prompt (such as <i>*.txt</i>). If an error occurs, <i>ppszFileName</i> is set to NULL.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
A valid absolute path was successfully returned.</dd>
<dt>
S_FALSE </dt>
<dd>
The default save prompt was returned.</dd>
<dt>
E_OUTOFMEMORY </dt>
<dd>
The operation failed due to insufficient memory.</dd>
<dt>
E_FAIL</dt>
<dd>
The operation failed due to some reason other than insufficient memory.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method returns the current filename or the default save prompt for the object.</p>
<p>
This method allocates memory for the string returned in the <i>ppszFileName</i> parameter using the <a href="if_f2n_3twj.htm"><b>IMalloc::Alloc</b></a> method. The caller is responsible for calling the <a href="if_f2n_1smd.htm"><b>IMalloc::Free</b></a> method to free the string. Both the caller and this method use the OLE task allocator provided by a call to <a href="api1_2qlf.htm"><b>CoGetMalloc</b></a>.</p>
<p>
The <b>LPOLESTR</b> type indicates a wide character string (two bytes per character); otherwise, the string has one byte per character.</p>
<p>
The filename returned in <i>ppszFileName</i> is the name specified in a call to <a href="if_p2q_0p7o.htm"><b>IPersistFile::Load</b></a> when the document was loaded; or in <a href="if_p2q_2dno.htm"><b>IPersistFile::SaveCompleted</b></a> if the document was saved to a different file.</p>
<p>
If the object does not have a current working file, it should supply the default filename prompt that it would display in a "Save As" dialog. For example, the default save prompt for a word processor object could be:</p>
<p>
*.txt</p>
<h5>Notes to Callers</h5>
<p>
OLE does not call the <b>IPersistFile::GetCurFile</b> method. Applications would not call this method unless they are also calling the save methods of this interface.</p>
<p>
In saving the object, you can call this method before calling <b>IPersistFile:Save</b> to determine whether the object has an associated file. If this method returns S_OK, you can then call <a href="if_p2q_8twl.htm"><b>IPersistFile::Save</b></a> with a NULL filename and a TRUE value for the <i>fRemember</i> parameter to tell the object to save itself to its current file. If this method returns S_FALSE, you can use the save prompt returned in the <i>ppszFileName</i> parameter to ask the end user to provide a filename. Then, you can call <b>IPersistFile::Save</b> with the filename that the user entered to perform a "Save As" operation.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_p2q_0p7o.htm"><b>IPersistFile::Load</b></a>, <a href="if_p2q_8twl.htm"><b>IPersistFile::Save</b></a>, <a href="if_p2q_2dno.htm"><b>IPersistFile::SaveCompleted</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
