<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistStorage::HandsOffStorage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipersiststorage_handsoffstorage"></a>IPersistStorage::HandsOffStorage</h2>
<p>
Instructs the object to release all storage objects that have been passed to it by its container and to enter HandsOff mode, in which the object cannot do anything and the only operation that works is a close operation.</p>
<pre><b><code>HRESULT HandsOffStorage(<i>void</i>);
 </code></b></pre>
<h4>Return Value</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The object has successfully entered HandsOff mode.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method causes an object to release any storage objects that it is holding and to enter the HandsOff mode until a subsequent <a href="if_p2q_115w.htm"><b>IPersistStorage::SaveCompleted</b></a> call. In HandsOff mode, the object cannot do anything and the only operation that works is a close operation.</p>
<p>
A container application typically calls this method during a full save or low-memory full save operation to force the object to release all pointers to its current storage. In these scenarios, the <b>HandsOffStorage</b> call comes after a call to either <a href="api3_9hb9.htm"><b>OleSave</b></a> or <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a>, putting the object in HandsOffAfterSave mode. Calling this method is necessary so the container application can delete the current file as part of a full save, or so it can call the <a href="if_r2z_2ztx.htm"><b>IRootStorage::SwitchToFile</b></a> method as part of a low-memory save.</p>
<p>
A container application also calls this method when an object is in Normal mode to put the object in HandsOffFromNormal mode.</p>
<p>
While the component object is in either HandsOffAfterSave or HandsOffFromNormal mode, most operations on the object will fail. Thus, the container should restore the object to Normal mode as soon as possible. The container application does this by calling the <b>IPersistStorage::SaveCompleted</b> method, which passes a storage pointer back to the component object for the new storage object.</p>
<h5>Notes to Implementers</h5>
<p>
This method must release all pointers to the current storage object, including pointers to any nested streams and storages. If the object contains nested objects, the container application must recursively call this method for any nested objects that are loaded or running.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="api3_9hb9.htm"><b>OleSave</b></a>, <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a>, <a href="if_p2q_115w.htm"><b>IPersistStorage::SaveCompleted</b></a>, <a href="if_r2z_2ztx.htm"><b>IRootStorage::SwitchToFile</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
