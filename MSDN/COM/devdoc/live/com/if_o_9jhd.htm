<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleObject::GetClipboardData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleobject_getclipboarddata"></a>IOleObject::GetClipboardData</h2>
<p>
Retrieves a data object containing the current contents of the embedded object on which this method is called. Using the pointer to this data object, it is possible to create a new embedded object with the same data as the original.</p>
<pre><code><b>HRESULT GetClipboardData(
  DWORD</b><i> dwReserved</i><b>,  </b>//Reserved
<b>  IDataObject</b><i> **ppDataObject</i>
<i>                     </i>//Address of output variable that receives the 
                     // IDataObject interface pointer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwReserved</i></dt>
<dd>
[in] Reserved for future use; must be zero.</dd>
<dt>
<i>ppDataObject</i></dt>
<dd>
[out] Address of <b>IDataObject</b>* pointer variable that receives the interface pointer to the data object. If an error occurs, *<i>ppDataObject</i> must be set to NULL. Each time an object receives a call to <b>GetClipboardData</b>, it must increase the reference count on *<i>ppDataObject</i>. It is the caller's responsibility to call <b>Release</b> when it is done with *<i>ppDataObject</i>.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The data transfer object is successfully returned.</dd>
<dt>
E_NOTIMPL</dt>
<dd>
<b>GetClipboardData</b> is not supported.</dd>
<dt>
OLE_E_NOTRUNNING</dt>
<dd>
The object is not running.
</dd>
</dl>
<h4>Remarks</h4>
<p>
You can use the <b>GetClipboardData</b> method to convert a linked object to an embedded object, in which case the container application would call <b>IOleObject::GetClipboardData</b> and then pass the data received to <a href="api3_1h0h.htm"><b>OleCreateFromData</b></a>. This method returns a pointer to a data object that is identical to what would have been passed to the Clipboard by a standard copy operation.</p>
<h5>Notes to Callers</h5>
<p>
If you want a stable snapshot of the current contents of an embedded object, call <b>IOleObject::GetClipboardData</b>. Should the data change, you will need to call the function again for an updated snapshot. If you want the caller to be informed of changes that occur to the data, call <b>IDataObject::QueryInterface</b>, then call <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a>.</p>
<h5>Notes to Implementers</h5>
<p>
If you implement this function, you must return an <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> pointer for an object whose data will not change.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_24z8.htm"><b>IDataObject</b></a>, <a href="if_o_3o4h.htm"><b>IOleObject::InitFromData</b></a>, <a href="if_r2z_7fvp.htm"><b>IUnknown::QueryInterface</b></a>, <a href="api3_1h0h.htm"><b>OleCreateFromData</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
