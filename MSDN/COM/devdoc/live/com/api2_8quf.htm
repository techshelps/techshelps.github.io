<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetConvertStg</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_getconvertstg"></a>GetConvertStg</h1>
<p>
Returns the current value of the convert bit for the specified storage object.</p>
<pre><code><b>WINOLEAPI GetConvertStg(
  IStorage *</b><i> pStg  </i>//Points to the IStorage interface on the storage 
                   // object
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>pStg</i></dt>
<dd>
[in] <b>IStorage</b> pointer to the storage object from which the convert bit is to be retrieved.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Indicates the convert bit is set to TRUE.</dd>
<dt>
S_FALSE</dt>
<dd>
Indicates the convert bit is cleared (FALSE).</dd>
<dt>
STG_E_ACCESSDENIED</dt>
<dd>
Access denied because the caller has insufficient permission, or another caller has the file open and locked.</dd>
<dt>
STG_E_LOCKVIOLATION</dt>
<dd>
Access denied because another caller has the file open and locked.
</dd>
</dl>
<p>
<a href="if_r2z_7x65.htm"><b>IStorage::OpenStream</b></a>, <a href="if_r2z_182t.htm"><b>IStorage::OpenStorage</b></a>, and <a href="if_r2z_14mc.htm"><b>ISequentialStream::Read</b></a> storage and stream access errors.</p>
<h4>Remarks</h4>
<p>
The <b>GetConvertStg</b> function is called by object servers that support the conversion of an object from one format to another. The server must be able to read the storage object using the format of its previous CLSID and write the object using the format of its new CLSID to support the object's conversion. For example, a spreadsheet created by one application can be converted to the format used by a different application.</p>
<p>
The convert bit is set by a call to the <a href="api4_3i3r.htm"><b>SetConvertStg</b></a> function. A container application can call this function on the request of an end user, or a setup program can call it when installing a new version of an application. An end user requests converting an object through the Convert To dialog box. When an object is converted, the new CLSID is permanently assigned to the object, so the object is subsequently associated with the new CLSID.</p>
<p>
Then, when the object is activated, its server calls the <b>GetConvertStg</b> function to retrieve the value of the convert bit from the storage object. If the bit is set, the object's CLSID has been changed, and the server must read the old format and write the new format for the storage object.</p>
<p>
After retrieving the bit value, the object application should clear the convert bit by calling the <b>SetConvertStg</b> function with its <i>fConvert</i> parameter set to FALSE.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api4_3i3r.htm"><b>SetConvertStg</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
