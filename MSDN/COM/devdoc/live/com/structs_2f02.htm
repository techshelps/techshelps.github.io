<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLEUIINSERTOBJECT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleuiinsertobject_str"></a>OLEUIINSERTOBJECT</h1>
<p>
The OLEUIINSERTOBJECT structure contains information that the OLE User Interface Library uses to initialize the Insert Object dialog box, and space for the library to return information when the dialog box is dismissed.</p>
<pre><code>typedef struct tagOLEUIINSERTOBJECT 
{ 
// These IN fields are standard across all OLEUI dialog box functions. 
    DWORD          cbStruct; 
    DWORD          dwFlags; 
    HWND           hWndOwner; 
    LPCSTR         lpszCaption; 
    LPFNOLEUIHOOK  lpfnHook; 
    LPARAM         lCustData; 
    HINSTANCE      hInstance; 
    LPCSTR         lpszTemplate; 
    HRSRC          hResource; 
    CLSID          clsid; 
 
// Specifics for OLEUIINSERTOBJECT. 
    LPTSTR         lpszFile; 
    UINT           cchFile; 
    UINT           cClsidExclude; 
    LPCLSID        lpClsidExclude; 
    IID            iid; 
 
// Specific to create objects if flags say so 
    DWORD            oleRender; 
    LPFORMATETC      lpFormatEtc; 
    LPOLECLIENTSITE  lpIOleClientSite; 
    LPSTORAGE        lpIStorage; 
    LPVOID FAR *     ppvObj; 
    SCODE            sc; 
    HGLOBAL          hMetaPict; 
} OLEUIINSERTOBJECT, *POLEUIINSERTOBJECT, FAR *LPOLEUIINSERTOBJECT; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbStruct</b></dt>
<dd>
Size of the structure in bytes. This field must be filled on input.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
On input, specifies the initialization and creation flags. On exit, specifies the user's choices. It can be a combination of the following flags:
<dl>
<dt>
IOF_SHOWHELP</dt>
<dd>
The dialog box will display a Help button.</dd>
<dt>
IOF_SELECTCREATENEW</dt>
<dd>
The Create New radio button will initially be checked. This cannot be used with IOF_SELECTCREATEFROMFILE.</dd>
<dt>
IOF_SELECTCREATEFROMFILE</dt>
<dd>
The Create From File radio button will initially be checked. This cannot be used with IOF_SELECTCREATENEW.</dd>
<dt>
IOF_CHECKLINK</dt>
<dd>
The Link check box will initially be checked.</dd>
<dt>
IOF_CHECKDISPLAYASICON</dt>
<dd>
The Display As Icon check box will initially be checked, the current icon will be displayed, and the Change Icon button will be enabled.</dd>
<dt>
IOF_CREATENEWOBJECT</dt>
<dd>
A new object should be created when the user selects OK to dismiss the dialog box and the Create New radio button was selected.</dd>
<dt>
IOF_CREATEFILEOBJECT</dt>
<dd>
A new object should be created from the specified file when the user selects OK to dismiss the dialog box and the Create From File radio button was selected.</dd>
<dt>
IOF_CREATELINKOBJECT</dt>
<dd>
A new linked object should be created when the user selects OK to dismiss the dialog box and the user checked the Link check box.</dd>
<dt>
IOF_DISABLELINK</dt>
<dd>
The Link check box will be disabled on initialization.</dd>
<dt>
IOF_VERIFYSERVERSEXIST</dt>
<dd>
The dialog box should validate the classes it adds to the listbox by ensuring that the server specified in the registration database exists. This is a significant performance factor.</dd>
<dt>
IOF_DISABLEDISPLAYASICON</dt>
<dd>
The Display As Icon check box will be disabled on initialization.</dd>
<dt>
IOF_HIDECHANGEICON</dt>
<dd>
The Change Icon button will be hidden in the Insert Object dialog box. </dd>
<dt>
IOF_SHOWINSERTCONTROL</dt>
<dd>
Displays the Insert Control radio button. </dd>
<dt>
IOF_SELECTCREATECONTROL</dt>
<dd>
Displays the Create Control radio button.</dd>
</dl>
</dd>
<dt>
<b>hWndOwner</b></dt>
<dd>
Window that owns the dialog box. It should not be NULL.</dd>
<dt>
<b>lpszCaption</b></dt>
<dd>
Pointer to a string to be used as the title of the dialog box. If NULL, then the library uses Insert Object.</dd>
<dt>
<b>lpfnHook</b></dt>
<dd>
Pointer to a hook function that processes messages intended for the dialog box. The hook function must return zero to pass a message that it didn't process back to the dialog box procedure in the library. The hook function must return a non-zero value to prevent the library's dialog box procedure from processing a message it has already processed. </dd>
<dt>
<b>lCustData</b></dt>
<dd>
Application-defined data that the library passes to the hook function pointed to by the <b>lpfnHook</b> member. The library passes a pointer to the OLEUIINSERTOBJECT structure in the <i>lParam</i> parameter of the WM_INITDIALOG message; this pointer can be used to retrieve the <b>lCustData</b> member. </dd>
<dt>
<b>hInstance</b></dt>
<dd>
Instance that contains a dialog box template specified by the <i>lpTemplateName</i> member. </dd>
<dt>
<b>lpszTemplate</b></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the resource file for the dialog box template that is to be substituted for the library's Insert Object dialog box template. </dd>
<dt>
<b>hResource</b></dt>
<dd>
Customized template handle.</dd>
<dt>
<b>clsid</b></dt>
<dd>
CLSID for class of the object to be inserted. Filled on output.</dd>
<dt>
<b>lpszFile</b></dt>
<dd>
Pointer to the name of the file to be linked or embedded. Filled on output.</dd>
<dt>
<b>cchFile</b></dt>
<dd>
Size of <b>lpszFile</b> buffer; will not exceed OLEUI_CCHPATHMAX.</dd>
<dt>
<b>cClsidExclude</b></dt>
<dd>
Number of CLSIDs included in the <b>lpClsidExclude</b> list. Filled on input.</dd>
<dt>
<b>lpClsidExclude</b></dt>
<dd>
Pointer to a list of CLSIDs to exclude from listing.</dd>
<dt>
<b>iid</b></dt>
<dd>
Identifier of the requested interface. If <a href="api3_5juc.htm"><b>OleUIInsertObject</b></a> creates the object, then it will return a pointer to this interface. This parameter is ignored if <b>OleUIInsertObject</b> does not create the object.</dd>
<dt>
<b>oleRender</b></dt>
<dd>
Rendering option. If <b>OleUIInsertObject</b> creates the object, then it selects the rendering option when it creates the object. This parameter is ignored if <b>OleUIInsertObject</b> does not create the object.</dd>
<dt>
<b>lpFormatEtc</b></dt>
<dd>
Desired format. If <a href="api3_5juc.htm"><b>OleUIInsertObject</b></a> creates the object, then it selects the format when it creates the object. This parameter is ignored if <b>OleUIInsertObject</b> does not create the object.</dd>
<dt>
<b>lpIOleClientSite</b></dt>
<dd>
Pointer to the client site to be used for the object. This parameter is ignored if <b>OleUIInsertObject</b> does not create the object.</dd>
<dt>
<b>lpIStorage</b></dt>
<dd>
Pointer to the storage to be used for the object. This parameter is ignored if <a href="api3_5juc.htm"><b>OleUIInsertObject</b></a> does not create the object.</dd>
<dt>
<b>ppvObj</b></dt>
<dd>
Address of output pointer variable that contains the interface pointer for the object being inserted. This parameter is ignored if <b>OleUIInsertObject</b> does not create the object.</dd>
<dt>
<b>sc</b></dt>
<dd>
Result of creation calls. This parameter is ignored if <a href="api3_5juc.htm"><b>OleUIInsertObject</b></a> does not create the object.</dd>
<dt>
<b>hMetaPict</b></dt>
<dd>
MetafilePict structure containing the iconic aspect, if it wasn't placed in the object's cache.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oledlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in oledlg.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_5juc.htm"><b>OleUIInsertObject</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
