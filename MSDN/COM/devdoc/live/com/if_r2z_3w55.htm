<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IServerSecurity</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_iserversecurity"></a>IServerSecurity</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Used by a server to help authenticate the client and to manage impersonation of the client. </p>
<p>
When a client calls a server, the server can call <a href="api1_2rqs.htm"><b>CoGetCallContext</b></a> to get a pointer to the <b>IServerSecurity</b> interface implemented on the call context object for the current method call. This pointer can be used to call an <b>IServerSecurity</b> method that allows the server to check the client's authentication or to impersonate the client. </p>
<p>
The pointer to the instance of <b>IServerSecurity</b> returned by <b>CoGetCallContext</b> is automatically deleted when the server sends the reply back to the client. Therefore, the <b>IServerSecurity</b> object is valid only for the duration of the call. The <b>IServerSecurity</b> pointer must be released when it is no longer needed.</p>
<h5>When to Implement</h5>
<p>
The stub management code in the system provides an implementation of <b>IServerSecurity</b> for objects by default as part of each incoming call, so typically you would not implement this interface.</p>
<p>
You may choose to implement <b>IServerSecurity</b> on the custom stubs of objects that support custom marshaling to maintain a consistent programming model for their objects. Before dispatching an arriving call, custom marshallers call <a href="api1_5j3o.htm"><b>CoSwitchCallContext</b></a>, specifying a new context object (which must implement <b>IServerSecurity</b>). The original call context must be restored after the server object sends a reply. </p>
<h5>When to Use</h5>
<p>
The methods of the <b>IServerSecurity</b> interface are called by a server object to examine the security settings of a particular call between a client and the server object (<a href="if_r2z_4k38.htm"><b>QueryBlanket</b></a>) or to impersonate the client (<a href="if_r2z_1h84.htm"><b>ImpersonateClient</b></a> and <a href="if_r2z_5kkm.htm"><b>RevertToSelf</b></a>). A server impersonates a client by running in the client's security context, which allows the server to test the privilege level of the calling client with an <b>AccessCheck</b> call and to access resources (such as files) as the client. For more information about how impersonation works, see <a href="comext_6d9q.htm"><b>Impersonation</b></a> and <a href="comext_71lz.htm"><b>Cloaking</b></a>.</p>
<p>
The information obtained through <b>IServerSecurity</b> also allows an object to perform security checks in addition to the automatic ACL checks COM performs. For example, an application may wish to allow time of day access to some objects or may have a different ACL for each method on an object.</p>
<p>
<b>IServerSecurity</b> methods may be called only before the remote procedure call completes. </p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%><a href="if_r2z_9dwu.htm">IUnknown</a> Methods</th>
<th align=left width=48%>Description</th>
</tr>
<tr valign=top>
<td width=52%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=48%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=52%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=48%>Increments the reference count.</td>
</tr>
<tr valign=top>
<td width=52%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=48%>Decrements the reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=52%><b>IServerSecurity</b> <b>Methods</b></td>
<td width=48%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=52%><a href="if_r2z_4k38.htm"><b>QueryBlanket</b></a></td>
<td width=48%>Called by the server to find out about the client that invoked one of its methods.</td>
</tr>
<tr valign=top>
<td width=52%><a href="if_r2z_1h84.htm"><b>ImpersonateClient</b></a></td>
<td width=48%>Allows a server to impersonate a client for the duration of a call.</td>
</tr>
<tr valign=top>
<td width=52%><a href="if_r2z_5kkm.htm"><b>RevertToSelf</b></a></td>
<td width=48%>Restores the authentication information on a thread.</td>
</tr>
<tr valign=top>
<td width=52%><a href="if_r2z_8t7r.htm"><b>IsImpersonating</b></a></td>
<td width=48%>Indicates whether the server is currently impersonating the client. </td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="comext_47fx.htm"><b>Security in COM</b></a>, <a href="api1_2rqs.htm"><b>CoGetCallContext</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
