<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateStreamOnHGlobal</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_createstreamonhglobal"></a>CreateStreamOnHGlobal</h1>
<p>
Creates a stream object stored in global memory.</p>
<pre><code><b>WINOLEAPI CreateStreamOnHGlobal(
  HGLOBAL</b><i> hGlobal</i><b>,</b>         //Memory handle for the stream object
<b>  BOOL</b><i> fDeleteOnRelease</i><b>,</b>   //Whether to free memory when the object 
                           // is released
<b>  LPSTREAM *</b><i> ppstm         </i>//Address of output variable that 
                           // receives the IStream interface pointer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hGlobal</i></dt>
<dd>
[in] Memory handle allocated by the <b>GlobalAlloc </b>function. The handle must be allocated as moveable and nondiscardable. If the handle is to be shared between processes, it must also be allocated as shared. New handles should be allocated with a size of zero. If <i>hGlobal</i> is NULL, the <b>CreateStreamOnHGlobal</b> function internally allocates a new shared memory block of size zero.</dd>
<dt>
<i>fDeleteOnRelease</i></dt>
<dd>
[in] Whether the underlying handle for this stream object should be automatically freed when the stream object is released.</dd>
<dt>
<i>ppstm</i></dt>
<dd>
[out] Address of <b>IStream</b>* pointer variable that receives the interface pointer to the new stream object. Its value cannot be NULL.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_INVALIDARG and E_OUTOFMEMORY, as well as the following:
<dl>
<dt>
S_OK </dt>
<dd>
The stream object was created successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>CreateStreamOnHGlobal</b> function creates a stream object in memory that supports the OLE implementation of the <a href="if_r2z_4x7x.htm"><b>IStream</b></a> interface. The returned stream object supports both reading and writing, is not transacted, and does not support locking.</p>
<p>
The initial contents of the stream are the current contents of the memory block provided in the <i>hGlobal</i> parameter. If the <i>hGlobal</i> paramter is NULL, this function internally allocates memory.</p>
<p>
The current contents of the memory block are undisturbed by the creation of the new stream object. Thus, you can use this function to open an existing stream in memory.</p>
<p>
The initial size of the stream is the size of the memory handle returned by the Win32 <b>GlobalSize</b> function. Because of rounding, this is not necessarily the same size that was originally allocated for the handle. If the logical size of the stream is important, you should follow the call to this function with a call to the <a href="if_r2z_3ysl.htm"><b>IStream::SetSize</b></a> method.</p>
<p>
After you have created the stream object with <b>CreateStreamOnHGlobal</b>, you can call <a href="api2_9a99.htm"><b>GetHGlobalFromStream</b></a> to get the global memory handle associated with the stream object.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="#_com_createstreamonhglobal"><b>CreateStreamOnHGlobal</b></a>,<b> <a href="api2_9a99.htm">GetHGlobalFromStream</a></b>, <a href="if_r2z_3ysl.htm"><b>IStream::SetSize</b></a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalsize">
</object><a href=JavaScript:alink_1.Click()><b>GlobalSize</b></a> in Win32  </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
