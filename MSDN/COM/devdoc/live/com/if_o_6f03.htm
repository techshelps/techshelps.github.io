<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleControlSite::TransformCoords</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iolecontrolsite_transformcoords"></a>IOleControlSite::TransformCoords</h2>
<p>
Converts between a <b>POINTL</b> structure expressed in HIMETRIC units (as is standard in OLE) and a <b>POINTF</b> structure expressed in units specified by the container. By converting the methods, the control can ensure that it sends coordinate information to the container in units that are directly usable in the container without additional conversion.</p>
<pre><code><b>HRESULT TransformCoords(
  POINTL* pPtlHimetric</b><i> </i><b>,  </b>//Address of POINTL structure
<b>  POINTF* pPtfContainer</b><i> </i><b>,  </b>//Address of POINTF structure
<b>  DWORD</b><i> dwFlags           </i>//Flags indicating the exact conversion
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pptlHimetric</i></dt>
<dd>
[in, out] Address of a <b>POINTL</b> structure containing coordinates expressed in HIMETRIC units. This is an [in] parameter when <i>dwFlags</i> contains XFORMCOORDS_HIMETRICTOCONTAINER; it is [out] with XFORMCOORDS_CONTAINERTOHIMETRIC. In the latter case, the contents are undefined on error.</dd>
<dt>
<i>pptfContainer</i></dt>
<dd>
[in, out] Address of a caller-allocated <b>POINTF</b> structure that receives the converted coordinates. This is an [in] parameter when <i>dwFlags</i> contains XFORMCOORDS_CONTAINERTOHIMETRIC; it is [out] with XFORMCOORDS_HIMETRICTOCONTAINER. In the latter case, the contents are undefined on error.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
[in] Flags indicating the exact conversion to perform. The <i>dwFlags</i> parameter can be any combination of the following values except where indicated:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Flag Value</th>
<th align=left width=51%>Description</th>
</tr>
<tr valign=top>
<td width=49%>XFORMCOORDS_POSITION</td>
<td width=51%>The coordinates to convert represent a position point. Cannot be used with XFORMCOORDS_SIZE.</td>
</tr>
<tr valign=top>
<td width=49%>XFORMCOORDS_SIZE</td>
<td width=51%>The coordinates to convert represent a set of dimensions. Cannot be used with XFORMCOORDS_POSITION.</td>
</tr>
<tr valign=top>
<td width=49%>XFORMCOORDS_HIMETRICTOCONTAINER</td>
<td width=51%>The operation converts <i>pptlHimetric</i> into <i>pptfContainer</i>. Cannot be used with XFORMCOORDS_CONTAINERTOHIMETRIC.</td>
</tr>
<tr valign=top>
<td width=49%>XFORMCOORDS_CONTAINERTOHIMETRIC</td>
<td width=51%>The operation converts <i>pptfContainer</i> into <i>pptlHimetric</i>. Cannot be used with XFORMCOORDS_HIMETRICTOCONTAINER.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG and E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The conversion was performed successfully.</dd>
<dt>
E_NOTIMPL</dt>
<dd>
The container does not require any special coordinate conversions. The container deals completely in HIMETRIC.</dd>
<dt>
E_POINTER</dt>
<dd>
The address in <i>pptlHimetric</i> or <i>pptfContainer</i> is not valid. For example, it may be NULL.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A control uses this method when it has to send coordinates to a container within an event or some other custom call or when the control has container coordinates that it needs to convert into HIMETRIC units.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="structs_6vom.htm"><b>POINTF</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
