<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ISurrogate::FreeSurrogate</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_isurrogate_freesurrogate"></a>ISurrogate::FreeSurrogate</h2>
<p>
Terminates the surrogate process. COM calls this method when all of the DLL servers running in a surrogate process have terminated.</p>
<pre><b><code>HRESULT FreeSurrogate();
 </code></b></pre>
<h4>Return Values</h4>
<p>
This method supports the standard return values including E_FAIL, and E_UNEXPECTED, and S_OK </p>
<h4>Remarks</h4>
<p>
COM calls <b>ISurrogate::FreeSurrogate</b> when there are no more DLL servers running in the surrogate process. When <b>ISurrogate::FreeSurrogate</b> is called, the method must properly revoke all of the class factories registered in the surrogate, and then cause the surrogate process to exit.</p>
<p>
Surrogate processes must call the <b>CoFreeUnusedLibraries</b> function periodically to unload DLL servers that are no longer in use. The surrogate process assumes this responsibility, which would normally be the client's responsibility. <b>CoFreeUnusedLibraries</b> calls the <b>DllCanUnloadNow</b> function on any loaded DLL servers. Because <b>CoFreeUnusedLibraries</b> depends on the existence and proper implementation of <b>DllCanUnloadNow</b> in DLL servers, it is not guaranteed to unload all DLL servers that should be unloaded --not every server implements <b>DllCanUnloadNow</b>, and this function is unreliable for free-threaded DLLs.  Additionally, the surrogate has no way of being informed when all DLL servers are gone. COM, however, can determine when all DLL servers have been unloaded, and will then call the <b>FreeSurrogate</b> method.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 SP2 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_r2z_7mn9.htm"><b>ISurrogate</b></a>, <a href="reg_6xyd.htm"><b>DllSurrogate</b></a>, <a href="if_r2z_8m9e.htm"><b>ISurrogate::LoadDllServer</b></a>, <a href="comext_2dlx.htm">Writing a Custom Surrogate</a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
