<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPrint::Print</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iprint_print"></a>IPrint::Print</h2>
<p>
Prints an object on the specified printer, using the specified job requirements.</p>
<pre><code><b>HRESULT Print(
  DWORD</b><i> grfFlags</i><b>,       </b>//Printing options
<b>  DVTARGETDEVICE</b><i> **pptd</i><b>,</b>
<b>                        </b>//Address of output variable that receives a 
                        //pointer to the TARGETDEVICE structure
<b>  PAGESET</b><i> **pppageset</i><b>,  </b>//Address of output variable that receives a 
                        //pointer to the PAGESET structure
<b>  STGMEDIUM</b><i> *pstgmOptions</i><b>,  </b>//Pointer to object-specific printing 
                            //options
<b>  IContinueCallback</b><i> *pcallback</i><b>,</b>
<b>                        </b>//Pointer to callback interface
<b>  LONG</b><i> nFirstPage</i><b>,      </b>//Number of first page to be printed
<b>  LONG</b><i> *pcPagesPrinted</i><b>, </b>//Pointer to total number of pages printed
<b>  LONG</b><i> *pnLastPage      </i>//Pointer to number of last page printed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>grfFlags</i></dt>
<dd>
[in] A bit field specifying print options from the PRINTFLAG enumeration.</dd>
<dt>
<i>pptd</i></dt>
<dd>
[in, out] Address of <b>DVTARGETDEVICE</b> pointer variable that receives a pointer to the <b>TARGETDEVICE</b> structure which describes the target print device.</dd>
<dt>
<i>ppPageSet</i></dt>
<dd>
[in, out] Address of <b>PAGESET</b> pointer variable that receives a pointer to the <b>PAGESET</b> structure that indicates which pages are to be printed.</dd>
<dt>
<i>ppstgmOptions</i></dt>
<dd>
[unique][in, out] Pointer to object-specific printing options in a serialized OLE property set. May be NULL on input or return.</dd>
<dt>
<i>pCallback</i></dt>
<dd>
[in] Pointer to the <b>IContinueCallback</b> interface on the view site, which is to be periodically polled at human-response speeds to determine whether printing should be abandoned. May be NULL.</dd>
<dt>
<i>nFirstPage</i></dt>
<dd>
[in] The page number of the first page to be printed. This value overrides any value previously passed to <a href="if_p2q_6krx.htm"><b>IPrint::SetInitialPageNum</b></a>.</dd>
<dt>
<i>pcPagesPrinted</i></dt>
<dd>
[out] Pointer to the actual number of pages that were successfully printed.</dd>
<dt>
<i>pnLastPage</i></dt>
<dd>
[out] Pointer to  the number of the last page that was printed.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standarde return value E_UNEXPECTED, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
The printing operation was successfully completed.</dd>
<dt>
PRINT_E_CANCELED</dt>
<dd>
The print process was canceled before completion. <i>*pcPagesPrinted </i>indicates the number of pages that were in fact successfully printed before this error occurred.</dd>
<dt>
PRINT_E_NOSUCHPAGE</dt>
<dd>
A page specified in <i>**pppageset </i>or <i>nFirstPage </i>does not exist.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The printer on which the object is to be printed is indicated by the <b>DVTARGETDEVICE</b> structure pointed to by <i>pptd</i>. The <b>DEVMODE</b> structure in the target device indicates whole-job printer-specific options, such as number of copies, paper size, and print quality. The DEVMODE structure may also contain orientation information in the <i>dmOrientation </i>field (this is indicated in the <i>dmFields </i>field). If present, then this paper orientation should be used; if absent, then natural orientation as determined by the object content is to be used.</p>
<p>
Due to the possibility of user input, the parameters <i>pptd </i>and <i>ppPageSet </i>are both [in,out] structures. In the absence of user interaction (that is, if the PRINTFLAG_PROMPTUSER flag is not set), both the target device and the page set will necessarily be the same for input and output. However, if the user is prompted for print options, then the object returns target device and page-set information appropriate to what the user has actually chosen.</p>
<p>
The <i>ppstgmOptions </i>parameter is also [in,out]. On exit, the object should write to <i>*ppstgmOptions </i>any object-specific information that it would need to reproduce this exact print job. Examples might include whether the user selected "sheet, notes, or both" in a spreadsheet application. The data passed is in the format of a serialized property set. The data is normally useful only when passed back in a subsequent call to the same object. Because a subsequent call may specify different user interaction flags, target device, or other settings, the caller can cause the document to be printed multiple times in the same way in slightly different printing contexts.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in docobj.h.<br>
‹</p>
<h4>See Also</h4>
<p>
TBD <b>›</b></p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
