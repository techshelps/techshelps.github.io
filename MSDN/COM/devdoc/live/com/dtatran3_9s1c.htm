<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Drag and Drop</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_drag_and_drop"></a>Drag and Drop</h1>
<p>
"Drag and drop" refers to data transfers in which a mouse or other pointing device is used to specify both the data source and its destination. In a typical drag and drop operation, a user selects the object to be transferred by moving the mouse pointer to it and holding down either the left button or some other button designated for this purpose. While continuing to hold down the button, the user initiates the transfer by dragging the object to its destination, which can be any OLE container. Drag and drop provides exactly the same functionality as the OLE Clipboard copy and paste but adds visual feedback and eliminates the need for menus. In fact, if an application supports Clipboard copy and paste, little extra is needed to support drag and drop.</p>
<p>
During an OLE drag and drop operation, the following three separate pieces of code are used:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Drag-and-drop code source</th>
<th align=left width=59%>Implementation and use</th>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_12jp.htm"><b>IDropSource</b></a> interface</td>
<td width=59%>Implemented by the object containing the dragged data, referred to as the <i>drag source</i>.</td>
</tr>
<tr valign=top>
<td width=41%><a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a> interface</td>
<td width=59%>Implemented by the object that is intended to accept the drop, referred to as the <i>drop target</i>.</td>
</tr>
<tr valign=top>
<td width=41%><a href="api2_5now.htm"><b>DoDragDrop</b></a> function</td>
<td width=59%>Implemented by OLE and used to initiate a drag and drop operation. Once the operation is in progress, it facilitates communication between the drag source and the drop target.</td>
</tr>
</table><br>
<p>
The <a href="if_a2e_12jp.htm"><b>IDropSource</b></a> and <a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a> interfaces can be implemented in either a container or in an object application. The role of drag source or drop target is not limited to any one type of OLE application.</p>
<p>
The OLE function <a href="api2_5now.htm"><b>DoDragDrop</b></a><b> </b>implements a loop that tracks mouse and keyboard movement until such time as the drag is canceled or a drop occurs. <b>DoDragDrop</b> is the key function in the drag and drop process, facilitating communication between the drag source and drop target. </p>
<p>
During a drag and drop operation, three types of feedback can be displayed to the user:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Type of feedback</th>
<th align=left width=69%>Description</th>
</tr>
<tr valign=top>
<td width=31%>Source feedback</td>
<td width=69%>Provided by the drag source, the source feedback indicates the data is being dragged and does not change during the course of the drag. Typically, the data is highlighted to signal it has been selected.</td>
</tr>
<tr valign=top>
<td width=31%>Pointer feedback</td>
<td width=69%>Provided by the drag source, the pointer feedback indicates what happens if the mouse is released at any given moment. Pointer feedback changes continually as the user moves the mouse and/or presses a modifier key. For example, if the pointer is moved into a window that cannot accept a drop, the pointer changes to the "not allowed" symbol.</td>
</tr>
<tr valign=top>
<td width=31%>Target feedback</td>
<td width=69%>Provided by the drop target, target feedback indicates where the drop is to occur.</td>
</tr>
</table><br>
<p>
Although the Windows 3.1 File Manager does not use OLE to implement drag and drop transfers, it is nevertheless an example of an application that acts as both a drag source and drop target and that provides all three types of feedback. When a user selects a file to copy, File Manager supplies source feedback by indicating the selection. As the selection is dragged and modifier keys are pressed, the mouse pointer changes. For example, if the user presses the ctrl key, a plus sign is added, indicating that the drop would result in a copy rather than moving the original. When the file is dragged over an area that is not a drop target, the pointer changes appropriately. Target feedback, a line drawn around a file or directory, is provided when the pointer is over an area that is a drop target.</p>
<p>&nbsp;</p></body>
</HTML>
