<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IFont</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ifont"></a>IFont</h1>
<p>
An COM font object is an object wrapper around a Windows font object. The COM font object supports a number of read-write properties as well as a set of methods through its <b>IFont</b> interface. It supports the same set of properties (but not the methods) through the dispatch interface <a href="if_f2n_1e40.htm"><b>IFontDisp</b></a>, which is derived from <b>IDispatch</b> to provide access to the font's properties through Automation. The system provides a standard implementation of the font object with both interfaces.</p>
<p>
The font object also supports the outgoing interface <a href="if_p2q_4gh7.htm"><b>IPropertyNotifySink</b></a> so a client can determine when font properties change. Because the font object supports at least one outgoing interface, it also implements <a href="if_a2e_5h2q.htm"><b>IConnectionPointContainer</b></a> and related interfaces for this purpose.</p>
<p>
The font object provides an <i>hFont</i> property, which is a Windows font handle that conforms to the other attributes specified for the font. The font object delays realizing this <i>hFont</i> object when possible, so consecutively setting two properties on a font won't cause an intermediate font to be realized. In addition, as an optimization, the system-implemented font object maintains a cache of font handles. Two font objects in the same process that have identical properties will return the same font handle. The font object can remove font handles from this cache at will, which introduces special considerations for clients using the <b>hFont</b> property. See the description for <a href="if_f2n_1px0.htm"><b>IFont::get_hFont</b></a> for more details.</p>
<p>
The font object also supports <a href="if_p2q_02b1.htm"><b>IPersistStream</b></a> so it can save and load itself from an instance of <a href="if_r2z_4x7x.htm"><b>IStream</b></a>. An object that uses a font object internally would normally save and load the font as part of the object's own persistence handling.</p>
<p>
In addition, the font object supports <a href="if_a2e_24z8.htm"><b>IDataObject</b></a>, which can render a property set containing the font's attributes, allowing a client to save these properties as text.</p>
<h5>When to Implement</h5>
<p>
Typically, you use the COM-provided font object, which implements the <b>IFont</b> interface as its primary interface. It allows the caller to manage font properties and to use that font in graphical rendering. Each property in the <b>IFont</b> interface includes a get_<i>PropertyName</i> method if the property supports read access and a put_<i>PropertyName</i> method if the property supports write access. Most of the properties support both read and write access, and thus expose both "get" and "put" methods for these properties.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=20%><br>
Property</th>
<th align=left width=15%><br>
Type</th>
<th align=left width=17%>Access <br>
Allowed</th>
<th align=left width=48%><br>
Description</th>
</tr>
<tr valign=top>
<td width=20%>Name</td>
<td class=indent1 width=15%>BSTR</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>The name of the font family, e.g. Arial.</td>
</tr>
<tr valign=top>
<td width=20%>Size</td>
<td class=indent1 width=15%>CY</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>The point size of the font, expressed in a <b>CY</b> type to allow for fractional point sizes.</td>
</tr>
<tr valign=top>
<td width=20%>Bold</td>
<td class=indent1 width=15%>BOOL</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>Indicates whether the font is boldfaced.</td>
</tr>
<tr valign=top>
<td width=20%>Italic</td>
<td class=indent1 width=15%>BOOL</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>Indicates whether the font is italicized.</td>
</tr>
<tr valign=top>
<td width=20%>Underline</td>
<td class=indent1 width=15%>BOOL</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>Indicates whether the font is underlined.</td>
</tr>
<tr valign=top>
<td width=20%>Strikethrough</td>
<td class=indent1 width=15%>BOOL</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>Indicates whether the font is strikethrough.</td>
</tr>
<tr valign=top>
<td width=20%>Weight</td>
<td class=indent1 width=15%>short</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>The boldness or weight of the font.</td>
</tr>
<tr valign=top>
<td width=20%>Charset</td>
<td class=indent1 width=15%>short</td>
<td class=indent1 width=17%>RW</td>
<td width=48%>The character set used in the font, such as ANSI_CHARSET, DEFAULT_CHARSET, or SYMBOL_CHARSET.</td>
</tr>
<tr valign=top>
<td width=20%>hFont</td>
<td class=indent1 width=15%>HFONT</td>
<td class=indent1 width=17%>R</td>
<td width=48%>The Windows font handle that can be selected into a device context for rendering.</td>
</tr>
</table><br>
<h5>When to Use</h5>
<p>
Use this interface to change or retrieve the properties of a font object.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>IUnknown Methods</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=64%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=64%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=64%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>IFont Methods</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_4pb9.htm"><b>get_Name</b></a></td>
<td width=64%>Gets the name of the font family.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_6ffp.htm"><b>put_Name</b></a></td>
<td width=64%>Sets a new name for the font family.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_3ilh.htm"><b>get_Size</b></a></td>
<td width=64%>Gets the point size for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_58px.htm"><b>put_Size</b></a></td>
<td width=64%>Sets the point size for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_8i90.htm"><b>get_Bold</b></a></td>
<td width=64%>Indicates whether the font is bold or not.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_08dg.htm"><b>put_Bold</b></a></td>
<td width=64%>Sets the boldness property for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_9jxf.htm"><b>get_Italic</b></a></td>
<td width=64%>Indicates whether the font is italic or not.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_7tlv.htm"><b>put_Italic</b></a></td>
<td width=64%>Sets the italic property for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_9zz9.htm"><b>get_Underline</b></a></td>
<td width=64%>Indicates whether the font is underlined or not.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_2ezp.htm"><b>put_Underline</b></a></td>
<td width=64%>Sets the underline property for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_4bhk.htm"><b>get_Strikethrough</b></a></td>
<td width=64%>Indicates whether the font is strikethrough or not.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_6hm0.htm"><b>put_Strikethrough</b></a></td>
<td width=64%>Sets the strikethrough property for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_6cfo.htm"><b>get_Weight</b></a></td>
<td width=64%>Gets the weight (boldness) for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_4m44.htm"><b>put_Weight</b></a></td>
<td width=64%>Sets the weight (boldness) for the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_6l9w.htm"><b>get_Charset</b></a></td>
<td width=64%>Gets the font's character set.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_5sqc.htm"><b>put_Charset</b></a></td>
<td width=64%>Sets the font's character set.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_1px0.htm"><b>get_hFont</b></a></td>
<td width=64%>Returns a Windows <b>HFONT</b> handle for the font described by this font object.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_4msl.htm"><b>Clone</b></a></td>
<td width=64%>Creates a duplicate font object with a state identical to the current font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_99nw.htm"><b>IsEqual</b></a></td>
<td width=64%>Compares this font object to another for equality.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_7ui7.htm"><b>SetRatio</b></a></td>
<td width=64%>Converts the scaling factor for this font between logical units and HIMETRIC units (in which is expressed the point size in the Size property).</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_1rcj.htm"><b>QueryTextMetrics</b></a></td>
<td width=64%>Fills a <b>TEXTMETRIC</b> structure describing the font.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_1eus.htm"><b>AddRefHfont</b></a></td>
<td width=64%>Notifies the font object that the previously realized font identified with <b>hFont</b> (from <b>IFont::GetHfont</b>) should remain valid until <b>IFont::ReleaseHfont</b> is called or the font object itself is released.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_841g.htm"><b>ReleaseHfont</b></a></td>
<td width=64%>Notifies the font object that the caller that previously locked this font in the cache with <b>IFont::AddRefHfont</b> no longer requires the lock.</td>
</tr>
<tr valign=top>
<td width=36%><a href="if_f2n_15gj.htm"><b>SetHdc</b></a></td>
<td width=64%>Provides a device context handle to the font that describes the logical mapping mode.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_6mum.htm"><b>IFont - Ole Implementation</b></a>, <a href="if_f2n_1e40.htm"><b>IFontDisp</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
