<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IHttpNegotiate::BeginningTransaction</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ihttpnegotiate_beginningtransaction"></a>IHttpNegotiate::BeginningTransaction</h2>
<p>
Notifies the client of the URL being bound at the beginning of an HTTP transaction.</p>
<pre><code><b>HRESULT BeginningTransaction(
  LPCWSTR </b><i> szURL</i><b>,                </b>//URL for the HTTP transaction
<b>  DWORD </b><i> dwReserved</i><b>,             </b>//Reserved for future use
<b>  LPCWSTR </b><i> szHeaders</i><b>,            </b>//Current request headers
<b>  LPWSTR *</b><i> pszAdditionalHeaders  </i>//Optional additional headers to 
                                 //append to the HTTP request header
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>szURL</i></dt>
<dd>
[in] URL for the HTTP transaction.</dd>
<dt>
<i>dwReserved</i></dt>
<dd>
[in] Reserved for future use.</dd>
<dt>
<i>szHeaders</i></dt>
<dd>
[in] Current request headers.</dd>
<dt>
<i>pszAdditionalHeaders</i></dt>
<dd>
[out] Optional additional headers to append to the HTTP request. If these conflict with existing values in <i>szHeaders</i>, then the new request headers take precedence. If <i>pszAdditionalHeaders</i> is set to NULL, no headers are added to the HTTP request.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The operation was successful. Any additional headers specfied are appended.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
The parameter is invalid.</dd>
<dt>
E_ABORT</dt>
<dd>
Terminate the HTTP transaction.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The URL moniker calls <b>IHttpNegotiate::BeginningTransaction</b> before sending an HTTP request. It notifies the client of the URL being bound to at the beginning of the HTTP transaction. It also allows the client to add additional headers, such as Accept-Language, to the request.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in urlmon.h.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_87qd.htm"><b>IHttpNegotiate::OnResponse</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
