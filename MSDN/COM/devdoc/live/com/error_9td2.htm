<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Codes in FACILITY_ITF</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_codes_in_facility_itf"></a>Codes in FACILITY_ITF</h1>
<p>
These <b>HRESULT</b>s with facilities such as FACILITY_NULL and FACILITY_RPC have universal meaning because they are defined at a single source: Microsoft. However, <b>HRESULT</b>s in FACILITY_ITF are determined by the function or interface method from which they are returned. This means that the same 32-bit value in FACILITY_ITF returned from two different interface methods might have different meanings.</p>
<p>
The reason <b>HRESULT</b>s in FACILITY_ITF can have different meanings in different interfaces is that <b>HRESULT</b>s are kept to an efficient data-type size of 32 bits. Unfortunately, 32 bits is not large enough for the development of an error code allocation system that avoids conflicting codes allocated by different programmers at different times in different places (unlike the handling of interface identifiers and CLSIDs). As a result, the 32-bit <b>HRESULT</b> is structured in a way that Microsoft can define several universal error codes, while allowing other programmers to define new error codes without fear of conflict. The status code convention is as follows:
<ol>
<li>
Status codes in facilities <i>other than</i> FACILITY_ITF can only be defined by Microsoft.</li>
<li>
Status codes in facility FACILITY_ITF are defined solely by the developer of the interface or function that returns the status code. To avoid conflicting error codes, whoever defines the interface is responsible for coordinating and publishing the FACILITY_ITF status codes associated with that interface.</li>
</ol>
<p>
All the COM-defined FACILITY_ITF codes have a code value in the range of 0x0000 – 0x01FF. While it is legal to use any codes in FACILITY_ITF, it is recommended that only code values in the range of 0x0200 — 0xFFFF be used. This recommendation is made as a means of reducing confusion with any COM-defined errors.</p>
<p>
It is also recommended that developers define new functions and interfaces to return error codes as defined by COM and in facilities other than FACILITY_ITF. In particular, interfaces that have any chance of being remoted using RPC in the future should define the FACILITY_RPC codes as legal. E_UNEXPECTED is a specific error code that most developers will want to make universally legal.</p>
<p>&nbsp;</p></body>
</HTML>
