<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IStream::SetSize</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_istream_setsize"></a>IStream::SetSize</h2>
<p>
Changes the size of the stream object.</p>
<pre><code><b>HRESULT SetSize(
  ULARGE_INTEGER</b><i> libNewSize  </i>//Specifies the new size of the stream 
                             // object
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>libNewSize</i></dt>
<dd>
[in] Specifies the new size of the stream as a number of bytes.</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The size of the stream object was successfully changed.</dd>
<dt>
E_PENDING</dt>
<dd>
Asynchronous Storage only: Part or all of the stream's data is currently unavailable. For more information see <a href="if_f2n_5xdf.htm"><b>IFillLockBytes</b></a> and <a href="asyncstg_86cl.htm">Asynchronous Storage</a>. </dd>
<dt>
STG_E_MEDIUMFULL</dt>
<dd>
The stream size is not changed because there is no space left on the storage device.</dd>
<dt>
STG_E_INVALIDFUNCTION</dt>
<dd>
The value of the <i>libNewSize</i> parameter is not valid. Since streams cannot be greater than 2<sup>32</sup> bytes in the COM-provided implementation, the high DWORD of <i>libNewSize</i> must be 0. If it is nonzero, this parameter is not valid.</dd>
<dt>
STG_E_REVERTED</dt>
<dd>
The object has been invalidated by a revert operation above it in the transaction tree.</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>IStream::SetSize</b> changes the size of the stream object. Call this method to preallocate space for the stream. If the <i>libNewSize</i> parameters larger than the current stream size, the stream is extended to the indicated size by filling the intervening space with bytes of undefined value. This operation is similar to the <a href="if_r2z_3yat.htm"><b>ISequentialStream::Write</b></a> method if the seek pointer is past the current end-of-stream.</p>
<p>
If the <i>libNewSize</i> parameter is smaller than the current stream, then the stream is truncated to the indicated size.</p>
<p>
The seek pointer is not affected by the change in stream size.</p>
<p>
Calling <b>IStream::SetSize</b> can be  an effective way of trying to obtain a large chunk of contiguous space.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also<i> </i></h4>
<p>
<a href="if_r2z_459q.htm"><b>IStream - Compound File Implementation</b></a>, <a href="if_r2z_3yat.htm"><b>ISequentialStream::Write</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
