<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>When the OLE 1 Version Is Overwritten</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_when_the_ole_1_version_is_overwritten"></a>When the OLE 1 Version Is Overwritten</h2>
<p>
When the OLE 1 object application is replaced by the OLE 2 version, do the following. (For the purpose of illustration, the OLE 1 object application is referred to as Ole 1 In-Place Server Outline while the OLE 2 version is Ole 2 In-Place Server Outline, as shown in the dialog box illustrations that follow).
<ol>
<li>
Register Ole 2 In-Place Server Outline.</li>
<li>
Modify (with your install/setup program) the <i>original</i> registry entries of Ole 1 In-Place Server Outline by changing the executable path to point to the Ole 2 In-Place Server Outline executable.<p>
For example, the Server subkey for the OLE 1 executable, named <b>svrapp.exe</b> in this example, changes from
<p>
<b>OLE1ISvrOtl\Protocol\StdFileEditing\Server = svrapp.exe</b>
<p>
to
<p>
<b>OLE1ISvrOtl\Protocol\StdFileEditing\Server = isvrotl.exe</b>
<p>
where <b>isvrotl.exe</b> is the name of the OLE 2 object application.
<p>
Next, proceed to either step 3 or step 4, depending on whether or not you want OLE 1 objects converted automatically to the OLE 2 format.
</li>
<li>
If Ole 1 In-Place Server Outline objects will be converted automatically to the Ole 2 In-Place Server Outline format when the application is saved, create or modify the following registration database entries:<ol type=a>
<li>
Modify the <i>original registry entry</i> of Ole 1 In-Place Server Outline by changing the "Value of the ProgID <b>=</b> Main User Type Name" key of the entry to Ole 2 In-Place Server Outline.<p>
For example, where <b>OLE1ISvrOtl</b> is the ProgID of the OLE 1 application,
<p>
<b>OLE1ISvrOtl = Ole 1 In-Place Server Outline</b>
<p>
becomes
<p>
<b>OLE1ISvrOtl = Ole 2 In-Place Server Outline</b>
</li>
<li>
Modify the <i>original registry entry</i> of Ole 1 In-Place Server Outline by adding a <b>NotInsertable</b> subkey under the ProgID key. For example:<pre><code>HKEY_CLASSES_ROOT\OLE1SvrOtl\NotInsertable
 </code></pre>
</li>
</ol>
<p>
<b>Note</b>&nbsp;&nbsp;Since the original registry entries for the OLE 1 server application remain (but with a pointer to the OLE 2 object application as shown in the preceding <i>step 3a</i>), the OLE 1 ProgID will appear in the Insert Object dialog box of any OLE 2 container application installed on the system. The <b>NotInsertable</b> subkey mentioned in <i>step 3b</i> prevents the ProgID of the OLE 1 application from appearing in the Insert Object dialog box of OLE 2 containers. The <b>NotInsertable</b> subkey overrides any <b>Insertable</b> subkey entries for that ProgID key.
<ol start=3 type=a>
<li>
Set the "AutoConvertTo = CLSID" subkey entry for Ole 1 In-Place Server Outline <i>under the CLSID key</i> to the CLSID of Ole 2 In-Place Server Outline. (See also "OLE 1 Compatibility Subkeys").<p>
<b>CLSID\{</b><i>CLSID of OLE 1 app.</i><b>}\AutoConvertTo = {</b><i>CLSID of OLE 2 app.</i><b>}</b>
</li>
</ol>
<p>
<b>Note</b>&nbsp;&nbsp;You can obtain the CLSID of the OLE 1 object application for inclusion in registration entry file by calling <a href="api1_51gk.htm"><b>CLSIDFromProgID</b></a>.
<ol start=4 type=a>
<li>
Modify the <i>original registry entry</i> of Ole 1 In-Place Server Outline by setting the verbs to those of Ole 2 In-Place Server Outline.<p>
For example, change 
<p>
<b>OLE1ISvrOtl\Protocol\StdFileEditing\Verb\0 = &amp;Edit</b>
<p>
to
<p>
<b>OLE1ISvrOtl\Protocol\StdFileEditing\Verb\0 = &amp;Edit</b>
<p>
<b>OLE1ISvrOtl\Protocol\StdFileEditing\Verb\1 = &amp;Open</b>
</li>
</ol>
</li>
<li>
If the user is allowed to open Acme Draw 1.0 objects and save them back to disk in the Acme Draw 1.0 format:<ol type=a>
<li>
Set the "TreatAs = CLSID" entry to the CLSID of Ole 2 In-Place Server Outline using the following form.<p>
<b>CLSID\{</b><i>CLSID of OLE 1 app.</i><b>}\TreatAs = {</b><i>CLSID of OLE 2 app.</i><b>}</b>
</li>
<li>
Set the Ole 1 In-Place Server Outline verbs to those of Ole 2 In-Place Server Outline as described in the preceding step 3.</li>
</ol>
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
