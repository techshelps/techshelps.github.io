<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleCacheControl::OnRun</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iolecachecontrol_onrun"></a>IOleCacheControl::OnRun</h2>
<p>
Notifies the cache that the data source object has now entered its running state.</p>
<pre><code><b>HRESULT OnRun(
  DATAOBJECT *</b><i> pDataObject  </i>//Pointer to the object that is now 
                            // running
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>pDataObject</i></dt>
<dd>
[in] Pointer to the <b>IDataObject</b> interface on the object that is entering the running state.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
The cache was notified and <i>pDataObject</i> is valid.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When <b>IOleCacheControl::OnRun</b> is called, the cache sets up advisory connections as necessary with the source data object so it can receive notifications. The advisory connection created between the running object and the cache is destroyed when <b>IOleCacheControl::OnStop</b> is called.</p>
<p>
Some object handlers or in-process servers might use the cache passively, and not call <b>IOleCacheControl::OnRun</b>. These applications must call <b>IOleCache2::UpdateCache</b>, <b>IOleCache::InitCache</b>, or <b>IOleCache::SetData</b> to fill the cache when necessary to ensure that the cache gets updated.</p>
<p>
<b>IOleCacheControl::OnRun</b> does not add a reference count on the pointer to <b>IDataObject</b> passed in <i>pDataObject.</i> Because it is the responsibility of the caller of <a href="api3_1yni.htm"><b>OleRun</b></a> to ensure that the lifetime of the <i>pDataObject</i> pointer lasts until <b>OnStop</b> is called, the caller must be holding a pointer to <b>IDataObject</b> on the data object of interest.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_6zqd.htm"><b>IOleCache2::UpdateCache</b></a>,<b> <a href="if_o_1b5c.htm">IOleCacheControl::OnStop</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
