<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLEUIPASTESPECIAL</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleuipastespecial_str"></a>OLEUIPASTESPECIAL</h1>
<p>
The OLEUIPASTESPECIAL structure contains information that the OLE User Interface Library uses to initialize the Paste Special dialog box, as well as space for the library to return information when the dialog box is dismissed.</p>
<pre><code>typedef struct tagOLEUIPASTESPECIAL 
{ 
// These IN fields are standard across all OLEUI dialog box functions. 
    DWORD          cbStruct; 
    DWORD          dwFlags; 
    HWND           hWndOwner; 
    LPCSTR         lpszCaption; 
    LPFNOLEUIHOOK  lpfnHook; 
    LPARAM         lCustData; 
    HINSTANCE      hInstance; 
    LPCSTR         lpszTemplate; 
    HRSRC          hResource; 
 
// Specifics for       OLEUIPASTESPECIAL. 
    LPDATAOBJECT       lpSrcDataObj; 
    LPOLEUIPASTEENTRY  arrPasteEntries; 
    int                cPasteEntries; 
    UINT FAR *         arrLinkTypes; 
    int                cLinkTypes; 
    UINT               cClsidExclude; 
    LPCLSID            lpClsidExclude; 
    int                nSelectedIndex; 
    BOOL               fLink; 
    HGLOBAL            hMetaPict; 
    SIZEL              sizel; 
} OLEUIPASTESPECIAL, *POLEUIPASTESPECIAL, FAR *LPOLEUIPASTESPECIAL; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbStruct</b></dt>
<dd>
Size of the structure, in bytes. This field must be filled on input.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
On input, <b>dwFlags</b><i> </i>specifies the initialization and creation flags. On exit, it specifies the user's choices. It may be a combination of the following flags:
<dl>
<dt>
PSF_SHOWHELP</dt>
<dd>
Dialog box will display a Help button.</dd>
<dt>
PSF_SELECTPASTE</dt>
<dd>
The Paste radio button will be selected at dialog box startup. This is the default, if PSF_SELECTPASTE or PSF_SELECTPASTELINK are not specified. Also, it specifies the state of the button on dialog termination. IN/OUT flag.</dd>
<dt>
PSF_SELECTPASTELINK</dt>
<dd>
The PasteLink radio button will be selected at dialog box startup. Also, specifies the state of the button on dialog termination. IN/OUT flag.</dd>
<dt>
PSF_CHECKDISPLAYASICON</dt>
<dd>
Whether the Display As Icon radio button was checked on dialog box termination. OUT flag.</dd>
<dt>
PSF_DISABLEDISPLAYASICON</dt>
<dd>
The Display As Icon check box will be disabled on initialization.</dd>
<dt>
HIDECHANGEICON</dt>
<dd>
Used to disable the change-icon button in the dialog box, which is available to users when they're pasting an OLE object by default. See STAYONCLIPBOARDCHANGE otherwise.</dd>
<dt>
STAYONCLIPBOARDCHANGE</dt>
<dd>
Used to tell the dialog box to stay up if the clipboard changes while the dialog box is up. If the user switches to another application and copies or cuts something, the dialog box will, by default, perform a cancel operation, which will remove the dialog box since the options it's in the middle of presenting to the user are no longer up-to-date with respect to what's really on the clipboard.</dd>
<dt>
NOREFRESHDATAOBJECT</dt>
<dd>
Used in conjunction with STAYONCLIPBOARDCHANGE (it doesn't do anything otherwise). If the clipboard changes while the dialog box is up and STAYONCLIPBOARDCHANGE is specified, then NOREFRESHDATAOBJECT indicates that the dialog box should NOT refresh the contents of the dialog box to reflect the new contents of the clipboard. This is useful if the application is using the paste-special dialog box on an IDataObject besides the one on the clipboard, for example, as part of a right-click drag-and-drop operation. </dd>
</dl>
</dd>
<dt>
<b>hWndOwner</b></dt>
<dd>
Wwindow that owns the dialog box. It should not be NULL.</dd>
<dt>
<b>lpszCaption</b></dt>
<dd>
Pointer to a string to be used as the title of the dialog box. If NULL, then the library uses Paste Special.</dd>
<dt>
<b>lpfnHook</b></dt>
<dd>
Pointer to a hook function that processes messages intended for the dialog box. The hook function must return zero to pass a message that it didn't process back to the dialog box procedure in the library. The hook function must return a non-zero value to prevent the library's dialog box procedure from processing a message it has already processed. </dd>
<dt>
<b>lCustData</b></dt>
<dd>
Application-defined data that the library passes to the hook function pointed to by the <b>lpfnHook</b> member. The library passes a pointer to the OLEUIPASTESPECIAL structure in the <i>lParam</i> parameter of the WM_INITDIALOG message; this pointer can be used to retrieve the <b>lCustData</b> member. </dd>
<dt>
<b>hInstance</b></dt>
<dd>
Instance that contains a dialog box template specified by the <i>lpTemplateName</i> member.</dd>
<dt>
<b>lpszTemplate</b></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the resource file for the dialog box template that is to be substituted for the library's Paste Special dialog box template. </dd>
<dt>
<b>hResource</b></dt>
<dd>
Customized template handle.</dd>
<dt>
<b>lpSrcDataObj</b></dt>
<dd>
Pointer to the <a href="if_a2e_24z8.htm">IDataObject</a>* interface of the data object to be pasted (from the clipboard). This field is filled on input. If <b>lpSrcDataObj</b> is NULL when <b>OleUIPasteSpecial</b> is called, then <b>OleUIPasteSpecial</b> will attempt to retrieve a pointer to an IDataObject from the clipboard. If <b>OleUIPasteSpecial</b> succeeds, it is the caller's responsibility to free the IDataObject returned in <b>lpSrcDataObj</b>. </dd>
<dt>
<b>arrPasteEntries</b></dt>
<dd>
The <a href="structs_381l.htm">OLEUIPASTEENTRY</a> array which specifies acceptable formats. This field is filled on input.</dd>
<dt>
<b>cPasteEntries</b></dt>
<dd>
Number of OLEUIPASTEENTRY array entries. This field is filled on input.</dd>
<dt>
<b>arrLinkTypes</b></dt>
<dd>
List of link types that are acceptable. Link types are referred to using <a href="enums_0b6v.htm">OLEUIPASTEFLAG</a> in <b>arrPasteEntries</b>. This field is filled on input.</dd>
<dt>
<b>cLinkTypes</b></dt>
<dd>
Number of link types. This field is filled on input.</dd>
<dt>
<b>cClsidExclude</b></dt>
<dd>
Number of CLSIDs in <b>lpClsidExclude</b>. This field is filled on input.</dd>
<dt>
<b>lpClsidExclude</b></dt>
<dd>
Pointer to an array of CLSIDs to exclude from the list of available server objects for a Paste operation. Note that this does not affect Paste Link. An application can prevent embedding into itself by listing its own CLSID in this list. This field is filled on input.</dd>
<dt>
<b>nSelectedIndex</b></dt>
<dd>
Index of <b>arrPasteEntries</b>[] that the user selected. This field is filled on output.</dd>
<dt>
<b>fLink</b></dt>
<dd>
Whether Paste or Paste Link was selected by the user. This field is filled on output.</dd>
<dt>
<b>hMetaPict</b></dt>
<dd>
Handle to the Metafile containing the icon and icon title selected by the user. This field is filled on output.</dd>
<dt>
<b>sizel</b></dt>
<dd>
Size of object as displayed in its source, if the display aspect chosen by the user matches the aspect displayed in the source. If the user chooses a different aspect, then <i>sizel</i>.<i>cx</i> and <i>sizel</i>.<i>cy</i> are both set to zero. The size of the object as it is displayed in the source is retrieved from the ObjectDescriptor if <b>fLink</b> is FALSE and from the LinkSrcDescriptor if <b>fLink</b> is TRUE. This field is filled on output.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oledlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in oledlg.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_833g.htm"><b>OleUIPasteSpecial</b></a>, <a href="structs_381l.htm"><b>OLEUIPASTEENTRY</b></a>, <a href="enums_0b6v.htm"><b>OLEUIPASTEFLAG</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
