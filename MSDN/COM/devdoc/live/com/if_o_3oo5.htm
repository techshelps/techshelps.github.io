<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleObject::SetColorScheme</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleobject_setcolorscheme"></a>IOleObject::SetColorScheme</h2>
<p>
Specifies the color palette that the object application should use when it edits the specified object.</p>
<pre><code><b>HRESULT SetColorScheme(
  LOGPALETTE</b><i> *pLogpal</i>   //Pointer to a structure
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>pLogpal</i></dt>
<dd>
[in] Pointer to a <b>LOGPALETTE</b> structure that specifies the recommended palette.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Color palette received successfully.</dd>
<dt>
E_NOTIMPL</dt>
<dd>
Object does not support setting palettes.</dd>
<dt>
OLE_E_PALETTE</dt>
<dd>
Invalid <b>LOGPALETTE</b> structure pointed to by <i>lpLogPal</i>.</dd>
<dt>
OLE_E_NOTRUNNING</dt>
<dd>
Object must be running to perform this operation.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IOleObject::SetColorScheme</b> method sends the container application's recommended color palette to the object application, which is not obliged to use it.</p>
<h5>Notes to Implementers</h5>
<p>
Upon receiving the palette, the object application should:
<ol>
<li>
Allocate and fill in its own <b>LOGPALETTE</b> structure with the colors specified in the container application's <b>LOGPALETTE</b> structure.</li>
<li>
Call <b>CreatePalette</b> to create a palette from the resulting <b>LOGPALETTE </b>structure. This palette can be used to render objects and color menus as the user edits objects in the document.</li>
</ol>
<p>
The first palette entry in the <b>LOGPALETTE</b> structure specifies the foreground color recommended by the container. The second palette entry specifies the recommended background color. The first half of the remaining palette entries are fill colors and the second half are colors for the lines and text.</p>
<p>
Container applications typically specify an even number of palette entries. If a container specifies an odd number of entries, the object application should assume that the first half of the total entries plus one designate fill colors, while the remainder designate line and text colors. For example, if there are five entries, the first three should be interpreted as fill colors and the last two as line and text colors.</p>
<p>
</p>
<p>
</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<p>&nbsp;</p></body>
</HTML>
