<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExternalConnection::ReleaseConnection</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iexternalconnection_releaseconnection"></a>IExternalConnection::ReleaseConnection</h2>
<p>
Decrements an object's count of its strong external connections (references).</p>
<pre><code><b>HRESULT ReleaseConnection(
  DWORD</b><i> extconn</i><b>,  </b>//Type of external connection
<b>  DWORD</b><i> dwreserved</i><b>,</b>
<b>                  </b>//Used by OLE to pass connection information
<b>  BOOL</b><i> fLastReleaseCloses</i>
<i>                  </i>//Indicates whether connection is last one or not
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>extconn</i></dt>
<dd>
[in] Type of external connection to the object. The only type of external connection currently supported by this interface is strong, which means that the object must remain alive as long as this external connection exists. Strong external connections are represented by the value EXTCONN_STRONG = 0x0001, which is defined in the enumeration <b>EXTCONN</b>.</dd>
<dt>
<i>dwreserved</i></dt>
<dd>
[in] Passes information about the connection. This parameter is reserved for use by OLE. Its value can be zero, but not necessarily. Therefore, implementations of <b>ReleaseConnection</b> should not contain blocks of code whose execution depends on whether a zero value is returned.</dd>
<dt>
<i>fLastReleaseCloses</i></dt>
<dd>
[in] TRUE specifies that if the connection being released is the last external lock on the object, the object should close. FALSE specifies that the object should remain open until closed by the user or another process.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
<b>DWORD</b> value</dt>
<dd>
The number of connections to the object; used for debugging purposes only.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If <i>fLastReleaseCloses</i> equals TRUE, calling <b>ReleaseConnection</b> causes the object to shut itself down. Calling this method is the only way in which a DLL object, running in the same process space as the container application, will know when to close following a silent update.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_344u.htm"><b>IExternalConnection::AddConnection</b></a> </p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
