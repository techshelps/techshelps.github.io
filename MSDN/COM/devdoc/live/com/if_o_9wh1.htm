<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleInPlaceSiteWindowless::OnDefWindowMessage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleinplacesitewindowless_ondefwindowmessage"></a>IOleInPlaceSiteWindowless::OnDefWindowMessage</h2>
<p>
Invokes the default processing for all messages passed to an object.</p>
<pre><code><b>HRESULT OnDefWindowMessage(
  UINT</b><i> msg</i><b>,</b>           //Message Identifier as provided by Windows
<b>  WPARAM</b><i> wParam</i><b>,</b>      //Message parameter as provided by Windows
<b>  LPARAM</b><i> lParam</i><b>,</b>      //Message parameter as provided by Windows
<b>  LRESULT*</b><i> plResult</i>   //Pointer to message result code
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>msg</i></dt>
<dd>
[in] Identifier for the window message provided to the container by Windows.</dd>
<dt>
<i>wParam</i></dt>
<dd>
[in] Parameter for the window message provided to the container by Windows.</dd>
<dt>
<i>lParam</i></dt>
<dd>
[in] Parameter for the window message provided to the container by Windows.</dd>
<dt>
<i>plResult</i></dt>
<dd>
[out] Pointer to result code for the window message as defined in the Windows API.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The container's default processing for the window message was successfully invoked.</dd>
<dt>
S_FALSE</dt>
<dd>
The container's default processing for the window message was not invoked. See Note to Implementers below.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A windowless object can explicitly invoke the default processing for a window message by calling this method. A container dispatches window messages to its windowless objects by calling <b>IOleInPlaceObjectWindowless::OnWindowMessage</b>. The object usually returns S_FALSE to indicate that it did not process the message. Then, the container can perform the default behavior for the message by calling the Windows API function <b>DefWindowProc</b>.</p>
<p>
Instead, the object can call this method on the container's site object to explicitly invoke the default processing. Then, the object can take action on its own if the container does not handle the message.</p>
<h5>Note to Implementers</h5>
<p>
The container must pass the following window messages to its default window procedure (the <b>DefWindowProc</b> Windows API function) and return S_OK. Note that *<i>plResult</i> should contain the value returned by <b>DefWindowProc</b>.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>WM_MOUSEMOVE</td>
<td width=50%>WM_DEADCHAR</td>
</tr>
<tr valign=top>
<td width=50%>WM_<i>X</i>BUTTON<i>xxx</i></td>
<td width=50%>WM_SYSKEYUP</td>
</tr>
<tr valign=top>
<td width=50%>WM_KEYDOWN</td>
<td width=50%>WM_SYSCHAR</td>
</tr>
<tr valign=top>
<td width=50%>WM_KEYUP</td>
<td width=50%>WM_SYSDEADCHAR</td>
</tr>
<tr valign=top>
<td width=50%>WM_CHAR</td>
<td width=50%>WM_IME<i>xxx</i></td>
</tr>
</table><br>
<p>
The container can either process the window messages as its own and return S_OK or not do anything and return S_FALSE.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>WM_SETCURSOR</td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%>WM_CONTEXTMENU</td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%>WM_HELP</td>
<td width=50%></td>
</tr>
</table><br>
<p>
If the container returns S_FALSE, the object can take action to process the window message on its own.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_1u79.htm"><b>IOleInPlaceObjectWindowless::OnWindowMessage</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
