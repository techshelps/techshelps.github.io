<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleObject::Close</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleobject_close"></a>IOleObject::Close</h2>
<p>
Changes an embedded object from the running to the loaded state. Disconnects a linked object from its link source.</p>
<pre><code><b>HRESULT Close(
  DWORD</b><i> dwSaveOption  </i>//Indicates whether to save object before 
                      // closing
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>dwSaveOption</i></dt>
<dd>
[in] DWORD that indicates whether the object is to be saved as part of the transition to the loaded state. Valid values are taken from the enumeration <a href="enums_4hid.htm"><b>OLECLOSE</b></a>.


<p>
<b>Note</b>&nbsp;&nbsp;The OLE 2 user model recommends that object applications do not prompt users before saving linked or embedded objects, including those activated in place. This policy represents a change from the OLE 1 user model, in which object applications always prompt the user to decide whether to save changes.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The object closed successfully.</dd>
<dt>
OLE_E_PROMPTSAVECANCELLED</dt>
<dd>
The user was prompted to save but chose the Cancel button from the prompt message box.
</dd>
</dl>
<h4>Remarks</h4>
<h5>Notes to Callers</h5>
<p>
A container application calls <b>IOleObject::Close</b> when it wants to move the object from a running to a loaded state. Following such a call, the object still appears in its container but is not open for editing. Calling <b>IOleObject::Close</b> on an object that is loaded but not running has no effect. Closing a linked object simply means disconnecting it.</p>
<h5>Notes to Implementers</h5>
<p>
Upon receiving a call to <b>IOleObject::Close</b>, a running object should do the following:
<ul>
<li>
If the object has been changed since it was last opened for editing, it should request to be saved, or not, according to instructions specified in <i>dwSaveOption</i>. If the option is to save the object, then it should call its container's <a href="if_o_5v78.htm"><b>IOleClientSite::SaveObject</b></a> interface.</li>
<li>
If the object has <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a> connections with ADVF_DATAONSTOP flags, then it should send an OnDataChange notification. See <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a> for details.</li>
<li>
If the object currently owns the Clipboard, it should empty it by calling <a href="api3_123o.htm"><b>OleFlushClipboard</b></a>.</li>
<li>
If the object is currently visible, notify its container by calling <a href="if_o_7k1j.htm"><b>IOleClientSite::OnShowWindow</b></a> with the <i>fshow</i> argument set to FALSE.</li>
<li>
Send <b>IAdvise::OnClose</b> notifications to appropriate advise sinks.</li>
<li>
Finally, forcibly cut off all remoting clients by calling <a href="api1_4mk4.htm"><b>CoDisconnectObject</b></a>.</li>
</ul>
<p>
If the object application is a local server (an EXE rather than a DLL), closing the object should also shut down the object application unless the latter is supporting other running objects or has another reason to remain in the running state. Such reasons might include the presence of <a href="if_a2e_38vm.htm"><b>IClassFactory::LockServer</b></a> locks, end-user control of the application, or the existence of other open documents requiring access to the application.</p>
<p>
Calling <b>IOleObject::Close</b> on a linked object disconnects it from, but does not shut down, its source application. A source application that is visible to the user when the object is closed remains visible and running after the disconnection and does not send an <b>OnClose</b> notification to the link container.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="api1_4mk4.htm"><b>CoDisconnectObject</b></a>, <a href="if_a2e_5sth.htm"><b>IAdviseSink::OnClose</b></a>, <a href="if_a2e_38vm.htm"><b>IClassFactory::LockServer</b></a>, <a href="if_a2e_376t.htm"><b>IDataObject::DAdvise</b></a>, <a href="if_o_7k1j.htm"><b>IOleClientSite::OnShowWindow</b></a>, <a href="if_o_5v78.htm"><b>IOleClientSite::SaveObject</b></a>, <a href="enums_4hid.htm"><b>OLECLOSE</b></a>, <a href="api3_123o.htm"><b>OleFlushClipboard</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
