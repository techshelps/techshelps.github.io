<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMessageFilter::RetryRejectedCall</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_imessagefilter_retryrejectedcall"></a>IMessageFilter::RetryRejectedCall</h2>
<p>
A client-based method that gives the application an opportunity to display a dialog box so the user can retry or cancel the call, or switch to the task identified by <i>threadIDCallee.</i> </p>
<pre><code><b>DWORD RetryRejectedCall(
  HTASK</b><i> threadIDCallee</i><b>,  </b>//Server task handle
<b>  DWORD</b><i> dwTickCount</i><b>,     </b>//Elapsed tick count
<b>  DWORD</b><i> dwRejectType</i>     //Returned rejection message
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>threadIDCallee</i></dt>
<dd>
[in] Handle of the server task that rejected the call.</dd>
<dt>
<i>dwTickCount</i></dt>
<dd>
[in] Number of elapsed ticks since the call was made.</dd>
<dt>
<i>dwRejectType</i></dt>
<dd>
[in] Specifies either SERVERCALL_REJECTED or SERVERCALL_RETRYLATER, as returned by the object application.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
-1</dt>
<dd>
The call should be canceled. COM then returns RPC_E_CALL_REJECTED from the original method call.</dd>
<dt>
Value &gt;= 0 and &lt;100</dt>
<dd>
The call is to be retried immediately.</dd>
<dt>
Value &gt;= 100</dt>
<dd>
COM will wait for this many milliseconds and then retry the call.
</dd>
</dl>
<h4>Remarks</h4>
<p>
COM calls <b>RetryRejectedCall</b> on the caller's <b>IMessageFilter</b> immediately after receiving SERVERCALL_RETRYLATER or SERVERCALL_REJECTED from the <b>IMessageFilter::HandleInComingCall </b>method on the callee's <b>IMessageFilter</b>.<b> </b></p>
<p>
If a called task rejects a call, the application is probably in a state where it cannot handle such calls, possibly only temporarily. When this occurs, COM returns to the caller and issues <b>IMessageFilter::RetryRejectedCall</b> to determine if it should retry the rejected call. </p>
<p>
Applications should silently retry calls that have returned with SERVERCALL_RETRYLATER. If, after a reasonable amount of time has passed, say about 30 seconds, the application should display the busy dialog box; a standard implementation of this dialog box is available in the OLEDLG library. The callee may momentarily be in a state where calls can be handled. The option to wait and retry is provided for special kinds of calling applications, such as background tasks executing macros or scripts, so that they can retry the calls in a nonintrusive way. </p>
<p>
If, after a dialog box is displayed, the user chooses to cancel, <b>RetryRejectedCall</b> returns -1 and the call will appear to fail with RPC_E_CALL_REJECTED. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<p>&nbsp;</p></body>
</HTML>
