<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoRevokeClassObject</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_corevokeclassobject"></a>CoRevokeClassObject</h1>
<p>
Informs OLE that a class object, previously registered with the <a href="api1_6kz8.htm"><b>CoRegisterClassObject</b></a> function, is no longer available for use.</p>
<pre><code><b>HRESULT CoRevokeClassObject(
  DWORD</b><i> dwRegister  </i>//Token on class object
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>dwRegister</i></dt>
<dd>
[in] Token previously returned from the <a href="api1_6kz8.htm"><b>CoRegisterClassObject</b></a> function.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
This function supports the standard return values E_INVALIDARG, </dt>
</dl>
<p>
E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK </dt>
<dd>
The class object was successfully revoked.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A successful call to <b>CoRevokeClassObject</b> means that the class object has been removed from the global class object table (although it does not release the class object). If other clients still have pointers to the class object and have caused the reference count to be incremented by calls to <b>IUnknown::AddRef</b>, the reference count will not be zero. When this occurs, applications may benefit if subsequent calls (with the obvious exceptions of <b>IUnknown::AddRef</b> and <b>IUnknown::Release</b>) to the class object fail.</p>
<p>
An object application <i>must</i> call <b>CoRevokeClassObject</b> to revoke registered class objects before exiting the program. Class object implementers should call <b>CoRevokeClassObject</b> as part of the release sequence. You must specifically revoke the class object even when you have specified the <i>flags </i>value REGCLS_SINGLEUSE in a call to <b>CoRegisterClassObject</b>, indicating that only one application can connect to the class object.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api1_6yb8.htm"><b>CoGetClassObject</b></a>, <a href="api1_6kz8.htm"><b>CoRegisterClassObject</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
