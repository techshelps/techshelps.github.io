<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLEUICHANGESOURCE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleuichangesource_str"></a>OLEUICHANGESOURCE</h1>
<p>
This structure is used to initialize the standard Change Source dialog box. It allows the user to modify the destination or source of a link. This may simply entail selecting a different file name for the link, or possibly changing the item reference within the file, for example, changing the destination range of cells within the spreadsheet that the link is to.</p>
<pre><code>typedef struct tagOLEUICHANGESOURCEW 
{ 
// These IN fields are standard across all OLEUI dialog box functions. 
    DWORD          cbStruct; 
    DWORDT         dwFlags; 
    HWND           hWndOwner; 
    LPCWSTR        lpszCaption; 
    LPFNOLEUIHOOK  lpfnHook; 
    LPARAM         lCustData; 
    HINSTANCE      hInstance; 
    LPCWSTR        lpszTemplate; 
    HRSRC          hResource; 
 
// INTERNAL ONLY: do not modify these members 
    OPENFILENAMEW*     lpOFN; 
    DWORD              dwReserved1[4]; 
 
// Specifics for OLEUICHANGESOURCE. 
    LPOLEUILINKCONTAINERW  lpOleUILinkContainer; 
    DWORD                  dwLink;  
    LPTSTR                 lpszDisplayName; 
    ULONG                  nFileLength; 
    LPTSTR                 lpszFrom; 
    LPTSTR                 lpszTo; 
} OLEUICHANGESOURCEW, *POLEUICHANGESOURCEW, FAR *LPOLEUICHANGESOURCEW; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbStruct</b></dt>
<dd>
Size of the structure in bytes.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
On input, this field specifies the initialization and creation flags. On exit, it specifies the user's choices. It may be a combination of the following flags:
<dl>
<dt>
CSF_SHOWHELP</dt>
<dd>
Enables or shows the Help button.</dd>
<dt>
CSF_VALIDSOURCE</dt>
<dd>
Indicates that the link was validated.</dd>
<dt>
CSF_ONLYGETSOURCE</dt>
<dd>
Disables automatic validation of the link source when the user presses OK. If you specify this flag, you should validate the source when the dialog box returns OK. </dd>
</dl>
</dd>
<dt>
<b>hWndOwner</b></dt>
<dd>
Window that owns the dialog box. </dd>
<dt>
<b>lpszCaption</b></dt>
<dd>
Pointer to a string to be used as the title of the dialog box. If NULL, then the library uses Change Source.</dd>
<dt>
<b>lpfnHook</b></dt>
<dd>
Pointer to a hook function that processes messages intended for the dialog box. The hook function must return zero to pass a message that it didn't process back to the dialog box procedure in the library. The hook function must return a non-zero value to prevent the library's dialog box procedure from processing a message it has already processed. </dd>
<dt>
<b>lCustData</b></dt>
<dd>
Application-defined data that the library passes to the hook function pointed to by the <b>lpfnHook</b> member. The library passes a pointer to the <a href="api3_6tv2.htm"><b>OLEUICHANGEICON</b></a> structure in the <i>lParam</i> parameter of the WM_INITDIALOG message; this pointer can be used to retrieve the <b>lCustData</b> member. </dd>
<dt>
<b>hInstance</b></dt>
<dd>
Instance that contains a dialog box template specified by the <b>lpszTemplate</b> member. This member is ignored if the <b>lpszTemplate</b> member is NULL or invalid. </dd>
<dt>
<b>lpszTemplate</b></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the resource file for the dialog box template that is to be substituted for the library's Convert dialog box template. </dd>
<dt>
<b>hResource</b></dt>
<dd>
Resource handle for a custom dialog box. If this member is NULL, then the library uses the standard Convert dialog box template, or if it is valid, the template named by the <b>lpszTemplate</b> member.</dd>
<dt>
<b>lpOFN</b></dt>
<dd>
Pointer to the <b>OPENFILENAME</b> structure, which contains information used by the operating system to initialize the system-defined Open or Save As dialog boxes.</dd>
<dt>
<b>dwReserved1</b>[<b>4</b>]</dt>
<dd>
Reserved for future use.</dd>
<dt>
<b>lpOleUILinkContainer</b></dt>
<dd>
Pointer to the container's implementation of the <b>IOleUILinkContainer</b> interface, used to validate the link source. The Edit Links dialog box uses this to allow the container to manipulate its links.</dd>
<dt>
<b>dwLink</b></dt>
<dd>
Container-defined unique 32-bit link identifier used to validate link sources. Used by <b>lpOleUILinkContainer</b>. </dd>
<dt>
<b>lpszDisplayName</b></dt>
<dd>
Pointer to the complete source display name. </dd>
<dt>
<b>nFileLength</b></dt>
<dd>
File moniker portion of <b>lpszDisplayName</b>.</dd>
<dt>
<b>lpszFrom</b></dt>
<dd>
Pointer to the prefix of the source that was changed from.</dd>
<dt>
<b>lpszTo</b></dt>
<dd>
Pointer to the prefix of the source to be changed to. 
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oledlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in oledlg.dll.</p>
<h4>See Also</h4>
<p>
<a href="if_o_9bg2.htm"><b>IOleUILinkContainer</b></a>, <a href="api3_3679.htm"><b>OleUIChangeSource</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
