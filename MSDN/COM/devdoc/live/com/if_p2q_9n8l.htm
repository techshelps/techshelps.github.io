<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistPropertyBag::Save</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipersistpropertybag_save"></a>IPersistPropertyBag::Save</h2>
<p>
Called by the container to save the object's properties.</p>
<pre><code><b>HRESULT Save(
  IPropertyBag*</b><i> pPropBag</i><b>,</b> 
                     //Pointer to the caller's property bag
<b>  BOOL</b><i> fClearDirty</i><b>,  </b>//Specifies whether to clear the dirty flag
<b>  BOOL</b><i> fSaveAllProperties</i>
<i>                     </i>//Specifies whether to save all properties or 
                     //just those that have changed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pPropBag</i></dt>
<dd>
[in] Pointer to the caller's <b>IPropertyBag</b> interface through which the object can write properties. Cannot be NULL.</dd>
<dt>
<i>fClearDirty</i></dt>
<dd>
[in] A flag indicating whether the object should clear its dirty flag when saving is complete. TRUE means clear the flag, FALSE means leave the flag unaffected. FALSE is used when the caller wishes to do a Save Copy As type of operation.</dd>
<dt>
<i>fSaveAllProperties</i></dt>
<dd>
[in] A flag indicating whether the object should save all its properties (TRUE) or only those that have changed since the last save or initialization (FALSE).
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The object successfully saved the requested properties itself.</dd>
<dt>
E_FAIL</dt>
<dd>
There was a problem saving one of the properties. The object can choose to fail only if a necessary property could not be saved, meaning that the object can assume default property values if a given property is not seen through <b>IPersistPropertyBag::Load</b> at some later time.</dd>
<dt>
E_POINTER</dt>
<dd>
The address in <i>pPropBag </i>is not valid (such as NULL) and therefore the object cannot initialize itself.</dd>
<dt>
STG_E_MEDIUMFULL</dt>
<dd>
The object was not saved because of a lack of space on the disk.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method instructs the object to save its properties to the specified property bag, optionally clearing the object's dirty flag. The caller can request that the object save all properties or that the object save only those that are known to have changed.</p>
<p>
E_NOTIMPL is not a valid return code as any object implementing this interface must support the entire functionality of the interface.</p>
<h4>See Also</h4>
<p>
<a href="if_p2q_5t4n.htm"><b>IPersistPropertyBag::InitNew</b></a>, <a href="if_p2q_1ijo.htm"><b>IPersistPropertyBag::Load</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
