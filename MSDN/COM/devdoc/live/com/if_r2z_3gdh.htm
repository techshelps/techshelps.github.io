<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRunningObjectTable::GetTimeOfLastChange</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_irunningobjecttable_gettimeoflastchange"></a>IRunningObjectTable::GetTimeOfLastChange</h2>
<p>
Returns the time that an object was last modified. The object must have previously been registered with the Running Object Table (ROT). This method looks for the last change time recorded in the ROT. </p>
<pre><code><b>HRESULT GetTimeOfLastChange(
  IMoniker</b><i> *pmkObjectName</i><b>,  </b>//Pointer to moniker on the object whose 
                            //status is desired
<b>  FILETIME</b><i> *pfiletime       </i>//Pointer to structure that receives 
                            //object's last change time
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pmkObjectName</i></dt>
<dd>
[in] Pointer to the <b>IMoniker</b> interface on the<b> </b>moniker to search for in the ROT.</dd>
<dt>
<i>pfiletime</i></dt>
<dd>
[out] Pointer to a <a href="structs_3vdx.htm"><b>FILETIME</b></a> structure that receives the object's last change time.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The last change time was successfully retrieved.</dd>
<dt>
S_FALSE</dt>
<dd>
There is no entry for <i>pmkObjectName</i> in the ROT, or that the object it identifies is no longer running (in which case, the entry is revoked).
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method returns the change time that was last reported for this object by a call to <a href="if_r2z_0xph.htm"><b>IRunningObjectTable::NoteChangeTime</b></a>. If <b>IRunningObjectTable::NoteChangeTime</b> has not been called previously, the method returns the time that was recorded when the object was registered. </p>
<p>
This method is provided to enable checking whether a connection between two objects (represented by one object holding a moniker that identifies the other) is up-to-date. For example, if one object is holding cached information about the other object, this method can be used to check whether the object has been modified since the cache was last updated. See <a href="if_f2n_0k9x.htm"><b>IMoniker::GetTimeOfLastChange</b></a>. </p>
<h5>Notes to Callers</h5>
<p>
Generally, you call <b>IRunningObjectTable::GetTimeOfLastChange</b> only if you are writing your own moniker class (that is, implementing the <a href="if_f2n_8otu.htm"><b>IMoniker</b></a> interface). You typically call this method from your implementation of <a href="if_f2n_0k9x.htm"><b>IMoniker::GetTimeOfLastChange</b></a>. However, you should do so only if the <i>pmkToLeft</i> parameter of <b>IMoniker::GetTimeOfLastChange</b> is NULL. Otherwise, you should call <b>IMoniker::GetTimeOfLastChange</b> on your <i>pmkToLeft</i> parameter instead. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_0k9x.htm"><b>IMoniker::GetTimeOfLastChange</b></a>, <a href="if_r2z_0xph.htm"><b>IRunningObjectTable::NoteChangeTime</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
