<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleInPlaceSiteWindowless::SetCapture</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleinplacesitewindowless_setcapture"></a>IOleInPlaceSiteWindowless::SetCapture</h2>
<p>
Enables an in-place active, windowless object to capture all mouse messages.</p>
<pre><code><b>HRESULT SetCapture(
  BOOL</b><i> fCapture</i>   //Set or release mouse capture
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>fCapture</i></dt>
<dd>
[in] If TRUE, the container should capture the mouse for the object. If FALSE, the container should release mouse capture for the object.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Mouse capture was successfully granted to the object. If called to release the mouse capture, this method must not fail.</dd>
<dt>
S_FALSE</dt>
<dd>
Mouse capture was denied to the object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
A windowless object captures the mouse input, by calling  <b>IOleInPlaceSiteWindowless::SetCapture(TRUE)</b> on its site object. The container can deny mouse capture, in which case this method returns S_FALSE. If the capture is granted, the container must set the Windows mouse capture to its own window and dispatch any subsequent mouse message to the object, regardless of whether the mouse cursor position is over this object or not.</p>
<p>
The object can later release mouse capture by calling <b>IOleInPlaceSiteWindowless::SetCapture(FALSE)</b> on its site object. The capture can also be released because of an external event, such as the ESC key being pressed. In this case, the object is notified by a WM_CANCELMODE message that the container dispatches along with the keyboard focus.</p>
<p>
Containers should dispatch all mouse messages, including WM_SETCURSOR, to the windowless OLE object that has captured the mouse. If no object has captured the mouse, the container should dispatch the mouse message to the object under the mouse cursor.</p>
<p>
The container dispatches these window messages by calling <b>IOleInPlaceObjectWindowless::OnWindowMessage</b> on the windowless object. The windowless object can return S_FALSE to this method to indicate that it did not process the mouse message. Then, the container should perform the default behavior for the message by calling the Windows API function <b>DefWindowProc</b>. For WM_SETCURSOR, the container can either set the cursor itself or do nothing.</p>
<p>
Objects can also use <b>IOleInPlaceSiteWindowless::OnDefWindowMessage</b> to invoke the default message processing from the container. In the case of the WM_SETCURSOR message, this allows an object to take action if the container does not set the cursor.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. New for OC96.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ocidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_9wh1.htm"><b>IOleInPlaceSiteWindowless::OnDefWindowMessage</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
