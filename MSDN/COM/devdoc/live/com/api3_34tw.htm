<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleCreatePropertyFrameIndirect</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_olecreatepropertyframeindirect"></a>OleCreatePropertyFrameIndirect</h1>
<p>
Creates a property frame, that is, a property sheet dialog box, based on a structure (<b>OCPFIPARAMS</b>) that contains the parameters, rather than specifying separate parameters as when calling <b>OleCreatePropertyFrame.</b></p>
<pre><code><b>STDAPI OleCreatePropertyFrameIndirect(
  OCPFIPARAMS*</b><i> pParams  </i>//Pointer to the structure of parameters for 
                        // dialog box
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pParams</i></dt>
<dd>
[in] Pointer to the caller-allocated structure containing the creation parameters for the dialog box.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_INVALIDARG, E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
The dialog box was invoked and operated successfully.</dd>
<dt>
E_POINTER</dt>
<dd>
The address<i> </i>in <i>pParams</i> is not valid. For example, it may be NULL.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Besides <i>cbStructSize</i> (the size of the structure) and <i>dispIDInitialProperty</i>, all of the members of the <b>OCPFIPARAMS</b> structure have the same semantics as the parameters for <b>OleCreatePropertyFrame</b>. When <i>dispIDInitialProperty</i> is DISPID_UNKNOWN, the behavior of the two functions is identical.</p>
<p>
Working in conjunction with <b>IPerPropertyBrowsing</b> and <b>IPropertyPage2</b>, <i>dispIDInitialProperty</i> allows the caller to specify which single property should be highlighted when the dialog box is made visible. This feature is not available when using <b>OleCreatePropertyFrame</b>. To determine the page and property to show initially, the property frame will do the following:
<ol>
<li>
Call <code>(*lplpUnk)-&gt;QueryInterface(IID_IPerPropertyBrowsing, ...)</code> to get an interface pointer to the first object.</li>
<li>
Call <code>IPerPropertyBrowsing::MapPropertyToPage(dispIDInitialProperty, ...)</code> to determine which page <b>CLSID</b> contains the property to be highlighted. All objects for which this frame is being invoked must support the set of properties displayed in the frame.</li>
<li>
When the dialog box is created, the property page with the <b>CLSID</b> retrieved in Step 2 is activated with <b>IPropertyPage::Activate</b>.</li>
<li>
The property frame queries the active page for <b>IPropertyPage2</b>.</li>
<li>
If successful, the frame calls <code>IPropertyPage2::EditProperty(dispIDInitialProperty)</code> to highlight the correct field in that dialog box.</li>
</ol>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in olectl.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in olepro32.dll.</p>
<h4>See Also</h4>
<p>
<a href="structs_77oz.htm"><b>OCPFIPARAMS</b></a>, <a href="api3_81t1.htm"><b>OleCreatePropertyFrame</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
