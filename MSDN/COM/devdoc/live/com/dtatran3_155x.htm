<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The FORMATETC Structure</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_com_the_formatetc_structure"></a>The FORMATETC Structure</h3>
<p>
The FORMATETC structure is a generalized clipboard format, enhanced to encompass a target device, an<i> aspect </i>or view of the data, and a storage medium. A data consumer, such as an OLE container application, passes the FORMATETC structure as an argument in calls to <a href="if_a2e_24z8.htm"><b>IDataObject</b></a><b> </b>to indicate the type of data it wants from a data source, such as a compound document object. The source uses the FORMATETC structure to describe what formats it can provide. FORMATETC can describe virtually any data, including other objects such as monikers. A container can ask one of its embedded objects to list its data formats by calling <b>IDataObject::EnumFormatetc</b>, which returns an enumerator object that implements the <b>IEnumFormatEtc</b> interface. Instead of replying merely that it has "text and a bitmap," the object can provide a detailed description of the data, including the device (normally screen or printer) for which it is rendered, the aspect to be presented to the user (full contents, thumbnail, icon, or formatted for printing), and the storage medium containing the data (global memory, disk file, storage object, or stream). This ability to tightly describe data will, in time, result in higher quality printer and screen output as well as more efficiency in data browsing, where a thumbnail sketch is much faster to retrieve and display than a fully detailed rendering.</p>
<p>
The following table lists fields of the FORMATETC data structure and the information they specify:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=23%>Field</th>
<th align=left width=77%>Specifies</th>
</tr>
<tr valign=top>
<td width=23%>cfFormat</td>
<td width=77%>The format in which the data is to be rendered, which can be a standard clipboard format, a proprietary format, or an OLE format. For more information on OLE formats, see Chapter 5, "Compound Documents."</td>
</tr>
<tr valign=top>
<td width=23%>ptd</td>
<td width=77%>A DVTARGETDEVICE structure, which contains enough information about a Windows target device, such as a screen or printer, so that a handle to its device context (hDC) can be created using the Windows <b>CreateDC</b> function. </td>
</tr>
<tr valign=top>
<td width=23%>dwAspect</td>
<td width=77%>The aspect or view of the data to be rendered; can be the full contents, a thumbnail sketch, an icon, or formatted for printing.</td>
</tr>
<tr valign=top>
<td width=23%>lindex</td>
<td width=77%>The part of the aspect that is of interest; for the present, the value must be -1, indicating that the entire view is of interest.</td>
</tr>
<tr valign=top>
<td width=23%>tymed</td>
<td width=77%>The data's storage medium, which can be global memory, disk file, or an instance of one of COM's structured-storage interfaces.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
