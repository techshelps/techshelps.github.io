<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OleGetIconOfFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_olegeticonoffile"></a>OleGetIconOfFile</h1>
<p>
Returns a handle to a metafile containing an icon and string label for the specified file name.</p>
<pre><code><b>HGLOBAL OleGetIconOfFile(
  LPOLESTR</b><i> lpszPath</i><b>,    </b>//Pointer to string that specifies the file 
                        // for which info is requested
<b>  BOOL</b><i> fUseFileAsLabel  </i>//Whether to use the file name as the icon 
                        // label
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszPath</i></dt>
<dd>
[in] Pointer to a file for which the icon and string are requested.</dd>
<dt>
<i>fUseFileAsLabel</i></dt>
<dd>
[in] Whether or not to use the file name as the icon label.
</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
HGLOBAL</dt>
<dd>
The <i>hGlobal</i> returned is a handle to a metafile that contains an icon and label for the specified file. If there is no CLSID in the registration database for the file, then the string "Document" is used. If the value of <i>lpszPath</i> is NULL, then NULL is returned.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ole2.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_1twz.htm"><b>OleGetIconOfClass</b></a>,<b> <a href="api3_6er0.htm">OleMetafilePictFromIconAndLabel</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
