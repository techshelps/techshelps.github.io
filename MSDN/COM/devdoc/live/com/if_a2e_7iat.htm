<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDataObject::GetDataHere</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_idataobject_getdatahere"></a>IDataObject::GetDataHere</h2>
<p>
Called by a data consumer to obtain data from a source data object. This method differs from the <b>GetData</b> method in that the caller must allocate and free the specified storage medium.</p>
<pre><code><b>HRESULT GetDataHere(
  FORMATETC *</b><i> pFormatetc</i><b>,  </b>//Pointer to the FORMATETC structure
<b>  STGMEDIUM *</b><i> pmedium  </i>//Pointer to the STGMEDIUM structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pFormatetc</i></dt>
<dd>
[in] Pointer to the FORMATETC structure that defines the format, medium, and target device to use when passing the data. Only one medium can be specified in <a href="enums_986c.htm"><b>TYMED</b></a>, and only the following TYMED values are valid: TYMED_STORAGE, TYMED_STREAM, TYMED_HGLOBAL, or TYMED_FILE.</dd>
<dt>
<i>pmedium</i></dt>
<dd>
[out] Pointer to the STGMEDIUM structure that defines the storage medium containing the data being transferred. The medium must be allocated by the caller and filled in by <b>IDataObject::GetDataHere</b>. The caller must also free the medium. The implementation of this method must always supply a value of NULL for the <i>punkForRelease</i> member of the STGMEDIUM structure to which this parameter points.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return values E_INVALIDARG, E_UNEXPECTED, and E_OUTOFMEMORY, as well as the following: 
<dl>
<dt>
S_OK</dt>
<dd>
Data was successfully retrieved and placed in the storage medium provided.</dd>
<dt>
DV_E_LINDEX</dt>
<dd>
Invalid value for <i>lindex</i>; currently, only -1 is supported.</dd>
<dt>
DV_E_FORMATETC</dt>
<dd>
Invalid value for <i>pFormatetc</i>.</dd>
<dt>
DV_E_TYMED</dt>
<dd>
Invalid <i>tymed</i> value.</dd>
<dt>
DV_E_DVASPECT</dt>
<dd>
Invalid <i>dwAspect</i> value.</dd>
<dt>
OLE_E_NOTRUNNING</dt>
<dd>
Object application is not running.</dd>
<dt>
STG_E_MEDIUMFULL</dt>
<dd>
The medium provided by the caller is not large enough to contain the data.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IDataObject::GetDataHere</b> method is similar to <a href="if_a2e_1jz5.htm"><b>IDataObject::GetData</b></a>, except that the caller must both allocate and free the medium specified in <i>pmedium</i>. <b>GetDataHere</b> renders the data described in a <a href="structs_14v7.htm"><b>FORMATETC</b></a> structure and copies the data into that caller-provided <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> structure. For example, if the medium is TYMED_HGLOBAL, this method cannot resize the medium or allocate a new <i>hGlobal</i>.</p>
<p>
Some media are not appropriate in a call to <b>GetDataHere</b>, including GDI types such as metafiles. The <b>GetDataHere</b> method cannot put data into a caller-provided metafile. In general, the only storage media it is necessary to support in this method are TYMED_ISTORAGE, TYMED_ISTREAM, and TYMED_FILE. </p>
<p>
When the transfer medium is a stream, OLE makes assumptions about where the data is being returned and the position of the stream's seek pointer. In a <b>GetData</b> call, the data returned is from stream position zero through just before the current seek pointer of the stream (that is, the position on exit). For <b>GetDataHere</b>, the data returned is from the stream position on entry through just before the position on exit. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_1jz5.htm"><b>IDataObject::GetData</b></a>, <a href="structs_14v7.htm"><b>FORMATETC</b></a>, <a href="structs_0gfh.htm"><b>STGMEDIUM</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
