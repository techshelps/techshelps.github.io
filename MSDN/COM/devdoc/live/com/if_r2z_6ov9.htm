<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IStream::Clone</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_istream_clone"></a>IStream::Clone</h2>
<p>
Creates a new stream object with its own seek pointer that references the same bytes as the original stream. </p>
<pre><code><b>HRESULT Clone(
  IStream **</b><i> ppstm  </i>//Points to location for pointer to the new 
                    // stream object
<b>);</b>
 </code></pre>
<h4>Parameter</h4>
<dl>
<dt>
<i>ppstm</i></dt>
<dd>
[out] When successful, points to the location of an <b>IStream</b> pointer to the new stream object. If an error occurs, this parameter is NULL.</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
The stream was successfully cloned.</dd>
<dt>
E_PENDING</dt>
<dd>
Asynchronous Storage only: Part or all of the stream's data is currently unavailable. For more information see <a href="if_f2n_5xdf.htm"><b>IFillLockBytes</b></a> and <a href="asyncstg_86cl.htm">Asynchronous Storage</a>. </dd>
<dt>
STG_E_INSUFFICIENT_MEMORY</dt>
<dd>
The stream was not cloned due to a lack of memory.</dd>
<dt>
STG_E_INVALIDPOINTER</dt>
<dd>
The <i>ppStm</i> pointer is not valid.</dd>
<dt>
STG_E_REVERTED</dt>
<dd>
The object has been invalidated by a revert operation above it in the transaction tree.</dd>
</dl>
<h4>Remarks</h4>
<p>
This method creates a new stream object for accessing the same bytes but using a separate seek pointer. The new stream object sees the same data as the source stream object. Changes written to one object are immediately visible in the other. Range locking is shared between the stream objects. </p>
<p>
The initial setting of the seek pointer in the cloned stream instance is the same as the current setting of the seek pointer in the original stream at the time of the clone operation.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also<i> </i></h4>
<p>
<a href="if_r2z_459q.htm"><b>IStream - Compound File Implementation</b></a>, <a href="if_r2z_3lkf.htm"><b>IStream::CopyTo</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
