<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RegisterMediaTypeClass</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_registermediatypeclass"></a>RegisterMediaTypeClass</h1>
<p>
Registers a mapping of media types to CLSIDs to override the default mapping specified in the registry. The new mapping is used calls to <b>IMoniker::BindToObject</b> when binding objects in the specified bind context.</p>
<pre><code><b>HRESULT RegisterMediaTypeClass(
  LPBC</b><i> pbc</i><b>,            </b>//Pointer to the bind context
<b>  UINT</b><i> ctypes</i><b>,         </b>//Number of media type strings in <i>rgszTypes</i>
<b>  LPCSTR </b><i> *rgszTypes</i><b>,  </b>//Pointer to array of media types to be 
                       // registered
<b>  CLSID </b><i> *rgclsID</i><b>,     </b>//Pointer to array of CLSIDs corresponding to 
                       // <i>rgszTypes</i>
<b>  DWORD </b><i> dwReserved    </i>//Reserved for future use; must be zero
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pbc</i></dt>
<dd>
[in] Pointer to the <b>IBindCtx</b> interface for the bind context in which the media types are to be registered.</dd>
<dt>
<i>ctypes</i></dt>
<dd>
[in] Number of media type strings in the <i>rgszTypes</i> array. This parameter cannot be zero.</dd>
<dt>
<i>rgszTypes</i></dt>
<dd>
[in] Pointer to an array of strings identifying the media types to be registered. None of these strings can be NULL.</dd>
<dt>
<i>rgclsID</i></dt>
<dd>
[in] Pointer to an array of CLSIDs corresponding to the media type strings in the <i>rgszTypes</i> array.</dd>
<dt>
<i>dwReserved</i></dt>
<dd>
[in] Reserved for future use; must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
The operation was successful.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
One or more parameters are invalid.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This function is primarily used by moniker clients calling <b>IMoniker::BindToObject</b> to override the default registry mapping between mime types and CLSIDs. In most cases, the default mapping provided in the registry is used. However, a web browser may want the CLSID for its HTML viewer to be associated with .TXT files without changing the default registry association for text files. The override is used for all bind operations using the specified bind context.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in urlmon.h.</p>
<h4>See Also</h4>
<p>
<a href="api3_31v7.htm"><b>RegisterMediaTypes</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
