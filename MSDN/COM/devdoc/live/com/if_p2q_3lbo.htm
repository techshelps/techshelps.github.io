<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersist</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ipersist"></a>IPersist</h1>
<p>
The <b>IPersist</b> interface defines the single method <b>GetClassID</b>, which is designed to supply the CLSID of an object that can be stored persistently in the system. A call to this method can allow the object to specify which object handler to use in the client process, as it is used in the OLE default implementation of marshaling.</p>
<p>
<b>IPersist</b> is the base interface for three other interfaces: <a href="if_p2q_8crp.htm"><b>IPersistStorage</b></a>, <a href="if_p2q_02b1.htm"><b>IPersistStream</b></a>, and <a href="if_p2q_99ph.htm"><b>IPersistFile</b></a>. Each of these interfaces, therefore, includes the <b>GetClassID</b> method, and the appropriate one of these three interfaces is implemented on objects that can be serialized to a storage, a stream, or a file. The methods of these interfaces allow the state of these objects to be saved for later instantiations, and load the object using the saved state. Typically, the persistence interfaces are implemented by an embedded or linked object, and are called by the container application or the default object handler</p>
<h5>When to Implement</h5>
<p>
You must implement the single method of <b>IPersist</b> in implementing any one of the other persistence interfaces: <a href="if_p2q_8crp.htm"><b>IPersistStorage</b></a>, <a href="if_p2q_02b1.htm"><b>IPersistStream</b></a>, or <a href="if_p2q_99ph.htm"><b>IPersistFile</b></a>. Typically, for example, you would implement <b>IPersistStorage</b> on an embedded object, <b>IPersistFile</b> on a linked object, and <b>IPersistStream</b> on a new moniker class, although their uses are not limited to these objects. You could implement <b>IPersist</b> in a situation where all that is required is to obtain the CLSID of a persistent object, as it is used in marshaling.</p>
<h5>When to Use</h5>
<p>
The single method of <b>IPersist</b> is rarely called directly in application code. It is called by the default object handler to get the CLSID of an embedded object, or an object to be marshaled. A container application, for example, would probably not call the <b>GetClassID</b> method directly unless it provided object handlers for specific classes of objects.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%><a href="if_r2z_9dwu.htm">IUnknown</a> Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=52%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=52%>Increments the reference count.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=52%>Decrements the reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>IPersist Method</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_1yn8.htm"><b>GetClassID</b></a></td>
<td width=52%>Returns the class identifier (CLSID) for the component object.</td>
</tr>
</table><br>
<p>
</p>
<p>
</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<p>&nbsp;</p></body>
</HTML>
