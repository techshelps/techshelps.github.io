<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistStorage::Save</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ipersiststorage_save"></a>IPersistStorage::Save</h2>
<p>
Saves an object, and any nested objects that it contains, into the specified storage. The object is placed in NoScribble mode, and it must not write to the specified storage until it receives a call to its <a href="if_p2q_115w.htm"><b>IPersistStorage::SaveCompleted</b></a> method.</p>
<pre><code><b>HRESULT Save(
  IStorage</b><i> *pStgSave</i><b>,</b>   //Pointer to storage object
<b>  BOOL</b><i> fSameAsLoad      </i>//Indicates whether the specified storage 
                        //object is the current one
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pStgSave</i></dt>
<dd>
[in]<b>IStorage</b> pointer to the storage into which the object is to be saved.</dd>
<dt>
<i>fSameAsLoad</i></dt>
<dd>
[in]Indicates whether the specified storage is the current one, which was passed to the object by one of the following calls:
<ul>
<li>
<a href="if_p2q_7hyv.htm"><b>IPersistStorage::InitNew</b></a> when it was created.</li>
<li>
<a href="if_p2q_34pw.htm"><b>IPersistStorage::Load</b></a> when it was loaded.</li>
<li>
<a href="if_p2q_115w.htm"><b>IPersistStorage::SaveCompleted</b></a> when it was saved to a storage different from its current storage.</li>
</ul>

<p>
This parameter is set to FALSE when performing a Save As or Save A Copy To operation or when performing a full save. In the latter case, this method saves to a temporary file, deletes the original file, and renames the temporary file.

<p>
This parameter is set to TRUE to perform a full save in a low-memory situation or to perform a fast incremental save in which only the dirty components are saved.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK </dt>
<dd>
The object was successfully saved.</dd>
<dt>
STG_E_MEDIUMFULL</dt>
<dd>
The object was not saved because of a lack of space on the disk.</dd>
<dt>
E_FAIL</dt>
<dd>
The object could not be saved due to errors other than a lack of disk space.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method saves an object, and any nested objects it contains, into the specified storage. It also places the object into NoScribble mode. Thus, the object cannot write to its storage until a subsequent call to the <a href="if_p2q_115w.htm"><b>IPersistStorage::SaveCompleted</b></a> method returns the object to Normal mode.</p>
<p>
If the storage object is the same as the one it was loaded or created from, the save operation may be able to write incremental changes to the storage object. Otherwise, a full save must be done.</p>
<p>
This method recursively calls the <b>IPersistStorage::Save</b> method, the <a href="api3_9hb9.htm"><b>OleSave</b></a> function, or the <a href="if_r2z_8yr3.htm"><b>IStorage::CopyTo</b></a> method to save its nested objects.</p>
<p>
This method does not call the <a href="if_r2z_11h0.htm"><b>IStorage::Commit</b></a> method. Nor does it write the CLSID to the storage object. Both of these tasks are the responsibilities of the caller.</p>
<h5>Notes to Callers</h5>
<p>
Rather than calling <b>IPersistStorage::Save</b> directly, you typically call the <a href="api3_9hb9.htm"><b>OleSave</b></a> helper function which performs the following steps:
<ol>
<li>
Call the <a href="api4_6smf.htm"><b>WriteClassStg</b></a> function to write the class identifier for the object to the storage.</li>
<li>
Call the <b>IPersistStorage::Save</b> method.</li>
<li>
If needed, call the <a href="if_r2z_11h0.htm"><b>IStorage::Commit</b></a> method on the storage object.</li>
</ol>
<p>
Then, a container application performs any other operations necessary to complete the save and calls the <b>SaveCompleted</b> method for each object.</p>
<p>
If an embedded object passes the <b>IPersistStorage::Save</b> method to its nested objects, it must receive a call to its <a href="if_p2q_115w.htm"><b>IPersistStorage::SaveCompleted</b></a> method before calling this method for its nested objects.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_p2q_7hyv.htm"><b>IPersistStorage::InitNew</b></a>, <a href="if_p2q_34pw.htm"><b>IPersistStorage::Load</b></a>, <a href="if_p2q_115w.htm"><b>IPersistStorage::SaveCompleted</b></a>, <a href="api3_9hb9.htm"><b>OleSave</b></a>, <a href="if_r2z_11h0.htm"><b>IStorage::Commit</b></a>, <a href="if_r2z_8yr3.htm"><b>IStorage::CopyTo</b></a>, <a href="api3_9hb9.htm"><b>OleSave</b></a>, <a href="api4_6smf.htm"><b>WriteClassStg</b></a>, <a href="api4_4kx3.htm"><b>WriteFmtUserTypeStg</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
