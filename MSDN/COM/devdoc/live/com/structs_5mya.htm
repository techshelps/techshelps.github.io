<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLEUICHANGEICON</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_oleuichangeicon_str"></a>OLEUICHANGEICON</h1>
<p>
The <b>OLEUICHANGEICON </b>structure contains information that the OLE User Interface Library uses to initialize the Change Icon dialog box, and it contains space for the library to return information when the dialog box is dismissed.</p>
<pre><code>typedef struct tagOLEUICHANGEICON 
{ 
// These IN fields are standard across all OLEUI dialog box functions. 
    DWORD          cbStruct; 
    DWORD          dwFlags; 
    HWND           hWndOwner; 
    LPCSTR         lpszCaption; 
    LPFNOLEUIHOOK  lpfnHook; 
    LPARAM         lCustData; 
    HINSTANCE      hInstance; 
    LPCSTR         lpszTemplate; 
    HRSRC          hResource; 
 
 // Specifics for OLEUICHANGEICON.
    HGLOBAL  hMetaPict; 
    CLSID    clsid; 
    char     szIconExe[OLEUI_CCHPATHMAX]; 
    int      cchIconExe; 
} OLEUICHANGEICON, *POLEUICHANGEICON, FAR *LPOLEUICHANGEICON; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbStruct</b></dt>
<dd>
Size of the structure in bytes. This field must be filled on input.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
On input, specifies the initialization and creation flags. On exit, it specifies the user's choices. It can be a combination of the following flags:
<dl>
<dt>
CIF_SHOWHELP</dt>
<dd>
Dialog box will display a Help button.</dd>
<dt>
CIF_SELECTCURRENT</dt>
<dd>
On input, selects the Current radio button on initialization. On exit, specifies that the user selected Current.</dd>
<dt>
CIF_SELECTDEFAULT</dt>
<dd>
On input, selects the Default radio button on initialization. On exit, specifies that the user selected Default.</dd>
<dt>
CIF_SELECTFROMFILE</dt>
<dd>
On input, selects the From File radio button on initialization. On exit, specifies that the user selected From File.</dd>
<dt>
CIF_USEICONEXE</dt>
<dd>
Input only. Extracts the icon from the executable specified in the <b>szIconExe</b> member, instead of retrieving it from the class. This is useful for OLE embedding or linking to non-OLE files.</dd>
</dl>
</dd>
<dt>
<b>hWndOwner</b></dt>
<dd>
Window that owns the dialog box. It should not be NULL.</dd>
<dt>
<b>lpszCaption</b></dt>
<dd>
Pointer to a string to be used as the title of the dialog box. If NULL, then the library uses Change Icon.</dd>
<dt>
<b>lpfnHook</b></dt>
<dd>
Pointer to a hook function that processes messages intended for the dialog box. The hook function must return zero to pass a message that it didn't process back to the dialog box procedure in the library. The hook function must return a non-zero value to prevent the library's dialog box procedure from processing a message it has already processed. </dd>
<dt>
<b>lCustData</b></dt>
<dd>
Application-defined data that the library passes to the hook function pointed to by the <b>lpfnHook</b> member. The library passes a pointer to the <b>OLEUICHANGEICON</b> structure in the <i>lParam</i> parameter of the WM_INITDIALOG message; this pointer can be used to retrieve the <b>lCustData</b> member. </dd>
<dt>
<b>hInstance</b></dt>
<dd>
Instance that contains a dialog box template specified by the <i>lpTemplateName</i> member. </dd>
<dt>
<b>lpszTemplate</b></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the resource file for the dialog box template that is to be substituted for the library's Change Icon dialog box template. </dd>
<dt>
<b>hResource</b></dt>
<dd>
Customized template handle.</dd>
<dt>
<b>hMetaPict</b></dt>
<dd>
Current and final image. The source of the icon is embedded in the metafile itself.</dd>
<dt>
<b>clsid</b></dt>
<dd>
Input only. The class to use to get the Default icon.</dd>
<dt>
<b>szIconExe</b></dt>
<dd>
Input only. Pointer to the executable to extract the default icon from. This member is ignored unless CIF_USEICONEXE is included in the <i>dwFlags</i> parameter and an attempt to retrieve the class icon from the specified CLSID fails. </dd>
<dt>
<b>cchIconExe</b></dt>
<dd>
Input only. The number of characters in <b>szIconExe</b>. This member is ignored unless CIF_USEICONEXE is included in the <b>dwFlags</b> member.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oledlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in oledlg.dll.</p>
<h4>See Also</h4>
<p>
<a href="api3_6tv2.htm"><b>OleUIChangeIcon</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
