<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Single-/Multi-threaded Communication</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_single_multi_threaded_communication"></a>Single-/Multi-threaded Communication</h2>
<p>
A client or server that supports both single and multi-threaded apartments will have one multi-threaded apartment, containing all threads initialized as free-threaded, and one or more single-threaded apartments. Interface pointers must be marshaled between apartments but can be used without marshaling within an apartment. Calls to objects in a single-threaded apartment will be synchronized by COM. Calls to objects in the multi-threaded apartment will not be synchronized by COM. </p>
<p>
All of the information on single-threaded apartments applies to the threads marked as apartment model, and all of the information on multi-threaded apartments applies to all of the threads marked as free -threaded. Apartment threading rules apply to inter-apartment communication, requiring that interface pointers be marshaled between apartments with calls to <b>CoMarshalInterThreadInterfaceInStream</b> and <b>CoGetInterfaceAndReleaseStream</b>, as described in the <a href="com_68s3.htm"><b>Single-threaded Apartments</b></a> section. For information on free-threading, see the <a href="com_00hf.htm"><b>Multi-threaded apartments</b></a> section. Some special considerations apply when dealing with in-process servers, as described in <a href="com_1ik3.htm"><b>In-process Server Threading Issues</b></a>.</p>
<p>&nbsp;</p></body>
</HTML>
