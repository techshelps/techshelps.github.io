<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ILayoutStorage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ilayoutstorage"></a>ILayoutStorage</h1>
<p>
The <b>ILayoutStorage</b> interface enables an application to optimize the layout of its compound files for efficient downloading across a slow link. The goal is to enable a browser or other application to download data in the order in which it will actually be needed.</p>
<p>
To optimize a compound file an application first saves it, then calls <a href="api4_82n9.htm"><b>StgOpenLayoutDocfile</b></a> to reopen the file using a special Compound Files implementation that exposes <b>ILayoutStorage</b> on its root storage. Once the storage is open, the application queries for a pointer to <b>ILayoutStorage</b>.</p>
<p>
Using this pointer, the application can either provide explicit layout instructions or obtain them by monitoring the pattern of access to the compound file as it is loaded into memory.
<ul>
<li>
To monitor the order in which a compound file's data is actually accessed, the application calls <a href="if_f2n_4tki.htm"><b>ILayoutStorage::BeginMonitor</b></a>, after which the Compound Files implementation assumes that any operation performed on the storage or stream object is part of the desired access pattern. When the specified compound file is completely loaded, the application halts monitoring by calling <a href="if_f2n_78aa.htm"><b>ILayoutStorage::EndMonitor</b></a>.</li>
</ul>
<p>
However the desired layout information is obtained, the application calls <a href="if_f2n_0t0l.htm"><b>ILayoutStorage::ReLayoutDocfile</b></a> to rewrite the compound file using either the explicit layout instructions or the monitored layout access patterns.</p>
<h5>When to Implement </h5>
<p>
You do not need to implement this interface. A special implementation of Compound Files exposes <b>ILayoutStorage</b> on the root storage object.</p>
<h5>When to Use</h5>
<p>
Use <b>ILayoutStorage</b> to optimize your application's compound files. The interface is exposed in dflayout.dll, which is included with the Win32 SDK. If you are a web master, you can optimize compound files exposed in your web site by using the <b>Docfile Layout Tool </b>(dflayout.exe), which is also included with the Win32 SDK.</p>
<h4>Methods in VTable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>IUnknown Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=52%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=52%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=52%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>ILayout Storage Method</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_f2n_01kk.htm"><b>LayoutScript</b></a></td>
<td width=52%>Provides explicit layout instructions.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_f2n_4tki.htm"><b>BeginMonitor</b></a></td>
<td width=52%>Monitors data access to a file.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_f2n_78aa.htm"><b>EndMonitor</b></a></td>
<td width=52%>Ends monitoring of data access.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_f2n_0t0l.htm"><b>ReLayoutDocfile</b></a></td>
<td width=52%>Rewrites file using layout information.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="#_com_ilayoutstorage"><b>ILayoutStorage</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
