<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOleAdviseHolder::Advise</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_ioleadviseholder_advise"></a>IOleAdviseHolder::Advise</h2>
<p>
Establishes an advisory connection between an OLE object and the calling object's advise sink. Through that sink, the calling object can receive notification when the OLE object is renamed, saved, or closed.</p>
<pre><code><b>HRESULT Advise(
  IAdviseSink *</b><i> pAdvise</i><b>, </b>//Pointer to the advise sink on the calling 
                         // object
<b>  DWORD *</b><i> pdwConnection  </i>//Pointer to a token
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pAdvise</i></dt>
<dd>
[in] Pointer to the <b>IAdviseSink</b> interface on the advisory sink that should be informed of changes.</dd>
<dt>
<i>pdwConnection</i></dt>
<dd>
[out] Pointer to a token that can be passed to the <a href="if_o_6izp.htm"><b>IOleAdviseHolder::Unadvise</b></a> method to delete the advisory connection. The calling object is responsible for calling both <a href="if_r2z_3rja.htm"><b>IUnknown::AddRef</b></a> and <a href="if_r2z_59np.htm"><b>IUnknown::Release</b></a> on this pointer.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This method supports the standard return value E_INVALIDARG, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
Advisory connections set up successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Containers, object handlers, and link objects all create advise sinks to receive notification of changes in compound-document objects of interest, such as embedded or linked objects. OLE objects of interest to these objects must implement the <b>IOleObject</b> interface, which includes several advisory methods, including <a href="if_o_1gh1.htm"><b>IOleObject::Advise</b></a>. A call to this method must set up an advisory connection with any advise sink that calls it, and maintain each connection until it is closed. It must be able to handle more than one advisory connection at a time. </p>
<p>
<b>IOleAdviseHolder::Advise</b> is intended to be used to simplify the implementation of <b>IOleObject::Advise</b>. You can get a pointer to the OLE implementation of <b>IOleAdviseHolder</b> by calling <a href="api2_0pbm.htm"><b>CreateOleAdviseHolder</b></a>, and then, to implement <b>IOleObject::Advise</b>, just delegate the call to <b>IOleAdviseHolder::Advise</b>. Other <b>IOleAdviseHolder</b> methods are intended to implement other <b>IOleObject </b>advisory methods.</p>
<p>
If the attempt to establish an advisory connection is successful, the object receiving the call returns a nonzero value through <i>pdwConnection</i>. If the attempt fails, the object returns a zero. To delete an advisory connection, the object with the advise sink passes this nonzero token back to the object by calling <b>IOleAdviseHolder::Unadvise</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_o_6izp.htm"><b>IOleAdviseHolder::UnAdvise</b></a>,<b> <a href="if_o_1cx1.htm">IOleAdviseHolder::EnumAdvise</a></b>,<b> <a href="if_o_1gh1.htm">IOleObject::Advise</a></b> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
