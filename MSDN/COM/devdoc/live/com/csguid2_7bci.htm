<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Binding to a Class Store Provider</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_binding_to_a_class_store_provider"></a>Binding to a Class Store Provider</h1>
<p>
When binding to a class store provider listed in the class store search path, the Class Store Manager object performs the following operations:
<ol>
<li>
Call <b>MkParseDisplayName</b>, which finds the provider's ProgID (the URL prefix), and creates the class factory object for the provider object.</li>
<li>
<b>MkParseDisplayName</b> queries the provider object for <b>IParseDisplayName</b> to pass the URL (moniker display name) to the provider's class factory.</li>
<li>
The provider's class factory looks for an existing moniker object for this URL in the Running Object Table (ROT). If an object already exists, a reference to this object is returned to the caller.</li>
<li>
If no object exists in the ROT, the provider's class factory creates a new object and, in the case of the provider for ADSI/LDAP, passes it the remainder of the URL.</li>
<li>
The newly-created ADSI/LDAP provider moniker object calls <b>MkParseDisplayName</b> which finds the LDAP ProgID and creates the class factory for the LDAP ADSI provider object.</li>
<li>
<b>MkParseDisplayName</b> queries the LDAP ADSI provider for <b>IParseDisplayName</b>, then passes the LDAP URL.</li>
<li>
The LDAP ADSI provider returns a moniker object initialized to the LDAP URL, which is returned to the provider moniker object.</li>
<li>
The provider moniker object binds to the LDAP ADSI moniker and queries for IID_IADSObject.</li>
<li>
The provider's class factory returns an initialized moniker object to the client.</li>
<li>
The Class Store Manager binds to the moniker object, which returns the ADCS object.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
