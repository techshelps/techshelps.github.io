<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPersistStorage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_ipersiststorage"></a>IPersistStorage</h1>
<p>
The <b>IPersistStorage</b> interface defines methods that enable a container application to pass a storage object to one of its contained objects and to load and save the storage object. This interface supports the structured storage model, in which each contained object has its own storage that is nested within the container's storage.</p>
<p>
The <b>IPersistStorage</b> contract inherits its definition from <a href="if_p2q_3lbo.htm"><b>IPersist</b></a>, so all implementations must also include the <b>GetClassID</b> method of <b>IPersist</b>.</p>
<h5>When to Implement</h5>
<p>
Any object that can be embedded in a container must implement the <b>IPersistStorage</b> interface. This interface is one of the primary interfaces for a compound document object. Embeddable objects must also implement the <a href="if_o_9778.htm"><b>IOleObject</b></a> and <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interfaces.</p>
<p>
The OLE default handler for embedded objects provides an implementation of the <b>IPersistStorage</b> interface that is used when the object is in the loaded state. Similarly, the OLE default link handler provides an <b>IPersistStorage</b> implementation that manages storage for a linked object. These default handlers both interact with the OLE default cache implementation, which has its own <b>IPersistStorage</b> implementation.</p>
<p>
If you are providing a custom embedding or link handler for your objects, the handler must include an implementation of <b>IPersistStorage</b>. You can delegate calls to the default handler so you can take advantage of the default cache implementation.</p>
<h5>When to Use</h5>
<p>
When an OLE container creates a new object, loads an existing object from storage, or inserts a new object in a clipboard or a drag-and-drop operation, the container uses the <b>IPersistStorage</b> interface to initialize the object and put it in the loaded or running state. When an object is loaded or running, an OLE container calls other <b>IPersistStorage</b> methods to instruct the object to perform various save operations or to release its storage.</p>
<p>
Typically, applications use helper functions such as <a href="api3_1cmc.htm"><b>OleLoad</b></a> or <a href="api3_6y5h.htm"><b>OleCreate</b></a>, rather than calling the <a href="if_p2q_34pw.htm"><b>IPersistStorage::Load</b></a> or <a href="if_p2q_7hyv.htm"><b>IPersistStorage::InitNew</b></a> methods directly. Similarly, applications typically call the <a href="api3_9hb9.htm"><b>OleSave</b></a> helper function rather than calling <a href="if_p2q_19et.htm"><b>IPersistStorage::Save</b></a> directly.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%><a href="if_r2z_9dwu.htm">IUnknown</a> Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=52%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=52%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=52%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%><a href="if_p2q_3lbo.htm">IPersist</a> Method</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_1yn8.htm"><b>GetClassID</b></a></td>
<td width=52%>Returns the class identifier (CLSID) for the object on which it is implemented.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>IPersistStorage Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_85x5.htm"><b>IsDirty</b></a></td>
<td width=52%>Indicates whether the object has changed since it was last saved to its current storage.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_7hyv.htm"><b>InitNew</b></a></td>
<td width=52%>Initializes a new storage object.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_34pw.htm"><b>Load</b></a></td>
<td width=52%>Initializes an object from its existing storage.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_19et.htm"><b>Save</b></a></td>
<td width=52%>Saves an object, and any nested objects that it contains, into the specified storage object. The object enters NoScribble mode.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_115w.htm"><b>SaveCompleted</b></a></td>
<td width=52%>Notifies the object that it can revert from NoScribble or HandsOff mode, in which in must not write to its storage object, to Normal mode in which it can.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_p2q_1z1h.htm"><b>HandsOffStorage</b></a></td>
<td width=52%>Instructs the object to release all storage objects that have been passed to it by its container and to enter HandsOffAfterSave or HandsOffFromNormal mode.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objidl.h.</p>
<h4>See Also</h4>
<p>
<a href="if_a2e_24z8.htm"><b>IDataObject</b></a>, <a href="if_o_9778.htm"><b>IOleObject</b></a>, <a href="api3_6y5h.htm"><b>OleCreate</b></a>, <a href="api3_1cmc.htm"><b>OleLoad</b></a>, <a href="api3_9hb9.htm"><b>OleSave</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
