<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoGetTreatAsClass</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_cogettreatasclass"></a>CoGetTreatAsClass</h1>
<p>
Returns the CLSID of an object that can emulate the specified object.</p>
<pre><code><b>HRESULT CoGetTreatAsClass(
  REFCLSID</b><i> clsidOld</i><b>,</b>   //CLSID of object that is being emulated
<b>  LPCLSID</b><i> pclsidNew    </i>//Pointer to CLSID for object that can 
                       // emulate <i>clsidOld</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>clsidOld</i></dt>
<dd>
[in] CLSID of the object that can be emulated (treated as) an object with a different CLSID.</dd>
<dt>
<i>pclsidNew</i></dt>
<dd>
[out] Pointer to where the CLSID that can emulate <i>clsidOld</i> objects is retrieved. This parameter cannot be NULL. If there is no emulation information for <i>clsidOld</i> objects, the <i>clsidOld</i> parameter is supplied.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
A new CLSID was successfully returned.</dd>
<dt>
S_FALSE </dt>
<dd>
No emulation information for the <i>clsidOld</i> parameter and that the <i>pclsidNew</i> parameter is set to <i>clsidOld</i>.</dd>
<dt>
REGDB_E_READREGDB</dt>
<dd>
An error reading the registry.
</dd>
</dl>
<p>
This function can also return any of the error values returned by the <a href="api1_3b3b.htm"><b>CLSIDFromString</b></a> function.</p>
<h4>Remarks</h4>
<p>
<b>CoGetTreatAsClass</b> returns the <b>TreatAs</b> entry in the registry for the specified object. The <b>TreatAs</b> entry, if set, is the CLSID of a registered object (an application) that can emulate the object in question. The <b>TreatAs</b> entry is set through a call to the <b>CoTreatAsClass</b> function. Emulation allows an application to open and edit an object of a different format, while retaining the original format of the object. Objects of the original CLSID are activated and treated as objects of the second CLSID. When the object is saved, this may result in loss of edits not supported by the original format. If there is no <b>TreatAs</b> entry for the specfied object, this function returns the CLSID of the original object (<i>clsidOld</i>). </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api1_9cqb.htm"><b>CoTreatAsClass</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
