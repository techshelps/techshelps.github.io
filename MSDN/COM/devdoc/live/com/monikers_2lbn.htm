<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Anti-monikers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_anti_monikers"></a>Anti-monikers</h2>
<p>
OLE provides an implementation of a special type of moniker called an <i>anti-moniker</i>. You use this moniker in the creation of new moniker classes. You use it as the inverse of the moniker that it is composed onto, effectively canceling that moniker, in much the same way that the ".." operator moves up a directory level in a file system command. </p>
<p>
It is necessary to have an anti-moniker available, because once a composite moniker is created, it is not possible to delete parts of the moniker if, for example, an object moves. Instead, you use an anti-moniker to remove one or more entries from a composite moniker.</p>
<p>
Anti-monikers are a moniker class explicitly intended for use as an inverse. COM defines an API function named <a href="api2_6vci.htm"><b>CreateAntiMoniker</b></a>, which returns an anti-moniker. You generally use this function to implement the <a href="if_f2n_2zvp.htm"><b>IMoniker::Inverse</b></a> method. </p>
<p>
An anti-moniker is <i>only</i> an inverse for those types of monikers that are implemented to treat anti-monikers as an inverse. For example, if you want to remove the last piece of a composite moniker, you should not create an anti-moniker and compose it to the end of the composite. You cannot be sure that the last piece of the composite considers an anti-moniker to be its inverse. Instead, you should call <a href="if_f2n_44od.htm"><b>IMoniker::Enum</b></a> on the composite moniker, specifying <b>FALSE</b> as the first parameter. This creates an enumerator that returns the component monikers in reverse order. Use the enumerator to retrieve the last piece of the composite, and call <b>IMoniker::Inverse</b> on that moniker. The moniker returned by <b>IMoniker::Inverse</b> is what you need to remove the last piece of the composite. </p>
<p>&nbsp;</p></body>
</HTML>
