<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoQueryAuthenticationServices</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_coqueryauthenticationservices"></a>CoQueryAuthenticationServices</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Retrieves a list of the authentication services registered when the process called <a href="api1_8ayh.htm"><b>CoInitializeSecurity</b></a>.</p>
<pre><code><b>HRESULT CoQueryAuthenticationServices(
  DWORD *</b><i> pcAuthSvc</i><b>,  </b>//Pointer to the number of entries returned in 
                      // the array
<b>  SOLE_AUTHENTICATION_SERVICE**</b><i> asAuthSvc</i>
<i>                      </i>//Pointer to an array of structures
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pcAuthSvc</i></dt>
<dd>
[out] Pointer to return the number of entries returned in the <i>rgAuthSvc</i> array. May not be NULL.</dd>
<dt>
<i>asAuthSvc</i></dt>
<dd>
[out] Pointer to an array of <a href="structs_31np.htm"><b>SOLE_AUTHENTICATION_SERVICE</b></a> structures. The list is allocated through a call to <a href="api1_9bj7.htm"><b>CoTaskMemAlloc</b></a>. The caller must free the list when finished with it by calling <a href="api1_63l1.htm"><b>CoTaskMemFree</b></a>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_INVALIDARG and E_OUTOFMEMORY, as well as the following:
<dl>
<dt>
S_OK </dt>
<dd>
Indicates success.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>CoQueryAuthenticationServices</b> retrieves a list of the authentication services currently registered. If the process calls <a href="api1_8ayh.htm"><b>CoInitializeSecurity</b></a>, these are the services registered through that call. If the application does not call it, <b>CoInitializeSecurity</b> is called automatically by COM, registering the default security package, the first time an interface is marshaled or unmarshaled. </p>
<p>
This function returns only the authentication services registered with <b>CoInitializeSecurity</b>. It does not return all of the authentication services installed on the machine, but <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_enumeratesecuritypackages">
</object><a href=JavaScript:alink_1.Click()><b>EnumerateSecurityPackages</b></a> does. <b>CoQueryAuthenticationServices</b> is primarily useful for custom marshalers, to determine which principal names an application can use.</p>
<p>
Different authentication services support different levels of security. For example, NTLMSSP does not support delegation or mutual authentication while Kerberos does. The application is responsible only for registering authentication services that provide the features the application needs. This function provides a way to find out which services have been registered with <b>CoInitializeSecurity</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="api1_8ayh.htm"><b>CoInitializeSecurity</b></a>, <a href="structs_31np.htm"><b>SOLE_AUTHENTICATION_SERVICE</b></a> structure, <a href="comext_47fx.htm"><b>Security in COM</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
