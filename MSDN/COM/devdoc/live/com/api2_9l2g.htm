<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MonikerCommonPrefixWith</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_monikercommonprefixwith"></a>MonikerCommonPrefixWith</h1>
<p>
Creates a new moniker based on the common prefix that this moniker (the one comprising the data of this moniker object) shares with another moniker. This function is intended to be called only in implementations of <a href="if_f2n_9nu0.htm"><b>IMoniker::CommonPrefixWith</b></a>.</p>
<pre><code><b>WINOLEAPI MonikerCommonPrefixWith(
  LPMONIKER</b><i> pmkThis</i><b>,  </b>//Pointer to the first moniker being compared
<b>  LPMONIKER</b><i> pmkOther</i><b>, </b>//Pointer to the second moniker being compared
<b>  LPMONIKER FAR</b><i> *ppmkCommon</i>
<i>                      </i>//Address of output variable that receives the 
                      // IMoniker interface pointer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pmkThis</i></dt>
<dd>
[in] Pointer to the <b>IMoniker</b> interface on one of the monikers for which a common prefix is sought; usually the moniker in which this call is used to implement <b>IMoniker::CommonPrefixWith</b>.</dd>
<dt>
<i>pmkOther</i></dt>
<dd>
[in] Pointer to the <b>IMoniker</b> interface on the other moniker to compare with the first moniker.</dd>
<dt>
<i>ppmkCommon</i></dt>
<dd>
[out] Address of <b>IMoniker</b>* pointer variable that receives the interface pointer to the moniker based on the common prefix of <i>pmkThis</i> and <i>pmkOther</i>. When successful, the function has called <a href="if_r2z_3rja.htm"><b>IUnknown::AddRef</b></a> on the moniker and the caller is responsible for calling <a href="if_r2z_59np.htm"><b>IUnknown::Release</b></a>. If an error occurs, the supplied interface pointer value is NULL.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function supports the standard return values E_OUTOFMEMORY and E_UNEXPECTED, as well as the following:
<dl>
<dt>
S_OK</dt>
<dd>
A common prefix exists that is neither <i>pmkThis</i> nor <i>pmkOther</i>.</dd>
<dt>
MK_S_HIM</dt>
<dd>
The entire <i>pmkOther</i> moniker is a prefix of the <i>pmkThis</i> moniker.</dd>
<dt>
MK_S_ME</dt>
<dd>
The entire <i>pmkThis</i> moniker is a prefix of the <i>pmkOther</i> moniker.</dd>
<dt>
MK_S_US</dt>
<dd>
The <i>pmkThis</i> and <i>pmkOther</i> monikers are equal.</dd>
<dt>
MK_E_NOPREFIX</dt>
<dd>
The monikers have no common prefix.</dd>
<dt>
MK_E_NOTBINDABLE</dt>
<dd>
This function was called on a relative moniker. It is not meaningful to take the common prefix of relative monikers. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
Call <b>MonikerCommonPrefixWith</b> only in the implementation of <a href="if_f2n_9nu0.htm"><b>IMoniker::CommonPrefixWith</b></a> for a new moniker class.</p>
<p>
Your implementation of <b>IMoniker::CommonPrefixWith</b> should first check whether the other moniker is of a type that you recognize and handle in a special way. If not, you should call <b>MonikerCommonPrefixWith</b>, passing itself as <i>pmkThis</i> and the other moniker as <i>pmkOther</i>. <b>MonikerCommonPrefixWith</b> correctly handles the cases where either moniker is a generic composite. </p>
<p>
You should call this function only if <i>pmkThis</i> and <i>pmkOther</i> are both absolute monikers (where an absolute moniker is either a file moniker or a generic composite whose leftmost component is a file moniker, and where the file moniker represents an absolute path). Do not call this function on relative monikers.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in objbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in ole32.dll.</p>
<h4>See Also</h4>
<p>
<a href="if_f2n_9nu0.htm"><b>IMoniker::CommonPrefixWith</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
