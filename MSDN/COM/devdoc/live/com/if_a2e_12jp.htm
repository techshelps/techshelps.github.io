<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDropSource</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_idropsource"></a>IDropSource</h1>
<p>
The <b>IDropSource</b> interface is one of the interfaces you implement to provide drag-and-drop operations in your application. It contains methods used in any application used as a data source in a drag-and-drop operation. The data source application in a drag-and-drop operation is responsible for:
<ul>
<li>
Determining the data being dragged based on the user's selection.</li>
<li>
Initiating the drag-and-drop operation based on the user's mouse actions.</li>
<li>
Generating some of the visual feedback during the drag-and-drop operation, such as setting the cursor and highlighting the data selected for the drag-and-drop operation.</li>
<li>
Canceling or completing the drag-and-drop operation based on the user's mouse actions.</li>
<li>
Performing any action on the original data caused by the drop operation, such as deleting the data on a drag move.</li>
</ul>
<p>
<b>IDropSource</b> contains the methods for generating visual feedback to the end user and for canceling or completing the drag-and-drop operation. You also need to call the <a href="api2_5now.htm"><b>DoDragDrop</b></a>, <a href="api3_9eeo.htm"><b>RegisterDragDrop</b></a>, and <a href="api3_2jow.htm"><b>RevokeDragDrop</b></a> functions in drag-and-drop operations.</p>
<h5>When to Implement</h5>
<p>
Implement <b>IDropSource</b> if you are developing a container or server application that can act as a data source for a drag-and-drop operation. The <b>IDropSource</b> interface is only required during the drag-and-drop operation.</p>
<p>
If you implement the <b>IDropSource</b> interface, you must also implement the <a href="if_a2e_24z8.htm"><b>IDataObject</b></a> interface on the same object to represent the data being transferred.</p>
<p>
You can use the same implementation of <b>IDataObject</b> for drag-and-drop data as for the data object offered to the clipboard. Once you have implemented clipboard operations in your application, you can add drag-and-drop operations with only a little extra work. </p>
<h5>When to Use</h5>
<p>
You don't usually call <b>IDropSource</b> methods directly. Instead, your data source calls the <a href="api2_5now.htm"><b>DoDragDrop</b></a> function when it detects that the user has initiated a drag-and-drop operation. Then, <b>DoDragDrop</b> calls the <b>IDropSource</b> methods during the drag-and-drop operation. </p>
<p>
For example, <b>DoDragDrop</b> calls <a href="if_a2e_6lkb.htm"><b>IDropSource::GiveFeedback</b></a> when you need to change the cursor shape or when you need to provide some other visual feedback. <b>DoDragDrop</b> calls <a href="if_a2e_5ew7.htm"><b>IDropSource::QueryContinueDrag</b></a> when there is a change in the mouse button state to determine if the drag-and-drop operation was canceled or completed.</p>
<h4>Methods in Vtable Order</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%><a href="if_r2z_9dwu.htm">IUnknown</a> Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_7fvp.htm"><b>QueryInterface</b></a></td>
<td width=52%>Returns pointers to supported interfaces.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_3rja.htm"><b>AddRef</b></a></td>
<td width=52%>Increments reference count.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_r2z_59np.htm"><b>Release</b></a></td>
<td width=52%>Decrements reference count.</td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>IDropSource Methods</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%><a href="if_a2e_5ew7.htm"><b>QueryContinueDrag</b></a></td>
<td width=52%>Determines whether a drag-and-drop operation should continue.</td>
</tr>
<tr valign=top>
<td width=48%><a href="if_a2e_6lkb.htm"><b>GiveFeedback</b></a></td>
<td width=52%>Gives visual feedback to an end user during a drag-and-drop operation.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleidl.h.</p>
<h4>See Also</h4>
<p>
<a href="api2_5now.htm"><b>DoDragDrop</b></a>, <a href="if_a2e_24z8.htm"><b>IDataObject</b></a>, <a href="if_a2e_2y7o.htm"><b>IDropTarget</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
