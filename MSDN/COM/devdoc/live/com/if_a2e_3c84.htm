<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAccessControl::IsAccessAllowed</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_com_iaccesscontrol_isaccessallowed"></a>IAccessControl::IsAccessAllowed</h2>
<p>
Determines if the given trustee has access rights to the object/property.</p>
<pre><code><b>HRESULT IsAccessAllowed(
  PTRUSTEEW</b><i> pTrustee</i><b>,           </b>//Pointer to the trustee
<b>  LPWSTR</b><i> lpProperty</i><b>,           </b>//Name of the property
<b>  ACCESS_RIGHTS</b><i> AccessRights</i><b>,  </b>//Access rights on the object
<b>  BOOL *</b><i> pfAccessAllowed       </i>//Pointer to access permission
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pTrustee</i></dt>
<dd>
[in] Pointer to the trustee.</dd>
<dt>
<i>lpProperty</i></dt>
<dd>
[in] Name of the property.</dd>
<dt>
<i>AccessRights</i></dt>
<dd>
[in] Access rights on the object.</dd>
<dt>
<i>pfAccessAllowed</i></dt>
<dd>
[out] Pointer to access permission.
</dd>
</dl>
<h4>Remarks</h4>
<p>
In the system-supplied implementation of <b>IAccessControl</b> (CLSID_DCOMAccessControl), <b>IsAccessAllowed</b> can be called only during a distributed COM call, and the only valid trustee name is the name of the client. </p>
<p>
This method uses the ACCESS_RIGHTS data structure, which is defined as follows:</p>
<pre><code>typedef    ULONG    ACCESS_RIGHTS
 </code></pre>
<p>
Bit 28 in an access permission can have the following values:</p>
<pre><code>#define ACTRL_ACCESS_ALLOWED    0x00000000
        //Denotes that this is an access-allowed entry
    #define ACTRL_ACCESS_DENIED     0x10000000
        //Denotes that this is an access-denied entry
 </code></pre>
<p>
The following table lists the object-specific access permissions:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=42%>Access Permission</th>
<th align=left width=13%>Object-type</th>
<th align=left width=45%>Description</th>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DS_OPEN</td>
<td width=13%>Ds</td>
<td width=45%>Open of a DS object</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DS_CREATE_CHILD</td>
<td width=13%>Ds</td>
<td width=45%>Creation of a child object</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DS_DELETE_CHILD</td>
<td width=13%>Ds</td>
<td width=45%>Deletion of a child object</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DS_LIST</td>
<td width=13%>Ds</td>
<td width=45%>Enumerate an object</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DS_SELF</td>
<td width=13%>Ds</td>
<td width=45%>Member list updates involving the trustee</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DS_READ_PROP</td>
<td width=13%>Ds</td>
<td width=45%>Read properties</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DS_WRITE_PROP</td>
<td width=13%>Ds</td>
<td width=45%>Write properties</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE-READ</td>
<td width=13%>File</td>
<td width=45%>Read from a file</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE_WRITE</td>
<td width=13%>File</td>
<td width=45%>Write to a file</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE_APPEND</td>
<td width=13%>File</td>
<td width=45%>Append to a file</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE_READ_PROP</td>
<td width=13%>File</td>
<td width=45%>Read file properties / Extended attributes</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE_WRITE_PROP</td>
<td width=13%>File</td>
<td width=45%>Write file properties / Extended attributes</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE_EXECUTE</td>
<td width=13%>File</td>
<td width=45%>Execute the file</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE_READ_ATTRIB</td>
<td width=13%>File</td>
<td width=45%>Read the file attributes</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_FILE_WRITE_ATTRIB</td>
<td width=13%>File</td>
<td width=45%>Write the file attributes</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DIR_LIST</td>
<td width=13%>Directory</td>
<td width=45%>List the contents of a directory</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DIR_CREATE_OBJECT</td>
<td width=13%>Directory</td>
<td width=45%>Create a child object (file) in a directory</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DIR_CREATE_CHILD</td>
<td width=13%>Directory</td>
<td width=45%>Create a subdirectory</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DIR_DELETE_CHILD</td>
<td width=13%>Directory</td>
<td width=45%>Delete a subdirectory</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_DIR_TRAVERSE</td>
<td width=13%>Directory</td>
<td width=45%>Traverse through the directory</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_KILL</td>
<td width=13%>Kernel</td>
<td width=45%>Kill a kernel item (process / thread)</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_THREAD</td>
<td width=13%>Kernel</td>
<td width=45%>Allow for the creation of a thread</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_VM</td>
<td width=13%>Kernel</td>
<td width=45%>Allow for address space operations</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_VM_READ</td>
<td width=13%>Kernel</td>
<td width=45%>Read memory</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_VM_WRITE</td>
<td width=13%>Kernel</td>
<td width=45%>Write memory</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_DUP_HANDLE</td>
<td width=13%>Kernel</td>
<td width=45%>Duplicate a handle</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_PROCESS</td>
<td width=13%>Kernel</td>
<td width=45%>Create a process</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_SET_INFO</td>
<td width=13%>Kernel</td>
<td width=45%>Get kernel object information/state</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_GET_INFO</td>
<td width=13%>Kernel</td>
<td width=45%>Set kernel object information/state</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_CONTROL</td>
<td width=13%>Kernel</td>
<td width=45%>Allow for the control of a kernel object (such as suspending a thread)</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_ALERT</td>
<td width=13%>Kernel</td>
<td width=45%>TBD</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_GET_CONTEXT</td>
<td width=13%>Kernel</td>
<td width=45%>Get the threads context</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_SET_CONTEXT</td>
<td width=13%>Kernel</td>
<td width=45%>Set the threads context</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_TOKEN</td>
<td width=13%>Kernel</td>
<td width=45%>Set the threads token</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_IMPERSONATE</td>
<td width=13%>Kernel</td>
<td width=45%>Client impersonation</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_KERNEL_DIMPERSONATE</td>
<td width=13%>Kernel</td>
<td width=45%>Direct client impersonation</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_PRINT_SADMIN</td>
<td width=13%>Printer</td>
<td width=45%>Print server administration</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_PRINT_SLIST</td>
<td width=13%>Printer</td>
<td width=45%>Print server enumeration</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_PRINT_PADMIN</td>
<td width=13%>Printer</td>
<td width=45%>Printer administration</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_PRINT_PUSE</td>
<td width=13%>Printer</td>
<td width=45%>Can the printer be used</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_PRINT_JADMIN</td>
<td width=13%>Printer</td>
<td width=45%>Print job administration</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_GET_INFO</td>
<td width=13%>Service</td>
<td width=45%>Get the info on a service</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_SET_INFO</td>
<td width=13%>Service</td>
<td width=45%>Set the info on a service</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_STATUS</td>
<td width=13%>Service</td>
<td width=45%>Get the status of a service</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_LIST</td>
<td width=13%>Service</td>
<td width=45%>Enumerate the services</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_START</td>
<td width=13%>Service</td>
<td width=45%>Start a service</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_STOP</td>
<td width=13%>Service</td>
<td width=45%>Stop a service</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_PAUSE</td>
<td width=13%>Service</td>
<td width=45%>Pause a service</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_INTERROGATE</td>
<td width=13%>Service</td>
<td width=45%>Query the service for the current status</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_SVC_UCONTROL</td>
<td width=13%>Service</td>
<td width=45%>User-defined control</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_REG_QUERY</td>
<td width=13%>Registry</td>
<td width=45%>Read a registry sub key</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_REG_SET</td>
<td width=13%>Registry</td>
<td width=45%>Write a registry sub key</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_REG_CREATE_CHILD</td>
<td width=13%>Registry</td>
<td width=45%>Create a registry sub key</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_REG_LIST</td>
<td width=13%>Registry</td>
<td width=45%>Enumerate a registry sub key</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_REG_NOTIFY</td>
<td width=13%>Registry</td>
<td width=45%>Create a registry notification</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_REG_LINK</td>
<td width=13%>Registry</td>
<td width=45%>Create a symbolic link</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_CLIPBRD</td>
<td width=13%>Window</td>
<td width=45%>Allow access to the clipboard</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_GLOBAL_ATOMS</td>
<td width=13%>Window</td>
<td width=45%>Allow global-atom access</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_CREATE</td>
<td width=13%>Window</td>
<td width=45%>Create desktop access</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_LIST_DESK</td>
<td width=13%>Window</td>
<td width=45%>Enumerate the desktops</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_LIST</td>
<td width=13%>Window</td>
<td width=45%>Enumerate the window station</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_READ_ATTRIBS</td>
<td width=13%>Window</td>
<td width=45%>Read the attributes</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_WRITE_ATTRIBS</td>
<td width=13%>Window</td>
<td width=45%>Write the attributes</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_SCREEN</td>
<td width=13%>Window</td>
<td width=45%>Allow access to the screen</td>
</tr>
<tr valign=top>
<td width=42%>ACTRL_WIN_EXIT</td>
<td width=13%>Window</td>
<td width=45%>Call ExitWindows* functions</td>
</tr>
</table><br>
<p>
</p>
<p>
</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Available as a Windows 95 redistributable.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in oleext.h.</p>
<p>&nbsp;</p></body>
</HTML>
