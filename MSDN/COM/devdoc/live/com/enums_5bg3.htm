<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSHLFLAGS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_com_mshlflags"></a>MSHLFLAGS</h1>
<p>
The <b>MSHLFLAGS</b> enumeration constants determine why the marshaling is to be done. These flags are used in the <a href="if_f2n_6sh8.htm"><b>IMarshal</b></a><b> </b>interface and the <a href="api1_8205.htm"><b>CoMarshalInterface</b></a><b> </b>and<b> <a href="api1_88q4.htm">CoGetStandardMarshal</a></b> functions.</p>
<pre><code>typedef enum tagMSHLFLAGS 
{ 
    MSHLFLAGS_NORMAL         = 0, 
    MSHLFLAGS_TABLESTRONG    = 1, 
    MSHLFLAGS_TABLEWEAK      = 2 
    MSHLFLAGS_NOPING         = 3
} MSHLFLAGS; 
 </code></pre>
<h4>Elements</h4>
<dl>
<dt>
MSHLFLAGS_NORMAL</dt>
<dd>
The marshaling is occurring because an interface pointer is being passed from one process to another. This is the normal case. The data packet produced by the marshaling process will be unmarshaled in the destination process. The marshaled data packet can be unmarshaled just once, or not at all. If the receiver unmarshals the data packet successfully, the <a href="api1_02u9.htm"><b>CoReleaseMarshalData</b></a> function is automatically called on the data packet as part of the unmarshaling process. If the receiver does not or cannot unmarshal the data packet, the sender must call the <b>CoReleaseMarshalData</b> function on the data packet. </dd>
<dt>
MSHLFLAGS_TABLESTRONG</dt>
<dd>
The marshaling is occurring because the data packet is to be stored in a globally accessible table from which it can be unmarshaled one or more times, or not at all. The presence of the data packet in the table counts as a strong reference to the interface being marshaled, meaning that it is sufficient to keep the object alive. When the data packet is removed from the table, the table implementer must call the <b>CoReleaseMarshalData</b> function on the data packet. 
<p>
MSHLFLAGS_TABLESTRONG is used by the <a href="api3_9eeo.htm"><b>RegisterDragDrop</b></a> function when registering a window as a drop target. This keeps the window registered as a drop target no matter how many times the end user drags across the window. The <a href="api3_2jow.htm"><b>RevokeDragDrop</b></a> function calls <b>CoReleaseMarshalData</b>. 
</dd>
<dt>
MSHLFLAGS_TABLEWEAK</dt>
<dd>
The marshaling is occurring because the data packet is to be stored in a globally accessible table from which it can be unmarshaled one or more times, or not at all. However, the presence of the data packet in the table acts as a weak reference to the interface being marshaled, meaning that it is not sufficient to keep the object alive. When the data packet is removed from the table, the table implementer must call the <a href="api1_02u9.htm"><b>CoReleaseMarshalData</b></a> function on the data packet. 
<p>
MSHLFLAGS_TABLEWEAK is typically used when registering an object in the Running Object Table (ROT). This prevents the object's entry in the ROT from keeping the object alive in the absence of any other connections. See <a href="if_r2z_33n6.htm"><b>IRunningObjectTable::Register</b></a> for more information. 
</dd>
<dt>
MSHLFLAGS_NOPING</dt>
<dd>
Adding this flag to an original object marshaling (as opposed to marshaling a proxy) will disable the ping protocol for that object.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 3.1 and later. <br>
&nbsp;&nbsp;<b>Windows:</b> Use Windows 95 and later. <br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in wtypes.h.</p>
<h4>See Also</h4>
<p>
<a href="api1_88q4.htm"><b>CoGetStandardMarshal</b></a>, <a href="api1_8205.htm"><b>CoMarshalInterface</b></a>, <a href="api1_02u9.htm"><b>CoReleaseMarshalData</b></a>, <a href="if_f2n_6sh8.htm"><b>IMarshal</b></a> </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
