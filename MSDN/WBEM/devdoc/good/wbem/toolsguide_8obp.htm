<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating an Event Consumer Instance</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_hmm_creating_an_event_consumer_instance"></a>Creating an Event Consumer Instance</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You create event consumers as instances of a given class. This version of WBEM contains a predefined EventViewerConsumer class, which is a subclass of the <b>__EventConsumer </b>system class.</p>
<p>
The first procedure describes how to create an event consumer instance. The second and third procedures are intended to work along with the example filters and timers.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create an event consumer instance</h5>
<ol>
<li>
From the drop-down list box, choose <b>Consumers</b>.</li>
<li>
Click the class you want to create an instance, and click the <b>New Instance</b> button.<p>
—or—
</li>
<li>
Right-click on the class you want to create an instance, and choose <b>New Instance</b> from the pop-up menu. The <b>Edit new instance properties</b> dialog box appears.</li>
</ol>
<p>
<img src="evpropscrn.gif" border=0>
<ol start=4>
<li>
In the <b>Edit new instance properties</b> dialog box, type strings in the <b>Description</b> and <b>Name</b> fields, and type a value in the <b>Severity</b> field.</li>
<li>
Click OK to create the instance.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create the ServiceStopped event consumer instance</h5>
<p>
This example defines an instance that, in conjunction with the ServiceStoppedEvent filter, triggers an event notification and displays it in the <a href="toolsguide_7v02.htm">Event Viewer</a> when a system service is stopped.
<ol>
<li>
From the drop-down list box, choose <b>Consumers</b>.</li>
<li>
Click the EventViewerConsumer class, and click the <b>New Instance</b> button.<p>
—or—
</li>
<li>
Right-click on the EventViewerConsumer class, and choose <b>New Instance</b> from the pop-up menu. The <b>Edit new instance properties</b> dialog box appears.</li>
<li>
In the <b>Edit new instance properties</b> dialog box, type the following:<ol type=a>
<li>
In the <b>Description</b> field, type <i>Service was stopped</i>. </li>
<li>
In the <b>Name</b> field, type <i>ServiceStopped</i>.<i> </i></li>
<li>
In the <b>Severity</b> field, type <i>1</i>.</li>
</ol>
</li>
<li>
Click OK to create the instance.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create the TimerEvent event consumer instance</h5>
<p>
This example defines a consumer that works with IntervalTimerFilter or AbsTimerFilter This triggers an event notification and displays it in the <a href="toolsguide_7v02.htm">Event Viewer</a> at regular intervals, or at a particular date and time.
<ol>
<li>
From the drop-down list box, choose <b>Consumers</b>.</li>
<li>
Click the EventViewerConsumer class, and click the <b>New Instance</b> button.<p>
—or—
</li>
<li>
Right-click on the EventViewerConsumer class, and choose <b>New Instance</b> from the pop-up menu. The <b>Edit new instance properties</b> dialog box appears.</li>
<li>
In the <b>Edit new instance properties</b> dialog box, type the following:<ol type=a>
<li>
In the <b>Description</b> field, type <i>TimerEventReceived</i>. </li>
<li>
In the <b>Name</b> field, type <i>TimerEvent</i>.<i> </i></li>
<li>
In the <b>Severity</b> field, type <i>2</i>.</li>
</ol>
</li>
<li>
Click OK to create the instance.</li>
</ol>
<p>
<a href="toolsguide_2vub.htm">Viewing Class Properties</a></p>
<p>
<a href="toolsguide_58yt.htm">Creating an Event Filter Instance</a></p>
<p>
<a href="toolsguide_3pr9.htm">Creating an Event Timer Instance</a></p>
<p>
<a href="toolsguide_8bjo.htm">Registering a Consumer for an Event</a></p>
<h4>See Also</h4>
<p>
<a href="event_8yyb.htm">Event Consumers</a></p>
<p>
<a href="hmmclass_3ygi.htm">__<b>EventConsumer</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
