<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connecting to a Data Source</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_connecting_to_a_data_source"></a>Connecting to a Data Source</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
In the connection string to <b>SQLDriverConnect</b>, the caller specifies either:
<ul>
<li>
"DSN=<i>dataSourceName</i>,<i>"</i> which can include the attribute-keywords, as described below, or</li>
<li>
"DRIVER=<i>driverName</i>" which can include the attribute-keywords, as described below. </li>
</ul>
<p>
In addition to the standard data source name, user name, and password, the adapter recognizes the attribute-keywords <a href="odbcdrvr_2nac.htm">NAMESPACES</a>, <a href="odbcdrvr_421w.htm">DBQ</a>, <a href="odbcdrvr_7lgk.htm">HOME</a>, and <a href="odbcdrvr_7kro.htm">SERVER</a>. </p>
<p>
If you specify the DRIVER keyword, the user is prompted to enter a database category.</p>
<p>
<b>Note</b>&nbsp;&nbsp;If <b>SQLDriverConnect</b> is called with an <b>fCompletionFlag</b> of SQL_NO_PROMPT, <b>SQLDriverConnect</b> returns an error. </p>
<p>
The keyword value is a string used to filter the total number of databases in WBEM. This number depends on the global environment variable <i>ODBC Category</i>, the value of which is equal to the keyword value. However, if the category string is ALL, then all databases are considered as included in this data source.</p>
<p>
If the connection string information is insufficient and the <b>fCompletionFlag</b> is not SQL_NO_PROMPT, a dialog box is displayed for namespace selection. In this dialog box, a tree control shows the nesting of namespaces. Each namespace has an associated bitmap image representing its state. The bitmap image looks like a checkbox with a folder.</p>
<p>
Clicking the folder alternately selects and cancels the selection of the namespace. If the checkbox or folder is not expanded (denoted by a <b>+</b> button next to the control), then all items in the folder are selected or canceled, depending on the current state of the folder. If the folder is already expanded or has no child items, then only the folder is affected.</p>
<p>
The state of each folder is represented as follows:</p>
<table border=1 cellspacing=4 cols=2 frame=box rules=all>
<tr valign=top>
<td width=34%><i>Clear Unchecked Checkbox</i></td>
<td width=66%>Item is not selected and no child items (if any) are selected.</td>
</tr>
<tr valign=top>
<td width=34%><i>Gray Unchecked Checkbox</i></td>
<td width=66%>At least one child item is selected.</td>
</tr>
<tr valign=top>
<td width=34%><i>Clear Checked Checkbox</i></td>
<td width=66%>Item is selected but no child items (if any) are selected.</td>
</tr>
<tr valign=top>
<td width=34%><i>Gray Checked Checkbox</i></td>
<td width=66%>Item is selected and at least one child item is selected.</td>
</tr>
</table><br>
<p>
The dialog box also allows namespace selection from a remote WBEM database. This functionality is available through the <b>Browse</b> button and text box.</p>
<p>
If you choose to manually enter a remote server name in the text box (maximum length 128 characters), the update does not occur until you exit the edit control by using the TAB key. The current tree control is cleared and replaced by the tree control for the new remote server. If the text box is empty, the local server is used.</p>
<p>
Click the <b>Browse</b> button to display a new <b>Server Selection</b> dialog box. This presents information similar to the Microsoft® Windows NT® Network Neighborhood. The dialog box initially displays the network resources on the local area network (LAN). Another link enables you to view the entire network (represented by a globe). If you double-click on an image that does not represent a server, then the current display is cleared and the contents of the chosen network resource are displayed.</p>
<p>
The dialog box also has three bitmap buttons:
<ul>
<li>
The <b>Folder</b> button enables you to traverse back to the previous network resource selection.</li>
<li>
The <b>Link view</b> button displays all the network resources in list view format.</li>
<li>
The <b>Report</b> <b>view</b> button displays all the network resources in report view format.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
