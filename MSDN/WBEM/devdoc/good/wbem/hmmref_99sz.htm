<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IWbemServices::ExecQueryAsync</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_iwbemservices_execqueryasync"></a>IWbemServices::ExecQueryAsync</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>IWbemServices::ExecQueryAsync</b> method performs the same task as <a href="hmmref_57qx.htm"><b>IWbemServices::ExecQuery</b></a> except that the result set is supplied to the specified response handler.</p>
<p>
For the valid types of queries that can be performed, see <a href="query_2fmt.htm">Queries</a>.</p>
<pre><code><b>HRESULT IWbemServices::ExecQueryAsync(
  [in] BSTR</b><i> bstrQueryLanguage</i><b>,                </b>
<b>  [in] BSTR</b><i> bstrQuery</i><b>,                        </b>
<b>  [in] LONG</b><i> lFlags</i><b>,                       </b>
<b>  [in] IWbemContext</b><i> *pCtx</i><b>,              </b>
<b>  [in] CALLBACK</b><i> *pResponseHandler</i><b>  </b>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>bstrQueryLanguage</i></dt>
<dd>
A valid BSTR containing one of the query languages supported by CIMOM. This must be WQL.</dd>
<dt>
<i>bstrQuery</i></dt>
<dd>
A valid BSTR containing the text of the query. This cannot be NULL. </dd>
<dt>
<i>lFlags</i></dt>
<dd>
Reserved. It must be zero.</dd>
<dt>
<i>pCtx</i></dt>
<dd>
Typically NULL. Otherwise, this is a pointer to an <b>IWbemContext</b> object required by the dynamic class provider that is producing the class instances. The values in the context object must be specified in the documentation for the provider in question.
<p>
If the query is very broad and involves many instance providers, it is not practical to include enough context information for all providers. In these cases, it is recommended that the parameter be NULL.
</dd>
<dt>
<i>pResponseHandler</i></dt>
<dd>
Points to the caller's implementation of <a href="hmmref_8qnf.htm"><b>IWbemObjectSink</b></a>. This handler receives the objects in the query result set as they become available. CIMOM calls <a href="hmmref_9y3p.htm"><b>IWbemObjectSink::Indicate</b></a> with the objects any number of times, followed by a single call to <b>IWbemObjectSink::SetStatus</b><i> </i>to indicate the final status.
<p>
For a detailed explanation of this parameter, see <a href="progintro_3nxj.htm">Asynchronous Methods</a>.

<p>
CIMOM only calls <b>AddRef</b> to the pointer in cases where WBEM_NO_ERROR is returned. In cases where an error code is returned, the reference count is the same as on entry.

</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=53%>WBEM_E_FAILED</td>
<td width=47%>Other unspecified errors.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_INVALID_CLASS</td>
<td width=47%>The specified class was invalid.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_INVALID_PARAMETER</td>
<td width=47%>An invalid parameter was specified or the namespace could not be parsed.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_OUT_OF_MEMORY</td>
<td width=47%>There was not enough memory to complete the operation.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_TRANSPORT_FAILURE</td>
<td width=47%>The communications link between the client and CIMOM has failed.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_NO_ERROR</td>
<td width=47%>The call succeeded.</td>
</tr>
</table><br>
<p>
On failure, you can obtain any available information from the COM function <b>GetErrorInfo</b>.</p>
<p>
Other error codes are returned to the object sink specified by the <i>pResponseHandler</i> parameter.</p>
<h4>See Also</h4>
<p>
<a href="progintro_3nxj.htm">Asynchronous Methods</a>, <a href="hmmref_57qx.htm"><b>IWbemServices::ExecQuery</b></a>, <a href="query_2fmt.htm">Queries</a></p>
<p>&nbsp;</p></body>
</HTML>
