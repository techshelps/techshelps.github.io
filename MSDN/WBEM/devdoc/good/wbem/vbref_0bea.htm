<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DWbemLocator.ConnectServer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_dwbemlocator.connectserver"></a>DWbemLocator.ConnectServer</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>DWbemLocator.ConnectServer</b> method connects to CIMOM on the machine specified in the <i>NetworkResource</i> parameter. This is typically a Microsoft® Windows NT® or Microsoft® Windows® 95/98 target machine, which must have an operational CIMOM. If method is succesfull then a <b>DIWbemServices</b> object will be returned that is bound to the namespace on the host machine.</p>
<pre><code><b>DWbemLocator.ConnectServer(
  [in] </b><i>NetworkResource </i><b>As String, </b>
<b>  [in] </b><i>User </i><b>As String,</b>
<b>  [in] </b><i>Password </i><b>As String,</b>
<b>  [in] </b><i>Locale </i><b>As String,</b>
<b>  [in] </b><i>lSecurityFlags </i><b>As Long,</b>
<b>  [in] </b><i>Authority </i><b>As String</b>,
<b>  [in] </b><i>pCtx </i><b>As Object, </b>
  <b>[out] </b><i>ppNamespace </i><b>As Object</b> 
<b>) As Long</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>NetworkResource</i></dt>
<dd>
A string containing the <a href="concepts_5lyr.htm">object path</a> of the desired CIMOM and namespace. For local machine access to the default namespace, for example, use a simple object path: "root\default" or "\\.\root\default".
<p>
For access to the default namespace on a remote machine using Distributed COM (DCOM), include the machine name: "\\myserver\root\default". 

<p>
See <a href="concepts_5lyr.htm">Object Paths</a>.
</dd>
<dt>
<i>User</i></dt>
<dd>
A string that specifies the user name to use while attempting to connect. Use <b>vbNullString</b> to use the user name of the current logged-on user.</dd>
<dt>
<i>Password</i></dt>
<dd>
A string that specifies the password to use when attempting to connect. Use <b>vbNullString</b>, but not a blank string, to use the password of the current logged-on user. A blank string is treated as a valid password.</dd>
<dt>
<i>Locale</i></dt>
<dd>
A string that specifies the localization code. Use <b>vbNullString</b> to use the current locale. If not <b>vbNullString</b>, this parameter must be a string that indicates the desired locale in which information should be retrieved. For Microsoft locale identifiers, the format of the string is "MS\xxxx", where xxxx is a string in hexadecimal form that indicates the LCID.
<p>
For example, American English would appear as "MS\0x409" 

<p>
Since WBEM accommodates other localization schemes besides Microsoft 32-bit LCIDs, you need to use this string format. Other schemes are ISO 639 and RFC 1766. See <a href="locale_6ugj.htm">WBEM Localization</a>.
</dd>
<dt>
<i>lSecurityFlags</i></dt>
<dd>
Must be 0.</dd>
<dt>
<i>Authority</i></dt>
<dd>
Reserved. It should be set to <b>vbNullString</b>.</dd>
<dt>
<i>pCtx</i></dt>
<dd>
<a href="vbref_3sac.htm"><b>DWbemContext</b></a><b> </b>type<b> </b>object required by the dynamic class provider that is producing the class instances. You must specify the values in the context object in the documentation for the provider in question. This can be <b>NOTHING</b> if no context is being provided.</dd>
<dt>
<i>ppNamespace</i></dt>
<dd>
<b>DIWbemServices</b> type object bound to the specified namespace. On error, this is set to <b>NOTHING</b>. 
</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=53%>WBEM_E_ACCESS_DENIED</td>
<td width=47%>The current or specified user name and password were not valid or authorized to make the connection.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_FAILED</td>
<td width=47%>Unspecified error. </td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_INVALID_NAMESPACE</td>
<td width=47%>The specified namespace did not exist on the server.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_INVALID_PARAMETER</td>
<td width=47%>An invalid parameter was specified, or the namespace could not be parsed.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_OUT_OF_MEMORY</td>
<td width=47%>There was not enough memory to complete the operation.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_TRANSPORT_FAILURE</td>
<td width=47%>A networking error occurred, preventing normal operation.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_SERVER_NOT_FOUND</td>
<td width=47%>The specified server could not be located.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_NO_ERROR</td>
<td width=47%>Success.</td>
</tr>
</table><br>
<h4>Sample Code</h4>
<pre><code>Function Wbem_logon()
  Dim NetworkResource
  Dim ErrObj As DWbemClassObject
  Dim pLocator As New DWbemLocator
  On Error GoTo ErrorHandler
' This example attempts to log on to the root\cimv2 namespace.
' Pass vbNullstring for the username, password, locale and authority 
' to use the currently logged in user password and the default locale
' and authority
' ppNamespace is a DWbemServices type object that will be bound to the 
' namespace.
   
   pLocator.ConnectServer Me.Namespace, vbNullString, vbNullString, vbNullString, 0, vbNullString, Nothing, ppNamespace
   Wbem_logon = WBEM_NO_ERROR
Exit Function
  
ErrorHandler:
' Calls a custom function that converts error codes to descriptive strings.
   MsgBox "An error has occurred: " &amp; show_wbem_error(Err.Number)
   show_wbem_error (Err.Number)
   Wbem_logon = -1 'indicate an error
   Exit Function

End Function</code></pre>
<h4>See Also</h4>
<p>
<a href="vbref_4b3n.htm"><b>DIWbemServices</b></a></p>
<p>&nbsp;</p></body>
</HTML>
