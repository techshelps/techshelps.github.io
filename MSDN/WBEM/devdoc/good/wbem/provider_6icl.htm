<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Compiling the Skeleton Code</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_hmm_compiling_the_skeleton_code"></a>Compiling the Skeleton Code</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<h5>&nbsp;&nbsp;&nbsp;&nbsp;To compile the skeleton code</h5>
<ol>
<li>
From the \Wbem\include directory, type the following commands:<p>
<b>midl wbemsvc.idl</b>
<p>
<b>midl providl.idl</b>
<p>
<b>midl wbemdisp.idl</b>
</li>
<li>
From the \Prov directory, run: <b>MKTYPLIB myprov.odl /h myprov.h</b>.</li>
<li>
Make sure \Wbem\include and \Wbem\Include are in your include path.</li>
<li>
Make sure \Wbem\Lib is in your lib path.</li>
<li>
You must compile Myprov.cpp and Olesrvr.cpp. You are creating a Microsoft Foundation Class (MFC) DLL. </li>
<li>
When you link, you must include framedyn.lib and framestat.lib and you must use myprov.def.</li>
</ol>
<p>
For Microsoft® Visual C++® version 5 users, this would be done as follows: 
<ol>
<li>
Create a new project named <b>MyProv</b> of type <b>Win32</b> <b>Dynamic Link Library</b> in location <b>\Prov</b>.</li>
<li>
<b>Project/AddtoProject/Files olesrvr.cpp</b>, <b>myprov.def</b> and <b>myclass.cpp</b>.</li>
<li>
Go to <b>Project/Settings</b>.</li>
<li>
Under <b>C/C++ Preprocessor</b> tab, select the category options and add the two paths for the include files: c:\Wbem\Include and c:\Wbem\Include.</li>
<li>
Under <b>Link/Input</b> tab add the lib path and the two lib files (framedyn.lib and framestat.lib).</li>
<li>
Under the <b>Additional Lib Path</b> tab add c:\Wbem\Lib.</li>
<li>
Make sure \Wbem\Lib is in your lib path.</li>
<li>
Save the settings.</li>
<li>
Under <b>Build</b>, select <b>Build MyProv.dll</b>.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
