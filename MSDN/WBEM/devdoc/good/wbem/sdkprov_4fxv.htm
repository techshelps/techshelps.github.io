<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Win32_NTEventlogFile Class</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_hmm_win32_nteventlogfile_class"></a>Win32_NTEventlogFile Class</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Event Log instance Provider defines the <b>Win32_NTEventlogFile</b> class to access the data stored in a Windows NT log file. The <b>Win32_NTEventlogFile</b> class derives from the <b>CIM_DataFile</b> class, which is part of the class hierarchy that ultimately inherits from <b>CIM_ManagedSystemElement</b>. <b>Win32_NTEventlogFile</b> inherits properties from the following superclasses:
<ul>
<li>
<b>CIM_ManagedSystemElement</b></li>
<li>
<b>CIM_LogicalFile</b></li>
</ul>
<p>
The following table describes the properties that are defined directly in the <b>Win32_NTEventlogFile</b> class:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Property</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%><b>LogfileName</b></td>
<td width=64%>Name of the log file. Standard log file names are application, system, and security. </td>
</tr>
<tr valign=top>
<td width=36%><b>MaxFileSize</b></td>
<td width=64%>Read/write value retrieved from the Windows NT Event Log service's MaxSize value in the registry. </td>
</tr>
<tr valign=top>
<td width=36%><b>NumberOfRecords</b></td>
<td width=64%>Determined by calling the Win32 function <b>GetNumberOfEventLogRecords</b>.</td>
</tr>
</table><br>
<p>
Clients of the Event Log Provider can change the value for the <b>MaxFileSize</b> property. If <b>MaxFileSize</b> is decreased, the change does not take effect until the log file is cleared. </p>
<p>
Two other properties, <b>OverWritePolicy</b> and <b>OverwriteOutDated</b>, are based on the Windows NT Event Log service's Retention value in the registry. <b>OverwriteOutDated</b> is set to the same value as Retention and provides the number of days after which an event can be overwritten. Valid values for this property are:
<ul>
<li>
0, indicating that any entry can be overwritten when necessary. </li>
<li>
1-365, indicating that events that have been in the log file for one year or less can be overwritten.</li>
<li>
4294967295, indicating that nothing can be overwritten. </li>
</ul>
<p>
To change the overwrite policy being used for the log file, change the <b>OverwriteOutDated</b> property. When <b>IWbemServices::PutInstance</b> or <b>IWbemServices::PutInstanceAsync</b> is called to store the <b>Win32_NTEventlogFile</b> instance, the registry is updated. <b>PutInstance</b> or <b>PutInstanceAsync</b> fails if an attempt is made to set <b>OverwriteOutDated</b> to a value between 365 and 4294967295. </p>
<p>
<b>OverWritePolicy</b> is a read-only property that identifies the current overwrite policy employed by the Windows NT Event Log service for this log file. Its value is based on the value of the <b>OverwriteOutDated</b> property and is set as follows:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>OverwriteOutDated value</th>
<th align=left width=52%>OverWritePolicy value</th>
</tr>
<tr valign=top>
<td width=48%>0</td>
<td width=52%>WhenNeeded</td>
</tr>
<tr valign=top>
<td width=48%>1 - 365</td>
<td width=52%>OutDated</td>
</tr>
<tr valign=top>
<td width=48%>4294967295</td>
<td width=52%>Never</td>
</tr>
</table><br>
<p>
For more information about overwrite policy values, see <a href="sdkprov_6aer.htm">Log File Registry Entries</a>.</p>
<p>
In addition to properties, the <b>Win32_NTEventlogFile</b> class includes two methods: <b>BackupEventlog</b> and <b>ClearEventlog</b>. These methods implement the corresponding Win32 functions and take one input parameter, the name of the archive file to be created. For <b>BackupEventlog</b>, this parameter must not be NULL or the name of a file that already exists. <b>ClearEventlog</b> accepts a NULL parameter if the caller does not require the log file to be archived before it is cleared. If the parameter is non-NULL, the file must not already exist. Both methods return 0 if they are successful; if unsuccessful, they return an error code obtained from the Win32 <b>GetLastError</b> function.  </p>
<p>&nbsp;</p></body>
</HTML>
