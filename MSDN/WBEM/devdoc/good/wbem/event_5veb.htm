<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Event Queries</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_event_queries"></a>Event Queries</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
When consumers register to receive event notifications, they specify a query that defines the type of event and the conditions under which it is delivered to them. These conditions depend on the properties that exist for the class used to represent the event. To create a query, consumers use the <a href="query_2fmt.htm">WBEM Query Language</a> (WQL). WQL is a structured query language (SQL) dialect with extensions to support WBEM event notification and other WBEM-specific features. </p>
<p>
In general, a query is limited to the form:</p>
<pre><code>select &lt;* | property_list&gt; from &lt;ClassName&gt; 
  where &lt;selection_criteria&gt;;
</code></pre>
<p>
The SELECT clause specifies the properties and the FROM clause specifies the class that correspond to the event of interest. The WHERE clause specifies additional filtering and is optional. Without a WHERE clause, consumers receive all notifications for the event class; with a WHERE clause, consumers receive only particular notifications for the event class. WBEM strongly encourages consumers to use extremely detailled WHERE clauses. The cost of a complex query is minimal compared to the cost of delivering and processing unneeded notifications..</p>
<p>
The following query shows how to request notification when disk space falls below one megabyte of free space. The SELECT statement requests all properties of the event class <b>__InstanceModificationEvent</b>. The WHERE clause narrows the receipt of that event to instances of the <b>Win32LogicalDisk</b> class when the <b>FreeSpace</b> property has a value of less than one million:</p>
<pre><code>Select * from __InstanceModificationEvent 
where TargetInstance isa "Win32LogicalDisk" and TargetInstance.FreeSpace &lt; 1000000
</code></pre>
<p>
Note that CIMOM can reject a query for a number of reasons. For example, the query can be too complex or resource-intensive for evaluation. When this occurs, CIMOM returns WBEM_E_INVALID_PARAMETER. For more information about event queries, see <a href="query_23n7.htm">SELECT Statements for Event Notifications</a>.</p>
<p>
Queries are specified differently depending on the type of consumer. <a href="event_73w3.htm">Temporary consumers</a> are consumers whose event registration lasts only for the lifetime of the consumer. Temporary consumers specify their queries in the <i>bstrQuery</i> parameter when they call either <a href="hmmref_65ix.htm"><b>IWbemServices::ExecNotificationQuery</b></a> or <a href="hmmref_3rkz.htm"><b>IWbemServices::ExecNotificationQueryAsync</b></a>. <a href="event_3bzn.htm">Permanent consumers</a> are consumers whose registration lasts until it is explicitly cancelled. Permanent consumers specify their queries in instances of the <a href="hmmclass_1fzm.htm"><b>__EventFilter</b></a> system class. </p>
<p>&nbsp;</p></body>
</HTML>
