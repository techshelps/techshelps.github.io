<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registering the Registry Provider</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_hmm_registering_the_registry_provider"></a>Registering the Registry Provider</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Because the Registry Provider is not automatically registered with CIMOM as part of the WBEM installation process, applications wanting to use it must complete the registration. An application registers the Registry Provider by creating a MOF file with instances of registration classes and either compiling it as a stand-alone file or including it at the top of an application-specific MOF file. The application-specific MOF file contains the classes and instances used to access the registry data.</p>
<p>
The newly-created MOF file contains an instance of the <b>__Win32Provider</b> class and one of the following instances, depending on whether the application intends to use the Registry Provider as an instance, property, or event provider:
<ul>
<li>
<b>__InstanceProviderRegistration</b></li>
<li>
<b>__PropertyProviderRegistration</b></li>
<li>
<b>__EventProviderRegistration</b></li>
</ul>
<p>
</p>
<p>
The <b>__Win32Provider </b>instance describes the name of the provider and its class identifier (CLSID). The following instances are used to register the Registry Provider as an instance provider or a property provider:</p>
<pre><code>// Instance provider
instance of __Win32Provider as $P
{
    Name    = "RegProv" ;
    ClsId   = "{fe9af5c0-d3b6-11ce-a5b6-00aa00680c3f}" ;
};    

//Property provider
instance of __Win32Provider as $P
{
    Name = "RegPropProv";
    Clsid = "{72967901-68EC-11d0-B729-00AA0062CBB7}";
};
</code></pre>
<p>
The <b>__InstanceProviderRegistration</b> and <b>__PropertyProviderRegistration</b> instances describe the operations that the provider supports:</p>
<pre><code>//Instance provider
instance of __InstanceProviderRegistration
{
    Provider = $P;
    SupportsPut = TRUE;
    SupportsGet = TRUE;
    SupportsDelete = FALSE;
    SupportsEnumeration = TRUE;
};

// Property provider
instance of __PropertyProviderRegistration 
{
    Provider = $P;
    SupportsGet = TRUE;
    SupportsPut = TRUE;
};
</code></pre>
<p>
For information on registering the Registry Provider as an event provider, see <a href="sdkprov_212r.htm">Registering for Registry Events</a>.</p>
<p>&nbsp;</p></body>
</HTML>
