<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Provider Class</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_creating_a_provider_class"></a>Creating a Provider Class</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<h5>&nbsp;&nbsp;&nbsp;&nbsp;To create the class for which you want to return data</h5>
<ol>
<li>
Create a directory to contain all of the provider files.  </li>
<li>
Open Internet Explorer and make sure its security level allows the installation of ActiveX™ tools. Under <b>View/Options…/Security/Safety Level…</b>, choose <b>Medium</b> or <b>None</b>. If you choose <b>None</b>, be careful if you use the same Internet Explorer elsewhere.</li>
<li>
Open WBEM CIM Studio. Click <b>Start</b>, select <b>Programs</b>, then select <b>WBEM SDK</b>. Then select <b>WBEM CIM Studio</b>. <p>
If you set the security level to Medium, you must allow all the .cab and ActiveX controls to be installed. In other words, you must answer <b>Yes to All</b> when asked if it is OK to install the controls.
</li>
<li>
Log in to CIMOM. If you have made no changes to security since installing WBEM, you can click <b>OK</b> here.</li>
<li>
Click the <b>Add Class</b> button to the right of the <b>Classes in</b> box. </li>
<li>
Clear the <b>Parent</b> field, enter <b>MyClass</b> in the <b>New Class</b> field, and click <b>OK</b>. At this point, the new class appears in the left frame. (You can also create a derived class. In this case, select the parent class first, then click the <b>Add Class</b> button and enter the new class name without clearing the <b>Parent</b> field.)</li>
<li>
Add a property to the new class. In the right frame, click the<b> Name</b> field in the blank line at the bottom. Type <b>MyName</b> in this field. Leave the type as <b>string </b>and the value blank.</li>
<li>
Add two qualifiers to the <b>MyName</b> property. Double-click <b>MyName</b> to display the Qualifiers window.</li>
<li>
For the first qualifier, enter <b>Key</b> as the name, <b>BOOL</b> as the type, and <b>true</b> as the value. Leave the other default settings as is.</li>
<li>
For the second qualifier, enter <b>Read</b> as the name, <b>BOOL</b> as the type, and <b>true</b> as the value. Leave the other default settings as is.</li>
<li>
Click <b>OK</b> to close the Qualifiers window.</li>
<li>
Add another new property named <b>Age</b>. It should be of type <b>sint32</b> (32-bit integer). Leave the value as <b>0</b>.</li>
<li>
Add a qualifier to the <b>Age</b> property. Double-click the <b>Age</b> field. The Qualifiers window appears.</li>
<li>
Enter <b>Read</b> as the name, <b>BOOL</b> as the type, and <b>true</b> as the value. Leave the other default settings as is.</li>
<li>
Click <b>OK</b> to close the Qualifiers window.</li>
<li>
Add two qualifiers to the <b>MyClass</b> class. Right-click the <b>Age </b>property and select <b>Object qualifiers</b>.</li>
<li>
For the first qualifier, enter <b>Dynamic</b> as the name, <b>BOOL</b> as the type, and <b>true</b> as the value. Leave the other default settings as is.</li>
<li>
For the second qualifier, enter <b>Provider</b> as the name, <b>BSTR</b> as the type, and <b>MyProv </b>as the value. Leave the other default settings as is.</li>
<li>
Click <b>OK</b> to close the Qualifiers window.</li>
<li>
Click the <b>Save</b> button.</li>
<li>
In the left frame, click the check box to the left of the <b>MyClass</b> class.</li>
<li>
Double-click the <b>MOF Generator</b> button to run the MOF Generator Wizard and generate a MOF file for the new class definition.</li>
<li>
Click the <b>Next</b> button on the first and second screens that appear. (Click <b>OK</b> to dismiss the "Cannot get instance enumeration…" warning message.) On the third screen, enter <b>MyClass</b> in the <b>MOF File Name</b> field and &lt;<i>drive</i>&gt;:<b>\Prov</b> in the <b>Directory for the MOF file</b> field. (You can also use the <b>Browse</b> button to select the directory.) </li>
<li>
Click the <b>Finish</b> button. The MOF file is generated and a confirmation message appears. Click <b>OK</b> to dismiss the message.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
