<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IWbemLocator::ConnectServer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_iwbemlocator_connectserver"></a>IWbemLocator::ConnectServer</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>IWbemLocator::ConnectServer</b> method connects to CIMOM on the machine specified in the <i>bstrNetworkResource</i> parameter. This is typically a Microsoft® Windows NT® machine or a Microsoft® Windows® 95/98 target machine, which must have an operational CIMOM.</p>
<pre><code><b>HRESULT IWbemLocator::ConnectServer(
  [in] BSTR</b><i> bstrNetworkResource</i><b>, </b>
<b>  [in] BSTR</b><i> bstrUser</i><b>,</b>
<b>  [in] BSTR</b><i> bstrPassword</i><b>,</b>
<b>  [in] BSTR</b><i> bstrLocale</i><b>,</b>
<b>  [in] long </b><i>lSecurityFlags</i><b>,</b>
<b>  [in] BSTR </b><i>bstrAuthority</i>,
<b>  [in] IWbemContext</b><i> *pCtx</i><b>, </b>
  <b>[out] IWbemServices</b> <i>**ppNamespace</i> 
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>bstrNetworkResource</i></dt>
<dd>
A pointer to a valid BSTR containing the object path of the desired CIMOM and namespace. For local machine access to the default namespace, for example, use a simple object path: "root\default" or "\\.\root\default".
<p>
For access to the default namespace on a remote machine using Distributed COM (DCOM) or Microsoft-compatible networking, include the machine name: "\\myserver\root\default". 

<p>
See <a href="concepts_5lyr.htm">Object Paths</a>.
</dd>
<dt>
<i>bstrUser</i></dt>
<dd>
A pointer to a valid BSTR, which contains the user name you need for a connection.. This can be NULL if you use the current logged-on user name.</dd>
<dt>
<i>bstrPassword</i></dt>
<dd>
A pointer to a valid BSTR, which contains the password you need for a connection. This can be NULL, but not a blank string, if you are using the current password. In contrast, treat a blank string as a valid password.</dd>
<dt>
<i>bstrLocale</i></dt>
<dd>
If NULL, use the current locale. If not NULL, this parameter must be a valid BSTR, which indicates the desired locale for information retrieval. For Microsoft locale identifiers, the format of the string is "MS\xxxx", where xxxx is a string in hexadecimal form that indicates the LCID.
<p>
For example, American English would appear as "MS\\0x409" (C++ requires two backslashes because the first is considered an escape character).

<p>
The string format is required since WBEM accommodates other localization schemes besides Microsoft 32-bit LCIDs, such as ISO 639 or RFC 1766. See <a href="locale_6ugj.htm">WBEM Localization Guidelines</a>.
</dd>
<dt>
<i>lSecurityFlags</i></dt>
<dd>
Must be one of the following constants:
<ul>
<li>
WBEM_AUTHENTICATION_DEFAULT</li>
<li>
WBEM_AUTHENTICATION_NTLM</li>
<li>
WBEM_AUTHENTICATION_WBEM</li>
</ul>

<p>
If you use WBEM_AUTHENTICATION_DEFAULT, <i>bstrUser,</i> <i>bstrPassword, </i>and <i>bstrAuthority </i>must remain NULL. In this case, log on using the currently logged-on Windows NT LanMan user. If that fails, try the WBEM Guest account (an anonymous logon). If both fail, the user is denied access.

<p>
If you use WBEM_AUTHENTICATION_NTLM, set <i>bstrUser</i> and <i>bstrPassword</i> to the desired Windows NT LanMan Domain account and password. Set the<i> bstrAuthority</i> parameter to the LanMan Domain name to which the user account belongs.

<p>
If WBEM_AUTHENTICATION_WBEM is specified, set <i>bstrUser </i>and <i>bstrPassword </i>to a valid WBEM user name and its corresponding password. <i>bstrAuthority </i>can be set to either "WBEM" or NULL.
</dd>
<dt>
<i>bstrAuthority</i></dt>
<dd>
<b>TBD</b></dd>
<dt>
<i>pCtx</i></dt>
<dd>
Typically NULL. Otherwise, this is a pointer to an <b>IWbemContext</b> object required by the dynamic class provider that produces the class instances. The values in the context object must be specified in the documentation for the provider in question.</dd>
<dt>
<i>ppNamespace</i></dt>
<dd>
Receives a pointer to an <b>IWbemServices</b> object bound to the specified namespace. This pointer has a positive reference count. The caller must call <a href="hmmref_9h9h.htm"><b>Release</b></a> on the pointer when it is no longer required. This pointer is set to point to NULL when there is an error.
</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=53%>WBEM_E_ACCESS_DENIED</td>
<td width=47%>The current or specified user name and password were not valid or authorized to make the connection.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_FAILED</td>
<td width=47%>Other unspecified errors. </td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_INVALID_NAMESPACE</td>
<td width=47%>The specified namespace did not exist on the server.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_INVALID_PARAMETER</td>
<td width=47%>An invalid parameter was specified, or the namespace could not be parsed.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_OUT_OF_MEMORY</td>
<td width=47%>There was not enough memory to complete the operation.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_TRANSPORT_FAILURE</td>
<td width=47%>A networking error occurred, preventing normal operation.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_E_SERVER_NOT_FOUND</td>
<td width=47%>The specified server could not be located.</td>
</tr>
<tr valign=top>
<td width=53%>WBEM_NO_ERROR</td>
<td width=47%>Success.</td>
</tr>
</table><br>
<h4>See Also</h4>
<p>
<a href="hmmref_9bxv.htm"><b>IWbemServices</b></a></p>
<p>&nbsp;</p></body>
</HTML>
