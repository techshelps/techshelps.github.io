<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Temporary Event Consumers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_temporary_event_consumers"></a>Temporary Event Consumers</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Temporary event consumers receive notifications of events only when they are running. Typical temporary consumers are user interface applications requiring notification of events that affect the data that displayed to end-users. Temporary consumers register for events whenever they wish and cancel the registration when they are no longer interested. CIMOM holds the registrations in memory; they are not stored persistently.</p>
<p>
There are two ways that an application can register as a temporary consumer:
<ul>
<li>
Create an object that implements the methods of the <a href="hmmref_8qnf.htm"><b>IWbemObjectSink</b></a> interface and make two calls: one  to <a href="hmmref_3rkz.htm"><b>IWbemServices::ExecNotificationQueryAsync</b></a>, passing a pointer to this object in the <i>pResponseHandler</i> parameter, and the other to <b>CoInitializeSecurity</b>. CIMOM calls the I<b>WbemObjectSink::Indicate</b> method asynchronously whenever an event arrives.<p>
-- or --
</li>
<li>
Call <a href="hmmref_65ix.htm"><b>IWbemServices::ExecNotificationQuery</b></a> and poll for events by making repeated calls to <a href="hmmref_994k.htm"><b>IEnumWbemClassObject::Next</b></a><b>. </b>A pointer to <b>IEnumWbemClassObject </b>is returned by <b>ExecNotificationQuery</b>. </li>
</ul>
<p>
WBEM recommends that all temporary consumers implement the first approach. The main advantage of this approach is that notifications are delivered asynchronously as they occur. Asynchronous delivery of notifications makes polling unnecessary and it improves performance. </p>
<p>
The only advantage to the second approach is that the consumer need not implement <b>IWbemObjectSink. </b>However, it means the consumer must poll each time it wants to receive event notifications, and polling is a time-consuming and inefficient technique. This approach is recommended for use only in unusual circumstances. </p>
<p>&nbsp;</p></body>
</HTML>
