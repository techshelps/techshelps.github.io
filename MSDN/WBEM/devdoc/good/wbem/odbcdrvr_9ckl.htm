<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Single-Table, Single-Column Example</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_hmm_single_table_single_column_example"></a>Single-Table, Single-Column Example</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following pseudocode assumes a typical client-adapter interaction. The client wants to select <b>c1t1</b> from table <b>t1</b> in the database called Wellfleet. In CIM terms, this corresponds to getting the property <b>fld1t1</b> from all instances of the class<b> t1</b>. This pseudocode for the client does not consider error handling.</p>
<pre><code>HENV henv;
HBDC hdbc;
HSTMT hstmt;
SQLAllocEnv (&amp;henv);
SQLAllocConnect (henv, &amp;hdbc);
SQLConnect (hdbc, "SNMP", SQL_NTS,
  NULL, SQL_NTS, NULL, SQL_NTS);
SQLSetConnectionOption (hdbc, SQL_CURRENT_QUALIFIER,
  "Wellfleet");
HSTMT hstmt; 
SQLAllocStmt (hdbc, &amp;hstmt);
<a href="odbcdrvr_88c4.htm">SQLExecDirect</a> (hstmt, "select c1t1 from t1");
while (SQL_SUCCESS == SQLFetch (hstmt))
{
  char szData [MAX_DATA];
  SQLGetData (hstmt, 1, SQL_C_CHAR,
    szData, sizeof (szData), &amp;cbData));
  MsgBox (NULL, szData, "ODBC", MB_OK);
}</code></pre>
<p>
Using <b>SQLSetConnectionOption</b> with the <b>SQL_CURRENT_QUALIFER</b> option sets the default database. This means the client can refer to tables without having to qualify them with the database name (in this case, Wellfleet). If the client had not invoked the <b>SQLSetConnectOption</b>, the adapter would have searched for <b>t1</b> in the current database. In <b>SQLSetConnectOption</b>, the adapter stores the database (qualifier) in a data structure associated with the <b>hdbc</b> (the connection handle).</p>
<p>&nbsp;</p></body>
</HTML>
