<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IWbemServices::ExecQuery</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_iwbemservices_execquery"></a>IWbemServices::ExecQuery</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>IWbemServices::ExecQuery</b> method executes a query to retrieve objects, which are available through the returned enumerator. All query results are returned through the enumerator as <a href="hmmref_2px0.htm"><b>IEnumWbemClassObject</b></a>. </p>
<p>
For the valid types of queries that can be performed, see <a href="query_2fmt.htm">Queries</a>.</p>
<pre><code><b>HRESULT IWbemServices::ExecQuery(
  [in] BSTR</b><i> bstrQueryLanguage</i><b>,             </b>
<b>  [in] BSTR</b><i> bstrQuery</i><b>,                     </b>
<b>  [in] LONG</b><i> lFlags</i><b>,                    </b>
<b>  [in] IWbemContext</b><i> *pCtx</i><b>,              </b>
<b>  [out] IEnumWbemClassObject</b><i> **ppEnum</i><b>  </b>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>bstrQueryLanguage</i></dt>
<dd>
A valid BSTR containing one of the query languages supported by CIMOM. This must be the "WQL," the acronym for WBEM Query Language.</dd>
<dt>
<i>bstrQuery</i></dt>
<dd>
A valid BSTR containing the text of the query. This cannot be NULL. </dd>
<dt>
<i>lFlags</i></dt>
<dd>
Reserved. It must be zero.</dd>
<dt>
<i>pCtx</i></dt>
<dd>
Typically NULL. Otherwise, this is a pointer to an <b>IWbemContext</b> object required by the dynamic class provider that is producing the class instances. The values in the context object must be specified in the documentation for the provider in question.
<p>
If the query is very broad and involves many instance providers, it is not practical to include enough context information for all providers. In these cases,  the parameter should be NULL.
</dd>
<dt>
<i>ppEnum</i></dt>
<dd>
If no error occurs, this receives the enumerator that allows the caller to retrieve the instances in the result set of the query. It is not an error for the query to have a result set with zero instances. This be determined only by attempting to iterate through the instances. This object is returned with a positive reference count. The caller must call <b>Release</b> when the object is no longer needed.
</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>WBEM_E_ACCESS_DENIED</td>
<td width=50%>The current user does not have permission to view the result set.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_FAILED</td>
<td width=50%>Other unspecified errors.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_INVALID_PARAMETER</td>
<td width=50%>An invalid parameter was specified, or the namespace could not be parsed.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_INVALID_QUERY</td>
<td width=50%>The query was not syntactically valid.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_INVALID_QUERY_LANGUAGE</td>
<td width=50%>The requested query language is not supported.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_OUT_OF_MEMORY</td>
<td width=50%>There was not enough memory to complete the operation.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_TRANSPORT_FAILURE</td>
<td width=50%>The communications link between the client and CIMOM has failed.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_NO_ERROR</td>
<td width=50%>The call succeeded.</td>
</tr>
</table><br>
<p>
On failure, you can obtain any available information from the COM function <b>GetErrorInfo</b>.</p>
<h4>See Also</h4>
<p>
<a href="progintro_19f7.htm">Error Objects</a>, <a href="hmmref_99sz.htm"><b>IWbemServices::ExecQueryAsync</b></a>, <a href="query_2fmt.htm">Queries</a></p>
<p>&nbsp;</p></body>
</HTML>
