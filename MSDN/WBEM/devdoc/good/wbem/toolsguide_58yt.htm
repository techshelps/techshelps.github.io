<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating an Event Filter Instance</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_hmm_creating_an_event_filter_instance"></a>Creating an Event Filter Instance</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Event filters define criteria for receiving event notifications.</p>
<p>
You create event filters as instances of a given class. This version of WBEM contains the predefined <b>__EventFilter</b> system class.</p>
<p>
The first procedure describes how to create an event consumer instance. The other procedures are examples intended to work along with the example consumers and timers.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create an event filter instance</h5>
<ol>
<li>
From the drop-down list box, choose <b>Filters</b>.</li>
<li>
Click the class you want to create an instance, and click the <b>New Instance</b> button.<p>
—or—
</li>
<li>
Right-click on the class you want to create an instance, and choose <b>New Instance</b> from the pop-up menu. The <b>Edit new instance properties</b> dialog box appears.</li>
</ol>
<p>
<img src="filtpropscrn.gif" border=0>
<ol start=4>
<li>
In the <b>Edit new instance properties</b> dialog box, type the following: <ol type=a>
<li>
In the <b>Name</b> field, type a name for the filter.</li>
<li>
In the <b>Query</b> field, type a <a href="query_2fmt.htm">WQL</a> SELECT statement that specifies the event criteria.</li>
<li>
In the <b>Query Language</b> field, type <i>WQL</i>.</li>
</ol>
</li>
<li>
Click OK to create the instance.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create the ServiceStoppedEvent filter</h5>
<p>
This example defines a filter that works with the ServiceStopped consumer to display an event notification in the <a href="toolsguide_7v02.htm">Event Viewer</a> when a system service is stopped.
<ol>
<li>
From the drop-down list box, choose <b>Filters</b>.</li>
<li>
Click the <b>__EventFilter </b>class, and click the <b>New Instance</b> button.<p>
—or—
</li>
<li>
Right-click on the <b>__EventFilter </b>class, and choose <b>New Instance</b> from the pop-up menu. The <b>Edit new instance properties</b> dialog box appears.</li>
</ol>
<p>
<img src="filtpropscrn.gif" border=0>
<ol start=4>
<li>
In the <b>Edit new instance properties</b> dialog box, type the following: <ol type=a>
<li>
In the <b>Name</b> field, type <i>ServiceStoppedEvent</i>.</li>
<li>
In the <b>Query</b> field, type the following <a href="query_2fmt.htm">WQL</a> SELECT statement to specify the event criteria:<pre><code>select * from __InstanceModificationEvent within 5 where TargetInstance isa "Win32_Service" and TargetInstance.State="Stopped"
</code></pre>
</li>
<li>
In the <b>Query Language</b> field, type <i>WQL</i>.</li>
</ol>
</li>
<li>
Click OK to create the instance.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create IntervalTimerFilter </h5>
<p>
This example defines a filter that works with the TimerEvent consumer and IntervalTimer to display an event notification in the <a href="toolsguide_7v02.htm">Event Viewer</a> every 5 seconds.
<ol>
<li>
From the drop-down list box, choose <b>Filters</b>.</li>
<li>
Click the <b>__EventFilter</b> class, and click the <b>New Instance</b> button.<p>
—or—
</li>
<li>
Right-click on the <b>__EventFilter</b> class, and choose <b>New Instance</b> from the pop-up menu. The <b>Edit new instance properties</b> dialog box appears.</li>
</ol>
<p>
<img src="filtpropscrn.gif" border=0>
<ol start=4>
<li>
In the <b>Edit new instance properties</b> dialog box, type the following: <ol type=a>
<li>
In the <b>Name</b> field, type <i>IntervalTimerFilter</i>.</li>
<li>
In the <b>Query</b> field, type the following <a href="query_2fmt.htm">WQL</a> SELECT statement to specify the event criteria:<pre><code>select * from __TimerEvent
</code></pre>
</li>
<li>
In the <b>Query Language</b> field, type <i>WQL</i>.</li>
</ol>
</li>
<li>
Click OK to create the instance.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create the AbsTimerFilter </h5>
<p>
This example defines a filter that works with the TimerEvent consumer and AbsTimer to display an event notification in the <a href="toolsguide_7v02.htm">Event Viewer</a> at a specified date and time.
<ol>
<li>
From the drop-down list box, choose <b>Filters</b>.</li>
<li>
Click the <b>__EventFilter</b> class, and click the <b>New Instance</b> button.<p>
—or—
</li>
<li>
Right-click on the <b>__EventFilter</b> class, and choose <b>New Instance</b> from the pop-up menu. The <b>Edit new instance properties</b> dialog box appears.</li>
</ol>
<p>
<img src="filtpropscrn.gif" border=0>
<ol start=4>
<li>
In the <b>Edit new instance properties</b> dialog box, type the following: <ol type=a>
<li>
In the <b>Name</b> field, type <i>AbsTimerFilter</i>.</li>
<li>
In the <b>Query</b> field, type the following <a href="query_2fmt.htm">WQL</a> SELECT statement to specify the event criteria:<pre><code>select * from __TimerEvent where TimerId="AbsTimer"
</code></pre>
</li>
<li>
In the <b>Query Language</b> field, type <i>WQL</i>.</li>
</ol>
</li>
<li>
Click OK to create the instance.</li>
</ol>
<p>
<a href="toolsguide_2vub.htm">Viewing Class Properties</a></p>
<p>
<a href="toolsguide_8obp.htm">Creating an Event Consumer Instance</a></p>
<p>
<a href="toolsguide_3pr9.htm">Creating an Event Timer Instance</a></p>
<p>
<a href="toolsguide_8bjo.htm">Registering a Consumer for an Event</a></p>
<h4>See Also</h4>
<p>
<a href="hmmclass_1fzm.htm">__<b>EventFilter</b></a> </p>
<p>
<a href="event_5cmq.htm">Creating an Event Filter</a></p>
<p>
<a href="event_5veb.htm">Event Queries</a></p>
<p>
<a href="query_2fmt.htm">WBEM Query Language</a></p>
<p>&nbsp;</p></body>
</HTML>
