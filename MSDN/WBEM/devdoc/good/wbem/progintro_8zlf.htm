<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Derived Class</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_creating_a_derived_class"></a>Creating a Derived Class</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Creating a derived class is similar to creating a base class. The main difference is that before the class is created, the parent class must be located as shown in the following fragment. The class <b>Example2</b> is created as a subclass to the <b>Example</b> class.</p>
<pre><code>IWbemClassObject *pNewDerivedClass = 0;
  IWbemClassObject *pExampleClass = 0;

  BSTR PathToClass = SysAllocString(L"Example");
  HRESULT hRes = g_pNamespace-&gt;GetObject(PathToClass, 0, 
    &amp;pExampleClass, 0);

  SysFreeString(PathToClass);

  if (hRes != 0)
    return;

  pExampleClass-&gt;SpawnDerivedClass(0, &amp;pNewDerivedClass);
  pExampleClass-&gt;Release();  // Don't need the superclass any more

  VARIANT v;
  VariantInit(&amp;v);

  // Create the class name
  // =====================

  V_VT(&amp;v) = VT_BSTR;
  V_BSTR(&amp;v) = SysAllocString(L"Example2");
  BSTR Class = SysAllocString(L"__CLASS");
  pNewDerivedClass-&gt;Put(Class, 0, &amp;v);
  SysFreeString(Class);
  VariantClear(&amp;v);

  // Create another property
  // =======================
  V_VT(&amp;v) = VT_BSTR;
  V_BSTR(&amp;v) = SysAllocString(L"&lt;default&gt;");
  BSTR OtherProp = SysAllocString(L"OtherInfo2");
  pNewDerivedClass-&gt;Put(OtherProp, 0, &amp;v);

  SysFreeString(OtherProp);
  VariantClear(&amp;v);

  // Register the class with CIMOM
  // ============================
  hRes = g_pNamespace-&gt;PutClass(pNewDerivedClass, 0, 0);
  pNewDerivedClass-&gt;Release();
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
