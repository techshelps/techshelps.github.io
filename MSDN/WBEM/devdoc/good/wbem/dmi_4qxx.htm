<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DMITEST Code Sample</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_dmitest_code_sample"></a>DMITEST Code Sample</h1>
<p>
This section describes the dmitest code sample (DMITEST.EXE), a Win32 console application that uses the WBEM API to access and manipulate a DMI 2.0 enabled Win32 platform. The sample includes examples of DMI 2.0 MIF files that will be used to install components in the DMI database.</p>
<p>
The same code reads input data from a script file, DMITEST.SCR, processes the command script, and makes appropriate WBEM API calls to access the DMI database. The application then will store the output data into a file called DMITEST.OUT.</p>
<p>
The DMITEST application relies on the user to ensure that the DMI 2.0 Service Provider is already running on the system and that the WBEMDMIP.MOF file has already been compiled and installed into the CIMOM's repository to enable DMI operations. </p>
<p>
The DMITEST code sample was developed using Microsoft Visual C++  version 5.0, and is in the \WBEM\SDK\COM\DMITEST directory.</p>
<p>
The DMITEST' s MIF data</p>
<p>
The application uses the MIF files DBTYPES1.MIF and TEMPCOM1.MIF to install three components in the DMI database and access them through the DMI provider. The DBTYPES1.MIF is installed twice. </p>
<p>
The DMITEST.SCR script uses hard-coded path of C:\TESTMIFS for the location of the above two MIF files. To access the MIF files from a different directory, change the DMITEST.SCR file to look for the correct path.</p>
<p>
The files included in this sample</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Sample File</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>DMITEST.CPP</td>
<td width=52%>Main source file for the DMITEST application responsible for reading and processing command scripts from the DMITEST.SCR input file and submitting DMI requests to WBEM.</td>
</tr>
<tr valign=top>
<td width=48%>DMITEST.H</td>
<td width=52%>Header file for DMITEST.CPP module.</td>
</tr>
<tr valign=top>
<td width=48%>DMITEST.SCR</td>
<td width=52%>Containing the DMI command scripts processed by the DMITEST application.</td>
</tr>
<tr valign=top>
<td width=48%>DMITEST.OUT</td>
<td width=52%>DMITEST application generated output file containing the results from executing the DMI service requests.</td>
</tr>
<tr valign=top>
<td width=48%>DATATYPES.CPP</td>
<td width=52%>Code for manipulating the OLE data types used by DMITEST.CPP.</td>
</tr>
<tr valign=top>
<td width=48%>DATATYPES.H</td>
<td width=52%>Header file for DATATYPES.CPP.</td>
</tr>
<tr valign=top>
<td width=48%>DEFINES.H</td>
<td width=52%>Header file of definitions used to turn off some sections of the WINDOWS.H header file not used by the application.</td>
</tr>
<tr valign=top>
<td width=48%>WBEMSVC.H</td>
<td width=52%>Header file containing the CIMOM interface definitions.</td>
</tr>
<tr valign=top>
<td width=48%>DBTYPES1.MIF</td>
<td width=52%>MIF file used to install a DMI component called "First Database Types MIF."</td>
</tr>
<tr valign=top>
<td width=48%>TEMPCOM1.MIF</td>
<td width=52%>MIF file used to install a DMI component called "Test System Temporary Component."</td>
</tr>
<tr valign=top>
<td width=48%>DMITEST.DSP, DMITEST.DSW</td>
<td width=52%>Visual C++ 5.0 project file used to build the DMITEST.EXE executable.</td>
</tr>
</table><br>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build the DMITEST module</h5>
<ol>
<li>
Run the Microsoft Visual C++ 5.0 Development Studio program.</li>
<li>
Load the DMITEST.DSP project file.</li>
<li>
From the BUILD menu, select SETTINGS. Choose the Preprocessor option from the C/C++ Tabbed dialog box. Set the Additional Include Directory entry to the INCLUDE directory of the WBEM SDK installed on your system.</li>
<li>
Replace the WBEMUUID.LIB module in the project files list with the one in the LIB directory of the WBEM SDK installed on your system.</li>
<li>
From the BUILD menu, select UPDATE ALL DEPENDENCIES.</li>
<li>
Rebuild the project to generate the DMITEST.EXE module.</li>
<li>
Verify that DMITEST.SCR file is in the same directory as the DMITEST.EXE module. </li>
<li>
Run the DMITEST application and view DMITEST.OUT file for the results after the program terminates.</li>
<li>
Open the DMITEST.CPP module and set breakpoints on the <i>ProcessScriptFile( )</i> function, run the DMITEST application again, and observe how the application accesses DMI information through WBEM.</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
