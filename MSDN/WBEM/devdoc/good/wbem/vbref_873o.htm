<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DWbemClassObject.Next</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_hmm_dwbemclassobject.next"></a>DWbemClassObject.Next</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>DWbemClassObject.Next</b> method retrieves the next property in an enumeration that was started with <a href="vbref_8h7y.htm"><b>DWbemClassObject.BeginEnumeration</b></a>. This should be called repeatedly to enumerate all the properties until WBEM_S_NO_MORE_DATA is returned. If the enumeration is to be terminated early, call <a href="vbref_2v1q.htm"><b>DWbemClassObject.EndEnumeration</b></a>.</p>
<p>
The order of the properties returned during the enumeration is not defined.  </p>
<pre><code><b>DWbemClassObject.Next(
  [in] </b><i>lFlags <b> </b></i><b>As<i> </i>Long,</b>
<b>  [out, OPTIONAL] </b><i>pName <b> </b></i><b>As<i> </i>String, </b>
<b>  [out, OPTIONAL] </b><i>pVal <b> </b></i><b>As<i> </i>VARIANT,</b>
<b>  [out, OPTIONAL] </b><i>pvtType <b> </b></i><b>As<i> </i>Long,</b>
<b>  [out, OPTIONAL] </b><i>plFlavor <b> </b></i><b>As<i> </i>Long</b>
<b>) As Long</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lFlags</i></dt>
<dd>
Reserved. It must be zero.</dd>
<dt>
<i>pName</i></dt>
<dd>
A string that will contain the property name. It can be set to <b>vbNullString</b> if you do not need the name.</dd>
<dt>
<i>pVal</i></dt>
<dd>
This <b>VARIANT</b> is filled with the value of the qualifier. It can be set to <b>NULL</b> if you do not need the value. If an error code is returned, the <b>VARIANT</b> in <i>pVal </i>is left unmodified.</dd>
<dt>
<i>pvtType</i></dt>
<dd>
Can be <b>NULL</b>. If not <b>NULL</b>, it must be a VARTYPE into which the type of the property is placed. The value of the property can be a VBNULL <b>VARIANT</b>, in which case this parameter would be necessary to determine the actual type of the property. <i>plFlavor</i>
<p>
Can be <b>NULL</b>. If not <b>NULL</b>, the Long value receives information on the origin of the property as follows:

<dl>
<dt>
WBEM_FLAVOR_ORIGIN_LOCAL</dt>
<dd>
The property belongs to the derived-most class.</dd>
<dt>
WBEM_FLAVOR_ORIGIN_PROPAGATED</dt>
<dd>
The property was inherited from a parent class.</dd>
<dt>
WBEM_FLAVOR_ORIGIN_SYSTEM</dt>
<dd>
The property is a standard system property.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%>WBEM_E_INVALID_PARAMETER</td>
<td width=50%>An invalid parameter was specified, or the namespace could not be parsed.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_OUT_OF_MEMORY</td>
<td width=50%>There was not enough memory to complete the operation.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_E_UNEXPECTED</td>
<td width=50%>Did not call <a href="vbref_8h7y.htm"><b>DWbemClassObject.BeginEnumeration</b></a>.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_NO_ERROR</td>
<td width=50%>Success.</td>
</tr>
<tr valign=top>
<td width=50%>WBEM_S_NO_MORE_DATA</td>
<td width=50%>No more properties are left in the enumeration.</td>
</tr>
</table><br>
<h4>Sample Code</h4>
<pre><code>Private Sub gather_desktop_data()
' This Subroutine fills a listbox with the desktop configurations.
  Dim ppEnum As DIEnumWbemClassObject 
  Dim ppObject As DWbemClassObject
  Dim pVal As Variant
  
  If wbem_logon &lt;&gt; WBEM_NO_ERROR Then   'logon Subroutine failed
     MsgBox ("Unable to log on to namespace")
     Exit Sub
  End If

' ppNamespace is a DIWbemServices type object bound to the
' specified namespace in wbem_logon
  ppNamespace.CreateInstanceEnum "Win32_desktop", WBEM_FLAG_DEEP, Nothing, ppEnum
  While ppEnum.Next(1000, ppObject) &lt;&gt; WBEM_S_FALSE
        ppObject.Get "__RELPATH", 0, pVal, 0, 0
        Listbox.AddItem pVal 'add to a listbox
  Wend
  Set ppEnum = Nothing     'Set the object back to nothing
End Sub</code></pre>
<h4>Remarks</h4>
<p>
If the underlying type of the property is an <a href="concepts_5lyr.htm">object path</a>, a date/time, or another special type, the returned type does not contain enough information. The caller must examine the CIMTYPE qualifier for the specified property, and determine if the property is an object reference, date/time, or another special type.</p>
<p>
This method also returns <a href="concepts_9kmr.htm">system properties</a>.</p>
<h4>See Also</h4>
<p>
<a href="vbref_8h7y.htm"><b>DWbemClassObject.BeginEnumeration</b></a>, <a href="vbref_2v1q.htm"><b>DWbemClassObject.EndEnumeration</b></a>, <a href="vbref_0alw.htm"><b>DWbemClassObject.Get</b></a>, <a href="concepts_9kmr.htm">System Properties</a></p>
<p>&nbsp;</p></body>
</HTML>
