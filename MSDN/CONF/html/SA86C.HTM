<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How It Works</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>How It Works</H3><p>The routine to create and mail reports is called Main and is contained in the Reports module. The relevant code is described as follows.</P>
<p>Log on to MAPI</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">    'Result = MAPILogon(0, "", "", MAPI_LOGON_UI, 0, gSession)
    'If Result &lt;&gt; SUCCESS_SUCCESS Then Exit Sub</font></pre>
<p>Create a report and output to Microsoft Excel format</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">    DoCmd OutputTo A_REPORT, "Project Summary", A_FORMATXLS,     "C:\~TEMP.XLS"</font></pre>
<p>Initialize MAPI variables</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">        ReDim gRecipients(0)
        ReDim gFiles(0)
        gMessage.RecipCount = 1
        gMessage.FileCount = 1</font></pre>
<p>Specify the Microsoft Excel file attachment</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">        gFiles(0).Reserved = 0
        gFiles(0).Flags = 0
        gFiles(0).Position = 0
        gFiles(0).pathname = "c:\~temp.xls"
        gFiles(0).filename = "Reports.xls"
        gFiles(0).FileType = ""</font></pre>
<p>Specify the Recipient (manager)</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">        gRecipients(0).Name = rs("Manager")
        gRecipients(0).RecipClass = MAPI_TO</font></pre>
<p>Specify the Subject (NoteText is set to one space so the space can be replaced with the file attachment)</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">        gMessage.Subject = "Weekly Report"
        gMessage.NoteText = " "</font></pre>
<p>Send the message by calling MAPISendMail</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">        Result = MAPISendMail(gSession, 0, gMessage,                         gRecipients(0), gFiles(0), 0, 0)</font></pre>
<p>Log off MAPI</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Result = MAPILogoff(gSession, 0, 0, 0)</font></pre></BODY></HTML>
