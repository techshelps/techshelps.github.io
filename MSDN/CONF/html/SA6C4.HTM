<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"Posting" queries are faster than explicit code</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>"Posting" queries are faster than explicit code</H3><p>The Microsoft Jet database engine provides many advanced query capabilities. Many of these are overlooked when it comes time to write update code. One example of a common scenario where a single update query can replace multiple lines of code is a so-called "Posting" query.</P>
<p>A posting query typically consists of two tables: a table that contains the "master" data, and an "update" table of similar structure that contains changed values for existing data in the master table and new rows to be inserted. Usually you would write explicit code that walks the update table and applies the changes to the master table, either updating or appending new records as required.</P>
<p>The code to do this can be replaced with a single query. By taking advantage of Jet's ability to do updatable outer joins, you can join the update table to the master table and specify that the master fields be updated with the update fields. If a record doesn't exist in the master, then because it is an outer join, the new records will appear in the candidate update set and the join field will be updated - thereby creating a new record.</P>
<p>For example, the following query would update to an Orders table from an Order Updates table:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">UPDATE Orders RIGHT JOIN [Order Updates]
ON Orders.[Order ID] = [Order Updates].[Order ID]
SET Orders.[Order ID] = [Order Updates].[Order ID],
Orders.[Customer ID] = [Order Updates].[Customer ID],
Orders.[Employee ID] = [Order Updates].[Employee ID],
Orders.[Required Date] = [Order Updates].[Required Date],
Orders.[Shipped Date] = [Order Updates].[Shipped Date],
Orders.Freight = [Order Updates].[Freight];</font></pre>
<p>This query could be tweaked further to allow for blank entries in the Order Updates table for certain fields. E.g. instead of:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Orders.Freight = [Order Updates].[Freight]</font></pre>
<p>you could use:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Orders.Freight = IIF(IsNull([Order Updates].Freight), 
                    Orders.Fright, [Order Updates].Freight)</font></pre></BODY></HTML>
