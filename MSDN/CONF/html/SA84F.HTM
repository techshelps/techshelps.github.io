<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logging In To A MAPI Session</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Logging In To A MAPI Session</H3><p>Prior to working with MAPI, you must sign in and allow the system to validate your password, if you've assigned one. When you use the MAPI logon function, you specify several different things. These include whether to display the standard user ID and password box and what variable you need to assign the session to.</P>
<p>As you work with MAPI, you do so in a "session." The login process will return a session ID that you will refer to as you submit or retrieve messages. The general format of a basic implementation of the logon is:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">MAPILogon(0&amp;, "", "", MAPI_LOGON_UI, 0&amp;, gMAPISession)</font></pre>
<p>gMAPISession will be established with the new session ID in this case. It should be declared as a global variable so that your other routines can refer to it if necessary. </P>
<p>When you make the call, be sure to check the return status for SUCCESS_SUCCESS. The samples included for this session have the constants definition files provided by Microsoft and can be included in your application for easy reference.</P>
<p>When you specify "MAPI_LOGON_UI" in the call, MAPI will automatically display the familiar logon screen. This allows the user to specify the user name and password for the mail system and will use this information to establish the mail session.</P>
<P><img src="MAPILOGN.gif"></P>
<P>MAPI Logon Dialog Box</P>
<p>Be sure to put some error handling logic in your routines. If you will simply show the returned error code and a message indicating a problem, you should be able to provide the user with another chance to sign in. MAPI will also display an error message prior to returning to your application, generally providing good feedback to the user about what the problem is. </P></BODY></HTML>
