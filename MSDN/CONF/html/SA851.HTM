<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending A Basic Note</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Sending A Basic Note</H3><p>The first thing you'll want to experiment with is sending a standard text note using the MAIL API. You can accomplish this with the following routine which automates the process of logging on, establishing the recipient structure, attachment structure, etc. This function assumes that you've got the constants and API declarations that are included with this paper and that they are loaded in the current database. </P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Function SendMailBasic ()
    'This function simply calls the MAPI functions
    'to prompt the user for login, addressee information, etc.
    '
    'This is the most basic of mail-enabling routines because
    'we're allowing MAPI to handle all aspects of the creation
    'of the message.

    On Error GoTo SendMailBasicErr

    Dim iStatus As Long
    Dim tMessage As MAPIMessage
    Dim tRecips As MAPIRecip
    Dim tFiles As MAPIFile
    
    'first, logon to MAPI
    
    iStatus = MAPILogon(0&amp;, "", "", MAPI_LOGON_UI, 0&amp;, gMAPISession)
    If iStatus &lt;&gt; SUCCESS_SUCCESS Then
        MsgBox "Unable to logon to MAPI"
        Exit Function
    End If

    'next, call MAPI to display the dialog box to send a note
    'by specifying MAPI_DIALOG, the result is the presentation of
    'the standard send note dialog box.
    iStatus = MAPISENDMAIL(gMAPISession, 0&amp;, tMessage, tRecips, tFiles, MAPI_DIALOG, 0&amp;)
    If iStatus &lt;&gt; SUCCESS_SUCCESS Then
        MsgBox "Unable to send message"
        Exit Function
    End If

    'logoff of mail, release our session
    iStatus = MAPILogoff(gMAPISession, 0, 0, 0)

    Exit Function
    
SendMailBasicErr:
    MsgBox Error$
    Exit Function

End Function</font></pre>
<p>This function completes all the necessary steps to send a basic e-mail message from within an Microsoft&nbsp;Access application. First, logon to MAPI as we've explained. If an error is encountered, let the user know about a problem and exit the function. </P>
<p>Next, make the call to MAPI to display the dialog box and prompt the user for the various information items. Since we've told MAPI that it's responsible for the user interface for the message, it will also send out the message after the user has completed the work. </P>
<p>Finally, we logoff from the MAPI session, clearing our session ID. At the beginning of the function, we've established a basic error handler which simply displays the Microsoft&nbsp;Access error message and exits the function.</P>
<p>This will provide the common dialog box that your users are familiar with. It will provide the interface that they know, including the address book, options dialog box and other items that are used to create or manage the message. </P></BODY></HTML>
