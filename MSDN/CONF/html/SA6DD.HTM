<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cancel Event</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Cancel Event</H3><p>With CBF, you also have the added ability to cancel specific events through the use of a parameter in the event's procedure. An example of this is again the "OnOpen" event and its event procedure, prototyped as follows:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3"><B>Sub Form_Open (Cancel as Integer)</B></font></pre>
<p>By setting the Cancel parameter to <B>True</B> before exiting the event procedure, we can tell the form to stop loading. This allows us to move more code behind the Wizard form. For example, before the Subform Wizard can begin, it must first check that the subform the user is linking contains at least one field. If the subform does not contain a field, the Wizard should stop and alert the user before opening the form. Without the capability to cancel a form open event, this validation code must be placed in the entry point, adding more global code. With the cancel event, we can move this CBF and place it in the form's OnOpen event where, if the condition is not met, we can stop the form from being displayed. Here's the code:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3"><B>' If the subform does not contain any controls halt the Wizard</B>
iSub = frmSubform.Count
    If (iSub = 0) Then
        ss_DisplayErr errSUBFORMEMPTY
        Cancel = True
        Exit Sub
<B>    End If</B></font></pre></BODY></HTML>
