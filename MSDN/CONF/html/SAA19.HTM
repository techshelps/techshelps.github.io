<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Returning a Value from a Modal Form</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Returning a Value from a Modal Form</H3><p>The following is an example wrapper class used to allow forms to return values. It uses a simple naming convention that the return value memvar must be called luRetValue. Since dialog forms which return values are normally modal, the example assumes that the form called is modal.</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">*-- The DoForm class is the wrapper class and 
*--  the DoForm UDF is used to call it.<BR>*-- Simply set memvar luRetValue in any code 
*--  snippet within a form/control method.<BR>*-- The exit code for the form should be 
*--  RELEASE thisform *and* CLEAR EVENTS.<BR>*-- This example set would need to be enhanced 
*--  to support parameter passing to the form.<BR>
? DoForm("MyForm.SCX")    &amp;&amp; Form MyForm.SCX should set
                                        &amp;&amp; luRetValue for the 
                                        &amp;&amp; return value.<BR>RETURN<BR>
FUNCTION DoForm(tcFileName)<BR>LOCAL oDoForm<BR>oDoForm=CREATEOBJECT('DoForm',tcFileName)<BR>RETURN oDoForm.Show()<BR>
DEFINE CLASS DoForm AS Custom<BR>
    cFileName=''<BR>
    FUNCTION Init(tcFileName)<BR>    this.cFileName=tcFileName<BR>    RETURN .T.<BR>    ENDFUNC<BR>
    FUNCTION Show<BR>    PRIVATE luRetValue<BR>    luRetValue=.T.<BR>    DO FORM (this.cFileName)<BR>    READ EVENTS<BR>    RETURN luRetValue<BR>    ENDFUNC<BR>
ENDDEFINE</font></pre></BODY></HTML>
