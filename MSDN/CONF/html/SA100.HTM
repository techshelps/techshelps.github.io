<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Microsoft Access As a DDE Server</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Using Microsoft&nbsp;Access As a DDE Server</H3><p>Microsoft&nbsp;Access DDE as both a destination (client) application and a source (<I>server</I>) application. Although Microsoft&nbsp;Access doesn't support automatic linking, it manually updates linked data at specified intervals. The client application is notified when a change has occurred in a Microsoft&nbsp;Access database. The client application can then update the linked data. In most cases, this update occurs as fast as an automatic update. You can specify the interval between DDE link updates by setting the Refresh Interval option under the Multiuser/ODBC category in the Options dialog box (View menu). In the same dialog box under the General category, Enable DDE Refresh turns this feature on or off, and Ignore DDE Requests instructs Microsoft&nbsp;Access to ignore or accept DDE requests from other applications.</P>
<p>Each DDE conversation is established on a particular topic, usually a data file, with the conversation thereafter limited to the items associated with that topic. For example, if you are running Word for Windows and want to insert data from a particular Microsoft&nbsp;Access database into a Word for Windows document, you need to initiate a DDE conversation with Microsoft&nbsp;Access by opening a channel and specifying the database name as the topic. You can then use that channel to obtain data from the database.</P>
<p>The following example shows how to create a Word for Windows WordBasic macro that uses Microsoft&nbsp;Access as a DDE <I>server</I>. (For this example to work, Microsoft&nbsp;Access must either be running or be listed in the <B>path</B> command in your AUTOEXEC.BAT file.)</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Sub MAIN<BR>    ' Using the System topic, open the NWIND.MDB database.
    ' The database must be open before you can use other DDE topics.
    Chan1 = DDEInitiate("MSAccess", "System")
    DDEExecute Chan1, "[OpenDatabase C:\ACCESS\NWIND.MDB]"

    ' Get all the data from the Orders and Products query.
    Chan2 = DDEInitiate("MSAccess", "NWIND;QUERY Orders and Products")
    MyData$ = DDERequest$(Chan2, "All")
    DDETerminate Chan2

    ' Close the database.
    DDEExecute Chan1, "[CloseDatabase]"
    DDETerminate Chan1

    ' Insert the data into a text file.
    Open "MYDATA.TXT" For Append As #1
    Print #1, MyData$
    Close #1
End Sub</font></pre>
<p>As a DDE <I>server</I>, Microsoft&nbsp;Access supports the following topics:</P>
<P>     The System topic</P>
<P>     The name of a database</P>
<P>     The name of a table</P>
<P>     The name of a query</P>
<P>     A Microsoft&nbsp;Access SQL statement</P>
<H4> </A>The System Topic</H4><p>The System topic is a standard topic for all Windows-based applications. It returns information about the topics supported by the application.</P>
<p>The System topic supports the following Microsoft&nbsp;Access items.</P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="52pt" VALIGN="TOP"><COL WIDTH="312pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Item</B></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Returns</B></P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>SysItems</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of items supported by the System topic in Microsoft&nbsp;Access.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>Formats</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of the formats Microsoft&nbsp;Access can copy onto the Clipboard.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>Status</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>"Busy" or "Ready."</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>Topics</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The System topic and a list of the full paths of all open Microsoft&nbsp;Access databases.</P></TD>

</TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4> </A>The <I>database</I> Topic</H4><p>The <I>database</I> topic is the filename of an existing Microsoft&nbsp;Access database. You can specify just the base name, as in the NWIND database, or its full path and .MDB extension, as in C:\ACCESS\NWIND.MDB. After you initiate a DDE conversation with the database, you can request a list of the objects in that database.</P>
<p>The database topic supports the following items.</P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="62pt" VALIGN="TOP"><COL WIDTH="112pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Item</B></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Returns</B></P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>TableList</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of table names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>QueryList</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of query names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>FormList</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of form names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>ReportList</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of report names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>MacroList</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of macro names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>ModuleList</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A list of module names.</P></TD>

</TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4> </A>The TABLE <I>tablename</I>, QUERY <I>queryname</I>, and SQL <I>sqlstring</I> Topics</H4><p>These topics use the following syntax:</P>
<p><I>databasename</I>;TABLE <I>tablename</I></P>
<p><I>databasename</I>;QUERY <I>queryname</I></P>
<p><I>databasename</I>;SQL [<I>sqlstring</I>]</P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="74pt" VALIGN="TOP"><COL WIDTH="290pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Argument</B></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Description</B></P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><I>databasename</I></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The name of the database that the table or query belongs to or that the SQL statement applies to, followed by a semicolon (;). The database name can be just the base name (NWIND) or its full path and .MDB extension (C:\ACCESS\NWIND.MDB).</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><I>tablename</I></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The name of an existing table.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><I>queryname</I></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The name of an existing query.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><I>sqlstring</I></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A valid SQL statement up to 255 characters long, ending with a semicolon. To exchange more than 255 characters, omit this argument and instead use successive <B>DDEPoke</B> statements to build an SQL statement.</P></TD>

</TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><p>The following table lists the valid items for the TABLE <I>tablename</I>, QUERY <I>queryname</I>, and SQL <I>sqlstring</I> topics.</P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="73pt" VALIGN="TOP"><COL WIDTH="292pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Item</B></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Returns</B></P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>All</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>All the data in the table, including field names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>Data</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>All rows of data, without field names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>FieldNames</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A single-row list of field names.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>FieldNames;T</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>A two-row list of field names (first row) and their data types (second row).</P>
<P>These are the values returned and the data types they represent:</P>
<P>0&mdash;Invalid</P>
<P>1&mdash;True/False (non-<B>Null</B>) </P>
<P>2&mdash;Unsigned byte (Byte) </P>
<P>3&mdash;2-byte signed integer (Integer) </P>
<P>4&mdash;4-byte signed integer (Long) </P>
<P>5&mdash;8-byte signed integer (Currency) </P>
<P>6&mdash;4-byte single-precision floating-point (Single) </P>
<P>7&mdash;8-byte double-precision floating-point (Double) </P>
<P>8&mdash;Date/Time (integral date, fractional time) </P>
<P>9&mdash;Binary data, 255 bytes maximum</P>
<P>10&mdash;ANSI text, not case-sensitive, 255 bytes maximum (Text) </P>
<P>11&mdash;Long binary (OLE Object) </P>
<P>12&mdash;Long text (Memo) </P></TD>

</TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><p></P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="61pt" VALIGN="TOP"><COL WIDTH="304pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Item</B></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P><B>Returns</B></P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>NextRow</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The data in the next row in a table or query. When you first open a channel, NextRow returns the data in the first row. If the current row is the last record and you request NextRow, the request fails.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>PrevRow</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The data in the previous row in a table or query. If PrevRow is the first request on a new channel, the data in the last row of the table or query is returned. If the first record is the current row, the request for PrevRow fails.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>FirstRow</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The data in the first row of a table or query.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>LastRow</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The data in the last row of a table or query.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>FieldCount</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>The number of fields in a table or query.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>SQLText</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>An SQL statement representing a table or query. For tables, this item returns an SQL statement in the form "SELECT * FROM <I>tablename</I>;"</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>SQLText;<I>n</I></P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>An SQL statement, in <I>n</I>-character chunks, representing a table or query, where <I>n</I> is an integer up to 255.</P></TD>

</TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P></BODY></HTML>
