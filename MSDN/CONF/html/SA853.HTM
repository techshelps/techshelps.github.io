<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Attachments to Your Message</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Adding Attachments to Your Message</H3><p>Attaching files to your message is accomplished by filling out the MAPIFile structure and updating the message header information to reflect the number of files that are attached. You treat the file attachments exactly as you do recipients, first updating the structure, then specifying the total number of attachments.</P>
<p>The following code sample shows how you can attach a file to an existing message. </P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">'---------------------------------------------------
'Establishing attached file counts
'---------------------------------------------------
tMessage.FileCount = 1
ReDim tFiles(1) as MAPIFile

tFiles(1).PathName = "C:\AUTOEXEC.BAT"
tFiles(1).Reserved = 0&amp;
tFiles(1).Position = 1
tFiles(1).FileName = ""
tFiles(1).FileType = ""</font></pre>
<p>This attaches the file C:\AUTOEXEC.BAT to the message at the first position of the message. Don't forget, to successfully attach an object, you'll have to already have at least a single character in the text of the message. </P>
<p>Using this technique, you can export a set of data to an excel spreadsheet, attach the spreadsheet and send it to another system. On the other end, you'll reverse the process, saving the attachment to disk when the message is opened. You can then import the data from the file on disk, updating the remote system's database table(s). </P></BODY></HTML>
