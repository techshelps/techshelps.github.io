<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logging Off From MAPI Sessions</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Logging Off From MAPI Sessions</H3><p>After you've completed your work, you need to release the MAPI session that you've been working with. If you don't or if your program terminates unexpectedly (which happens quite a lot during development), you'll reach MAPI's session limit. In that case, you'll receive a message indicating that you have too many current sessions and that you are unable to establish a new session. </P>
<P><img src="TOOMNYS.gif"></P>
<P>MAPI Won't Allow An Infinite Number of Sessions</P>
<p>In order to clear MAPI sessions, if you have either the mail client or schedule plus running, you can select File, Exit and Log Off from their menus. This will effectively sign you off of MAPI and close all sessions. </P>
<p>In your program code, you can clear the MAPI session by calling the MAPILogoff API function. You simply pass in the session ID that you want to logoff from and MAPI will clear it, closing the connection and invalidating the session ID. </P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">iStatus = MAPILogoff(gMAPISession, 0, 0, 0)</font></pre>
<p>The status returned should again be SUCCESS_SUCCESS, although in almost all cases, it's not a status that you need to interpret for the user. This is mostly due to the fact that if the process fails, it probably means that the session ID is invalid, indicating that the connection has already been closed by another process. This can happen if, as indicated above, the user goes into Mail or Schedule Plus and Logs off the system from within those applications. </P></BODY></HTML>
