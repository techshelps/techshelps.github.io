<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Batch Processing Word for Windows Files</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Batch Processing Word for Windows Files</H3><p>In preparing text files we often need to perform the same set of routines on all of the files in a particular directory. The following WordBasic routine will process all of the files in the directory that contains the active document. It opens each file, determines it's extension and takes action contingent upon the extension.</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Sub MAIN

Dim rec As DocumentStatistics
Dim fnames$(500)

'Find the dir of the active document
GetCurValues rec
docpath$ = rec.Directory + "\*.*"

'Fill an array with the names of all files 
currfile$ = LCase$(Files$(docpath$))
While currfile$ &lt;&gt; ""
    fnames$(fcount) = currfile$
    fcount = fcount + 1
    currfile$ = LCase$(Files$())
Wend

'for each file in the array...
For j = 0 To fcount - 1
    FileOpen .Name = fnames$(j)

    'Get the file extension
    filetype$ = LCase$(Right$(fnames$(j), 3))

    'Do processes contingent on the extension
    Select Case filetype$
    Case "doc"
        '&lt;Code&gt;
    Case "txt"
        '&lt;Code&gt;
    Case Else
    End Select
    
    'Close the file without saving (it must be saved above)
    FileClose 2
Next j
End Sub</font></pre></BODY></HTML>
