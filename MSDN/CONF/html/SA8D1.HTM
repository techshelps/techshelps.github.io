<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UPS</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>UPS</H3><p>Unlike LAN Manager for OS/2, uninterruptible power supply (UPS) services are supported by both Microsoft Windows&nbsp;NT Workstation and Microsoft Windows&nbsp;NT Server. UPS systems allow the computer to continue to function from battery reserves for a short period of time in the event of a power failure. They also protect from both power sags (brown outs) and spikes (typically experienced when the power returns). The UPS services provided with Microsoft Windows&nbsp;NT is sensitive to signals from the UPS unit and performs orderly shut downs of applications, services, and file systems if the UPS power is depleted. The UPS services is built into the base operating system itself. This allows it easier access to the file systems in the event of a power problem.</P>
<p>UPS provides two levels of protection. First, it keeps the computer active during power outages of short or medium durations. This allows the computer to continue processing data without loss of time. It also allows the computer to be shut down in an orderly fashion before the battery power is fully depleted. The main advantages is to allow the file system to flush its internal cache buffers to the disk before the power to the computer is lost.</P>
<p>As with other components in a distributed system, connectivity during a power outage is only as good as the weakest chain. Placing a UPS unit on a computer keeps that computer up and active. If the computer is a server, then the server remains up. If the computer is a workstation, it remains active. However, if there are no UPS devices on hubs, concentrators, routers, or bridges, the workstation and the server may still be unable to communicate. Planning which pieces of the environment should be protected by a UPS device depends on the expectation of its use. If the UPS is used only to prevent data lost at the server, then placing a UPS system only on the server is enough. If the expectation is to be able to continue with business at some level, then having some number of workstations and printers on UPS may also be needed. If there are electrically active components in the network, they too may have to be on a UPS to accomplish the business goals during power outages.</P>
<p>All power is run through the UPS system, where the battery is constantly being charged. When there is a sag or a power failure, the battery automatically begins providing power to the computer and the appropriate communications line is raised. This alerts the UPS Service to take the appropriate action based on the configuration. Within the UPS industry there is a standard for connecting UPS units to a Com port on a computer; this connection has 3 pins. The actual pin depends on the type of connector used (DB-25 or DB-9). Pins are "signaled" when a problem is detected. Signaling can be either setting the pin high (from its normal low state) or setting the pin low (from its normal high state) depending on the needs of the UPS device being used. The CTS pin (five on a DB-25 or eight on a DB-9) is used to signal a power failure. When the power coming into the UPS device is lost or sags below a threshold, this pin is signaled. The DCD pin (eight on a DB-25 or one on a DB-9) is signaled when the battery is about to run out of power. When this pin is signaled, Microsoft Windows&nbsp;NT expects to have two minutes to perform the needed shutdown activities. Finally, the UPS service can communicate with the UPS device through the DTR pin (20 on a DB-25 or four on a DB-9). This pin is signaled to inform the UPS device to shut down. Two other pins provide for support of contact-closure type UPSs.</P>
<p>The UPS control panel controls the configuration of the interface between the UPS device and the UPS service. The UPS service is selected for execution by the check box at the top of the screen. It says "installed," but it is always installed, and is really marked for automatic startup during the boot sequence. The Com port is selected from the list box. The signals generated by the UPS and the values on those pins to indicate signaling is provided. If the UPS device can generate the power failure signal, then certain additional characteristics can be entered. First is the life expectancy and the battery recharge time. This informs Microsoft Windows&nbsp;NT of the time the battery can be expected to keep the system up. This also informs it of the amount of time it takes to recharge the battery to that level. These fields are not enabled if the UPS has a low battery signal because the UPS device can inform the UPS service directly. If the UPS can signal immediately that there was a power failure, it is advisable that someone be alerted to the problems. The time between the power failure and the initial alert can be set. Thus, if the power failure is of a short duration, no error messages are generated. If the power failure is persistent, the frequency of additional warning messages can be set.</P>
<p>The first time the UPS service is activated, it is marked as an automatically started service. The UPS service does not start the UPS at that time. The UPS control panel prompts the user to start the service by way of the service manager control panel. The system does not have to be rebooted to start the service. Once the service is marked as automatic, it is started during subsequent system boots.</P>
<p>The actual UPS service itself runs as a background task. When the power failure pin is signaled, the initial warning timer is started. If the pin is not "unsignaled," the timer expires and the initial warning message is sent. This message tells the user a failure has occurred and it is now running on backup. When the low battery pin is signaled, or when the life expectancy of the battery has expired, the system automatically begins shutdown procedures.</P></BODY></HTML>
