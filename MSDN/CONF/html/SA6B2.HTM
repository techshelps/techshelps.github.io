<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>In inner loops, use Field objects instead of myRS!fieldname (Q112724)</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>In inner loops, use Field objects instead of myRS!fieldname (Q112724)</H3><p>To speed up iterative (looping) processes through large numbers of rows using Access Basic, declare all field references explicitly.</P>
<p>The following is an example of Access Basic code that can be improved by using direct Field references:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">While Not rstOrd.EOF
   rstOrd.Edit
   rstOrd.Fields!Price = rstOrd!Qty * rstOrd!UnitCost
   rstOrd.Update
   rstOrd.MoveNext
Wend</font></pre>
<p>In the example above, the field variable "lookup" (that is, where Access Basic equates variable names with database fields) for the three field variables Price, Qty, and UnitCost is performed in the same While loop where the calculations are performed. In this configuration, both calculations and lookups must be performed inside the While loop, which is not an efficient design. This is how the changes might look:</P>
<p>The following is an example of Access Basic code that is more efficient:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Dim Price As Field, Qty As Field, UnitCost As Field
Set Price = rstOrd!Price
Set Qty = rstOrd!Qty
Set UnitCost = rstOrd!UnitCost
rst.BeginTrans
While Not rstOrd.EOF
   rstOrd.Edit
   Price = Qty * UnitCost
   rstOrd.Update
   rstOrd.MoveNext
Wend
rst.CommitTrans</font></pre>
<p>This example runs faster because Access Basic performs the field lookup only once for each field and completes it before executing the loop. A direct reference to each of the three fields is then stored in the three field variables Price, Qty, and UnitCost. As a result, no lookup is required in the While loop, and the field values are accessed and manipulated directly.</P>
<p>The code examples above are illustrative. In some cases, an Update query can be a faster way to accomplish the task (see tip #11). Also, speed differences will be slight for small numbers of records. Note the use of tip #12 included in the revised example.</P></BODY></HTML>
