<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using SendObject to Send A Mail Message</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Using SendObject to Send A Mail Message</H3><p>As you've seen, using MAPI to send messages is quite straight-forward. You'll probably find that you'll come across instances where you require more programmatic control over the information that is sent.</P>
<p>In these cases, you may be able to use the Microsoft&nbsp;Access Basic SendObject function. With SendObject, you specify all of this information from within Microsoft&nbsp;Access Basic. If you do leave out a piece of information that is required, MAPI will step in and ask the user to clarify that item.</P>
<p>You may want to add the SendObject capabilities to a menu that is pertinent to your application. You can place a reference from the menu to an Microsoft&nbsp;Access Basic module routine that packages up the information and sends it to the defined recipient.</P>
<p>As an example, the Function below, ABSendObject function, send a copy of a table, hard-coded as "Company," to the destination you set up. You'll need to provide a valid destination address in sRecipient. The name should be unique in your mail system to avoid MAPI needing to resolve the name when the message is sent.</P>
<p>If you do not specify a unique name, the Send Note dialog will be shown and you will have to specify the name to send the message to. </P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Function ABSendObject ()
    'send an object, using MAPI, from Access to
    'another system - this routine is hardcoded
    'to send the company table.

    Dim sRecipient As String
    sRecipient = "Steve Wynkoop;"

    'This example specifies the user to send the object to.
    MsgBox "Sending message to: " &amp; sRecipient &amp; "..."
    DoCmd SendObject A_TABLE, "Company", A_FORMATXLS, sRecipient, , , "Copy of the company database.", , False
    
    MsgBox "Message sent."
End Function</font></pre>
<p>The table below shows the parameters expected by the SendObject method. As indicated before, if you omit these, MAPI will attempt to resolve the information, either by asking the user to clarify something, or by not sending the message and providing your calling routine with an error message.</P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="79pt" VALIGN="TOP"><COL WIDTH="285pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>ObjectType</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>Use the Microsoft&nbsp;Access intrinsic constants of A_TABLE, A_QUERY, A_FORM, A_REPORT or A_MODULE.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>ObjectName</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>This is the name of what you're going to send. This can be a form or query name, etc.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>OutputFormat</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>These file types are represented by the A_FORMATXLS, A_FORMATRTF and A_FORMATTXT intrinsic constants.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>To, CC, BCC, Subject and MessageText</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>All items are strings, providing the addressee's name, the message subject and any associated message text. BCC is not currently supported by the MSMail client.</P></TD>

</TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>EditMessage</P></TD>

<TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>True or False. This controls the display of the send note dialog box.</P></TD>

</TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><p>If the recipient information provided is not valid, the message will not be sent. Instead, your routine will receive an error message indicating that the recipient was not valid.</P>
<P><img src="SENDERR.gif"></P>
<P>Error message received when a recipient is not valid</P></BODY></HTML>
