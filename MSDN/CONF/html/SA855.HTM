<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working With Attachments</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Working With Attachments</H3><p>Once you've retrieved the messages containing the information you need, you'll need to process the information contained in the message. This may mean simply displaying it for a user to review, or it can also mean unbundling attachments that are included with the message. </P>
<p>When you read the message, you can use the FileCount NumFiles variable, returned with the MAPIReadMail call, to determine how many attachments are included. When you issue the MAPIReadMail call, MAPI opens not only the mail messages, but it also extracts the attachment, placing it in the user's TEMP subdirectory. All you need to do to retrieve the attachment and begin working with it, then, is to review the MAPIFile structure for the file name. Use this name to locate the file and begin working with it.</P>
<p>Here's some sample code that will help illustrate this capability:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">If NumFiles &gt; 0 Then
    'since there is a file attachment, import it.
    MsgBox "Importing " &amp; tFiles(0).PathName &amp; "..."

    'Import the files
    DoCmd TransferSpreadsheet A_IMPORT, 5, "Company", tFiles(0).PathName, True
    MsgBox tFiles(0).PathName &amp; " imported.
End If</font></pre>
<p>In this example, we first check the number of available files to make sure an attachment was present. If so, we indicate to the user that we'll be importing a file and then use the Microsoft&nbsp;Access Basic DoCmd function to run the TransferSpreadsheet method and import the sheet to the Company table. </P>
<p>It's interesting to note that MAPI has updated the path to the file, showing the path to the user's TEMP subdirectory in PathName. When you add an attachment, you use this field to specify where the file is found, then, when the message is read, MAPI updates the field to show the location of the attachment when it's unbundled. </P></BODY></HTML>
