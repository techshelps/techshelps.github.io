<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Preconnecting</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h3>Preconnecting</H3><p>Establishing a connection takes time and memory on both the client and the server. This section describes several ways you can limit connections and thus reduce the resources your application uses.</P>
<p>Using the connection-management capabilities of the Jet database engine, you can log a user onto a server when your application starts without waiting until the first form opens. Microsoft Jet caches the connection and authentication information and reuses them as needed.</P>
<p>One way to preconnect is to create a form to gather user and password information, construct a connection string containing the values, and use <B>OpenDatabase</B>. For example, the following procedure connects to a server called MyServer and opens a database:</P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Sub PreConnect (UserName As String, Password As String)
    Dim MyDB As Database, ConnStr As String
    
    ConnStr = "ODBC;DSN=MyServer;DATABASE=MyDatabase;"
    ConnStr = ConnStr &amp; "UID=" &amp; UserName &amp; ";"
    ConnStr = ConnStr &amp; "PWD=" &amp; Password &amp; ";"
    Set MyDB = OpenDatabase("", False, False, ConnStr)
    MyDB.Close        ' Close database but keep connection.
End Sub</font></pre>
<p>If you're not sure which ODBC data source to connect to, you can display a dialog box listing all registered data sources by using <B>"ODBC;"</B> for the connection string argument. Then you can access the actual connection string using the Connect property, which connects you to the server, as in the following example. You can then use the <B>ConnStr</B> value when you create pass-through queries or attach tables. </P>
<P CLASS="spacing"><BR></P>
<pre><FONT FACE="Courier New" SIZE="3">Sub PreConnect ()
    Dim MyDB As Database, ConnStr As String

    Set MyDB = OpenDatabase("", False, False, "ODBC;")
    ConnStr = MyDB.Connect
    MyDB.Close        ' Close database but keep connection.
End Sub</font></pre>
<p>In both examples, the <B>Close</B> method doesn't disconnect from the server &mdash; instead, Microsoft Jet caches the connection internally.</P></BODY></HTML>
