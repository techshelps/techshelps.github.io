<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Deploying Microsoft Windows 95 and Microsoft Windows NT Using Microsoft Systems Management Server</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>



	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>



	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h1>Deploying Microsoft Windows 95 and Microsoft Windows NT Using Microsoft Systems Management Server</h1>
<p>
<img src="ent308ef_1.gif" border=0></p>
<h2>Overview</h2>
<p>
<img src="ent308ef_2.gif" border=0></p>
<p>
The material in this session assumes that you meet the following prerequisites:
<ul>
<li>
You are certified on the Microsoft&reg; Windows NT&reg; Server network operating system.<br><br></li>
<li>
You know how to install and configure Systems Management Server (SMS) centralized management for distributed systems.<br><br></li>
<li>
You know how to inventory clients, query the database, and create packages and jobs using SMS Administrator.<br><br></li>
<li>
You have technical expertise in Microsoft Windows&reg; 95 and Microsoft Windows NT operating systems.</li>
</ul>
<h3>Objectives</h3>
<p>
At the end of this session, you will be able to:
<ul>
<li>
Plan an operating system upgrade using SMS.<br><br></li>
<li>
Describe the process for deploying an operating system upgrade.<br><br></li>
<li>
Determine which target client computers should receive the upgrade.<br><br></li>
<li>
Install Windows 95 for a variety of client configurations. <br><br></li>
<li>
Install Windows NT for a variety of client configurations.</li>
</ul>
<h2>Phase 1: Plan the Project</h2>
<p>
<img src="ent308ef_3.gif" border=0></p>
<p>
A major key to successful upgrades is knowledge of what can and cannot be done, and a clear picture of your desired end result.</p>
<p>
It is essential that you understand SMS product and client limitations and are completely familiar with the Windows 95 and Windows NT setup programs.</p>
<p>
SMS provides the delivery mechanism, not the installation technology. For a fully automated upgrade, you need to supply the appropriate unattended answer files. If you are unable to do a fully automated install or upgrade from a command line, then SMS will not be able to do it either. </p>
<h3>Know What Clients Can Be Upgraded</h3>
<p>
<img src="ent308ef_4.gif" border=0></p>
<p>
The target client must be participating in the SMS site. Inventory must be as current and up-to-date as possible.</p>
<p>
It is not possible to upgrade OS/2&reg; clients to either Windows 95 or Windows NT.</p>
<p>
It is also not possible to upgrade Windows 95 to Windows NT 4.0. If an upgrade path does not exist without SMS, then it also will not work with SMS. It is possible to upgrade MS-DOS&reg; operating system version 5.0 or later, Windows 3.1x, and Windows for Workgroups 3.1x operating system with integrated networking to either Windows 95 or Windows NT.</p>
<p>
SMS does not support shared or networked Windows installations. If you have a shared or network version of Windows and wish to do an upgrade with SMS, consider rolling back the clients to MS-DOS. </p>
<p>
SMS also does not support a single computer with more than one operating system installed on it. These are known as dual-boot computers. If you have dual-boot computers in your environment and want them to be SMS clients, you must choose the operating system under which you will install the SMS client and make it your primary operating system. SMS client functionality will not be available under the secondary operating system.</p>
<p>
In most cases, it is not possible to upgrade the operating system and applications in one package. Remember, if you cannot get it to work from a single command line, it will not work through SMS.</p>
<h3>Study Product Information</h3>
<p>
<img src="ent308ef_5.gif" border=0></p>
<p>
There are several sources of information for installing Windows 95 and Windows NT. Information and materials are updated regularly on the Systems Management World Wide Web (the Web) page. Current white papers of interest are:
<ul>
<li>
Automated Client Upgrade Process for Windows 95 and Windows NT Workstation through SMS<br><br></li>
<li>
Upgrading Client Operating Systems Using Package Definition Files</li>
</ul>
<p>
The Windows NT Workstation and Windows 95 resource kits contain invaluable information on the setup process of the products, including customization information.</p>
<p>
There is a Deployment Guide for both Windows NT Workstation and Windows 95. These documents go further in identifying potential pitfalls and giving step-by-step scenarios and examples.</p>
<p>
The TechNet compact disc contains the latest bulletins, white papers and Knowledge Base articles. Make sure there are no known issues with your upgrade plans.</p>
<p>
The Microsoft Premier Technology News Flash may include information such as common questions and answers, case studies, and Knowledge Base articles.</p>
<p>
In addition, other Internet resources may have helpful information for you. Spend a few minutes browsing the Web to see if there are any news groups or Web sites which may help you.</p>
<h3>Desktop Specification</h3>
<p>
<img src="ent308ef_6.gif" border=0></p>
<p>
There are multiple configuration options for both Windows 95 and Windows NT. It is very important to identify the configuration(s) that suit your environment and needs before you begin. You should create written specifications for both Windows 95 and Windows NT Workstation 4.0 before commencing any other work. Items to include and consider follow:</p>
<p>
<b>Setup options</b></p>
<p>
Determine the extent to which you want to allow users to setup and configure their own environment during initial install. For example: Do you want the user to setup the Microsoft Exchange mailbox using the Microsoft Exchange Wizard at time of setup? Do you want to fully automate the setup?</p>
<p>
<b>Networks</b></p>
<p>
Address all aspects of Windows 95 and Windows NT Workstation 4.0 networking options. For example: Default protocol, redirector, and services, and, additional protocols, redirectors, and services.</p>
<p>
<b>Local security</b></p>
<p>
Address all aspects of Windows 95 and Windows NT Workstation 4.0 local security options. For example: Will the users have access to their C drives? Will you require users to use local password protected screen savers? </p>
<p>
<b>Policies</b></p>
<p>
Address all aspects of Windows 95 and Windows NT Workstation 4.0 policy options. For example: Are policies currently in use? How many groups of users are there, and to which parts of the desktop will you allow access for each of these user groups? </p>
<p>
<b>Profiles</b></p>
<p>
Address all aspects of Windows 95 and Windows NT Workstation 4.0 profiles. For example: Is it important for a user to see his or her normal desktop environment when working on another computer? Will hardware profiles be required?</p>
<p>
<b>Local applications</b></p>
<p>
Address aspects of locally installed applications. For example: Which applications in addition to the operating system will be stored locally on all desktops? Will an anti-virus program be installed locally on all desktops?</p>
<p>
<b>Remote applications</b></p>
<p>
Address aspects of network applications. For example: In addition to the operating system, which applications will be delivered from remote network servers? Will you install Microsoft Office 97 office suite on a network server for desktop users? Do you have applications that require Open Database Connectivity (ODBC)?</p>
<p>
<b>Private and public data</b></p>
<p>
Address the storage of public and private data. For example: Will you give desktop users access to network servers with private data stores, access to shared data stores, or both?</p>
<p>
Once you have considered all of the previous points, create a specification document for each operating system and configuration. This document will be used as a guideline for the rest of the project.</p>
<h2>Phase 2: Identify Target Computers </h2>
<p>
<img src="ent308ef_7.gif" border=0></p>
<p>
Whether you are upgrading from Windows for Workgroups to Windows 95 or simply updating Windows NT clients to a newer version, there is a basic process to follow and common issues to resolve.</p>
<p>
The success of an operating system upgrade depends on the accuracy and completeness of the list of target computers in the SMS database. If computers in the list have incompatibilities in software or hardware, the upgrade will fail. If the SMS database is not accurate or complete, computers that should be upgraded may be missed. </p>
<p>
The administrator should take the following steps to ensure an accurate list of target computers:
<ol>
<li>
Verify the integrity of the SMS database.<br><br></li>
<li>
Determine the hardware requirements you want to set for your enterprise and run an appropriate query against the SMS database. <br><br></li>
<li>
From the query results, build a machine group or groups for the identified target computers.<br><br></li>
<li>
Check these computers for software that is incompatible with the operating system upgrade you will be doing.</li>
</ol>
<h3>SMS Database Integrity</h3>
<p>
<img src="ent308ef_8.gif" border=0></p>
<p>
Target computers are determined by querying the SMS database. Even if your queries are perfect, you will not get accurate results if the integrity of the SMS database is not maintained. There are three areas you should check to make sure the database is completely up to date.</p>
<p>
<b>Make sure each client runs SMSLS or RUNSMS </b></p>
<p>
Users should have the Smsls.bat file in their logon script or they should run Runsms.bat. If one of these files is not run, SMS is not installed on the client computer and inventory is not collected. Make sure users are not exiting out of the logon script before inventory collection can be completed. For Novell&reg; NetWare&reg; users, Smsls.scr should be added to the system login script.</p>
<p>
<b>Check inventory frequency</b></p>
<p>
It is important that the computer inventory is up to date in the SMS database before you run a query for target computers. It is recommended that you increase hardware inventory collection frequency to once per day. Also, check to make sure your users are logging on at least once per day. You may have users who log on once and stay logged on for several days. Inventory is only collected at logon, through the logon scripts, or when the user runs Runsms.bat.</p>
<p>
<b>Drop unused computers from the database</b></p>
<dl>
<dt>
Clean out unused computers from the database before running queries for the target computer. Check the database for computers that have not reported inventory for several collection periods. You may need to manually run inventory collection at the computer that is not reporting. Either log on to have the Smsls.bat script run or connect to \\<i>logon server</i>\SMS_SHR and run Runsms.bat.</dt>
<dd>
<b>Note</b>&nbsp;&nbsp;&nbsp;If the information in the database is questionable, delete the site history files. These files are located in Sms\Site.srv\Inventry.box\History and have an .hms extension. Deleting these files will not compromise the integrity of the database but it will ensure that the Management Information Format(MIF) files sent to the database are complete rather than delta-MIFs which contain only information that has been changed.</dd>
</dl>
<h3>Client Compatibility</h3>
<p>
<img src="ent308ef_9.gif" border=0></p>
<p>
Build a basic query to find computers that meet the hardware requirements for the operating system you are upgrading. </p>
<p>
Consider what parameters the hardware needs to meet with respect to:
<ul>
<li>
Processor name<br><br></li>
<li>
Amount of RAM<br><br></li>
<li>
Available hard disk space<br><br></li>
<li>
Display type<br><br></li>
<li>
Network card</li>
</ul>
<p>
Also, if you have client computers that are not on the hardware compatibility list (HCL) for the operating system upgrade you are doing, then consider checking for those clients in order to exclude them.</p>
<p>
Make sure that the client computer is running an upgradable operating system.</p>
<h3>Software Compatibility</h3>
<p>
<img src="ent308ef_10.gif" border=0></p>
<p>
Before upgrading a computer to a new operating system, it is necessary to verify that the target computers do not run software unsupported by that operating system, whether it is Windows 95 or Windows NT. In addition, there are some programs that are supported by the operating system, but that should not be running during setup. For example, many virus-checking terminate-and-stay-resident programs (TSRs) are not compatible with Windows 95 Setup.</p>
<p>
For a successful upgrade process, try one of these options:
<ul>
<li>
Remove computers with incompatible software from the machine group and upgrade them by hand.<br><br></li>
<li>
Write a script that removes or stops the incompatible item. The script can be run using an SMS job that is initiated before the upgrade.</li>
</ul>
<p>
<b>User restrictions </b></p>
<p>
You may need to build separate machine groups for users with specific needs. For example, if a set of computers is used by outside contractors who have security restrictions, they may receive a different installation than full-time employees.</p>
<p>
Also, different departments may use different user profiles that can be established during the operating system upgrade.</p>
<h3>Build Machine Groups</h3>
<p>
<img src="ent308ef_11.gif" border=0></p>
<p>
It is possible to run a query and distribute an operating system upgrade job in one step, within the Job Details dialog box. However, by running the query first, you can examine the list of clients that will receive the job and make any changes necessary.</p>
<p>
<b>Build a machine group</b></p>
<dl>
<dt>
After you run the query, you can build a machine group by copying the query results to a given machine group. A machine group is a selection of computers in the SMS database. You will probably build several machine groups for different installations. These will be your target groups for the jobs to run the operating system upgrade. </dt>
<dd>
<b>Note</b>&nbsp;&nbsp;&nbsp;In the inventory, the MS-DOS version for Windows 95 is recorded as version 7.0.<b> </b>Systems Management Server does not report an MS-DOS version for Microsoft Windows NT computers. This affects queries searching for MS-DOS versions.</dd>
</dl>
<p>
<b>To build a machine GROUP</b>
<ol>
<li>
In SMS Administrator, open the Machine Groups window.<br><br></li>
<li>
From the <b>File</b> menu, click <b>New</b> and create a machine group.<br><br></li>
<li>
Type an appropriate name for the machine group and then click <b>OK</b>.<br><br></li>
<li>
From the <b>File</b> menu, click <b>Execute Query</b>, and run the query for this group of computers.<br><br></li>
<li>
Select all the computers in the Query Results window.<br><br></li>
<li>
From the <b>File</b> menu, click <b>Add To Group</b> to add the query results to the machine group. You can also drag or paste the query results into the machine group.</li>
</ol>
<h2>Phase 3: Testing</h2>
<p>
<img src="ent308ef_12.gif" border=0></p>
<p>
Testing is an investment of time that will pay huge dividends when you carry out the real upgrade. Testing has been proved to make a difference in the success rate you will see. There may be other areas that should have distinct testing phases, but following are three testing phases that should be carried out:
<ul>
<li>
Lab testing on target hardware.<br><br></li>
<li>
Software testing for compatibility.<br><br></li>
<li>
Pilot testing with a small group of real users.<p>
<b>Important</b>&nbsp;&nbsp;&nbsp;Make sure you allocate adequate time, hardware, and people to testing.</p>
</li>
</ul>
<h3>Lab Testing on Target Hardware</h3>
<p>
<img src="ent308ef_13.gif" border=0></p>
<p>
Set up a lab with computers that match the typical target client. Many times installing a new client computer will not identify real-world problems. If possible, backup and restore a few real client computers to work with.</p>
<p>
The following guidelines should help you complete a successful lab test:
<ul>
<li>
Make sure each type of client is represented in the lab, whether that means a different amount of RAM or a different operating system.<br><br></li>
<li>
Review the project goals you wrote down in the first phase and use them to derive a testing goal. The more specific you were in the planning phase, the better test you will have. For example:<p>
“Windows 95 should install using our corporate default user profile, with the Microsoft Exchange client, with no user input required.” </p>
</li>
<li>
Start by testing a simple upgrade, with no customization. Add in customized scripts or changes once the basic functionality works. Do not try to run a fully automated installation right away.<br><br></li>
<li>
Use the same media that you will use for the client upgrade. OEM versions, Microsoft Developer Network (MSDN) versions, and the Microsoft BackOffice™ family compact disc have limitations.<br><br></li>
<li>
As testing progresses, write down the test scenarios and results. Include the client hardware and software configuration, the batch files or scripts used, and the results.</li>
</ul>
<h3>Software Testing for Compatibility</h3>
<p>
<img src="ent308ef_14.gif" border=0></p>
<p>
Make sure that any software used on the target clients is compatible with the new operating system.</p>
<p>
<b>Areas to test</b></p>
<p>
Consider the following areas in testing for software compatibility:
<ul>
<li>
Select software versions for testing. Make sure you use the versions that are or will be installed on the client computers.<br><br></li>
<li>
After upgrading the operating system, you should test each local and network application. Make sure there are no conflicts with other software. Make sure that the SMS client components work correctly.<br><br></li>
<li>
Identify possible shared .dll or Registry problems. Test the installation order. For example, if you install the Microsoft Exchange client before installing Office 97, they will not share the same spelling dictionary.</li>
</ul>
<p>
<b>Incompatible software</b></p>
<p>
There are different categories of software that are incompatible with Windows 95 and Windows NT. Each category has a different solution.</p>
<p>
<b>TSRs Incompatible with Windows 95 Setup</b></p>
<p>
There are a few TSRs that cause Windows 95 Setup to fail. These TSRs may run fine once Windows 95 is installed, but should be stopped or removed before the Windows 95 upgrade is run. </p>
<p>
<b>TSRs Incompatible with Windows 95</b></p>
<p>
There are certain TSRs that are incompatible with Windows 95. Windows 95 Setup will remove these TSRs from Autoexec.bat. </p>
<p>
<b>Applications Incompatible with Windows 95</b></p>
<p>
There are several applications that are not compatible with Windows 95. You may want to determine whether any clients have these applications installed before running the Windows 95 upgrade. You can:
<ul>
<li>
Check with the manufacturers of any incompatible applications that you have and see if they have an upgrade.<br><br></li>
<li>
Warn users about which applications are not compatible.<br><br></li>
<li>
Exclude computers with incompatible applications from the upgrade.</li>
</ul>
<p>
See the Programs.txt file included with Windows 95 for specific information regarding application and TSR incompatibilities. </p>
<p>
<b>Upgrading Windows for Workgroups to Windows NT Workstation</b></p>
<p>
If 32-bit file access and/or disk access is enabled on Windows for Workgroups, the Windows NT setup may hang. To disable 32-bit file access (VFAT), edit the System.ini file and remark the following lines from the [386Enh] section: </p>
<pre><FONT FACE="Courier New" SIZE="2">device=vfat.386
device=vcache.386
</font></pre>
<p>
To disable 32-bit disk access, edit the System.ini file and remark the following lines from the [386Enh] section:</p>
<pre><FONT FACE="Courier New" SIZE="2">device=*BLOCKDEV
device=*PAGEFILE
device=*int13
device=*wdctrl
</font></pre>
<h3>Create and Test Unattended Scripts</h3>
<p>
<img src="ent308ef_15.gif" border=0></p>
<p>
Use the specification document created in Phase 1 to identify the types of installation scripts you need to create and test. The deployment guides and the resource kits provide samples and instructions to define automated and custom setup options. Often, it is possible to find an .inf file for a particular function on the Web.</p>
<p>
Do you need to configure the application after it is installed? Is there a way to automate that process?</p>
<p>
Develop the desktop look and feel. Do you want to add or remove any applications or desktop icons installed by default? Do you want to add your company logo to the wallpaper?</p>
<p>
If creating a fully automated installation script, it is possible to modify the SMS Help Desk options to enable remote control by default. See Knowledge Base article: “Enabling Help Desk Options for MS-DOS Clients” ID: Q122399.</p>
<h2>Phase 4: The Pilot Roll-out</h2>
<p>
<img src="ent308ef_16.gif" border=0></p>
<p>
No matter how well the lab testing phase completes, do not skip the pilot test. This is the first time you come into contact with users and they will introduce a complete new set of variables into the process that never came up during testing in an isolated lab.</p>
<h3>Pilot Testing</h3>
<p>
<img src="ent308ef_17.gif" border=0></p>
<p>
A pilot test is a check against the lab testing. You are in a real production environment, but limit the upgrade to a small set of computers. There are different philosophies about how to choose the pilot group.
<ul>
<li>
Choose a group of technical users that can be flexible if there are problems. These users may not cause errors that a nontechnical user would, but can help with network challenges, such as servers not responding, or installation scripts not running correctly.<br><br></li>
<li>
Choose a diverse group of hardware. You may not have been able to have every client configuration represented in the lab. For the pilot choose a set of clients that covers the additional configurations.<br><br></li>
<li>
Choose a diverse group of users. Find out what works or does not work for users with different skill levels.</li>
</ul>
<p>
Make sure that all computers in the pilot test have recently reported inventory.</p>
<h3>Set Expectations </h3>
<p>
<img src="ent308ef_18.gif" border=0></p>
<p>
Communication is a vital factor in the success rate of a production deployment. Users who are uninformed may press F3 during a Windows 95 unattended installation, because they did not expect it to happen.</p>
<p>
<b>Management</b></p>
<p>
Management personnel should understand that there will be some client computers that cannot be installed automatically and will need to be manually installed. The more and better testing that is done prior to deployment, the lower the failure rate will be. </p>
<p>
Some ways to manage failures are:
<ul>
<li>
Remove as many questionable clients from the machine groups as possible.<br><br></li>
<li>
Run a deployment job to 25 clients at a time, rather than all 1,000 or so.<br><br></li>
<li>
Plan for a technician to be on site when the upgrade occurs. The technician can help with the problem cases.</li>
</ul>
<p>
<b>Users</b></p>
<p>
Users need to be informed in the following areas:
<ul>
<li>
If they are not used to SMS and logon scripts, they should be introduced to a nonoperational logon script first. It could simply display a message explaining the purpose of logon scripts.<br><br></li>
<li>
They need to understand what Package Command Manager is, how to use it, and how to use any other SMS client utilities that they may need.<br><br></li>
<li>
They need to receive training on the new operating system version. </li>
</ul>
<h2>Windows 95 Deployment</h2>
<p>
<img src="ent308ef_19.gif" border=0></p>
<h3>Customize Windows 95 Setup Files</h3>
<p>
<img src="ent308ef_20.gif" border=0></p>
<p>
The Windows 95 Setup program uses a setup .inf file. This file provides answers or defines which dialog boxes will appear to the user.</p>
<p>
<b>Answer files for Windows 95 Setup</b></p>
<p>
If no .inf is specified, the Msbatch.inf file is used. SMS includes Win95.inf in the \Site.srv\Maincfg.box\Mstest directory. The Win95.pdf ,which ships with SMS 1.2, references Win95.inf. </p>
<p>
The Win95.inf file included with SMS has been designed specifically for batch installations using SMS. You can use this file unmodified for a standard, hands-free upgrade to Windows 95. If you want to take advantage of this prebuilt file, but still want to make some changes, the file can be edited manually. The file is well commented and includes most of the common installation options, such as specifying the Product ID, and hands-free installation settings. </p>
<p>
<b>Utilities to build a customized .inf File</b></p>
<p>
There are several programs that enable you to create or modify a custom Msbatch.inf format file. Available utilities include:</p>
<table>
<tr valign=top>
<td>
<b>Utility</b></td>
<td>
<b>Function</b></td>
<td>
<b>Location</b></td>
</tr>
<tr valign=top>
<td>
Batch.exe</td>
<td>
·&nbsp;&nbsp;Change default Windows installation directory.<p>
·&nbsp;&nbsp;Set network options.</p>
<p>
·&nbsp;&nbsp;Set automatic reboot.</p>
<p>
·&nbsp;&nbsp;Set uninstall information.</p>
<p>
·&nbsp;&nbsp;Specify a printer.</p>
<p>
·&nbsp;&nbsp;Choose specific software components.</p>
</td>
<td>
Windows 95 compact disc under Admin\Nettools\<BR>Netsetup</td>
</tr>
<tr valign=top>
<td>
Infinst.exe</td>
<td>
Take .inf files built for individual components, such as the Policy Editor or additional hardware components, and add them to an existing Msbatch.inf file.</td>
<td>
Windows 95 compact disc under the Admin\Nettools\<BR>Netsetup</td>
</tr>
<tr valign=top>
<td>
Infgen.exe</td>
<td>
Remove the Inbox from the desktop, removing MSN™ The Microsoft Network Online services from the desktop, or disabling online registration</td>
<td>
INF Generator available on the Internet. </td>
</tr>
</table><br>
<p>
Parameters that you may want to change are documented in the <i>Windows 95 Resource Kit</i>, Appendix D, “Msbatch.inf Parameters.” </p>
<p>
<b>Notes regarding Batch.exe</b>
<ul>
<li>
If you leave the User Name, Computer Name, and Workgroup blank, Systems Management Server is able to determine appropriate values from various .ini files on the client computer.<br><br></li>
<li>
Some of these settings may cause a prompt during installation at the client computer, which would counteract a hands-free installation. During your test of the setup files, make note of any user interaction required.<br><br></li>
<li>
If you are making changes to Win95.inf using Batch, it may insert new settings in the middle of existing comment statements. Windows 95 Setup will run correctly, but Win95.inf may be harder to read.<br><br></li>
<li>
Finally, there are some settings that cannot be made using Batch. Specifically, the product ID must be set by hand. This number is required for technical support calls, so you do not want to leave it blank. If you have purchased a Windows 95 license package, use the product ID on the CD-ROM for all your users. </li>
</ul>
<p>
<b>Notes regarding INF Installer </b></p>
<p>
INF Installer (Infinst.exe) requires two directory paths:
<ul>
<li>
The Windows 95 source files in expanded form, which should include an Msbatch.inf file.<br><br></li>
<li>
The directory with the new .inf file to add. </li>
</ul>
<p>
<b>Notes regarding INF Generator</b></p>
<p>
INF Generator (Infgen.exe) includes the .INF Installer functionality and adds the ability to set other options, such as removing the Inbox from the desktop, removing MSN The Microsoft Network from the desktop, or disabling online registration. It is also designed to build multiple .inf files when there are user-specific items such as Transmission Control Protocol/Internet Protocol (TCP/IP) configuration settings to be specified. INF Generator requires more setup than INF Installer, as well as some additional input files. If you need the additional functionality, use INF Generator; otherwise, use INF Installer. For more information, see the Infgndoc.doc file included with INF Generator. </p>
<dl>
<dt>
Both INF Installer and INF Generator require an administrative installation of Windows 95. Netsetup is a utility that allows the administrator to build an administrative share with the decompressed Windows 95 files. </dt>
<dd>
<b>Hint</b>&nbsp;&nbsp;&nbsp;It is also possible to use one of the .INF utilities (Batch, Netsetup, Infinst, and Infgen) to produce the necessary settings in a temporary Msbatch.inf file and then paste them into the Win95.inf file using a text editor. </dd>
</dl>
<h3>Prepare the Distribution Source</h3>
<p>
<img src="ent308ef_21.gif" border=0></p>
<p>
There are two ways to set up the package source: with compressed files or with decompressed files.</p>
<p>
<b>Using decompressed Windows 95 files</b></p>
<p>
With the Netsetup program (see the <i>Microsoft Windows 95 Resource Kit</i> for details) you can install a source directory for Windows 95 by decompressing the .cab files and setting the appropriate permissions. This directory can then be used to build a custom Msbatch.inf file. Once this file exists, you can run either of the INF utilities. If you are editing .inf files other than the main .inf file, you will need to distribute the decompressed set of Windows 95 files.</p>
<p>
<b>Using compressed Windows 95 files</b></p>
<p>
If possible, you will want to distribute the compressed Windows 95 files because they take about 30 MB of disk space versus 90 MB for the decompressed set.</p>
<p>
To use the compressed files:
<ol>
<li>
Build an Msbatch.inf file with required components added.<br><br></li>
<li>
Paste the changes made to the Msbatch.inf file into Win95.inf.<br><br></li>
<li>
Copy the Win95 directory from the Windows 95 compact disc to a source directory.</li>
</ol>
<p>
<b>Put Win95.INF into the source directory</b></p>
<p>
For either a compressed or decompressed source, copy the Win95.inf (or specified Setup.inf file) to the Windows 95 source directory.</p>
<h3>Run Scandisk</h3>
<p>
<img src="ent308ef_22.gif" border=0></p>
<p>
Although Scandisk is normally run by Windows 95 Setup, it is recommended that you run it separately when using SMS to complete the installation. This is because Scandisk can produce message boxes that require user interaction. Scandisk is particularly recommended if the computers to be upgraded are using the DoubleSpace&reg; disc compression utility or Stacker.</p>
<p>
<b>To run Scandisk</b>
<ol>
<li>
Create a Scandisk package. In the <b>Packages</b> window, on the <b>File</b> menu, click <b>New</b>. The <b>Package Properties</b> dialog box appears.<br><br></li>
<li>
Click <b>Import</b>, and then click Scandisk.pdf. This file is not included on the SMS compact disc, but is available with the Windows 95 Deployment Guide.<br><br></li>
<li>
In the <b>Source Directory</b> text box, type the full Universal Naming Convention (UNC) name of the source directory (in this case the directory with the Scandisk.exe file).<br><br></li>
<li>
Set the command line as follows:<pre><FONT FACE="Courier New" SIZE="2">SCANDISK /all /autofix /nosummary /surface
</font></pre>
<p>
Where:</p>
<pre><FONT FACE="Courier New" SIZE="2">/all - all drives
/autofix - fixes errors
/nosummary - does not stop if errors are encountered
/surface - perform surface scan
</font></pre>
</li>
<li>
Create a Scandisk job by dragging the package over the target machine group.<br><br></li>
<li>
Monitor the job status. Select the Scandisk job in the <b>Jobs</b> window and access the <b>Job Properties</b> dialog box. Click <b>Status</b>, and view the Sending and Working columns in the <b>Job Status</b> dialog box.<p>
After the job has had a chance to propagate, you can check on details of the job. In a test situation this could take as little as 30 minutes. In your production network you will need to allow more time.</p>
<p>
When the <b>Overall Job Status</b> changes to Complete, the job has been distributed and run on all target computers. The total duration of the job depends on a number of factors, including parameters set for the job and the behavior of your users (who must run Package Command Manager to receive the package).</p>
</li>
<li>
When the command has completed it leaves a C:\Scandisk.log file that can be collected later by the Inventory Agent. View the Scandisk.log file using SMS Administrator once inventory has been collected, or manually view the files on each client.</li>
</ol>
<h3>Run Windows 95 Upgrade</h3>
<p>
<img src="ent308ef_23.gif" border=0></p>
<p>
The Win95.pdf is located in the \Primsite.srv\Import.src\<i>language code</i> directory of the site server. The Win95.pdf includes several built-in command lines that provide both manual and automated upgrades of computers running MS-DOS, Windows 3.1, Windows 95, and Windows for Workgroups. These command lines make use of helper programs (Dos2w95.exe, Win2w95.exe, and W95tow95.exe) to fill in values for client-specific items, such as user name or computer name.</p>
<dl>
<dt>
For MS-DOS and Windows 3.<i>x</i> clients, the helper programs also set the Sms.ini upgrade flag and reset the Client.bat file. The SMS upgrade flag is used to indicate that the SMS client components should be upgraded for the new operating system. When the client components are upgraded, the Client.bat file is set correctly for a Windows 95 client.</dt>
<dd>
<b>Important</b>&nbsp;&nbsp;&nbsp;All applications should be closed on the client computer before beginning the upgrade process. If an application is running, Windows 95 Setup will close it and prompt the user to save data.</dd>
</dl>
<p>
<b>Command line switches</b></p>
<p>
The command lines include the following parameters:
<ul>
<li>
Setup.exe&#45;The Windows 95 Setup program.<br><br></li>
<li>
Win95.inf&#45;The customized .inf file for Systems Management Server installations. You can replace this with your own .inf file.<br><br></li>
<li>
/IS&#45;Do not start Scandisk.<br><br></li>
<li>
/IW&#45;Suppress warning dialog boxes.</li>
</ul>
<p>
<b>How the helper programs work</b></p>
<p>
The helper programs are included with Systems Management Server and are located in the \Sms\Logon.srv\mstest directory. The helper programs follow this process:
<ol>
<li>
The helper program checks the .inf file for certain values. If the value is left blank, the helper program attempts to find the default value in client files, such as System.ini, the Windows 95 registry, or Sms.ini. <br><br></li>
<li>
On Windows or MS-DOS clients, the helper program sets the SMS client upgrade flag.<br><br></li>
<li>
The helper program starts Windows 95 Setup using the modified .inf file. <br><br></li>
<li>
The helper program terminates once Windows 95 Setup is successfully started.</li>
</ol>
<p>
The helper programs will attempt to determine default values for the following fields:
<ul>
<li>
Computer name<br><br></li>
<li>
Computer description<br><br></li>
<li>
Workgroup<br><br></li>
<li>
Logon domain<br><br></li>
<li>
Registered user name<br><br></li>
<li>
Registered organization</li>
</ul>
<p>
If the helper program cannot determine a default value for a required client specific value, the user will be prompted for a value during Windows 95 Setup.</p>
<h3>Evaluate Distribution Results</h3>
<p>
<img src="ent308ef_24.gif" border=0></p>
<p>
When a Systems Management Server upgrade job completes it indicates that the command has been run at the client computer. It does not indicate whether or not Windows 95 is running successfully on the client computer.</p>
<p>
<b>Windows 95 query</b></p>
<p>
Use the Computers By Operating System prompted query to look for client computers that report Windows 95 as their operating system. Make sure that each client inventory has been reported and processed before you run the query. Ideally, the query results will return every computer that received the job. These will be included in the machine group you specified in the Target Computer section of the Run Command On Workstation job.</p>
<p>
<b>Unsuccessful upgrades </b></p>
<p>
There are a few reasons for an unsuccessful upgrade:
<ul>
<li>
Hard disk space was reduced between the time of the last reported inventory and the time the job actually ran.<br><br></li>
<li>
The user may have installed or started an incompatible application. <br><br></li>
<li>
TSRs incompatible with Windows 95 Setup were running.<br><br></li>
<li>
The user pressed F3 (Cancel) during setup.</li>
</ul>
<p>
<b>Windows 95 installed, but fails to run</b></p>
<p>
If the user cannot run Windows 95 on the client computer after an installation, the most likely problem is a hardware incompatibility. Windows 95 Setup is able to complete because it is a simplified version of the operating system; however, the final version may have conflicts with certain hardware configurations. Consult the Windows 95 Hardware Compatibility List for more information.</p>
<h2>Windows NT 4.0 Deployment</h2>
<p>
<img src="ent308ef_25.gif" border=0></p>
<h3>Methods for Automating Installation</h3>
<p>
<img src="ent308ef_26.gif" border=0></p>
<p>
Windows NT Workstation installations can be customized, as well as fully automated. The Package Command Manager service, which runs on Windows NT–based computers, can complete an installation entirely in the background.</p>
<p>
<b>The Windows NT Workstation resource kit</b></p>
<p>
The <i>Microsoft Windows NT 4.0 Workstation Resource Kit</i> contains most of the information needed to successfully configure, customize and automate a Windows NT 4.0 deployment. 
<ul>
<li>
Chapter 1 focuses on deployment strategy and should be studied carefully. <br><br></li>
<li>
Chapter 2 encompasses automation and customization techniques. <br><br></li>
<li>
Chapter 3 describes a roll-out using Systems Management Server.</li>
</ul>
<p>
<b>Using Package Command Manager</b></p>
<p>
By default the Package Command Manager utility (Pcmwin32.exe) is installed on computers running Windows NT Workstation. Any packages that are executed using this utility run in the security context of the user logged in at the time of package execution. To complete a Windows NT upgrade: 
<ul>
<li>
The user needs local Administrator rights.<br><br></li>
<li>
The user can supply information during installation.</li>
</ul>
<p>
<b>Using Package Command Manager service</b></p>
<p>
SMS 1.2 Service Pack 2 supports installing Package Command Manager as a service on Windows NT Workstations. Installation procedures and documentation for the Package Command Manager service is provided with the service pack and is also available on http://www.microsoft.com/smsmgmt. To complete a Windows NT upgrade using this service:
<ul>
<li>
Setup must be a fully automated, background task.<br><br></li>
<li>
SMS service account must be an Administrator in the local account database.</li>
</ul>
<p>
<b>Notes</b>
<ul>
<li>
The white paper, “Automated Client Upgrade Process,” is at http://www.microsoft.com/smsmgmt and gives specific information on a 100% unattended installation.<br><br></li>
<li>
Updates of Pcmsvc32.exe are not propagated and installed automatically. This utility must be upgraded manually using the Rservice utility. Do not use Rservice to remove and reinstall. Instead, use the following command to upgrade: &#09;<br><br></li>
<li>
rservice /stop /install /start<br><br></li>
<li>
Check the Microsoft Knowledge Base on TechNet or at http://www.microsoft.com for the latest articles. An example of a good query string to use would be “sms 4.0 upgrade”.</li>
</ul>
<h3>Setup Files</h3>
<p>
<img src="ent308ef_27.gif" border=0></p>
<p>
Sending a Windows NT Workstation version 4.0 upgrade job using SMS requires:</p>
<p>
<b>Windows NT Workstation Package Definition File</b></p>
<p>
This Nt40.pdf file is located on the Windows NT Workstation 4.0 compact disc in the platform directory of your choice or at: http://www.microsoft.com/smsmgmt/pdfs.htm</p>
<p>
<b>Unattend script</b></p>
<p>
Ntupgrd.scr is supplied in the \Sms\Site.srv\Maincfg.box\Mstest directory of an SMS 1.2 installation. This file must be renamed to Ntupgrd.400.</p>
<p>
<b>Windows NT Setup wrapper files</b></p>
<p>
SMS 1.1 requires an updated wrapper file, included with SMS 1.2. The wrapper files are operating system and platform-specific and are located in the \Sms\Site.srv\Maincfg.box\Mstest directory. If you do not have access to an SMS 1.2 compact disc, contact Microsoft Technical Support to get a copy of the files.</p>
<p>
Wrapper files are as follows:
<ul>
<li>
Ntencap.exe&#45;Windows NT to Windows NT on x86-compatible computers.<br><br></li>
<li>
Ntencapa.exe&#45;Windows NT to Windows NT on Digital Alpha computers.<br><br></li>
<li>
Ntencapm.exe&#45;Windows NT to Windows NT on MIPS computers.<br><br></li>
<li>
Dosntupg.exe&#45;MS-DOS to Windows NT upgrade.<br><br></li>
<li>
Win16ntupg.exe&#45;Windows 3.1<i>x </i>to Windows NT upgrade.</li>
</ul>
<p>
<b>Retail version of Windows NT Workstation 4.0</b></p>
<p>
A fully licensed, retail version of Windows NT Workstation 4.0 must be used. A limited license, developer edition or OEM version will not work.</p>
<h3>Prepare the Source Directory</h3>
<p>
<img src="ent308ef_28.gif" border=0></p>
<p>
It is possible to use the Windows NT Workstation compact disc as the source for the package, but this is not recommended. The compact disc contains all platform versions of Windows NT as well as the debug symbols for each platform. Keep in mind that SMS requires hard disk space of at least 4 times the amount of the source files to distribute the package.</p>
<p>
To prepare the source directory:
<ul>
<li>
Create the source directory on the site server or any other Windows NT Workstation or Windows NT Server on the network. <br><br></li>
<li>
Share the directory.<br><br></li>
<li>
Copy Ntupgrad.scr to the source directory and rename it to Ntupgrd.400.<br><br></li>
<li>
Copy Nt40.pdf to the \Sms\Primsite.srv\Import.src\Enu directory on the site server.<br><br></li>
<li>
Insert the Windows NT Workstation 4.0 compact disc in an accessible CD ROM drive.<br><br></li>
<li>
From the root of the compact disc, copy the following files to the source directory: Autorun.inf and Cdrom_w.40 <br><br></li>
<li>
Copy the entire platform directory of your choice to the source directory. </li>
</ul>
<h3>Complete the Installation </h3>
<p>
<img src="ent308ef_29.gif" border=0></p>
<p>
When a Systems Management Server upgrade job completes it indicates that the command has been run at the client computer. It does not indicate whether or not Windows NT is running successfully on the client computer.</p>
<p>
<b>Windows NT query</b></p>
<p>
Use the Computers By Operating System prompted query to look for client computers that report Windows NT as their operating system. Make sure that each client inventory has been reported and processed before you run the query. Ideally, the query results will return every computer that received the job. These will be included in the machine group you specified in the Target Computer section of the Run Command On Workstation job.</p>
<p>
<b>Test the installation</b></p>
<p>
Test the client install to ensure that the upgrade has been completed successfully. Make sure the computer can:
<ul>
<li>
Connect to and browse the network.<br><br></li>
<li>
Set up printers and print to network printers.<br><br></li>
<li>
Open, run, and close local and network applications, especially all mission-critical applications.<br><br></li>
<li>
Shut down completely.</li>
</ul>
<p>
&copy; 1997 Microsoft Corporation. All rights reserved. </p>
<p>
The information contained in this document represents the current view of Microsoft Corporation on the issues discussed as of the date of publication. Because Microsoft must respond to changing market conditions, it should not be interpreted to be a commitment on the part of Microsoft, and Microsoft cannot guarantee the accuracy of any information presented after the date of publication.</p>
<p>
This document is for informational purposes only. MICROSOFT MAKES NO WARRANTIES, EXPRESS OR IMPLIED, IN THIS SUMMARY.</p>
<p>
Microsoft, DoubleSpace, MS-DOS, Windows, and Windows NT are registered trademarks and BackOffice and MSN The Microsoft Network are trademarks of Microsoft Corporation. </p>
<p>
Other product or company names mentioned herein may by the trademarks of their respective owners.</p>
</font></BODY>
</HTML>
