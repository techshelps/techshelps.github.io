<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Publishing Microsoft Project and Team Manager on the Internet </title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>



	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>



	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h1>Publishing Microsoft Project and Team Manager on the Internet </h1>
<p>
Presented by:&#09;Sam Brooks</p>
<p>
Sam Brooks is a Microsoft Regional Director. His company is a Solution Provider Partner offering training, development, and active web application services.</p>
<p>
Phone: (770) 953-8637</p>
<p>
Fax: (770) 916-1346</p>
<p>
Email: admin@sambrooks.com</p>
<h2>Introduction</h2>
<p>
This session provides the process and methods to publish Microsoft&reg; Project and Team Manager data on the Internet. The examples are built around IE 3.01 as the client browser. Six individual examples show how to publish and update information using different technologies:</p>
<p>
Demo1 illustrates how to use the Internet Data Connector (IDC) to browse Team Manager data.</p>
<p>
Demo2 illustrates the process of updating the Team Manager database using the HTML layout control.</p>
<p>
Demo3 illustrates the process of updating Microsoft Project database using active server pages.</p>
<p>
Demo4 illustrates setting up a browser for Microsoft Project data using the advanced data connector (ADC).</p>
<p>
Demo5 illustrates the process of updating Microsoft Project data using the ADC.</p>
<p>
Demo6 illustrates how to set up Microsoft Project as an OLE server on the web.</p>
<h2>Demo1</h2>
<p>
The first page has a button which calls step1.idc. This idc file pulls task data from the Team Manager database and populates a drop down list in the template file, step1.htx. The value behind the list box is the task ID, but the value shown is the task name. The &lt;select&gt; tag starts the drop down. Next the &lt;%begindetail%&gt; tag starts the loop for data filling. The &lt;option&gt; tag is for each item in the drop down. There is only one in the htx file because as each option is filled from the database. It cycles through each record and adds a new &lt;option&gt; tag. The taskID is inside the option tag and the taskname is outside so the user will see it. The &lt;%enddetail%&gt; tag and the &lt;/select&gt; tags end the drop down list.</p>
<p>
The second idc file takes the value from the previous drop down list (the taskID) and returns start, finish, and fixed cost information about the task. There is only one record returned and it goes into a table.</p>
<h3>Source Code</h3>
<p>
<b>Default.htm</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Browse Team Manager Data with IDC&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;center&gt;&lt;font color=&quot;navy&quot; size=&quot;6&quot;&gt;Use this form to browse Team Manager Data with the Internet Database Connector.&lt;/font&gt;&lt;/center&gt;
&lt;font size=&quot;4&quot; color=&quot;navy&quot;&gt;Step 1: Click the &quot;View Tasks&quot; button to see all of the tasks
&lt;form method=&quot;post&quot; action=&quot;step1.idc&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;View Tasks&quot;&gt;
&lt;/form&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Step1.htx</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Browse Team Manager Data with IDC&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;center&gt;&lt;font color=&quot;navy&quot; size=&quot;6&quot;&gt;Use this form to browse Team Manager Data with the Internet Database Connector.&lt;/font&gt;&lt;/center&gt;
&lt;font size=&quot;4&quot; color=&quot;navy&quot;&gt;Step 1: Click the &quot;View Tasks&quot; button to see all of the tasks
&lt;form method=&quot;post&quot; action=&quot;step1.idc?&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;View Tasks&quot;&gt;
&lt;/form&gt;
&lt;hr&gt;
Step 2: Select a Task and click the &quot;View Task Details&quot; button to see more data
&lt;form method=&quot;post&quot; action=&quot;step2.idc?&quot;&gt;
&lt;select name=&quot;tasks&quot; size=&quot;1&quot;&gt;
&lt;%begindetail%&gt;
&lt;option value=&quot;&lt;%TaskID%&gt;&quot;&gt;&lt;%Name%&gt;
&lt;%enddetail%&gt;
&lt;/select&gt;
&lt;input type=&quot;submit&quot; value=&quot;View Task Details&quot;&gt;
&lt;/form&gt;
&lt;/font&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Step1.idc</b></p>
<pre><FONT FACE="Courier New" SIZE="2">DataSource: Team Manager Database
Template: step1.htx
SQLStatement:
+SELECT TaskID, Name FROM Task
+ WHERE TaskID &lt;&gt; 0
</font></pre>
<p>
<b>Step2.htx</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Browse Team Manager Data with IDC&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;center&gt;&lt;font color=&quot;navy&quot; size=&quot;6&quot;&gt;Use this form to browse Team Manager Data with the Internet Database Connector.&lt;/font&gt;&lt;/center&gt;
&lt;p&gt;&lt;font size=&quot;4&quot; color=&quot;navy&quot;&gt;Click the &quot;View Tasks&quot; button to see all of the tasks&lt;/font&gt;
&lt;form method=&quot;post&quot; action=&quot;step1.idc?&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;View Tasks&quot;&gt;
&lt;/form&gt;
&lt;hr&gt;
&lt;font size=&quot;4&quot; color=&quot;navy&quot;&gt;TaskID: &lt;%TaskID%&gt; Name: &lt;%Name%&gt;
&lt;/font&gt;
&lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;
&lt;tr&gt;&lt;td&gt;&lt;font color=&quot;navy&quot; size=&quot;4&quot;&gt;Start&lt;/td&gt;&lt;td&gt;&lt;font color=&quot;navy&quot; size=&quot;4&quot;&gt;Finish&lt;/td&gt;&lt;td&gt;&lt;font color=&quot;navy&quot; size=&quot;4&quot;&gt;Cost&lt;/td&gt;&lt;/font&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;font color=&quot;navy&quot; size=&quot;4&quot;&gt;&lt;%UserStartDate%&gt;&lt;/td&gt;&lt;td&gt;&lt;font color=&quot;navy&quot; size=&quot;4&quot;&gt;&lt;%UserEndDate%&gt;&lt;/td&gt;&lt;td&gt;&lt;font color=&quot;navy&quot; size=&quot;4&quot;&gt;&lt;%FixedCost%&gt;&lt;/td&gt;&lt;/font&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/font&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Step2.idc</b></p>
<pre><FONT FACE="Courier New" SIZE="2">DataSource: Team Manager Database
Template: step2.htx
SQLStatement:
+SELECT TaskID, Name, UserStartDate, UserEndDate, FixedCost FROM Task
</font></pre>
<p>
+ WHERE TaskID=%tasks%</p>
<h2>Demo2</h2>
<p>
This demo uses the HTML layout control. Usually, the HTML layout control's alxpath property points to an alx file, an ActiveX Layout control file. In this example, the alxpath property points to an idc. This idc, in turn points to the usual htx template to fill in the data. However, the htx file is actually an alx file that has been renamed. Use the ActiveX Control Pad to view the idcdemo1.htx file. It is a normal alx file. Click on the Script wizard button. Then click on the Layout2 object on the left and then on its OnLoad event. Click Code View at the bottom to view the code. Here is the &lt;%begindetail%&gt; tag. Data returned from the database is added to the list box. Count is row. The second value represents the number of columns. Five columns are added, but only one is visible to the user. In the Click event of the list box, the text boxes are filled with data from the list box and made visible.</p>
<p>
Task name can be changed. All fields cannot be updated in this example. The 'Update this Task' button, calls another idc file. Preview the code in the same way as before. VBScript has a replace function which looks for a string within a string and replaces it with an additional string. This function is used to replace spaces with '+' signs. The idc, like a cgi, recognizes the plus sign as a space. You would see this in the URL of a search in any search engine. At this point there is a string to pass to the idc file. This idc updates the task whose ID matches the ID in the text box. It calls is the default.htm file which contains the layout control. In conclusion, the taskupdate.idc file updates the database and then opens the default.htm file. The default.htm file has the HTML layout which alxpath property is set to an idc file in order that the tasks are again selected for display. After the taskupdate.idc file updates the database, it refreshes the open htm file.</p>
<h3>Source Code</h3>
<p>
<b>Default.htm</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Task Information&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;center&gt;&lt;font size=&quot;6&quot; color=&quot;navy&quot;&gt;Update the Team Manager Database&lt;/font&gt;&lt;/center&gt;
&lt;OBJECT CLASSID=&quot;CLSID:812AE312-8B8E-11CF-93C8-00AA00C08FDF&quot;
ID=&quot;Layout1_alx&quot; STYLE=&quot;LEFT:0;TOP:0&quot; Width=&quot;0&quot; Height=&quot;0&quot;&gt;
&lt;PARAM NAME=&quot;ALXPATH&quot; REF VALUE=&quot;idcdemo1.idc?&quot;&gt;
&lt;/OBJECT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Idcdemo1.htx</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--
Sub Layout2_OnLoad()
dim TaskArray(3,26)
Count=0
&lt;%begindetail%&gt;
ListBox1.Additem()
ListBox1.List(Count,0)=&quot;&lt;%TaskID%&gt;&quot;
ListBox1.List(Count,1)=&quot;&lt;%Name%&gt;&quot;
ListBox1.List(Count,2)=&quot;&lt;%UserStartDate%&gt;&quot;
ListBox1.List(Count,3)=&quot;&lt;%UserEndDate%&gt;&quot;
ListBox1.List(Count,4)=&quot;&lt;%FixedCost%&gt;&quot;
Count=Count+1
&lt;%enddetail%&gt;
end sub
--&gt;
&lt;/SCRIPT&gt;
&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--
dim Count
Sub ListBox1_Click()
btnUpdate.visible = true
Label2.visible = true
Label4.visible = true
Label5.visible = true
Label6.visible = true
Label7.visible = true
Label8.visible = true
txtTaskID.Text= ListBox1.List(Listbox1.ListIndex,0)
txtTaskID.visible = true
txtName.Text= ListBox1.List(ListBox1.ListIndex,1)
txtName.visible = true
txtCost.Text = FormatCurrency(ListBox1.List(Listbox1.ListIndex,4),2)
txtCost.visible = true
txtEndDate.Text = ListBox1.List(Listbox1.ListIndex,3)
txtEndDate.visible = true
txtStartDate.Text = ListBox1.List(Listbox1.ListIndex,2)
txtStartDate.Visible = true
end sub
--&gt;
&lt;/SCRIPT&gt;
&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--
Sub btnUpdate_Click()
NameString=txtName.Value
NewName=Replace(NameString,&quot; &quot;,&quot;+&quot;)
Window.location.href = &quot;taskupdate.idc?txtTaskID=&quot;&amp;txtTaskID&amp;&quot;&amp;txtName=&quot;&amp;NewName
end sub
--&gt;
&lt;/SCRIPT&gt;
&lt;DIV BACKGROUND=&quot;#ffffff&quot; ID=&quot;Layout2&quot; STYLE=&quot;LAYOUT:FIXED;WIDTH:473pt;HEIGHT:300pt;&quot;&gt;
    &lt;OBJECT ID=&quot;Label1&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:25pt;LEFT:25pt;WIDTH:58pt;HEIGHT:25pt;ZINDEX:0;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;8388608&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Tasks&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2046;882&quot;&gt;
        &lt;PARAM NAME=&quot;FontName&quot; VALUE=&quot;Times New Roman&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;360&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label2&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:25pt;LEFT:215pt;WIDTH:58pt;HEIGHT:25pt;DISPLAY:NONE;ZINDEX:1; &quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;8388608&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Details&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2046;882&quot;&gt;
        &lt;PARAM NAME=&quot;FontName&quot; VALUE=&quot;Times New Roman&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;360&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;txtStartDate&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:107pt;LEFT:281pt;WIDTH:83pt;HEIGHT:16pt;TABINDEX:3;DISPLAY:NO NE;ZINDEX:2;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604571&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2928;564&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;txtEndDate&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:132pt;LEFT:281pt;WIDTH:83pt;HEIGHT:16pt;TABINDEX:4;DISPLAY:NO NE;ZINDEX:3;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604571&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2928;564&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;txtCost&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:157pt;LEFT:281pt;WIDTH:83pt;HEIGHT:16pt;TABINDEX:5;DISPLAY:NO NE;ZINDEX:4;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604571&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2928;564&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label4&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:107pt;LEFT:190pt;WIDTH:83pt;HEIGHT:17pt;DISPLAY:NONE;ZINDEX:5 ;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;8388608&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Start Date&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2928;600&quot;&gt;
        &lt;PARAM NAME=&quot;FontName&quot; VALUE=&quot;Times New Roman&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;360&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label5&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:132pt;LEFT:190pt;WIDTH:74pt;HEIGHT:17pt;DISPLAY:NONE;ZINDEX:6 ;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;8388608&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;End Date&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2611;600&quot;&gt;
        &lt;PARAM NAME=&quot;FontName&quot; VALUE=&quot;Times New Roman&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;360&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label6&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:157pt;LEFT:190pt;WIDTH:58pt;HEIGHT:17pt;DISPLAY:NONE;ZINDEX:7 ;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;8388608&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Cost&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2046;600&quot;&gt;
        &lt;PARAM NAME=&quot;FontName&quot; VALUE=&quot;Times New Roman&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;360&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;btnUpdate&quot;
     CLASSID=&quot;CLSID:D7053240-CE69-11CD-A777-00DD01143C57&quot; STYLE=&quot;TOP:190pt;LEFT:281pt;WIDTH:74pt;HEIGHT:25pt;TABINDEX:9;DISPLAY:NO NE;ZINDEX:8;&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Update this Task&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2611;882&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;ParagraphAlign&quot; VALUE=&quot;3&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label7&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:83pt;LEFT:190pt;WIDTH:83pt;HEIGHT:17pt;DISPLAY:NONE;ZINDEX:9; &quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;8388608&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Name&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2928;600&quot;&gt;
        &lt;PARAM NAME=&quot;FontName&quot; VALUE=&quot;Times New Roman&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;360&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;txtName&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:83pt;LEFT:281pt;WIDTH:173pt;HEIGHT:16pt;TABINDEX:11;DISPLAY:N ONE;ZINDEX:10;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604571&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;6103;564&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label8&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:58pt;LEFT:190pt;WIDTH:83pt;HEIGHT:17pt;DISPLAY:NONE;ZINDEX:11 ;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;8388608&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;ID&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2928;600&quot;&gt;
        &lt;PARAM NAME=&quot;FontName&quot; VALUE=&quot;Times New Roman&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;360&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;txtTaskID&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:58pt;LEFT:281pt;WIDTH:33pt;HEIGHT:16pt;TABINDEX:13;DISPLAY:NO NE;ZINDEX:12;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604569&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;1164;564&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073750016&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;ListBox1&quot;
     CLASSID=&quot;CLSID:8BD21D20-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:58pt;LEFT:17pt;WIDTH:155pt;HEIGHT:113pt;TABINDEX:0;ZINDEX:13; &quot;&gt;
        &lt;PARAM NAME=&quot;ScrollBars&quot; VALUE=&quot;3&quot;&gt;
        &lt;PARAM NAME=&quot;DisplayStyle&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;5468;3986&quot;&gt;
        &lt;PARAM NAME=&quot;BoundColumn&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;ColumnCount&quot; VALUE=&quot;5&quot;&gt;
        &lt;PARAM NAME=&quot;cColumnInfo&quot; VALUE=&quot;5&quot;&gt;
        &lt;PARAM NAME=&quot;MatchEntry&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;Width&quot; VALUE=&quot;0;5469;0;0;0&quot;&gt;
    &lt;/OBJECT&gt;
&lt;/DIV&gt;
</font></pre>
<p>
<b>Idcdemo1.idc</b></p>
<pre><FONT FACE="Courier New" SIZE="2">DataSource: Team Manager Database
Template: idcdemo1.htx
SQLStatement:
+SELECT TaskID, Name, UserStartDate, UserEndDate, FixedCost FROM Task
+ WHERE TaskID &lt;&gt; 0
</font></pre>
<p>
<b>Taskupdate.idc</b></p>
<pre><FONT FACE="Courier New" SIZE="2">DataSource: Team Manager Database
Template: default.htm
SQLStatement:
+Update Task Set Name = '%txtname%'
</font></pre>
<p>
+ WHERE TaskID = %txttaskid%;</p>
<h2>Demo3</h2>
<p>
This demo uses Active Data Objects. ADO is a component that is loaded when ASP is installed. There are few forms in this page. Each one refreshes this page. Only the first one will appear every time. The others check which form was called to determine if it will appear. The update Code only runs after clicking the update button, which submits the update form.</p>
<p>
First a connection to the Multiple Microsoft Project Database is opened. This uses the ADO.Connection conn object. Next a SQL statement is created to get all tasks where ID is 0. These tasks represent the project names. The ProjectKey uniquely identifies each project in the database. A list box is filled with this data. This is almost the same way it is done with idc. This form is named &quot;ProjectSelect.&quot;  There is a hidden field (&lt;input type=&quot;hidden&quot; name=&quot;hname&quot; value=&quot;projselect&quot;&gt; which points to the form.  Again, starting with the &lt;select&gt; tag and next putting the &lt;option&gt; tag inside a loop that cycles through the data that is returned from the query. A conditional branch tests  for the calling form field &quot;ProjectKey&quot; being equal to the recordset field ProjectKey. If so, it becomes the selected project. The last tag is another &lt;input&gt; tag. This tag is an image type that acts like a submit button when clicked. It submits the form.</p>
<p>
The next form will appear only if another form has been called. It selects Microsoft Project name, start and finish data where the projectKey matches the ProjectKey in the previous list box. The start and finish times for the entire project populate the table. The remaining tasks populate a list box. Now there are two hidden text boxes. One is hname to hold the form name. The other is text box is name ProjectKey to hold the selected project.</p>
<p>
The next form will appear only if a task is selected or updated. It receives task information for the selected/updated task and enters it in a table with editable text boxes. This form's hidden text box named hname and has the value &quot;update&quot; so that the update code will run if the form is submitted.</p>
<p>
This update code receives the taskID and ProjectKey fields from the bottom form and updates all of the task information to match the values input in the text boxes. Finally, the rest of the forms are displayed to reflect updated information.</p>
<h3>Source Code</h3>
<p>
<b>Default.htm</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Update Project Database with ASP&lt;/TITLE&gt;
&lt;meta HTTP-EQUIV=&quot;Refresh&quot; Content=&quot;1; URL=demo3.asp&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Demo3.asp</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;%@ LANGUAGE = VBScript %&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Project Information from a Database&lt;/TITLE&gt;&lt;/HEAD&gt;
&lt;body bgcolor=&quot;white&quot;&gt;
&lt;center&gt;
&lt;font size=&quot;6&quot; color=&quot;navy&quot;&gt;Manipulate Project Data from the Web using Active Server Pages and Active Data Objects&lt;/font&gt;
&lt;%
'This Active Server Page accesses a database created from a
'Microsoft Project File. IIS 3.0 with Active Server Pages and
'OLE DB must be installed on the server. The code is written in VBScript.
'ActiveX Data Objects are used to view and manipulate the data.
'14
'Create the connection object using ADO
Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)
'-----Start UPDATE Code-----
'if the Update form was called, run the UPDATE SQL
if request.form(&quot;hname&quot;) = &quot;update&quot; then
'Update the name field from the name text box on the form
SQL = &quot;UPDATE Tasks SET Name = '&quot; &amp; request.form(&quot;name&quot;) &amp; &quot;'&quot;
SQL = SQL &amp; &quot;, Duration = '&quot; &amp; request.form(&quot;duration&quot;) &amp; &quot;'&quot;
SQL = SQL &amp; &quot;, Start = #&quot; &amp; request.form(&quot;start&quot;) &amp; &quot;#&quot;
SQL = SQL &amp; &quot;, Finish = #&quot; &amp; request.form(&quot;finish&quot;) &amp;&quot;#&quot;
SQL = SQL &amp; &quot; WHERE TaskID = &quot; &amp; cint(request.form(&quot;TaskID&quot;))
SQL = SQL &amp; &quot; AND ProjectKey = '&quot; &amp; request.form(&quot;ProjectKey&quot;) &amp; &quot;'&quot;
'29
'Open the connection to the project database
Conn.open &quot;Multiple Project Database&quot;, &quot;&quot;, &quot;&quot;
'Execute the SQL to update the record
set rs = Conn.Execute(SQL)
'Close the connection
Conn.close
end if
'-----End UPDATE Code-----
'Open the connection to the project database
Conn.open &quot;Multiple Project Database&quot;, &quot;&quot;, &quot;&quot;
'Create the SQL to retrieve all project information and fill the combo box
SQL = &quot;SELECT ProjectKey, Name, TaskID,Start, Finish FROM Tasks WHERE TaskID = 0&quot;
'Execute the SQL and create a recordset
set rs = Conn.Execute(SQL)
'48
%&gt;
&lt;!-- Form with combo box for task names and button to get info --&gt;
&lt;form method=&quot;post&quot; action=&quot;demo3.asp&quot; name=&quot;ProjectSelect&quot;&gt;
&lt;img src=&quot;images/choosproj.gif&quot; border=&quot;0&quot; alt=&quot;Choose a Project Below:&quot;&gt;
&lt;br&gt; 
&lt;!-- Hidden control tells us which form was called (if any) --&gt;
&lt;input type=&quot;hidden&quot; name=&quot;hname&quot; value=&quot;ProjSelect&quot;&gt;
&lt;select name=&quot;ProjectKey&quot; size=&quot;1&quot;&gt;
&lt;%
'61
'For each record, add an OPTION tag to the SELECT tag
Do While Not RS.EOF %&gt;
&lt;option value=&quot;&lt;% =rs(&quot;ProjectKey&quot;) %&gt;&quot;
&lt;%
'If we are retrieving detail information, make sure the correct
'Task is selected in the combo box (add SELECTED keyword)
if Request.form(&quot;ProjectKey&quot;) = cstr(rs(&quot;ProjectKey&quot;)) then
%&gt;
 selected
&lt;%
end if
%&gt;
&gt;
&lt;% =rs(&quot;Name&quot;) %&gt;
&lt;% rs.movenext
'78&#09;
Loop
rs.close
'Conn.close
%&gt;
&lt;/select&gt;&lt;br&gt;
&lt;input type=&quot;image&quot; src=&quot;images/projdet.gif&quot;&gt;
&lt;hr&gt;
&lt;/form&gt;
&lt;% if request.form(&quot;hname&quot;) &lt;&gt; &quot;&quot; then
'Conn.Open &quot;Multiple Project Database&quot;, &quot;&quot;, &quot;&quot;
SQL = &quot;Select Name, ProjectKey, TaskID, Start, Finish FROM Tasks WHERE ProjectKey = '&quot; &amp; request.form(&quot;ProjectKey&quot;) &amp; &quot;'&quot;
Set rs=Conn.Execute(SQL)
'93
%&gt;
&lt;form method=&quot;Post&quot; Action=&quot;demo3.asp&quot; name=&quot;TaskSelect&quot;&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;5&quot;&gt;&lt;tr&gt;&lt;td align=&quot;center&quot; rowspan=&quot;2&quot;&gt;
&lt;font size=&quot;5&quot; color=&quot;navy&quot;&gt;Details for &lt;% =rs(&quot;Name&quot;) %&gt;&lt;/font&gt;
&lt;/td&gt;
&lt;input name=&quot;hname&quot; type=&quot;hidden&quot; value=&quot;TaskSelect&quot;&gt;
&lt;td align=&quot;center&quot;&gt;
&lt;img src=&quot;images/StartDate.gif&quot; border=&quot;0&quot;&gt;
&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;img src=&quot;images/FinDate.gif&quot; border=&quot;0&quot;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
&lt;font size=&quot;5&quot; color=&quot;navy&quot;&gt;&lt;% =rs(&quot;Start&quot;) %&gt;&lt;/font&gt;
&lt;/td&gt;&lt;td&gt;
&lt;font size=&quot;5&quot; color=&quot;navy&quot;&gt;&lt;% =rs(&quot;Finish&quot;) %&gt;&lt;/font&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;5&quot;&gt;&lt;tr&gt;&lt;td align=&quot;center&quot;&gt;
&lt;font size=&quot;5&quot; color=&quot;navy&quot;&gt;Tasks for &lt;% =rs(&quot;Name&quot;) %&gt;&lt;/font&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ProjectKey&quot; Value=&quot;&lt;% =rs(&quot;ProjectKey&quot;) %&gt;&quot;&gt;
&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;select name=&quot;TaskID&quot; size=&quot;1&quot;&gt;
&lt;%
'For each record, add an OPTION tag to the SELECT tag
Do While Not RS.EOF
if rs(&quot;TaskID&quot;) = 0 then 
rs.movenext
end if
%&gt;
&lt;option value=&quot;&lt;% =rs(&quot;TaskID&quot;) %&gt;&quot;
&lt;%
'If we are retrieving detail information, make sure the correct
'Task is selected in the combo box (add SELECTED keyword)
if Request.form(&quot;TaskID&quot;) = cstr(rs(&quot;TaskID&quot;)) then
%&gt;
 selected
&lt;%
end if
%&gt;
&gt;
&lt;% =rs(&quot;Name&quot;) %&gt;
&lt;% rs.movenext
&#09;
Loop
rs.close
'Conn.close
%&gt;
&lt;/select&gt;&lt;br&gt;
&lt;input type=&quot;image&quot; src=&quot;images/taskdet.gif&quot;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;hr&gt;
&lt;/form&gt;
&lt;% if request.form(&quot;hname&quot;) = &quot;TaskSelect&quot; or request.form(&quot;hname&quot;) = &quot;update&quot; then
'Conn.open &quot;Multiple Project Database&quot;, &quot;&quot;, &quot;&quot;
SQL = &quot;SELECT * FROM Tasks WHERE TaskID=&quot; &amp; Request.Form(&quot;TaskID&quot;)
SQL = SQL &amp; &quot; and ProjectKey = '&quot; &amp; request.form(&quot;ProjectKey&quot;) &amp; &quot;'&quot;
set rs = Conn.Execute(SQL)
%&gt;
&lt;form method=&quot;post&quot; action=&quot;demo3.asp&quot;&gt;
&lt;!-- Hidden control identifies the Update form --&gt;
&lt;input name=&quot;hname&quot; type=&quot;hidden&quot; value=&quot;update&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ProjectKey&quot; value=&quot;&lt;% =rs(&quot;ProjectKey&quot;) %&gt;&quot;&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;5&quot;&gt;&lt;tr&gt;&lt;td align=&quot;center&quot;&gt;
&lt;img src=&quot;images/id.gif&quot; border=&quot;0&quot; alt=&quot;ID&quot;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;
&lt;img src=&quot;images/taskname.gif&quot; border=&quot;0&quot; alt=&quot;Task Name&quot;&gt;&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;img src=&quot;images/duration.gif&quot; border=&quot;0&quot; alt=&quot;Duration&quot;&gt;&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;img src=&quot;images/StartDate.gif&quot; border=&quot;0&quot; alt=&quot;Start Date&quot;&gt;&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;img src=&quot;images/FinDate.gif&quot; border=&quot;0&quot; alt=&quot;Finish Date&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
&lt;!-- Fill the table with values from the query in text boxes --&gt;
&lt;input type=&quot;hidden&quot; name=&quot;TaskID&quot; value=&quot;&lt;% =rs(&quot;TaskID&quot;)%&gt;&quot;&gt;
&lt;font size=&quot;5&quot; color=&quot;navy&quot;&gt;&lt;% =rs(&quot;TaskID&quot;) %&gt;&lt;/font&gt;
&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;input type=&quot;text&quot; size=&quot;30&quot; name=&quot;name&quot; value=&quot;&lt;% =rs(&quot;Name&quot;)%&gt;&quot;&gt;
&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;input type=&quot;text&quot; size=&quot;5&quot; name=&quot;duration&quot; value=&quot;&lt;% =rs(&quot;Duration&quot;)%&gt;&quot;&gt;
&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;input type=&quot;text&quot; size=&quot;20&quot; name=&quot;start&quot; value=&quot;&lt;% =rs(&quot;Start&quot;)%&gt;&quot;&gt;
&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;
&lt;input type=&quot;text&quot; size=&quot;20&quot; name=&quot;finish&quot; value=&quot;&lt;% =rs(&quot;Finish&quot;)%&gt;&quot;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;br&gt;
&lt;%
rs.close 
'conn.close
%&gt;
&lt;center&gt;
&lt;input type=&quot;image&quot; src=&quot;images/update.gif&quot;&gt;
&lt;/center&gt;
&lt;hr&gt;
&lt;%
end if
end if
%&gt;
&lt;/form&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Images (Folder)</b></p>
<table>
<tr valign=top>
<td>
Choosproj.gif</td>
<td>
Chootask.gif</td>
<td>
Duration.gif</td>
<td>
Findate.gif</td>
<td>
Id.gif</td>
</tr>
<tr valign=top>
<td>
Projdef.gif</td>
<td>
Startdate.gif</td>
<td>
Taskdet.gif</td>
<td>
Taskname.gif</td>
<td>
Update.gif</td>
</tr>
</table><br>
<h2>Demo 4 &amp; Demo 5</h2>
<h3>Demo 4</h3>
<p>
This demo uses the Advanced Data connector to browse project data. The DSN is &quot;Single Project Database&quot; It is the SoftDev.mpp file saved in its own database file, &quot;Single Project.mdb&quot; There are two ActiveX Controls on the page designated with &lt;object&gt; and &lt;/object&gt; tags. The Sheridan Grid control is used to display the data. When the page is loaded, a message box comes prompts for demos only. This control’s  ID is'Grid1.'  There are a few parameters to investigate: AllowNew, AllowUpdate, and AllowDelete are all initialized as false. Nextr is the Advanced Data Connector, where the id=SControl. The code base attribute displays whether to download it if the control does not exist on the client. The Bindings param displays Grid1. This value places the data returned by the ADC in the grid control. There is also the connect string which contains the data source name, user id, and password. The server name is retrieved dynamically from the&lt;%servervariables%&gt; tag.</p>
<p>
Preview the SUB Load event. This event sends a query to the database which returns the columns, but no rows of data. This sets up the grid with column names, but no data. Select name, duration, start and finish from Tasks where 2&gt;1. SControl.Refresh gets the data and returns it toGrid1. The Clear button clears the search text boxes. </p>
<p>
The Find button builds the SQL string based on the values in the textboxes. If the text box is not blank, it is added to the SQL statement. When the database is queried, the data is returned to the Grid control. If all text boxes are left blank, all tasks will be returned in the grid. The buttons below the grid have code to navigate the data. </p>
<h3>Source Code</h3>
<p>
<b>Default.htm</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Update Project Database with ASP&lt;/TITLE&gt;
&lt;meta HTTP-EQUIV=&quot;Refresh&quot; Content=&quot;1; URL=demo4.asp&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Demo4.asp</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Browsing Project Data with ADC&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;!--
&#09;Purpose:&#09;Browsing Team Manager data with Advanced Data Connector
&#09;Written By:&#09;Brian Castor, Samuel Brooks Corporation
&#09;Date:&#09;&#09;January, 1997
--&gt;
&lt;BODY LANGUAGE=&quot;VBScript&quot; onload=&quot;Load&quot; bgcolor=&quot;white&quot;&gt;
&lt;tr&gt;
&#09;&lt;td align=&quot;center&quot; width=&quot;40%&quot;&gt;
        &lt;table border=&quot;2&quot; cellpadding=&quot;7&quot; cellspacing=&quot;7&quot;&gt;
            &lt;tr&gt;
                &lt;td width=&quot;100%&quot;&gt;&lt;font color=&quot;#160B5A&quot;&gt;&lt;font
                size=&quot;4&quot;&gt;&lt;strong&gt;Project Data with the Advanced Data Connector&lt;/strong&gt;&lt;/font&gt;&lt;/font&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
        &lt;/td&gt;
&lt;/tr&gt;
&lt;hr&gt;
&lt;h2&gt;&lt;font color = &quot;#160B5A&quot;&gt;Search Parameters&lt;/h2&gt;
&lt;h5&gt;&lt;font color = &quot;#160B5A&quot;&gt;Please enter one or more search patterns and press FIND to search.&lt;/h5&gt;
&lt;FONT COLOR = &quot;#160B5A&quot;&gt;&lt;B&gt;
&lt;PRE&gt; Name              &lt;INPUT NAME=&quot;SName&quot; SIZE=30&gt; &lt;/PRE&gt;
&lt;PRE&gt; Duration          &lt;INPUT NAME=&quot;SDuration&quot;  SIZE=30&gt; &lt;/PRE&gt;
&lt;PRE&gt; Start             &lt;INPUT NAME=&quot;SStart&quot; SIZE=30&gt; &lt;/PRE&gt;
&lt;PRE&gt; Finish            &lt;INPUT NAME=&quot;SFinish&quot; SIZE=30&gt; &lt;/PRE&gt;
&lt;!-- 
&#09;Command button options:
&#09;-----------------------
&#09;Find&#09;&#09;Submit a search request to the database.
&#09;Clear&#09;&#09;Clear the QBE fields (labor saving function only).
--&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Find&quot; &#09;&#09;VALUE=&quot;Find&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Clear&quot; &#09;VALUE=&quot;Clear&quot;&gt;
&lt;hr&gt;
&lt;h2&gt;&lt;font color = &quot;#400040&quot;&gt;Search Results&lt;/h2&gt;
&lt;/B&gt;
&lt;br&gt;
&lt;!-- 
&#09;This Sheridan DataGrid control (SGrid) are initialized not to
&#09;allow changes to the data
--&gt;
&lt;OBJECT CLASSID=&quot;clsid:BC496AE0-9B4E-11CE-A6D5-0000C0BE9395&quot; 
&#09;ID=Grid1
&#09;CODEBASE=&quot;HTTP://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;/MSADC/Sampl es/Sheridan.cab&quot;  
&#09;HEIGHT= 125
&#09;Width = 600&gt;
&#09;&lt;PARAM NAME=&quot;AllowAddNew&quot;   VALUE=&quot;FALSE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;AllowDelete&quot;   VALUE=&quot;FALSE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;AllowUpdate&quot;   VALUE=&quot;FALSE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;DefColWidth&quot;   VALUE=&quot;4000&quot;&gt;
&#09;&lt;PARAM NAME=&quot;BackColor&quot;     VALUE=&quot;-2147483643&quot;&gt;
&#09;&lt;PARAM NAME=&quot;BackColorOdd&quot;  VALUE=&quot;-2147483643&quot;&gt;
&#09;&lt;PARAM NAME=&quot;ForeColorEven&quot; VALUE=&quot;1&quot;&gt;
&lt;/OBJECT&gt;
&lt;br&gt;
&lt;br&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;First&quot; &#09;VALUE=&quot;First&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Prev&quot; &#09;&#09;VALUE=&quot;Previous&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Next&quot;&#09;&#09;VALUE=&quot;Next&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Last&quot;&#09;&#09;VALUE=&quot;Last&quot;&gt;
&lt;hr&gt;
&lt;!-- Non-visual controls - AdvancedDataControl --&gt;
&lt;OBJECT CLASSID=&quot;clsid:9381D8F2-0288-11d0-9501-00AA00B911A5&quot;
&#09;ID=&quot;SControl&quot;
&#09;CODEBASE=&quot;HTTP://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;/MSADC/msadc 10.cab&quot;  
&#09;WIDTH=1 HEIGHT=1&gt;
&#09;&lt;PARAM NAME=&quot;BINDINGS&quot; VALUE=&quot;Grid1;&quot;&gt;
&#09;&lt;PARAM NAME=&quot;Connect&quot; VALUE=&quot;DSN=Single Project Database;UID=;PWD=;&quot;&gt;
&#09;&lt;PARAM NAME=&quot;Server&quot; VALUE=&quot;http://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;&quot;&gt;
&lt;/OBJECT&gt;
&lt;!-- VBS scripting for composing queries and retrieving search results. --&gt;
&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;
Dim myQuery
SUB Load
&#09;Grid1.CAPTION = &quot;Project Data&quot;
&#09;'Initialize data grid with column names only.
&#09;SControl.SQL = &quot;Select Name, Duration, Start, Finish from Tasks where 2 &lt; 1&quot;
&#09;SControl.Refresh
END SUB
'Implement &quot;Clear&quot; button - clears all of the QBE fields in preparation for a new &quot;Find.&quot;
SUB Clear_OnClick
&#09;SName.Value=&quot;&quot;
&#09;SDuration.Value=&quot;&quot;
&#09;SStart.Value=&quot;&quot;
&#09;SFinish.Value=&quot;&quot;
END SUB
'Implement &quot;Find&quot; button - composes a dynamic SQL query to be processed by the database and returns matching records to be bound to the SGrid object.
SUB Find_OnClick
&#09;myQuery = &quot;Select Name, Duration, Start, Finish from Tasks&quot;
&#09;'Check QBE fields and compose a dynamic SQL query.
&#09;IF (SName.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Name like '&quot; + SName.Value + &quot;%'&quot;
&#09;END IF
&#09;IF (SDuration.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Duration like '&quot; + SDuration.Value + &quot;%'&quot;
&#09;END IF
&#09;IF (SStart.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Start like '&quot; + SStart.Value + &quot;%'&quot;
&#09;END IF
&#09;IF (SFinish.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Finish like '&quot; + SFinish.Value + &quot;%'&quot;
&#09;END IF
&#09;
&#09;'Set the new query and then refresh the SControl so that the new results are displayed.
&#09;SControl.SQL = myQuery
&#09;SControl.Refresh
&#09;
END SUB
'Navigation subroutines - based on currency changes to AdvancedDataControl (SControl).
'Move to the first record in the bound recordset.
SUB First_OnClick
  &#09;SControl.MoveFirst
END SUB
'Move to the next record from the current position in the bound recordset.
SUB Next_OnClick
  &#09;SControl.MoveNext
END SUB
'Move to the previous record from the current position in the bound recordset.
SUB Prev_OnClick
  &#09;SControl.MovePrevious
END SUB
'Move to the last record in the bound recordset.
SUB Last_OnClick
  &#09;SControl.MoveLast
END SUB
&lt;/SCRIPT&gt;
&lt;BR&gt;
&lt;font color = &quot;#400040&quot;&gt;This site powered by Microsoft Advanced Data Connector. &lt;/font&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<h3>Demo 5</h3>
<p>
This demo is similar to demo 4 with a significant exceptions. The data is a SQL Server database because the &quot;for update&quot; command is used to allow updates. There are command buttons to modify the database and cancel any pending changes.  Investigate the Grid1 control properties. AllowNew, Update, and Delete are all true. </p>
<p>
Preview the new code. SUB Update_OnClick Submit changes sends update commands to the server for each cell that has been changed in the grid since the last update or select. The database is refreshed and requeried.</p>
<p>
SUB Cancel_OnlickCancels any changes in the grid.</p>
<h3>Source Code</h3>
<p>
<b>Default.htm</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Update Project Database with ASP&lt;/TITLE&gt;
&lt;meta HTTP-EQUIV=&quot;Refresh&quot; Content=&quot;1; URL=demo5.asp&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Demo5.asp</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Updating Project Data with ADC&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;!--
&#09;Purpose:&#09;Updating Project data with Advanced Data Connector
&#09;Written By:&#09;Brian Castor, Samuel Brooks Corporation
&#09;Date:&#09;&#09;January, 1997
--&gt;
&lt;BODY LANGUAGE=&quot;VBScript&quot; onload=&quot;Load&quot; bgcolor=&quot;white&quot;&gt;
&lt;tr&gt;
&#09;&lt;td align=&quot;center&quot; width=&quot;40%&quot;&gt;
        &lt;table border=&quot;2&quot; cellpadding=&quot;7&quot; cellspacing=&quot;7&quot;&gt;
            &lt;tr&gt;
                &lt;td width=&quot;100%&quot;&gt;&lt;font color=&quot;#160B5A&quot;&gt;&lt;font
                size=&quot;4&quot;&gt;&lt;strong&gt;Updating Project Data with the Advanced Data Connector&lt;/strong&gt;&lt;/font&gt;&lt;/font&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
        &lt;/td&gt;
&lt;/tr&gt;
&lt;hr&gt;
&lt;h2&gt;&lt;font color = &quot;#160B5A&quot;&gt;Search Parameters&lt;/h2&gt;
&lt;h5&gt;&lt;font color = &quot;#160B5A&quot;&gt;Please enter one or more search patterns and press FIND to search.&lt;/h5&gt;
&lt;FONT COLOR = &quot;#160B5A&quot;&gt;&lt;B&gt;
&lt;PRE&gt; Name              &lt;INPUT NAME=&quot;SName&quot; SIZE=30&gt; &lt;/PRE&gt;
&lt;PRE&gt; Duration          &lt;INPUT NAME=&quot;SDuration&quot;  SIZE=30&gt; &lt;/PRE&gt;
&lt;PRE&gt; Start             &lt;INPUT NAME=&quot;SStart&quot; SIZE=30&gt; &lt;/PRE&gt;
&lt;PRE&gt; Finish            &lt;INPUT NAME=&quot;SFinish&quot; SIZE=30&gt; &lt;/PRE&gt;
&lt;!-- 
&#09;Command button options:
&#09;-----------------------
&#09;Find&#09;&#09;Submit a search request to the database.
&#09;Clear&#09;&#09;Clear the QBE fields (labor saving function only).
&#09;Update Tasks&#09;Send updated &quot;task&quot; back to the database.
&#09;Cancel Changes&#09;Undo all changes since the last Update Tasks.
--&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Find&quot; &#09;&#09;VALUE=&quot;Find&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Clear&quot; &#09;VALUE=&quot;Clear&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Update&quot; &#09;VALUE=&quot;Update Tasks&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Cancel&quot; &#09;VALUE=&quot;Cancel Changes&quot;&gt;
&lt;hr&gt;
&lt;h2&gt;&lt;font color = &quot;#400040&quot;&gt;Search Results&lt;/h2&gt;
&lt;/B&gt;
&lt;br&gt;
&lt;!-- 
&#09;This Sheridan DataGrid control (SGrid) are initialized to
&#09;allow changes to the data - these changes will be saved
&#09;to the database when the Update Tasks button is pressed. 
--&gt;
&lt;OBJECT CLASSID=&quot;clsid:BC496AE0-9B4E-11CE-A6D5-0000C0BE9395&quot; 
&#09;ID=Grid1
&#09;CODEBASE=&quot;HTTP://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;/MSADC/Sampl es/Sheridan.cab&quot;  
&#09;HEIGHT= 125
&#09;Width = 495&gt;
&#09;&lt;PARAM NAME=&quot;AllowAddNew&quot;   VALUE=&quot;TRUE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;AllowDelete&quot;   VALUE=&quot;TRUE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;AllowUpdate&quot;   VALUE=&quot;TRUE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;BackColor&quot;     VALUE=&quot;-2147483643&quot;&gt;
&#09;&lt;PARAM NAME=&quot;BackColorOdd&quot;  VALUE=&quot;-2147483643&quot;&gt;
&#09;&lt;PARAM NAME=&quot;ForeColorEven&quot; VALUE=&quot;1&quot;&gt;
&lt;/OBJECT&gt;
&lt;br&gt;
&lt;br&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;First&quot; &#09;VALUE=&quot;First&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Prev&quot; &#09;&#09;VALUE=&quot;Previous&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Next&quot;&#09;&#09;VALUE=&quot;Next&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Last&quot;&#09;&#09;VALUE=&quot;Last&quot;&gt;
&lt;hr&gt;
&lt;!-- Non-visual controls - AdvancedDataControl --&gt;
&lt;OBJECT CLASSID=&quot;clsid:9381D8F2-0288-11d0-9501-00AA00B911A5&quot;
&#09;ID=&quot;SControl&quot;
&#09;CODEBASE=&quot;HTTP://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;/MSADC/msadc 10.cab&quot;  
&#09;WIDTH=1 HEIGHT=1&gt;
&#09;&lt;PARAM NAME=&quot;BINDINGS&quot; VALUE=&quot;Grid1;&quot;&gt;
&#09;&lt;PARAM NAME=&quot;Connect&quot; VALUE=&quot;DSN=Project;UID=sa;PWD=;&quot;&gt;
&#09;&lt;PARAM NAME=&quot;Server&quot; VALUE=&quot;http://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;&quot;&gt;
&lt;/OBJECT&gt;
&lt;!-- VBS scripting for composing queries, updating profiles, and retrieving search results. --&gt;
&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;
Dim myQuery
SUB Load
&#09;Grid1.CAPTION = &quot;Project Data&quot;
&#09;'Initialize data grid with column names only.
&#09;SControl.SQL = &quot;Select Name, Duration, Start, Finish from Tasks where 2 &lt; 1 for browse&quot;
&#09;SControl.Refresh
END SUB
'Implement &quot;Clear&quot; button - clears all of the QBE fields in preparation for a new &quot;Find.&quot;
SUB Clear_OnClick
&#09;SName.Value=&quot;&quot;
&#09;SDuration.Value=&quot;&quot;
&#09;SStart.Value=&quot;&quot;
&#09;SFinish.Value=&quot;&quot;
END SUB
'Implement &quot;Find&quot; button - composes a dynamic SQL query to be processed by the database and returns matching records to be bound to the SGrid object.
SUB Find_OnClick
&#09;myQuery = &quot;Select Name, Duration, Start, Finish from Tasks&quot;
&#09;'Check QBE fields and compose a dynamic SQL query.
&#09;IF (SName.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Name like '&quot; + SName.Value + &quot;%'&quot;
&#09;END IF
&#09;IF (SDuration.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Duration like '&quot; + SDuration.Value + &quot;%'&quot;
&#09;END IF
&#09;IF (SStart.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Start like '&quot; + SStart.Value + &quot;%'&quot;
&#09;END IF
&#09;IF (SFinish.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Finish like '&quot; + SFinish.Value + &quot;%'&quot;
&#09;END IF
&#09;
&#09;myQuery = myQuery + &quot; for browse&quot;  'Mark recordset for editing.
&#09;'Set the new query and then refresh the SControl so that the new results are displayed.
&#09;SControl.SQL = myQuery
&#09;SControl.Refresh
&#09;
END SUB
'Navigation subroutines - based on currency changes to AdvancedDataControl (SControl).
'Move to the first record in the bound recordset.
SUB First_OnClick
  &#09;SControl.MoveFirst
END SUB
'Move to the next record from the current position in the bound recordset.
SUB Next_OnClick
  &#09;SControl.MoveNext
END SUB
'Move to the previous record from the current position in the bound recordset.
SUB Prev_OnClick
  &#09;SControl.MovePrevious
END SUB
'Move to the last record in the bound recordset.
SUB Last_OnClick
  &#09;SControl.MoveLast
END SUB
'Submits edits made and pull a clean copy of the new data.
SUB Update_OnClick
  &#09;SControl.SubmitChanges
&#09;SControl.Refresh
END SUB
'Cancel edits and restores original values.
SUB Cancel_OnClick
  &#09;SControl.CancelUpdate
END SUB
&lt;/SCRIPT&gt;
&lt;BR&gt;
&lt;font color = &quot;#400040&quot;&gt;This site powered by Microsoft Advanced Data Connector. &lt;/font&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<h2>Demo 6</h2>
<p>
This demo uses MSProject as an OLE server. If we run this demo with Microsoft Project as an out-of-process OLE server, it will crash because it will try to create more than one instance. It would also leave a process running that cannot be stopped. An in-process dynamic link library (DLL) that calls Microsoft Project is stable. It is easier to create and close the Microsoft Project application object in a Microsoft&reg; Visual Basic&reg; application than it is in a web page without a constant connection to the server.  In the DLL, set error handling much more intelligently and conveniently than in a Web page. So, the DLL should go in the path:C:\WINNT\System32\inetsrv/asp/cmpnts/ProjAsp.dll. The VB app,ProjAsp.vbp, is also included with its components, ProjAsp.cls andModule1.bas.</p>
<p>
Preview the code in the asp file. The first thing is to get the project name from the default.htm list box. This is added to the hard coded path to create a string to pass to the DLL to open the project. </p>
<p>
Another way of doing this is would be in a default.htm file, where the list box is between &lt;select&gt;and &lt;/select&gt; and there are hard coded list items. As  the value of each&lt;option&gt; tag, the full path of each project file on the server machine could be coded.</p>
<p>
After retrieving the project path the MSProjAsp.ProjAsp object is created. This calls the ProjAsp.dll. The name of the object comes from the name of the project in Visual Basic. Open the ProjAsp.vbp project in Visual Basic. Go to the Tools/Options/Project tab for the project name &quot;MSProjAsp&quot;  The name of the class is ProjAsp. Thus the object name MSProjAsp.ProjAsp. In the Options dialog box, look at the advanced tab. &quot;Use OLE DLL Restrictions&quot; is checked. This makes testing the vbp easier because it applies all restrictions for a DLL, i.e. no modal dialog boxes, etc.</p>
<p>
A Sub Main is created as an entry point for creating the object. It is the start-up procedure, but it is empty. Otherwise, Module1.bas declares aWin32API that will be called to see if Microsoft Project is running, and declare a public variable pjApp for the Microsoft Project Application object.</p>
<p>
In the asp page,  pj is the name of the DLL object. pj.GetTaskCount is called. In the Visual Basic application, the ProjAsp.cls class is opened. Notice that there are several declarations. There are also four functions. One of these is GetTaskCount. First get an instance of Microsoft Project. The functionCheckPJInstance checks for Microsoft Project. If it is running, it opens the object, if not, it creates the application object. On that pjApp object, we run FileOpen, passing it the path in the variable 'name' from the web page. Set pjProj to the activeproject. WithpjProj, GetTaskCount = NumberOfTasks. This is the value of the function and is returned to the web page. The next line in the asp page displays this value in the form of a variable, Scount.</p>
<p>
Next, we call GetTasks and fill an array, TaskArray. Look at the GetTasks Function in the ProjAsp class. Again, we check for and create an instance of the Microsoft Project application and open the file specified from the previous page. Dim TaskArray (1 to 7, 1 topjProj.NumberOfTasks). This means we have seven columns and a row for each task. Begin cycling through the tasks starting with number one. The If Not T is Nothing statement skips any blank tasks in the project. For each task, add the elements to the array. The last two, summary and milestone, display whether the current task is a summary or a milestone. The function is assigned the value of the array TaskArray(). This is passed back to the client to the variable in the active server page. </p>
<p>
Now, for each row in the TaskArray, 1 to Ubound(TaskArray,2), we add the information to a table. For each new task, we add a row using the &lt;tr&gt;tag. I made three variables MyColor, MyFontStart, and MyFontEnd. These are for formatting the data. By default, Mycolor is black. This is for normal tasks. If the task is a Summary Task, the color is changed to blue and MyFontStart and MyFontEnd are '&lt;b&gt;' and '&lt;/b&gt;' to make the text bold in HTML. If it is a Milestone, the color is green and the other variables are '&lt;u&gt;' and '&lt;/u&gt;' to start and stop underlining in HTML. </p>
<p>
Now we add the data to the table. For each column in the array from 1 to 5, add a cell in the table using the &lt;td&gt; tag. On value three, the duration, divide by 60 to get hours. Finally, add the value with the formatting using the variables and the &lt;/td&gt;tag to end the cell. </p>
<p>
At the end of each task add the &lt;/tr&gt; tag to end the row and move to thenext task.</p>
<p>
At the end of the project, call pj.Quit. This is another function in theVisual Basic app. This closes Microsoft Project and clears the object variable in the DLL.. Also set the pj variable = Nothing in the asp page.</p>
<p>
After we are through, add the &lt;/table&gt; tag to end the table.</p>
<h3>Source Code</h3>
<p>
<b>Default.htm</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Project as an OLE Server on the Web&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot;&gt;
&lt;center&gt;&lt;font size=&quot;6&quot; color=&quot;navy&quot;&gt;
Using Microsoft Project as an OLE Server over the Internet
&lt;br&gt;&lt;/font&gt;&lt;/center&gt;
&lt;form method=&quot;post&quot; action=&quot;aspole.asp&quot;&gt;
Enter the name of the project file:&lt;br&gt;
&lt;Select size=&quot;1&quot; name=&quot;pjname&quot;&gt;
&lt;option value=&quot;Audit.mpp&quot;&gt;Audit
&lt;option value=&quot;Eventpln.mpp&quot;&gt;Event Plan
&lt;option value=&quot;mktplan.mpp&quot;&gt;Marketing Plan
&lt;option value=&quot;Softdev.mpp&quot;&gt;Software Development
&lt;/select&gt;
&lt;br&gt;
&lt;input type=&quot;submit&quot; value=&quot;Get Project Information&quot;&gt;
&lt;/form&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Aspole.asp</b></p>
<pre><FONT FACE="Courier New" SIZE="2">&lt;%@ LANGUAGE = VBScript %&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Microsoft Project as an OLE Controller&lt;/TITLE&gt;&lt;/HEAD&gt;
&lt;body bgcolor=&quot;white&quot;&gt;
&lt;font color=&quot;navy&quot; 
&lt;%
'On Error Resume Next
'Get the project name from the previous form
projname=request(&quot;pjname&quot;)
'if it was blank, tell the user to go back and enter a project file
if projname = &quot;&quot; then
%&gt;
Please go back and enter a project name in the &quot;Rama Demos&quot; Directory
&lt;%
'otherwise, continue
else
'create an instance of the .dll to get the project data
set pj = Server.CreateObject(&quot;MSProjAsp.ProjAsp&quot;)
'Get the number of tasks in the project
Scount=pj.GetTaskCount(&quot;d:\Rama Demos\Project Files\&quot; &amp; projname)
%&gt;
&lt;font size=&quot;5&quot; color=&quot;navy&quot;&gt;
There are &lt;% =Scount %&gt; tasks in the &lt;% =projname %&gt; project.&lt;/font&gt;&lt;br&gt;
&lt;p&gt;
Normal tasks are in normal text.
&lt;font color=&quot;navy&quot;&gt;&lt;b&gt;Summary tasks are bold in blue.&lt;/b&gt;&lt;/font&gt;
&lt;font color=&quot;olive&quot;&gt;&lt;u&gt;Milestones are unerlined in green.&lt;/u&gt;&lt;/font&gt;
&lt;font size=&quot;4&quot;&gt;
&lt;table width=&quot;100%&quot; border=&quot;1&quot; cellpadding=&quot;1&quot;&gt;
&lt;tr&gt;&lt;td&gt;TaskID&lt;/td&gt;&lt;td&gt;Name&lt;/td&gt;&lt;td&gt;Duration&lt;/td&gt;&lt;td&gt;Start&lt;/td&gt;&lt;td&gt;Finish&lt;/td&gt;
&lt;%
'Fill an array with all of the project data
TaskArray = pj.GetTasks(&quot;d:\Rama Demos\Project Files\&quot; &amp; projname)
'Loop through each element of the array
for i = 1 to ubound(TaskArray,2)
%&gt;
&lt;tr&gt;
&lt;%
'Set font properties based on the type of task
'Normal task - black normal text
MyColor = &quot;black&quot;
MyFontStart = &quot;&quot;
MyFontEnd = &quot;&quot;
if TaskArray(6,i) = -1 then
'Summary task = red and bold
Mycolor = &quot;navy&quot;
MyfontStart = &quot;&lt;b&gt;&quot;
MyFontEnd = &quot;&lt;/b&gt;&quot;
end if
'Milestone = green and underlined
if TaskArray(7,i) = -1 then
MyColor = &quot;olive&quot;
MyFontStart = &quot;&lt;u&gt;&quot;
MyFontEnd = &quot;&lt;/u&gt;&quot;
end if
for j = 1 to 5
'Convert minutes to hours and add &quot;h&quot; for the Duration
if j = 3 then
MyValue = TaskArray(j,i)/60 &amp; &quot;h&quot;
else
MyValue = TaskArray(j,i)
end if 
%&gt;
&lt;td&gt;
&lt;font color = &quot;&lt;% =MyColor %&gt;&quot;&gt;&lt;% =MyFontStart %&gt;&lt;% =MyValue %&gt;&lt;% =MyFontEnd %&gt;&lt;/font&gt;&lt;/td&gt; 
&lt;%
'Next element
next
%&gt;
&lt;/tr&gt;
&lt;%
'Next Task
next
end if
'Call the function to close Microsoft Project.
i = pj.Quit()
'Unload the DLL
set pj = Nothing
%&gt;
&lt;/table&gt;
&lt;/font&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</font></pre>
<p>
<b>Projasp.dll (in winnt35\system32\inetsrv\asp\cmpnts)</b></p>
<p>
Projasp.vbp</p>
<pre><FONT FACE="Courier New" SIZE="2">Class=ProjAsp; ProjAsp.cls
Module=Module1; Module1.bas
Reference=*\G{BEF6E001-A874-101A-8BBA-00AA00300CAB}#2.0#0#C:\WINNT\System32\OLEPRO32.DLL#Standard OLE Types
Reference=*\G{A7107640-94DF-1068-855E-00DD01075445}#4.0#9#D:\MSOFFICE\WINPROJ\PJ4EN32.OLB#Microsoft Project 4.1 Object Library
ProjWinSize=136,413,201,113
ProjWinShow=2
HelpFile=&quot;&quot;
Title=&quot;ProjAsp&quot;
ExeName32=&quot;ProjAsp.dll&quot;
Name=&quot;MSProjAsp&quot;
HelpContextID=&quot;0&quot;
StartMode=1
VersionCompatible32=&quot;0&quot;
MajorVer=1
MinorVer=0
RevisionVer=12
AutoIncrementVer=1
ServerSupportFiles=0
DllRestrictions=1
VersionCompanyName=&quot;Samuel Brooks Corporation&quot;
</font></pre>
<p>
<b>Projasp.cls</b></p>
<pre><FONT FACE="Courier New" SIZE="2">VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = &quot;ProjAsp&quot;
Attribute VB_Creatable = True
Attribute VB_Exposed = True
Private Const PROJ_APP = &quot;MSProject.Application.4_1&quot;
Private Const PROJ_WINDOW = &quot;JWinproj-WhimperMainClass&quot;
Private GetProj As String
Private TaskTot As Integer
Public Function GetTaskCount(name) As String
On Error GoTo GetTaskCountEH
Dim pjProj As Project
'Get reference to MSProject
GetProj = CheckPJInstance()
'open the requested file
pjApp.FileOpen (name)
Set pjProj = pjApp.ActiveProject
'Return the number of tasks
TaskTot = pjProj.NumberOfTasks
GetTaskCount = CStr(TaskTot)
EOFunction:
    Exit Function
GetTaskCountEH:
    pjApp.Quit
    GetTaskCount = &quot;Error in Manipulating Project&quot;
    Exit Function
    
End Function
Public Function GetTasks(name)
On Error GoTo GetTasksEH
Dim pjProj As Project
'Get reference to MSProject
GetProj = CheckPJInstance()
'open the requested file
pjApp.FileOpen (name)
Set pjProj = pjApp.ActiveProject
'Fill an array with all of the task information
ReDim TaskArray(1 To 7, 1 To pjProj.NumberOfTasks)
Counter = 0
For Each T In pjProj.Tasks
    Counter = Counter + 1
    If Not T Is Nothing Then
        TaskArray(1, Counter) = T.ID
        TaskArray(2, Counter) = T.name
        TaskArray(3, Counter) = T.Duration
        TaskArray(4, Counter) = T.Start
        TaskArray(5, Counter) = T.Finish
        TaskArray(6, Counter) = T.Summary
        TaskArray(7, Counter) = T.Milestone
    End If
Next T
GetTasks = TaskArray()
EOFunction:
    Exit Function
GetTasksEH:
    GetTasks = &quot;Error in Manipulating Project&quot;
    Exit Function
    
End Function
Private Function CheckPJInstance() As String
    On Error GoTo ErrorHandler
    
    'Check to see if Microsoft Project is running.
    If FindWindow(PROJ_WINDOW, vbNullString) = 0 Then
        'if not, create the application object
        Set pjApp = CreateObject(PROJ_APP)
    Else
        'if so, get an application object
        Set pjApp = GetObject(, PROJ_APP)
    End If
    
    Exit Function
    
ErrorHandler:
    CheckPJInstance = &quot;Error in Manipulating Project&quot;
    Exit Function
End Function
Public Function Quit()
'Close Microsoft Project
pjApp.Quit
Set pjApp = Nothing
End Function
</font></pre>
<p>
<b>Module1.bas</b></p>
<pre><FONT FACE="Courier New" SIZE="2">Attribute VB_Name = &quot;Module1&quot;
Declare Function FindWindow Lib &quot;user32&quot; Alias &quot;FindWindowA&quot; (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Public pjApp As Object
Sub main()
End Sub
</font></pre>
<h2>Conclusion</h2>
<p>
This session provides the process and methods to publish Microsoft Project and Team Manager data on the internet using six different methods. It is an excellent starting point for building internet aware project management information systems based on either Microsoft Project or Team Manager.</p>
<p>
&copy; 1997 Microsoft Corporation. All rights reserved.</p>
<p>
The information contained in this document represents the current view of Microsoft Corporation on the issues discussed as of the date of publication. Because Microsoft must respond to changing market conditions, it should not be interpreted to be a commitment on the part of Microsoft, and Microsoft cannot guarantee the accuracy of any information presented after the date of publication.</p>
<p>
This document is for informational purposes only. MICROSOFT MAKES NO WARRANTIES, EXPRESS OR IMPLIED, IN THIS SUMMARY.</p>
<p>
Microsoft and Visual Basic are registered trademarks of Microsoft Corporation.</p>
<p>
Other product or company names mentioned herein may be the trademarks of their respective owners.</p>
</font></BODY>
</HTML>
