<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSHFlexGrid Control</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbctlmshflexgridcontrol"></a>MSHFlexGrid Control</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbctlMSHFlexGridControl_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbctlMSHFlexGridControl_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Properties">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbctlMSHFlexGridControl_P">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Methods">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbctlMSHFlexGridControl_M">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Events">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbctlMSHFlexGridControl_E">
</object></p>
<p>
The Microsoft Hierarchical FlexGrid (<b>MSHFlexGrid</b>) control displays and operates on tabular data. It allows complete flexibility to sort, merge, and format tables containing strings and pictures. When bound to a data control, <b>MSHFlexGrid</b> displays read-only data.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>MSHFlexGrid</b></p>
<p class=label>
<b>Remarks</b></p>
<p>
You can place text, a picture, or both in any cell of an <b>MSHFlexGrid</b>. The <b>Row</b> and <b>Col</b> properties specify the current cell in an <b>MSHFlexGrid</b>. You can specify the current cell using code, or the user can change it at <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defRunTime">
</object><a href=JavaScript:alink_6.Click()>run time</a> using the mouse or the arrow keys. The <b>Text</b> property references the contents of the current cell.</p>
<p>
If the text in a cell is too long to display in the cell, and the <b>WordWrap</b> property is set to <b>True</b>, the text wraps to the next line within the same cell. To display the wrapped text, you may need to increase the cell’s column width (<b>ColWidth</b> property) or row height (<b>RowHeight</b> property).</p>
<p>
Use the <b>Col</b> and <b>Row</b> properties to determine the number of columns and rows in an <b>MSHFlexGrid</b>. Use the <b>Band</b> properties to determine the band styles in an <b>MSHFlexGrid</b>.</p>
<h2>Displaying Hierarchical Recordsets</h2>
<p>
A major feature of the MSHFlexGrid control is its ability to display hierarchical recordsets—relational tables displayed in a hierarchical fashion. The easiest way to create a hierarchical recordset is to use the Data Environment designer and assign the <b>DataSource</b> property of the <b>MSHFlexGrid</b> control to the Data Environment. You can also create a hierarchical recordset in code using a Shape command as the <b>RecordSource</b> for an <b>ADO Data Control</b>, as shown in the example below:</p>
<pre><code>' Create a ConnectionString.
Dim strCn As String
strCn = "Provider=MSDataShape.1;Data Source=Nwind;" &amp; _
"Connect Timeout=15;Data Provider=MSDASQL"

' Create a Shape command.
Dim strSh As String
strSh = "SHAPE {SELECT * FROM `Customers`}&nbsp; AS Customers " &amp; _
"APPEND ({SELECT * FROM `Orders`}&nbsp; AS Orders RELATE " &amp; _
"CustomerID TO CustomerID) AS Orders"

' Assign the ConnectionString to an ADO Data Control's
' ConnectionString property, and the Shape command to the 
' control's RecordSource property.
With Adodc1
   .ConnectionString = strCn
   .RecordSource = strSh
End With
' Set the HflexGrid control's DataSource property to the 
' ADO Data control.
Set HFlexGrid1.DataSource = Adodc1
</code></pre>
<p class=indent>
<b><B>For More Information</B> &nbsp; </b>To find out more about hierarchical recordsets, see <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscHierarchicalCursorsDataShapingDetail">
</object><a href=JavaScript:alink_7.Click()>Hierarchical Cursors and Data Shaping Summary</a>. A description of Shape commands can also be found in <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscShapeCommandsInGeneral">
</object><a href=JavaScript:alink_8.Click()>Shape Commands in General</a>.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Before you can use an <b>MSHFlexGrid</b> in your application, you must add the MSHFlxGd.ocx file to your project. To automatically include the file in your project, put it in the Autoload file. When distributing your application, you should install the MSHFlxGd.ocx file in the user’s Microsoft Windows System directory. For more information about adding an ActiveX control to a project, see "Standard ActiveX Controls" in the <i>Visual Basic Programmer’s Guide</i>.</p>
</BODY>
</HTML>
