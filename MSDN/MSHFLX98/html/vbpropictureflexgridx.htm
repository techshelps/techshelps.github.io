<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ColData, RowData, Picture Properties Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbpropictureflexgridx"></a>ColData, RowData, Picture Properties Example</h1>
<p>
The following code shows how you can trap out-of-memory errors and automatically switch to monochrome mode using the <b>PictureType</b> property. In addition, it shows how to create a picture within the <b>MSHFlexGrid </b>that includes only the current selection.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you are using the <b>MSFlexGrid</b>, substitute "MSHFlexGrid1" with "MSFlexGrid1."</p>
<pre><code>Sub CopySelectedPictureToClipboard (myFlex As _
MSHFlexGrid)
   Dim i As Integer, tr As Long, lc As Long, _
   hl As Integer
<b>   '</b> Get ready to operate.
   MyFlex.<span class=cfe><b>Redraw</b></span> =False   <b>'</b> To eliminate flicker.
   hl =MyFlex.HighLight   <b>'</b> Save current settings.
   tr =MyFlex.TopRow
   lc =MyFlex.LeftCol
   MyFlex.HighLight =0   <b>'</b> No highlight on picture.
   ' Hide nonselected rows and columns.
   ' (Save original sizes in RowData/ColData 
   ' properties.)
   For i =MyFlex.FixedRows To MyFlex.Rows - 1
      If i &lt; MyFlex.Row Or i &gt; MyFlex.RowSel Then
         MyFlex.<span class=cfe><b>RowData</b></span>(i) =MyFlex.RowHeight(i)
         MyFlex.RowHeight(i) =0
      End If
   Next
   For i =MyFlex.FixedCols To MyFlex.Cols - 1
      If i &lt; MyFlex.Col Or i &gt; MyFlex.ColSel Then
         MyFlex.<span class=cfe><b>ColData</b></span>(i) =MyFlex.ColWidth(i)
         MyFlex.ColWidth(i) =0
      End If
   Next
<b>   '</b> Scroll to top left corner.
   MyFlex.TopRow =MyFlex.FixedRows
   MyFlex.LeftCol =MyFlex.FixedCols
<b>   '</b> Copy picture.
   clipboard.Clear
   On Error Resume Next
   MyFlex.<span class=cfe><b>PictureType</b></span> =0 ' Color.
   clipboard.SetData MyFlex.<span class=cfe><b>Picture</b></span>
   If Error &lt;&gt; 0 Then
      MyFlex.<span class=cfe><b>PictureType</b></span> =1 ' Monochrome.
      clipboard.SetData MyFlex.<span class=cfe><b>Picture</b></span>
   Endif
<b>   '</b> Restore control.
   For i =MyFlex.FixedRows To MyFlex.Rows - 1
      If i &lt; MyFlex.Row Or i &gt; MyFlex.RowSel Then
         MyFlex.RowHeight(i) =MyFlex.RowData(i)
      End If
   Next
   For i =MyFlex.FixedCols To MyFlex.Cols - 1
      If i &lt; MyFlex.Col Or i &gt; MyFlex.ColSel Then
         MyFlex.ColWidth(i) =MyFlex.ColData(i)
      End If
   Next
   MyFlex.TopRow =tr
   MyFlex.LeftCol =lc
   MyFlex.HighLight =hl
   MyFlex.Redraw =True
End Sub
</code></pre>
<p>
The following example shows how to set the <b>MSHFlexGrid's</b> <b>Picture</b> property to a <b>PictureBox</b> control:</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you are using the <b>MSFlexGrid</b>, substitute "MSHFlexGrid1" with "MSFlexGrid1."</p>
<pre><code>Private Sub Form_Click ()
   Set Picture1.<span class=cfe><b>Picture</b></span> =MSHFlexGrid1.Picture
End Sub
</code></pre>
</BODY>
</HTML>
