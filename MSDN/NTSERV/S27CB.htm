<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with Black Hole Routers</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H2 CLASS="h2">Working with Black Hole Routers</H2><P CLASS="t">Another way to add effective bandwidth is by detecting and properly responding to black hole routers. Black hole routers are a common cause of frequent connection resets. </P>
<P CLASS="t"><I>Black hole routers</I> are routers that do not send an "ICMP Destination Unreachable" message when they cannot forward an IP datagram. Instead, they ignore the datagram. Doing so causes the connection to be reset. Typically, the reason an IP datagram cannot be forwarded is because the datagram's maximum segment size is too large for the receiving server and the Don't-Fragment bit is set.</P>
<P CLASS="t">To respond effectively to black hole routers, you can enable the Path MTUBH Detect feature of TCP/IP. Path MTUBH Detect recognizes repeated unacknowledged transmission and responds by turning off the Don't-Fragment bit. After the datagram in question is transmitted successfully, it reduces the maximum segment size and turns the Don't-Fragment bit on again.</P>
<P CLASS="t">Path MTUBH Detect is disabled by default, but you can enable it by adding the <B>EnablePMTUBHDetect</B> value entry to the Registry and setting its value to 1. <B>EnablePMTUBHDetect</B> is an optional entry that does not appear in the Registry unless you add it. You must place it in: </P>
<P CLASS="t">HKEY_LOCAL_MACHINE\System<BR>    \CurrentControlSet<BR>        \Services<BR>            \Tcpip<BR>                \Parameters </P>
<P CLASS="t">You can disable Path MTUBH Detect by deleting <B>EnablePMTUBHDetect</B> from the Registry or by setting its value to 0.</P></BODY></HTML>
