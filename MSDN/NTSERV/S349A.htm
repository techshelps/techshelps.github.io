<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Spool File Security</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Spool File Security</H3><P CLASS="t">To implement spool file security, change the default spool directory to an NTFS partition and directory where write permission is limited on a user-by-user basis. </P>
<P CLASS="t">When a print job prints locally, the local print provider spools the job to disk during processing. By default, the Everyone group has Change permission in the default spool directory. This allows all user print jobs write access to the default spooler directory.</P>
<P CLASS="t">A print job that cannot be spooled to disk during processing does not print. If the spool directory location is changed, all users who need to print must have Change permission for the new spool directory.</P>
<P CLASS="t">As described in the "Local Print Provider" section, the spool file (SPL_) and the shadow file (SHD) are written to the default spooler directory: %WINNT\SYSTEM32\SPOOL\Printers</P>
<P CLASS="t">For instructions on changing the default spool file directory, see "Local Print Provider" ealier in this chapter.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>To override the default location for one specific printer</H4><P>    1.    Start the Registry Editor (Regedt32.exe).</P>
<P>    2.    Find the following key:</P>
<P CLASS="spacing"><BR></P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\
Print\Printers
<P>    3.    Find the key for the printer: </P>
<P CLASS="spacing"><BR></P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\
Print\&lt;<I>Printername</I>&gt;
<P>    4.    Add a new SpoolDirectory setting, and as its value provide the path to the spool directory that this printer should use.</P>
<P><B>Note</B>  You must create a directory for the new spool file location. If you attempt to spool directly to the root (C:\ or D:\, for example), the spool file will revert to the default spool directory.</P>
<P CLASS="t">The change in the Registry takes effect after you stop and restart the Spooler service.</P></BODY></HTML>
