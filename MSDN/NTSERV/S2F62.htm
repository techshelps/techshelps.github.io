<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDC Problems</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">IDC Problems</H3><H4 CLASS="h3"><A NAME="sec0"></A>Troubleshooting Microsoft SQL Server</H4><P CLASS="t">If an Internet Information Server application cannot connect to SQL Server, it might indicate a problem with the network or SQL Server. You can test Microsoft Internet Information Server connectivity with SQL Server by using tools provided with Microsoft SQL Server. Table 8.3 describes tools included with the Microsoft SQL Server product that can help isolate network problems.</P>
<P>Table 8.3    SQL Server Troubleshooting Tools</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"><COL WIDTH="211pt" VALIGN="TOP"><COL WIDTH="60pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>SQL Server tool</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Purpose</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Location</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>Makepipe.exe</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Tests the integrity of the network named pipe services.</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">SQL Server</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>Readpipe.exe</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Tests the integrity of the network named pipe services.</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">SQL Server clients</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>Odbcping.exe</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Troubleshoots connectivity to SQL Server through Microsoft ODBC SQL Server drivers.</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">SQL Server</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Isqlw.exe</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Queries SQL Server, analyzes the execution plan of a query, and views statistics about the executed query.</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">SQL Server and clients</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">For more information about Microsoft SQL Server and these tools, see the<I> Microsoft SQL Server Books Online</I>.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>SYBASE SQL Server Does Not Work with Internet Information Server</H4><P CLASS="t">If you try to connect to a SYBASE&reg; database through an .idc file by using the ODBC drivers included in Internet Information Server, you might see this message:</P>
<P CLASS="spacing"><BR></P>
Error performing query state=01000, error 1225 Microsoft ODBC SQL Server <BR>Driver DBNMPNTW Connection open Create file <BR>State = 08001 error = 1225 Microsoft ODBC SQL Server Driver unable to <BR>connect to data source.<BR>
<P CLASS="t">The current Microsoft SQL Server ODBC driver is not certified for use with SYBASE SQL Server.</P>
<P CLASS="t">To correct this problem, use SYBASE SQL Server ODBC drivers. Contact SYBASE Corporation for ODBC drivers certified for use with SYBASE SQL Server. Many third-party ODBC vendors also provide ODBC drivers certified for use with SYBASE SQL Server. </P>
<H4 CLASS="h3"><A NAME="sec2"></A>SQL Server Returns 'Not Defined as a Valid User'</H4><P CLASS="t">You might see the following message when accessing an Internet Database Connector (IDC) script:</P>
<P CLASS="spacing"><BR></P>
Error Performing Query<BR>*[State=3700][Error=18450][Microsoft][ODBC SQL Driver][SQL Server]<BR>Login failed- User: _ Reason: Not defined as a valid user of a trusted <BR>SQL Server Connection.<BR>
<P CLASS="t">This message can appear under the following conditions:</P>
<UL><LI>You are not running SQL Server and Internet Information Server on the same computer.</LI><LI>You are using Windows&nbsp;NT challenge/response authentication on Internet Information Server.</LI><LI>You are using integrated or mixed security with Microsoft SQL Server.</LI><LI>You are not providing the user name or password values in your .idc file.</LI></UL><P></P>
<P CLASS="t">When the client runs the IDC script, Internet Information Server must determine whether the data source is local or remote. If the data source is defined as Local System, the query is passed to SQL Server on the same computer. If the data source is remote, the computer running Internet Information Server must make a network connection to SQL Server. When Internet Information Server makes the network connection, it does not pass the credentials of the remote user. It passes a blank user name and password instead.</P>
<P CLASS="t">SQL Server does not validate a user without a user name, and returns the message to Internet Information Server. Internet Information Server then passes the results of the query to the client Web browser.</P>
<P CLASS="t">There are two possible workarounds:</P>
<UL><LI>Install SQL Server and Internet Information Server on the same computer. Then set up your ODBC system Data Source Name (DSN) to be Local Server instead of a remote computer name.</LI><LI>Use Basic authentication instead of Windows&nbsp;NT challenge/response authentication.</LI></UL><P></P>
<H4 CLASS="h3"><A NAME="sec3"></A>Pipe/Connection Busy or Time-out Expired Errors Appear when Using SQL Server</H4><P CLASS="t">If Internet Information Server connects to Microsoft SQL Server through the Internet Database Connector, multiple error messages can appear as databases are added to SQL Server. </P>
<P CLASS="t">The following messages might be displayed when using the Internet Database Connector to make SQL requests to Microsoft SQL Server, if it has a growing number of databases:</P>
<P CLASS="spacing"><BR></P>
*[State=01000][Error=231][Microsoft][ODBC SQL Server Driver]Pipe busy.<BR>*[State=08001][Error=3][Microsoft][ODBC SQL Server Driver]Connection is busy.<BR>*[State=S1T00][Error=0][Microsoft][ODBC SQL Server Driver]Time-out expired.<BR>
<P CLASS="t">These problems can result if the SQL Server configuration parameter Open Databases is set too low. SQL Server 6.0 sets this value to 20 by default. If you add databases to SQL Server until you exceed the configured value, it does not generate an "out of open databases" message in the SQL Server log. Instead, the messages listed above appear when you query the database from Internet Information Server. </P>
<P CLASS="t">To solve this problem, increase the value of the SQL Server configuration parameter Open Databases. For more information on setting this parameter, consult the <I>Microsoft SQL Server Administrator's Companion</I>.</P></BODY></HTML>
