<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Emergency Repair Disk</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Using the Emergency Repair Disk</H3><P CLASS="t">If your system files, Registry information, or Partition Boot Sector are corrupt, and you are unable to start Windows&nbsp;NT by using the Last Known Good control set, you can use the Repair process in Windows&nbsp;NT Setup to restore your system so you can start up. </P>
<P CLASS="t">To repair a Windows&nbsp;NT installation, Setup needs either the configuration information that is saved on the %systemroot%\Repair folder or the Emergency Repair Disk created when you installed the operating system (or you created later by using the Repair Disk program).</P>
<P CLASS="t">You cannot repair all disk problems by using the Emergency Repair Disk. Your Emergency Repair Disk needs to match the version of Windows&nbsp;NT that you have installed on your computer. It also needs to have current configuration information. If you have more than one installation of Windows&nbsp;NT on your computer, you should have an Emergency Repair Disk for each installation. You should never use an Emergency Repair Disk from another computer.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>To use the Emergency Repair Disk </H4><P>    1.    Start the computer from the Windows NT Setup disk 1. Insert disk 2 when it is requested. When prompted, select the option to Repair by pressing the R key. Setup displays the following options:</P>
<P CLASS="spacing"><BR></P>
[X]  Inspect Registry files 
[X]  Inspect startup environment
[X]  Verify Windows NT system files
[X]  Inspect boot sector
     Continue (perform selected tasks)
<P>A description of each of the options follows this procedure.</P>
<P>    2.    Clear all selections that you do not want to use. Click <B>Continue (perform selected tasks)</B>.</P>
<P>    3.    After disk 3, you will be prompted for the Emergency Repair Disk. Follow the instructions.</P>
<P>Setup displays the following messages after it has finished the repair process: </P>
<P CLASS="spacing"><BR></P>
Setup has completed repairs.
If there is a floppy disk inserted in drive A:, remove it.
Press ENTER to restart your computer.
<H4 CLASS="h3"><A NAME="sec1"></A>Inspect Registry Files</H4><P CLASS="t">The Repair process in Windows&nbsp;NT Setup is one of several ways that you can repair Registry keys. When you select <B>Inspect Registry files</B>, Setup provides you with a list of the Registry files that it can restore. It also warns you that restoring a Registry file can result in information being lost. These are the options:</P>
<P CLASS="spacing"><BR></P>
[ ] SYSTEM (System Configuration)
[ ] SOFTWARE (Software Information)
[ ] DEFAULT (Default User Profile)
[ ] NTUSER.DAT (New User Profile)
[ ] SECURITY (Security Policy) and 
    SAM (User Accounts Database)
    Continue (perform selected tasks)
<P CLASS="t">Select the key(s) that you want to restore by entering an X between the brackets, such as:</P>
<P CLASS="spacing"><BR></P>
[X] SYSTEM (System Information)
<P CLASS="t">See "Creating an Emergency Repair Disk," presented earlier in this chapter, for information about how often to create the disk, and how to save the current keys.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Inspect Startup Environment</H4><P CLASS="t">This option verifies that the Windows&nbsp;NT files in the system partition are the correct ones. If any of the files that are needed to start Windows&nbsp;NT are missing or corrupt, Repair replaces them from the <I>Windows&nbsp;NT Server</I> CD.</P>
<P CLASS="t">On x86-based computers, if Windows&nbsp;NT is not listed in the Boot.ini file, Repair adds a Windows NT option to the file. If there is no Boot.ini file, Repair creates one.  </P>
<P CLASS="t">On a RISC-based computer, Repair inspects and repairs the startup information in the NVRAM.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Verify Windows NT System Files</H4><P CLASS="t">This option uses a checksum to verify that each file in the installation is good and matches the file that was installed from the <I>Windows&nbsp;NT Server</I> CD. Repair uses the Setup.log file on the Emergency Repair Disk to determine what files were installed and their checksums. The repair process also verifies that files needed to start, such as NTLDR and Ntoskrnl.exe, are present and valid. To find out if one or more service packs need to be reinstalled, check Files.lst on each service pack. The <I>Windows&nbsp;NT Server</I> CD is required for this option.</P>
<P CLASS="t">When Repair determines that the file on the disk does not match what was installed, it displays a message that identifies the file and asks whether you want to replace it.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>Inspect Boot Sector (x86-based Computers)</H4><P CLASS="t">This option verifies that the Partition Boot Sector on the system partition still references NTLDR, and replaces it from the Emergency Repair Disk if it does not. The Repair process can only replace the Partition Boot Sector for the system partition on the first hard disk. The Repair process can also repair the Partition Boot Sector for the system partition on the startup disk.</P>
<P CLASS="t">If you have saved the Partition Boot Sector, you can also use the procedures described in "Replacing the Master Boot Record and the Partition Boot Sector," presented later in this chapter, to replace it.</P></BODY></HTML>
