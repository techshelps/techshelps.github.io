<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Simulating UPS Operation</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Simulating UPS Operation</H3><P CLASS="t">The next figure shows a simple simulator that you can build to emulate the power failure and low battery signals from a UPS.</P>
<P><img src="xsr_f04.gif"></P>
<P CLASS="cap"><B>Figure 5.1.    UPS simulator</B></P>
<P CLASS="t"><B>Note</B></P>
<P>The pins numbers in the diagram are for a 9-pin serial port. For a 25-pin connector, use the pin numbers in parenthesis.</P>
<P CLASS="t">You can use two Single Pole Double Throw (SPDT) switches to construct the UPS simulator. To simulate normal operation, set both switches 1 and 2 to make contact with pin 7 (pin 4 on a 25-pin connector). Set both the <B>Power failure signal</B> and <B>Low battery signal at least 2 minutes before shutdown</B> to <B>Negative</B> in the <B>UPS</B> dialog box.</P>
<P CLASS="t">To simulate a power failure, move switch 1 to make contact with pin 3 (pin 2 on a 25-pin connector). Moving switch 2 to make contact with pin 3 simulates a low battery condition.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Simulating Power Failure and Low Battery Signals</H4><P CLASS="t">To simulate the operation of a UPS with both a Power Failure and Low Battery signal, have both switches making contact with pin 7. Configure your UPS as shown in this dialog box:</P>
<P><img src="xsr_f05.gif"></P>
<P CLASS="t">Flip switch 1 to simulate a Power Failure signal. After five seconds, the initial warning message should be displayed. Every 120 seconds, the warning message should be displayed again. </P>
<P CLASS="t">When you know that the Power Failure signal processing is working correctly, flip switch 2. If you have checked the <B>Execute Command File</B> check box and specified a filename, the file should begin execution immediately. If the file does not finish executing within 30 seconds, Windows&nbsp;NT should terminate it. Windows&nbsp;NT should perform an orderly shutdown after the file terminates or immediately after the Power Failure signal if no file is specified.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Simulating UPS With Power Failure Signal Only</H4><P CLASS="t">To simulate the operation of a UPS with only a Power Failure signal, have both switches making contact with pin 7. For purposes of this test, you can set the values in the <B>UPS Characteristics</B> group box to make it seem that your computer does not have to run very long before the battery is fully charged. When you set the values this way, you have to make sure that your battery does have enough charge to be able to complete the tests. For instance, if you set the values as shown in this dialog box, and let your computer run for 20 minutes, the UPS service assumes that the battery is fully charged.</P>
<P><img src="xsr_f06.gif"></P>
<P CLASS="t">You can test two scenarios with this configuration:</P>
<UL><LI>If you connect switch 1 to pin 3 within four minutes of starting the UPS service, the expected battery life is less than two minutes, and Windows&nbsp;NT should begin shutdown immediately.</LI><LI>If you allow the computer to run for 20 minutes before you flip switch 1, the battery is assumed to be fully charged. When you flip switch 1, the warning message should be displayed after five seconds. Every 120 seconds, another warning message should be displayed. Shutdown should not begin until the expected battery life decreases to two minutes.</LI></UL></BODY></HTML>
