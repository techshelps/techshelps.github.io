<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DHCP Clients</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">DHCP Clients</H3><P CLASS="t">To configure a computer running Windows&nbsp;NT Server or Windows&nbsp;NT Workstation as a DHCP client, select the <B>Obtain an IP address from a DHCP server</B> check box on the <B>IP Address</B> tab of the <B>Microsoft TCP/IP Properties</B> page. A DHCP server can also be used to configure computers running under following operating systems:</P>
<UL><LI>Windows 95</LI><LI>Windows for Workgroups version 3.11 with the Microsoft 32-bit TCP/IP VxD installed</LI><LI>Microsoft – Network Client version 3.0 for MS-DOS with the real-mode TCP/IP driver installed</LI><LI>LAN Manager version 2.2c</LI></UL><P CLASS="t">Table 7.5 describes the basic TCP/IP configuration parameters that a DHCP server must provide to DHCP clients. </P>
<P CLASS="ttl"><B>Table 7.5    Required TCP/IP Configuration Parameters for DHCP Clients</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="15%" VALIGN="TOP"><COL WIDTH="85%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B>Basic TCP/IP configuration parameters</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">IP address</P></TD><TD VALIGN="TOP"><P CLASS="tt">Every device attached to a TCP/IP network is identified by a unique IP address. (If the computer has multiple network adapter cards, it will require multiple IP addresses.) The IP address is a numeric identifier comprised of four 8-bit octets separated by periods. (This number is generally shown in dotted-decimal notation, for example, 172.16.32.1) The IP address is actually two parts: the first part represents a network ID and the second part represents a host (computer) ID.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Subnet mask</P></TD><TD VALIGN="TOP"><P CLASS="tt">Used to identify the part of the unique IP address that is the network identifier and the part that is the host identifier. Subnet masks are created by assigning 1s to network ID bits and 0s to the host ID bits of the IP address. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Default gateway</P></TD><TD VALIGN="TOP"><P CLASS="tt">The computer (router) connected to the local subnet and other subnets that is used to pass IP packets from one subnet to another. (A default gateway is required only when the client is located on a routed TCP/IP network.)</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4 CLASS="h3"><A NAME="sec0"></A>Initial DHCP Client Configuration</H4><P CLASS="t">When a DHCP client computer is started on a TCP/IP network, it communicates with a DHCP server to get its TCP/IP configuration information. The following table describes the DHCP message types exchanged between client and server. </P>
<P CLASS="ttl"><B>Table 7.6    DHCP Message Types</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="75%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B>Message type</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Dhcpdiscover</P></TD><TD VALIGN="TOP"><P CLASS="tt">The first time a DHCP client computer attempts to start on the network, it requests IP address information from a DHCP server by broadcasting a Dhcpdiscover packet. The source IP address in the packet is 0.0.0.0 because the client does not yet have an IP address. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Dhcpoffer</P></TD><TD VALIGN="TOP"><P CLASS="tt">When the DHCP server receives the request, it selects an unleased IP address from the range of available IP addresses and offers it to the DHCP client. In most cases, the DHCP server also returns additional TCP/IP configuration information, such as the subnet mask and default gateway in a Dhcpoffer packet. More than one DHCP server can respond with a Dhcpoffer packet, and the client accepts the first Dhcpoffer it receives.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Dhcprequest</P></TD><TD VALIGN="TOP"><P CLASS="tt">When a DHCP client receives a Dhcpoffer packet, it responds by broadcasting a Dhcprequest packet that contains the offered IP address.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Dhcpdecline</P></TD><TD VALIGN="TOP"><P CLASS="tt">A message from the DHCP client to the server indicating that the offered configuration parameters are invalid.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Dhcpack</P></TD><TD VALIGN="TOP"><P CLASS="tt">The DHCP server acknowledges the client Dhcprequest for the IP address by sending a Dhcpack packet.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Dhcpnack</P></TD><TD VALIGN="TOP"><P CLASS="tt">If the IP address cannot be used by the client because it is no longer valid or is now used by another computer, the DHCP server will respond with a Dhcpnack packet.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Dhcprelease</P></TD><TD VALIGN="TOP"><P CLASS="tt">A message from the DHCP client to the server that releases the IP address and cancels any remaining lease.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">When the DHCP server receives the request from the DHCP client computer, it dynamically assigns an IP address to the requesting computer from the range of valid IP addresses contained within the DHCP scope. The DHCP server allocates the IP address with a <I>lease</I> that defines how long the IP address is usable by the client computer. The DHCP server can also establish other configuration parameters, such as subnet mask and DNS and WINS server identification, for the client computer.</P>
<P CLASS="t">If the DHCP client has previously been assigned an IP address by the DHCP server or by manual configuration, the client sends a Dhcprequest packet. The following figure illustrates this process.</P>
<P><img src="XNG_L01.gif"></P>
<P CLASS="cap"><B>Figure 7.1    DHCP Client and Server Interaction During System Startup</B></P>
<P CLASS="t"><B>Note</B></P>
<P>The client accepts the first offer it receives, regardless of whether the offer came from a DHCP server on the local subnet or from a DHCP server on a different subnet.</P>
<P CLASS="t">When a client accepts an IP address, and any other configuration information offered by the DHCP server, the client saves the configuration in the following Registry keys:</P>
<P CLASS="spacing"><BR></P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services:
    Network interface specific: &lt;adapter&gt;\parameters\Tcpip
    General: Dhcp\parameters\options\*
<P CLASS="t">IP addressing information is leased to a client until the client manually releases the address, or until the DHCP server cancels the lease and makes the address available to other computers on the network.</P>
<P CLASS="t">If a client does not receive a Dhcpoffer packet from a DHCP server, it will broadcast a request four times, at 2- ,4- ,8- , and 16-second intervals (plus a random amount between 0 and 1,000 milliseconds). If the client does not receive a response after four attempts, it will cease trying and retry again in five minutes. In the case where the DHCP server is unavailable or there is no available IP addressing information to lease to a client computer, the client is unable to bind to TCP/IP.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Restarting a DHCP Client</H4><P CLASS="t">When a client computer restarts and logs on to the network, it broadcasts a Dhcprequest packet instead of a Dhcpdiscover packet. The Dhcprequest packet contains a request for the previously assigned IP address. The DHCP server will attempt to allow the client to retain the same IP address, and will respond with a Dhcpack packet. If the IP address cannot be used by the client because it is no longer valid, or is now used by another computer, the DHCP server will respond with a Dhcpnack packet. The client that receives a Dhcpnack response must restart the configuration process by sending a Dhcpdiscover request.</P></BODY></HTML>
