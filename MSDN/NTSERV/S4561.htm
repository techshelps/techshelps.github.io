<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Accessing the Database</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Accessing the Database</H3><P CLASS="t">Terra Flora has an existing table in its order database. This table is used to process retail orders. The ability to access existing stores of information is the primary benefit of using Internet Information Server at Terra Flora. </P>
<P CLASS="t">Users enter data into the database by using an HTML form, as shown in the .htm file in Figure 5.17.</P>
<P CLASS="spacing"><BR></P>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Terra Flora&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY BGCOLOR="#FFFFFF"&gt;
&lt;H1 Align = "Center"&gt;&lt;CENTER&gt;&lt;FONT SIZE=6 COLOR=#000000 FACE="Arial"&gt;Terra
Flora Order Desk&lt;/FONT&gt;&lt;FONT SIZE=6&gt; &lt;/FONT&gt;&lt;/CENTER&gt;&lt;/H1&gt;
&lt;FORM ACTION="/secure/Order.idc" METHOD = "POST"&gt;
&lt;P&gt;
&lt;TABLE BORDER=2 BORDER BGCOLOR="#FFFFFF"&gt;
&lt;TR&gt;&lt;TD&gt;FirstName&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="FirstName" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;&lt;BR&gt;
Address1&lt;/TD&gt;&lt;TD&gt;&lt;A NAME="UQHTML0"&gt;&lt;/A&gt;&lt;INPUT NAME="Address1" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;LastName&lt;/TD&gt;&lt;TD&gt;
&lt;INPUT NAME="LastName" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;&lt;BR&gt;
Address2&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="Address2" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;ProductId1&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="ProductId1" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;
&lt;BR&gt;
City&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="City" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;ProductId2&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="ProductId2" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;
&lt;BR&gt;
State&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="State" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;ProductId3&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="ProductId3" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;
&lt;BR&gt;
Country&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="Country" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Comment&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="Comment" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;PhoneNumber&lt;/TD&gt;&lt;TD&gt;
&lt;INPUT NAME="PhoneNumber" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;DeliveryDate&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="DeliveryDate" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;Email&lt;/TD&gt;&lt;TD&gt;
&lt;INPUT NAME="Email" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;CreditCardNumber&lt;/TD&gt;&lt;TD&gt;&lt;INPUT NAME="CreditCardNumber" VALUE="" &amp;lt;/TD&gt;
&lt;/TD&gt;&lt;TD&gt;
&lt;INPUT TYPE="SUBMIT" VALUE="Place Order" ALIGN="MIDDLE"&gt;&lt;/P&gt;
&lt;/TD&gt;&lt;TD&gt;&lt;INPUT TYPE="RESET" NAME="reset" VALUE="Clear" ALIGN="MIDDLE"&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;P&gt;
&lt;/FORM&gt;
&lt;P&gt;
&lt;HR=2&gt; 
&lt;/BODY&gt;
&lt;/HTML&gt;

<P>Figure 5.17    Sample .htm file for Terra Flora order desk</P>
<P CLASS="t">Figure 5.18 shows the results of this .htm file in Internet Explorer.</P>
<P><img src="xig_d18.gif"></P>
<P>Figure 5.18    Terra Flora order desk file displayed by Internet Explorer</P>
<P CLASS="t">When a user clicks the <B>Place Order</B> button, the data is processed by using the .idc file shown in Figure 5.19.</P>
<P CLASS="spacing"><BR></P>
Datasource: OrderDB
Template: Order.htx
SQLStatement:
+INSERT INTO "OrderDB" ("FirstName", "LastName", "Email", "PhoneNumber", "CreditCardNumber",<BR>+"Address1", "Address2", "City", "State", "Country", "ProductId1", "ProductId2", <BR>+"ProductId3", "Comment", "DeliveryDate")
+VALUES ('%FirstName%', '%LastName%', '%Email%', '%PhoneNumber%', '%CreditCardNumber%', <BR>+'%Address1%', '%Address2%', '%City%', '%State%', '%Country%', '%ProductId1%', '%ProductId2%', <BR>+'%ProductId3%', '%Comment%', '%DeliveryDate%');
#IDC-Insert FrontHTM-default.htm ReportHTX-Order.htx

<P>Figure 5.19    Sample .idc file for Terra Flora order desk</P>
<P CLASS="t">The .idc file then posts the information to the database and results are formatted by using the .htx file specified in the .idc file, Order.idc, as shown in Figure 5.20.</P>
<P CLASS="spacing"><BR></P>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Submitted Order&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY BGCOLOR="#FFFFFF"&gt;
&lt;P&gt;
&lt;B&gt;Verify this posted information with the customer.&lt;BR&gt;
&lt;/B&gt;
&lt;P&gt;
&lt;TABLE BORDER=2 BORDER BGCOLOR="#FFFFFF"&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;FirstName&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.FIRSTNAME%&gt;
&lt;/TD&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;Address1&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.ADDRESS1%&gt;
&lt;/TD&gt;&lt;/TR&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;LastName&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.LASTNAME%&gt;
&lt;/TD&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;Address2&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.ADDRESS2%&gt;
&lt;/TD&gt;&lt;/TR&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;ProductId1&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.PRODUCTID1%&gt;
&lt;/TD&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;City&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.CITY%&gt;&lt;/TD&gt;&lt;/TR&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;ProductId2&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.PRODUCTID2%&gt;
&lt;/TD&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;State&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.STATE%&gt;&lt;/TD&gt;
&lt;/TR&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;ProductId3&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.PRODUCTID3%&gt;
&lt;/TD&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;Country&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.COUNTRY%&gt;
&lt;/TD&gt;&lt;/TR&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;Comment&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.COMMENT%&gt;&lt;/TD&gt;&lt;TD <BR>ALIGN="RIGHT"&gt;&lt;B&gt;PhoneNumber&lt;/B&gt;
&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.PHONENUMBER%&gt;&lt;/TD&gt;&lt;/TR&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;DeliveryDate&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.DELIVERYDATE%&gt;
&lt;/TD&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;Email&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.EMAIL%&gt;&lt;/TD&gt;
&lt;/TR&gt;

&lt;TR&gt;&lt;TD ALIGN="RIGHT"&gt;&lt;B&gt;CreditCardNumber&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%IDC.CREDITCARDNUMBER%&gt;
&lt;/TD&gt;&lt;TD&gt;&lt;/TD&gt;&lt;TD&gt;&lt;/TD&gt;&lt;/TR&gt;

&lt;/TABLE&gt;

&lt;P&gt;

&lt;P&gt;
&lt;A HREF="/default.htm"&gt;Return To Data Entry Page&lt;/A&gt;
&lt;P&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

<P>Figure 5.20    Sample .htx file for Terra Flora order desk</P>
<P CLASS="t">The process is complete when the database returns confirmation through the .htx file, as shown in Figure 5.21.</P>
<P><img src="xig_d17.gif"></P>
<P>Figure 5.21    Terra Flora order desk confirmation .htx file in Internet Explorer</P></BODY></HTML>
