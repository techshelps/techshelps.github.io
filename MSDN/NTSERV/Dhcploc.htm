<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dhcploc.exe</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h1>Dhcploc.exe</h1>
<h1>Windows&nbsp;NT® Resource Kits</h1>
<h3>Contents</h3>
<p>
Introduction</p>
<p>
Command-line syntax</p>
<p>
Examples</p>
<h2>Introduction</h2>
<p>
You can use the Dhcploc utility to detect unauthorized DHCP servers on a subnet. It displays the DHCP servers that are active on the subnet, and beeps and sends alert messages when it detects unauthorized DHCP servers.</p>
<h2>Command-line syntax</h2>
<p>
<b>dhcploc</b> [<b>-p</b>] [<b>-a:</b><i>"list_of_alertnames"</i>] [<b>-i:</b><i>alertinterval</i>] <i>computer_IP_address</i> [<i>IP addresses of valid DHCP servers</i>]</p>
<p>
where</p>
<p>
<b>ParameterMeaning</b></p>
<p>
<i>computer_IP_addres</i>The IP address of the computer on which you are running the</p>
<p>
utility. If the computer has multiple network adapters</p>
<p>
installed, you need to select an adapter (and the corresponding</p>
<p>
IP address) that is connected to the subnet under test.</p>
<p>
<i>IP addresses of valid </i>Specify any number of IP addresses corresponding to</p>
<p>
<i>DHCP servers</i>authorized DHCP servers. The Dhcploc utility does not</p>
<p>
respond to packets sent from these servers. However, if you do</p>
<p>
not include the <b>-p</b> option, it will display the packets it sees</p>
<p>
from these servers.</p>
<p>
<b>-p</b>Disables display of packets sent from authorized DHCP</p>
<p>
servers.</p>
<p>
<b>-a:</b><i>"list_of_alertnames"</i>Sends alert messages to the names specified in</p>
<p>
<i>list_of_alertnames</i>. Separate multiple names with a space in</p>
<p>
the list, and include the quotation marks to prevent Dhcploc</p>
<p>
from confusing the names with IP addresses.</p>
<p>
<b>-i:</b><i>alertinterval</i>Specifies the alert frequency in seconds.</p>
<h2>Examples</h2>
<p>
Output produced by the Dhcploc utility has the following format:</p>
<p>
<i>time</i> (IP)<i>computer_IP_address packet_type</i> (S)<i>server_IP_address</i> [***]</p>
<p>
***Indicates an unauthorized server.</p>
17:34:58 (IP)0.0.0.0        NACK      (S)11.11.31.84         ***
17:36:38 (IP)11.101.190.130 OFFER     (S)11.101.12.226       ***
17:36:38 (IP)11.101.196.231 ACK       (S)11.101.13.53
17:36:53 (IP)11.101.196.231 ACK       (S)11.101.13.53
17:37:05 (IP)11.101.196.234 OFFER     (S)11.101.13.53
17:37:05 (IP)11.101.193.232 OFFER     (S)11.101.12.198
17:37:06 (IP)11.101.190.132 OFFER     (S)11.101.12.226       ***
</code>

</FONT>
</BODY>
</HTML>
