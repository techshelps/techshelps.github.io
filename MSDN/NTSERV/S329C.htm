<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Windows 95 for Windows 95 Clients</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Installing Windows&nbsp;95 for Windows&nbsp;95 Clients</H3><P CLASS="t">To support Windows&nbsp;95 remoteboot clients, you must install Server-Based Setup (SBS) on a server, install the first Windows&nbsp;95 client, and then install subsequent clients.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Installing SBS for Windows&nbsp;95 Clients</H4><P CLASS="t">For greater technical detail about SBS servers, see the <I>Microsoft Windows&nbsp;95 Resource Kit</I>. When you set up an SBS server, you can use the server for remoteboot and for other purposes described in the <I>Microsoft Windows&nbsp;95 Resource Kit</I>.</P>
<P CLASS="t">You will need a Windows&nbsp;95 installation compact disc (not floppies) and a Windows&nbsp;95 client computer.</P>
<P CLASS="t"><B>To install an SBS server</B></P>
<P>    1.    On the server that will contain SBS files, create a shared directory with 90 MB of space available. The shared directory can have any name.</P>
<P>As you share the directory, assign read-only permission for regular users and full access for administrators. For example, use Server Manager to focus on the shared directory and set read-only permission for the Users group and full permission for the Administrators group. In <B>File Manager</B>, click <B>Share As</B> on the <B>Disk</B> menu, not <B>Permissions</B> on the <B>Security</B> menu.</P>
<P>    2.    Install one regular Windows&nbsp;95 client on the network or use an existing one. </P>
<P>You will use this client to configure the SBS server.</P>
<P>    3.    Log on to the Windows&nbsp;95 client using an account that has write access to the shared directory on the SBS server.</P>
<P>    4.    Put the Windows&nbsp;95 compact disc in the client's CD-ROM drive. In Windows&nbsp;Explorer, switch to the Admin\Nettools\Netsetup directory.</P>
<P>    5.    Double-click <B>Netsetup.exe</B>. </P>
<P>Note that you must run Netsetup.exe at a Windows&nbsp;95 client. It will encounter errors on a computer running Windows&nbsp;NT.</P>
<P>    6.    In the <B>Server-Based Setup</B> dialog box, click <B>Set Path</B>, and specify the path to the SBS server; then click <B>OK</B>.</P>
<P>You can type a drive letter for a mapped drive, a network name for a server (for example, \\server1\sharedir), or a network path to a specific directory (for example, \\server1\sharedir\rpl\win95).</P>
<P>The button name becomes <B>Change Path</B> if a server was defined previously.</P>
<P>    7.    Click <B>Install</B>.</P>
<P>Server-Based Setup presents a series of dialog boxes so that you can complete these actions:</P>
<UL><LI>Specify an "install policy" for how users can install Windows&nbsp;95 from the server. If you support only remoteboot clients, click <B>Server</B>. If you support other SBS functions as well, click <B>User's choice</B>. Do not click <B>Local hard drive</B>.</LI><LI>Set the source path for Windows&nbsp;95 files. </LI></UL><P>This is the path to the compact disc on the client.</P>
<UL><LI>If asked, specify that you do <I>not</I> want to create a default setup script.</LI></UL><P>Setup scripts for Windows&nbsp;NT remoteboot installation require special settings.</P>
<UL><LI>Provide a CD Key number for product identification.</LI></UL><P>Server-Based Setup copies Windows&nbsp;95 files to the SBS shared directory.</P>
<P>    8.    At the remoteboot server, put the compact disc or floppy disk containing the Windows&nbsp;NT remoteboot for Windows&nbsp;95 files into a drive. Change to the drive and then change to the Update\Win95 directory. Run <B>win95srv.bat</B> to update the Windows&nbsp;95 files for remotebooting. For example:</P>
<P CLASS="spacing"><BR></P>
d:
cd \update\win95
win95srv.bat <I>&lt;dest&gt;</I>
<P>where <I>&lt;dest&gt;</I> is the shared directory on the SBS server.</P>
<P>    9.    If you are updating from version 3.51 or earlier of the Remoteboot service, start the Remoteboot service at the remoteboot server if it is not already started. Then, run the <B>rbootsrv.bat</B> program to update the remoteboot files and database for Windows&nbsp;95 remotebooting. At the server's command prompt, type:</P>
<P CLASS="spacing"><BR></P>
d:
cd \update\win95
rbootsrv.bat  &lt;<I>SBS_path&gt;  &lt;RPL_path&gt;  </I>[<I>\\servername</I>]
<P>where: </P>
<UL><LI><I>&lt;SBS_path&gt;</I> is the path to the installed SBS server's Windows&nbsp;95 files.</LI><LI><I>&lt;RPL_path&gt;</I> is the path to the remoteboot directory.</LI><LI><I>\\servername</I> is the name of the remoteboot server ; you can omit this if you are typing at the remoteboot server.</LI></UL><P>    10.    At the remoteboot server, start Remoteboot Manager.</P>
<P>    11.    On the <B>Configure</B> menu, click <B>Check Configurations</B> to activate the new configurations.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Installing the First Windows&nbsp;95 Client</H4><P CLASS="t">Installing the first Windows&nbsp;95 client requires booting that client first to MS-DOS 6.2<I>x,</I> running Windows&nbsp;95 Setup on the client, and then copying selected files from the client's machine directory to the remoteboot server. Once you have installed this first client, you can easily install subsequent clients by using SBS to make a modified copy of the original machine directory without having to run Windows&nbsp;95 Setup again.</P>
<P CLASS="t">Each remoteboot client has a "machine directory," a directory on a server that contains client-specific configuration information and data. For example, the machine directory contains the following:</P>
<UL><LI>Appropriate initialization and configuration files (including Win.ini and System.ini)</LI><LI>System.dat and User.dat (the Registry)</LI><LI>Files that define the Desktop, <B>Start</B> menu directories, and other programs</LI><LI>The spool directory for printing</LI><LI>The swap file and Temp directory</LI></UL><P CLASS="t">Machine directories can reside on the remoteboot server, on the SBS server, or on any designated server on the network. You may want to spread the load of machine directories across servers. The only qualifications for a machine directory server are sufficient disk space and running the NetBEUI protocol. To create a location for machine directories, simply make a shared directory on a server and share it with a name that does not contain spaces. For example, on a computer running Windows&nbsp;NT Server that will contain machine directories, type:</P>
<P CLASS="spacing"><BR></P>
mkdir c:\rplmachines
net share machines=c:\rplmachines
<P CLASS="t"><B>Note</B></P>
<P>The machine directories may not be subdirectories of the SBS directory.</P>
<P CLASS="t">Assign permissions to a machine directory so that only the users or administrators who will use the client have read and write permissions in the directory. If the machine directory is on an NTFS partition, assign permissions directly to the machine directories. If the machine directory is on a FAT partition, assign permissions to the shared directory containing the machine directories.</P>
<P CLASS="t"><B>To install the first Windows&nbsp;95 client</B></P>
<P>    1.    Boot the new client to MS-DOS 6.2<I>x</I>, using procedures in "Adding a New Client" earlier in this chapter.</P>
<P>You will need to run Windows&nbsp;95 Setup while the client is booted from the Remoteboot service rather than when the client is booted from a floppy disk or hard drive.</P>
<P>    2.    Use the <B>net logon</B> command to log on using an account that has read access to the SBS server and write access to the shared directory that will contain this client's machine directory.</P>
<P>A good example is the account of someone who will use this client because they will need this access anyway.</P>
<P>    3.    Synchronize the time and date settings of the client, the SBS server, and the remoteboot server. Differing settings can interfere with Windows&nbsp;95 Setup.</P>
<P>    4.    Use the <B>net use</B> command to map drive letters to the SBS server and machine directory location, and then determine the highest drive letter in use on the computer.</P>
<P>C: is a virtual hard drive mapped to parts of the remoteboot server. Each local hard drive partition (if any) takes another drive letter after C: (for example, D: and E: for two partitions). One more drive letter is reserved for use as a RAM drive during the Windows&nbsp;95 boot process. Drive letters after that are available for use.</P>
<P>For example, if you have a local hard drive with one partition, C: will be mapped to the remoteboot server, D: will be the local hard drive, E: is reserved for use as a RAM drive, and F: and higher are available for use. You would type:</P>
<P CLASS="spacing"><BR></P>
net use f: \\sbs_server\win95_share
net use g: \\mach_server\mach_share
<P>    5.    Change to the drive letter mapped to the SBS directory.</P>
<P>    6.    Run the Windows&nbsp;95 Setup program by typing:</P>
<P CLASS="spacing"><BR></P>
setup  /t:<I>temppath</I>

<P>where <B>/t:</B> is required and <I>temppath</I> is a path to a directory in which to store temporary files during installation. For example, if G: is mapped to the shared directory containing the client's machine directory, you could type:</P>
<P CLASS="spacing"><BR></P>
setup  /t:g:\client1.tmp
<P>to store temporary files on that server.</P>
<P>Do not delete the t:\<I>temppath</I> directory until you have completed Step 12. Also, if you are installing two Window&nbsp;95 clients simultaneously (for example, to support clients with different network adapters), choose separate temporary directories for each client.</P>
<P>Make the following decisions during setup:</P>
<UL><LI>In the <B>Server-based Setup</B> dialog box, click <B>Set up Windows to run from a network server</B> if asked.</LI><LI>In the <B>Startup Method</B> dialog box, click <B>Start Windows from the network (remote boot server)</B>.</LI><LI>In the <B>Machine Directory</B> dialog box, when asked where to install Windows&nbsp;95, type the path of the machine directory (using the drive letter specified in Step 4, for example, <B>g:\client1</B>).</LI><LI>In the <B>Setup Options</B> dialog box, click <B>Custom</B> setup.</LI><LI>In the <B>Analyzing Your Computer</B> dialog box, click <B>No, I want to modify the hardware list</B>.<B> </B></LI></UL><P>Exclude as many hardware types and items from autodetection as possible. If autodetection crashes, run Setup again and exclude more items from autodetection. One problem could be that your network adapter is on IRQ2 or IRQ3; this conflicts with serial port detection with some network adapters.</P>
<UL><LI>In the <B>Select Components</B> dialog box, click to clear the <B>Communications</B> check box (unless the client has a modem and you intend to use dial-up networking).</LI><LI>In the <B>Network Configuration</B> dialog box, check that your network adapter and desired protocols are present and configured correctly.</LI></UL><P>If there are no network adapters shown, you must add and configure your network adapter.</P>
<P>If you add your network adapter, you must confirm the resource settings for the adapter. Select the adapter name in the <B>Network Configuration</B> dialog box, click <B>Properties</B>, and then click the <B>Resources</B> tab. Check that the settings displayed are correct (for example, the interrupt level). Then, click <B>OK</B> to force the Setup program to accept the settings; do not click <B>Cancel</B>.</P>
<P>For details about protocols on Windows&nbsp;95 remoteboot clients, see "Supporting Multiple Network Adapters and Protocols" later in this chapter.</P>
<UL><LI>In the <B>Identification</B> dialog box, make sure that the workgroup for this client is the same as the workgroup or domain of the SBS server and machine directory server.</LI></UL><P>When the Windows&nbsp;95 Setup program is done, reboot the client. The client will not yet boot to Windows&nbsp;95; however, you must complete more steps first.</P>
<P>    7.    At the remoteboot server (or a client running Remoteboot Manager focused on the remoteboot server), start Remoteboot Manager.</P>
<P>    8.    Create a profile for the Windows&nbsp;95 client. In <B>Configuration</B>, click the Windows&nbsp;95 configuration corresponding to the client's network adapter type.</P>
<P>If you are not sure which configuration to choose, check the profile that is currently associated with this client for booting MS-DOS and use the equivalent Windows&nbsp;95 profile.</P>
<P>    9.    Edit the client's workstation record to assign the client to the Windows&nbsp;95 profile.</P>
<P>    10.    At the remoteboot server (or a client with write access to the remoteboot server's Rpl directory), run the Rpl\Bin\Win95clt.bat program by typing:</P>
<P CLASS="spacing"><BR></P>
cd &lt;systemroot&gt;\rpl\bin
win95clt  <I>mach_directory  \\rpl_server  profile_name</I>
<P>where:</P>
<UL><LI><I>mach_directory</I> is the path to the client's machine directory.</LI><LI>\\<I>rpl_server</I> is the name of the remoteboot server.</LI><LI><I>profile_name</I> is the name of the Windows&nbsp;95 profile associated with the client.</LI></UL><P>For example, you could type:</P>
<P CLASS="spacing"><BR></P>
cd \winnt\rpl\bin
win95clt  \\mach_server\mach_share\client1  \\rpl_server  win95elnk2
<P>The Win95clt program copies client-specific Windows&nbsp;95 real-mode (also identified as MS-DOS 7.0) boot files from the client's machine directory to the Rpl\Rplfiles\Profiles\<I>&lt;profile_name&gt;</I> directory on the remoteboot server.</P>
<P>    11.    At the SBS server (or a client with write access to the SBS directory), edit the Machines.ini file in the SBS directory and add the following lines for the new client:</P>
<P CLASS="spacing"><BR></P>
[<I>adapter id</I>]
SYSDATPATH=<I>g:\machine_dir</I>
<I>g=\\mach_server\mach_share</I>
<P>where:</P>
<UL><LI><I>adapter id</I> is the network adapter ID, specified in the remoteboot workstation record for this client.</LI><LI><I>g:\machine_dir</I> is the location of the client's machine directory on a server; <I>g</I> is the drive letter assigned on the next line to the shared directory where the client's machine directory is located.</LI><LI><I>g=\\mach_server\mach_share</I> identifies the drive letter assigned to the shared directory where the machine directory resides. You must use the same drive letter and share name established in Step 4.</LI></UL><P>For example, you might add the following lines to Machines.ini:</P>
<P CLASS="spacing"><BR></P>
[02608C8EAA2D]
SYSDATPATH=g:\client1
g=\\mach_server\mach_share
<P>Reboot the Windows&nbsp;95 client.</P>
<P>The client will now boot to Windows&nbsp;95 and complete the Windows&nbsp;95 Setup program.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Installing Subsequent Windows&nbsp;95 Clients</H4><P CLASS="t">Once you have installed a single client, subsequent clients of the same type will be much easier to install. These subsequent clients do not have to be exactly the same as the first, but they must use the same type of network adapter and the same adapter settings (IRQ, I/O address, etc.).</P>
<P CLASS="t">If you need to install a Windows&nbsp;95 client that does have different configuration settings, you must treat the installation as a fresh installation; see "Installing the First Windows&nbsp;95 Client" earlier in this section.</P>
<P CLASS="t"><B>To install subsequent Windows&nbsp;95 clients</B></P>
<P>    1.    Boot the new client to MS-DOS 6.2<I>x</I>, using procedures in "Adding a New Client" earlier in this chapter.</P>
<P>    2.    Log on to a regular Windows&nbsp;95 client (for example, the one you used to run <B>netsetup</B> when you established the SBS server).</P>
<P>Use an account that has write access to the shared directory on the SBS server and to the shared directory containing machine directories.</P>
<P>    3.    Put the Windows&nbsp;95 compact disc in the client's CD-ROM drive. In Windows&nbsp;Explorer, switch to the Admin\Nettools\Netsetup directory.</P>
<P>    4.    Double-click <B>Netsetup.exe</B>. </P>
<P>    5.    In the <B>Server-Based Setup</B> dialog box, click <B>Set Path</B>, and specify the path to the SBS server; then click <B>OK</B>.</P>
<P>You can type a drive letter for a mapped drive, a network name for a server (for example, \\server1\sharedir), or a network path to a specific directory (for example, \\server1\sharedir\rpl\win95).</P>
<P>The button name becomes <B>Change Path</B> if a server was defined previously.</P>
<P>    6.    Click <B>Add</B>.</P>
<P>    7.    In the <B>Set Up Machine</B> dialog box, click <B>Set Up One Machine</B> and then type the following information:</P>
<UL><LI>Computer name: type a computer name of the client (you must create a unique name).</LI><LI>Path to machine directory: type a network pathname for the machine directory you want to create for the client.</LI><LI>Existing machine directory: type the network pathname for an existing machine directory of a client similar to this one.</LI></UL><P>For example, you might type the following values:</P>
<UL><LI>Computer name: client2</LI><LI>Path to machine directory: \\mach_server\mach_share\client2</LI><LI>Existing machine directory: \\mach_server\mach_share\client1</LI></UL><P>    8.    Click <B>OK</B>.</P>
<P>You may see an error message about creating the machine directory. Check that the directory was created and that it contains several files; if so, then disregard the error message.</P>
<P>    9.    At the remoteboot server (or a client running Remoteboot Manager focused on the remoteboot server), start Remoteboot Manager.</P>
<P>    10.    Edit the client's workstation record to assign the client to the same Windows&nbsp;95 profile as the first client.</P>
<P>    11.    Edit the Machines.ini file in the SBS directory. Add the following lines for the new client:</P>
<P CLASS="spacing"><BR></P>
[<I>adapter id</I>]
SYSDATPATH=<I>g:\machine_dir</I>
<I>g=\\mach_server\mach_share</I>
<P>where:</P>
<UL><LI><I>adapter id</I> is the network adapter ID, specified in the remoteboot workstation record for this client.</LI><LI><I>g:\machine_dir</I> is the location of the client's machine directory on a server; <I>g</I> is the drive letter assigned on the next line to the shared directory where the machine directory is located. </LI><LI><I>g=\\mach_server\mach_share</I> assigns a drive letter to the shared directory where the machine directory resides. Use the same drive letter used by the original Windows&nbsp;95 remoteboot client.</LI></UL><P>For example, you might add the following lines to Machines.ini:</P>
<P CLASS="spacing"><BR></P>
[02608C8EAA2E]
SYSDATPATH=g:\client2
g=\\mach_server\mach_share
<P>    12.    Reboot the Windows&nbsp;95 client.</P>
<P>The client will now boot to Windows&nbsp;95 and complete the Windows&nbsp;95 Setup program.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>What You See on a Windows&nbsp;95 Client</H4><P CLASS="t">When you boot the client, a remoteboot logon prompt appears:</P>
<P CLASS="spacing"><BR></P>
Type Remoteboot username, or press enter if it is &lt;workstation&gt;:
<P CLASS="t">This asks for the account name and password associated with the client computer itself, not for your own user account name and password.</P>
<P CLASS="t">Windows&nbsp;95 then prompts you twice for your username and password: once from a command prompt and again in a dialog box. At both of these prompts, enter your user account name and password.</P>
<P CLASS="t">Once Windows&nbsp;95 has started, the C: drive is unassigned; it was assigned during the remoteboot process and is no longer needed. Each local hard drive partition takes another drive letter after C: (for example, D: and E: for two partitions). One more drive letter was used as a RAM drive during the Windows&nbsp;95 boot process; you can now use it as a RAM drive for your own purposes. Two more drive letters, usually the next two drive letters in sequence, are mapped to the SBS server and to the shared directory containing the client's machine directory. When setting up the client, you choose exactly which two drive letters to map and they will always be the same for this client. Do not unmap or remap these drives elsewhere.</P>
<P CLASS="t">For example, if you have a local hard drive with one partition, C: is unmapped, D: is the local hard drive, E: is a RAM drive, F: is mapped to the SBS server, and G: is mapped to the shared directory containing the client's machine directory. </P></BODY></HTML>
