<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Local Print Provider (Localspl.dll)</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Local Print Provider (Localspl.dll)</H3><P CLASS="t">The <I>local print provider</I> writes the print job contents to a spool (.spl) file and tracks administrative information (such as user name, document name, and data type) in a shadow (.shd) file. By default, both files are written to <I>%systemroot%</I>\SYSTEM32\SPOOL\PRINTERS.</P>
<P CLASS="t">If, however, the hard drive partition containing Windows&nbsp;NT Server doesn't have sufficient disk space to accommodate the spool files, you can change the location of spool files by changing the server properties.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>To change the location of spool files</H4><P>    1.    Create a new spool file directory.</P>
<P>    2.    Click Start, and then point to Settings.</P>
<P>    3.    Click <B>Printers</B>.</P>
<P>    4.    Click <B>Server Properties</B> on the <B>File</B> menu.</P>
<P>    5.    Click the Advanced tab.</P>
<P>    6.    In the Spool Folder box, type the path for the new spool file directory.</P>
<P>    7.    Click OK.</P>
<P CLASS="nt"><B>Note</B>  You must create a directory for the new spool file location. If you attempt to spool directly to the root (C:\ or D:\, for example) the spool file will revert to the default spool directory.</P>
<P CLASS="t">Spooling a print job to a file protects the print job by saving it on disk. Should the print server suffer a power failure or other serious event before printing all jobs in the queue, the spool and shadow files on the server's hard disk preserve each job and prevent any loss of data once processing resumes.</P>
<P CLASS="t">By default, spool and shadow files are deleted after the job prints. However, you can enable spooler event logging to get valuable information about printer traffic, hard disk space, and other printing maintenance issues. </P>
<H4 CLASS="h4"><A NAME="sec1"></A>To enable spooler event logging</H4><P>    1.    In the Printers folder, click the printer to select it.</P>
<P>    2.    Click <B>Server Properties</B> on the <B>File</B> menu.</P>
<P>    3.    Click the Advanced tab.</P>
<P>    4.    Click Enable spooler event logging to add a check mark.</P>
<P>    5.    Click <B>OK</B>.</P>
<P CLASS="t">Next, LOCALSPL polls the installed print processors (such as Winprint.dll and Sfmpsprt.dll) to see if one of them recognizes the job's data type set. If the data type is not set, the Winprint.dll print processor receives the job and uses the default data-type set <B>Print Processor</B> dialog box on the print server.</P>
<P CLASS="t">You can set a new default location or override the default location on a printer-by-printer basis by manually editing the Registry. However, before doing so, read the "Spool File Security" section later in this chapter. </P>
<H4 CLASS="h3"><A NAME="sec2"></A>Enhanced Metafile (EMF) Spool Files</H4><P CLASS="t"><I>Enhanced metafiles</I> (EMF) are one type of spool file used by the default Windows&nbsp;NT print spooler. EMF spool files reduce the time between the initiation of a print request and when control is returned back to the operating system. This is done by storing only the GDI function calls that produce the graphic object the application wants printed. The much more time-consuming execution of function calls can then be carried out later, in the background, when the spool file is "played back."</P>
<P CLASS="t">The way EMF spool files are encoded also provides the advantage of printer device-independence. In other words, a picture measuring 2 inches by 4 inches on a VGA display and stored in an EMF maintains those original dimensions whether it is printed on a 300 dpi laser printer or on a 75 dpi dot matrix printer.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>RAW Spool Files</H4><P CLASS="t">If the print job's data type is RAW, the spool file's data type is RAW. These files are device-dependent. The spooled data is destined and formatted for a particular device and does not need to be printable on a different device. An example of a RAW spool file is an encapsulated PostScript (EPS) file, which is formatted to be understood by the PostScript printer for which it is destined, but which is just RAW data to the Windows&nbsp;NT spooler.</P></BODY></HTML>
