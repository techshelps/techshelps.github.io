<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Application and Script Problems</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Application and Script Problems</H3><H4 CLASS="h3"><A NAME="sec0"></A>Testing CGI Scripts</H4><P CLASS="t">You can use a Perl script to test for the proper installation and execution of Common Gateway Interface (CGI) scripts with Internet Information Server.</P>
<P CLASS="t">Use a text editor to create a file with the following lines of code. Save the file in the /Scripts directory as Hello.pl.</P>
<P CLASS="spacing"><BR></P>
print "Content-Type: text/html\n\n";<BR>print "&lt;HTML&gt;\n";<BR>print "&lt;HEAD&gt;\n";<BR>print "&lt;TITLE&gt;Hello World&lt;/TITLE&gt;\n";<BR>print "&lt;/HEAD&gt;\n";<BR>print "&lt;BODY&gt;\n";<BR>print "&lt;H4&gt;Hello World&lt;/H4&gt;\n";<BR>print "&lt;P&gt;\n";<BR>print "Your IP Address is $ENV{REMOTE_ADDR}.\n";<BR>print "&lt;P&gt;";<BR>print "&lt;H5&gt;Have a nice day&lt;/H5&gt;\n";<BR>print "&lt;/BODY&gt;\n";<BR>print "&lt;/HTML&gt;\n";<BR>
<P CLASS="t">After you create the file, configure Perl to run securely with Internet Information Server. Do not locate Perl.exe in any directory accessible by a user. Create a script mapping in the Registry for Perl.exe to enable the script to run by using Perl.</P>
<H5 CLASS="h4"><A NAME="sec1"></A>To configure script mapping for Perl</H5><P>    1.    Click the <B>Start</B> button, then point to <B>Run</B>. In the <B>Open</B> box, type <B>regedt32.exe</B> and then click <B>OK</B>.</P>
<P>    2.    Click the HKEY_LOCAL_MACHINE window and locate the following key:</P>
<P>\System<BR>    \CurrentControlSet<BR>        \Services<BR>            \W3SVC<BR>                \Parameters<BR>                     \ScriptMap</P>
<P></P>
<P>    3.    From the <B>Edit</B> menu, click <B>Add Value</B>. </P>
<P>    4.    In the <B>Add Value</B> dialog box, enter the value name <B>.pl</B> with the data type <B>REG_SZ</B>. </P>
<P>    5.    In the <B>String Editor</B> dialog box type the string value </P>
<P><I>full path</I>\<B>perl.exe %s</B> </P>
<P>and click <B>OK</B>. <BR>This instructs Internet Information Server to interpret all files with the extension .pl by using Perl.exe.</P>
<P>    6.    To implement these changes, quit the Registry Editor, then stop and restart the WWW service.</P>
<P>    7.    Test the Perl script with your browser. For example, in Internet Explorer, type</P>
<P>http://<I>Servername</I>/scripts/helloworld.pl?</P>
<P></P>
<H4 CLASS="h3"><A NAME="sec2"></A>Programs Attempt to Download to Client Computers</H4><P CLASS="t">When you attempt to run a script on a client Web browser, an <B>Unhandled File Type</B> dialog box might appear. It requests that you save the file as a different filename or in a different location (<B>Save As</B>).</P>
<P CLASS="t">The problem is that the /Scripts directory has both Read and Execute access permissions set in Internet Service Manager. To work around this problem, do one of the following:</P>
<UL><LI>Change the access permissions in Internet Service Manager to Execute only.</LI><LI>Add a question mark (<B>?</B>) to the end of the URL. For example, </LI></UL><P><B>http://myserver/scripts/test.exe?</B></P>
<P></P>
<H4 CLASS="h3"><A NAME="sec3"></A>Programs from 16-bit Compilers Fail to Run</H4><P CLASS="t">A CGI script compiled with a 16-bit C compiler might fail to run on Internet Information Server.</P>
<P CLASS="t">For example, say you use a 16-bit compiler to compile and build an executable file out of this C language source code: </P>
<P CLASS="spacing"><BR></P>
#include &lt;stdio.h&gt;<BR>void main()|<BR>{<BR>   printf( "Content-type: text/html\n\n" );<BR>   printf( "&lt;BODY BGCOLOR=\"#FFFFF0\" TEXT=\"#0000FF\"&gt;" );<BR>   printf( "&lt;TITLE&gt;This is a Test page&lt;/TITLE&gt;" );<BR>   printf( "&lt;h2&gt;Hello World.&lt;/h2&gt;&lt;br&gt;" );<BR>   printf( "&lt;h1&gt;&lt;center&gt;End of the test page.&lt;/center&gt;&lt;/h1&gt;" );<BR>   printf( "&lt;/BODY&gt;\n" );<BR>}<BR>
<P CLASS="t">If you then run the .exe file from the command prompt of Windows&nbsp;NT, the correct HTML output is generated. However, the results will be different if you place the same executable file in the /Scripts directory of the computer running Internet Information Server. If you try to run it from a Web browser by using the syntax. </P>
<P CLASS="t"><B>http://</B><I>Server</I>/<I>Path</I>/<I>File.exe</I><B>?</B></P>
<P CLASS="t">it fails to generate the correct page.</P>
<P CLASS="t">To correct this problem, use a 32-bit C compiler to compile and build the C language source code. Microsoft C/C++ 4.0 and C/C++ 2.0 are 32-bit C compilers.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>REMOTE_USER Variable Is Blank</H4><P CLASS="t">Microsoft Internet Information Server does not return a user name for the variable REMOTE_USER unless both of the following are true:</P>
<UL><LI>Basic (clear-text) password authentication is used.</LI><LI>Anonymous access is not allowed. (That is, you clear the <B>Allow Anonymous</B> box on the <B>WWW Service</B> property sheet.) </LI></UL><P></P>
<P CLASS="t">If you use anonymous authentication, all users are authenticated with the IUSR_<I>computername</I> account, and the variable is not assigned a value by default.</P>
<P CLASS="t">One method of obtaining the REMOTE_USER variable is to create a batch file with the following lines and save it in the /Scripts directory, or a directory enabled in Internet Information Server for execute permissions: </P>
<P CLASS="spacing"><BR></P>
@echo off<BR>echo Content-Type: text/plain<BR>echo.<BR>Set<BR>
<P CLASS="t">This batch file lists the environment variables used by Internet Information Server, including the REMOTE_USER variable. The list is returned as an HTML page to the Web browser that started the batch file.</P>
<P CLASS="t">Make sure you have configured script mapping for .bat or .cmd files, as described in the <I>Internet Information Server Installation and Administration Guide</I>.</P>
<P CLASS="t">You run the script from a browser by typing a URL with the syntax</P>
<P CLASS="t"><B>http://</B><I>Server_Name</I> /<I>Script</I></P>
<P CLASS="t">For example, you might type </P>
<P CLASS="t"><B>http://www.company.com/scripts/environment.cmd? </B></P>
<P CLASS="t">The question mark at the end of the URL is required. The question mark signals the server that this is a GET request, which makes the server return script results rather than downloading the file to the user.</P>
<H4 CLASS="h3"><A NAME="sec5"></A>CGI Scripts Return Error</H4><P CLASS="t">When submitting an HTML form or clicking a link to a script from a Web browser, the following message might be returned:</P>
<P CLASS="spacing"><BR></P>
   CGI Error<BR>   The specified CGI application misbehaved by not returning a complete<BR>   set of HTTP headers. The headers it did return are:<BR>   Can't open perl script "c:\inetsrv\wwwroot\scripts\test.pl":<BR>   No such file or directory<BR>
<P CLASS="t">This error is caused by missing or incorrect CGI header information. In this case, the headers are missing because the script file cannot be run. Therefore, the message was displayed instead of the output from the script.</P>
<P CLASS="t">The CGI specification calls for the script file to return at least one header. This header indicates how to fill out the remainder of the HTTP headers as required by that protocol. HTTP also requires a blank line between the end of the headers and the start of the document. Some servers return an error if the blank line is not present. The only headers currently supported by the CGI specification are:</P>
<UL><LI>Content-type</LI><LI>Location</LI><LI>Status</LI></UL><P></P>
<P CLASS="t">For more information about these headers, see the HTTP and CGI protocol draft specifications at <B>http://www.w3.org</B>.</P></BODY></HTML>
