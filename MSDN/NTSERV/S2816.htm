<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Remote Access to the Registry for Performance Monitor Users</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3>Remote Access to the Registry for <BR>Performance Monitor Users</H3><P CLASS="t">Performance Monitor extracts counter data from the Registry. A Performance Monitor user who monitors another computer remotely must have permission to connect to the Registry of the remote computer. </P>
<P CLASS="t">Permission to connect is set on the remote computer. Users who have permission to connect to a remote computer's Registry can do so from any computer. By default, only the administrators of a Windows NT Server are permitted to connect to its Registry from another computer. This section explains how to give other users this permission.</P>
<P CLASS="t">On computers running Windows NT 4.0 (and Windows NT 3.51 Service Pack 2), the system uses the ACL for <B>winreg</B>, an optional Registry subkey, to determine who can connect to the Registry from another computer. When a user tries to connect to the Registry remotely, the system looks for this <B>winreg</B> subkey, as described previously in the section "winreg: Connecting to the Windows NT Registry." <B>w</B><B>inreg</B> is located in the following Registry path:</P>
<P CLASS="t">HKEY_LOCAL_MACHINE\System<BR>    \CurrentControlSet<BR>        \Control<BR>            \SecurePipeServers<BR>                \winreg</P>
<P CLASS="t">When a user tries to connect to the Registry remotely, the system looks for the <B>winreg</B> subkey.</P>
<P CLASS="t">On Windows NT servers, <B>winreg</B> is included in the Registry by default. The default ACL for <B>winreg</B> gives full control to administrators, allowing them to connect to the Registry. No other users have permission by default. If the Performance Monitor user who is monitoring the server remotely is not an administrator, you must add that user to the ACL for <B>winreg</B> and then give him or her at least read/write permission.</P>
<P CLASS="t">On Windows&nbsp;NT workstations, and computers running Windows&nbsp;NT&nbsp;3.51&nbsp;Service Pack&nbsp;2, <B>winreg</B> is not included in the Registry by default. However, administrators can add <B>winreg</B> to the Registry of these computers to control remote access. If <B>winreg</B> appears in the Registry, the Performance Monitor user must be listed in the ACL for <B>winreg</B> and have at least read/write permission to <B>winreg</B>.</P>
<P> <FONT FACE="Symbol">Û</FONT>    To display the ACL for winreg</P>
<P>    1.    Start Regedt32 on the computer to be monitored.</P>
<P>    2.    Click the <B>winreg</B> subkey in the following Registry path:</P>
<P CLASS="t">HKEY_LOCAL_MACHINE\System<BR>    \CurrentControlSet<BR>        \Control<BR>            \SecurePipeServers<BR>                \winreg</P>
<P>If <B>winreg</B> does not appear in the Registry, all users can connect to the Registry remotely. In that case, you can skip both this procedure and the following one and go to the next section, "Access to the Perflib Subkeys."</P>
<P><B>    </B>3.<B>    </B>On the<B> Security</B> menu, click <B>Permissions</B>.</P>
<P>The ACL for <B>winreg</B> appears in the <B>Registry Key Permissions</B> dialog box.</P>
<P>    4.    Double-click the ACL entry for a user or user group to display its permissions.</P>
<P></P>
<P CLASS="t">Users must have at least read/write permission (that is, they must have special access permission to create subkeys and set values) to use <B>winreg</B> to monitor a computer from another computer. Full control is not required. If those people listed as Administrators for your computer have read/write permission to <B>winreg</B>, you can add a user to the list of Administrators. However, you can also give users just the permissions they need to monitor computers remotely.</P>
<P> <FONT FACE="Symbol">Û</FONT>    To give a user permission to monitor a computer remotely</P>
<P>    1.    Display the ACL for the <B>winreg</B> subkey.</P>
<P>    2.    Click the <B>Add</B> button in the <B>Registry Key Permissions</B> dialog box for <B>winreg</B>.</P>
<P>    3.    Add the user to the <B>winreg</B> ACL and give the user read access. For detailed instructions, click the <B>Help</B> button in the <B>Registry Key Permissions</B> dialog box.</P>
<P>    4.    Double-click the name of the user you just added.</P>
<P>    5.    In the <B>Special Access</B><B> </B>dialog box, select the <B>Set Value</B> and <B>Create Subkey </B>check boxes.</P>
<P>    6.    Click <B>OK</B>, and then click <B>OK</B> again to close the dialog boxes.</P>
<P></P>
<P CLASS="t">When you have set the access to <B>winreg</B>, verify that the user has at least read access to all subkeys in the path to <B>winreg</B>. (By default, the Everyone group has permission to read all <B>winreg</B> subkeys and the subkeys in its path.) To check the ACL for each subkey in the path, click <B>Permissions</B> on the <B>Security</B> menu, and then grant the user read access to any ACLs that do not otherwise permit it.</P></BODY></HTML>
