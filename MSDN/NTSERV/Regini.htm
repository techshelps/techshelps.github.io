<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Regini.exe</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h1>Regini.exe</h1>
<h1>Windows&nbsp;NT® Resource Kits</h1>
<h4>Contents</h4>
<p>
Introduction</p>
<p>
Command-line syntax</p>
<p>
Creating a Regini script file</p>
<p>
Script file syntax</p>
<p>
Line formatting</p>
<p>
Registry Key names</p>
<p>
Key name syntax</p>
<p>
Kernel and User key names</p>
<p>
ACLs</p>
<p>
Value entries</p>
<p>
Sample script files</p>
<p>
Storing a user name for automatic administrative logon</p>
<p>
Adding a value for the current user in the Exchange client subkey</p>
<p>
Setting the default user name</p>
<p>
Complex sample</p>
<h3>Introduction</h3>
<p>
Regini is a command-line utility that you can use to edit the Windows&nbsp;NT Registry. Regini runs the scripts you write that add and modify Registry subkeys and value entries.</p>
<p>
When you want to edit the Registry directly, use a Registry editor.</p>
<h4>Caution</h4>
<p>
Changing the Registry by using a Registry editor can have unforeseen effects that can prevent you from starting your computer. Whenever possible, use programs such as Control Panel or System Policy Editor to configure Windows&nbsp;NT.</p>
<p>
You can use Regini for batch implementation of corporate standards, including display, sound, and security settings. When you install new device drivers or hardware, however, use the Setup program provided for that purpose.</p>
<h2>Command-line Syntax</h2>
<p>
To run Regini, at the command prompt, type:</p>
<p>
<b>regini </b><i>ScriptFile</i><b> [</b><i>ScriptFile</i><b>...]</b></p>
<p>
where <i>ScriptFile</i> is the filename (and optionally the full path) of a script file used to modify the Windows&nbsp;NT Registry.</p>
<p>
For example:</p>
<p>
<b>regini</b> \\<b>myserver</b>\<b>public</b>\<b>myfolder</b>\<b>srv</b>.<b>ini</b></p>
<p>
runs Regini, and directs it to run a script file named Srv.ini from the shared folder \\Myserver\Public\Myfolder.</p>
<h3>Creating a Regini Script File</h3>
<h4>Script File Syntax</h4>
<p>
In a Regini script file specifying Registry changes, you must locate the subkey containing the value entry to be added or changed on the first line, followed by the intended value of that value entry on the second line, using the following format:</p>
<p>
<b>\Registry\</b><i>Key</i> [<i>ACL</i>]<i>ValueEntryName</i><b> = </b><i>DataType</i><b> </b><i>Value</i></p>
<p>
where:</p>
<p>
<i>Key</i>is the name of the key or subkey containing the value entry you</p>
<p>
wish to add or change</p>
<p>
<i>ValueEntryName</i>is the name of the value entry whose value is to be modified</p>
<p>
<i>DataType</i>is the data type used by the value entry</p>
<p>
<i>Value</i>is the intended result</p>
<p>
<i>ACL</i>is an access control list you can choose to include.</p>
<p>
The elements of this syntax are explained in more detail below.</p>
<p>
If a line contains an equal sign (=), then Regini interprets that line as specifying the value of a Registry value entry.</p>
<p>
If a line does not contain an equal sign (=), Regini interprets that line as specifying the name of a Registry key or subkey.</p>
<h4>Note</h4>
<p>
Make sure the text editor you use to create the script file inserts a carriage return at the end of each line. Missing carriage returns can cause unpredictable results.</p>
<p>
For example, a Regini script file named Srv.ini, in the shared directory \\Myserver\Public\Myfolder, contains the following text:</p>
\Registry\Machine\System\CurrentControlSet\Services\Lanmanserver
\ParametersDiskSpaceThreshhold = REG_DWORD 0x00000000
</code>
<p>
The following, typed at the command prompt, adds the <b>DiskSpaceThreshhold</b> value entry to the Registry or changes the value that is already there:</p>
<p>
<b>regini</b> \\<b>myserver</b>\<b>public</b>\<b>myfolder</b>\<b>srv</b>.<b>ini</b></p>
<h4>Note</h4>
<p>
Script files can have any extension. They must be saved in ANSI format, but are converted to Unicode when read from the disk. Currently, there is no way to specify a Unicode text file as the script file.</p>
<h4>Line Formatting</h4>
<p>
The format of the script file is line-based. If you are unable to fit all the information for a Registry subkey name or value entry on one line, use the backslash character (\) as a line-continuation character.</p>
<p>
For example:</p>
<p>
<b>123456\</b></p>
<p>
<b>1234 \</b></p>
<p>
<b>12</b></p>
<p>
is treated as single line containing:</p>
<p>
<b>1234561234 12</b></p>
<h4>Registry Key Names</h4>
<h4>Key Name Syntax</h4>
<p>
If a line does not contain an equal sign (=), then the line specifies the name of a Registry key or subkey. In a Regini script file, the subkey name consists of all text from the first non-blank character to the end of the line, including spaces, on any line that does not contain an equal sign.</p>
<p>
Leading spaces are significant. If there are no leading spaces, then the named subkey is an absolute path in the Registry.</p>
<p>
For example:</p>
<p>
\<b>Registry</b>\<b>Machine</b>\<b>Software</b></p>
<p>
&ndash; or &ndash;</p>
<p>
<i>USER</i>:<b>Control</b> <b>Panel</b></p>
<p>
In the second example, <i>USER</i>: is replaced by the full path to the root of the currently logged-on user's profile (for example, \Registry\Users\S-x-x-xxxx...).</p>
<p>
If a line in the script file does not contain an equal sign, and there are one or more spaces at the beginning of that line, then the subkey name on that line is defined in relation to the subkey preceding it in the Registry hierarchy. If the number of leading spaces is the same as in the preceding subkey, then Regini locates the subkey at the same level. If the number of leading spaces is lower, Regini locates the subkey one level higher; if the number is higher, Regini locates the subkey one level lower.</p>
<p>
For example:</p>
<p>
<b>\Registry\Machine\Software</b></p>
<p>
<b>Level1a</b></p>
<p>
<b>Level2a</b></p>
<p>
<b>Level2b</b></p>
<p>
<b>Level3a</b></p>
<p>
<b>Level1b</b></p>
<h4>Kernel and User Key Names</h4>
<p>
Note that Regini works with Kernel Registry strings. When you access the Registry in User mode to modify the HKEY_LOCAL_MACHINE, HKEY_CURRENT_USER, or HKEY_CURRENT_USER keys, the string is converted to the following in Kernel mode:</p>
<p>
HKEY_LOCAL_MACHINE is converted to \Registry\Machine.</p>
<p>
HKEY_USERS is converted to \Registry\User.</p>
<p>
HKEY_CURRENT_USER is converted to \Registry\User\<i>User_SID</i>, where <i>User_SID</i> is the current user's security identifier (SID).</p>
<h4>ACL</h4>
<p>
After the subkey name, you can optionally specify an access control list (ACL). The ACL is a list of decimal numbers separated by spaces within square brackets. The decimal numbers represent the following user rights:</p>
<p>
1.Administrator Full</p>
<p>
2.Administrator R</p>
<p>
3.Administrator RW</p>
<p>
4.Administrator RWD</p>
<p>
5.Creator Full</p>
<p>
6.Creator RW</p>
<p>
7.World Full</p>
<p>
8.World R</p>
<p>
9.World RW</p>
<p>
10.World RWD</p>
<p>
11.Power Users Full</p>
<p>
12.Power Users RW</p>
<p>
13.Power Users RWD</p>
<p>
14.System OpFull</p>
<p>
15.System OpRW</p>
<p>
16.System OpRWD</p>
<p>
17.System Full</p>
<p>
18.System RW</p>
<p>
19.System R</p>
<p>
20.Administrator RWX</p>
<h4>Value Entries</h4>
<p>
If a line in a script file contains an equal sign (=), then that line specifies a value for a Registry value entry. The text to the left of the equal sign, if any, is the name of the value entry. The text to the right of the equal sign specifies the data type and value of the value entry. Syntax for specifying a value is as follows:</p>
<p>
<i>ValueEntryName</i> = <i>DataType</i> <i>Value</i></p>
<p>
where:</p>
<p>
<i>ValueEntryName</i>is the name of the value entry.</p>
<p>
<i>DataType</i>is the data type.</p>
<p>
<i>Value</i>is the value of the entry.</p>
<p>
The value entry name consists of all characters from the first non-blank character on the line to the last non-blank character before the equal sign. The value consists of the first non-blank character after the data type to the end of the line.</p>
<p>
Eight data type keywords are supported by Regini. If none is specified, the default data type, REG_SZ, is used. The data types and the format of the values for each are:</p>
<p>
<b>Sets the Registry</b></p>
<p>
<b>Data TypeValue Datadata type toNotes</b></p>
<p>
REG_SZA stringREG_SZREG_SZ is the defaut</p>
<p>
data type.</p>
<p>
REG_EXPAND_SZA stringREG_EXPAND_SZ</p>
<p>
REG_MULTI_SZOne or moreREG_MULTI_SZ</p>
<p>
strings, each</p>
<p>
within quotes</p>
<p>
REG_MULTISZFILEA path to a fileREG_MULTI_SZThe file is opened and</p>
<p>
each quoted string is</p>
<p>
added to the value.</p>
<p>
REG_DWORDA decimalREG_DWORDUse 0x to specify a</p>
<p>
numberhexadecimal value, 0o</p>
<p>
to specify an octal </p>
<p>
value, and 0b to</p>
<p>
specify a binary value.</p>
<p>
You can use the</p>
<p>
strings <b>On</b>, <b>Yes</b>, or</p>
<p>
<b>True</b>, which are</p>
<p>
converted to</p>
<p>
0x00000001, and the</p>
<p>
strings <b>Off</b>, <b>No</b>, or</p>
<p>
<b>False</b>, which are</p>
<p>
converted to</p>
<p>
0x00000000.</p>
<p>
REG_BINARYTwo or moreREG_BINARYThe first decimal</p>
<p>
decimal numbersnumber must be the</p>
<p>
number of bytes of</p>
<p>
data that follow. The</p>
<p>
remaining numbers are</p>
<p>
converted into 32-bit</p>
<p>
numbers. The value</p>
<p>
length is always a</p>
<p>
multiple of 4 bytes.</p>
<p>
REG_BINARYFILEA path to a fileREG_BINARYThe named file is</p>
<p>
opened and its</p>
<p>
contents stored in the</p>
<p>
Registry as the value.</p>
<p>
The length of the value</p>
<p>
is the length of the file.</p>
<p>
DELETE[No value data][No data type]If this keyword is</p>
<p>
specified as the data</p>
<p>
type, the value entry</p>
<p>
name is deleted.</p>
<h3>Sample Script Files</h3>
<p>
The sample Regini script files included in this section show how to:</p>
<p>
Store a user name to use for automatic logon</p>
<p>
Add a value for the current user in the Exchange client subkey</p>
<p>
Modify several Registry keys at the same time</p>
<h4>Storing a user name for automatic administrative logon</h4>
<p>
This example shows how to use a Regini script to set a user name for an administrative account that can log on automatically to Windows&nbsp;NT.</p>
<p>
Start the computer, and press <small>ctrl+alt+del </small>to log on to Windows&nbsp;NT. In the <b>Logon Information</b> dialog box, type a user name and password. The user name you type is stored in the <b>DefaultUserName</b> value entry in the Winlogon subkey of the Registry.</p>
<p>
To ensure that the value of <b>DefaultUserName</b> never changes, create a script file containing the following text:</p>
\Registry\Machine
Software
Microsoft
Windows NT
CurrentVersion
Winlogon
DefaultUserName = REG_SZ <i>USERNAME</i>
</code>
<p>
where <code>DefaultUserName</code> is the value name, <code>REG_SZ</code> is the data type and <i><code>USERNAME</code></i> is the desired result or value.</p>
<h4>Note</h4>
<p>
To log on automatically to Windows&nbsp;NT, you must supply the password associated with the user name. The password is stored in the <b>DefaultPassword</b> value entry in the Winlogon subkey of the Registry. If no password was entered in the <b>Logon Information</b> dialog box, you do not need to supply a password in the script file.</p>
<p>
To reference the script file, create a batch file containing the following command:</p>
<p>
<b>c</b>:\<b>reskit</b>\<b>regini</b> <b>c</b>:\<i>username</i>.<b>ini</b></p>
<p>
where the name of the script file saved is <i>Username</i>.ini.</p>
<p>
To ensure that the <b>DefaultUserName</b> will not change, however many users log on, place this batch file in the <i>Systemroot</i>\Profiles\All Users\Start Menu\Programs\Startup directory.</p>
<h4>Adding a value for the current user in the Exchange client subkey</h4>
<p>
These examples show how to add a value entry for the current user in the Exchange subkey.</p>
<p>
You can change the value of Exchange client options in either HKEY_USERS or HKEY_CURRENT_USER.</p>
<p>
The following two sample scripts show how to use this information with Regini when you want to add or modify multiple Registry keys.</p>
<h4>Example 1</h4>
\registry\user\software\microsoft\exchange\client\options
    DictionaryLangId = REG_SZ 1033
    PickLogonProfile = REG_SZ 0
</code>
<h4>Example 2</h4>
\registry\user\S-1-5-21-2185238159-1414228629-1939875897-1000\software\microsoft\exchange\client\options
    DictionaryLangId = REG_SZ 1033
    PickLogonProfile = REG_SZ 0
</code>
<h4>Setting the default user name</h4>
<p>
This example shows how to use Regini to set the default user name in the <b>Logon Information </b>dialog box. This script modifies HKEY_LOCAL_MACHINE.</p>
\Registry\Machine
Software
Microsoft
Windows NT
CurrentVersion
Winlogon
DefaultUserName = REG_SZ bmiller
</code>
<h3>Complex sample</h3>
<p>
The following scripts were obtained by running the Regdmp utility.</p>
\Registry\Machine\Software
    Classes
        AudioCD [10 1 17 5]
            EditFlags = REG_BINARY 0x00000004 0x00000002
            DefaultIcon
                = REG_EXPAND_SZ %SystemRoot%\system32\shell32.dll,40
            shell
                = play
                play
                    = &amp;Play
                    command
                        = REG_EXPAND_SZ %SystemRoot%\system32\cdplayer.exe \
                                        /play %1

    Microsoft
        Rpc
            DCOM Protocols = REG_MULTI_SZ  "ncadg_ip_udp" \
                                           "ncadg_ipx"    \
                                           "ncacn_ip_tcp" \
                                           "ncacn_spx" \
                                           "ncacn_nb_nb" \
                                           "ncacn_nb_ipx"
            NameService
                Protocol=ncacn_np
                NetworkAddress=\\.
                ServerNetworkAddress=\\.
                Endpoint=\pipe\locator
                DefaultSyntax=3
            NetBios
            ServerProtocols
                ncacn_np=rpclts1.dll
                ncalrpc=ncalrpc
                ncacn_vns=rpclts8.dll
            ClientProtocols
                ncacn_np=rpcltc1.dll
                ncalrpc=ncalrpc
                ncacn_vns=rpcltc8.dll

        NetDDE [17 1]
            DDE Shares
                SerialNumber = REG_BINARY 8 0x09000005 0x01000000
                CLPBK$
                    fuCmdShow = REG_DWORD 0x7
                    ItemList = REG_MULTI_SZ
                    NewStyleLink = REG_SZ
                    NumItems = REG_DWORD 0x0
                    OldStyleLink = REG_SZ
                    Revision = REG_DWORD 0x1
                    SecurityDescriptor = REG_BINARY 0x6C \
                        0x80040001 \
                        0x0000004C \
                        0x0000005C \
                        0x00000000 \
                        0x00000014 \
                        0x00380002 \
                        0x00000002 \
                        0x00180200 \
                        0x000F03FF \
                        0x00000201 \
                        0x05000000 \
                        0x00000020 \
                        0x00000220 \
                        0x00180200 \
                        0x000002BD \
                        0x00000101 \
                        0x01000000 \
                        0x00000000 \
                        0x00000220 \
                        0x00000201 \
                        0x05000000 \
                        0x00000020 \
                        0x00000220 \
                        0x00000201 \
                        0x05000000 \
                        0x00000020 \
                        0x00000220
                    SerialNumber = REG_BINARY 8 0x09000005 0x01000000
                    Service = REG_DWORD 0x1
                    SharedFlag = REG_DWORD 0x1
                    ShareName = REG_SZ CLPBK$
                    ShareType = REG_DWORD 0x4
                    StartAppFlag = REG_DWORD 0x0
                    StaticDataLink = REG_SZ ClipSrv|System

</code>

</FONT>
</BODY>
</HTML>
