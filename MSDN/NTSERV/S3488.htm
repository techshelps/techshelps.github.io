<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Print Monitors</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Print Monitors</H3><P CLASS="t">Windows&nbsp;NT 4.0 supports two kinds of print monitors: <I>language monitors</I> and <I>port monitors</I>. </P>
<P CLASS="t">A language monitor is necessary to support bi-directional print devices. A bi-directional print device supports two-way communication between the print device and the spooler running on its print server. The language monitor allows the spooler to configure and monitor the status of a bi-directional printer. A language monitor can also add data (such as printer control information) to the print stream. When you create a printer, you install a printer driver. If a language monitor is associated with that printer driver, all data that flows from the printer driver to the print device goes through the language monitor before it goes through the port monitor and out to the printer.</P>
<P CLASS="t">Two-way communication between computer and print device allows a system administrator to configure the printer and to monitor printer status. The spooler running on the computer can request configuration and status information from the printer, and the printer can send unsolicited status information to the computer (such as the fact that the paper tray is empty). A common language is necessary for the two devices to understand each other.</P>
<P CLASS="t">The language monitor supplied with Windows&nbsp;NT 4.0 uses Printer Job Language (PJL). If a print-device vendor uses a printer language other than PJL, that vendor can develop a language monitor for it. A vendor might also develop a language monitor to add data, such as printer-specific control information, to the print stream going to a single directional printer.</P>
<P CLASS="t">Port monitors control the I/O port to which the physical print device is connected. The local print monitor executable (Localmon.dll) supplied by Microsoft controls parallel and serial I/O ports that may have a print device connected to them. Print devices connected to different types of I/O ports such as SCSI or Ethernet ports on a network card or adapter, are controlled by vendor-developed port monitors. </P>
<P CLASS="t">The print monitors supplied with Windows&nbsp;NT are described in the following sections.</P>
<UL><LI>Local print monitor (Localmon.dll)</LI><LI>Hewlett Packard Network Port print monitor (Hpmon.dll)</LI><LI>Line Printer (LPR) Port print monitor (Lprmon.dll)</LI><LI>Macintosh print monitor (Sfmmon.dll)</LI><LI>Digital Network Port print monitor (Decpsmon.dll)</LI><LI>LexMark Mark Vision print monitor (Lexmon.dll<B>)</B></LI><LI>PJL Language Monitor (Pjlmon.dll)</LI></UL><P CLASS="t">The Ports tab of the <B>Printer Properties</B> dialog box lists the default Windows&nbsp;NT ports. </P>
<P CLASS="t">By default, the list includes only standard ports controlled by the local print monitor, Localmon.dll. When you want to print over other communications channels (to a network-attached printer, for example), you must create a new port. </P>
<H4 CLASS="h4"><A NAME="sec0"></A>To create a new port</H4><P>    1.    Click the <B>Start</B> button, and then point to Settings.</P>
<P>    2.    Click <B>Printers</B>.</P>
<P>    3.    Click<B> Add New Port</B>.</P>
<P>    4.    Click to select the port monitor that controls the type of communications channel you want to use.</P>
<P>    5.    Insert the disk or type the network path to the port monitor files.</P>
<P>    6.    Click <B>OK</B> in each dialog box.</P>
<P CLASS="t">Print monitors often depend on other software components and appear in this list only when you have installed the components they require. For example, the Hewlett-Packard Network print monitor transmits print jobs by using the DLC network protocol. This monitor appears in the list only if you have installed the DLC protocol. </P>
<P CLASS="t">Each monitor displays its own user interface, which you use to create a new port and configure a printer to use it. To reconfigure the new port (if the monitor allows reconfiguration), click the <B>Configure Port</B> button on the Ports tab of the <B>Printer Properties</B> dialog box.</P>
<P CLASS="t">When you read about each print monitor in the following sections, remember that each is associated with a data communications channel, not with the print device at the other end of that channel. In most cases, the port monitor is unaware of the make or model of the print device it is communicating with, nor does it need this information. Also, although different port monitors might use the same network protocol, this does not make them interchangeable. For example, both the Digital Network Port print monitor and the LPR Port print monitor use the TCP/IP protocol, but they send data over that protocol in very different ways.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Local Print Monitor (Localmon.dll)</H4><P CLASS="t">The local print monitor, Localmon.dll, sends print jobs to local devices. These include familiar ports like LPT1 and COM1. Use of the less familiar FILE and Other ports are described below. </P>
<P CLASS="t">The FILE port appears in the default port list on the Ports tab of the <B>Printer Properties</B> dialog box. When you send jobs to a printer that uses this port, the local print monitor prompts you for the name of a file in which the print job should be stored. </P>
<P CLASS="t">If you select Other from the list of ports in the Print To box on the<B> Printer Properties</B> dialog box, and select the Local Port option, the local print monitor prompts you to enter a port name. Some possibilities include:</P>
<UL><LI>An explicit filename, such as C:\DIR\FILENAME. All jobs sent to this port are written to the named file. Each new job overwrites the last one.</LI><LI>The name of a print share, such as \\SERVER\PRINTER. Jobs sent to this port are transferred over the network to the named share by the network redirector. This can be useful if you need to send jobs to a network print server, but you want the job to spool locally as well as on the print server. </LI><LI>The NULL port. Use this port to test whether network clients are able to send jobs. Simply pause the printer set to use this port, send a job from a network client, look at the printer in Print Manager to confirm that it arrived, and resume the printer. Jobs sent to NULL are simply deleted from the system without wasting paper or delaying real print jobs.</LI></UL><H4 CLASS="h3"><A NAME="sec2"></A>Hewlett-Packard Network Port Print Monitor (Hpmon.dll)</H4><P CLASS="t">The Hewlett-Packard Network print monitor, Hpmon.dll, sends print jobs to HP JetDirect adapters. This includes both the network adapters commonly installed in print devices (such as the LaserJet 4 Si) and the JetDirect device (which connects a parallel print device to the network).</P>
<P CLASS="t">Although many JetDirect devices can communicate over several different network protocols, including DLC, IPX, TCP/IP, and AppleTalk, Hpmon.dll is specific to DLC; you must load the DLC protocol to use this print monitor. </P>
<P CLASS="t">The DLC protocol is bridgeable, but not routable. This means that if a Windows&nbsp;NT print server is on one physical subnet and a JetDirect device is on another physical subnet, the server can send jobs to the JetDirect if the two subnets are joined by a bridge but cannot send jobs if the two subnets are joined by a router.</P>
<P CLASS="t">The DLC protocol can be bound to multiple network adapters, but the HP print monitor software can only manage printers over one network adapter, and it must be either adapter 0 or adapter 1. If your Windows&nbsp;NT computer has multiple network adapters, make sure all the HP JetDirect-equipped printers are on the same physical subnet.</P>
<P CLASS="t">When you install, reinstall, or upgrade Windows&nbsp;NT, it assigns a number to each network adapter in your computer. The adapter with the lowest I/O base address is assigned the number 0; the adapter with the next lowest I/O base address is assigned the number 1, and so on. If you later add another network adapter, it is assigned the next unused number, regardless of its I/O base address. Later, if you upgrade or reinstall Windows&nbsp;NT, each adapter is again assigned a number based on its I/O base address. If the third adapter has a lower I/O base address than either of the other two, then the numbering changes. In this case, HPMON looks for JetDirect cards through the wrong network adapter on the server.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>To correct adapter numbering after an upgrade</H5><P>    1.    Click Start, point to Settings, and then click Control Panel.</P>
<P>    2.    Double-click the Network icon.</P>
<P>    3.    Click the Adapters tab.</P>
<P>    4.    Remove each adapter that has an incorrect number.</P>
<P>    5.    Add the adapters back in the order that corresponds with their I/O addresses (the lowest address getting the lowest number).</P>
<P>    6.    Click OK.</P>
<P CLASS="t">You can configure ports managed by Hpmon.dll as either <I>job-based</I> or <I>continuous connection</I>. The setting affects all ports at once:</P>
<UL><LI>With job-based connection, a print server connects to the JetDirect adapter, sends a print job, and disconnects when the job is finished printing. This enables other print servers to connect and print. </LI><LI>With continuous connection, a print server connects to the JetDirect adapter and maintains the connection until either the print server or the adapter is rebooted, preventing other servers from connecting. The main advantage of continuous connection is that all users are validated by the Windows&nbsp;NT security model, and every print job access can be audited.</LI></UL><P>For more information about auditing printing, see the <I>Windows&nbsp;NT 4.0 Workstation Resource Guide.</I></P>
<P CLASS="nt"><B>Note</B>  If you configure two Windows&nbsp;NT print servers to send jobs to the same JetDirect device, configure both servers for job-based connections. If you configure one of the print servers for continuous connection, it prevents the job-based server from connecting to the print device.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>Line Printer Port Monitor (Lprmon.dll/Lpr.exe)</H4><P CLASS="t">Windows&nbsp;NT supplies a command line utility (Lpr.exe) and the LPR Port print monitor (Lprmon.dll). Both act as clients sending print jobs to an LPD service running on another computer. As mentioned previously, Windows&nbsp;NT also supplies an LPD service, the TCP/IP Print service, which receives print jobs sent by LPR clients, including UNIX computers and other Windows&nbsp;NT computers using the TCP/IP protocol. </P>
<P CLASS="t">To send print jobs, the LPR clients needs the network address of the LPD print server and the name that the LPD service associates with its print device. LPR sends print jobs to LPD along with instruction on how to process the job and the name of the print device. </P>
<P CLASS="t">When you add an LPR port while connecting to the LPR print server, you'll be asked in a dialog box to supply information identifying the print server (host) and the name of the printer. You can supply either the IP address or the host name of the server. The server can be one of the following:</P>
<UL><LI>UNIX computer</LI><LI>Windows&nbsp;NT computer</LI><LI>Windows for Workgroups computer with a 3<SUP>rd</SUP>-party LPD</LI><LI>network adapter, such as an HP JetDirect or Emulex NetJet</LI></UL><P CLASS="t">For example, let's say you're connecting to a printer named LABLASER on a UNIX computer whose IP address is 11.22.33.44, and whose name (defined in the hosts file on your Windows&nbsp;NT computer) is UNIXBOX. You can enter either "UNIXBOX" or "11.22.33.44" (without the quotation marks) in the Name Or Address Of Host Providing LPD box. You would enter LABLASER in the Name Of Printer On That Machine box.</P>
<P CLASS="t">To obtain the IP address of a network adapter, check the adapter's documentation. Some adapters provide a character-based application that you can access either by network connection or by directly connecting to the adapter by means of a serial-to-serial port cable.</P>
<P CLASS="t">If the server is a UNIX computer, and you don't know a valid name for the printer, you can often find it by looking at the /etc/printcap file on the UNIX computer. Each entry corresponds to a print queue ("printer" in Windows&nbsp;NT terminology) on the UNIX computer. Fields in these entries are separated by ":" characters, and for readability an entry can be broken over several lines by ending a line with a "\" character and beginning the next line with a space or tab character. The first field of each entry lists valid names for the queue, separated by "|" characters.</P>
<P CLASS="t">Continuing the LABLASER example, we might find entries like the following in the printcap file on the computer named UNIXBOX:</P>
<P CLASS="spacing"><BR></P>
lp|lablaser|The_Lab_Printer:\
:lp=/dev/ttya:br#9600:\
:lf=/usr/spool/lpd/lablaser-err:\
:sd=/usr/spool/lpd/lablaser:
<P CLASS="t">The first line in this example defines a print queue with three valid names: lp, lablaser, and The_Lab_Printer. You can use any of these names in the second field of the<B> LPR Port</B> dialog box previously shown.</P>
<P CLASS="nt"><B>Note</B>  This example is provided for illustrative purposes only. The UNIX system documentation is your best source of detailed information on your system's printcap file. Also note that the term "queue" is the UNIX term. Its Windows&nbsp;NT equivalent is "printer."</P>
<P CLASS="t">When the LPR Port print monitor receives the LPD server's network address and the proper queue name, it can send print jobs and processing instructions. </P>
<P CLASS="t">The LPR Port print monitor sends the <B>l</B> command by default, whereas the command line Lpr.exe utility sends the <B>f</B> command by default. With the Lpr.exe utility, use the <B>-o</B> command if you want to override the default on a job-by-job basis. To change the default command for a particular printer controlled by the LPR Port print monitor, you must modify a Registry parameter. Use the Registry Editor (Regedt32.exe) to find the following key: </P>
<P CLASS="spacing"><BR></P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Monitors\
LPRPort\Ports\&lt;portname&gt;\&lt;IP Address or Host name&gt;:&lt;printer name&gt;
<P CLASS="t">In this key, add a value named PrintSwitch with type REG_SZ, and enter the control command you want to use. For instance, enter the letter "f" (without the quotation marks) if you want to use the <B>f </B>command by default. </P>
<P CLASS="t">Some UNIX computers do not follow the control commands alone when deciding how to process a print job. For instance, if you send an ASCII text file with an <B>l</B> command (which tells the spooler not to alter the print job) to a PostScript printer, it does not print correctly. Consequently, many UNIX systems have added software that converts scans jobs that arrive with the <B>l</B> command. If the scanner finds PostScript commands, the job goes directly to the printer. If no PostScript is found, the added software adds the PostScript code so that the job prints correctly.</P>
<P CLASS="t">If you send PostScript jobs from a Windows&nbsp;NT computer using LPR, and the printer controlled by the UNIX server prints the PostScript code instead of interpreting it, the UNIX server might have a scanner that does not recognize the output from the Windows&nbsp;NT PostScript driver as valid PostScript code. If this happens, you might need to reconfigure Windows&nbsp;NT to use the <B>o</B> control command by default.<B> </B></P>
<P CLASS="t">If the client sends the <B>f</B>, <B>o</B>,<B> </B>or<B> p</B> control command, the Windows&nbsp;NT TCP/IP Print service assigns the TEXT data type to the print job—which tells the spooler to edit the job to make sure it prints. If the client sends the <B>l </B>control command, the Windows&nbsp;NT TCP/IP Print service assigns the RAW data type to the print job—which tells the spooler the print job needs no editing to print correctly. For more detail about data types, see "Data Types" earlier in this chapter. </P>
<P CLASS="t">Control commands are documented in the LPR specification, Request For Comment (RFC)1179, sections 7.17 through 7.29. For detailed information about RFC 1179, refer to the Windows&nbsp;NT Knowledge Base article, "Text of RFC1179 Standard for Windows&nbsp;NT TCP/IP Printing," reference number Q124734. </P>
<P CLASS="t">LPD-compliant print devices must supply one or more names for each of their print queues, even though these devices often have only one possible destination for the print jobs they receive. Each print-device manufacturer chooses naming conventions independently. Some, like the HP JetDirect adapter, accept any string as a legal print queue name. In comparison, the Emulex NetJet adapter accepts only two strings, and these are case sensitive, and default to TEXT and PASSTHRU. These strings are configurable. To find the names supported by any specific adapter, check its documentation, or contact the vendor's technical support group.</P>
<P CLASS="t">Remember that<I> </I>the local print provider spools print jobs, and that it despools them to the print monitors. In Windows&nbsp;NT, after LPRMON receives a job from the local print provider, it spools it a second time as a temporary file in the SYSTEM32 subdirectory. LPR must include an accurate byte count in the control file, and it cannot get that byte count from the local print provider. Instead, it respools the data to a temp file, finds the size of that temp file, and sends that size in the control file to the LPD server.</P>
<P CLASS="t">The most common problem people encounter when printing from UNIX systems to a Windows&nbsp;NT print server is that their print jobs are processed as TEXT data type instead of RAW data type, as they would be on a UNIX system. This happens because the UNIX systems almost always send the <B>f </B>control command, expecting that the control command isn't too important, because the TCP/IP (LPD) server parses the job to identify what data type to use and how to alter the job. However, Windows&nbsp;NT relies on the control command to determine the data type. As a result, the LPD service on Windows&nbsp;NT assigns the TEXT data type to most jobs.</P>
<P CLASS="t">To correct this problem, reconfigure the LPR client to send the <B>l</B> control command so the LPD will assign the RAW data type. </P>
<H4 CLASS="h3"><A NAME="sec5"></A>Macintosh Port Monitor (Sfmmon.dll)</H4><P CLASS="t">The Macintosh port monitor, Sfmmon.dll, transmits jobs over a network using the AppleTalk protocol to network-attached print devices, such as the Apple LaserWriter family. It also lets you send jobs to AppleTalk spoolers, regardless of the print device that the spooler is attached to.</P>
<P CLASS="t">This monitor is available on both Windows&nbsp;NT Workstation and Windows&nbsp;NT Server computers and enables any Windows&nbsp;NT-based computer to send local print jobs to AppleTalk print devices. However, only Windows&nbsp;NT Server has a Macintosh print server component, so only a Windows&nbsp;NT Server computer can receive print jobs from Macintosh clients.</P>
<P CLASS="t">Some print devices process non-PostScript print jobs incorrectly if they receive those jobs over AppleTalk. Also, some print devices process PostScript jobs incorrectly if those jobs contain binary data and arrive over any protocol other than AppleTalk. These problems result from restrictions in those print devices; they do not indicate that the Windows&nbsp;NT Server print server is transmitting the jobs incorrectly.</P>
<H4 CLASS="h3"><A NAME="sec6"></A>Digital Network Port Monitor (Decpsmon.dll)</H4><P CLASS="t">The Digital Network Port print monitor, Decpsmon.dll, sends print jobs to Digital Equipment Corporation's Digital PrintServer print devices and to other Digital Equipment Corporation print devices (such as the DEClaser 5100 and the DECcolorwriter 1000).</P>
<P CLASS="t">Windows&nbsp;NT supplies the TCP/IP network protocol, but does not supply the DECnet&trade; protocol. If you want to use DECnet, you must contact Digital Equipment Corporation to obtain it.</P>
<H4 CLASS="h3"><A NAME="sec7"></A>LexMark Mark Vision Print Monitor (Lexmon.dll)</H4><P CLASS="t">LexMark's Mark Vision print monitor (Lexmon.dll) sends print jobs to LexMark MarkNet print devices (such as the MarkNetXL) and to network adapters (such as the MarkNetXLe). This print monitor uses any of the following protocols:</P>
<UL><LI>DLC</LI><LI>TCP/IP</LI><LI>IPX</LI></UL></BODY></HTML>
