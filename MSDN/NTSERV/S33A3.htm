<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DiskProbe - a Low-level Disk Editor</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">DiskProbe - a Low-level Disk Editor</H3><P CLASS="t">This Windows&nbsp;NT-based utility enables you to save, restore, find, examine, and change data on the disk. DiskProbe gives an administrator access to every byte on the physical disk without regard to access privilege, and with it you can change any part of the disk. It is your responsibility to make sure that you have backups of the disk.</P>
<P CLASS="t">After starting DiskProbe, as shown in Figure 7.2, you use the <B>Drives</B> menu to open a physical disk or a logical drive.</P>
<P><img src="xsr_h03.gif"></P>
<P CLASS="cap"><B>Figure 7.2    Opening a disk by using DiskProbe </B></P>
<P CLASS="t">Clicking<B> Physical Drive</B> on the <B>Drives</B> menu opens the entire physical disk. You can access any sector on the disk. When you read or write sectors, the sector number is the absolute sector from the beginning of the disk.</P>
<P CLASS="t">Clicking<B> Logical Volume</B> on the <B>Drives</B> menu opens the logical drive associated with a drive letter. Sector numbers are relative to the start of the logical drive, and you can only access sectors within the range of the logical drive. You cannot use DiskProbe to access a network drive.</P>
<P CLASS="t">When you have opened either a disk by clicking either <B>Physical Drive</B> or <B>Logical Volume</B>, you can get information about the characteristics of the disk by clicking <B>Volume Information</B> on the <B>Drives</B> menu. You get the same information regardless of how you opened the disk. This information is the same as what you see if you run the DiskMap utility for this disk. You can use this information if you need to repair the Partition Table. Here is an example:</P>
<P><img src="xsr_h02.gif"></P>
<P CLASS="t">Whenever you use DiskProbe to read a sector, it displays the sector number of the first sector it read in the title bar. It also displays the sector number of the sector you are currently viewing in the status bar. This information is useful if you have read more than one sector. </P>
<P CLASS="t">When you are first using DiskProbe, or are looking at information in an extended partition, it is recommended that you write down the sector number for the start of each partition and logical drive. You should also write down the sector number of the Partition Boot Sector for each partition or logical drive. You can produce a hardcopy of the disk configuration by using the DiskMap utility, which is described earlier in this chapter.</P>
<P CLASS="t">If your disk has volume sets or an extended partition, remembering which primary partition or logical drive you are looking at can become difficult. You can always start over by reading sector 0, which reads the Partition Table for the disk. </P>
<P CLASS="t"><B>Note</B></P>
<P>In the DiskProbe utility, sectors are numbered starting from zero. </P>
<P>The location of some system information on NTFS volumes is different, depending on which version of Windows&nbsp;NT, was used to format the volume. For example, Windows&nbsp;NT 4.0 writes a backup of the Partition Boot Sector for the volume at the end of the volume. Earlier versions of Windows&nbsp;NT put the backup at the center of the volume. </P>
<P CLASS="t">For more information about DiskProbe, see Dskprobe.hlp and Rktools.hlp on the <I>Windows&nbsp;NT Server Resource Kit</I> CD.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Comparing DiskProbe to Disk Administrator</H4><P CLASS="t">Although DiskProbe and Disk Administrator both provide you with information about the organization of your hard disks, each utility has additional functionality. Disk Administrator enables you to configure and format your disks. DiskProbe enables you to save and change the data on the disk.</P>
<P CLASS="t">Disk Administrator shows you, for each disk, the size and organization of:</P>
<UL><LI>Primary partitions</LI><LI>Logical drives (single contiguous areas in an extended partition)</LI><LI>Stripe sets</LI><LI>Volume sets</LI><LI>Mirror sets</LI><LI>Stripe sets with parity</LI></UL><P CLASS="t">When displaying information about stripe sets, volume sets, mirror sets, and stripe sets with parity, both DiskProbe and Disk Administrator read the Registry key HKEY_LOCAL_MACHINE\SYSTEM\DISK to determine which disks contain the members of the volumes. </P>
<P CLASS="t">When you view the Partition Table, DiskProbe enables you to determine the starting and ending location of primary partitions, logical drives, and volume sets.</P>
<P CLASS="t">DiskProbe simply displays the information that it finds in each Partition Table, it is up to you to understand how the individual entries in the Partition Table relate to what you have configured on your disks. If your configuration contains extended partitions, you might find it easier to understand the DiskProbe information if you print a screen shot of the Disk Administrator display (by pressing ALT+Print Screen, pasting the screen shot into Paint or a document, and then printing the picture or document). The section "Walking an Extended Partition," presented later in this chapter, contains an example of the Disk Administrator and DiskProbe information for an extended partition.</P>
<P CLASS="t"><B>Note</B></P>
<P>Because both DiskProbe and Disk Administrator can modify the Partition Table, and DiskProbe enables you to directly modify any sector on a disk, you should never have both of these utilities open at the same time. When you are using DiskProbe, you should also be very cautious about running any other programs. DiskProbe writes directly to the disk without using the file cache, the NTFS log file, or any file system device drivers.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Backing Up and Restoring the Master Boot Record </H4><P CLASS="t">The Master Boot Record on the hard disk that you use to start your computer is the most important sector on the disk. The Master Boot Record on other disks is not as critical. However, if the partition information in the other Master Boot Records is not correct, you might not be able to access volumes on those disks. </P>
<P CLASS="t">For an example of a Master Boot Record, see Chapter 3, "Disk Management Basics."</P>
<H5 CLASS="h4"><A NAME="sec2"></A>To back up the Master Boot Record </H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    On the <B>Drives</B> menu, click <B>Physical Drive</B>. You will see the <B>Open Physical Drive</B> dialog box, which is shown in the following figure.</P>
<P><img src="xsr_h04.gif"></P>
<P>The <B>Available Physical Drives</B> are listed as PhysicalDrive<I>n</I>, where n=0 for the first hard disk. Double-click the disk that contains the Master Boot Record you want to save. You should always save the Master Boot Record on the startup disk. In the case of an x86-based computer, the startup disk is usually PhysicalDrive0. </P>
<P>When you have more than one disk, you should back up the Master Boot Record on each disk, since it contains the Partition Table for that disk.</P>
<P>    3.    In the <B>Handle 0</B> group box, click<B> Set Active</B>. Click <B>Close</B>.</P>
<P>    4.    On the <B>Sectors</B> menu, click <B>Read</B> to open the <B>Sector Range</B> dialog box, which is shown in the following figure. Set <B>Starting Sector</B> to 0 and <B>Number of Sectors</B> to 1. Click <B>Read</B>. </P>
<P><img src="xsr_h05.gif"></P>
<P>Make sure that the sector you read looks like a Master Boot Record, as described within Chapter 3, "Disk Management Basics."</P>
<P>    5.    On the <B>File</B> menu, click <B>Save As</B>. Enter the filename. Consider saving the file to the Emergency Repair Disk, Windows&nbsp;NT startup floppy disk, or the MS-DOS bootable floppy disk. You can save it on more than one disk. If you have more than one disk whose master Boot Record you are backing up, using a filename such as Mbrdiskn.dsk can help you remember which file corresponds to which disk.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>To restore the Master Boot Record </H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    On the <B>File</B> menu, click <B>Open</B>. Enter the filename and open the file. Verify that the file looks like a Master Boot Record and that it is 512 bytes. DiskProbe displays a message if the size of the file you open is not a multiple of 512.</P>
<P>    3.    On the <B>Drives</B> menu, click <B>Physical Drive</B>. The <B>Available Physical Drives</B> are listed as PhysicalDrive<I>n</I>, where n=0 for the first hard disk. Double-click the disk that contains the Master Boot Record you want to restore. </P>
<P>    4.    In the <B>Handle 0</B> group box, clear the <B>Read Only</B> check box, and click <B>Set Active</B>. Click <B>Close</B>.</P>
<P>    5.    On the <B>Sectors</B> menu, click <B>Write</B> to open the <B>Write Sector</B> dialog box. Set <B>Starting sector to write data </B>to 0. Click <B>Write it</B>. </P>
<P>DiskProbe displays a message box so you can verify the information.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>Displaying and Using the Partition Table </H4><P CLASS="t">The Master Boot Record is the first sector on each hard disk. The first step in troubleshooting Partition Table problems should be to read the Master Boot Record and look at the Partition Table. The description in this section applies to viewing the Partition Table in the Master Boot Record. See "Walking an Extended Partition," presented later in this chapter, for information about finding the Partition Table for an extended partition. </P>
<H5 CLASS="h4"><A NAME="sec5"></A>To display the Partition Table </H5><P>    1.    Read the Master Boot Record by using steps 1 through 4 in the procedure for backing up the Master Boot Record, given earlier in this chapter. </P>
<P>    2.    On the View menu, click Partition Table to see the information displayed in a user-friendly manner. You will see a screen similar to the following:</P>
<P><img src="xsr_h06.gif"></P>
<P><B>Figure 7.3    DiskProbe Partition Table view</B></P>
<P CLASS="t">DiskProbe makes it easy for you to look at the information for each volume. In the <B>Partition table index</B> list box, double-click the partition number for which you want to see the Partition Table entry. </P>
<P CLASS="t">Click the <B>Next Partition</B> button to see the information in the first sector of the next partition. For a primary partition, clicking the <B>Next Partition</B> button reads the Partition Boot Sector of the next partition. When the next partition is an extended partition, clicking <B>Next Partition</B> reads the Partition Table sector for the first logical drive in the extended partition.</P>
<P CLASS="t">For a primary partition, clicking the <B>Go</B> button next to the <B>Relative Sector</B> field reads the Partition Boot Sector for the current partition. When the <B>System ID</B> field is EXTENDED, clicking the <B>Go</B> button reads the Partition Table for the next logical drive in the extended partition.</P>
<P CLASS="t">If you make changes to the Partition Table, you must explicitly write the sector to disk by clicking <B>Write</B> on the <B>Sectors</B> menu.</P>
<P CLASS="t">When you are viewing the information for an extended partition in the Partition Table area of the Master Boot Record, the <B>Total Sectors</B> field is the total size of the extended partition, which is usually larger than the size of the first logical drive in the partition.</P>
<H4 CLASS="h3"><A NAME="sec6"></A>Walking an Extended Partition </H4><P CLASS="t">If the disk has an extended partition, finding the information for each logical drive is more complicated than just looking at the Partition Table in the Master Boot Record, but DiskProbe does the work for you. "Logical Drives and Extended Partitions," within Chapter 3, describes the organization of an extended partition.</P>
<P CLASS="t">Information for the logical drives in an extended partition is basically chained from one logical drive to the next. The term <I>walking an extended partition</I> means that utilities like DiskProbe and DiskMap use the information defined for one logical drive in the chain to find the next logical drive in the chain. Knowing how to walk an extended partition is necessary if one of the links in the chain becomes corrupted, and you want to repair it.</P>
<P CLASS="t">The description in this section applies when you are viewing the Partition Table information in the first sector of each logical drive. </P>
<P CLASS="t">To help make the descriptions easier to understand, following is a screen shot from Disk Administrator, and the information from DiskProbe for the extended partition shown in the screen shot. The extended partition includes volume set E, logical drives I and K, and 4 MB of unused space between E and L. This example is the same disk configuration used in the section "DiskMap — Display a Map of the Disk," presented earlier in this chapter.</P>
<P><img src="xsr_h07.gif"></P>
<P CLASS="t"><B>Note</B></P>
<P>This example is for illustration purposes, and is not a good organization for the disk, because the free space at the end of the primary partition is unusable. This is because you can have only four Partition Table entries in the Master Boot Record. In this example, primary partitions C, D, and L each use one entry. The extended partition, which includes volume set E, logical drives I and K, and the free space between E and K, uses the other entry. Disk Administrator displays an error message if you try to use any of the area after drive L to create a partition or extend an NTFS logical drive. </P>
<P>The distinction between the two areas of free space is that the one on the left is free space within an extended partition, while the free space on the right, which has a different background pattern, is not a part of any partition. </P>
<P CLASS="t">To walk the extended partition in this example, start with the information for Partition 3 in the Partition Table on relative sector 0. Partition 3 points you to the first logical drive in the extended partition. By following the links in the Partition Table entry for each logical drive, you can find the information for all of the logical drives. </P>
<P CLASS="t">The next table identifies which sectors contain information about the extended partition and the logical drives. The table also describes which buttons to click to walk the extended partition.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="63pt" VALIGN="TOP"><COL WIDTH="285pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Relative sector</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Contents</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">0</P></TD><TD VALIGN="TOP"><P CLASS="tt">Partition 3 of the Master Boot Record contains an EXTENDED entry, which is the information about the first part of volume set E. Click <B>Go</B> when viewing Partition 3 to read the Partition Table for the first part of volume set E.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">819504</P></TD><TD VALIGN="TOP"><P CLASS="tt">Partition 1 describes the first part of volume set E. Partition 2 is an EXTENDED entry with the information for logical drive I. Click <B>Next Partition </B>when viewing Partition 1 to read the Partition Table for logical drive I.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">839664</P></TD><TD VALIGN="TOP"><P CLASS="tt">Partition 1 describes logical drive I, Partition 2 is an EXTENDED entry with the information for logical drive K. Click <B>Next Partition</B> when viewing Partition 1 to read the Partition Table for logical drive K.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">855792</P></TD><TD VALIGN="TOP"><P CLASS="tt">Partition 1 describes logical drive K. Partition 2 is an EXTENDED entry with the information for the second part of volume set E. Click <B>Next Partition</B> when viewing Partition 1 to read the Partition Table for the second part of volume set E.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">879984</P></TD><TD VALIGN="TOP"><P CLASS="tt">Partition 1 describes the second part of volume set E. Partition 2 is all zeroes (end of the extended partition).</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The next table shows the information in Partition 3 of the Master Boot Record and each of the Partition 1 entries for the extended partition.</P>

<TABLE COLS="6" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="39pt" VALIGN="TOP"><COL WIDTH="68pt" VALIGN="TOP"><COL WIDTH="63pt" VALIGN="TOP"><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="67pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Field Name</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Master Boot Record entry</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>First part of E (10 MB)</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B><BR>I (8 MB)</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B><BR>K (12MB)</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Second part of E (16 MB)</B></P></TD></TR><TR><TD COLSPAN="6" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">System ID</P></TD><TD VALIGN="TOP"><P CLASS="tt">EXTENDED</P></TD><TD VALIGN="TOP"><P CLASS="tt">NTFS FT</P></TD><TD VALIGN="TOP"><P CLASS="tt">FAT</P></TD><TD VALIGN="TOP"><P CLASS="tt">NTFS</P></TD><TD VALIGN="TOP"><P CLASS="tt">NTFS FT</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Boot Indicator</P></TD><TD VALIGN="TOP"><P CLASS="tt">NO_ SYSTEM</P></TD><TD VALIGN="TOP"><P CLASS="tt">NO_ SYSTEM</P></TD><TD VALIGN="TOP"><P CLASS="tt">NO_ SYSTEM</P></TD><TD VALIGN="TOP"><P CLASS="tt">NO_ SYSTEM</P></TD><TD VALIGN="TOP"><P CLASS="tt">NO_ SYSTEM</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Start Head</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">End Head</P></TD><TD VALIGN="TOP"><P CLASS="tt">15</P></TD><TD VALIGN="TOP"><P CLASS="tt">15</P></TD><TD VALIGN="TOP"><P CLASS="tt">15</P></TD><TD VALIGN="TOP"><P CLASS="tt">15</P></TD><TD VALIGN="TOP"><P CLASS="tt">15</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Start Sector</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">End Sector</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Start Cylinder</P></TD><TD VALIGN="TOP"><P CLASS="tt">813</P></TD><TD VALIGN="TOP"><P CLASS="tt">813</P></TD><TD VALIGN="TOP"><P CLASS="tt">833</P></TD><TD VALIGN="TOP"><P CLASS="tt">849</P></TD><TD VALIGN="TOP"><P CLASS="tt">873</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">End Cylinder</P></TD><TD VALIGN="TOP"><P CLASS="tt">914</P></TD><TD VALIGN="TOP"><P CLASS="tt">832</P></TD><TD VALIGN="TOP"><P CLASS="tt">848</P></TD><TD VALIGN="TOP"><P CLASS="tt">872</P></TD><TD VALIGN="TOP"><P CLASS="tt">905</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Relative Sector</P></TD><TD VALIGN="TOP"><P CLASS="tt">819504</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD><TD VALIGN="TOP"><P CLASS="tt">63</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Total Sectors</P></TD><TD VALIGN="TOP"><P CLASS="tt">102816</P></TD><TD VALIGN="TOP"><P CLASS="tt">20097</P></TD><TD VALIGN="TOP"><P CLASS="tt">16065</P></TD><TD VALIGN="TOP"><P CLASS="tt">24129</P></TD><TD VALIGN="TOP"><P CLASS="tt">33201</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">When the <B>System ID</B> field for a Partition 2 in an extended partition contains the value EXTENDED, double-click Partition 1 in the<B> Partition table index </B>list box, and then<B> </B>click <B>Next Partition</B> to read the first sector of the next logical drive. The only information in the first sector of a logical drive is a Partition Table, which has two entries. The Partition 1 entry contains information about the current logical drive, and the Partition 2 entry is the information for the next logical drive in the extended partition. The <B>System ID</B> for each Partition 2 entry should be EXTENDED unless you are at the end of the extended partition. </P>
<P CLASS="t">The next screen shot shows the Partition Table entry for the first part of volume set E; the Partition Table is located at relative sector 819504.</P>
<P><img src="xsr_h08.gif"></P>
<P CLASS="t">When the <B>System ID</B> field contains any value except EXTENDED or UNKNOWN, clicking the <B>Go</B> button next to the <B>Relative Sector</B> field reads the Partition Boot Sector for the logical drive.</P>
<P CLASS="t">To view the information for Partition 2 (the next logical volume), double-click Partition 2 or click <B>Next Partition</B> while viewing the information for Partition 1.</P>
<P CLASS="t">The <B>Relative Sector</B> field for each Partition 2 entry in an extended partition is the offset from the beginning of the extended partition, not the offset from the beginning of the Partition Table associated with the Partition 1 entry. Therefore, do not use the <B>Go</B> button to try to read the Partition Boot Sector for Partition 2. </P>
<P CLASS="t"><B>Note</B></P>
<P>Sometimes, the System ID byte for NTFS volume sets, stripe sets, mirror sets, and stripe sets with parity does not have the correct value. It should be 0x87, which DiskProbe displays as NTFS FT. Instead, it might be 0x86, which DiskProbe displays as FAT FT. Windows&nbsp;NT uses information in the Partition Boot Sector to determine which file system to use, so this incorrect value causes no problems, although it can be confusing to a person trying to understand the data on the disk. To be certain which file system is being used for a volume, look at the Partition Boot Sector.</P>
<H4 CLASS="h3"><A NAME="sec7"></A>Viewing the Partition Boot Sector</H4><P CLASS="t">You can use DiskProbe to view the information in Partition Boot Sectors. You see a formatted view of the information in the BIOS Parameter Block and the Extended BIOS Parameter Block. For a description of these structures, see "Partition Boot Sector," within Chapter 3, "Disk Management Basics."</P>
<H5 CLASS="h4"><A NAME="sec8"></A>To view a Partition Boot Sector </H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    On the <B>Drives</B> menu, click <B>Logical Volume</B>. In the <B>Logical Volumes</B> list box of the <B>Open Logical Volume</B> dialog box, double-click the drive letter for the partition or logical drive whose Partition Boot Sector you want to read.</P>
<P>    3.    In the <B>Handle 0</B> group box, click<B> Set Active</B>. Click<B> OK</B>.</P>
<P>    4.    On the <B>Sectors</B> menu, click <B>Read</B> to display the <B>Read Sectors </B>dialog box. Set <B>Starting Sector</B> to 0 and <B>Number of Sectors</B> to 1. </P>
<P>    5.    On the <B>View</B> menu, click <B>NTFS Bootsector</B> or <B>FAT Bootsector</B> to see the information.</P>
<P CLASS="t">The next screen shot shows the NTFS Bootsector view of primary partition D for the disk configuration shown in Figure 7.1.</P>
<P><img src="xsr_h16.gif"></P>
<P CLASS="t">When viewing an NTFS Partition Boot Sector, there are <B>Go</B> buttons next to the fields <B>Clusters to MFT</B> and <B>Clusters to MFT mirr</B>. When you click one of these buttons, it reads the first sector of the MFT or the MFT mirror, respectively. For information about these structures, see "Master File Table (MFT) and NTFS System Files" within Chapter 17, "Disk and File System Basics," in the <I>Windows&nbsp;NT Workstation Resource Guide</I>.</P>
<P CLASS="t">As described earlier in this section, Windows&nbsp;NT writes a backup of the NTFS Partition Boot Sector at the logical center of the volume (Windows&nbsp;NT version 3.51 and earlier) or the end of the volume (Windows&nbsp;NT 4.0). You can use the <B>Volume Middle</B> and <B>Volume End</B> buttons to read the backup Partition Boot Sector. However, these are some situations (when using Windows&nbsp;NT version 3.51 or earlier) where the backup Partition Boot Sector does not get written in the correct location:</P>
<UL><LI>Converting a volume from FAT to NTFS.</LI><LI>Extending a volume set.</LI></UL><P CLASS="t">View the sector you read to make sure it looks like an NTFS Partition Boot Sector, and that the information in it is accurate for the volume.</P>
<P CLASS="t">When viewing a FAT Partition Boot Sector, there is also a <B>Volume End</B> button, but there is no backup of the FAT Partition Boot Sector on the volume. If you are trying to find where volumes begin and end so you can repair a Partition Table, you can use the <B>Volume End</B> button for both FAT and NTFS partitions or logical drives to read what should be the sector immediately before the beginning of the next partition or logical drive. </P>
<P CLASS="t"><B>Note</B></P>
<P>If you are viewing a backup NTFS Partition Boot Sector, do not use the <B>Go</B>, <B>Volume End</B>, or <B>Volume Middle</B> buttons. These buttons read the correct sectors only when you are viewing the Partition Boot Sector at the beginning of the volume.</P>
<H4 CLASS="h3"><A NAME="sec9"></A>Backing Up and Restoring the Partition Boot Sector </H4><P CLASS="t">The Partition Boot Sector contains information that the file system uses to access the volume. On x86-based computers, the Master Boot Record uses the Partition Boot Sector on the system partition to load the operating system kernel files, or in the case of Windows&nbsp;NT, the boot loader. </P>
<P CLASS="t">For examples of a Partition Boot Sector for a FAT and an NTFS volume, see Chapter 3, "Disk Management Basics."</P>
<P CLASS="t">There are several procedures that you can use, depending on whether you are backing up or restoring the Partition Boot Sector for:</P>
<UL><LI>A primary partition</LI><LI>A logical drive, which is a single contiguous area in an extended partition</LI><LI>Several Partition Boot Sectors in an extended partition</LI><LI>A volume set</LI><LI>A stripe set</LI><LI>A mirror set</LI><LI>A stripe set with parity</LI></UL><P CLASS="t">You can open the disk to read the Partition Boot Sector by using either <B>Physical Drive</B> or <B>Logical Volume</B> on the <B>Drives</B> menu. When you use <B>Physical Drive</B>, you have to read the Partition Table to find the address of the Partition Boot Sector. When you use <B>Logical Volume</B>, you read the Partition Boot Sector by reading sector 0 of the logical drive. You cannot read the Master Boot Record when you use <B>Logical Volume</B>.</P>
<H5 CLASS="h4"><A NAME="sec10"></A>To back up a Partition Boot Sector for a primary partition by using Physical Drive</H5><P>    1.    Read the Partition Table and view it by using the procedure in "Displaying and Using the Partition Table," presented earlier in this section. </P>
<P>    2.    In the <B>Partition table index</B> list box, double-click the partition number for the Partition Boot Sector that you want to save. For instance, to save the Partition Boot Sector for the system partition, double-click the partition number that has the <B>Boot Indicator</B> set to <B>SYSTEM</B>.</P>
<P>    3.    To read the Partition Boot Sector, click the <B>Go</B> button next to the <B>Relative Sector</B> field. On the <B>View</B> menu, click <B>NTFS BootSector</B> or <B>FAT BootSector</B> to see the information displayed appropriately. Make sure that the sector you just read looks like a Partition Boot Sector, as described within Chapter 3, "Disk Management Basics."</P>
<P>    4.    On the <B>File</B> menu, click <B>Save As</B>. Enter the filename. Consider saving the file to the Emergency Repair Disk, the Windows&nbsp;NT startup floppy disk, or the MS-DOS bootable floppy disk. You can save it to more than one disk. When you are saving a Partition Boot Sector, using a name such as PBS<I>ssssssss</I>DISK<I>n</I>.dsk, where <I>ssssssss</I> is the relative sector of the Partition Boot Sector and <I>n</I> is the disk number, can help you remember what the file contains.</P>
<H5 CLASS="h4"><A NAME="sec11"></A>To back up the Partition Boot Sector by using Logical Volume</H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    On the <B>Drives</B> menu, click <B>Logical Volume</B>. In the <B>Logical Volumes</B> list box, double-click the drive letter for the partition whose Partition Boot Sector you want to save.</P>
<P>    3.    In the <B>Handle 0</B> group box, click<B> Set Active</B>. Close the dialog box.</P>
<P>    4.    On the <B>Sectors</B> menu, click <B>Read</B>. Set <B>Starting Sector</B> to 0 and <B>Number of Sectors</B> to 1. Make sure that the sector you read looks like a Partition Boot Sector, as described within Chapter 3, "Disk Management Basics."</P>
<P>    5.    On the <B>File</B> menu, click <B>Save As</B>. Enter the filename. Consider saving the file to the Emergency Repair Disk, the Windows&nbsp;NT startup floppy disk, or the MS-DOS bootable floppy disk. You can save it to more than one disk. When you are saving a Partition Boot Sector in this manner, using a name such as PBS<I>d</I>DSK<I>n</I>.dsk, where <I>d</I> is the drive letter of the logical drive, and <I>n</I> is the disk number, can help you remember what the file contains. Using a name such as this assumes that you will not be changing drive letters.</P>
<H5 CLASS="h4"><A NAME="sec12"></A>To back up the Partition Boot Sectors in an extended partition by using Physical Drive</H5><P>    1.    Read the Partition Table and view it by using the procedure in "Displaying and Using the Partition Table," presented earlier in this section. </P>
<P>    2.    In the <B>Partition table index</B> list box, double-click the partition number for the extended partition, and then click <B>Go</B>. Doing this reads the first Partition Table entry in the extended partition.</P>
<P>    3.    You can walk the extended partition to find the logical drive whose Partition Boot Sector you want to back up. When you walk the extended partition, view the information for Partition 1 and click <B>Go</B> to read the Partition Boot Sector. You can use the <B>Search</B> function on the <B>Tools</B> menu to find each Partition Boot Sector. See "Finding a Partition Boot Sector," presented later in this chapter, for information about finding these disk sectors.</P>
<P>You can also print a map of the disk by using the DiskMap utility, which provides you with the address of the Partition Table entry for each logical drive. You can then use DiskProbe to read the first sector of the logical drive whose Partition Boot Sector you want to back up, and use the <B>Go</B> button to read the Partition Boot Sector.</P>
<P>Once you have read a Partition Boot Sector, on the <B>View</B> menu, click <B>NTFS BootSector</B> or <B>FAT BootSector</B> to see the information displayed appropriately. Make sure that the sector you just read looks like a Partition Boot Sector, as described within Chapter 3, "Disk Management Basics." </P>
<P>    4.    On the <B>File</B> menu, click <B>Save As</B>. Enter the filename. Consider saving the file to the Emergency Repair Disk, the Windows&nbsp;NT startup floppy disk, or the MS-DOS bootable floppy disk. When you are saving a Partition Boot Sector, using a name such as PBS<I>ssssssss</I>DISK<I>n</I>.dsk, where <I>ssssssss</I> is the relative sector of the Partition Boot Sector and <I>n</I> is the disk number, can help you remember what all of the files contain.</P>
<H5 CLASS="h4"><A NAME="sec13"></A>To restore the Partition Boot Sector for a primary partition by using Physical Drive</H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    On the <B>Drives</B> menu, click <B>Physical Drive</B>. In the <B>Available Physical Drives</B> group box, the disks are listed as PhysicalDrive<I>n</I>, where n=0 for the first hard disk. Double-click the disk that contains the Partition Boot Sector that you want to replace.</P>
<P>    3.    In the <B>Handle 0</B> group box, clear the <B>Read Only</B> check box, click <B>Set Active, </B>and click <B>Close</B>.</P>
<P>    4.    If you know the address of the sector you need to write, skip to step 6. To use DiskProbe to compute the sector, first read the Partition Table and view it by using the procedure in "Displaying and Using the Partition Table," presented earlier in this section. Figure 7.3 shows the DiskProbe Partition Table view.</P>
<P>    5.    In the <B>Partition table index</B> list box, double-click the partition number for the Partition Boot Sector that you want to replace. For example, to view information about the Partition Boot Sector for the system partition, double-click the partition number that has the <B>Boot Indicator</B> set to <B>SYSTEM</B>.</P>
<P>The <B>Relative Sector</B> field contains the sector number for the Partition Boot Sector. Write down this number.</P>
<P>    6.    On the <B>File</B> menu, click <B>Open</B>, and enter the filename of the file that contains the Partition Boot Sector. Open the file. Verify that it looks like a Partition Boot Sector. </P>
<P>    7.    On the <B>Sectors</B> menu, click <B>Write</B> to display the <B>Write Sector</B> dialog box. In the <B>Starting sector to write data</B>, enter the sector number from step 5 (or that you already know is the correct sector). Click the option button for the disk to which you want to write the sector. Click <B>Write it</B>.</P>
<P><img src="xsr_h14.gif"></P>
<P>    8.    DiskProbe displays a message box so you can verify the information.</P>
<H5 CLASS="h4"><A NAME="sec14"></A>To restore the Partition Boot Sector by using Logical Volume</H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    On the <B>Drives</B> menu, click <B>Logical Volume</B>. In the <B>Logical Volumes</B> list box of the <B>Open Logical Volume</B> dialog box, double-click the logical drive whose Partition Boot Sector you want to restore.</P>
<P>    3.    In the <B>Handle 0</B> group box, clear <B>Read Only,</B> click<B> Set Active</B>, and click <B>Close</B>.</P>
<P>    4.    On the <B>File</B> menu, click <B>Open</B>, and enter the filename of the file that contains the Partition Boot Sector. Open the file. Verify that it looks like a Partition Boot Sector and is 512 bytes. DiskProbe displays an error if the file size is not a multiple of 512.</P>
<P>    5.    On the <B>Sectors</B> menu, click <B>Write</B> to display the <B>Write Sector</B> dialog box. In the <B>Starting sector to write data</B>, enter 0 for the <B>Starting sector to write data</B>. Click <B>Write it</B>.</P>
<P>    6.    DiskProbe displays a message box so you can verify the information.</P>
<H5 CLASS="h4"><A NAME="sec15"></A>To restore the Partition Boot Sector in an extended partition by using Physical Drive</H5><P>    1.    If you know the address of the Partition Boot Sector that you want to restore (which you would know if the sector number is part of the filename), follow the procedure for restoring the Partition Boot Sector (given earlier in this chapter) for a primary partition, skipping steps 4 and 5. You are done.</P>
<P>If you do not know the address, you can find it by walking the extended partition. Follow steps 1 through 3 in the procedure for backing up the Partition Boot Sector for an extended partition (given earlier in this chapter). Even though the Partition Boot Sector that you read is the one you want to replace, when you read it, DiskProbe displays its relative sector number. Write down this number.</P>
<P>You can also calculate the address of the Partition Boot Sector by using a DiskMap output for the disk. The sector number for a Partition Boot Sector is the address of the EBR for the logical drive + the Relative Sector value.</P>
<P>    2.    In the <B>Handle 0</B> group box of the <B>Open Physical Drive</B> dialog box, be sure that <B>Read Only</B> is cleared.</P>
<P>    3.    On the <B>File</B> menu, click <B>Open</B>, and enter the filename of the file that contains the Partition Boot Sector. Open the file. Verify that it looks like a Partition Boot Sector. </P>
<P>    4.    On the <B>Sectors</B> menu, click <B>Write</B> to display the <B>Write Sector</B> dialog box. In the <B>Starting sector to write data</B>, enter the sector number that you found in step 1. Click the option button for the disk to which you want to write the sector. Click <B>Write it</B>.</P>
<P>    5.    DiskProbe displays a message box so you can verify the information.</P>
<P CLASS="t">If you formatted an NTFS volume when running Windows&nbsp;NT version 4.0, a backup of the Partition Boot Sector for NTFS primary partitions and logical drives is located at the end of the partition or logical drive. Earlier versions of Windows&nbsp;NT put the backup at the center of the volume. If you did not make a backup of the Partition Boot Sector, you can find the backup sector and copy it to the first sector of the volume. </P>
<H5 CLASS="h4"><A NAME="sec16"></A>To restore the backup NTFS Partition Boot Sector</H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    "Finding a Partition Boot Sector," presented later in this chapter, describes different methods for finding the Partition Boot Sector. When you find a Partition Boot Sector within the boundaries of an NTFS volume, make sure that the data are reasonable for the volume. If you have a deleted volume, or extended an NTFS volume, there might be old, invalid, Partition Boot Sectors on the disk. Save the backup to a disk.</P>
<P>    3.    Close any handles that you opened to find the backup. </P>
<P>    4.    On the <B>Drives</B> menu, click <B>Logical Volume</B>. Click the <B>Close Handle </B>button for any drives or logical volumes that are currently open. In the <B>Logical Volumes</B> list box of the <B>Open Logical Volume </B>dialog box, double-click the logical drive whose Partition Boot Sector you want to restore.</P>
<P>    5.    In the <B>Handle 0</B> group box, clear <B>Read Only</B> and click<B> Set Active</B>. Click <B>OK</B>.</P>
<P>    6.    On the <B>File</B> menu, click <B>Open</B>, and enter the name of the file you copied to disk in step 2. Open the file.</P>
<P>    7.    On the <B>Sectors</B> menu, click <B>Write</B> to display the <B>Write Sector</B> dialog box. Since you are going to be writing to relative sector 0, make sure that the active handle is a drive letter, not PhysicalDrive<I>n</I>. Enter 0 for the <B>Starting sector to write data</B>. Click <B>Write it</B>. </P>
<P>    8.    DiskProbe displays a message box so you can verify the information.</P>
<H4 CLASS="h3"><A NAME="sec17"></A>Finding a Partition Boot Sector </H4><P CLASS="t">This section discusses some approaches for finding primary partitions and logical drives on your disk in order to repair the Partition Table, which is discussed in "Editing and Repairing the Partition Table," presented later in this chapter.</P>
<P CLASS="t">When you are looking for Partition Boot Sectors in order to repair the Partition Table, you know that some information is wrong or missing. Therefore, you need to verify that the information you use to find a Partition Boot Sector, or a Partition Table in an extended partition, is accurate. For example, if you use the <B>Number of Sectors</B> field for one primary partition to calculate the location of the Partition Boot Sector for the next partition, make sure that there is a valid Partition Boot Sector at that sector.</P>
<P CLASS="t">The easiest way to find the start of a primary partition is to find the Partition Boot Sector for the partition. For an extended partition, subtract the sectors per track from the address of the Partition Boot Sector to find the Partition Table entry for the logical drive.</P>
<P CLASS="t">The Partition Boot Sector for the first partition on your hard disk is always the first sector on head 1 of cylinder 0. Because disks typically have 32 or 63 sectors per track, you can usually find the Partition Boot Sector for the first partition at either relative sector 32 or relative sector 63. You can get the sectors-per-track information by clicking <B>Volume Information</B> on the <B>Drives</B> menu.</P>
<P CLASS="t">If you think that the relative sector field for a partition or logical drive is correct, you can read the sector by clicking <B>Go</B> when you are viewing its information to see if it looks like a Partition Boot Sector. </P>
<P CLASS="t">There is also a <B>Total Sectors</B> field on the Partition Table view. If you think this field is accurate, you can use this value to calculate the start of the next primary partition or logical drive.</P>
<P CLASS="t">The FAT and NTFS Partition Boot Sectors each have a field that contains the total number of sectors. If you already know or have found the start of a partition or logical drive, you can add the number of sectors to the starting sector to find the start of the next partition or logical drive. For an NTFS Partition Boot Sector, on the <B>View</B> menu, click <B>NTFS BootSector</B>. The <B>Total sectors</B> field contains the value you want. For a FAT volume, on the <B>View</B> menu, click <B>FAT Bootsector</B>. If the size of the primary partition or logical drive fits in 16 bits, the <B>Small sectors</B> field contains the size. Otherwise, the size is in the <B>Large sectors</B> field.</P>
<P CLASS="t">You can also use DiskProbe to search for Partition Boot Sectors. As you find each one, write down its location, and use the Partition Table view in DiskProbe to enter the information. </P>
<P CLASS="t">There are three situations in which you can find a Partition Boot Sector that is not at the beginning of a volume. You need to know about these other Partition Boot Sectors so you do not use the information about where these Partition Boot Sectors are located to repair the Partition Table.</P>
<UL><LI>If you formatted an NTFS volume, or converted a volume from FAT to NTFS when running Windows&nbsp;NT version 4.0, each NTFS volume has a backup of its Partition Boot Sector at the end of the volume. Earlier versions of Windows&nbsp;NT put the backup at the middle of the volume when you formatted it, but did not create a backup when you converted the volume. </LI><LI>When you extend an NTFS volume set, Windows&nbsp;NT version 4.0 puts a new copy of the Partition Boot Sector in the middle of the extended volume set. It does not remove the old copy of the Partition Boot Sector. If you extend a volume set when running Windows&nbsp;NT version 3.51, it does not remove the old copy of the Partition Boot Sector either, nor does it write a new one. </LI><LI>There can be old, invalid Partition Boot Sectors on the disk if you have deleted volumes. </LI></UL><H5 CLASS="h4"><A NAME="sec18"></A>To search for Partition Boot Sectors </H5><P>    1.    In the Resource Kit folder, double-click the DiskProbe icon.</P>
<P>    2.    On the <B>Drives</B> menu, click <B>Physical Drive</B>. The <B>Available Physical Drives</B> in the <B>Open Physical Drive</B> dialog box are listed as PhysicalDrive<I>n</I>, where <I>n</I>=0 for the first hard disk. Double-click the disk that you want to open, click <B>Set Active</B>, and click <B>Close</B>.</P>
<P>    3.    On the <B>Tools</B> menu, click <B>Search</B>. The information that you search for depends upon whether you want to find a FAT or an NTFS Partition Boot Sector. If you check the <B>Search at offset</B> check box and specify an <B>Offset in hex</B> at which to search for a specific value, the search runs much faster than searching each entire sector. You can search the entire disk if you do not change the default values in the <B>First sector to search</B> and <B>Last sector to search</B> fields.</P>
<P>This is an example of a search for an NTFS Partition Boot Sector.</P>
<P><img src="xsr_h15.gif"></P>
<P CLASS="t"><B>Note</B></P>
<P>The contents of the Partition Boot Sector for an NTFS volume can be slightly different, depending on whether you formatted the volume when running Windows&nbsp;NT version 4.0 or earlier versions of Windows&nbsp;NT. If you specify a value in the <B>Offset in hex</B> field, you might need to search at a different offset depending on the data you are searching for, and which version of Windows&nbsp;NT you used to format the volume. For example, the string "discontinguous" starts at location 19A when you use Windows&nbsp;NT version 4.0 to format the volume. But discontinguous is at hex location 195 if you formatted the volume when running Windows&nbsp;NT version 3.5. The string NTFS starts at offset 3, regardless of the version of Windows&nbsp;NT you used to format the volume. If you don't know which version of Windows&nbsp;NT was used to format a volume, search for NTFS. Note that DiskProbe will find matches in sectors that are not Partition Boot Sectors.</P>
<P>    4.    If DiskProbe finds a match, it displays the address of the sector, as the following figure shows:</P>
<P><img src="xsr_h16.gif"></P>
<P>Be sure to verify that each sector DiskProbe finds is really a Partition Boot Sector. The <B>View</B> menu enables you to look at the data as bytes or formatted as an NTFS or a FAT Partition Boot Sector. </P>
<H4 CLASS="h3"><A NAME="sec19"></A>Editing and Repairing the Partition Table </H4><P CLASS="t">You can use DiskProbe to display and change your Partition Table. Repairing a damaged Partition Table is risky, and should never be attempted by a user not familiar with the procedure. If all of the partitions on the disk are primary partitions, the repair process is much simpler than if you have an extended partition, volume sets, stripe sets, mirror sets, or stripe sets with parity.</P>
<P CLASS="t">If the wrong partition is set as the system partition, or you do not have a system partition on the disk, you can use DiskProbe to change this information in the Partition Table. If you have configured your system partition as a mirror set, you need to set the Boot Indicator field on the shadow partition. If this flag is not set and the original partition or the disk with the original partition fails, you will have to use the Windows&nbsp;NT startup floppy disk to start Windows&nbsp;NT. </P>
<P CLASS="t"><B>Note</B></P>
<P>The system partition is always a primary partition. The original partition is the one from which you created the mirror set. The copy of the original partition is called the shadow partition.</P>
<H5 CLASS="h4"><A NAME="sec20"></A>To change or set the Boot Indicator field </H5><P>    1.    View the Partition Table by using the procedure described in "Displaying and Using the Partition Table," presented earlier in this chapter. </P>
<P>    2.    Double-click each partition number in the <B>Partition table index</B> list box to determine which one is the system partition, or that none is set as the system partition. The partition that has the<B> Boot Indicator</B> field set to SYSTEM is the system partition.</P>
<P>    3.    To clear the <B>Boot Indicator</B> field for a partition, double-click its partition number, double-click <B>NOSYSTEM</B> in the <B>Boot Indicator</B> list box. </P>
<P>    4.    To set the system partition, double-click its partition number, and double-click <B>SYSTEM</B> in the <B>Boot Indicator</B> list box. </P>
<P>    5.    Make sure that the disk is in read/write mode. On the <B>Drives</B> menu, click <B>Physical Drive</B> to see the <B>Open Physical Drive</B> dialog box. Clear the <B>Read Only</B> check box, if it is checked. Click <B>Close</B>.</P>
<P>    6.    On the <B>Sectors</B> menu, click <B>Write</B>, and enter 0 in <B>Starting sector to write to</B>. Click <B>Write it</B>.</P>
<P>    7.    DiskProbe displays a message box so you can verify the information.</P>
<P CLASS="t">When you create a volume set, stripe set, mirror set, or stripe set with parity, Windows&nbsp;NT sets the fault tolerant (FT) bit of the System ID byte in the Partition Table. This bit indicates that Windows&nbsp;NT needs to use the Registry key HKEY_LOCAL_MACHINE\SYSTEM\DISK to know how to find all of the members of the volume. Because volumes cannot be accessed without the DISK key, they can only be accessed by Windows&nbsp;NT. In a dual-boot configuration, the other operating system cannot use a partition with the FT bit set. </P>
<P CLASS="t">In general, you should use Disk Administrator, and not DiskProbe, to change the value of this field. You should only change this field to remove the FT flag, and then only to break a mirror set. You might want to set or clear the FT flag to test recovery procedure, but be sure to have a backup of the Registry and the data on the partition before you do so.</P>
<H5 CLASS="h4"><A NAME="sec21"></A>To clear the FT flag for a primary partition </H5><P>    1.    View the Partition Table by using the procedure described in "Displaying and Using the Partition Table," presented earlier in this chapter. </P>
<P>    2.    Double-click the partition number in the <B>Partition table index</B> list box for which you want to change the value of the FT flag.</P>
<P>    3.    If you want to remove the FT flag from a FAT partition, you need to figure out whether the partition should be FAT 12 bit, FAT 16 bit, or FAT Large. See the section titled "System ID Field," within Chapter 3, "Disk Management Basics," for information about the types of FAT partitions. Double-click either <B>FAT 12 bit</B>,<B> FAT 16 bit</B>, or <B>FAT Large</B> in the System ID field.</P>
<P>    4.    If you want to remove the FT flag from a NTFS partition, double-click <B>NTFS</B> in the System ID field.</P>
<P>    5.    Make sure that the disk is in read/write mode. On the <B>Drives</B> menu, click <B>Physical Drive</B> to see the Open Physical drives dialog box. Clear the <B>Read Only</B> check box, if it is checked. Click <B>Close</B>.</P>
<P>    6.    On the <B>Sectors</B> menu, click <B>Write</B>, and enter 0 in <B>Starting sector to write to</B>. Click <B>Write it</B>.</P>
<P>    7.    DiskProbe displays a message box so you can verify the information.</P>
<P CLASS="t">When you have found the Partition Boot Sectors, you can calculate all of the information for the Partition Table entries. If you do not know the values for the number of heads, number of sectors per track, or number of cylinders for the disk, open a handle by clicking either <B>Physical Drive</B> or <B>Logical Volume</B> on the <B>Drives</B> menu, and then click <B>Volume Information</B> on the <B>Drives</B> menu. </P>
<P CLASS="t">If none of the information in your Partition Table is correct, you might be safer to try to do a complete backup of the data on the disk. It might even be faster to backup and restore the data instead of repairing the Partition Table. You can then recreate and reformat the partitions and logical drives, and restore all of the data.</P>
<P CLASS="t"><B>Note</B></P>
<P>If a partition or logical drive extends beyond cylinder 1023, set the Starting and Ending Sector, Head, and Cylinder fields to the maximum values. Maximum values indicate to Windows&nbsp;NT that it needs to use the information in the Partition Boot Sector to know how to access the volume. Remember that your system and boot partitions should not go beyond cylinder 1023 if you have set up your computer to dual-boot MS-DOS or Windows 95.</P>
<H5 CLASS="h4"><A NAME="sec22"></A>Repairing the Partition Table </H5><P>    1.    For primary partitions, view the Partition Table by using the procedure described in "Displaying and Using the Partition Table," presented earlier in this chapter. For an extended partition, the section "Walking an Extended Partition," presented earlier in this chapter, describes finding the Partition Table entry for each logical drive.</P>
<P>    2.    Double-click the partition number for which you want to change information. Enter the new values. </P>
<P>    3.    Make sure that the disk is in read/write mode. On the <B>Drives</B> menu, click <B>Physical Drive </B>to see the<B> Open Physical Drive </B>dialog box. Clear the <B>Read Only</B> check box, if it is checked. Click <B>Close</B>.</P>
<P>    4.    On the <B>Sectors</B> menu, click <B>Write</B>, and enter the sector number of the Partition Table that you read in step 1. If you are changing information for primary partitions, the sector number is 0. Click <B>Write it</B>.</P>
<P>    5.    DiskProbe displays a message box so you can verify the information.</P></BODY></HTML>
