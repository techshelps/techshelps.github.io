<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DiskSave - Back Up and Restore Critical Disk Sectors</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">DiskSave - Back Up and Restore Critical Disk Sectors</H3><P CLASS="t">DiskSave is an MS-DOS-based utility that enables you to save the Master Boot Record (MBR) and Partition Boot Sector (PBS) as binary files. You must start MS-DOS to run this utility. It will not run from the command prompt.</P>
<P CLASS="t">You should save these files to your Windows&nbsp;NT startup floppy disk or your MS-DOS bootable floppy disk. If your computer fails to start because it has a problem using the MBR or PBS, you can restore them and try the startup again.</P>
<P CLASS="t">This tool also enables you to turn off the FT bit in the System ID field of the system partition. You should turn off the bit on the system partition on the shadow disk if you are unable to start Windows&nbsp;NT when the original disk has failed.</P>
<P CLASS="t">The Master Boot Record contains code that the system BIOS on x86-based computers uses to read the Partition Table and find the Partition Boot Sector of the system partition. This sector also contains the Partition Table. If this sector becomes damaged, the computer cannot find or start the operating system.</P>
<P CLASS="t">The Partition Boot Sector contains code that loads the operating system kernel or a boot loader. A corrupt Partition Boot Sector can also cause startup failures.</P>
<P CLASS="t"><B>Note</B></P>
<P>If either of the sectors that you restore does not match the configuration of your computer, you can make your problems worse. Always be sure to save the Master Boot Record and the Partition Boot Sector whenever you make changes that affect them.</P>
<P CLASS="t">These are the DiskSave functions:</P>
<UL><LI>F2, back up the Master Boot Record. This function saves cylinder 0, head 0, sector 1 of the startup disk to the filename that you enter. You need to save a new copy of this record any time that you create or delete a partition, or change the file system used on a partition.</LI><LI>F3, restore the Master Boot Record. This function copies the file that you specify to cylinder 0, head 0, sector 1 of the startup disk. Restoring this sector also replaces the Partition Table. There are no checks to determine if the sector is a valid Master Boot Record.</LI><LI>F4, backup the Partition Boot Sector. This function saves the first sector of the system partition on disk 0 to the filename specified. </LI><LI>F5, restore the Partition Boot Sector. This function replaces the first sector of the system partition with the contents of the specified file. There are no checks to determine if the sector is a valid Partition Boot Sector.</LI><LI>F6, disable fault tolerance on the startup disk. This function is useful when Windows&nbsp;NT will not start from a mirror set of the system partition. The function looks for the system partition. It then checks to see if the System ID byte has the high bit set. Windows&nbsp;NT sets the high bit of the System ID field if the partition is a member of a fault-tolerant volume. Disabling this bit has the same effect as breaking the mirror set. DiskSave does not allow you to reenable the bit once it has been disabled.</LI></UL><P>If you use F6 to turn off the FT bit to be able to start, you still need to break the mirror set after you have started Windows&nbsp;NT. Use Disk Administrator to break the mirror set, which turns off the FT bit in the shadow partition. You need to do this so the Registry and disk information match. </P>
<P CLASS="t">When DiskSave makes calls to the system BIOS, it checks the status of each call. The normal return value is zero. Originally, a nonzero value indicated an error, and the error codes were documented. Currently, there are system BIOSs that return nonzero values, which are not documented. These nonzero values do not seem to be errors. So far, all of these nonzero values that are not errors have occurred when using IDE disks. </P>
<P CLASS="t">If the value is non-zero, DiskSave displays a message at the bottom of the screen. If you see a message about a system BIOS call returning a nonzero value, it would be a good idea to check whether the function worked correctly. One way to check is to start Windows&nbsp;NT, and use the Windows&nbsp;NT-based utility DiskProbe to compare the sector that you tried to save or restore with a copy of the data. For example, if you see a message about a nonzero return code when you select F4 to save the Partition Boot Sector, finish saving the sector to a file. Then, using DiskProbe, read the Partition Boot Sector from disk, and compare the contents to the file that you just saved. </P>
<H4 CLASS="h4"><A NAME="sec0"></A>To use DiskSave to back up the Master Boot Record or Partition Boot Sector </H4><P>    1.    Start MS-DOS. Enter <B>disksave</B> at the command prompt. You now have the following options:</P>
<P>F2 — Backup the Master Boot Record</P>
<P>F3 — Restore Master Boot Record</P>
<P>F4 — Backup the Boot Sector</P>
<P>F5 — Restore Boot Sector</P>
<P>F6 — Disable FT on the Boot Drive</P>
<P>    2.    Press F2 to save the Master Boot Record and F4 to save the Partition Boot Sector. You need to enter the full name for the file, including the path. For example, to save the Master Boot Record to a folder on your C drive, use a name such as C:\Backup\Mbrdisk0.dsk. If you copy it to a floppy disk, the path should be similar to A:\Mbrdisk0.dsk. </P>
<P CLASS="t"><B>Note</B></P>
<P>DiskSave only saves the Master Boot Record on disk 0 and the Partition Boot Sector for the system partition on disk 0.</P>
<H4 CLASS="h4"><A NAME="sec1"></A>To use DiskSave to replace the Master Boot Record or Partition Boot Sector </H4><P>    1.    Start MS-DOS. Enter <B>disksave</B> at the command prompt. You have the following options:</P>
<P>F2 — Backup the Master Boot Record</P>
<P>F3 — Restore Master Boot Record</P>
<P>F4 — Backup the Boot Sector</P>
<P>F5 — Restore Boot Sector</P>
<P>F6 — Disable FT on the Boot Drive</P>
<P>    2.    Press F3 to replace the Master Boot Record and F5 to replace the Partition Boot Sector. You need to enter the full name for the file, including the path. For example, if you have saved the Master Boot Record on your Emergency Repair Disk or the Windows&nbsp;NT startup floppy disk, the path might be A:\Mbrdsk0.dsk. </P>
<P CLASS="t"><B>Note</B></P>
<P>DiskSave only restores the Master Boot Record on disk 0 and the Partition Boot Sector for the system partition on disk 0.</P></BODY></HTML>
