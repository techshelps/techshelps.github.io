<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>winreg: Connecting to the Windows NT Registry</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H2 CLASS="h2">winreg: Connecting to the Windows NT Registry</H2><P CLASS="t">Windows NT 4.0 uses the ACL for <B>winreg</B>, an optional Registry subkey, to determine who can connect to the Registry from another computer. This section explains how to use the <B>winreg </B>subkey ACL to control remote access to the Registry.</P>
<P></P>
<P>Note</P>
<P>The ACL for <B>winreg</B>, not a Boolean value stored in <B>winreg</B>, controls remote access to the Registry. The information in <I>Windows&nbsp;NT Workstation Resource Guide</I>, Chapter 6, "Windows NT Security," is incorrect in this regard.</P>
<P></P>
<P CLASS="t">When a user tries to connect to the Registry remotely, Windows NT looks for the <B>winreg</B> subkey.</P>
<P>     If <B>winreg</B> is in the Registry, the ACL for <B>winreg</B> determines which users can connect to the Registry remotely. To connect to the Registry, users must have at least read/write permission, including permission to create subkeys and set values.</P>
<P>     If <B>winreg</B> does not appear in the Registry, all users can connect to the Registry remotely.</P>
<P></P>
<P CLASS="t">After a user is connected to the Registry, the ACL for each Registry key or subkey determines whether the user can read, edit, add, and/or delete Registry contents.</P>
<P CLASS="t">The <B>winreg</B> subkey must be located in the following Registry path:</P>
<P CLASS="t">HKEY_LOCAL_MACHINE\System<BR>    \CurrentControlSet<BR>        \Control<BR>            \SecurePipeServers<BR>                \winreg</P>
<P CLASS="t">By default, <B>winreg</B> is included in the Registry of Windows NT 4.0 servers only. Administrators can add <B>winreg</B> to the Registry of Windows NT workstations and to the Registry of workstations and servers running Windows NT 3.51 Service Pack 2. </P>
<P></P>
<P>Note</P>
<P>If you add a <B>winreg</B> subkey to the Registry, be sure to add an <B>AllowedPaths</B> subkey under it. Failure to do so can disable some system services. The <B>AllowedPaths</B> subkey is described in the following sections.</P>
<P></P>
<P></P>
<P CLASS="t">The default ACL for <B>winreg</B> is as follows:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="239pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Operating system</P></TD><TD VALIGN="TOP"><P>Default ACL</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Windows&nbsp;NT Server</P></TD><TD VALIGN="TOP"><P>Administrators: Full Control</P></TD></TR><TR><TD VALIGN="TOP"><P>Windows&nbsp;NT Workstation</P></TD><TD VALIGN="TOP"><P>(Not in the Registry)</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P> <FONT FACE="Symbol">Û</FONT>    To give a user permission to connect to the Registry remotely</P>
<P>    1.    Start Regedt32.</P>
<P>    2.    Click the <B>winreg</B> subkey to select it.</P>
<P>    3.    On the <B>Security</B> menu, click <B>Permissions</B>.</P>
<P>The ACL for <B>winreg</B> appears in the <B>Registry Key Permissions</B> dialog box.</P>
<P>    4.    Click the <B>Add</B> button in the <B>Registry Key Permissions</B> dialog box.</P>
<P>    5.    Add the user to the <B>winreg</B> ACL and give the user read access. For detailed instructions, click the <B>Help</B> button in the <B>Registry Key Permissions</B> dialog box.</P>
<P>    6.    Double-click the name of the user you just added.</P>
<P>    7.    In the <B>Special Access</B><B> </B>dialog box, select the <B>Set Value</B> and <B>Create Subkey</B>check boxes.</P>
<P>    8.    Click <B>OK</B>, and then click <B>OK</B> again to close the dialog boxes.</P>
<P></P>
<P CLASS="t">If a user does not have sufficient access to <B>winreg</B>, that user may still be able to connect to the Registry. The <B>winreg</B> subkey contains the <B>AllowedPaths</B> subkey, which stores exceptions to the permissions set in <B>winreg</B>.</P></BODY></HTML>
