<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Virtual Server Network Configuration</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Virtual Server Network Configuration</H3><P CLASS="t">Terra Flora uses virtual servers for its division-level IIS servers because it does not want the expense of dedicated IIS servers for the initial rollout. The network configuration of a virtual server on an intranet requires multiple IP addresses and name resolution for each IP address assigned. Figure 5.1 highlights the components in the Terra Flora network that are involved in creating enterprise virtual servers by using Internet Information Server.</P>
<P><img src="xig_d01.gif"></P>
<P>Figure 5.1    Virtual server network overview</P>
<P CLASS="t">The virtual servers are hosted on the computer CANTS40DIV01, which also is a file and print server and a messaging server. Name resolution is provided by CANTS40ENT03. All clients in the network except MS-DOS-based clients can access the virtual servers.</P>
<P CLASS="t">If you use DHCP servers and WINS servers on your network, as Terra Flora does, it is best to avoid using IIS virtual servers.</P>
<P CLASS="t">Virtual servers require you to manually configure Transmission Control Protocol/Internet Protocol (TCP/IP) properties on the computer running Internet Information Server and also to manually configure the name resolution system in use on your network. </P>
<P CLASS="t">DHCP and WINS are designed to work together for automatic name resolution on a network, as explained in Chapter 2. Automatic administration means that name resolution on the network is completely automated. Every time the IIS server starts, it is automatically given an IP address and its name is registered on the WINS servers used throughout the network. This method is demonstrated in "Peer Web Services on an Intranet Desktop" and "Internet Information Server as a Single Intranet Server" in Chapter 4, "Desktop Scenarios." </P>
<P CLASS="t">If you do not use DHCP or WINS servers on your network, installation of Internet Information Server requires manual configuration. Because virtual servers require little additional manual configuration, they are ideal for a network that does not use DHCP or WINS. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>Virtual Server TCP/IP Properties</H4><P CLASS="t">One IP address must be added to the network interface card (NIC) of CANTS40DIV01 for each virtual server. When you assign more than one IP address to a single network interface card , you must disable automatic DCHP configuration. The DHCP server cannot assign multiple IP addresses to the same network interface card. </P>
<P CLASS="t">You enter the IP addresses and all TCP/IP properties for this computer by using the configuration options available when you double-click <B>Network</B> in Control Panel. On the <B>Protocol</B> tab, select <B>TCP/IP protocol</B> and click <B>Properties</B>. Type the first IP address, subnet mask, and the computer's default gateway under <B>Specify an IP Address</B> on the <B>IP Address</B> tab. (See Figure 5.2.)</P>
<P><img src="xig_d02.gif"></P>
<P>Figure 5.2    Setting TCP/IP properties for virtual servers</P>
<P CLASS="t">After you type the first IP address, subnet mask, and default gateway, click <B>Advanced</B> to display the <B>Advanced IP Addressing</B> dialog box, as shown in Figure 5.3. To add IP addresses to your network interface card, click the <B>Add</B> button under <B>IP Addresses</B>.</P>
<P><img src="xig_d03.gif"></P>
<P>Figure 5.3    Adding more than one IP address</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Virtual Server Name Resolution</H4><P CLASS="t">The computer name of the computer hosting the IIS virtual servers is CANTS40DIV01 (see diagram inside the back cover of this book). When you use multiple computer names with multiple IP addresses on the same network interface card, you must configure the WINS server with the computer name/IP address pairs that you will use. Thus, when clients consult a WINS server, the server provides the computer name and IP address for your virtual server. (You can also configure the WINS server to override the default computer name/IP address pair used if only a single IP address is assigned to the network interface card of a computer running Internet Information Server.)</P>
<P CLASS="t">You use the WINS server (CANTS40ENT03 in the Terra Flora diagram) to assign three computer names (NetBIOS computer names) to the three static IP addresses configured on the computer running Internet Information Server. The names in the WINS database will be used by Windows-based clients for name resolution. </P>
<P CLASS="t">Use WINS Manager in the Administrative Tools folder to assign the NetBIOS names to the IP addresses you added to the network interface card of your computer running Internet Information Server. On the <B>WINS Manager Mappings </B>menu, click <B>Static Mappings</B>. In the <B>Static Mappings</B> dialog box, click <B>Add Mappings</B> and add each virtual server's IP address/NetBIOS name pair. After you have added the IP address/NetBIOS name pairs, the mappings appear as shown in Figure 5.4.</P>
<P><img src="xig_d04.gif"></P>
<P>Figure 5.4    Virtual server WINS mapping</P>
<P CLASS="t">When an Internet Explorer client (or other browser) requests a Uniform Resource Locator (URL) that uses a NetBIOS name—such as <B>http://retail</B>—TCP/IP networking on the client automatically consults the WINS server to discover IP addresses. This is illustrated as step 1 in Figure 5.5. The WINS server notifies the client of the IP address assigned to that NetBIOS name (step 2). The client then uses the IP address to make the request to the computer running Internet Information Server (step 3).</P>
<P><img src="xig_d05.gif"></P>
<P>Figure 5.5    WINS resolution for URL that uses NetBIOS computer name</P>
<P CLASS="t">Networks that do not use WINS can use an alternative name resolution system, usually Domain Name System (DNS) servers. DNS servers resolve a domain name—such as retail.terraflora.com—to an IP address. </P>
<P CLASS="t">If you use third-party DNS servers, you manually add a DNS A-type resource record to the zone data file for each virtual server IP address/DNS domain name pair. For more information about DNS resource records and their formats see RFC 883 and RFC 973 or the documentation for your DNS server. </P>
<P CLASS="t">Terra Flora uses both Windows&nbsp;NT WINS servers and Windows&nbsp;NT DNS servers. For example, both a WINS server and a DNS server are on CANTS40ENT03 on the Terra Flora network diagram. Because Terra Flora uses both WINS and DNS, there is no need to create actual DNS database entries for the new servers. Instead, you can provide a form of dynamic DNS by directing the Windows&nbsp;NT Server DNS server to query WINS for name resolution of the terraflora.com domain. </P>
<P CLASS="t">In DNS Manager, right-click the zone that will consult the WINS database for name resolution, and then click <B>Properties</B>. Click the <B>WINS Lookup</B> tab and enter the IP address of the WINS server, as shown in Figure 5.6.</P>
<P><img src="xig_d06.gif"></P>
<P>Figure 5.6    Using WINS with DNS for name resolution</P>
<P CLASS="t">The DNS server automatically consults the WINS server to discover the IP address. For example, a UNIX computer requests the DNS server to resolve retail.terraflora.com to an IP address. Because the DNS server does not have an explicit record for retail.terraflora.com, it queries the WINS server for the name "retail." The WINS server has a static mapping for the NetBIOS name "retail" to the IP address 172.16.32.100 and returns that IP address to the DNS server. The DNS server then resolves the DNS name retail.terraflora.com based on the NetBIOS name mapping in WINS. This NetBIOS-name-to-DNS-name mapping is automatic for all names in the WINS server, including WINS mappings based on automatic IP address assignment by DHCP.</P>
<P CLASS="t">After you finish these configurations, users can then access the Internet Information Server virtual server by using either the NetBIOS name (if WINS is supported on the client) or the domain name (if DNS is supported on the client), as shown in Table 5.2.</P>
<P>Table 5.2    Virtual Server Computer Names Used in URLs</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="67pt" VALIGN="TOP"><COL WIDTH="140pt" VALIGN="TOP"><COL WIDTH="140pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B><BR>NetBIOS name</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Computer name used in URL with WINS name resolution</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Domain name URL used by DNS name resolution</B></P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>RETAIL</P></TD><TD VALIGN="TOP"><P><B>http://retail</B></P></TD><TD VALIGN="TOP"><P>http://retail.terraflora.com</P></TD></TR><TR><TD VALIGN="TOP"><P>SUPPLY</P></TD><TD VALIGN="TOP"><P><B>http://supply</B></P></TD><TD VALIGN="TOP"><P>http://supply.terraflora.com</P></TD></TR><TR><TD VALIGN="TOP"><P>NURSERY</P></TD><TD VALIGN="TOP"><P><B>http://nursery</B></P></TD><TD VALIGN="TOP"><P>http://nursery.terraflora.com</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">For more information on WINS and DNS interoperability, see the <I>Windows&nbsp;NT Server Networking Guide</I>. </P>
<P CLASS="t">If your network contains non-Microsoft DNS servers, you must add a record in the DNS database for each IP address/domain name pair you add. The name resolution process is similar to WINS name resolution. For information about adding a computer to a domain, see your DNS server documentation.</P>
<P CLASS="t">You can also use HOSTS or LMHOSTS files on client computers for name resolution. On frequently accessed servers, this is slightly faster that consulting a WINS or DNS server, and also reduces network traffic. For more information on name resolution by using HOSTS and LMHOSTS files, see the <I>Windows&nbsp;NT Server Networking Supplement</I>.</P>
<P CLASS="t">To complete the creation of the virtual servers, you must now create a home directory for each virtual server, as described in the next section. </P></BODY></HTML>
