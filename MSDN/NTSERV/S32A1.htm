<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Windows 3.1 for MS-DOS Clients</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Installing Windows&nbsp;3.1 for MS-DOS Clients</H3><P CLASS="t">You can install Windows&nbsp;3.1 in similar client environments simply by creating a profile for Windows&nbsp;3.1 users and installing the Windows&nbsp;3.1 environment in the profile. In this way, you can add as many new clients as you need without having to install the Windows&nbsp;3.1 environment with each new addition. Keep in mind, however, that all the clients sharing the profile must be similar enough to share the same startup information.</P>
<P CLASS="t">If the clients are not similar, you create personal copies of profiles. If Windows&nbsp;3.1 is already installed for a profile, and you create a new personal copy of that profile, the Windows&nbsp;3.1 installation is part of the new copy, and you do not have to reinstall it. If you have established a personal copy of a profile and later want to add Windows&nbsp;3.1, you must add it separately for that personal copy of the profile, or delete the personal copy of the profile and create a new one from a profile that does have Windows&nbsp;3.1 installed.</P>
<P CLASS="t">To support Windows&nbsp;3.1 for remoteboot clients:</P>
<UL><LI>Install Windows&nbsp;3.1 files on the remoteboot server. This makes the files easily available for client installations.</LI><LI>Create a profile for Windows&nbsp;3.1 users. Install Windows&nbsp;3.1 once for all clients using the profile.</LI><LI>Install Windows&nbsp;3.1 separately for clients using a personal copy of a profile (if the profile did not support Windows&nbsp;3.1 at the time you made the personal copy). Or, delete the client account and recreate it, making a personal copy of a profile that does support Windows&nbsp;3.1.</LI></UL><H4 CLASS="h3"><A NAME="sec0"></A>Installing Windows&nbsp;3.1 Files on the Server</H4><P CLASS="t">Installing Windows&nbsp;3.1 files on the server makes the files easily available for client installations.</P>
<P CLASS="t"><B>To install Windows&nbsp;3.1 files on the server</B></P>
<P>    1.    Create an MS-DOS profile, if one does not exist. (For details, see "Setting Up and Starting the Remoteboot Service" earlier in this chapter.)</P>
<P>    2.    Boot a remoteboot client that will use Windows&nbsp;3.1, and join it to the MS-DOS profile using Remoteboot Manager. (For details, see "Adding a New Client" earlier in this chapter.)</P>
<P CLASS="t"><B>Note</B></P>
<P>If you will use the shared Windows&nbsp;3.1 profile method for similar clients, assign the client to use a profile, not a personal copy of a profile. If you will use the personal profile user method for different clients, assign the client to use a personal copy of a profile.</P>
<P>    3.    Reboot the client.</P>
<P>At the remoteboot logon prompt (the prompt that first appears when you start the client), supply the name and password of an account that is a member of the Administrators group on the Windows&nbsp;NT Server computer.</P>
<P>    4.    If the client does not have a floppy disk drive, use the floppy disk drive of a server on the network:</P>
<UL><LI>First, at the server (it doesn't have to be the remoteboot server), use File Manager or the <B>net share</B> command to share the server's floppy disk drive.</LI><LI>Then, at the client, use File Manager or the <B>net use</B> command to connect to the shared floppy disk drive.</LI></UL><P>    5.    Put the Windows&nbsp;3.1 Disk 1 in the floppy disk drive.</P>
<P>    6.    Run <B>setup /a</B> on the Windows&nbsp;3.1 Disk 1 and install to C:\Win.</P>
<P>Windows&nbsp;3.1 files are expanded and put into the <I>&lt;systemroot&gt;</I>\Rpl\Rplfiles\Binfiles\Win directory on the remoteboot server.</P>
<P CLASS="t">Continue the installation. Depending on how you want to set up profiles, proceed to "Installing Windows&nbsp;3.1 for a Profile" or to "Installing Windows&nbsp;3.1 for a Personal Copy of a Profile."</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Installing Windows&nbsp;3.1 for a Profile</H4><P CLASS="t">When you install Windows&nbsp;3.1 for a profile, all clients that share that profile use Windows&nbsp;3.1. Also, if you later assign a personal copy of the profile to a client, that client uses Windows&nbsp;3.1.</P>
<P CLASS="t"><B>To install Windows&nbsp;3.1 for a profile</B></P>
<P>    1.    Create a profile for Windows&nbsp;3.1 users on the remoteboot server.</P>
<P>Give the profile a specific name that suggests the Windows version and the operating system associated with it. For example, D62WIN31 tells you that this profile is for MS-DOS 6.2<I>x</I> with Windows version 3.1.</P>
<P>    2.    In Remoteboot Manager, assign a remoteboot client to the new profile (not using a personal copy of the profile).</P>
<P>    3.    Reboot the client.</P>
<P>At the remoteboot logon prompt (the prompt that first appears when you start the client), supply the name and password of an account that is a member of the Administrators group on the Windows&nbsp;NT Server computer.</P>
<P>    4.    On the client, change to the Windows&nbsp;3.1 directory by typing:</P>
<P><B>cd  \win</B></P>
<P>    5.    On the client, run <B>setup /n</B> to install Windows&nbsp;3.1 in C:\Windows (do not choose to upgrade any existing Windows installations). Choose the express installation.</P>
<P>If the client has memory trouble while running Setup, see "Configuring Memory for MS-DOS and Windows&nbsp;3.1" later in this chapter.</P>
<P>    6.    Follow the instructions in the Setup program to modify the Autoexec.bat and Config.sys files.</P>
<P CLASS="t"><B>Note</B></P>
<P>If Setup displays an error message saying that it cannot update your system files on drive C, choose <B>Cancel</B>. This creates Autoexec.win and Config.win files in the C:\Windows directory. Copy these files to C:\Autoexec.bat and C:\Config.sys, respectively.</P>
<P>    7.    Add the following lines to the end of the [386enh] section in the C:\Windows\System.ini file:</P>
<P CLASS="spacing"><BR></P>
TimerCriticalSection=5000
UniqueDosPSP=True
PSPIncrement=2
<P>    8.    Return to the MS-DOS prompt and copy all the files and directories in C:\Windows to C:\Wksta.pro\Win by typing:</P>
<P><B>xcopy  /e  c:\windows  c:\wksta.pro\win</B></P>
<P>This makes the Windows&nbsp;3.1 files available to all remoteboot clients that are joined to the profile.</P>
<P>If the <B>xcopy</B> command does not work on the client, you can copy the files from a command prompt on the server by typing the following command, all on one line:</P>
<P><B>xcopy  /e  c:</B>\<I>systemroot</I>\<B>rpl\rplfiles\machines\</B><I>client</I><B>\</B><I>profile</I><B>\wksta\win<BR>    c:</B>\<I>systemroot</I>\<B>rpl\rplfiles\profiles\</B><I>profile</I><B>\wksta\win</B></P>
<P>where <I>client</I> is the name of the client and <I>profile</I> is the name of the profile.</P>
<P>    9.    Reboot the remoteboot client and log on.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Installing Windows&nbsp;3.1 for a Personal Copy of a Profile</H4><P CLASS="t">If you assign a personal copy of a profile (without Windows&nbsp;3.1) to a client, and then later decide that you want to install Windows&nbsp;3.1 for that client, you can install Windows&nbsp;3.1 separately for this client. Or, delete the client account and recreate it, making a personal copy of a profile that does support Windows&nbsp;3.1.</P>
<P CLASS="t">You may want to install a separate copy of Windows&nbsp;3.1 for a client if the client requires customized Windows&nbsp;3.1 configuration files.</P>
<P CLASS="t"><B>To install Windows&nbsp;3.1 for a personal copy of a profile</B></P>
<P>    1.    On the remoteboot server, assign the remoteboot client to an MS-DOS profile. Specify a personal copy of the profile.</P>
<P>    2.    Reboot the client.</P>
<P>At the remoteboot logon prompt (the prompt that first appears when you start the client), supply the name and password of an account that is a member of the Administrators group on the Windows&nbsp;NT&nbsp;Server computer.</P>
<P>    3.    On the client, change to the Windows&nbsp;3.1 directory by typing the following:</P>
<P><B>cd  \win</B></P>
<P>    4.    Run <B>setup /n</B> to install Windows&nbsp;3.1 in C:\Windows (do not choose to upgrade any existing Windows installations). Choose the express installation.</P>
<P>If the client has memory trouble while running Setup, see "Configuring Memory for MS-DOS and Windows&nbsp;3.1" later in this chapter.</P>
<P>    5.    Follow the instructions in the Setup program to modify the Autoexec.bat and Config.sys files.</P>
<P CLASS="t"><B>Note</B></P>
<P>If Setup displays an error message saying that it cannot update your system files on drive C, choose <B>Cancel</B>. This creates Autoexec.win and Config.win files in the C:\Windows directory. Copy these files to C:\Autoexec.bat and C:\Config.sys, respectively.</P>
<P>    6.    Add the following lines to the end of the [386enh] section in the C:\Windows\System.ini file:</P>
<P CLASS="spacing"><BR></P>
TimerCriticalSection=5000
UniqueDosPSP=True
PSPIncrement=2

<P>    7.    When the Setup program is finished, reboot the client and log on.</P></BODY></HTML>
