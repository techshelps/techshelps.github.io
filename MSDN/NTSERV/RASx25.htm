<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RAS and X.25 - Evaluation, Implementation, and Troubleshooting for All RAS Versions</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h1>MS RAS and X.25 - Evaluation, Implementation, and Troubleshooting for All RAS Versions</h1>
<p>
<b>Last updated: March 1997</b></p>
<p>
Contributed by Gert C. Gustedt, Technical Content Developer and former Support Engineer specializing in RAS<br>
Microsoft® Enterprise Systems Support </p>
<p>
AT A GLANCE</p>
<table cols=1>
<tr valign=top>
<td width=480><b>Key Point:  Providing detailed X.25 information on all RAS versions for planners, implementers, and troubleshooters</b></td>
</tr>
<tr valign=top>
<td width=480></td>
</tr>
<tr valign=top>
<td width=35%><b>Detail: High</b></td>
<td width=65%><b>Task: Evaluation, planning, troubleshooting</b></td>
</tr>
<tr valign=top>
<td width=480></td>
</tr>
<tr valign=top>
<td width=35%><b>Article Section</b></td>
<td width=65%><b>What's There</b></td>
</tr>
<tr valign=top>
<td width=35%><b>Introduction</b></td>
<td width=65%>This paper consolidates information from many sources including information based on the author's own troubleshooting experience. The goal is to help the planner and support engineer with RAS and X.25. It mentions that Pad.inf and Switch.inf script languages are nearly the same and that the new script language in Windows NT® 4.0 and Windows® 95 is not supported with X.25.</td>
</tr>
<tr valign=top>
<td width=35%><b>List of MS RAS Versions</b></td>
<td width=65%>Lists all RAS versions to date (March 1997)</td>
</tr>
<tr valign=top>
<td width=35%><b>General X.25 Information</b></td>
<td width=65%>Gives an overview of X.25 and RAS, reasons to use X.25 versus ISDN, including how many X.25 connections a RAS server can support simultaneously.</td>
</tr>
<tr valign=top>
<td width=35%><b>Planning an X.25 RAS Client To Server Dial-Up or Direct Connection</b></td><br>
<td width=65%>Discusses X.25-related features and limitations of the different RAS versions, including which versions can become RAS servers, what dial-up scripts exist and which third-party X.25 products are supported.</td>
</tr>
<tr valign=top>
<td width=35%><b>Implementing an X.25 RAS Client-To-Server Dial-Up or Direct Connection</b></td>
<td width=65%>Discusses the RAS after-dialing Terminal screen and how to configure RAS for existing dial-up scripts and how to write new dial-up scripts, if necessary. Explains how to configure direct-connection clients and how to configure RAS servers. Further RAS X.3 specifications and X.28 PAD commands are discussed.</td>
</tr>
<tr valign=top>
<td width=35%><b>Troubleshooting an X.25 RAS Client-To-Server Dial-Up or Direct-Connection</b></td>
<td width=65%>Gives and understanding of what connections the RAS client makes on the way to connecting to the RAS server. Discusses frequent problem areas, including debugging dial-up scripts, how to enable logging of communication between RAS and the PAD and gives some tips on how to troubleshoot the server. It then gives a few problem scenarios and solutions of transmission reliability problems.</td>
</tr>
<tr valign=top>
<td width=35%><b>Appendix A: Windows NT 4.0 Networking Supplement Manual RAS X.25 Chapter</b></td>
<td width=65%>Contains Chapter 9 of the Windows NT 4.0 Supplement Manual covering RAS X.25. </td>
</tr>
<tr valign=top>
<td width=35%><b>Appendix B: General X.3 Parameter Description</b></td>
<td width=65%>Gives a more detailed description (than in the RAS X.3 specifications) of the function of each X.3 parameter.</td>
</tr>
<tr valign=top>
<td width=35%><b>Appendix C: Using Pad.inf with Non-X.25 RAS Connections</b></td>
<td width=65%>Discusses the advantages of Pad.inf versus Switch.inf.</td>
</tr>
<tr valign=top>
<td width=35%><b>Appendix D: List of Electronic and Hardcopy RAS Documentation in the Different RAS Versions</b></td>
<td width=65%>Gives a list of documentation available to help you identify if you have all documentation available for a certain RAS version and where to look for it.</td>
</tr>
<tr valign=top>
<td width=35%><b>Appendix E: Other RAS Sources</b></td>
<td width=65%>Gives pointers to the Microsoft Knowledge Base and TechNet and the Microsoft web site.</td><br>
</tr>
<tr valign=top>
<td width=35%><b>Appendix F: The New Script Language for Windows 95 and Windows NT 4.0</b></td>
<td width=65%>Contains a copy of the Script.doc file included in the Windows NT 4.0 %SystemRoot%\System32\RAS directory and available with Windows 95 Service Pack 1.</td>
<tr valign=top>
<td width=35%><b>Appendix G: Troubleshooting RAS 1.0 and 1.1 on a MS OS/2 1.3 Server Running MS LAN Manager</b></td>
<td width=65%>Has a copy of two Microsoft Knowledge Base articles that focus on troubleshooting a computer running MS OS/2 1.3 with LAN Manager 2.1 or later and RAS 1.0 or 1.1 installed.</td>
</tr>
<tr valign=top>
<td width=35%><b>Legal Disclaimers</b></td>
<td width=65%>Contains all the legal disclaimers pertaining to this document.</td>
</tr>
</table><br>
<h2>Introduction</h2>
<p>
In many organizations, computers run different versions of Remote Access Service (RAS). This makes the job harder for the planner and support engineer because it requires knowing all about all the versions, and this material is scattered through the manuals, the help and Readme files, the Microsoft (MS) Knowledge Base, the Pad.inf and Switch.inf files, and the Script.doc file (Windows 95 and Windows NT 4.0). This article is designed to be a Remote Access Service X.25 reference that addresses common network questions related to all versions of RAS current at the time of writing (March 1997). To help its target audience (CIO, MIS, or help desk employees) it incorporates the most useful information and provides other helpful material that cannot be found even in the usual sources. Even though this paper focuses on X.25 issues, many sections relating to writing and troubleshooting Pad.inf scripts also apply to Switch.inf scripts in RAS 1<i>.x</i>, Windows for Workgroups 3.11 and Windows NT 3<i>.x</i> because the script language is the same. (For more information on writing Switch.inf scripts see the MS Knowledge Base or the RAS online help.)</p>
<p>
For convenience and to assist with planning, a copy of the Windows NT 4.0, Networking Supplement, Chapter 9, titled X.25 PAD Support is included.</p>
<p>
Appendix E lists manuals (including on-line sources, when possible) for the different RAS versions. Microsoft recommends that you refer to the manuals that pertain to your RAS versions in addition to this article.</p>
<p>
Not covered in-depth is the new script language for Windows 95 and Windows NT 4.0. Windows 95 has not been tested with X.25 dial-up, though it may work, and Windows NT 3<i>.x</i> and 4.0 do not support the use of the new script language inside the Pad.inf file. (However, Windows NT 4.0 supports the new script language in regular RAS script files for PPP and Slip dial-up which is not the topic of this article.) The new script language is more intuitive, very similar to BASIC and C, and is well described in Script.doc, which you can find in Appendix F. Three example script files are included with Windows NT 4.0: Pppmenu.scp, Slip.scp, Slipmenu.scp. These three files and Script.doc are in the Windows NT 4.0 %SystemRoot%\System32\RAS directory. </p>
<p>
Troubleshooting RAS 1.0 and 1.1 for Microsoft OS/2 version 1.3 is mainly covered in Appendix G because most OS/2 implementations have been upgraded to Windows NT. For more information on RAS for Microsoft OS/2 (v. 1.3) versions 1.0 and 1.1 see the Microsoft Knowledge Base.</p>
<h3>List of Microsoft Remote Access Versions</h3>
<p>
Microsoft Remote Access for MS-DOS, versions 1.0, 1.1, and 1.1a</p>
<p>
Microsoft Remote Access for OS/2 (v. 1.3), versions 1.0 and 1.1</p>
<p>
Microsoft Windows for Workgroups version 3.11 (RAS is built-in)</p>
<p>
Microsoft Windows 95 (RAS is built-in under the name &ldquo;Dial-Up Networking&rdquo;)</p>
<p>
Microsoft Windows NT operating system version 3.1 (RAS is built-in)</p>
<p>
Microsoft Windows NT Advanced Server version 3.1 (RAS is built-in)</p>
<p>
Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0 (RAS is built-in; Windows NT 4.0: &ldquo;Dial-Up Networking&rdquo;)</p>
<p>
Microsoft Windows NT Server versions 3.5, 3.51, and 4.0 (RAS is built-in; Windows NT 4.0: &ldquo;Dial-Up Networking&rdquo;)</p>
<h2>General X.25 Information</h2>
<p>
The following section contains general information about X.25 networks.</p>
<h3>Overview of X.25 Networks</h3>
<p>
An X.25 network transmits data between two computers with a packet-switching protocol. This protocol relies on an elaborate worldwide network of packet-forwarding nodes (DCEs) that can deliver an X.25 packet to its designated address.</p>
<p>
X.25 also requires additional hardware such as an X.25 Smart Card or a PAD. For additional information on hardware requirements, see &ldquo;What Third-Party Products Are Required to Set Up a RAS Connection over X.25&rdquo; below and the Windows NT Server 3.5 and 3.51 Remote Access Service manual, Chapter 6, or the Windows NT Server 4.0 Networking Supplement manual, Chapter 9.</p>
<h3>How RAS Supports X.25 Networks</h3>
<p>
Connecting to a server through an X.25 network is similar to connecting through a phone line. The only difference is that the phone book entry must specify an X.25 PAD type and an X.121 address for the RAS server.</p>
<p>
RAS does not know what medium it is running over. It does not know about the X.25 protocol, just as it does not know about how phone lines and modem</p>
<p>
equipment work on the lower levels. The RAS server uses the Eicon Technology WAN Services Eicon drivers and an internal Eicon X.25 adapter to convert the X.25 protocol to the serial (RS232) protocol signals (and vice versa), or it can send and receive serial signals to and from an external X.25 PAD (packet assembler/disassembler), in which case, no Eicon software and hardware is necessary because the X.25 PAD does the protocol conversion.</p>
<p>
Some RAS client versions can also be configured with the Eicon driver and adapter or the external PAD, but usually the clients use a modem to call the X.25 network provider dial-up PAD, which is also a modem. After the RAS client modem and the X.25 provider dial-up PAD connect, the X.25 provider usually requires callers to identify themselves for billing purposes. To support caller identification, most RAS clients can run a customized command script, and some can also go into an interactive post-connect Terminal mode, to allow the client to send the user name and password.</p>
<h4>Note </h4>
<p>
The external PAD configuration mentioned above is not supported in Windows for Workgroups 3.11, Windows 95, and Windows NT Workstation and Server versions 3.5, 3.51, and 4.0, because they have not been tested. However, there are no known reasons why this external configuration should not work. </p>
<h4>Note</h4>
<p>
You need to purchase an Eicon X.25 adapter card and the specific Eicon WAN Services for your operating system. Since Windows NT version 4.0 the &ldquo;Eicon WAN Adapters&rdquo; card driver ships with Windows NT.</p>
<h3>Reasons to Use RAS with an X.25 Network</h3>
<p>
In addition to transmitting data more reliably than regular phone lines, X.25 connections supply bandwidths of up to 56 kilobytes (K) (64K in Europe). </p>
<h4>How Many X.25 Connections Are Supported by RAS Servers</h4>
<p>
A Windows NT 3.1, 3.5, 3.51, or 4.0 RAS server with Eicon Technologies software and Smart Card installed can host up to 256 RAS client connections over one X.25 line simultaneously. This compares favorably to the expense and space needs of having to purchase and maintain 256 modems and phone lines for the RAS server for regular telephone line connections not using X.25.</p>
<p>
RAS 1.1 for OS/2 (OS/2 version 1.3), version 2.1 or later only supports 13 simultaneous RAS client connections over one X.25 line.</p>
<h4>X.25 Versus ISDN</h4>
<h4>Note</h4>
<p>
In areas where ISDN is available, Microsoft recommends considering the use of ISDN rather than X.25. ISDN is much faster (128kb or more depending on the type of adapter and provider network) without compromising reliability, however, it is likely to be more expensive.</p>
<p>
For additional information on ISDN and RAS, see the Windows NT 3.5 Server &ldquo;Remote Access Service&rdquo; manual, page 8, or the Windows NT 3.5 RAS online Help.</p>
<h2>Planning an X.25 RAS Client to Server Dial-Up or Direct Connection</h2>
<h3>X.25 Related Limitations of Certain RAS Versions</h3>
<h4>RAS 1.0</h4>
<p>
Microsoft RAS version 1.0 does not have the capability to invoke RAS</p>
<p>
Terminal or use scripts in .INF files. It does not support X.25. Upgrades to RAS 1.1 and RAS 1.1a are free.</p>
<h4>RAS 1.1 and 1.1a</h4>
<p>
RAS 1.1 is the first RAS version to support X.25 with a Pad.inf file, however, the syntax in Pad.inf scripts is different from the syntax used in later RAS versions. For more information, see your RAS version 1.1x Pad.inf file, RAS manual, and release notes.</p>
<p>
RAS 1.1x also does not support a RAS Terminal screen (nor the capability to run scripts from a Switch.inf file for use with intermediary security devices). The latter two features were introduced with RAS for Windows For Workgroups 3.11.</p>
<h4>Windows 95</h4>
<p>
Windows 95 was not tested with X.25 RAS Dial-Up Networking and therefore is not supported as a RAS X.25 client, however, it may work. If you want to try RAS X.25 on Windows 95 keep in mind that it does not support the script language used in the Pad.inf and Switch.inf files and that the Pad.inf and Switch.inf files do not exist and cannot be invoked in Windows 95. </p>
<p>
To get support for scripting in non-X.25 environments (for example for Slip or PPP Internet access) in Windows 95, obtain Windows 95 Service Pack 1 (SP1). In the Admin directory of SP1 you can find the scripting tool Script.exe. The Admin directory also contains the Script.doc file that describes the commands and syntax of that new and improved script language which is, however, incompatible with the Pad.inf and Switch.inf script language.</p>
<p>
Windows 95 supports an after-dialing Terminal window for connections to non-X.25 providers. We have received unconfirmed reports from customers attempting to use Windows 95 with X.25 dial-up that there are problems of receiving incomplete text from the provider PAD in the Terminal window. </p>
<h4>Note </h4>
<p>
Windows NT 4.0 supports the script language used in Pad.inf and Switch.inf as well as the new Windows 95 script language. RAS for Windows for Workgroups 3.11 and Windows NT 3.1, 3.5, 3.51, and 4.0 support RAS Terminal screens for X.25 dial-up. Eicon Technologies supports Windows 95 as a non-RAS X.25 client with the OSI PCGATEWAY software which does not allow connections to a Windows NT RAS server.</p>
<h3>Which RAS Clients Support X.25 Dial-Up</h3>
<p>
RAS 1.1x for LAN Manager 2.1 or later (MS-DOS-based or Windows-based)</p>
<p>
RAS 1.1 for LAN Manager for OS/2 (v. 1.3), version 2.1 and later</p>
<p>
RAS for Windows for Workgroups 3.11</p>
<p>
RAS for Windows NT Workstation and Server 3.1, 3.5, 3.51, and 4.0</p>
<h4>Note </h4>
<p>
The Dial-up Networking client (DUN) for Windows 95 has not been tested as an X.25 dial-up client and is therefore not supported in that function, but may work.</p>
<h3>Which RAS Clients Support X.25 Smart Cards (Client and Server function)</h3>
<p>
The following RAS versions can assume the RAS client or RAS server roll:</p>
<p>
RAS 1.1 for LAN Manager for OS/2 (OS/2 v. 1.3), version 2.1 and later</p>
<p>
RAS for Windows NT Workstation and Server 3.1, 3.5, 3.51, and 4.0</p>
<p>
To make Windows NT work with an X.25 SmartCard, install the driver and the X.25 SmartCard from Eicon Technologies in your computer. Windows NT 4.0 ships with the Eicon X.25 driver. The driver is called &ldquo;Eicon WAN Adapters.&rdquo; You do not need to purchase additional software if you have purchased an adapter that is supported by this driver. See &ldquo;What Third-Party Products Are Required to Set Up a RAS Connection over X.25&rdquo; below.</p>
<h3>Which RAS Versions Can Become RAS Servers Using an X.25 Smart Card</h3>
<p>
The RAS versions that can become RAS servers are identical to the ones listed above under &ldquo; RAS Clients Accessing X.25 Through an X.25 Smart Card.&rdquo;</p>
<h4>RAS and External X.25 PADs - Supported Only in Windows NT 3.1</h4>
<p>
RAS for Windows NT 3.1 was the only RAS version tested with an external X.25 PAD (see RAS manual page 34, 37 Figure 6.3). Other versions of RAS may work with an external X.25 PAD, but are not supported in that configuration.</p>
<h3>For Which X.25 Providers Exist RAS Dial-Up Scripts in the Pad.inf File</h3>
<p>
These scripts allow an automatic connection of your RAS client with the RAS server over X.25 dial-up:</p>
<p>
RAS 1.1, Windows for Workgroups 3.11, and Windows NT 3.1 include the following scripts:</p>
<p>
Sprintnet (9600 bps and 2400 bps)</p>
<p>
InfoNet (9600 bps and 2400 bps)</p>
<p>
The following scripts are included with Windows NT 3.5, 3.51, and 4.0, but should work with Windows NT 3.1, too. </p>
<p>
Sprintnet (9600 bps and 2400 bps)</p>
<p>
InfoNet (9600 bps and 2400 bps)</p>
<p>
Compuserve</p>
<p>
SITA Group Network</p>
<p>
Alascom/Tymnet/MCI</p>
<p>
Telematics</p>
<h4>Note </h4>
<p>
These scripts are not required to connect. You can also connect manually by using a RAS Terminal window and typing the required parameters, user name and password. For X.25 providers that are not listed here, you can write your own script or connect manually. To write your own script, see the section titled &ldquo;Writing a Pad.inf script to automate Remote RAS Logons.&rdquo;</p>
<p>
In case there were updates to Pad.inf after this document is published, check the Pad.inf file that is installed with RAS automatically to find out for which X.25 carriers your current RAS version includes scripts. The section title (enclosed in square brackets [ ]) for each script usually indicates the name of the X.25 carrier for which the script was designed, except the section titled Eicon X.PAD which is the X.25 Eicon card script for Windows NT servers and clients that have an Eicon card installed.</p>
<h3>For Which X.25 Cards Exist RAS Scripts in the Pad.inf File</h3>
<p>
Only X.25 cards by Eicon Technologies are supported for RAS over X.25. See the following paragraph for more information on Eicon products. There maybe X.25 cards and drivers available by other companies, however, they have not been tested by Microsoft. Please contact that vendor for support.</p>
<h3>What Third-Party Products Are Required to Set Up a RAS Connection over X.25</h3>
<p>
Microsoft only supports Eicon Technologies hardware and software with RAS over X.25. You only need Eicon products for your RAS X.25 server and RAS X.25 direct-connection clients. RAS Dial-Up clients do not need any additional software or adapters.</p>
<h4>Software</h4>
<p>
To get X.25 support on your Windows NT 3.1, 3.5, or 3.51 server you need to purchase the corresponding version WAN Services for Windows NT from Eicon Technologies. However, in Windows NT 4.0 you do not need to purchase Wan Services For Windows NT (it does not exist). Windows NT 4.0 already ships with the Eicon driver for Eicon X.25 adapters. You can install the adapter driver by running Control Panel and choosing Network. The adapter driver name is Eicon WAN Adapter.</p>
<h4>Driver Versions and Adapter Support</h4>
<p>
For Windows NT 3.51 obtain Eicon Wan Services version 3, release 4a (V3R4A). This version works only on Windows NT 3.51, not on Windows NT 4.0. It supports the following Eicon X.25 adapters:</p>
<p>
PC, HSI, DPNA, MPNA, C21, and S51</p>
<p>
There is a newer version of Wan Services for Windows NT 3.51 known as version 3, release 4c (V3R4C). This version works only on Windows NT 3.51 but has additional adapter support as follows:</p>
<p>
S52, S50, C20</p>
<p>
The Windows NT 4.0 Eicon Wan Adapter driver supports the following adapters: </p>
<p>
C21, S51, PC, HSI, DPNA, and MPNA. </p>
<p>
For a complete up-to-date list contact Eicon Technologies.</p>
<h4>Note</h4>
<p>
At the time of this writing (December 1996) Eicon Technologies stated it was close to releasing a new X.25 Windows NT Server product called Connection For Windows NT 4.0. This software has support for new and faster X.25 adapters and is said to support software compression and other new features. To find out more about this new product contact Eicon Technologies. Contact information is provided below.</p>
<p>
Per Eicon Technologies, Connection For Windows NT 4.0 supports the following adapters:</p>
<p>
All cards the Eicon Wan Adapter in Windows NT 4.0 supports.</p>
<p>
New: C20, S50, S52, and S94.</p>
<h4>Note</h4>
<p>
The S-series of adapters, that is the adapters with an &ldquo;S&rdquo; in the model name, are generally faster (S stands for Server) than those with a &ldquo;C&rdquo; in the model name (&ldquo;C&rdquo; stands for Client) which are designed to be for X.25 clients which do not require as much speed.</p>
<p>
You can contact Eicon Technologies at:</p>
<p>
USA: (214) 239-3270 </p>
<p>
Canada: (514) 745-5500</p>
<p>
Internet: http://www.eicon.com</p>
<p>
E-mail: sales@eicon.com</p>
<p>
On CompuServe, type: go eicon</p>
<h2>Implementing an X.25 RAS Client-to-Server Dial-Up or Direct Connection</h2>
<h3>Creating Reliable Links When Connecting Through Dial-up PADs</h3>
<p>
The following is recommended on all workstations that are going to access a dial-up PAD to connect through X.25 to a RAS server using an Eicon card.</p>
<p>
Establish all modem connections using a reliable link (either V.42, LAPM, or MNP4) and enable hardware handshaking between your local modem and the workstation. Enable these settings by editing the Remote Access entry's modem settings. Select the check box for modem error correction and the check box for hardware flow control.</p>
<p>
Using this feature ensures that there is end-to-end flow control and no data will be lost between the dial-up PAD and the client workstation. You may encounter problems unless these modem settings are made.</p>
<h3>Configuring RAS Clients to Use RAS Terminal After Dialing</h3>
<p>
If RAS does not have an X.25 logon script for your particular X.25 provider (see above &ldquo;For Which X.25 Providers Exist RAS Dial-Up Scripts in the Pad.inf File&rdquo;), you need to write a script or configure RAS to pop up the interactive RAS Terminal screen after dialing to display logon prompts from X.25 providers and allow you to type your logon credentials and other parameters. For more information on writing your own X.25 script see &ldquo;Creating Scripts for the RAS Pad.inf File&rdquo; below.</p>
<p>
RAS 1<i>.x</i> Clients do not have support for a RAS Terminal screen.</p>
<p>
<b>To configure a Windows NT RAS 3.1, 3.5, or 3.51 entry to use RAS Terminal after dialing:</b></p>
<p>
1.In Remote Access, select an entry.</p>
<p>
2.Click Edit.</p>
<p>
3.If the Security button is not available, click the <b>Advanced</b> button.</p>
<p>
4.Click <b>Security</b>. (In Windows NT 3.1 and Windows for  Workgroups 3.11 this button is labeled Switch).</p>
<p>
5.In the After Dialing field, select <b>Terminal</b>. (In Windows NT 3.1 and Windows for Workgroups 3.11 this is labeled Post-Connect).</p>
<p>
6.Click the <b>OK</b> button until you return to the main Remote Access screen.</p>
<p>
<b>To configure a Windows NT RAS 4.0 entry to use Terminal after dialing:</b></p>
<p>
1.On the Windows NT 4.0 desktop, double-click <b>My Computer</b> and then <b>Dial-Up Networking</b>.</p>
<p>
2.In Dial-Up Networking, select a Phonebook entry and then click <b>More</b> and click <b>Edit entry and modem properties</b>.</p>
<p>
3.In the Script tab under After Dialing (Login), click on Pop Up A Terminal Window. </p>
<p>
<b>To configure a Windows 95 Dial-Up entry to use Terminal after dialing:</b></p>
<p>
1.On your Desktop double-click <b>My Computer</b>.</p>
<p>
2.Double-click <b>Dial-Up Networking</b></p>
<p>
3.Double-click <b>Make New Connection</b> and click <b>Configure</b>.</p>
<p>
4.Click the <b>Options</b> tab and click the <b>Bring Up Terminal Window After Dialing</b> check box.</p>
<h3>Configuring a Windows NT 3<i>.x</i> or Windows for Workgroups 3.11 RAS Dial-Up Client to Run a Pad.inf X.25 Script </h3>
<p>
You can configure a RAS entry to run a Pad.inf script after dialing. For example, to automate the task of logging onto a remote host, create the script in the Pad.inf file and then configure the RAS entry to use the created script after dialing. The following steps allow you to connect to an X.25 provider through Windows for Workgroups RAS dial-up. These instructions assume that a dial-up script exists for your X.25 provider:</p>
<p>
1.In Remote Access, do one of the following:</p>
<p>
If you need to add a new RAS Phonebook entry, click Add from the toolbar.</p>
<p>
&ndash; Or &ndash;</p>
<p>
If you want to edit an existing RAS Phonebook entry, click Edit from the toolbar.</p>
<p>
2.In the Phone Book Entry dialog box, if the Advanced button is displayed, select Advanced, otherwise go to step 3.
<ol>
<li>
In the Port field, select the COM port your modem is connected to. </li>
</ol>
<h4>Note</h4>
<p>
Do not select the &ldquo;Any X.25 port&rdquo; option in the Port drop down list unless you are connecting through an Eicon X.25 card instead of a modem.</p>
<p>
4.At the bottom of the Advanced Phone Book Entry dialog box, select X.25.</p>
<p>
5.Fill in the fields in the X.25 dialog box:</p>
<p>
<b>PAD Type</b>: Enter the name of the X.25 provider (for example, SprintNet, InfoNet, or another provider that you added to Pad.inf file manually with a text editor).</p>
<p>
<b>X.121 Address</b>: Provide the RAS server X.121 address</p>
<p>
<b>User Data</b>: Enter any additional connection information required by the X.25 host computer. In Windows for Workgroups RAS Setup or X.25, the User Data field is usually left blank unless additional connection information is required such as a user name to identify the caller to the X.25 provider for billing purposes.</p>
<p>
<b>Facilities</b>: Facility parameters for the X.25 provider. For example, some X.25 providers support the /R parameter to specify reverse charging. Consult the X.25 documentation or provider for more information. Some providers require the user to provide a password which you can enter here if the script you are using specifies the reserved word &ldquo;&lt;facilities&gt;&ldquo; to send the password to the remote X.25 device.</p>
<h4>Note</h4>
<p>
When using a Pad.inf script the &ldquo;PAD Type&rdquo; and &ldquo;X.121 Address&rdquo; are mandatory settings. The &ldquo;User Data&rdquo; and &ldquo;Facilities&rdquo; fields are only used with certain scripts where additional information is required by the X.25 provider.</p>
<p>
For more information, see the RAS Online Help under &ldquo;Setting X.25 Parameters.&rdquo;</p>
<h4>Activating an X.25 Script in Switch.inf instead of Pad.inf in Windows for Workgroups 3.11 RAS </h4>
<p>
In Windows for Workgroups 3.11 RAS, if you have a problem of Pad.inf script files not executing completely, you can try running your X.25 script from Switch.inf after replacing all references to the special Pad.inf macros X25address, Userdata, and Facilities (if applicable) with the actual values because Switch.inf does not support these macros.</p>
<p>
You can configure a RAS entry to run a Switch.inf script before dialing, after dialing, or both. For example, to automate the task of logging onto a dial-up PAD, create the script in the Switch.inf file and then configure the RAS entry to use the created script after dialing.</p>
<p>
<b>To activate a Switch.inf script in Windows for Workgroups version 3.11</b></p>
<p>
1.Run Remote Access and select an entry.</p>
<p>
2.Click the <b>Edit</b> button.</p>
<p>
3.If the <b>Security</b> button is not available, click the <b>Advanced</b> button.</p>
<p>
4.Click the <b>Security</b> button. (In Windows NT 3.1 and Windows for Workgroups 3.11 the button is labeled Switch).</p>
<p>
5.In the <b>After Dialing</b> box, select the name of the script. The section header in the Switch.inf file is what appears as the name of the script. (In Windows NT 3.1 and Windows for Workgroups 3.11 this box is labeled Post-Connect).</p>
<p>
6.Click the <b>OK</b> button until you return to the main Remote Access Screen. When you dial this entry, the selected script runs after RAS dials and connects to the remote host.</p>
<h3>Configuring a Windows NT 3<i>.x</i> RAS X.25 Direct-Connection Client to Run a Pad.inf Script</h3>
<p>
On a direct connect (via an Eicon card) X.25 RAS client you can configure a RAS entry to run a Pad.inf script to call the X.25 RAS server. In most cases you should select the script titled Eicon X.PAD which is for Eicon cards on SprintNet network. If you have an Eicon card, but a different X.25 provider select the Eicon X.PAD script to try it out. If it does not work, see the section titled &ldquo;Writing a script for Direct X.25 Connections&rdquo; below. </p>
<p>
The following steps allow you to connect to an X.25 provider through a Windows NT direct X.25 connection. These instructions assume that a script exists for your X.25 provider:</p>
<p>
1.In Remote Access, do one of the following:</p>
<p>
If you need to add a new RAS Phonebook entry, click <b>Add</b> from the toolbar.</p>
<p>
&ndash; Or &ndash;</p>
<p>
If you want to edit an existing RAS Phonebook entry, click <b>Edit</b> on the toolbar.</p>
<p>
2.In the <b>Phone Book Entry</b> dialog box, if the Advanced button is displayed, select <b>Advanced</b>, otherwise go to step 3.</p>
<p>
3.In the Port field, select an X.25 port which usually appears as a COM port with a high number such as COM3 or COM10 or select &ldquo;Any X.25 port.&rdquo;</p>
<p>
4.At the bottom of the <b>Advanced Phone Book Entry</b> dialog box, select <b>X.25</b>.</p>
<p>
5.Fill in the fields in the <b>X.25</b> dialog box:</p>
<p>
PAD Type: Enter the name of the X.25 provider (for example, SprintNet, InfoNet, or another provider that you added to Pad.inf file manually with a text editor).</p>
<p>
X.121 Address: Provide the RAS server X.121 address</p>
<p>
User Data: Enter any additional connection information required  by the X.25 host computer. In Windows for Workgroups RAS Setup for X.25, the User Data field is usually left blank unless additional connection information is required such as a username to identify the caller to the X.25 provider for billing purposes.</p>
<p>
Facilities: Facility parameters for the X.25 provider. For example, some X.25 providers support the /R parameter to specify reverse charging. Consult the X.25 documentation or provider for more information. Some providers require the user to provide a password which you can enter here if the script you are using specifies the reserved word &ldquo;&lt;facilities&gt;&ldquo; to send the password to the remote X.25 device.</p>
<h4>Note</h4>
<p>
When using a Pad.inf script the &ldquo;PAD Type&rdquo; and &ldquo;X.121 Address&rdquo; are mandatory settings. The &ldquo;User Data&rdquo; and &ldquo;Facilities&rdquo; fields are only used with certain scripts where additional information is required by the X.25 provider.</p>
<p>
For more information, see the RAS Online Help under &ldquo;Setting X.25 Parameters.&rdquo;</p>
<h3>Configuring a Windows NT 4.0 X.25 Client to Run a Pad.inf X.25 Script</h3>
<p>
These instructions apply to RAS Direct-Connection or Dial-Up X.25 clients:</p>
<p>
1.In Dial-Up Networking, select a phonebook entry and then click <b>More</b> and click <b>Edit entry and modem properties</b>.</p>
<p>
2.On the <b>Basic</b> tab under Dial Using, select the X.25 card if you have a direct X.25 connection, or, select the COM port your modem is on, if you are using a dial-up X.25 connection. If you need to configure the entry, click on <b>Configure</b>.</p>
<p>
3.The <b>X.25</b> tab, select your X.25 provider dial-up provider (or Eicon X.PAD for direct connections) and type the X.25 address of the remote server.</p>
<p>
In most cases of direct-connect RAS X.25 client configurations you should select the script titled Eicon X.PAD which is for Eicon cards on SprintNet network. If you have an Eicon card, but a different X.25 provider select the Eicon X.PAD script to try it out. If it does not work, see the section titled &ldquo;Writing a script for Direct X.25 Connections&rdquo; below. </p>
<p>
4.Type additional information in the User Data and Facilities boxes if the Userdata and Facilities variables are used in the script you selected. </p>
<h3>Configuring a RAS Server for an X.25 Network</h3>
<p>
To install RAS, run Control Panel and click Network. In Windows NT 3<i>.x</i> click Add Software. In Windows NT 4.0 click the Services tab and click Add. Then add the Remote Access service. </p>
<p>
To configure your RAS server for an X.25 RAS network, follow the installation instruction for the X.25 adapter and software. As a rule of thumb use the defaults, for example, leave the X.25 COM port (e.g.: COM10) at the default unless you are absolutely sure another COM port number has to be used. </p>
<p>
Also for X.25 Buffering: On each communication port in the Eicon PAD configuration, it is recommended that the packet length supported be left at the default of 128. This will give optimum performance on the server.</p>
<p>
Otherwise, connection problems may occur.</p>
<h4>Windows NT 4.0 RAS Server</h4>
<p>
<b>To configure RAS on Windows NT 4.0 for the X.25 adapter:</b></p>
<p>
1.Install the Eicon adapter in your computer according to your computer manufacturer and Eicon adapter installation instructions.</p>
<p>
Install the Eicon driver by running Control Panel, clicking <b>Network</b>, then <b>Adapters</b>, and then <b>Add</b> and adding the Eicon Wan Adaters driver.</p>
<p>
Configure the driver according to your Eicon WAN Services for Windows NT System Guide or in online Help &ldquo;Help For WAN Services Configuration&rdquo; on how to configure the total number of virtual circuits.</p>
<p>
The sum of the two-way virtual circuits (TVC) and incoming virtual circuits (IVC) in the X.25 configuration screen must equal the number of incoming X.25 clients the server will support at one time. You may have to find out how many TVCs and IVCs your X.25 line has by contacting your X.25 vendor.</p>
<p>
2.Define the number of communication ports to be available for RAS in the XPAD configuration program.</p>
<p>
Click the <b>Network</b> option in Control Panel.</p>
<p>
Click the <b>Services</b> tab.</p>
<p>
If didn't chose to install the Eicon X.PAD services during the Eicon card installation in step1, click the <b>Add</b> button and install the &ldquo;Eicon X.PAD Driver&rdquo; and follow the instructions for rebooting.</p>
<p>
Restart Windows NT and Control Panel Network and click the <b>Services</b> tab. </p>
<p>
Click the <b>Eicon X.PAD Driver</b> in the <b>Network Services</b> list box and click <b>Properties</b>.</p>
<p>
Configure the total number of COM ports by selecting the COM ports from the Available Ports list and then clicking <b>Add</b>.</p>
<p>
It is recommended that the number of communication ports should be equal to the number of virtual circuits (TVC+IVC) configured.</p>
<p>
Click <b>Configure Ports</b> and make sure that the Local Profile and Remote Profile name is RAS. Make changes to the fields in this screen only if you know they are necessary. The default values work with most X.25 networks and RAS.</p>
<p>
3.Configure the number of communication ports (Eicon XPAD's)<b> </b>in RAS using the Network option in Control Panel.</p>
<p>
Run Control Panel and click <b>Network</b> again.</p>
<p>
Click the <b>Services</b> tab, then click <b>Remote Access Service</b>.</p>
<p>
Click <b>Properties</b>, click Add, and then click <b>Install X.25 Pad.</b></p>
<p>
Add an X.25 port to RAS by specifying a port name. Take the default or first available port first to avoid connection problems due to unexpected configurations.</p>
<p>
Specify an X.25 PAD and click <b>OK</b>.</p>
<p>
If you do not see the PAD name you want in the Click X.25 PAD Name box, you can edit the PAD names in Pad.inf. For more information, see the section on X.25 PAD Support in the Windows NT Server Networking Supplement, below in appendix A.</p>
<p>
Make sure the selected ports are configured for dial-in.</p>
<h4>Windows NT 3<i>.x</i> RAS Server</h4>
<p>
When configuring a RAS Server to use X.25 over an EiconCard, several steps must be followed to define the number of clients that can connect to the server.</p>
<p>
1.Define the total number of virtual circuits that the EiconCard will be configured for.</p>
<p>
Click the <b>Network</b> option in Control Panel.</p>
<p>
In the <b>Network Settings</b> dialog box, select the <b>EiconCard</b> driver in the <b>Installed Adapter Cards</b> box.</p>
<p>
Click the <b>Configure</b> button. </p>
<p>
Follow the instructions in your Eicon WAN Services for Windows NT System Guide on how to configure the total number of virtual circuits.</p>
<p>
The sum of the two-way virtual circuits (TVC) and incoming virtual circuits (IVC) in the X.25 configuration screen must equal the number of incoming X.25 clients the server will support at one time. You may have to find out how many TVCs and IVCs your X.25 line has by contacting your X.25 vendor.</p>
<p>
2.Define the number of communication ports to be available for RAS in the XPAD configuration program.</p>
<p>
Click the <b>Network</b> option in Control Panel.</p>
<p>
In the <b>Network Settings</b> dialog box, select the <b>Eicon X.PAD</b> Driver in the <b>Installed Network Software</b> box.</p>
<p>
Click the <b>Configure</b> button. </p>
<p>
Configure the total number of COM ports by selecting the COM ports from the Available Ports list and then choosing the <b>Add</b> button.</p>
<p>
It is recommended that the number of communication ports should be equal to the number of virtual circuits (TVC+IVC) configured.</p>
<p>
3.Configure the number of communication ports (Eicon XPAD's) in RAS using the Network option in Control Panel. Make sure the selected ports are configured for dial-in.</p>
<h4>Configuring the X.25 RAS Server Eicon card to Configure the Client Dial-Up PAD</h4>
<p>
The client dial-up PAD, through which a remote computer connects to the X.25 network, might have previously been set to X.3-parameter values that are incompatible with the Remote Access Service. Therefore, it is important to configure the X.25 smart card on the Remote Access server so that it changes the client PAD&rsquo;s X.3 settings to the values described in &ldquo;X.3 RAS Specifications and Potential Problems&rdquo; Table 9.3 as soon as a connection is established through X.29 commands. To configure an X.25 smart card to make these changes, see the configuration manual for your specific card.</p>
<h4>Note</h4>
<p>
If the X.25 smart card on the server end does not support commands for the X.29 language, the client PAD script must set the X.3 parameters locally. If you have problems, contact the support site for your X.25 smart card vendor.</p>
<h4>Server Bandwidth and the Total Number of Clients</h4>
<p>
To obtain maximum performance in the RAS clients and to ensure reliable connections, ensure that the aggregate throughput of all clients does not exceed the bandwidth of the RAS server.</p>
<p>
For example, four clients running at 2400 bits per second (bps) can be connected to a server with a 9600 bps X.25 line. However, attaching a fifth client at 2400 bps will exceed the server's bandwidth. This will cause all clients to operate at speeds below 2400 bps.  If a virtual circuit, communication port, and RAS port are defined for five ports, then five clients can connect using X.25. However, connecting five clients at one time is not recommended since the throughput of each client will be very low and will cause time-outs in the network protocols running over RAS.</p>
<h3>Configuring Null Modem Connections on X.25 Networks</h3>
<p>
When using a null-modem connection on X.25 networks, the server X.25 port must be set to DCE and the client should be set to DTE. If the port on both computers is set to DTE, you cannot connect.</p>
<p>
The X.25 null modem should be configured for DCE and internal clocking before an X.25 null-modem client can connect. To configure the X.25 null modem, in Control Panel click Network. In the Network Settings dialog box, click the X.25 card driver in the list of adapters, then click Configure. Select the null modem port, click X.25 and change the node type to DCE. Select X.25 and set the clocking to Internal. Save the configuration and restart the system.</p>
<h3>The X.28 Packet Assembler/Disassembler (PAD) and X.3 and X.29 Standards </h3>
<p>
On an X.25 network, a X.28 Packet Assembler/Disassembler (PAD) converts serial signals from the RAS client modem to and from X.25 packet-switched signals for communication with the X.25 host, for example, a RAS server with Eicon WAN services installed. A PAD is similar to a modem in that it has a command mode and a data transfer mode. In command mode the user can issue X.3 commands to the PAD. In data transfer mode the PAD forwards data between the client and the server which can be any equipment that complies with the X.25 standards like Unix TTY hardware and a Unix host or a RAS client and a RAS server with Eicon WAN Services installed. The host must comply with the X.29 standard , which allows the host to configure the dial-up PAD's X.3 parameters remotely. Therefore, the PAD X.3 parameters can be set by the client or by the server. The client or the server can invoke predefined purpose-specific Profiles that configure all X.3 parameters at once. When writing a new RAS Pad.inf script, it can sometimes save code to invoke a Profile first and then set only a couple parameters with the Set command rather than having to use the Set command to set all X.3 parameters individually.</p>
<p>
These X.3 parameters configure the dial-up PAD so that it produces a data stream of required characteristics similar to serial communication where Parity, Data Bits, and Stop Bits are configured. For RAS to work over X.25 the X.3 parameters must be set according to the RAS specifications mentioned below under &ldquo;X.3 RAS Specifications and Potential Problems.&rdquo; The X.3 parameters can be set by the RAS client or the WAN services on the X.25 RAS server (the host) depending on the X.25 provider network functionality. The X.29 standard allows the host to modify the dial-up PAD X.3 parameters over the X.25 network, however, in most RAS Pad.inf scripts, the RAS client sets the X.3 parameters. The RAS client can set the X.3 parameters either in a Terminal window or usually inside a script (see Pad.inf). </p>
<p>
Some X.25 network providers use additional proprietary parameters that are extensions to the standard X.3 set of 22 parameters. For more information on X.3 extionsions, see &ldquo;X.3 RAS Specifications and Potential Problems&rdquo; below. </p>
<p>
Therefore, for RAS X.25 set up and troubleshooting it is important to verify that all X.3 parameters are set correctly. If problems occur they can be caused by setting the X.3 parameters correctly, but failing to configure the X.29 parameters which can override the X.3 parameters or vice versa.</p>
<h4>Important X.28 Commands</h4>
<p>
The RAS client can issue the following commands to the PAD when the PAD is in command mode:</p>
<p>
<b>Set &lt;X.3 parameter A&gt;:&lt;value&gt; [,&lt;X.3 parameter B&gt;:&lt;value&gt;,&lt;X.3 parameter C&gt;:&lt;value&gt;,…]</b></p>
<p>
Sets the PAD X.3 configuration to define the form of the data stream. Multiple parameter/value pairs can be listed on the same line if each pair is separated by a comma.</p>
<p>
<b>Par?</b></p>
<p>
Displays the current settings of all X.3 parameters. This is an important command for verifying X.3 parameter settings during RAS X.25 setup and troubleshooting.</p>
<p>
<b>PROF (identifier)</b></p>
<p>
Invokes a predefined set of values for all or a number of X.3 parameters to prepare the data stream for different types of connections eliminating the need to set X.3 parameters individually.</p>
<p>
<b>PRF?</b></p>
<p>
Displays the current profile settings. This is an important command for verifying X.3 parameters during setup troubleshooting. This command may not work on all X.25 networks.</p>
<p>
<b>RESET</b></p>
<p>
Resets all X.3 parameters back to their default settings. Default settings vary according to vendor equipment used on the particular X.25 network.</p>
<p>
Contact your X.25 network provider for other commands, that the RAS client needs to issue before calling the RAS server. For example, on SprintNet the @ sign configures the PAD to use 8 data bits, the letter D requests 9600 bits per second (bps) communication.</p>
<h4>Important X.28 Service Signals</h4>
<p>
The following are X.28 service signals that a RAS client or Windows Terminal client receives when making a call to the X.121 address of the RAS server X.25 host. One of these signals should appear in the Terminal window or the Device.log file if logging is turned on:</p>
<table cols=2>
<tr valign=top>
<td width=140><b>PAD Service Signal</b></td>
<td width=324><b>Explanation</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=464></td>
</tr>
<tr valign=top>
<td width=140>CLR</td>
<td width=324>Indication that the call has been cleared (not accepted)</td>
</tr>
<tr valign=top>
<td width=140>ERR</td>
<td width=324>A PAD command signal is in error</td>
</tr>
<tr valign=top>
<td width=140>COM</td>
<td width=324>The call is connected</td>
</tr>
</table><br>
<h4>Note </h4>
<p>
Some vendors have non-standard service signals like &ldquo;connected&rdquo; or similar.</p>
<h3>X.3 RAS Specifications and Potential Problems</h3>
<p>
The following table shows the RAS X.3 specifications. This table was taken  from the Windows NT 4.0 Networking Supplement Chapter 9, titled &ldquo;X.25 PAD Support.&rdquo; For a detailed description of the standard 22 X.3 parameters, see &ldquo;Appendix B: General X.3 Parameter Description.&rdquo; Give these specifications to your X.25 provider and the information in the following two paragraphs as well.</p>
<p>
The values set for the X.3 parameters in the following table apply to the X.25 network equipment of most providers, however, there are exceptions. The values in the table are derived from a SprintNet X.25 network. If your X.25 provider has different X.25 equipment the X.3 values may actually specify different unit sizes or may mean &ldquo;off&rdquo; when the same value on SprintNet means &ldquo;on&rdquo;. Therefore, to achieve the same effect as on a SprintNet network you may have to specify values that differ from the values in the table below. </p>
<p>
For example, if you set parameter 4: to 4:1 to set the Idle Timer to an interval of 50 miliseconds on a Sprintnet x.25 network, the same setting of 4:1 may mean an interval of only 20 miliseconds on your x.25 carrier network (e.g. on a SITA Group Network 4:1 means 40 miliseconds as of July 1994). Therefore, parameter 4: should be set to 4:2 in this example (or should be tried at 4:1 or 4:2 for the SITA Group Network). </p>
<p>
As the example demonstrates, it is essential to know how the values for the X.3 parameters on your x.25 carrier network map to those of a SprintNet X.25 network or you may experience connection problems. See your X.25 providers documentation for more specific information on your X.25 network if you have problems.</p>
<p>
A note on syntax. The parameter number is always separated from the parameter value by a colon. for example, to set parameter 1 to a value of 126 you type: </p>
<p>
1:126</p>
<p>
<b>To set parameters 1 and 2 to the value 0 (zero) from within the RAS Terminal Window separate the two parameter/value pairs with a space. For example </b></p>
set 1:0 2:0
</code>
<p>
and press the <b><small>enter</small></b> key.</p>
<p>
<b>X.25 Configuration Values</b></p>
<table cols=1>
<tr valign=top>
<td width=464></td>
</tr>
<tr valign=top>
<td width=168><b>Parameter number</b></td>
<td width=164><b>X.3 parameter</b></td>
<td width=133><b>Value</b></td>
</tr>
<tr valign=top>
<td width=464></td>
</tr>
<tr valign=top>
<td width=168>1</td>
<td width=164>PAD Recall</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>2</td>
<td width=164>Echo</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>3</td>
<td width=164>Data Fwd. Char</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>4</td>
<td width=164>Idle Timer</td>
<td width=133>1</td>
</tr>
<tr valign=top>
<td width=168>5</td>
<td width=164>Device Ctrl</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>6</td>
<td width=164>PAD Service Signals</td>
<td width=133>1</td>
</tr>
<tr valign=top>
<td width=168>7</td>
<td width=164>Break Signal</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>8</td>
<td width=164>Discard Output</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>9</td>
<td width=164>Padding after CR</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>10</td>
<td width=164>Line Folding</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>11</td>
<td width=164>Not Set</td>
<td width=133></td>
</tr>
<tr valign=top>
<td width=168>12</td>
<td width=164>Flow Control</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>13</td>
<td width=164>Linefeed Insertion</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>14</td>
<td width=164>Padding after LF</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>15</td>
<td width=164>Editing</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>16</td>
<td width=164>Character Delete</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>17</td>
<td width=164>Line Delete</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>18</td>
<td width=164>Line Display</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>19</td>
<td width=164>Editing PAD Srv Signals</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>20</td>
<td width=164>Echo Mask</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>21</td>
<td width=164>Parity Treatment</td>
<td width=133>0</td>
</tr>
<tr valign=top>
<td width=168>22</td>
<td width=164>Page Wait</td>
<td width=133>0</td>
</tr>
</table><br>
<h4>Caution:</h4>
<p>
Failure to set these values as shown prevents the Remote Access Service from functioning properly. For information on setting these values, see the instructions with your X.25 smart card.</p>
<p>
Some X.25 network providers use additional proprietary parameters that are extensions to the standard X.3 set of 22 parameters.<b><i> </i></b>Northern Telecom Equipment may support the following X.3 parameter extensions. Not all extended X.3 parameter information was available or confirmed at the time of publishing this paper, therefore, please do not rely on the information in the following table. Instead, please consult your X.25 provider whether extended X.3 parameters are used on the X.25 network. The information in this table is provided as an example only and will be updated as information becomes available.</p>
<p>
<b>Example Extended Parameter Table</b></p>
<table cols=1>
<tr valign=top>
<td width=480></td>
</tr>
<tr valign=top>
<td width=200><b>Extended Parameter Number</b></td>
<td width=280><b>Extended Parameter</b></td>
</tr>
<tr valign=top>
<td width=480></td>
</tr>
<tr valign=top>
<td width=200>113</td>
<td width=280>?</td>
</tr>
<tr valign=top>
<td width=200>114</td>
<td width=280>Abort Output</td>
</tr>
<tr valign=top>
<td width=200>118</td>
<td width=280>Character Delete</td>
</tr>
<tr valign=top>
<td width=200>119</td>
<td width=280>Line Delete</td>
</tr>
<tr valign=top>
<td width=200>120</td>
<td width=280>Line Display</td>
</tr>
<tr valign=top>
<td width=200>121</td>
<td width=280>Additional data forwarding?</td>
</tr>
<tr valign=top>
<td width=200>122</td>
<td width=280>Additional data forwarding?</td>
</tr>
<tr valign=top>
<td width=200>123</td>
<td width=280>Parity on Input data stream; 0 means OFF</td>
</tr>
<tr valign=top>
<td width=200>124</td>
<td width=280>?</td>
</tr>
<tr valign=top>
<td width=200>125</td>
<td width=280>Output Pending Timer</td>
</tr>
<tr valign=top>
<td width=200>126</td>
<td width=280>Linefeed insertion</td>
</tr>
</table><br>
<p>
The SITA Group Network is an X.25 provider that supports these additional parameters and maybe more. Therefore, if your provider equipment uses extended X.3 parameters, it is important for RAS X.25 setup and troubleshooting to verify that all X.3 parameters are set correctly including these extended parameters. If problems occur they can be caused by setting the standard X.3 parameters correctly, but failing to configure the extended X.3 parameters which can override the X.3 parameters or vice versa. For example, the following parameters can cancel each other based on the example table of extended parameters above:</p>
<table cols=2>
<tr valign=top>
<td width=152><b><br>
X.3 Parameter Number</b></td>
<td width=304><b>Corresponding Example Extended Parameter Number</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=456></td>
</tr>
<tr valign=top>
<td width=152>13</td>
<td width=304>126</td>
</tr>
<tr valign=top>
<td width=152>16 </td>
<td width=304>118</td>
</tr>
<tr valign=top>
<td width=152>17</td>
<td width=304>119</td>
</tr>
<tr valign=top>
<td width=152>18</td>
<td width=304>120</td>
</tr>
</table><br>
<p>
Consult your X.25 provider for a complete list of parameters that can cancel each other's effect, if applicable.</p>
<h3>Writing a Script for Direct X.25 RAS Client Connections with Non-Eicon X.25 Cards</h3>
<p>
If you plan on using a non-Eicon X.25 card, verify first that the drivers are available to work with the version of your RAS server.</p>
<p>
If you have a non-Eicon X.25 card in a RAS client, but the Eicon X.PAD script does not work, modify the script according to your X.25 card vendor and your X.25 providers requirements to initialize the PAD and make the X.121 address call to the RAS server. To do that, first make a copy of the Eicon X.PAD script and copy it to the end of Pad.inf. Rename the script title so that it is unique in Pad.inf and then start modifying the copied script.</p>
<p>
For more information on modifying Pad.inf scripts, read the section below titled &ldquo;Writing a Pad.inf Script to Automate Remote RAS Logons.&rdquo;</p>
<h3>Automating Remote RAS Logons Using Pad.inf Scripts</h3>
<h4>Use an Existing Script or Write a New Script</h4>
<p>
Instead of using the interactive RAS Terminal screen, you can automate the logon process to X.25 providers by using an existing script in the Pad.inf file if you are using an X.25 provider for which a script is provided. See the section above &ldquo;For Which X.25 Providers Exist RAS Dial-Up Scripts in the Pad.inf File&rdquo;. Keep in mind that these scripts are provided only for your convenience and are not guaranteed by Microsoft to work because X.25 providers may change or upgrade their equipment at any time which may cause the requirements for scripts to change, in effect making the scripts obsolete. If this is the case in your situation or if your X.25 provider is not listed at all you can create a modified or new script in the Pad.inf file yourself. </p>
<p>
Pad.inf was specifically designed for X.25 scripts, but most of the information pertaining to Pad.inf scripting also applies to Switch.inf scripting. However, Pad.inf supports a few more features and has a few more requirements. If you have problems using Pad.inf under Windows for Workgroups please see &ldquo;Potential Pad.inf Problem in Windows for Workgroups&rdquo; below in the Troubleshooting section.</p>
<h4>Creating Scripts for the Ras Pad.inf File</h4>
<h4>Note </h4>
<p>
In Windows NT version 4.0, you must use the script language described in this section if you are planning to use Pad.inf for X.25 dial-up. The new and improved script language described in Script.doc in Appendix F (also in the Windows NT 4.0 %SystemRoot%\System32\RAS directory) does not work in Pad.inf. RAS X.25 dial-up has not been tested with the new script language using a regular *.scp file. If you are planning to run your script on a previous version of RAS as well, you must use the Pad.inf script language described in the following paragraphs:</p>
<p>
The Pad.inf file is like a set of small batch files or scripts, all contained in one file separated by script titles called section headers. A Pad.inf script can contain six elements: a section header, comments, commands, responses, response keywords, and reserved macro keywords.</p>
<p>
In addition to dividing the Pad.inf file into individual scripts, section headers start the scripts. Comment lines are used to document the script. Any other line in a script is either a command or a response. A command is issued from the local RAS client. A response is received from the remote device or computer.</p>
<p>
To write an automatic script for your RAS client you must know the required commands and corresponding responses for the intermediary device. The commands and responses must be in the exact order that the device expects to encounter them. Branching statements, such as GOTO or IF command, are not supported by the Pad.inf and Switch.inf script language. The required sequence of commands and responses from the PAD device should be in the device documentation. If you are connecting to a commercial service, the required sequence of commands and responses should also be available from the service support staff.</p>
<p>
The Pad.inf file contains scripts for different X.25 providers or different PADs that the RAS user calls. The scripts are activated by configuring Remote Access Phonebook entries as described under &ldquo;Configuring a Windows NT 3<i>.x</i> or WFWG 3.11 RAS Client for a Pad.inf X.25 Script&rdquo; and &ldquo;Configuring a Windows NT 4.0 RAS Client for a Pad.inf X.25 Script.&rdquo;</p>
<p>
For additional information on writing a Pad.inf script, see the instructions in the Windows NT 3.5 RAS manual, pages 65-67</p>
<h4>SECTION HEADERS</h4>
<p>
A section header marks the beginning of a script, is enclosed in square brackets, and cannot exceed 31 characters. For example:</p>
[Route 66 Login]
</code>
<p>
Each script requires one section header. The section header appears in the RAS Phonebook field allowing you to select RAS Terminal or any other Pad.inf script. For more information, see the &ldquo;Activating Pad.inf Scripts&rdquo; section below.</p>
<h4>COMMENTS</h4>
<p>
Comment lines are preceded by semicolons (;) in the left most margin (column one), are optional, and can be placed anywhere in the file. For example:</p>
;This script was created by Patrick on September 29, 1995</code>
<h4>COMMANDS</h4>
<p>
A command comes from the local computer. A response comes from the remote device or computer. The COMMAND= statement, which can be used in three different ways, is used to send commands to the intermediary device.</p>
<h4>Note </h4>
<p>
Use upper case for all Pad.inf commands.</p>
<p>
<b>DEVICETYPE=pad</b></p>
<p>
DEVICETYPE=pad tells RAS that it is not communicating with a modem which is the default if DEVICETYPE= is completely omitted. Use the string as the first line of your script only if your are writing a new script for communication with an X.25 adapter.</p>
<p>
<b>DEFAULTOFF=</b></p>
<p>
DEFAULTOFF= by itself specifies that no default off commands are going to be send to the PAD. This command allows you to specify a custom macro, but is usually only used in the Modem.inf file. See the Modem.inf file for examples.</p>
<p>
<b>MAXCARRIERBPS=&lt;bits per second&gt;<br>
MAXCONNECTBPS=&lt;bits per second&gt;</b></p>
<p>
The MAXCARRIERBPS=&lt;bits per second&gt; and MAXCONNECTBPS=&lt;bits per second&gt; should be specified for every X.25 script. These parameters specify a bits-per-second (bps) rate, however, these rates are not dictating the actual maximum carrier or connect rate. Instead, they indicate to the RAS server to wait for a response from the client as long as it would wait for a response over a connection of that bps rate. For example, the client-server carrier speed may occur at 9600 bps, but both parameters may be set as follows to allow the server to wait longer before timing out:</p>
<p>
<b>MAXCARRIERBPS=1200<br>
MAXCONNECTBPS=1200</b></p>
<p>
The following setting allows the server to time out faster:</p>
<p>
<b>MAXCARRIERBPS=9600<br>
MAXCONNECTBPS=9600</b></p>
<p>
<b>COMMAND=</b></p>
<p>
COMMAND= by itself causes an approximate two second delay, depending on CPU speed and the presence of caching software (for example, SMARTDRV.EXE). If the intermediary device cannot process all of the characters on a COMMAND=&lt;CustomString&gt;&lt;cr&gt; line (because they are sent at once), use multiple COMMAND= statements.</p>
<p>
<b>COMMAND=&lt;CUSTOM STRING&gt;</b></p>
<p>
COMMAND=&lt;custom string&gt; sends the custom string and causes a slight delay of several hundred milliseconds (depending on CPU speed and installed caching software<b><i>)</i></b>. The delay gives the intermediary device time to process the custom string and prepare for the next command.</p>
<p>
<b>COMMAND=&lt;CUSTOM STRING&gt; &lt;cr&gt;</b></p>
<p>
COMMAND=&lt;custom string&gt;&lt;cr&gt; sends the custom string immediately.</p>
<p>
Consult the remote device documentation to determine which strings are required.</p>
<h4>RESPONSES</h4>
<p>
Each command line is followed by one or more response lines. Consult the remote device documentation to determine which response strings and dialogs are expected by the remote device. RAS compares responses received with what you put on the response lines. If it matches, RAS uses the response related keyword and macro.</p>
<h4>RESPONSE KEYWORDS</h4>
<p>
The keyword in a response line specifies what your RAS client does with the responses it receives from the remote computer.</p>
<p>
The response strings your RAS client receives from the remote device or online service can be used with one of the following keywords in response lines:</p>
<p>
<b>OK= remote_device_response &lt;macro&gt;</b></p>
<p>
The OK keyword indicates that RAS can execute the next script line if the condition on the right side of the equal sign is met.</p>
<p>
<b>LOOP= remote_device_response &lt;macro&gt;</b></p>
<p>
The LOOP keyword indicates to RAS to wait for a response that matches the condition to the right of the equal sign and if that condition is met to wait for the same response again. If a response does not meet the condition on the right side of the equal sign RAS executes the next line.</p>
<p>
<b>CONNECT= remote_device_response &lt;macro&gt;</b></p>
<p>
This keyword is used near the end of the script to indicate the end of the script.</p>
<p>
<b>ERROR_NO_CARRIER= remote_device_response &lt;macro&gt;</b></p>
<p>
This keyword is used to test for the presence of a carrier. Intermediary devices report their presence in different ways.</p>
<p>
<b>ERROR_DIAGNOSTICS= remote_device_response &lt;macro&gt;</b></p>
<p>
This keyword can be used in conjunction with the &lt;Diagnostics&gt; macro to allow RAS to display a message box containing a problem cause and diagnostic information.</p>
<p>
These response related keywords are usually clustered, but do not have to be. CONNECT= is usually the last line, unless it is followed by an ERROR_line. For example:</p>
<p>
<b>CONNECT=&lt;match&gt;&ldquo; CONNECT&rdquo;<br>
ERROR_NO_CARRIER=&lt;match&gt;&ldquo;NO CARRIER&rdquo;<br>
ERROR_DIAGNOSTICS=&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;<br>
ERROR_DIAGNOSTICS=&lt;lf&gt;&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;</b></p>
<p>
<b>NoResponse</b></p>
<p>
The RAS client always expects a response from the remote device. The client waits until a response is received unless a NoResponse statement follows the COMMAND= line. If there is no statement for a response following a COMMAND= line, the COMMAND= line still executes, but the script does not execute any further.</p>
<h4>RESERVED MACRO KEYWORDS</h4>
<p>
The macros in the following list are reserved words, which you cannot define in Pad.inf to create a new entry. Reserved words are case insensitive.</p>
<table cols=2>
<tr valign=top>
<td width=122><b>Macro</b></td>
<td width=350><b>Function</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=472></td>
</tr>
<tr valign=top>
<td width=122>&lt;x25address&gt;</td>
<td width=350>Inserts the value you type in the &ldquo;X.121 Address&rdquo; field  (Windows NT 3<i>.x</i>, WFWG 3.11) or &ldquo;Address&rdquo; field (Windows  NT 4.0) of the RAS application (Dial-Up client).</td>
</tr>
<tr valign=top>
<td width=122>&lt;userdata&gt;</td>
<td width=350>Inserts the value you type in the User Data field in the RAS application (Dial-Up client).</td>
</tr>
<tr valign=top>
<td width=122>&lt;facilities&gt;</td>
<td width=350>Inserts the value you type in the Facilities field in the RAS application (Dial-Up client).</td>
</tr>
<tr valign=top>
<td width=122>&lt;cr&gt;</td>
<td width=350>Inserts a carriage return.</td>
</tr>
<tr valign=top>
<td width=122>&lt;lf&gt;</td>
<td width=350>Inserts a line feed.</td>
</tr>
<tr valign=top>
<td width=122>&lt;match&gt;</td>
<td width=350>Reports a match if the string enclosed in quotation marks is found in the device response. For example, &lt;match&gt;&ldquo;Smith&rdquo; matches Jane Smith and John Smith III.</td>
</tr>
<tr valign=top>
<td width=122>&lt;?&gt;</td>
<td width=350>Inserts a wildcard character. For example, CO&lt;?&gt;&lt;?&gt;2 matches COOL2 or COAT2, but not COOL3.</td>
</tr>
<tr valign=top>
<td width=122>&lt;hXX&gt;</td>
<td width=350>Allows any hexadecimal character to appear in a string including the zero byte, &lt;h00&gt;. (XX represents hexadecimal digits)</td>
</tr>
<tr valign=top>
<td width=122>&lt;ignore&gt;</td>
<td width=350>Ignores the rest of a response from the macro. For example, &lt;cr&gt;&lt;lf&gt;CONNECTV-&lt;ignore&gt; reads the following responses as the same: &ldquo;crlfCONNECTV-1.1&rdquo; and &ldquo;crlfCONNECTV-2.3.&rdquo; If a lot of information is ignored, like a large welcome banner, RAS might time out and move on to the next script line. This usually causes problems. To avoid this problem, use multiple pairs of COMMAND= followed by OK=&lt;ignore&gt; to force RAS to wait longer and ignore additional response stings. For example: COMMAND=OK=&lt;ignore&gt; COMMAND= OK=&lt;ignore&gt;</td>
</tr>
<tr valign=top>
<td width=122>&lt;diagnostics&gt;</td>
<td width=350>This macro function can be used in conjunction with the ERROR_DIAGNOSITICS= keyword macro to allow RAS to display a message box containing a problem cause and diagnostic information.</td>
</tr>
</table><br>
<h3>Stepping Through an Example Script</h3>
<p>
This topic describes each part of a relatively long X.25 script for a fictitious X.25 provider. Not every script has to contain as many commands as this one, but for training purposes this type of script is most helpful. Please see the Pad.inf file for the following examples of short scripts: Compuserve or Alascom/Tymnet/MCI.</p>
<p>
Every script must start with a script header followed by DEFAULTOFF=, MAXCARRIERBPS=&lt;baudrate&gt;, and MAXCONNECTBPS=&lt;baudrate&gt; to properly inform the RAS client software of transmission speeds and corresponding expected delays, for example:</p>
<p>
[Fictitious X.25 Provider]</p>
DEFAULTOFF=
MAXCARRIERBPS=9600
MAXCONNECTBPS=9600
</code>
<p>
Next issue a command to the remote computer, followed by one or more response lines. This initial command might be simply to wait for the remote computer to initialize and send its logon banner. The initial command depends on your X.25 carrier equipment. In some cases it is necessary to wait two seconds after making the telephone connection to the X.25 PAD modem so the PAD can initialize and get ready to receive commands from your RAS client. So a COMMAND= to cause a two second delay should be used first in such a case, otherwise not. Note, the COMMAND= is preceded by a line with a semicolon indicating to RAS it is a comment line. Use comments to allow easy debugging in the future. Near the end of this walk-through the comment lines are used instead of regular text:</p>
; Give the PAD 2 seconds time to initialize after the modem connection.
COMMAND=
</code>
<p>
If there is no response expected, RAS needs to be informed about that or it waits forever for a response. So the next line should be:</p>
NoResponse
</code>
<p>
On a computer with a Pentium processor you may need to add another COMMAND= followed by NoResponse to achieve an approximate two second delay since the COMMAND= delay is controlled by CPU speed or slowness not actual time.</p>
<p>
Next the X.25 provider requires you to select 8 data-bit communication and send an &ldquo;@&rdquo; sign to the PAD upon which the PAD is not expected to respond. To delay RAS from moving on to the next command too fast the carriage return (&lt;cr&gt;) is left out:</p>
; set 8 databit mode
COMMAND=@
NoResponse
</code>
<p>
Next a &ldquo;D&rdquo; should be sent to configure the PAD for 9600 baud. However, through testing it was found that the @ command needs about 3 seconds to be processed by the PAD before it is ready to receive the next command; so to give the PAD some more time (about 2 more seconds) in addition to leaving out the &lt;cr&gt; in the previous command, use the following two lines:</p>
<p>
; Delay RAS 2 more seconds to give the PAD time to process previous command</p>
COMMAND=
NoResponse
</code>
<p>
Next send the D without a carriage return to cause RAS to delay moving on to the next command; the response can be ignored:</p>
; D sets 9600 baud on X.25 network
COMMAND = D
OK=&lt;ignore&gt;
</code>
<p>
Next the caller's user id and password need to be entered. </p>
; Enter your user id in the Remote Access program's X.25 Settings &ldquo;User 
; Data:&rdquo; field.
COMMAND=&lt;UserData&gt;&lt;cr&gt;
The response from the PAD after the user ID is not important:
OK=&lt;ignore&gt;
</code>
<p>
Next the caller's password needs to be provided to the X.25 provider. For that the Facilities variable is used which allows the user to enter the password in the RAS user interface:</p>
; Enter your x.25 password in the Remote Access program's X.25 Settings 
; &ldquo;Facilities:&rdquo; field.
COMMAND=&lt;Facilities&gt;&lt;cr&gt;
</code>
<p>
The response should contain the word &ldquo;active&rdquo; if the user ID and password were recognized:</p>
OK=&lt;match&gt;&ldquo;active&rdquo;
</code>
<p>
If the user ID and password are not recognized, the error information provided in the response from the PAD should be displayed by RAS with the help of the &lt;Diagnostics&gt; macro. Since the X.25 equipment error response has two versions (preceded by a different number of carriage returns and line feeds), two error lines are added to make sure both error response versions are received by the RAS client and displayed on the screen:</p>
ERROR_DIAGNOSTICS=&lt;ca&gt;&lt;lf&gt;&lt;cr&gt;&lt;lf&gt;&lt;lf&gt;&lt;Diagnostics&gt;
ERROR_DIAGNOSTICS=&lt;lf&gt;&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;
</code>
<p>
Next profile 6 is invoked to set all 22 (or more) X.3 parameters to values that are close to the X.3 RAS specifications. The few parameters that are known to differ from the X.3 RAS specifications will be set later:</p>
COMMAND=PROF 6&lt;cr&gt;
NoResponse
</code>
<p>
The profile set the X.3 Echo facility to Off (2:0) which prevents responses from the PAD being send to the RAS client. It is important to see the responses from the PAD so problems can be identified, therefore parameter 2 is set to On again:</p>
; turn echo back On to allow PAD responses to be sent to RAS client
COMMAND=SET 2:1&lt;cr&gt;
OK=&lt;ignore&gt;

COMMAND=
NoResponse

; set the standard parameters that the profile didn't set to X.3 RAS specifications yet.
COMMAND=SET 4:1,6:1,16:0,17:0,18:0,19:0,21:0&lt;cr&gt;
OK=&lt;ignore&gt;

COMMAND=
NoResponse

; set certain extended X.3 parameters so they don't undo what the standard 
; parameters were configured for
COMMAND=SET 118:0,119:0,120:0&lt;cr&gt;
OK=&lt;ignore&gt;

COMMAND=
NoResponse
</code>
<p>
If you are in the process of debugging X.3 parameter settings use the following two lines to request the PAD to send all X.3 parameter settings information to the RAS client so you can capture it in the Device.log or Modemlog.txt files.</p>
COMMAND=PAR?
OK=&lt;ignore&gt;

; Call the RAS X25 server
COMMAND=&lt;x25address&gt;&lt;cr&gt;&lt;lf&gt;

; CONNECT response means that the connection completed fine.
CONNECT=&lt;match&gt;&ldquo;COM&rdquo;

; ERROR_DIAGNOISTICS response means connection attempt failed - the X25
;  DIAGNOSTIC information will be extracted from the response and sent
;  to the user.
; ERROR_NO_CARRIER means that the remote modem hung up.
; ERROR responses are for generic failures.
ERROR_NO_CARRIER=&lt;match&gt;&ldquo;NO CARRIER&rdquo;
ERROR_DIAGNOSTICS=&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;
</code>
<p>
; Finally turn echo Off again to comply with X.3 RAS specifications</p>
COMMAND=SET 2:0&lt;cr&gt;
NoResponse

; End of Pad.inf script
</code>
<h4>Creating One Script for Multiple Situations</h4>
<p>
RAS for Windows NT 4.0 supports a new script language that supports subroutines, IF, WHILE, and GOTO command, etc. which allows for complex scripts, however, this script language does not work in the Pad.inf file. It is designed to work with PPP and SLIP dial-up connections in *.scp files invoked in RAS under the Script tab (not the X.25 tab) and has not been tested with X.25 dial-up. Windows 95 supports the same script language, but has not yet been tested with X.25 and therefore is not supported in that environment; however, it may work.</p>
<p>
A company with employees working at different locations may need to provide employees with the ability to log on to an X.25 service from various locations requiring different scripts. Not all employees may have the same RAS versions and the RAS script language on pre-Windows NT 4.0 RAS does not provide any IF, or GOTO statements or support for subroutines. Therefore, you cannot test for logical responses or errors received from a PAD and then branch off to a different execution path. However, the script language does allow you to catch errors and display them on the screen using:</p>
ERROR_DIAGNOSTICS=&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;
</code>
<p>
To provide a variety of RAS clients with a Pad.inf or Switch.inf script you need to write several scripts in the Pad.inf file to manage all local logon dialog variations. For example:</p>
<p>
If you have a Windows for Workgroups 3.11 RAS client or Microsoft RAS 1.1a client, set an environment variable to a value representing the local X.25 carrier. Then run a batch file that copies the correct script to the file name Pad.inf or switch.inf (depending on the value of the environment variable) and then start Windows.</p>
<p>
If you have a Windows NT RAS client, create an icon that runs a similar batch file that tests the environment variable and then runs RAS. All scripts can be provided on one disk and all the user has to do is copy the files to a directory on their hard drive and set the environment variable. This can be automated as well to minimize user interaction.</p>
<h2>Troubleshooting a X.25 RAS Client-to-Server Dial-Up or Direct-Connection</h2>
<p>
The following sections contain formation about X.25 RAS connections.</p>
<h3>Frequent Problem Areas</h3>
<p>
The following are often especially difficult problem areas when implementing a RAS X.25 network:</p>
<p>
On the Client side:</p>
<p>
Writing a new logon script for communication with the dial-up PAD.</p>
<p>
Setting the x.3 paramenters on the x.25 providers network.</p>
<p>
On the Server side:</p>
<p>
The server side usually does not experience difficult problems unless the Eicon software is erroneously changed from the default settings.</p>
<h3>Troubleshooting Connection Problems During Implementation</h3>
<p>
To ensure proper operation of the dial-up X.25 RAS client and server, do the following:</p>
<p>
1.Verify your RAS client can establish a simple RAS link with the RAS server over a regular public switched telephone network (PSTN) using a supported modem. </p>
<p>
This verifies the RAS software on client and server is properly working and the serial port, cable, and modem on the client side are properly configured.</p>
<h4>Note</h4>
<p>
If problems persist over PSTN and you have an internal modem in the client or the serer, test with an external modem. This configuration is usually easier to troubleshoot because the modem can be easily reset by switching it on and off while an internal modem can only be reset completely if the computer is turned off and on again. External modem configurations are also less prone to interrupt and i/o address conflicts.</p>
<p>
To isolate the problem to the client or the server it is often useful to have two RAS clients with different versions of RAS to test with. If the problem occurs with one client and not the other, you know that the server is configured correctly and the client that failed has the problem.</p>
<p>
If problems persist PSTN connections, use the MS RAS troubleshooters and the MS Knowledge Base available on the MS support web site http://www.microsoft.com or query your TechNet CD.</p>
<p>
If simple PSTN connections work and the problems over a X.25 connection persist, the problem lies with the X.25 network or the RAS server X.25 configuration. Read item number 2.</p>
<p>
2.Make sure the Eicon software and hardware is installed on the RAS server without changing any default settings, for example, do not change the COM port numbers Eicon software is configured to use. For example, Eicon WAN Services version 3, release 1 on Windows NT Server 3.51 uses COM10 as the default COM port. If problems persist, read item 3.</p>
<p>
3.Verify that you can type messages back and forth over x.25 using the Windows Terminal (not the RAS after-dialing Terminal window!) application on the client and server side. </p>
<p>
4.If this works but RAS connections do not, the server Eicon software is probably configured correctly and the problem lies with the X.3 parameter settings not matching the RAS specifications. Read item 4.</p>
<p>
5.Verify that your X.25 provider has configured the X.25 network according to the RAS X.3 specifications above or if it is your responsibility to set the X.3 parameters for each call, verify that you are setting them correctly. To resolve this problem, </p>
<p>
If you are using a script:</p>
<p>
Turn on logging on your RAS client (See &ldquo;Enabling Logging and Creating a Device.log file&rdquo; below).</p>
<p>
Insert the command COMMAND=PAR? into your X.25 dial-up script after your X.25 vendor user account name and password and after your attempt to set the X.3 parameters so you can later verify the result of your attempt.</p>
<p>
Call the RAS server to run the script with the PAR? command.</p>
<p>
Verify that the Device.log  or Modemlog.txt file captured the X.3 parameter settings. </p>
<p>
Compare the X.3 parameters in the Device.log  file to the Microsoft X.3 RAS Specifications above and note any mismatches. Be sure to read &ldquo;X.3 RAS Specifications and Potential Problems&rdquo; above.</p>
<p>
If any parameter values are set incorrectly, correct your script in Pad.inf to set them to the correct value. If you are already setting them to the correct value in your script, the problem may be a timing issue where the RAS client is sending the script command too fast for the PAD to process. Adjust your script by inserting more COMMAND= statements to delay RAS and give the PAD more time to process the previous command (See &ldquo;Stepping Through an Example Script&rdquo; above).</p>
<p>
There is also a possibility of you trying to set a parameter that is not changable by users. For example, many X.25 providers have a fixed terminal speed (X.3 parameter 11) and any attempt to change that setting causes an error. Check with your X.25 provider if there are any other X.3 parameters that are &ldquo;frozen.&rdquo;</p>
<p>
If you are using RAS Terminal:</p>
<p>
After you type your X.25 vendor user account name and password and after typing the X.3 parameter settings, type the PAR? command. Write down the resulting PAD response with all the X.3 parameter settings and compare it to the RAS X.3 specifications.</p>
<p>
If any parameter values are set incorrectly, you may not have specified them when you gave the Set command. Be sure to set them to the correct value the next time.</p>
<p>
There is also a possibility of you trying to set a parameter that is not changable by users. For example, many X.25 providers have a fixed terminal speed (X.3 parameter 11) and any attempt to change that setting causes an error. Check with your X.25 provider if there are any other X.3 parameters that are &ldquo;frozen.&rdquo;</p>
<h3>Understanding RAS X.25 Configurations</h3>
<p>
In all troubleshooting, the cause needs to be identified through tests that isolate the problem to the component that is not working properly. To be able to isolate a problem quickly an understanding of the following is helpful and sometimes necessary:</p>
<p>
Hardware and software components and their functionality.</p>
<p>
Required sequence of events and expected feedback from the software.</p>
<p>
Troubleshooting tools available.</p>
<h4>A. Hardware and Software Components of X.25 Configurations</h4>
<p>
Verify that all the following hardware and software components are installed and configured correctly:</p>
<h4>RAS Client </h4>
<p>
Software</p>
<p>
RAS software</p>
<p>
X.25 Logon Script (unless RAS Terminal is used)</p>
<p>
Latest X.25 card driver (if X.25 SmartCard is used and supported in this client)</p>
<p>
Hardware</p>
<p>
Modem</p>
<p>
X.25 SmartCard (if used)</p>
<p>
Phone line</p>
<h4>X.25 Provider</h4>
<p>
Software</p>
<p>
X.3 settings</p>
<p>
X.29 settings</p>
<p>
Hardware</p>
<p>
X.28 Packet Assembler/Disassemblers (PADs)</p>
<h4>RAS Server</h4>
<p>
Software</p>
<p>
RAS software</p>
<p>
X.25 card driver(if X.25 SmartCard is installed)</p>
<p>
Wan Services if applicable</p>
<p>
Hardware</p>
<p>
X.25 SmartCard (unless external PAD is used)</p>
<p>
Cables</p>
<h4>B. The Sequence of Events During RAS X.25 Connections</h4>
<p>
This section has two subsections because the events during RAS X.25 dial-up connections differ from the events during direct RAS X.25 connections (where both the RAS client and the RAS server have an X.25 card installed). Read the section that applies to your configuration.</p>
<h4>X.25 Dial-Up Connections</h4>
<p>
For a successful dial-up RAS connection to a remote network over X.25 to a RAS X.25 server, the RAS client needs to make <b>five</b> successfull connections, that is, the RAS client has to use command mode five times and each time following the command mode switch into a data transfer mode that becomes the command mode for the next connection level. After the fifth connection the user can issue network commands to the remote network or run applications from the remote network:</p>
<p>
Connection I&mdash;Connect to the dial-up PAD of the X.25 provider.</p>
<p>
Connection II&mdash;Authenticate with the X.25 provider software.</p>
<p>
Connection III&mdash;Connect over X.25 to RAS server X.25 adapter.</p>
<p>
Connection IV&mdash;Authenticate with the RAS server service.</p>
<p>
Connection V&mdash;Log on to the remote Windows NT domain.</p>
<p>
These five connection phases can be broken down into the following actions:</p>
<p>
<b>X.25 Dial-Up Connection I</b></p>
<p>
1.The RAS client dials the number for the X.25 service providers dial-up PAD.</p>
<p>
2.The dial-up PAD and the client modem establish a connection. (The RAS server is not involved yet, that is, the RAS server is not aware of the RAS client call to the X.25 dial-up PAD.)</p>
<p>
<b>X.25 Dial-Up Connections II and III</b></p>
<p>
The RAS client supplies miscellaneous information, including but not limited to:</p>
<p>
<b>For X.25 Dial-Up Connection II</b></p>
<p>
PAD configuration parameters to set databits, echo, etc.</p>
<p>
User name to identify the user for billing purposes to the X.25 provider.</p>
<p>
Password to maintain security on the X.25 customer account.</p>
<p>
<b>For X.25 Dial-Up Connection III</b></p>
<p>
X.3 parameters to configure the X.25 network according to RAS specifications.</p>
<p>
The RAS server X.121 address to call the RAS server host PAD configured with Eicon WAN services. The host PAD accepts the X.25 connection and the client and host PADs go into data transfer mode.</p>
<p>
This information is supplied by the RAS client through two methods depending on your configuration:</p>
<p>
The RAS client displays a RAS Terminal window (available in Windows For Workgroups 3.11, Windows 95, Windows NT 3.1, 3.5, 3.51, and 4.0) and the user types the information.</p>
<p>
The RAS client executes a logon script that provides the information with the correct timing which is critical.</p>
<p>
<b>X.25 Dial-Up Connection IV</b></p>
<p>
The RAS client and the RAS server begin the RAS client authentication conversation. If the RAS client is authenticated as an authorized RAS client, the RAS connection is established and the RAS client and server go into data transfer mode.</p>
<p>
<b>X.25 Dial-Up Connection V</b></p>
<p>
The RAS client logs on to the remote domain for network access. RAS 1.1 clients need to log on with the Net Logon command. RAS for Windows for Workgroups 3.11 clients can log on using Log On/Off icon in the Network group in Program Manager. Windows NT RAS clients are logged on automatically with the credentials they provided during system startup, or if those credentials differ from the remote domain credentials are prompted for their credentials for the remote domain when accessing resources that require proper permission.</p>
<p>
<b>X.25 Direct Connections</b></p>
<p>
For a RAS client to connect to a remote Windows NT network over a direct X.25 to X.25 RAS connection between RAS client with a X.25 card installed and RAS server (also using an X.25 card), the RAS client needs to make <b>three</b> successful connections:</p>
<p>
Connection I&mdash;Connect over X.25 to the RAS server Eicon WAN services.</p>
<p>
Connection II&mdash;Authenticate with the RAS server service.</p>
<p>
Connection III&mdash;Log on to the remote Windows NT domain.</p>
<p>
<b>X.25 Direct Connection I</b></p>
<p>
The RAS client issues X.3 PAD configuration parameters to set data bits, echo, etc. and calls the RAS server X.121 address using a script in Pad.inf. The RAS server host PAD configured with Eicon WAN services responds and accepts the X.25 connection. The client and host PADs go into data transfer mode.</p>
<p>
<b>X.25 Direct Connection II</b></p>
<p>
The RAS client and the RAS server begin the RAS client authentication conversation. If the RAS client is authenticated as an authorized RAS client, the RAS connection is established and goes into data transfer mode.</p>
<p>
<b>X.25 Direct Connection III</b></p>
<p>
The RAS client logs on to the remote domain for network access. RAS 1.1 clients for OS/2 need to log on with the Net Logon command. Windows NT RAS clients are logged on automatically with the credentials they provided during system startup, or if those credentials differ from the remote domain credentials are prompted for their credentials for the remote domain when accessing resources that require proper permission</p>
<h3>Troubleshooting Scripts using Device.log and RAS Terminal</h3>
<p>
Before writing scripts to automate the process of logging onto a PAD, use the RAS Terminal feature to familiarize yourself with the logon sequence of events. For more information on activating the RAS Terminal feature, see the section &ldquo;Implementing an X.25 RAS Client-to-Server Dial-Up or Direct Connection&rdquo; above.</p>
<p>
To find errors that prevent your scripts from working, log all information passed between RAS, the modem, and/or the PAD (including errors reported by any other intermediary device in your configuration) by turning on RAS logging (see &ldquo;ENABLING LOGGING AND CREATING A Device.log  FILE&rdquo; in this section below).</p>
<p>
After you enable logging, the Device.log  file is created (when you start RAS) in the Windows NT %systemroot%\SYSTEM32\RAS subdirectory or the Windows for Workgroups \WINDOWS directory.</p>
<p>
If an error is encountered during script execution, execution halts. Determine the problem by studying any RAS error messages that appear on the screen and by studying the Device.log file contents. Make necessary corrections to the script and then restart RAS. If you are running Windows for Workgroups RAS 3.11 and the script execution halts even though you verified all lines to be error free, read the paragraph titled &ldquo;Potential Pad.inf Problem in Windows for Workgroups&rdquo; in the implementation section below.</p>
<p>
The Device.log file appends any communication as long as RAS is not restarted. If you restart RAS, the Device.log  file is erased and re-created. Therefore, if you make changes to Pad.inf during your script development which always require you to restart RAS, and you need to save the current traces contained in the Device.log file, rename the Device.log file before starting RAS again.</p>
<h3>Enabling Logging and Creating a Device.log or Modemlog.txt File</h3>
<p>
<b>To enable logging and create a Device.log  file under Windows NT 3<i>.x</i> or 4.0:</b></p>
<h4>Warning</h4>
<p>
Using Registry Editor incorrectly can cause serious, system-wide problems that may require you to reinstall Windows NT to correct them. Microsoft cannot guarantee that any problems resulting from the use of Registry Editor can be solved. Use this tool at your own risk.</p>
<p>
1.Hang up any connections, and exit from Remote Access.</p>
<p>
2.Run Registry Editor (REGEDT32.EXE).</p>
<p>
3.From the HKEY_LOCAL_MACHINE subtree, go to the following key:</p>
<p>
SYSTEM\CurrentControlSet\Services\RasMan\Parameters</p>
<p>
4.Change the value of the Logging parameter to 1:</p>
Logging:REG_DWORD:0x1</code>
<p>
Logging begins when you restart Remote Access or start the Remote Access Server service (if your computer is receiving calls). You do not need to shutdown and restart Windows NT.</p>
<p>
<b>To enable logging and create a Device.log  file under Windows for Workgroups:</b></p>
<p>
1.Using a text editor such as Windows Notepad, edit the System.Ini file.</p>
<p>
2.In the [Remote Access] section, add the following line:</p>
LOGGING=1.
</code>
<p>
3.Save the file.</p>
<p>
In Windows 95 the Device.log text file is named <b>Modemlog.txt</b> instead and is created in the Windows directory when you restart Windows and RAS.</p>
<p>
<b>To enable logging and create a Modemlog.txt file under Windows 95: </b></p>
<p>
1.On your Desktop double-click <b>My Computer</b>.</p>
<p>
2.Double-click <b>Dial-Up Networking</b></p>
<p>
3.Double-click <b>Make New Connection</b> and click <b>Configure</b>.</p>
<p>
4.Click the <b>Connection</b> tab and click on <b>Advanced</b>.</p>
<p>
5.Click the <b>Record A Log</b> File check box.</p>
<h3>Troubleshooting RAS X.25 Client Pad.inf Script Timing Problems</h3>
<p>
Many script problems occur because of timing problems in the command-response dialog between the RAS client and the dial-up PAD. Often the RAS client sends commands too soon to the dial-up PAD because the PAD is still processing the first command while the second command already arrives from the RAS client. In those cases the second command is lost by the time the PAD becomes available. If the PAD has a buffer to store the command, the timing becomes less of an issue, but most PADs do not have buffers for storing remote commands. </p>
<p>
To diagnose timing problems and measure timing intervals precisely, you may use a serial analyzer such as a Hewlett Packard HP 4957A, but a serial analyzer is not required. Serial analyzers can be expensive relative to using the trial and error method of troubleshooting a script which takes longer, but usually is successful, too.</p>
<p>
To prevent the RAS X.25 client from sending commands too soon, use the COMMAND = without the carriage return macro (&lt;cr&gt;), or the COMMAND = &lt;PAD_X.28_or_other_command&gt; without &lt;cr&gt;, and the LOOP = commands. The tricky part is that the amount of time delayed with these commands varies by the speed of your processor and the presence of caching software in your RAS client. Therefore, on a 386-based computer the COMMAND= and the COMMAND= &lt;PAD_X.28_or_other_command&gt; cause a longer delay than on a 486-based or Pentium-based computer.</p>
<p>
For example, if your Device.log or Modemlog.txt file shows that a certain command in your script is not received by the PAD, insert a &ldquo;COMMAND=&ldquo; line before that command to gain about a 2 second delay. </p>
<p>
For more information, see the text and the examples in the Switch.inf and Pad.inf files in the Windows NT &lt;SystemRoot&gt;\System32\RAS directory.</p>
<p>
After the X.25 provider has given you the commands you need to send from your script or RAS Terminal screen to log on to the dial-up PAD, start out by issuing the commands manually in a RAS Terminal window. Once you verified that this works you can start building a script either from scratch or by copying one of the existing scripts to the end of the Pad.inf file and renaming and modifying that script to suite your X.25 provider equipment.</p>
<h3>Potential Pad.inf Problem in Windows for Workgroups</h3>
<p>
RAS for Windows for Workgroups 3.11 reportedly may under certain circumstances not execute Pad.inf scripts completely even though no error was encountered in the script. If that problem occurs you can try copying your Pad.inf script to the Switch.inf file and replace the special Pad.inf macros X25address, Userdata, and Facilities (if applicable) with the actual values because Switch.inf does not support these macros in Windows for Workgroups. See the section &ldquo;Activating an X.25 Script in Switch.inf in Windows for Workgroups 3.11 RAS.&rdquo;</p>
<h4>Note</h4>
<p>
If you are using Windows for Workgroups make sure that you have the RAS program files with a file date of April 1994 or later installed. The update to these RAS files is free. Call Microsoft Technical Support to obtain these files. These files make RAS memory usage more efficient and eliminate error 640 and other symptoms. For more information see the Microsoft Knowledge Base on www.microsoft.com or your TechNet CD.</p>
<h3>Troubleshooting the X.25 Provider X.3 Parameters</h3>
<p>
See the information provided above under &ldquo;X.3 RAS Specifications and Potential Problems.&rdquo;</p>
<h3>Troubleshooting the RAS X.25 Server During Setup</h3>
<p>
Problem: After calling the RAS server X.121 address the following server PAD response appears on the X.25 provider monitoring equipment: </p>
call cleared - remote directive 
</code>
<p>
(the X.25 provider helpdesk person sees this on the screen) and the RAS Client Device.log file captures: </p>
clr conf
</code>
<p>
Solution: This is a sign of the RAS server Eicon card not being properly initialized. Make sure that the Eicon software is not changed from the default configuration. Verify the COM port used by the Eicon software, for example, COM10, is not changed to another COM port, for example, COM4.</p>
<h4>Eicon Software Trace Utility</h4>
<p>
Eicon Technologies provides the EiconCard Loadable Module Management Utility (ECMODULE) which allows the tracing of all activity on the Eicon card. These traces may have to be interpreted with the help of an Eicon support engineer.</p>
<h3>Troubleshooting Transmission Reliability Problems</h3>
<p>
The following are X.25 troubleshooting tips from the Windows NT 4.0 Help File:</p>
<p>
<b>Problem:</b> After connecting through a dial-up PAD, the server consistently fails to authenticate the client. </p>
<p>
<b>Solution:</b> If the remote access server is running and clients cannot connect to it directly through an X.25 smart card or an external PAD, the dial-up PAD may have the wrong X. 3 parameters or serial settings. Ask your administrator for the correct settings, listed in the Chapter 9 &ldquo;X. 25 PAD Support&rdquo; in the Networking Supplement of Windows NT Server 4.0.</p>
<p>
<b>Problem:</b> A connection has been established, but network drives are disconnecting, and you are dropping sessions or getting network errors. </p>
<p>
<b>Solution:</b> Congestion on the Remote Access server's leased line may be the cause. The administrator should make sure that the speed of the leased line can support all the COM ports at all speeds clients use to dial in.</p>
<p>
For example, four clients connecting at 9600 bps (through dial-up PADS) require a 38,400-bps (four times 9600) leased line on the server end. If the leased line does not have adequate bandwidth, it can cause timeouts and degrade performance for connected clients. This example assumes the Remote Access Service is using all the bandwidth. If it is sharing the bandwidth, fewer connections can be made.</p>
<p>
<b>Problem:</b> While transferring files, you frequently get the error messages &ldquo;Network drive disconnected&rdquo; or &ldquo;Network drive no longer exists.&rdquo; </p>
<p>
<b>Solution:</b> On X. 25 smart cards, change the Negotiate network parameters option in the X. 25 settings to Yes. This problem arises when X.25 parameters, such as the size of the send and receive window, are set differently for the server, the network, and the client X.25 software.</p>
<p>
By enabling the Negotiate network parameters option on the client's (if using the direct X. 25 connection) and the server's X.25 software, you let the server, the network, and the client use commonly negotiated X.25 network parameters.</p>
<p>
Topic 4 is not included here. This topic is better explained with this article.</p>
<p>
<b>Problem:</b> A modem connected to a dial-up PAD connects a lower speed than it should. </p>
<p>
<b>Solution:</b> Replace the modem with a compatible one from the list in the Setup program.</p>
<p>
The following section is from the Windows NT 3.51 and 4.0 RasRead.txt file:</p>
<h4>Troubleshooting Remote Disconnections</h4>
<p>
When a client connection is cleared, the system event log of the RAS server running X.25 can be examined for an error message. The event log can record why the remote client or the remote network disconnected.</p>
<p>
If the remote client (through a dial-up PAD or local PAD) disconnects, the following warning message will appear in the system event log:</p>
<p>
Remote DTE cleared the X.25 call on XPADxxx, X.25 Return Codes: Cause yy (hex) Diagnostic yy (hex)</p>
<p>
The &ldquo;XPADxxx&rdquo; is the port name defined in the XPAD configuration.  &ldquo;yy&rdquo; is a hex string.  For DTE clearing the cause will always be 00. The Diagnostic code can be 00--indicating that the remote client requested a disconnect--or another non-zero value. When the diagnostic code is non-zero it indicates a clearing due to the remote client's dial-up PAD service. Contact the remote client's X.25 service provider to determine the problem.</p>
<p>
If the X.25 network disconnects, the following warning message will appear in the system event log:</p>
<p>
Network cleared the X.25 call on XPADxxx, X.25 Return Codes: Cause yy (hex) Diagnostic yy (hex)</p>
<p>
The &ldquo;XPADxxx&rdquo; is the port name defined in the XPAD configuration.  &ldquo;yy&rdquo; is a hex string. For a network clearing the cause value will always be a non-zero value. The diagnostic code in the cause can be any value. Consult your local X.25 service provider with the cause and diagnostic value to determine the exact reason for the network disconnect.</p>
<h3>Appendix A: Windows NT 4.0 Networking Supplement Manual RAS X.25 Chapter</h3>
<p>
<b>chapter 9 - X.25 PAD support</b></p>

<p>
An X.25 network uses a packet-switching protocol to transmit data. This protocol relies on an elaborate worldwide network of packet-forwarding nodes (Data Communications Equipment [DCEs]) that participate in delivering an X.25 packet to its designated address.</p>

<p>
Dial-up Asynchronous Packet Assemblers/Disassemblers (PADs) constitute a practical choice for Remote Access clients because they don&rsquo;t require an X.25 line to be plugged into the back of the computer. Their only requirement is the telephone number of the PAD service for the carrier.</p>

<h4>Note</h4>
<p>
This Chapter is specific to X.25 PADs. X.25 cards can also be supported through WAN miniport drivers.</p>

<p>
The Remote Access Service lets you access the X.25 network in two general ways:</p>
<table cols=2>
<tr valign=top>
<td width=264><b>Server/Client</b></td>
<td width=200><b>Method of access</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=464></td>
</tr>
<tr valign=top>
<td width=264><p>
Client (for the Windows or Windows&nbsp;NT operating systems)</p>
</td>
<td width=200>Asynchronous Packet Assemblers/Disassemblers (PADs)</td>
</tr>
<tr valign=top>
<td width=264><p>
Server and client (for Windows&nbsp;NT systems only)</p>
</td>
<td width=200>Direct connections</td>
</tr>
</table><br>

<p>
The next section tells how to access the X.25 network in both ways for specific configurations.</p>

<h4>X.25 Configurations</h4>

<p>
The Remote Access Service for X.25 networks offers two configurations for the client and one for the server:</p>
<p>
<b>Table 9.1    X.25 Configurations</b></p>
<table cols=1>
<tr valign=top>
<td width=464></td>
</tr>
<tr valign=top>
<td width=91><b>Client/Server</b></td>
<td width=374><b>Configuration</b></td>
</tr>
<tr valign=top>
<td width=464></td>
</tr>
<tr valign=top>
<td width=91>Client</td>
<td width=374>Dial-up PAD</td>
</tr>
<tr valign=top>
<td width=91>Client</td>
<td width=374>Direct connection to the X.25 network through X.25 smart card</td>
</tr>
<tr valign=top>
<td width=91>Server</td>
<td width=374>Direct connection to the X.25 network through X.25 smart card</td>
</tr>
</table><br>

<h4>Pad.inf Format</h4>

<p>
Similar in format to Modem.inf (which contains script information used to talk to the modem), Pad.inf contains conversations between the client software and the PAD. For details, see Appendix C, &ldquo;Understanding Modem.inf.&rdquo; Pad.inf is located in the \<i>systemroot</i>\SYSTEM32\RAS folder.</p>

<p>
The macros in the following list are <i>reserved words</i>, which you cannot define in Pad.inf to create a new entry. Reserved words are case insensitive.</p>

<p>
<b>x25address</b></p>

<p>
<b>diagnostics</b></p>

<p>
<b>userdata</b></p>

<p>
<b>facilities</b></p>
<h4>Caution</h4>
<p>
Using reserved words as macro names in Pad.inf could result in unpredictable behavior of the Remote Access software.</p>
<p>
<b>Sample Pad.inf</b></p>

<p>
The following sample Pad.inf file will help you create a section within Pad.inf for your X.25 network. This example shows an entry for Sprintnet:</p>
[SPRINTNET]


;The following three lines are temporary.

DEFAULTOFF=

MAXCARRIERBPS=9600

MAXCONNECTBPS=9600


; The next line will give a delay of 2 secs -

; allowing the PAD to initialize



COMMAND=

NoResponse
                  

COMMAND=

NoResponse


; The @ character sets the SPRINTNET PAD for 8 databit communication.

COMMAND=@ 
NoResponse


COMMAND=

NoResponse


; The D character requests a 9600 speed.

COMMAND=D&lt;cr&gt;

; We don't care for the response so we ignore it.

OK=&lt;ignore&gt;


; A carriage return line feed again to initialize

; the PAD read/write buffers

COMMAND=&lt;cr&gt;&lt;lf&gt;

OK=&lt;ignore&gt;


COMMAND=&lt;cr&gt;&lt;lf&gt;

OK=&lt;ignore&gt;


; Set X.3 settings on the PAD which make it work well with RAS.

; Broken into two parts since the line is too long.

COMMAND=SET 1:0,2:0,3:0,4:1,5:0,6:1,7:0,8:0,9:0,10:0,11:0&lt;cr&gt;

OK=&lt;ignore&gt;


; Set the other half of X.3 parameters

COMMAND=SET 12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0&lt;cr&gt;

OK=&lt;ignore&gt;


; Finally try to call RAS X25 server

COMMAND=C &lt;x25address&gt;&lt;cr&gt;&lt;lf&gt;


CONNECT=&lt;match&gt;&ldquo;CONNECT&rdquo;

ERROR_DIAGNOSTICS=&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;


; CONNECT response means that the connection completed fine.

; X25ERROR response means connection attempt failed - the X25 CAUSE and

; DIAGNOSTIC information will be extracted from the response and

; sent to the user.

; ERROR responses are for generic failures.

</code>
<p>
After this sample conversation for SPRINTNET is completed (with the correct responses), the X.25 connection is established. If errors are detected during the PAD conversation, no connection is made.</p>

<h4>Note</h4>
<p>
The Remote Access Service currently works with PADs set to 8 data bits, 1 stop bit, and no parity. Consult the documentation for the PAD to see how to install these settings.</p>

<p>
In Pad.inf, you can use the <b>COMMAND</b>_ series of commands (<b>COMMAND_INIT</b>,<b> COMMAND_DIAL</b>,<b> </b>and <b>COMMAND_LISTEN</b>) or the generic <b>COMMAND</b>. But do not mix the two families of commands. For more information on the <b>COMMAND_</b> series, see Appendix C, &ldquo;Understanding Modem.inf.&rdquo;</p>

<h4>Troubleshooting</h4>

<p>
For troubleshooting information, see the Remote Access online Help.</p>
<h4>Accessing X.25 Through Dial-Up PADs</h4>

<p>
Operating between the client and the Remote Access server, an asynchronous PAD converts serially-transmitted data into X.25 packets. When the PAD receives a packet from an X.25 network, it puts the packet out on a serial line, making communication possible between the client and the X.25 network.</p>

<p>
Remote Access clients can connect with Remote Access servers through dial-up PAD services supplied by X.25 carriers, such as Sprintnet and Infonet. After the client&rsquo;s modem (modem A in Figure 9.1) connects to the PAD&rsquo;s modem (modem B), the client software must converse with the dial-up PAD. When their conversation is successfully completed, a connection is established between client and server. The conversation (command/response scripts) for the PADs supported by an X.25 carrier is stored in the Pad.inf file. Remote Access software supplies one example. To customize your PAD, see &ldquo;Pad.inf Format,&rdquo; in this chapter.</p>

<p>
For example, Pad.inf contains two Sprintnet entries: Sprintnet Standard and Sprintnet Alternate. Generally, if you are calling through 9600 bits-per-second (bps) or faster dial-up PADs, try Sprintnet Standard. If you are calling through 2400 bps or slower dial-up PADs, try Sprintnet Alternate.</p>

<p>
If one Sprintnet entry fails to connect reliably, try the other one. Sprintnet dial-up PADs should work with both.</p>

<h4>Note</h4>

<p>
For dial-up PADs, you must use the <b>COMMAND</b>= format, not the <b>COMMAND_INIT</b>, <b>COMMAND_DIAL</b>, and <b>COMMAND_LISTEN</b> format.</p>

<p>
Figure 1.1 shows how a client connects to the Remote Access server through a dial-up PAD and the X.25 network.</p>
<p>
<img src="xns_i01.gif" border=0></p>
<p>
<b>Figure 1.1    Connecting to the Server Through a Dial-Up PAD</b></p>


<h4>Note</h4>
<p>
For best results when using a dial-up PAD, use a modem that matches the one used by the PAD carrier (or at least matches the V. protocol supported by the carrier&rsquo;s modem).</p>

<p>
The following table compares connecting through dial-up PADs and connecting directly to the X.25 network:</p>
<p>
<b>Table 1.2    Comparison of Dial-Up PADs to Connecting Directly</b></p>
<table cols=1>
<tr valign=top>
<td width=464></td>
</tr>
<tr valign=top>
<td width=196><b>Dial-Up PAD</b></td>
<td width=269><b>Direct connection</b></td>
</tr>
<tr valign=top>
<td width=464></td>
</tr>
<tr valign=top>
<td width=196>Saves the expense of a dedicated leased line (direct connection).</td>
<td width=269>Requires expensive leased line.</td>
</tr>
<tr valign=top>
<td width=196>Allows connections from hotels, airports, homes&mdash;anywhere a phone line is available.</td>
<td width=269>Requires users to dial in from a fixed location.</td>
</tr>
<tr valign=top>
<td width=196>Requires two steps to connect.</td>
<td width=269>Connects conveniently in one step.</td>
</tr>
<tr valign=top>
<td width=196>Limits maximum communication speed to whichever speed is slower, the modem&rsquo;s or the PAD&rsquo;s.</td>
<td width=269>Lets communication take place up to the speed of a leased line, 56 kilobytes (K).</td>
</tr>
<tr valign=top>
<td width=196>Allows less control in configuring PADs.</td>
<td width=269>Offers greater reliability.</td>
</tr>
<tr valign=top>
<td width=196><p>
Only a client can connect through a dial-up PAD.</p>
</td>
<td width=269>Both servers and clients can connect directly.</td>
</tr>
</table><br>

<h4>PAD and Serial Configuration</h4>

<p>
To configure your PAD correctly, set the X.3 parameters according to the information shown in Table 9.3 later in this chapter.</p>

<p>
The configuration of the dial-up PAD should be as follows:</p>

<p>
8 data bits</p>

<p>
1 stop bit</p>

<p>
No parity serial communication</p>

<p>
For dial-up PADs, make sure your vendor supports this configuration. The PADs might already be set to the correct configuration for connecting directly through an internal X.25 smart card. If they are, do not change the configuration.</p>

<h4>Connecting to the X.25 Network Directly</h4>

<p>
RAS also supports connecting directly from the remote computer to the X.25 network through a smart card, which acts like a modem. An <i>X.25 smart card</i> is a hardware card with a PAD embedded in it. To the personal computer, a smart card looks like several communication ports attached to PADs. To access the X.25 network through a direct connection, you must have</p>

<p>
a direct line connection to an X.25 network (clients only)</p>

<p>
a smart card</p>

<h4>Note</h4>

<p>
The server side always requires an X.25 smart card, but the client side requires one only when connecting to the X.25 network directly. </p>


<h4>Note</h4>

<p>
For connecting to the network directly, you must use the <b>COMMAND_INIT</b>, <b>COMMAND_DIAL</b>, and <b>COMMAND_LISTEN</b> format.</p>

<p>
Figure 1.2 shows how the server and a Windows&nbsp;NT client (both equipped with smart cards) connect to the X.25 network directly.</p>
<p>
<img src="xns_i02.gif" border=0></p>
<p>
<b>Figure 1.2    Connecting to X.25 Directly</b></p>

<h4>Callback</h4>

<p>
The Remote Access server does not support callback on X.25 networks.</p>

<h4>Setting Up the Remote Access Server for&nbsp;an&nbsp;X.25&nbsp;Network</h4>

<p>
After installing Windows&nbsp;NT Server and adding the Remote Access Service, follow these steps:</p>

<p>
<b>To set up the Remote Access server for an X.25 network</b></p>

<p>
1.Install the X.25 smart card (according to the manufacturer&rsquo;s instructions).</p>

<p>
A communications driver for the X.25 smart card that emulates communication ports is supplied by the hardware manufacturer or by a third party.</p>

<p>
2.Make sure your X.25 smart card is configured with the X.3-parameter values shown in Table 9.3.</p>

<p>
3.From the list of devices on the <b>Remote Access Setup</b> dialog box, select an entry corresponding to the X.25 smart card.</p>

<p>
4.In setting up the Remote Access server, make sure that the ports selected are configured for dial-in.</p>
<h4>Note</h4>
<p>
Make sure that the speed of the leased line can support all the serial communication (COM) ports at all speeds at which clients will dial in. For example, 4 clients connecting at 9600 bps (through dial-up PADs) will require a 38,400-bps (4 times 9600) leased line on the server end. If the leased line does not have adequate bandwidth, it can cause time-outs and can cause the performance for connected clients to degrade.</p>

<p>
<b>Table 1.3    X.25 Configuration Values</b></p>
<table cols=1>
<tr valign=top>
<td width=446></td>
</tr>
<tr valign=top>
<td width=138><b>Parameter number</b></td>
<td width=154><b>X.3 parameter</b></td>
<td width=154><p>
<b>Value</b></p>
</td>
</tr>
<tr valign=top>
<td width=446></td>
</tr>
<tr valign=top>
<td width=138>1</td>
<td width=154>PAD Recall</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>2</td>
<td width=154>Echo</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>3</td>
<td width=154>Data Fwd. Char</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>4</td>
<td width=154>Idle Timer</td>
<td width=154>1</td>
</tr>
<tr valign=top>
<td width=138>5</td>
<td width=154>Device Ctrl</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>6</td>
<td width=154>PAD Service Signals</td>
<td width=154>1</td>
</tr>
<tr valign=top>
<td width=138>7</td>
<td width=154>Break Signal</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>8</td>
<td width=154>Discard Output</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>9</td>
<td width=154>Padding after CR</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>10</td>
<td width=154>Line Folding</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>11</td>
<td width=154><i>Not Set</i></td>
<td width=154></td>
</tr>
<tr valign=top>
<td width=138>12</td>
<td width=154>Flow Control</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>13</td>
<td width=154>Linefeed Insertion</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>14</td>
<td width=154>Padding after LF</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>15</td>
<td width=154>Editing</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>16</td>
<td width=154>Character Delete</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>17</td>
<td width=154>Line Delete</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>18</td>
<td width=154>Line Display</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>19</td>
<td width=154>Editing PAD Srv Signals</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>20</td>
<td width=154>Echo Mask</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>21</td>
<td width=154>Parity Treatment</td>
<td width=154>0</td>
</tr>
<tr valign=top>
<td width=138>22</td>
<td width=154>Page Wait</td>
<td width=154>0</td>
</tr>
</table><br>
<h4>Caution</h4>
<p>
Failure to set these values as shown prevents the Remote Access Service from functioning properly. For information on setting these values, see the instructions with your X.25 smart card.</p>
<h4>Setting Up Remote Access Clients</h4>

<p>
This section tells how to set up Remote Access clients for connecting to the X.25 network through PAD services and for connecting to the X.25 network directly.</p>

<h4>Connecting Through Dial-Up PADs</h4>

<p>
Following these steps to connect a client to an X.25 network:</p>

<p>
1.Dial from the client&rsquo;s modem to a PAD (modem-to-modem).</p>

<p>
2.Establish a connection over the X.25 network between the PAD and the server-side X.25 smart card.</p>

<p>
After you&rsquo;ve established a connection, communicate as you would through any asynchronous connection. For a complete description of connecting through dial-up PADs, see &ldquo;Accessing X.25 Through Dial-Up PADs,&rdquo; earlier in this chapter.</p>

<h4>Configuring Client PADs</h4>

<p>
The client PAD, through which a remote computer connects to the X.25 network, might have previously been set to X.3-parameter values that are incompatible with the Remote Access Service. Therefore, it is important to configure the X.25 smart card on the Remote Access server so that it changes the client PAD&rsquo;s X.3 settings to the values in Table 9.3 as soon as a connection is established through X.29 commands. To configure an X.25 smart card to make these changes, see the configuration manual for your specific card.</p>

<h4>Note</h4>

<p>
If the X.25 smart card on the server end does not support commands for the X.29 language, the client PAD script must set the X.3 parameters locally. If you have problems, contact the support site for your X.25 smart card vendor.</p>

<h4>Connecting Directly</h4>

<p>
To set up the client for connecting directly to the X.25 network, follow the procedures used in setting up the Remote Access server. See &ldquo;Setting Up the Remote Access Server for an X.25 Network,&rdquo; earlier in this chapter. Make sure the communication ports are selected as dial-out.</p>

<h4>Configuring Remote Access Software for X.25</h4>

<p>
Connecting to a server through an X.25 network is similar to connecting through a phone line. The only difference is that the phone book entry must specify an X.25 PAD type and an X.121 address.</p>

<p>
<b>To add a phone book entry with X.25 or to add X.25 to an existing entry</b></p>
<p>
See RAS online Help. This online Help also provides troubleshooting information.</p>
<h3>Appendix B: General X.3 Parameter Description</h3>
<p>
This is a general listing of X.3 Packet Assembler/Disassembler (PAD) parameters. There are 22 standard PAD parameters since 1984. Parameters 16, 17, 18, and 19 describe editing functions that are not used with RAS.</p>
<p>
For more information on how to set these parameters with RAS, see the paragraph titled &ldquo;X.3 RAS Specifications and Potential Problems&rdquo; above.</p>
<h4>Parameter 1: PAD recall</h4>
<p>
Description: This enables an escape from the PAD on-line state (data transfer mode) to the PAD command state on receipt of a specific character. When the PAD receives this character, the PAD prompt is displayed on your terminal monitor.</p>
<h4>Parameter 2:  Echo</h4>
<p>
Description: This parameter is set to &ldquo;0&rdquo; (zero) for echo and &ldquo;1&rdquo; fornon-echo. One of the most frequently used parameters, this is handy for applications used for suppression of text when you are typing in your name and password. When this parameter is set, all characters received from the terminal are echoed, excluding those specified by parameters 5,12,20,22. Setting parameters 12 or 22 to non-zero values suppresses character echo (XON and OFF) even if parameter 2 is set to echo on.</p>
<h4>Parameter 3:  Data Forwarding Signal (characters)</h4>
<p>
Description: This value is bit-mapped. The PAD does not usually transmit one character at a time; it prefers large blocks of data, such as lines of text. A normal character used for this parameter is [carriage return = 2]. A PAD manufacturer's manual should have a table showing the options for this parameter.</p>
<h4>Parameter 4: Idle Time Delay</h4>
<p>
Description: With the Data Forwarding, this parameter provides the capability to forward data to a host based on idle time. If there is data in the buffer and there has been no additional characters received in the IDLE TIME, the buffer is sent to the host. The time units are in 0.05 seconds and the values range from 1 - 255. The implementation of the time unit sizes can vary from vendor to vendor.</p>
<h4>Parameter 5: Flow Control - PAD to Terminal</h4>
<p>
Description: This parameter tells the PAD to transmit the XON/OFF characters to the DTE, depending on the buffer state.</p>
<h4>Parameter 6: PAD Result Code Control</h4>
<p>
Description: This controls how the PAD result codes are transmitted to the terminal. The parameter can stop the PAD from sending service codes back to the terminal in response to events as the X.25 calls for clear or reset.</p>
<h4>Parameter 7: Action on Receipt of Break from Character Terminal</h4>
<p>
Description: This parameter is bit-mapped. The break action here is a sequence (from the host that the PAD is connected to) for indicating that attention is required. This can be used in the interruption of a long transmission that the host may think is hung in a loop or stuck in constant transmit mode.</p>
<h4>Parameter 8: Discard Output</h4>
<p>
Description: Set this parameter so that you can abort a running process on the remote system by pressing a [break] key. If set to zero [0], normal data delivery is used.</p>
<h4>Parameter 9: Padding after Carriage Return</h4>
<p>
Description: Specifies the number of {NUL} characters to transmit after a carriage return.</p>
<h4>Parameter 10: Line Folding</h4>
<p>
Description: This allows for the formatting of data into regular line lengths when delivered to the character terminal. If a line length is specified, a [carriage return / line feed] must be transmitted.</p>
<h4>Parameter 11: Terminal Speed</h4>
<p>
Description: This is a READ ONLY value. The parameter shows the current DTE speed. It is automatically set by the PAD using the last AT command.</p>
<table cols=2>
<tr valign=top>
<td width=86><b>Value</b></td>
<td width=102><b>Baud Rate</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=188></td>
</tr>
<tr valign=top>
<td width=86>0</td>
<td width=102>110</td>
</tr>
<tr valign=top>
<td width=86>2</td>
<td width=102>300</td>
</tr>
<tr valign=top>
<td width=86>3</td>
<td width=102>1200</td>
</tr>
<tr valign=top>
<td width=86>4</td>
<td width=102>600</td>
</tr>
<tr valign=top>
<td width=86>5</td>
<td width=102>75</td>
</tr>
<tr valign=top>
<td width=86>12</td>
<td width=102>2400</td>
</tr>
<tr valign=top>
<td width=86>13</td>
<td width=102>4800</td>
</tr>
<tr valign=top>
<td width=86>14</td>
<td width=102>7200 or  9600</td>
</tr>
<tr valign=top>
<td width=86>15</td>
<td width=102>14400 or 19200</td>
</tr>
<tr valign=top>
<td width=86>16</td>
<td width=102>38400</td>
</tr>
</table><br>
<h4>Parameter 12: Flow Control of the PAD by Local Terminal</h4>
<p>
Description: This is basically the opposite of parameter 5: it allows the character terminal to control the flow control.</p>
<h4>Parameter 13: Line Feed Insertion after Carriage Return</h4>
<p>
Description: This specifies whether the PAD inserts a line feed character after carriage returns. This applies only in the PAD on-line state.</p>
<h4>Parameter 14: Padding after Line Feed</h4>
<p>
Description: This is the same as parameter 9 except that the padding {NUL} characters instead of a carriage return are inserted after a line feed.</p>
<h4>Parameter 15: Editing</h4>
<p>
Description: This specifies whether editing is used in the PAD on-line state.</p>
<h4>Parameter 16:  Character Delete</h4>
<h4>Note </h4>
<p>
Parameters 16, 17, 18, and 19 help describe the available editing functions. If editing is enabled, parameter 4 (Idle Time Delay) is ignored.</p>
<p>
Description: This defines the delete character to delete the last character in the editing buffer. ASCII 8 is the backspace character.</p>
<h4>Parameter 17: Line (buffer) Delete</h4>
<p>
Description: This defines the line delete character. ASCII 24 is &lt;Ctrl-X&gt;.</p>
<h4>Parameter 18: Line Display</h4>
<p>
Description: This defines the line display. If you enter the character specified and editing is enabled, the editing buffer is displayed. ASCII 18 is &lt;Ctrl-R&gt;.</p>
<h4>Parameter 19: Editing PAD Result Codes</h4>
<p>
Description: This defines the effect of editing buffered characters with the character delete and line delete functions.</p>
<h4>Parameter 20: Echo Mask</h4>
<p>
Description: Bit-Masked Parameter. If parameter 2 is set to 1, this parameter lets you select the characters that are echoed.</p>
<h4>Parameter 21: Parity Treatment</h4>
<p>
Description: This controls the parity and character format used by the terminal. Best left in the &ldquo;OFF&rdquo; condition.</p>
<h4>Parameter 22: Page Wait</h4>
<p>
Description: This allows for pagination of data sent to the terminal. If the terminal display can display 20 lines and this parameter is set to 20, the PAD sends 20 lines of data then stops transmission.</p>
<h3>Appendix C: Using Pad.inf with Non-X.25 RAS Connections</h3>
<p>
In Windows for Workgroups 3.11 and Windows NT 3.1 and 3.50 Pad.inf has the advantage over Switch.inf that it supports three macros (variables): X.121 Address, User Data, and Facilities that are getting their values from the X.25 user interface. This makes Pad.inf more user-friendly and secure because the password does not need to be entered permanently in the Pad.inf script like it would have to in the Switch.inf file. </p>
<p>
For example, calling a RAS server with an intermediary security device switched in-line where the security device requires a user ID and password in addition to the Windows NT RAS credentials becomes more secure and user-friendly by using the Pad.inf file rather than Switch.inf. In those cases where the password for the intermediary security device is changing every few seconds or minutes, the use of the variables in Pad.inf file is virtually the only feasible solution because quickly editing the Switch.inf file to enter the password, saving the changes and then starting RAS and making the call may take so much time that the password has changed again in the meantime.</p>
<p>
However, in Windows NT 3.51 and 4.0, Switch.inf supports two variables: Username and Password which are conveniently obtained through the familiar Windows NT logon dialog box. The Username and Password variables are not available in Windows for Workgroups 3.11, Windows NT 3.1 and 3.5 RAS. For more information, see your RAS manual and online help for X.25 topics.</p>
<h4>Note</h4>
<p>
Pad.inf was designed for X.25 connectivity. Although using Pad.inf with non-X.25 networks may work, it has not been tested by, and is not supported by Microsoft.</p>
<h3>Appendix D: List of Electronic and Hardcopy RAS documentation in the Different RAS Versions</h3>
<p>
The following list shows all RAS versions to-date - regardless of X.25 support - and whether they ship with a hard copy of the manual or only a softcopy manual or only online help. All RAS versions ship with online help, however, the early RAS versions do not contain nearly as much information in the online help as the later versions.</p>
<p>
The following RAS version ship with a hard copy of the manual:</p>
<p>
Remote Access for MS-DOS, versions 1.0, 1.1, 1.1a</p>
<p>
Remote Access for OS/2, version 1.0, 1.1</p>
<p>
Windows NT operating system version 3.1</p>
<p>
Windows NT Advanced Server version 3.1</p>
<p>
Windows NT Workstation versions 3.5, and 3.51</p>
<p>
Windows NT Server versions 3.5, and 3.51</p>
<p>
The following RAS versions only have online help:</p>
<p>
RAS for Windows for Workgroups only has online help documentation.</p>
<p>
RAS for Windows 95</p>
<p>
The following RAS versions ship online help and with a printable, electronic version of the manual on the compact disc. A hard copy of the manual can be purchased for a small fee:</p>
<p>
Microsoft Windows NT Workstation version 4.0</p>
<p>
Microsoft Windows NT Server version 4.0</p>
<h4>Note</h4>
<p>
The RAS server and RAS client online help may contain information on different topics.</p>
<h3>Appendix E: Other RAS sources</h3>
<p>
The <i>Windows NT 3.51 Resource Kit Update 2</i> manual has a comprehensive RAS Reference that discusses all RAS versions up to Windows NT 3.51 and Windows 95.</p>
<p>
The RAS Troubleshooter on the Microsoft web at: http://<b>www.microsoft.com</b></p>
<p>
Microsoft TechNet (Knowledge Base and White Papers)</p>
<p>
The Microsoft Knowledge Base on the web and on Microsoft TechNet: http://www.microsoft.com/technet</p>
<h4>For More Information</h4>
<p>
For the latest information on Windows NT Server, check out our World Wide Web site at http://www.microsoft.com/ntserver or the Windows NT Server Forum on MSN™ The Microsoft Network (GO WORD: MSNTS). </p>
<h3>Appendix F: The New Script Language for Windows 95 and Windows NT 4.0</h3>
<p>
This script language is not supported for use in the Windows NT Pad.inf file! Use it with RAS for PPP and SLIP dial-up networking, for example, to access the Internet via an Internet access provider. Using the script language in a *.scp script file for X.25 dial-up has not been tested by Microsoft and is therefore not supported, however, it may work. Also Windows 95 has not been tested with X.25 dial-up and this script language, however, it may work, too.</p>
<h4>Dial-Up Scripting Command Language / For Dial-Up Networking Scripting Support</h4>
<h4>1.0   Overview</h4>
<p>
Many Internet service providers and online services require you to manually enter information, such as your user name and password, to establish a connection. With Scripting support for Dial-Up Networking, you can write a script to automate this process. </p>
<p>
A script is a text file that contains a series of commands, parameters, and expressions required by your Internet service provider or online service to establish the connection and use the service. You can use any text editor, such as Microsoft Notepad, to create a script file. Once you've created your script file, you can then assign it to a specific Dial-Up Networking connection by running the Dial-Up Scripting Tool.</p>
<h4>2.0   Basic Structure of a Script</h4>
<p>
A command is the basic instruction that a script file contains. Some commands require parameters that further define what the command should do. An expression is a combination of operators and arguments that create a result. Expressions can be used as values in any command.  Examples of expressions include arithmetic, relational comparisons, and string concatenations.</p>
<p>
The basic form of a script for Dial-Up Networking follows:</p>
;
; A comment begins with a semi-colon and extends to 
; the end of the line.
;

proc main
;  A script can have any number of variables 
;  and commands
variable declarations
command block
endproc</code>
<p>
A script must have a main procedure, specified by the <b>proc </b>keyword, and a matching <b>endproc </b>keyword, indicating the end of the procedure.  </p>
<p>
You must declare variables before you add commands. The first command in the main procedure is executed, and then any subsequent commands are executed in the order they appear in the script. The script ends when the end of the main procedure is reached.</p>
<h4>3.0   Variables</h4>
<p>
Scripts may contain variables. Variable names must begin with a letter or an underscore ('_'), and may contain any sequence of upper- or lower-case letters, digits, and underscores. You cannot use a reserved word as a variable name. For more information, see the list of reserved words at the end of this document.</p>
<p>
You must declare variables before you use them. When you declare a variable, you must also define its type. A variable of a certain type may only contain values of that same type. The following three types of variables are supported:</p>
<table cols=2>
<tr valign=top>
<td width=160><b>Type</b></td>
<td width=296><b>Description</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=456></td>
</tr>
<tr valign=top>
<td width=160>integer</td>
<td width=296>A negative or positive number, such as 7, -12, or 5698.</td>
</tr>
<tr valign=top>
<td width=160>String</td>
<td width=296>A series of characters enclosed in double-quotes; for example, &ldquo;Hello world!&rdquo; or &ldquo;Enter password:&rdquo;.</td>
</tr>
<tr valign=top>
<td width=160>Boolean</td>
<td width=296>A logical boolean value of TRUE or FALSE.</td>
</tr>
</table><br>
<p>
Variables are assigned values using the following assignment statement:</p>
<p>
variable <b>=</b> expression</p>
<p>
The variable gets the evaluated expression.  </p>
<p>
Examples:</p>
integer count = 5
integer timeout = (4 * 3)
integer i

boolean bDone = FALSE

string szIP = (getip 2)

set ipaddr szIP
</code>
<h4>3.1   System Variables</h4>
<p>
System variables are set by scripting commands or are determined by the information your enter when you set up a Dial-Up Networking connection. System variables are read-only, which means they cannot be changed within the script. The system variables are:</p>
<table cols=3>
<tr valign=top>
<td width=120><b>Name</b></td>
<td width=120><b>Type</b></td>
<td width=232><b>Description</b></td>
</tr>
<tr valign=top>
<td colspan=3 width=472></td>
</tr>
<tr valign=top>
<td width=120>$USERID</td>
<td width=120>String</td>
<td width=232>The user identification for the current connection. This variable is the value of the user name specified in the Dial-Up Networking Connect To dialog box.</td>
</tr>
<tr valign=top>
<td width=120>$PASSWORD</td>
<td width=120>String</td>
<td width=232>The password for the current connection. This variable is the value of the user name specified in the Dial-Up Networking Connect To dialog box.</td>
</tr>
<tr valign=top>
<td width=120>$SUCCESS</td>
<td width=120>Boolean</td>
<td width=232>This variable is set by certain commands to indicate whether or not the command succeeded. A script can make decisions based upon the value of this variable.</td>
</tr>
<tr valign=top>
<td width=120>$FAILURE</td>
<td width=120>Boolean</td>
<td width=232>This variable is set by certain commands to indicate whether or not the command failed. A script can make decisions based upon the value of this variable.</td>
</tr>
</table><br>
<p>
These variables may be used wherever an expression of a similar type is used. For example, </p>
transmit $USERID
</code>
<p>
is a valid command because $USERID is a variable of type string.</p>
<h4>4.0   String Literals</h4>
<p>
Scripting for Dial-Up Networking supports escape sequences and caret translations, as described below.</p>
<table cols=2>
<tr valign=top>
<td width=240><b>String Literal</b></td>
<td width=232><b>Description</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=472></td>
</tr>
<tr valign=top>
<td width=240>^char</td>
<td width=232>Caret translation</td>
</tr>
<tr valign=top>
<td width=240>&lt;cr&gt;</td>
<td width=232>Carriage return</td>
</tr>
<tr valign=top>
<td width=240>&lt;lf&gt;</td>
<td width=232>Linefeed</td>
</tr>
<tr valign=top>
<td width=240>\&rdquo;</td>
<td width=232>Double-quote</td>
</tr>
<tr valign=top>
<td width=240>\^</td>
<td width=232>Single caret</td>
</tr>
<tr valign=top>
<td width=240>\&lt;</td>
<td width=232>Single '&lt;'</td>
</tr>
<tr valign=top>
<td width=240>\\</td>
<td width=232>Backslash</td>
</tr>
</table><br>
<p>
If <i>char</i> is a value between '@' and '_', the character sequence is translated into a single-byte value between 0 and 31.  For example, ^M is converted to a carriage return.</p>
<p>
If <i>char</i> is a value between a and z, the character sequence is translated into a single-byte value between 1 and 26.</p>
<p>
If <i>char</i> is any other value, the character sequence is not specially treated.</p>
<p>
Examples:</p>
transmit &ldquo;^M&rdquo;
transmit &ldquo;Joe^M&rdquo;
transmit &ldquo;&lt;cr&gt;&lt;lf&gt;&ldquo;
waitfor &ldquo;&lt;cr&gt;&lt;lf&gt;&ldquo;
</code>
<h4>5.0    Expressions</h4>
<p>
An expression is a combination of operators and arguments that evaluates to a result.  Expressions can be used as values in any command.</p>
<p>
An expression can combine any variable, or integer, string, or boolean values with any of the unary and binary operators in the following tables. All unary operators take the highest precedence. The precedence of binary operators is indicated by their position in the table. </p>
<p>
The unary operators are:</p>
<table cols=2>
<tr valign=top>
<td width=112><b>Operator</b></td>
<td width=360><b>Type of Operation</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=472></td>
</tr>
<tr valign=top>
<td width=112><b>-</b></td>
<td width=360>Unary minus</td>
</tr>
<tr valign=top>
<td width=112><b>!</b></td>
<td width=360>One's complement</td>
</tr>
</table><br>
<p>
The binary operators are listed in the following table in their order of precedence. Operators with higher precedence are listed first:</p>
<table cols=3>
<tr valign=top>
<td width=160><b>Operators</b></td>
<td width=160><b>Type of Operation</b></td>
<td width=160><b>Type Restrictions </b></td>
</tr>
<tr valign=top>
<td colspan=3 width=479></td>
</tr>
<tr valign=top>
<td width=160><b>*  /</b></td>
<td width=160>Multiplicative</td>
<td width=160>Integers</td>
</tr>
<tr valign=top>
<td width=160><b>+  - </b></td>
<td width=160>Additive</td>
<td width=160>integers Strings (+ only)</td>
</tr>
<tr valign=top>
<td width=160><b>&lt; &gt; &lt;= &gt;=</b></td>
<td width=160>Relational</td>
<td width=160>Integers</td>
</tr>
<tr valign=top>
<td width=160><b>== !=</b></td>
<td width=160>Equality</td>
<td width=160>Integers, strings, booleans</td>
</tr>
<tr valign=top>
<td width=160><b>and</b></td>
<td width=160>Logical AND</td>
<td width=160>Booleans</td>
</tr>
<tr valign=top>
<td width=160><b>or</b></td>
<td width=160>Logical OR</td>
<td width=160>Booleans</td>
</tr>
</table><br>
<p>
Examples:</p>
count = 3 + 5 * 40
transmit &ldquo;Hello&rdquo; + &ldquo; there&rdquo;
delay 24 / (7 - 1)
</code>
<h4>6.0   Comments</h4>
<p>
All text on a line following a semicolon is ignored.</p>
<p>
Examples:</p>
; this is a comment
transmit &ldquo;hello&rdquo;; transmit the string &ldquo;hello&rdquo;
</code>
<h4>7.0   Keywords</h4>
<p>
Keywords specify the structure of the script. Unlike commands, they do not perform an action. The keywords are listed below.</p>
<p>
<b>proc</b> <i>name</i> </p>
<p>
Indicates the beginning of a procedure. All scripts must have a main procedure (<b>proc </b>main). Script execution starts at the main procedure and terminates at the end of the main procedure.</p>
<p>
<b>endproc</b></p>
<p>
Indicates the end of a procedure. When the script is executed to the <b>endproc </b>statement for the main procedure, Dial-Up Networking will start PPP or SLIP. </p>
<p>
<b>integer </b><i>name </i>[ <b>=</b> <i>value</i> ] </p>
<p>
Declares a variable of type integer. You can use any numerical expression or variable to  initialize the variable.</p>
<p>
<b>string </b><i>name </i>[ <b>=</b> <i>value</i> ] </p>
<p>
Declares a variable of type string. You can use any string literal or variable to initialize the variable.</p>
<p>
<b>boolean </b><i>name </i>[ <b>=</b> <i>value</i> ] </p>
<p>
Declares a variable of type boolean. You can use any boolean expression or variable to initialize the variable.</p>
<h4>8.0   Commands</h4>
<p>
All commands are reserved words, which means you cannot declare variables that have the same names as the commands. The commands are listed below:</p>
<p>
<b>delay</b> <i>nSeconds</i></p>
<p>
Pauses for the number of seconds specified by <i>nSeconds</i> before executing the next command in the script.</p>
<p>
Examples:</p>
delay 2; pauses for 2 seconds
delay x * 3; pauses for x * 3 seconds
</code>
<p>
<b>getip</b>  <i>value</i></p>
<p>
Waits for an IP address to be received from the remote computer. If your Internet service provider returns several IP addresses in a string, use the value parameter to specify which IP address the script should use.</p>
<p>
Examples:</p>
; get the second IP address 
set ipaddr getip 2 

; assign the first received IP address to a variable
szAddress = getip
</code>
<p>
<b>goto </b><i>label</i></p>
<p>
Jumps to the location in the script specified by <i>label </i>and continues executing the commands following it.</p>
<p>
Example:</p>
waitfor &ldquo;Prompt&gt;&ldquo; until 10
  if !$SUCCESS then
goto BailOut; jumps to BailOut and executes commands 
; following it
  endif

  transmit &ldquo;bbs^M&rdquo;
  goto End

BailOut:
  transmit &ldquo;^M&rdquo;
</code>
<p>
<b>halt</b></p>
<p>
Stops the script. This command does not remove the terminal dialog window. You must click Continue to establish the connection. You cannot restart the script.</p>
<p>
<b>if </b><i>condition </i><b>then</b></p>
<p>
<i>commands</i></p>
<p>
<b>endif</b></p>
<p>
Executes the series of <i>commands</i> if <i>condition </i>is TRUE.</p>
<p>
Example:</p>
if $USERID == &ldquo;John&rdquo; then
transmit &ldquo;Johnny^M&rdquo;
endif
</code>
<p>
<i>label</i> <b>:</b></p>
<p>
Specifies the place in the script to jump to. A label must be a unique name and follow the naming conventions of variables.</p>
<p>
<b>set port databits </b>5 | 6 | 7 | 8</p>
<p>
Changes the number of bits in the bytes that are transmitted and received during the session. The number of bits can be between 5 and 8. If you do not include this command, Dial-Up Networking will use the properties settings specified for the connection.</p>
<p>
Example:</p>
set port databits 7
</code>
<p>
<b>set port parity </b>none | odd | even | mark | space</p>
<p>
Changes the parity scheme for the port during the session. If you do not include this command, Dial-Up Networking will use the properties settings specified for the connection.</p>
<p>
Example:</p>
set port parity even
</code>
<p>
<b>set port stopbits </b>1 | 2</p>
<p>
Changes the number of stop bits for the port during the session. This number can be either 1 or 2. If you do not include this command, Dial-Up Networking uses the properties settings specified for the connection.</p>
<p>
Example:</p>
set port stopbits 2
</code>
<p>
<b>set screen keyboard </b> on | off</p>
<p>
Enables or disables keyboard input in the scripting terminal window.</p>
<p>
Example:</p>
set screen keyboard on
</code>
<p>
<b>set ipaddr </b><i>string</i></p>
<p>
Specifies the IP address of the workstation for the session. <i>String </i>must be in the form of an IP address.</p>
<p>
Examples:</p>
szIPAddress = &ldquo;11.543.23.13&rdquo;
set ipaddr szIPAddress

set ipaddr &ldquo;11.543.23.13&rdquo;

set ipaddr getip
</code>
<p>
<b>transmit </b><i>string </i>[ <b>, raw </b>]</p>
<p>
Sends the characters specified by <i>string</i> to the remote computer. </p>
<p>
The remote computer will recognize escape sequences and caret translations, unless you include the <b>raw </b>parameter with the command. The <b>raw </b>parameter is useful when transmitting $USERID and $PASSWORD system variables when the user name or password contains character sequences that, without the <b>raw</b> parameter, would be interpreted as caret or escape sequences.</p>
<p>
Examples:</p>
transmit &ldquo;slip&rdquo; + &ldquo;^M&rdquo;
transmit $USERID, raw
</code>
<p>
<b>waitfor </b><i>string </i>[ <b>,</b> <b>matchcase </b>] [ <b>then </b><i>label </i></p>
<p>
{ <b>,</b> <i>string </i>[ <b>,</b> <b>matchcase </b>] <b>then </b><i>label </i>} ]</p>
<p>
[ <b>until </b><i>time </i>]</p>
<p>
Waits until your computer receives one or more of the specified strings from the remote computer. The <i>string</i> parameter is case-insensitive, unless you include the <b>matchcase</b> parameter.</p>
<p>
If a matching string is received and the <b>then </b><i>label </i>parameter is used, this command will jump to the place in the script file designated by <i>label</i>.</p>
<p>
The optional <b>until </b><i>time </i>parameter defines the maximum number of seconds that your computer will wait to receive the string before it execute the next command. Without this parameter, your computer will wait forever.</p>
<p>
If your computer receives one of the specified strings, the system variable $SUCCESS is set to TRUE. Otherwise, it is set to FALSE if the number of seconds specified by <i>time</i> elapses before the string is received.  </p>
<p>
Examples:</p>
waitfor &ldquo;Login:&rdquo;

waitfor &ldquo;Password?&rdquo;, matchcase

waitfor &ldquo;prompt&gt;&ldquo; until 10

waitfor
&ldquo;Login:&rdquo;then DoLogin,
&ldquo;Password:&rdquo;then DoPassword,
&ldquo;BBS:&rdquo;then DoBBS,
&ldquo;Other:&rdquo;then DoOther
  until 10
</code>
<p>
<b>while </b><i>condition </i><b>do</b></p>
<p>
<i>commands</i></p>
<p>
<b>endwhile</b></p>
<p>
Executes the series of <i>commands</i> until <i>condition </i>is FALSE.</p>
<p>
Example:</p>
integer count = 0

while count &lt; 4 do
transmit &ldquo;^M&rdquo;
waitfor &ldquo;Login:&rdquo; until 10
if $SUCCESS then
goto DoLogin
endif
count = count + 1
endwhile</code>
<p>
<code>...</code></p>
<h4>9.0   Reserved Words</h4>
<p>
The following words are reserved and may not be used as variable names.</p>
<table cols=4>
<tr valign=top>
<td width=120>And</td>
<td width=112>boolean</td>
<td width=128>databits</td>
<td width=113>delay</td>
</tr>
<tr valign=top>
<td width=120>do</td>
<td width=112>endif</td>
<td width=128>endproc</td>
<td width=113>endwhile</td>
</tr>
<tr valign=top>
<td width=120>even</td>
<td width=112>FALSE</td>
<td width=128>getip</td>
<td width=113>goto</td>
</tr>
<tr valign=top>
<td width=120>halt</td>
<td width=112>if</td>
<td width=128>integer</td>
<td width=113>ipaddr</td>
</tr>
<tr valign=top>
<td width=120>keyboard</td>
<td width=112>mark</td>
<td width=128>matchcase</td>
<td width=113>none</td>
</tr>
<tr valign=top>
<td width=120>odd</td>
<td width=112>off</td>
<td width=128>on</td>
<td width=113>or</td>
</tr>
<tr valign=top>
<td width=120>parity</td>
<td width=112>port</td>
<td width=128>proc</td>
<td width=113>raw</td>
</tr>
<tr valign=top>
<td width=120>screen</td>
<td width=112>set</td>
<td width=128>space</td>
<td width=113>stopbits</td>
</tr>
<tr valign=top>
<td width=120>string</td>
<td width=112>then</td>
<td width=128>transmit</td>
<td width=113>TRUE</td>
</tr>
<tr valign=top>
<td width=120>until</td>
<td width=112>waitfor</td>
<td width=128>while</td>
<td width=113></td>
</tr>
</table><br>
<h3>Appendix G: Troubleshooting RAS 1.0 and 1.1 on a MS OS/2 1.3 Server Running MS LAN Manager</h3>
<p>
The following are two Microsoft Knowledge Base troubleshooting articles that focus on RAS 1.0 and 1.1 installed on computers running Microsoft OS/2 1.3 and LAN Manager 2.1 or later. </p>
<p>
Part 1 (of 2)--Troubleshooting RAS on an OS/2 1<i>.x</i> Server      [lanman]</p>
<p>
ID: Q98518     CREATED: 06-MAY-1993   MODIFIED: 26-JAN-1995</p>
<p>
2.10 2.10a 2.20</p>
<p>
MS-DOS  PUBLIC | kbnetwork</p>
<p>
The information in this article applies to:</p>
<p>
Microsoft LAN Manager versions 2.1, 2.1a, and 2.2<br>
Microsoft Remote Access Service versions 1.0 and 1.1</p>
<h4>SUMMARY</h4>
<p>
This is part 1 of a two-part article meant to supplement (not replace) information provided in the &ldquo;Remote Access Administrator's Guide,&rdquo;Chapter 4, &ldquo;System Requirements.&rdquo; It will help you troubleshoot problems by verifying that basic requirements are met.</p>
<p>
To ensure proper operation of RAS 1.0 or 1.1 on an OS/2 1.21 or 1.3 server (OS/2 2.0 is currently not supported), verify that the following elements are present  &mdash;  preferably BEFORE you run the RAS Setup program:</p>
<p>
1.Serial Ports/Device Drivers</p>
<p>
One or more serial ports.</p>
<p>
One or more OS/2 serial port device drivers.</p>
<p>
Part 1 (the rest of this article) provides information on item 1: serial drivers and boards for ISA, EISA, MCA, Hewlett-Packard (HP) and 3Com computers, Digiboards, AST 4 port boards, and X.25 configurations. Part 2 of this article provides information on items 2-6 below:</p>
<p>
2. Modems</p>
<p>
One or more modems.</p>
<p>
All supported modems are listed in the RAS 1.1 MODEMS.INF file.</p>
<p>
Unsupported modems may also work.</p>
<p>
3.Serial Cable</p>
<p>
External modems require properly wired serial cables.</p>
<p>
4.LAN Manager</p>
<p>
LAN Manager 2.1 or later with one protocol/network in addition to AsyBEUI. LAN Manager 2.1 or later must be installed with at least one network (for example, a loopback driver, or NetBEUI plus a MAC driver) in addition to the RAS AsyBEUI. This is because RAS 1.0 and 1.1 function as a gateway and expect another network to be present.</p>
<p>
5.User-Level Security</p>
<p>
RAS MUST have user-level security--it does not support share-level security.</p>
<p>
6.PDC, BDC, Member Server or Standalone Status</p>
<p>
A RAS server can be configured as a primary or backup domain controller, a member-server, or a standalone.</p>
<h4>Note  </h4>
<p>
For details on topics other than SERIAL PORTS/DEVICE DRIVERS, refer to part 2 of this article, or query on the following words in the Microsoft Knowledge Base:</p>
<h4>MORE INFORMATION</h4>
<p>
1. Serial Ports and OS/2 Serial Port Device Drivers</p>
<p>
Under OS/2 1.3, serial ports cannot be accessed without serial device drivers. Each serial driver/COM-port combination has its own hardware requirements and limitations, so they are discussed separately below.</p>
<p>
At least one serial port must be available and properly configured, but remember that COM ports have specific and sometimes unique OS/2 serial device driver requirements. Third party serial boards or proprietary built-in ports usually require their own device drivers.</p>
<p>
For example: Digiboards require XALL.SYS.</p>
<p>
You must install an OS/2 serial port device driver through the CONFIG.SYS file. Depending on the serial port hardware, you may also have to install proprietary device drivers.</p>
<h4>Serial Port/Driver Combinations</h4>
<h4>1.1ISA and EISA (but not certain HP machines and 3COM 3Servers) machines </h4>
<p>
use COM01.SYS. COM01.SYS must be loaded in the CONFIG.SYS file. It supports ONLY serial ports COM1 and COM2 on ISA and EISA machines, NOT COM3 and COM4.</p>
<p>
SERIAL 1   COM1:  I/O Address = 3F8h   IRQ = 4</p>
<p>
SERIAL 2   COM2:  I/O Address = 2F8h   IRQ = 3</p>
<h4>Note </h4>
<p>
RAS requires that the serial port in use be configured as above. COM01.SYS does not perform a DosOpen call to the serial port until the serial port is actually used, so COM01.SYS loads during CONFIG.SYS time even if the port is misconfigured or there is an IRQ or I/O conflict between one of the COM ports and another device. For example: if a network card is configured for IRQ3, COM01.SYS loads but a system error &ldquo;SYS 1620&rdquo; occurs when a MODE COM2: command is issued.</p>
<p>
Hewlett-Packard EISA machines: use COMHP01.SYS. </p>
<h4>Note</h4>
<p>
Find out your HP model number--this may NOT apply to all models.</p>
<h4>1.2COMHP01.SYS</h4>
<p>
supports COM1-COM4 with COM1 and COM2 configured as above, but you need to set up COM3 and COM4 with the following I/O addresses and IRQ settings:</p>
<p>
SERIAL 3   COM3 I/O Address = 3E8h,  IRQ = 10</p>
<p>
SERIAL 4   COM4 I/O Address = 2E8h,  IRQ = 11</p>
<p>
These are discussed (as is COMHP01.SYS) in the README.TXT file in C:\OS2\SUPPORT.</p>
<h4>1.3MCA machines </h4>
<p>
use COM02.SYS (COM01.SYS CANNOT be used): COM02.SYS must be used on Micro Channel machines and loaded in the CONFIG.SYS file. COM02.SYS supports serial ports COM1, COM2, and COM3. IRQ3 is shared by COM2 and COM3.</p>
<p>
COM1:  I/O Address = 3F8h   IRQ = 4</p>
<p>
COM2:  I/O Address = 2F8h   IRQ = 3</p>
<p>
COM3:  I/O Address = 2F8h,  IRQ = 3</p>
<p>
On Micro Channel machines, COM2-8 are shared at IRQ3, and I/O ports 2F8, 3220 (hex), 3228, 4220, 4228, 5220, and 5228. In OS/2 1.3, however, COM02.SYS can support only COM1-COM3.</p>
<p>
Some add-in serial boards are supported so that you can get ports COM2 and/or COM3 on, for example, an IBM PS/2 Model 80. One supported add-in board is the IBM DUAL ASYNC adapter, which has two 9-pin serial ports built into it.</p>
<h4>1.4Computers with Digiboards (Micro Channel, ISA, or EISA) </h4>
<p>
use XALL.SYS. For older products, use DGX.SYS.</p>
<p>
The information in the rest of this section was verified in April 1993:</p>
<p>
The OS/2 XALL.SYS device driver supports the entire line of Digichannel intelligent asynchronous serial communication controllers and must be loaded in the OS/2 Config.sys file. You can adjust its functionality with device line parameters.</p>
<p>
The OS/2 DGX.SYS device driver supports older non-intelligent serial Digiboards such as the PC4 board, and is also configured with the help of device line parameters.</p>
<h4>Note</h4>
<p>
Digiboard does NOT ship the XALL.SYS OS/2 driver with their hardware. You must order it by calling (612) 943-9020 or obtain itfrom their BBS at (612) 943-0812.</p>
<p>
(Communication settings: N,8,1; baud 300, 1200, 2400, 9600; V.32, V.42 and V.42bis standards are supported.)</p>
<h4>Note</h4>
<p>
On EISA bus machines with EISA Digiboards you must verify that the XALL.SYS parameter: /p:xxxx has a 4-digit I/O address, the first digit of which is the EISA Digiboard card's bus slot number. This first digit is often forgotten, which prevents the driver from loading properly.</p>
<h4>1.5AST 4-port serial board: use COM01A.SYS</h4>
<p>
This board is NOT supported by Microsoft, but no problems have been reported with it and we provide this information as a convenience. The driver is available on the Microsoft BBS at (425) 936-MSDL in the LAN Manager area. Load it just as you would COM01.SYS. Microsoft has not tested this driver with OS/2 1.3 and therefore does NOT guarantee proper performance.</p>
<h4>1.63COM 3Servers</h4>
<p>
3S400 servers: use COM01S.400</p>
<p>
3S500 AND 3S600 servers: use COM01S.500</p>
<p>
The CONFIG.SYS file loaded by the LAN Manager installation tape has the appropriate 3COM serial port driver already referenced but still REMarked out so that it does NOT allow the serial port to be used. To make it usable, simply remove the REM on that line, save the file, shutdown and reboot your server.</p>
<h4>Note  </h4>
<p>
On 3COM servers, only COM1 and COM3 are available--the COM2 port is reserved for the built-in Localtalk port. A 3Com RAS server can use only COM1 and COM3 unless a third party driver and serial port hardware (such as Digiboard) is installed to make COM ports above COM3 available.</p>
<p>
COM01S.400 and COM01S.500 expect the serial ports to be configured as follows (these are the defaults):</p>
<p>
COM1:  I/O Address = 3F8h,  IRQ = 4</p>
<p>
COM3:  I/O Address = 2F8h,  IRQ = 3</p>
<h4>Note  </h4>
<p>
The 3Com upgrade toolkits for LAN Manager 2.1 and 2.2 contain a disk for installing RAS on 3servers. For 2.1, insert this disk once you start RemSetup (Remote Setup for 3 Servers--located in the LAN Manager directory on the 3server).</p>
<p>
Follow the same procedure for the 3COM upgrade toolkit for LAN Manager 2.2, but when you install RAS, insert the disk labeled &ldquo;Services for Macintosh Remote Installation for 3Server&rdquo; &mdash;  the labels for the RAS and the Macintosh services are mixed up.</p>
<h4>Note </h4>
<p>
The &ldquo;LAN Manager Installation and Configuration Guide&rdquo; for 3Servers incorrectly assumes that a REMarked outline in the STARTUP.CMD file exists for the RAS. Please add the following line to the STARTUP.CMD file just below the group of similar lines.</p>
<p>
Call c:\lanman\3startms.cmd remoteaccess remoteaccess</p>
<h4>Note </h4>
<p>
If you configure RAS for more ports than are physically present (for example, you request a COM4 on a standard 3s500 system where only COM1 and COM3 exist) then the 3Server might hang when RAS is initialized. To cure such a problem, you must edit the STARTUP.CMD file and REMark out the RAS &ldquo;Call&rdquo; line. For information on how to do this, refer to the LAN Manager for 3Com servers documentation explaining the CONSOLE mode of 3Servers.</p>
<h4>1.7 X.25 drivers and cards: use the vendor's X.25 card and driver</h4>
<p>
If your server is running RAS over an X.25 network, then in addition to the X.25 card driver RAS needs a COM01.SYS or other driver in order to function and recognize COM ports present on the server. For example: the X.25 card from Eicon, Inc. emulates a maximum of 13 COM ports (COM4- COM16) if there are three regular serial ports on the server already.</p>
<h4>Note  </h4>
<p>
If more than 13 COM ports are configured, the RAS service terminates upon startup with a TRAP D during NET START REMOTEACCESS. The number of COM ports configurable also depends on other programs running simultaneously and competing for the same resources needed by the Eicon driver software, so if software of this type is running, RAS probably has to be configured for fewer ports before it can start successfully. Start out with 9 or 10 ports configured and then work your way up towards 13.</p>
<p>
Eicon software version 2 release 2 (v2r2) is out of date as of April 1993. Please upgrade to the latest version: version 3 release 1 (v3r1).</p>
<p>
For support with the Eicon driver installation or to upgrade to the latest version, please contact Eicon Customer Support Services at (514) 631-2592 (EST).</p>
<p>
For more information on debugging X.25 problems with RAS, refer to the RAS 1.1 Release Notes in the RAS retail package.</p>
<p>
For details on RAS requirements other than serial ports and device drivers, please see &ldquo;Part 2 (of 2)-- Troubleshooting RAS on an OS/2 1<i>.x</i> Server.&rdquo;</p>
<h4>REFERENCES</h4>
<p>
RAS 1.1 Release Notes</p>
<p>
LAN Manager &ldquo;Installation and Configuration Guide&rdquo;</p>
<p>
&ldquo;Remote Access Administrator's Guide,&rdquo; Chapter 4, System Requirements</p>
<p>
Additional reference words: sfm 2.10 2.1 2.10a 2.1a 2.20 2.2</p>
<p>
KBCategory: kbnetwork</p>
<p>
KBSubcategory: rmt</p>
<p>
Part 2 (of 2)--Troubleshooting RAS on an OS/2 1<i>.x</i> Server      [lanman]</p>
<p>
ID: Q98517     CREATED: 06-MAY-1993   MODIFIED: 30-SEP-1994</p>
<p>
2.10 2.20</p>
<p>
MS-DOS</p>
<p>
PUBLIC | kbnetwork</p>
<p>
The information in this article applies to:</p>
<p>
Microsoft LAN Manager versions 2.1, 2.1a, and 2.2</p>
<p>
Microsoft Remote Access Service versions 1.0 and 1.1</p>
<h4>Summary:</h4>
<p>
This is part 2 of a two-part article meant to supplement (not replace) information provided in the Remote Access Administrator's Guide, Chapter 4, &ldquo;System Requirements.&rdquo; It will help you troubleshoot problems by verifying that basic requirements are met.</p>
<p>
To ensure proper operation of RAS 1.0 or 1.1 on an OS/2 1.21 or 1.3 server (OS/2 2.0 is currently not supported at all) verify that the following elements are present  &mdash;  preferably BEFORE running the RAS Setup program:</p>
<p>
1.Serial Ports/Device Drivers</p>
<p>
One or more serial ports.</p>
<p>
One or more OS/2 serial port device drivers.</p>
<p>
Part 1 (a separate article) provides information on item 1: serial drivers and boards for ISA, EISA, MCA, HP and 3Com computers, Digiboards, AST 4 port boards, and X.25 configurations.</p>
<p>
Part 2 (the rest of this article) provides information on the next five required items:</p>
<p>
2.Modems</p>
<p>
One or more modems.</p>
<p>
All supported modems are listed in the RAS 1.1 MODEMS.INF file.</p>
<p>
Unsupported modems may also work.</p>
<p>
3. Serial Cable</p>
<p>
External modems require properly wired serial cables.</p>
<p>
4. LAN Manager</p>
<p>
LAN Manager 2.1 or later with one protocol/network in addition to AsyBEUI. LAN Manager 2.1 or later must be installed with at least one network (for example: a loopback driver, or NetBEUI and a MAC driver) in addition to the RAS AsyBEUI. This is because RAS 1.0 and 1.1 function as gateways and expect another network to be present.</p>
<p>
5. User-Level Security</p>
<p>
RAS MUST have user-level security--it does not support share-level security.</p>
<p>
6. PDC, BDC, Member Server or Standalone Status</p>
<p>
A RAS server can be configured as a primary or backup domain controller, a member-server, or a standalone.</p>
<h4>Note</h4>
<p>
For details on Serial Ports/Device Drivers, refer to part 1 of this article, or query on the following words in the Microsoft Knowledge Base:</p>
<p>
Part 1 (of 2)--Troubleshooting RAS on an OS/2 1<i>.x</i> Server</p>
<h4>MORE INFORMATION</h4>
<p>
1.Modems</p>
<p>
At least one modem must be available. RAS can use internal and external modems. Microsoft supports all modems listed in the RAS 1.1 MODEMS.INF file at a baud rate not to exceed the rate listed with the &ldquo;MAXBAUD=&ldquo; parameter in each modem's section. The MODEMS.INF file is the current listing.</p>
<p>
An unsupported modem MAY work if you:</p>
<p>
Click a supported modem in RAS Setup that is emulated by the  unsupported modem.</p>
<p>
&ndash; Or &ndash;</p>
<p>
Create its own MODEMS.INF file section containing the proper commands. </p>
<p>
<b>To do this, refer to these sources:</b></p>
<p>
RAS 1.1 README.TXT file section &ldquo;Using Non-Supported Modems&rdquo; and &ldquo;Modem Initialization String.&rdquo;</p>
<p>
&ldquo;RAS Administrator's Guide&rdquo; Appendix A, under &ldquo;Adding a New Modem to MODEMS.INF.&rdquo;</p>
<p>
The modem manufacturer's modem manual (for the correct codes for the &ldquo;COMMAND=&ldquo; line in the MODEMS.INF file).</p>
<h4>Note </h4>
<p>
A Modem does not have to be hooked up to a serial port in order for the &ldquo;NET START REMOTEACCESS&rdquo; server service to load. Also the RASADMIN utility starts properly (if everything else is set up correctly) and shows the RAS server as running. However, if you access the COM port status screen through the RASADMIN &ldquo;Server&rdquo; menu, by selecting &ldquo;Communication Ports&rdquo; and then &ldquo;Port Status,&rdquo; you will see these text strings:</p>
<p>
During Initialization:</p>
<p>
Line condition: &ldquo;Initializing modem&rdquo;</p>
<p>
Modem condition: &ldquo;Unknown&rdquo;</p>
<p>
Unknown/No modem:</p>
<p>
Line condition:  &ldquo;Line non-operational</p>
<p>
Modem condition: &ldquo;Modem not responding&rdquo;</p>
<p>
&ldquo;Hardware failure&rdquo;</p>
<p>
&ldquo;Hardware failure&rdquo; means that the modem failed for some reason after a &ldquo;No Errors&rdquo; condition. Turning the modem off could also cause this condition.</p>
<p>
RAS recognized the modem's response:</p>
<p>
Line condition:  &ldquo;Waiting for Call&rdquo;</p>
<p>
Modem condition: &ldquo;No Errors&rdquo;</p>
<p>
2.Serial Cable</p>
<p>
External modems require properly wired serial cables. For wiring diagrams, see the RAS 1.0 manual, Appendix A, pages 80, 81, or the RAS 1.1 manual, Appendix A, pages 92 and 93.</p>
<h4>Note </h4>
<p>
Serial mouse adapter cables are usually NOT wired correctly formodem communication purposes and should not be used.</p>
<p>
3.LAN MANAGER</p>
<p>
LAN Manager 2.1 (or later) with one protocol/network in addition to AsyBEUI.</p>
<p>
If the loopback driver is not used, RAS requires that you install a network adapter card that uses a  Certified Network Driver Interface Specification (NDIS) driver in addition to NetBEUI (or other protocol).</p>
<p>
4.User-Level Security</p>
<p>
User-level security is essential, because RAS relies on the User Accounts Subsystem database for keeping track of user names, passwords, and RAS permissions. Even so, users who are logged on to a RAS server can access LAN resources that have share-level security. For more information see the &ldquo;RAS Administrator's Guide,&rdquo; Chapter 2, &ldquo;User-level Security.&rdquo;</p>
<p>
5.RAS Server Configured as PDC, BDC, Member Server, or Standalone:</p>
<p>
If the RAS server is supposed to be separate from other domains or simply a non-networked machine, the easiest choice is primary domain controller.&rdquo; (See LAN Manager 2.1 Administrator's Guide, Chapter 4, page 62: &ldquo;Changing a Server's Role&rdquo;).</p>
<h4>Note  </h4>
<p>
&ldquo;Error 67&rdquo; when starting RASADMIN on a standalone server.</p>
<p>
Even if the server is configured as &ldquo;standalone,&rdquo; RASADMIN first tries to verify your administrator privilege by finding a primary domain controller with the domain name specified in the &ldquo;domain = &ldquo; line of the LANMAN.INI [workstation] section. Most standalone configurations have no valid domain with that name and RAS issues the message:</p>
<p>
Error 67: This network name cannot be found.</p>
<p>
If LANMAN.INI specifies a valid domain name where you also have an administrator account with the same password as in your standalone RAS server's user accounts database, RASADMIN starts, but it focuses on the other machine instead of the local standalone server. However, depending on the circumstances, RASADMIN issues other errors such as: </p>
<p>
Error 2320: The computer isn't active on this domain</p>
<p>
&ndash; Or &ndash;</p>
<p>
Error 5: Insufficient privilege</p>
<p>
If you receive these errors, click OK, then type in the dialog box the standalone RAS server's computer name as it appears in the LANMAN.INI [workstation] section (for example: computername=rasserver) preceded by two backslashes:</p>
<p>
\\rasserver (then press ENTER)</p>
<p>
The RAS server service should now be properly installed.</p>
<h4>Note </h4>
<p>
In LAN Manager 2.1a and later, the hardcoded domain name &ldquo;standalone&rdquo; allows users to log on faster if validation by a domain controller is bypassed. RASADMIN of RAS version 1<i>.x</i> is not aware of this feature and still responds with the errors shown above even if &ldquo;domain = standalone&rdquo; is specified in LANMAN.INI.</p>
<h4>REFERENCES</h4>
<p>
RAS 1.1 Release Notes</p>
<p>
LAN Manager &ldquo;Installation and Configuration Guide&rdquo;</p>
<p>
LAN Manager 2.1 &ldquo;Administrator's Guide,&rdquo; &ldquo;Changing a Server's Role,&rdquo; page 62</p>
<p>
Remote Access &ldquo;Administrator's Guide,&rdquo; Appendix A, &ldquo;Adding a New Modem to MODEMS.INF&rdquo;; Chapter 2, &ldquo;User-level Security&rdquo;</p>
<p>
RAS 1.0 manual, Appendix A, pages 80, 81</p>
<p>
RAS 1.1 manual, Appendix A, pages 92, 93</p>
<p>
KBCategory: kbnetwork</p>
<p>
KBSubcategory:</p>
<p>
Additional reference words: 2.10 2.10a 2.20</p>
<h2>Legal Disclaimers</h2>
<p>
The information contained in this document represents the current view of Microsoft Corporation on the issues discussed as of the date of publication. Because Microsoft must respond to changing market conditions, it should not be interpreted to be a commitment on the part of Microsoft, and Microsoft cannot guarantee the accuracy of any information presented after the date of publication.</p>
<p>
The third-party products discussed here are manufactured by vendors independent of Microsoft; we make no warranty, implied or otherwise, regarding these products' performance or reliability.</p>
<p>
The third-party contact information included in this article is provided to help you find the technical support you need. This contact information is subject to change without notice. Microsoft in no way guarantees the accuracy of this third-party contact information.</p>
<p>
THESE MATERIALS ARE PROVIDED &ldquo;AS-IS,&rdquo; FOR INFORMATIONAL PURPOSES ONLY.</p>
<p>
NEITHER MICROSOFT NOR ITS SUPPLIERS MAKE ANY WARRANTY, EXPRESS OR IMPLIED, WITH RESPECT TO THE CONTENT OF THESE MATERIALS OR THE ACCURACY OF ANY INFORMATION CONTAINED HEREIN, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. BECAUSE SOME STATES/JURISDICTIONS DO NOT ALLOW EXCLUSIONS OF IMPLIED WARRANTIES, THE ABOVE LIMITATION MAY NOT APPLY TO YOU. </p>
<p>
NEITHER MICROSOFT NOR ITS SUPPLIERS SHALL HAVE ANY LIABILITY FOR ANY DAMAGES WHATSOEVER INCLUDING CONSEQUENTIAL, INCIDENTAL, DIRECT, INDIRECT, SPECIAL, AND LOSS OF PROFITS. BECAUSE SOME STATES/JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF CONSEQUENTIAL OR INCIDENTAL DAMAGES, THE ABOVE LIMITATION MAY NOT APPLY TO YOU. IN ANY EVENT, MICROSOFT&rsquo;S AND ITS SUPPLIERS&rsquo; ENTIRE LIABILITY IN ANY MANNER ARISING OUT OF THESE MATERIALS, WHETHER BY TORT, CONTRACT, OR OTHERWISE, SHALL NOT EXCEED THE SUGGESTED RETAIL PRICE OF THESE MATERIALS.</p>

</FONT>
</BODY>
</HTML>
