<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Capacity Planning and Performance</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Capacity Planning and Performance</H3><P CLASS="t">Microsoft DNS server keeps track of a number of server usage statistics and displays these statistics in the right pane of the DNS Manager window. These statistics are cumulative; in other words they are started when the DNS server is started and are not cleared until the DNS server is stopped.</P>
<P CLASS="t">These statistics are useful for comparing relative name query traffic and load on each DNS server to determine how many name queries each DNS server is servicing. If one DNS server is busier than other DNS servers, you can direct some of the name query traffic away from the overloaded server to another server that is not as heavily loaded. For example if you have a primary and two secondaries, you can balance the load on the primary by configuring some of the DNS clients to point to one DNS secondary and other clients to point to the other DNS secondary. This reconfiguration can be done by using the DHCP server to change the DNS server which DHCP clients are configured to use, or by manually reconfiguring TCP/IP on non-DHCP enabled clients.</P>
<P CLASS="t">For capacity planning purposes, it is important to periodically compare the level of growth in usage of the DNS server versus the memory, disk, network, and CPU capabilities of the computer running the DNS server. If you feel that a DNS server is not responding as fast as it should, look first at the following performance monitor counters on that server. If any of the thresholds described in the following table are being met, there may be room to improve performance on the DNS server. </P>
<P CLASS="ttl"><B>Table 9.3    Using Performance Monitor Counters to Monitor DNS Server </B></P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="90pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B>Object</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Counter</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Threshold</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Notes</B></P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>processor </P></TD><TD VALIGN="TOP"><P>%processor time</P></TD><TD VALIGN="TOP"><P>&gt; 80%</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>memory </P></TD><TD VALIGN="TOP"><P>available bytes</P></TD><TD VALIGN="TOP"><P>&lt; 1 MB</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>physical disk </P></TD><TD VALIGN="TOP"><P>%disk time </P></TD><TD VALIGN="TOP"><P>&gt; 67%</P></TD><TD VALIGN="TOP"><P>only available if you start the counters from the command line with diskperf -y, and reboot</P></TD></TR><TR><TD VALIGN="TOP"><P>network segment </P></TD><TD VALIGN="TOP"><P>% network usage </P></TD><TD VALIGN="TOP"><P>&gt; 40%</P></TD><TD VALIGN="TOP"><P>only available if Network Monitor Agent is installed</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">If memory is an issue, then check the 'process' object, 'DNS' instance, 'Private Bytes' counter. If this counter is high, then the DNS service is causing the memory available bytes counter to be low. If this is the case, add more memory or possibly investigate which records are currently active in the DNS cache and find out the TTL associated with each.</P>
<P CLASS="t">If processor is an issue , check the 'process' object, 'DNS' instance, '%processor time' counter. If this is &gt; 80 %, consider running the DNS server on a more powerful server. If this is not high, and processor '%processor time' is still high, look at all the other processes and determine which process is requiring large amounts of CPU time.</P>
<P CLASS="t">On a DNS server, physical disk '%disk time' should not be a problem, unless the system has started paging for lack of memory. If this is the case, treat this as a memory issue.</P>
<P CLASS="t">If network use is a problem, find out if it is the DNS server that is causing all of the traffic or another server on the same segment. To do this, use the <B>Network Monitor</B> utility to examine the traffic that is received and sent by the server. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>DNS Server Memory Usage</H4><P CLASS="t">Microsoft DNS server cache memory is different than processing of resource records. Virtual (pageable) memory is allocated for cached data as needed (remember, as a DNS server performs name resolution for a name query, it caches a copy of the data which is retained for the time period specified by the TTL). If the DNS server requires more than the normal amount of cache memory, this memory is taken from the local computer page file and is usually slower than cache memory.</P></BODY></HTML>
