<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Upgrading the DHCP Database to Windows NT Server Version 4.0</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Upgrading the DHCP Database to Windows NT Server Version 4.0</H3><P CLASS="t">When upgrading a Windows NT Server version 3.51 (or earlier) release to Windows&nbsp;NT 4.0, the DHCP database must be converted to the new database format. This is required because the services now use an improved database engine that is faster and that compacts automatically to prevent fragmentation and consequent growth of the database. The database conversion procedure happens automatically as part of an upgrade installation.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>Database Conversion Procedure</H4><P CLASS="t">When the DHCP service first starts after an upgrade to Windows&nbsp;NT&nbsp;4.0, it detects that the database needs to be converted. It then starts a conversion process, Jetconv.exe. (If Jetconv.exe has already been started by another service, a second Jetconv.exe process is not started.) Prior to conversion, the user is notified that the conversion process is about to start and is asked for confirmation. If the user clicks <B>OK</B>, the DHCP service terminates and the conversion begins. Jetconv.exe converts the databases of all the installed services (DHCP and if installed WINS and RPL) to the new Windows&nbsp;NT 4.0 database format.</P>
<P CLASS="t">After the DHCP database is converted successfully, the DHCP Server service is automatically restarted.</P>
<P CLASS="t">Before starting the conversion process, note the following guidelines:</P>
<UL><LI>Prior to upgrading to Windows&nbsp;NT Server 4.0, bring the Windows NT 3.51 databases for the DHCP server to a consistent state. Do this by terminating the services, either by using <B>Service</B> in <B>Control Panel</B> or by using the <B>net stop</B> <B>service</B> command. This is recommended because it prevents the Jetconv.exe conversion from failing due to an inconsistent Windows&nbsp;NT 3.51 database.</LI><LI>The conversion requires approximately the same amount of free disk space as the size of the original database and log files. You should have at least 5 MB free for the log files for each database.</LI><LI>The conversion process preserves the original database and log files in a subdirectory named <I>351db</I> under the same directory where the original database and log files were located. On the DHCP server, this is the  <I>systemroot</I>\System32\dhcp\351db\ directory. The administrator can later remove these files to reclaim the disk space.</LI></UL><P CLASS="t">The database conversion can take anywhere from a minute to an hour depending on the size of the database. The user must not try to restart the services while the databases are being converted. To check the status of the conversion, the user should watch the Application Event Log of the Jetconv.exe process by using Event Viewer.</P>
<P CLASS="t">In case this automatic procedure of converting databases fails for some reason (as can be determined from the event logs), the database that couldn't be converted can be converted manually using <I>winntdir</I>\system32\upg351db.exe. At the command line, type <B>upg351db -?</B> for instructions.</P>
<P CLASS="t">Note the following information:</P>
<UL><LI>You cannot convert the new database back to the previous database format.</LI><LI>The converted database will not work with Windows NT 3.51 or earlier services.</LI><LI>The new database engine uses log files named by using the prefix <I>J50</I>.</LI></UL></BODY></HTML>
