<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scheduling Robocopy</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<p>
<b><u>Scheduling Robocopy</u></b></p>
<p>
You can use the Windows NT <b>AT</b> command, or the Resource Kit <b>SOON</b> command, with the</p>
<p>
Windows NT Schedule Service to create Robocopy jobs that run regularly in the background,</p>
<p>
to automatically maintain local mirrors of remote directory trees.</p>
<p>
By default the Schedule Service logs on as the System Account for the local system, which</p>
<p>
has no network access. Scheduled jobs run in the same context as the Schedule Service. So,</p>
<p>
in order to successfully schedule a Robocopy job, some extra configuration is required. There</p>
<p>
are basically two options :</p>
<p>
<b>Option 1)</b> Leave the Schedule Service running in the context of the local System Account,</p>
<p>
and schedule batch files of the following form :</p>
<b>NET USE \\</b>remoteserver<b>\IPC$ /USER:</b>userid password
<b>ROBOCOPY \\</b>remoteserver<b>\</b>sourcepath <b>\\</b>localserver<b>\</b>destpath ...
<b>NET USE \\</b>remoteserver<b>\IPC$ /DEL</b></code>
<p>
Within each such job, credentials with remote servers are established by connecting to the</p>
<p>
<b>IPC$</b> (Inter Process Communication) share on remote machines using an appropriate user</p>
<p>
account, rather than as the local System account. The disadvantage of this approach is that</p>
<p>
user passwords are stored in the batch files, but they can be protected by storing the batch</p>
<p>
files on an NTFS partition, and applying appropriate NTFS file security to the batch files.</p>
<p>
<b>Option 2)</b> In Control Panel/Services/Schedule Service/Startup configure the Schedule</p>
<p>
Service to use a "real" user account that you have created in User Manager, by specifying an</p>
<p>
appropriate User Id and Password in the "Log On As" section. Then you should Stop and</p>
<p>
Start the Schedule Service to get it running in the new user context. Once the nominated</p>
<p>
user has been granted appropriate access to source and destination servers, you can now</p>
<p>
schedule Robocopy jobs to copy files between them.</p>
<p>
Finally, as drive mappings can be changed by users, it is generally best to use UNC names</p>
<p>
for source and destination directories in scheduled Robocopy jobs, as these explicity specify</p>
<p>
file locations, and are more reliable. I.e. rather than scheduling a command of the form :</p>
<b>ROBOCOPY X:\</b>source <b>Y:\</b>dest ...</code>
<p>
for increased reliability, you should use commands of the form :</p>
<b>ROBOCOPY \\</b>server1<b>\</b>share1<b>\</b>source <b>\\</b>server2<b>\</b>share2<b>\</b>dest ...</code>
<p>
<b>AT</b> and the Schedule Service are documented in the Windows NT Commands on-line help.</p>
<p>
<b>SOON</b> is documented in the Windows NT Resource Kit on-line documentation.</p>

</FONT>
</BODY>
</HTML>
