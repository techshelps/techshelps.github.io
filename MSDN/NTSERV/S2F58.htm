<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logging Problems</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Logging Problems</H3><H4 CLASS="h3"><A NAME="sec0"></A>Logging to SQL Server on the Network Fails</H4><P CLASS="t">Although a valid SQL Server user name and password are entered on the <B>Logging</B> property sheet in Internet Service Manager, they might seem to disappear when you start Internet Service Manager. </P>
<P CLASS="t">This is a problem with SQL Server Login Security Mode set to Integrated. In Integrated mode, the user name and password specified in Internet Service Manager are ignored because SQL Server attempts to use the logon account specified when the computer running the IIS server was started. Because this account probably does not have permission to use SQL Server, Internet Information Server logging to SQL Server fails and the SQL Server log records this message:</P>
<P CLASS="spacing"><BR></P>
failure condition - logon failed because there is no valid user account.<BR>
<P CLASS="t">And the IIS server reports the following:</P>
<P CLASS="spacing"><BR></P>
Error: odbc reported an error. The Datasource name "<I>DSN_name</I>" may be <BR>incorrect. Check the server's event log for details.<BR>
<P CLASS="t">To resolve this issue, set the SQL Server Login Security Mode to Mixed. This setting enables the IIS server to access SQL Server for logging. Access to SQL Server by using other access methods is unaffected.</P>
<P CLASS="t">For more information about SQL Server Login Security Mode, see Part 4, "Security," of the <I>Administrator's Companion</I> in the <I>Microsoft SQL Server Books Online</I>.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Time Field Appears Wrong in Log</H4><P CLASS="t">The Microsoft Internet Information Server log file contains a Time field. This field displays the elapsed time from the start of a request (connect) until the request is finished and the item is about to be logged. The value represents only a checkpoint in terms of millisecond difference.</P></BODY></HTML>
