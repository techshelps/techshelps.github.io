<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Synchronization over WAN and Remote Area Service</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Synchronization over WAN and Remote Area Service</H3><P CLASS="t">Consideration should be given to the amount of traffic that account synchronization places on WAN or Remote Access Service (RAS) dial-up lines. Avoid full synchronizations across WAN links. Full synchronizations are required when first setting up a new PDC or bringing a new location online. Full synchronizations are also initiated when more than 2,000 changes happen to users or groups within a short time (less than one hour). If you anticipate high change activity, you can increase the value for the size of the change log. If the above conditions do not exist, the synchronization process will include only the changes made in the directory database since the last time synchronization occurred.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>BDC Over a RAS Link</H4><P CLASS="t">A BDC can be connected to a remote domain using Windows&nbsp;NT, a modem, and the Windows&nbsp;NT Server RAS. </P>
<H4 CLASS="h3"><A NAME="sec1"></A>Using a RAS-connected BDC as a PDC</H4><P CLASS="t">If a RAS-connected BDC is expected to be promoted to PDC at some time when it is remotely connected to the domain, this BDC should be set up as a dial-out-only RAS client (RAS is not running on this computer). If you promote the RAS-connected client, NetLogon stops, changes roles, and restarts. RAS depends on NetLogon, so when NetLogon stops, you would lose your connection. By having the RAS client dial-out services on this remote BDC, it can function as a PDC because that functionality does not depend on NetLogon running constantly. If neither the RAS server (which could also be a BDC) nor the RAS-connected BDC are ever expected to serve as PDC, this is not an issue. A RAS-connected BDC that has been promoted to PDC will function as it should, but may respond more slowly, depending on line speed.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Partial Synchronization with a RAS-connected BDC</H4><P CLASS="t">The default value for ChangeLogSize should be increased if either of the following conditions exist:</P>
<UL><LI>A remote site has a RAS-connected BDC that dials in nightly to do a partial synchronization of any changes.</LI><LI>Daily changes to the SAM/LSA database sometimes exceed 2,000.</LI></UL><P CLASS="t">Changing the default log size may also be necessary if many changes occur while a BDC is off-line. Otherwise, that BDC may be forced to do a full synchronization of the database. </P>
<P CLASS="t">If few changes occur during the time a BDC is not connected to the PDC, then the default size is sufficient. If an administrator notices a BDC doing full synchronizations, then it is probably a good idea to increase the ChangeLogSize. The default value for ChangeLogSize is 64K, which handles approximately 2,000 changes.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Calculating Replication Times</H4><P CLASS="t">Managing the amount of network traffic so that response time remains acceptable is an important part of administration. When the PDC is located across a WAN or modem link, you can estimate the amount of traffic and time needed to replicate directory database changes to and from the PDC and then schedule this traffic to meet the needs of the site. The following chart helps you calculate the time needed for replication:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="100pt" VALIGN="TOP"><COL WIDTH="199pt" VALIGN="TOP"><COL WIDTH="48pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Factors</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Password changes per month</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Number of user accounts</P></TD><TD VALIGN="TOP"><P CLASS="tt">A</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Passwords expire in how many (calendar) days</P></TD><TD VALIGN="TOP"><P CLASS="tt">B</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Divide <B>B</B> by 30</P></TD><TD VALIGN="TOP"><P CLASS="tt">C</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="tt">User account changes <B>A</B> + <B>C</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">D</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Additional changes per month</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">If number not knows, use 5% of <B>D</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">E</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="tt">New user accounts</P></TD><TD VALIGN="TOP"><P CLASS="tt">F</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Group changes * 4</P></TD><TD VALIGN="TOP"><P CLASS="tt">G</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="tt">New machine accounts * 5</P></TD><TD VALIGN="TOP"><P CLASS="tt">H</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Amount of data to be replicated per month</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">D +<B> E</B> + <B>F</B> + <B>G</B> + <B>H</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">I</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Total monthly replication time</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Compute throughput; modern/line speed in bps, If in KB, multiply by 1024 (i.e. 56KB = 57344 bps)</P></TD><TD VALIGN="TOP"><P CLASS="tt">J1</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>J1</B> * 8 bits/bytes =</P></TD><TD VALIGN="TOP"><P CLASS="tt">J2</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>J2</B> * 60 sec./min. =</P></TD><TD VALIGN="TOP"><P CLASS="tt">J3</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>J3</B> * 60 min./hour = total throughput</P></TD><TD VALIGN="TOP"><P CLASS="tt">J</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>I/J</B> = total replication time (hours/month)</P></TD><TD VALIGN="TOP"><P CLASS="tt">K</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="cap"><B>Figure 2.10    Job Aid to Calculate Monthly Replication Time</B></P></BODY></HTML>
