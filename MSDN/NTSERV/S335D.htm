<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Internet Group Management Protocol</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Internet Group Management Protocol </H3><P CLASS="t">Windows&nbsp;NT versions 4.0 and 3.5<I>x</I> provide level-2 (full) support for IP multicasting as specified in RFC 1112. The introduction to RFC 1112 provides a good overall summary of IP multicasting.  The text reads: </P>
<P CLASS="t">IP multicasting is the transmission of an IP datagram to a "host group", a set of zero or more hosts identified by a single IP destination address. A multicast datagram is delivered to all members of its destination host group with the same "best-efforts" reliability as regular unicast IP datagrams, i.e., the datagram is not guaranteed to arrive intact at all members of the destination group or in the same order relative to other datagrams. </P>
<P CLASS="t">The membership of a host group is dynamic; that is, hosts may join and leave groups at any time. There is no restriction on the location or number of members in a host group. A host may be a member of more than one group at a time. A host need not be a member of a group to send datagrams to it.</P>
<P CLASS="t">A host group may be permanent or transient. A permanent group has a well-known, administratively assigned IP address. It is the address, not the membership of the group, that is permanent; at any time a permanent group may have any number of members, even zero. Those IP multicast addresses that are not reserved for permanent groups are available for dynamic assignment to transient groups that exist only as long as they have members.</P>
<P CLASS="t">Internetwork forwarding of IP multicast datagrams is handled by "multicast routers" that may be co-resident with, or separate from, Internet gateways. A host transmits an IP multicast datagram as a local network multicast that reaches all immediately-neighboring members of the destination host group. If the datagram has an IP time-to-live greater than 1, the multicast router(s) attached to the local network take responsibility for forwarding it towards all other networks that have members of the destination group. On those other member networks that are reachable within the IP time-to-live, an attached multicast router completes delivery by transmitting the datagram as a local multicast.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>IP/ARP Extensions for IP Multicasting</H4><P CLASS="t">To support IP multicasting, an additional route is defined. The route (added by default) specifies that if a datagram is being sent to a multicast host group, it should be sent to the IP address of the host group by using the local interface card, not forwarded to the default gateway. The following route (which can be seen with the <B>route print</B> command) illustrates this: </P>

<TABLE COLS="6" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="100pt" VALIGN="TOP"><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="47pt" VALIGN="TOP"><COL WIDTH="2pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Network Address  </B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Netmask          </B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Gateway Address  </B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Interface       </B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Metric</B></P></TD></TR><TR><TD COLSPAN="5" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>224.0.0.0</P></TD><TD VALIGN="TOP"><P>224.0.0.0</P></TD><TD VALIGN="TOP"><P>172.16.80.138</P></TD><TD VALIGN="TOP"><P>172.16.80.138</P></TD><TD COLSPAN="2" VALIGN="TOP"><P>1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">Host group addresses are easily identified, because they are from the class D range, 224.0.0.0 to 239.255.255.255. These IP addresses all have "1110" as their high-order 4 bits. </P>
<P CLASS="t">To send a packet to a host group using the local interface, the IP address must be resolved to a MAC address. From RFC 1112:</P>
<P CLASS="t">An IP host group address is mapped to an Ethernet multicast address by placing the low-order 23 bits of the IP address into the low-order 23 bits of the Ethernet multicast address 01-00-5E-00-00-00 (hex). Because there are 28 significant bits in an IP host group address, more than one host group address may map to the same Ethernet multicast address.</P>
<P CLASS="t">For example, a datagram addressed to the multicast address 225.0.0.5 would be sent to the (Ethernet) MAC address 01-00-5E-00-00-05. This MAC address is formed by the junction of 01-00-5E and the 23 low-order bits of 225.0.0.5 (00-00-05). </P>
<P CLASS="t">Because more than one host group address might map to the same Ethernet multicast address, the NIC may indicate up some multicasts for a host group for which no local programs have registered interest. These extra multicasts are discarded. </P>
<P CLASS="t">Finally, the protocol stack must provide a means of joining and leaving host groups.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Using IP Multicasts with Windows Sockets Programs</H4><P CLASS="t">IP multicasting is currently supported only on AF_INET sockets of type SOCK_DGRAM. By default, IP multicast datagrams are sent with a time-to-live (TTL) of 1. The setsockopt() call can be used by a program to specify a TTL. By convention, multicast routers use TTL thresholds to determine how far to forward datagrams.  The following table lists the TTL thresholds that are used to determine how far to forward multicast datagrams.</P>
<P CLASS="cap"><B>Table 6.1    Time-to-Live Thresholds for Windows Sockets Programs</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B>TTL Threshold</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">TTL equal to  0</P></TD><TD VALIGN="TOP"><P CLASS="tt">Restricted to the same host</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">TTL equal to 1</P></TD><TD VALIGN="TOP"><P CLASS="tt">Restricted to the same subnet</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">TTL equal to 32</P></TD><TD VALIGN="TOP"><P CLASS="tt">Restricted to the same site</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">TTL equal to 64</P></TD><TD VALIGN="TOP"><P CLASS="tt">Restricted to the same region</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">TTL equal to 128</P></TD><TD VALIGN="TOP"><P CLASS="tt">Restricted to the same continent</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">TTL equal to 255</P></TD><TD VALIGN="TOP"><P CLASS="tt">Unrestricted in scope</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4 CLASS="h3"><A NAME="sec2"></A>Use of IGMP by Windows NT Components</H4><P CLASS="t">At the time of this writing. the only Windows NT component that uses IGMP is Windows Internet Name Service (WINS), which attempts to locate replication partners by using multicasting. </P></BODY></HTML>
