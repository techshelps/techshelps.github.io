<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting the WINS Server Database</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"></HEAD><BODY BGCOLOR="#FFFFFF">
<H3 CLASS="h2">Troubleshooting the WINS Server Database</H3><P CLASS="t">This section describes how to restore, rebuild, or move the WINS database. Also provided is a procedure for compacting the WINS database for Windows NT Server version 3.51 or earlier. (Microsoft WINS running under Windows&nbsp;NT Server version 4.0 provides automatic compacting of the WINS database.)</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Restoring a WINS Server Database</H4><P CLASS="t">If you have determined that the Windows Internet Name Service is running on the WINS server, but you cannot connect to the server using WINS Manager, then the WINS database is not available or has become corrupted. If a WINS server fails for any reason, you can restore the database from a backup copy.</P>
<P CLASS="t">You can use WINS Manager to restore the WINS database, or you can manually restore the database. For information about using WINS Manager to restore a WINS database, see the topic "Backing Up and Restoring the Database" in WINS<B> </B>Manager Help.</P>
<P CLASS="t"><B>To restore a WINS database manually</B></P>
<P>    1.    Before starting, make a copy of the WINS database files.</P>
<P>    2.    In the \%S<I>ystemroot%</I>\System32\Wins directory, delete the J50.log, J50#####.log, and Wins.tmp files.</P>
<P>    3.    Copy an uncorrupted backup version of Wins.mdb to the \<I>Systemroot</I>\System32\Wins directory.</P>
<P>    4.    Restart the WINS service on the WINS server, using the procedure in the next section.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Restarting and Rebuilding a Stopped WINS Server</H4><P CLASS="t">In rare circumstances, the WINS server may not start or a STOP error might occur. If the WINS server is stopped, use the following procedure to restart it.</P>
<P CLASS="t"><B>To restart a WINS server that is stopped</B></P>
<P>    1.    Turn off the power to the server and wait at least 15 seconds. </P>
<P>    2.    Turn on the power, start Windows&nbsp;NT Server, and then log on under an account with Administrator rights.</P>
<P>    3.    At the command prompt, type <B>net start wins</B>,<B> </B>and then press Enter.</P>
<P CLASS="t">If the hardware for the WINS server is malfunctioning or other problems prevent you from running Windows&nbsp;NT, you must rebuild the WINS database on another computer.</P>
<P CLASS="t"><B>To rebuild a WINS server</B></P>
<P>    1.    If you can start the original WINS server using MS-DOS, use MS-DOS to make backup copies of the files in the \<I>Systemroot</I>\System32\Wins directory.</P>
<P>If you cannot start the computer with MS-DOS, you must use the last backup version of the WINS database files.</P>
<P>    2.    Install Windows&nbsp;NT Server and Microsoft TCP/IP to create a new WINS server using the same hard drive location and \<I>Systemroot </I>directory.</P>
<P>That is, if the original server stored the WINS files on C:\Winnt35\System32\Wins, then the new WINS server must use this same path to the WINS files.</P>
<P>    3.    Make sure the WINS services on the new server are stopped, and then use the Registry Editor to restore the WINS keys from backup files.</P>
<P>    4.    Copy the WINS backup files to the \<I>Systemroot</I>\System32\Wins directory.</P>
<P>    5.    Restart the new, rebuilt WINS server.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Moving the WINS Server Database</H4><P CLASS="t">You may find a situation where you need to move a WINS database to another computer. To do this, use the following procedure.</P>
<P CLASS="t"><B>To move a WINS database</B></P>
<P>    1.    Stop the Windows Internet Name Service on the current computer, using the procedure in the preceding section.</P>
<P>    2.    Copy the \System32\Wins directory to the new computer that has been configured as a WINS server.</P>
<P>Make sure the new directory is under exactly the same drive letter and path as on the old computer.</P>
<P>If you must copy the files to a different directory, copy Wins.mdb, but do not copy the checkpoint (.chk) or log files.</P>
<P>    3.    Start the Windows Internet Name Service on the new computer.</P>
<P>The service automatically starts using the .mdb and .log files copied from the old computer.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Compacting the WINS Server Database</H4><P CLASS="t">Windows NT Server version 4.0 is designed to automatically compact the WINS database, and you should normally not need to run this procedure. However, if you are using Windows NT Server version 3.51 or earlier, after WINS has been running for a while, the database might need to be compacted to improve WINS performance. You should compact the WINS database whenever it approaches 30 MB. </P>
<P CLASS="t">You can use the Jetpack.exe utility provided with Windows NT Server version 3.5 and 3.51 to compact a WINS database. Jetpack.exe is a command-line utility that is run in the Windows NT Server command window. The utility is found in the \%S<I>ystemroot</I>\System32 directory. </P>
<P CLASS="t">The Jetpack.exe syntax is:</P>
<P CLASS="t"><B>Jetpack.exe</B> &lt;<I>database name</I>&gt; &lt;<I>temp database name</I>&gt;</P>
<P CLASS="t">For example:</P>
<P CLASS="spacing"><BR></P>
   &gt; CD %SYSTEMROOT%\SYSTEM32\WINS
   &gt; JETPACK WINS.MDB TMP.MDB
<P CLASS="t">In the preceding examples, Tmp.mdb is a temporary database that is used by Jetpack.exe. Wins.mdb is the WINS database file. When Jetpack.exe is started, it performs the following sequential tasks: </P>
<P>    1.    Copies database information to a temporary database file called Tmp.mdb.</P>
<P>    2.    Deletes the original database file, Wins.mdb. </P>
<P>    3.    Renames the temporary database file to the original filename.</P>
<P CLASS="t"><B>To compact the WINS database</B></P>
<P>    1.    In Control Panel, on the local WINS server computer, double-click <B>Services</B>.</P>
<P>    2.    Under Service, click <B>Windows Internet Name Service</B>.</P>
<P>    3.    Click <B>Stop,</B> and then click <B>Close</B>. (Alternatively, you can type <B>net stop wins</B> at the command prompt.)</P>
<P>    4.    Click <B>Start</B>, and then click <B>Run</B>.</P>
<P>    5.    In <B>Open</B>, type <B>Jetpack.exe</B>, and then click <B>OK</B>.</P>
<P>    6.    Restart the Windows Internet Name Service by using the <B>Services</B> dialog box.</P></BODY></HTML>
