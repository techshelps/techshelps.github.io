<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening and Closing Files</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_opening_and_closing_files"></a>Opening and Closing Files</h3>
<p>
An application must open an AVI file before reading or writing. To open an AVI file, use the <a href="../pdref/mmfunc_8l2m.htm"><b>AVIFileOpen</b></a> function. <b>AVIFileOpen</b> returns the address of an AVI file interface that contains the handle of the open file and increments the reference count of the file. </p>
<p>
The <b>AVIFileOpen</b> function supports the OF flags used with the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_openfile">
</object><a href=JavaScript:alink_1.Click()><b>OpenFile</b></a> function. If an application writes to an existing file, it must include the OF_WRITE flag in <b>AVIFileOpen</b>. Similarly, if your application creates and writes to a new file, you must include the OF_CREATE and OF_WRITE flags in <b>AVIFileOpen</b>.</p>
<p>
When you open a file using <b>AVIFileOpen</b>, you can use a default file handler or you can specify a custom file handler to read and write to the file and its data streams. In either case, AVIFile searches the registry for the correct file handler to use. You must ensure custom file handlers are in the registry before an application can access them.</p>
<p>
You can increment the reference count of a file by using the <a href="../pdref/mmfunc_950m.htm"><b>AVIFileAddRef</b></a> function. For example, you might want to do this when passing a handle of the file interface to another application, or when you want to keep a file open while using a function that would normally close the file. </p>
<p>
You can close a file by using the <a href="../pdref/mmfunc_98h1.htm"><b>AVIFileRelease</b></a> function. The <b>AVIFileRelease</b> function decrements the reference count of an AVI file, saves changes made to the file, and when the reference count reaches zero, closes the file. Your applications should balance the reference count by including a call to <b>AVIFileRelease</b> for each use of <a href="../pdref/mmfunc_8l2m.htm"><b>AVIFileOpen</b></a> and <b>AVIFileAddRef</b>.</p>
<p>
<b>Note</b>&nbsp;&nbsp;An application can open a file with one or more program threads. However, for the best possible performance, only one thread should access the file at any one time.</p>
<p>&nbsp;</p></body>
</HTML>
