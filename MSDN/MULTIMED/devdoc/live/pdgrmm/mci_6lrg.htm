<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Device Control</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_device_control"></a>Device Control</h3>
<p>
To control an MCI device, you open the device, send the necessary commands to it, and then close the device. The commands can be very similar, even for completely different MCI devices. For example, the following series of MCI commands plays the sixth track of an audio CD by using the command-string interface:</p>
<pre><code>mciSendString("open cdaudio", lpszReturnString,
    lstrlen(lpszReturnString), NULL);
mciSendString("set cdaudio time format tmsf", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
mciSendString("play cdaudio from 6 to 7", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
mciSendString("close cdaudio", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
 </code></pre>
<p>
The next example shows a similar series of MCI commands that plays the first 10,000 samples of a waveform-audio file:</p>
<pre><code>mciSendString(
    "open c:\mmdata\purplefi.wav type waveaudio alias finch", 
    lpszReturnString, lstrlen(lpszReturnString), NULL);
mciSendString("set finch time format samples", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
mciSendString("play finch from 1 to 10000", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
mciSendString("close finch", lpszReturnString, 
    lstrlen(lpszReturnString), NULL);
 </code></pre>
<p>
These examples illustrate some interesting facts about MCI commands:
<ul>
<li>
The same basic commands (<a href="../pdref/mmcmdstr_7226.htm"><b>open</b></a>, <a href="../pdref/mmcmdstr_8eyc.htm"><b>set</b></a>, <a href="../pdref/mmcmdstr_2bi1.htm"><b>play</b></a>, and <a href="../pdref/mmcmdstr_4y3p.htm"><b>close</b></a>) are used with CD audio and waveform-audio devices. The same MCI commands are used with all MCI devices. </li>
<li>
The <b>open</b> command for the waveform-audio device includes a filename specification. The waveform-audio device is a <i>compound device</i> (one associated with a data file), while the CD audio device is a <i>simple device</i> (one without an associated data file).</li>
<li>
The <b>set</b> command specifies time formats in each case, but the time-format flag for the CD audio device specifies tracks/minutes/seconds/frames (TMSF) format, while the time format used with the waveform-audio device specifies "samples".</li>
<li>
The variables used with the "from" and "to" flags are appropriate to the respective time format. For example, for the CD audio device, the variables specify a range of tracks, but for the waveform-audio device, the variables specify a range of samples.</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
