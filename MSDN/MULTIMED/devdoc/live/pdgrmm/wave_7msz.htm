<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Audio Data Blocks</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_audio_data_blocks"></a>Audio Data Blocks</h2>
<p>
The <a href="../pdref/mmfunc_7aya.htm"><b>waveInAddBuffer</b></a><b> </b>and <a href="../pdref/mmfunc_1k9x.htm"><b>waveOutWrite</b></a><b> </b>functions require applications to allocate data blocks to pass to the device drivers for recording or playback purposes. Both of these functions use the <a href="../pdref/mmstr_7zsi.htm"><b>WAVEHDR</b></a> structure to describe its data block. </p>
<p>
Before using one of these functions to pass a data block to a device driver, you must allocate memory for the data block and the header structure that describes the data block. The headers can be prepared and unprepared by using the following functions.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Function</th>
<th align=left width=59%>Description</th>
</tr>
<tr valign=top>
<td width=41%><a href="../pdref/mmfunc_2b76.htm"><b>waveInPrepareHeader</b></a></td>
<td width=59%>Prepares a waveform-audio input data block.</td>
</tr>
<tr valign=top>
<td width=41%><a href="../pdref/mmfunc_3ueq.htm"><b>waveInUnprepareHeader</b></a></td>
<td width=59%>Cleans up the preparation on a waveform-audio input data block.</td>
</tr>
<tr valign=top>
<td width=41%><a href="../pdref/mmfunc_93ci.htm"><b>waveOutPrepareHeader</b></a></td>
<td width=59%>Prepares a waveform-audio output data block.</td>
</tr>
<tr valign=top>
<td width=41%><a href="../pdref/mmfunc_2h82.htm"><b>waveOutUnprepareHeader</b></a></td>
<td width=59%>Cleans up the preparation on a waveform-audio output data block.</td>
</tr>
</table><br>
<p>
Before you pass an audio data block to a device driver, you must prepare the data block by passing it to either <a href="../pdref/mmfunc_2b76.htm"><b>waveInPrepareHeader</b></a> or <a href="../pdref/mmfunc_93ci.htm"><b>waveOutPrepareHeader</b></a>. When the device driver is finished with the data block and returns it, you must clean up this preparation by passing the data block to either <a href="../pdref/mmfunc_3ueq.htm"><b>waveInUnprepareHeader</b></a> or <a href="../pdref/mmfunc_2h82.htm"><b>waveOutUnprepareHeader</b></a> before any allocated memory can be freed.</p>
<p>
Unless the waveform-audio input and output data is small enough to be contained in a single data block, applications must continually supply the device driver with data blocks until playback or recording is complete. </p>
<p>
Even if a single data block is used, an application must be able to determine when a device driver is finished with the data block so the application can free the memory associated with the data block and header structure. There are several ways to determine when a device driver is finished with a data block:
<ul>
<li>
By specifying a callback function to receive a message sent by the driver when it is finished with a data block</li>
<li>
By using an event callback</li>
<li>
By specifying a window or thread to receive a message sent by the driver when it is finished with a data block</li>
<li>
By polling the WHDR_DONE bit in the <b>dwFlags</b> member of the <a href="../pdref/mmstr_7zsi.htm"><b>WAVEHDR</b></a> structure sent with each data block</li>
</ul>
<p>
If an application does not get a data block to the device driver when needed, there can be an audible gap in playback or a loss of incoming recorded information. This requires at least a double-buffering scheme — staying at least one data block ahead of the device driver.</p>
<p>
The following sections describe ways to determine when a device driver is finished with a data block:
<ul>
<li>
<a href="wave_5zub.htm">Using a callback function to process driver messages</a></li>
<li>
<a href="wave_331v.htm">Using an event callback to process driver messages</a></li>
<li>
<a href="wave_5ar7.htm">Using a window or thread to process driver messages</a></li>
<li>
<a href="wave_95rb.htm">Managing data blocks by polling</a></li>
</ul>
<p>&nbsp;</p></body>
</HTML>
