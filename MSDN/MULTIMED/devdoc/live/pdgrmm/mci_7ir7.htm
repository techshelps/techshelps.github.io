<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI Functions, Macros, and Messages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_mci_functions_macros_and_messages"></a>MCI Functions, Macros, and Messages</h2>
<p>
Most MCI applications use the <a href="../pdref/mmfunc_5lrb.htm"><b>mciSendString</b></a> and <a href="../pdref/mmfunc_1xwk.htm"><b>mciSendCommand</b></a> functions dozens of times. MCI provides some other useful functions that your application will use less frequently.</p>
<p>
The device identifier required by most MCI commands is typically retrieved in a call to the <a href="../pdref/mmcmdstr_7226.htm"><b>open</b></a> (<a href="../pdref/mmcmd_3vzi.htm"><b>MCI_OPEN</b></a>) command. If you need a device identifier but do not want to open the device — for example, if you want to query the capabilities of the device before taking any other action — you can call the <a href="../pdref/mmfunc_3v38.htm"><b>mciGetDeviceID</b></a> function.</p>
<p>
The <a href="../pdref/mmfunc_5e7f.htm"><b>mciGetCreatorTask</b></a> function allows your application to use a device identifier to retrieve a handle to the task that created that identifier.</p>
<p>
You can use the <a href="../pdref/mmfunc_62lf.htm"><b>mciGetYieldProc</b></a> and <a href="../pdref/mmfunc_6gir.htm"><b>mciSetYieldProc</b></a> functions to assign and retrieve the address of the callback function associated with the "wait" (MCI_WAIT) flag.</p>
<p>
The <a href="../pdref/mmfunc_3q3r.htm"><b>mciGetErrorString</b></a> function retrieves a string that describes an MCI error value. Each string that MCI returns, whether data or an error description, is a maximum of 128 characters. Dialog box fields that are smaller than 128 characters will truncate the longer strings returned by MCI. For more information about these strings, see <a href="../pdref/mmconst_7lwz.htm">Constants: MCIERR Return Values</a>. </p>
<p>
The MCI macros are tools you can use to create and disassemble values that specify time formats. These time formats are used in many MCI commands. The formats acted on by the macros are hours/minutes/seconds (HMS), minutes/seconds/frames (MSF), and tracks/minutes/seconds/frames (TMSF). The following table lists the macros and their descriptions.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Macro</th>
<th align=left width=66%>Description</th>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_0sdu.htm"><b>MCI_HMS_HOUR</b></a></td>
<td width=66%>Retrieves the hours component from an HMS value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_33hh.htm"><b>MCI_HMS_MINUTE</b></a></td>
<td width=66%>Retrieves the minutes component from an HMS value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_6go4.htm"><b>MCI_HMS_SECOND</b></a></td>
<td width=66%>Retrieves the seconds component from an HMS value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_3g37.htm"><b>MCI_MAKE_HMS</b></a></td>
<td width=66%>Creates an HMS value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_3w6e.htm"><b>MCI_MAKE_MSF</b></a></td>
<td width=66%>Creates an MSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_810m.htm"><b>MCI_MAKE_TMSF</b></a></td>
<td width=66%>Creates a TMSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_7rtx.htm"><b>MCI_MSF_FRAME</b></a></td>
<td width=66%>Retrieves the frames component from an MSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_2ztx.htm"><b>MCI_MSF_MINUTE</b></a></td>
<td width=66%>Retrieves the minutes component from an MSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_6d0k.htm"><b>MCI_MSF_SECOND</b></a></td>
<td width=66%>Retrieves the seconds component from an MSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_6mg5.htm"><b>MCI_TMSF_FRAME</b></a></td>
<td width=66%>Retrieves the frames component from a TMSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_9fc5.htm"><b>MCI_TMSF_MINUTE</b></a></td>
<td width=66%>Retrieves the minutes component from a TMSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_2sis.htm"><b>MCI_TMSF_SECOND</b></a></td>
<td width=66%>Retrieves the seconds component from a TMSF value.</td>
</tr>
<tr valign=top>
<td width=34%><a href="../pdref/mmmacro_0xbf.htm"><b>MCI_TMSF_TRACK</b></a></td>
<td width=66%>Retrieves the tracks component from a TMSF value.</td>
</tr>
</table><br>
<p>
MCI also provides two messages: <a href="../pdref/mmmsg_68ah.htm">MM_MCINOTIFY</a> and <a href="../pdref/mmmsg_64h8.htm">MM_MCISIGNAL</a>. The MM_MCINOTIFY message notifies an application of the outcome of an MCI command whenever that command specifies the "notify" (MCI_NOTIFY) flag. The MM_MCISIGNAL message is specific to digital-video devices; it notifies the application when a specified position is reached.</p>
<p>&nbsp;</p></body>
</HTML>
