<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Querying MIDI Output Devices</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_querying_midi_output_devices"></a>Querying MIDI Output Devices</h3>
<p>
Before playing a MIDI file, you should use the <a href="../pdref/mmfunc_4wab.htm"><b>midiOutGetDevCaps</b></a> function to determine the capabilities of the MIDI output device that is present in the system. This function takes an address of a <a href="../pdref/mmstr_16ya.htm"><b>MIDIOUTCAPS</b></a> structure, which it fills with information about the capabilities of the given device. This information includes the manufacturer and product identifiers, a product name for the device, and the version number of the device driver (specified in the <b>wMid</b>, <b>wPid</b>, <b>szPname</b>, and <b>vDriverVersion</b> members, respectively). </p>
<p>
MIDI output devices can be either internal synthesizers or external MIDI output ports. The <b>wTechnology</b> member of the <b>MIDIOUTCAPS</b> structure specifies the technology of the device.</p>
<p>
If the device is an internal synthesizer, additional device information is available in the <b>wVoices</b>, <b>wNotes</b>, and <b>wChannelMask</b> members. The <b>wVoices</b> member specifies the number of voices that the device supports. Each voice can have a different sound or timbre. Voices are organized into MIDI channels. The <b>wNotes</b> member specifies the <i>polyphony</i> of the device — that is, the maximum number of notes that can be played simultaneously. The <b>wChannelMask</b> member is a bit representation of the MIDI channels that the device responds to. For example, if the device responds to the first eight MIDI channels, <b>wChannelMask</b> is 0x00FF. If the device is an external output port, <b>wVoices</b> and <b>wNotes </b>are unused, and <b>wChannelMask</b> is set to 0xFFFF.</p>
<p>
The <b>dwSupport</b> member of the <b>MIDIOUTCAPS</b> structure indicates whether the device driver supports volume changes, patch caching, and streaming. Volume changes are supported only by internal synthesizer devices. External MIDI output ports do not support volume changes. For information about changing volume, see <a href="midi_5xr9.htm">Changing Internal MIDI Synthesizer Volume</a>.</p>
<p>&nbsp;</p></body>
</HTML>
