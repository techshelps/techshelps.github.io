<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Limiting the Playback Scope</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_limiting_the_playback_scope"></a>Limiting the Playback Scope</h2>
<p>
Controlling playback begins with the <a href="../pdref/mmmacro_503d.htm"><b>MCIWndPlay</b></a> macro, which plays the content or file associated with an MCIWnd window from the current playback position to the end of the content. If you want to limit playback to a specific portion of the content or file, you can choose from the other playback MCIWnd macros: <a href="../pdref/mmmacro_44vh.htm"><b>MCIWndPlayFrom</b></a>, <a href="../pdref/mmmacro_0s8f.htm"><b>MCIWndPlayTo</b></a>, and <a href="../pdref/mmmacro_8qnj.htm"><b>MCIWndPlayFromTo</b></a>.</p>
<p>
You also need to set an appropriate time format. The time format determines whether the content is measured in frames, milliseconds, tracks, or some other units. </p>
<p>
The following example creates an MCIWnd window and provides menu commands to play the last third, first third, or middle third of the content. These menu commands use <b>MCIWndPlayFrom</b>, <b>MCIWndPlayTo</b>, and <b>MCIWndPlayFromTo</b> to play the content segments. The example also uses the <a href="../pdref/mmmacro_06ic.htm"><b>MCIWndGetStart</b></a> and <a href="../pdref/mmmacro_2hr8.htm"><b>MCIWndGetEnd</b></a> macros to identify the beginning and end of the content, and it uses the <a href="../pdref/mmmacro_0bz9.htm"><b>MCIWndHome</b></a> macro to move the playback position to the beginning of the content. </p>
<p>
The <a href="../pdref/mmfunc_6jc5.htm"><b>MCIWndCreate</b></a> function uses the WS_CAPTION and MCIWNDF_SHOWALL styles in addition to the standard window styles to display the filename, mode, and current playback position in the title bar of the MCIWnd window. </p>
<pre><code>case WM_COMMAND: 
    switch (wParam) 
    { 
        case IDM_CREATEMCIWND: 
            g_hwndMCIWnd = MCIWndCreate(hwnd, 
                g_hinst, 
                WS_CHILD | WS_VISIBLE | WS_CAPTION | 
                MCIWNDF_SHOWALL, 
                "sample.avi"); 
            break;
        case IDM_PLAYFROM:                // plays last third of clip 
            MCIWndUseTime(g_hwndMCIWnd);  // millisecond format 
 
        // Get media start and end positions. 
            lStart = MCIWndGetStart(g_hwndMCIWnd); 
            lEnd = MCIWndGetEnd(g_hwndMCIWnd); 
 
        // Determine playback end position. 
            lPlayStart = 2 * (lEnd - lStart) / 3 + lStart; 
 
            MCIWndPlayFrom(g_hwndMCIWnd, lPlayStart); 
            break; 
        case IDM_PLAYTO:                  // plays first third of clip 
            MCIWndUseTime(g_hwndMCIWnd);  // millisecond format 
 
        // Get media start and end positions. 
            lStart = MCIWndGetStart(g_hwndMCIWnd); 
            lEnd = MCIWndGetEnd(g_hwndMCIWnd); 
 
        // Determine playback start position. 
            lPlayEnd = (lEnd - lStart) / 3 + lStart;
 
            MCIWndHome(g_hwndMCIWnd); 
            MCIWndPlayTo(g_hwndMCIWnd, lPlayEnd); 
            break; 
        case IDM_PLAYSOME:               // plays middle third of clip 
            MCIWndUseTime(g_hwndMCIWnd); // millisecond format 
 
        // Get media start and end positions. 
            lStart = MCIWndGetStart(g_hwndMCIWnd); 
            lEnd = MCIWndGetEnd(g_hwndMCIWnd); 
 
        // Determine playback start and end positions. 
            lPlayStart = (lEnd - lStart) / 3 + lStart;
            lPlayEnd = 2 * (lEnd - lStart) / 3 + lStart; 
 
            MCIWndPlayFromTo(g_hwndMCIWnd, lPlayStart, lPlayEnd); 
            break; 
    
    // Handle other commands here. 
    } 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
