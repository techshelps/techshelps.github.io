<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Devices and Data Types</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_devices_and_data_types"></a>Devices and Data Types</h3>
<p>
This section describes working with waveform-audio devices, and includes information on how to open, close and query them for their capabilities. It also describes how to keep track of the devices in a system by using device handles and device identifiers.</p>
<h4>Opening Waveform-Audio Output Devices</h4>
<p>
Use the <a href="../pdref/mmfunc_36b2.htm"><b>waveOutOpen</b></a> function to open a waveform-audio output device for playback. This function opens the device associated with the specified device identifier and returns a handle of the open device by writing the handle of a specified memory location. </p>
<p>
Some multimedia computers have multiple waveform-audio output devices. Unless you want to open a specific waveform-audio output device in a system, you should use the WAVE_MAPPER flag for the device identifier when you open a device. The <b>waveOutOpen</b> function chooses the device in the system that is best able to play the specified data format.</p>
<h4>Querying Audio Devices</h4>
<p>
Windows provides the following functions to determine how many devices of a certain type are available in a system.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Function</th>
<th align=left width=68%>Description</th>
</tr>
<tr valign=top>
<td width=32%><a href="../pdref/mmfunc_08hf.htm"><b>auxGetNumDevs</b></a><b> </b></td>
<td width=68%>Retrieves the number of auxiliary output devices present in the system. </td>
</tr>
<tr valign=top>
<td width=32%><a href="../pdref/mmfunc_5oj7.htm"><b>WaveInGetNumDevs</b></a><b> </b></td>
<td width=68%>Retrieves the number of waveform-audio input devices present in the system. </td>
</tr>
<tr valign=top>
<td width=32%><a href="../pdref/mmfunc_2ooj.htm"><b>WaveOutGetNumDevs</b></a><b> </b></td>
<td width=68%>Retrieves the number of waveform-audio output devices present in the system.</td>
</tr>
</table><br>
<p>
Audio devices are identified by a device identifier. The device identifier is determined implicitly from the number of devices present in a system. Device identifiers range from zero to one less than the number of devices present. For example, if there are two waveform-audio output devices in a system, valid device identifiers are 0 and 1.</p>
<p>
After you determine how many devices of a certain type are present in a system, you can use one of the following functions to query the capabilities of each device. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Function</th>
<th align=left width=68%>Description</th>
</tr>
<tr valign=top>
<td width=32%><a href="../pdref/mmfunc_7lrn.htm"><b>auxGetDevCaps</b></a></td>
<td width=68%>Retrieves the capabilities of a specified auxiliary output device.</td>
</tr>
<tr valign=top>
<td width=32%><a href="../pdref/mmfunc_31tf.htm"><b>waveInGetDevCaps</b></a></td>
<td width=68%>Retrieves the capabilities of a specified waveform-audio input device.</td>
</tr>
<tr valign=top>
<td width=32%><a href="../pdref/mmfunc_01yr.htm"><b>waveOutGetDevCaps</b></a></td>
<td width=68%>Retrieves the capabilities of a specified waveform-audio output device.</td>
</tr>
</table><br>
<p>
Each of these functions fills a structure with information about the capabilities of a specified device. The following table lists the structures that correspond to each of these functions.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Function</th>
<th align=left width=69%>Structure</th>
</tr>
<tr valign=top>
<td width=31%><a href="../pdref/mmfunc_7lrn.htm"><b>auxGetDevCaps</b></a></td>
<td width=69%><a href="../pdref/mmstr_8prm.htm"><b>AUXCAPS</b></a></td>
</tr>
<tr valign=top>
<td width=31%><a href="../pdref/mmfunc_31tf.htm"><b>waveInGetDevCaps</b></a></td>
<td width=69%><a href="../pdref/mmstr_1ble.htm"><b>WAVEINCAPS</b></a></td>
</tr>
<tr valign=top>
<td width=31%><a href="../pdref/mmfunc_01yr.htm"><b>waveOutGetDevCaps</b></a></td>
<td width=69%><a href="../pdref/mmstr_9t2q.htm"><b>WAVEOUTCAPS</b></a></td>
</tr>
</table><br>
<p>
Standard formats are listed in the <b>dwFormats</b> member of the <b>WAVEOUTCAPS</b> structure. Waveform-audio devices can support nonstandard formats. To determine whether a particular format (standard or nonstandard) is supported by a device, you can call the <a href="../pdref/mmfunc_36b2.htm"><b>waveOutOpen</b></a> function with the WAVE_FORMAT_QUERY flag. This flag does not open the device. You specify the format in question in the <a href="../pdref/mmstr_625u.htm"><b>WAVEFORMATEX</b></a> structure pointed to by the <i>pwfx</i> parameter passed to <b>waveOutOpen</b>. For information about setting up this structure, see <a href="#_win32_devices_and_data_types">Devices and Data Types</a>.</p>
<p>
Waveform-audio output devices vary in the capabilities they support. The <b>dwSupport</b> member of the <a href="../pdref/mmstr_9t2q.htm"><b>WAVEOUTCAPS</b></a> structure indicates whether a device supports such capabilities as volume and pitch changes. </p>
<h4>Device Handles and Device Identifiers</h4>
<p>
Each function that opens an audio device specifies a device identifier, a pointer to a memory location, and some parameters that are unique to each type of device. The memory location is filled with a device handle. Use this device handle to identify the open audio device when calling other audio functions.</p>
<p>
The difference between identifiers and handles for audio devices is subtle but important:
<ul>
<li>
Device identifiers are determined implicitly from the number of devices present in a system. This number is obtained by using the <a href="../pdref/mmfunc_08hf.htm"><b>auxGetNumDevs</b></a>, <a href="../pdref/mmfunc_5oj7.htm"><b>waveInGetNumDevs</b></a>, or <a href="../pdref/mmfunc_2ooj.htm"><b>waveOutGetNumDevs</b></a> function.</li>
<li>
Device handles are returned when device drivers are opened by using the <a href="../pdref/mmfunc_1q5q.htm"><b>waveInOpen</b></a><b> </b>or<b> <a href="../pdref/mmfunc_36b2.htm">waveOutOpen</a> </b>function.</li>
</ul>
<p>
There are no functions that open or close auxiliary audio devices. Auxiliary audio devices need not be opened and closed like waveform-audio devices because there is no continuous data transfer associated with them. All auxiliary audio functions use device identifiers to identify devices.</p>
<h4>Waveform-Audio Output Data Types</h4>
<p>
The following data types are defined for waveform-audio output functions.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=30%>Type</th>
<th align=left width=70%>Description</th>
</tr>
<tr valign=top>
<td width=30%><b>HWAVEOUT</b></td>
<td width=70%>Handle to an open waveform-audio output device.</td>
</tr>
<tr valign=top>
<td width=30%><a href="../pdref/mmstr_625u.htm"><b>WAVEFORMATEX</b></a></td>
<td width=70%>Structure that specifies the data formats supported by a particular waveform-audio input device. This structure is also usedfor waveform-audio input devices.</td>
</tr>
<tr valign=top>
<td width=30%><a href="../pdref/mmstr_7zsi.htm"><b>WAVEHDR</b></a></td>
<td width=70%>Structure used as a header for a block of waveform-audio input data. This structure is also used for waveform-audio input devices.</td>
</tr>
<tr valign=top>
<td width=30%><a href="../pdref/mmstr_9t2q.htm"><b>WAVEOUTCAPS</b></a></td>
<td width=70%>Structure used to query the capabilities of a particular waveform-audio output device.</td>
</tr>
</table><br>
<h4>Specifying Waveform-Audio Data Formats</h4>
<p>
When you call the <a href="../pdref/mmfunc_36b2.htm"><b>waveOutOpen</b></a> function to open a device driver for playback or to query whether the driver supports a particular data format, use the <i>pwfx</i> parameter to specify a pointer to a <a href="../pdref/mmstr_625u.htm"><b>WAVEFORMATEX</b></a> structure containing the requested waveform-audio data format. The <b>WAVEFORMATEX</b> structure is an extended version of the <a href="../pdref/mmstr_5kky.htm"><b>WAVEFORMAT</b></a> structure. It contains all the members of <b>WAVEFORMAT</b>, and adds two more: a <b>wBitsPerSample</b> member, which contains extra information required for the PCM (Pulse Code Modulation) format, and a <b>cbSize</b> member at the end. You can append data to the structure following <b>cbSize</b> as long as you fill <b>cbSize</b> with the size of the data. You can use the <b>WAVEFORMATEX</b> structure to describe PCM data, although you could also use the <a href="../pdref/mmstr_7gtu.htm"><b>PCMWAVEFORMAT</b></a> structure. When the waveform-audio format type is not PCM, you must use <b>WAVEFORMATEX</b> instead of <b>WAVEFORMAT</b>.</p>
<p>
The outmoded <b>WAVEFORMAT</b> structure does not contain all the information required to describe the PCM format. The <b>PCMWAVEFORMAT</b> structure includes a <b>WAVEFORMAT</b> structure along with an additional member containing PCM-specific information. The <b>PCMWAVEFORMAT</b> structure has also been superseded by the <b>WAVEFORMATEX</b> structure.</p>
<p>
There are also two clipboard formats you can use to represent audio data: CF_WAVE and CF_RIFF. Use the CF_WAVE format to represent data in one of the standard formats, such as 11 kHz or 22 kHz PCM. Use the CF_RIFF format to represent more complex data formats that cannot be represented as standard waveform-audio files. </p>
<h4>Writing Waveform-Audio Data</h4>
<p>
After successfully opening a waveform-audio output device driver, you can begin playing a sound. Windows provides the <a href="../pdref/mmfunc_1k9x.htm"><b>waveOutWrite</b></a><b> </b>function for sending data blocks to waveform-audio output devices.</p>
<p>
Use the <a href="../pdref/mmstr_7zsi.htm"><b>WAVEHDR</b></a> structure to specify the waveform-audio data block you are sending using <b>waveOutWrite</b>. This structure contains a pointer to a locked data block, the length of the data block, and some flags. This data block must be prepared before you use it; for information about preparing a data block, see <a href="wave_7msz.htm">Audio Data Blocks</a>.</p>
<p>
After you send a data block to an output device by using <b>waveOutWrite</b>, you must wait until the device driver is finished with the data block before freeing it. If you are sending multiple data blocks, you must monitor the completion of data blocks to know when to send additional blocks. For more information about data blocks, see <a href="wave_7msz.htm">Audio Data Blocks</a>.</p>
<h5>PCM Waveform-Audio Data Format</h5>
<p>
The <b>lpData</b> member of the <a href="../pdref/mmstr_7zsi.htm"><b>WAVEHDR</b></a> structure points to the waveform-audio data samples. For 8-bit PCM data, each sample is represented by a single unsigned data byte. For 16-bit PCM data, each sample is represented by a 16-bit signed value. The following table summarizes the maximum, minimum, and midpoint values for PCM waveform-audio data.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=25%>Data format</th>
<th align=left width=25%>Maximum value</th>
<th align=left width=25%>Minimum value</th>
<th align=left width=25%>Midpoint value</th>
</tr>
<tr valign=top>
<td width=25%>8-bit PCM</td>
<td width=25%>255 (0xFF)</td>
<td width=25%>0</td>
<td width=25%>128 (0x80)</td>
</tr>
<tr valign=top>
<td width=25%>16-bit PCM</td>
<td width=25%>32,767 (0x7FFF)</td>
<td width=25%>– 32,768 (0x8000)</td>
<td width=25%>0</td>
</tr>
</table><br>
<h5>PCM Data Packing</h5>
<p>
The order of the data bytes varies between 8-bit and 16-bit formats and between mono and stereo formats. The following list describes data packing for the different PCM waveform-audio data formats.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>PCM waveform-audio format</th>
<th align=left width=80%><br>
<br>
<br>
Description</th>
</tr>
<tr valign=top>
<td width=20%>8-bit mono </td>
<td width=80%>Each sample is 1 byte that corresponds to a single audio channel. Sample 1 is followed by samples 2, 3, 4, and so on. </td>
</tr>
<tr valign=top>
<td width=20%>8-bit stereo </td>
<td width=80%>Each sample is 2 bytes. Sample 1 is followed by samples 2, 3, 4, and so on. For each sample, the first byte is channel 0 (the left channel) and the second byte is channel 1 (the right channel).</td>
</tr>
<tr valign=top>
<td width=20%>16-bit mono </td>
<td width=80%>Each sample is 2 bytes. Sample 1 is followed by samples 2, 3, 4, and so on. For each sample, the first byte is the low-order byte of channel 0 and the second byte is the high-order byte of channel 0.</td>
</tr>
<tr valign=top>
<td width=20%>16-bit stereo</td>
<td width=80%>Each sample is 4 bytes. Sample 1 is followed by samples 2, 3, 4, and so on. For each sample, the first byte is the low-order byte of channel 0 (left channel); the second byte is the high-order byte of channel 0; the third byte is the low-order byte of channel 1 (right channel); and the fourth byte is the high-order byte of channel 1.</td>
</tr>
</table><br>
<h4>Closing Waveform-Audio Output Devices</h4>
<p>
After waveform-audio playback is complete, call <a href="../pdref/mmfunc_6hwl.htm"><b>waveOutClose</b></a> to close the output device. If <b>waveOutClose</b> is called while a waveform-audio file is playing, the close operation fails and the function returns an error code indicating that the device was not closed. If you do not want to wait for playback to end before closing the device, call the <a href="../pdref/mmfunc_1epg.htm"><b>waveOutReset</b></a> function before closing. This ends playback and allows the device to be closed. Be sure to use the <a href="../pdref/mmfunc_2h82.htm"><b>waveOutUnprepareHeader</b></a> function to clean up the preparation on all data blocks before closing the device. </p>
<p>&nbsp;</p></body>
</HTML>
