<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening and Closing Streams</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_opening_and_closing_streams"></a>Opening and Closing Streams</h3>
<p>
Opening data streams is similar to opening files. You can open a stream by using the <a href="../pdref/mmfunc_4pwt.htm"><b>AVIFileGetStream</b></a> function. This function creates a stream interface, places a handle of the stream in the interface, and returns a pointer to the interface. <b>AVIFileGetStream</b> also maintains a reference count of the applications that have opened a stream, but not of those that have closed it. </p>
<p>
If you want to access a single stream in a file, you can open the file and the stream by using the <a href="../pdref/mmfunc_7bol.htm"><b>AVIStreamOpenFromFile</b></a> function. This function combines the operations and function arguments of the <a href="../pdref/mmfunc_8l2m.htm"><b>AVIFileOpen</b></a> and <b>AVIFileGetStream</b> functions. </p>
<p>
To access more than one stream in a file, use <b>AVIFileOpen</b> once followed by multiple calls to <b>AVIFileGetStream</b>.</p>
<p>
You can increment the reference count of a stream by using the <a href="../pdref/mmfunc_9l46.htm"><b>AVIStreamAddRef</b></a> function to keep a stream open when using a function that would normally close the stream. </p>
<p>
You can close a stream by using the <a href="../pdref/mmfunc_7usl.htm"><b>AVIStreamRelease</b></a> function. This function decrements the reference count of the stream and closes it when the reference count reaches zero. Your applications should balance the reference count by including a call to <b>AVIStreamRelease</b> for each use of the <a href="../pdref/mmfunc_4pwt.htm"><b>AVIFileGetStream</b></a>, <a href="../pdref/mmfunc_3xkd.htm"><b>AVIFileCreateStream</b></a>, <b>AVIStreamAddRef</b>, or <b>AVIStreamOpenFromFile</b> function. When you release a stream that has been opened by using <b>AVIStreamOpenFromFile</b>, AVIFile closes the file containing the stream. If your application releases a file that has open data streams, AVIFile will not close the streams until all of the streams are released.</p>
<p>&nbsp;</p></body>
</HTML>
