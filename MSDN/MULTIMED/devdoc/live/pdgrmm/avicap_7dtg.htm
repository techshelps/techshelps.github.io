<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Obtaining and Setting the Video Format</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_obtaining_and_setting_the_video_format"></a>Obtaining and Setting the Video Format</h2>
<p>
The <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_bitmapinfo_str">
</object><a href=JavaScript:alink_1.Click()><b>BITMAPINFO</b></a> structure is of variable length to accommodate standard and compressed data formats. Because this structure is of variable length, applications must always query the size of the structure and allocate memory before retrieving the current video format. The following example uses the <a href="../pdref/mmmacro_0xr9.htm"><b>capGetVideoFormatSize</b></a> macro to retrieve the buffer size and then calls the <a href="../pdref/mmmacro_9upg.htm"><b>capGetVideoFormat</b></a> macro to retrieve the current video format. </p>
<pre><code>LPBITMAPINFO lpbi;
DWORD dwSize;

dwSize = capGetVideoFormatSize(hWndC);
lpbi = GlobalAllocPtr (GHND, dwSize);
capGetVideoFormat(hWndC, lpbi, dwSize); 

// Access the video format and then free the allocated memory.
 </code></pre>
<p>
Applications can use the <a href="../pdref/mmmacro_4bas.htm"><b>capSetVideoFormat</b></a> macro (or the <a href="../pdref/mmmsg_8t2s.htm">WM_CAP_SET_VIDEOFORMAT</a> message) to send a <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_bitmapinfo_str">
</object><a href=JavaScript:alink_2.Click()><b>BITMAPINFO</b></a> header structure to the capture window. Because video formats are device specific, your application should check the return value to determine if the format was accepted.</p>
<p>&nbsp;</p></body>
</HTML>
