<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Customizing the Recording Process</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_customizing_the_recording_process"></a>Customizing the Recording Process</h2>
<p>
You can customize the recording process, taking complete control of most everything — from creating the MCIWnd window to saving the recorded information in a file. The following example queries the MCI device for recording and saving capabilities, and includes menu commands to record at the beginning or end of the content.</p>
<p>
The following example uses the <a href="../pdref/mmfunc_6jc5.htm"><b>MCIWndCreate</b></a> function to create a new window and allows you to specify an existing file to store the recorded data and the <a href="../pdref/mmmacro_8yev.htm"><b>MCIWndNew</b></a> macro to associate a new file with the window. Alternatively, you can use the <a href="../pdref/mmmacro_9qni.htm"><b>MCIWndOpen</b></a> or <a href="../pdref/mmmacro_4bl3.htm"><b>MCIWndOpenDialog</b></a> macro to specify a file. </p>
<p>
The example uses the <a href="../pdref/mmmacro_4ulg.htm"><b>MCIWndCanRecord</b></a> macro to verify that the device can record and the <a href="../pdref/mmmacro_5zdx.htm"><b>MCIWndCanSave</b></a> macro to verify that the device save information. The example sets the current playback position by using the <a href="../pdref/mmmacro_0bz9.htm"><b>MCIWndHome</b></a> and <a href="../pdref/mmmacro_86ec.htm"><b>MCIWndEnd</b></a> macros. The example starts recording by using the <a href="../pdref/mmmacro_20dg.htm"><b>MCIWndRecord</b></a> macro. After the information is recorded, the example saves it by using the <a href="../pdref/mmmacro_31nr.htm"><b>MCIWndSaveDialog</b></a><b> </b>macro.</p>
<pre><code>case WM_COMMAND: 
    switch (wParam) 
    { 
        case IDM_CREATEMCIWND: 
            g_hwndMCIWnd = MCIWndCreate( hwnd, g_hinst, 
                WS_VISIBLE | WS_CHILD | 
                MCIWNDF_RECORD,                   // add Record button
                NULL ); 
 
            MCIWndNew(g_hwndMCIWnd, "waveaudio"); // new file 
 
            if( MCIWndCanRecord(g_hwndMCIWnd) ) 
            { 
                MessageBox( hwnd, 
                "Press the red button on the toolbar to record.", 
                "MCIWnd Record", 
                MB_OK ); 
            } 
            else 
            { 
                MessageBox( hwnd, 
                    "This device doesn't record.", 
                    "MCIWnd Record", 
                    MB_OK ); 
            } 
            break; 
        case IDM_RECORDATSTART: 
            if( MCIWndCanRecord(g_hwndMCIWnd) ) 
            { 
                MCIWndHome(g_hwndMCIWnd); 
                MCIWndRecord(g_hwndMCIWnd); 
            } 
            else 
            { 
                MessageBox( hwnd, 
                    "This device doesn't record.", 
                    "MCIWnd Record", 
                    MB_OK); 
            } 
            break; 
        case IDM_RECORDATEND: 
            if( MCIWndCanRecord(g_hwndMCIWnd) ) 
            { 
                MCIWndEnd(g_hwndMCIWnd); 
                MCIWndRecord(g_hwndMCIWnd); 
            } 
            else 
            { 
                MessageBox( hwnd, 
                    "This device doesn't record.", 
                    "MCIWnd Record", 
                    MB_OK); 
            } 
            break; 
        case IDM_SAVEMCIWND: 
            if( MCIWndCanSave(g_hwndMCIWnd) ) 
                MCIWndSaveDialog(g_hwndMCIWnd); 
    } 
    break; 
 
    // Handle other messages here. 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
