<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Video Capture: A Minimal Approach</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_video_capture.3a_.a_minimal_approach"></a>Video Capture: A Minimal Approach</h2>
<p>
Video capture digitizes a stream of video and audio data, and stores it on a hard disk or some other type of persistent storage device. This section describes how to add a simple form of video capture to an application using three statements of code. It also describes how to end or abort a capture session by sending messages to the capture window.</p>
<p>
An AVICap capture window handles the details of streaming audio and video capture to AVI files. This frees your application from involvement in the AVI file format, video and audio buffer management, and the low-level access of video and audio device drivers. AVICap provides a flexible interface for applications. You can add video capture to your application, using only the following lines of code:</p>
<pre><code>hWndC = capCreateCaptureWindow ( "My Own Capture Window", 
    WS_CHILD | WS_VISIBLE , 0, 0, 160, 120, hwndParent, nID);

SendMessage (hWndC, WM_CAP_DRIVER_CONNECT, 0 /* wIndex */, 0L);

SendMessage (hWndC, WM_CAP_SEQUENCE, 0, 0L);
 </code></pre>
<p>
A macro interface is also available that provides an alternative to using the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_sendmessage">
</object><a href=JavaScript:alink_1.Click()><b>SendMessage</b></a> function and improves the readability of an application. The following example uses the macro interface to add video capture to an application.</p>
<pre><code>hWndC = capCreateCaptureWindow (    "My Own Capture Window", 
    WS_CHILD | WS_VISIBLE ,    0, 0, 160, 120, hwndParent, nID);

capDriverConnect (hWndC, 0);

capCaptureSequence (hWndC); 
 </code></pre>
<p>
After your application creates a capture window of the AVICap window class and connects it to a video driver, the capture window is ready to capture data. At this point, your application can simply send the <a href="../pdref/mmmsg_71gl.htm">WM_CAP_SEQUENCE</a> message (or the <a href="../pdref/mmmacro_2qlh.htm"><b>capCaptureSequence</b></a> macro) to begin capturing.</p>
<p>
Using default settings, WM_CAP_SEQUENCE initiates the capture of video and audio input to a file named CAPTURE.AVI. Capture continues until one of the following events occurs:
<ul>
<li>
The user presses the esc key or a mouse button.</li>
<li>
Your application stops or aborts capture operation.</li>
<li>
The disk becomes full.</li>
</ul>
<p>
In an application, you can stop streaming captured data to a file by sending the <a href="../pdref/mmmsg_2ucw.htm">WM_CAP_STOP</a> (or the <a href="../pdref/mmmacro_6t9s.htm"><b>capCaptureStop</b></a> macro) message to a capture window. You can also abort the capture operation by sending the <a href="../pdref/mmmsg_85bo.htm">WM_CAP_ABORT</a> message (or the <a href="../pdref/mmmacro_27sk.htm"><b>capCaptureAbort</b></a> macro) to a capture window.</p>
<p>&nbsp;</p></body>
</HTML>
