<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AVISaveV</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_avisavev"></a>AVISaveV</h1>
<p>
The <b>AVISaveV</b> function builds a file by combining data streams from other files or from memory. </p>
<pre><code><b>STDAPI AVISaveV(
  LPCTSTR</b><i> szFile</i><b>,                </b>
<b>  CLSID *</b><i> pclsidHandler</i><b>,         </b>
<b>  AVISAVECALLBACK</b><i> lpfnCallback</i><b>,  </b>
<b>  int</b><i> nStreams</i><b>,                  </b>
<b>  PAVISTREAM *</b><i> ppavi</i><b>,            </b>
<b>  LPAVICOMPRESSOPTIONS *</b><i> plpOptions  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szFile</i></dt>
<dd>
Null-terminated string containing the name of the file to save.</dd>
<dt>
<i>pclsidHandler</i></dt>
<dd>
Address of the file handler used to write the file. The file is created by calling the <a href="mmfunc_8l2m.htm"><b>AVIFileOpen</b></a> function using this handler. If a handler is not specified, a default is selected from the registry based on the file extension.</dd>
<dt>
<i>lpfnCallback</i></dt>
<dd>
Address of a callback function used to display status information and to let the user cancel the save operation.</dd>
<dt>
<i>nStreams</i></dt>
<dd>
Number of streams to save.</dd>
<dt>
<i>ppavi</i></dt>
<dd>
Address of an array of pointers to the <b>AVISTREAM</b> function structures. The array uses one pointer for each stream.</dd>
<dt>
<i>plpOptions</i></dt>
<dd>
Address of an array of pointers to <a href="mmstr_2bqq.htm"><b>AVICOMPRESSOPTIONS</b></a> structures. The array uses one pointer for each stream.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns AVIERR_OK if successful or an error otherwise. </p>
<h4>Remarks</h4>
<p>
This function is equivalent to the <a href="mmfunc_2r1h.htm"><b>AVISave</b></a> function except the streams are passed in an array instead of as a variable number of arguments.</p>
<p>
This function creates a file, copies stream data into the file, closes the file, and releases the resources used by the new file. The last two parameters of this function are arrays that identify the streams to save in the file and define the compression options of those streams. </p>
<p>
An application must allocate memory for the <b>AVICOMPRESSOPTIONS</b> structures and the array of pointers to these structures.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in vfw.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use vfw32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/avifile_3uwj.htm">AVIFile Functions and Macros Overview</a>, <a href="../pdgrmm/avifile_1d6b.htm">AVIFile Functions</a>, <a href="mmfunc_8l2m.htm"><b>AVIFileOpen</b></a>, <a href="mmstr_2bqq.htm"><b>AVICOMPRESSOPTIONS</b></a>, <a href="mmfunc_2r1h.htm"><b>AVISave</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
