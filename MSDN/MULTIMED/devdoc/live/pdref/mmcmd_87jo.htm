<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_SET</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mci_set"></a>MCI_SET</h1>
<p>
The <b>MCI_SET</b> command sets device information. CD audio, digital-video, MIDI sequencer, VCR, videodisc, video-overlay, and waveform-audio devices recognize this command. </p>
<pre><code>MCIERROR mciSendCommand(MCIDEVICEID wDeviceID, MCI_SET, 
    DWORD dwFlags, (DWORD) (LPMCI_SET_PARMS) lpSet);
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wDeviceID</i></dt>
<dd>
Device identifier of the MCI device that is to receive the command message.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
MCI_NOTIFY, MCI_WAIT, or, for digital-video and VCR devices, MCI_TEST. For information about these flags, see <a href="../pdgrmm/mci_9v3n.htm">The Wait, Notify, and Test Flags</a>.</dd>
<dt>
<i>lpSet</i></dt>
<dd>
Address of an <a href="mmstr_5d2q.htm"><b>MCI_SET_PARMS</b></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise.</p>
<h4>Remarks</h4>
<p>
The following additional flags apply to all devices supporting <b>MCI_SET</b>:
<dl>
<dt>
MCI_SET_AUDIO</dt>
<dd>
An audio channel number is included in the <b>dwAudio</b> member of the structure identified by <i>lpSet</i>. This flag must be used with MCI_SET_ON or MCI_SET_OFF. Use one of the following constants to indicate the channel number:
<dl>
<dt>
MCI_SET_AUDIO_ALL</dt>
<dd>
All audio channels.</dd>
<dt>
MCI_SET_AUDIO_LEFT</dt>
<dd>
Left channel.</dd>
<dt>
MCI_SET_AUDIO_RIGHT</dt>
<dd>
Right channel.</dd>
</dl>
</dd>
<dt>
MCI_SET_DOOR_CLOSED</dt>
<dd>
Closes the media cover (if any).</dd>
<dt>
MCI_SET_DOOR_OPEN</dt>
<dd>
Opens the media cover (if any).</dd>
<dt>
MCI_SET_OFF</dt>
<dd>
Disables the specified video or audio channel.</dd>
<dt>
MCI_SET_ON</dt>
<dd>
Enables the specified video or audio channel.</dd>
<dt>
MCI_SET_TIME_FORMAT</dt>
<dd>
A time format parameter is included in the <b>dwTimeFormat</b> member of the structure identified by <i>lpSet</i>. The following flags are used with this flag:
<dl>
<dt>
MCI_FORMAT_BYTES </dt>
<dd>
Within a PCM (Pulse Code Modulation) data format, changes the time member description to bytes for input or output. Recognized by the <b>waveaudio</b> device type.</dd>
<dt>
MCI_FORMAT_FRAMES </dt>
<dd>
Subsequent commands will use frames. Recognized by the <b>digitalvideo, vcr,</b> and <b>videodisc</b> device types.</dd>
<dt>
MCI_FORMAT_HMS </dt>
<dd>
Changes the time format to hours, minutes, and seconds. Recognized by the <b>vcr</b> and <b>videodisc</b> device types.</dd>
<dt>
MCI_FORMAT_MILLISECONDS </dt>
<dd>
Changes the time format to milliseconds. Recognized by all device types. </dd>
<dt>
MCI_FORMAT_MSF </dt>
<dd>
Changes the time format to minutes, seconds, and frames. Recognized by the <b>cdaudio</b> and <b>vcr</b> device types.</dd>
<dt>
MCI_FORMAT_SAMPLES </dt>
<dd>
Changes the time format to samples for input or output. Recognized by the <b>waveaudio</b> device type.</dd>
<dt>
MCI_FORMAT_SMPTE_24, MCI_FORMAT_SMPTE_25, and MCI_FORMAT_SMPTE_30 </dt>
<dd>
Sets the time format to 24, 25, and 30 frame SMPTE (Society of Motion Picture and Television Engineers), respectively. Recognized by the <b>sequencer</b> and <b>vcr</b> device types.</dd>
<dt>
MCI_FORMAT_SMPTE_30DROP </dt>
<dd>
Sets the time format to 30 drop-frame SMPTE. Recognized by the <b>sequencer</b> and <b>vcr</b> device types.</dd>
<dt>
MCI_FORMAT_TMSF </dt>
<dd>
Changes the time format to tracks, minutes, seconds, and frames. (MCI uses continuous track numbers.) Recognized by the <b>cdaudio</b> and <b>vcr</b> device types.</dd>
</dl>
</dd>
<dt>
MCI_SET_VIDEO</dt>
<dd>
Sets the video signal on or off. This flag must be used with either MCI_SET_ON or MCI_SET_OFF. Devices that do not have video return MCIERR_UNSUPPORTED_FUNCTION.
</dd>
</dl>
<p>
The following additional flags are used with the <b>digitalvideo</b> device type:
<dl>
<dt>
MCI_DGV_SET_FILEFORMAT</dt>
<dd>
A file format parameter is included in the <b>dwFileFormat</b> member of the structure identified by <i>lpSet</i>. For digital-video devices, the file format is used for save or capture commands. If omitted, this might default to a device driver defined format. If the specified file format conflicts with the currently selected algorithm and quality, then they are changed to the defaults for the file format. The following file format constants are defined:
<dl>
<dt>
MCI_DGV_FF_AVI</dt>
<dd>
AVI format. </dd>
<dt>
MCI_DGV_FF_AVSS</dt>
<dd>
AVSS format. </dd>
<dt>
MCI_DGV_FF_DIB</dt>
<dd>
DIB format. </dd>
<dt>
MCI_DGV_FF_JFIF</dt>
<dd>
JFIF format. </dd>
<dt>
MCI_DGV_FF_JPEG</dt>
<dd>
JPEG format.</dd>
<dt>
MCI_DGV_FF_MPEG</dt>
<dd>
MPEG format. </dd>
<dt>
MCI_DGV_FF_RDIB</dt>
<dd>
RLE DIB format.</dd>
<dt>
MCI_DGV_FF_RJPEG</dt>
<dd>
RJPEG format.</dd>
</dl>
</dd>
<dt>
MCI_DGV_SET_SEEK_EXACTLY</dt>
<dd>
Sets the format used for positioning. This flag must be used with MCI_SET_ON or MCI_SET_OFF. If MCI_SET_ON is specified, playing or recording precisely accesses the frame specified with the MCI_FROM flag. This might add some extra delay if the requested frame is not a key frame. If MCI_SET_OFF is specified, the device will seek to a key-frame image that precedes the requested frame. For some files and devices, this might be the first frame of the file. The default for this flag is device dependent.</dd>
<dt>
MCI_DGV_SET_SPEED</dt>
<dd>
A speed parameter is included in the <b>dwSpeed</b> member of the structure identified by <i>lpSet</i>. Speed is specified as a ratio between the nominal frame rate and the desired frame rate where the nominal frame rate is designated as 1000. Half speed is 500 and double speed is 2000. The allowable speed range is dependent on the device and possibly the file, too.</dd>
<dt>
MCI_DGV_SET_STILL</dt>
<dd>
When used with MCI_DGV_SET_FILEFORMAT, <b>MCI_SET</b> sets the file format used for capture commands.
</dd>
</dl>
<p>
For digital-video devices, the <i>lpSet</i> parameter points to an <a href="mmstr_78qa.htm"><b>MCI_DGV_SET_PARMS</b></a> structure.</p>
<p>
The following additional flags are used with the <b>sequencer</b> device type:
<dl>
<dt>
MCI_SEQ_FORMAT_SONGPTR </dt>
<dd>
Sets the time format to song pointer units. </dd>
<dt>
MCI_SEQ_SET_MASTER</dt>
<dd>
Sets the sequencer as a source of synchronization data and indicates that the type of synchronization is specified in the <b>dwMaster</b> member of the structure identified by <i>lpSet</i>. MCISEQ returns MCIERR_UNSUPPORTED_FUNCTION. The following constants are defined for the synchronization type:
<dl>
<dt>
MCI_SEQ_MIDI </dt>
<dd>
The sequencer will send MIDI format synchronization data.</dd>
<dt>
MCI_SEQ_SMPTE </dt>
<dd>
The sequencer will send SMPTE format synchronization data.</dd>
<dt>
MCI_SEQ_NONE </dt>
<dd>
The sequencer will not send synchronization data.</dd>
</dl>
</dd>
<dt>
MCI_SEQ_SET_OFFSET</dt>
<dd>
Changes the SMPTE offset of a sequence to that specified by the <b>dwOffset</b> member of the structure identified by <i>lpSet</i>. This affects only sequences with a SMPTE division type.</dd>
<dt>
MCI_SEQ_SET_PORT</dt>
<dd>
Sets the output MIDI port of a sequence to that specified by the MIDI device identifier in the <b>dwPort</b> member of the structure identified by <i>lpSet</i>. The device closes the previous port (if any), and attempts to open and use the new port. If it fails, it returns an error and reopens the previously used port (if any). The following constants are defined for the ports:
<dl>
<dt>
MCI_SEQ_NONE </dt>
<dd>
Closes the previously used port (if any). The sequencer behaves exactly the same as if a port were open, except no MIDI message is sent.</dd>
<dt>
MIDI_MAPPER </dt>
<dd>
Sets the port opened to the MIDI mapper.</dd>
</dl>
</dd>
<dt>
MCI_SEQ_SET_SLAVE</dt>
<dd>
Sets the sequencer to receive synchronization data and indicates that the type of synchronization is specified in the <b>dwSlave</b> member of the structure identified by <i>lpSet</i>. MCISEQ returns MCIERR_UNSUPPORTED_FUNCTION. The following constants are defined for the synchronization type:
<dl>
<dt>
MCI_SEQ_FILE </dt>
<dd>
Sets the sequencer to receive synchronization data contained in the MIDI file.</dd>
<dt>
MCI_SEQ_MIDI </dt>
<dd>
Sets the sequencer to receive MIDI synchronization data.</dd>
<dt>
MCI_SEQ_NONE</dt>
<dd>
Sets the sequencer to ignore synchronization data in a MIDI stream.</dd>
<dt>
MCI_SEQ_SMPTE </dt>
<dd>
Sets the sequencer to receive SMPTE synchronization data.</dd>
</dl>
</dd>
<dt>
MCI_SEQ_SET_TEMPO</dt>
<dd>
Changes the tempo of the MIDI sequence to that specified by the <b>dwTempo</b> member of the structure pointed to by <i>lpSet</i>. For sequences with division type PPQN, tempo is specified in beats per minute; for sequences with division type SMPTE, tempo is specified in frames per second.
</dd>
</dl>
<p>
For sequencer devices, the <i>lpSet</i> parameter points to an <a href="mmstr_2fsi.htm"><b>MCI_SEQ_SET_PARMS</b></a> structure.</p>
<p>
The following additional flags are used with the <b>vcr</b> device type:
<dl>
<dt>
MCI_VCR_SET_ASSEMBLE_RECORD</dt>
<dd>
Sets the device to record in assemble or insert modes (when assemble is off, insert is on, and vice-versa). Use with one of the following flag:
<dl>
<dt>
MCI_SET_ON</dt>
<dd>
Sets assemble record on, and turns insert record off. Records all video, audio and timecode tracks.</dd>
<dt>
MCI_SET_OFF</dt>
<dd>
Sets assemble record off, and turns insert record on. When assemble record is off, individual tracks of video, audio, and timecode can be selected for recording.</dd>
</dl>
</dd>
<dt>
MCI_VCR_SET_CLOCK</dt>
<dd>
The<b> dwClock</b> member of the structure identified by <i>lpSet</i> contains the new clock time.</dd>
<dt>
MCI_VCR_SET_COUNTER_FORMAT</dt>
<dd>
The <b>dwCounterFormat </b>member of the structure identified by <i>lpSet</i> contains a constant specifying the new counter-time format to be used by the status counter. For a list of valid constants, see MCI_SET_TIME_FORMAT in the list of additional flags for this command.</dd>
<dt>
MCI_VCR_SET_COUNTER_VALUE</dt>
<dd>
The <b>dwCounterValue </b>member of the structure identified by <i>lpSet</i> contains the new counter value.</dd>
<dt>
MCI_VCR_SET_INDEX</dt>
<dd>
The <b>dwIndex </b>member of the structure identified by <i>lpSet</i> contains a constant indicating the contents of the on-screen display and must be one of the following:
<dl>
<dt>
MCI_VCR_INDEX_COUNTER</dt>
<dd>
Displays counter.</dd>
<dt>
MCI_VCR_INDEX_DATE</dt>
<dd>
Displays date.</dd>
<dt>
MCI_VCR_INDEX_TIME</dt>
<dd>
Displays time.</dd>
<dt>
MCI_VCR_INDEX_TIMECODE</dt>
<dd>
Displays timecode.</dd>
</dl>

<p>
For more information, see the <a href="mmcmd_9yrc.htm"><b>MCI_INDEX</b></a> command.
</dd>
<dt>
MCI_VCR_SET_PAUSE_TIMEOUT</dt>
<dd>
The <b>dwPauseTimeout</b> member of the structure identified by <i>lpSet</i> contains the maximum duration, in milliseconds, of a pause command.</dd>
<dt>
MCI_VCR_SET_POSTROLL_DURATION</dt>
<dd>
The <b>dwPostrollDuration</b> member of the structure identified by <i>lpSet</i> contains the videotape length, in the current time format, needed to brake the VCR transport when a stop or pause command is issued.</dd>
<dt>
MCI_VCR_SET_POWER</dt>
<dd>
Sets the power on or off. Must be used with one of the following flags:
<dl>
<dt>
MCI_SET_OFF</dt>
<dd>
Turns power off.</dd>
<dt>
MCI_SET_ON</dt>
<dd>
Turns power on.</dd>
</dl>
</dd>
<dt>
MCI_VCR_SET_PREROLL_DURATION</dt>
<dd>
The <b>dwPrerollDuration</b> member of the structure identified by <i>lpSet</i> contains the videotape length, in the current time format, needed to stabilize the VCR output. </dd>
<dt>
MCI_VCR_SET_RECORD_FORMAT</dt>
<dd>
The <b>dwRecordFormat </b>member of the structure identified by <i>lpSet</i> contains a constant describing the record speed, which must be one of the following:
<dl>
<dt>
MCI_VCR_FORMAT_EP</dt>
<dd>
Records at slow speed.</dd>
<dt>
MCI_VCR_FORMAT_LP</dt>
<dd>
Records at medium-slow speed.</dd>
<dt>
MCI_VCR_FORMAT_SP</dt>
<dd>
Records at standard speed.</dd>
</dl>
</dd>
<dt>
MCI_VCR_SET_SPEED</dt>
<dd>
The <b>dwSpeed </b>member of the structure identified by <i>lpSet</i> contains the new speed setting, where 1000 is normal speed, 2000 is double speed, and 500 is half speed, and so on.</dd>
<dt>
MCI_VCR_SET_TAPE_LENGTH</dt>
<dd>
The <b>dwTapeLength </b>member of the structure identified by <i>lpSet</i> contains the new length of the tape, provided that the length of the tape is undetectable.</dd>
<dt>
MCI_VCR_SET_TIME_MODE</dt>
<dd>
The <b>dwTimeMode </b>member of the structure identified by <i>lpSet</i> contains a constant indicating the new positional time mode. The following constants are valid:
<dl>
<dt>
MCI_VCR_TIME_COUNTER</dt>
<dd>
Forces the device to use counter exclusively.</dd>
<dt>
MCI_VCR_TIME_DETECT</dt>
<dd>
Each time a new videotape is inserted into the device, or the mode changes from not ready to ready, the device should attempt to determine if there is timecode available on the videotape. If timecode is available, use timecode in all subsequent commands that specify positions. Otherwise, use the counter.</dd>
<dt>
MCI_VCR_TIME_TIMECODE</dt>
<dd>
Forces the device to use timecode exclusively.</dd>
</dl>
</dd>
<dt>
MCI_VCR_SET_TRACKING</dt>
<dd>
Tunes the speed of the VCR tape transport with a fine adjustment, and must be used with one of the following flags:
<dl>
<dt>
MCI_VCR_PLUS</dt>
<dd>
Increases the tape transport speed.</dd>
<dt>
MCI_VCR_MINUS</dt>
<dd>
Decreases the tape transport speed.</dd>
<dt>
MCI_VCR_RESET</dt>
<dd>
Returns the tracking adjustment to zero.
</dd>
</dl>
</dd>
</dl>
<p>
For VCR devices, the <i>lpSet</i> parameter points to an <a href="mmstr_0t82.htm"><b>MCI_VCR_SET_PARMS</b></a> structure.</p>
<p>
The following additional flag is used with the <b>videodisc</b> device type:
<dl>
<dt>
MCI_VD_FORMAT_TRACK </dt>
<dd>
Changes the time format to tracks. MCI uses continuous track numbers. 
</dd>
</dl>
<p>
The following additional flags are used with the <b>waveaudio</b> device type:
<dl>
<dt>
MCI_WAVE_INPUT</dt>
<dd>
Sets the input used for recording to the <b>wInput</b> member of the structure identified by <i>lpSet</i>.</dd>
<dt>
MCI_WAVE_OUTPUT</dt>
<dd>
Sets the output used for playing to the <b>wOutput</b> member of the structure identified by <i>lpSet</i>.</dd>
<dt>
MCI_WAVE_SET_ANYINPUT</dt>
<dd>
Any wave input compatible with the current format can be used for recording.</dd>
<dt>
MCI_WAVE_SET_ANYOUTPUT</dt>
<dd>
Any wave output compatible with the current format can be used for playing.</dd>
<dt>
MCI_WAVE_SET_AVGBYTESPERSEC</dt>
<dd>
Sets the bytes per second used for playing, recording, and saving to the <b>nAvgBytesPerSec</b> member of the structure identified by <i>lpSet</i>.</dd>
<dt>
MCI_WAVE_SET_BITSPERSAMPLE</dt>
<dd>
Sets the bits per sample used for playing, recording, and saving to the <b>nBitsPerSample</b> member of the PCM data format identified by <i>lpSet</i>.</dd>
<dt>
MCI_WAVE_SET_BLOCKALIGN</dt>
<dd>
Sets the block alignment used for playing, recording, and saving to the <b>nBlockAlign</b> member of the structure identified by <i>lpSet</i>.</dd>
<dt>
MCI_WAVE_SET_CHANNELS</dt>
<dd>
The number of channels is indicated in the <b>nChannels</b> member of the structure identified by <i>lpSet</i>.</dd>
<dt>
MCI_WAVE_SET_FORMATTAG</dt>
<dd>
Sets the format type used for playing, recording, and saving to the <b>wFormatTag</b> member of the structure identified by <i>lpSet</i>. Specifying WAVE_FORMAT_PCM changes the format to PCM.</dd>
<dt>
MCI_WAVE_SET_SAMPLESPERSEC</dt>
<dd>
Sets the samples per second used for playing, recording, and saving to the <b>nSamplesPerSec</b> member of the structure identified by <i>lpSet</i>.
</dd>
</dl>
<p>
For waveform-audio devices, the <i>lpSet</i> parameter points to an <a href="mmstr_8xgy.htm"><b>MCI_WAVE_SET_PARMS</b></a> structure.</p>
<p>
Several properties of waveform-audio data are defined when the file to store the data is created. These properties describe how the data is structured within the file and cannot be changed once recording begins. The following list of flags identifies these properties:
<ul>
<li>
MCI_WAVE_SET_AVGBYTESPERSEC</li>
<li>
MCI_WAVE_SET_BITSPERSAMPLE</li>
<li>
MCI_WAVE_SET_BLOCKALIGN</li>
<li>
MCI_WAVE_SET_CHANNELS</li>
<li>
MCI_WAVE_SET_FORMATTAG</li>
<li>
MCI_WAVE_SET_SAMPLESPERSEC</li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mmsystem.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mci_7vvt.htm">MCI Overview</a>, <a href="../pdgrmm/mci_4eib.htm">MCI Commands</a>, <a href="mmstr_78qa.htm"><b>MCI_DGV_SET_PARMS</b></a>, <a href="mmcmd_9yrc.htm"><b>MCI_INDEX</b></a>, <a href="mmstr_2fsi.htm"><b>MCI_SEQ_SET_PARMS</b></a>, <a href="mmstr_5d2q.htm"><b>MCI_SET_PARMS</b></a>, <a href="mmstr_0t82.htm"><b>MCI_VCR_SET_PARMS</b></a>, <a href="mmstr_8xgy.htm"><b>MCI_WAVE_SET_PARMS</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
