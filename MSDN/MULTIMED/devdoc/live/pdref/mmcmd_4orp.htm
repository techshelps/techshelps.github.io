<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_CAPTURE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mci_capture"></a>MCI_CAPTURE</h1>
<p>
The <b>MCI_CAPTURE</b> command captures the contents of the frame buffer and stores it in a specified file. Digital-video devices recognize this command.</p>
<pre><code>MCIERROR mciSendCommand(MCIDEVICEID wDeviceID, MCI_CAPTURE, 
    DWORD dwFlags, (DWORD) (LPMCI_DGV_CAPTURE_PARMS) lpCapture);
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wDeviceID</i></dt>
<dd>
Device identifier of the MCI device that is to receive the command message.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
MCI_NOTIFY, MCI_WAIT, or MCI_TEST. For information about these flags, see <a href="../pdgrmm/mci_9v3n.htm">The Wait, Notify, and Test Flags</a>.</dd>
<dt>
<i>lpCapture</i></dt>
<dd>
Address of an <a href="mmstr_5jw2.htm"><b>MCI_DGV_CAPTURE_PARMS</b></a>structure. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise.</p>
<h4>Remarks</h4>
<p>
The following additional flags apply to digital-video devices:
<dl>
<dt>
MCI_DGV_CAPTURE_AS</dt>
<dd>
The <b>lpstrFileName</b> member of the structure identified by <i>lpCapture </i>contains an address of a buffer specifying the destination path and filename. (This flag is required.)</dd>
<dt>
MCI_DGV_CAPTURE_AT</dt>
<dd>
The <b>rc</b> member of the structure identified by <i>lpCapture </i>contains a valid rectangle. The rectangle specifies the rectangular region within the frame buffer that is cropped and saved to disk. If omitted, the cropped region defaults to the rectangle specified or defaulted on a previous <a href="mmcmd_7yus.htm"><b>MCI_PUT</b></a> command that specifies the source area for this instance of the device driver.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mmsystem.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mci_7vvt.htm">MCI Overview</a>, <a href="../pdgrmm/mci_4eib.htm">MCI Commands</a>, <a href="mmstr_5jw2.htm"><b>MCI_DGV_CAPTURE_PARMS</b></a>, <a href="mmcmd_7yus.htm"><b>MCI_PUT</b></a></p>
<p>&nbsp;</p></body>
</HTML>
