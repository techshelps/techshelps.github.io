<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AVIStreamOpenFromFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_avistreamopenfromfile"></a>AVIStreamOpenFromFile</h1>
<p>
The <b>AVIStreamOpenFromFile</b> function opens a single stream from a file.</p>
<pre><code><b>STDAPI AVIStreamOpenFromFile(
  PAVISTREAM *</b><i> ppavi</i><b>,    </b>
<b>  LPCTSTR</b><i> szFile</i><b>,        </b>
<b>  DWORD</b><i> fccType</i><b>,         </b>
<b>  LONG</b><i> lParam</i><b>,           </b>
<b>  UINT</b><i> mode</i><b>,             </b>
<b>  CLSID *</b><i> pclsidHandler  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ppavi</i></dt>
<dd>
Address to contain the new stream handle.</dd>
<dt>
<i>szFile</i></dt>
<dd>
Null-terminated string containing the name of the file to open.</dd>
<dt>
<i>fccType</i></dt>
<dd>
Four-character code indicating the type of stream to be opened. Zero indicates that any stream can be opened. The following definitions apply to the data commonly found in AVI streams:
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=47%>Value</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=47%>streamtypeAUDIO</td>
<td colspan=2 width=53%>Indicates an audio stream.</td>
</tr>
<tr valign=top>
<td width=47%>streamtypeMIDI</td>
<td colspan=2 width=53%>Indicates a MIDI stream.</td>
</tr>
<tr valign=top>
<td width=47%>streamtypeTEXT</td>
<td colspan=2 width=53%>Indicates a text stream.</td>
</tr>
<tr valign=top>
<td width=47%>streamtypeVIDEO</td>
<td colspan=2 width=53%>Indicates a video stream.</td>
</tr>
</table><br>

</dd>
<dt>
<i>lParam</i></dt>
<dd>
Stream of the type specified in <i>fccType</i> to access. This parameter is zero-based; use zero to specify the first occurrence.</dd>
<dt>
<i>mode</i></dt>
<dd>
Access mode to use when opening the file. This function can open only existing streams, so the OF_CREATE mode flag cannot be used. For more information about the available flags for the <i>mode</i> parameter, see the <b>OpenFile</b> function.</dd>
<dt>
<i>pclsidHandler</i></dt>
<dd>
Address of a class identifier of the handler you want to use. If the value is NULL, the system chooses one from the registry based on the file extension or the file RIFF type.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise. </p>
<h4>Remarks</h4>
<p>
This function calls the <b>AVIFileOpen</b>, <b>AVIFileGetStream</b>, and <b>AVIFileRelease</b> functions.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in vfw.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use vfw32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/avifile_3uwj.htm">AVIFile Functions and Macros Overview</a>, <a href="../pdgrmm/avifile_1d6b.htm">AVIFile Functions</a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_openfile">
</object><a href=JavaScript:alink_1.Click()><b>OpenFile</b></a>, <a href="mmfunc_8l2m.htm"><b>AVIFileOpen</b></a>, <a href="mmfunc_4pwt.htm"><b>AVIFileGetStream</b></a>, <a href="mmfunc_98h1.htm"><b>AVIFileRelease</b></a></p>
<p>&nbsp;</p></body>
</HTML>
