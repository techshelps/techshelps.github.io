<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CAPTUREPARMS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_captureparms_str"></a>CAPTUREPARMS</h1>
<p>
The <b>CAPTUREPARMS</b> structure contains parameters that control the streaming video capture process. This structure is used to get and set parameters that affect the capture rate, the number of buffers to use while capturing, and how capture is terminated.</p>
<pre><code>typedef struct { 
    DWORD dwRequestMicroSecPerFrame; 
    BOOL  fMakeUserHitOKToCapture; 
    UINT  wPercentDropForError; 
    BOOL  fYield; 
    DWORD dwIndexSize; 
    UINT  wChunkGranularity; 
    BOOL  fUsingDOSMemory; 
    UINT  wNumVideoRequested; 
    BOOL  fCaptureAudio; 
    UINT  wNumAudioRequested; 
    UINT  vKeyAbort; 
    BOOL  fAbortLeftMouse; 
    BOOL  fAbortRightMouse; 
    BOOL  fLimitEnabled; 
    UINT  wTimeLimit; 
    BOOL  fMCIControl; 
    BOOL  fStepMCIDevice; 
    DWORD dwMCIStartTime; 
    DWORD dwMCIStopTime; 
    BOOL  fStepCaptureAt2x; 
    UINT  wStepCaptureAverageFrames; 
    DWORD dwAudioBufferSize; 
    BOOL  fDisableWriteCache; 
    UINT  AVStreamMaster; 
} CAPTUREPARMS; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>dwRequestMicroSecPerFrame</b></dt>
<dd>
Requested frame rate, in microseconds. The default value is 66667, which corresponds to 15 frames per second.</dd>
<dt>
<b>fMakeUserHitOKToCapture</b></dt>
<dd>
User-initiated capture flag. If this member is TRUE, AVICap displays a dialog box prompting the user to initiate capture. The default value is FALSE.</dd>
<dt>
<b>wPercentDropForError</b></dt>
<dd>
Maximum allowable percentage of dropped frames during capture. Values range from 0 to 100. The default value is 10.</dd>
<dt>
<b>fYield</b></dt>
<dd>
Yield flag. If this member is TRUE, the capture window spawns a separate background thread to perform step and streaming capture. The default value is FALSE.
<p>
Applications that set this flag must handle potential reentry issues because the controls in the application are not disabled while capture is in progress.
</dd>
<dt>
<b>dwIndexSize</b></dt>
<dd>
Maximum number of index entries in an AVI file. Values range from 1800 to 324,000. If set to 0, a default value of 34,952 (32K frames plus a proportional number of audio buffers) is used.
<p>
Each video frame or buffer of waveform-audio data uses one index entry. The value of this entry establishes a limit for the number of frames or audio buffers that can be captured.
</dd>
<dt>
<b>wChunkGranularity</b></dt>
<dd>
Logical block size, in bytes, of an AVI file. The value 0 indicates the current sector size is used as the granularity.</dd>
<dt>
<b>fUsingDOSMemory</b></dt>
<dd>
Not used in Win32 applications.</dd>
<dt>
<b>wNumVideoRequested</b></dt>
<dd>
Maximum number of video buffers to allocate. The memory area to place the buffers is specified with <b>fUsingDOSMemory</b>. The actual number of buffers allocated might be lower if memory is unavailable.</dd>
<dt>
<b>fCaptureAudio</b></dt>
<dd>
Capture audio flag. If this member is TRUE, audio is captured during streaming capture. This is the default value if audio hardware is installed.</dd>
<dt>
<b>wNumAudioRequested</b></dt>
<dd>
Maximum number of audio buffers to allocate. The maximum number of buffers is 10.</dd>
<dt>
<b>vKeyAbort</b></dt>
<dd>
Virtual keycode used to terminate streaming capture. The default value is VK_ESCAPE. You must call the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_registerhotkey">
</object><a href=JavaScript:alink_1.Click()><b>RegisterHotKey</b></a> function before specifying a keystroke that can abort a capture session.
<p>
You can combine keycodes that include ctrl and shift keystrokes by using the logical OR operator with the keycodes for ctrl (0x8000) and shift (0x4000).
</dd>
<dt>
<b>fAbortLeftMouse</b></dt>
<dd>
Abort flag for left mouse button. If this member is TRUE, streaming capture stops if the left mouse button is pressed. The default value is TRUE.</dd>
<dt>
<b>fAbortRightMouse</b></dt>
<dd>
Abort flag for right mouse button. If this member is TRUE, streaming capture stops if the right mouse button is pressed. The default value is TRUE.</dd>
<dt>
<b>fLimitEnabled</b></dt>
<dd>
Time limit enabled flag. If this member is TRUE, streaming capture stops after the number of seconds in <b>wTimeLimit</b> has elapsed. The default value is FALSE.</dd>
<dt>
<b>wTimeLimit</b></dt>
<dd>
Time limit for capture, in seconds. This parameter is used only if <b>fLimitEnabled</b> is TRUE.</dd>
<dt>
<b>fMCIControl</b></dt>
<dd>
MCI device capture flag. If this member is TRUE, AVICap controls an <br>
MCI-compatible video source during streaming capture. MCI-compatible video sources include VCRs and laserdiscs.</dd>
<dt>
<b>fStepMCIDevice</b></dt>
<dd>
MCI device step capture flag. If this member is TRUE, step capture using an MCI device as a video source is enabled. If it is FALSE, real-time capture using an MCI device is enabled. (If <b>fMCIControl</b> is FALSE, this member is ignored.)</dd>
<dt>
<b>dwMCIStartTime</b></dt>
<dd>
Starting position, in milliseconds, of the MCI device for the capture sequence. (If <b>fMCIControl</b> is FALSE, this member is ignored.)</dd>
<dt>
<b>dwMCIStopTime</b></dt>
<dd>
Stopping position, in milliseconds, of the MCI device for the capture sequence. When this position in the content is reached, capture ends and the MCI device stops. (If <b>fMCIControl</b> is FALSE, this member is ignored.)</dd>
<dt>
<b>fStepCaptureAt2x</b></dt>
<dd>
Double-resolution step capture flag. If this member is TRUE, the capture hardware captures at twice the specified resolution. (The resolution for the height and width is doubled.) 
<p>
Enable this option if the hardware does not support hardware-based decimation and you are capturing in the RGB format.
</dd>
<dt>
<b>wStepCaptureAverageFrames</b></dt>
<dd>
Number of times a frame is sampled when creating a frame based on the average sample. A typical value for the number of averages is 5.</dd>
<dt>
<b>dwAudioBufferSize</b></dt>
<dd>
Audio buffer size. If the default value of zero is used, the size of each buffer will be the maximum of 0.5 seconds of audio or 10K bytes.</dd>
<dt>
<b>fDisableWriteCache</b></dt>
<dd>
Not used in Win32 applications.</dd>
<dt>
<b>AVStreamMaster</b></dt>
<dd>
Indicates whether the audio stream controls the clock when writing an AVI file. If this member is set to AVSTREAMMASTER_AUDIO, the audio stream is considered the master stream and the video stream duration is forced to match the audio duration. If this member is set to AVSTREAMMASTER_NONE, the durations of audio and video streams can differ.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The WM_CAP_GET_SEQUENCE_SETUP message or <b>capCaptureGetSetup</b> macro is used to retrieve the current capture parameters. The WM_CAP_SET_SEQUENCE_SETUP message or <b>capCaptureSetSetup</b> macro is used to set the capture parameters.</p>
<p>
The <a href="mmmsg_2w1c.htm">WM_CAP_GET_SEQUENCE_SETUP</a> message or <a href="mmmacro_3wkw.htm"><b>capCaptureGetSetup</b></a> macro is used to retrieve the current capture parameters. The <a href="mmmsg_5hyo.htm">WM_CAP_SET_SEQUENCE_SETUP</a> message or <a href="mmmacro_6568.htm"><b>capCaptureSetSetup</b></a> macro is used to set the capture parameters.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in vfw.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/avicap_8xyd.htm">Video Capture Overview</a>, <a href="../pdgrmm/avicap_0qcy.htm">Video Capture Structures</a>, <a href="mmmacro_3wkw.htm"><b>capCaptureGetSetup</b></a>, <a href="mmmacro_6568.htm"><b>capCaptureSetSetup</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_registerhotkey">
</object><a href=JavaScript:alink_2.Click()><b>RegisterHotKey</b></a>, <a href="mmmsg_2w1c.htm">WM_CAP_GET_SEQUENCE_SETUP</a>, <a href="mmmsg_5hyo.htm">WM_CAP_SET_SEQUENCE_SETUP</a></p>
<p>&nbsp;</p></body>
</HTML>
