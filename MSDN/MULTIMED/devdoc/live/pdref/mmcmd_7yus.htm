<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_PUT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mci_put"></a>MCI_PUT</h1>
<p>
The <b>MCI_PUT</b> command sets the source, destination, and frame rectangles. Digital-video and video-overlay devices recognize this command. </p>
<pre><code>MCIERROR mciSendCommand(MCIDEVICEID wDeviceID, MCI_PUT, 
    DWORD dwFlags, (DWORD) (LPMCI_GENERIC_PARMS) lpDest);
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wDeviceID</i></dt>
<dd>
Device identifier of the MCI device that is to receive the command message.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
MCI_NOTIFY, MCI_WAIT, or, for digital-video devices, MCI_TEST. For information about these flags, see <a href="../pdgrmm/mci_9v3n.htm">The Wait, Notify, and Test Flags</a>.</dd>
<dt>
<i>lpDest</i></dt>
<dd>
Address of an <a href="mmstr_0jjm.htm"><b>MCI_GENERIC_PARMS</b></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise.</p>
<h4>Remarks</h4>
<p>
The following additional flags are used with the <b>digitalvideo</b> device type:
<dl>
<dt>
MCI_DGV_PUT_CLIENT</dt>
<dd>
The rectangle defined for MCI_DGV_RECT applies to the position of the client window. The rectangle specified is relative to the parent window of the display window. MCI_DGV_PUT_WINDOW must be set concurrently with this flag.</dd>
<dt>
MCI_DGV_PUT_DESTINATION</dt>
<dd>
The rectangle defined for MCI_DGV_RECT specifies a destination rectangle. The destination rectangle specifies the portion of the client window associated with this device driver instance that shows the image or video.</dd>
<dt>
MCI_DGV_PUT_FRAME</dt>
<dd>
The rectangle defined for MCI_DGV_RECT applies to the frame rectangle. The frame rectangle specifies the portion of the frame buffer used as the destination of the video images obtained from the video rectangle. The video should be scaled to fit within the frame buffer rectangle. 
<p>
The rectangle is specified in frame buffer coordinates. The default rectangle is the full frame buffer. Specifying this rectangle lets the device scale the image as it digitizes the data. Devices that cannot scale the image reject this command with MCIERR_UNSUPPORTED_FUNCTION. You can use the MCI_GETDEVCAPS_CAN_STRETCH flag with the <a href="mmcmd_72b7.htm"><b>MCI_GETDEVCAPS</b></a> command to determine if a device scales the image. A device returns FALSE if it cannot scale the image.
</dd>
<dt>
MCI_DGV_PUT_SOURCE</dt>
<dd>
The rectangle defined for MCI_DGV_RECT specifies a source rectangle. The source rectangle specifies which portion of the frame buffer is to be scaled to fit into the destination rectangle.</dd>
<dt>
MCI_DGV_PUT_VIDEO</dt>
<dd>
The rectangle defined for MCI_DGV_RECT applies to the video rectangle. The video rectangle specifies which portion of the current presentation source is stored in the frame buffer. The rectangle is specified using the natural coordinates of the presentation source. It allows the specification of cropping that occurs prior to storing images and video in the frame buffer. The default rectangle is the full active scan area or the full decompressed images and video.</dd>
<dt>
MCI_DGV_PUT_WINDOW</dt>
<dd>
The rectangle defined for MCI_DGV_RECT applies to the display window. This rectangle is relative to the parent window of the display window (usually the desktop). If the window is not specified, it defaults to the initial window size and position. </dd>
<dt>
MCI_DGV_RECT</dt>
<dd>
The <b>rc</b> member of the structure identified by <i>lpDest</i> contains a valid rectangle.
</dd>
</dl>
<p>
For digital-video devices, <i>lpDest</i> points to an <a href="mmstr_4whe.htm"><b>MCI_DGV_PUT_PARMS</b></a> structure.</p>
<p>
The following additional flags are used with the <b>overlay</b> device type:
<dl>
<dt>
MCI_OVLY_PUT_DESTINATION</dt>
<dd>
The rectangle defined for MCI_OVLY_RECT specifies the area of the client window used to display an image. The rectangle contains the offset and visible extent of the image relative to the window origin. If the frame is being stretched, the source is stretched to the destination rectangle.</dd>
<dt>
MCI_OVLY_PUT_FRAME</dt>
<dd>
The rectangle defined for MCI_OVLY_RECT specifies the area of the video buffer used to receive the video image. The rectangle contains the offset and extent of the buffer area relative to the video buffer origin.</dd>
<dt>
MCI_OVLY_PUT_SOURCE</dt>
<dd>
The rectangle defined for MCI_OVLY_RECT specifies the area of the video buffer used as the source of the digital image. The rectangle contains the offset and extent of the clipping rectangle for the video buffer relative to its origin.</dd>
<dt>
MCI_OVLY_PUT_VIDEO</dt>
<dd>
The rectangle defined for MCI_OVLY_RECT specifies the area of the video source capture by the video buffer. The rectangle contains the offset and extent of the clipping rectangle for the video source relative to its origin.</dd>
<dt>
MCI_OVLY_RECT</dt>
<dd>
The <b>rc</b> member of the structure identified by <i>lpDest</i> contains a valid display rectangle. If this flag is not specified, the default rectangle matches the coordinates of the video buffer or window being clipped.
</dd>
</dl>
<p>
For video-overlay devices, <i>lpDest</i> points to an <a href="mmstr_6bg2.htm"><b>MCI_OVLY_RECT_PARMS</b></a> structure.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mmsystem.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mci_7vvt.htm">MCI Overview</a>, <a href="../pdgrmm/mci_4eib.htm">MCI Commands</a>, <a href="mmstr_4whe.htm"><b>MCI_DGV_PUT_PARMS</b></a>, <a href="mmstr_0jjm.htm"><b>MCI_GENERIC_PARMS</b></a>, <a href="mmcmd_72b7.htm"><b>MCI_GETDEVCAPS</b></a>, <a href="mmstr_6bg2.htm"><b>MCI_OVLY_RECT_PARMS</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
