<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_SETAUDIO</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mci_setaudio"></a>MCI_SETAUDIO</h1>
<p>
The <b>MCI_SETAUDIO</b> command sets values associated with audio playback and capture. Digital-video and VCR devices recognize this command. </p>
<pre><code>MCIERROR mciSendCommand(MCIDEVICEID wDeviceID, MCI_SETAUDIO, 
    DWORD dwFlags, (DWORD) (LPMCI_GENERIC_PARMS) lpSetAudio);
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wDeviceID</i></dt>
<dd>
Device identifier of the MCI device that is to receive the command message.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
MCI_NOTIFY, MCI_WAIT, or MCI_TEST. For information about these flags, see <a href="../pdgrmm/mci_9v3n.htm">The Wait, Notify, and Test Flags</a>.</dd>
<dt>
<i>lpSetAudio</i></dt>
<dd>
Address of an <a href="mmstr_0jjm.htm"><b>MCI_GENERIC_PARMS</b></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise.</p>
<h4>Remarks</h4>
<p>
The following flags apply to the <b>digitalvideo</b> device type:
<dl>
<dt>
MCI_DGV_SETAUDIO_ALG</dt>
<dd>
The <b>lpstrAlgorithm</b> member of the structure identified by <i>lpSetAudio</i> contains an address of a buffer containing the name of an audio compression algorithm. The compression algorithm is used by subsequent <a href="mmcmd_85lx.htm"><b>MCI_RESERVE</b></a> or <a href="mmcmd_2tpg.htm"><b>MCI_RECORD</b></a> commands. The available algorithms are device dependent. If the algorithm is incompatible with the current file format, the file format is changed to the default format for the algorithm.</dd>
<dt>
MCI_DGV_SETAUDIO_CLOCKTIME</dt>
<dd>
The time specified is in milliseconds and is absolute time when used with MCI_DGV_SETAUDIO_OVER. (This time is not in step with the playing of the workspace.)</dd>
<dt>
MCI_DGV_SETAUDIO_INPUT</dt>
<dd>
Modifies the bass, treble, or volume flag so that it affects the input signal and modifies what is recorded. If possible, this is the default when monitoring the input.</dd>
<dt>
MCI_DGV_SETAUDIO_ITEM</dt>
<dd>
An audio constant is specified in the <b>dwItem</b> member of the structure identified by <i>lpSetAudio</i>. The constant identifies the value that is being set. The following constants are defined:
<dl>
<dt>
MCI_DGV_SETAUDIO_AVGBYTESPERSEC</dt>
<dd>
The average number of bytes is specified in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. This value sets the average number of bytes per second for playing or recording in the PCM (Pulse Code Modulation) and ADPCM (Adaptive Differential Pulse Code Modulation) formats. The file is saved in this format. </dd>
<dt>
MCI_DGV_SETAUDIO_BASS</dt>
<dd>
The audio low frequency level is specified as a factor in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>.</dd>
<dt>
MCI_DGV_SETAUDIO_BITSPERSAMPLE</dt>
<dd>
The number of bits per sample is specified in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. This value sets the number of bits per sample played or recorded in the PCM format. The file is saved in this format.  </dd>
<dt>
MCI_DGV_SETAUDIO_BLOCKALIGN</dt>
<dd>
The data block alignment is specified in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. This value sets the alignment of data blocks relative to the start of input waveform data. </dd>
<dt>
MCI_DGV_SETAUDIO_SAMPLESPERSEC</dt>
<dd>
The sample rate is specified in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. This value sets the sample rate for playing and recording with the PCM and ADPCM algorithms. The file is saved in this format.</dd>
<dt>
MCI_DGV_SETAUDIO_SOURCE</dt>
<dd>
A constant specifying the source of audio input is included in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. The following constants are defined for the audio input sources:
<p>
MCI_DGV_SETAUDIO_SOURCE_AVERAGE

<p>
The average of the left and right audio channels. 

<p>
MCI_DGV_SETAUDIO_SOURCE_LEFT

<p>
Left audio channel. 

<p>
MCI_DGV_SETAUDIO_SOURCE_RIGHT

<p>
Right audio channel. 

<p>
MCI_DGV_SETAUDIO_SOURCE_STEREO

<p>
Stereo. 
</dd>
<dt>
MCI_DGV_SETAUDIO_STREAM</dt>
<dd>
An audio-stream is specified in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. The integer value specifies the audio stream played back from the workspace. If the stream is not specified, the first physically interleaved audio stream is played. </dd>
<dt>
MCI_DGV_SETAUDIO_TREBLE</dt>
<dd>
The audio high-frequency level is specified as a factor in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. </dd>
<dt>
MCI_DGV_SETAUDIO_VOLUME</dt>
<dd>
The audio level for one or both audio channels is specified as a factor in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. If the left and right volumes have been set to different values, then the ratio of left to right volume is approximately unchanged.</dd>
</dl>
</dd>
<dt>
MCI_DGV_SETAUDIO_LEFT</dt>
<dd>
Enables the left audio channel when used with MCI_SET_ON. Disables the left audio channel when used with MCI_SET_OFF. When this flag is used with the combination of MCI_DGV_SETAUDIO_VALUE and MCI_DGV_SETAUDIO_VOLUME, it sets the volume of the left audio channel. When this flag is used with MCI_DGV_SETAUDIO_SOURCE, it specifies the left audio channel as the source for the audio input digitizer.</dd>
<dt>
MCI_DGV_SETAUDIO_OVER</dt>
<dd>
A transition length parameter is included in the <b>dwOver</b> member of the structure identified by <i>lpSetAudio</i>. The length value specifies how long (in units of the current time format) it should take to make a change that uses a factor. If this flag is not used, changes occur immediately.</dd>
<dt>
MCI_DGV_SETAUDIO_QUALITY</dt>
<dd>
The <b>lpstrQuality</b> member of the structure identified by <i>lpSetAudio </i>contains an address of a buffer defining the audio quality. A text-string within the buffer specifies the characteristics of the audio compression algorithm. 
<p>
The MCI_DGV_SETAUDIO_ALG flag can be used to select a quality descriptor for the specified algorithm. If this flag is omitted, then the current algorithm is used. 

<p>
The algorithms and descriptor names available depend on the device. Each device supplies documentation for the available algorithms and a description of the applicable descriptor names. The <a href="mmcmd_1ce1.htm"><b>MCI_QUALITY</b></a> command can define additional descriptor names.
</dd>
<dt>
MCI_DGV_SETAUDIO_RECORD</dt>
<dd>
Specifies whether recording includes or excludes audio data. When combined with MCI_SET_ON, audio data is recorded. When combined with MCI_SET_OFF, audio data is excluded. The default includes audio data.</dd>
<dt>
MCI_DGV_SETAUDIO_RIGHT</dt>
<dd>
Enables the right audio channel when used with MCI_SET_ON. Disables the right audio channel when used with MCI_SET_OFF. When this flag is used with the combination of MCI_DGV_SETAUDIO_VALUE and MCI_DGV_SETAUDIO_VOLUME, it sets the volume of the right audio channel.</dd>
<dt>
MCI_DGV_SETAUDIO_VALUE</dt>
<dd>
A value is specified in the <b>dwValue</b> member of the structure identified by <i>lpSetAudio</i>. The meaning of the value is specified by the constant defined for the MCI_DGV_SETAUDIO_ITEM flag.</dd>
<dt>
MCI_SET_OFF</dt>
<dd>
Disables the specified audio channel.</dd>
<dt>
MCI_SET_ON</dt>
<dd>
Enables the specified audio channel.</dd>
<dt>
MCI_SETAUDIO_OUTPUT</dt>
<dd>
Modifies the bass, treble, or volume flag so that it modifies only the played signal and not what is recorded. If possible, this is the default when monitoring the input.
</dd>
</dl>
<p>
For digital-video devices, the <i>lpSetAudio</i> parameter points to an <a href="mmstr_6zci.htm"><b>MCI_DGV_SETAUDIO_PARMS</b></a> structure.</p>
<p>
The following additional flags are used with the <b>vcr</b> device type:
<dl>
<dt>
MCI_VCR_SETAUDIO_RECORD</dt>
<dd>
Sets the audio recording to on or off, which is used in conjunction with one of following flags:
<dl>
<dt>
MCI_SET_ON</dt>
<dd>
Audio recording on.</dd>
<dt>
MCI_SET_OFF</dt>
<dd>
Audio recording off. It might be necessary to first turn off the assemble recording (using the <a href="mmcmd_87jo.htm"><b>MCI_SET</b></a> command<b> </b>with the MCI_VCR_SET_ASSEMBLE_RECORD flag set to off) before the audio recording can be turned off.</dd>
<dt>
MCI_TRACK</dt>
<dd>
The<b> dwTrack </b>member<b> </b>of the structure identified by <i>lpSetAudio</i> specifies which track is affected by the command.</dd>
</dl>
</dd>
<dt>
MCI_VCR_SETAUDIO_SOURCE</dt>
<dd>
Sets the audio source. This flag must be used with the MCI_VCR_SETAUDIO_TO flag.</dd>
<dt>
MCI_VCR_SETAUDIO_MONITOR</dt>
<dd>
Sets the audio source monitor. This flag must be used with the MCI_VCR_SETAUDIO_TO flag.</dd>
<dt>
MCI_VCR_SETAUDIO_TO</dt>
<dd>
The<b> dwTo </b>member of the structure identified by <i>lpSetAudio</i> contains a constant describing the type of input or monitored input. It must be one of the following:
<dl>
<dt>
MCI_VCR_SRC_TYPE_TUNER</dt>
<dd>
Type is tuner.</dd>
<dt>
MCI_VCR_SRC_TYPE_LINE</dt>
<dd>
Type is line.</dd>
<dt>
MCI_VCR_SRC_TYPE_AUX</dt>
<dd>
Type is auxiliary.</dd>
<dt>
MCI_VCR_SRC_TYPE_GENERIC</dt>
<dd>
Type is generic.</dd>
<dt>
MCI_VCR_SRC_TYPE_MUTE</dt>
<dd>
Type is mute. This can be used only with the MCI_VCR_SETAUDIO_SOURCE flag.</dd>
<dt>
MCI_VCR_SRC_TYPE_OUTPUT</dt>
<dd>
Type is output.</dd>
</dl>
</dd>
<dt>
MCI_VCR_SETAUDIO_NUMBER</dt>
<dd>
The<b> dwNumber </b>member of the structure identified by <i>lpSetAudio</i> contains the audio input (of the type specified in the <b>dwTo </b>member) to use.
</dd>
</dl>
<p>
For VCR devices, the <i>lpSetAudio</i> parameter points to an <a href="mmstr_3bea.htm"><b>MCI_VCR_SETAUDIO_PARMS</b></a> structure.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mmsystem.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mci_7vvt.htm">MCI Overview</a>, <a href="../pdgrmm/mci_4eib.htm">MCI Commands</a>, <a href="mmstr_6zci.htm"><b>MCI_DGV_SETAUDIO_PARMS</b></a>, <a href="mmstr_0jjm.htm"><b>MCI_GENERIC_PARMS</b></a>, <a href="mmcmd_1ce1.htm"><b>MCI_QUALITY</b></a>, <a href="mmcmd_2tpg.htm"><b>MCI_RECORD</b></a>, <a href="mmcmd_85lx.htm"><b>MCI_RESERVE</b></a>, <a href="mmcmd_87jo.htm"><b>MCI_SET</b></a>, <a href="mmstr_3bea.htm"><b>MCI_VCR_SETAUDIO_PARMS</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
