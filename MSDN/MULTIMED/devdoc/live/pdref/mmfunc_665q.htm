<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>mmioOpen</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mmioopen"></a>mmioOpen</h1>
<p>
The <b>mmioOpen</b> function opens a file for unbuffered or buffered I/O. The file can be a standard file, a memory file, or an element of a custom storage system. The handle returned by <b>mmioOpen</b> is not a standard file handle; do not use it with any file I/O functions other than multimedia file I/O functions.</p>
<pre><code><b>HMMIO mmioOpen(
  LPSTR</b><i> szFilename</i><b>,       </b>
<b>  LPMMIOINFO</b><i> lpmmioinfo</i><b>,  </b>
<b>  DWORD</b><i> dwOpenFlags       </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szFilename</i></dt>
<dd>
Address of a string containing the filename of the file to open. If no I/O procedure is specified to open the file, the filename determines how the file is opened, as follows:
<ul>
<li>
If the filename does not contain a plus sign (+), it is assumed to be the name of a standard  file (that is, a file whose type is not <b>HMMIO</b>).</li>
<li>
If the filename is of the form EXAMPLE.EXT+<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_abc_str">
</object><a href=JavaScript:alink_1.Click()><b>ABC</b></a>, the extension EXT is assumed to identify an installed I/O procedure which is called to perform I/O on the file. For more information, see <a href="mmfunc_1h5v.htm"><b>mmioInstallIOProc</b></a>.</li>
<li>
If the filename is NULL and no I/O procedure is given, the <b>adwInfo</b> member of the <a href="mmstr_7saa.htm"><b>MMIOINFO</b></a> structure is assumed to be the standard (non-<b>HMMIO</b>) file handle of a currently open file.</li>
</ul>

<p>
The filename should not be longer than 128 bytes, including the terminating NULL character.

<p>
When opening a memory file, set <i>szFilename</i> to NULL.
</dd>
<dt>
<i>lpmmioinfo</i></dt>
<dd>
Address of an <a href="mmstr_7saa.htm"><b>MMIOINFO</b></a> structure containing extra parameters used by <b>mmioOpen</b>. Unless you are opening a memory file, specifying the size of a buffer for buffered I/O, or specifying an uninstalled I/O procedure to open a file, this parameter should be NULL. If this parameter is not NULL, all unused members of the <b>MMIOINFO</b> structure it references must be set to zero, including the reserved members.</dd>
<dt>
<i>dwOpenFlags</i></dt>
<dd>
Flags for the open operation. The MMIO_READ, MMIO_WRITE, and MMIO_READWRITE flags are mutually exclusive — only one should be specified. The MMIO_COMPAT, MMIO_EXCLUSIVE, MMIO_DENYWRITE, MMIO_DENYREAD, and MMIO_DENYNONE flags are file-sharing flags. The following values are defined:
<dl>
<dt>
MMIO_ALLOCBUF</dt>
<dd>
Opens a file for buffered I/O. To allocate a buffer larger or smaller than the default buffer size (8K, defined as MMIO_DEFAULTBUFFER), set the <b>cchBuffer</b> member of the <a href="mmstr_7saa.htm"><b>MMIOINFO</b></a> structure to the desired buffer size. If <b>cchBuffer</b> is zero, the default buffer size is used. If you are providing your own I/O buffer, this flag should not be used.</dd>
<dt>
MMIO_COMPAT</dt>
<dd>
Opens the file with compatibility mode, allowing any process on a given machine to open the file any number of times. If the file has been opened with any of the other sharing modes, <b>mmioOpen</b> fails.</dd>
<dt>
MMIO_CREATE</dt>
<dd>
Creates a new file. If the file already exists, it is truncated to zero length. For memory files, this flag indicates the end of the file is initially at the start of the buffer.</dd>
<dt>
MMIO_DELETE</dt>
<dd>
Deletes a file. If this flag is specified, <i>szFilename</i> should not be NULL. The return value is TRUE (cast to <b>HMMIO</b>) if the file was deleted successfully or FALSE otherwise. Do not call the <a href="mmfunc_88f9.htm"><b>mmioClose</b></a> function for a file that has been deleted. If this flag is specified, all other flags that open files are ignored.</dd>
<dt>
MMIO_DENYNONE</dt>
<dd>
Opens the file without denying other processes read or write access to the file. If the file has been opened in compatibility mode by any other process, <b>mmioOpen</b> fails.</dd>
<dt>
MMIO_DENYREAD</dt>
<dd>
Opens the file and denies other processes read access to the file. If the file has been opened in compatibility mode or for read access by any other process, <b>mmioOpen</b> fails.</dd>
<dt>
MMIO_DENYWRITE</dt>
<dd>
Opens the file and denies other processes write access to the file. If the file has been opened in compatibility mode or for write access by any other process, <b>mmioOpen</b> fails.</dd>
<dt>
MMIO_EXCLUSIVE</dt>
<dd>
Opens the file and denies other processes read and write access to the file. If the file has been opened in any other mode for read or write access, even by the current process, <b>mmioOpen</b> fails.</dd>
<dt>
MMIO_EXIST</dt>
<dd>
Determines whether the specified file exists and creates a fully qualified filename from the path specified in <i>szFilename</i>. The filename is placed back into <i>szFilename</i>. The return value is TRUE (cast to <b>HMMIO</b>) if the qualification was successful and the file exists or FALSE otherwise. The file is not opened, and the function does not return a valid multimedia file I/O file handle, so do not attempt to close the file.</dd>
<dt>
MMIO_GETTEMP</dt>
<dd>
Creates a temporary filename, optionally using the parameters passed in <i>szFilename.</i> For example, you can specify "C:F" to create a temporary file residing on drive C, starting with letter "F". The resulting filename is placed in the buffer pointed to by <i>szFilename</i>. The return value is MMSYSERR_NOERROR (cast to <b>HMMIO</b>) if the temporary filename was created successfully or MMIOERR_FILENOTFOUND otherwise. The file is not opened, and the function does not return a valid multimedia file I/O file handle, so do not attempt to close the file. This flag overrides all other flags.</dd>
<dt>
MMIO_PARSE</dt>
<dd>
Creates a fully qualified filename from the path specified in <i>szFilename</i>. The filename is placed back into <i>szFilename</i>. The return value is TRUE (cast to <b>HMMIO</b>) if the qualification was successful or FALSE otherwise. The file is not opened, and the function does not return a valid multimedia file I/O file handle, so do not attempt to close the file. If this flag is specified, all flags that open files are ignored.</dd>
<dt>
MMIO_READ</dt>
<dd>
Opens the file for reading only. This is the default if MMIO_WRITE and MMIO_READWRITE are not specified.</dd>
<dt>
MMIO_READWRITE</dt>
<dd>
Opens the file for reading and writing.</dd>
<dt>
MMIO_WRITE</dt>
<dd>
Opens the file for writing only. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns a handle of the opened file. If the file cannot be opened, the return value is NULL. If <i>lpmmioinfo</i> is not NULL, the <b>wErrorRet</b> member of the <a href="mmstr_7saa.htm"><b>MMIOINFO</b></a> structure will contain one of the following error values:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=50%>Value</th>
<th align=left width=50%>Description</th>
</tr>
<tr valign=top>
<td width=50%>MMIOERR_ACCESSDENIED</td>
<td width=50%>The file is protected and cannot be opened.</td>
</tr>
<tr valign=top>
<td width=50%>MMIOERR_INVALIDFILE</td>
<td width=50%>Another failure condition occurred. This is the default error for an open-file failure.</td>
</tr>
<tr valign=top>
<td width=50%>MMIOERR_NETWORKERROR</td>
<td width=50%>The network is not responding to the request to open a remote file.</td>
</tr>
<tr valign=top>
<td width=50%>MMIOERR_PATHNOTFOUND</td>
<td width=50%>The directory specification is incorrect.</td>
</tr>
<tr valign=top>
<td width=50%>MMIOERR_SHARINGVIOLATION</td>
<td width=50%>The file is being used by another application and is unavailable.</td>
</tr>
<tr valign=top>
<td width=50%>MMIOERR_TOOMANYOPENFILES</td>
<td width=50%>The number of files simultaneously open is at a maximum level. The system has run out of available file handles.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
If <i>lpmmioinfo</i> references an <a href="mmstr_7saa.htm"><b>MMIOINFO</b></a> structure, set up the members of that structure as described below. All unused members must be set to zero, including reserved members.
<ul>
<li>
To request that a file be opened with an installed I/O procedure, set <b>fccIOProc</b> to the four-character code of the I/O procedure, and set <b>pIOProc</b> to NULL.</li>
<li>
To request that a file be opened with an uninstalled I/O procedure, set <a href="mmfunc_51cz.htm"><b>IOProc</b></a> to point to the I/O procedure, and set <b>fccIOProc</b> to NULL.</li>
<li>
To request that <b>mmioOpen</b> determine which I/O procedure to use to open the file based on the filename contained in <i>szFilename</i>, set <b>fccIOProc</b> and <b>pIOProc</b> to NULL. This is the default behavior if no <b>MMIOINFO</b> structure is specified.</li>
<li>
To open a memory file using an internally allocated and managed buffer, set <b>pchBuffer</b> to NULL, <b>fccIOProc</b> to FOURCC_MEM, <b>cchBuffer</b> to the initial size of the buffer, and <b>adwInfo</b> to the incremental expansion size of the buffer. This memory file will automatically be expanded in increments of the number of bytes specified in <b>adwInfo</b> when necessary. Specify the MMIO_CREATE flag for the <i>dwOpenFlags</i> parameter to initially set the end of the file to be the beginning of the buffer.</li>
<li>
To open a memory file using an application-supplied buffer, set <b>pchBuffer</b> to point to the memory buffer, <b>fccIOProc</b> to FOURCC_MEM, <b>cchBuffer</b> to the size of the buffer, and <b>adwInfo</b> to the incremental expansion size of the buffer. The expansion size in <b>adwInfo</b> should be nonzero only if <b>pchBuffer</b> is a pointer obtained by calling the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalalloc">
</object><a href=JavaScript:alink_2.Click()><b>GlobalAlloc</b></a> and <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globallock">
</object><a href=JavaScript:alink_3.Click()><b>GlobalLock</b></a> functions; in this case, the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalrealloc">
</object><a href=JavaScript:alink_4.Click()><b>GlobalReAlloc</b></a> function will be called to expand the buffer. In other words, if <b>pchBuffer</b> points to a local or global array or a block of memory in the local heap, <b>adwInfo</b> must be zero. Specify the MMIO_CREATE flag for the <i>dwOpenFlags</i> parameter to initially set the end of the file to be the beginning of the buffer. Otherwise, the entire block of memory is considered readable.</li>
<li>
To use a currently open standard file handle (that is, a file handle that does not have the <b>HMMIO</b> type) with multimedia file I/O services, set <b>fccIOProc</b> to FOURCC_DOS, <b>pchBuffer</b> to NULL, and <b>adwInfo </b>to the standard file handle. Offsets within the file will be relative to the beginning of the file and are not related to the position in the standard file at the time <b>mmioOpen</b> is called; the initial multimedia file I/O offset will be the same as the offset in the standard file when <b>mmioOpen</b> is called. To close the multimedia file I/O file handle without closing the standard file handle, pass the MMIO_FHOPEN flag to <b>mmioClose</b>.</li>
</ul>
<p>
You must call <b>mmioClose</b> to close a file opened by using <b>mmioOpen</b>. Open files are not automatically closed when an application exits.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mmsystem.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winmm.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mmio_4jvz.htm">Multimedia File I/O Overview</a>, <a href="../pdgrmm/mmio_5ysz.htm">Multimedia File I/O Functions</a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_abc_str">
</object><a href=JavaScript:alink_5.Click()><b>ABC</b></a>, <a href="mmfunc_1h5v.htm"><b>mmioInstallIOProc</b></a>, <a href="mmstr_7saa.htm"><b>MMIOINFO</b></a>, <a href="mmfunc_88f9.htm"><b>mmioClose</b></a>, <a href="mmfunc_51cz.htm"><b>IOProc</b></a>, <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalalloc">
</object><a href=JavaScript:alink_6.Click()><b>GlobalAlloc</b></a>, <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globallock">
</object><a href=JavaScript:alink_7.Click()><b>GlobalLock</b></a>, <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_globalrealloc">
</object><a href=JavaScript:alink_8.Click()><b>GlobalReAlloc</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
