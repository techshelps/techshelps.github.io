<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_SYSINFO</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mci_sysinfo"></a>MCI_SYSINFO</h1>
<p>
The <b>MCI_SYSINFO</b> command retrieves information about MCI devices. MCI supports this command directly rather than passing it to the device. Any MCI application can use this command. String information is returned in the application-supplied buffer pointed to by the <b>lpstrReturn</b> member of the structure identified by <i>lpSysInfo</i>. Numeric information is returned as a doubleword value placed in the application-supplied buffer. The <b>dwRetSize</b> member specifies the buffer length.  </p>
<pre><code>MCIERROR mciSendCommand(MCIDEVICEID wDeviceID, MCI_SYSINFO, 
    DWORD dwFlags, (DWORD) (LPMCI_SYSINFO_PARMS) lpSysInfo);
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wDeviceID</i></dt>
<dd>
Device identifier of the MCI device that is to receive the command message.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
One or more of the following standard and command-specific flags:
<dl>
<dt>
MCI_SYSINFO_INSTALLNAME</dt>
<dd>
Obtains the name (listed in the registry or the SYSTEM.INI file) used to install the device.</dd>
<dt>
MCI_SYSINFO_NAME</dt>
<dd>
Obtains a device name corresponding to the device number specified in the <b>dwNumber</b> member of the structure identified by <i>lpSysInfo</i>. If the MCI_SYSINFO_OPEN flag is set, MCI returns the names of open devices.</dd>
<dt>
MCI_SYSINFO_OPEN</dt>
<dd>
Obtains the quantity or name of open devices.</dd>
<dt>
MCI_SYSINFO_QUANTITY</dt>
<dd>
Obtains the number of devices of the specified type that are listed in the registry or the [mci] section of the SYSTEM.INI file. If the MCI_SYSINFO_OPEN flag is set, the number of open devices is returned.</dd>
</dl>
</dd>
<dt>
<i>lpSysInfo</i></dt>
<dd>
Address of an <a href="mmstr_1u9e.htm"><b>MCI_SYSINFO_PARMS</b></a> structure.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise.</p>
<h4>Remarks</h4>
<p>
The <b>wDeviceType</b> member of the structure identified by <i>lpSysInfo</i> is used to indicate the device type of the query. If the <i>wDeviceID</i> parameter is set to MCI_ALL_DEVICE_ID, it overrides the value of <b>wDeviceType</b>. For a list of device types, see <a href="mmconst_25rn.htm">Constants: Device Types</a>.</p>
<p>
Integer return values are doubleword values returned in the buffer pointed to by the <b>lpstrReturn</b> member of the structure identified by <i>lpSysInfo</i>. </p>
<p>
String return values are null-terminated strings returned in the buffer pointed to by the <b>lpstrReturn</b> member of the structure identified by <i>lpSysInfo</i>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mmsystem.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mci_7vvt.htm">MCI Overview</a>, <a href="../pdgrmm/mci_4eib.htm">MCI Commands</a>, <a href="mmstr_1u9e.htm"><b>MCI_SYSINFO_PARMS</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
