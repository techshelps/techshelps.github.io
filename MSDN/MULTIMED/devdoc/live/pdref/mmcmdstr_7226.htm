<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>open</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_open"></a>open</h1>
<p>
The <b>open</b> command initializes a device. All MCI devices recognize this command. </p>
<pre><code>wsprintf(lpstrCommand, "open %s %s %s", lpszDevice, lpszOpenFlags, 
    lpszFlags); 
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszDevice</i></dt>
<dd>
Identifier of an MCI device or device driver. This can be either a device name (as given in the registry or the SYSTEM.INI file) or the filename of the device driver. If you specify the filename of the device driver, you can optionally include the .DRV extension, but you should not include the path to the file.</dd>
<dt>
<i>lpszOpenFlags</i></dt>
<dd>
Flag that identifies what to initialize. The following table lists device types that recognize the <b>open</b> command and the flags used by each type:
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=25%><b>cdaudio</b></td>
<td width=30%>alias <i>device_alias</i><br>
shareable</td>
<td width=45%>type <i>device_type</i></td>
</tr>
<tr valign=top>
<td width=25%><b>digitalvideo</b></td>
<td width=30%>alias <i>device_alias</i><br>
<i>elementname<br>
</i>nostatic<i><br>
</i>parent <i>hwnd<br>
</i>shareable</td>
<td width=45%>style child<br>
style overlapped<br>
style popup<br>
style <i>style_type<br>
</i>type <i>device_type</i></td>
</tr>
<tr valign=top>
<td width=25%><b>overlay</b></td>
<td width=30%>alias <i>device_alias</i><br>
parent <i>hwnd<br>
</i>shareable<br>
style child</td>
<td width=45%>style overlapped<br>
style popup<br>
style <i>style_type<br>
</i>type <i>device_type</i></td>
</tr>
<tr valign=top>
<td width=25%><b>sequencer</b></td>
<td width=30%>alias <i>device_alias</i><br>
shareable</td>
<td width=45%>type <i>device_type</i></td>
</tr>
<tr valign=top>
<td width=25%><b>vcr</b></td>
<td width=30%>alias <i>device_alias</i><br>
shareable</td>
<td width=45%>type <i>device_type</i></td>
</tr>
<tr valign=top>
<td width=25%><b>videodisc</b></td>
<td width=30%>alias <i>device_alias</i><br>
shareable</td>
<td width=45%>type <i>device_type</i></td>
</tr>
<tr valign=top>
<td width=25%><b>waveaudio</b></td>
<td width=30%>alias <i>device_alias</i><br>
buffer <i>buffer_size</i></td>
<td width=45%>shareable<br>
type <i>device_type</i></td>
</tr>
</table><br>


<p>
The following table lists the flags that can be specified in the <i>lpszOpenFlags</i> parameter and their meanings:

<table cellspacing=4 cols=2>
<tr valign=top>
<td width=24%>alias <i>device_alias</i></td>
<td width=76%>Specifies an alternate name for the given device. If specified, it must be used as the <i>device_id</i> in subsequent commands.</td>
</tr>
<tr valign=top>
<td width=24%><i>elementname</i></td>
<td width=76%>Specifies the name of the device element (file) loaded when the device opens.</td>
</tr>
<tr valign=top>
<td width=24%>buffer <i>buffer_size</i></td>
<td width=76%>Sets the size, in seconds, of the buffer used by the waveform-audio device. The default size of the buffer is set when the waveform-audio device is installed or configured. Typically the buffer size is set to 4 seconds. With the MCIWAVE device, the minimum size is 2 seconds and the maximum size is 9 seconds.</td>
</tr>
<tr valign=top>
<td width=24%>parent <i>hwnd</i></td>
<td width=76%>Specifies the window handle of the parent window.</td>
</tr>
<tr valign=top>
<td width=24%>shareable</td>
<td width=76%>Initializes the device or file as shareable. Subsequent attempts to open the device or file fail unless you specify "shareable" in both the original and subsequent <b>open</b> commands. <br>
MCI returns an invalid device error if the device is already open and not shareable.<p>
The MCISEQ sequencer and MCIWAVE devices do not support shared files.</p>
</td>
</tr>
<tr valign=top>
<td width=24%>style child</td>
<td width=76%>Opens a window with a child window style.</td>
</tr>
<tr valign=top>
<td width=24%>style overlapped</td>
<td width=76%>Opens a window with an overlapped window style.</td>
</tr>
<tr valign=top>
<td width=24%>style popup</td>
<td width=76%>Opens a window with a pop-up window style.</td>
</tr>
<tr valign=top>
<td width=24%>style <i>style_type</i></td>
<td width=76%>Indicates a window style.</td>
</tr>
<tr valign=top>
<td width=24%>type <i>device_type</i></td>
<td width=76%>Specifies the device type of a file. </td>
</tr>
</table><br>

</dd>
<dt>
<i>lpszFlags</i></dt>
<dd>
Can be "wait", "notify", or both. For more information about these flags, see <a href="../pdgrmm/mci_9v3n.htm">The Wait, Notify, and Test Flags</a>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise.</p>
<h4>Remarks</h4>
<p>
MCI reserves "cdaudio" for the CD audio device type, "videodisc" for the videodisc device type, "sequencer" for the MIDI sequencer device type, "AVIVideo" for the digital-video device type, and "waveaudio" for the waveform-audio device type.</p>
<p>
As an alternative to the "type" flag, MCI can select the device based on the extension used by the file, as recorded in the registry or the [mci extension] section of the SYSTEM.INI file. </p>
<p>
MCI can open AVI files by using a file-interface pointer or a stream-interface pointer. To open a file by using either type of interface pointer, specify an at sign (@) followed by the interface pointer in place of the file or device name for the <i>lpszDevice</i> parameter. For more information about the file and stream interfaces, see "<a href="../pdgrmm/avifile_3uwj.htm">AVIFile Functions and Macros</a> ."</p>
<p>
The following command opens the "mysound" device:</p>
<pre><code>open new type waveaudio alias mysound buffer 6
 </code></pre>
<p>
With device name "new", the waveform driver prepares a new waveform resource. The command assigns the device alias "mysound" and specifies a 6-second buffer.</p>
<p>
You can eliminate the "type" flag if you combine the device name with the filename. MCI recognizes this combination when you use the following syntax:</p>
<p>
<i>device_name</i>!<i>element_name</i></p>
<p>
The exclamation point separates the device name from the filename. The exclamation point should not be delimited by white spaces.</p>
<p>
The following example opens the RIGHT.WAV file using the "waveaudio" device:</p>
<pre><code>open waveaudio!right.wav
 </code></pre>
<p>
The MCIWAVE driver requires an asynchronous waveform-audio device.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Version: </b>Requires Windows NT Server Enterprise Edition 4.0.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in resapi.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mci_7vvt.htm">MCI Overview</a>, <a href="../pdgrmm/mci_04dv.htm">MCI Command Strings</a> </p>
<p>&nbsp;</p></body>
</HTML>
