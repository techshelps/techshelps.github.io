<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_OPEN</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_mci_open"></a>MCI_OPEN</h1>
<p>
The <b>MCI_OPEN</b> command initializes a device or file. All devices recognize this command.</p>
<pre><code>MCIERROR mciSendCommand(MCIDEVICEID wDeviceID, MCI_OPEN, 
    DWORD dwFlags, (DWORD) (LPMCI_OPEN_PARMS) lpOpen);
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wDeviceID</i></dt>
<dd>
Device identifier of the MCI device that is to receive the command message.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
MCI_NOTIFY or MCI_WAIT. For information about these flags, see <a href="../pdgrmm/mci_9v3n.htm">The Wait, Notify, and Test Flags</a>.</dd>
<dt>
<i>lpOpen</i></dt>
<dd>
Address of an <a href="mmstr_0582.htm"><b>MCI_OPEN_PARMS</b></a> structure. (Devices with extended command sets might replace this structure with a device-specific structure.)
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if successful or an error otherwise.</p>
<h4>Remarks</h4>
<p>
The MCI_OPEN_TYPE flag must be used whenever a device is specified in the <a href="mmfunc_1xwk.htm"><b>mciSendCommand</b></a> function. If you open a device by specifying a device-type constant, you must specify the MCI_OPEN_TYPE_ID flag in addition to MCI_OPEN_TYPE. For a list of device-type constants, see <a href="mmconst_25rn.htm">Constants: Device Types</a>.</p>
<p>
If the MCI_OPEN_SHAREABLE flag is not specified when a device or file is initially opened, all subsequent <b>MCI_OPEN </b>commands to the device or file will fail. If the device or file is already open and this flag is not specified, the call will fail even if the first open command specified MCI_OPEN_SHAREABLE. Files opened for the MCISEQ.DRV and MCIWAVE.DRV devices are nonshareable.</p>
<p>
Case is ignored in the device name, but there cannot be leading or trailing blanks.</p>
<p>
To use automatic type selection (via the entries in the registry), assign the filename and file extension to the <b>lpstrElementName</b> member of the structure identified by <i>lpOpen</i>, set the <b>lpstrDeviceType</b> member to NULL, and set the MCI_OPEN_ELEMENT flag.</p>
<p>
The following additional flags apply to all devices supporting <b>MCI_OPEN</b>:
<dl>
<dt>
MCI_OPEN_ALIAS</dt>
<dd>
An alias is included in the <b>lpstrAlias</b> member of the structure identified by <i>lpOpen</i>.</dd>
<dt>
MCI_OPEN_SHAREABLE</dt>
<dd>
The device or file should be opened as shareable.</dd>
<dt>
MCI_OPEN_TYPE</dt>
<dd>
A device type name or constant is included in the <b>lpstrDeviceType</b> member of the structure identified by <i>lpOpen</i>.</dd>
<dt>
MCI_OPEN_TYPE_ID</dt>
<dd>
The low-order word of the <b>lpstrDeviceType</b> member of the structure identified by <i>lpOpen</i> contains a standard MCI device type identifier and the high-order word optionally contains the ordinal index for the device. Use this flag with the MCI_OPEN_TYPE flag.
</dd>
</dl>
<p>
The following additional flags apply to compound devices:
<dl>
<dt>
MCI_OPEN_ELEMENT</dt>
<dd>
A filename is included in the <b>lpstrElementName</b> member of the structure identified by <i>lpOpen</i>.</dd>
<dt>
MCI_OPEN_ELEMENT_ID</dt>
<dd>
The <b>lpstrElementName</b> member of the structure identified by <i>lpOpen</i> is interpreted as a doubleword value and has meaning internal to the device. Use this flag with the MCI_OPEN_ELEMENT flag.
</dd>
</dl>
<p>
The following additional flags are used with the <b>digitalvideo</b> device type:
<dl>
<dt>
MCI_DGV_OPEN_NOSTATIC</dt>
<dd>
The device should reduce the number of static (system) colors in the palette. This increases the number of colors available for rendering the video stream. This flag applies only to devices that share a palette with Windows.</dd>
<dt>
MCI_DGV_OPEN_PARENT</dt>
<dd>
The parent window handle is specified in the <b>hWndParent</b> member of the structure identified by <i>lpOpen</i>.</dd>
<dt>
MCI_DGV_OPEN_WS</dt>
<dd>
A window style is specified in the <b>dwStyle</b> member of the structure identified by <i>lpOpen</i>.</dd>
<dt>
MCI_DGV_OPEN_16BIT</dt>
<dd>
Indicates a preference for 16-bit MCI device support.</dd>
<dt>
MCI_DGV_OPEN_32BIT</dt>
<dd>
Indicates a preference for 32-bit MCI device support.
</dd>
</dl>
<p>
For digital-video devices, the <i>lpOpen</i> parameter points to an <a href="mmstr_0f3m.htm"><b>MCI_DGV_OPEN_PARMS</b></a> structure.</p>
<p>
The following additional flags are used with the <b>overlay</b> device type:
<dl>
<dt>
MCI_OVLY_OPEN_PARENT</dt>
<dd>
The parent window handle is specified in the <b>hWndParent</b> member of the structure identified by <i>lpOpen</i>.</dd>
<dt>
MCI_OVLY_OPEN_WS</dt>
<dd>
A window style is specified in the <b>dwStyle</b> member of the structure identified by <i>lpOpen</i>. The <b>dwStyle</b> value specifies the style of the window that the driver will create and display if the application does not provide one. The style parameter takes an integer that defines the window style. These constants are the same as the standard window styles (such as WS_CHILD, WS_OVERLAPPEDWINDOW, or WS_POPUP).
</dd>
</dl>
<p>
For video-overlay devices, the <i>lpOpen</i> parameter points to an <a href="mmstr_2mb6.htm"><b>MCI_OVLY_OPEN_PARMS</b></a> structure.</p>
<p>
The following additional flag is used with the <b>waveaudio</b> device type:
<dl>
<dt>
MCI_WAVE_OPEN_BUFFER</dt>
<dd>
A buffer length is specified in the <b>dwBufferSeconds</b> member of the structure identified by <i>lpOpen</i>.
</dd>
</dl>
<p>
For waveform-audio devices, the <i>lpOpen</i> parameter points to an <a href="mmstr_8eia.htm"><b>MCI_WAVE_OPEN_PARMS</b></a> structure. The MCIWAVE driver requires an asychronous waveform-audio device.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mmsystem.h.</p>
<h4>See Also</h4>
<p>
<a href="../pdgrmm/mci_7vvt.htm">MCI Overview</a>, <a href="../pdgrmm/mci_4eib.htm">MCI Commands</a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createwindow">
</object><a href=JavaScript:alink_1.Click()><b>CreateWindow</b></a>, <a href="mmstr_0f3m.htm"><b>MCI_DGV_OPEN_PARMS</b></a>, <a href="mmstr_0582.htm"><b>MCI_OPEN_PARMS</b></a>, <a href="mmstr_2mb6.htm"><b>MCI_OVLY_OPEN_PARMS</b></a>, <a href="mmstr_8eia.htm"><b>MCI_WAVE_OPEN_PARMS</b></a>, <a href="mmfunc_1xwk.htm"><b>mciSendCommand</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
