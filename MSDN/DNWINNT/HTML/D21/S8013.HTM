<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving Selected Data</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Retrieving Selected Data</H2><P>Retrieving the performance data is not without cost to the system, especially in terms of processor and memory requirements. In cases where your application does not need all the performance data, you can use the <I>lpszValueName</I> parameter of <B>RegQueryValueEx</B> to indicate the amount of information to retrieve. The following table lists the values you can specify for <I>lpszValueName</I>. Note that the value strings are case-sensitive, and if a string includes more than one word, your words must be separated by a space. </P>
<P>Table 12.2    Possible Values for <I>lpszValueName</I></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="240pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>String</P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Global</B></P></TD><TD VALIGN="TOP"><P>The function returns all data for counters on the local computer except those included in the <B>Costly</B> category, described later in this table.</P></TD></TR><TR><TD VALIGN="TOP"><P><B><I>nnn xx yyy</I></B></P></TD><TD VALIGN="TOP"><P>Each of these is a Unicode string representing the decimal value for a PERF_OBJECT_TYPE.ObjectNameTitleIndex. The function only returns data about the specified object types on the local computer. 1 </P>
<P>Using the example above, if your program were to pass  "2 4" as the <I>lpszValueName</I> the System and Memory objects would be retrieved.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Foreign </B><B><I>ssss</I></B></P></TD><TD VALIGN="TOP"><P>The string <B><I>ssss</I></B> is the name of a foreign computer, such as a Novell NetWare server or a UNIX system that does not support the Registry calls for returning data remotely. The function returns all data for counters on the foreign computer, if your system is capable of collecting data from a foreign computer. You may want to try this approach if RegConnectRegistry fails to connect to a foreign computer.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Foreign </B><B><I>ssss nnn xx yyy</I></B></P></TD><TD VALIGN="TOP"><P>This format combines <B>Foreign </B><B><I>ssss</I></B> and <B><I>nnn xx yyy</I></B> discussed above, and returns all data for the specified objects on the foreign computer, if your system is capable of collecting data from a foreign computer.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Costly</B></P></TD><TD VALIGN="TOP"><P>Data for object types whose data is expensive to collect (in terms of processor time or memory usage) is returned. If you want to respond to the user during data collection, you may want to start a secondary thread to access this data. PView does this. <B>Costly</B> data includes all the data normally returned by <B>Global</B>, and the expensive stuff too. For example, to return the current instruction pointer, the data collection code must map into every process's address space. This is too expensive for routine performance monitoring but may be useful in other situations.</P></TD></TR></TBODY></TABLE>
<P>|<P><BR></P><P>1If you request an object type that requires other object types, the required object types will also be returned. For example, processes are needed to identify threads, so if you request threads you will also receive data about processes.</P></FONT></BODY></HTML>
