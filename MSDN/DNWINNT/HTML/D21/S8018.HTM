<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the Application's Performance Key</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Creating the Application's Performance Key</H3><P>An application that supports performance counters must have a Performance subkey in a Services node. For development, an application writer can use Regedt32 to manually create the Performance key and the <B>Library</B>, <B>Open</B>, <B>Collect</B>, and <B>Close</B> values.</P>
<P>The following code shows the values under this key:</P>
<P>|<P><BR></P>
<pre><code>\HKEY_LOCAL_MACHINE<BR>     \SYSTEM<BR>          \CurrentControlSet<BR>               \Services<BR>                    \ApplicationName<BR>                         \Performance<BR>                              Library = DLL_Name<BR>                              Open = Open_Function_Name<BR>                              Collect = Collect_Function_Name<BR>                              Close = Close_Function_Name<BR>                              First Counter = <BR>                              First Help = <BR>                              Last Counter = <BR>                              Last Help = </code></pre>
<P>The <B>Library</B>, <B>Open</B>, <B>Collect</B>, and <B>Close</B> values provide the name of the application's performance DLL and the names of the exported functions in the DLL. When a performance monitoring application requests performance data, the Registry controller uses these values to determine the performance DLLs to load and the DLL functions to call. The Open and Close entries are optional.</P>
<P>You do not need to add manually the <B>First Counter</B>, <B>First Help</B>, <B>Last Counter</B>, and <B>Last Help</B> values. These are created automatically by the <B>lodctr</B> utility when you add counter names and descriptions to the Registry. These entries are explained in the following section. </P></FONT></BODY></HTML>
