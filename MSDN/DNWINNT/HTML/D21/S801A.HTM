<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Other Registry Entries</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Other Registry Entries</H3><P>In some cases, additional Registry entries are required. </P>
<P>To obtain the performance data for some applications (those that return counters via the DeviceIOControlFile call), it is necessary to use the CreateFile function to open the device associated with the application. In this case, the name specified in CreateFile must also be installed in the DOS Devices node of the Registry:</P>
<P>|<P><BR></P>
<pre><code><BR>\HKEY_LOCAL_MACHINE<BR>     \SYSTEM<BR>          \CurrentControlSet<BR>               \Control<BR>                    \Session Manager<BR>                         \DOS Devices<BR></code></pre>
<P>For applications that manage multiple device instances with performance data for each device, the application's Services node must have a Linkage key containing an Export value whose data is a list of the device names. For example, a system with two Etherlink cards could have the following Registry entries:</P>
<P>|<P><BR></P>
<pre><code><BR>\HKEY_LOCAL_MACHINE<BR>     \SYSTEM\CurrentControlSet\Services<BR>          \Elnkii<BR>               \Linkage<BR>                    Export = "\Device\Elnk01" "\Device\Elnk02"<BR>               \Performance<BR>                    Library = "ElnkStat.dll"<BR>                    Open = "OpenElnkStats"<BR>                    Collect = "GetElnkStats"<BR>                    Close = "CloseElnkStats"<BR>          \Elnk01<BR>               Parameters<BR>               Linkage<BR>          \Elnk02<BR>               Parameters<BR>               Linkage</code></pre>
<P>When the Registry controller calls the Open function in an application's performance DLL, the function's argument is a string containing the list of device names from the application's Export value (if present). The Open function can then use these names to determine the devices for which to collect performance data.</P></FONT></BODY></HTML>
