<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using WinDbg with the Recovery Option</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Using WinDbg with the Recovery Option</H3><P>If you do not want to or are unable to do local or remote debugging, you can use the Recovery option located under the System option in Control Panel. Whenever a Windows&nbsp;NT Executive STOP error occurs, Windows&nbsp;NT can save the state of the computer system to a log file on the boot partition. This file contains all the information needed by WinDbg to troubleshoot the STOP error as if you were connected to a live computer experiencing the problem. In addition, all the WinDbg commands that work during a local or remote debugging session also work in this mode. </P>
<P>This enables you to examine the error at any time and immediately restart the computer that failed instead of keeping it down during the debug session. The only drawback to this method is that, to contain all the necessary information for a debug session, you must have sufficient space on your hard disk for the resulting log file, which will be as large as your RAM memory. Therefore, whenever a STOP error occurs, a computer with 32 MB of RAM will produce a 32-MB log file.</P>
<H4><A NAME="sec0"></A>To configure Windows&nbsp;NT to save STOP information to a log file</H4><OL><LI>    In Control Panel, choose the System option.</LI><LI>    In the System dialog box, choose the Recovery button. </LI><LI>    In the Recovery dialog box, select the Write Debugging Information To check box, and either accept the default path and filename (C:\<I>systemroot</I>\MEMORY.DMP) or type your own in the text box. 
<P>To have this log file overwrite any file of the same name, select the Overwrite Any Existing File check box. If you clear this check box, Windows&nbsp;NT will not write a log file if there is already a file by that name.</P></LI></OL><H4><A NAME="sec1"></A>To debug a log file using WinDbg</H4><OL><LI>    Create a subdirectory called \SYMBOLS on the host computer's hard disk under the directory in which you have installed Windows&nbsp;NT.</LI><LI>    Copy the debugging symbols, corresponding to the target computer that produced the log file, from the \SUPPORT\DEBUG\&lt;<I>platform</I>&gt;\SYMBOLS directory on the CD-ROM to the \SYMBOLS directory on the host computer. 
<P><I>Platform</I> refers to the hardware platform of the host computer.</P></LI><LI>    Copy all the files from the \SUPPORT\DEBUG\&lt;<I>platform</I>&gt; directory on the CD-ROM to the \SYSTEM32 directory on the host computer. 
<P>This can be done with the <B>xcopy</B> or <B>copy</B> command.</P></LI><LI>    To start WinDbg in Kernel-debug mode from either the command line or the File Run dialog box in Program Manager, type:
<P><B>&lt;</B><I>path</I><B>&gt; windbg</B> <B>-z </B>&lt;<I>filename</I>&gt;<B> -y </B>&lt;<I>symbol path</I>&gt; </P>

<P>Where:</P>

<P><I>Path</I> is the path to the WINDBG.EXE file.</P>

<P><B>-z</B> invokes the Kernel-debug mode using the MEMORY.DMP file.</P>

<P><I>Filename </I>is the path and name of the log file that you want to debug.</P>

<P><B>-y</B> indicates that the next parameter is the symbol path.</P>

<P><I>Symbol path</I> is the path to the \SYMBOLS directory.</P>

<P>The following is an example of such a command:</P>

<P>c:\ windbg -z c:\windows\memory.dmp -y c:\windows\symbols</P><ol start=5></LI><LI>    To create a log of the debugging session, from the Options menu, choose Debug. </LI><LI>    In the Logfile section of the Debugger Options dialog box, you can:

<UL><LI>     Select the Open Automatically check box to have WinDbg open a log file whenever it starts. If you want to specify a path and name for the log file, type one in the Name text box.</LI><LI>     Select the Append check box to append new data to an existing log file. Otherwise, the file will be overwritten.</LI></UL><P>For more information on WinDbg settings, see the online Help file.</P></LI></OL><P></P>
<P></P></FONT></BODY></HTML>
