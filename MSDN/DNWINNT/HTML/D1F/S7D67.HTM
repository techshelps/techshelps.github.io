<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Specifying the Home Directory in a Logon Script or Batch File</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Specifying the Home Directory in a Logon Script or Batch File</H3><P>Windows&nbsp;NT provides three environment parameters you can use in a logon script or other batch file to specify the location of the home directory, or in Program Manager to specify the working directory of an application. Logon scripts are described later in this chapter. If a home directory has not been defined for the user, the default values are used as shown in the following table.</P>
<P><B>Table 3.1    Environment Parameters for Logon Scripts and Batch Files</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="140pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Parameter name</B></P></TD><TD VALIGN="TOP"><P><B>Definition</B></P></TD><TD VALIGN="TOP"><P><B>Default value</B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>%homedrive%</B></P></TD><TD VALIGN="TOP"><P>Drive where the home directory is located</P></TD><TD VALIGN="TOP"><P>Drive where the Windows&nbsp;NT system files are installed</P></TD></TR><TR><TD VALIGN="TOP"><P><B>%homepath%</B></P></TD><TD VALIGN="TOP"><P>Path name of the home directory</P></TD><TD VALIGN="TOP"><P>\USERS\DEFAULT</P></TD></TR><TR><TD VALIGN="TOP"><P><B>%homeshare%</B></P></TD><TD VALIGN="TOP"><P>UNC name of the shared directory containing the home directory, or a local or redirected drive letter</P></TD><TD VALIGN="TOP"><P>No default value</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>If the \USERS\DEFAULT directory does not exist on the drive specified by the <B>%homedrive%</B> parameter, the value of the <B>%homepath%</B> parameter is set by default to the \USERS directory on that drive. If the \USERS directory does not exist, the <B>%homepath%</B> parameter is set to the root directory specified by the <B>%homedrive%</B> parameter.</P>
<P>When the user opens a Command Prompt window, the default directory is the equivalent of <B>%homedrive%%homepath%</B>. If a user's home directory is specified on a remote computer and that computer is not available, the default directory of the Command Prompt on a Windows&nbsp;NT Workstation computer is the user's home directory on the local workstation. </P>
<P>You might also want to specify the working directory of each application as <B>%homedrive%%homepath%</B>. That way, all File Open and Save As dialog boxes default to the user's home directory.</P></FONT></BODY></HTML>
