<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automating Remote Log Ons Using SWITCH.INF Scripts</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Automating Remote Log Ons Using SWITCH.INF Scripts</H3><P>You can use the SWITCH.INF file (or PAD.INF on X.25 networks) to automate the log on process instead of using the manual RAS Terminal describe in the previous section, "Using RAS Terminal for Remote Log Ons." </P>
<H4><A NAME="sec0"></A>Creating Scripts for RAS</H4><P>SWITCH.INF is like a set of small batch files (scripts) contained in one file. A SWITCH.INF script has four elements: a section header, commands, responses, and comments.</P>
<P>Section headers divide SWITCH.INF into individual scripts. A section header starts a script. </P>
<P>Each line in a script is a command or a response. A command comes from the local RAS client. The commands you can issue from a Windows&nbsp;NT computer are listed below. </P>
<P>A response is from the remote device or computer. To write an automatic script, you must know the required responses for a specific device. The commands and responses must be in the exact order the remote device expects them. Branching statements, such as GOTO or IF, are not supported. The required sequence of commands and responses for a specific intermediary device should be in the documentation for the device, or if you are connecting to a commercial service, from the support staff of that service.</P>
<P>The SWITCH.INF file can contain scripts for each intermediary devices or online service that the RAS user will call. The scripts are activated by configuring Remote Access phonebook entries as described below in the section "Activating SWITCH.INF Scripts."</P>
<P><B>Note</B>   RAS permits you to embed your username and password only in clear text in the SWITCH.INF file. The ability to use macros that obtain your username and password from your own RAS phone book file (<I>username</I>.PBK) will be included in an upcoming, interim release of Windows&nbsp;NT. This functionality may be available by the time you are reading this. Check the RASPHONE.HLP file on your current system for the availability of these macros and for more information about creating scripts with SWITCH.INF.</P>
<H5><A NAME="sec1"></A>Section Headers</H5><P>A section header marks the beginning of a script for a certain intermediary device and must not exceed 31 characters. The section header is enclosed in square brackets. For example:</P>
<P><BR></P>
<pre><code><BR>[Route 66 Login]</code></pre>
<H5><A NAME="sec2"></A>Comment Lines</H5><P>Comment lines must have a semicolon (;) in column one and can appear anywhere in the file. Comment lines can contain information for those who maintain the SWITCH.INF file. For example:</P>
<P><BR></P>
<pre><code><BR>; This script was created by MariaG on September 29, 1995</code></pre>
<H5><A NAME="sec3"></A>Commands</H5><P>A command comes from the local computer.  A response comes from the remote device or computer.</P>
<P>You use the <B>COMMAND=</B> statement to send commands to the intermediary device. The <B>COMMAND=</B> statement can be used three ways, as described below:</P>
<P><B>COMMAND= </B></P>
<P><B>COMMAND=</B> by itself causes a 2-second delay, depending on CPU speed and whether or not caching software like SMARTDRV.DRV is running. Using <B>COMMAND= </B>as a delay is important because the intermediary device may not be able to process all commands if they are send at once.</P>
<P><B>COMMAND=</B><I>custom string</I></P>
<P>This sends <I>custom string</I> but will also cause a slight delay of several hundred milliseconds (depending on CPU speed and caching software installed) to give the intermediary device time to process <I>custom string</I> and prepare for the next command.</P>
<P><B>COMMAND=</B><I>custom string &lt;cr&gt;</I></P>
<P>This causes <I>custom string</I> to be sent instantaneously because of the carriage return (&lt;<I>cr</I>&gt;) at the end of the line.</P>
<P>You must consult the documentation from the remote device to determine the required strings to be send with the <B>COMMAND=</B> command.</P>
<H5><A NAME="sec4"></A>Response Related Keywords</H5><P>Each command line is followed by one or more response lines. You must consult the documentation from the remote device to determine the possible response strings.</P>
<P>In addition to the response strings you obtain for the remote device (or online service), response lines can contain one of the following keywords:</P>
<P><B>OK</B><I>=custom response string &lt;macro&gt;</I></P>
<P>The script continues to the next line.</P>
<P><B>CONNECT</B><B><I>=</I></B><I>custom response string  &lt;macro&gt;</I></P>
<P>Used at the end of a successful script.</P>
<P><B>ERROR</B><B><I>=</I></B><I>custom response string &lt;macro&gt;</I></P>
<P>Causes RAS to display a generic error message.</P>
<P><B>ERROR_DIAGNOSTICS=</B><I>custom response string </I><B>&lt;diagnostics&gt;</B></P>
<P>Causes RAS to display the specific cause for an error returned by the device. Not all devices report specific errors. Use <B>ERROR=</B> if you device does not return specific errors.</P>
<P><B>NoResponse</B></P>
<P>Used when no response will come from the remote device.</P>
<P>These commands are usually combined. <B>CONNECT=</B> is usually the last line executed unless an <B>ERROR</B> line follows it and the intermediary device reports an error.</P>
<P>RAS on the local computer always expects a response from the remote device and will wait until a response is received unless a <B>NoResponse</B> statement follows the <B>COMMAND=</B> line. If there is no statement for a response following a <B>COMMAND= </B>line, the <B>COMMAND=</B> line will execute and stop.</P>
<H5><A NAME="sec5"></A>Reserved Macro Words</H5><P>Reserved macro keyword are enclosed in angle brackets</P>
<P><B>&lt;cr&gt;</B></P>
<P>Inserts a carriage return.</P>
<P><B>&lt;lf&gt;</B></P>
<P>Inserts a line feed.</P>
<P><B>&lt;match&gt;</B></P>
<P>Reports a match if the string enclosed in quotation marks is found in the device response. For example, &lt;match&gt; "Smith" matches Jane Smith and John Smith III.</P>
<P><B>&lt;?&gt;</B></P>
<P>Inserts a wildcard character, for example, CO&lt;?&gt;&lt;?&gt;2 matches COOL2 or COAT2, but not COOL3.</P>
<P><B>&lt;hXX&gt; </B>(XX are hexadecimal digits)</P>
<P>Allows any hexadecimal character to appear in a string including the zero byte, &lt;h00&gt;.</P>
<P><B>&lt;ignore&gt;</B></P>
<P>Ignores the rest of a response from the macro on. For example, &lt;cr&gt;&lt;lf&gt;CONNECTV-&lt;ignore&gt; reads the following responses as the same: "crlfCONNECTV-1.1" and "crlfCONNECTV-2.3."</P>
<P><B>&lt;diagnostics&gt;</B></P>
<P>Passes specific error information from a device to RAS. This enables RAS to display the specific error to RAS users. Otherwise, a nonspecific error message will appear.</P>
<H4><A NAME="sec6"></A>Activating SWITCH.INF Scripts</H4><P>You can configure a RAS entry to execute a SWITCH.INF script before dialing, after dialing, or both. For example, to automate a remote log on to a remote host, you would first create the script in SWITCH.INF, and then configure the RAS entry to use the created script after dialing.</P>
<H4><A NAME="sec7"></A>To activate a script in Windows&nbsp;NT 3.5</H4><OL><LI>    In Remote Access, select the entry you want to connect to.</LI><LI>    Choose the Edit button.</LI><LI>    If the Security button is not visible, choose the Advanced button.</LI></OL><P>Choose the Security button. (In Windows&nbsp;NT 3.1 and Windows for Workgroups 3.11, this button is labeled Switch).</P>
<P>In the After Dialing box, select the name of the script. The section header in SWITCH.INF is what will appear as the name of the script. (In Windows&nbsp;NT 3.1 and Windows for Workgroups 3.11, this box is labeled Post-Connect).</P>
<OL start=4><LI>    Choose the OK button until you return to the main Remote Access Screen. </LI></OL><P>When you dial this entry, the selected script will execute after RAS dials and connects to the remote host.</P>
<H4><A NAME="sec8"></A>Troubleshooting Scripts Using DEVICE.LOG</H4><P>Windows&nbsp;NT 3.1 and 3.5 (and Windows for Workgroups 3.11) allow you to log all information passed between RAS, the modem, and the intermediate device, including errors reported by the intermediate device. This can allow you to find errors that prevent your scripts from working.</P>
<P>The DEVICE.LOG file is created by turning logging on in the registry. The DEVICE.LOG file is in the SYSTEM32\RAS subdirectory of your Windows&nbsp;NT directory.</P>
<H4><A NAME="sec9"></A>To create DEVICE.LOG</H4><OL start=1><LI>    Hang up any connections, and then exit from Remote Access.</LI><LI>    Start the Registry Editor by running the REGEDT32.EXE program.</LI><LI>    Go to HKEY_LOCAL_MACHINE, and then access the following key:<BR>\SYSTEM\CurrentControlSet\Services\RasMan\Parameters</LI></OL><P>Change the value of the Logging parameter to 1. When changed, the parameter should look like this:</P>
<P>Logging:REG_DWORD:0x1</P>
<P>Logging begins when you restart Remote Access or start the Remote Access Server service (if your computer is receiving calls). You do not need to shutdown and restart Windows&nbsp;NT.</P>
<P>If an error is encountered during script execution, execution halts. You must determine the problem by looking in DEVICE.LOG, make the necessary corrections to the script, and then restart RAS.</P>
<P>To turn logging on in Windows for Workgroups 3.11, edit the SYSTEM.INI file and in the [Remote Access] section add the line LOGGING=1. The text file DEVICE.LOG will be created automatically in the Windows directory when RAS is started.</P></FONT></BODY></HTML>
