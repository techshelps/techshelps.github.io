<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Restoring the DHCP Database</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Restoring the DHCP Database</H3><P>If you ascertain that the DHCP services are running on both the client and server computers but the error conditions described earlier persist, then the DHCP database is not available or has become corrupted. If a DHCP server fails for any reason, you can restore the database from the automatic backup files.</P>
<H4><A NAME="sec0"></A>To restore a DHCP database</H4><UL><LI>Restart the DHCP server using the procedure described earlier in this chapter. </LI></UL><P>If the DHCP database has become corrupted, it is automatically restored from the DHCP backup directory specified in the Registry, as described later in this chapter.</P>
<H4><A NAME="sec1"></A>To force the restoration of a DHCP database</H4><UL><LI>Set the value of <B>RestoreFlag</B> in the Registry to 1, and then restart the computer. </LI></UL><P>For information about this parameter, see "Registry Parameters for DHCP Servers" later in this chapter.</P>
<H4><A NAME="sec2"></A>To manually restore a DHCP database</H4><UL><LI>If the two restore methods described earlier in this chapter do not work, manually copy all DHCP database files from the backup directory to the \DHCP working directory. Then restart the Microsoft DHCP Server service.</LI></UL><P>If the backup database is also corrupted and you have an additional backup stored elsewhere, copy the most recent usable backup to the \DHCP working directory, and then restart the DHCP Server service.</P>
<P>Once you have restored the DHCP database using any of these methods, you need to reconcile the database to add entries for any leased addresses that are not in the restored database.</P>
<H4><A NAME="sec3"></A>To reconcile the DHCP database</H4><OL><LI>From the Scope menu, choose the Active Leases command.</LI><LI>In the Active Leases dialog box, choose the Reconcile button.</LI></OL></FONT></BODY></HTML>
