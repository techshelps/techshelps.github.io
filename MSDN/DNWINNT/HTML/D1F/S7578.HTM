<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logon Scripts</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Logon Scripts</H2><P>A logon script is a .BAT, .CMD, or .EXE file that is run automatically when a user logs on at a Windows&nbsp;NT network client running either Windows&nbsp;NT Workstation or MS-DOS. A logon script can automatically configure the user's environment to perform such tasks as making network connections, running applications, and setting environment variables upon startup. </P>
<P>User profiles can do everything that logon scripts can do, and more. However, there are several reasons to use logon scripts instead of, or in addition to, user profiles:</P>
<UL><LI>You have users that use MS-DOS workstations. User profiles work only on Windows&nbsp;NT workstations.</LI><LI>You want to manage part of the user's environment, such as network connections, without managing or dictating the entire environment.</LI><LI>You use only personal profiles, and you want to create common network connections for multiple users.</LI><LI>You already have LAN Manager 2.<I>x </I>running on your network, and you want to continue to use the logon scripts you created for that system.</LI><LI>Logon scripts are easier to create and maintain than user profiles.</LI></UL><P>You can assign a different logon script to each user or create logon scripts for use by multiple users. Whenever that user logs on, the logon script is downloaded and run. To assign a user a logon script, you designate the name of the logon script file in the user environment profile defined in User Manager on a Windows&nbsp;NT Workstation computer, or User Manager for Domains on a Windows&nbsp;NT Server computer. Specify only the filename, not the full pathname. </P>
<P>The default file extension for logon scripts is .CMD for client workstations running OS/2 2.1 and .BAT for all other client computers. You can define a different file type as the logon script by specifying the file extension. If the same logon script must run at both Intel-based and RISC-based workstations, it must be a .BAT file that runs the appropriate .EXE file or files on the workstation. Use the <B>%processor% </B>parameter in the logon script to run the appropriate .EXE file no matter which processor is being used. </P>
<P>You specify the path to the logon script using the Server option of Control Panel. For detailed information, see online Help. By default, Windows&nbsp;NT looks for logon scripts on the primary domain controller in the directory <I>systemroot</I>\SYSTEM32\REPL\IMPORT\SCRIPTS, where <I>systemroot </I>is the disk drive and directory in which Windows&nbsp;NT Server was installed. </P>
<P>If you use logon scripts in a domain with more than one domain controller, you should replicate the logon scripts to all the backup domain controllers. All servers in a domain can authorize logon requests, and the logon script for a user must be located on the server that approves the user's logon request. By replicating logon scripts, you ensure that logon scripts are always available to users, yet you still need to maintain only one copy of each script.</P>
<P>The filename for each user's logon script is defined with other user account information in User Manager for Domains. If you change the path to the logon scripts, this change is not replicated to the client workstations. The path must be updated manually in the Server option of Control Panel for each client computer. </P>
<P>To simplify the replication of logon scripts, Windows&nbsp;NT Server creates a \SCRIPTS subdirectory under both the default import and export directories used for replication. If you replicate logon scripts, you must be sure to use the Server option of Control panel or Server Manager to change the logon script path to <I>systemroot\</I>SYSTEM32\REPL\IMPORT\SCRIPTS or <I>systemroot\</I>SYSTEM32\REPL\EXPORT\ SCRIPTS, as appropriate. For more information, see the Server Manager chapter of the <I>Windows&nbsp;NT Server System Guide</I>.</P>
<P>When you use replicated logon scripts, you identify one of the domain controllers as the export server and all the others as import servers. The export server for the logon scripts is normally, but does not have to be, the primary domain controller (PDC).</P></FONT></BODY></HTML>
