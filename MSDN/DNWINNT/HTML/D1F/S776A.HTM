<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DNS Server</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>DNS Server </H3><P>The Domain Name System is a protocol and system used throughout the Internet. Its best-known function is mapping IP addresses to user-friendly names. A major advantage of this service is that the name of a computer can remain the same, even if the address changes. For example, suppose the FTP site provided by Microsoft had the IP address <B>11.101.54.134</B>. Most people would reach this computer by specifying <B>ftp.microsoft.com</B>. Besides being easier to remember, the name is more reliable. The numeric address could change for any of a number of reasons, but the name can always be used.</P>
<P>The IP address that matches this name is found by DNS servers on the Internet, using the following procedure. When the address name is specified, it is sent to the DNS server specified in the TCP/IP configuration of the computer sending the message. This can be a server on the local area network that is running the DNS Server service, or it can be one that your Internet service provider makes available. It is generally one that is physically nearby. If that DNS server cannot resolve the address, it passes it to the DNS server it deems most likely to be able to resolve the address. If that server can resolve the address it does so; otherwise, it responds with a referral to another server more likely to have the answer. This process is repeated as needed, resolving the address from the most general to the most specific, until the correct address is returned. This address is then used for communication with the target computer for the remainder of the session. The client software for DNS (called the <I>resolver</I>) is built into the TCP/IP software that ships with Windows&nbsp;NT. </P>
<P>In the extreme case, the queries must work down from the servers governing the root addresses to those on the individual sub-domains. However, DNS servers keep a record of recently requested addresses that lets them start further down the chain in most instances, or even to return the specific address immediately.</P>
<P>The Domain Name System is a complex topic, and this document does not attempt to explain it fully. An excellent book on the subject is <I>DNS and BIND</I> by Paul&nbsp;Albitz and Cricket Liu, published by O'Reilly and Associates. This book is a great introduction to the Domain Name System. Another good source of information is <I>Connecting to the Internet</I>, also published by O'Reilly and Associates. </P>
<H4><A NAME="sec0"></A>Determining Whether You Should Maintain a DNS Server</H4><P>In many cases, you do not need to maintain a DNS server. If you have a small network, or a single network rather than an internetwork, you will probably find it simpler and more effective to have the DNS client software query a nearby DNS server such as the one maintained by your Internet service provider. Most providers will maintain your domain information for a fee. </P>
<P>You will want to provide your own DNS server if you have your own domain on the Internet or if you want to access DNS from your LAN, rather than going through your Internet provider. </P>
<P>If you do maintain a DNS server, you will probably want to assign the task to at least two computers: a primary and a secondary name server. Data should be replicated from the primary name server to the secondary name server. This lets the Internet-wide DNS locate computers on your network even if one of the name servers is down. How often you schedule replication will depend on how often names change in your domain. Replicate often enough that changes are known to both servers. Excessive replication can tie up your network and servers unnecessarily.</P>
<H4><A NAME="sec1"></A>Preparing and Installing the DNS Server Service</H4><P>To use the DNS Server service, you must first create (or modify) the configuration files used by the service. Then install the service as you would any other service, through Services in Control Panel.</P>
<H5><A NAME="sec2"></A>Configuration</H5><P>You must have a set of configuration files in place for the DNS service to start. These files are:</P>
<UL><LI>A file named BOOT in the %systemroot%\system32\drivers\etc directory.</LI><LI>Database files specified by the BOOT file.</LI></UL><P>You can use files from a UNIX BIND installation at your site, or you can use the included files, which contain comments to help explain their format. The included files are:</P>
<UL><LI>BOOT</LI><LI>CACHE</LI><LI>ARPA-127.REV</LI><LI>ARPA-257.REV</LI><LI>PLACE.DOM </LI></UL><P>These files are used as follows:</P>
<H4><A NAME="sec3"></A>BOOT</H4><P>This file controls the startup behavior of the DNS server. The syntax of Windows&nbsp;NT DNS boot files is mostly compatible with that of BIND boot files. (Some out-of-date commands are not supported.) Commands must begin at the beginning of a line. No spaces can precede commands. Recognized commands and their syntax are as follows:</P>
<P>directory <I>pathname</I></P>
<P>Causes the server to read database files from the directory given by <I>pathname</I> instead of from the %systemroot%\system32\drivers\etc directory. This should be the first command in the file.</P>
<P>cache <I>filename</I></P>
<P>Specifies a file used to help the DNS service contact name servers for the root domain. This command and the file it refers to must be present. A cache file suitable for use on the Internet is provided. To get an up-to-date root name server cache file, connect via anonymous FTP to ftp.rs.internic.net and download the file /domain/named.root.</P>
<P>primary <I>domain filename</I> </P>
<P>Specifies a domain for which this name server is authoritative and a database file which contains the name information for that domain.</P>
<P>secondary <I>domain hostlist</I> [<I>filename</I>]</P>
<P>Specifies a domain for which this name server is authoritative, and a list of host's IP addresses from which to attempt downloading the zone information, rather than reading it from a file. The optional filename instructs the DNS service to maintain a backup copy of the downloaded information, in the specified file.</P>
<H4><A NAME="sec4"></A>CACHE </H4><P>This file contains host information that is needed to achieve usable DNS connectivity. For users on the Internet, the provided file generally should suffice. However, if there is a firewall (hardware or software that inhibits Internet traffic in one or both directions) between you and the Internet, you might be unable to reach Internet name servers. In this case, contact your Internet provider for a valid CACHE file.</P>
<H4><A NAME="sec5"></A>ARPA-127.REV </H4><P>A database file for the 127.in-addr.arpa. domain. This domain is used for reverse-lookups of IP numbers in the 127 network, such as localhost. This file should be usable as provided.</P>
<H4><A NAME="sec6"></A>ARPA-257.REV</H4><P>A fictitious database file for reverse lookups in the fictitious 257 network. This file must be edited and renamed before use on a production DNS server.</P>
<H4><A NAME="sec7"></A>PLACE.DOM </H4><P>A fictitious database file for looking up host names in the PLACE.DOM domain. This file must be edited and renamed before use on a production DNS server. The corresponding entry in the BOOT file must also be changed.</P>
<P>To use these files, you must change the database information to match your company's information. Note that information in ARPA-257.REV and PLACE.DOM is fictitious.</P>
<H5><A NAME="sec8"></A>Setting up WINS Name Resolution</H5><P>The Windows&nbsp;NT DNS Server service can use the WINS service to resolve the names of computers running Windows or Windows&nbsp;NT. For example, you might want to use a UNIX computer to connect to a computer that has a WINS name and a changing IP address (for example, an address acquired through the DHCP service). In this case, configure the UNIX computer's resolver to use the Windows&nbsp;NT computer running the DNS service, and make sure that the computer running the DNS service has a properly configured WINS Server service. Then, decide which domain the WINS names will belong in. For example, you might decide that the domain<B> nt.place.dom</B> is the name space in which all WINS computers will be named. You would then expect queries for <B>testcomputer.nt.place.dom</B> to be handled via WINS lookup, looking for the <B>TestComputer </B>computer.</P>
<P><B>Note   </B>Windows&nbsp;NT servers that run DNS and also provide WINS lookup must not be configured to use DNS for Windows name resolution. This setting is reached by choosing Network from the Control Panel, and going to the advanced configuration settings for the TCP/IP protocol. The checkbox "Use DNS for Windows Name Resolution" should be cleared.</P>
<H4><A NAME="sec9"></A>To provide WINS names through the DNS service</H4><OL><LI>Open the PLACE.DOM file with any text editor.</LI><LI>Find or create the "Start of Authority" (SOA) record for the domain in which you want to use WINS names. </LI></OL><P>The SOA record points to the computer that is the best source of information on computer names in the domain. The record can span more than one line if enclosed in parenthesis so that the program reads it as a single line.</P>
<OL start=3><LI>Create a new line under this line, consisting of the string <B>$WINS</B>. </LI></OL><P>Note that this must be on a line by itself and start in column 1. </P>
<OL start=4><LI>Save the file.</LI></OL><P>For an example, see the PLACE.DOM file.</P>
<P><B>Note   </B>Do not put the <B>$WINS</B> line in reverse-lookup (IN-ADDR.ARPA.) domains.</P>
<H5><A NAME="sec10"></A>Installing the Domain Name Server Service</H5><P>Before beginning to install the Domain Name Server service, be sure to read all the directions carefully.</P>
<H4><A NAME="sec11"></A>To install the Domain Name Server Service</H4><OL><LI>Install the TCP/IP protocol software on your computer if you have not done so already.</LI><LI>Run the INSTALL batch file from the directory that contains the DNS service files. </LI></OL><P>This batch file will complete the following tasks:</P>
<UL><LI>Copy the DNS Server service executable file to your system directory.</LI><LI>Configure the registry entries that control the DNS Server service.</LI><LI>Edit the files as described under "Configuration" earlier in this chapter, and make sure that the boot file and the database files are in the proper directories. </LI><LI>Open the Control Panel, and choose Services. </LI><LI>From the Services dialog, select DNS.</LI><LI>Choose Startup.</LI><LI>Choose Automatic Startup</LI><LI>Choose OK.</LI></UL><H5><A NAME="sec12"></A>Registering with the Parent Domain</H5><P>Once you have your DNS server or servers configured and installed, you need to register with the DNS server that is above you in the hierarchical naming structure of DNS. The parent system needs the name and addresses of your name servers, and will probably want other information such as the date that the domain will be available and the names and addresses of contact people. </P>
<P>If you are registering with a parent below the second level, check with the administrator of that system to find out what information you need to supply and how to submit it. </P>
<H4><A NAME="sec13"></A>Operating the DNS Service</H4><P>Once the DNS service is installed, there is very little work involved in maintaining it. As with all services, you will want to use Performance Monitor and the Event Log to make sure that everything is going well and that the computer resources available to the service are sufficient. </P>
<P>When you add addresses (for a computer or for a new sub-domain) to the Internet domain you are administering, you need to consider a few issues. The first consideration is the name you choose for the new address, which should be easy to remember, hard to misspell, and indicative of what the address represents.</P>
<P>Also, you will need to enter the new address in the reverse mapping file (which generally has a file type of .REV).</P>
<P>The remaining consideration is the "time to live" (TTL) value. When any DNS server receives an address, it retains the address for possible re-use, until the TTL for that address has expired. After that it must go to the next higher level of DNS server that it knows of, to get the address again. The TTL for each address is assigned by the administrator for that address. If your network is growing rapidly, you'll want to assign small TTLs so that information in the DNS system remains current. If your network is relatively stable, assign a larger TTL to reduce traffic and improve performance for those seeking addresses on your network.</P>
<P>The default TTL for your DNS server is specified in the SOA record in the BOOT file. If you want to specify a different TTL for a specific address, specify it in the record in the database file. The TTL appears before the word "in" toward the beginning of the line. This is the same convention as is used in BIND.</P>
<P>See the readme that accompanies the DNS Server files in this resource kit for troubleshooting suggestions.</P></FONT></BODY></HTML>
