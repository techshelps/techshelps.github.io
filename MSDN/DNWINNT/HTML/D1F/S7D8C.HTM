<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining Browser Roles</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Determining Browser Roles</H2><P>At certain times in each domain or workgroup, it is necessary to force an election of the master browser. This section explains how the election works.</P>
<P>When a Windows&nbsp;NT computer needs to force a master browser election, it notifies the other browsers on the system by broadcasting an <I>election datagram. </I>The election datagram contains the sending browser's election version and election criteria, as explained later in this section. The election version is a constant value that identifies the version of the browser election protocol. </P>
<P>When a browser receives an election datagram, the receiving browser examines the datagram and first compares the election version with its own. If the receiving browser has a higher election version than any other browser, it wins the election regardless of the election criteria. If the election versions are identical for both computers, the election criteria are compared.</P>
<P>The election criteria is a 4-byte hexadecimal value. If there is a tie on the basis of election version, the tie is broken by the value of the election criteria. </P>
<UL><LI>     If the browser has a higher election criteria than the issuer of the election datagram, the browser issues its own election datagram and enters the "election in progress" state.</LI><LI>     If the browser does not have a higher election criteria than the issuer of the election datagram, the browser attempts to determine which system is the new master browser.</LI></UL><P>Specific groups of bytes are masked and their values set according to the following list: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="185pt" VALIGN="TOP"><COL WIDTH="216pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Operating System Type:</P></TD><TD VALIGN="TOP"><P>0xFF000000</P></TD></TR><TR><TD VALIGN="TOP"><P>   Windows&nbsp;NT Server:</P></TD><TD VALIGN="TOP"><P>0x20000000</P></TD></TR><TR><TD VALIGN="TOP"><P>   Windows&nbsp;NT Workstation:</P></TD><TD VALIGN="TOP"><P>0x10000000</P></TD></TR><TR><TD VALIGN="TOP"><P>   Windows for Workgroups:</P></TD><TD VALIGN="TOP"><P>0x01000000</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Election Version:</P></TD><TD VALIGN="TOP"><P>0x00FFFF00</P></TD></TR><TR><TD VALIGN="TOP"><P>Per Version Criteria:</P></TD><TD VALIGN="TOP"><P>0x000000FF</P></TD></TR><TR><TD VALIGN="TOP"><P>   Primary Domain Controller:</P></TD><TD VALIGN="TOP"><P>0x00000080</P></TD></TR><TR><TD VALIGN="TOP"><P>   WINS client:</P></TD><TD VALIGN="TOP"><P>0x00000020</P></TD></TR><TR><TD VALIGN="TOP"><P>   Preferred Master browser</P></TD><TD VALIGN="TOP"><P>0x00000008</P></TD></TR><TR><TD VALIGN="TOP"><P>   Running Master browser:</P></TD><TD VALIGN="TOP"><P>0x00000004</P></TD></TR><TR><TD VALIGN="TOP"><P>   MaintainServerList=yes</P></TD><TD VALIGN="TOP"><P>0x00000002</P></TD></TR><TR><TD VALIGN="TOP"><P>   Running Backup Browser</P></TD><TD VALIGN="TOP"><P>0x00000001</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>If there is still a tie, the browser that has been running longest is the winner. If there is still a tie, the browser that has a lexically lower name is the winner. For example, a server with a name of A becomes master browser instead of a server with a name of B.</P>
<P>When a browser receives an election datagram indicating that it wins the election, the browser enters the <I>running election</I> state. In the running election state, the browser sends an election request after a delay based on the browser's current browser role:</P>
<UL><LI>     Master browsers delay for 200ms.</LI><LI>     Backup browsers delay for 400ms</LI><LI>     All other browsers delay for 800ms.</LI></UL><P>The browser broadcasts up to four election datagrams. If, after four election datagrams, no other browser has responded with an election criteria that would win the election, the browser becomes the master browser. If the browser receives an election datagram indicating that another system would win the election, the browser demotes itself to backup browser. To avoid unnecessary network traffic, a browser that has lost an election does not broadcast any unsent election datagrams. </P></FONT></BODY></HTML>
