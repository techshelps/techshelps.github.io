<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Other Connection Problems</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Troubleshooting Other Connection Problems</H3><P>In addition to <B>ping</B>, the other diagnostic utilities such as <B>netstat</B> and <B>nbtstat</B> can be used to find and resolve connection problems. Although this is not a complete list, these examples show how you might use these utilities to track down problems on the network.</P>
<H4><A NAME="sec0"></A>To determine the cause of Error 53 when connecting to a server</H4><OL><LI>If the computer is on the local subnet, confirm that the name is spelled correctly and that the target computer is running TCP/IP as well. If the computer is not on the local subnet, be sure that its name and IP address mapping are available in the LMHOSTS file or the WINS database. 
<P>Error 53 is returned if name resolution fails for a particular computer name. </P></LI><LI>If all TCP/IP elements appear to be installed properly, use <B>ping</B> with the remote computer to be sure that its TCP/IP software is working.</LI></OL><H4><A NAME="sec1"></A>To determine the cause of long connect times after adding to LMHOSTS</H4><UL><LI>Because this behavior can occur with a large LMHOSTS file with an entry at the end of the file, mark the entry in LMHOSTS as a preloaded entry by following the mapping with the #PRE tag. Then use the <B>nbtstat -R </B>command to update the local name cache immediately. 
<P>– Or –</P>

<P>Place the mapping higher in the LMHOSTS file. </P>

<P>As discussed in Chapter&nbsp;15, "Setting Up LMHOSTS," the LMHOSTS file is parsed sequentially to locate entries without the #PRE keyword. Therefore, you should place frequently used entries near the top of the file and place the #PRE entries near the bottom.</P></LI></UL><H4><A NAME="sec2"></A>To determine the cause of connection problems when specifying a server name</H4><UL><LI>Use the <B>nbtstat -n </B>command to determine what name the server registered on the network.
<P>The output of this command lists several names that the computer has registered. A name resembling the computer's computer name should be present. If not, try one of the other unique names displayed by <B>nbtstat</B>. </P>

<P>The <B>nbtstat</B> utility can also be used to display the cached entries for remote computers from either #PRE entries in LMHOSTS<B> </B>or recently resolved names. If the name the remote computers are using for the server is the same, and the other computers are on a remote subnet, be sure that they have the computer's mapping in their LMHOSTS files.</P></LI></UL><H4><A NAME="sec3"></A>To determine why only IP addresses work for connections to foreign systems but not host names</H4><OL><LI>Make sure that the appropriate HOSTS file and DNS setup have been configured for the computer by checking the host name resolution configuration using the Network icon in Control Panel and then choosing the DNS button in the TCP/IP Configuration dialog box.</LI><LI>If you are using a HOSTS file, make sure that the name of the remote computer is spelled the same and capitalized the same in the file and by the application using it. </LI><LI>If you are using DNS, be sure that the IP addresses of the DNS servers are correct and in the proper order. Use <B>ping</B> with the remote computer by typing both the host name and IP address to determine whether the host name is being resolved properly.</LI></OL><H4><A NAME="sec4"></A>To determine why a TCP/IP connection to a remote computer is not working properly</H4><UL><LI>Use the <B>netstat -a </B>command to show the status of all activity on TCP and UDP ports on the local computer. 
<P>The state of a good TCP connection is usually established with 0 bytes in the send and receive queues. If data is blocked in either queue or if the state is irregular, there is probably a problem with the connection. If not, you are probably experiencing network or application delay.</P></LI></UL></FONT></BODY></HTML>
