<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WOW Startup Control Entries</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>WOW Startup Control Entries</H3><P>The following values control startup parameters that affect MS-DOS – based applications and applications created for 16-bit Windows 3.1. The Registry path for these values is the following:</P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet<BR>    \Control\WOW</code></pre>
<P><B>Cmdline     REG_EXPAND_SZ     </B><I>Path and switches</I></P>
<P>Defines the command line that runs when an MS-DOS – based application runs under Windows&nbsp;NT. This command line continues to run until the related application is closed. The following switches can be included:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="48pt" VALIGN="TOP"><COL WIDTH="289pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Switch</P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD VALIGN="TOP"><P>-a</P></TD><TD VALIGN="TOP"><P>Specifies a command to pass to the VDM</P></TD></TR><TR><TD VALIGN="TOP"><P>-f</P></TD><TD VALIGN="TOP"><P>Specifies the directory to find NTVDM.EXE</P></TD></TR><TR><TD VALIGN="TOP"><P>-m</P></TD><TD VALIGN="TOP"><P>Hides the VDM console window</P></TD></TR><TR><TD VALIGN="TOP"><P>-w</P></TD><TD VALIGN="TOP"><P>Specifies the WOW VDM</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>Default:  %SystemRoot%\system32\ntvdm -f%SystemRoot%\system32 -a</P>
<P><B>KnownDLLs     REG_SZ     </B><I>DLL filenames</I></P>
<P>Defines a list of known DLLs for use by the WOW VDM that provide compatibility for non-Win32 applications. When the system searches for DLLs to load, it compares the requested DLL with those in the <B>KnownDLLs</B> list and then loads the matching DLL from the <I>SystemRoot</I>\SYSTEM32 directory. </P>
<P>If you want to replace a DLL, you must delete the name from this list, so that the system will search elsewhere for the DLL. The files USER.DLL, GDI.DLL, and SYSTEM.DRV are not included in this list, because these are required Windows&nbsp;NT system files and their location cannot be changed.</P>
<P>Default:  shell.dll commdlg.dll mmsystem.dll olecli.dll olesvr.dll ddeml.dll win87em.dll toolhelp.dll lanman.drv netapi.dll pmspl.dll wowdeb.exe</P>
<P><B>LPT_timeout     REG_SZ     </B><I>Number of seconds</I></P>
<P>Defines how many seconds after the LPT port has been used that Windows&nbsp;NT waits before grabbing the port, closing it, and flushing the output. This value should only be needed for MS-DOS -based applications that use BIOS and do not close the port.</P>
<P>Default:  15</P>
<P><B>Size     REG_SZ     </B><I>Number in megabytes</I></P>
<P>Defines the amount of memory to be given to each individual MS-DOS VDM. The default of 0 gives the VDM as much memory as Windows&nbsp;NT determines is necessary, depending upon the memory configuration. </P>
<P>To change this value, change the related value in the PIF file for the application.</P>
<P>Defaultl:  0</P>
<P><B>Wowcmdline     REG_EXPAND_SZ     </B><I>Path and switches</I></P>
<P>Defines the command line that runs when a 16-bit Windows-based application is started. The switches instruct Windows&nbsp;NT to start either an MS-DOS VDM or a WOW VDM. See the definitions for allowable switches under <B>Cmdline</B>.</P>
<P>Default:  %SystemRoot%\system32\ntvdm -m -w -f%SystemRoot%\system32   -a %SystemRoot%\system32\krnl386</P>
<P><B>Wowsize     REG_SZ     </B><I>Up to 16 megabytes</I></P>
<P>For RISC-based computers, defines the amount of memory provided in a VDM when a WOW session is started. This value is not used on <I>x</I>86-based computers, where Windows&nbsp;NT allocates the memory needed when it is asked for. </P>
<P>The default size chosen for a RISC-based computer depends on the amount of system memory on the computer. For each megabyte specified, the system uses 1.25&nbsp;MB, so setting <B>Wowsize</B> to 4&nbsp;MB causes the VDM to allocate 5&nbsp;MB, although applications can only use 4&nbsp;MB. You can override the following defaults:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="161pt" VALIGN="TOP"><COL WIDTH="173pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>System memory size</P></TD><TD VALIGN="TOP"><P>Default VDM size</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Less than 12 MB (small)</P></TD><TD VALIGN="TOP"><P>3 MB</P></TD></TR><TR><TD VALIGN="TOP"><P>12–16 MB (medium)</P></TD><TD VALIGN="TOP"><P>6 MB</P></TD></TR><TR><TD VALIGN="TOP"><P>More than 16 MB (large)</P></TD><TD VALIGN="TOP"><P>8 MB</P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>Caution</B>   Setting <B>Wowsize</B> to a value lower than 3 MB will cause most applications to fail.</P>
<P>Default:  Depends on RISC-based computer's system memory</P></FONT></BODY></HTML>
