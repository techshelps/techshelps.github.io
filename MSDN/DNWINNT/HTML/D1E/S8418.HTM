<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Messaging Application Program Interface (MAPI)</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Messaging Application Program Interface (MAPI)</H3><P>The Messaging Application Program Interface (MAPI) is a set of functions that developers can use to create Mail-enabled applications. Mail includes a subset of 12 functions called <I>Simple MAPI</I>, which enable developers to send, address, and receive messages from within Windows-based applications.</P>
<P>With Simple MAPI functions, developers can easily add the power of messaging to any Windows-based application. Simple MAPI supports the standard interface for simple integration of a Windows-based application with Mail.</P>
<P>All of the Simple MAPI functions are designed to be called from C or C++ programs, but they can also be called from high-level languages, such as Visual Basic&reg;, Actor&reg;, Smalltalk&reg;, and ObjectVision&reg;. Simple MAPI functions can also be called from applications with macro languages that can call a DLL. Two examples of these are Microsoft Excel for Windows or Microsoft Word for Windows.</P>
<P>Some Simple MAPI functions include a user interface (a dialog box) but can also be called without generating an interface. The seamless integration with Mail is convenient for applications such as word processors and spreadsheets, which manipulate files that users may want to exchange through Mail. The style of the user interface is not defined by Simple MAPI, so you can design your own.</P>
<P>An application developer can incorporate Mail functionality into their application by calling the MAPI functions. For example, if an application creates data files that need to be distributed to other users in a workgroup, the application developer can use the <B>MapiSendDocuments()</B> function to create a mail message and to send the data files as an attachment to the message. Sending mail messages is fully controlled from the application and the MAPI support library (MAPI32.DLL). The user doesn't need to have the Mail program running to do this.</P>
<P>In this case, one function call is all that is required. The <B>MapiSendDocuments()</B> function creates and initializes a message and supplies all the standard Mail dialog boxes for the user to send messages. The function can be compiled into  the native code of the application, or if the application includes a macro facility that can link to a DLL, the developer can integrate the DLL as an added macro command.</P>
<P>Simple MAPI consists of the following functions:</P>
<P>Table 8.1    Simple MAPI Functions</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="94pt" VALIGN="TOP"><COL WIDTH="251pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Function</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiAddress()</P></TD><TD VALIGN="TOP"><P>Addresses a Mail message.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiDeleteMail()</P></TD><TD VALIGN="TOP"><P>Deletes a Mail message.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiDetails()</P></TD><TD VALIGN="TOP"><P>Displays a recipient details dialog box.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiFindNext()</P></TD><TD VALIGN="TOP"><P>Returns the ID of the next (or first) Mail message of a specified type.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiFreeBuffer()</P></TD><TD VALIGN="TOP"><P>Frees memory allocated by the messaging system.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiLogoff()</P></TD><TD VALIGN="TOP"><P>Ends a session with the messaging system.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiLogon()</P></TD><TD VALIGN="TOP"><P>Begins a session with the messaging system.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiReadMail()</P></TD><TD VALIGN="TOP"><P>Reads a Mail message.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiResolveName()</P></TD><TD VALIGN="TOP"><P>Displays a dialog box to resolve an ambiguous recipient name.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiSaveMail()</P></TD><TD VALIGN="TOP"><P>Saves a Mail message.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiSendDocuments()</P></TD><TD VALIGN="TOP"><P>Sends a standard Mail message.</P></TD></TR><TR><TD VALIGN="TOP"><P>MapiSendMail()</P></TD><TD VALIGN="TOP"><P>Sends a Mail message.</P></TD></TR></TBODY></TABLE>
<P><BR></P></FONT></BODY></HTML>
