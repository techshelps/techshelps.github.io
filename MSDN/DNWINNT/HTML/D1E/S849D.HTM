<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Controlling Multiport Serial I/O Cards</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Controlling Multiport Serial I/O Cards</H3><P>The Microsoft serial driver can be used to control many <I>dumb</I> multiport serial cards. <I>Dumb</I> indicates that the control includes no onboard processor. Each port of a multiport board has a separate subkey under the CurrentControlSet\Services\Serial subkey in the Registry. In each of these subkeys, you must add values for DosDevices, Interrupt, InterruptStatus, PortAddress, and PortIndex, because these are not detected by the Hardware Detector. (For descriptions and ranges for these values, see "Disk, Serial, and Parallel Port Entries" in Chapter&nbsp;14, "Registry Value Entries.") </P>
<P>For example, if you have a four-port COMTROL Hostess 550 board configured to use address 0x500 with an interrupt of 0x2, the values in the Registry would be as follows: </P>
<H4><A NAME="sec0"></A>Serial2 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x500<BR>Interrupt = REG_DWORD 2<BR>DosDevices = REG_SZ COM3<BR>InterruptStatus = REG_DWORD 0x507<BR>PortIndex = REG_DWORD 1</code></pre>
<H4><A NAME="sec1"></A>Serial3 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x508<BR>Interrupt = REG_DWORD 2<BR>DosDevices = REG_SZ COM4<BR>InterruptStatus = REG_DWORD 0x507<BR>PortIndex = REG_DWORD 2</code></pre>
<H4><A NAME="sec2"></A>Serial4 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x510<BR>Interrupt = REG_DWORD 2<BR>DosDevices = REG_SZ COM5<BR>InterruptStatus = REG_DWORD 0x507<BR>PortIndex = REG_DWORD 3</code></pre>
<H4><A NAME="sec3"></A>Serial5 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x518<BR>Interrupt = REG_DWORD 2<BR>DosDevices = REG_SZ COM6<BR>InterruptStatus = REG_DWORD 0x507<BR>PortIndex = REG_DWORD 4</code></pre>
<P>Certain multiport boards, such as Digiboard non-MCA bus cards, use a different scheme to determine which port is interrupting. These boards should include the Indexed value entry in the configuration data for each port under its subkey in CurrentControlSet\Services\Serial. This entry indicates that the board uses an indexed interrupt notification scheme as opposed to a bitmapped method. </P>
<P>For example, if you have an eight-port Digiboard communications board configured to be at address 0x100 with an interrupt of 0x3, the values in the Registry would be as follows: </P>
<H4><A NAME="sec4"></A>Serial2 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x100<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM3<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 1<BR></code></pre>
<H4><A NAME="sec5"></A>Serial3 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x108<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM4<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 2<BR></code></pre>
<H4><A NAME="sec6"></A>Serial4 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x110<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM5<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 3<BR></code></pre>
<H4><A NAME="sec7"></A>Serial5 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x118<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM6<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 4</code></pre>
<H4><A NAME="sec8"></A>Serial6 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x120<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM7<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 5<BR></code></pre>
<H4><A NAME="sec9"></A>Serial7 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x128<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM8<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 6<BR></code></pre>
<H4><A NAME="sec10"></A>Serial8 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x130<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM9<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 7<BR></code></pre>
<H4><A NAME="sec11"></A>Serial9 subkey:</H4><P><BR></P>
<pre><code>PortAddress = REG_DWORD 0x138<BR>Interrupt = REG_DWORD 3<BR>DosDevices = REG_SZ COM10<BR>InterruptStatus = REG_DWORD 0x140<BR>Indexed = REG_DWORD 1<BR>PortIndex = REG_DWORD 8</code></pre></FONT></BODY></HTML>
