<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UPS Service Entries</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>UPS Service Entries</H3><P>The Registry does not contain information for the UPS service until the user checks the Uninterruptible Power Supply Is Installed checkbox in the UPS dialog box and then chooses the OK button. Changes to settings should be made by using the UPS icon in Control Panel.</P>
<P>The UPS service will not start unless the UPS subkey is present in the Registry, all parameters are present in the Registry, and all values are within the correct range. If any of these elements are missing or in error, a message announces that the UPS service is not correctly configured. All corrections can be made using the UPS icon in Control Panel.</P>
<P>The UPS parameters remain in the Registry if the user uninstalls UPS.</P>
<P>The path for the UPS subkey is the following:</P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\UPS</code></pre>
<P><B>BatteryLife    REG_DWORD     </B><I>2 to 720 minutes</I></P>
<P>Specifies the life of the UPS backup battery when fully charged.</P>
<P>Default:  2 (minutes)</P>
<P><B>CommandFile    REG_EXPAND_SZ     </B><I>Filename</I></P>
<P>Specifies the name of a command file to execute immediately before shutting down.</P>
<P>Default:  (empty)</P>
<P><B>FirstMessageDelay    REG_DWORD     </B><I>0 to 120 seconds</I></P>
<P>Specifies the number of seconds between initial power failure and the first message sent to the users. If power is restored within the <B>FirstMessageDelay</B> time, no message is sent, although the event is logged.</P>
<P>Default:  5 (seconds)</P>
<P><B>MessageInterval    REG_DWORD     </B><I>5 to 300 seconds</I></P>
<P>Specifies the number of seconds between messages sent to users to inform them of power failure.</P>
<P>Default:  120 (seconds)</P>
<P><B>Options    REG_DWORD     </B><I>Value</I></P>
<P>Defines the bit mask for messages related to options in the UPS dialog box, as the following:</P>
<P>Installed    0x00000001<BR>PowerFailSignal    0x00000002<BR>LowBatterySignal    0x00000004<BR>CanTurnOff    0x00000008<BR>PosSigOnPowerFail    0x00000010<BR>PosSigOnLowBattery    0x00000020<BR>PosSigShutOff    0x00000040<BR>CommandFile    0x00000080</P>
<P>There are no default values in the registry for <B>Options</B>. They are set in the UPS application of Control Panel. For example, if you select only Power Failure Signal, Low Battery Signal At Least 2 Minutes Before Shutdown, and Remote UPS Shutdown, then the registry value will be 0xf. However, if you also change all UPS Interface Voltages from negative (default) to positive, then the registry value will be 0x7f.</P>
<P><B>Port    REG_SZ     </B><I>Port name</I></P>
<P>Specifies the name of the serial port the UPS is connected to.</P>
<P>Default:  COM1:</P>
<P><B>RechargeRate    REG_DWORD     </B><I>1 to 250 minutes</I></P>
<P>Specifies the recharge rate of the UPS backup battery.</P>
<P>Default:  100 (minutes)</P></FONT></BODY></HTML>
