<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Any Program to Any Program Manager Group</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Adding Any Program to Any Program Manager Group</H3><P>You can have Setup add items to any program group, not just the Startup group. This example shows how the Terra Flora administrator added the file, TERRA.HLP, (with the TERRA.ICO icon) to the Terra Flora Help Program group. The steps shown here can be used to add any program to any Program Manager group.</P>
<P>The first step in this process is to make sure the files are installed. In this case, the Terra Flora administrator adds the files TERRA.HLP and TERRA.ICO to Setup as described earlier in "Adding a File to the Windows&nbsp;NT Installation."</P>
<P>Next, if you are adding programs to a new program group, you must create that group, as described earlier in "Adding a New Program Manager Group."</P>
<P>Finally, you need to modify the PARTIAL.INF file. For example, the Terra Flora administrator makes a number of changes to the PARTIAL.INF file to ensure that TERRA.HLP is added to the Terra Flora Help program group.</P>
<P>The first change that the administrator makes is to the [PartialDestinationVars] section. In the following example, the new line is added to the end of the section:</P>
<P><BR></P>
<pre><code>[PartialDestinationVars]
    ReadmeDest          = $(!STF_WINDOWSPATH)
    AccessoriesDest     = $(!STF_WINDOWSSYSPATH)
    GamesDest           = $(!STF_WINDOWSSYSPATH)
    SaversDest          = $(!STF_WINDOWSSYSPATH)
    WallpapersDest      = $(!STF_WINDOWSPATH)
    MainDest            = $(!STF_WINDOWSSYSPATH)
    AdminToolsDest    = $(!STF_WINDOWSSYSPATH)
    StartupDest    = $(!STF_WINDOWSSYSPATH)
    TerraFloraDest     = $(!STF_WINDOWSSYSPATH)</code></pre>
<P>The [PartialDestinationVars] section indicates where the files for the specific components will be installed in the system. $(!STF_WINDOWSPATH) means to install the files in the <I>SystemRoot </I>directory. $(!STF_WINDOWSSYSPATH) means to install the files in the <I>SystemRoot</I>\SYSTEM32 directory. The name in the left column matches the name of the group listed in the [ProgmanGroups] section, followed in the [ProgmanGroups] section by the text "Dest".</P>
<P>Next, the Terra Flora administrator adds a line to the [InstallProgramGroups] section. In the following example, the new line is added to the end of the section:</P>
<P><BR></P>
<pre><code>[InstallProgramGroups]
    set Groups = ^(ProgmanGroups, 1)
    set MainToInstall = ^(MainItems$(!STF_PRODUCT)$(!STF_PLATFORM), 1)
    set AdminToolsToInstall = ^(AdminToolsItems$(!STF_PRODUCT), 1)
    set TerraFloraToInstall = ^(TerraFloraItems,1)</code></pre>
<P>The [InstallProgramGroups] section specifies which group items will be installed in their respective groups. The item in the left column is the name of the group as mentioned in the [ProgmanGroups] section, followed in the [ProgmanGroups] section by the text "ToInstall". The text in the right column is the name of the section where the program items are listed.</P>
<P>The administrator adds a new section, [TerraFloraItems], to the PARTIAL.INF file to specify the new program group, with the new program item specified in that section. In the following example the new section appears after the [MainItemsWinntI386] section:</P>
<P><BR></P>
<pre><code>[MainItemsWinntI386]
    FileManager
    ControlPanel
    ...
    readme

[TerraFloraItems]
    TerraFloraHelp</code></pre>
<P>The [TerraFloraItems] section lists the key names of the items that will be installed in the TerraFlora group.</P>
<P>Finally, the administrator creates the [TerraFloraItemsENG] section of the PARTIAL.INF file. In this section the name of the file that is represented by the name TerraFloraHelp is specified, using this format:</P>
<P><I>keyname = item description, command line, command line parameters, icon resource file, icon offset</I></P>
<P>The new section looks similar to the following:</P>
<P><BR></P>
<pre><code>[TerraFloraItemsENG]
    TerraFloraHelp = "Terra Flora Help",WINHLP32.EXE,"WINHLP32.EXE "$(!STF_WINDOWSSYSPATH)"\TERAFLOR.HLP","TERAFLOR.ICO",0</code></pre></FONT></BODY></HTML>
