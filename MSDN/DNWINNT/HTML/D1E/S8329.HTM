<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Process IDs and Handle IDs of Audit Events</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Process IDs and Handle IDs of Audit Events</H3><P>One of the most important aspects of security is determining who is actually behind operations of security interest, such as file writes or security policy change. With the client-server model of Windows, user account identification can be rather tricky. Although a thread that requests access to a resource is identified by the user ID, the thread may be impersonating someone else. In this case, it would be misleading to log events by user ID and may not be very useful in finding the perpetrator in the case of a security breach.</P>
<P>To prevent this problem, there are two levels of subject identification used in Windows&nbsp;NT auditing and the security log—the user ID (also called the primary ID) and the impersonation ID (also called the client ID), as applicable. These two IDs show security administrators who are performing auditable actions. </P>
<P>In some cases, however, a security administrator wants to see what is happening with each process. To meet this need, auditing information also includes a subject's process ID where possible.</P>
<P>When process tracking is enabled (through the Audit Policy dialog box of User Manager), audit messages are generated each time a new process is created. This information can be correlated with specific audit messages to see not only which user account is being used to perform auditable actions, but also which program was run. </P>
<P>Many audit events also include a handle ID, enabling the event to be associated with future events. For example, when a file is opened, the audit information indicates the handle ID assigned. When the handle is closed, another audit event with the same handle ID is generated. With this information, you can determine exactly how long the file remained open. This could be useful, for example, when you want to assess damage following a security breach.</P>
<P>The following list shows some of the information that Windows&nbsp;NT tracks within a process's access token. This information also is used for auditing.</P>
<UL><LI>     The security ID of the user account used to log on</LI><LI>     The group security IDs and corresponding attributes of groups to which the user is assigned membership</LI><LI>     The names of the privileges assigned to and used by the user, and their corresponding attributes</LI><LI>     Authentication ID, assigned when the user logs on</LI></UL></FONT></BODY></HTML>
