<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Print Providers</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Print Providers</H3><P>The Windows&nbsp;NT local print provider is used to send print jobs to a print device attached locally to the Windows&nbsp;NT-based computer. Remote print providers are used to send print jobs to other computers on the network.</P>
<H4><A NAME="sec0"></A>Local Print Provider</H4><P>A local print provider is used when a Windows&nbsp;NT print server is in charge of printing a job and the output goes to a local device, such as a parallel port or a network-attached printer.</P>
<P>The local print provider, LOCALSPL.DLL, provides the following functions:</P>
<UL><LI>     Writes the job to disk as a spool file, and then writes job information to disk as a shadow file. For more information on these files, see the following section, "Spool Files and Shadow Files."</LI><LI>     Passes control of the job to whichever print processor is responsible for that job's data type, so that the print processor can modify the print job, if necessary. When the print processor finishes it returns control to the local print provider.</LI><LI>     Adds separator pages to the job, if the user has requested them in Print Manager. For more information, see "Separator Pages," later in this chapter.</LI><LI>     Uses the destination printer name to look up the port that the job must be sent to, and pass control to whichever print monitor is responsible for that port.</LI></UL><P><img src="xrgr14a.gif"></P>
<P><img src="xrgr14.gif"></P>
<P>Figure 6.4    The Local Print Provider (LOCALSPL.DLL)</P>
<P>Most of the local print provider's options are configurable in Print Manager, by using the Details button from the Printer Properties dialog box. These options are documented thoroughly in online help, but you should be sure to note some options new to Windows&nbsp;NT in version 3.5:</P>
<UL><LI>     You can select whether you want the spooler to hold mismatched jobs. If you do, the spooler makes sure that incoming jobs from locally-run Windows-based applications are requesting features that are currently available. For instance, suppose that you have configured the printer driver assuming Letter-sized paper in the print device. Without the Hold Mismatched Jos option, if an application requests Legal-sized paper, the printer pauses indefinitely, waiting for a human operator to load a Legal paper cassette. With this option enabled, the local print provider holds this job, allowing correctly-configured jobs to print, until a Legal cassette is loaded.</LI><LI>     You can specify whether to keep spool files after the print device accepts the whole print job. This situation is often undesirable, because spool files will accumulate on disk. However, it is possible that between the time that the print device accepts the end of the job and the time it completes printing the job, the print device could be turned off. If you have a very important print job, or one that would be very difficult to recreate, deselecting this option lets you keep the spool file on disk until you're sure the print device has finished printing.</LI><LI>     You can tell the print provider whether it should send data to the print device while the spool file is being written to disk, or wait for the whole spool file to be written before starting to send the job to the print device. Sending data to the device while the spool files is being written can improve printing speed on large jobs.</LI><LI>     You can decide which job to send to the print device first, if two or more are spooling at the same time. You can select whether the job that starts spooling first will print first regardless of how long each job takes to finish spooling, or whether the job that <I>finishes </I>spooling will print first.</LI></UL><H5><A NAME="sec1"></A>Spool Files and Shadow Files</H5><P>For each spooled job, the local print provider creates two files:</P>
<UL><LI>     A spool file, which contains the print job itself, without any administrative information about the job. Spool files have an .SPL extension.</LI><LI>     A shadow file, which contains information such as the name of the destination printer, the job's priority, the name of the user who sent the job, and so on. Shadow files have an .SHD extension</LI></UL><P>If the print server is shut down while print jobs are spooled and waiting to print, the spool and shadow files remain on the disk and are used to restart the print job when the print server is restarted. The local print provider uses the information in the shadow file to determine how to print the print job, and the content of the job is contained in the spool file.</P>
<P>The spool file and shadow file for a job are kept in the same directory on disk. By default, these files are written to \<I>systemroot</I>\SYSTEM32\SPOOL\PRINTERS. However, you can set a new default location or override the default location on a per-printer basis, by manually editing the Registry.  </P>
<H4><A NAME="sec2"></A>To set a new default location by manually editing the Registry</H4><OL><LI>    Start the Registry Editor (REGEDT32.EXE) and find the following key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\ Control\Print\Printers. </LI><LI>    Add a DefaultSpoolDirectory setting and as its value provide the full path to the spool directory that all printers should use by default.
<P>The change in the Registry takes effect after you stop and restart the spooler service.</P></LI></OL><H4><A NAME="sec3"></A>To override the default location for one specific printer</H4><OL><LI>    Start the Registry Editor (REGEDT32.EXE), and find the following key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print<BR>\Printers. </LI><LI>    Find the key for the printer. </LI><LI>    Add a new SpoolDirectory setting, and as its value provide the path to the spool directory that this printer should use.
<P>The change in the Registry takes effect after you stop and restart the Spooler service.</P></LI></OL><H4><A NAME="sec4"></A>Remote Print Providers</H4><P>Remote print providers are used when a Windows&nbsp;NT-based computer sends a print job to another print server. This usually happens when your Windows&nbsp;NT-based computer acts as a workstation on the network, but it can also occur if your Windows&nbsp;NT-based computer acts as a print server which forwards incoming jobs to another print server.</P>
<P>Windows&nbsp;NT supplies two remote print providers.</P>
<UL><LI>     WIN32SPL.DLL transfers jobs to Windows Network print servers (such as print servers running Windows&nbsp;NT or Windows for Workgroups).</LI><LI>     NWPROVAU.DLL transfers jobs to Novell NetWare print servers. </LI></UL><P>Generally, if you are sending a print job to another print server, you have established the printer in Print Manager using the Connect To option. When a client sends a job to such a printer, the router polls each of the remote print providers in turn, in effect asking each one whether it recognizes the printer name. The router passes control to the first network provider that recognizes the printer name. You can set the polling order by using the Network icon in the Control Panel window. After choosing this icon, choose the Networks button. In the Network Providers Search Order dialog box, choose the Print Provider option in the Show Providers For box. Then select the name of a network and use the Up and Down buttons to change the polling order.</P>
<P><B>Note</B>   Neither of these remote print providers performs spooling. When you send a print job using these remote print providers, the job does not spool locally.</P>
<H5><A NAME="sec5"></A>Windows Network Print Provider</H5><P>If the Windows network print provider, WIN32SPL.DLL, recognizes the printer name, then this print provider makes further decisions based on the type of print server to which the job is going. If the print server is running Windows&nbsp;NT, then WIN32SPL.DLL makes remote procedure calls (RPC) to the router component of the remote server. The remote server's router receives the print job over the network, and then begins processing the job as if one of its own local clients had submitted the job.</P>
<P>If the remote print server is not running Windows&nbsp;NT, then WIN32SPL.DLL contacts the local Windows Network redirector, which forwards the job over the network to the downlevel server. The downlevel server is then responsible for printing the job.</P>
<P>The functions provided by the Windows network print provider are illustrated in the following figure.</P>
<P><img src="xrgr18a.gif"></P>
<P><img src="xrgr18.gif"></P>
<P>Figure 6.5    The Windows Network Print Provider (WIN32SPL.DLL)</P>
<H5><A NAME="sec6"></A>NetWare Print Provider</H5><P>If the NetWare print provider (NWPROVAU.DLL) recognizes the server name when polled by the router, it takes control of the print job. The NetWare print provider then communicates with the NetWare workstation service, NWWKS.DLL, which in turn passes control to the NetWare redirector. The NetWare redirector then transmits the print job over the network to the NetWare print server. This process is illustrated in the following figure.</P>
<P><img src="xrgr17a.gif"></P>
<P><img src="xrgr17.gif"></P>
<P>Figure 6.6    How the NetWare Print Provider Interacts with Other Components</P></FONT></BODY></HTML>
