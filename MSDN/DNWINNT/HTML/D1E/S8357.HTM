<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the TXTSETUP.SIF File to Update the Registry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Using the TXTSETUP.SIF File to Update the Registry</H3><P>You can specify that certain values or keys in the Software and Default template hives, and in the "Current Control Set" key of the System template hive, always be copied to an existing Registry (even if it means overwriting existing values) by specifying them in the [KeysToAdd] section of the TXTSETUP.SIF file. </P>
<P>In addition, you can use the [KeysToAdd] section together with the [Values.<I>section</I>] section to create new keys or values, or to change values, without editing the template hives directly.</P>
<P>The choice of whether to add a key or value by editing a hive or by adding to the TXTSETUP.SIF file depends on the extent of the changes you want to make, whether you want existing values to be overwritten, and often on personal preference. However, you should be comfortable with editing the Registry before you use either method. In either case, you are using Setup to change the Registry; both the Registry and the Setup files are unforgiving of errors. The Registry Editor does not understand or recognize errors in syntax or semantics.</P>
<P>The sections in the TXTSETUP.SIF file that you are most likely to change in order to have Setup change registry values are listed in the following table:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="242pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Section</P></TD><TD VALIGN="TOP"><P>Used to</P></TD></TR><TR><TD VALIGN="TOP"><P>[KeysToAdd]</P></TD><TD VALIGN="TOP"><P>Add or change keys, or add or change values under keys. </P></TD></TR><TR><TD VALIGN="TOP"><P>[Values.<I>section</I>]</P></TD><TD VALIGN="TOP"><P>Specify values for specific keys listed in the [KeysToAdd] section.</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec0"></A>The [KeysToAdd] Section</H4><P>The lines in the [KeysToAdd] section specify that a key, or one or more values in a key, be written to an existing Registry. If the key or value already exists, it will be overwritten. The keys and/or values can be read from a template hive, or from a [values.<I>section</I>] section in the TXTSETUP.SIF file if one is specified. The format for lines in this section is as follows:</P>
<P><I>hive</I>, "<I>key</I>"[, values.<I>section</I>]</P>
<P>where h<I>ive</I> is the template hive from which the key should be copied. <I>Key </I>specifies the key in the specified hive. (It is enclosed in double-quotes.) Values<I>.Section</I> points to the section in the TXTSETUP.SIF file that lists the values to be added to this key. If you use this parameter, the information is taken from the TXTSETUP.SIF file rather than from the template hive. If you omit this parameter, Setup looks for the information in the template hive.</P>
<H5><A NAME="sec1"></A>Examples</H5><P>The following line specifies that everything in the PBrush32 key under Classes in the Software template hive be added to the registry:</P>
<P><BR></P>
<pre><code>Software, "Classes\PBrush32"</code></pre>
<P>Normally, since this key is in the Software hive, it would be copied to an existing Registry only if the key did not already exist. By specifying it here, you ensure that the entire key and any subkeys will be written to the Registry, even if it involves overwriting an existing key by that name.</P>
<P>The following line, with the associated [Values.<I>section</I>] section, specifies a value (no wallpaper) for the Control Panel\Desktop key in the Default hive:</P>
<P><BR></P>
<pre><code>Default, "Control Panel\Desktop",  Values.Desktop
[Values.Desktop]
  Wallpaper,                 REG_SZ,    (None)</code></pre>
<P>No other values in this key will be affected.</P>
<H4><A NAME="sec2"></A>The [Values.<I>section</I>] Section</H4><P>This section specifies the values assigned to a key that was specified in the [KeysToAdd] section. You can list as many values as you want. The format is as follows:</P>
<P><I>name</I>[, <I>type</I>, <I>value</I>]</P>
<P>where <I>name</I> is the name of the key to which you want to add the value. If the key does not already exist in the Registry, it will be created. (The hive in which the key is placed is specified in the line in the [KeysToAdd] section that points to this [Value.<I>section</I>] section.) If only <I>name</I> is entered, that entire key, including any subkeys, will be copied to the existing Registry. If a key by that name already exists it will be overwritten. <I>Type</I> is the value type, and can be any of the following:</P>
<UL><LI>     REG_SZ</LI><LI>     REG_EXPAND_SZ</LI><LI>     REG_MULTI_SZ</LI><LI>     REG_BINARY</LI><LI>     REG_DWORD</LI><LI>     REG_BINARY_DWORD</LI></UL><P><I>Value</I> is the value you want to assign to this entry. For types REG_SZ, REG_EXPAND_SZ, and REG_MULTI_SZ, the value is a string and must be enclosed in double quote marks.</P></FONT></BODY></HTML>
