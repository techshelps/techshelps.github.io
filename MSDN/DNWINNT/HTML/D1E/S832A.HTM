<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Security Event Examples</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Security Event Examples</H3><P>As described earlier, you can track several categories of security events. This section provides examples for most of these categories. This set of examples does not constitute a strategy for using the auditing capabilities of Windows&nbsp;NT; they merely serve as an introduction to help you interpret these events when you enable auditing for your Windows&nbsp;NT system. </P>
<H4><A NAME="sec0"></A>Example 1: Tracking File and Object Access</H4><P>In this example, auditing is enabled as follows (assuming you are logged on as  an administrator):</P>
<UL><LI>     From File Manager, select the .TXT file, and then choose Auditing from the Security menu. Assign Full Control permission to the user accessing the .TXT file and enable auditing for Success and Failure of Read and Write events.</LI><LI>     From User Manager, choose Audit from the Policies menu. Then enable auditing for Success and Failure of File and Object Access and Process Tracking. </LI></UL><P>From File Manager, the user double-clicks the .TXT file (which is associated with Notepad) and then writes some data to the file, saves it, and closes the file.</P>
<P>This results in audit events, as shown below:</P>
<P><img src="XRGU19.gif"></P>
<P>From this view of the security log, you get a quick summary of security-related events that occurred. Double-click the first event to examine the details. (For example, details of this first event are shown in the Event Detail box.)</P>
<P>The data that needs to be interpreted is listed in the Description list box. The following table summarizes the audited events for this example, in the order  they occurred. </P>
<P>Table 2.1    Security Events for File Access Example</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Event ID and description</P></TD><TD VALIGN="TOP"><P>Analysis</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 560: Object Open<BR>Event 561: Handle Allocated<BR>Event 562: Handle Closed</P></TD><TD VALIGN="TOP"><P>In this sequence of events, Windows&nbsp;NT is doing some internal checks, such as checking to see if the file exists and checking to see that there is no sharing violation.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 592: A New Process Has Been Created<BR>Event 560: Object Open<BR>Event 561: Handle Allocated<BR>Event 562: Handle Closed</P></TD><TD VALIGN="TOP"><P>In this series of events, a new process is created for NOTEPAD.EXE. This process opens the .TXT file for reading. Next, the process allocates, then closes, a handle to the file. Note that from the security log it is clear that Notepad does not keep an open handle to the file; it simply keeps a copy of the file in memory.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 560: Object Open<BR>Event 561: Handle Allocated<BR>Event 562: Handle Closed</P></TD><TD VALIGN="TOP"><P>The process opens the file for reading and writing, and since the event is a successful audit, new data is written to the file. Next, the handle is allocated for the open file, then closed.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 593: A Process Has Exited</P></TD><TD VALIGN="TOP"><P>This event indicates that the process, whose process ID relates to NOTEPAD.EXE, has ended.</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec1"></A>Example 2: Use of User Rights</H4><P>In this example, auditing is enabled by using User Manager to enable auditing  for Success and Failure of Use of User Rights.</P>
<P>When the user tries to change the system time, only one event is generated,  as shown below.</P>
<P><img src="XRGU20.gif"></P>
<P>This event indicates that a privileged service was called and that a server component named Kernel has called an audit check on the primary username of the user. The audit type is a Success Audit, meaning that the user successfully exercised the right to use the SeSystemtimePrivilege (that is, the right to change the system time).</P>
<H4><A NAME="sec2"></A>Example 3: User and Group Management</H4><P>In this example, a new user account is added to the user accounts database. Auditing is enabled in User Manager by specifying both Success and Failure of User and Group Management. This generates four audit events, as shown below:</P>
<P><img src="XRGU21.gif"></P>
<P>Table 2.2    Security Events for Added User Account</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="231pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Event ID and description</P></TD><TD VALIGN="TOP"><P>Analysis</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 632: Global Group Member Added<BR>Event 624: User Account Created</P></TD><TD VALIGN="TOP"><P>A new security ID (member) is created and added to the group represented by the target account ID. This is a default global group Domain Users. At this point, the security ID does not have a username allocated to it.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 642: User Account Changed</P></TD><TD VALIGN="TOP"><P>This event indicates that the account name of the security ID represented by the Target Account ID has been changed to the new user's.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 636: Local Group Member Added</P></TD><TD VALIGN="TOP"><P>This event indicates that the account represented by the new user's security ID is created. The new user is added to the local group represented the security ID under Target Account ID (Users).</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec3"></A>Example 4: Restart, Shutdown and System</H4><P>In this example, auditing is enabled in User Manager for both Success and Failure of Restart, Shutdown and System.</P>
<P>In this example, seven events were generated. Note, however, that the number of events generated is related to the number of trusted systems that you start when the system is restarted. This number may vary if you replicate this scenario on your own Windows&nbsp;NT computer.</P>
<P><img src="XRGU22.gif"></P>
<P>Table 2.3    Security Events for System Startup</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="291pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Event ID and description</P></TD><TD VALIGN="TOP"><P>Analysis</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 512: Windows&nbsp;NT   is starting up.</P></TD><TD VALIGN="TOP"><P>Identifies the date and time the system started.</P></TD></TR><TR><TD VALIGN="TOP"><P>Event 514: Authentication  package loaded</P></TD><TD VALIGN="TOP"><P>The description of this event says: </P>
<P>An authentication package has been loaded by the Local Security Authority. This authentication package will be used to authenticate logon attempts.<BR>Authentication Package Name: msv 1_0</P>
<P>This is the standard authentication package shipped with Windows&nbsp;NT. </P></TD></TR><TR><TD VALIGN="TOP"><P>Events 515: Trusted  logon process</P></TD><TD VALIGN="TOP"><P>The description for each of these events says:</P>
<P>A trusted logon process has registered with the Local Security Authority. This logon process will be trusted to submit logon requests.</P>
<P>The logon process name is listed for each of these events, as follows:</P>
<P>  Winlogon<BR>  Service Control Manager<BR>  LAN Manager Workstation Service<BR>  LAN Manager Server<BR>  LAN Manager Redirector</P>
<P>Each of these events is a successful audit in the category  of system event. These events indicate that the respective logon processes have registered themselves with the Local Security Authority and are now trusted to submit logon requests.</P></TD></TR></TBODY></TABLE>
<P><BR></P></FONT></BODY></HTML>
