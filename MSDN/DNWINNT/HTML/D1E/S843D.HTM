<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Registry Hierarchy</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>The Registry Hierarchy</H3><P>The Registry is structured as a set of four subtrees of keys that contain per-computer and per-user databases. The per-computer information includes information about hardware and software installed on the specific computer. The per-user information includes the information in user profiles, such as desktop settings, individual preferences for certain software, and personal printer and network settings. In versions of Windows for MS-DOS, per-computer information was saved in the WIN.INI and SYSTEM.INI files, but it was not possible to save separate information for individual users.</P>
<P>In the Windows&nbsp;NT Registry, each individual key can contain data items called <I>value entries</I> and can also contain additional <I>subkeys.</I> In the Registry structure, keys are analogous to directories, and the value entries are analogous to files.</P>
<P><img src="XRGF04.gif"></P>
<P>Figure 10.3    The Four Subtrees in the Windows&nbsp;NT Registry</P>
<P>The following table identifies and defines these four subtrees.</P>
<P>Table 10.1 Registry Subtrees</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="117pt" VALIGN="TOP"><COL WIDTH="229pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Root key name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE</P></TD><TD VALIGN="TOP"><P>Contains information about the local computer system, including hardware and operating system data such as bus type, system memory, device drivers, and startup control data.</P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_CLASSES_ROOT</P></TD><TD VALIGN="TOP"><P>Contains object linking and embedding (OLE) and file-class association data (equivalent to the Registry in Windows for MS-DOS).</P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_CURRENT_USER</P></TD><TD VALIGN="TOP"><P>Contains the user profile for the user who is currently logged on, including environment variables, personal program groups, desktop settings, network connections, printers, and application preferences. </P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_USERS</P></TD><TD VALIGN="TOP"><P>Contains all actively loaded user&nbsp;profiles, including HKEY_CURRENT_USER, which always refers to a&nbsp;child of HKEY_USERS, and the default profile. Users who are accessing a server&nbsp;remotely do not have profiles under this key on&nbsp;the server; their profiles are loaded into the Registry on their own computers.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>Each of these subtrees is described in detail later in this chapter. Each of the root key names begins with "HKEY_" to indicate to software developers that this is a <I>handle</I> that can be used by a program. A handle is a value used to uniquely identify a resource so that a program can access it. </P></FONT></BODY></HTML>
