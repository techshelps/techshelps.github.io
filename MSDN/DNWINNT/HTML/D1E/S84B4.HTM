<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How .INI Files Are Mapped to the Registry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>How .INI Files Are Mapped to the Registry</H2><P>If you install Windows&nbsp;NT as an upgrade over Windows 3.1, all the settings from various initialization files are copied into the Registry, including CONTROL.INI, PROGMAN.INI, SYSTEM.INI, WIN.INI, WINFILE.INI, and others. You can see where the Windows initialization files are mapped in&nbsp;the&nbsp;Registry by viewing the subkeys and value entries under this path:</P>
<P><BR></P>
<pre><code>HKEY_Local_Machine\SOFTWARE\Microsoft<BR>    \Windows&nbsp;NT\CurrentVersion\IniFileMapping</code></pre>
<P>When you install an application created for 16-bit Microsoft Windows, the application's setup program creates its own .INI file or creates entries for the WIN.INI or SYSTEM.INI file in the same way that it does for any versions of Windows for MS-DOS. These entries are not updated in the Registry, because these applications do not know how to access the Windows&nbsp;NT Registry. For this reason, basic SYSTEM.INI, WIN.INI, and WINFILE.INI files appear in the <I>SystemRoot</I> directory in Windows&nbsp;NT.</P>
<P>If a Windows-based application tries to write to WIN.INI, SYSTEM.INI, or any other section listed in the IniFileMapping key, and if the application uses the Windows&nbsp;NT Registry APIs, the information is stored in the Registry. If the application writes to other sections of the .INI file or tries to open the .INI file directly without using the Windows&nbsp;NT Registry APIs, the information is saved in an .INI file.</P>
<P>To find mapping information in the HKEY_LOCAL_MACHINE\Software key, the system looks up the <I>filename.ext</I> of the initialization file. If a match is found, it looks under the mapped key for the specific application name and a variable name, and if necessary it continues to look for keys whose value entries are the variable names. If no mapping for either the application name or filename is found, the system looks for an .INI file to read and write its contents. </P>
<P>Tables 13.1 through 13.3 show where system settings are saved in the Registry in comparison to initialization files used with Windows 3.1 for MS-DOS. </P>
<P>In the entries in the IniFileMapping key and in Tables 13.1 through 13.3, the following symbols are used:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="274pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Symbol</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>! </P></TD><TD VALIGN="TOP"><P>Forces all writes to go to both the Registry and to the .INI file on disk.</P></TD></TR><TR><TD VALIGN="TOP"><P># </P></TD><TD VALIGN="TOP"><P>Causes the Registry value to be set to the value in the Windows 3.1 .INI file whenever a new user logs in for the first time after Setup, if Windows&nbsp;NT was installed on a computer that had Windows 3.1 already installed.</P></TD></TR><TR><TD VALIGN="TOP"><P>@ </P></TD><TD VALIGN="TOP"><P>Prevents any reads from going to the .INI file on disk if the requested data is not found in the Registry.</P></TD></TR><TR><TD VALIGN="TOP"><P>USR </P></TD><TD VALIGN="TOP"><P>Stands for HKEY_CURRENT_USER, and the text after the prefix is relative to that key.</P></TD></TR><TR><TD VALIGN="TOP"><P>SYS </P></TD><TD VALIGN="TOP"><P>Stands for HKEY_LOCAL_MACHINE\Software, and the text after the prefix is relative to that key.</P></TD></TR></TBODY></TABLE>
<P><BR></P></FONT></BODY></HTML>
