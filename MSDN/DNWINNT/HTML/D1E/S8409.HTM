<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interface Between the Mail Client and Postoffice</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Interface Between the Mail Client and Postoffice</H2><P>Mail has a modular architecture. While some of the modules comprise the user interface and postoffice, most modules make up the interface between the Mail client and the Mail postoffice. Figure 8.3 shows the key components that make up this interface.</P>
<P><img src="XRGD02.gif"></P>
<P>Figure 8.3    Components of the Interface Between Mail Clients and Server</P>
<H3><A NAME="sec0"></A>Mail Spooler and Mail Transport</H3><P>When you have a message to send, the <I>spooler</I> (MAILSP32.EXE) notifies the <I>transport</I> (MSSFS32.DLL) to move the message from your Outbox to the postoffice. When a message arrives for you at the postoffice, the spooler notifies the transport to deliver the message to your Inbox.</P>
<P>The primary job of the spooler is to parcel out system idle time to the transport. This enables the transport to transfer messages in a timely manner but without interfering with the work you really want to do in the foreground. The spooler provides a safety net for the transport by retrying any operations that fail.</P>
<P>The spooler also resolves address book entries, adds message recipients to the personal address book, generates nondelivery reports, checks for new mail, and deletes mail from the server.</P>
<H3><A NAME="sec1"></A>Mail Session Manager</H3><P>The <I>Mail Session Manager</I> (MAILM32.DLL) validates users' identities and manages connections with the Message Store, directory, and transport. It is the component that enables you to work even when the Mail server is unavailable (for example, when you work offline). Mail continues to work with the resources that are available at your computer and automatically connects to the server's resources when the server is available again. Maintaining the security of messages across transitions from offline to online and back is another feature of the Mail Session Manager.</P>
<H3><A NAME="sec2"></A>Name Service</H3><P>The <I>Name Service</I> (MAILM32.DLL) manages functions related to browsing and filtering lists of names. At the user interface, the Name Service is apparent whenever you browse file folders, specify search criteria, or ask for a recipient's name to be checked.</P>
<P>With the exception of the personal address book, the Name Service treats the directories it uses as read-only lists. Addresses, as used in Mail, consist of the following parts:</P>
<UL><LI>     Display name, which is usually the full descriptive name of a person, group, or resource. This is the name you most often see in the user interface.</LI><LI>     Mail address type, which helps the transport route mail and provides the syntax of the mail address to the Mail client.</LI><LI>     Mail address, which is the part actually used to identify the routing destination for a message.</LI></UL><H3><A NAME="sec3"></A>Notification Engine</H3><P>When you receive new mail, the <I>Notification Engine</I> (STORE32.DLL) lets you know that the mail has arrived.</P>
<P>The Notification Engine also works with the Session Manager when you browse or filter messages. Folder management and message searches use the services of the Notification Engine. </P>
<P>For example, you can have multiple windows viewing the same folder. If you delete a message from the folder in one of the windows, it automatically disappears from the others because each window waits for notification of events like messages being deleted.</P>
<P>When a new message arrives and is written to the <I>Message Store</I> by the spooler, the Inbox viewer is updated by the Notification Engine. When you place a message in your Outbox, the Notification Engine alerts the spooler that there is a message to deliver to the postoffice.</P></FONT></BODY></HTML>
