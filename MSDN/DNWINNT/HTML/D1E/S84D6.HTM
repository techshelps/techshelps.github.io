<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CurrentControlSet\Services Subkeys</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>CurrentControlSet\Services Subkeys</H3><P>The Services<I> </I>subkeys under the following Registry path contain parameters for the device drivers, file system drivers, and Win32 service drivers:</P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services</code></pre>
<P>The name of each Services subkey is the name of the service, which is also the root of the name of the file from which the service is loaded. For example, for the serial mouse, the service name and Services<I> </I>subkey name is Sermouse. The file from which this is loaded is <I>SystemRoot</I>\SYSTEM32\DRIVERS\SERMOUSE.SYS.</P>
<P>All&nbsp;service names are defined under HKEY_LOCAL_MACHINE\SOFTWARE. The names of the Windows&nbsp;NT built-in network services such as the Alerter and Browser services are defined under the Microsoft\Windows&nbsp;NT\CurrentVersion subkey in the Software area of the Registry.</P>
<P>Each Services subkey can have additional subkeys. Many services have a Linkage subkey, which provides data for binding network components, as described in "Linkage Subkey Entries for Network Components," later in this chapter. Many services also have a Parameters subkey that contains entries defined by the service with values for configuring the specific service.</P>
<P>Values for Parameters subkeys and other service-specific entries are described in these sections in this chapter:</P>
<UL><LI>     Registry Entries for LPDSVC</LI><LI>     Registry Entries for Network Adapter Cards</LI><LI>     Registry Entries for Device Drivers</LI><LI>     Registry Entries for Network Services</LI></UL><P>The following standard value entries appear for each Services subkey:</P>
<P><B>ErrorControl     REG_DWORD     </B><I>Error constant</I></P>
<P>Specifies the level of error control for the service as follows:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="85pt" VALIGN="TOP"><COL WIDTH="251pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Error control level</P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD VALIGN="TOP"><P>0x3 (Critical)</P></TD><TD VALIGN="TOP"><P>Fail the attempted system startup. If the startup is not using the LastKnownGood control set, switch to LastKnownGood. If the startup attempt is using LastKnownGood, run a bug-check routine. </P></TD></TR><TR><TD VALIGN="TOP"><P>0x2 (Severe)</P></TD><TD VALIGN="TOP"><P>If the startup is not using the LastKnownGood control set, switch to LastKnownGood. If the startup attempt is using LastKnownGood, continue on in case of error.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x1 (Normal)</P></TD><TD VALIGN="TOP"><P>If the driver fails to load or initialize, startup should proceed, but display a warning.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x0 (Ignore)</P></TD><TD VALIGN="TOP"><P>If the driver fails to load or initialize, start up proceeds. No warning is displayed.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>Group     REG_DWORD     </B><I>Group name</I></P>
<P>Specifies the name of the group of which the particular service is a member. </P>
<P>Default:  (null)</P>
<P><B>DependOnGroup     REG_DWORD     </B><I>Group name</I></P>
<P>Specifies zero or more group names. If one or more groups is listed, at least one service from the named group must be loaded before this service is loaded. </P>
<P>Default:  (empty)</P>
<P><B>DependOnService     REG_DWORD     </B><I>Service name</I></P>
<P>Specifies zero or more Services subkey names. If a service is listed here, that named service must be loaded before this service is loaded. </P>
<P>Default:  (empty)</P>
<P><B>ImagePath     REG_DWORD     </B><I>Path and filename</I></P>
<P>Specifies a path name. For adapters, this value is ignored.</P>
<P>Default:  For a driver, <I>systemroot</I><B>\</B>SYSTEM32\DRIVERS\<I>driverName</I>.SYS. For a service, <I>systemroot</I><B>\</B>SYSTEM32\<I>serviceName</I>.EXE (where <I>driverName</I> or <I>serviceName</I> is the same as the related Services subkey name)</P>
<P><B>ObjectName     REG_DWORD     </B><I>Object name</I></P>
<P>Specifies an object name. If <B>Type</B> specifies a WIN32 Service, this name is the account name that the service will use to log on when the service runs. If <B>Type</B> specifies a Kernel driver or file system driver, this name is the Windows&nbsp;NT driver object name that the I/O Manager uses to load the device driver. </P>
<P>Default:  <I>subkeyName</I> </P>
<P><B>Start     REG_DWORD     </B><I>Start constant</I></P>
<P>Specifies the starting values for the service as follows:  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="76pt" VALIGN="TOP"><COL WIDTH="64pt" VALIGN="TOP"><COL WIDTH="196pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Start  type</P></TD><TD VALIGN="TOP"><P>Loader </P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD VALIGN="TOP"><P>0x0 <BR>(Boot)</P></TD><TD VALIGN="TOP"><P>Kernel</P></TD><TD VALIGN="TOP"><P>Represents a part of the driver stack for the boot (startup) volume and must therefore be loaded by the Boot Loader.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x1 <BR>(System)</P></TD><TD VALIGN="TOP"><P>I/O subsystem</P></TD><TD VALIGN="TOP"><P>Represents a driver to be loaded at Kernel initialization.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x2 <BR>(Auto load)</P></TD><TD VALIGN="TOP"><P>Service Control Manager</P></TD><TD VALIGN="TOP"><P>To be loaded or started automatically for all startups, regardless of service type.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x3 <BR>(Load on demand)</P></TD><TD VALIGN="TOP"><P>Service Control Manager</P></TD><TD VALIGN="TOP"><P>Available, regardless of type, but will not be started until the user starts it (for example, by using the Devices icon in Control Panel).</P></TD></TR><TR><TD VALIGN="TOP"><P>0x4 <BR>(Disabled)</P></TD><TD VALIGN="TOP"><P>Service Control Manager</P></TD><TD VALIGN="TOP"><P>Not to be started under any conditions.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>The <B>Start</B> value is ignored for adapters. If <B>Type </B>is a Win32 Service value (as described below), the <B>Start</B> value must specify an Auto, Demand, or Disabled value.</P>
<P><B>Tag     REG_DWORD     </B></P>
<P>Specifies a load order within a given group. The value of <B>Tag</B> specifies a number that is unique within the group of which the service is a member. The related <I>GroupName</I> entry under the Control\GroupOrderList subkey specifies a&nbsp;list of ltags, in load order.</P>
<P>For example, the following services that are members of the Primary Disk group could have these values:  <B>Tag</B>=4 for the Abiosdsk subkey, <B>Tag</B>=2 for Atdisk, <B>Tag</B>=1 for Cpqarray, and <B>Tag</B>=3 for Floppy. The value for <B>Primary Disk</B> under the GroupOrderList subkey will use these <B>Tag</B> values to specify the defined order for loading these services. As another example, each SCSI miniport service has a unique <B>Tag</B> value that is used as an identifier in the <B>SCSI miniport</B> value under the GroupOrderList subkey to define which SCSI adapter to load first.</P>
<P><B>Type     REG_DWORD     </B><I>Type constant</I></P>
<P>Specifies the type of service as follows:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="260pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Service type</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>0x1</P></TD><TD VALIGN="TOP"><P>A Kernel device driver. </P></TD></TR><TR><TD VALIGN="TOP"><P>0x2 </P></TD><TD VALIGN="TOP"><P>File system driver, which is also a Kernel device driver. </P></TD></TR><TR><TD VALIGN="TOP"><P>0x4 </P></TD><TD VALIGN="TOP"><P>A set of arguments for an adapter.</P></TD></TR><TR><TD VALIGN="TOP"><P>0x10 </P></TD><TD VALIGN="TOP"><P>A Win32 program that can be started by the Service Controller and that obeys the service control protocol. This type of Win32 service runs in a process by itself. </P></TD></TR><TR><TD VALIGN="TOP"><P>0x20 </P></TD><TD VALIGN="TOP"><P>A Win32 service that can share a process with other Win32 services. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P>For example, when you start Windows&nbsp;NT, the Boot Loader scans the Registry for drivers with a <B>Start</B> value of 0 (which indicates that these drivers should be loaded but not initialized before the Kernel) and a <B>Type</B> value of 0x1 (which indicates a Kernel device driver such as a hard disk or other low-level hardware device driver). The drivers are then loaded into memory in the order specified as the <B>List</B> value in CurrentControlSet\Control\ServiceGroupOrder.</P></FONT></BODY></HTML>
