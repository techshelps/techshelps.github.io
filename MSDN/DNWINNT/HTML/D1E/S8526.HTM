<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Custom Messages Entries for Mail</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Custom Messages Entries for Mail</H3><P>This subkey is similar in many ways to the Custom Commands subkey. Each entry specifies a custom message type to be installed into a Mail menu at run-time. </P>
<P>These entries can appear both in the Microsoft Mail key and in the SHARED32.INI file in the directory defined by the <B>SharedExtensionsDir</B> entry under the Microsoft Mail key. </P>
<P>This is the Registry path for this subkey:</P>
<P><BR></P>
<pre><code>HKEY_CURRENT_USER\Software\Microsoft\Mail\Custom Messages</code></pre>
<P>The Custom Messages subkey can contain one or more of the following entries. </P>
<P><I>class</I><B>      REG_SZ</B></P>
<P>Specifies a string uniquely identifying the message type. Mail places this string in messages and calls custom message DLLs based on its value. Each entry is in the following format:</P>
<P><BR></P>
<pre><code><I>class </I><B><I>=</I></B><I> version;menu;name;position;DLL name;command;operation map;<BR>    status text;Help file;help context;</I></code></pre>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="265pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Value</P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD VALIGN="TOP"><P><I>version</I></P></TD><TD VALIGN="TOP"><P>The version of Mail in which the custom message is compatible.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>menu</I></P></TD><TD VALIGN="TOP"><P>The menu where the custom command for the message type is to be added, such as File or Mail.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>name</I></P></TD><TD VALIGN="TOP"><P>The command name to appear on the menu. Include an ampersand just before the letter that is to serve as an ALT+k<I>ey</I> accelerator.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>position</I></P></TD><TD VALIGN="TOP"><P>The zero-relative position within its menu at which the command is to appear. A value of –1 places the command at the end of the menu.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>DLL name</I></P></TD><TD VALIGN="TOP"><P>Name or path of the DLL in which the custom command resides.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>command</I></P></TD><TD VALIGN="TOP"><P>Command string passed as one of the parameters to the DLL entry point for the command.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>operation map</I></P></TD><TD VALIGN="TOP"><P>Sequence of up to 16 digits. Each can be 0, 1, or 2, where 0 indicates that Mail is to perform its standard operation on the custom message. 1 indicates that the DLL is to be called to handle the operation. 2 indicates that the operation is to be completely disabled. Currently eight operations are defined; the rest are reserved and must be zero. In the following list, 0 is the leftmost digit:</P>
<P>0      Compose (menu command defined in this entry)<BR>1      File.Open<BR>2      Mail.Reply<BR>3      Mail.Reply to All<BR>4      Mail.Forward<BR>5      File.Print<BR>6      File.Save as<BR>7      Arrival of new mail</P></TD></TR><TR><TD VALIGN="TOP"><P><I>status text</I></P></TD><TD VALIGN="TOP"><P>Text to be displayed in the Mail status bar when the user highlights the command in the menu.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>Help file</I></P></TD><TD VALIGN="TOP"><P>Windows&nbsp;NT Help file to be invoked when the user presses F1 while the command is selected. The specified filename is passed to the Windows&nbsp;NT Help program. (optional)</P></TD></TR><TR><TD VALIGN="TOP"><P><I>help context</I></P></TD><TD VALIGN="TOP"><P>Passed to the Windows&nbsp;NT Help program along with the Help filename. Use –1 (Help file index) if there is no specific entry in the Help file for this command. (optional)</P></TD></TR><TR><TD VALIGN="TOP"><P><I>&lt;ExtsDir&gt;</I></P></TD><TD VALIGN="TOP"><P>A special token that can appear within certain fields. Expands to the value of <B>SharedExtensionsDir</B> in the Microsoft Mail key. Used to refer to DLLs that are installed in a shared extensions directory on the network. Valid for the <I>DLL name, command, </I>and<I> Help file</I> fields.</P></TD></TR></TBODY></TABLE>
<P><BR></P></FONT></BODY></HTML>
