<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Disk, Serial, and Parallel Port Entries</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Disk, Serial, and Parallel Port Entries</H3><P>This section provides general information about the Description entries for adapters in the Hardware subtree. Then specific information is presented about the DeviceMap subkey entries for AtDisk and for serial and parallel ports. Finally, Services subkey entries for parallel and serial ports are described, including specific entries for multiport serial I/O cards.</P>
<H4><A NAME="sec0"></A>Description Entries for Adapters</H4><P>The following shows the path for all <I>MultifunctionAdapter</I> entries:</P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\HARDWARE\Description\System<BR>    \<I>MultifunctionAdapter</I>\0\<I>ControllerName\</I>0. </code></pre>
<P>The entries in this portion of the Registry contain data discovered by the Hardware Recognizer (NTDETECT.COM) or provided from the ARC database that describes controllers for hard disks, display devices, the keyboard, pointing devices, and serial and parallel ports. Administrators cannot usefully modify entries in the Hardware subtree. This data is volatile (destroyed and recreated each time the system starts) and is useful only for informational purposes. You can use WinMSD to view this information in a more usable format.</P>
<P>Each subkey contains information in the following format:</P>
<P><B>Component Information     REG_BINARY     </B><I>System-defined</I></P>
<P>Identifies version information plus other data for the associated subkey entry.</P>
<P><B>Configuration Data     REG_UNKNOWN     </B><I>System-defined</I> </P>
<P>Contains binary information related to the hardware component, such as I/O port addresses and IRQ number. This entry is not present if no such data is available for a particular subkey.</P>
<P><B>Identifier     REG_SZ     </B><I>Device type name</I></P>
<P>Contains the name of a component, if specified.</P>
<P>The following samples from the <I>MultifunctionAdapter</I> subkeys describe a system that has a keyboard, a Microsoft InPort&reg; bus mouse or Microsoft Mouse Port mouse, and a Microsoft serial mouse (on COM1), all connected to the ISA bus. This sample is for informational purposes only, since these subkeys are volatile and are therefore recreated each time you start Windows&nbsp;NT. </P>
<P>In the following example, the <B>Identifier </B>value specifies the keyboard type name, which is typically PCAT_ENHANCED to indicate a 101/102-key enhanced keyboard. The keyboard type name is mainly informational, since the actual keyboard type and subtype are retrieved from the keyboard-specific data in <B>Configuration Data</B>.</P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\HARDWARE\Description\System\MultifunctionAdapter<BR>    \0\KeyboardController\0\KeyboardPeripheral\0    
Configuration Data : REG_UNKNOWN : <I>Device data (keyboard type, subtype)</I>
Identifier : REG_SZ : PCAT_ENHANCED</code></pre>
<P>The following two examples show typical <B>Identifier</B> values for two basic types of pointer devices. For the first example, the <B>Identifier</B> value for the pointer type name can also be MICROSOFT PS2 MOUSE (also known as the Mouse Port mouse) or MICROSOFT BUS MOUSE under this subkey: </P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\HARDWARE\Description\System\MultifunctionAdapter<BR>    \0\PointerController\0\PointerPeripheral\0    
Identifier : REG_SZ : MICROSOFT INPORT MOUSE</code></pre>
<P>This example shows a typical entry for a serial mouse, under this subkey:</P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\HARDWARE\Description\System\MultifunctionAdapter<BR>    \0\SerialController\0\PointerPeripheral\0    
Identifier : REG_SZ : MICROSOFT SERIAL MOUSE</code></pre>
<H4><A NAME="sec1"></A>DeviceMap Subkey Entries for AtDisk </H4><P>AtDisk is the driver for non-SCSI hard disk controllers on <I>x</I>86-based computers.</P>
<P><B>Note</B>   The Abiosdsk driver has no Hardware key and no parameters that users can set under CurrentControlSet\Services.</P>
<P>The following Registry path can contain subkeys named Controller<I>x</I>, where <I>x</I> starts at 0 and increases:</P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap\AtDisk </code></pre>
<P>These Controller<I>x </I>subkeys are created for each non-SCSI hard disk controller on the system. As with all hardware data, these subkeys are volatile and so are recreated each time you start the system.</P>
<P>Under the Controller<I>x</I> subkeys are subkeys named Disk<I>y</I>, where <I>y</I> starts at 0 (zero) and increases. These subkeys are created for each actual disk controlled by the particular controller.</P>
<P>Under the Disk<I>y</I> subkeys are the following value entries, which can be extremely helpful in reporting disk problems: </P>
<P><B>Firmware revision     REG_SZ   </B><I>  Free format</I></P>
<P>Defined by the disk manufacturer to identify the version of the on-board code used to control the disk. </P>
<P><B>Identifier     REG_SZ </B><I>    Free format</I></P>
<P>Defined by the disk manufacturer to identify the make and model of the disk.</P>
<P><B>Number of cylinders     REG_DWORD </B><I>    A hex value</I></P>
<P>The number of cylinders on the drive. </P>
<P><B>Number of heads     REG_DWORD </B><I>    A hex value</I></P>
<P>The number of heads on the drive.</P>
<P><B>Sectors per track     REG_DWORD </B><I>    A hex value</I></P>
<P>The number of sectors that exist on a track. These are typically 512-byte sectors.</P>
<P>The standard entries for AtDisk under the CurrentControlSet\Services subkey are the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="278pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Value entry</P></TD><TD VALIGN="TOP"><P>Default value</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>ErrorControl</B> </P></TD><TD VALIGN="TOP"><P>0 (startup halts)</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Group</B> </P></TD><TD VALIGN="TOP"><P>Primary disk</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Start</B> </P></TD><TD VALIGN="TOP"><P>0x0 (boot)</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Tag</B> </P></TD><TD VALIGN="TOP"><P>0x2 </P></TD></TR><TR><TD VALIGN="TOP"><P><B>Type</B> </P></TD><TD VALIGN="TOP"><P>0x1 (Kernel driver)</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec2"></A>DeviceMap Subkey Entries for Serial and Parallel Ports</H4><P>Remember that the entries in HKEY_LOCAL_MACHINE\HARDWARE are recreated each time the system is started. The entries in these subkeys are described here for informational purposes only. </P>
<P><B>Parallel</B><I>X</I><B>     REG_SZ     </B><I>A string, typically LPTy</I></P>
<P><BR></P>
<pre><code>   HKEY_LOCAL_MACHINE\HARDWARE\DEVICEMAP\PARALLEL PORTS</code></pre>
<P>Specifies that the Windows&nbsp;NT Parallel device <I>X</I> is the actual device for the MS-DOS name LPT<I>y</I>. These value entries are used to determine all the parallel ports available on the system.</P>
<P><B>Serial</B><I>X</I><B>     REG_SZ     </B><I>A string, typically COMy</I></P>
<P><BR></P>
<pre><code>   HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap\Serialcomm</code></pre>
<P>Specifies that the Windows&nbsp;NT Serial device <I>X</I> is the actual device for the MS-DOSMS-DOS name COM<I>y</I>. These value entries are used to determine all the communication ports available on the system.</P>
<H4><A NAME="sec3"></A>Parallel Subkey Entries in the Services Subkey</H4><P>The following subkeys and values can be found under the following subkey: </P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Parallel</code></pre>
<P>Subkeys and values under the Parallel subkey can be used to configure parallel (printer) ports in addition to information that the Hardware Recognizer finds at system startup. </P>
<P>This can also be used to override values determined by the Hardware Recognizer. If the <B>PortAddress</B> value entry is the same as a system-detected port, this data in the current control set will be used instead of the data found by the system. Entries appear in the System log in Event Viewer if this is occurring.</P>
<P>The Parallel subkey contains a subkey named Parameters, under which is a set of subkeys typically named Parallel<I>x</I> where <I>x</I> is some whole number. A system administrator must place these subkeys and values into the Registry. There exists no tool other than Registry Editor to define and manipulate these values.</P>
<P>For example, under the Parallel2 subkey, the following value entries can appear.</P>
<P>The first two of these value entries are required. If the section does not include both, the port is not configured and an error appears in the System log in Event Viewer. If an entry is placed into the Registry with just these values, the port will be driven using polling algorithms.</P>
<P><B>DosDevices     REG_SZ     </B><I>Free-form string</I> </P>
<P>Specifies the name used to access the parallel port from the command prompt or from within an application. A typical value would be LPT3. </P>
<P><B>PortAddress     REG_DWORD </B><I>    A hex value</I></P>
<P>Denotes the address of the first register of the parallel port. A typical <B>PortAddress</B> in this case would be 0x278. </P>
<P>The following values are optional:</P>
<P><B>DisablePort     REG_DWORD     </B><I>0 or 1</I>  </P>
<P>If the value is a 1, the device will be deleted after the port is reset during initialization. No access to the port will be allowed.</P>
<P>Default:  0</P>
<P><B>Interrupt     REG_DWORD </B><I>    A hex value</I> </P>
<P>Denotes the IRQ that the particular device would interrupt on. A typical <B>Interrupt</B> value in this case would be 0x5. </P>
<P>The standard entries for the Parallel subkey are the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="174pt" VALIGN="TOP"><COL WIDTH="216pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Value entry</P></TD><TD VALIGN="TOP"><P>Default value</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>ErrorControl</B> </P></TD><TD VALIGN="TOP"><P>0 (startup halts)</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Group</B> </P></TD><TD VALIGN="TOP"><P>Extended base</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Start</B> </P></TD><TD VALIGN="TOP"><P>0x2 (autoload)</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Type</B> </P></TD><TD VALIGN="TOP"><P>0x1 (Kernel device driver)</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec4"></A>Serial Subkey Entries in the Services Subkey</H4><P>The values for serial ports are under the following Registry path: </P>
<P><BR></P>
<pre><code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Serial</code></pre>
<P>Subkeys and values under the CurrentControlSet\Services subkey can be used to configure serial ports in addition to information that the Hardware Recognizer finds at system startup. This can also be used to override values determined by the Hardware Recognizer. If the <B>PortAddress</B> value entry is the same as a system-detected port, this data in the current control set will be used instead of the data found by the system. Entries appear in the System log in Event Viewer if this is occurring.</P>
<P>The Serial subkey contains a subkey named Parameters, under which is a set of subkeys typically named Serial<I>X</I> where <I>X</I> is a whole number. A system administrator must place these subkeys and values into the Registry. You can only define and manipulate these values by using Registry Editor.</P>
<P>For example, under the Serial2 subkey, the following value entries can appear.</P>
<P>The first three of these value entries are required. If the subkey does not include all three, the port is not configured, and an error appears in the System log in Event Viewer. </P>
<P><B>DosDevices     REG_SZ     </B><I>Free-form string</I></P>
<P>Specifies the name used to access the communication port from the command prompt or from within an application. A typical value would be COM3. </P>
<P><B>Interrupt     REG_DWORD </B><I>    A hex value</I></P>
<P>Denotes the IRQ that the particular device would interrupt on. A typical <B>Interrupt</B> value in this case would be 0x4. </P>
<P><B>PortAddress     REG_DWORD </B><I>    A hex value</I></P>
<P>Denotes the address of the first register of the serial device. A typical <B>PortAddress</B> in this case would be 0x3e8. </P>
<P>The following entry values are optional: </P>
<P><B>DisablePort     REG_DWORD    </B><I>0 or 1</I></P>
<P>If the value is 1, the device will be deleted after the port is reset during initialization. No access to the port will be allowed.</P>
<P>Default:  0</P>
<P><B>ForceFifoEnable     REG_DWORD     </B><I>0 or 1</I></P>
<P>If the value is 1 and the hardware supports a FIFO buffer (for example, the NS 16550AFN), the driver enables the FIFO. Not all FIFOs are reliable. If the application or the user notices lost data or no data transmission, it is recommended that this value be set to 0.</P>
<P>Default:  1</P>
<P>The standard entries for the Serial subkey are the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="176pt" VALIGN="TOP"><COL WIDTH="215pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Value entry</P></TD><TD VALIGN="TOP"><P>Default value</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>ErrorControl</B> </P></TD><TD VALIGN="TOP"><P>0 (startup halts)</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Group</B> </P></TD><TD VALIGN="TOP"><P>Extended base</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Start</B> </P></TD><TD VALIGN="TOP"><P>0x2 (autoload)</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Type</B> </P></TD><TD VALIGN="TOP"><P>0x1 (Kernel device driver)</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec5"></A>Multiport Serial I/O Card Entries in the Services Subkey</H4><P>In addition to controlling the standard serial ports included with most personal computers, the Microsoft serial driver can be used to control many <I>dumb</I> multiport serial cards. Dumb denotes that the control includes no onboard processor.</P>
<P>At least the following two additional value entries are used for each port on the multiport card. Each of these two entries must be included for each port of the multiport board under subkey entries in CurrentControlSet\Services:</P>
<P><B>InterruptStatus     REG_DWORD </B><I>    A hex value</I></P>
<P>Denotes the address of the interrupt status register that indicates which port on the multiport card is actually requesting an interrupt. To determine the appropriate value, consult the manufacturer's installation guide. </P>
<P><B>PortIndex     REG_DWORD </B><I>    A hex value</I> </P>
<P>Denotes which port on the card this information is for. These values start at 1 and increase. Typically these would be the same as the values inscribed on the connector for the multiport. </P>
<P>Certain multiport boards, such as Digiboard non-MCA bus cards, use a different scheme to determine which port is interrupting. These boards should include the following value entry in the configuration data:</P>
<P><B>Indexed     REG_DWORD     </B><I>Should be 1</I></P>
<P>Denotes that this board uses an indexed interrupt notification scheme as opposed to a bitmapped method. To determine whether this entry should be included, consult the board's manufacturer.</P>
<P>For detailed examples describing entries for four-port and eight-port communications boards, see "Controlling Multiport Serial I/O Cards" in Chapter&nbsp;12, "Configuration Management and the Registry." </P></FONT></BODY></HTML>
