<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Clients</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Clients</H3><P>Clients are those applications which request the spooler's services. These include applications running on the local computer; workstations on the network that send jobs to a Windows&nbsp;NT print server; and the Print Manager application.</P>
<P><img src="xrgr12a.gif"></P>
<P><img src="xrgr12.gif"></P>
<P>Figure 6.2    The Client Component</P>
<H4><A NAME="sec0"></A>Local Applications</H4><P>Local print clients are any applications running on the local computer that send a print job while running on a Windows&nbsp;NT-based computer. These include both 16-bit and 32-bit Windows-based applications, and non-Windows-based applications.</P>
<H5><A NAME="sec1"></A>Windows-based Applications</H5><P>Windows-based applications are different from nearly all other printing clients, because they depend on the Graphics Device Interface (GDI) and the Windows&nbsp;NT printer driver. These applications rely on Windows&nbsp;NT to create their print jobs, whereas other printing clients rely on Windows&nbsp;NT only to transfer their jobs to the appropriate print device.</P>
<P>The graphics engine (GDI32.DLL) is the printing component that provides WYSIWYG support across devices. The graphics engine communicates with Windows-based applications through the Graphics Device Interface (GDI) and with printer drivers through the Device Driver Interface (DDI).</P>
<P>When a Windows-based application prints, it describes the output it wants in a series of GDI commands. The graphics engine is responsible for translating these GDI commands into the DDI commands understood by components like printer drivers and print processors.</P>
<P>The graphics engine also communicates with the printer driver to find out what the printer's capabilities are. Then the graphics engine instructs the printer driver about which characters, fonts, locations, and point sizes to print and when.</P>
<P>The graphics engine can also query the printer driver about the fonts supported. Then, using that information, the graphics engine uses other DDI commands to specify the positioning of each character in the document by the print device. The graphics engine also uses DDI commands to define how the printer should draw and fill graphics, and how to manipulate and print bitmaps. </P>
<P>The graphics engine provides services to the printer driver, including compatibility with the environment subsystem (MS-DOS, OS/2, and so on), performance optimization, caching, client-server communications, and ANSI-to-Unicode conversion. </P>
<P>The graphics engine communicates with the spooler to determine which data type the graphics engine should spool. If the specified data type is <I>RAW</I>, the graphics engine calls the printer driver to render the DDI calls. If the data type is <I>journal</I>, the graphics engine writes a journal file and does not call the printer driver to render the DDI calls.</P>
<P>When the graphics engine passes the journal file to the spooler, spooling happens quickly because journal files are small and there is no wait for printer-specific rendering. (Rendering is done later as a background process.) Although journal files contain DDI calls rather than printer commands, they are device-dependent.</P>
<P>The graphics engine calls the printer driver and provides information about the type of printer needed and the data type used. In response, the printer driver provides the graphics engine with the printer's fully qualified path name for the printer and printer-setting information. This information is passed to the spooler.</P>
<P>Journal files differ from metafiles. Windows&nbsp;NT does not spool metafiles because they are device-independent and thus do not translate reliably to an individual printer's page layout. Metafiles are pictures, not pages. In addition, metafiles often contain a list of "acceptable" font and color substitutions for a document. For WYSIWYG accuracy, such color and font substitutions are unacceptable. In contrast, use of journal files guarantees that Windows&nbsp;NT provides true reproduction of spooled document.</P>
<P>Journal files are concise and precise. They only contain calls that make a difference. For example, some applications add hundreds of unnecessary and/or redundant instructions for creating a graphic. The journal file includes only those necessary to draw that picture.</P>
<P>Journal files are tuned for a particular device; they are not device-independent. For example, a journal file created for a 150-DPI LaserJet&reg; printer cannot print on a 300-DPI LaserJet printer. A journal file is created to play back on a specific device and therefore is tuned for the device's specific coordinate space, color space, bits-per-pixel, fonts, and so on.</P>
<H5><A NAME="sec2"></A>Non-Windows-based Applications</H5><P>Non-Windows-based applications running on Windows&nbsp;NT-based computers are not aware of the Windows&nbsp;NT printing model; in particular, they are not aware of Windows&nbsp;NT printer drivers, they cannot make use of them, and the Windows&nbsp;NT driver does not get involved during the job's processing.</P>
<P>If you print from a non-Windows-based application, and the port it prints to is spooled, then the spooler components will take control of the job, much like other client's jobs. However, if the job is sent to a port that isn't spooled, the job goes directly to the device driver responsible for the port, for example, PARALLEL.SYS. A port is spooled if any printer defined in Print Manager prints to that port, or if you have issued a NET USE &lt;<I>portname</I>&gt; command in a Windows&nbsp;NT command prompt.</P>
<H4><A NAME="sec3"></A>Remote Print Clients</H4><P>The second type of print client is remote workstations that send print jobs over the network to a Windows&nbsp;NT print server. The most interesting of these are clients running operating systems other than Windows&nbsp;NT. This section concentrates on those clients: downlevel Microsoft Network clients, Macintosh clients, and UNIX clients. For information on what happens when a Windows&nbsp;NT client sends a print job to a printer controlled by another Windows&nbsp;NT-based computer, see "Remote Print Providers," later in this chapter.</P>
<P>The spooler on the Windows&nbsp;NT print server does not care what kind of application the remote client is running. In most cases, the Windows&nbsp;NT printer driver does not get involved in processing print jobs from remote non-Windows-NT clients. The two exceptions are when jobs sent from Macintosh clients to non-PostScript print devices and when jobs from UNIX or downlevel clients are sent to printers whose default data type has been set to TEXT.</P>
<H5><A NAME="sec4"></A>Downlevel Clients</H5><P>Computers on the network running Windows for Workgroups, Windows 3.1, or MS-DOS are referred to as <I>downlevel</I> clients. Any downlevel client that can send a job to a Windows for Workgroups print server or LAN Manager print server can also send jobs to a Windows&nbsp;NT print server.</P>
<P>The Windows&nbsp;NT Server service receives jobs from these clients and passes them to the spooler without alteration. Regardless of what kind of application created the print job on the downlevel client, the job is assigned the RAW data type when it reaches the spooler. In general, the printer driver installed on the Windows&nbsp;NT print server does not get involved with processing jobs from downlevel clients.</P>
<H5><A NAME="sec5"></A>Macintosh clients</H5><P>Because Windows&nbsp;NT Services for Macintosh is required for Macintosh clients to send print jobs to printers controlled by Windows&nbsp;NT-based computers, Macintosh clients cannot print to printers controlled by Windows&nbsp;NT Workstation computers. Windows&nbsp;NT Server, running Services for Macintosh, is required to make printers available to Macintosh clients.</P>
<P>Macintosh clients usually print using a PostScript driver, so their print jobs consist of PostScript commands. Jobs sent to PostScript print devices are assigned the RAW data type, and the Windows&nbsp;NT printer driver does not help process the print job. Macintosh print jobs sent to non-PostScript print devices are assigned the Pscript1 data type, which causes Windows&nbsp;NT Server to convert the job from PostScript to the print device's native language. In this case, the Windows&nbsp;NT printer driver is involved in processing the job.</P>
<H5><A NAME="sec6"></A>UNIX</H5><P>Windows&nbsp;NT can also receive print jobs sent by UNIX systems. To enable this feature, you must first install the TCP/IP network protocol via the Network icon in the Control Panel window, and then install the TCP/IP Network Printing Support option. This procedure installs the LPD service ("daemon" in UNIX terminology), which enables Windows&nbsp;NT to receive print jobs sent by UNIX computers. Once installed, you must start this service by using the Services icon in the Control Panel window or by typing the <B>net start lpdsvc</B> command at the command line. Jobs that reach the LPD service are assigned the RAW data type if they contain the "l" control command, or are assigned the TEXT data type if they contain the "f" control command. For more information on these control commands, see "LPR Print Monitor," later in this chapter.</P>
<P>For more information about UNIX print connectivity, see "Print Monitors" later in this chapter.</P>
<H4><A NAME="sec7"></A>Print Manager</H4><P>Because Print manager relies on the spooler components, it is also considered a client. Print Manager is a window into the spooler components; a user interface that lets you configure various options and manipulate print jobs as they are processed.</P></FONT></BODY></HTML>
