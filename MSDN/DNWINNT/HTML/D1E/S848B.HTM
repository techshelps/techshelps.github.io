<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Solving Users' Environment Problems with the Registry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Solving Users' Environment Problems with the Registry</H2><P>Using Registry Editor to view the contents of the Registry for a remote computer makes it easier for a system administrator to solve users' configuration problems. Select the troublesome computer using the Select Computer command in Registry Editor, and then you can browse through Registry entries to find where problems may exist.</P>
<P>You can also load a copy of a hive from another computer to view and change entries, as described in "Loading Hives from Another Computer" in Chapter 11, "Registry Editor and Registry Administration."</P>
<P>This is probably how you will use Registry Editor most often—to find the source of problems, not to edit value entries. After you find the source of a problem, Control Panel or other tools can be used to solve the problem.</P>
<P>For example, you can check the user's desktop settings easily by examining the values under the Console and Control Panel subkeys for the user. The Console subkeys define settings for the command prompt and other character-based applications. The Control Panel subkeys in the Registry define the appearance and behavior of items in the Windows&nbsp;NT desktop.</P>
<H3><A NAME="sec0"></A>To view a user's desktop settings</H3><OL><LI>Focus on the user's computer by choosing the Select Computer command from the Registry menu.</LI><LI>Under HKEY_USERS for the selected computer, select the key that represents the profile for the user who is having problems. (See "Tip" Below.)</LI><LI>Double-click either the Console or Control Panel subkey, depending on whether the problem is with a character-based screen or a Windows&nbsp;NT window.</LI><LI>Check values as described in the Help topic, "Registry Entries for User Components," in the REGENTRY.HLP file, which is included on the <I>Resource Kit</I> disk.</LI></OL><P></P>
<P><b>Tip</b></P>
<P>To determine which <I>SID_#</I> key represents which user, see the values for ProfileImagePath under the ProfileList key in the following Registry path:</P>
<P>HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS&nbsp;NT\CurrentVersion</P>
<P>The hive filename that is the value for ProfileImagePath includes a portion of the username associated with that <I>SID_#</I> key, so that you can identify the user to which it belongs.</P>
<P></P>
<P>For example, suppose a user asks for help, complaining that their screen goes black whenever the icon for the command prompt is clicked in Program Manager. You can select this computer in Registry Editor, and then select the following subkey:</P>
<P><BR></P>
<pre><code>HKEY_USERS\<I>SID_#</I>\Console\Command Prompt</code></pre>
<P>In this example, if the value of ScreenColors is 0, both the text and the screen background have been set to black, and this is the source of the user's problem. The user can fix this by running Command Prompt and pressing ALT+SPACEBAR to display the Control menu and choosing the Screen Colors command to select new colors.</P>
<P><B>Tip</B>   To change the colors or the bitmap that appears on the CTRL+ALT+DEL logon screen, change the entries under HKEY_USERS\.DEFAULT\Control Panel\Desktop. For example, if you want a bitmap of your company's logo on the logon screen, change the value of Wallpaper to specify the path and filename for that bitmap. </P>
<P>As another example, any user with sufficient access permission can use the System icon in Control Panel to change user environment variables, but the system environment variables can only be set by changing values in the Registry. Such changes to the system environment variables affect all users and can only be made in the Registry if you are logged on as a member of the Administrators group.</P>
<H3><A NAME="sec1"></A>To change system environment variables</H3><OL><LI>In Registry Editor, select the Environment subkey under this Registry path:
<P>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet<BR>   \Control\Session Manager\Environment</P></LI><LI>Double-click an environment variable and change its value, as described in "The CurrentControlSet\Control Subkeys" in REGENTRY.HLP, which is included on the <I>Resource Kit</I> disk.</LI><LI>Restart the system for these changes to take effect.</LI></OL><P>For example, if you want to change the path for the Microsoft OS/2 version 1.<I>x</I> libraries, change the value of OS2Lib under the Environment subkey to specify a new path name, such as D:\OS2\DLL. </P></FONT></BODY></HTML>
