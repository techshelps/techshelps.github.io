<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SNMP Information in the Registry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>SNMP Information in the Registry</H3><P>SNMP parameters are contained in the Registry, and so is the information about which extension-agent DLLs SNMP loads. To examine or change information in the Registry, use the REGEDT32.EXE program that comes with Windows&nbsp;NT.</P>
<H4><A NAME="sec0"></A>SNMP Parameters</H4><P>This section lists Windows&nbsp;NT SNMP network parameters. These parameters are contained in the Registry in the following key:</P>
<P>HKEY_LOCAL_MACHINE\<BR>          SYSTEM\<BR>               CurrentControlSet\     <BR>                    Services\<BR>                         SNMP\<BR>                              Parameters </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="238pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Registry parameter</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>EnableAuthenticationTraps<BR></B>Units: Boolean<BR>Range: 0 (off) or 1 (on)<BR>Default: on</P></TD><TD VALIGN="TOP"><P>A value of On (1) indicates that the SNMP service sends a trap whenever it receives a request that does not match any community name or host filter in its lists. Off (0) indicates that the SNMP service does not send a trap when this occurs.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>ExtensionAgents</B></P></TD><TD VALIGN="TOP"><P>Contains information about each of the extension-agent DLLs to load. See the next section "SNMP Extension Agent Information."</P></TD></TR><TR><TD VALIGN="TOP"><P><B>ValidCommunities<BR></B>Units: names<BR>Range:  — <BR>Default: public</P></TD><TD VALIGN="TOP"><P>Specifies one or more community names defining groups of hosts from which the SNMP service will accept requests.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>TrapConfiguration<BR></B>Units: name<BR>Range:  — <BR>Default: —</P></TD><TD VALIGN="TOP"><P>Specifies one or more host names, IP addresses, or IPX addresses defining hosts to which the SNMP service sends traps. Under the TrapConfiguration key, there is a key for each community. Under the community key, there are trap destination values for that community.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<H4><A NAME="sec1"></A>SNMP Extension Agent Information</H4><P>If you are developing an extension-agent DLL, you must configure the Registry so that the SNMP agent will load the extension-agent DLL. You can use the REGEDT32.EXE program that comes with Windows&nbsp;NT to add this information, or you can have your SNMP extension-agent installation program configure the Registry using the Win32 Registry APIs.</P>
<P>These are the steps to configure an SNMP extension-agent in the Registry.</P>
<P CLASS="ls">    1.    Locate the following key: </P>
<P CLASS="lt1">HKEY_LOCAL_MACHINE\<BR>          SYSTEM\<BR>               CurrentControlSet\     <BR>                    Services\<BR>                         SNMP\<BR>                              Parameters\<BR>                                   ExtensionAgents </P>
<P CLASS="ls">    2.    For the new extension-agent, create a value under this key with a Value Name of the next available integer and a type of REG_SZ. For the SNMP Toaster sample in the SDK, the entry is:</P>
<P CLASS="lt1">3:REG_SZ:SOFTWARE\CompanyName\toaster\CurrentVersion</P>
<P CLASS="lt1">This entry provides a pointer to another Registry entry (see next step), which contains the physical path where the extension-agent DLL can be found. The "CompanyName" and "toaster" strings are used in the next step.</P>
<P CLASS="ls">    3.    Locate the following key:</P>
<P CLASS="lt1">HKEY_LOCAL_MACHINE\SOFTWARE</P>
<P CLASS="lt1">and create a CompanyName\toaster\CurrentVersion key that corresponds to the new entry in step 2. The keys Microsoft\RFC1156Agent\CurrentVersion and Microsoft\LANManagerMIB2Agent\CurrentVersion show the format of the information.</P>
<P CLASS="ls">    4.    Assign the path of the extension-agent DLL as the value for the CurrentVersion key. Remember that the names and values in the Windows&nbsp;NT Registry are case sensitive.</P>
<P CLASS="lt1">For instance, if you have copied the SNMP toaster sample agent DLL to drive D, the entry is:</P>
<P CLASS="lt1">Pathname:REG_SZ:D:\mstools\samples\snmp\testdll\testdll.dll.</P>
<P CLASS="ls">    5.    Stop and restart the SNMP service from the Control Panel Services icon. You need to do this for the SNMP agent to load the new extension agent that you have just added to the system. </P>
<P CLASS="lt1">You can use Event Viewer in the Administrative Tools program group to view errors encountered during the startup process of the SNMP service and extension agents.</P>
<P></P>
<P></P>
<P CLASS="nh"><B>Note</B></P>
<P>The key name and values are case sensitive. Make sure that they match. If you have problems, look in the system log. You can also type "Net Help Start SNMP" to see how to configure error logging of the SNMP agent. </P>
<P>You must stop and restart the SNMP service for it to load the new extension-agent DLLs.</P>
<P></P></FONT></BODY></HTML>
