<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Frequently Asked Questions About CPS</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H2>Frequently Asked Questions About CPS </H2><P CLASS="proch"><B>Is CPS a one-step process?</B></P>
<P CLASS="proct">In many cases it's very close. However, since each customer's installation is unique, you might need to modify the CPS process. The additional steps can include such things as auto logon scripts, MS-Test scripts, batch or command files, custom programs, and so on.</P>
<P CLASS="proct">It's best to think of CPS as a "starting point" to your installation process, rather than an "ending point."</P>
<P CLASS="proch"><B>Can I profile files with long filenames?</B></P>
<P CLASS="proct">Long filenames are not supported by MS-DOS&reg;. Since the files are copied from the distribution directory to the target computer using an MS-DOS program (WINNTP.EXE), only MS-DOS-based filenames (that is, those using the "8.3" format) are allowed.</P>
<P CLASS="proct">As a workaround, you can use files that have 8.3 filenames in the WINNT system directories, and copy only the system directories using CPS. Then, after Windows&nbsp;NT has been installed on the target computer, use the <B>xcopy</B> command to copy the remaining files and directories.</P>
<P CLASS="proch"><B>I'm using TCP/IP. How can I assign an IP address during setup?</B></P>
<P CLASS="proct">In the %systemroot%\SYSTEM32 directory there is a file named IPINFO.INF. See that file for information on manually configuring your IP addresses. Each target computer will require a unique IP address in the IPINFO.INF file. CPS will use the information from this file during setup.</P>
<P CLASS="proch"><B>If CPS won't transfer my application, service, or program, what should I do?</B></P>
<P CLASS="proct">Some applications do not profile completely. If your installation requires an application that does not transfer correctly from the source to the target computers, the following steps can be taken:</P>
<P CLASS="ls">    1.    Profile the system without the application(s) installed.</P>
<P CLASS="ls">    2.    Install the application, while recording the steps using MS-Test. (MS-Test is a separate Microsoft product.)</P>
<P CLASS="ls">    3.    Install the profiled system on the target computer.</P>
<P CLASS="ls">    4.    Run the MS-Test script to install the application(s).</P>
<P></P>
<P CLASS="proch"><B>Why can't I just copy the contents on the hard disk from one computer to another?</B></P>
<P CLASS="proct">Each computer is assigned a unique Security ID (SID) during setup so that it can be identified on the network. Most of the network services have this Security information encoded in their entries in the Registry during setup or subsequent installation. Copying the contents of one hard disk to another would give each computer the same SID, which would compromise security.</P>
<P CLASS="proct">CPS works within this system by noting the network services that are installed on the source computer and then removing those entries from the profiled version of the Registry. During setup on the target computer, the target computer's unique SID is created, and then assigned to the network services that were found on the source computer as they are re-installed.</P>
<P CLASS="proch"><B>How do I get CPS to profile my network adapter?</B></P>
<P CLASS="proct">If your network adapter card is not listed in the Registry under the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft key, then you'll need to modify the CPS.INI file so as to point to the correct key. This is documented in online Help.</P>
<P CLASS="proch"><B>How can I use CPS to copy multiple network adapters, or Remote Access Service and a network adapter?</B></P>
<P CLASS="proct">CPS is capable of profiling only a single-network adapter. RAS is configured to look like a network adapter and as such makes the system appear to have two network adapters, only one of which will be profiled and subsequently installed on the target computer. </P>
<P CLASS="proct">As a workaround, complete the following steps:</P>
<P CLASS="ls">    1.    Profile the system without the Remote Access Service (RAS) installed.</P>
<P CLASS="ls">    2.    Install RAS, while recording the steps using MS-Test. (MS-Test is a separate Microsoft product.)</P>
<P CLASS="ls">    3.    Install the profiled system on the target computer.</P>
<P CLASS="ls">    4.    Run the MS-Test script to install RAS.</P>
<P></P>
<P CLASS="proct">For multiple network adapters, follow the same steps, substituting the additional adapter(s) for RAS.</P>
<P CLASS="proch"><B>Why won't CPS copy the user accounts?</B></P>
<P CLASS="proct">CPS only transfers domain accounts found on the source computer. (These are account names that are prefixed with a domain name, in the format DOMAIN\UserName). Local computer accounts are presumed by CPS to be unique to each computer. Also passwords are not copied from one computer to the next, for security reasons.</P>
<P CLASS="proch"><B>How can I transfer environment variables via CPS?</B></P>
<P CLASS="proct">CPS does not copy environment variables to the target computer. As a workaround, complete the following steps:</P>
<P CLASS="ls">    1.    Profile the system as usual.</P>
<P CLASS="ls">    2.    Create a script file of the environment variables you want to copy. In the following sample file, lines without equal signs (=) designate a key path or subkey, and subkeys are indented. Lines that include an equal sign indicate a value. Use the value modifiers that appear in the Add Value dialog box in the Registry Editor.</P>
<P><BR></P>
<pre><code>\Registry\USER
    .DEFAULT
        Environment
            NewOne = REG_SZ new string
    S-1-5-21-2127521184-1604012920-1887927527-9600
        Environment
            NewOne = REG_SZ new string
</code></pre>
<P CLASS="ls">    3.    Install the profiled system on the target computer.</P>
<P CLASS="ls">    4.    Use the <B>regini</B> command to change the Registry on the target computer, using the script created in step 2. </P>
<P></P>
<P CLASS="proct">For more information on the Registry Editor, see Part IV, "Windows&nbsp;NT Registry," of the <I>Windows&nbsp;NT Resource Guide</I>. For information on <B>regini</B>, see the RKTOOLS Help file.</P>
<P CLASS="proch"><B>Can I use CPS to transfer disk shares?</B></P>
<P CLASS="proct">CPS does not transfer disk shares. You'll need to create the shares after using CPS to copy the profile.</P>
<P CLASS="proch"><B>Where can I find information about the .INI &amp; .INF files?</B></P>
<P CLASS="proct">The INI file contents are documented in RKTOOLS Help. The INF file contents are described in the <I>Programmer's Guide</I> of the Windows&nbsp;NT Device-Driver Development Kit (DDK) documentation.</P>
<P CLASS="proch"><B>How can I get CPS to transfer my personal Program Groups?</B></P>
<P CLASS="proct">CPS profiles only the "common" program groups. If you have personal program groups, load them by using the REGTOGRP and GRPTOREG utilities provided with this resource kit. </P></FONT></BODY></HTML>
