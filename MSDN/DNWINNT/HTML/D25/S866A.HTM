<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SNMP Files on the SDK</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>SNMP Files on the SDK</H3><P>The Windows Systems Developers Kit (SDK) is a set of libraries, header files, tools, books, online Help, and sample source programs to help you create Windows applications. The Windows&nbsp;NT SDK contains SNMP files, tools, and information in the following directories:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="166pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Directory</B></P></TD><TD VALIGN="TOP"><P><B>File</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>\DOC\MISC</P></TD><TD VALIGN="TOP"><P>PROGREF.RTF</P></TD><TD VALIGN="TOP"><P>Microsoft Windows/NT SNMP Programmer's Reference </P></TD></TR><TR><TD VALIGN="TOP"><P>\MSTOOLS\BIN\WINNT</P></TD><TD VALIGN="TOP"><P>DHCP.MIB</P></TD><TD VALIGN="TOP"><P>Microsoft proprietary MIB for DHCP, described in the section "MIB Object Types for Windows&nbsp;NT" in Appendix A</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>LMMIB2.MIB</P></TD><TD VALIGN="TOP"><P>LAN Manager MIB II, described in the section "MIB Object Types for Windows&nbsp;NT" in Appendix A</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>MIB_II.MIB</P></TD><TD VALIGN="TOP"><P>This MIB is described in RFC 1213 and the section "MIB Object Types for Windows&nbsp;NT"  in Appendix A</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>SMI.MIB</P></TD><TD VALIGN="TOP"><P>This MIB is described in RFC 1155 </P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>SNMP.TXT</P></TD><TD VALIGN="TOP"><P>Notes on SNMP development for Windows&nbsp;NT — incorporated into this chapter</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>TOASTER.MIB</P></TD><TD VALIGN="TOP"><P>MIB for the sample extension-agent TESTDLL.DLL</P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>WINS.MIB</P></TD><TD VALIGN="TOP"><P>Microsoft proprietary MIB for WINS, described in the section "MIB Object Types for Windows&nbsp;NT" in Appendix A</P></TD></TR><TR><TD VALIGN="TOP"><P>\MSTOOLS\BIN\WINNT\<BR>ALPHA, I386, and MIPS</P></TD><TD VALIGN="TOP"><P>MIB.BIN</P></TD><TD VALIGN="TOP"><P>Output from the MIB compiler</P></TD></TR><TR><TD VALIGN="TOP"><P>\MSTOOLS\BIN\WINNT\<BR>ALPHA, I386, and MIPS</P></TD><TD VALIGN="TOP"><P>MIBCC.EXE</P></TD><TD VALIGN="TOP"><P>MIB compiler, described in PROGREF.RTF</P></TD></TR><TR><TD VALIGN="TOP"><P>\MSTOOLS\SAMPLES\<BR>WIN32\WINNT\SNMP\<BR>SNMPUTIL</P></TD><TD VALIGN="TOP"><P>SNMPUTIL.C</P></TD><TD VALIGN="TOP"><P>Example of how to code management applications using the SNMP Management APIs for Windows&nbsp;NT</P></TD></TR><TR><TD VALIGN="TOP"><P>\MSTOOLS\SAMPLES\<BR>WIN32\WINNT\SNMP\<BR>TESTDLL</P></TD><TD VALIGN="TOP"><P>*.*</P></TD><TD VALIGN="TOP"><P>Example of how to structure an extension-agent DLL that works in conjunction with the Windows&nbsp;NT SNMP agent.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<H4><A NAME="sec0"></A>SNMP Source Code </H4><P>There are two sets of sample code on the SDK.</P>
<H5><A NAME="sec1"></A>SNMPUTIL</H5><P>The files in the SNMPUTIL directory contain the source code for the SNMPUTIL.EXE utility. This utility will allow you to retrieve data from any SNMP agent. </P>
<P>To use the utility, type <B>snmputil</B> with the appropriate switches:</P>
<P CLASS="syn"><B>snmputil [get|getnext|walk]</B> <I>agent community oid </I>[<I>oid</I>] </P>
<P>or</P>
<P CLASS="syn"><B>snmputil trap</B></P>
<P>Where:</P>
<P CLASS="term1"><B>get</B></P>
<P CLASS="dt1">Gets the current value of the specified <I>oid</I>(s).</P>
<P CLASS="term1"><B>getnext</B></P>
<P CLASS="dt1">Gets the current value of the item in the MIB that follows the item whose <I>oid</I> is specified.</P>
<P CLASS="term1"><B>walk</B></P>
<P CLASS="dt1">Steps through the MIB and retrieves the values of all items in the branch of the MIB specified by <I>oid</I>.</P>
<P CLASS="term1"><I>agent</I></P>
<P CLASS="dt1">Specifies the computer to query. This can be an IP address, an IPX address, or a hostname.</P>
<P CLASS="term1"><I>community</I></P>
<P CLASS="dt1">Specifies a community name, which is used to group computers together into management groups. </P>
<P CLASS="term1"><I>oid</I></P>
<P CLASS="dt1">The ASN.1 name of the variable being queried, of the form .N.N.N.N (that is, a string of numbers separated by periods or, alternately, a string of names separated by periods). See the section "Application is Unable to Get Requested Variables" under "Troubleshooting SNMP" earlier in this chapter for more information about this parameter.</P>
<P CLASS="term1">trap</P>
<P CLASS="dt1">Tells SNMPUTIL to listen for traps.</P>
<P></P>
<P>For example:</P>
<P><BR></P>
<pre><code>snmputil get jb486 public
    .iso.org.dod.internet.mgmt.mib2.system.sysDescr.0
</code></pre>
<P>Would return a text description of the type of computer hardware and software being used on the computer named jb486.</P>
<H5><A NAME="sec2"></A>TESTDLL</H5><P>The files in the TESTDLL directory are the sources for the TESTDLL.DLL. This DLL implements the toaster MIB. See the next section, "SNMP Information in the Registry," for information about installing this DLL.</P>
<H4><A NAME="sec3"></A>MIBs and the MIB Compiler </H4><P>You can use the MIB compiler, MIBCC.EXE, to compile your own private MIBs. The file MIB.BIN must be placed in the path for the SNMP Manager APIs to be able to function properly. MIBCC.EXE by default places the file MIB.BIN in the &lt;WINDIR&gt;\SYSTEM32 directory.</P>
<P>The Microsoft Windows&nbsp;NT SNMP Programmer's Reference document describes the usage of the MIB compiler, which creates the file MIB.BIN that the SNMPUTIL.EXE program uses. </P></FONT></BODY></HTML>
