<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MigrateUserNT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_migrateusernt"></a>MigrateUserNT</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Migrate the user accounts that port from Windows 95 or Windows 98 to Windows NT.</p>
<pre><code><b>LONG
CALLBACK 
MigrateUserNT( 
    IN HINF </b><i>AnswerFileHandle</i><b>,
    IN HKEY </b><i>UserRegKey</i><b>,
    IN LPCWSTR </b><i>UserName<b>,</b></i><b> 
    LPVOID </b><i>Reserved</i><b>
    );</b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>AnswerFileHandle</i> </dt>
<dd>
INF handle to the answer file being used for the upgrade process. This file contains settings generated by Setup, the attending user, and all migration DLLs. You can access the file referenced by this handle using the Setup functions. Do not close this handle at any time.</dd>
<dt>
<i>UserRegKey</i> </dt>
<dd>
A registry handle to the private registry settings of the Windows 95 or Windows 98 user specified in <i>UserName</i>. This handle is equivalent to HKEY_CURRENT_USER (HKCU) when that user is logged on. The handle is only valid within the scope of <b>MigrateUserNT</b>. Do not close this handle at any time.</dd>
<dt>
<i>UserName</i> </dt>
<dd>
The user name for the user whose registry information is supplied through the <i>UserRegKey</i> parameter. If this value is NULL, Setup is referring to the Windows NT logon account. The Windows NT logon account is used for creating the desktop settings for the Windows NT logon prompt and as a template for creating new Windows NT users. </dd>
<dt>
<i>Reserved</i></dt>
<dd>
Reserved for future use.</dd>
</dl>
<h4>Return Value</h4>
<p>
ERROR_SUCCESS if the migration of user-specific settings is successful.</p>
<p>
Other error codes will terminate the processing of your migration DLL. However, Windows NT Setup will proceed. Ideally, only critical problems (such as a hardware failure) should generate terminating error codes.</p>
<p>
Exceptions generated by your migration DLL cause Setup to report RPC error messages. Setup provides more information in SETUPERR.LOG.</p>
<h4>Remarks</h4>
<p>
The order in which user names are passed to your migration DLL during the call to <b>MigrateUserNT</b> may be different than the order in which they were passed during the call to <b>MigrateUser9x</b>.</p>
<p>
Setup may disable migration of one or more user accounts if errors occur. For this reason, the number of user names passed to <b>MigrateUserNT</b> may be less than the number passed to <b>MigrateUser9x</b>.</p>
<p>
Your migration DLL is responsible for managing its private data created and stored during <b>MigrateUser9x</b> and processed during <b>MigrateUserNT</b>.</p>
<p>
Your migration DLL must not display user messages within its <b>MigrateUserNT</b> function.</p>
<p>&nbsp;</p></body>
</HTML>
