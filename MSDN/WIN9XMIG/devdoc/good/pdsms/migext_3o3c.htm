<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MigrateSystem9x</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_migratesystem9x"></a>MigrateSystem9x</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Gather system-wide information concerning the target application, and save private data to be used during the later call to <b>MigrateSystemNT.</b></p>
<pre><code><b>LONG 
CALLBACK 
MigrateSystem9x(
    IN HWND </b><i>ParentWnd</i><b>, 
    IN LPCSTR </b><i>AnswerFile</i><b>,
    LPVOID </b><i>Reserved</i><b>
    );</b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ParentWnd </i></dt>
<dd>
Specifies a handle to the parent window for any dialog boxes or windows that your migration DLL may want to display. 

<p>
<b>Note</b>  You should not display a user interface unless absolutely necessary.


<p>
If this parameter value is NULL, Setup is running in an unattended mode and your DLL must not prompt the user for input. Therefore, the <i>ParentWnd</i> value determines whether ERROR_CANCELLED can be returned from this function. 
</dd>
<dt>
<i>AnswerFile</i> </dt>
<dd>
Points to a copy of the Windows NT Setup answer file, UNATTEND.TXT. This file is used to automate the installation of Windows NT and can be accessed using the Win32 profile APIs, such as <b>GetPrivateProfileString</b> and <b>WritePrivateProfileString</b>. For more information, see <a href="migext_5bl1.htm">Using the Setup Answer File</a>.</dd>
<dt>
<i>Reserved </i></dt>
<dd>
Reserved for future use.</dd>
</dl>
<h4>Return Values</h4>
<p>
ERROR_SUCCESS if your target application is installed on the system. Also, return ERROR_SUCCESS if system-wide changes need to be made for the target application during the Windows NT phase of the upgrade.</p>
<p>
ERROR_NOT_INSTALLED if your migration DLL detects no application components common to the entire system or if your DLL requires no further processing. Note that Setup will continue to call <b>MigrateUser9x</b> for the rest of the users and <b>MigrateSystem9x</b> if this function returns ERROR_NOT_INSTALLED.</p>
<p>
ERROR_CANCELLED if the user elects to exit the Setup program. Use this return value only if <i>ParentWnd</i> is not NULL. </p>
<p>
All other return values (Win32 error values) are considered initialization errors. Setup reports the error to the user and asks to abort or continue the upgrade.</p>
<p>
Exceptions generated by your migration DLL cause Setup to report RPC error messages. Setup provides more information in SETUPERR.LOG.</p>
<h4>Remarks</h4>
<p>
Your DLL must always check for the value in <i>ParentWnd</i> before proceeding since its value determines whether user interface elements can be displayed to the user. </p>
<p>
Do not use this function to modify the system. Use it for system-wide information gathering only. To modify system-wide settings, save any private data collected in your migration DLLs working directory (specified in an earlier call to <b>Initialize9x</b>). Use <b>MigrateSystemNT</b> to perform the modifications during the Windows NT portion of the upgrade.</p>
<p>&nbsp;</p></body>
</HTML>
