<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Setup Answer File</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_zaw_using_the_setup_answer_file"></a>Using the Setup Answer File</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Setup passes the location of its answer file (UNATTEND.TXT) to your migration DLL in the <a href="migext_0u2g.htm"><b>MigrateUser9x</b></a>, <a href="migext_3o3c.htm"><b>MigrateSystem9x</b></a>, <a href="migext_0wok.htm"><b>MigrateUserNT</b></a>, and <a href="migext_3qpg.htm"><b>MigrateSystemNT</b></a> functions. </p>
<p>
Your migration DLL can modify this answer file during the Windows 95 and Windows 98 portion of the upgrade process by using the Win32 profile APIs (such as <b>WritePrivateProfileString</b>). Your DLL is permitted to change standard answer file settings and create private sections for its own use. Note that it may not modify the following sections of the UNATTEND.TXT file.</p>
<pre><code>[Unattended]]
[MassStorageDrivers]
[DisplayDrivers]
[KeyboardDrivers]
[PointingDeviceDrivers]
[OemBootFiles]
[OEM_Ads]
[GuiUnattended]
[UserData]
[LicenseFilePrintData]
[Display]
[Modem]
</code></pre>
<p>
<b>Note</b>  This list will change before Beta 2.&nbsp; Refer the reader to Win95upg.inf, [Answer File Restrictions] on the Windows NT compact disc.</p>
<p>
For a detailed description of answer file parameters, search the Microsoft Knowledge Base at http://www.microsoft.com/kb/. </p>
<p>
If you require a private section, your DLL should build the section name from the working directory passed to it by the <a href="migext_3ago.htm"><b>Initialize9x</b></a> function. The private section name may only contain alphanumeric characters (A-Z and 0-9). Spaces and other characters are not permitted because they prevent Windows NT Setup from starting the text-only portion of the installation.</p>
<p>
During the Windows NT portion of the upgrade, your migration DLL must treat the UNATTEND.TXT file as a read-only file. You must not modify the answer file in any way.</p>
<p>&nbsp;</p></body>
</HTML>
