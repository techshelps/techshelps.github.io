<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MigrateUser9x</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_migrateuser9x"></a>MigrateUser9x </h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Gather information concerning the users, and save private data to be used during the later call to <b>MigrateUserNT.</b></p>
<pre><code><b>LONG
CALLBACK 
MigrateUser9x(
    IN HWND </b><i>ParentWnd</i><b>, 
    IN LPCSTR </b><i>AnswerFile</i><b>,
    IN HKEY </b><i>UserRegKey</i><b>, 
    IN LPCSTR </b><i>UserName</i><b>, 
    LPVOID </b><i>Reserved</i><b>
    );</b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ParentWnd </i></dt>
<dd>
Specifies a handle to the parent window for any dialog boxes or windows that you may want your migration DLL to display. 

<p>
<b>Note</b>  You should not display a user interface unless absolutely necessary.


<p>
If this parameter is NULL, Setup is running in an unattended mode and your DLL must not display user interface elements or prompt the user for input.
</dd>
<dt>
<i>AnswerFile</i> </dt>
<dd>
Points to a copy of the Windows NT Setup answer file (typically UNATTEND.TXT), which is used to automate the installation of Windows NT. You can access this file using the Win32 profile APIs (for example, <b>GetPrivateProfileString</b> and <b>WritePrivateProfileString</b>). Some sections of this answer file cannot be modified by your DLL. For more information, see <a href="migext_5bl1.htm">Using the Setup Answer File</a>.</dd>
<dt>
<i>UserRegKey</i> </dt>
<dd>
Provides a registry handle to the user hive of the Windows 95 or Windows 98 user specified in the <i>UserName</i> parameter. This user hive is equivalent to the user's HKEY_CURRENT_USER (HKCU) when that user logs on. This handle is valid only within the scope of <b>MigrateUser9x</b> and is provided for user-specific information gathering purposes. </dd>
<dt>
<i>UserName</i> </dt>
<dd>
Provides the user name (for example, "<i>username</i>") for the Windows 95 or Windows 98 user whose registry information is supplied through the <i>UserRegKey</i> parameter. A value of NULL refers to the default Windows 95 or Windows 98 user account (that is, the account used when a user accesses the system by skipping the log on process). <i>UserName</i> may also be "Administrator" even though Windows 95 and Windows 98 do not have an administrator account. This allows a migration DLL to collect information for the Windows NT Administrator account to be created later. </dd>
<dt>
<i>Reserved </i></dt>
<dd>
Reserved for future use.</dd>
</dl>
<h4>Return Values</h4>
<p>
ERROR_SUCCESS if the target application is installed for the specified user. Also return ERROR_SUCCESS if your migration DLL needs further processing during the Windows NT phase.</p>
<p>
ERROR_NOT_INSTALLED if your target application is not installed for the specified user account and that user's registry does not require any processing. However, Setup will continue to call <b>MigrateUser9x</b> for the rest of the users and <b>MigrateSystem9x</b> if this function returns ERROR_NOT_INSTALLED.</p>
<p>
ERROR_CANCELLED if the user wants to exit Setup. You should specify this return value only if <i>ParentWnd</i> is not set to NULL. </p>
<p>
All other return values (Win32 error values) are considered initialization errors. Setup reports the error to the user and prompts to abort or continue the upgrade.</p>
<p>
Exceptions generated by your migration DLL cause Setup to report RPC error messages. Setup provides more information in SETUPERR.LOG.</p>
<h4>Remarks</h4>
<p>
A DLL must always check for the value of <i>ParentWnd</i> in <b>MigrateUser9x</b> before proceeding since its value determines whether UI can be displayed to the user. </p>
<p>
Do not use the <b>MigrateUser9x </b>function for user account modification. Use it only for information gathering about user accounts. To modify user-specific settings, save the data collected to your provided working directory and then use the <b>MigrateUserNT</b> function to perform the modifications.</p>
<p>
Use the DLL working directory provided by the <b>Initialize9x</b> <i>WorkingDirectory</i> parameter to store any user-specific configuration information you may want to keep track of. Remember to use the <i>UserName</i> parameter to differentiate the information about the various users.</p>
<p>&nbsp;</p></body>
</HTML>
