<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>InitializeNT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_zaw_initializent"></a>InitializeNT</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This function is called during Windows NT GUI Mode Setup when the Windows NT phase of the upgrade is ready to start. </p>
<pre><code><b>LONG
CALLBACK 
InitializeNT(
    IN LPCWSTR </b><i>WorkingDirectory</i><b>,
    IN LPCWSTR </b><i>SourceDirectories</i><b>,
    LPVOID </b><i>Reserved</i><b>
    );</b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>WorkingDirectory</i> </dt>
<dd>
Points to the path of the Setup-supplied working directory. This value is the value that your migration DLL used for storing its private temporary data and files during the Windows 95 or Windows 98 phase of the upgrade. </dd>
<dt>
<i>SourceDirectories </i></dt>
<dd>
Points to the path of the Windows NT installation files. This path is a multi-sz because multiple source directories can be provided. Normally this directory is D:\I386 or C:\$WIN_NT$.~LS\I386 where D:\ is the CD-ROM drive on the computer and C:\$WIN_NT$.~LS\I386 is the Setup temporary source directory.</dd>
<dt>
<i>Reserved</i></dt>
<dd>
Reserved for future use.</dd>
</dl>
<h4>Return Values</h4>
<p>
ERROR_SUCCESS if your migration DLL initializes properly within the Windows NT environment. </p>
<p>
All other return values (Win32 error values) are considered critical errors. Setup reports the error to the user and then cancels processing your migration DLL. However, Setup will not continue the upgrade. Any errors or logs generated will include the <i>ProductID</i> string specified in <b>QueryVersion</b> to identify your DLL.</p>
<p>
Exceptions generated by your migration DLL cause Setup to report RPC error messages. Setup provides more information in SETUPERR.LOG.</p>
<h4>Remarks</h4>
<p>
<b>InitializeNT</b> is called during Windows NT GUI Mode Setup when the Windows NT phase of application migration is ready to start. When this function is called, the current directory is set to the DLL working directory.</p>
<p>
Your migration DLL must not display user messages in its <b>InitializeNT</b> function.</p>
<p>&nbsp;</p></body>
</HTML>
