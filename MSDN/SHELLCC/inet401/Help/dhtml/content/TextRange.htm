<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the TextRange Object</TITLE>

<META NAME=MS-HKWD CONTENT="Using the TextRange Object">
<META NAME="Keywords" CONTENT="Dynamic HTML, DHTML, IE4, Internet Explorer 4.0, dynamic content">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="dc_textrange"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Using the TextRange Object"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbara.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Using the TextRange Object"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../dhtml.htm">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="content.htm">Dynamic Content</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="finding_text.htm">Finding Text in the Document</A></PRE></TD></TR>
</TABLE>
<!-- NAVLINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Using the TextRange Object</H1>
<BR CLEAR=ALL>
<P>Most users will only want to use the <A HREF="../references/properties/innerText.htm#innerText">innerText</A>/<A HREF="../references/properties/innerHTML.htm#innerHTML">innerHTML</A> and <A HREF="../references/properties/outerText.htm#outerText">outerText</A>/<A HREF="../references/properties/outerHTML.htm#outerHTML">outerHTML</A> properties and methods discussed previously. However, there is some more advanced text manipulation that can be done using a "text range" object. The <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object can be used to:

<UL>
<LI>Locate the text for a given element or a given point. <LI>Search for words and characters in the text of the document.<LI>Move through the text in logical units.<LI>Provide read/write access to the plain text and the HTMLText in the document.</UL>

<P>This feature might not be available on non-Win32&#174; platforms. See article <A HREF="http://www.microsoft.com/kb/articles/q172/9/76.htm" TARGET="_top">Q172976</A> in the Microsoft Knowledge Base for the latest information on Internet Explorer cross-platform compatibility.


<H2><A NAME="textrange_overview">Overview of the TextRange Object</A></H2>
<P>Text range objects are an advanced feature of Dynamic HTML that you can use to carry out useful tasks related to dynamic content, such as searching for and selecting text. Text ranges let you selectively pick out characters, words, and sentences from a document. The <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object is an abstract object that creates a start and end position over the stream of text that would appear in the HTML document. Consider the following simple HTML document:

<PRE>&lt;HTML&gt;
&lt;BODY&gt;
&lt;H1&gt;Welcome&lt;/H1&gt;
&lt;CENTER&gt;&lt;H2&gt;Overview&lt;H2&gt;&lt;/CENTER&gt;
&lt;P&gt;Be sure to &lt;B&gt;Refresh&lt;/B&gt; this page.&lt;/P&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

<P>In this document, creating a text range over the <A HREF="../references/objects/BODY.htm#BODY">BODY</A> would position the start at the beginning of the textual content of the <B>BODY</B>, and the end at the end of the textual content of the <B>BODY</B>. This text range would contain the plain text "Welcome Overview Be Sure to Refresh this page." 




<P><B>What Do I Do with a TextRange Object?</B>

<P>There are two parts to manipulating text with a <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object. The first is to create a text range so that the start and end positions encompass the desired text. The next step is to apply a method to the text range, or make a copy of the text to be used elsewhere in the document. Once the text range is positioned, you can search for text, select the text, and make a copy of the text and use it elsewhere in your document.



<P>See the <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object in the Object Model Reference for the properties and methods supported. 

<P><B>Positioning the TextRange Object</B>

<P>Each text range has a start and an end position defining the scope of the text that is encompassed by the <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object. When you create a new text range, the start and end positions encompass the entire content by default. Use methods such as <A HREF="../references/methods/move.htm#move">move</A>, <A HREF="../references/methods/moveStart.htm#moveStart">moveStart</A>, and <A HREF="../references/methods/moveEnd.htm#moveEnd">moveEnd</A> to change the scope of the text range.

<P>Other methods can position the <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object with respect to a particular element, or a point on the page. For example, <A HREF="../references/methods/moveToElementText.htm#moveToElementText">moveToElementText</A> positions the text range so that it encompasses the text contained by the given element. <A HREF="../references/methods/moveToPoint.htm#moveToPoint">moveToPoint</A> positions the text range at a given point where the user clicked a mouse button. The x and y positions of the user's click are known by the window.event object and can be used to position the range over a given point. From this collapsed point, the range can then be expanded to encompass a word, sentence, or a whole textEdit (the entire possible <B>TextRange</B> object).


<PRE>&lt;HTML&gt;&lt;HEAD&gt;
&lt;TITLE&gt;moveToPoint Example&lt;/TITLE&gt;
&lt;script&gt;
function selectMe() {
var r=document.body.createTextRange();
r.moveToPoint(window.event.x, window.event.y);
r.expand("word");
r.select();
}
&lt;/script&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;H1 id=myH1 onclick=selectMe()&gt;Click on a word and it will highlight&lt;/H1&gt;

&lt;/BODY&gt;&lt;/HTML&gt;
</PRE>

<P><BUTTON onclick="if (CheckCAB(3)) {window.open('../../../samples/dhtml/overview/cont_05.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL><P>You create a <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object by applying the <A HREF="../references/methods/createTextRange.htm#createTextRange">createTextRange</A> method to a <A HREF="../references/objects/BODY.htm#BODY">BODY</A>, <A HREF="../references/objects/TEXTAREA.htm#TEXTAREA">TEXTAREA</A>, or <A HREF="../references/objects/BUTTON.htm#BUTTON">BUTTON</A> element. You can also create a text range from a selection made by the user. The <A HREF="../references/methods/createRange.htm#createRange">createRange</A> method on the <A HREF="../references/objects/obj_selection.htm#obj_selection">selection</A> object returns a text range. You can use the same methods and properties on this range as you do for ranges created using <B>createTextRange</B>. 



<P>Creating a <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object on the body will not include the content inside a <A HREF="../references/objects/TEXTAREA.htm#TEXTAREA">TEXTAREA</A> or <A HREF="../references/objects/BUTTON.htm#BUTTON">BUTTON</A>. Conversely, you cannot change the start or end position of a text range over the <B>TEXTAREA</B> or <B>BUTTON</B> to move outside the scope of these particular elements. Use the properties provided on each element, <A HREF="../references/properties/isTextEdit.htm#isTextEdit">isTextEdit</A> and <A HREF="../references/properties/parentTextEdit.htm#parentTextEdit">parentTextEdit</A>, to walk the hierarchy. If the document above contained a <B>TEXTAREA</B>, a <A HREF="../references/methods/createTextRange.htm#createTextRange">createTextRange</A> on the body object would not find the position where the user actually clicked. The following reworks the above example to handle this case.

<PRE>&lt;HTML&gt;&lt;HEAD&gt;
&lt;TITLE&gt;moveToPoint Example&lt;/TITLE&gt;
&lt;script for=document event=onclick&gt;
     var r
     if(window.event.srcElement.isTextEdit)
           {
            r=window.event.srcElement.createTextRange();
     }else{
            var el=window.event.srcElement.parentTextEdit;
            r=el.createTextRange();
           }
     r.moveToPoint(window.event.x, window.event.y);
     r.expand("word");
     r.select();
&lt;/script&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;H1 id=myH1&gt;Click on a word and it will highlight&lt;/H1&gt;

&lt;TEXTAREA&gt;
There's text in this element too that you could click on
&lt;/TEXTAREA&gt;

&lt;/BODY&gt;&lt;/HTML&gt;
</PRE>

<P><BUTTON onclick="if (CheckCAB(3)) {window.open('../../../samples/dhtml/overview/cont_07.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL><H3><A NAME="textrange_content">Getting the Content of a TextRange</A></H3>
<P>The content of a <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object can be viewed with the <A HREF="../references/objects/INPUT.htm#text">text</A> or <B>HTMLtext</B> property on the <B>TextRange</B> object. The text property is a read/write property that is similar to the <A HREF="../references/properties/innerText.htm#innerText">innerText</A> properties on the element objects, only this replaces the text encompassed by a <B>TextRange</B> object.

<P>HTMLtext is a read-only property that lets you examine the HTML that is contained within the start and end points of the <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object. To add rich HTML content to the text range, use the <A HREF="../references/methods/pasteHTML.htm#pasteHTML">pasteHTML</A> method. Although you can paste any HTML text that you want into a text range, the <B>pasteHTML</B> method does not preserve the hierarchy of the document, as do the <A HREF="../references/properties/innerHTML.htm#innerHTML">innerHTML</A> and <A HREF="../references/properties/outerHTML.htm#outerHTML">outerHTML</A> properties. Although <B>pasteHTML</B> won't fail if you paste invalid or inappropriate tags into the range, the resulting document may not look or behave the way you expect. If you paste an HTML fragment, the fragment is automatically closed to prevent it from affecting subsequent text and elements. For example, this means if your scripts rely on ordinal positions in the document's <A HREF="../references/collections/all.htm#all">all</A> collection, after a <B>pasteHTML</B>, the <A HREF="../references/properties/sourceIndex.htm#sourceIndex">sourceIndex</A> into the document.all collection may point to a different element.

<P><B>Comparing Ranges</B>

<P>You can create more than one text range at a time, using them for independent, simultaneous access to different portions of the text in an element. You can also copy a text range by using the <A HREF="../references/methods/duplicate.htm#duplicate">duplicate</A> method. This is useful if you want temporary access to a portion of the original range but don't want to bother recreating or restoring the original range. You can determine the relationship of one text range to another by using methods such as <A HREF="../references/methods/isEqual.htm#isEqual">isEqual</A> and <A HREF="../references/methods/inRange.htm#inRange">inRange</A>. 

<P>Because the object model never holds on to a text range, you'll need to recreate any range whenever control leaves and then reenters your code. For example, any text range objects created by an event handler are discarded when the event handler returns. 

<P>You can determine whether one range in entirely contained within another text range by using the <A HREF="../references/methods/inRange.htm#inRange">inRange</A> method. You can determine whether two text ranges are identical by using the <A HREF="../references/methods/isEqual.htm#isEqual">isEqual</A> method. Text ranges are identical if they start and end at exactly the same positions. Note that identical text ranges are always considered to be within one another, meaning the <B>inRange</B> method returns true for these. 

<P>You can set the start or end point of a range to match the start or end point of another range by using the <A HREF="../references/methods/setEndPoint.htm#setEndPoint">setEndPoint</A> method. The method takes two parameters: a string describing which end points to transfer, and a range from which the source end point is taken. The following example sets the end of the range "r1" to the start of "r2". 

<PRE>r1.setEndPoint( "StartToEnd", r2 )
</PRE>

<P>You can also use "StartToStart", "EndToStart", and "EndToEnd" to set the end points. 

<P>You can compare the start or end points of two ranges by using the <A HREF="../references/methods/compareEndPoints.htm#compareEndPoints">compareEndPoints</A> method. This method compares the end points and returns -1, 0, or 1, indicating whether the end point of the first range is less than, equal to, or greater than that of the second. 

<P>A bookmark is an easy way to save the current start and end positions of a text range and quickly restore these positions when you need them. You create a bookmark for a given range by using the <A HREF="../references/methods/getBookmark.htm#getBookmark">getBookmark</A> method, which returns an opaque string that uniquely identifies the bookmark. (Opaque means the string cannot be examined or modified.) You use the string with the <A HREF="../references/methods/moveToBookmark.htm#moveToBookmark">moveToBookmark</A> method to move the text range back to the same start and end positions as when the bookmark was created. 

<H3><A NAME="textrange_commands">Commands</A></H3>
<P>You can use commands to apply formatting and to carry out special actions on the text of a text range. You execute a command by using the <A HREF="../references/methods/execCommand.htm#execCommand">execCommand</A> method. You supply a command identifier and provide any additional command parameters. For example, you can change text to bold by using the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Command_Identifiers>
</object><A HREF=JavaScript:hhal_3.Click()>Bold</A> command as in the following JScript example. 

<PRE>var rng = document.body.createTextRange();
rng.collapse();
rng.expand("sentence");
rng.execCommand("Bold");
</PRE>

<P><BUTTON onclick="if (CheckCAB(3)) {window.open('../../../samples/dhtml/overview/cont_08.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL><P>The above example makes bold all text up to the first period in the document. 

<P>Not all commands are available at all times. You can determine whether a command is available for a given text range by using the <A HREF="../references/methods/queryCommandEnabled.htm#queryCommandEnabled">queryCommandEnabled</A> and <A HREF="../references/methods/queryCommandSupported.htm#queryCommandSupporte">queryCommandSupported</A> methods. For a list of commands, see
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Command_Identifiers>
</object><A HREF=JavaScript:hhal_4.Click()>Command Identifiers</A>. 

<P>To determine whether a given command has already been applied to a text range, use the <A HREF="../references/methods/queryCommandState.htm#queryCommandState">queryCommandState</A> method to retrieve the state of the command. The state is true if the command has been applied.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>