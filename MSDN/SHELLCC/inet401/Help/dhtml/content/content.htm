<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dynamic Content</TITLE>

<META NAME=MS-HKWD CONTENT="Dynamic Content">
<META NAME="Keywords" CONTENT="Dynamic HTML, DHTML, IE4, Internet Explorer 4.0, dynamic content">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="bk_dcontent"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Dynamic Content"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbara.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Dynamic Content"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../dhtml.htm">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../styles/printing.htm">Style Sheets and Printing</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="TextRange.htm">Using the TextRange Object</A></PRE></TD></TR>
</TABLE>
<!-- NAVLINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><A NAME="dhtml_content">Dynamic Content</A></H1>
<BR CLEAR=ALL>

<P>Before Microsoft&#174; Internet Explorer 4.0, once a Web page was loaded into a user's browser, changing the information displayed on the page required another round-trip to the server. The user interacted with the page (submitted a form, or clicked a link to another page), and the server delivered a new page to the client. Any customization of the information (such as building the page on the fly from a template) required that the server spend additional time processing a page request. Furthermore, the only way to maintain the context for the page's content was to use frame sets, where one frame's content stays constant and another frame changes its content based on the user's activity on the initial page. 

<P>Dynamic content is all about changing the content of the HTML document&#151;inserting and deleting elements or the contents of an element before or <I>after</I> the document has been loaded. To see an example of how dynamic content works, enter text in the text box to change the following text: 

<P><H3 id=mytitle>Dynamic content is cool</H2>
<P><input type='text' size='20' value='Enter new text here' id='newtitle'> <input type='button' value='Change Title' onclick='(document.all.mytitle.innerText=document.all.newtitle.value)'>
<P>Internet Explorer 4.0 gives you a rich set of properties and methods to dynamically construct and alter Web pages on the fly. For example, a script can insert a list of section titles at the beginning of the document, or replace that list with a list of links to the actual sections in the document.

<P>The following topics show how to dynamically access and modify the content in your Web pages. 

<P><A HREF="content.htm#dc_changing">Changing HTML Content</A>
<P><A HREF="content.htm#dc_adding">Adding Document Content</A>
<P><A HREF="content.htm#dc_building">Example: Building a Table of Contents</A>
<P><A HREF="content.htm#dc_topics">Advanced Topics</A>

<P>For more information about advanced text manipulation that can be done using a <A HREF="../references/objects/obj_TextRange.htm#obj_TextRange">TextRange</A> object, see <A HREF="TextRange.htm#dc_textrange">Using the TextRange Object</A>.

<P><B><A NAME="dc_changing">Changing HTML Content</A></B>

<P>Internet Explorer 4.0 provides a set of properties and methods on each element that are designed to make it quite simple to change the document. There are four properties that provide the ability to see what's inside an element on the page and replace that content with new information: <A HREF="../references/properties/innerText.htm#innerText">innerText</A>, <A HREF="../references/properties/outerText.htm#outerText">outerText</A>, <A HREF="../references/properties/innerHTML.htm#innerHTML">innerHTML</A>, and <A HREF="../references/properties/outerHTML.htm#outerHTML">outerHTML</A>. 

<P>Assigning new text (also called a "string") to one of these properties replaces the contents of the element, including any elements contained by that element, with the new string. Consider the following HTML for an <A HREF="../references/objects/H1.htm#H1">H1</A> heading. 

<PRE>&lt;H1 id=myH1&gt;Dynamic Content is Very Cool!&lt;/H1&gt;
</PRE>

<P>The content of the <A HREF="../references/objects/H1.htm#H1">H1</A> can be changed with the <A HREF="../references/properties/innerText.htm#innerText">innerText</A> property. 

<PRE>document.all.myH1.innerText = "DHTML is Very Cool"
</PRE>

<P>The <A HREF="../references/objects/H1.htm#H1">H1</A> element remains in the document, while the content of the <B>H1</B> changes to contain the new string "DHTML is Very Cool". The string assigned to <A HREF="../references/properties/innerText.htm#innerText">innerText</A> renders any HTML tags as text, and does not process the HTML. To insert HTML code into the contents of another element, you must use the <A HREF="../references/properties/innerHTML.htm#innerHTML">innerHTML</A> property. 

<PRE>document.all.myH1.innerHTML = "DHTML is &lt;I&gt;Very&lt;/I&gt; Cool!"
</PRE>

<P>The new string replaces the original content of the <A HREF="../references/objects/H1.htm#H1">H1</A>, and the word "Very" appears in italic. 

<P>The <A HREF="../references/properties/outerText.htm#outerText">outerText</A> and <A HREF="../references/properties/outerHTML.htm#outerHTML">outerHTML</A> properties represent the element itself, as well as the contents of the element. Assuming that the preceding example is contained by a <A HREF="../references/objects/BODY.htm#BODY">BODY</A> element, using an <B>outerText</B> property on the <A HREF="../references/objects/H1.htm#H1">H1</A> replaces the entire element with the string attached. The following script causes the <B>H1</B> to go away entirely, and the text string appears where the element was in the flow of the <B>BODY</B> 's content.

<PRE>document.all.myspan.outerText = "DHTML is VERY Cool!"
</PRE>

<P>The <A HREF="../references/properties/outerHTML.htm#outerHTML">outerHTML</A> property replaces the element with rich HTML. Much like the example above where HTML was inserted in the <A HREF="../references/objects/H1.htm#H1">H1</A>, using the <B>outerHTML</B> property will do the same, except the <B>H1</B> would also be removed. 

<PRE>document.all.myH1.outerHTML = "&lt;SPAN STYLE='height:0;width:200;FILTER:Shadow(color=#00FF00)'&gt;RICH HTML&lt;/SPAN&gt;";
</PRE>

<P><BUTTON onclick="if (CheckCAB(3)) {window.open('../../../samples/dhtml/overview/cont_01.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL><P><B><A NAME="dc_adding">Adding Document Content</A></B>

<P>The properties described above replace the entire contents of an element with a new string. What if you only want to insert new text or HTML and don't want to change what is already in the document? There are two helper methods on most elements that help you do just this. 

<P>These methods, <A HREF="../references/methods/insertAdjacentHTML.htm#insertAdjacentHTML">insertAdjacentHTML</A> and <A HREF="../references/methods/insertAdjacentText.htm#insertAdjacentText">insertAdjacentText</A>, place the new content at the beginning or end of the element, leaving the existing content intact. These methods all take a parameter that indicates one of four possible places the new content can be inserted with regard to the element: <I>BeforeBegin</I>, <I>AfterBegin</I>, <I>BeforeEnd</I>, and <I>AfterEnd</I>.

<P>The following example appends a new paragraph to the end of the document when it loads. 

<PRE>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Dynamic Content: Inserting Elements&lt;/TITLE&gt;
&lt;SCRIPT LANGUAGE="JScript"&gt;
function insertPara()
{
   document.body.insertAdjacentHTML("BeforeEnd", "&lt;P&gt;But adding a line makes it less so.");
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY onload="insertPara()"&gt;
&lt;P&gt;This is a &lt;B&gt;very&lt;/B&gt; short document.
&lt;/P&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

<P><BUTTON onclick="if (CheckCAB(3)) {window.open('../../../samples/dhtml/overview/cont_02.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL><P><B><A NAME="dc_building">Example: Building a Table of Contents</A></B>

<P>Building a table of contents is a good example of dynamic content at its best. By using a relatively small amount of script, you can automatically generate a detailed list of the contents of any document. 

<P>This example consists of three functions: buildTOC, setAnchor, and setLink. 
The buildTOC function creates the table of contents, calling the other two functions to apply anchors and insert the links. The example depends on the document having an element, such as <A HREF="../references/objects/DIV.htm#DIV">DIV</A> or <A HREF="../references/objects/P.htm#P">P</A>, that has the identifier "MyTOC". The setLink function inserts the links there. To build the table successfully, buildTOC cannot be called until the document is fully loaded. 

<P>Once buildTOC is called, it uses the <A HREF="../references/collections/all.htm#all">all</A> collection to check each element to see whether it is a header element: <A HREF="../references/objects/H1.htm#H1">H1</A>, <A HREF="../references/objects/H2.htm#H2">H2</A>, <A HREF="../references/objects/H3.htm#H3">H3</A>, or <A HREF="../references/objects/H4.htm#H4">H4</A>. It starts the search at the first element after the <A HREF="../references/objects/BODY.htm#BODY">BODY</A> element since no links are possible before this. When it finds a header, it sets the "level" variable and calls the setAnchor and setLink functions. 

<PRE>function buildTOC() {
    var coll = document.all;
    var level;
    var id;
    for (i=document.body.sourceIndex+1; i&lt;coll.length; i++) {
        switch (coll[i].tagName) {
        case "H1":
            level = 0;
            break;
        case "H2":
            level = 1;
            break;
        case "H3":
            level = 2;
            break;
        case "H4":
            level = 3;
            break;
        default:
            level = -1;
        }
        if (level!=-1) {
            id = i;
            setAnchor(coll[i], id);
            i++;
            setLink(coll[i], level, id);
            i+=2;
        }
    }
}
</PRE>

<P>Notice how the variable "i" is updated after the call to setAnchor and setLink. These functions insert new elements into the document, causing the <A HREF="../references/collections/all.htm#all">all</A> collection to be immediately updated and requiring a new index value for the heading. The setAnchor function inserts one element before the heading, so the index is increased by one; the setLink function inserts two elements at the top of the document, so the index is increased by two. 

<P>The setAnchor function adds an <A HREF="../references/objects/A.htm#A">A</A> element to the document, inserting the start and ends tags for this element immediately before and after the header tag, and setting the <A HREF="../references/html/A.htm#NAME_">NAME=</A> attribute of the new element to be equal to the "id" parameter passed to the function. 

<PRE>function setAnchor(el, id) {
    el.insertAdjacentHTML("BeforeBegin", "&lt;A NAME=\"" + id + "\"&gt;");
    el.insertAdjacentHTML("AfterEnd", "&lt;/A&gt;");
}
</PRE>

<P>The setLink function adds another <A HREF="../references/objects/A.htm#A">A</A> element to the document. This time the element is a link to the heading that setAnchor just created an anchor for. The <A HREF="../references/html/A.htm#HREF_">HREF=</A> attribute is set to the same "id" value as was set in the matching anchor. Notice that the setLink function places the link just before the end of the element having the identifier "MyTOC", separating it from the previous link with a <A HREF="../references/objects/BR.htm#BR">BR</A> element and inserting zero or more nonbreaking spaces for a very simple way to indicate the heading level. 

<PRE>function setLink(el, level, id) {
    document.all.MyTOC.insertAdjacentHTML("BeforeEnd", "
");
    var s = "&amp;nbsp;";
    for (j=0; j&lt;level; j++)
        s = s + s;
    document.all.MyTOC.insertAdjacentHTML("BeforeEnd", 
        s + "&lt;A HREF=\"#" + id + "\"&gt;" + el.innerText + "&lt;/A&gt;");
}
</PRE>

<P><BUTTON onclick="if (CheckCAB(3)) {window.open('../../../samples/dhtml/overview/cont_03.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL><P>There are a few things to keep in mind when you are dynamically changing content in your Web page. 

<P><B>Can't modify the content until after the document has been loaded:</B> Keep in mind that you cannot assign a string to these properties until the document has been completely loaded, that is, until the <A HREF="../references/events/onload.htm#onload">onload</A> event occurs. If you attempt to do so before loading, an error occurs.

<P>Be careful! When you add an element to a document, the <A HREF="../references/collections/all.htm#all">all</A> and other element collections are automatically updated to reflect the change. This also affects the value of the <A HREF="../references/properties/sourceIndex.htm#sourceIndex">sourceIndex</A> for elements that follow the new elements. If you have saved the index value of an element, be careful to update that value or retrieve a new value whenever you add or delete elements in a document. 

<P><B>Can't put invalid HTML in the document: </B>You cannot assign a string to <A HREF="../references/properties/innerHTML.htm#innerHTML">innerHTML</A> or <A HREF="../references/properties/outerHTML.htm#outerHTML">outerHTML</A> that contains invalid HTML. For example, trying to replace the content of the <A HREF="../references/objects/P.htm#P">P</A> element with another <B>P</B> will fail. A <B>P</B> element can only contain text and inline elements. However, replacing the entire <B>P</B> element with another <B>P</B> would work just fine. 

<P><B>Which Elements Will This Work For?</B> 

<P>Here are a few guidelines for which elements you can expect these properties and methods to work. 

<P>Only elements that appear in the <A HREF="../references/objects/BODY.htm#BODY">BODY</A> of the document can be changed with these properties. You can replace the contents of the <B>BODY</B>, but you can't replace the <B>BODY</B> itself. 

<P>This should be obvious, but deserves mention anyway: you can't replace the contents of an element where the element type doesn't have any contents like the replaced elements, <A HREF="../references/objects/INPUT.htm#INPUT">INPUT</A> and <A HREF="../references/objects/IMG.htm#IMG">IMG</A>. 

<P>The contents of a <A HREF="../references/objects/TD.htm#TD">TD</A> can be changed (<A HREF="../references/properties/innerText.htm#innerText">innerText</A> and <A HREF="../references/properties/innerHTML.htm#innerHTML">innerHTML</A>) and the <A HREF="../references/objects/TABLE.htm#TABLE">TABLE</A> element itself can be replaced (<A HREF="../references/properties/outerText.htm#outerText">outerText</A> and <A HREF="../references/properties/outerHTML.htm#outerHTML">outerHTML</A>), but no other table elements and their contents can be changed with these properties.

<P><B><A NAME="dc_topics">Advanced Topics</A></B>

<P>The following sections provide information on more advanced text manipulation.

<P><A HREF="TextRange.htm#dc_textrange">Using the TextRange Object</A>
<P><A HREF="finding_text.htm#dc_finding">Finding Text in the Document</A>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>