<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tips and Tricks</TITLE>

<META NAME=MS-HKWD CONTENT="Tips and Tricks">
<META NAME="Keywords" CONTENT="Dynamic HTML, DHTML, IE4, Internet Explorer 4.0">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="dhtml_tips"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Tips and Tricks"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbara.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Tips and Tricks"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../more_refs.htm#part_addrefs">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../colors/colors.htm">Color Table</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../../howto/howto.htm">DHTML Tutorials</A></PRE></TD></TR>
</TABLE>
<!-- NAVLINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Tips and Tricks</H1>
<BR CLEAR=ALL>
<P>As with any type of programming, writing bug-free, efficient scripts that meet your expectations takes a bit of work. The following sections provide some tips and hints to make that work take less time and go more smoothly.
<P><A CLASS=tctop HREF="tips.htm#Checking_the_Interne"><IMG SRC="../../../art/arrowr.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowr.gif">Checking the Internet Explorer Version Number</A><BR>
<P><A CLASS=tctop HREF="tips.htm#Canceling_a_Button_C"><IMG SRC="../../../art/arrowr.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowr.gif">Canceling a Button Click</A><BR>
<P><A CLASS=tctop HREF="tips.htm#Preventing_a_Documen"><IMG SRC="../../../art/arrowr.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowr.gif">Preventing a Document From Being Cached</A><BR>
<P><A CLASS=tctop HREF="tips.htm#Using_Objects"><IMG SRC="../../../art/arrowr.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowr.gif">Using Objects</A><BR>
<P><A CLASS=tctop HREF="tips.htm#Replacing_Custom_Con"><IMG SRC="../../../art/arrowr.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowr.gif">Replacing Custom Controls with Dynamic HTML</A><BR>
<H2><A NAME="Checking_the_Interne">Checking the Internet Explorer Version Number</A></H2>
<P>Your scripts should always check the version of the client browser so as to degrade gracefully if the browser does not support the new features of Internet Explorer version 4. The easiest way to identify whether the browser is Internet Explorer and determine its version number is to use the following JScript function:

<PRE>function msieversion()
// return Microsoft Internet Explorer (major) version number, or 0 for others.
// This function works by finding the "MSIE " string and extracting the version number
// following the space, up to the decimal point for the minor version, which is ignored.
{
    var ua = window.navigator.userAgent
    var msie = ua.indexOf ( "MSIE " )
    if ( msie &gt; 0 )        // is Microsoft Internet Explorer; return version number
        return parseInt ( ua.substring ( msie+5, ua.indexOf ( ".", msie ) ) )
    else
        return 0    // is other browser
}
</PRE>

<P>This function runs on the large majority of browsers and returns the major version number for any Microsoft Internet Explorer browser, or zero for all other browsers. Use of this function assures that the script will be compatible with future versions of Internet Explorer.

<P>Scripts should always check version numbers greater than or equal so as to be compatible with future versions. Existing scripts that check for userAgent equal to "MSIE 3" should be changed to check the version correctly so that these scripts will recognize Internet Explorer 4.0 which supports all of the functionality of the previous version.

<P>The following example shows how to correctly check the client browser version. 

<PRE>if ( msieversion() &gt;= 4 )
    document.alert( "This is IE4 or later - safe to use all IE4 features" )
else if ( msieversion() &gt;= 3 )
    document.alert( "This is IE3 - safe to use ActiveX" )
else
    document.alert( "This is not IE" )
</PRE>
<H2><A NAME="Canceling_a_Button_C">Canceling a Button Click</A></H2>
<P>The following HTML example shows a common scripting mistake related to event handling and canceling the default action. 

<PRE>&lt;HTML&gt;
&lt;HEAD&gt;&lt;TITLE&gt;Canceling the Default Action&lt;/TITLE&gt;
&lt;SCRIPT LANGUAGE="JScript"&gt;
function askConfirm() {
    return window.confirm ("Choose OK to follow hyperlink, Cancel to not.")
}
&lt;/SCRIPT&gt;

&lt;BODY onload="b3.onclick=askConfirm"&gt;
&lt;!-- Try links with different hookups - should be canceled by "Cancel" to confirm dialog. --&gt;

&lt;BR&gt;&lt;A NAME=b1 HREF="http://www.microsoft.com" onclick="askConfirm()"&gt;1 Without return (won't work)&lt;/A&gt;

&lt;BR&gt;&lt;A NAME=b2 HREF="http://www.microsoft.com" onclick="return askConfirm()"&gt;2 With return (works)&lt;/A&gt;

&lt;BR&gt;&lt;A NAME=b3 HREF="http://www.microsoft.com"&gt;3 Function pointer (works)&lt;/A&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

<P>The first <A HREF="../objects/A.htm#A">A</A> element in this example does not work properly. Without the <B>return</B> in the <A HREF="../events/onclick.htm#onclick">onclick</A> JScript expression, the browser interprets the function expression, throws away the resulting value (this is just a statement consisting of an expression, no assignment, an so on), and leaves the default action unaffected. 

<P>The other <A HREF="../objects/A.htm#A">A</A> elements correctly bind the return value to the event, hence the default action 
can be canceled when false is returned.

<H2><A NAME="Preventing_a_Documen">Preventing a Document From Being Cached</A></H2>
<P>You can prevent a document from being cached by adding the following <A HREF="../objects/META.htm#META">META</A> tag to the document. 

<PRE>&lt;META HTTP-EQUIV="Expires" CONTENT="0"&gt;
</PRE>

<P>Preventing the document from being cached ensures that a fresh copy of the document will always be retrieved from the site, even during the user's current session, regardless of how the user has set his browser's caching options. This is useful if the content of the document changes frequently.

<H2><A NAME="Using_Objects">Using Objects</A></H2>
<P>Objects are ActiveX controls or other similar components that provide custom capabilities and services for HTML documents. You can add a control to your document by using the <A HREF="../objects/OBJECT.htm#OBJECT">OBJECT</A> element, and gain access to the capabilities and services of the control by using its properties and methods from script.

<P>When using objects, be aware that Dynamic HTML extends every object by providing these additional properties:

<TABLE>
<TR><TD><A HREF="../properties/align_0.htm#align_0">align</A> </TD><TD><B>BaseHref</B></TD></TR>
<TR><TD><A HREF="../properties/classid.htm#classid">classid</A> </TD><TD><A HREF="../properties/code.htm#code">code</A></TD></TR>
<TR><TD><A HREF="../properties/codeBase_0.htm#codeBase_0">codeBase</A> </TD><TD><A HREF="../properties/codeType.htm#codeType">codeType</A></TD></TR>
<TR><TD><A HREF="../properties/data.htm#data">data</A> </TD><TD><A HREF="../properties/form.htm#form">form</A></TD></TR>
<TR><TD><A HREF="../properties/height_2.htm#height_2">height</A> </TD><TD><A HREF="../properties/name_2.htm#name_2">name</A></TD></TR>
<TR><TD><A HREF="../properties/object.htm#object">object</A> </TD><TD><A HREF="../properties/recordset.htm#recordset">recordset</A></TD></TR>
<TR><TD><A HREF="../properties/type_5.htm#type_5">type</A> </TD><TD><A HREF="../properties/width_1.htm#width_1">width</A></TD></TR>
</TABLE>
<P>If a control has properties with these same names, you will not be able to access the properties unless you preface the name with the <A HREF="../properties/object.htm#object">object</A> property. For example, assume that an ActiveX control is added to the document by using the following.

<PRE>&lt;OBJECT ID="MyControl" HEIGHT=100 WIDTH=200 CLASSID="clsid: ... "&gt;
&lt;/PARAM NAME="width" VALUE="400"&gt;
&lt;/OBJECT&gt;
</PRE>

<P>In this example, there are two widths: an extended property set within the <A HREF="../objects/OBJECT.htm#OBJECT">OBJECT</A> element, and a property belonging to the control that is set using the <A HREF="../html/PARAM.htm#PARAM">PARAM</A> element. To access these from script, you use the following code.

<PRE>alert(MyControl.width);   // this is Dynamic HTML's property; displays "200"
alert(MyControl.object.width);  // this is the object's property; displays "400"
</PRE>
<H2><A NAME="Replacing_Custom_Con">Replacing Custom Controls with Dynamic HTML</A></H2>
<P>Dynamic HTML provides everything you need to generate animated effects without resorting to custom controls. For example, consider the following script, which is a replacement for the Path control. 

<PRE>var tickDuration;
tickDuration = 50;

var activeObjectCount;
var activeObjects;
var itemDeactivated;

var tickGeneration;

activeObjects = new Array();
activeObjectCount = 0;
timerRefcount = 0;
itemDeactivated = false;

tickGeneration = 0;

function initializePath(e) {
 e.waypointX = new Array();
 e.waypointY = new Array();
 e.duration = new Array();

}

function addWaypoint(e, number, x, y, duration) {
 e.waypointX[number] = x;
 e.waypointY[number] = y;
 e.duration[number] = duration;
}

function compact() {
  var i, n, c;

  n = new Array();
  c = 0;
  itemDeactivated = false;
  for (i=0; i&lt;activeObjectCount; i++)  {
     if (activeObjects[i].active == true) {
        n[c] = activeObjects[i];
        c++;
     }
  }

  activeObjects = n;
  activeObjectCount = c;
}

function tick(generation) {

  if (generation &lt; tickGeneration) {
    // alert("Error "+generation);
     return;
  }

  //alert("tick: "+generation);

  if (itemDeactivated)
     compact();

  if (activeObjectCount == 0) {
     return;
  }
  else {
    for (i=0; i&lt;activeObjectCount; i++) {
      moveElement(activeObjects[i]);
    }

    window.setTimeout("tick("+generation+");", tickDuration);
  }
}

function start(e) {
  if (itemDeactivated)
     compact();

  activeObjects[activeObjectCount] = e;
  activeObjectCount++;

  if (activeObjectCount == 1) { 
    tickGeneration++;
    tick(tickGeneration);
  }
}

function runWaypoint(e, startPoint, endPoint) {

  var startX, startY, endX, endY, duration;

  if (e.waypointX == null)  
    return;   

  startX = e.waypointX[startPoint];
  startY = e.waypointY[startPoint];
  endX = e.waypointX[endPoint];
  endY = e.waypointY[endPoint];

  duration = e.duration[endPoint];
  e.ticks = duration / tickDuration;

  e.endPoint = endPoint;
  e.active = true;
  e.currTick = 0;

  e.dx = (endX - startX) / e.ticks;
  e.dy = (endY - startY) / e.ticks;

  e.style.posLeft = startX;
  e.style.posTop = startY;

  start(e);
}  

function moveElement(e) {
  e.style.posLeft += e.dx;
  e.style.posTop += e.dy;

  e.currTick++;

  if (e.currTick &gt; e.ticks) {
    e.active = false;
    itemDeactivated = true;
    if (e.onpathcomplete != null) {
       window.pathElement = e;
       e.onpathcomplete()
    }
  }
}
</PRE>

<P>To use this script in your document, do the following:

<OL><LI>Load the script by using the <A HREF="../properties/src_0.htm#src_0">src</A> attribute of the <A HREF="../objects/SCRIPT.htm#SCRIPT">SCRIPT</A> element.
<LI>Initialize the paths by using the initializePath function.
<LI>Set the way points by using the addWaypoint function.
<LI>Set the path-complete handlers, using the runWaypoint function.
</OL>
<P>The following sample document show how this works.

<PRE>&lt;html&gt;

&lt;body&gt;

&lt;div id=Item1 style="position: absolute; left: 0; top: 0;"&gt;Item1&lt;/div&gt;
&lt;div id=Item2 style="position: absolute; left: 0; top: 0;"&gt;Item2&lt;/div&gt;
&lt;div id=Item3 style="position: absolute; left: 0; top: 0;"&gt;Item3&lt;/div&gt;
&lt;div id=Item4 style="position: absolute; left: 0; top: 0;"&gt;Item4&lt;/div&gt;
&lt;div id=Item5 style="position: absolute; left: 0; top: 0;"&gt;Item5&lt;/div&gt;
&lt;div id=Item6 style="position: absolute; left: 0; top: 0;"&gt;Item6&lt;/div&gt;

&lt;input type=button value="Start" onclick="runWaypoint(Item1, 0, 1); runWaypoint(Item2, 0, 1);"&gt;
&lt;div id=Debug&gt;Generation&lt;/div&gt;

&lt;script src="htmlpath.js"&gt;
&lt;/script&gt;

&lt;script&gt;

// need to call initializePath on all objects that will be moved with this mechanism
initializePath(Item1);
initializePath(Item2);
initializePath(Item3);
initializePath(Item4);
initializePath(Item5);
initializePath(Item6);

// the 0th waypoint is the intial position for waypoint #1
// syntax is item, waypoint, endx, endy, duration in msecs
addWaypoint(Item1, 0, 0, 0, 0);
addWaypoint(Item1, 1, 200, 200, 2000);

addWaypoint(Item2, 0, 100, 100, 0);
addWaypoint(Item2, 1, 400, 100, 4000);

addWaypoint(Item3, 0, 400, 400, 0);
addWaypoint(Item3, 1, 200, 100, 1000);

addWaypoint(Item4, 0, 0, 0, 0);
addWaypoint(Item4, 1, 200, 200, 2000);

addWaypoint(Item5, 0, 100, 100, 0);
addWaypoint(Item5, 1, 400, 100, 4000);

addWaypoint(Item6, 0, 400, 400, 0);
addWaypoint(Item6, 1, 200, 100, 1000);

function endfunction() {
  // syntax for runWaypoint is Item, start point, end point
  runWaypoint(Item3, 0, 1);
  runWaypoint(Item4, 0, 1);
  runWaypoint(Item5, 0, 1);
  runWaypoint(Item6, 0, 1);

}

function endfunction2() {
  runWaypoint(Item1, 0, 1);
}

Item1.onpathcomplete = endfunction;
Item6.onpathcomplete = endfunction2;

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</PRE>

<P>
<BUTTON onclick="if (CheckCAB(3)) {window.open('../../../../samples/dhtml/overview/tips_01.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>