<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BanUsers Method</TITLE>
<META NAME=MS-HKWD CONTENT="BanUsers Method">
<META NAME="Keywords" CONTENT="Component Library">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="BanUsers"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="BanUsers Method"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="BanUsers Method"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../VB_ref.htm#ch_mschatpr_vb">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="AboutBox.htm">AboutBox Method</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CancelConnectLogin.htm">CancelConnectLogin Method</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>BanUsers Method<BR CLEAR=ALL>
<HR></H1>
<P>Bans users from the server and reinstates users to the server.

<P class=ref>Syntax
<BLOCKQUOTE>
<PRE><I>object</I><B>.BanUsers</B> <I>UserItems</I><B>,</B> <I>Set</I>[<B>,</B> <I>Reason</I>][<B>,</B> <I>Duration</I>]<BR>
</PRE>
</BLOCKQUOTE>

<P class=ref>Parameters
<BLOCKQUOTE>
<TABLE WIDTH=87%>
<TR><TD><I>object</I></TD><TD>Required. An object expression that evaluates to an <A HREF="mschatpr.htm#MsChatPr">MsChatPr</A> control.</TD></TR>
<TR><TD><I>UserItems</I></TD><TD>Required. An object expression that evaluates to a <A HREF="items.htm#ChatItems">ChatItems</A> object. Defines which users are banned or reinstated. The item names that can be used to construct the <B>ChatItems</B> object are:
<TABLE BORDER=0>
<TR><TD><A HREF="chatusr_prop.htm#nn">Nickname</A></TD></TR>
<TR><TD><A HREF="chatusr_prop.htm#useniop">NicknameOp</A></TD></TR>
<TR><TD><A HREF="chatusr_prop.htm#usena">UserName</A></TD></TR>
<TR><TD><A HREF="chatusr_prop.htm#usenaop">UserNameOp</A></TD></TR>
<TR><TD><A HREF="chatusr_prop.htm#useip">IPAddress</A></TD></TR>
<TR><TD><A HREF="chatusr_prop.htm#useop">IPAddressOp</A></TD></TABLE></TD></TR>
<TR><TD><I>Set</I></TD><TD>Required. A Boolean variable that determines whether the users are banned or reinstated.</TD></TR>
<TR><TD><I>Reason</I></TD><TD>Optional. A variant that is used if <I>Set</I> is TRUE to contain the reason for banishing users.</TD></TR>
<TR><TD><I>Duration</I></TD><TD>Optional. A variant that is used if <I>Set</I> is TRUE to indicate, in minutes, the length of time a user or users will be banned.</TD></TR>
</TABLE>
</BLOCKQUOTE>

<P class=ref>Remarks
<BLOCKQUOTE>
<P>This feature is reserved for administrators and system operators only. Banned users will not be able to log on to the server. Some IRC servers do not provide this feature and will return an error code.
</BLOCKQUOTE>

<P class=ref>Examples
<BLOCKQUOTE>
<P>These examples illustrate methods of using <B>BanUsers</B> to ban users from the server and to reinstate users to the server. 
<P>1. Ban a specific user:
<PRE>Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType  = "Query"
chatitemobj.Item("UserName") = "RebeccaH"
chatitemobj.Item("IPAddressOp") = "EndsWith"
chatitemobj.Item("IPAddress") = ".microsoft.com"
MsChatPr1.BanUsers chatitemobj, True, "Abusive behavior"
Set chatitemobj = Nothing
</PRE>
<P>2. Ban all the users with an IP address that ends with .edu, for the duration of one hour:
<PRE>Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType  = "Query"
chatitemobj.Item("IPAddressOp") = "EndsWith"
chatitemobj.Item("IPAddress") = ".edu"
MsChatPr1.BanUsers chatitemobj, True, , 60
Set chatitemobj = Nothing
</PRE>
<P>3. Stop banning the same group:
<PRE>Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType  = "Query"
chatitemobj.Item("IPAddressOp") = "EndsWith"
chatitemobj.Item("IPAddress") = ".edu"
MsChatPr1.BanUsers chatitemobj, False
Set chatitemobj = Nothing
</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
