<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Microsoft Tabular Data Control</TITLE>
<META NAME=MS-HKWD CONTENT="Microsoft Tabular Data Control">
<META NAME="Keywords" CONTENT="Component Library">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_tabdata_ovr"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft Tabular Data Control"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft Tabular Data Control"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="tabdata.htm#book_tabdata">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="tabdata.htm">Tabular Data Control (TDC)</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="reference.htm">Microsoft Tabular Data Control Reference</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Microsoft Tabular Data Control</H1>
<BR CLEAR=ALL>
<P>The Tabular Data Control (TDC) is a Microsoft&#174; ActiveX&#153; control that can be hosted 
by Microsoft&#174; Internet Explorer 4.0 to display data stored in a delimited text file. 
Using the TDC, a Web author can display data either within tables or within controls 
found in a form. (Extensions in Internet Explorer 4.0 allow you to bind data to 
HTML elements on the page as well as to repeat the content of an HTML &lt;TABLE&gt; for each 
record of a data set. The latter can be thought of as using the table as a template for 
the data, where the template is repeated once for each record.)
<P>One of the primary features of the TDC is that it brings filtering and sorting operations 
to the client side (there are no server-side operations).
<P>The TDC exposes the OLE-DB simple provider interfaces. For more information about these interfaces, 
see
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_OLE_DB_Simple_Provider_A_Data_Binding_API_for_IE4_MSHTML>
</object><A HREF=JavaScript:hhal_3.Click()>OLE-DB Simple Provider: A Data Binding API for IE4/MSHTML</A>.
<P><A CLASS=tctop HREF="overview.htm#Source_Availability"><IMG SRC="../../art/arrowb.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowb.gif">Source Availability</A><BR>
<P><A CLASS=tctop HREF="overview.htm#Licensing_and_Distri"><IMG SRC="../../art/arrowb.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowb.gif">Licensing and Distribution</A><BR>
<P><A CLASS=tctop HREF="overview.htm#Dependencies"><IMG SRC="../../art/arrowb.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowb.gif">Dependencies</A><BR>
<P><A CLASS=tctop HREF="overview.htm#Understanding_the_Ta"><IMG SRC="../../art/arrowb.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowb.gif">Understanding the Tabular Data Control Object Model</A><BR>
<P><A CLASS=tctop HREF="overview.htm#TDC_USE"><IMG SRC="../../art/arrowb.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowb.gif">Using the Tabular Data Control</A><BR>
<P><A CLASS=tctop HREF="overview.htm#Summary"><IMG SRC="../../art/arrowb.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowb.gif">Summary</A><BR>
<H2><A NAME="Source_Availability">Source Availability</A></H2>
<P>To aid developers in creating their own data source objects, the Tabular Data Control 
is provided as a sample that ships with the Internet Client SDK. The source code can be found in 
\inetsdk\samples\tdc.
<H2><A NAME="Licensing_and_Distri">Licensing and Distribution</A></H2>
<P>The Microsoft Tabular Data Control is automatically installed as part of the base installation of Microsoft Internet Explorer version 4.0.
<H2><A NAME="Dependencies">Dependencies</A></H2>
<P>The TDC is found in the file Tdc.ocx, which is automatically installed and registered 
with all versions of Internet Explorer 4.0. 
<H2><A NAME="Understanding_the_Ta">Understanding the Tabular Data Control Object Model</A></H2>
<P>The TDC supports properties and methods that can be divided into these categories:
<UL><LI>Elements that describe the data file.
<LI>Elements that support data filtering.
<LI>Elements that support data sorting.
</UL>
<H3><A NAME="File_Properties">File Properties</A></H3>
<P>Most of the properties supported by the TDC are data-file properties. 
These properties specify the location of the data file, the language used to create the 
data file, the character used to delimit fields, and so on. The following list describes 
each property:
<TABLE BORDER=0>
<TR><TD><B>Property</B></TD>
<TD><B>Description
</B></TD>
</TR>
<TR><TD><A HREF="references/CharSet.htm#CharSet">CharSet</A></TD>
<TD>Identifies the character set used by the data file. The default character set is latin1.</TD>
</TR>
<TR><TD><A HREF="references/DataURL.htm#DataURL">DataURL</A></TD>
<TD>Specifies the location of the data file as a URL.</TD>
</TR>
<TR><TD><A HREF="references/EscapeChar.htm#EscapeChar">EscapeChar</A></TD>
<TD>Identifies the character to be used as an escape character in the data file. There is no default escape character.</TD>
</TR>
<TR><TD><A HREF="references/FieldDelim.htm#FieldDelim">FieldDelim</A></TD>
<TD>Identifies the character that is used to mark the end of a field in the data file. The default character is the comma (,).</TD>
</TR>
<TR><TD><A HREF="references/Language.htm#Language">Language</A></TD>
<TD>Specifies the language used to generate the data file (this specifier uses the HTML standard codes based on ISO 369). The default specifier is eng-us.</TD>
</TR>
<TR><TD><A HREF="references/TextQualifier.htm#TextQualifier">TextQualifier</A></TD>
<TD>Specifies the optional character that surrounds a field.</TD>
</TR>
<TR><TD><A HREF="references/RowDelim.htm#RowDelim">RowDelim</A></TD>
<TD>Identifies the character used to mark the end of each row of data. The default character is the newline (NL) character.</TD>
</TR>
<TR><TD><A HREF="references/UseHeader.htm#UseHeader">UseHeader</A></TD>
<TD>Specifies whether the first line of the data file contains header information. The default value is FALSE.</TD>
</TR>
</TABLE>
<H3><A NAME="TDC_FILTER">Filtering Properties</A></H3>
<P>One TDC property and one method apply to data filtering. 
<P>Set the <A HREF="references/Filter.htm#Filter">Filter</A> property to an expression that includes the name 
of the column to be filtered, the criteria for filtering, and the value that will be compared 
against the specified column using the given value. The default value is an empty string ("").
<P>Call the <A HREF="references/Reset.htm#Reset">Reset</A> method to apply the filter and refresh the contents of the HTML elements 
bound to the data supplied by the TDC.
<H3><A NAME="TDC_SORT">Sorting Properties</A></H3>
<P>One TDC property and a single TDC method apply to data sorting. 
<P>Set the <A HREF="references/Sort.htm#Sort">Sort</A> property to a semicolon-delimited list of column names by which the bound HTML elements should be sorted. 
Prefixing a column name with a plus (+) symbol indicates ascending order. The minus (-) symbol indicates descending order. 
The default sort order is ascending.
<P>Call the <A HREF="references/Reset.htm#Reset">Reset</A> method to apply the new sort order and to refresh the contents 
of the HTML elements bound to the data supplied by the TDC.
<H2><A NAME="TDC_USE">Using the Tabular Data Control</A></H2>
<P>This section demonstrates how you can incorporate the TDC into your Web pages.
<P><B>Note</B>  The TDC examples in this section require Internet Explorer 4.0.<H3><A NAME="A_Simple_Before_and_">A Simple Before-and-After Example</A></H3>
<P>This section contains a very simple example demonstrating how you can replace a static table in your HTML page with a dynamic table that is generated using the TDC. When this replacement occurs, you'll no longer need to modify your HTML source file each time your data changes; instead, you can simply modify the data file or regenerate it from a database.
<H4><A NAME="Adding_data_to_your_">Adding data to your Web page</A></H4>
<P>The Tabular Data Control (TDC) has many uses, but perhaps the easiest way to get a feel for its capabilities is to see a short example. If you have a data file containing some of the elements of the periodic table, it might look like this:
<PRE>Element,Symbol
Hydrogen,H
Helium,He
Lithium,Li
Beryllium,Be
Boron,B
Carbon,C
Nitrogen,N
Oxygen,O
Flourine,F
Neon,Ne
</PRE>
<P>Each line contains the name of the element followed by a comma, then its scientific abbreviation. If you wanted to display this table in a Web page without using the TDC, you would add the table tags around each word, as shown in the following example:
<PRE>&lt;TABLE&gt;
&lt;THEAD&gt;&lt;TR&gt;&lt;TD&gt;Element&lt;/TD&gt;&lt;TD&gt;Symbol&lt;/TD&gt;&lt;/TR&gt;&lt;/THEAD&gt;
&lt;TBODY&gt;
&lt;TR&gt;&lt;TD&gt;Hydrogen&lt;/TD&gt; &lt;TD&gt;H&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Helium&lt;/TD&gt; &lt;TD&gt;He&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Lithium&lt;/TD&gt; &lt;TD&gt;Li&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Beryllium&lt;/TD&gt; &lt;TD&gt;Be&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Boron&lt;/TD&gt; &lt;TD&gt;B&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Carbon&lt;/TD&gt; &lt;TD&gt;C&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Nitrogen&lt;/TD&gt; &lt;TD&gt;N&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Oxygen&lt;/TD&gt; &lt;TD&gt;O&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Flourine&lt;/TD&gt; &lt;TD&gt;F&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Neon&lt;/TD&gt; &lt;TD&gt;Ne&lt;/TD&gt;&lt;/TR&gt;
&lt;/TBODY&gt;
&lt;/TABLE&gt;
</PRE>
<P>Click the Show Me button to see how the previous table appears when viewed in your browser.

<P><BUTTON onclick="window.open('../../../samples/databind/eltstat.htm')">Show Me</BUTTON>
<BR CLEAR=ALL><P>A static table is not only tedious to create, but it also makes it inconvenient to edit or update the data. This especially applies if you want to use the raw data file in other applications. Using the TDC, you can instead tell the Web page where to find the text file, and it will read the data directly from the file (plus optionally sort it, filter it, and skip columns). The previous table coding is replaced with the following coding:
<PRE>&lt;TABLE datasrc=#elements&gt;
&lt;THEAD&gt;&lt;TR&gt;&lt;TD&gt;Element&lt;/TD&gt;&lt;TD&gt;Symbol&lt;/TD&gt;&lt;/TR&gt;&lt;/THEAD&gt;
&lt;TBODY&gt;
&lt;TR&gt;&lt;TD&gt;&lt;DIV datafld="Element"&gt;&lt;/DIV&gt;&lt;/TD&gt;&lt;TD&gt;&lt;DIV datafld="Symbol"&gt;&lt;/DIV&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TBODY&gt;
&lt;/TABLE&gt;
</PRE>
<P>Click the Show Me button to see how databinding can be used to replace a static table in Internet Explorer 4.0.

<P><BUTTON onclick="window.open('../../../samples/databind/eltdyn.htm')">Show Me</BUTTON>
<BR CLEAR=ALL><P>If you look more closely at these changes, you will note that the first line uses the DATASRC attribute to identify the TDC. (This identifier corresponds to the ID attribute that was specified for the &lt;OBJECT&gt; tag that loaded the control.)
<PRE>&lt;TABLE datasrc=#elements&gt;
</PRE>
<P>The prepended <B>#</B> symbol is always required by the DATASRC attribute. 
<P>You can include multiple linked tables and objects in each Web page; each table should specify a DATASRC attribute that can be unique to that table or shared between tables or other elements on the page, such as forms. 
<P>The second line of the table definition is unchanged. As you can see, it provides the table heading.
<PRE>&lt;THEAD&gt;&lt;TR&gt;&lt;TD&gt;Element&lt;/TD&gt;&lt;TD&gt;Symbol&lt;/TD&gt;&lt;/TR&gt;&lt;/THEAD&gt;
</PRE>
<P>The fourth line is the most interesting. Instead of providing the actual data, you specify the name of a column in the data file using the new DATAFLD attribute. 
<PRE>&lt;TR&gt;&lt;TD&gt;&lt;DIV datafld="Element"&gt;&lt;/DIV&gt;&lt;/TD&gt;&lt;TD&gt;&lt;DIV datafld="Symbol"&gt;&lt;/DIV&gt;&lt;/TD&gt;&lt;/TR&gt;
</PRE>
<P>Because the original data file had a header that specified the name of each column, these column names can be used. If no header is provided in your data file, you should use the default names of Column1, Column2, and so on.
<P>As part of the header that specifies column names, a type specifier can be included indicating the data type of the column. Since the TDC reads its data from a text file, this indicates the appropriate type conversion to do upon reading the data from the file. The TDC uses this to perform accurate sorting and filtering. Consider the case where you have integers in a column and you request the column to be sorted. Without the type specification, the sort would be done using string (lexicographic) ordering, which would give the wrong result. For more information on specifying data types for columns, see <A HREF="reference.htm#tabdata_ref">Microsoft Tabular Data Control Reference</A>.
<P>With this information encoded in the table, Internet Explorer 4.0 will ask the TDC for data to put into the table. It will then create one new row for each row of data. Notice how all the other table encoding tags remain unchanged. In fact, you can treat the incoming data exactly as if it were text that you hard-coded into your Web page. For example, if you wanted the symbols in the table to be bold and centered in their column, you could change the table entry to the following:
<PRE>&lt;TD&gt;&lt;CENTER&gt;&lt;B&gt;&lt;DIV datafld="Symbol"&gt;&lt;/DIV&gt;&lt;/B&gt;&lt;/CENTER&gt;&lt;/TD&gt;
</PRE>
<P>You could also choose to completely leave out the symbol information from the table just by removing the &lt;DIV&gt; entry where it is specified. Although this might not necessarily be appropriate for this example, it's often convenient to omit some fields because that allows you to reuse the same data file in many different Web pages rather than maintaining multiple copies of almost identical data.
<H4><A NAME="Declaring_the_TDC_ob">Declaring the TDC object</A></H4>
<P>The only other new entry in your Web page is the TDC object declaration. The above examples use the following:
<PRE>&lt;OBJECT id=elements CLASSID="clsid:333C7BC4-460F-11D0-BC04-0080C7055A83"&gt;
    &lt;PARAM NAME="DataURL" VALUE="minielts.txt"&gt;
    &lt;PARAM NAME="UseHeader" VALUE="True"&gt;
&lt;/OBJECT&gt;
</PRE>
<P>The ID attribute identifies the TDC and its associated data for later use by 
elements such as tables, forms, and scripting. The ID attribute can be any 
arbitrary name, but it's best to start with a letter and avoid spaces and 
punctuation characters.
<P>The <A HREF="references/DataURL.htm#DataURL">DataURL</A> property tells the TDC where to find the data file. 
You can provide any valid URL, or, as in this example, use a relative URL 
that will cause the TDC to look in the same place your Web page was found. 
Other valid <B>DataURL</B> settings include the following:
<PRE>&lt;PARAM NAME="DataURL" VALUE="data/elements.txt"&gt;
&lt;PARAM NAME="DataURL" VALUE="http://www.mycoolsite.com.au/elements.txt"&gt;
&lt;PARAM NAME="DataURL" VALUE="file://\\intranet\server\buried\down\a\long\path\elements.txt"&gt;
</PRE>
<P><A HREF="references/DataURL.htm#DataURL">DataURL</A> is the only property required by the TDC to access data. To delay the binding, omit the specification of the <B>DataURL</B> property in the object declaration, and set it later in script code.
<P>The <A HREF="references/UseHeader.htm#UseHeader">UseHeader</A> property indicates whether the first line of the data file identified by <A HREF="references/DataURL.htm#DataURL">DataURL</A> lists the names of the fields. 
In the example text file above, the first line was:
 
<PRE>Element,Symbol
</PRE>
<P>This isn't part of the data. Instead, it identifies the names of the columns in the data set. Because the default value of this property is FALSE, the <A HREF="references/UseHeader.htm#UseHeader">UseHeader</A> property must be set to TRUE.
<H4><A NAME="Relaxing_TDC_Securit">Relaxing TDC Security</A></H4>
<P>By default, if the <A HREF="references/DataURL.htm#DataURL">DataURL</A> property specifies a URL on a different domain than that of the Web page, the TDC will silently fail to load the data. This feature prevents unauthorized pages or untrusted scripts from using the TDC to access private data. To allow content providers to create pages that access data on a different domain, providers can insert a domain string in the data. The string begins with "@!allow_domains" and is followed by a semicolon-delimited list of domain names and/or IP addresses. The string must appear exclusively at the beginning of the first line in the data set with no preceding white-space. The exact specification for the format string is as follows:
<PRE>
   domain_string: header_string "=" domain_list
   header_string: "@!allow_domains"
   domain_list: domain_spec [; domain_list ]
   domain_spec: * | [*.] domain | ipaddr
</PRE>
<P>Observe that while wildcards may be used in domain names (*.microsoft.com), they are not supported in IP addresses.
<P>The following is an example of a domain string that could be embedded in a data set to enable a page hosted on all microsoft.com and investor.msn.com servers to access the data.
<PRE>
   @!allow_domains=*.microsoft.com; investor.msn.com
</PRE>
<H3><A NAME="A_More_Advanced_Exam">A More Advanced Example: Sorting and Filtering</A></H3>
<P>The example behind the following Show Me button demonstrates how you can automate the sorting and filtering of data in a table. Using the chemistry theme, the example displays a table that contains the first five periods of the periodic table. You can sort the data by clicking any of the three table headings (Position, Element, or Symbol); you can filter the data by choosing a specific period and group from the Period or Group list box.

<P><BUTTON onclick="window.open('../../../samples/databind/eltadv.htm')">Show Me</BUTTON>
<BR CLEAR=ALL><H4><A NAME="Sorting_data">Sorting data</A></H4>
<P>Dynamic sorting is enabled using the <A HREF="references/Sort.htm#Sort">Sort</A> property and the <A HREF="references/Reset.htm#Reset">Reset</A> method on the TDC. In the previous example, a VBScript function supports the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_onclick>
</object><A HREF=JavaScript:hhal_4.Click()>onclick</A> event for each column heading in the table. When the user clicks a given heading, the corresponding function is called and the <B>Sort</B> property is assigned a value prior to calling the <B>Reset</B> method. The following example shows the function that handles sorting for the Symbol column.
<PRE>function symbol_onclick()
    elem_list.Sort = "+Symbol"
    elem_list.Reset()
end function
</PRE>
<P>In this example, the <A HREF="references/Sort.htm#Sort">Sort</A> property is assigned the name of the third column (Symbol), and then the <A HREF="references/Reset.htm#Reset">Reset</A> method is called.
The "+" indicates an ascending sort. A "-" prefix indicates a descending sort.
<P>The following excerpt from the HTML source file for this example demonstrates how the column headings were set up using the HTML &lt;DIV&gt; tag.
<PRE>&lt;THEAD&gt;&lt;TR&gt;
     &lt;TD&gt;&lt;DIV ID=position&gt;&lt;B&gt;&lt;U&gt;&lt;FONT COLOR=BLUE&gt;Position&lt;/FONT&gt;&lt;/U&gt;&lt;/B&gt;&lt;/DIV&gt;&lt;/TD&gt;
     &lt;TD&gt;&lt;DIV ID=element&gt;&lt;B&gt;&lt;U&gt;&lt;FONT COLOR=BLUE&gt;Element&lt;/FONT&gt;&lt;/U&gt;&lt;/B&gt;&lt;/DIV&gt;&lt;/TD&gt;
     &lt;TD&gt;&lt;DIV ID=symbol&gt;&lt;B&gt;&lt;U&gt;&lt;FONT COLOR=BLUE&gt;Symbol&lt;/FONT&gt;&lt;/U&gt;&lt;/B&gt;&lt;/DIV&gt;&lt;/TD&gt;
&lt;/TR&gt;&lt;/THEAD&gt;
</PRE>
<H4><A NAME="Filtering_data">Filtering data</A></H4>
<P>Dynamic filtering is enabled using the <A HREF="references/Filter.htm#Filter">Filter</A> property and the <A HREF="references/Reset.htm#Reset">Reset</A> method of the TDC.
In the example, a VBScript function supports the
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_onchange>
</object><A HREF=JavaScript:hhal_5.Click()>onchange</A> event for each drop-down list box that appears above the table. When this function is invoked, a filter expression is constructed from the selected values in the Period and Group combo boxes, the expression is assigned to the <B>Filter</B> property, and the <B>Reset</B> method is called to synchronize the table displaying the data. 
<P>The following excerpt from the HTML source file shows the definition of the Period drop-down list box.
<PRE>
&lt;SELECT ID=cboPeriod&gt;
  &lt;OPTION SELECTED VALUE=0&gt;ALL
  &lt;OPTION VALUE=1&gt;1
  &lt;OPTION VALUE=2&gt;2
  &lt;OPTION VALUE=3&gt;3
  &lt;OPTION VALUE=4&gt;4
  &lt;OPTION VALUE=5&gt;5
&lt;/SELECT&gt;
 </PRE>
<P>When a user selects a different value from either the Period drop-down or the Group drop-down, the following VBScript function handles the resulting
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_onchange>
</object><A HREF=JavaScript:hhal_6.Click()>onchange</A> event.
<PRE>function FilterGroupAndPeriod()
   cFilterExpr = ""
   if cboPeriod.selectedIndex &gt; 0 then
      cFilterExpr = "Period=" &amp; cboPeriod.selectedIndex
   end if
   if cboGroup.selectedIndex &gt; 0 then
      if Not IsEmpty(cFilterExpr) then
         cFilterExpr = cFilterExpr &amp; " &amp; "
      end if
      cFilterExpr = cFilterExpr &amp; "Group=" &amp; cboGroup.selectedIndex
      elem_list.object.Filter = cFilterExpr
   end if
   elem_list.object.Filter = cFilterExpr
   elem_list.Reset
end function 
</PRE>
<P>The code builds a single expression representing a filter on both the Period and the Group columns in the data set. Notice that if the first value (ALL) is selected in either drop-down, the respective code will not contribute to the filter expression. Also note that if the user has selected an explicit period as well as a group, the subexpressions are separated by an "&amp;" indicating to the TDC that the records to be displayed must meet both criteria. If the user selects "ALL" in both drop-downs, none of the code within the boundaries of the conditional statements is executed, the filter expression remains empty, and all the data is displayed in the bound table.
 
<P>The final line in this function invokes the <A HREF="references/Reset.htm#Reset">Reset</A> method, which evaluates the filter expression, applies it to the data set, and forces MSHTML to re-render the table in which the data is displayed.
<H2><A NAME="Summary">Summary</A></H2>
<P>This article has described the features of the Tabular Data Control, a simple read-only data source object provided with Internet Explorer 4.0. For more detailed information on the methods and properties supported by this object, see the <A HREF="reference.htm#tabdata_ref">Microsoft Tabular Data Control Reference</A>.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>

