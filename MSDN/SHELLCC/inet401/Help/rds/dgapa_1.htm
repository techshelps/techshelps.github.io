<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Remote Data Service</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Troubleshooting Remote Data Service">
<META NAME="Keywords" CONTENT="Remote Data Service">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>

<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft Remote Data Service"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft Remote Data Service"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="gs01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="adc_troubleshootingadc"></a>Appendix A: Troubleshooting Remote Data Service</H1>
<p>If you have problems running the Remote Data Service, first make sure you have met the hardware and software requirements for RDS. Then, make sure you have <A HREF="gs01_2.htm">installed Remote Data Service correctly</a> (see &quot;<A HREF="gs01_2.htm#adc_validatingsetup">Validating Setup</a>&quot; to validate your installation). 
<p>The following sections describe workarounds for more specific errors.
<p><a name="adc_accessdenied"></a><b>&quot;Internet Server Error: Access Denied&quot;</b>
<p>If you get this error, it usually means that <A HREF="dg01_1.htm#adc_dg_arch_iis">Microsoft Internet Information Server (IIS)</a> returned the following status:
<p>HTTP_STATUS_DENIED 401.
<p>Make sure the directories accessed by IIS have proper permissions. RDS 1.5 can communicate with an IIS Web server running in any one of the three Password Authentication modes: Anonymous, Basic, or NT Challenge/Response. Unlike previous versions, the <b>Allow Anonymous</b> setting is no longer required. (For more information, see &quot;HTTP Protocol Permissions Setting.&quot;) Also, the <A HREF="def01_37.htm">Web server</a> must have permissions to the data source computer if it is a Windows NT&reg; computer.
<p><a name="adc_unexpectederror"></a><b>&quot;Unexpected Error&quot; Message When Running the Sample Applications</b>
<p><b>Server Checklist</b>
<ul>
<li>
If you re-install IIS, you must re-install Remote Data Service afterwards. <br><br></li>
<li>
If you are using Microsoft SQL Server as your back-end data source, use Microsoft SQL Server 6.5, Service Pack 2 or later. <br><br></li>
<li>
Ensure that the ODBC DSNs are <A HREF="def01_23.htm">System DSNs</a> and not User DSNs. The Anonymous user logging on through IIS can view only System DSNs. <br><br></li>
<li>
Check that the anonymous account your WWW service uses is a user on your domain that has NTFS permissions to all the relevant servers and directories. Lastly, check that the password for this anonymous account hasn't expired. <br><br></li>
<li>
Because Remote Data Service is installed in the C:\Program Files\Common Files\System\MSADC directory, check that the Anonymous user from the IIS Service Manager can access this directory. It should have both <b>Read</b> and <b>Execute</b> access. <br><br></li>
<li>
If you have trouble with Remote Data Service DLLs and sample applications, re-register the DLLs by using Regsvr32.exe. <br><br></li>
<li>
If you are writing your own <A HREF="dg01_1.htm#adc_dg_arch_mt_bo">business objects</a>, place your <A HREF="dg01_1.htm#adc_dg_arch_active_server_pages">Active Server Pages</a> script files (.asp) in a directory that gives the Anonymous user (in IIS) execute permission.</li>
</ul>
<p><a name="adc_sheridancombo"></a><b>Using the RDS.DataControl with the Sheridan Combo Box Control</b>
<p>The Sheridan combo box has two properties that can be bound to <A HREF="ref01_1.htm"><b>RDS.DataControl</b></a> data. Just binding the combo box to <b>RDS.DataControl</b> doesn't automatically populate the &quot;Text&quot; portion, a non-bindable property, which shows the currently selected item. As a result, old data may still be displayed after the <A HREF="ref01_17.htm"><b>Refresh</b></a> method is called. 
<p>A workaround is to use code like either of the following two sample Visual Basic&reg; Scripting Edition Sub procedures. Both clear the <b>Text</b> property when the <b>Refresh</b> method is called. <code>SSCombo</code> is the name of the Sheridan combo box control in these examples.
<PRE>Sub SSCombo_InitColumnProps()
&#09;SSCombo.Text=&quot;&quot;
End Sub

Sub Refresh_OnClick
&#09;ADC1.Refresh
&#09;SSCombo.Text=&quot;&quot;
End Sub</pre>
<p><b>Sorting Client-side Recordset Data</b>
<p>To sort on a <b>Recordset</b>, any pending changes must first be saved. If you are using the <b>RDS.DataControl</b>, you can use the <b>SubmitChanges</b> method. For example, if your <b>RDS.DataControl</b> is named ADC1, your code would be <code>ADC1.SubmitChanges</code>. If you are using an ADO <b>Recordset</b>, you can use its <b>UpdateBatch</b> method. Using <b>UpdateBatch</b> is the recommended method for <b>Recordset</b> objects created with the <b>CreateRecordset</b> method. For example, your code could be <code>myRS.UpdateBatch</code> or <code>ADC1.Recordset.UpdateBatch</code>.
<p><a name="adc_deadlocksisolation"></a><b>Deadlocks With Read Repeatable Isolation Level</b>
<p>If a custom <A HREF="dg01_1.htm#adc_dg_arch_mt_bo">business object</a> uses an isolation level of read repeatable to access a SQL Server, and the business object is called simultaneously by two clients that send a query and update in the same transaction, a deadlock is possible. Remote Data Service is built to allow one of the processes to timeout to release the deadlock, but this will fail the update for that client.
<p>You can add a registry entry on the Web server to modify the length of the timeout. The default is 30 seconds (or 30,000 milliseconds).
<p><img src="art/prcarrow.gif" border=0><b>&#09;To modify the timeout value</b>
<ol>
<li>
From the <b>Start</b> menu, click <b>Run</b>.<br><br></li>
<li>
Type <b>RegEdit</b> and click <b>OK</b>.<br><br></li>
<li>
In the Registry Editor, navigate to the <b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W3SVC\Parameters</b> key.<br><br></li>
<li>
Select the <b>Parameters </b>key, and then from the <b>Edit </b>menu, point to <b>New</b>, and select <b>DWORD Value</b>.<br><br></li>
<li>
In the <b>Name </b>column, type <b>ADCUpdateTimeout </b>and press ENTER.<br><br></li>
<li>
Double-click the new entry. In the <b>Edit DWORD Value </b>dialog box, enter the new value in milliseconds in the <b>Value data</b> box. The value must be greater than or equal to zero.</li>
</ol>
<p><a name="adc_multipleresultset"></a><b>RDS.DataControl and Multiple Recordset Requests</b>
<p>If you query for multiple results, only the first <b>Recordset</b> is returned. If multiple result sets are needed, assign each to its own <A HREF="ref01_1.htm"><b>RDS.DataControl</b></a>. An example of a query for multiple results could be <code>&quot;Select * from Authors Select * from Topics&quot;</code>.
<p><a name="adc_tsadorvsadodb"></a><b>What's the difference between ADOR.Recordset and ADODB.Recordset?</b>
<p>Remote Data Service applications use <b>ADOR.Recordset </b>objects on the <A HREF="def01_7.htm">client side</a>. This makes it possible to access <A HREF="dg01_1.htm#adc_dg_arch_oledb">OLE DB</a> data sources with Visual Basic and VBScript code (rather than C), and get data to the client. If <b>ADODB.Recordset</b> is already registered on the client, it will use the full-featured <b>ADODB.Recordset</b> instead of <b>ADOR.Recordset</b>.
<p><A HREF="dg01_1.htm#adc_dg_arch_ado">Active Data Objects (ADO)</a> can exist in both the client and <A HREF="def01_6.htm">middle tiers</a>, but the <b>ADOR.Recordset</b> objects that Remote Data Service uses on the client side are leaner, and implement only the <b>Recordset</b> semantics. The ADO layer on the middle tier uses <b>ADODB.Recordset</b> objects and implements the <b>Connection</b> object and all other ADO semantics.
<p><b>See Also</b>   For more information about ADOR vs. ADODB, see <A HREF="dg01_1.htm#adc_adodbvsador">ADOR.Recordset vs. ADODB.Recordset Object</a>.
<p><a name="adc_tsadoincbo"></a><b>Using ADO in Custom Business Objects</b>
<p>If you used Visual Basic to create a custom business object that uses early binding with the ADOR 1.0 type library, you should rebuild your custom business object to use the ADOR 1.5 type library.
<H2><a name="adc_rn_lgrecordsets"></a>SQL Server — Ensuring Sufficient TempDB Space</H2>
<p>If errors occur while handling <b>Recordset</b> objects that need processing space on SQL Server, you may need to increase the size of the TempDB. (Some queries require temporary processing space; for example, a query with an ORDER BY clause requires a sort of the <b>Recordset</b>, which requires some temporary space.) 
<p><b>Important</b>   Read through this procedure first before performing the actions because it isn't as easy to shrink a device once it is expanded. 
<p><img src="art/prcarrow.gif" border=0><b>&#09;To increase the TempDB space on SQL Server</b>
<ol>
<li>
Start Microsoft&reg; SQL Server Enterprise Manager, open the tree for the Server, and then open the Database Devices tree.<br><br></li>
<li>
Select a (physical) device to expand, such as Master, and double-click the device to open the <b>Edit Database Device</b> dialog box.<p>This dialog shows how much space the current databases are using.
</li>
<li>
In the <b>Size</b> scroll box, increase the device to the desired amount. For example, 50 megabytes (MB) of hard disk space.<br><br></li>
<li>
Click <b>Change Now</b> to increase the amount of space to which the (logical) TempDB can expand.<br><br></li>
<li>
Open the Databases tree on the server, and then double-click <b>TempDB</b> to open the <b>Edit Database</b> dialog box. The <b>Database</b> tab lists the amount of space currently allocated to TempDB (<b>Data Size</b>). By default, this is 2 MB.<br><br></li>
<li>
Under the <b>Size </b>group, click <b>Expand</b>. The graphs show the available and allocated space on each of the physical devices. The bars in maroon color represent available space.<br><br></li>
<li>
Select a <b>Log Device</b>, such as <b>Master </b>to display the available size in the <b>Size (MB) </b>box.<br><br></li>
<li>
Click <b>Expand Now</b> to allocate that space to the TempDB database. <p>The <b>Edit Database</b> dialog displays the new allocated size for TempDB.
</li>
</ol>
<p><b>See Also</b>   For more information about this topic, search the Microsoft SQL Server Enterprise Manager Help file for &quot;Expand Database dialog box.&quot;
<H2><a name="adc_rn_setlogfile"></a>SQL Server — Minimizing Log File Space Usage</H2>
<p>A log file may fill quickly (thus halting the server) if there is large volume activity on a SQL Server database. You can set the Log file to <b>Truncate on Checkpoint </b>to significantly extend the life of the log file for a database. 
<p><img src="art/prcarrow.gif" border=0><b>&#09;To enable Truncate on Checkpoint </b>
<ol>
<li>
Run Microsoft SQL Server Enterprise Manager.<br><br></li>
<li>
Open the tree for the Server.<br><br></li>
<li>
Open the Databases tree.<br><br></li>
<li>
Double-click the name of the database on which this feature will be enabled.<br><br></li>
<li>
On the <b>Database</b> tab, click <b>Truncate</b>.<br><br></li>
<li>
On the <b>Options</b> tab, check <b>Truncate Log on Checkpoint</b>, and then click <b>OK</b>.</li>
</ol>
<p><b>See Also</b>   For more information about the <b>Truncate on Checkpoint</b> feature, see the Microsoft SQL Server documentation.
<H2><a name="adcmscoutdatedclassids"></a>Outdated Class IDs</H2>
<p>If you get an error that an <b>RDS.DataSpace</b> or <b>RDS.DataControl</b> object doesn't load, make sure you are using the correct class ID. The class IDs for these objects have changed from version 1.0 and 1.1. The correct class IDs are listed as follows:
<TABLE>
<TR><TD><b>Object</b></TD><TD><b>Class ID</b></td>
</tr>
<TR><TD></td>
</tr>
<TR><TD><A HREF="ref01_1.htm"><b>RDS.DataControl</b></a></TD><TD>BD96C556-65A3-11D0-983A-00C04FC29E33</td>
</tr>
<TR><TD><A HREF="ref01_24.htm"><b>RDS.DataSpace</b></a></TD><TD>BD96C556-65A3-11D0-983A-00C04FC29E36</td>
</tr>
</table><br>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>