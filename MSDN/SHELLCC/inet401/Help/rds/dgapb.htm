<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Detailed Control Flow</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Detailed Control Flow">
<META NAME="Keywords" CONTENT="Remote Data Service">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>

<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft Remote Data Service"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft Remote Data Service"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="gs01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="adc_gs_detailed_control_flow"></a>Appendix B: Detailed Control Flow</H1>
<p>This section contains a control flow description of the programming events that occur when the Remote Data Service processes a user event. 
<p>The following illustration shows the detailed control flow of a simple RDS application that uses the default <A HREF="dg01_1.htm#adc_dg_arch_adf"><b>RDSServer.DataFactory</b></a> business object. The numbered labels correspond to processes in the control flow and are described as follows.
<p><img src="art/ad003.gif" border=0>
<ol>
<li>
The user enters query text in a visual control. That query text will eventually be sent to the Web server for processing.<br><br></li>
<li>
When a user event occurs on the Web page (such as an OnClick event on a Search button), the RDS creates a <A HREF="dg01_1.htm#adc_dg_arch_bo_proxies">business object proxy</a> on the client. If you use the default business object, <b>RDSServer.DataFactory</b>, you will get a generic proxy for the <b>RDSServer.DataFactory</b> object.<br><br></li>
<li>
The business object proxy translates the request into an HTTP sendable format. The parameters to the method are passed across the Internet via HTTP to the <A HREF="def01_37.htm">Web server</a> (<A HREF="dg01_1.htm#adc_dg_arch_iis">Internet Information Server, or IIS</a>) specified in the <A HREF="ref01_1.htm"><b>RDS.DataControl</b></a> object's <A HREF="ref01_9.htm"><b>Server</b></a> property. IIS then passes the HTTP request to a server extension called the Advanced Data Internet Server API (ADISAPI).<br><br></li>
<li>
ADISAPI examines the contents of the call. It creates an instance of the business object and makes the requested method call. (If you use the <b>RDSServer.DataFactory</b> object, it calls the <A HREF="ref01_22.htm"><b>Query</b></a> method.)<p>The remaining steps describe the process flow when the <b>Query</b> method of the <b>RDSServer.DataFactory</b> object is called. A similar process happens when methods on a custom business object are called. 
</li>
<li>
The <b>RDSServer.DataFactory </b>object executes the user's query via <A HREF="dg01_1.htm#adc_dg_arch_oledb">OLE DB</a> (and ODBC) by passing in the SQL statement and <A HREF="def01_23.htm">DSN</a> information. It sets the properties for the requested <A HREF="def01_28.htm">rowset</a> so that OLE DB uses the <A HREF="dg01_1.htm#adc_dg_arch_vtm">Client Cursor Engine</a> as its buffering component. <br><br></li>
<li>
OLE DB passes the rowset containing the results of the query to the Client Cursor Engine. The Client Cursor Engine populates its buffers with the rowset data and stores all of the meta data information for all base tables that are part of the result set. It also implements the <A HREF="def01_27.htm">marshaling</a> interfaces for the rowset.<br><br></li>
<li>
The Client Cursor Engine passes the marshalable rowset back to the <b>RDSServer.DataFactory </b>object.<br><br></li>
<li>
The <b>RDSServer.DataFactory </b>object creates an instance of an ADO <b>Recordset</b> and passes it the Client Cursor Engine marshalable rowset. ADO wraps the rowset into a <b>Recordset</b>, which is then returned as the return value of the original <b>Query</b> method call from Step 4.<u> </u><br><br></li>
<li>
The <b>RDSServer.DataFactory</b> passes the <b>Recordset</b> back to ADISAPI, which packages the return value of the <b>Recordset</b> into <A HREF="def01_32.htm">MIME</a> format by calling the Client Cursor Engine.<br><br></li>
<li>
ADISAPI sends the <b>Recordset</b>  over HTTP as multi-part MIME packets to the business object proxy on the client side.<br><br></li>
<li>
The client-side business object proxy unpacks the results of the method call from HTTP format, and recreates the <b>Recordset</b> in the client-side Client Cursor Engine. <br><br></li>
<li>
The <b>RDS.DataControl</b> object binds the data in the Client Cursor Engine to the visual <A HREF="def01_38.htm">controls</a>.</li>
</ol>
<p>After the preceding steps have taken place, the user now has access to the <b>Recordset</b> object, representing the results of the query (displayed through the visual controls). He or she can perform tasks such as examining the record data, making changes, inserting new records, or deleting existing records.
<p>When the user makes an update request, only the changed records are sent back via a process similar to that described previously. When an attempt is made to save the updated data, either all the changes will be written back to the data source, or, if any individual change cannot be saved, none of the changes will be saved.
<p>For a custom business object, one difference to the steps outlined previously is that an <A HREF="ref01_25.htm"><b>RDS.DataSpace.CreateObject</b></a> method is called on the client page to instantiate the business object proxy (Step 2). Also, if you write your business object in Visual Basic or Java, it cannot communicate directly with OLE DB, so the business object sends a request to ADO, which then sends the request to OLE DB (Steps 5 and 6). Business objects created with Visual C++ can access OLE DB directly.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>