<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Address Book Example: Source Code</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Address Book Example: Source Code">
<META NAME="Keywords" CONTENT="Remote Data Service">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>

<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft Remote Data Service"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft Remote Data Service"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="gs01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="adc_gs_ab_source_code"></a>Address Book Application Source Code</H1>
<p>The following code is the complete source code for the Address Book sample application.
<PRE>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Corporate Address Book&lt;/TITLE&gt;
&lt;/HEAD&gt;

&lt;!--
&#09;Purpose:&#09;To provide a company directory search service for Web users.
&#09;Written By:&#09;Microsoft Remote Data Service Team, Microsoft Corp.
&#09;Date:&#09;&#09;April, 1997
--&gt;

&lt;BODY BACKGROUND=&quot;Arcadia.gif&quot; LANGUAGE=&quot;VBScript&quot; onload=&quot;Load&quot;&gt;
&lt;tr&gt;
&#09;&lt;td align=&quot;center&quot; width=&quot;40%&quot;&gt;
        &lt;table border=&quot;2&quot; cellpadding=&quot;7&quot; cellspacing=&quot;7&quot;&gt;
            &lt;tr&gt;
                &lt;td width=&quot;100%&quot;&gt;&lt;font color=&quot;#160B5A&quot;&gt;&lt;font
                size=&quot;4&quot;&gt;&lt;strong&gt;Arcadia Bay Corporate Phone Directory&lt;/strong&gt;&lt;/font&gt;&lt;/font&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
        &lt;/td&gt;
&lt;/tr&gt;

&lt;hr&gt;
&lt;h2&gt;&lt;font color = &quot;#160B5A&quot;&gt;Search Parameters&lt;/h2&gt;
&lt;h5&gt;&lt;font color = &quot;#160B5A&quot;&gt;Please enter one or more search patterns and press FIND to search.&lt;/h5&gt;

&lt;FONT COLOR = &quot;#160B5A&quot;&gt;&lt;B&gt;

&lt;PRE&gt; First Name     &lt;INPUT NAME=SFirst SIZE=30&gt; &lt;/PRE&gt;

&lt;PRE&gt; Last Name      &lt;INPUT NAME=SLast  SIZE=30&gt; &lt;/PRE&gt;

&lt;PRE&gt; Title          &lt;INPUT NAME=STitle SIZE=30&gt; &lt;/PRE&gt;

&lt;PRE&gt; E-mail Alias   &lt;INPUT NAME=SEmail SIZE=30&gt; &lt;/PRE&gt;

&lt;!-- 
&#09;Command button options:
&#09;-----------------------
&#09;Find&#09;&#09;Submit a search request to the database.
&#09;Clear&#09;&#09;Clear the QBE fields (labor saving function only).
&#09;Update Profile&#09;Send updated &quot;address profile&quot; back to the database.
&#09;Cancel Changes&#09;Undo all changes since the last Update Profile.
--&gt;

&lt;INPUT TYPE=BUTTON NAME=&quot;Find&quot; &#09;VALUE=&quot;Find&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Clear&quot; &#09;VALUE=&quot;Clear&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Update&quot; &#09;VALUE=&quot;Update Profile&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Cancel&quot; &#09;VALUE=&quot;Cancel Changes&quot;&gt;

&lt;hr&gt;
&lt;h2&gt;&lt;font color = &quot;#400040&quot;&gt;Search Results&lt;/h2&gt;
&lt;/B&gt;
&lt;br&gt;

&lt;!-- 
&#09;This Sheridan DataGrid control (SGrid) are initialized to
&#09;allow changes to the data - these changes will be saved
&#09;to the database when the Update Profile button is pressed. 
--&gt;

&lt;Object CLASSID=&quot;clsid:AC05DC80-7DF1-11d0-839E-00A024A94B3A&quot;
&#09;CODEBASE=&quot;http://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;/MSADC/Samples/Sheridan.cab&quot;
&#09;ID=GRID1 
        datasrc=#SControl 
        HEIGHT=125 
        WIDTH=495&gt;
&#09;&lt;PARAM NAME=&quot;AllowAddNew&quot;   VALUE=&quot;TRUE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;AllowDelete&quot;   VALUE=&quot;TRUE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;AllowUpdate&quot;   VALUE=&quot;TRUE&quot;&gt;
&#09;&lt;PARAM NAME=&quot;BackColor&quot;     VALUE=&quot;-2147483643&quot;&gt;
&#09;&lt;PARAM NAME=&quot;BackColorOdd&quot;  VALUE=&quot;-2147483643&quot;&gt;
&#09;&lt;PARAM NAME=&quot;ForeColorEven&quot; VALUE=&quot;0&quot;&gt;
&lt;/OBJECT&gt;

&lt;br&gt;
&lt;br&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;First&quot; &#09;VALUE=&quot;First&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Prev&quot; &#09;VALUE=&quot;Previous&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Next&quot;&#09;VALUE=&quot;Next&quot;&gt;
&lt;INPUT TYPE=BUTTON NAME=&quot;Last&quot;&#09;VALUE=&quot;Last&quot;&gt;
&lt;hr&gt;


&lt;!-- Non-visual controls - RDS.DataControl --&gt;

&lt;OBJECT classid=&quot;clsid:BD96C556-65A3-11D0-983A-00C04FC29E33&quot;
&#09;ID=SControl
&#09;WIDTH=1 HEIGHT=1&gt;
&#09;&lt;PARAM NAME=&quot;SERVER&quot; VALUE=&quot;http://&lt;%=Request.ServerVariables(&quot;SERVER_NAME&quot;)%&gt;&quot;&gt;
&#09;&lt;PARAM NAME=&quot;CONNECT&quot; VALUE=&quot;dsn=ADCDemo;UID=ADCDemo;PWD=ADCDemo;&quot;&gt;
&lt;/OBJECT&gt;


&lt;!-- VBS scripting for composing queries, updating profiles, and retrieving search results. --&gt;

&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;

Dim myQuery

Sub Load
&#09;Grid1.CAPTION = &quot;Arcadia Bay Corporate Phone Directory&quot;

&#09;'Initialize data grid with column names only.
&#09;SControl.SQL = &quot;Select FirstName, LastName, Title, Email, Building, Room, Phone from Employee where 2 &lt; 1&quot;
&#09;SControl.Refresh

End Sub

'Implement &quot;Clear&quot; button - clears all of the QBE fields in preparation for a new &quot;Find.&quot;

Sub Clear_OnClick
&#09;SFirst.Value=&quot;&quot;
&#09;SLast.Value=&quot;&quot;
&#09;STitle.Value=&quot;&quot;
&#09;SEmail.Value=&quot;&quot;
End Sub


'Implement &quot;Find&quot; button - composes a dynamic SQL query to be processed by the database and returns matching records to be bound to the SGrid object.

Sub Find_OnClick

&#09;myQuery = &quot;Select FirstName, LastName, Title, Type, Email, ManagerEmail, Building, Room, Phone from Employee&quot;

&#09;'Check QBE fields and compose a dynamic SQL query.

&#09;IF (SFirst.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where FirstName like '&quot; + SFirst.Value + &quot;%'&quot;
&#09;End IF

&#09;IF (SLast.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where LastName like '&quot; + SLast.Value + &quot;%'&quot;
&#09;End IF

&#09;IF (STitle.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Title like '&quot; + STitle.Value + &quot;%'&quot;
&#09;End IF

&#09;IF (SEmail.Value &lt;&gt; &quot;&quot;) THEN
&#09;&#09;myQuery = myQuery + &quot; where Email like '&quot; + SEmail.Value + &quot;%'&quot;
&#09;End IF

&#09;'Set the new query and then refresh the SControl so that the new results are displayed.

&#09;SControl.SQL = myQuery
&#09;SControl.Refresh
&#09;
End Sub

'Navigation subroutines - based on currency changes to RDS.DataControl (SControl).

'Move to the first record in the bound recordset.

Sub First_OnClick
  &#09;SControl.Recordset.MoveFirst
End Sub

'Move to the next record from the current position in the bound recordset.

Sub Next_OnClick
&#09;If SControl.Recordset.EOF Then&#09;'cannot move beyond bottom record
&#09;&#09;SControl.Recordset.MoveFirst 
&#09;&#09;SControl.Recordset.MoveNext
&#09;&#09;Exit Sub
&#09;End If&#09;

&#09;SControl.Recordset.MoveNext

End Sub

'Move to the previous record from the current position in the bound recordset.

Sub Prev_OnClick
If SControl.Recordset.BOF Then&#09;'cannot move beyond top record
&#09;&#09;SControl.Recordset.MoveLast&#09;'Get out of BOF buffer
&#09;&#09;SControl.Recordset.MovePrevious
&#09;&#09;Exit Sub
&#09;End If
&#09;SControl.Recordset.MovePrevious
End Sub

'Move to the last record in the bound recordset.

Sub Last_OnClick
  &#09;SControl.Recordset.MoveLast
End Sub

'Submits edits made and pull a clean copy of the new data.

Sub Update_OnClick
  &#09;SControl.SubmitChanges
&#09;SControl.Refresh        ' A Refresh is not required in ADC 1.5 after a SubmitChanges, but it ensures fresh data.
End Sub

'Cancel edits and restores original values.

Sub Cancel_OnClick
  &#09;SControl.CancelUpdate
End Sub

&lt;/SCRIPT&gt;

&lt;BR&gt;
&lt;font color = &quot;#400040&quot;&gt;This site powered by Microsoft Remote Data Service. &lt;/font&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

</pre>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>