<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Microsoft Agent Speech Output Tags</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="PLATFORM" CONTENT="Windows">
<META NAME=MS-HKWD CONTENT="Microsoft Agent Speech Output Tags">
<META NAME="Keywords" CONTENT="Microsoft Agent, MSAgent">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft Agent"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft Agent"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="agent.htm">Topic Contents</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Speech Output Tags</H1>
<P><H4>ActiveX&#153; Technology for Interactive Software Agents</H4>
<P><IMG SRC="art/agent.GIF" WIDTH="123" HEIGHT="123" ALT="agent">

<P>August 1997
<BR>Microsoft Corporation
<P><blockquote><b>Note:</b> This document is provided for informational purposes only and Microsoft makes no warranties, either expressed or implied, in this document. The entire risk of the use or the results of this document remains with the user.</blockquote>
<P><blockquote>Information in this document is subject to change without notice. Companies, names, and data used in examples herein are fictitious unless otherwise noted. No part of this document may be reproduced or transmitted in any form or by any means, electronic or mechanical, for any purpose, without the express written permission of Microsoft Corporation.
<P>Microsoft may have patents or pending patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document. The furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property rights. Microsoft, MS, MS-DOS, Windows, Windows NT, and the Windows logo are either registered trademarks or trademarks of Microsoft Corporation in the U.S. and/or other countries. Other product and company names mentioned herein may be the trademarks of their respective owners.</blockquote>

<P>The Microsoft Agent services support modifying speech output through special tags inserted in the speech text string. These tags help you change the characteristics of the output expression of the character.
<P>Speech output tags use the following rules of syntax:<UL>

<LI> All tags begin and end with a backslash character (\).<LI> The single backslash character is not enabled <i>within</i> a tag. To include a backslash character in a text parameter of a tag, use a double backslash (\\).<LI> Tags are case-insensitive. For example, \pit\ is the same as \PIT\.<LI> Tags are whitespace-dependent. For example, \Rst\ is not the same as \&nbsp;Rst&nbsp;\.
</UL>Unless otherwise specified or modified by another tag, the speech output retains the characteristic set by the tag within the text specified in a single <b>Speak</b> method. Speech output is automatically reset through the user-defined parameters after a <b>Speak</b> method is completed.<P>Some tags include quoted strings. For some programming languages, such as Visual Basic&#174; Scripting Edition (VBScript) and Visual Basic&#174;, this means that you may have to use two quote marks to designate the tag's parameter or concatenate a double-quote character as part of the string. The latter is shown in this Visual Basic example:<P><PRE>Agent1.Characters("Genie").Speak "This is \map=" + chr(34) + "Spoken text" _
+ chr(34) + "=" + chr(34) + "Balloon text" + chr(34) + "\."
</PRE><P>For C, C++, and Java&#153; programming, precede backslashes and double quotes with a backslash. For example:<P><PRE>BSTR bszSpeak = SysAllocString(L&quot;This is \\map=\&quot;Spoken text\&quot;=\&quot;Balloon text\&quot;\\&quot;);

pCharacter-&gt;Speak(bszSpeak, ......);
</PRE>
<P>For foreign languages that support double-byte character set (DBCS) characters, you can use double-byte characters to specify string parameters. However, use single-byte characters for all other parameters and characters that are used to define the tag, including the tag itself.
<P><a name="top"></a>The following tags are supported:
<P><b><A HREF="#CHR">Chr</A></b>, <b><A HREF="#CTX">Ctx</A></b>, <b><A HREF="#EMP">Emp</A></b>, <b><A HREF="#LST">Lst</a></b>, <b><A HREF="#MAP">Map</A></b>, <b><A HREF="#MRK">Mrk</A></b>, <b><A HREF="#PAU">Pau</A></b>, <b><A HREF="#PIT">Pit</A></b>, <b><A HREF="#RST">Rst</A></b>, <b><A HREF="#SPD">Spd</A></b>, <b><A HREF="#VOL">Vol</A></b>
<P>The tags are primarily designed for adjusting text-to-speech (TTS)-generated output. Only the <b>Mrk</b> and <b>Map</b> tags can be used with sound file-based spoken output.

<P><B>Note:</b>  Microsoft Agent does not support all the tags documented in the Microsoft Speech SDK. Parameters may also vary depending on the TTS engine installed.
<P><H4><A NAME="CHR"></A>Chr Tag</H4>
<P><b>Description</b> <blockquote>Sets the character of the voice.</blockquote>
<P><b>Syntax</b> <blockquote>\<b>Chr</b>=<i>string</i>\</blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>string</i></TD>
<TD>A string specifying the character of the voice.
<P><b>"Normal"</b> (Default) A normal tone of voice.
<P><b>"Monotone"</b> A monotone voice.
<P><b>"Whisper"</b> A whispered voice.
</TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>This tag is supported only for TTS-generated output. The range of values for the parameter may vary depending on the installed TTS engine.</blockquote>
<P><hr>
<P><H4><A NAME="CTX"></A>Ctx Tag</H4>
<P><b>Description</b> <blockquote>Sets the context of the output text.</blockquote>
<P><b>Syntax</b> <blockquote>\<b>Ctx</b>=<i>string</i>\</blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>string</i></TD>
<TD>A string specifying the context of the text that follows, which determines how symbols or abbreviations are spoken.
<P><b>"Address"</b> Addresses and/or phone numbers.
<P><b>"Email"</b> Electronic mail.
<P><b>"Unknown"</b> (Default) Context is unknown.
</TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>This tag is supported only for TTS-generated output. The range of values for the parameter may vary depending on the installed TTS engine.</blockquote>
<P><hr>
<P><H4><A NAME="EMP"></A>Emp Tag</H4>
<P><b>Description</b> <blockquote>Emphasizes the next word spoken. This tag must immediately precede the word.</blockquote>
<P><b>Syntax</b> <blockquote><b>\Emp\</b></blockquote>
<P><b>Remarks</b> <blockquote>This tag is supported only for TTS-generated output. The range of values for the parameter may vary depending on the installed TTS engine.</blockquote>
<P><hr>
<P><H4><A NAME="LST"></A>Lst Tag</H4>
<P><b>Description</b> <blockquote>Repeats last spoken statement for the character.</blockquote>
<P><b>Syntax</b> <blockquote><b>\Lst\</b></blockquote>
<P><b>Remarks</b> <blockquote>This tag enables a character repeat its last spoken statement. This tag must appear by itself in the <b>Speak</b> method; no other text or parameters can be included. When the spoken text is repeated, any other tags included in the original text are repeated, except for bookmarks. Any .WAV and .LWV files included in the text are also repeated.</blockquote>
<P><hr>
<P><H4><A NAME="MAP"></A>Map Tag</H4>
<P><b>Description</b> <blockquote>Maps spoken text to text displayed in the word balloon.</blockquote>
<P><b>Syntax</b> <blockquote>\<b>Map</b>="<i>spokentext"</i>="<i>balloontext"</i>\</blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>spokentext</i></TD>
<TD>A string specifying the text for spoken output.
</TD>
</TR>
<TR VALIGN=TOP>
<TD><i>balloontext</i></TD>
<TD>A string specifying the text for word balloon output.
</TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>This tag enables you to use different spoken text than that displayed in the word balloon. </blockquote>
<P><hr>
<P><H4><A NAME="MRK"></A>Mrk Tag</H4>
<P><b>Description</b> <blockquote>Defines a bookmark in the spoken text.</blockquote>
<P><b>Syntax</b> <blockquote><b>\Mrk=</b><i>number</i><b>\</b></blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>number</i></TD>
<TD>A Long integer value that identifies the bookmark.
</TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>When the server processes a bookmark, it generates a bookmark event. You must specify a number greater than zero (0) and not equal to 2147483647 or 2147483646.</blockquote>
<P><b>See Also</b> <blockquote><b><A HREF="control.htm#BOOKMARK">Bookmark</A></b> event</blockquote>
<P><hr>
<P><H4><A NAME="PAU"></A>Pau Tag</H4>
<P><b>Description</b> <blockquote>Pauses speech for the specified number of milliseconds.</blockquote>
<P><b>Syntax</b> <blockquote><b>\Pau=</b><i>number</i><b>\</b></blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>number</i></TD>
<TD>The number of milliseconds to pause.
</TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>This tag is supported only for TTS-generated output. The range of values for the parameter may vary depending on the installed TTS engine. The speech engine supplied with Microsoft Agent supports values from 10 (0.01sec) to 2550 (2.55sec). </blockquote>
<P><hr>
<P><H4><A NAME="PIT"></A>Pit Tag</H4>
<P><b>Description</b> <blockquote>Sets the baseline pitch of the output to the specified value in hertz.</blockquote>
<P><b>Syntax</b>  <blockquote><b>\Pit=</b><i>number</i><b>\</b></blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>number</i></TD>
<TD>The pitch in hertz. </TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>This tag is supported only for TTS-generated output. The range of values for the parameter may vary depending on the installed TTS engine. The speech engine supplied with Microsoft Agent supports values from 50 to 400. </blockquote>
<P><hr>
<P><H4><A NAME="RST"></A>Rst Tag</H4>
<P><b>Description</b> <blockquote>Resets all tags to the default settings.</blockquote>
<P><b>Syntax</b> <blockquote><b>\Rst\</b></blockquote>
<P><hr>
<P><H4><A NAME="SPD"></A>Spd Tag</H4>
<P><b>Description</b> <blockquote>Sets the baseline average talking speed of the speech output.</blockquote>
<P><b>Syntax</b> <blockquote><b>\Spd=</b><i>number</i><b>\</b></blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>number</i></TD>
<TD>Baseline average talking speed, in words per minute. </TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>This tag is supported only for TTS-generated output. The range of values for the parameter may vary depending on the installed TTS engine. The speech engine supplied with Microsoft Agent supports values from 50 to 250.</blockquote>
<P><hr>
<P><H4><A NAME="VOL"></A>Vol Tag</H4>
<P><b>Description</b> <blockquote>Sets the baseline speaking volume of the speech output.</blockquote>
<P><b>Syntax</b> <blockquote><b>\Vol=</b><i>number</i><b>\</b></blockquote>
<P><blockquote>
<P>
<TABLE WIDTH="87%" CELLPADDING=5 CELLSPACING=0>
<TR><TD><b>Part</b></TD>
<TD><b>Description</b></TD>
</TR>
<TR VALIGN=TOP>
<TD><i>number</i></TD>
<TD>Baseline speaking volume: 0 is silence and 65535 is maximum volume. </TD>
</TR>
</TABLE></blockquote>
<P><b>Remarks</b> <blockquote>The volume setting affects both left and right channels. You cannot set the volume of each channel separately. This tag is supported only for TTS-generated output.</blockquote>
<P>
<P><A HREF="#top"><IMG SRC="art/uparrow.gif"  BORDER="0" WIDTH=14 HEIGHT=10 ALT="uparrow.gif">Back to list of tags</A>
<P>

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>