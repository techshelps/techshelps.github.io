<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Microsoft Agent Character Editor</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="PLATFORM" CONTENT="Windows">
<META NAME=MS-HKWD CONTENT="Using the Microsoft Agent Character Editor">
<META NAME="Keywords" CONTENT="Microsoft Agent, MSAgent">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft Agent"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft Agent"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="agent.htm">Topic Contents</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Using the Microsoft Agent Character Editor</H1>
<P><H4>ActiveX&#153; Technology for Interactive Software Agents</H4>
<P><IMG SRC="art/agent.GIF" WIDTH="123" HEIGHT="123" ALT="agent">

<P>August 1997
<BR>Microsoft Corporation

<P><blockquote><b>Note:</b> This document is provided for informational purposes only and Microsoft makes no warranties, either expressed or implied, in this document. The entire risk of the use or the results of this document remains with the user.</blockquote>
<P><blockquote>Information in this document is subject to change without notice. Companies, names, and data used in examples herein are fictitious unless otherwise noted. No part of this document may be reproduced or transmitted in any form or by any means, electronic or mechanical, for any purpose, without the express written permission of Microsoft Corporation.
<P>Microsoft may have patents or pending patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document. The furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property rights. Microsoft, MS, MS-DOS, Windows, Windows NT, and the Windows logo are either registered trademarks or trademarks of Microsoft Corporation in the U.S. and/or other countries. Other product and company names mentioned herein may be the trademarks of their respective owners.</blockquote>
<P><a name="top"></a><b>Contents</b>
<P> <A HREF="#TOPIC1">Introduction</A>
<P> <A HREF="#TOPIC2">Installing the Agent Character Editor</A>
<P> <A HREF="#TOPIC3">Starting the Agent Character Editor</A>
<P> <A HREF="#TOPIC4">Defining a New Character</A>
<P> <A HREF="#TOPIC5">Command Reference</A>
<P> <A HREF="#TOPIC6">Toolbar buttons</A>
<P><H3><A NAME="TOPIC1"></A> Introduction</H3>
<P>The Microsoft&#174; Agent Character Editor enables you to compile character animations for use with Microsoft Agent. You can define animations by importing Windows bitmap images, setting their duration, and optionally including branching, sound effects, and speaking overlays. For information about designing a character's animation, see  <A HREF="DESCHAR.HTM">Designing Characters for Microsoft Agent</A>. 
<P>With the Agent Character Editor you can define the character's name and description as well as output options, including text-to-speech (TTS), synthesized voice output, pop-up menu support, and the character's word balloon design. 
<P><A HREF="#top"><IMG SRC="art/uparrow.gif"  BORDER="0" WIDTH=14 HEIGHT=10 ALT="uparrow.gif">Back to contents</A>
<P><H3><A NAME="TOPIC2"></A> Installing the Agent Character Editor</H3>
<P>To install the Microsoft Agent Character Editor, open its self-extracting cabinet file. This will automatically install the appropriate files on your system. If you are downloading the Agent Character Editor from the Microsoft Web site, the downloading software gives you the option to save the file and open it or open it automatically as soon as the download completes. 
<P>If you plan to use a TTS engine for your character's output, you need to install that engine before you begin creating your character. A special version of the Lernout &amp; Hauspie&#174; TruVoice Text-To-Speech Engine (American English language) can be downloaded from the Microsoft Agent Web site. You can use and distribute this engine as part of a Microsoft Agent application, subject to the conditions described in the End User Licensing Agreement that displays when you install the engine. If you plan to use another TTS engine, contact that vendor to confirm their support for Microsoft Agent and for information on their licensing provisions for use and redistribution.
<P><A HREF="#top"><IMG SRC="art/uparrow.gif"  BORDER="0" WIDTH=14 HEIGHT=10 ALT="uparrow.gif">Back to contents</A>
<P><H3><A NAME="TOPIC3"></A> Starting the Agent Character Editor</H3>
<P>To run the Agent Character Editor, choose the Agent Character Editor option from the Windows Taskbar's Start menu, or double-click the Microsoft Agent Character Editor icon on your desktop. The Editor's window will open, displaying its menus, a toolbar with frequently used commands, a tree listing the components that make up a character's definition, and a set of tabbed pages that change based on your selection in the component tree. 
<P><IMG SRC="art/CHA3154C.GIF" WIDTH="636" HEIGHT="468" ALT="[CHA3154C.GIF]">
<P><b><b>Figure 1.  Microsoft Agent Character Editor window</b></b>
<P>To access fields in the window from the keyboard, you can use the tab key and shift+tab to navigate between controls, or use the access key (alt<i>underlined letter</i>) to move to a specific control. Once the Editor completes starting up, you can begin creating a new character definition or load an existing character definition. 
<P>The status bar displays information about commands or toolbar buttons when you move the pointer over them. It also displays summary information about your character animation data and status information when you build a character.
<P><A HREF="#top"><IMG SRC="art/uparrow.gif"  BORDER="0" WIDTH=14 HEIGHT=10 ALT="uparrow.gif">Back to contents</A>
<P><H3><A NAME="TOPIC4"></A> Defining a New Character</H3>
<P>To define a new character, run the Agent Character Editor. If you have an existing character file loaded, choose the New command from the File menu or the New button on the toolbar.  This action selects the Character icon in the tree and displays its property pages on the right side of the window. The following sections describe how to set your character's properties and how to create animations for the character.
<P><H4>Setting Your Character's Properties</H4>
<P>To begin defining a character, provide the character's name by entering it in the Name text box (32 characters maximum). Because Microsoft Agent uses the name to allow users to access the character, specify a user-friendly name. Supply a name that can be pronounced using conventional spelling, or you may disable speech input for the character. You can also specify a short optional description (256 characters) for your character in the Description text box. The server exposes what you enter in the Description text box to client applications.
<P>For your character's spoken output, Microsoft Agent provides the choice of a synthesized, text-to-speech (TTS) voice or a voice that uses recorded sound files. If you want to use a synthesized voice, check the Use Synthesized Speech For Voice Output option. This will add a Voice page for selecting the characteristics of the voice. Choose the Voice page and use the controls on it page to select a voice, speed, and pitch of any compatible TTS engines you have installed. The range of the voice parameters you can select depends on TTS engines. If you have not yet installed a TTS engine, the Voice ID list will be empty. You must have a TTS engine installed before you define your character's voice settings in the Agent Character Editor.
<P>If you plan to use a TTS engine for your character's output, you must also install that engine on the user's system. For more information on how to install the Lernout &amp; Hauspie&#174; TruVoice engine on a user's system from a Web script, see <A HREF="control.htm">Programming the Microsoft Agent Control</A>. If you are using another TTS engine, check with the vendor for appropriate installation information. If you select a voice based on a particular TTS engine, but the user has a different TTS engine installed, the server attempts to fit the voice based on the characteristics you defined in the Agent Character Editor. 
<P>If you plan to use recorded sound files (.WAV files) for your character's spoken output, do not check the Use Synthesized Speech For Voice Output option. Instead, you will need to record the spoken output audio files separately and load them from your application code.
<P>The Use Word Balloon on the character's Properties page enables you to determine whether you want to support this feature for your character. Once defined, it cannot be changed through the Microsoft Agent programming interface. 
<P>When the Use Word Balloon option is checked, you can access the Word Balloon page. The options on the Word Balloon page enable you to change the default characteristics of your word balloon. The Characters Per Line setting enables you to define the width of the balloon based on the average number of characters per line. You can set the default height based on either a fixed number of lines you want to display at once or automatically sized to the text you supply in the <b>Speak</b> method. You can also set whether the balloon automatically hides after a <b>Speak</b> method is completed and whether the balloon automatically displays or "paces" words to the character's speech output speed setting.

<P>The Word Balloon page also enables you to set the default font for the character's word balloon and the balloon's display colors. However, be aware that users can override your word balloon font settings using the Microsoft Agent Property Sheet.
<P>Each character requires a unique identifier (GUID). The server uses the identifier to differentiate characters. When you create a new character, the Editor automatically creates a new identifier for your character. You need to change a character's identifier only if you copied the character definition file of another character or if you intentionally want to differentiate a character from a former version. To change a character's identifier, click the New GUID button and the Editor will generate a new identifier. 
<P><H4>Creating Animations</H4>
<P>To begin creating animations for your character, select the Animations icon in the tree. This displays the Properties page with the default settings for all animations. You can alter the frame size, the default frame duration, and color palette settings on the Properties page. The animation frame height and width must remain constant throughout the entire character definition (that is, for all of that character's animations). Although you can change the frame size from its default setting (128 x 128 pixels), images displayed in the Editor will be scaled to fit default display size. If you change the default frame setting, you can display the frame's full, non-scaled size by choosing Open Frame Window from the Edit menu.
<P>By default, the Editor uses the first bitmap image you load to set your character's default color palette, and sets the color in the 11th palette position as your transparency color. However, you can change these settings using the buttons in the Palette Information group. Your character's color palette must not remap the standard system colors. The Editor will automatically reserve the system's color palette when displaying images. In addition, make sure all your animation images use the same color palette and transparency color. If they do not, you may see color remapping of your images when you load them into the Editor. 
<P>Once you have determined your global animation settings, you can begin creating animations. To create a new animation, choose New Animation from the Edit menu or the New Animation button on the toolbar. This adds a new animation icon in the tree under the Animations icon and assigns the new icon a default name. You can rename your animation by typing in the Animation Name field. Note that animation names within a character definition must be unique. Also, avoid using characters in the name that are not valid characters for filenames.
<P>Every animation is composed of frames. To create a new frame for your animation, choose New Frame from either the Edit menu or the toolbar. This adds a new frame icon to the tree under your animation icon, and displays three tabbed pages. The General page includes controls that enable you to load and adjust an image for your frame. It also includes a display area for the frame's appearance.
<P><IMG SRC="art/CHA3154D.GIF" WIDTH="422" HEIGHT="232" ALT="[CHA3154D.GIF]">
<P><b><b>Figure 2:  The Frame Image display and controls</b></b>
<P>A frame can contain one or more images. To define an image for a frame, click the Add Image File button just above the Images list box. The Select Image Files dialog box displays, which allows you to select a bitmap image file. 
<P><IMG SRC="art/Cha3154e.gif" WIDTH="593" HEIGHT="286" ALT="[CHA3154E.GIF]">
<P><b>Figure 3.  The Select Image Files dialog box</b>
<P>Select the file you want to load, choose Open, and the image appears in the frame display on the General page. The Editor accepts only images that are stored as 1-bit (monochrome), 4-bit, or 8-bit Windows bitmap format, or as .GIF format.

<P>You can use the four arrow buttons beneath the image in the Position box to adjust the image's appearance within the frame. If the image is larger than your frame's size, only the portion of the image that appears within the frame will display. If you increase the frame size, the image may be scaled to fit within the display area of the Editor. 

<P>You can also display a frame by choosing Open Frame Window from the Edit menu. This displays the current frame in a separate window without scaling the images loaded into the frame. This window's initial size is based on your frame's height and width settings. You can resize it smaller, but not larger. The Frame Window reflects the changes you make using the controls in the Editor and also allows you view the frame while viewing its other property pages.


<P><IMG SRC="art/CHA3154F.GIF" WIDTH="141" HEIGHT="73" ALT="[CHA3154F.GIF]">
<P><b><b>Figure 4.  Image Position controls</b></b>
<P>You can compose a frame from multiple images. Each time you select the Add Image button and choose another image, the image gets added to the list and to the image display area. You can also add multiple images by selecting more than one file. Press shift or ctrl while you click in the Select Image Files dialog box, and then choose Open. The Move Up and Move Down buttons above the Images list box move a selected image in the display order (z-order) for the frame. You can also move images by dragging them within the list. Selecting an image in the list and clicking the Delete button removes an image. To change an image you have loaded to another image file, you can click the filename to edit it directly or use the Ellipsis (&#133;) button to bring up the Select Image Files dialog box and select a different file.
<P><IMG SRC="art/CHA3154G.GIF" WIDTH="30" HEIGHT="27" ALT="[CHA3154G.GIF]">
<P><b><b>Figure 5.  The Ellipsis button</b></b>
<P>You can use the Duration text box to set the duration for the frame; that is, how long the frame will be displayed. If a frame has no image and zero duration, the frame will not be displayed when the animation plays.
<P>You can also specify a sound effect file to play when the frame is displayed. If you plan to load the character from a Web server, you may want to compress the sound effect file to minimize load time. You can then specify the compressed sound file in the Agent Character Editor. In addition, avoid using a sound effect with a duration longer than the duration of your animation and especially avoid a sound effect that loops, because the Microsoft Agent animation services do not send an animation complete event until the sound completes. Also avoid specifying a sound effect for any animation you assign to the <b>Listening</b> or <b>Hearing</b> states, because this interferes with speech input. Finally, while you can include more than one sound effect in an animation, avoid placing them so they overlap, because this may affect the timing of the animation. Also, keep in mind that sound effects may play at different rates based on the user's hardware.
<P>To add frames to your animation, choose the New Frame command again and follow the same procedure. As an option, you can also load multiple images and automatically generate new frames for them. To use this feature, choose New Frames From Images from the Edit menu. The frames will be created in alphabetic order based on the image filenames. When you are finished defining all frames for your animation, you can choose the New Animation command again to begin a new animation.
<P>There are other ways to add frames to animations and move frames within or between animations. You can select another frame (from the same or another animation) and choose Cut or Copy, then select the animation or a frame in that animation and choose Paste. You can also drag a frame from one animation to another. If you drag within an animation, the action moves the frame. If you drag to another animation, it copies the frame. Dragging to a preceding frame in the same animation inserts the frame before the frame to which you drag. Dragging to a following frame places it after the frame to which you drag. If you drag a frame using the right mouse button, releasing the button displays a pop-up menu with your transfer choices. 
<P>You can also create an animation by copying an existing animation (select the animation and choose Copy), and selecting the Animations icon or another animation icon and choosing Paste. The Editor automatically creates a new name for the animation, although you can change the name.
<P><H4>Branching</H4>
<P>When you create a frame, you can also define which frame plays next. By default, the next frame played in the animation sequence is always the next frame in the z-order. However, by choosing the Branching page, you can set the probability for up to three other frames that the server may play. Enter the probability percentage and the target frame number in the appropriate fields. You can specify branching even for frames that don't have images and have their duration set to zero. This enables you to branch without first displaying a particular image.
<P><IMG SRC="art/CHA3154H.GIF" WIDTH="409" HEIGHT="179" ALT="[CHA3154H.GIF]">
<P><b><b>Figure 6.  The Branching page</b></b>
<P>You can use the branching feature to create animations that will loop indefinitely. However, note that when a looping animation plays, other animations in the character's queue will not play until an event--such as a user pressing the push-to-talk key or the client application calling the <b>Stop</b> method--halts the looping animation. Therefore, carefully consider the context in which the animation will be used before creating a looping animation.
<P><H4>Previewing an Animation</H4>
<P>You can preview your animation in the Agent Character Editor by choosing the Preview command on the Edit menu or the Preview button on the toolbar. This plays your animation, including any branches and sound effects, starting from the current selected frame. It resets to the current selected frame when the animation completes. To play your entire animation, go to the tree view, select the animation's icon or first frame of the animation, and choose the Preview command. The Editor animates your frames on the General page. To stop the preview before it ends, choose the Stop Preview command. The Preview command automatically changes to Stop Preview while the preview plays.
<P><H4>Assigning Speaking Overlays</H4>
<P>You can define a character so that it speaks during the last frame of its animation. On this frame, choose the Overlay page. This page enables you to load and assign mouth image files to the standard mouth positions supported by Microsoft Agent. Click the Add Image button and select the image from the dialog box. You can also select multiple images, and the Editor will load and assign the images starting with the mouth position you selected. Click the Move Up and Move Down buttons or drag an entry to change an image assignment in the list. Click the Delete button to remove an image. You can also edit the pathname of an assigned file by clicking its entry in the list and retyping its filename, or by choosing the Ellipsis (&#133;) button to display the Select Image Files dialog box.
<P><IMG SRC="art/CHA3154I.GIF" WIDTH="457" HEIGHT="407" ALT="[CHA3154I.GIF]">
<P><b><b>Figure 7.  The Overlay page image controls</b></b>
<P><H4>Assigning a Return Animation</H4>
<P>To create a smooth transition from one animation to the next, design your animation sequences to begin and end with a neutral image. For more information, see  <A HREF="DESCHAR.HTM">Designing Characters for Microsoft Agent</A>. However, this does not mean that every animation must end at the neutral position. You can animate a character through a sequence of frames, have it speak during the last frame, and create a separate, complementary animation that returns the character to the neutral position. This complementary animation is called a <b>Return</b> animation. Define a <b>Return</b> animation like any other animation. To assign the <b>Return</b> animation, select an animation in the tree, and select the <b>Return</b> animation you created from the <b>Return</b> Animation drop-down list on the Properties page.
<P>Creating and assigning a <b>Return</b> animation has an added benefit: When the server gets a request to play another animation, it will attempt to play the <b>Return</b> animation for the last animation it played, if a <b>Return</b> animation is assigned. This ensures a smooth transition. If an animation begins and ends at the neutral position, you don't need to define a <b>Return</b> animation. Similarly, if you intend to handle transitions from one animation to another yourself, you may not need to assign a <b>Return</b> animation.
<P><H4>Assigning Animations to States</H4>
<P>The Microsoft Agent animation services automatically play animations when the hosting client application uses certain methods. For example, when an application calls the <b>MoveTo</b> and <b>GestureAt</b> methods, the server automatically determines where the character is displayed and plays an appropriate animation. Similarly, Microsoft Agent automatically plays <b>Idle</b> animations when the user has not interacted with the character for several seconds. These conditions when the server automatically plays animations on an application's behalf are called <i>states</i>. However, for the server to know which animation to play, you must assign animations to these states. 
<P>To define a state, create the appropriate animation, expand the States entry in the tree view of the Editor window, and select the State icon. The list of animations you have created appear in a list box on the right side of the window. Check the animation you want to assign to this state. Note that you can assign more than one animation to the same state. This allows the server to randomly select different animations for the state. Assigning an animation to a state does not prevent an animation from playing that animation directly.
<P>You can also assign an animation to a state by selecting the animation's entry in the tree. The Assign To State list box on the Properties page lists the states. Select the check box of the state to which you're assigning the animation.
<P><H4>Saving Your Character Definition</H4>
<P>You can save your character's definition file by choosing the Save command on the File menu or the Save Character Definition button on the toolbar. If you want to save the character definition file with a new name, choose the Save As command on the File menu. The Editor saves a character's editable definition as an Agent Character Definition (.ACD) file. You can also edit this self-documenting text file format with most text editors and word processing applications.
<P><H4>Printing Your Character Definition</H4>
<P>To print your character's definition, choose the Print command on the File menu or the Print button on the toolbar. To set the properties for your printed output, choose the Page Setup command and choose your settings before selecting the Print command.
<P><H4>Building A Character</H4>
<P>When you are done creating your animations, the character and images must be compiled into a special format that Microsoft Agent uses to load this data. To build a character, select the Build Character command on the File menu or from the toolbar. If you have unsaved edits in your character definition file, the Editor saves the definition file before displaying the Build Character dialog box. 
<P><IMG SRC="art/CHAfig8.GIF" WIDTH="465" HEIGHT="316" ALT="chafig8.gif">
<P><b>Figure 7.  The Build Character dialog box</b>

<P>The Agent Character Editor will automatically propose a filename based on your character definition filename. The Build Character dialog box also includes a drop-down list so you can choose between building the character as a single storage file (.ACS) or as multiple files. If you choose the latter, the Editor builds an .ACF file that includes character's data and an .AAF file for each animation you created. If you plan to install and access a character stored on the same machine as your client application, you would typically choose the single structured file format. This format provides easy and efficient installation of and access to the character. However, if the character will be accessed from a Web server using the HTTP protocol, build your character using the .ACF (individual) file format. This latter file structure allows a Web page script to load individual animation files, storing the data in the user's browser file cache. It provides more efficient access over the Web because animation data can be downloaded as needed rather than requiring the user to wait for the entire set of animations to download at one time. In addition, because the character's data is stored in the browser cache, the file space can be automatically reclaimed. 
<P>Although you can also download character data (either as a single structured file or multiple files) from a Web server and install elsewhere on a user's machine, such a method requires security provisions for downloading and installation. As a result, Microsoft Agent does not include support for downloadable installation of a character except to the browser's cache. However, you can still support this scenario by creating your own installation control and distribute it following appropriate security conventions. For more information, see the  <A HREF="../" TARGET="_top">Microsoft Internet Client Software Development Kit</A>.
<P>The Compress option enables you to set whether the character data is compressed. Typically, you will want to set this option to compact your character data, although building a character with the compacted data takes longer.
<P>Once you build a character, subsequent builds will be faster if you build the character to the same directory location. The character editor automatically verifies and copies those files that have not changed, and recompiles any data that has been edited.
<P><H4>Editing an Existing Character</H4>
<P>To edit an existing character, choose Open on the File menu, select the character's definition file (.ACD) in the resulting dialog box, and choose Open. The file will load into the Editor. Note that you cannot load compiled character files (.ACS, .ACF, or .AAF) with the Editor. 
<P>Because the character's definition file (.ACD) is a text file, you can also edit a character's definition by opening the file with a text editor or word processing program. However, when completing your changes, make sureto save the file in its original format before loading it into the character editor for compilation.
<H4>Storing Additional Data in Your Character Definition</H4>
<P>You can also store your own data as part of your character. You can use this capability to include special information about your character or other data. Once compiled with the character editor, this information can be accessed at run time when the character is loaded by using the <b>ExtraData</b> property. 
<P>To define your own data as part of the character's definition, you must load the character's definition file (.ACD) into a text editor. Then in the DefineCharacter section of the file (between the DefineCharacter and EndCharacter tags), add an entry using the following syntax:
<P><PRE>
ExtraData = "<i>string</i>"
</PRE>
<P>The string you supply should appear between two double-quotes and can include any characters other than double quotes, provided that the programming language you use to read the data at run time supports them. You can only include a single ExtraData entry, but the string you supply with it can be of any length.
<P>To compile this data with your character, save the file in the original text format and load the character definition file into the character editor. Then build the character following the normal conventions. You can access the data at run time using the <b>ExtraData</b> property.
<P><A HREF="#top"><IMG SRC="art/uparrow.gif"  BORDER="0" WIDTH=14 HEIGHT=10 ALT="uparrow.gif">Back to contents</A>
<P><H3><A NAME="TOPIC5"></A> Command Reference</H3>
<P><H4>The File Menu</H4>
<P><b>New</b>
<P>Resets the Agent Character Editor for creating a new character definition. If an existing character is loaded and has unsaved edits, the Editor displays a message to determine whether to save or discard unsaved changes.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Open</b>
<P>Displays the Open File dialog box, enabling you to open an existing character definition file for editing. If an existing character is loaded and has unsaved edits to a file, the Editor displays a message to determine whether to save or discard unsaved changes.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Save</b>
<P>Saves the character definition. If the character definition does not exist (has not been named), the Editor displays the Save As dialog box for input of the filename.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Save As</b>
<P>Displays the Save As dialog box, enabling you to enter a new name for the character definition file. 
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Print</b>
<P>Displays the Print dialog box, enabling you to choose a printing option and to print the character definition file.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Build Character</b>
<P>Displays the Build Character dialog box, which includes options for defining how to build a character's data and animation files for use with Microsoft Agent. 
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Page Setup</b>
<P>Displays the Page Setup dialog box that enables you to set the printing options for the character definition file.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Most Recently Open Files</b>
<P>Keeps track of the recent character definition files you opened. Choosing a file automatically opens that file for editing. If an existing character is loaded and has unsaved edits to a file, the Editor displays a message to determine whether to save or discard unsaved changes.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Exit</b>
<P>Quits the Agent Character Editor. If an existing character is loaded and has unsaved edits to a file, the Editor displays a message to determine whether to save or discard unsaved changes.
<P>&nbsp;<br><H4>The Edit Menu</H4>
<P><b>Undo</b>
<P>Removes a change made in the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Redo</b>
<P>Reverses an undo action in the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Cut</b>
<P>Removes the selected item from the Editor and places it on the Windows Clipboard.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Copy</b>
<P>Copies the selected item in the Editor to the Windows Clipboard.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Paste</b>
<P>Copies data from the current Windows Clipboard to the selected location.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Delete</b>
<P>Removes the selected item from the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>New Animation</b>
<P>Creates a new animation object in the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>New Frame</b>
<P>Creates a new frame for an animation.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>New Frames from Files</b>
<P>Displays the Select Image Files dialog box and creates frames using the selected files.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Preview | Stop Preview</b>
<P>Plays an animation, starting from its selected frame.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>Open Frame Window</b>
<P>Displays the current frame and its images in a separate window without scaling the images loaded into the frame.
<P>&nbsp;<br><H4>The Help Menu</H4>
<P><b>Help Topics</b>
<P>Displays the Help Topics dialog box, enabling you to select a Editor help topic.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><b>About Microsoft Editor</b>
<P>Displays a dialog box with copyright and version information for the Editor.
<P><A HREF="#top"><IMG SRC="art/uparrow.gif"  BORDER="0" WIDTH=14 HEIGHT=10 ALT="uparrow.gif">Back to contents</A>
<P>&nbsp;<br><H3><A NAME="TOPIC6"></A> Toolbar buttons</H3>
<P><IMG SRC="art/CHA3154K.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154K  951 bytes ]">
<P><b>New</b>
<P>Resets the Editor for creating a new character definition. If an existing character is loaded and has unsaved edits to a file(s), the Editor displays a message to determine whether to save or discard unsaved changes.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154L.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154L.GIF]">
<P><b>Open</b>
<P>Displays the Open File dialog box, enabling you to open an existing character definition file for editing. If an existing character is loaded and has unsaved edits to a file(s), the Editor displays a message to determine whether to save or discard unsaved changes.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154M.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154M.GIF]">
<P><b>Save</b>
<P>Saves the character definition. If the character definition does not exist (has not been named), the Editor displays the Save As dialog box for input of the filename.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154N.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154N.GIF]">
<P><b>Print</b>
<P>Prints the current character definition file open in the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154O.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154O.GIF]">
<P><b>Cut</b>
<P>Removes the selected item in the Editor and places it on the Windows Clipboard.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154P.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154P.GIF]">
<P><b>Copy</b>
<P>Copies the selected item in the Editor to the Windows Clipboard.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154Q.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154Q.GIF]">
<P><b>Paste</b>
<P>Copies data from the current Windows Clipboard to the selected location.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154R.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154R.GIF]">
<P><b>Delete</b>
<P>Removes the selected item from the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154S.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154S.GIF]">
<P><b>Undo</b>
<P>Removes a change made in the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154T.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154T.GIF]">
<P><b>Redo</b>
<P>Reverses an undo action in the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154U.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154U.GIf">
<P><b>New Animation</b>
<P>Creates a new animation object in the Editor.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154V.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154V.GIF]">
<P><b>New Frame</b>
<P>Creates a new frame for an animation.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154W.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154W.GIF">
<P><b>Preview</b> 
<P>Plays an animation, starting from its selected frame.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154X.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154X.GIF]">
<P><b>Stop Preview</b>
<P>Stops playing the preview of an animation.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154Y.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154Y.GIF]"> 
<P><b>Add Image File</b>
<P>Displays the Select Image File dialog box. Selected images are added to the list. 
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CHA3154Z.GIF" WIDTH="23" HEIGHT="22" ALT="[CHA3154Z.GIF]"> 
<P><b>Move Up</b>
<P>Moves an image up in the ordered (z-ordered) list. In a frame's images list, this moves the image up in the visual z-order.
<P><HR WIDTH="25%" ALIGN="LEFT">
<P><IMG SRC="art/CH3154AB.GIF" WIDTH="23" HEIGHT="22" ALT="[CH3154AB.GIF]">
<P><b>Move Down</b>
<P>Moves an image down in the ordered (z-ordered) list. In a frame's images list, this moves the image down in the visual z-order.
<P><A HREF="#top"><IMG SRC="art/uparrow.gif"  BORDER="0" WIDTH=14 HEIGHT=10 ALT="uparrow.gif">Back to contents</A>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>