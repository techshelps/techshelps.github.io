<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Authoring Notes for Migrating from Internet Explorer 3.0 to Internet Explorer 4.0</TITLE>

<META NAME=MS-HKWD CONTENT="Authoring Notes for Migrating from Internet Explorer 3.0 to Internet Explorer 4.0">
<META NAME="Keywords" CONTENT="Internet Client SDK">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = ''	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="bk_iecompat"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Authoring Notes for Migrating from Internet Explorer 3.0 to Internet Explorer 4.0"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="art/headIC.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Authoring Notes for Migrating from Internet Explorer 3.0 to Internet Explorer 4.0"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="contents.htm">Contents</A>  <IMG SRC="art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="index.htm">Index</A>  <IMG SRC="art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="faq.htm">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><A NAME="dhtml_compatibility">Authoring Notes for Migrating from Internet Explorer 3.0 to Internet Explorer 4.0</A></H1>
<P>Compatibility is a key priority for Microsoft&#174; Internet Explorer 4.0. As much as possible, we want to ensure that users who upgrade from Internet Explorer 3.0 will not be affected adversely. Goals for compatibility are:


<UL><LI>Compliance with existing W3C standards&#151;CSS1, HTML 4, and so on. 
 <LI>Accurate rendering of content on the Web. Web site authors expect Internet Explorer 4.0 to render their pages as they designed them.
</UL>
<P>Users should experience the behavior they expect, and Internet Explorer achieves this within the boundaries of the aforementioned goals. The combination of these factors and some bug fixes causes Internet Explorer 4.0 to render some pages differently from Internet Explorer 3.0. While we have kept these differences to a minimum, some issues are unavoidable. The following sections outline the most salient differences that authors will encounter.

<UL><LI><A HREF="iecompat.htm#General_Authoring">General Authoring Issues</A>
<LI><A HREF="iecompat.htm#CSS_Compatibility">CSS Compatibility with Internet Explorer 3.0</A>
<LI><A HREF="iecompat.htm#Using_Different_StylShts">Using Different Style Sheets</A>
<LI><A HREF="iecompat.htm#International_Issues">International Issues</A>
</UL>
<H3><A NAME="General_Authoring">General Authoring Issues</A></H3>
<P>
<table border="1" STYLE="font-size:12">
<TR><TD><strong><u>Summary or Symptom in IE4</u></strong></TD><TD><strong><u>Description</u></strong></TD><TD><strong><u>Reason</u></strong></TD></TR>
<TR><TD>FRAMESET inside a BODY is ignored.</TD><TD>FRAMESET and BODY are mutually exclusive tags for IE4. Either use one, or the other. If you use both, the second one will be ignored.<p>If you are using the BODY element to set attributes for the contents of the FRAMESET, move these attributes to the FRAMESET. 
<P>Any SCRIPT or OBJECT tags used in a FRAMESET definition document should be defined in the HEAD section of the document, otherwise they will imply a BODY element, and the FRAMESET will be ignored. </TD><TD>Compliance with HTML 4 DTD</TD></TR>
<TR><TD>Improved table width algorithm.</TD><TD>IE4 calculates the width of a table more accurately than IE3, and consequently matches the way many web sites were designed. For example, if the combined widths of the cells in a table exceed the width set for the TABLE, IE4 uses the cumulative width of the cells to override the width set for TABLE. IE3 would have adjusted the widths of the cells to fit the width of the TABLE. <p>TFOOT, TBODY, THEAD were rendered in source order for IE3. According to W3C specifications, the order of these table elements should not matter. IE4 matches the spec. For example, if a TFOOT appears first in source order, IE4 will still render the contents of the TFOOT at the end of the table. </TD><TD>Better compatibility with real-world pages.</TD></TR>
<TR><TD>Case sensitivity</TD><TD><strong>Javascript</strong> is case sensitive in IE4. Some real-world pages rely on capitalization to result in different variables being defined. Case insensitivity was breaking those scripts.<p><strong>Entities</strong> are case-sensitive. They were not in IE3, except where case-sensitivity was meaningful. For example, &amp;nbsp works for both, but &amp;NBSP will only work on IE3. </TD><TD>Javascript compatibility<p>Microsoft applications read and generate case sensitive HTML entities. </TD></TR>
<TR><TD>Use system's Window color</TD><TD>If a document does not have its own BGCOLOR specified, IE4 sets the background color based on the system's Windows color, where as IE3 set the window background to the system's default button-face color.</TD><TD>Consistency with other Microsoft applications.</TD></TR>
<TR><TD>mouse* events renamed</TD><TD>mouse* events are non-standard. They are now onmouse*.</TD><TD>JavaScript compatibility</TD></TR>
<TR><TD>Unknown attributes are exposed as implicitly declared variables (&quot;expando feature&quot;)</TD><TD>Any unknown attribute on an element is exposed as an implicitly declared property on the element. This enables authors to specify initial values for implicitly declared properties in their HTML pages. Also known as the &quot;expando&quot; feature.</TD><TD>Enhancement - better compatibility with real world pages.</TD></TR>
<TR><TD>Accessing X-object properties for ActiveX controls</TD><TD>X-object properties are properties which are exposed by the IE4 container on all objects in IE4. If an object has a property or method which conflicts with an X-object property/method, then the object's property/method should be accessed explicitly as item.object.property, instead of item.property.</TD><TD>Enhancement</TD></TR>
<TR><TD>Page cache (1)</TD><TD>IE3 kept the last 4 pages in memory as they were rendered. When the user hit the back arrow, IE3 pulled the page straight from cache to the screen. This caused some subtle problems. For instance, Scripts were not re-run (for instance, the onload event was not fired), dynamically generated content was not up-to-date (like a script generating the local time), and this mechanism used a lot of memory.<p>IE4 implements a history mechanism, which stores the URL of a page (or the URL list of a frameset) and associates a &quot;history stream&quot; with the URL . When the user navigates away from a page, the document and the objects living in the document get a chance to save their state. Things that are saved as part of the history of the document include the document's vertical scroll position, form values, and information from controls which specifically implement the IPersistHistory interface.  Controls which want to persist their state must support IPersistHistory. </TD><TD>Better support for dynamic pages and existing content</TD></TR>
<TR><TD>Page caching (2)</TD><TD>IE30 - doesn't always pull from the cache for a repeat visit to a page with a form. <p>IE40 - always pulls from the cache if HTTP (won't pull from cache for HTTPs). 
<P>Solution: 
<P>Put the following in the META tag in the HEAD of the document: 
<P><font color="#000000">&lt;META HTTP-EQUIV=&quot;expires&quot; CONTENT=&quot;0&quot;&gt;</FONT></TD><TD>Bug fix</TD></TR>
<TR><TD>Form submission with a GET method</TD><TD>&lt;FORM METHOD=get <p>ACTION=&quot;http://www.Microsoft.com?value1=boo&quot;&gt; 
<P>For the above HTML, IE3 would submit the name/value pair &quot;value1=boo&quot; to the server. IE4 ignores the part of the action after the &quot;?&quot; and forms the submit string based on the contents of the form. </TD><TD>Better compatibility with existing content.</TD></TR>
</table>
<BR CLEAR=ALL><H3><A NAME="CSS_Compatibility">CSS Compatibility with Internet Explorer 3.0</A></H3>
<P>Internet Explorer 3.0 introduced cascading style sheets (CSS) to the Web with the first implementation of a working draft from the World Wide Web Consortium (W3C). Since this time, the W3C style sheets working group has published a CSS recommendation. The Internet Explorer 4.0 implementation of CSS is based on the final CSS recommendation. What this means for authors is that the CSS implementation is a richer, complete implementation that also includes bug fixes and reflects any specification changes made from earlier drafts. The following is a list of issues that might affect authors who have authored pages using CSS in Internet Explorer 3.0. In some cases, we've fixed bugs, and in other cases there have been specification changes or clarifications.

<P>Authors might choose to use separate style sheets for Internet Explorer 3.0 and Internet Explorer 4.0. See the section following the table for ideas on how to use separate style sheets for each browser.

<P>
<table border="1" STYLE="font-size:12">
<TR><TD><strong><u>Summary or Symptom in IE4</u></strong></TD><TD><strong><u>Description</u></strong></TD><TD><strong><u>Reason</u></strong></TD></TR>
<TR><TD>Multiple stylesheets</TD><TD>IE3 applied only one (the last) styleSheets for a page. IE4 supports multiple stylesheets per page - including multiple linked and imported stylesheets.</TD><TD>Better CSS support</TD></TR>
<TR><TD>HTML vs. CSS inheritance</TD><TD>Correct inheritance when style properties are mixed with HTML properties. In IE3, style properties always override any non-styleSheets rendering properties. For example, if <strong>text-decoration</strong> is set to &quot;none&quot; on the &lt;HTML&gt; tag, &lt;A&gt; tags would not be underlined (this is incorrect). In IE4, underlining is removed only if <strong>text-decoration </strong>is set to &quot;none&quot; on all &lt;A&gt; tags, not the &lt;HTML&gt; tag.<p>Another example: IE3 would set margins on the BODY relative to the default BODY margins or the margins set with the TOPMARGIN and LEFTMARGIN attributes. IE4 correctly overrides HTML settings with CSS, so these attributes (as well as the default margin settings) are overridden with a CSS margin set for the BODY. </TD><TD>Spec Compliance</TD></TR>
<TR><TD>Better CSS support - margins</TD><TD>IE4 correctly implements vertical margin (top and bottom) collapsing; inserted non-overridable margins between paragraph elements. IE4 collapses vertical margins together, as per specifications, and vertical paragraph margins are overridden by any top- and bottom-margins on the paragraphs.<p>IE4 replaces margin values, where IE3 would add the margin value to the default margin value. </TD><TD>Spec Compliance</TD></TR>
<TR><TD>Better CSS support - line-height</TD><TD>An earlier working draft of the CSS specification said that line-height should be measured between baselines. The CSS Recommendation states that line-height is calculated as the &quot;line-box&quot; (includes leading for ascenders and decenders) and that the balance of space is split between the top and bottom of the line.</TD><TD>Spec Compliance</TD></TR>
<TR><TD>CSS inheritance in tables</TD><TD>IE3.0 - TABLE, TR, TD were treated as any other element, and CSS inheritance rules applied as they would to any other element.<p>IE4.0 - treats CSS formatting for tables the same as HTML formatting elements. Precedence for HTML formatting attributes dictate that TABLE formatting does not inherit from previous content. Therefore, CSS attributes are not inherited by TABLE elements either.  
<P>NOTE: the defaults for these formatting elements can be set by the BODY, and do not necessarily default to their initial values. </TD><TD>&nbsp;</TD></TR>
<TR><TD>BODY and LINKed stylesheets</TD><TD>IE3 didn't handle background images and body properties set through linked stylesheets. IE4 does.</TD><TD>Bug fix</TD></TR>
<TR><TD>Comments</TD><TD>IE3 supported C++ style comments - IE4 does not</TD><TD>Spec compliance</TD></TR>
<TR><TD>HR inherits color property from the BODY</TD><TD>Setting the color property for the BODY would affect the color of an HR. IE4 does not pick up the color from the BODY. </TD><TD>Spec Compliance</TD></TR>
<TR><TD>background on block level elements</TD><TD>In IE3, the background would not extend to the complete width of the element. In IE4 it does. <p>For example, in IE3, only the text contained in a DIV would have a background color. In IE4 the entire rectangle for the DIV gets the background setting. </TD><TD>Spec compliance</TD></TR>
<TR><TD>font-size calculation</TD><TD>IE3 - the font size is calculated as a percent of the elements default/initial font size<p>IE4 - the font-size is calculated as a percent of the parent element's font size 
<P>If you set a font-size style for H1 to 85%, for example, the font will be slightly smaller than a normal H1 in IE3, but it will be smaller than normal text in IE4. </TD><TD>Bug fix</TD></TR>
<TR><TD>Error handling</TD><TD>IE3 would throw errors for missing/bad linked stylesheets - IE4 will fail silently</TD><TD>Better user experience</TD></TR>
</table>
<BR CLEAR=ALL><H3><A NAME="Using_Different_StylShts">Using Different Style Sheets</A></H3>
<P>Several techniques can be used to tailor your page for use in Internet Explorer 3.0 and Internet Explorer 4.0 using cascading style sheets. This section describes two of them:

<UL><LI><A HREF="iecompat.htm#css_multiple_sheets">use multiple style sheets</A>, and place Internet Explorer 4.0 specific styles in the primary style sheet, or
<LI><A HREF="iecompat.htm#css_use_import">use @import</A> to import Internet Explorer 4.0 specific styles
<LI><A HREF="iecompat.htm#css_use_dom">use the Document Object Model</A> to manipulate the style sheets if Internet Explorer 4.0 is in use
</UL>
<H4><A NAME="css_multiple_sheets">Using Multiple Style Sheets</A></H4>
<P>To use this technique, observe these facts about Internet Explorer 3.0:
<UL><LI>only a single style sheet is supported
<LI>the <A HREF="dhtml/references/properties/disabled_1.htm#disabled_1">disabled</A> attribute is not supported
</UL>
<P>Define multiple style sheets using the <A HREF="dhtml/references/objects/STYLE.htm#STYLE">STYLE</A> or <A HREF="dhtml/references/objects/LINK.htm#LINK">LINK</A> elements within a document. Add Internet Explorer 3.0 specific style information to the last style sheet defined in the document. Internet Explorer 3.0 uses the last style sheet it encounters. To prevent Internet Explorer 4.0 from using it, add the <A HREF="dhtml/references/properties/disabled_1.htm#disabled_1">disabled</A> attribute.

<P>For example, given the following style sheet:

<PRE>&lt;STYLE TITLE=css_ie4&gt;
   body   {font-weight:bold}
&lt;/STYLE&gt;
&lt;STYLE TITLE=css_ie3 DISABLED&gt;
   body   {font-style:italic} 
&lt;/STYLE&gt;
</PRE>
<P>Internet Explorer 4.0 will set the content within the body of the document to bold, but Internet Explorer 3.0 will italicize that same content.

<H4><A NAME="css_use_import">Use @import</A></H4>
<P>Internet Explorer 3.0 does not support <A HREF="dhtml/references/css/import.htm#_import">@import</A>, so define Internet Explorer 4.0 specific styles in a separate file, and use <B>@import</B> to import them.

<P>When Internet Explorer 4.0 loads a document containing the following HTML code, it will import and use the style sheet information in "ie4specfic.css". Because the <A HREF="dhtml/references/objects/LINK.htm#LINK">LINK</A> element includes the <A HREF="dhtml/references/properties/disabled_1.htm#disabled_1">disabled</A> attribute, Internet Explorer 4.0 will not apply the styles. On the other hand, Internet Explorer 3.0 will use the styles defined in "ie3specific.css" because: 

<OL><LI>it is the last style sheet encountered
<LI>the <A HREF="dhtml/references/properties/disabled_1.htm#disabled_1">disabled</A> attribute is ignored
</OL>
<PRE>&lt;STYLE&gt;
   @import url(ie4specific.css);
&lt;/STYLE&gt;
&lt;LINK disabled REL="stylesheet" HREF ="ie3specific.css"&gt;
</PRE>
<P>In the following example, Internet Explorer 4.0 uses the styles contained within "ie4specific.css" as well as the styles defined directly within the <A HREF="dhtml/references/objects/STYLE.htm#STYLE">STYLE</A> tag. Internet Explorer 3.0 only applies the <B>h1</B> and <B>h2</B> styles.

<PRE>&lt;STYLE&gt;
   @import url(ie4specific.css);
   h1  {color:green}
   h2  {font-style:italic}
&lt;/STYLE&gt;
</PRE>
<H4><A NAME="css_use_dom">Using the Document Object Model to Manipulate Style Sheets</A></H4>
<P>Internet Explorer 4.0 exposes styles and style sheets through the Document Object Model. Styles and style sheets can be added, styles can be removed, and style sheets can be disabled using any installed scripting language. To use this technique, 

<UL><LI>check for Internet Explorer 4.0 or greater at document load time, 
<LI>disable the first style sheet in the <A HREF="dhtml/references/collections/styleSheets.htm#styleSheets">styleSheets</A> collection, 
<LI>add a new style sheet
</UL>
<P>The following code can be associated with the <A HREF="dhtml/references/events/onload.htm#onload">onload</A> event of the body.

<PRE>&lt;SCRIPT&gt;
function HandleOnLoad()
{
   cUA = window.navigator.userAgent;
   if (parseInt(cUA.substring(cUA.indexOf("MSIE ")+5, 
      cUA.indexOf( ".", cUA.indexOf ( "MSIE " ) ))) &gt;= 4)
   {
      document.styleSheets[0].disabled = true;
      document.createStyleSheet("ie4specific.css");
   }
}
&lt;/SCRIPT&gt;
</PRE>
<H3><A NAME="International_Issues">International Issues</A></H3>
<P>
<table border="1" STYLE="font-size:12">
<TR><TD><strong><u>Summary or Symptom in IE4</u></strong></TD><TD><strong><u>Description</u></strong></TD><TD><strong><u>Reason</u></strong></TD></TR>
<TR><TD>One NCR represents one character</TD><TD>Under DBCS language, such as Japanese, Chinese, and Korean, a pair of NCRs (Numeric Character References) are treated as one double byte character in IE3. For instance, &amp;#136;&amp;#159; is rendered as Chinese character U+4e9c (Unicode codepoint) in IE3 with charset=Shift_JIS. In IE4 the same pair is displayed as two high-ANSI characters in IE4.</TD><TD>Bug Fix</TD></TR>
<TR><TD>Line spacing </TD><TD>For FE fonts where leading is not 0, IE4 increases the font height by 1/8 for better readability of ascenders and decenders.</TD><TD>Enhancement</TD></TR>
<TR><TD>Font linking</TD><TD>Font linking enables display characters that are not supported by the specified font. <pre>&lt;FONT FACE=Arial&gt;some double byte characters here&lt;/FONT&gt;.&nbsp; </pre>
<P>For IE3, non ASCII characters enclosed by a FONT element are displayed in default glyphs (looks like garbage to the end user). For the same scenario, IE4 fontlinking picks up an appropriate font if IE4 can find one. IE4 uses the information you provide under View.Options.Fonts. You can use the Multilanguage support offered on the IE4 download site or shipped with NT4 to add fonts for languages that are not native to your system. </TD><TD>Enhancement</TD></TR>
<TR><TD>Express Unicode values directly.</TD><TD>IE3 interpreted NCRs (&amp;#nnn) as bytes within the system's active code page. IE4 interprets the NCRs as Unicode code points. This breaks compatibility with pages authored for IE3 using NCRs and designed for character sets other than Latin1. (IE4 treats less than 256 as Latin1, and greater than 256 as Unicode.)</TD><TD>Better compatibility with existing pages.</TD></TR>
<TR><TD>Carriage return is treated as white space</TD><TD>In IE3, carriage returns (White space) in the source of FE characters result in one single space regardless of the contents.&nbsp; IE4 collapses the space if the carriage return is between FE characters in source.</TD><TD>Enhancement</TD></TR>
<TR><TD>FORM posting</TD><TD>IE3 submits a &lt;FORM&gt; using the Window's character set of the local machine. IE4 submits form data using the character set that the &lt;FORM&gt; element is embedded in.</TD><TD>Bug Fix</TD></TR>
</table>
<BR CLEAR=ALL>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>