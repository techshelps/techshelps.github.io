<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MoveFirst, MoveLast, MoveNext, and MovePrevious Methods Example (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="MoveFirst, MoveLast, MoveNext, and MovePrevious Methods Example (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<P><a name="admthmovefirstx"></a><b>MoveFirst, MoveLast, MoveNext, and MovePrevious Methods Example</b>
<p>This example uses the <b>MoveFirst</b>, <b>MoveLast</b>, <b>MoveNext</b>, and <b>MovePrevious </b>methods to move the record pointer of a <b>Recordset </b>based on the supplied command. The MoveAny procedure is required for this procedure to run.
<pre>Public Sub MoveFirstX()

&#09;Dim rstAuthors As ADODB.Recordset
&#09;Dim strCnn As String
&#09;Dim strMessage As String
&#09;Dim intCommand As Integer

&#09;' Open recordset from Authors table.
&#09;strCnn = &quot;driver={SQL Server};server=srv;&quot; &amp; _
&#09;&#09;&quot;uid=sa;pwd=;database=pubs&quot;
&#09;Set rstAuthors = New ADODB.Recordset
&#09;rstAuthors.CursorType = adOpenStatic
&#09;' Use client cursor to enable AbsolutePosition property.
&#09;rstAuthors.CursorLocation = adUseClient
&#09;rstAuthors.Open &quot;authors&quot;, strCnn, , , adCmdTable

&#09;' Show current record information and get user's method choice.
&#09;Do While True

&#09;&#09;strMessage = &quot;Name: &quot; &amp; rstAuthors!au_fName &amp; &quot; &quot; &amp; _
&#09;&#09;&#09;rstAuthors!au_lName &amp; vbCr &amp; &quot;Record &quot; &amp; _
&#09;&#09;&#09;rstAuthors.AbsolutePosition &amp; &quot; of &quot; &amp; _
&#09;&#09;&#09;rstAuthors.RecordCount &amp; vbCr &amp; vbCr &amp; _
&#09;&#09;&#09;&quot;[1 - MoveFirst, 2 - MoveLast, &quot; &amp; vbCr &amp; _
&#09;&#09;&#09;&quot;3 - MoveNext, 4 - MovePrevious]&quot;
&#09;&#09;intCommand = Val(Left(InputBox(strMessage), 1))
&#09;&#09;If intCommand &lt; 1 Or intCommand &gt; 4 Then Exit Do

&#09;&#09;' Call method based on user's input.
&#09;&#09;MoveAny intCommand, rstAuthors
&#09;Loop
&#09;rstAuthors.Close

End Sub

Public Sub MoveAny(intChoice As Integer, _
&#09;rstTemp As Recordset)

&#09;' Use specified method, trapping for BOF and EOF.
&#09;Select Case intChoice
&#09;&#09;Case 1
&#09;&#09;&#09;rstTemp.MoveFirst
&#09;&#09;Case 2
&#09;&#09;&#09;rstTemp.MoveLast
&#09;&#09;Case 3
&#09;&#09;&#09;rstTemp.MoveNext
&#09;&#09;&#09;If rstTemp.EOF Then
&#09;&#09;&#09;&#09;MsgBox &quot;Already at end of recordset!&quot;
&#09;&#09;&#09;&#09;rstTemp.MoveLast
&#09;&#09;&#09;End If
&#09;&#09;Case 4
&#09;&#09;&#09;rstTemp.MovePrevious
&#09;&#09;&#09;If rstTemp.BOF Then
&#09;&#09;&#09;&#09;MsgBox &quot;Already at beginning of recordset!&quot;
&#09;&#09;&#09;&#09;rstTemp.MoveFirst
&#09;&#09;&#09;End If
&#09;End Select

End Sub</PRE>
<p><b>VBScript Version</b>
<p>The following is the same example written in VBScript to be used in an Active Server Page (ASP). To view this example, you need to create a system Data Source Name (DSN) called AdvWorks for the Microsoft Access database file AdvWorks.mdb, which is installed with Microsoft Internet Information Server and located at C:\InetPub\ASPSamp\AdvWorks. Locate the file adovbs.inc and place it in the directory you plan to use. Cut and paste the following code to Notepad or another text editor and save it as MoveOne.asp. You can view the result in any client browser.
<p>Try moving beyond the upper or lower limits of the recordset to see error handling work.
<pre>&lt;!-- #Include file=&quot;ADOVBS.INC&quot; --&gt;
&lt;% Language = VBScript %&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;TITLE&gt;ADO 1.5 MoveNext MovePrevious MoveLast MoveFirst Methods&lt;/TITLE&gt;&lt;/HEAD&gt;
&lt;BODY&gt; 
&lt;FONT FACE=&quot;MS SANS SERIF&quot; SIZE=2&gt;
&lt;Center&gt;
&lt;H3&gt;ADO Methods&lt;BR&gt;MoveNext MovePrevious MoveLast MoveFirst&lt;/H3&gt;
&lt;!-- Create Connection and Recordset Objects on Server --&gt;
&lt;%
 'Create and Open Connection Object
Set OBJdbConnection = Server.CreateObject(&quot;ADODB.Connection&quot;) 
OBJdbConnection.Open &quot;AdvWorks&quot; 
'Create and Open Recordset Object
Set RsCustomerList = Server.CreateObject(&quot;ADODB.Recordset&quot;)
RsCustomerList.ActiveConnection = OBJdbConnection
RsCustomerList.CursorType = adOpenKeyset
RsCustomerList.LockType = adLockOptimistic
RsCustomerList.Source = &quot;Customers&quot;

RsCustomerList.Open

' Check Request.Form collection to see if any moves are recorded

If Not IsEmpty(Request.Form(&quot;MoveAmount&quot;)) Then
'Keep track of the number and direction of moves this session
&#09;
&#09;Session(&quot;Moves&quot;) = Session(&quot;Moves&quot;) + Request.Form(&quot;MoveAmount&quot;)
&#09;
&#09;Clicks = Session(&quot;Moves&quot;)
'Move to last known position
&#09;RsCustomerList.Move CInt(Clicks)
'Check if move is + or - and do error checking
&#09;&#09;If CInt(Request.Form(&quot;MoveAmount&quot;)) = 1 Then
&#09;&#09;
&#09;&#09;&#09;If RsCustomerList.EOF Then
&#09;&#09;&#09;&#09;Session(&quot;Moves&quot;) = RsCustomerList.RecordCount
&#09;&#09;&#09;&#09;RsCustomerList.MoveLast
&#09;&#09;&#09;End If&#09;

&#09;&#09;&#09;RsCustomerList.MoveNext
&#09;&#09;End If

&#09;&#09;If Request.Form(&quot;MoveAmount&quot;) &lt; 1 Then
&#09;&#09;&#09;
&#09;&#09;&#09;RsCustomerList.MovePrevious
&#09;&#09;End If
'Check if First Record or Last Record Command Buttons Clicked
&#09;&#09;If Request.Form(&quot;MoveLast&quot;) = 3 Then
&#09;&#09;&#09;RsCustomerList.MoveLast
&#09;&#09;&#09;Session(&quot;Moves&quot;) = RsCustomerList.RecordCount
&#09;&#09;End If
&#09;&#09;If Request.Form(&quot;MoveFirst&quot;) = 2 Then
&#09;&#09;&#09;RsCustomerList.MoveFirst
&#09;&#09;&#09;Session(&quot;Moves&quot;) = 1
&#09;&#09;End If
&#09;
&#09;
End If
' Do Error checking for combination of Move Button clicks
&#09;&#09;If RsCustomerList.EOF Then
&#09;&#09;&#09;Session(&quot;Moves&quot;) = RsCustomerList.RecordCount
&#09;&#09;&#09;RsCustomerList.MoveLast
&#09;&#09;&#09;Response.Write &quot;This is the Last Record&quot;
&#09;&#09;&#09;End If&#09;
&#09;
&#09;&#09;If RsCustomerList.BOF Then
&#09;&#09;&#09;Session(&quot;Moves&quot;) = 1
&#09;&#09;&#09;RsCustomerList.MoveFirst
&#09;&#09;&#09;Response.Write &quot;This is the First Record&quot;
&#09;&#09;End If
&#09;

%&gt;

&lt;H3&gt;Current Record Number is &lt;BR&gt;
&lt;!-- Display Current Record Number and Recordset Size --&gt;
&lt;% If IsEmpty(Session(&quot;Moves&quot;))  Then 
Session(&quot;Moves&quot;) = 1
End If
%&gt;

&lt;%Response.Write(Session(&quot;Moves&quot;) )%&gt; of &lt;%=RsCustomerList.RecordCount%&gt;&lt;/H3&gt;
&lt;HR&gt;


&lt;Center&gt;&lt;TABLE COLSPAN=8 CELLPADDING=5 BORDER=0&gt;

&lt;!-- BEGIN column header row for Customer Table--&gt;

&lt;TR&gt;&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Company Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Contact Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER WIDTH=150 BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Phone Number&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;City&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;State/Province&lt;/FONT&gt;
&lt;/TD&gt;&lt;/TR&gt;

&lt;!--Display ADO Data from Customer Table--&gt;

  &lt;TR&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt; 
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RSCustomerList(&quot;CompanyName&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;ContactLastName&quot;) &amp; &quot;, &quot; %&gt; 
      &lt;%= RScustomerList(&quot;ContactFirstName&quot;) %&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt;
     
      &lt;%= RScustomerList(&quot;PhoneNumber&quot;)%&gt; 
   &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;City&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;StateOrProvince&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;/TR&gt; &lt;/Table&gt;&lt;/FONT&gt;


&lt;HR&gt;
&lt;Input Type = Button Name = cmdDown  Value = &quot;&lt;    &quot;&gt;
&lt;Input Type = Button Name = cmdUp Value = &quot;    &gt;&quot;&gt;
&lt;BR&gt;
&lt;Input Type = Button Name = cmdFirst Value = &quot;First Record&quot;&gt;

&lt;Input Type = Button Name = cmdLast Value = &quot;Last Record&quot;&gt;
&lt;H5&gt;Click Direction Arrows to Use MovePrevious or MoveNext 
&lt;BR&gt; &lt;/H5&gt;

&lt;!-- Use Hidden Form Fields to send values to Server --&gt;

&lt;Form Method = Post Action=&quot;MoveOne.asp&quot; Name=Form&gt;
&lt;Input Type=&quot;Hidden&quot; Size=&quot;4&quot; Name=&quot;MoveAmount&quot; Value = 0&gt;
&lt;Input Type=&quot;Hidden&quot; Size=&quot;4&quot; Name=&quot;MoveLast&quot; Value = 0&gt;
&lt;Input Type=&quot;Hidden&quot; Size=&quot;4&quot; Name=&quot;MoveFirst&quot; Value = 0&gt;
&lt;/Form&gt;&lt;/BODY&gt;

&lt;Script Language = &quot;VBScript&quot;&gt;

Sub cmdDown_OnClick
'Set Values in Form Input Boxes and Submit Form
&#09;Document.Form.MoveAmount.Value = -1
&#09;Document.Form.Submit
End Sub

Sub cmdUp_OnClick

&#09;Document.Form.MoveAmount.Value = 1
&#09;Document.Form.Submit

End Sub

Sub cmdFirst_OnClick

&#09;Document.Form.MoveFirst.Value = 2
&#09;Document.Form.Submit

End Sub

Sub cmdLast_OnClick

&#09;Document.Form.MoveLast.Value = 3
&#09;Document.Form.Submit

End Sub
&lt;/Script&gt;&lt;/HTML&gt;</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>