<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset Object (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Recordset Object (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="adobjrecordset"></a>Recordset Object</H1>
<p>A <b>Recordset</b> object represents the entire set of records from a base table or the results of an executed command. At any time, the <b>Recordset</b> object only refers to a single record within the set as the current record.
<p><a href="obj01_1.htm"><img src="art/objconn.gif" border=0></a><BR><img src="art/parchild.gif" border=0><img src="art/objrecor.gif" border=0><BR><img src="art/space.gif" border=0><img src="art/parchild.gif" border=0><a href="obj02_1.htm"><img src="art/colfield.gif" border=0></a>
<p><b>Collections</b>
<p><a href="obj02_1.htm"><b>Fields</b></a>, <a href="obj02_3.htm"><b>Properties</b></a>
<p><b>Methods</b>
<p><a href="mth01.htm"><b>AddNew</b></a>, <a href="mth01_4.htm"><b>CancelBatch</b></a>, <a href="mth01_5.htm"><b>CancelUpdate</b></a>, <a href="mth01_7.htm"><b>Clone</b></a>, <a href="mth01_8.htm"><b>Close</b></a>, <a href="mth02_1.htm"><b>Delete</b></a>, <a href="mth02_5.htm"><b>GetRows</b></a>, <a href="mth02_6.htm"><b>Move</b></a>, <a href="mth02_7.htm"><b>MoveFirst</b></a>, <a href="mth02_7.htm"><b>MoveLast</b></a>, <a href="mth02_7.htm"><b>MoveNext</b></a>, <a href="mth02_7.htm"><b>MovePrevious</b></a>, <a href="mth02_8.htm"><b>NextRecordset</b></a>, <a href="mth03_1.htm"><b>Open</b></a>, <a href="mth03_3.htm"><b>Requery</b></a>, <a href="mth03_4.htm"><b>Resync</b></a>, <a href="mth03_5.htm"><b>Supports</b></a>, <a href="mth03_6.htm"><b>Update</b></a>, <a href="mth03_7.htm"><b>UpdateBatch</b></a>
<p><b>Properties</b>
<p><a href="pro01.htm"><b>AbsolutePage</b></a>, <a href="pro01_1.htm"><b>AbsolutePosition</b></a>, <a href="pro01_2.htm"><b>ActiveConnection</b></a>, <a href="pro01_5.htm"><b>BOF</b></a>, <a href="pro01_6.htm"><b>Bookmark</b></a>, <a href="pro02.htm"><b>CacheSize</b></a>, <a href="pro07.htm"><b>CursorLocation</b></a>, <a href="pro02_7.htm"><b>CursorType</b></a>, <a href="pro03_4.htm"><b>EditMode</b></a>, <a href="pro01_5.htm"><b>EOF</b></a>, <a href="pro03_5.htm"><b>Filter</b></a>, <a href="pro04.htm"><b>LockType</b></a>, <a href="pro07_1.htm"><b>MarshalOptions</b></a>, <a href="pro04_1.htm"><b>MaxRecords</b></a>, <a href="pro05_1.htm"><b>PageCount</b></a>, <a href="pro05_2.htm"><b>PageSize</b></a>, <a href="pro05_6.htm"><b>RecordCount</b></a>, <a href="pro06_2.htm"><b>Source</b></a>, <a href="pro07_2.htm"><b>State</b></a>, <a href="pro06_4.htm"><b>Status</b></a>
<p><b>Remarks</b>
<p>You use <b>Recordset</b> objects to manipulate data from a provider. When you use ADO, you manipulate data almost entirely using <b>Recordset</b> objects. All <b>Recordset</b> objects are constructed using records (rows) and fields (columns). Depending on the functionality supported by the provider, some <b>Recordset</b> methods or properties may not be available.
<p><b>Recordset</b> objects can also be remoted. For example, in a web-based application, you can open a <b>Recordset</b> on the client, using the progID &quot;ADOR.&quot; The Remote Data Service provides a mechanism for local data caching and local cursoring of remoted <b>Recordset</b> data. A client-side <b>Recordset</b> can be used in the same way as a server-side <b>Recordset</b>, and supports almost all of the <b>Recordset</b> normal methods and properties. <b>Recordset</b> methods and properties that are not supported on a client-side <b>Recordset</b>, or that behave differently, are noted in the Help topics for those properties and methods.
<p>There are four different cursor types defined in ADO:
<ul>
<li>
<b>Dynamic cursor</b> — allows you to view additions, changes, and deletions by other users, and allows all types of movement through the <b>Recordset</b> that don't rely on bookmarks; allows bookmarks if the provider supports them.<br><br></li>
<li>
<b>Keyset cursor</b> — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete. Data changes by other users will still be visible. It always supports bookmarks and therefore allows all types of movement through the <b>Recordset</b>. <br><br></li>
<li>
<b>Static cursor</b> — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the <b>Recordset</b>. Additions, changes, or deletions by other users will not be visible. This is the only type of cursor allowed when you open a client-side (ADOR) <b>Recordset</b> object.<br><br></li>
<li>
<b>Forward-only cursor</b> — behaves identically to a dynamic cursor except that it allows you to scroll only forward through records. This improves performance in situations where you need to make only a single pass through a recordset.</li>
</ul>
<p>Set the <a href="pro02_7.htm"><b>CursorType</b></a> property prior to opening the <b>Recordset</b> to choose the cursor type, or pass a <b><i>CursorType</i></b> argument with the <b>Open</b> method. Some providers don’t support all cursor types. Check the documentation for the provider. If you don't specify a cursor type, ADO opens a forward-only cursor by default.
<p>When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create <b>Recordset</b> objects independently of a previously defined <a href="obj01_1.htm"><b>Connection</b></a> object by passing a connection string with the <a href="mth03_1.htm"><b>Open</b></a> method. ADO still creates a <b>Connection</b> object, but it doesn't assign that object to an object variable. However, if you are opening multiple <b>Recordset</b> objects over the same connection, you should explicitly create and open a <b>Connection</b> object; this assigns the <b>Connection</b> object to an object variable. If you do not use this object variable when opening your <b>Recordset</b> objects, ADO creates a new <b>Connection</b> object for each new <b>Recordset</b>, even if you pass the same connection string.
<p>You can create as many <b>Recordset</b> objects as needed.
<p>When you open a <b>Recordset</b>, the current record is positioned to the first record (if any) and the <a href="pro01_5.htm"><b>BOF</b></a> and <a href="pro01_5.htm"><b>EOF</b></a> properties are set to <b>False</b>. If there are no records, the <b>BOF</b> and <b>EOF</b> property settings are <b>True</b>.
<p>You can use the <a href="mth02_7.htm"><b>MoveFirst</b></a>, <a href="mth02_7.htm"><b>MoveLast</b></a>, <a href="mth02_7.htm"><b>MoveNext</b></a>, and <a href="mth02_7.htm"><b>MovePrevious</b></a> methods, as well as the <a href="mth02_6.htm"><b>Move</b></a> method, and the <a href="pro01_1.htm"><b>AbsolutePosition</b></a>, <a href="pro01.htm"><b>AbsolutePage</b></a>, and <a href="pro03_5.htm"><b>Filter</b></a> properties to reposition the current record, assuming the provider supports the relevant functionality. Forward-only <b>Recordset</b> objects support only the <b>MoveNext</b> method. When you use the <b>Move</b> methods to visit each record (or enumerate the <b>Recordset</b>), you can use the <b>BOF</b> and <b>EOF</b> properties to see if you've moved beyond the beginning or end of the <b>Recordset</b>.
<p><b>Recordset</b> objects may support two types of updating: immediate and batched. In immediate updating, all changes to data are written immediately to the underlying data source once you call the <a href="mth03_6.htm"><b>Update</b></a> method. You can also pass arrays of values as parameters with the <a href="mth01.htm"><b>AddNew</b></a> and <b>Update</b> methods and simultaneously update several fields in a record.
<p>If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the <a href="mth03_7.htm"><b>UpdateBatch</b></a> method. This applies to changes made with the <b>AddNew</b>, <b>Update</b>, and <a href="mth02_1.htm"><b>Delete</b></a> methods. After you call the <b>UpdateBatch</b> method, you can use the <a href="pro06_4.htm"><b>Status</b></a> property to check for any data conflicts in order to resolve them.
<p><b>Note   </b>To execute a query without using a <b>Command</b> object, pass a query string to the <b>Open</b> method of a <b>Recordset</b> object. However, a <b>Command</b> object is required when you want to persist the command text and re-execute it, or use query parameters.
<p><b>See Also</b>
<p><a href="idx02.htm">Using OLE DB Providers with ADO</a>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>