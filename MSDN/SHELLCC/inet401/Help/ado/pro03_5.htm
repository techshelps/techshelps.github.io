<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Filter Property (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Filter Property (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="adprofilter"></a>Filter Property - ADO</H1>
<p>Indicates a filter for data in a <a href="obj01_6.htm"><b>Recordset</b></a>.
<p><b>Applies To</b>
<p><a href="obj01_6.htm"><b>Recordset</b></a>
<p><b>Settings and Return Values</b>
<p>Sets or returns a <b>Variant</b> value, which can contain one of the following:
<ul>
<li>
Criteria string — a string made up of one or more individual clauses concatenated with <b>AND</b> or <b>OR</b> operators.<br><br></li>
<li>
Array of bookmarks — an array of unique bookmark values that point to records in the <b>Recordset</b> object.<br><br></li>
<li>
One of the following <b>FilterGroupEnum</b> values:
<br>
<TABLE>
<tr>
<TD>
<b>Constant</b></TD><TD>
<b>Description</b></td>
</tr>
<tr>
<TD>
<b>adFilterNone</b></TD><TD>
Removes the current filter and restores all records to view.</td>
</tr>
<tr>
<TD>
<b>adFilterPendingRecords</b></TD><TD>
Allows you to view only records that have changed but have not yet been sent to the server. Only applicable for batch update mode.</td>
</tr>
<tr>
<TD>
<b>adFilterAffectedRecords</b></TD><TD>
Allows you to view only records affected by the last <a href="mth02_1.htm"><b>Delete</b></a>, <a href="mth03_4.htm"><b>Resync</b></a>, <a href="mth03_7.htm"><b>UpdateBatch</b></a>, or <a href="mth01_4.htm"><b>CancelBatch</b></a> call.</td>
</tr>
<tr>
<TD>
<b>adFilterFetchedRecords</b></TD><TD>
Allows you to view records in the current cache, that is, the results of the last call to retrieve records from the database.</td>
</tr>
</table><br>
</li>
</ul>
<p><b>Remarks</b>
<p>Use the <b>Filter</b> property to selectively screen out records in a <b>Recordset</b> object. The filtered <b>Recordset</b> becomes the current cursor. This affects other properties such as <a href="pro01_1.htm"><b>AbsolutePosition</b></a>, <a href="pro01.htm"><b>AbsolutePage</b></a>, <a href="pro05_6.htm"><b>RecordCount</b></a>, and <a href="pro05_1.htm"><b>PageCount</b></a> that return values based on the current cursor, since setting the <b>Filter</b> property to a specific value will move the current record to the first record that satisfies the new value.
<p>The criteria string is made up of clauses in the form <i>FieldName-Operator-Value</i> (for example, &quot;<code>LastName = 'Smith'</code>&quot;). You can create compound clauses by concatenating individual clauses with <b>AND</b> (for example, &quot;<code>LastName = 'Smith' AND FirstName = 'John'</code>&quot;) or <b>OR</b> (for example, <code>&quot;LastName = 'Smith' OR LastName = 'Jones'&quot;</code>). Use the following guidelines for criteria strings:
<ul>
<li>
<i>FieldName</i> must be a valid field name from the <b>Recordset</b>. If the field name contains spaces, you must enclose the name in square brackets.<br><br></li>
<li>
<i>Operator</i> must be one of the following: &lt;, &gt;, &lt;=, &gt;=, &lt;&gt;, =, <b>LIKE</b>.<br><br></li>
<li>
<i>Value</i> is the value with which you will compare the field values (for example, <code>'Smith'</code>, <code>#8/24/95#</code>, <code>12.345</code> or <code>$50.00</code>). Use single quotes with strings and pound signs (<code>#</code>) with dates. For numbers, you can use decimal points, dollar signs, and scientific notation. If <i>Operator</i> is <b>LIKE</b>, <i>Value</i> can use wildcards. Only the asterisk (*) and percent sign (%) wild cards are allowed, and they must be the last character in the string. <i>Value</i> may not be <b>Null</b>.<br><br></li>
<li>
There is no precedence between <b>AND</b> and <b>OR</b>. Clauses can be grouped within parentheses. However, you cannot group clauses joined by an <b>OR</b> and then join the group to another clause with an <b>AND</b>, like this<pre>(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'</PRE>
<p>Instead, you would construct this filter as
<pre>(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')</PRE>
</li>
<li>
In a <b>LIKE</b> clause, you can use a wildcard at the beginning and end of the pattern (for example, <code>LastName Like '*mit*'</code>), or only at the end of the pattern (for example, <code>LastName Like 'Smit*'</code>).</li>
</ul>
<p>The filter constants make it easier to resolve individual record conflicts during batch update mode by allowing you to view, for example, only those records that were affected during the last <b>UpdateBatch</b> method call.
<p>Setting the <b>Filter</b> property itself may fail because of a conflict with the underlying data (for example, a record has already been deleted by another user); in such a case, the provider returns warnings to the <a href="obj02.htm"><b>Errors</b></a> collection but does not halt program execution. A run-time error occurs only if there are conflicts on all the requested records. Use the <a href="pro06_4.htm"><b>Status</b></a> property to locate records with conflicts.
<p>Setting the <b>Filter</b> property to a zero-length string (&quot;&quot;) has the same effect as using the <b>adFilterNone</b> constant.
<p>Whenever the <b>Filter</b> property is set, the current record position moves to the first record in the filtered subset of records in the <b>Recordset</b>. Similarly, when the <b>Filter</b> property is cleared, the current record position moves to the first record in the <b>Recordset</b>.
<p>See the <a href="pro01_6.htm"><b>Bookmark</b></a> property for an explanation of bookmark values from which you can build an array to use with the <b>Filter</b> property.
<p><b>Examples</b>
<p><a href="prox1_11.htm"><b>Filter and RecordCount Properties Example (VB)</b></a>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>