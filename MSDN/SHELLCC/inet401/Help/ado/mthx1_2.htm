<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AppendChunk and GetChunk Methods Example (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="AppendChunk and GetChunk Methods Example (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<P><a name="admthappendchunkx"></a><b>AppendChunk and GetChunk Methods Example</b>
<p>This example uses the <b>AppendChunk</b> and <b>GetChunk</b> methods to fill an image field with data from another record, 32K at a time. In a real application, one might use a procedure like this to copy a record containing a photo or graphic image field from one table to another. In this example, the record is simply being copied back to same table. Note that all the chunk manipulation takes place within a single <b>AddNew</b>-<b>Update</b> sequence.
<pre>Public Sub AppendChunkX()

&#09;Dim cnn1 As ADODB.Connection
&#09;Dim rstPubInfo As ADODB.Recordset
&#09;Dim strCnn As String
&#09;Dim strPubID As String
&#09;Dim strPRInfo As String
&#09;Dim lngOffset As Long
&#09;Dim lngLogoSize As Long
&#09;Dim varLogo As Variant
&#09;Dim varChunk As Variant
&#09;
&#09;Const conChunkSize = 100

&#09;' Open a connection.
&#09;Set cnn1 = New ADODB.Connection
&#09;strCnn = &quot;driver={SQL Server};server=srv;&quot; &amp; _
&#09;&#09;&quot;uid=sa;pwd=;database=pubs&quot;
&#09;cnn1.Open strCnn
&#09;
&#09;' Open the pub_info table.
&#09;Set rstPubInfo = New ADODB.Recordset
&#09;rstPubInfo.CursorType = adOpenKeyset
&#09;rstPubInfo.LockType = adLockOptimistic
&#09;rstPubInfo.Open &quot;pub_info&quot;, cnn1, , , adCmdTable
&#09;
&#09;' Prompt for a logo to copy.
&#09;strMsg = &quot;Available logos are : &quot; &amp; vbCr &amp; vbCr
&#09;Do While Not rstPubInfo.EOF
&#09;&#09;strMsg = strMsg &amp; rstPubInfo!pub_id &amp; vbCr &amp; _
&#09;&#09;&#09;Left(rstPubInfo!pr_info, InStr(rstPubInfo!pr_info, &quot;,&quot;) - 1) &amp; _
&#09;&#09;&#09;vbCr &amp; vbCr
&#09;&#09;rstPubInfo.MoveNext
&#09;Loop
&#09;strMsg = strMsg &amp; &quot;Enter the ID of a logo to copy:&quot;
&#09;strPubID = InputBox(strMsg)
&#09;
&#09;' Copy the logo to a variable in chunks.
&#09;rstPubInfo.Filter = &quot;pub_id = '&quot; &amp; strPubID &amp; &quot;'&quot;
&#09;lngLogoSize = rstPubInfo!logo.ActualSize
&#09;Do While lngOffset &lt; lngLogoSize
&#09;&#09;varChunk = rstPubInfo!logo.GetChunk(conChunkSize)
&#09;&#09;varLogo = varLogo &amp; varChunk
&#09;&#09;lngOffset = lngOffset + conChunkSize
&#09;Loop
&#09;
&#09;' Get data from the user.
&#09;strPubID = Trim(InputBox(&quot;Enter a new pub ID:&quot;))
&#09;strPRInfo = Trim(InputBox(&quot;Enter descriptive text:&quot;))
&#09;
&#09;' Add a new record, copying the logo in chunks.
&#09;rstPubInfo.AddNew
&#09;rstPubInfo!pub_id = strPubID
&#09;rstPubInfo!pr_info = strPRInfo

&#09;lngOffset = 0   ' Reset offset.
&#09;Do While lngOffset &lt; lngLogoSize
&#09;&#09;varChunk = LeftB(RightB(varLogo, lngLogoSize - lngOffset), _
&#09;&#09;&#09;conChunkSize)
&#09;&#09;rstPubInfo!logo.AppendChunk varChunk
&#09;&#09;lngOffset = lngOffset + conChunkSize
&#09;Loop
&#09;rstPubInfo.Update
&#09;
&#09; ' Show the newly added data.
&#09;MsgBox &quot;New record: &quot; &amp; rstPubInfo!pub_id &amp; vbCr &amp; _
&#09;&#09;&quot;Description: &quot; &amp; rstPubInfo!pr_info &amp; vbCr &amp; _
&#09;&#09;&quot;Logo size: &quot; &amp; rstPubInfo!logo.ActualSize

&#09;' Delete new record because this is a demonstration.
&#09;rstPubInfo.Requery
&#09;cnn1.Execute &quot;DELETE FROM pub_info &quot; &amp; _
&#09;&#09;&quot;WHERE pub_id = '&quot; &amp; strPubID &amp; &quot;'&quot;

&#09;rstPubInfo.Close
&#09;cnn1.Close&#09;

End Sub</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>