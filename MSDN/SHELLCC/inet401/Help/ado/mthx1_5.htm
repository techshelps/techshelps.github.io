<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Delete Method Example (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Delete Method Example (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<P><a name="admthdeletex"></a><b>Delete Method Example</b>
<p>This example uses the <b>Delete</b> method to remove a specified record from a <b>Recordset</b>. The DeleteRecord procedure is required for this procedure to run.
<pre>Public Sub DeleteX()

&#09;Dim rstRoySched As ADODB.Recordset
&#09;Dim strCnn As String
&#09;Dim strMsg As String
&#09;Dim strTitleID As String
&#09;Dim intLoRange As Integer
&#09;Dim intHiRange As Integer
&#09;Dim intRoyalty As Integer

&#09;' Open RoySched table.
&#09;strCnn = &quot;driver={SQL Server};server=srv;&quot; &amp; _
&#09;&#09;&quot;uid=sa;pwd=;database=pubs&quot;
&#09;Set rstRoySched = New ADODB.Recordset
&#09;Set rstRoySched.CursorLocation = adUseClient
&#09;rstRoySched.CursorType = adOpenKeyset
&#09;rstRoySched.LockType = adLockBatchOptimistic
&#09;rstRoySched.Open &quot;SELECT * FROM roysched &quot; &amp; _
&#09;&#09;&quot;WHERE royalty = 20&quot;, strCnn, , , adCmdText

&#09;' Prompt for a record to delete.
&#09;strMsg = &quot;Before delete there are &quot; &amp; _
&#09;&#09;rstRoySched.RecordCount &amp; _
&#09;&#09;&quot; titles with 20 percent royalty:&quot; &amp; vbCr &amp; vbCr
&#09;Do While Not rstRoySched.EOF
&#09;&#09;strMsg = strMsg &amp; rstRoySched!title_id &amp; vbCr
&#09;&#09;rstRoySched.MoveNext
&#09;Loop
&#09;strMsg = strMsg &amp; vbCr &amp; vbCr &amp; _
&#09;&#09;&quot;Enter the ID of a record to delete:&quot;
&#09;strTitleID = UCase(InputBox(strMsg))

&#09;' Move to the record and save data so it can be restored.
&#09;rstRoySched.Filter = &quot;title_id = '&quot; &amp; strTitleID &amp; &quot;'&quot;
&#09;intLoRange = rstRoySched!lorange
&#09;intHiRange = rstRoySched!hirange
&#09;intRoyalty = rstRoySched!royalty

&#09;' Delete the record.
&#09;rstRoySched.Delete
&#09;rstRoySched.UpdateBatch

&#09;' Show the results.
&#09;rstRoySched.Filter = adFilterNone
&#09;rstRoySched.Requery
&#09;strMsg = &quot;&quot;
&#09;strMsg = &quot;After delete there are &quot; &amp; _
&#09;&#09;rstRoySched.RecordCount &amp; _
&#09;&#09;&quot; titles with 20 percent royalty:&quot; &amp; vbCr &amp; vbCr
&#09;Do While Not rstRoySched.EOF
&#09;&#09;strMsg = strMsg &amp; rstRoySched!title_id &amp; vbCr
&#09;&#09;rstRoySched.MoveNext
&#09;Loop
&#09;MsgBox strMsg

&#09;' Restore the data because this is a demonstration.
&#09;rstRoySched.AddNew
&#09;rstRoySched!title_id = strTitleID
&#09;rstRoySched!lorange = intLoRange
&#09;rstRoySched!hirange = intHiRange
&#09;rstRoySched!royalty = intRoyalty
&#09;rstRoySched.UpdateBatch

&#09;rstRoySched.Close

End Sub
</PRE>
<p><b>VBScript Version</b>
<p>The following is the same example written in VBScript to be used in an Active Server Page (ASP). To view this example, you need to create a system Data Source Name (DSN) called AdvWorks for the Microsoft Access database file AdvWorks.mdb, which is installed with Microsoft Internet Information Server and located at C:\InetPub\ASPSamp\AdvWorks. Locate the file adovbs.inc and place it in the directory you plan to use. Cut and paste the following code to Notepad or another text editor and save it as Delete.asp. You can view the result in any client browser.
<p>To exercise the example, try using the <b>AddNew</b> example first, to  add some records. Then try to delete them.
<pre>&lt;!-- #Include file=&quot;ADOVBS.INC&quot; --&gt;
&lt;% Language = VBScript %&gt;

&lt;HTML&gt;

&lt;HEAD&gt;&lt;TITLE&gt;ADO 1.5 Delete Method&lt;/TITLE&gt;
&lt;/HEAD&gt;&lt;BODY&gt; 
&lt;FONT FACE=&quot;MS SANS SERIF&quot; SIZE=2&gt;
&lt;Center&gt;&lt;H3&gt;ADO Delete Method&lt;/H3&gt;

&lt;!--- ADO Connection Object used to create recordset--&gt;
&lt;% 
'Create and Open Connection Object
Set OBJdbConnection = Server.CreateObject(&quot;ADODB.Connection&quot;) 
OBJdbConnection.Open &quot;AdvWorks&quot; 
'Create and Open Recordset Object
Set RsCustomerList = Server.CreateObject(&quot;ADODB.Recordset&quot;)
RsCustomerList.ActiveConnection = OBJdbConnection
RsCustomerList.CursorType = adOpenKeyset
RsCustomerList.LockType = adLockOptimistic
RsCustomerList.Source = &quot;Customers&quot;
RsCustomerList.Open
%&gt;
&lt;!-- Move to designated Record and Delete It --&gt;
&lt;% 

If Not IsEmpty(Request.Form(&quot;WhichRecord&quot;)) Then
&#09;'Get value to move from Form Post method
&#09;Moves = Request.Form(&quot;WhichRecord&quot;)

&#09;RsCustomerList.Move CInt(Moves)
&#09;If Not RsCustomerList.EOF or RsCustomerList.BOF Then
&#09;&#09;RsCustomerList.Delete 1
&#09;&#09;RsCustomerList.MoveFirst
&#09;&#09;
&#09;Else
&#09;&#09;Response.Write &quot;Not a Valid Record Number&quot;
&#09;&#09;RsCustomerList.MoveFirst
&#09;End If
End If

%&gt;
&lt;!-- BEGIN column header row for Customer Table--&gt;

&lt;TABLE COLSPAN=8 CELLPADDING=5 BORDER=0&gt;&lt;TR&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Company Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Contact Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER WIDTH=150 BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Phone Number&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;City&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;State/Province&lt;/FONT&gt;
&lt;/TD&gt;&lt;/TR&gt;

&lt;!--Display ADO Data from Customer Table Loop through Recordset adding
One Row to HTML Table each pass--&gt;
&lt;% Do While Not RsCustomerList.EOF %&gt;
  &lt;TR&gt;&lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt; 
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RSCustomerList(&quot;CompanyName&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;ContactLastName&quot;) &amp; &quot;, &quot; %&gt; 
      &lt;%= RScustomerList(&quot;ContactFirstName&quot;) %&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt;
      &lt;%= RScustomerList(&quot;PhoneNumber&quot;)%&gt; 
   &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;City&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;StateOrProvince&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;/TR&gt;
&lt;!-Next Row = Record Loop and add to html table--&gt;
&lt;% 
RScustomerList.MoveNext 
Loop 
%&gt;
&lt;/Table&gt;&lt;/Center&gt;&lt;/FONT&gt;
&lt;!-- Do Client side Input Data Validation Move to named record and Delete it --&gt;

&lt;Center&gt;
&lt;H4&gt;Clicking Button Will Remove Designated Record&lt;/H4&gt;
&lt;H5&gt;There are &lt;%=RsCustomerList.RecordCount - 1%&gt; Records in this Set&lt;/H5&gt;
&lt;Form Method = Post Action = &quot;Delete.asp&quot; Name = Form&gt;
&lt;Input Type = Text Name = &quot;WhichRecord&quot; Size = 3&gt;&lt;/Form&gt;
&lt;Input Type = Button Name = cmdDelete Value = &quot;Delete Record&quot;&gt;&lt;/Center&gt;

&lt;/BODY&gt;

&lt;Script Language = &quot;VBScript&quot;&gt;

Sub cmdDelete_OnClick
If IsNumeric(Document.Form.WhichRecord.Value) Then
&#09;Document.Form.WhichRecord.Value = CInt(Document.Form.WhichRecord.Value)
Dim Response
&#09;Response = MsgBox(&quot;Are You Sure About Deleting This Record?&quot;, vbYesNo,  &quot;ADO-ASP 

Example&quot;)

&#09;If Response = vbYes Then
&#09;&#09;
&#09;Document.Form.Submit
&#09;
&#09;End If
Else
&#09;MsgBox &quot;You Must Enter a Valid Record Number&quot;,,&quot;ADO-ASP Example&quot;
End If
End Sub


&lt;/Script&gt;
&lt;/HTML&gt;</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>