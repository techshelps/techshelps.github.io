<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NextRecordset Method (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="NextRecordset Method (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="admthnextrecordset"></a>NextRecordset Method - ADO</H1>
<p>Clears the current <a href="obj01_6.htm"><b>Recordset</b></a> object and returns the next recordset by advancing through a series of commands.
<p><b>Applies To</b>
<p><a href="obj01_6.htm"><b>Recordset</b></a>
<p><b>Syntax</b>
<p><b>Set</b> <i>recordset2</i> = <i>recordset1</i><b>.NextRecordset(</b> <b><i>RecordsAffected</i> )</b>
<p><b>Return Values</b>
<p>Returns a <b>Recordset</b> object. In the syntax model, <i>recordset1</i> and <i>recordset2</i> can be the same <b>Recordset</b> object, or you can use separate objects.
<p><b>Parameters</b>
<p><i><b>RecordsAffected</b>   </i>Optional. A <b>Long</b> variable to which the provider returns the number of records that the current operation affected.
<p><b>Remarks</b>
<p>Use the <b>NextRecordset</b> method to return the results of the next command in a compound command statement or of a stored procedure that returns multiple results. If you open a <b>Recordset</b> object based on a compound command statement (for example, &quot;SELECT * FROM table1;SELECT * FROM table2&quot;) using the <a href="mth02_2.htm"><b>Execute</b></a> method on a <b>Command</b> or the <a href="mth03_1.htm"><b>Open</b></a> method on a <b>Recordset</b>, ADO executes only the first command and returns the results to <i>recordset</i>. To access the results of subsequent commands in the statement, call the <b>NextRecordset</b> method.
<p>As long as there are additional results, the <b>NextRecordset</b> method will continue to return <b>Recordset</b> objects. If a row-returning command returns no records, the returned <b>Recordset</b> object will be empty; test for this case by verifying that the <a href="pro01_5.htm"><b>BOF</b></a> and <a href="pro01_5.htm"><b>EOF</b></a> properties are both <b>True</b>. If a non row-returning command executes successfully, the returned <b>Recordset</b> object will be closed, which you can verify by testing the <a href="pro07_2.htm"><b>State</b></a> property on the <b>Recordset</b>.  When there are no more results, <i>recordset</i> will be set to <b>Nothing</b>.
<p>If an edit is in progress while in immediate update mode, calling the <b>NextRecordset</b> method generates an error; call the <a href="mth03_6.htm"><b>Update</b></a> or <a href="mth01_5.htm"><b>CancelUpdate</b></a> method first.
<p>If you need to pass parameters for more than one command in the compound statement by filling the <a href="obj02_2.htm"><b>Parameters</b></a> collection or by passing an array with the original <b>Open</b> or <b>Execute</b> call, the parameters must be in the same order in the collection or array as their respective commands in the command series. You must finish reading all the results before reading output parameter values.
<p>When you call the <b>NextRecordset</b> method, ADO executes only the next command in the statement. If you explicitly close the <b>Recordset</b> object before stepping through the entire command statement, ADO never executes the remaining commands.
<p><b>Remote Data Service Usage</b>   The <b>NextRecordset</b> method is not available on a client-side (ADOR) <b>Recordset</b> object.
<p><b>Examples</b>
<p><a href="mthx1_10.htm"><b>NextRecordset Method Example (VB)</b></a>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>