<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BeginTrans, CommitTrans, and RollbackTrans Methods (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="BeginTrans, CommitTrans, and RollbackTrans Methods (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="admthbegintrans"></a>BeginTrans, CommitTrans, and RollbackTrans Methods - ADO</H1>
<p>The transaction methods manage transaction processing within a <a href="obj01_1.htm"><b>Connection</b></a> object as follows:
<ul>
<li>
<b>BeginTrans</b> begins a new transaction.<br><br></li>
<li>
<b>CommitTrans</b> saves any changes and ends the current transaction. It may also start a new transaction.<br><br></li>
<li>
<b>RollbackTrans</b> cancels any changes made during the current transaction and ends the transaction. It may also start a new transaction.</li>
</ul>
<p><b>Applies To</b>
<p><a href="obj01_1.htm"><b>Connection</b></a>
<p><b>Syntax</b>
<p><i>level</i> <b>=</b> <i>connection</i><b>.BeginTrans()</b>
<p><i>connection</i><b>.BeginTrans</b>
<p><i>connection</i><b>.CommitTrans</b>
<p><i>connection</i><b>.RollbackTrans</b>
<p><b>Return Value</b>
<p><b>BeginTrans</b> can be called as a function that returns a <b>Long</b> variable indicating the nesting level of the transaction.
<p><b>Remarks</b>
<p>Use these methods with a <b>Connection</b> object when you want to save or cancel a series of changes made to the source data as a single unit. For example, to transfer money between accounts, you subtract an amount from one and add the same amount to the other. If either update fails, the accounts no longer balance. Making these changes within an open transaction ensures either all or none of the changes goes through.
<p><b>Note</b>   Not all providers support transactions. Check that the provider-defined property &quot;Transaction DDL&quot; appears in the <b>Connection</b> object's <b>Properties</b> collection, indicating that the provider supports transactions. If the provider does not support transactions, calling one of these methods will return an error.
<p>Once you call the <b>BeginTrans</b> method, the provider will no longer instantaneously commit any changes you make until you call <b>CommitTrans</b> or <b>RollbackTrans</b> to end the transaction.
<p>For providers that support nested transactions, calling the <b>BeginTrans</b> method within an open transaction starts a new, nested transaction. The return value indicates the level of nesting: a return value of &quot;1&quot; indicates you have opened a top-level transaction (that is, the transaction is not nested within another transaction), &quot;2&quot; indicates that you have opened a second-level transaction (a transaction nested within a top-level transaction), and so forth. Calling <b>CommitTrans</b> or <b>RollbackTrans</b> affects only the most recently opened transaction; you must close or rollback the current transaction before you can resolve any higher level transactions.
<p>Calling the <b>CommitTrans</b> method saves changes made within an open transaction on the connection and ends the transaction. Calling the <b>RollbackTrans</b> method reverses any changes made within an open transaction and ends the transaction. Calling either method when there is no open transaction generates an error.
<p>Depending on the <b>Connection</b> object's <a href="pro01_4.htm"><b>Attributes</b></a> property, calling either the <b>CommitTrans</b> or <b>RollbackTrans</b> methods may automatically start a new transaction. If the <b>Attributes</b> property is set to <b>adXactCommitRetaining</b>, the provider automatically starts a new transaction after a <b>CommitTrans</b> call. If the <b>Attributes</b> property is set to <b>adXactAbortRetaining</b>, the provider automatically starts a new transaction after a <b>RollbackTrans</b> call.
<p><b>Remote Data Service Usage</b>   The <b>BeginTrans</b>, <b>CommitTrans</b>, and <b>RollbackTrans</b> methods are not available on a client-side <b>Connection</b> object.
<p><b>Examples</b>
<p><a href="mthx1_3.htm"><b>BeginTrans, CommitTrans, and RollbackTrans Methods Example (VB)</b></a>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>