<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddNew Method Example (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="AddNew Method Example (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<P><a name="admthaddnewx"></a><b>AddNew Method Example</b>
<p>This example uses the <b>AddNew</b> method to create a new record with the specified name.
<pre>Public Sub AddNewX()

&#09;Dim cnn1 As ADODB.Connection
&#09;Dim rstEmployees As ADODB.Recordset
&#09;Dim strCnn As String
&#09;Dim strID As String
&#09;Dim strFirstName As String
&#09;Dim strLastName As String
&#09;Dim booRecordAdded As Boolean

&#09;' Open a connection.
&#09;Set cnn1 = New ADODB.Connection
&#09;strCnn = &quot;driver={SQL Server};server=srv;&quot; &amp; _
&#09;&#09;&quot;uid=sa;pwd=;database=pubs&quot;
&#09;cnn1.Open strCnn
&#09;&#09;
&#09;' Open Employee table.
&#09;Set rstEmployees = New ADODB.Recordset
&#09;rstEmployees.CursorType = adOpenKeyset
&#09;rstEmployees.LockType = adLockOptimistic
&#09;rstEmployees.Open &quot;employee&quot;, cnn1, , , adCmdTable

&#09;' Get data from the user.
&#09;strID = Trim(InputBox(&quot;Enter employee ID:&quot;))
&#09;strFirstName = Trim(InputBox(&quot;Enter first name:&quot;))
&#09;strLastName = Trim(InputBox(&quot;Enter last name:&quot;))

&#09;' Proceed only if the user actually entered something
&#09;' for both the first and last names.
&#09;If (strID &lt;&gt; &quot;&quot;) And (strFirstName &lt;&gt; &quot;&quot;) _
&#09;&#09;And (strLastName &lt;&gt; &quot;&quot;) Then

&#09;&#09;rstEmployees.AddNew
&#09;&#09;rstEmployees!emp_id = strID
&#09;&#09;rstEmployees!fname = strFirstName
&#09;&#09;rstEmployees!lname = strLastName
&#09;&#09;rstEmployees.Update
&#09;&#09;booRecordAdded = True

&#09;&#09;' Show the newly added data.
&#09;&#09;MsgBox &quot;New record: &quot; &amp; rstEmployees!emp_id &amp; &quot; &quot; &amp; _
&#09;&#09;&#09;rstEmployees!fname &amp; &quot; &quot; &amp; rstEmployees!lname

&#09;Else
&#09;&#09;MsgBox &quot;Please enter an employee ID, &quot; &amp; _
&#09;&#09;&#09;&quot;first name, and last name.&quot;
&#09;End If
&#09;&#09;
&#09;' Delete the new record because this is a demonstration.
&#09;cnn1.Execute &quot;DELETE FROM employee WHERE emp_id = '&quot; &amp; strID &amp; &quot;'&quot;
&#09;&#09;
&#09;rstEmployees.Close
&#09;cnn1.Close

End Sub
</PRE>
<p><b>VBScript Version</b>
<p>The following is the same example written in VBScript to be used in an Active Server Page (ASP). To view this example, you need to create a system Data Source Name (DSN) called AdvWorks for the Microsoft Access database file AdvWorks.mdb, which is installed with Microsoft Internet Information Server and located at C:\InetPub\ASPSamp\AdvWorks. Locate the file adovbs.inc and place it in the directory you plan to use. Cut and paste the following code to Notepad or another text editor and save it as AddNew.asp. You can view the result in any client browser.
<p>To exercise the example, add a new fictional record in the HTML Form.   Click the Add New Button. See the <b>Delete</b> method example to remove unwanted records.
<pre>&lt;!-- #Include file=&quot;ADOVBS.INC&quot; --&gt;
&lt;% Language = VBScript %&gt;
&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;ADO 1.5 Open Method&lt;/TITLE&gt;
&lt;/HEAD&gt;&lt;BODY&gt; 
&lt;FONT FACE=&quot;MS SANS SERIF&quot; SIZE=2&gt;
&lt;Center&gt;&lt;H3&gt;ADO AddNew Method&lt;/H3&gt;
&lt;!-- ADO Connection Object used to create recordset--&gt;
&lt;% 
'Create and Open Connection Object
Set OBJdbConnection = Server.CreateObject(&quot;ADODB.Connection&quot;) 
OBJdbConnection.Open &quot;AdvWorks&quot; 
'Create and Open Recordset Object
Set RsCustomerList = Server.CreateObject(&quot;ADODB.Recordset&quot;)
RsCustomerList.ActiveConnection = OBJdbConnection
RsCustomerList.CursorType = adOpenKeyset
RsCustomerList.LockType = adLockOptimistic
RsCustomerList.Source = &quot;Customers&quot;
RsCustomerList.Open

%&gt;
&lt;!-- If this is the first time the page is opened, the Form collection will be empty when data is entered 

run AddNew method--&gt;
&lt;% If Not IsEmpty(Request.Form) Then
&#09;If Not Request.Form(&quot;CompanyName&quot;) = &quot;&quot; Then
&#09;&#09;RsCustomerList.AddNew
&#09;&#09;RsCustomerList(&quot;CompanyName&quot;) = Request.Form(&quot;CompanyName&quot;)
&#09;&#09;RsCustomerList(&quot;ContactLastName&quot;) = Request.Form(&quot;LastName&quot;)
&#09;&#09;RsCustomerList(&quot;ContactFirstName&quot;) = Request.Form(&quot;FirstName&quot;)
&#09;&#09;RsCustomerList(&quot;PhoneNumber&quot;) = Request.Form(&quot;PhoneNumber&quot;)
&#09;&#09;RsCustomerList(&quot;City&quot;) = Request.Form(&quot;City&quot;)
&#09;&#09;RsCustomerList(&quot;StateOrProvince&quot;) = Request.Form(&quot;State&quot;)
&#09;&#09;RsCustomerList.Update
&#09;&#09;RsCustomerList.MoveFirst
&#09;&#09;
&#09;End If
End If
%&gt;

&lt;TABLE COLSPAN=8 CELLPADDING=5 BORDER=0&gt;

&lt;!-- BEGIN column header row for Customer Table--&gt;

&lt;TR&gt;&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Company Name&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Contact Name&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER WIDTH=150 BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Phone Number&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;City&lt;/FONT&gt;&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;State/Province&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;!--Display ADO Data from Customer Table One row on each pass through recordset--&gt;
&lt;% Do While Not RsCustomerList.EOF %&gt;
  &lt;TR&gt;&lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt; 
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RSCustomerList(&quot;CompanyName&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;ContactLastName&quot;) &amp; &quot;, &quot; %&gt; 
      &lt;%= RScustomerList(&quot;ContactFirstName&quot;) %&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt;
     &lt;%= RScustomerList(&quot;PhoneNumber&quot;)%&gt; 
   &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;City&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;StateOrProvince&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt; 
&lt;!-- Next Row = Record Loop and add to row html table--&gt;
&lt;% 
RScustomerList.MoveNext 
Loop 
%&gt;

&lt;/TABLE&gt;&lt;HR&gt;
&lt;!-- Form to enter new record posts variables back to this page --&gt;
&lt;Table&gt;
&lt;Form Method = Post Action=&quot;AddNew.asp&quot; Name=Form&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Company Name:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type=&quot;Text&quot; Size=&quot;50&quot; Name=&quot;CompanyName&quot; Value = &quot;&quot;&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Contact First Name:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type=&quot;Text&quot; Size=&quot;50&quot; Name=&quot;FirstName&quot; Value = &quot;&quot;&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Contact Last Name:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type=&quot;Text&quot; Size=&quot;50&quot; Name=&quot;LastName&quot; Value = &quot;&quot;&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;Contact Phone:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type=&quot;Text&quot; Size=&quot;50&quot; Name=&quot;PhoneNumber&quot; Value = &quot;&quot;&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;City:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type=&quot;Text&quot; Size=&quot;50&quot; Name=&quot;City&quot; Value = &quot;&quot;&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;P&gt;State / Province:&lt;/TD&gt;
&lt;TD&gt;&lt;Input Type=&quot;Text&quot; Size=&quot;5&quot; Name=&quot;State&quot; Value = &quot;&quot;&gt;&lt;/P&gt;&lt;/TD&gt;
&lt;TR&gt;&lt;TD&gt;&lt;Input Type=&quot;Submit&quot; Value=&quot;Add New &quot;&gt;&lt;Input Type=&quot;Reset&quot; Value=&quot;Reset Form&quot;&gt;
&lt;/Form&gt;&lt;/Table&gt;&lt;/Center&gt;&lt;/FONT&gt;
&lt;%'Show location of DSN data source
Response.Write(OBJdbConnection)
%&gt;
&lt;Script Language = &quot;VBScript&quot;&gt;
Sub Form_OnSubmit
&#09;MsgBox &quot;Sending New Record to Server&quot;,,&quot;ADO-ASP _Example&quot;
End Sub
&lt;/Script&gt;
&lt;/BODY&gt;&lt;/HTML&gt;</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>