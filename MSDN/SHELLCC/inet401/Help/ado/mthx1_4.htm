<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Clone Method Example (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Clone Method Example (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<P><a name="admthclonex"></a><b>Clone Method Example</b>
<p>This example uses the <b>Clone</b> method to create copies of a <b>Recordset</b> and then lets the user position the record pointer of each copy independently.
<pre>Public Sub CloneX()

&#09;Dim arstStores(1 To 3) As ADODB.Recordset
&#09;Dim intLoop As Integer
&#09;Dim strSQL As String
&#09;Dim strCnn As String
&#09;Dim strMessage As String
&#09;Dim strFind As String

&#09;' Assign SQL statement and connection string to variables.
&#09;strSQL = &quot;SELECT stor_name FROM Stores &quot; &amp; _
&#09;&#09;&quot;ORDER BY stor_name&quot;
&#09;strCnn = &quot;driver={SQL Server};server=srv;&quot; &amp; _
&#09;&#09;&quot;uid=sa;pwd=;database=pubs&quot;

&#09;' Open recordset as a static cursor type recordset.
&#09;Set arstStores(1) = New ADODB.Recordset
&#09;arstStores(1).CursorType = adOpenStatic
&#09;arstStores(1).LockType = adLockBatchOptimistic
&#09;arstStores(1).Open strSQL, strCnn, , , adCmdText

&#09;' Create two clones of the original Recordset.
&#09;Set arstStores(2) = arstStores(1).Clone
&#09;Set arstStores(3) = arstStores(1).Clone

&#09;Do While True

&#09;&#09;' Loop through the array so that on each pass, 
&#09;&#09;' the user is searching a different copy of the 
&#09;&#09;' same Recordset.
&#09;&#09;For intLoop = 1 To 3

&#09;&#09;&#09;' Ask for search string while showing where 
&#09;&#09;&#09;' the current record pointer is for each Recordset.
&#09;&#09;&#09;strMessage = _
&#09;&#09;&#09;&#09;&quot;Recordsets from stores table:&quot; &amp; vbCr &amp; _
&#09;&#09;&#09;&#09;&quot;  1 - Original - Record pointer at &quot; &amp; _
&#09;&#09;&#09;&#09;arstStores(1)!stor_name &amp; vbCr &amp; _
&#09;&#09;&#09;&#09;&quot;  2 - Clone - Record pointer at &quot; &amp; _
&#09;&#09;&#09;&#09;arstStores(2)!stor_name &amp; vbCr &amp; _
&#09;&#09;&#09;&#09;&quot;  3 - Clone - Record pointer at &quot; &amp; _
&#09;&#09;&#09;&#09;arstStores(3)!stor_name &amp; vbCr &amp; _
&#09;&#09;&#09;&#09;&quot;Enter search string for #&quot; &amp; intLoop &amp; &quot;:&quot;
&#09;&#09;&#09;strFind = Trim(InputBox(strMessage))
&#09;&#09;&#09;If strFind = &quot;&quot; Then Exit Do

&#09;&#09;&#09;' Find the search string; if there's no 
&#09;&#09;&#09;' match, jump to the last record.
&#09;&#09;&#09;arstStores(intLoop).Filter = &quot;stor_name &gt;= '&quot; &amp; strFind &amp; &quot;'&quot;
&#09;&#09;&#09;If arstStores(intLoop).EOF Then
&#09;&#09;&#09;&#09;arstStores(intLoop).Filter = adFilterNone
&#09;&#09;&#09;&#09;arstStores(intLoop).MoveLast
&#09;&#09;&#09;End If

&#09;&#09;Next intLoop

&#09;Loop

&#09;arstStores(1).Close
&#09;arstStores(2).Close
&#09;arstStores(3).Close

End Sub</PRE>
<p><b>VBScript Version</b>
<p>The following is the same example written in VBScript to be used in an Active Server Page (ASP). To view this example, you need to create a system Data Source Name (DSN) called AdvWorks for the Microsoft Access database file AdvWorks.mdb, which is installed with Microsoft Internet Information Server and located at C:\InetPub\ASPSamp\AdvWorks. Locate the file adovbs.inc and place it in the directory you plan to use. Cut and paste the following code to Notepad or another text editor and save it as Clone.asp. You can view the result in any client browser.
<p>To exercise the example, change the line RsCustomerList.Source = &quot;Customers&quot; to RsCustomerList.Source = &quot;Products&quot; to count a larger table.
<pre>&lt;!-- #Include file=&quot;ADOVBS.INC&quot; --&gt;
&lt;% Language = VBScript %&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;TITLE&gt;ADO 1.5 Clone Method&lt;/TITLE&gt;
&lt;/HEAD&gt;&lt;BODY&gt; &lt;Center&gt;
&lt;H3&gt;ADO Clone Method&lt;/H3&gt;
&lt;!--- ADO Connection Object used to create recordset--&gt;
&lt;% 
'Create and open Connection object
Set OBJdbConnection = Server.CreateObject(&quot;ADODB.Connection&quot;) 
OBJdbConnection.Open &quot;AdvWorks&quot; 
'Create and open Recordset object
Set RsCustomerList = Server.CreateObject(&quot;ADODB.Recordset&quot;)
RsCustomerList.ActiveConnection = OBJdbConnection
RsCustomerList.CursorType = adOpenKeyset
RsCustomerList.LockType = adLockOptimistic
RsCustomerList.Source = &quot;Customers&quot;
RsCustomerList.Open
%&gt;
&lt;HR&gt;
&lt;!-- Loop through Customers Table adding 1 to the Counter variable each pass --&gt;
&lt;% 
&#09;Set MyRecordset = RSCustomerList.Clone
&#09;Counter = 0
&#09;Do Until MyRecordset.EOF
&#09;&#09;Counter = Counter + 1
&#09;&#09;MyRecordset.MoveNext
&#09;Loop
%&gt;
&lt;!-- Display Results --&gt;
&lt;H3&gt;There Are &lt;%=Counter %&gt; Records in the Customers Table&lt;/H3&gt;
&lt;BR&gt;&lt;HR&gt;
&lt;H4&gt;Location of DSN Datbase&lt;/H4&gt;
&lt;%' Show location of DSN data source
Response.Write(OBJdbConnection)
%&gt;
&lt;HR&gt;&lt;/Center&gt;&lt;/BODY&gt;&lt;/HTML&gt;</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>