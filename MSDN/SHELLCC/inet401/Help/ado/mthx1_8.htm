<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Move Method Example (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="Move Method Example (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<P><a name="admthmovex"></a><b>Move Method Example</b>
<p>This example uses the <b>Move</b> method to position the record pointer based on user input.
<pre>Public Sub MoveX()

&#09;Dim rstAuthors As ADODB.Recordset
&#09;Dim strCnn As String
&#09;Dim varBookmark As Variant
&#09;Dim strCommand As String
&#09;Dim lngMove As Long

&#09;' Open recordset from Authors table.
&#09;strCnn = &quot;driver={SQL Server};server=srv;&quot; &amp; _
&#09;&#09;&quot;uid=sa;pwd=;database=pubs&quot;
&#09;Set rstAuthors = New ADODB.Recordset
&#09;rstAuthors.CursorType = adOpenStatic
&#09;' Use client cursor to allow use of 
&#09;' AbsolutePosition property.
&#09;rstAuthors.CursorLocation = adUseClient
&#09;rstAuthors.Open &quot;SELECT au_id, au_fname, au_lname, city, state &quot; &amp; _
&#09;&#09;&quot;FROM Authors ORDER BY au_lname&quot;, strCnn, , , adCmdText
&#09;&#09;

&#09;rstAuthors.MoveFirst

&#09;Do While True
&#09;&#09;' Display information about current record and
&#09;&#09;' ask how many records to move.

&#09;&#09;strCommand = InputBox( _
&#09;&#09;&#09;&quot;Record &quot; &amp; rstAuthors.AbsolutePosition &amp; _
&#09;&#09;&#09;&quot; of &quot; &amp; rstAuthors.RecordCount &amp; vbCr &amp; _
&#09;&#09;&#09;&quot;Author: &quot; &amp; rstAuthors!au_fname &amp; _
&#09;&#09;&#09;&quot; &quot; &amp; rstAuthors!au_lname &amp; vbCr &amp; _
&#09;&#09;&#09;&quot;Location: &quot; &amp; rstAuthors!City &amp; _
&#09;&#09;&#09;&quot;, &quot; &amp; rstAuthors!State &amp; vbCr &amp; vbCr &amp; _
&#09;&#09;&#09;&quot;Enter number of records to Move &quot; &amp; _
&#09;&#09;&#09;&quot;(positive or negative).&quot;)

&#09;&#09;If strCommand = &quot;&quot; Then Exit Do

&#09;&#09;' Store bookmark in case the Move goes too far
&#09;&#09;' forward or backward.
&#09;&#09;varBookmark = rstAuthors.Bookmark

&#09;&#09;' Move method requires parameter of data type Long.
&#09;&#09;lngMove = CLng(strCommand)
&#09;&#09;rstAuthors.Move lngMove

&#09;&#09;' Trap for BOF or EOF.
&#09;&#09;If rstAuthors.BOF Then
&#09;&#09;&#09;MsgBox &quot;Too far backward! &quot; &amp; _
&#09;&#09;&#09;&#09;&quot;Returning to current record.&quot;
&#09;&#09;&#09;rstAuthors.Bookmark = varBookmark
&#09;&#09;End If
&#09;&#09;If rstAuthors.EOF Then
&#09;&#09;&#09;MsgBox &quot;Too far forward! &quot; &amp; _
&#09;&#09;&#09;&#09;&quot;Returning to current record.&quot;
&#09;&#09;&#09;rstAuthors.Bookmark = varBookmark
&#09;&#09;End If
&#09;Loop
&#09;rstAuthors.Close

End Sub</PRE>
<p><b>VBScript Version</b>
<p>The following is the same example written in VBScript to be used in an Active Server Page (ASP). To view this example, you need to create a system Data Source Name (DSN) called AdvWorks for the Microsoft Access database file AdvWorks.mdb, which is installed with Microsoft Internet Information Server and located at C:\InetPub\ASPSamp\AdvWorks. Locate the file adovbs.inc and place it in the directory you plan to use. Cut and paste the following code to Notepad or another text editor and save it as Move.asp. You can view the result in any client browser.
<p>Try entering a letter or non integer to see the error handling work.
<pre>&lt;!-- #Include file=&quot;ADOVBS.INC&quot; --&gt;
&lt;% Language = VBScript %&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;TITLE&gt;ADO 1.5 Move Methods&lt;/TITLE&gt;&lt;/HEAD&gt;
&lt;BODY&gt; 
&lt;FONT FACE=&quot;MS SANS SERIF&quot; SIZE=2&gt;
&lt;Center&gt;
&lt;H3&gt;ADO Move Methods&lt;/H3&gt;

&lt;%
 'Create and Open Connection Object
Set OBJdbConnection = Server.CreateObject(&quot;ADODB.Connection&quot;) 
OBJdbConnection.Open &quot;AdvWorks&quot; 
'Create and Open Recordset Object
Set RsCustomerList = Server.CreateObject(&quot;ADODB.Recordset&quot;)
RsCustomerList.ActiveConnection = OBJdbConnection
RsCustomerList.CursorType = adOpenKeyset
RsCustomerList.LockType = adLockOptimistic
RsCustomerList.Source = &quot;Customers&quot;

RsCustomerList.Open

'Check number of user moves this session
'Increment by amount in Form
Session(&quot;Clicks&quot;) = Session(&quot;Clicks&quot;) + Request.Form(&quot;MoveAmount&quot;)
Clicks = Session(&quot;Clicks&quot;)
'Move to last known recordset position plus amount passed
'by Form Post method
RsCustomerList.Move CInt(Clicks)

'Error Handling
&#09;If RsCustomerList.EOF Then
&#09;&#09;&#09;Session(&quot;Clicks&quot;) = RsCustomerList.RecordCount
&#09;&#09;&#09;Response.Write &quot;This is the Last Record&quot;
&#09;&#09;&#09;RsCustomerList.MoveLast
&#09;&#09;Else If RsCustomerList.BOF Then
&#09;&#09;&#09;Session(&quot;Clicks&quot;) = 1
&#09;&#09;&#09;RsCustomerList.MoveFirst
&#09;&#09;&#09;Response.Write &quot;This is the First Record&quot;
&#09;&#09;End If
&#09;End If

%&gt;

&lt;H3&gt;Current Record Number is &lt;BR&gt;
&lt;% If Session(&quot;Clicks&quot;) = 0 Then 
Session(&quot;Clicks&quot;) = 1
End If
Response.Write(Session(&quot;Clicks&quot;) )%&gt; of &lt;%=RsCustomerList.RecordCount%&gt;&lt;/H3&gt;
&lt;HR&gt;


&lt;Center&gt;&lt;TABLE COLSPAN=8 CELLPADDING=5 BORDER=0&gt;

&lt;!-- BEGIN column header row for Customer Table--&gt;

&lt;TR&gt;

&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Company Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Contact Name&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER WIDTH=150 BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;Phone Number&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;City&lt;/FONT&gt;
&lt;/TD&gt;
&lt;TD ALIGN=CENTER BGCOLOR=&quot;#008080&quot;&gt;
&lt;FONT STYLE=&quot;ARIAL NARROW&quot; COLOR=&quot;#ffffff&quot; SIZE=1&gt;State/Province&lt;/FONT&gt;
&lt;/TD&gt;

&lt;/TR&gt;

&lt;!--Display ADO Data from Customer Table--&gt;

  &lt;TR&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt; 
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RSCustomerList(&quot;CompanyName&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;ContactLastName&quot;) &amp; &quot;, &quot; %&gt; 
      &lt;%= RScustomerList(&quot;ContactFirstName&quot;) %&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt;
     
      &lt;%= RScustomerList(&quot;PhoneNumber&quot;)%&gt; 
   &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;City&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;TD BGCOLOR=&quot;f7efde&quot; ALIGN=CENTER&gt;
    &lt;FONT STYLE=&quot;ARIAL NARROW&quot; SIZE=1&gt; 
      &lt;%= RScustomerList(&quot;StateOrProvince&quot;)%&gt; 
    &lt;/FONT&gt;&lt;/TD&gt;
  &lt;/TR&gt; &lt;/Table&gt;&lt;/FONT&gt;


&lt;HR&gt;
&lt;Input Type = Button Name = cmdDown  Value = &quot;&lt;    &quot;&gt;
&lt;Input Type = Button Name = cmdUp Value = &quot;   &gt;&quot;&gt;
&lt;H5&gt;Click Direction Arrows for Previous or Next Record
&lt;BR&gt; Click Move Amount to use Move Method
Enter Number of Records to Move + or - &lt;/H5&gt;

&lt;Table&gt;

&lt;Form Method = Post Action=&quot;Move.asp&quot; Name=Form&gt;

&lt;TR&gt;&lt;TD&gt;&lt;Input Type=&quot;Button&quot; Name = Move Value=&quot;Move Amount &quot;&gt;&lt;/TD&gt;&lt;TD&gt;&lt;/TD&gt;&lt;TD&gt;
&lt;Input Type=&quot;Text&quot; Size=&quot;4&quot; Name=&quot;MoveAmount&quot; Value = 0&gt;&lt;/TD&gt;&lt;TR&gt;
&lt;/Form&gt;&lt;/Table&gt;&lt;/Center&gt;

&lt;/BODY&gt;

&lt;Script Language = &quot;VBScript&quot;&gt;

Sub Move_OnClick
' Make sure move value entered is an integer
If IsNumeric(Document.Form.MoveAmount.Value)Then
&#09;Document.Form.MoveAmount.Value = CInt(Document.Form.MoveAmount.Value)
&#09;Document.Form.Submit
Else
&#09;MsgBox &quot;You Must Enter a Number&quot;, ,&quot;ADO-ASP Example&quot;
&#09;Document.Form.MoveAmount.Value = 0
End If

End Sub

Sub cmdDown_OnClick

Document.Form.MoveAmount.Value = -1
Document.Form.Submit

End Sub

Sub cmdUp_OnClick

Document.Form.MoveAmount.Value = 1
Document.Form.Submit

End Sub

&lt;/Script&gt;
&lt;/HTML&gt;</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>