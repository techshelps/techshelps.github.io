<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddNew Method (ADO)</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME=MS-HKWD CONTENT="AddNew Method (ADO)">
<META NAME="Keywords" CONTENT="Active Data Objects, ADO">
<META NAME="Platform" CONTENT="Windows">
<META NAME="ROBOTS" CONTENT="all">

<!--@ SNIFF_START -->
<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../code/ver.js"></SCRIPT>
<!--@ SNIFF_END -->

<SCRIPT DEFER SRC="../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Microsoft ActiveX Data Objects"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID=TOC HREF="../contents.htm">Contents</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../index.htm">Index</A>  <IMG SRC="../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="idx01.htm">Topic Contents</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><a name="admthaddnew"></a>AddNew Method - ADO</H1>
<p>Creates a new record for an updatable <a href="obj01_6.htm"><b>Recordset</b></a> object.
<p><b>Applies To</b>
<p><a href="obj01_6.htm"><b>Recordset</b></a>
<p><b>Syntax</b>
<p><i>recordset</i><b>.AddNew</b> <b><i>Fields</i>,</b> <b><i>Values</i></b>
<p><b>Parameters</b>
<p><b><i>Fields</i></b>   Optional. A single name or an array of names or ordinal positions of the fields in the new record.
<p><b><i>Values</i></b>   Optional. A single value or an array of values for the fields in the new record. If <i><b>Fields</b> </i>is an array, <b><i>Values</i></b> must also be an array with the same number of members; otherwise, an error occurs. The order of field names must match the order of field values in each array.
<p><b>Remarks</b>
<p>Use the <b>AddNew</b> method to create and initialize a new record. Use the <a href="mth03_5.htm"><b>Supports</b></a> method with <b>adAddNew</b> to verify whether you can add records to the current <b>Recordset</b> object.
<p>After you call the <b>AddNew</b> method, the new record becomes the current record and remains current after you call the <a href="mth03_6.htm"><b>Update</b></a> method. If the <b>Recordset</b> object does not support bookmarks, you may not be able to access the new record once you move to another record. Depending on your cursor type, you may need to call the <a href="mth03_3.htm"><b>Requery</b></a> method to make the new record accessible.
<p>If you call <b>AddNew</b> while editing the current record or while adding a new record, ADO calls the <b>Update</b> method to save any changes and then creates the new record.
<p>The behavior of the <b>AddNew</b> method depends on the updating mode of the <b>Recordset</b> object and whether or not you pass the <b><i>Fields</i></b> and <b><i>Values</i></b> arguments.
<p>In immediate update mode (the provider writes changes to the underlying data source once you call the <b>Update</b> method), calling the <b>AddNew</b> method without arguments sets the <a href="pro03_4.htm"><b>EditMode</b></a> property to <b>adEditAdd</b>. The provider caches any field value changes locally. Calling the <b>Update</b> method posts the new record to the database and resets the <b>EditMode</b> property to <b>adEditNone</b>. If you pass the <b><i>Fields</i></b> and <b><i>Values</i></b> arguments, ADO immediately posts the new record to the database (no <b>Update</b> call is necessary); the <b>EditMode</b> property value does not change (<b>adEditNone</b>).
<p>In batch update mode (the provider caches multiple changes and writes them to the underlying data source only when you call the <a href="mth03_7.htm"><b>UpdateBatch</b></a> method), calling the <b>AddNew</b> method without arguments sets the <b>EditMode</b> property to <b>adEditAdd</b>. The provider caches any field value changes locally. Calling the <b>Update</b> method adds the new record to the current recordset and resets the <b>EditMode</b> property to <b>adEditNone</b>, but the provider does not post the changes to the underlying database until you call the <b>UpdateBatch</b> method. If you pass the <b><i>Fields</i></b> and <b><i>Values</i></b> arguments, ADO sends the new record to the provider for storage in a cache; you need to call the <b>UpdateBatch</b> method to post the new record to the underlying database.
<p><b>Examples</b>
<p><a href="mthx1.htm"><b>AddNew Method Example (VB)</b></a>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>