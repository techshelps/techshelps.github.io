<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDispatchEx</TITLE>

<META NAME=MS-HKWD CONTENT="IDispatchEx">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_script_idispex"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IDispatchEx"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbarc.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IDispatchEx"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../compdev.htm#set_components">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../engines/references/SCRIPTTHREADSTATE.htm">SCRIPTTHREADSTATE</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="references/IDispatchEx.htm">IDispatchEx Methods</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>IDispatchEx</h1>

<P><A HREF="IDispatchEx.htm#ch_script_idispex">IDispatchEx</A>, an extension of the <A HREF="references/IDispatch.htm#IDispatch">IDispatch</A> interface, supports features appropriate for dynamic languages such as scripting languages. This section describes the <B>IDispatchEx</B> interface itself, the differences between <B>IDispatch</B> and <B>IDispatchEx</B>, and the rationale for the extensions. It is expected that readers are familiar with <B>IDispatch</B> and have access to the <B>IDispatch</B> documentation.

<P><A CLASS=tctop HREF="IDispatchEx.htm#Description"><IMG SRC="../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">Description</A><BR>

<P><A CLASS=tctop HREF="references/IDispatchEx.htm#IDispatchEx_Methods"><IMG SRC="../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">IDispatchEx Methods</A><BR>

<P><A CLASS=tctop HREF="references/IDispatch.htm#IDispatch"><IMG SRC="../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">IDispatch Methods</A><BR>

<P><A CLASS=tctop HREF="references/examples.htm#ref_idi_examples"><IMG SRC="../../art/arrowg.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowg.gif">Examples</A><BR>
<h2><A NAME="Description">Description</A></h2>

<P><A HREF="references/IDispatch.htm#IDispatch">IDispatch</A> was developed essentially for Microsoft&#174; Visual Basic&#174;. The primary limitation of <B>IDispatch</B> is that it assumes objects are static, that is, they do not change during run time and thus can be fully described at compile time by type information. Dynamic run time models as found in scripting languages such as Visual Basic Scripting Edition (VBScript) and JScript and object models such as Dynamic HTML require a more flexible interface.

<P><A HREF="IDispatchEx.htm#ch_script_idispex">IDispatchEx</A> was developed to provide all the services of <A HREF="references/IDispatch.htm#IDispatch">IDispatch</A> as well as some extensions that are appropriate for more dynamic late-bound languages such as scripting languages. The additional features of <B>IDispatchEx</B> beyond those provided by <B>IDispatch</B> are: 
<UL>
<LI>Add new members to an object ("expando")&#151;use <A HREF="references/IDispatchEx_GetDispID.htm#GetDispID">GetDispID</A> with the fdexNameEnsure flag.
<LI>Delete members of an object&#151;use <A HREF="references/IDispatchEx_DeleteMemberByName.htm#DeleteMemberByName">DeleteMemberByName</A> or <A HREF="references/IDispatchEx_DeleteMemberByDispID.htm#DeleteMemberByDispID">DeleteMemberByDispID</A>.
<LI>Case-sensitive dispatch operations&#151;use fdexNameCaseSensitive or fdexNameCaseInsensitive.
<LI>Search for member with implicit name&#151;use fdexNameImplicit.
<LI>Enumerate DISPIDs of an object&#151;use <A HREF="references/IDispatchEx_GetNextDispID.htm#GetNextDispID">GetNextDispID</A>.
<LI>Map from DISPID to element name&#151;use <A HREF="references/IDispatchEx_GetMemberName.htm#GetMemberName">GetMemberName</A>.
<LI>Obtain properties of object members&#151;use <A HREF="references/IDispatchEx_GetMemberProperties.htm#GetMemberProperties">GetMemberProperties</A>.
<LI>Method invocation with <B>this</B> pointer&#151;use <A HREF="references/IDispatchEx_InvokeEx.htm#InvokeEx">InvokeEx</A> with DISPATCH_METHOD.
<LI>Allow browsers that support the concept of name spaces to obtain the name space parent of an object&#151;use <A HREF="references/IDispatchEx_GetNameSpaceParent.htm#GetNameSpaceParent">GetNameSpaceParent</A>.
</UL>

<P>Objects that support <A HREF="IDispatchEx.htm#ch_script_idispex">IDispatchEx</A> might also support <A HREF="references/IDispatch.htm#IDispatch">IDispatch</A> for backward compatibility. The dynamic nature of objects that support <B>IDispatchEx</B> has a few implications for the <B>IDispatch</B> interface of those objects. For example, <B>IDispatch</B> assumes that "The member and parameter DISPIDs must remain constant for the lifetime of the object. This allows a client to obtain DISPIDs once, and cache them for later use." Since <B>IDispatchEx</B> allows the addition and deletion of members, the set of valid DISPIDs does not remain constant. However, <B>IDispatchEx</B> requires that the mapping between DISPID and member name remain constant. This means that if a member is deleted:
<UL>
<LI>The DISPID cannot be reused unless a member with the same name is created.
<LI>The DISPID must remain valid for <A HREF="references/IDispatchEx_GetNextDispID.htm#GetNextDispID">GetNextDispID</A>.
<LI>The DISPID must be accepted gracefully by any of the <A HREF="references/IDispatch.htm#IDispatch">IDispatch</A>/<A HREF="IDispatchEx.htm#ch_script_idispex">IDispatchEx</A> methods&#151;they must recognize the member as deleted and return an appropriate error code (usually DISP_E_MEMBERNOTFOUND or S_FALSE). 
</UL>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
