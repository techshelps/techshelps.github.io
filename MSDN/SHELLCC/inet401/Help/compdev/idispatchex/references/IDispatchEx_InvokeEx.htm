<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDispatchEx::InvokeEx</TITLE>

<META NAME=MS-HKWD CONTENT="IDispatchEx::InvokeEx">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="InvokeEx"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IDispatchEx::InvokeEx"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbarc.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IDispatchEx::InvokeEx"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../IDispatchEx.htm#ch_script_idispex">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IDispatchEx_GetNextDispID.htm">IDispatchEx::GetNextDispID</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IDispatch.htm">IDispatch Methods</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>IDispatchEx::InvokeEx</h1>

<PRE>HRESULT InvokeEx(
   DISPID id,
   LCID lcid,
   WORD wFlags,
   DISPARAMS *pdp,
   VARIANT *pVarRes, 
   EXCEPINFO *pei, 
   IServiceProvider *pspCaller 
);
</PRE>

<P>Provides access to properties and methods exposed by an <A HREF="../IDispatchEx.htm#ch_script_idispex">IDispatchEx</A> object.

<UL>
<LI>Returns one of the following values:
<TABLE>
<TR><TD>S_OK 
 </TD><TD>Success. 
</TD></TR><TR><TD>DISP_E_BADPARAMCOUNT 
 </TD><TD>The number of elements provided to DISPPARAMS is different from the number of arguments accepted by the method or property. 
</TD></TR><TR><TD>DISP_E_BADVARTYPE 
 </TD><TD>One of the arguments in rgvarg is not a valid variant type. 
</TD></TR><TR><TD>DISP_E_EXCEPTION 
 </TD><TD>The application needs to raise an exception. In this case, the structure passed in <I>pei</I> should be filled in. 
</TD></TR><TR><TD>DISP_E_MEMBERNOTFOUND 
 </TD><TD>The requested member does not exist, or the call to <B>InvokeEx</B> tried to set the value of a read-only property.
</TD></TR><TR><TD>DISP_E_NONAMEDARGS 
 </TD><TD>This implementation of <A HREF="IDispatch.htm#IDispatch">IDispatch</A> does not support named arguments. 
</TD></TR><TR><TD>DISP_E_OVERFLOW 
 </TD><TD>One of the arguments in rgvarg could not be coerced to the specified type. 
</TD></TR><TR><TD>DISP_E_PARAMNOTFOUND 
 </TD><TD>One of the parameter DISPIDs does not correspond to a parameter on the method.
</TD></TR><TR><TD>DISP_E_TYPEMISMATCH 
 </TD><TD>One or more of the arguments could not be coerced.
</TD></TR><TR><TD>DISP_E_UNKNOWNLCID 
 </TD><TD>The member being invoked interprets string arguments according to the LCID, and the LCID is not recognized. If the LCID is not needed to interpret arguments, this error should not be returned. 
</TD></TR><TR><TD>DISP_E_PARAMNOTOPTIONAL
 </TD><TD>A required parameter was omitted.
</TD></TR></TABLE>
</UL>
<DL><DT><I>id</I>
 </DT><DD>Identifies the member. Use <A HREF="IDispatchEx_GetDispID.htm#GetDispID">GetDispID</A> or <A HREF="IDispatchEx_GetNextDispID.htm#GetNextDispID">GetNextDispID</A> to obtain the dispatch identifier.
</DD><DT><I>lcid</I>
 </DT><DD>The locale context in which to interpret arguments. The <I>lcid</I> is passed to <B>InvokeEx</B> to allow the object to interpret its arguments specific to a locale.
</DD><DT><I>wFlags</I>
 </DT><DD>Flags describing the context of the <B>InvokeEx</B> call:
 <TABLE>
<TR><TD>DISPATCH_METHOD
 </TD><TD>The member is invoked as a method. If a property has the same name, both this and the DISPATCH_PROPERTYGET flag may be set (defined by <A HREF="IDispatch.htm#IDispatch">IDispatch</A>).
 </TD></TR><TR><TD>DISPATCH_PROPERTYGET
 </TD><TD>The member is retrieved as a property or data member (defined by <A HREF="IDispatch.htm#IDispatch">IDispatch</A>).
 </TD></TR><TR><TD>DISPATCH_PROPERTYPUT
 </TD><TD>The member is changed as a property or data member (defined by <A HREF="IDispatch.htm#IDispatch">IDispatch</A>).
 </TD></TR><TR><TD>DISPATCH_PROPERTYPUTREF
 </TD><TD>The member is changed by a reference assignment, rather than a value assignment. This flag is valid only when the property accepts a reference to an object (defined by <A HREF="IDispatch.htm#IDispatch">IDispatch</A>).
 </TD></TR><TR><TD>DISPATCH_CONSTRUCT
 </TD><TD>The member is being used as a constructor (this is a new value defined by <B>IDispatchEx</B>). The legal values for wFlags are:
 <TABLE>
<TR><TD>DISPATCH_PROPERTYGET
 </TD><TR><TD>DISPATCH_METHOD
 </TD><TR><TD>DISPATCH_PROPERTYGET | DISPATCH_METHOD
 </TD><TR><TD>DISPATCH_PROPERTYPUT
 </TD><TR><TD>DISPATCH_PROPERTYPUTREF
 </TD><TR><TD>DISPATCH_PROPERTYPUT | DISPATCH_PROPERTYPUTREF
 </TD><TR><TD>DISPATCH_CONSTRUCT
 </TD></TABLE>
</TD></TR></TABLE>
</DD><DT><I>pdp</I>
 </DT><DD>Pointer to a structure containing an array of arguments, an array of argument DISPIDs for named arguments, and counts for the number of elements in the arrays. See the <A HREF="IDispatch.htm#IDispatch">IDispatch</A> documentation for a full description of the DISPPARAMS structure.
</DD><DT><I>pVarRes</I>
 </DT><DD>Pointer to the location where the result is to be stored, or Null if the caller expects no result. This argument is ignored if DISPATCH_PROPERTYPUT or DISPATCH_PROPERTYPUTREF is specified.
</DD><DT><I>pei</I>
 </DT><DD>Pointer to a structure that contains exception information. This structure should be filled in if DISP_E_EXCEPTION is returned. Can be Null. See the <A HREF="IDispatch.htm#IDispatch">IDispatch</A> documentation for a full description of the EXCEPINFO structure.
</DD><DT><I>pspCaller</I>
 </DT><DD>Pointer to a service provider object supplied by the caller which allows the object to obtain services from the caller. Can be Null.
</DD></DL>

<P><B>IDispatchEx::InvokeEx</B> provides all of the same features as
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>IDispatch::Invoke</A> and adds a few extensions:
<TABLE>
<TR><TD>DISPATCH_CONSTRUCT&nbsp;&nbsp;&nbsp;
 </TD><TD>Indicates that the item is being used as a constructor.
</TD></TR><TR><TD>pspCaller
 </TD><TD>The pspCaller allows the object access to services provided by the caller. Specific services may be handled by the caller itself or delegated to callers further up the call chain. For example, if a script engine inside a browser makes an <B>InvokeEx</B> call to an external object, the object can follow the <I>pspCaller</I> chain to obtain services from the script engine or browser. (Note that the call chain is not the same as the creation chain &#150; a.k.a. container chain or site chain &#150; the creation chain may be available through some other mechanism such as IObjectWithSite.) 
</TD></TR><TR><TD>"this" pointer
 </TD><TD>When DISPATCH_METHOD is set in wFlags, there may be a "named parameter" for the "this" value. The DISPID will be DISPID_THIS and it must be the first named parameter.
 <P>The unused riid parameter in
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>IDispatch::Invoke</A> has been removed.
 <P>The puArgArr parameter in
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>IDispatch::Invoke</A> has been removed.
</TD></TR></TABLE>

<P>See the
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>IDispatch::Invoke</A> documentation for the following examples:
<UL>
<LI>"Calling a method with no arguments"
<LI>"Getting and setting properties"
<LI>"Passing parameters"
<LI>"Indexed Properties"
<LI>"Raising exceptions during Invoke"
<LI>"Returning errors"
</UL>

<P><B>Example</B>
<PRE>VARIANT var;
   BSTR bstrName;
   DISPID dispid;
   IDispatch *pdex;
   DISPPARAMS dispparamsNoArgs = {NULL, NULL, 0, 0};

   // Assign to pdex and bstrName
   pdex-&gt;GetDispID(bstrName, fdexNameCaseSensitive, &amp;dispid);
   pdex-&gt;InvokeEx(dispid, LOCALE_USER_DEFAULT,
   DISPATCH_PROPERTYGET, &amp;dispparamsNoArgs, 
   &amp;var, NULL, NULL);
</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
