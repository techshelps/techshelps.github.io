<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IActiveScriptParse::AddScriptlet</TITLE>

<META NAME=MS-HKWD CONTENT="IActiveScriptParse::AddScriptlet">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="IActiveScriptParse__"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IActiveScriptParse::AddScriptlet"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbarc.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IActiveScriptParse::AddScriptlet"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../engines.htm#ch_script_engine">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="IActiveScriptParse.htm">IActiveScriptParse</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="IActiveScriptParse_InitNew.htm">IActiveScriptParse::InitNew</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>IActiveScriptParse::AddScriptlet</h1>

<PRE>HRESULT AddScriptlet(
    LPCOLESTR pstrDefaultName,   // address of default name of scriptlet
    LPCOLESTR pstrCode,          // address of scriptlet text
    LPCOLESTR pstrItemName,      // address of item name
    LPCOLESTR pstrSubItemName,   // address of subitem name
    LPCOLESTR pstrEventName,     // address of event name
    LPCOLESTR pstrDelimiter,     // address of end-of-scriptlet delimiter
    DWORD dwSourceContextCookie, // application-defined value for debugging
    ULONG ulStartingLineNumber,  // starting line of the script
    DWORD dwFlags,               // scriptlet flags
    BSTR *pbstrName,             // address of actual name of scriptlet
    EXCEPINFO *pexcepinfo        // address of exception information
);
</PRE>

<P>Adds a code scriptlet to the script. This method is used in environments where the persistent state of the script is intertwined with the host document and the host is responsible for restoring the script, rather than through an <B>IPersist*</B> interface. The primary examples are HTML scripting languages that allow scriptlets of code embedded in the HTML document to be attached to intrinsic events (for instance, ONCLICK="button1.text='Exit'"). 

<UL>
<LI>Returns one of the following values:
<TABLE>
<TR><TD>S_OK
 </TD><TD>Success.
</TD></TR><TR><TD>DISP_E_EXCEPTION
 </TD><TD>An exception occurred in the parsing of the scriptlet; the <I>pexcepinfo</I> parameter contains information about the exception.
</TD></TR><TR><TD>E_INVALIDARG
 </TD><TD>An argument was invalid.
</TD></TR><TR><TD>E_NOTIMPL
 </TD><TD>This method is not supported; the scripting engine does not support adding event-sinking scriptlets.
</TD></TR><TR><TD>E_POINTER
 </TD><TD>An invalid pointer was specified.
</TD></TR><TR><TD>E_UNEXPECTED
 </TD><TD>The call was not expected (for example, the scripting engine has not yet been loaded or initialized) and therefore failed. 
</TD></TR><TR><TD>OLESCRIPT_E_INVALIDNAME
 </TD><TD>The default name supplied is invalid in this scripting language.
</TD></TR><TR><TD>OLESCRIPT_E_SYNTAX
 </TD><TD>An unspecified syntax error occurred in the scriptlet.
</TD></TR></TABLE>
</UL>
<DL><DT><I>pstrDefaultName</I>
 </DT><DD>[in] Address of a default name to associate with the scriptlet. If the scriptlet does not contain naming information (as in the ONCLICK example above), this name will be used to identify the scriptlet. If this parameter is NULL, the scripting engine manufactures a unique name, if necessary.
</DD><DT><I>pstrCode</I>
 </DT><DD>[in] Address of the scriptlet text to add. The interpretation of this string depends on the scripting language.
</DD><DT><I>pstrItemName</I>
 </DT><DD>[in] Address of a buffer that contains the item name associated with this scriptlet. This parameter, in addition to <I>pstrSubItemName</I>, identifies the object for which the scriptlet is an event handler.
</DD><DT><I>pstrSubItemName</I>
 </DT><DD>[in] Address of a buffer that contains the name of a subobject of the named item with which this scriptlet is associated; this name must be found in the named item's type information. This parameter is NULL if the scriptlet is to be associated with the named item instead of a subitem. This parameter, in addition to <I>pstrItemName</I>, identifies the specific object for which the scriptlet is an event handler.
</DD><DT><I>pstrEventName</I>
 </DT><DD>[in] Address of a buffer that contains the name of the event for which the scriptlet is an event handler.
</DD><DT><I>pstrDelimiter</I>
 </DT><DD>[in] Address of the end-of-scriptlet delimiter. When the <I>pstrCode</I> parameter is parsed from a stream of text, the host typically uses a delimiter, such as two single quotation marks ("), to detect the end of the scriptlet. This parameter specifies the delimiter that the host used, allowing the scripting engine to provide some conditional primitive preprocessing (for example, replacing a single quotation mark ['] with two single quotation marks for use as a delimiter). Exactly how (and if) the scripting engine makes use of this information depends on the scripting engine. Set this parameter to NULL if the host did not use a delimiter to mark the end of the scriptlet.
</DD><DT><I>dwSourceContextCookie</I>
 </DT><DD>[in] Application-defined value that is used for debugging purposes.
</DD><DT><I>ulStartingLineNumber</I>
 </DT><DD>[in] Zero-based value that specifies which line the parsing will begin at.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags associated with the scriptlet. Can be a combination of the following values:
 <TABLE>
<TR><TD>SCRIPTTEXT_ISVISIBLE
 </TD><TD>Indicates that the script text should be visible (and, therefore, callable by name) as a global method in the name space of the script.
 </TD></TR><TR><TD>SCRIPTTEXT_ISPERSISTENT
 </TD><TD>Indicates that the code added during this call should be saved if the scripting engine is saved (for example, through a call to <B>IPersist*::Save</B>), or if the scripting engine is reset by way of a transition back to the initialized state. For more information about this state, see <A HREF="../engines.htm#Engine_States">Script Engine States</A>.
 </TD></TR></TABLE>
</DD><DT><I>pbstrName</I>
 </DT><DD>[out] Actual name used to identify the scriptlet. This will be, in order of preference: a name explicitly specified in the scriptlet text, the default name provided in <I>pstrDefaultName</I>, or a unique name synthesized by the scripting engine.
</DD><DT><I>pexcepinfo</I>
 </DT><DD>[out] Address of a structure containing exception information. This structure should be filled in if DISP_E_EXCEPTION is returned.
</DD></DL>
<!-- ****************************************************** --><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
