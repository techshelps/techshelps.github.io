<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Software Update Channels</TITLE>

<META NAME=MS-HKWD CONTENT="Creating Software Update Channels">
<META NAME="Keywords" CONTENT="Active Channels, Active Desktop items, Software Update Channels">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_softchan"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Creating Software Update Channels"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbarb.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Creating Software Update Channels"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="authoring.htm#content_authoring">Topic Contents</A>

</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="desktop_items.htm">Creating Active Desktop Items</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../references/CDF.htm">CDF Reference</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Creating Software Update Channels</H1>

<P>Software Update Channels are specialized channels that provide the ability to notify users of software updates and also to deliver and install program files onto users' computers. 

<P>Software developers can use Software Update Channels as a method of delivering updated versions of their software to their users. All users who subscribe to the developer's Software Update Channel will receive notification that a new version is available.

<P>Corporations can use Software Update Channels to distribute applications and software updates to all of the desktops connected to their corporate network instead of updating each system individually.

<H2><A NAME="Distributing_Softwar">Distributing Software</A></H2>

<P>To distribute software using a Software Update Channel, the developer or corporation needs to:

<OL>
<LI>Create a Software Update Channel.
<LI>Create an Open Software Description (OSD) file.
<LI>Create a distribution unit.
</OL>

<H3><A NAME="Creating_a_Software_">Creating a Software Update Channel</A></H3>

<P>A Software Update Channel is defined with a Channel Definition Format (CDF) file, which is written in the Extensible Markup Language (XML). For more information on CDF files, see <A HREF="active_channels.htm#ch_channels">CDF Reference for Active Channels</A>. For Software Update Channel extensions to the CDF, see <A HREF="../../itt/osd/reference/SOFTPKG.htm#VERSION_">VERSION= (SOFTPKG)</A><BR>. For information on XML, see <A HREF="../../itt/xml/xmlobj.htm#ch_xmlobj">XML Object Model</A> documentation.

<P>The <B>VALUE=</B> attribute of the <B>USAGE</B> tag is set to the value "SoftwareUpdate" in the CDF file to notify Microsoft&#174; Internet Explorer 4.0 that this is a Software Update Channel. The shortcut for the channel will be created in the Software Updates folder in the Favorites menu.

<P>For a Software Update Channel, the CDF file would contain details on the software distribution unit available. These details include:

<UL>
<LI>The unique string name of the distribution unit. One way to ensure the name is unique is to use a globally unique identifier (GUID).
<LI>The title of the distribution unit, which should be something meaningful to the user.
<LI>The operating system for which the distribution unit is available.
<LI>The location of the distribution unit.
</UL>

<P>The following is an example of a CDF file for a Software Update Channel for a fictitious company, Awesome Computers. 

<PRE>&lt;CHANNEL HREF="http://www.server.com/setup-page.htm"&gt;
&lt;SELF HREF="http://www.awesome_computers.com/awesome_comp.cdf" /&gt;
&lt;USAGE VALUE="SoftwareUpdate" /&gt;
&lt;TITLE&gt;Awesome Computer's Software Update Channel&lt;/TITLE&gt;
&lt;ABSTRACT&gt;Awesome Computers' site for updated drivers and programs for all our awesome systems.
&lt;/ABSTRACT&gt;

&lt;LOGO HREF="http://www.awesome_computers.com/ac-channel.gif" STYLE="IMAGE" /&gt;
&lt;LOGO HREF="http://www.awesome_computers.com/ac-channel.ico" STYLE="ICON" /&gt;

    &lt;SOFTPKG NAME="{D27CDB6E-AE6D-11CF-96B8-444553540000}" 
        HREF="http://www.awesome_computers.com/Update.htm"
        VERSION="2,0,0,0"
        AUTOINSTALL="Yes"
        STYLE="MSICD"&gt;
        &lt;TITLE&gt;Update for the system diagnostic control for Windows 95&lt;/TITLE&gt;

        &lt;ABSTRACT&gt;System diagnostic control that tracks download efficency information.
        &lt;/ABSTRACT&gt;

        &lt;USAGE VALUE="email" /&gt;
        &lt;IMPLEMENTATION&gt;
                &lt;OS VALUE="win95" /&gt;
                &lt;CODEBASE HREF="http://www.awesome_computers.com/diagnostic.cab" /&gt;
        &lt;/IMPLEMENTATION&gt;
    &lt;/SOFTPKG&gt;
&lt;/CHANNEL&gt;

</PRE>

<P>The <B>NAME=</B> attribute of the <A HREF="../../itt/osd/reference/SOFTPKG.htm#VERSION_">VERSION= (SOFTPKG)</A><BR> tag contains the unique string name for the distribution unit, which is a GUID in the example.

<P>The <A HREF="../references/channels/TITLE.htm#TITLE">TITLE</A> tag contains the friendly title that is used to notify the user of the software distribution unit's availability.

<P>The <A HREF="../../itt/osd/reference/IMPLEMENTATION.htm">IMPLEMENTATION</A> tag contains the information on the operating system and the location of the code. The <B>VALUE=</B> attribute of the <A HREF="../../itt/osd/reference/OS.htm">OS</A> tag indicates the operating system for which the distribution unit is available (Microsoft&#174; Windows 95&#174; in the example), and the <B>HREF=</B> attribute of the <A HREF="../../itt/osd/reference/CODEBASE.htm">CODEBASE</A> tag indicates the location of the distribution unit. If no <B>CODEBASE</B> tag is provided, the Active Channel acts as an advertisement for the software package. The content in the <A HREF="../references/channels/ABSTRACT.htm#ABSTRACT">ABSTRACT</A> tag should contain information about where to download the advertised software package.

<P>The CDF file should contain scheduling information so that the user's computer knows how often to check the server for updates. The schedule should also provide information to let the user's computer randomize its checks. For details about adding schedule information to the CDF file, see the <A HREF="../references/channels/SCHEDULE.htm#SCHEDULE">SCHEDULE</A> tag in the <A HREF="active_channels.htm#ch_channels">CDF Reference for Active Channels</A>.

<P>For Software Update Channels that are provided for a one-time download, the <A HREF="../references/software_channels/DELETEONINSTALL.htm">DELETEONINSTALL</A> tag can be added inside the <A HREF="../../itt/osd/reference/SOFTPKG.htm#VERSION_">VERSION= (SOFTPKG)</A><BR> tag in the CDF file. The channel will be deleted after the installation of the software package has been completed.


<H3><A NAME="Creating_the_Open_So">Creating the Open Software Description file</A></H3>

<P>The Open Software Description (OSD) file is also written in XML and is similar to the CDF file. This file contains the information about what the user's computer needs to do after it downloads the distribution unit from the server. For more information on OSD files, see <A HREF="http://www.microsoft.com/sitebuilder/standards/osd/" TARGET="_top">http://www.microsoft.com/sitebuilder/standards/osd/</A><IMG SRC="../../art/external.gif" WIDTH="19" HEIGHT="8" ALT="External link">. For more information on XML, see <A HREF="http://www.microsoft.com/sitebuilder/standards/xml/" TARGET="_top">http://www.microsoft.com/sitebuilder/standards/xml/</A><IMG SRC="../../art/external.gif" WIDTH="19" HEIGHT="8" ALT="External link">.

<P>The following example is a sample OSD file for Awesome Computer's updated diagnostic control that indicates a download location for the updated control.

<PRE>&lt;?XML version="1.0" ?&gt;
&lt;!DOCTYPE SOFTPKG SYSTEM "http://www.microsoft.com/standards/osd/osd.dtd" &gt;
&lt;?XML::namespace href="http://www.microsoft.com/standards/osd/msicd.dtd" as="msicd"?&gt;

&lt;SOFTPKG NAME="{D27CDB6E-AE6D-11CF-96B8-444553540000}" VERSION="2,0,0,0" STYLE="MSICD"&gt;
    &lt;TITLE&gt;System diagnostic control for Windows 95&lt;/TITLE&gt;
    &lt;ABSTRACT&gt;This distribution contains updated diagnostic control.
    &lt;/ABSTRACT&gt;

    &lt;msicd::NATIVECODE&gt;
        &lt;CODE   NAME="diagnose.ocx"
                        CLASSID="{D27CDB6E-AE6D-11CF-96B8-444553540000}"
                        VERSION="2,0,0,0"&gt;
                &lt;IMPLEMENTATION&gt;
                    &lt;OS VALUE="win95" /&gt;
                    &lt;CODEBASE HREF="http://www.awesome_computers.com/diagnose.cab" /&gt;
                &lt;/IMPLEMENTATION&gt;
        &lt;/CODE&gt;
    &lt;/msicd::NATIVECODE&gt;
&lt;/SOFTPKG&gt;

</PRE>

<P>The &lt;!DOCTYPE SOFTPKG SYSTEM "http://www.microsoft.com/standards/osd/osd.dtd" &gt; line sets the Document Type Definition (DTD) file, which defines the formal grammar for a type document. In this case, it is defining the grammar for an OSD file. This file allows an XML parser or other verifier to check if the OSD file is well-formed. 
 

<P>The &lt;?XML::namespace href="http://www.microsoft.com/standards/osd/msicd.dtd" as="msicd"?&gt; line specifies additional legal elements that will use the name space identifier defined by the <B>as=</B> attribute. For this example, the name space is "msicd".

<P>The <A HREF="../../itt/msicd/reference/NATIVECODE.htm">NATIVECODE</A> tag defined in the Msicd.dtd file notifies the user's computer that the distribution unit is written in the native code of the operating system noted in the <B>VALUE=</B> attribute of the <A HREF="../../itt/osd/reference/OS.htm">OS</A> tag. The <A HREF="../../itt/msicd/reference/JAVA.htm">JAVA</A> tag is used if the distribution unit contains a Java class, a Java application, or JavaBeans.

<P>The <A HREF="../../itt/osd/reference/DEPENDENCY.htm">DEPENDENCY</A> tag can be added inside the <A HREF="../../itt/osd/reference/SOFTPKG.htm#VERSION_">VERSION= (SOFTPKG)</A><BR> tag section to indicate a software dependency. The <B>DEPENDENCY</B> tag allows developers or corporations to have the distribution unit downloaded only if certain conditions exist. For example, you could set a dependency that a particular distribution unit has to be installed. If it is installed, it will download a distribution unit that contains a patch for the installed software. 


<H4><A NAME="Describing_Java_Pack">Describing Java packages</A></H4>

<P>Describing Java packages is similar to describing native code distribution units, except they use the <A HREF="../../itt/msicd/reference/JAVA.htm">JAVA</A> tag instead of <A HREF="../../itt/msicd/reference/NATIVECODE.htm">NATIVECODE</A> and the <A HREF="../../itt/msicd/reference/PACKAGE.htm">PACKAGE</A> tag instead of <A HREF="../../itt/osd/reference/CODEBASE.htm">CODEBASE</A>.

<P>The following example shows the <A HREF="../../itt/osd/reference/SOFTPKG.htm#VERSION_">VERSION= (SOFTPKG)</A><BR> tag section that describes a Java package.

<PRE>&lt;SOFTPKG NAME="StorePackage" VERSION="1,0,0,0"&gt;
&lt;TITLE&gt;The StoreData class&lt;/TITLE&gt;

&lt;ABSTRACT&gt;StorePackage contains a single class called StoreData.
&lt;/ABSTRACT&gt;

&lt;msicd::JAVA&gt;

    &lt;PACKAGE NAME="com.ms.StorePackage" VERSION="1,0,0,2"&gt;
    &lt;IMPLEMENTATION&gt;
    &lt;/IMPLEMENTATION&gt;
    &lt;/PACKAGE&gt;

&lt;/msicd::JAVA&gt;

&lt;/SOFTPKG&gt;

</PRE>


<H4><A NAME="Describing_Java_Appl">Describing Java applications</A></H4>

<P>The following example shows the <A HREF="../../itt/osd/reference/SOFTPKG.htm#VERSION_">VERSION= (SOFTPKG)</A><BR> tag section that describes a Java application.

<PRE>&lt;SOFTPKG NAME="Some Application for Java" VERSION="1,0,0,0"&gt;

    &lt;TITLE&gt;MS Office for Java&lt;/TITLE&gt;

    &lt;ABSTRACT&gt;Some Application for Java is a standalone Java application.
    &lt;/ABSTRACT&gt;

        &lt;msicd::JAVA&gt;
            &lt;NAMESPACE&gt;Some Application for Java&lt;/NAMESPACE&gt;
            &lt;PACKAGE VERSION="1,0,0,2"&gt;

                &lt;IMPLEMENTATION&gt;
                &lt;/IMPLEMENTATION&gt;

            &lt;/PACKAGE&gt;

        &lt;/msicd::JAVA&gt;

&lt;/SOFTPKG&gt;

</PRE>

<H4><A NAME="Describing_JavaBeans">Describing JavaBeans</A></H4>

<P>The OSD file can describe both JavaBeans and Microsoft&#174; ActiveX&#153; Controls wrapped as JavaBeans. ActiveX Controls wrapped as JavaBeans require the <B>CLASSID=</B> attribute in the <A HREF="../../itt/msicd/reference/CLASS.htm">CLASS</A> element and the <A HREF="../../itt/msicd/reference/ICON.htm">ICON</A> or <A HREF="../../itt/msicd/reference/TYPELIB.htm">TYPELIB</A> element, while a regular JavaBean does not require these elements.

<P>The following is a sample description of an ActiveX control wrapped as a JavaBean.

<PRE>&lt;msicd::JAVA&gt;

    &lt;NAMESPACE&gt;some-namespace-string&lt;/NAMESPACE&gt;

    &lt;PACKAGE NAME="com.ms.JPMBrowser" VERSION="1,0,0,0"&gt;
        &lt;CLASS NAME="Browserbean" CLASSID="{383807B5-2C60-11D0-A31D-00AA00B92C04}"&gt;
            &lt;ISBEAN /&gt;
            &lt;ICON FILENAME="Browser.ico" /&gt;
            &lt;TYPELIB CLASSID="{...}" /&gt;
        &lt;/CLASS&gt;
    &lt;/PACKAGE&gt;
    &lt;IMPLEMENTATION /&gt;
&lt;/msicd::JAVA&gt;

</PRE>

<H3><A NAME="Creating_a_Distribut">Creating a distribution unit</A></H3>

<P>The distribution unit contains the OSD file and the files that belong to an application. These files are compressed using the cabinet (CAB) compression format. The CAB file then must be digitally signed by a certificate authority. For more information on CABs, see the CAB SDK, which is provided as a self-extracting executable file (Cab-SDK.exe) in the \bin directory of the Internet Client SDK.

<P>There are three ways to package a distribution unit:

<UL>
<LI>Only the OSD file in the CAB file.
<LI>The OSD file and application files in the CAB file.
<LI>The OSD file and another CAB file in the CAB file.
</UL>

<P>Having only the OSD file in the CAB file is the minimal distribution unit possible. The OSD file would indicate the URL of the resource containing the software update in the <A HREF="../../itt/osd/reference/CODEBASE.htm">CODEBASE</A> tag of the OSD file.

<P>The simplest case is to package the OSD file with the program files into the CAB file. In this case, the OSD file does not need a <A HREF="../../itt/osd/reference/CODEBASE.htm">CODEBASE</A> tag in it. When no CODEBASE is given, Internet Explorer automatically looks for the program file in the same CAB file where the OSD file was found. 

<P>When multiple program files are involved, and especially when the program files are separated into multiple subdirectories, it is easier to organize the distribution unit by creating a CAB file that contains the OSD file and another CAB file that contains the program files.


<H2>Related Topics</H2>

<P>For more information on software update channels and OSD, see the following:</p>

<dl>
<dt><a href="../../itt/osd/osd.htm">Open Software Description (OSD)</a>
<dd>Contains more information about OSD and references for all the elements supported by OSD.
<dt><a href="../../itt/msicd/icd.htm">Internet Component Download</a>
<dd>Contains information on the mechanism that handles the download and installation of software through the Internet.
</dl>

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>