<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ListView_SetItemState</TITLE>

<META NAME=MS-HKWD CONTENT="ListView_SetItemState">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Common controls">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ListView_SetItemState"></A>
<!--NAV_LINKS_START-->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="ListView_SetItemState"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="ListView_SetItemState"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../RefList.htm#listview_listview">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ListView_SetItemPosition32.htm">ListView_SetItemPosition32</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ListView_SetItemText.htm">ListView_SetItemText</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>ListView_SetItemState</H1>
<BR CLEAR=ALL>
<PRE>BOOL WINAPI ListView_SetItemState(
    HWND hwnd, &#009;&#009;
    int i, &#009;&#009;
    UINT state, &#009;&#009;
    UINT mask&#009;&#009;
);&#009;&#009;
</PRE>
<P>Changes the state of an item in a list view control. You can use this macro or send the <A HREF="../messages/LVM_SETITEMSTATE.htm#LVM_SETITEMSTATE">LVM_SETITEMSTATE</A> message explicitly. 
<UL><LI>No return value. 

</UL>
<DL><DT><I>hwnd</I> 
 </DT><DD>Handle to the list view control.
</DD><DT><I>i</I>
 </DT><DD>Index of the list view item.&nbsp;&nbsp;&nbsp;If this parameter is -1, then the state change is applied to all items.
</DD><DT><I>state</I> 
 </DT><DD>New state bits for the item. The <I>mask</I> parameter indicates the valid bits of the <I>state</I> parameter. The macro ignores bits in the <I>state</I> parameter if the corresponding bit is not set in the <I>mask</I> parameter.
 <P>The low-order byte contains a set of bit flags that indicate the item's state. This byte can be a combination of the following values:
<TABLE>
<TR><TD>LVIS_CUT
 </TD><TD>The item is marked for a cut-and-paste operation.</TD></TR><TR><TD>LVIS_DROPHILITED
 </TD><TD>The item is highlighted as a drag-and-drop target.</TD></TR><TR><TD>LVIS_FOCUSED
 </TD><TD>The item has the focus, so it is surrounded by a standard focus rectangle. Although more than one item may be selected, only one item can have the focus.</TD></TR><TR><TD>LVIS_SELECTED
 </TD><TD>The item is selected. The appearance of a selected item depends on whether it has the focus and also on the system colors used for selection.</TD></TR></TABLE>
<P>Bits 8 through 11 of the <I>state</I> parameter specify the one-based index of an overlay image in the control's image lists. Both the full-sized icon image list and the small icon image list can have overlay images. The overlay image is superimposed over the item's icon image. If these bits are zero, the item has no overlay image. To isolate these bits, use the LVIS_OVERLAYMASK mask. To specify an overlay index, use the <A HREF="../../imagelist/macros/INDEXTOOVERLAYMASK.htm#INDEXTOOVERLAYMASK">INDEXTOOVERLAYMASK</A> macro.
 <P>Bits 12 through 15 of the <I>state</I> parameter specify the one-based index of an image in the control's state image list. The state image is displayed next to an item's icon to indicate an application-defined state. If these bits are zero, the item has no state image. To isolate these bits, use the LVIS_STATEIMAGEMASK mask. To specify a state image index, use the <A HREF="../../common/macros/INDEXTOSTATEIMAGEMASK.htm#INDEXTOSTATEIMAGEMASK">INDEXTOSTATEIMAGEMASK</A> macro.
</DD><DT><I>mask</I>
 </DT><DD>Bits of the <I>state</I> parameter that you want to set or clear. You can use <B>ListView_SetItemState</B> both to set and to clear bits. To set an item's overlay image index, set the LVIS_OVERLAYMASK bits. To set an item's state image index, set the LVIS_STATEIMAGEMASK bits. 
</DD></DL>
<P>An item's state value includes a set of bit flags that indicate the item's state. The state value can also include image list indexes that indicate the item's state image and overlay image. 

<P>The <I>mask</I> parameter specifies the state bits you want to modify, and the <I>state</I> parameter specifies the new value for those bits. To set a bit in the item's internal state, set it in both the <I>mask</I> and <I>state</I> parameters. To clear a bit in the item's internal state, set it in the <I>mask</I> parameter and clear it in the <I>state</I> parameter. To leave a bit unchanged in the item's internal state, clear it in the <I>mask</I> parameter.

<P>See also <A HREF="ListView_GetItemState.htm#ListView_GetItemState">ListView_GetItemState</A>

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>