<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPSHEETHEADER</TITLE>

<META NAME=MS-HKWD CONTENT="PROPSHEETHEADER">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Common controls">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="PROPSHEETHEADER"></A>
<!--NAV_LINKS_START-->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="PROPSHEETHEADER"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="PROPSHEETHEADER"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../PropSheet.htm#ch_prpsheet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Structures.htm">Property Sheet Structures</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="PROPSHEETPAGE.htm">PROPSHEETPAGE</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>PROPSHEETHEADER</H1>
<BR CLEAR=ALL>
<PRE>typedef struct _PROPSHEETHEADER {
    DWORD dwSize;
    DWORD dwFlags;
    HWND  hwndParent;
    HINSTANCE hInstance;
    union {
        HICON hIcon;
        LPCTSTR pszIcon;
        };
    LPCSTR pszCaption;
    UINT nPages;
    union {
        UINT nStartPage;
        LPCTSTR pStartPage;
        };
    union {
        LPCPROPSHEETPAGE ppsp;
        HPROPSHEETPAGE FAR *phpage;
        };
    PFNPROPSHEETCALLBACK pfnCallback;

#if (_WIN32_IE &gt;= 0x0400)
    union {
        HBITMAP hbmWatermark;
        LPCTSTR pszbmWatermark;
        };
    HPALETTE hplWatermark;
    union {
        HBITMAP hbmHeader; 
        LPCSTR pszbmHeader;
        };
#endif
} PROPSHEETHEADER, FAR *LPPROPSHEETHEADER;
</PRE>
<P>Defines the frame and pages of a property sheet.

<DL><DT><B>dwSize</B>
 </DT><DD>Size, in bytes, of this structure.
</DD><DT><B>dwFlags</B>
 </DT><DD>Flags that indicate which options to use when creating the property sheet page. This member can be a combination of the following values:
 <TABLE>
<TR><TD>PSH_DEFAULT
 </TD><TD>Uses the default meaning for all structure members.
 </TD></TR><TR><TD>PSH_HASHELP
 </TD><TD>Displays the property sheet Help button. The Help button is enabled only when the PSP_HASHELP flag is set in the <A HREF="PROPSHEETPAGE.htm#PROPSHEETPAGE">PROPSHEETPAGE</A> structure for the active page. If any of the initial property sheet pages set the PSP_HASHELP flag, the Help button is automatically displayed regardless of the PSH_HASHELP flag. However, PSH_HASHELP is useful when none of the initial pages set PSP_HASHELP, but pages added later might.
 </TD></TR><TR><TD>PSH_HEADER
 </TD><TD><B>Version 4.71</B>. Indicates that a header bitmap will be used. If this value does not include PSH_USEHBMHEADER, the header bitmap is obtained from <B>pszbmHeader</B>. If this value includes PSH_USEHBMHEADER, the header bitmap is obtained from <B>hbmHeader</B>. This flag is ignored if PSH_WIZARD97 is not included.
 </TD></TR><TR><TD>PSH_MODELESS
 </TD><TD>Causes the <A HREF="../functions/PropertySheet.htm#PropertySheet">PropertySheet</A> function to create the property sheet as a modeless dialog instead of as a modal dialog. When this flag is set, <B>PropertySheet</B> returns immediately after the dialog is created, and the return value from <B>PropertySheet</B> is the window handle to the property sheet dialog.
 </TD></TR><TR><TD>PSH_NOAPPLYNOW
 </TD><TD>Removes the Apply Now button.
 </TD></TR><TR><TD>PSH_PROPSHEETPAGE
 </TD><TD>Uses <B>ppsp</B> and ignores <B>phpage</B> when creating the pages for the property sheet.
 </TD></TR><TR><TD>PSH_PROPTITLE
 </TD><TD>Displays the string "Properties for", followed by the string specified by <B>pszCaption</B>, in the title bar of the property sheet. 
 </TD></TR><TR><TD>PSH_RTLREADING
 </TD><TD>Displays the title of the property sheet dialog using right-to-left reading order on Hebrew or Arabic systems.
 </TD></TR><TR><TD>PSH_STRETCHWATERMARK
 </TD><TD><B>Version 4.71</B>. Stretches the bitmap to fit the background of the property sheet instead of tiling the watermark and/or header bitmap. This flag is ignored if PSH_WIZARD97 and PSH_WATERMARK or PSH_HEADER are not included.
 </TD></TR><TR><TD>PSH_USECALLBACK
 </TD><TD>Calls the function specified by <B>pfnCallback</B> when initializing the property sheet defined by this structure.
 </TD></TR><TR><TD>PSH_USEHBMHEADER
 </TD><TD><B>Version 4.71</B>. Obtains the header bitmap from <B>hbmHeader</B> instead of <B>pszbmHeader</B>. This flag is ignored if PSH_WIZARD97 and PSH_HEADER are not included.
 </TD></TR><TR><TD>PSH_USEHBMWATERMARK
 </TD><TD><B>Version 4.71</B>. Obtains the watermark bitmap from <B>hbmWatermark</B> instead of <B>pszbmWatermark</B>. This flag is ignored if PSH_WIZARD97 and PSH_WATERMARK are not included.
 </TD></TR><TR><TD>PSH_USEHICON
 </TD><TD>Uses <B>hIcon</B> as the small icon in the title bar of the property sheet dialog box.
 </TD></TR><TR><TD>PSH_USEHPLWATERMARK
 </TD><TD><B>Version 4.71</B>. Obtains the HPALETTE for drawing the watermark bitmap and/or header bitmap from <B>hplWatermark</B> instead of using the default palette. This flag is ignored if PSH_WIZARD97 and PSH_WATERMARK or PSH_HEADER are not included.
 </TD></TR><TR><TD>PSH_USEICONID
 </TD><TD>Uses <B>pszIcon</B> as the name of the icon resource to load and use as the small icon in the title bar of the property sheet dialog box.
 </TD></TR><TR><TD>PSH_USEPAGELANG
 </TD><TD><B>Version 4.71</B>. The language for the property sheet will be taken from the first page's resource.
 </TD></TR><TR><TD>PSH_USEPSTARTPAGE
 </TD><TD>Uses <B>pStartPage</B> and ignores <B>nStartPage</B> when displaying the initial page of the property sheet.
 </TD></TR><TR><TD>PSH_WATERMARK
 </TD><TD><B>Version 4.71</B>. Specifies that a watermark bitmap will be used. If this value does not include PSH_USEHBMWATERMARK, the watermark bitmap is obtained from <B>pszbmWatermark</B>. If this value includes PSH_USEHBMWATERMARK, the header bitmap is obtained from <B>hbmWatermark</B>. This flag is ignored if PSH_WIZARD97 is not included.
 </TD></TR><TR><TD>PSH_WIZARD
 </TD><TD>Creates a wizard property sheet.
 </TD></TR><TR><TD>PSH_WIZARD97
 </TD><TD>Creates a wizard property sheet that allows a header and/or watermark bitmap to be displayed in the background. This and all Wizard 97-associated flags are not currently implemented. 
 </TD></TR><TR><TD>PSH_WIZARDCONTEXTHELP
 </TD><TD>Adds a system menu to the wizard property sheet. This flag is ignored if PSH_WIZARD or PSH_WIZARD97 is not included.
 </TD></TR><TR><TD>PSH_WIZARDHASFINISH
 </TD><TD>Always displays the Finish button on the wizard. This flag is ignored if PSH_WIZARD or PSH_WIZARD97 is not included.
 </TD></TR></TABLE>
</DD><DT><B>hwndParent</B>
 </DT><DD>Handle to the property sheet's owner window.
</DD><DT><B>hInstance</B>
 </DT><DD>Handle to the instance from which to load the icon or title string resource. If <B>pszIcon</B> or <B>pszCaption</B> identifies a resource to load, this member must be specified.
</DD><DT><B>hIcon</B>
 </DT><DD>Handle to the icon to use as the small icon in the title bar of the property sheet dialog box. If <B>dwFlags</B> does not include PSH_USEHICON, this member is ignored.
</DD><DT><B>pszIcon</B>
 </DT><DD>Icon resource to use as the small icon in the title bar of the property sheet dialog box. This member can specify either the identifier of the icon resource or the address of the string that specifies the name of the icon resource. If <B>dwFlags</B> does not include PSH_USEICONID, this member is ignored.
</DD><DT><B>pszCaption</B>
 </DT><DD>Title of the property sheet dialog box. This member can specify either the identifier of a string resource or the address of a string that specifies the title. If <B>dwFlags</B> includes PSH_PROPTITLE, the string "Properties for" is inserted at the beginning of the title.
</DD><DT><B>nPages</B>
 </DT><DD>Number of elements in the <B>phpage</B> array.
</DD><DT><B>nStartPage</B>
 </DT><DD>Zero-based index of the initial page that appears when the property sheet dialog box is created.
</DD><DT><B>pStartPage</B>
 </DT><DD>Name of the initial page that appears when the property sheet dialog box is created. This member can specify either the identifier of a string resource or the address of a string that specifies the name.
</DD><DT><B>ppsp</B>
 </DT><DD>Address of an array of <A HREF="PROPSHEETPAGE.htm#PROPSHEETPAGE">PROPSHEETPAGE</A> structures that define the pages in the property sheet. If <B>dwFlags</B> does not include PSH_PROPSHEETPAGE, this member is ignored.
</DD><DT><B>phpage</B>
 </DT><DD>Address of an array of handles to the property sheet pages. Each handle must have been created by a previous call to the <A HREF="../functions/CreatePropertySheetPage.htm#CreatePropertySheetPage">CreatePropertySheetPage</A> function. If <B>dwFlags</B> includes PSH_PROPSHEETPAGE, this member is ignored.
</DD><DT><B>pfnCallback</B>
 </DT><DD>Address of an application-defined callback function that is called when the property sheet is initialized. For more information about the callback function, see the description of the <A HREF="../functions/PropSheetProc.htm#PropSheetProc">PropSheetProc</A> function. If <B>dwFlags</B> does not include PSH_USECALLBACK, this member is ignored.
</DD><DT><B>hbmWatermark</B>
 </DT><DD><B>Version 4.71</B>. Handle to the watermark bitmap. If <B>dwFlags</B> does not include PSH_USEHBMWATERMARK, this member is ignored.
</DD><DT><B>pszbmWatermark</B>
 </DT><DD><B>Version 4.71</B>. Bitmap resource to use as the watermark. This member can specify either the identifier of the bitmap resource or the address of the string that specifies the name of the bitmap resource. If <B>dwFlags</B> includes PSH_USEHBMWATERMARK, this member is ignored.
</DD><DT><B>hplWatermark</B>
 </DT><DD><B>Version 4.71</B>. HPALETTE used for drawing the watermark bitmap and/or header bitmap. If <B>dwFlags</B> does not include PSH_USEHPLWATERMARK, this member is ignored.
</DD><DT><B>hbmHeader</B>
 </DT><DD><B>Version 4.71</B>. Handle to the header bitmap. If <B>dwFlags</B> does not include PSH_USEHBMHEADER, this member is ignored.
</DD><DT><B>pszbmHeader</B>
 </DT><DD><B>Version 4.71</B>. Bitmap resource to use as the header. This member can specify either the identifier of the bitmap resource or the address of the string that specifies the name of the bitmap resource. If <B>dwFlags</B> includes PSH_USEHBMHEADER, this member is ignored.
</DD></DL>

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>