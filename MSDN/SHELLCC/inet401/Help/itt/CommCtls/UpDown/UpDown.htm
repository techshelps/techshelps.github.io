<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Up-Down Controls</TITLE>

<META NAME=MS-HKWD CONTENT="Up-Down Controls">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Common controls">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_updown"></A>
<!--NAV_LINKS_START-->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Up-Down Controls"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Up-Down Controls"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../CommCtls.htm#book_cc">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../treeview/structures/TVSORTCB.htm">TVSORTCB</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="RefList.htm">Up-Down Control Reference</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Up-Down Controls</H1>
<BR CLEAR=ALL>
<P>An <I>up-down control</I> is a pair of arrow buttons that the user can click to increment or decrement a value, such as a scroll position or a number displayed in a companion control. The value associated with an up-down control is called its <I>current position</I>. An up-down control is most often used with a companion control, which is called a <I>buddy window</I>.


<P><A CLASS=tctop HREF="UpDown.htm#About_Up_Down_Contro"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">About Up-Down Controls</A><BR>
<P><A CLASS=tctop HREF="UpDown.htm#Up_Down_Control_Upda"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Up-Down Control Updates in Internet Explorer</A><BR>
<P><A CLASS=tctop HREF="RefList.htm#updown_UpDown"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Up-Down Control Reference</A><BR>
<!--************************************************************--><H2><A NAME="About_Up_Down_Contro">About Up-Down Controls</A></H2>
<P>To the user, an up-down control and its buddy window often look like a single control. You can specify that an up-down control automatically position itself next to its buddy window and that it automatically set the caption of the buddy window to its current position. For example, you can use an up-down control with an edit control to prompt the user for numeric input. The following illustration shows an up-down control with an edit control as its buddy window, a combination that is sometimes referred to as a <I>spinner control</I>.

<P><IMG SRC="../../../art/ud_scrn1.gif" WIDTH="79" HEIGHT="19" ALT="Up-down control with an edit control as its buddy window." >

<P>An up-down control without a buddy window functions as a sort of simplified scroll bar. For example, a tab control sometimes displays an up-down control to enable the user to scroll additional tabs into view. The following illustration shows an up-down control in the upper-right corner of a tab control.

<P><IMG SRC="../../../art/ud_scrn2.gif" WIDTH="280" HEIGHT="95" ALT="Up-down control in the upper-right corner of a tab control." >

<P>You can create an up-down control and specify its buddy window in several ways. The UPDOWN_CLASS value specifies an up-down control's window class. You can specify this window class in a dialog box template or in a call to the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>CreateWindowEx</A> function. Another way is to use the <A HREF="functions/CreateUpDownControl.htm#CreateUpDownControl">CreateUpDownControl</A> function to create an up-down control and, at the same time, specify its buddy window, current position, and minimum and maximum positions. 

<P>The UPDOWN_CLASS window class is registered when the common controls dynamic-link library (DLL) is loaded. If you create an up-down control without using the <A HREF="functions/CreateUpDownControl.htm#CreateUpDownControl">CreateUpDownControl</A> function, you must ensure that the DLL is loaded. You can do so by using the <A HREF="../common/functions/InitCommonControls.htm#InitCommonControls">InitCommonControls</A> function. 

<P><A HREF="functions/CreateUpDownControl.htm#CreateUpDownControl">CreateUpDownControl</A> enables you to specify a buddy window. If you create an up-down control without using this function, you can assign a buddy window by specifying the <A HREF="Styles.htm#UDS_AUTOBUDDY">UDS_AUTOBUDDY</A> window style or by using the <A HREF="messages/UDM_SETBUDDY.htm#UDM_SETBUDDY">UDM_SETBUDDY</A> message. If <B>UDS_AUTOBUDDY</B> is specified, the up-down control automatically selects the previous window in the z-order as its buddy window. This window might be the previous control in a dialog box template. You can use <B>UDM_SETBUDDY</B> to assign a specific buddy window to an up-down control. To determine an up-down control's current buddy window, use the <A HREF="messages/UDM_GETBUDDY.htm#UDM_GETBUDDY">UDM_GETBUDDY</A> message. An up-down control and its buddy window must have the same parent window. 

<P>An up-down control notifies its parent window when its current position changes by sending it a <A HREF="notifications/UDN_DELTAPOS.htm#UDN_DELTAPOS">UDN_DELTAPOS</A> notification message and a
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>WM_VSCROLL</A> or
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>WM_HSCROLL</A> message. A vertical up-down control (which does not have the <A HREF="Styles.htm#UDS_HORZ">UDS_HORZ</A> style) sends a <B>WM_VSCROLL</B> message. A horizontal up-down control (which has the <B>UDS_HORZ</B> style) sends a <B>WM_HSCROLL</B> message. 

<H3><A NAME="About_Up_Down_Contro">About Up-Down Control Styles</A></H3>
<P>Using window styles, you can manipulate characteristics of an up-down control, such as how it positions itself relative to its buddy window, whether it sets the text of its buddy window, and whether it processes the <SMALL>UP ARROW</SMALL> and <SMALL>DOWN ARROW</SMALL> keys.

<P>An up-down control with the <A HREF="Styles.htm#UDS_ALIGNLEFT">UDS_ALIGNLEFT</A> or <A HREF="Styles.htm#UDS_ALIGNRIGHT">UDS_ALIGNRIGHT</A> style aligns with the left or right edge of its buddy window. The width of the buddy window is decreased to accommodate the width of the up-down control.

<P>An up-down control with the <A HREF="Styles.htm#UDS_SETBUDDYINT">UDS_SETBUDDYINT</A> style sets the caption of its buddy window whenever the current position changes. The control inserts a thousands separator between every three digits of a decimal string unless the <A HREF="Styles.htm#UDS_NOTHOUSANDS">UDS_NOTHOUSANDS</A> style is specified. If the buddy window is a list box, an up-down control sets its current selection instead of its caption.

<P>You can specify the <A HREF="Styles.htm#UDS_ARROWKEYS">UDS_ARROWKEYS</A> style to provide a keyboard interface for an up-down control. If this style is specified, the control processes the <SMALL>UP ARROW</SMALL> and <SMALL>DOWN ARROW</SMALL> keys. The control also subclasses the buddy window so that it can process these keys when the buddy window has the focus.

<P>If you use an up-down control for horizontal scrolling, you can specify the <A HREF="Styles.htm#UDS_HORZ">UDS_HORZ</A> style. This style causes the up-down control's arrows to point left and right instead of up and down.

<P>By default, the current position does not change if the user attempts to increment it or decrement it beyond the maximum or minimum value. You can change this behavior by using the <A HREF="Styles.htm#UDS_WRAP">UDS_WRAP</A> style, so the position "wraps" to the opposite extreme. For example, incrementing past the upper limit wraps the position back to the lower limit.

<H3><A NAME="Position_and_Acceler">Position and Acceleration</A></H3>
<P>After an up-down control is created, you can change the control's current position, minimum position, and maximum position by sending messages. You can also change the radix base used to display the current position in the buddy window and the rate at which the current position changes when the up or down arrow is clicked.

<P>To retrieve the current position of an up-down control, use the <A HREF="messages/UDM_GETPOS.htm#UDM_GETPOS">UDM_GETPOS</A> message. For an up-down control with a buddy window, the current position is the number in the buddy window's caption. Because the caption may have changed (for example, the user may have edited the text of an edit control), the up-down control retrieves the current caption and updates its current position accordingly.

<P>The buddy window's caption may be either a decimal or hexadecimal string, depending on the radix base (that is, either base 10 or 16) of the up-down control. You can set the radix base by using the <A HREF="messages/UDM_SETBASE.htm#UDM_SETBASE">UDM_SETBASE</A> message and retrieve the radix base by using the <A HREF="messages/UDM_GETBASE.htm#UDM_GETBASE">UDM_GETBASE</A> message.

<P>The <A HREF="messages/UDM_SETPOS.htm#UDM_SETPOS">UDM_SETPOS</A> message sets the current position of a buddy window. Note that unlike a scroll bar, an up-down control automatically changes its current position when the up and down arrows are clicked. An application, therefore, does not need to set the current position when processing the
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>WM_VSCROLL</A> or
<object id="hhal_7" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_7.Click()>WM_HSCROLL</A> message.

<P>You can change the minimum and maximum positions of an up-down control by using the <A HREF="messages/UDM_SETRANGE.htm#UDM_SETRANGE">UDM_SETRANGE</A> message. The maximum position may be less than the minimum, and in that case clicking the up arrow button <I>decreases</I> the current position. To put it another way, up means moving towards the maximum position. To retrieve the minimum and maximum positions for an up-down control, use the <A HREF="messages/UDM_GETRANGE.htm#UDM_GETRANGE">UDM_GETRANGE</A> message.

<P>You can control the rate at which the position changes when the user holds down an arrow button by setting the up-down control's <I>acceleration</I>. The acceleration is defined by an array of <A HREF="structures/UDACCEL.htm#UDACCEL">UDACCEL</A> structures. Each structure specifies a time interval and the number of units by which to increment or decrement at the end of that interval. To set the acceleration, use the <A HREF="messages/UDM_SETACCEL.htm#UDM_SETACCEL">UDM_SETACCEL</A> message. To retrieve acceleration information, use the <A HREF="messages/UDM_GETACCEL.htm#UDM_GETACCEL">UDM_GETACCEL</A> message.

<H3><A NAME="Default_Up_Down_Cont">Default Up-Down Controls Message Processing</A></H3>
<P>This section describes the standard Windows messages processed by an up-down control. 


<TABLE>
<TR><TD><B>Message
 </B></TD><TD><B>Processing performed
</B></TD></TR><TR><TD>WM_CREATE
 </TD><TD>Allocates and initializes a private data structure and saves its address as window data.</TD></TR><TR><TD>WM_DESTROY
 </TD><TD>Frees data allocated during WM_CREATE processing.</TD></TR><TR><TD>WM_ENABLE
 </TD><TD>Invalidates the window.</TD></TR><TR><TD>WM_KEYDOWN
 </TD><TD>Changes the current position in the case of an <SMALL>UP ARROW</SMALL> or <SMALL>DOWN ARROW</SMALL> key.</TD></TR><TR><TD>WM_KEYUP
 </TD><TD>Completes the position change. </TD></TR><TR><TD>WM_LBUTTONDOWN
 </TD><TD>Captures the mouse. If the buddy window is an edit control or list box, it sets the focus to the buddy window. If the mouse is over the up or down button, it begins changing the position and sets a timer.</TD></TR><TR><TD>WM_LBUTTONUP
 </TD><TD>Completes the position change and releases the mouse capture if the up-down control has captured the mouse. If the buddy window is an edit control, it selects all the text in the edit control.</TD></TR><TR><TD>WM_PAINT
 </TD><TD>Paints the up-down control. If the <I>wParam</I> parameter is non-NULL, the control assumes that the value is an HDC and paints using that device context.</TD></TR><TR><TD>WM_TIMER
 </TD><TD>Changes the current position if the mouse is being held down over a button and a sufficient interval has elapsed.</TD></TR></TABLE>
<H2><A NAME="Up_Down_Control_Upda">Up-Down Control Updates in Internet Explorer</A></H2>
<P>Up-down controls in Microsoft&#174; Internet Explorer support the following new feature.

<DL>
<DT><B>Full 32-bit Range</B>
 </DT><DD>The up-down control now supports a full 32-bit range. The <A HREF="messages/UDM_SETRANGE32.htm#UDM_SETRANGE32">UDM_SETRANGE32</A> and <A HREF="messages/UDM_GETRANGE32.htm#UDM_GETRANGE32">UDM_GETRANGE32</A> messages have been added to support this feature. The up-down control uses signed integers for its range, so it is necessary to set the range from -0x7FFFFFFF to +0x7FFFFFFF to utilize the full 32-bit range.
</DD></DL>
<!-- ************************************************** -->
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>