<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Drag List Boxes</TITLE>

<META NAME=MS-HKWD CONTENT="Drag List Boxes">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Common controls">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="Drag_List_Boxes"></A>
<!--NAV_LINKS_START-->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Drag List Boxes"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Drag List Boxes"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../CommCtls.htm#book_cc">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../datetime/structures/NMDATETIMEWMKEYDOWN.htm">NMDATETIMEWMKEYDOWN</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="RefList.htm">Drag List Box Reference</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Drag List Boxes</H1>
<BR CLEAR=ALL>
<P>A <I>drag list box</I> is a special type of list box that enables the user to drag items from one position to another. An application can use a drag list box to display strings in a particular sequence and allow the user to change the sequence by dragging the items into position.


<P><A CLASS=tctop HREF="DragLB.htm#Using_Drag_List_Boxe"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Using Drag List Boxes</A><BR>
<P><A CLASS=tctop HREF="RefList.htm#dragLB_DragLB"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Drag List Box Reference</A><BR>
<!--************************************************************--><H2><A NAME="Using_Drag_List_Boxe">Using Drag List Boxes</A></H2>
<P>Drag list boxes have the same window styles and process the same messages as standard list boxes. To create a drag list box, first create a standard list box and then call the <A HREF="functions/MakeDragList.htm#MakeDragList">MakeDragList</A> function. To convert a list box in a dialog box to a drag list box, you can call <B>MakeDragList</B> when the WM_INITDIALOG message is processed. 

<H3><A NAME="Drag_List_Box_Messag">Drag List Box Messages</A></H3>
<P>A drag list box notifies the parent window of drag events by sending it a drag list message. The parent window must process the drag list message.

<P>The drag list box registers this message when the <A HREF="functions/MakeDragList.htm#MakeDragList">MakeDragList</A> function is called. To get the message identifier (numeric value) of the drag list message, call the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>RegisterWindowMessage</A> function and specify the DRAGLISTMSGSTRING value.

<P>The <I>wParam</I> parameter of the drag list message is the control identifier for the drag list box. The <I>lParam</I> parameter is the address of a <A HREF="structures/DRAGLISTINFO.htm#DRAGLISTINFO">DRAGLISTINFO</A> structure, which contains the notification code for the drag event and other information. The return value of the message depends on the notification.

<H3><A NAME="Drag_List_Box_Notifi">Drag List Box Notification Messages</A></H3>
<P>The drag list notification message, which is identified by the <B>uNotification</B> member of the <A HREF="structures/DRAGLISTINFO.htm#DRAGLISTINFO">DRAGLISTINFO</A> structure included with the drag list message, can be <A HREF="notifications/DL_BEGINDRAG.htm#DL_BEGINDRAG">DL_BEGINDRAG</A>, <A HREF="notifications/DL_DRAGGING.htm#DL_DRAGGING">DL_DRAGGING</A>, <A HREF="notifications/DL_CANCELDRAG.htm#DL_CANCELDRAG">DL_CANCELDRAG</A>, or <A HREF="notifications/DL_DROPPED.htm#DL_DROPPED">DL_DROPPED</A>.

<P>The <A HREF="notifications/DL_BEGINDRAG.htm#DL_BEGINDRAG">DL_BEGINDRAG</A> notification message is sent when the cursor is on a list item and the user clicks the left mouse button. The parent window can return TRUE to begin the drag operation or FALSE to disallow dragging. In this way, the parent window can enable dragging for some list items and disable it for others. You can determine which list item is at the specified location by using the <A HREF="functions/LBItemFromPt.htm#LBItemFromPt">LBItemFromPt</A> function.

<P>If dragging is in effect, the <A HREF="notifications/DL_DRAGGING.htm#DL_DRAGGING">DL_DRAGGING</A> notification message is sent whenever the mouse is moved, or at regular intervals if the mouse is not being moved. The parent window should first determine the list item under the cursor by using <A HREF="functions/LBItemFromPt.htm#LBItemFromPt">LBItemFromPt</A> and then draw the insert icon by using the <A HREF="functions/DrawInsert.htm#DrawInsert">DrawInsert</A> function. By specifying TRUE for the <I>bAutoScroll</I> parameter of <B>LBItemFromPt</B>, you can cause the list box to scroll by one line if the cursor is above or below its client area. The value you return for this notification specifies the type of mouse cursor that the drag list box should set.

<P>The <A HREF="notifications/DL_CANCELDRAG.htm#DL_CANCELDRAG">DL_CANCELDRAG</A> notification message is sent if the user cancels a drag operation by clicking the right mouse button or pressing the <SMALL>ESC</SMALL> key. The <A HREF="notifications/DL_DROPPED.htm#DL_DROPPED">DL_DROPPED</A> notification message is sent if the user completes a drag operation by releasing the left mouse button, even if the cursor is not over a list item. The drag list box releases the mouse capture before sending either notification. The return value of these two notifications is ignored.

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>