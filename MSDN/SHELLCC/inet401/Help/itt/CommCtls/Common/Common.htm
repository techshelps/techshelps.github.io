<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Common Controls</TITLE>

<META NAME=MS-HKWD CONTENT="Common Controls">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Common controls">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="Common_Controls"></A>
<!--NAV_LINKS_START-->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Common Controls"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Common Controls"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../CommCtls.htm#book_cc">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../CommCtls.htm">Common Controls</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="refs.htm">Common Control Reference</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Common Controls</H1>
<BR CLEAR=ALL>
<P>The <I>common controls</I> are a set of windows that are implemented by the common control library, which is a dynamic-link library (DLL) included with the Microsoft&#174; Windows&#174; operating system. Like other control windows, a common control is a child window that an application uses in conjunction with another window to perform I/O tasks. 
<P><A CLASS=tctop HREF="Common.htm#Using_Common_Control"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Using Common Controls</A><BR>
<P><A CLASS=tctop HREF="Common.htm#Common_Control_Updat"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Common Control Updates in Internet Explorer</A><BR>
<P><A CLASS=tctop HREF="refs.htm#cc_refs"><IMG SRC="../../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Common Control Reference</A><BR>
<H2><A NAME="Using_Common_Control">Using Common Controls</A></H2>
<P>Most common controls belong to a window class defined in the common control DLL. The window class and the corresponding window procedure define the properties, appearance, and behavior of the control. To ensure that the common control DLL is loaded, include the <A HREF="functions/InitCommonControls.htm#InitCommonControls">InitCommonControls</A> function in your application. You create a common control by specifying the name of the window class when calling the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>CreateWindowEx</A> function or by specifying the appropriate class name in a dialog box template. 

 
<H3><A NAME="cc_dll_version">Common Control DLL Versions</A></H3>
<P>Because of ongoing enhancements, different versions of Comctl32.dll implement different features. Throughout this document, programming elements are marked with a version number. This version number indicates that the programming element is implemented in that version and later versions of Comctl32.dll. If no version number is specified, the programming element is implemented in all versions. The following table outlines the different versions of Comctl32.dll and the distribution platform.

<P><TABLE>
<TR><TD><B>Version</B></TD>
<TD><B>Distribution platform</B></TD></TR>
<TR><TD>4.00</TD>
<TD>Microsoft&#174; Windows&#174; 95/Windows NT&#174; 4.0</TD></TR>
<TR><TD>4.70</TD>
<TD>Microsoft&#174; Internet Explorer 3.x</TD></TR>
<TR><TD>4.71</TD>
<TD>Microsoft&#174; Internet Explorer 4.0</TD></TR>
<TR><TD>4.72</TD>
<TD>Microsoft&#174; Internet Explorer 4.01</TD></TR>
</TABLE>
<P>The following function retrieves the major and minor version numbers of the Comctl32.dll that is installed on the local system.

<PRE>#include &lt;windows.h&gt;
#include &lt;shlwapi.h&gt;

HRESULT GetComCtlVersion(LPDWORD pdwMajor, LPDWORD pdwMinor)
{
HINSTANCE   hComCtl;

if(   IsBadWritePtr(pdwMajor, sizeof(DWORD)) || 
      IsBadWritePtr(pdwMinor, sizeof(DWORD)))
   return E_INVALIDARG;

//load the DLL
hComCtl = LoadLibrary(TEXT("comctl32.dll"));

if(hComCtl)
   {
   HRESULT           hr = S_OK;
   DLLGETVERSIONPROC pDllGetVersion;
   
   /*
   You must get this function explicitly because earlier versions of the DLL 
   don't implement this function. That makes the lack of implementation of the 
   function a version marker in itself.
   */
   pDllGetVersion = (DLLGETVERSIONPROC)GetProcAddress(hComCtl, TEXT("DllGetVersion"));
   
   if(pDllGetVersion)
      {
      DLLVERSIONINFO    dvi;
      
      ZeroMemory(&amp;dvi, sizeof(dvi));
      dvi.cbSize = sizeof(dvi);
   
      hr = (*pDllGetVersion)(&amp;dvi);
      
      if(SUCCEEDED(hr))
         {
         *pdwMajor = dvi.dwMajorVersion;
         *pdwMinor = dvi.dwMinorVersion;
         }
      else
         {
         hr = E_FAIL;
         }   
      }
   else
      {
      /*
      If GetProcAddress failed, then the DLL is a version previous to the one 
      shipped with IE 3.x.
      */
      *pdwMajor = 4;
      *pdwMinor = 0;
      }
   
   FreeLibrary(hComCtl);

   return hr;
   }

return E_FAIL;
}
</PRE>
<H4><A NAME="Structure_sizes_for_">Structure sizes for different common control versions</A></H4>
<P>Ongoing enhancements to common controls has resulted in the need to extend many of the structures. This results in the size of the structures changing between different versions of Commctrl.h. Because most of the common control structures take a structure size as one of the parameters, this can result in a message or function failing if the size is not recognized. To remedy this, structure size constants have been defined to aid in targeting different version of Comctl32.dll. The following list defines the new structure size constants.

<P><TABLE>
<TR><TD>HDITEM_V1_SIZE</TD>
<TD>The size of the <A HREF="../header/structures/HDITEM.htm#HD_ITEM">HDITEM</A> structure in version 4.00.</TD></TR>
<TR><TD>LVCOLUMN_V1_SIZE</TD>
<TD>The size of the <A HREF="../listview/structures/LVCOLUMN.htm#LV_COLUMN">LVCOLUMN</A> structure in version 4.00.</TD></TR>
<TR><TD>LVHITTESTINFO_V1_SIZE</TD>
<TD>The size of the <A HREF="../listview/structures/LVHITTESTINFO.htm#LV_HITTESTINFO">LVHITTESTINFO</A> structure in version 4.00.</TD></TR>
<TR><TD>LVITEM_V1_SIZE</TD>
<TD>The size of the <A HREF="../listview/structures/LVITEM.htm#LV_ITEM">LVITEM</A> structure in version 4.00.</TD></TR>
<TR><TD>NMLVCUSTOMDRAW_V3_SIZE</TD>
<TD>The size of the <A HREF="../listview/structures/NMLVCUSTOMDRAW.htm#NMLVCUSTOMDRAW">NMLVCUSTOMDRAW</A> structure in version 4.70.</TD></TR>
<TR><TD>NMTTDISPINFO_V1_SIZE</TD>
<TD>The size of the <A HREF="../tooltip/structures/TOOLTIPTEXT.htm#TOOLTIPTEXT">NMTTDISPINFO</A> structure in version 4.00.</TD></TR>
<TR><TD>NMTVCUSTOMDRAW_V3_SIZE</TD>
<TD>The size of the <A HREF="../treeview/structures/NMTVCUSTOMDRAW.htm#NMTVCUSTOMDRAW">NMTVCUSTOMDRAW</A> structure in version 4.70.</TD></TR>
<TR><TD>PROPSHEETHEADER_V1_SIZE</TD>
<TD>The size of the <A HREF="../propsheet/structures/PROPSHEETHEADER.htm#PROPSHEETHEADER">PROPSHEETHEADER</A> structure in version 4.00.</TD></TR>
<TR><TD>PROPSHEETPAGE_V1_SIZE</TD>
<TD>The size of the <A HREF="../propsheet/structures/PROPSHEETPAGE.htm#PROPSHEETPAGE">PROPSHEETPAGE</A> structure in version 4.00.</TD></TR>
<TR><TD>REBARBANDINFO_V3_SIZE</TD>
<TD>The size of the <A HREF="../rebar/structures/REBARBANDINFO.htm#REBARBANDINFO">REBARBANDINFO</A> structure in version 4.70.</TD></TR>
<TR><TD>TTTOOLINFO_V1_SIZE</TD>
<TD>The size of the <A HREF="../tooltip/structures/TOOLINFO.htm#TOOLINFO">TOOLINFO</A> structure in version 4.00.</TD></TR>
<TR><TD>TVINSERTSTRUCT_V1_SIZE</TD>
<TD>The size of the <A HREF="../treeview/structures/TVINSERTSTRUCT.htm#TV_INSERTSTRUCT">TVINSERTSTRUCT</A> structure in version 4.00.</TD></TR>
</TABLE>
<H3><A NAME="cc_win32_ie">Project Versions</A></H3>
<P>To ensure that your application is compatible with different targeted versions of the common control DLL (Comctl32.dll), a version macro was added to Commctrl.h. This version macro is used to define, exclude, or redefine certain common control definitions for different versions of the DLL. The macro name is <B>_WIN32_IE</B> and you, the developer, are responsible for defining the macro as a hexadecimal number. This version number defines the target version of the application that is using the DLL. The following are the currently available version numbers and the effect each has on your application.

<P><TABLE>
<TR><TD><B>Version</B></TD>
<TD><B>Description</B></TD></TR>
<TR><TD>0x0200</TD>
<TD>The application will be compatible with Comctl32.dll version 4.00 and later. The application will not, however, be able to implement the common control features that were added after version 4.00 of Comctl32.dll.</TD></TR>
<TR><TD>0x0300</TD>
<TD>The application will be compatible with Comctl32.dll version 4.70 and later. The application will not, however, be able to implement the common control features that were added after version 4.70 of Comctl32.dll.</TD></TR>
<TR><TD>0x0400</TD>
<TD>The application will be compatible with Comctl32.dll version 4.71 and later. The application will not, however, be able to implement the common control features that were added after version 4.71 of Comctl32.dll.</TD></TR>
<TR><TD>0x0401</TD>
<TD>The application will be compatible with Comctl32.dll version 4.72 and later. The application will not, however, be able to implement the common control features that were added after version 4.72 of Comctl32.dll.</TD></TR>
</TABLE>
<P>The most effective way to define this macro in your project is to add the following to the compiler directives in your make file (substitute the desired version number for 0x0400): 

<PRE>/D _WIN32_IE=0x0400 
</PRE>
<P>Another method that can be used to define this macro in your project is to add a line similar to the following in your source code <I>before</I> including Commctrl.h (substitute the desired version number for 0x0400):

<PRE>#define _WIN32_IE 0x0400
#include &lt;commctrl.h&gt;
</PRE>
<P>If you do not define this macro in your project, Commctrl.h will automatically define it as 0x0400.

 
<H3><A NAME="Common_Control_Style">Common Control Styles</A></H3>
<P>Each type of common control has a set of control styles that you can use to vary the appearance and behavior of the control. The common control library also includes a set of control styles that apply to two or more types of common controls. The common control styles are described in the <A HREF="Styles.htm#cc_styles">Common Control Styles</A> section.

 
<H3><A NAME="Common_Control_Messa">Common Control Messages</A></H3>
<P>Because common controls are windows, an application can manipulate them by using messages, such as WM_GETFONT or WM_SETTEXT. In addition, the window class of each common control supports a set of control-specific messages that an application can use to manipulate the control. An application can use any of the message sending or posting functions to pass messages to the control. In addition, some common controls have a set of macros that an application can use instead of the sending or posting functions. The macros are typically easier to use than the functions. 

<P>When a change is made to the system color settings, Windows sends a
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>WM_SYSCOLORCHANGE</A> message to all top-level windows. Your top-level window must forward the <B>WM_SYSCOLORCHANGE</B> message to its common controls; otherwise, the controls will not be notified of the color change. This ensures that the colors used by your common controls are consistent with those used by other user interface objects. For example, a toolbar control uses the "3D Objects" color to draw its buttons. If the user changes the 3D Objects color but the <B>WM_SYSCOLORCHANGE</B> message is not forwarded to the toolbar, the toolbar buttons will remain in their original color (or even change to a combination of old and new colors) while the color of other buttons in the system changes.

<H3><A NAME="Common_Control_Notif">Common Control Notification Messages</A></H3>
<P>Common controls are child windows that send notification messages to the parent window when events, such as input from the user, occur in the control. The application relies on these notification messages to determine what action the user wants it to take. Except for trackbars, which use the
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>WM_HSCROLL</A> and
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>WM_VSCROLL</A> messages to notify its parent of changes, common controls send notification messages as <A HREF="messages/WM_NOTIFY.htm#WM_NOTIFY">WM_NOTIFY</A> messages. The <I>lParam</I> parameter of <B>WM_NOTIFY</B> is either the address of an <A HREF="structures/NMHDR.htm#NMHDR">NMHDR</A> structure or the address of a larger structure that includes <B>NMHDR</B> as its first member. The structure contains the notification code and identifies the common control that sent the notification message. The meaning of the remaining structure members, if any, varies depending on the notification code. 

<P><B>Note</B>  Not all controls will send <A HREF="messages/WM_NOTIFY.htm#WM_NOTIFY">WM_NOTIFY</A> messages. In particular, the standard Windows controls (edit controls, combo boxes, list boxes, buttons, scroll bars, and static controls) do not send <B>WM_NOTIFY</B> messages. Consult the documentation for the control to determine if it will send any <B>WM_NOTIFY</B> messages and, if it does, which notification codes it will send.
<P>Each type of common control has a corresponding set of notification codes. The common control library also provides notification codes that can be sent by more than one type of common control. See the documentation for the control of interest to determine which notification codes it will send and what format they take.

 
<H2><A NAME="Common_Control_Updat">Common Control Updates in Internet Explorer</A></H2>
<P>Common controls in Microsoft&#174; Internet Explorer support the following new features.
<DL>
<DT><B>Common Control Initialization</B>
</DT><DD>The common controls are now initialized with the <A HREF="functions/InitCommonControlsEx.htm#InitEx_Function">InitCommonControlsEx</A> function. This function allows you to specify which controls should be initialized for your application instead of initializing all of the controls. The <A HREF="functions/InitCommonControls.htm#InitCommonControls">InitCommonControls</A> function is still supported, but new applications should use <B>InitCommonControlsEx</B>. 
</DD><DT><B>New Common Control Styles</B>
</DT><DD>There are four new common control styles defined. These are <A HREF="Styles.htm#CCS_LEFT">CCS_LEFT</A>, <A HREF="Styles.htm#CCS_RIGHT">CCS_RIGHT</A>, <A HREF="Styles.htm#CCS_VERT">CCS_VERT</A>, and <A HREF="Styles.htm#CCS_NOMOVEX">CCS_NOMOVEX</A>. For more information, see <A HREF="Styles.htm#cc_styles">Common Control Styles</A>.
</DD></DL>

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>