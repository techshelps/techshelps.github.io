<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ImageList_LoadImage</TITLE>

<META NAME=MS-HKWD CONTENT="ImageList_LoadImage">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Common controls">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ImageList_LoadImage"></A>
<!--NAV_LINKS_START-->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="ImageList_LoadImage"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="ImageList_LoadImage"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR><TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../ImageList.htm#ch_il_refs">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ImageList_GetImageInfo.htm">ImageList_GetImageInfo</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ImageList_Merge.htm">ImageList_Merge</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>ImageList_LoadImage</H1>
<BR CLEAR=ALL>
<PRE>HIMAGELIST ImageList_LoadImage(
    HINSTANCE hi,
    LPCTSTR lpbmp,
    int cx,
    int cGrow,
    COLORREF crMask,
    UINT uType,
    UINT uFlags
   );&#009;
</PRE>
<P>Creates an image list from the specified bitmap, cursor, or icon resource.
<UL><LI>Returns the handle to the image list if successful, or NULL otherwise.

</UL>
<DL><DT><I>hi</I> 
 </DT><DD>Handle to the instance that contains the resource. This parameter can be NULL if you are loading an image from a file or loading an OEM resource.
</DD><DT><I>lpbmp</I>
 </DT><DD>Identifies the image to load. 
 <P>If the <I>uFlags</I> parameter includes LR_LOADFROMFILE, <I>lpbmp</I> is the address of a null-terminated string that names the file containing the image to load. 
 <P>If the <I>hi</I> parameter is non-NULL and LR_LOADFROMFILE is not specified, <I>lpbmp</I> is the address of a null-terminated string that contains the name of the image resource in the <I>hi</I> module.
 <P>If <I>hi</I> is NULL and LR_LOADFROMFILE is not specified, the low-order word of this parameter must be the identifier of an OEM image to load. To create this value, use the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>MAKEINTRESOURCE</A> macro with one of the OEM image identifiers defined in WINUSER.H. These identifiers have the following prefixes:

<TABLE>
<TR><TD>OBM_ for OEM bitmaps</TD></TR>
<TR><TD>OIC_ for OEM icons</TD></TR>
<TR><TD>OCR_ for OEM cursors</TD></TR>
</TABLE>
</DD><DT><I>cx</I>
 </DT><DD>Width of each image. The height of each image and the initial number of images are inferred by the dimensions of the specified resource.
</DD><DT><I>cGrow</I>
 </DT><DD>Number of images by which the image list can grow when the system needs to make room for new images. This parameter represents the number of new images that the resized image list can contain.
</DD><DT><I>crMask</I>
 </DT><DD>Color used to generate a mask. Each pixel of this color in the specified bitmap, cursor, or icon is changed to black, and the corresponding bit in the mask is set to 1. If this parameter is the CLR_NONE value, no mask is generated. If this parameter is the CLR_DEFAULT value, the color of the pixel at the upper-left corner of the image is treated as the mask color.
</DD><DT><I>uType</I>
 </DT><DD>Flag that specifies the type of image to load. This parameter can be one of the following values:
<TABLE>
<TR><TD>IMAGE_BITMAP
 </TD><TD>Loads a bitmap.</TD></TR><TR><TD>IMAGE_CURSOR
 </TD><TD>Loads a cursor.</TD></TR><TR><TD>IMAGE_ICON
 </TD><TD>Loads an icon.</TD></TR></TABLE>
</DD><DT><I>uFlags</I>
 </DT><DD>Flags that specify how to load the image. This parameter can be a combination of the following values:
<TABLE>
<TR><TD>LR_DEFAULTCOLOR
 </TD><TD>Uses the color format of the display.</TD></TR><TR><TD>LR_LOADDEFAULTSIZE
 </TD><TD>Uses the width or height specified by the system metric values for cursors and icons if the <I>cx</I> parameter is set to zero. If this value is not specified and <I>cx</I> is set to zero, the function sets the size to the one specified in the resource. If the resource contains multiple images, the function sets the size to that of the first image. </TD></TR><TR><TD>LR_LOADFROMFILE
 </TD><TD>Loads the image from the file specified by the <I>lpbmp</I> parameter.</TD></TR><TR><TD>LR_LOADMAP3DCOLORS
 </TD><TD>Searches the color table for the image and replaces the following shades of gray with the corresponding three-dimensional color (see the comments section at the end of this topic for more information):
<P>Dk Gray: RGB(128, 128, 128)COLOR_3DSHADOW
<P>Gray: RGB(192, 192, 192)COLOR_3DFACE
<P>Lt Gray: RGB(223, 223, 223)COLOR_3DLIGHT</TD></TR><TR><TD>LR_LOADTRANSPARENT
 </TD><TD>Retrieves the color value of the first pixel in the image and replaces the corresponding entry in the color table with the default window color (the COLOR_WINDOW display color). All pixels in the image that use that color become the default window value color. This value applies only to images that have a corresponding color table. See the comments section at the end of this topic for more information.</TD></TR><TR><TD>LR_MONOCHROME
 </TD><TD>Loads the image in black and white.</TD></TR><TR><TD>LR_SHARED
 </TD><TD>Shares the image handle if the image is loaded multiple times. Do not use this value for images that have nontraditional sizes that might change after loading or for images that are loaded from a file. </TD></TR></TABLE>
</DD></DL>
<P>LR_LOADTRANSPARENT does not load the image transparently. It creates an opaque image list that only appears transparent because all of the "background" pixels have been changed to COLOR_WINDOW. If the images are drawn over a background that is not the color COLOR_WINDOW, the image will not draw properly. Also, LR_LOADTRANSPARENT and LR_LOADMAP3DCOLORS use the system colors that were in effect at the time that <B>ImageList_LoadImage</B> was called. If the system colors subsequently change, the application must reload the image to remap the colors.
<P>See also
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>LoadImage</A>

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>