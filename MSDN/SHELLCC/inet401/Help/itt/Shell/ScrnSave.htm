<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Screen Saver Library</TITLE>

<META NAME=MS-HKWD CONTENT="Screen Saver Library">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Windows Shell API">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_screensaverlib"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Screen Saver Library"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Screen Saver Library"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="Shell.htm#book_shell">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="AppHelp.htm">Help</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="dde/DDE.htm">Shell Dynamic Data Exchange Interface</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Screen Saver Library</H1>
<BR CLEAR=ALL>
<P>The Microsoft&#174; Win32&#174; application programming interface (API) supports special applications called <I>screen savers</I>. Screen savers start when the mouse and keyboard have been idle for a specified period of time. They are used for these two reasons: 
<UL><LI>To protect a screen from phosphor burn caused by static images.
<LI>To conceal sensitive information left on a screen. 
</UL>
<P><A CLASS=tctop HREF="ScrnSave.htm#About_Screen_Savers"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">About Screen Savers</A><BR>
<P><A CLASS=tctop HREF="ScrnSave.htm#Using_the_Screen_Sav"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Using the Screen Saver Functions</A><BR>
<!--*************************************************************--><H2><A NAME="About_Screen_Savers">About Screen Savers</A></H2>
<P>The Desktop application in the Microsoft&#174; Windows&#174; Control Panel lets users select from a list of screen savers, specify how much time should elapse before the screen saver starts, configure screen savers, and preview screen savers. Screen savers are loaded automatically when Windows starts or when a user activates the screen saver through the Control Panel. 

<P>Once a screen saver is chosen, Windows monitors keystrokes and mouse movements and then starts the screen saver after a period of inactivity. However, Windows does not start the screen saver if any of the following conditions exist: 
<UL><LI>The active application is not a Windows-based application. 
<LI>A computer-based training (CBT) window is present. 
<LI>The active application receives the WM_SYSCOMMAND message with the <I>wParam</I> parameter set to the SC_SCREENSAVE value, but it does not pass the message to the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>DefWindowProc</A> function. 
</UL>
<P>Screen savers contain specific exported functions, resource definitions, and variable declarations. The screen saver library contains the <B>main</B> function and other startup code required for a screen saver. When a screen saver starts, the startup code in the screen saver library creates a full-screen window. The window class for this window is declared as follows: 

<PRE>WNDCLASS cls; 
 
cls.hCursor        = NULL; 
cls.hIcon          = LoadIcon(hInst, MAKEINTATOM(ID_APP)); 
cls.lpszMenuName   = NULL; 
cls.lpszClassName  = "WindowsScreenSaverClass"; 
cls.hbrBackground  = GetStockObject(BLACK_BRUSH); 
cls.hInstance      = hInst; 
cls.style          = CS_VREDRAW | CS_HREDRAW | 
                     CS_SAVEBITS | CS_DBLCLKS; 
cls.lpfnWndProc    = (WNDPROC) ScreenSaverProc; 
cls.cbWndExtra     = 0; 
cls.cbClsExtra     = 0;  
</PRE>
<P>To create a screen saver, most developers create a source code module containing three required functions and link them with the screen saver library. A screen saver module is responsible only for configuring itself and for providing visual effects. 

<P>One of the three required functions in a screen saver module is <A HREF="functions/ScreenSaverProc.htm#ScreenSaverProc">ScreenSaverProc</A>. This function processes specific messages and passes any unprocessed messages back to the screen saver library. Following are some of the typical messages processed by <B>ScreenSaverProc</B>. 
<TABLE>
<TR><TD><B>Message
 </B></TD><TD><B>Meaning
</B></TD></TR>
<TR><TD>WM_CREATE </TD><TD>Retrieve any initialization data from the Regedit.ini file. Set a window timer for the screen saver window. Perform any other required initialization.</TD></TR>
<TR><TD>WM_ERASEBKGND </TD><TD>Erase the screen saver window and prepare for subsequent drawing operations.</TD></TR>
<TR><TD>WM_TIMER </TD><TD>Perform drawing operations.</TD></TR>
<TR><TD>WM_DESTROY </TD><TD>Destroy the timer(s) created when the application processed the WM_CREATE message. Perform any additional required cleanup.</TD></TR>
</TABLE>
<P><A HREF="functions/ScreenSaverProc.htm#ScreenSaverProc">ScreenSaverProc</A> passes unprocessed messages to the screen saver library by calling the <A HREF="functions/DefScreenSaverProc.htm#DefScreenSaverProc">DefScreenSaverProc</A> function. The following table describes how this function processes various messages. 
<TABLE>
<TR><TD><B>Message
 </B></TD><TD><B>Action
</B></TD></TR>
<TR><TD>WM_SETCURSOR </TD><TD>Set the cursor to the null cursor, removing it from the screen.</TD></TR>
<TR><TD>WM_PAINT </TD><TD>Paint the screen background.</TD></TR>
<TR><TD>WM_LBUTTONDOWN </TD><TD>Terminate the screen saver.</TD></TR>
<TR><TD>WM_MBUTTONDOWN </TD><TD>Terminate the screen saver.</TD></TR>
<TR><TD>WM_RBUTTONDOWN </TD><TD>Terminate the screen saver.</TD></TR>
<TR><TD>WM_KEYDOWN </TD><TD>Terminate the screen saver.</TD></TR>
<TR><TD>WM_MOUSEMOVE </TD><TD>Terminate the screen saver.</TD></TR>
<TR><TD>WM_ACTIVATE </TD><TD>Terminate the screen saver if the <I>wParam</I> parameter is set to FALSE. </TD></TR>
</TABLE>
<P>The second required function in a screen saver module is <A HREF="functions/ScreenSaverConfigureDialog.htm#ScreenSaverConfigure">ScreenSaverConfigureDialog</A>. This function displays a dialog box that enables the user to configure the screen saver (an application must provide a corresponding dialog box template). Windows displays the configuration dialog box when the user selects the Setup button in the Control Panel's Screen Saver dialog box. 

<P>The third required function in a screen saver module is <A HREF="functions/RegisterDialogClasses.htm#RegisterDialogClasse">RegisterDialogClasses</A>. This function must be called by all screen saver applications. However, applications that do not require special windows or custom controls in the configuration dialog box can simply return TRUE. Applications requiring special windows or custom controls should use this function to register the corresponding window classes. 

<P>In addition to creating a module that supports the three functions just described, a screen saver should supply an icon. This icon is visible only when the screen saver is run as a standalone application. (To be run by the Control Panel, a screen saver must have the .scr file name extension; to be run as a standalone application, it must have the .exe file name extension.) The icon must be identified in the screen saver's resource file by the constant ID_APP, which is defined in the Scrnsave.h header file. 

<P>One final requirement is a screen saver description string. The resource file for a screen saver must contain a string that the Control Panel displays as the screen saver name. The description string must be the first string in the resource file's string table (identified with the ordinal value 1). 

<H2><A NAME="Using_the_Screen_Sav">Using the Screen Saver Functions</A></H2>
<P>This section uses example code taken from a screen saver application to illustrate the following tasks:
<UL><LI><A HREF="ScrnSave.htm#Creating_Screen_Saver">Creating a Screen Saver</A>
<LI><A HREF="ScrnSave.htm#Installing_New_Screen_Savers">Installing New Screen Savers</A>
<LI><A HREF="ScrnSave.htm#Adding_Help_screen_saver">Adding Help to the Screen Saver Configuration Dialog</A> 
</UL>
<H3><A NAME="Creating_Screen_Saver">Creating a Screen Saver</A></H3>
<P>At intervals ranging from 1 through 10 seconds, the application in this example repaints the screen with one of four colors: white, light gray, dark gray, and black. The application paints the screen each time it receives a WM_TIMER message. The user can adjust the interval at which this message is sent by selecting the application's configuration dialog box and adjusting a single horizontal scroll bar. 

 
<H4><A NAME="Screen_Saver_Library">Screen saver library</A></H4>
<P>The static screen saver functions are contained in the screen saver library. There are two versions of the library available, <B>Scrnsave.lib</B> and <B>Scrnsavw.lib</B>. You must link your project with one of these. <B>Scrnsave.lib</B> is used for screen savers that use ANSI characters, and <B>Scrnsavw.lib</B> is used for screen savers that use UNICODE characters. A screen saver that is linked with <B>Scrnsavw.lib</B> will only run on Windows platforms that support UNICODE, while a screen saver linked with <B>Scrnsave.lib</B> will run on any Windows platform.

<H4><A NAME="Supporting_the_confi">Supporting the configuration dialog box</A></H4>
<P>Most screen savers provide a configuration dialog box to let the user specify customization data such as unique colors, drawing speeds, line thickness, fonts, and so on. To support the configuration dialog box, the application must provide a dialog box template and must also support the <A HREF="functions/ScreenSaverConfigureDialog.htm#ScreenSaverConfigure">ScreenSaverConfigureDialog</A> function. Following is the dialog box template for the sample application. 

<PRE>DLG_SCRNSAVECONFIGURE DIALOG 6, 18, 160, 63
LANGUAGE LANG_NEUTRAL, SUBLANG_NEUTRAL
STYLE DS_MODALFRAME | WS_POPUP | WS_VISIBLE | WS_CAPTION |
    WS_SYSMENU
CAPTION "Sample Screen-Saver Setup"
FONT 8, "MS Shell Dlg"
BEGIN
    GROUPBOX      "Redraw Speed", 101, 0, 6, 98, 40
    SCROLLBAR     ID_SPEED, 5, 31, 89, 10
    LTEXT         "Fast", 103, 6, 21, 20, 8
    LTEXT         "Slow", 104, 75, 21, 20, 8
    PUSHBUTTON    "OK", ID_OK, 117, 10, 40, 14
    PUSHBUTTON    "Cancel", ID_CANCEL, 117, 32, 40, 14
END 
 </PRE>
<P>You must define the constant used to identify the dialog box template by using the decimal value 2003, as in the following example: 
<PRE>#define  DLG_SCRNSAVECONFIGURE 2003 
 
</PRE>
<P>The following example shows the <A HREF="functions/ScreenSaverConfigureDialog.htm#ScreenSaverConfigure">ScreenSaverConfigureDialog</A> function found in the sample application. 
<PRE>#define MINVEL  1               /* minimum redraw speed value    */ 
#define MAXVEL  10              /* maximum redraw speed value    */ 
#define DEFVEL  5               /* default redraw speed value    */ 
 
LONG    lSpeed = DEFVEL;        /* redraw speed variable         */ 
 
extern HINSTANCE hMainInstance; /* screen saver instance handle  */ 
 
CHAR   szAppName[80];           /* .ini section name             */ 
CHAR   szTemp[20];              /* temporary array of characters */ 
CHAR   szRedrawSpeed[] = "Redraw Speed";   /* .ini speed entry   */ 
 
BOOL WINAPI ScreenSaverConfigureDialog(hDlg, message, wParam, lParam) 
HWND  hDlg; 
UINT  message; 
DWORD wParam; 
LONG  lParam; 
{ 
    static HWND hSpeed; /* handle to speed scroll bar */ 
    static HWND hOK;    /* handle to OK push button */ 
 
    switch(message) 
    { 
        case WM_INITDIALOG: 
 
            /* Retrieve the application name from the .rc file. */ 
 
            LoadString(hMainInstance, idsAppName, szAppName, 40); 
 
            /* Retrieve the .ini (or registry) file name. */ 
 
            LoadString(hMainInstance, idsIniFile, szIniFile, 
                MAXFILELEN); 
 
            /* Retrieve any redraw speed data from the registry. */ 
 
            lSpeed = GetPrivateProfileInt(szAppName, szRedrawSpeed, 
                DEFVEL, szIniFile); 
 
            /* 
             * If the initialization file does not contain an entry 
             * for this screen saver, use the default value. 
             */ 
 
            if(lSpeed &gt; MAXVEL || lSpeed &lt; MINVEL) 
                lSpeed = DEFVEL; 
 
            /* Initialize the redraw speed scroll bar control. */ 
 
            hSpeed = GetDlgItem(hDlg, ID_SPEED); 
            SetScrollRange(hSpeed, SB_CTL, MINVEL, MAXVEL, FALSE); 
            SetScrollPos(hSpeed, SB_CTL, lSpeed, TRUE); 
 
            /* Retrieve a handle to the OK push button control. */ 
 
            hOK = GetDlgItem(hDlg, ID_OK); 
 
            return TRUE; 
 
        case WM_HSCROLL: 
 
            /* 
             * Process scroll bar input, adjusting the lSpeed 
             * value as appropriate. 
             */ 
 
            switch (LOWORD(wParam)) 
                { 
                    case SB_PAGEUP: 
                        --lSpeed; 
                    break; 
 
                    case SB_LINEUP: 
                        --lSpeed; 
                    break; 
 
                    case SB_PAGEDOWN: 
                        ++lSpeed; 
                    break; 
 
                    case SB_LINEDOWN: 
                        ++lSpeed; 
                    break; 
 
                    case SB_THUMBPOSITION: 
                        lSpeed = HIWORD(wParam); 
                    break; 
 
                    case SB_BOTTOM: 
                        lSpeed = MINVEL; 
                    break; 
 
                    case SB_TOP: 
                        lSpeed = MAXVEL; 
                    break; 
 
                    case SB_THUMBTRACK: 
                    case SB_ENDSCROLL: 
                        return TRUE; 
                    break; 
                } 
                if ((int) lSpeed &lt;= MINVEL) 
                    lSpeed = MINVEL; 
                if ((int) lSpeed &gt;= MAXVEL) 
                    lSpeed = MAXVEL; 
 
                SetScrollPos((HWND) lParam, SB_CTL, lSpeed, TRUE); 
            break; 
 
        case WM_COMMAND: 
            switch(LOWORD(wParam)) 
            { 
                case ID_OK: 
 
                   /* 
                    * Write the current redraw speed variable to 
                    * the .ini file. 
                    */ 
 
                    wsprintf(szTemp, "%ld", lSpeed); 
                    WritePrivateProfileString(szAppName, szRedrawSpeed, 
                        szTemp, szIniFile); 
 
                case ID_CANCEL: 
                    EndDialog(hDlg, LOWORD(wParam) == ID_OK); 
                return TRUE; 
            } 
    } 
    return FALSE; 
} 
 </PRE>
<P>In addition to providing the dialog box template and supporting the <A HREF="functions/ScreenSaverConfigureDialog.htm#ScreenSaverConfigure">ScreenSaverConfigureDialog</A> function, an application must also support the <A HREF="functions/RegisterDialogClasses.htm#RegisterDialogClasse">RegisterDialogClasses</A> function. This function registers any nonstandard window classes required by the screen saver. Because the sample application used only standard window classes in its dialog box procedure, this function simply returns TRUE, as in the following example:
 
<PRE>BOOL WINAPI RegisterDialogClasses(hInst) 
HANDLE  hInst; 
{ 
    return TRUE; 
} 
</PRE>
<H4><A NAME="Supporting_the_scree">Supporting the screen saver window procedure</A></H4>
<P>Each screen saver must support a window procedure named <A HREF="functions/ScreenSaverProc.htm#ScreenSaverProc">ScreenSaverProc</A>. Like most window procedures, <B>ScreenSaverProc</B> processes a set of specific messages and passes any unprocessed messages to a default procedure. However, instead of passing them to the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>DefWindowProc</A> function, <B>ScreenSaverProc</B> passes unprocessed messages to the <A HREF="functions/DefScreenSaverProc.htm#DefScreenSaverProc">DefScreenSaverProc</A> function. Another difference between <B>ScreenSaverProc</B> and a normal window procedure is that the handle passed to <B>ScreenSaverProc</B> identifies the entire desktop rather than a client window. The following example shows the <B>ScreenSaverProc</B> window procedure for the sample screen saver.

<PRE>LONG WINAPI ScreenSaverProc(hwnd, message, wParam, lParam) 
HWND  hwnd; 
UINT  message; 
DWORD wParam; 
LONG  lParam; 
{ 
static HDC          hdc;    /* device-context handle */ 
static RECT         rc;     /* RECT structure */ 
static UINT         uTimer; /* timer identifier */ 
 
    switch(message) 
    { 
        case WM_CREATE: 
 
            /* Retrieve the application name from the .rc file. */ 
 
            LoadString(hMainInstance, idsAppName, szAppName, 40); 
 
            /* Retrieve the .ini (or registry) file name. */ 
 
            LoadString(hMainInstance, idsIniFile, szIniFile, 
                MAXFILELEN); 
 
            /* Retrieve any redraw speed data from the registry. */ 
 
            lSpeed = GetPrivateProfileInt(szAppName, szRedrawSpeed, 
                DEFVEL, szIniFile); 
 
           /* 
            * Set a timer for the screen saver window using the 
            * redraw rate stored in Regedit.ini. 
            */ 
 
            uTimer = SetTimer(hwnd, 1, lSpeed * 1000, NULL); 
            break; 
 
        case WM_ERASEBKGND: 
 
           /* 
            * The WM_ERASEBKGND message is issued before the 
            * WM_TIMER message, allowing the screen saver to 
            * paint the background as appropriate. 
            */ 
 
            hdc = GetDC(hwnd); 
            GetClientRect (hwnd, &amp;rc); 
            FillRect (hdc, &amp;rc, GetStockObject(BLACK_BRUSH)); 
            ReleaseDC(hwnd,hdc); 
            break; 
 
        case WM_TIMER: 
 
           /* 
            * The WM_TIMER message is issued at (lSpeed * 1000) 
            * intervals, where lSpeed == .001 seconds. This 
            * code repaints the entire desktop with a white, 
            * light gray, dark gray, or black brush each 
            * time a WM_TIMER message is issued. 
            */ 
 
            hdc = GetDC(hwnd); 
            GetClientRect(hwnd, &amp;rc); 
            if (i++ &lt;= 4) 
                FillRect(hdc, &amp;rc, GetStockObject(i)); 
            else 
                (i = 0); 
            ReleaseDC(hwnd,hdc); 
            break; 
 
        case WM_DESTROY: 
 
           /* 
            * When the WM_DESTROY message is issued, the screen saver 
            * must destroy any of the timers that were set at WM_CREATE 
            * time. 
            */ 
 
            if (uTimer) 
                KillTimer(hwnd, uTimer); 
            break; 
    } 
 
   /* 
    * DefScreenSaverProc processes any messages 
    * ignored by ScreenSaverProc. 
    */ 
 
    return DefScreenSaverProc(hwnd, message, wParam, lParam); 
} 
 </PRE>
<H4><A NAME="Creating_a_module_de">Creating a module-definition file</A></H4>
<P>The <A HREF="functions/ScreenSaverProc.htm#ScreenSaverProc">ScreenSaverProc</A> and <A HREF="functions/ScreenSaverConfigureDialog.htm#ScreenSaverConfigure">ScreenSaverConfigureDialog</A> functions must be exported in the application's module-definition file; <A HREF="functions/RegisterDialogClasses.htm#RegisterDialogClasse">RegisterDialogClasses</A> should not be exported, however. The following example shows the module-definition file for the sample application.
 
<PRE>NAME    SSTEST.SCR 
 
DESCRIPTION 'SCRNSAVE : Test' 
 
STUB    'WINSTUB.EXE' 
EXETYPE WINDOWS 
 
CODE    MOVEABLE 
DATA    MOVEABLE MULTIPLE 
 
HEAPSIZE  1024 
STACKSIZE 4096 
 
EXPORTS 
        ScreenSaverProc 
        ScreenSaverConfigureDialog 
 </PRE>
<H3><A NAME="Installing_New_Screen_Savers">Installing New Screen Savers</A></H3>
<P>When compiling the list of available screen savers, the Control Panel searches the Windows Startup directory for files with the .scr extension. Because screen savers are standard Windows executable files with .exe extensions, you must rename them so they have .scr extensions and copy them to the correct directory. 

<H3><A NAME="Adding_Help_screen_saver">Adding Help to the Screen Saver Configuration Dialog</A></H3>
<P>The configuration dialog box for a screen saver typically includes a Help button. Screen saver applications can check for the Help button identifier and call the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function in the same way Help is provided in other Windows-based applications. 

<!--CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>