<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>About Program Manager Initialization</TITLE>

<META NAME=MS-HKWD CONTENT="About Program Manager Initialization">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Windows Shell API">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="shelldde_pgmmgr"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="About Program Manager Initialization"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="About Program Manager Initialization"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="DDE.htm#ch_shelldde">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="DDE.htm">Shell Dynamic Data Exchange Interface</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="Command.htm">Command-String Interface</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>About Program Manager Initialization</H1>
<BR CLEAR=ALL>
<P>Program Manager starts automatically when the user starts Windows and runs as long as Windows is in use. When it starts, Program Manager displays one or more windows within its main window. Each window contains icons that correspond to logically related Windows-based applications. For example, the Accessories window contains icons for Windows Write, Paintbrush, Notepad, and other accessory applications. 

<P>Program Manager stores initialization and configuration information in the registry. This information is stored under the <A HREF="ProgMan.htm#Shelldde_Settings_Key">Settings</A>, <A HREF="ProgMan.htm#Shelldde_Groups_Key">Groups</A>, and <A HREF="ProgMan.htm#Shelldde_Restrictions_Key">Restrictions</A> keys in the following section of the registry: 

<PRE>HKEY_CURRENT_USER\Software\Microsoft\WindowsNT\
        CurrentVersion\Program Manager
</PRE>
<P>Additional information is stored in the <B>Program Groups</B> key in the following section of the registry: 

<P>HKEY_LOCAL_MACHINE\SOFTWARE

<H2><A NAME="Shelldde_Settings_Key">Settings Key</A></H2>
<P>The <B>Settings</B> key contains information that Program Manager uses to configure its environment. The following entries appear in the <B>Settings</B> key. 
<TABLE>
<TR><TD><B>Entry
 </B></TD><TD><B>Description</B></TD></TR>
<TR><TD>MinOnRun </TD><TD>Specifies whether to minimize Program Manager when an application is started.</TD></TR>
<TR><TD>AutoArrange </TD><TD>Specifies whether Program Manager should automatically arrange icons within groups.</TD></TR>
<TR><TD>SaveSettings </TD><TD>Specifies whether to save the position of the Program Manager window when Program Manager terminates.</TD></TR>
<TR><TD>Display.drv </TD><TD>Specifies the file name of the display driver in use when Program Manager last terminated. When Program Manager starts, it compares this value to the file name of the display driver currently in use. If the names are different, Program Manager re-extracts the application icons.</TD></TR>
<TR><TD>Window </TD><TD>Specifies the location and dimensions of the Program Manager window.</TD></TR>
<TR><TD>Order </TD><TD>Specifies the order that the groups listed in the <A HREF="ProgMan.htm#Shelldde_Groups_Key">Groups</A> key appear in the Program Manager window.</TD></TR>
<TR><TD>Startup </TD><TD>Specifies the name of the startup group. Program Manager automatically starts the applications in this group whenever it starts.</TD></TR>
</TABLE>
<H2><A NAME="Shelldde_Groups_Key">Groups Key</A></H2>
<P>The windows that appear in the Program Manager window correspond to group files. From the user's perspective, a group file is a collection of icons that represent logically related applications, but from the programmer's perspective, a group file is actually a collection of data. This data includes the color information for the icons (AND and XOR masks), an offset to the resource header of each icon, the ideal resolution for displaying each icon, the name of the executable (.exe) file that contains the application, and so on. 

<P>There are two types of groups: common and personal. A common group is shared among multiple users through network connections; a personal group is not shared. Program Manager stores information about personal groups under the <B>Groups</B> key. It stores information about common groups under the HKEY_LOCAL_MACHINE\SOFTWARE key. 

<P>The <B>Groups</B> key of the registry identifies the names of the group files that Program Manager displays as unique windows or icons. The groups must be numbered, but they don't need to be listed in any particular order. Program Manager never changes the number of an existing group. 


<H2><A NAME="Shelldde_Restrictions_Key">Restrictions Key</A></H2>
<P>The <B>Restrictions</B> key controls whether certain features of Program Manager are enabled or disabled. The following entries can appear in the <B>Restrictions</B> key. 
<TABLE>
<TR><TD><B>Entry
 </B></TD><TD><B>Description</B></TD></TR>
<TR><TD>NoRun </TD><TD>Specifies whether to disable the Run command on the File menu. If this entry is set to 1, the Run command is disabled. If this entry is set to 0, the Run command is enabled. The default is 0 if no value is specified.</TD></TR>
<TR><TD>NoClose </TD><TD>Specifies whether to prevent the user from closing Program Manager through the File menu, the System menu, the <SMALL>ALT+F4</SMALL> key combination, or the Task List. If this entry is set to 1, closing is prevented. If this entry is set to 0, closing is allowed. If no value is specified, the default is 0.</TD></TR>
<TR><TD>EditLevel </TD><TD>Controls the extent to which the user can modify read/write groups. (Shared read-only groups cannot be modified.) This entry can be set to one of the following values.
<TABLE>
<TR><TD><B>Value
 </B></TD><TD><B>Action</B></TD></TR>
<TR><TD>0 </TD><TD>Allows any modifications to the group. This is the default value.</TD></TR>
<TR><TD>1 </TD><TD>Prevents the user from creating, deleting, or renaming groups.</TD></TR>
<TR><TD>2 </TD><TD>Prevents the user from creating, deleting, or renaming groups and from creating or deleting items in a group.</TD></TR>
<TR><TD>3 </TD><TD>Prevents the user from creating, deleting, or renaming groups; from creating or deleting items in a group; and from changing command lines for items in a group.</TD></TR>
<TR><TD>4 </TD><TD>Prevents the user from changing any property of an item in a group; from creating, deleting, or renaming groups; from creating or deleting items in a group; and from changing command lines for items in a group.</TD></TR>
</TABLE></TD></TR>
<TR><TD>NoFileMenu </TD><TD>Specifies whether to disable the File menu and all of its commands. If this entry is set to 1, the File menu is disabled. If this entry is set to 0, the menu is enabled. If no value is specified, the default setting is 0.</TD></TR>
<TR><TD>NoSaveSettings </TD><TD>Specifies whether to disable the Save Settings on Exit command on the Options menu. If this entry is set to 1, the Save Settings on Exit command is disabled. If this entry is set to 0, the command is enabled. If no value is specified, the default setting is 0.</TD></TR>
</TABLE>
<P>Setting the value of NoRun to 1 and the value of EditLevel to 3 prevents a user from using Program Manager to run any applications not already in a program group. 


<!--CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>