<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Help</TITLE>

<META NAME=MS-HKWD CONTENT="Help">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Windows Shell API">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_help"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Help"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Help"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="Shell.htm#book_shell">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="FileView.htm">File Viewers</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ScrnSave.htm">Screen Saver Library</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Help</H1>
<BR CLEAR=ALL>
<P>Online Help can come in a variety of forms, from detailed conceptual information to quick definitions.
<P><A CLASS=tctop HREF="AppHelp.htm#About_Help"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">About Help</A><BR>
<P><A CLASS=tctop HREF="AppHelp.htm#Using_Help"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Using Help</A><BR>
<!--*************************************************************--><H2><A NAME="About_Help">About Help</A></H2>
<P>An important element of a user-friendly application is readily available in online Help. Microsoft&#174; Windows&#174; provides functions and messages that, when used in conjunction with the Windows Help application, make it easy to implement online Help in your application. This overview discusses the elements of the Microsoft&#174; Win32&#174; application programming interface (API) that support online Help. It describes how to use these elements to give users a means to request Help, and it explains how to use the Windows Help application to display Help.

<H3><A NAME="Help_Requests">Help Requests</A></H3>
<P>Most Windows-based applications provide online Help information in a variety of forms, ranging from conceptual Help that explains the purpose of an application's features to pop-up Help that provides quick definitions of individual elements in the application's user interface. You use Win32 functions and messages to give users a variety of ways to request access to this information. The following sections describe these Help requests. 

<H4><A NAME="Help_menu">Help menu</A></H4>
<P>Most applications provide user access to Help information by including a Help menu in the main window. When the user selects an item from a Help menu, the corresponding window procedure receives a
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>WM_COMMAND</A> message that identifies the selected item. The application responds by displaying the appropriate Help information, such as a list of Help topics, an index, or an introduction to the application.

<H4><A NAME="Help_from_the_keyboa">Help from the keyboard</A></H4>
<P>Windows provides user access to Help information from the keyboard by notifying the application whenever the user presses the <SMALL>F1</SMALL> key. The system sends a <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> message to the window that had the keyboard focus when the user pressed the <SMALL>F1</SMALL> key. If the window is a child window (for example, a control in a dialog box), the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>DefWindowProc</A> function passes the message to the parent window. If a menu is active when <SMALL>F1</SMALL> is pressed, the system sends the message to the window associated with the menu. The application responds by displaying Help information associated with the window, control, or menu that has the focus or is active. For example, if the user selects a control in a dialog box and presses <SMALL>F1</SMALL>, the application displays Help information for that control. 

<P>The <I>lParam</I> parameter of <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> is a pointer to a <A HREF="structures/HELPINFO.htm#HELPINFO">HELPINFO</A> structure that contains detailed information about the item for which Help is requested. You use this information to determine the Help topic to display. The <B>HELPINFO</B> structure also includes the coordinates of the mouse cursor at the time the user pressed the <SMALL>F1</SMALL> key. You can use this information to provide Help based on the location of the mouse cursor. 

<H4><A NAME="Help_from_the_mouse">Help from the mouse</A></H4>
<P>Windows provides the user access to Help information from the mouse by notifying the application whenever the user clicks the right mouse button or clicks a window, control, or menu after clicking the Question (?) button. The application responds by displaying Help information associated with the given window, control, or menu.

<P>The system sends a
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>WM_CONTEXTMENU</A> message when the user clicks the right mouse button. The window that was clicked receives the message. If the window is a child window, such as a control, the
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>DefWindowProc</A> function passes the message to the parent window. The <B>WM_CONTEXTMENU</B> message specifies the coordinates of the mouse cursor. The x-coordinate is in the low-order word of the <I>lParam</I> parameter, and the y-coordinate is in the high-order word. If the user clicked a control, the <I>wParam</I> parameter is the handle to the control that received the click.

<P>The system sends a <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> message when the user clicks an item in a window after clicking the Question (?) button that appears in the title bar of the window. You can add a Question button to a title bar by specifying the WS_EX_CONTEXTHELP style in the
<object id="hhal_7" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_7.Click()>CreateWindowEx</A> function when creating the window. The <I>lParam</I> parameter of <B>WM_HELP</B> is a pointer to a <A HREF="structures/HELPINFO.htm#HELPINFO">HELPINFO</A> structure that contains detailed information about the item for which Help is requested, including the coordinates of the mouse cursor at the time the user clicked the mouse button.

<P>The Question button is recommended for use in dialog boxes only. In the past, applications have provided user access to Help information about a dialog box by providing a Help button in the dialog box. This method is no longer recommended. Use the Question button instead. 

<H3><A NAME="Help_Display_and_Win">Help Display and Windows Help</A></H3>
<P>Once an application receives a request for Help, it should display the appropriate Help information. Because the Windows Help application supplies a consistent user interface, it is recommended that applications use Windows Help rather than other methods. To direct Windows Help to display Help information, an application uses the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function, specifying details such as the information to display and the form of the window in which to display it. The following sections explain how to use <B>WinHelp</B> to display Help information.

<H4><A NAME="Help_files">Help files</A></H4>
<P>To view Help information, you must specify a Help file when calling the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function. The Help file must have the Windows Help (.hlp) file format and one or more topics. Each topic is a distinct unit of information, such as a conceptual description, a set of instructions, a picture, a glossary definition, and so on. Topics must be uniquely identified so that Windows Help can locate them whenever they are requested. Internally, Windows Help uses topic identifiers to locate topics, but applications most often use context identifiers (unique integer values) to specify the topics to display. The Help file author must explicitly map context identifiers to topic identifiers in the [MAP] section of the project file used to build the Help file.

<P>When you specify a Help file but you do not specify a path, <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> looks for the Help file in the Help directory or in a directory specified by the PATH environment variable. In addition, <B>WinHelp</B> can find a Help file whose name is listed in the following registry location: 

<PRE>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\Help 
 </PRE>
<P>To take advantage of the registry, you must create a value name that has the same name as your Help file. The value assigned to that name must be the directory where the Help file resides. 

<P>If <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> cannot find the given Help file, it displays a dialog box that allows the user to specify the location of the Help file. Because <B>WinHelp</B> saves the location information in the registry, it does not ask again for the location of the same Help file. 

<P>For more information about how to author and build a Help file, see the documentation provided with your development tools.

<H4><A NAME="Starting_Windows_Hel">Starting Windows Help</A></H4>
<P>The following example uses the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function to start the Windows Help application and open the Microsoft&#174; Windows NT&#174; Help file to its Contents topic.

<PRE>HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 
 
bResult = WinHelp(hWnd, "WINNT.HLP", HELP_CONTENTS, 0L); 
 </PRE>
<P>This next example opens the Windows NT user Help file, searches the file for the topic associated with a keyword string, and then displays the topic.

<PRE>HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 
 
bResult = WinHelp(hWnd, "WINNT.HLP", HELP_KEY, 
                  (DWORD) "finding topics"); 
 </PRE>
<H4><A NAME="Help_Topics_dialog_b">Help Topics dialog box</A></H4>
<P>You can display the Help Topics dialog box by calling the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function with the HELP_FINDER command. The Help Topics dialog box lets the user select topics to display by viewing the titles of the topics, the keywords associated with the topics, or the words and phrases found in the topics. Applications typically display this dialog box when the user chooses a command, such as Help Topics, from the Help menu. An application may also display this dialog box if the user presses the <SMALL>F1</SMALL> key when no specific window, control, or menu in the application has the focus or is active.

<P>In the past, applications have used the HELP_CONTENTS and HELP_INDEX commands with the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function to display the Contents topic and the keyword index of the Help file. These commands are no longer recommended. Use the HELP_FINDER command instead.

<H4><A NAME="Information_topics">Information topics</A></H4>
<P>You can display a specific topic by calling the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function with the HELP_CONTEXT command and specifying the context identifier for the topic. Applications typically use the HELP_CONTEXT command in response to user requests for topics containing conceptual information or procedural Help rather than information about a specific control or menu. In such cases, the user may continue to browse the Help file looking for related information before returning to the application.

<P>The HELP_CONTEXT command invokes a regular instance of Windows Help, enabling the user to find other topics in the Help file. It typically displays the main Help window, which includes a title bar, a system menu, minimize and maximize buttons, a main menu, an optional navigation bar, a sizing border, and a client area. The text of the selected topic appears in the client area, and the user can navigate through the Help file by using hot links or navigation buttons in the main window. The regular instance of Windows Help can also be used to display Help in one or more secondary windows instead of the main window.

<H4><A NAME="Pop_up_topics">Pop-up topics</A></H4>
<P>You can display a pop-up topic that contains information for a specific control or menu by calling the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function with the HELP_WM_HELP or HELP_CONTEXTMENU command. These commands display a topic in a pop-up window near the corresponding control or menu. To let the user return immediately to work in the application, the pop-up window is destroyed as soon as the user presses a key or clicks the left mouse button.

<P>You use the HELP_WM_HELP command when processing <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> messages for control windows. Because most controls pass the <B>WM_HELP</B> message to the
<object id="hhal_8" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_8.Click()>DefWindowProc</A> function, the corresponding dialog box procedure (or parent window procedure) processes this message. Rather than give a specific context identifier, the dialog box procedure must pass an array of control and context identifier pairs to <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> along with the control handle specified in the <B>hItemHandle</B> member of the <A HREF="structures/HELPINFO.htm#HELPINFO">HELPINFO</A> structure passed with the <B>WM_HELP</B> message. The function determines the identifier of the control for which the <B>WM_HELP</B> message was generated and uses the matching context identifier to display the appropriate topic. 

<P>You use the HELP_CONTEXTMENU command when processing
<object id="hhal_9" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_9.Click()>WM_CONTEXTMENU</A> messages. Because most controls pass the <B>WM_CONTEXTMENU</B> message to the
<object id="hhal_10" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_10.Click()>DefWindowProc</A> function, the corresponding dialog box procedure (or parent window procedure) processes this message. The procedure specifies an array of control and context identifier pairs; it also specifies the handle in the <I>wParam</I> parameter when calling <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> so that the function can pick the appropriate context identifier from the array and display the appropriate topic. Unlike the HELP_WM_HELP command, HELP_CONTEXTMENU first displays a What's This? command in a menu. If the user chooses the command, <B>WinHelp</B> displays the topic. Otherwise, the request is canceled.

<P>You can also display pop-up topics by using the HELP_CONTEXTPOPUP command and specifying a context identifier of the topic. This command is similar to the HELP_CONTEXT command but invokes the pop-up instance of Windows Help used by HELP_WM_HELP and HELP_CONTEXTMENU. Applications can use this command in response to <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> messages to display Help for menus and for windows that are not controls in a dialog box. To use this command most effectively, the application should assign context identifiers to these menus and windows.

<P>You can assign a context identifier to any window or menu in the application. When a <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> message is generated, the system includes the context identifier in the <A HREF="structures/HELPINFO.htm#HELPINFO">HELPINFO</A> structure that is passed to the parent window in the <B>WM_HELP</B> message. The parent window can then pass the context identifier to <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> to display the requested Help topic.

<P>You use the <A HREF="functions/SetWindowContextHelpId.htm#SetWindowContextHelp">SetWindowContextHelpId</A> function to assign a context identifier to a window or control and the <A HREF="functions/SetMenuContextHelpId.htm#SetMenuContextHelpId">SetMenuContextHelpId</A> function to assign a context identifier to a menu. You can retrieve the context identifier for a window or menu by using the <A HREF="functions/GetWindowContextHelpId.htm#GetWindowContextHelp">GetWindowContextHelpId</A> or <A HREF="functions/GetMenuContextHelpId.htm#GetMenuContextHelpId">GetMenuContextHelpId</A> function.

<H4><A NAME="Keyword_searches">Keyword searches</A></H4>
<P>You can enable the user to find and view topics by assigning keywords to topics in the Help file. A keyword is simply a string that is associated with one or more topics. Windows Help collects all keywords in a Help file, places them in a table, and displays them in the Index list of the Help Topics dialog box. When the user selects a keyword, Windows Help displays the associated Help topic or, if there is more than one topic associated with the keyword, displays a list of topics from which the user can choose. 

<P>In an application, you can use the HELP_KEY, HELP_PARTIALKEY, or HELP_MULTIKEY command with the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function to search for and display Help topics based on whole or partial keywords. You specify the command, the keyword string, the Help file, and the handle to the owner window. In all cases, if a single match is found, <B>WinHelp</B> displays the corresponding topic. If more than one match is found, the function displays the Topics Found dialog box, and the user can choose which topic to view. If no match is found, <B>WinHelp</B> either displays the Index list (for HELP_KEY and HELP_PARTIALKEY) or displays an error message (for HELP_MULTIKEY).

<P>Your application can search for multiple keywords in a single call to <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> by separating the keywords with semicolons. (Searching for multiple keywords is not supported for Help files created for Windows version 3.<I>x</I>.) It can also search for keywords across multiple Help files if the Help file that is specified has a contents (.cnt) file that contains :Index or :Link commands. With the HELP_KEY command, <B>WinHelp</B> searches for keywords in all files specified by these commands. With the HELP_MULTIKEY and HELP_PARTIALKEY commands, the function searches all files except those specified by :Link commands. 

<P>By default, Windows Help recognizes only the keyword table identified by the K footnote character in the Help source file. You can direct Windows Help to create additional keyword tables by adding a footnote character other than K, with the keyword definition, in the Help source file. (The footnote character A, however, is reserved.) You must define any additional keyword tables by using MULTIKEY statements in the [OPTIONS] section of the project file when building the Help file. 

<P>An application can use the HELP_SETINDEX command with the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function to direct Windows Help to display a keyword table other than K in its Index list. To direct Windows Help to search for a keyword in an alternate keyword table, an application can use the HELP_MULTIKEY command. You specify the keyword and keyword table in a <A HREF="structures/MULTIKEYHELP.htm#MULTIKEYHELP">MULTIKEYHELP</A> structure, which you pass to <B>WinHelp</B>. 

<P>When <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> displays a topic, it displays it in the window specified by the "&gt;" footnote for the topic, in the window specified by the :Base command in the contents file, or in the main window. If the main window is already open to a different Help file when you call <B>WinHelp</B>, the function hides the main window while searching. In this case, canceling both the Topics Found and Help Topics dialog boxes closes the main window. 

<H4><A NAME="Secondary_Help_windo">Secondary Help windows</A></H4>
<P>The main window of the Windows Help application is called the primary window. Windows Help can also display Help topics in a secondary window. Unlike the primary Help window, a secondary window does not contain a menu bar. You can include a navigation bar in a secondary window, and you can add buttons to the bar. You can also choose to have Windows Help automatically adjust the height of the secondary window to accommodate the topic. 

<P>You must define secondary windows in the [WINDOWS] section of your Help project file, providing the name and, optionally, initial size and position of each window. You can direct the Windows Help application to display a topic in a secondary window by appending an angle bracket (&gt;) and the name you have defined for the secondary window to the name of the Help file. The resulting string is then passed to the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function. 

<P>An application can change the size and position of a primary or secondary window by specifying the address of a <A HREF="structures/HELPWININFO.htm#HELPWININFO">HELPWININFO</A> structure and the HELP_SETWINPOS command in a call to <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A>. <B>HELPWININFO</B> specifies the name of the window and its new size and position. 

<H4><A NAME="Training_card_Help">Training card Help</A></H4>
<P>Using training card Help, an application can display a sequence of instructions to guide the user through the steps of a task. A training card typically consists of text that explains a particular step and buttons that are associated with TCard macros, which allow the user to tell the application what to do next. Training cards can only be displayed in secondary windows and must not contain hot links to other topics in the Help file.

<P>An application initiates the training card instance of Windows Help by calling the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function and specifying the HELP_TCARD command in combination with another command, such as HELP_CONTEXT. Subsequently, when the user clicks a button in the training card, clicks a hot spot assigned to the TCard macro, or closes the training card, Windows Help notifies the application by sending it a <A HREF="messages/WM_TCARD.htm#WM_TCARD">WM_TCARD</A> message. The <I>wParam</I> parameter identifies the button or user action, and the <I>lParam</I> parameter contains additional data, the meaning of which depends on the value of <I>wParam</I>. 

<H4><A NAME="Canceling_Help">Canceling Help</A></H4>
<P>Windows Help requires an application to explicitly cancel Help so that it can free any resources used to keep track of the application and its Help files. The application can do this at any time by calling the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function and specifying the HELP_QUIT command. Note that this is not true for the pop-up instance of Windows Help. An application should not try to close a pop-up instance. 

<P>If an application has made any calls to <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A>, it must cancel Help before it closes its main window (for example, in response to the WM_DESTROY message in the main window procedure). An application needs to call <B>WinHelp</B> only once to cancel Help, no matter how many Help files it has opened. Windows Help remains running until all applications or dynamic-link libraries (DLLs) have canceled Help. 

<P>To close the training card instance of Windows Help, you must specify both the HELP_TCARD and HELP_QUIT commands when calling <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A>. An application does not need to cancel the training card instance of Windows Help if the user cancels it first. Windows Help notifies an application when the user cancels the training card instance by sending the <A HREF="messages/WM_TCARD.htm#WM_TCARD">WM_TCARD</A> message with the <I>wParam</I> parameter set to IDCLOSE. 

<H2><A NAME="Using_Help">Using Help</A></H2>
<P>This section shows how to provide context-sensitive Help for a dialog box and how to set the appearance of a secondary Help window. 
<UL><LI><A HREF="AppHelp.htm#shell_dialog_help">Providing Help in a Dialog Box</A>
<LI><A HREF="AppHelp.htm#shell_sec_help_appearance">Setting the Appearance of a Secondary Help Window</A>
</UL>
<H3><A NAME="shell_dialog_help">Providing Help in a Dialog Box</A></H3>
<P>To provide context-sensitive Help in a dialog box, you must create an array consisting of pairs of DWORD values. The first value in each pair is the identifier of a control in the dialog box, and the second is the context identifier of the Help topic for the control. The array should contain one pair of identifiers for each control in the dialog box.

<P>The dialog box procedure must process the <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> and
<object id="hhal_11" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_11.Click()>WM_CONTEXTMENU</A> messages. The dialog box procedure receives <B>WM_HELP</B> when the user presses the <SMALL>F1</SMALL> key and <B>WM_CONTEXTMENU</B> when the user clicks the right mouse button.

<P>The <I>lParam</I> parameter of <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> contains the address of a <A HREF="structures/HELPINFO.htm#HELPINFO">HELPINFO</A> structure. The <B>hItemHandle</B> member of this structure identifies the control for which the user has requested Help. You must pass this handle to the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function along with the HELP_WM_HELP command, the name of your Help file, and a pointer to the array of identifiers. The <B>WinHelp</B> function searches the array for the control identifier of the specified control and then retrieves the corresponding Help context identifier. Next, the function passes the Help context identifier to Windows Help, which finds the corresponding topic and displays it in a pop-up window. If the control has an identifier of -1, the system searches for the next control that is a tab stop and then uses its identifier to find the Help context identifier. For this reason, it is important that you place static text before controls in a resource file.

<P>When calling the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function, processing
<object id="hhal_12" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_12.Click()>WM_CONTEXTMENU</A> is similar to processing <A HREF="messages/WM_HELP.htm#WM_HELP">WM_HELP</A> with these two exceptions:
<UL><LI>You pass the <I>wParam</I> parameter from
<object id="hhal_13" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_13.Click()>WM_CONTEXTMENU</A>, which is the handle to the control that sent the message.
<LI>You specify the HELP_CONTEXTMENU command instead of HELP_WM_HELP. 
</UL>
<P>The HELP_CONTEXTMENU command causes Windows Help to display a menu before it displays the Help topic. The menu is system-defined. It allows the user to display Help for the control or to display the Help Topics dialog box.

<P>The following example shows how to implement context-sensitive Help in a dialog box.
<PRE> 
LRESULT CALLBACK EditDlgProc(HWND hwndDlg, UINT uMsg, WPARAM wParam, 
    LPARAM lParam) 
{ 
 
// Create an array of control identifiers and context identifiers. 
 
static DWORD aIds[] = { 
    ID_SAVE,   IDH_SAVE, 
    ID_DELETE, IDH_DELETE, 
    ID_COPY,   IDH_COPY, 
    ID_PASTE,  IDH_PASTE, 
    0,0 
}; 
 
switch (uMsg) { 
    case WM_HELP: 
        WinHelp(((LPHELPINFO) lParam)-&gt;hItemHandle, "helpfile.hlp", 
            HELP_WM_HELP, (DWORD) (LPSTR) aIds); 
        break; 
 
    case WM_CONTEXTMENU: 
        WinHelp((HWND) wParam, "helpfile.hlp", HELP_CONTEXTMENU, 
            (DWORD) (LPVOID) aIds); 
        break; 
    . 
    . // Process other messages here. 
    . 
    } 
 
return FALSE; 
 
} 
 
</PRE>
<H3><A NAME="shell_sec_help_appearance">Setting the Appearance of a Secondary Help Window</A></H3>
<P>An application can set the size, position, and show state of a secondary Help window by passing the HELP_SETWINPOS command and the address of a <A HREF="structures/HELPWININFO.htm#HELPWININFO">HELPWININFO</A> structure to the <A HREF="functions/WinHelp.htm#WinHelp">WinHelp</A> function. The members of <B>HELPWININFO</B> specify the name of the window to change and the window's new size, position, and show state. 

<P>The following example sets the appearance of a secondary window named "wnd_menu". The name must be defined in the [WINDOWS] section of the Help project file.
<PRE> 
BOOL DoWindowSize(VOID) 
{ 
    HANDLE hhwi; 
    LPHELPWININFO lphwi; 
    WORD wSize; 
    char *szWndName = "wnd_menu"; 
 
    wSize = sizeof(HELPWININFO) + lstrlen(szWndName); 
    hhwi = GlobalAlloc(GHND, wSize); 
    lphwi = (LPHELPWININFO) GlobalLock(hhwi); 
 
    lphwi-&gt;wStructSize = wSize; 
    lphwi-&gt;x    = 256;      // horizontal position 
    lphwi-&gt;y    = 256;      // vertical position 
    lphwi-&gt;dx   = 767;      // width 
    lphwi-&gt;dy   = 512;      // height 
    lphwi-&gt;wMax = SW_SHOW;  // show the window 
    lstrcpy(lphwi-&gt;rgchMember, szWndName);  // secondary window 
 
    WinHelp(hwnd, "myhelp.hlp", HELP_SETWINPOS, (DWORD) lphwi); 
    GlobalUnlock(hhwi); 
    GlobalFree(hhwi); 
 
return; 
} 
 
</PRE>
<!--CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>