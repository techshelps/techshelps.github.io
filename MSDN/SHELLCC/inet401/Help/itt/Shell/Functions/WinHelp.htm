<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WinHelp</TITLE>

<META NAME=MS-HKWD CONTENT="WinHelp">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Windows Shell API">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="WinHelp"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="WinHelp"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="WinHelp"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../RefList.htm#ch_shell_ref">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="VwStreamTellFunc.htm">VwStreamTellFunc</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="shell_callbacks.htm">Callback Functions</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>WinHelp</H1>
<P>Starts Microsoft&reg; Windows&reg; Help (Winhelp.exe) and passes additional data indicating the nature of the Help requested by the application. 

<H4>Syntax</H4>
<BLOCKQUOTE><BR>
<PRE>BOOL WinHelp(
    HWND hWndMain,
    LPCTSTR lpszHelp,
    UINT uCommand,
    DWORD dwData
);
</PRE>
</BLOCKQUOTE>

<H4>Parameters</H4>
<BLOCKQUOTE>
<DL>
<DT><I>hWndMain</I></DT>
<DD>Identifies the window requesting Help. The <B>WinHelp</B> function uses this handle to keep track of which applications have requested Help. If the <I>uCommand</I> parameter specifies HELP_CONTEXTMENU or HELP_WM_HELP, <I>hWndMain</I> identifies the control requesting Help.</DD>
<DT><I>lpszHelp</I></DT>
<DD>Address of a null-terminated string containing the path, if necessary, and the name of the Help file that <B>WinHelp</B> is to display.</DD>
<P>The file name may be followed by an angle bracket (&gt;) and the name of a secondary window if the topic is to be displayed in a secondary window rather than in the primary window. The name of the secondary window must have been defined in the [WINDOWS] section of the Help project (.hpj) file.</DD>
<DT><I>uCommand</I></DT>
<DD>Type of Help requested. For a list of possible values and how they affect the value to place in the <I>dwData</I> parameter, see the Remarks section.</DD>
<DT><I>dwData</I></DT>
<DD>Additional data. The value used depends on the value of the <I>uCommand</I> parameter. For a list of possible values, see the Remarks section.</DD>
</DL>
</BLOCKQUOTE>

<H4>Return Values</H4>
<BLOCKQUOTE><BR>
<P>Returns nonzero if successful, or zero otherwise.
<P>To get extended error information, call
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A>.
</BLOCKQUOTE>

<H4>Remarks</H4>
<BLOCKQUOTE><BR>
<P>Before closing the window that requested Help, the application must call <B>WinHelp</B> with the <I>uCommand</I> parameter set to HELP_QUIT. Until all applications have done this, Windows Help will not terminate. Note that calling Windows Help with the HELP_QUIT command is not necessary if you used the HELP_CONTEXTPOPUP command to start Windows Help.
<P>The following table shows the possible values for the <I>uCommand</I> parameter and the corresponding formats of the <I>dwData</I> parameter. 

<TABLE>
<TR><TD><B>uCommand</B></TD><TD><B>ActiondwData</B></TD></TR>
<TR><TD>HELP_COMMAND</TD><TD>Executes a Help macro or macro string. Address of a string that specifies the name of the Help macro(s) to run. If the string specifies multiple macro names, the names must be separated by semicolons. You must use the short form of the macro name for some macros because Windows Help does not support the long name.</TD><TD></TD></TR>
<TR><TD>HELP_CONTENTS</TD><TD>Displays the topic specified by the Contents option in the [OPTIONS] section of the .hpj file. This command is for backward compatibility. New applications should provide a .cnt file and use the HELP_FINDER command. Ignored, set to 0.</TD><TD></TD></TR>
<TR><TD>HELP_CONTEXT</TD><TD>Displays the topic identified by the specified context identifier defined in the [MAP] section of the .hpj file. Unsigned long integer containing the context identifier for the topic.</TD><TD></TD></TR>
<TR><TD>HELP_CONTEXTMENU</TD><TD>Displays the <A HREF="../AppHelp.htm#ch_help">Help</A> menu for the selected window, then displays the topic for the selected control in a pop-up window. Address of an array of double word pairs. The first double word in each pair is a control identifier, and the second is a context number for a topic.</TD><TD></TD></TR>
<TR><TD>HELP_CONTEXTPOPUP</TD><TD>Displays the topic identified by the specified context identifier defined in the [MAP] section of the .hpj file in a pop-up window. Unsigned long integer containing the context identifier for a topic.</TD><TD></TD></TR>
<TR><TD>HELP_FINDER</TD><TD>Displays the <B>Help Topics</B> dialog box. Ignored; set to 0.</TD><TD></TD></TR>
<TR><TD>HELP_FORCEFILE</TD><TD>Ensures that Windows Help is displaying the correct Help file. If the incorrect Help file is being displayed, Windows Help opens the correct one; otherwise, there is no action. Ignored, set to 0.</TD><TD></TD></TR>
<TR><TD>HELP_HELPONHELP</TD><TD>Displays Help on how to use Windows Help, if the <B>WINHLP32.HLP</B> file is available. Ignored, set to 0.</TD><TD></TD></TR>
<TR><TD>HELP_INDEX</TD><TD>Displays the topic specified by the Contents option in the [OPTIONS] section of the .hpj file. This command is for backward compatibility. New applications should use the HELP_FINDER command. Ignored, set to 0.</TD><TD></TD></TR>
<TR><TD>HELP_KEY</TD><TD>Displays the topic in the keyword table that matches the specified keyword, if there is an exact match. If there is more than one match, displays the Index with the topics listed in the <B>Topics Found</B> list box. Address of a keyword string. Multiple keywords must be separated by semicolons.</TD><TD></TD></TR>
<TR><TD>HELP_MULTIKEY</TD><TD>Displays the topic specified by a keyword in an alternative keyword table. Address of a <A HREF="../structures/MULTIKEYHELP.htm#MULTIKEYHELP">MULTIKEYHELP</A> structure that specifies a table footnote character and a keyword.</TD><TD></TD></TR>
<TR><TD>HELP_PARTIALKEY</TD><TD>Displays the topic in the keyword table that matches the specified keyword, if there is an exact match. If there is more than one match, displays the <B>Topics Found</B> dialog box. To display the Index without passing a keyword, you should use a pointer to an empty string. Address of a keyword string. Multiple keywords must be separated by semicolons.</TD><TD></TD></TR>
<TR><TD>HELP_QUIT</TD><TD>Informs Windows Help that it is no longer needed. If no other applications have asked for Help, Windows closes Windows Help. Ignored, set to 0.</TD><TD></TD></TR>
<TR><TD>HELP_SETCONTENTS</TD><TD>Specifies the Contents topic. Windows Help displays this topic when the user clicks the Contents button if the Help file does not have an associated .cnt file. Unsigned long integer containing the context identifier for the Contents topic.</TD><TD></TD></TR>
<TR><TD>HELP_SETPOPUP_POS</TD><TD>Sets the position of the subsequent pop-up window. Address of a
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>POINTS</A> structure. The pop-up window is positioned as if the mouse cursor were at the specified point when the pop-up window is invoked. </TD><TD></TD></TR>
<TR><TD>HELP_SETWINPOS</TD><TD>Displays the Help window, if it is minimized or in memory, and sets its size and position as specified. Address of a <A HREF="../structures/HELPWININFO.htm#HELPWININFO">HELPWININFO</A> structure that specifies the size and position of either a primary or secondary Help window.</TD><TD></TD></TR>
<TR><TD>HELP_TCARD</TD><TD>Indicates that a command is for a training card instance of Windows Help. Combine this command with other commands using the bitwise OR operator. Depends on the command with which this command is combined.</TD><TD></TD></TR>
<TR><TD>HELP_WM_HELP</TD><TD>Displays the topic for the control identified by the <I>hWndMain</I> parameter in a pop-up window.</TD><TD>Address of an array of double word pairs. The first double word in each pair is a control identifier, and the second is a context identifier for a topic.</TD></TR>
</TABLE>
</BLOCKQUOTE>

<H4>See Also</H4>
<BLOCKQUOTE><BR>
<P><A HREF="../structures/HELPWININFO.htm#HELPWININFO">HELPWININFO</A>, <A HREF="../structures/MULTIKEYHELP.htm#MULTIKEYHELP">MULTIKEYHELP</A>
</BLOCKQUOTE>


<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>