<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SHELLEXECUTEINFO</TITLE>

<META NAME=MS-HKWD CONTENT="SHELLEXECUTEINFO">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Windows Shell API">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="SHELLEXECUTEINFO"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="SHELLEXECUTEINFO"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="SHELLEXECUTEINFO"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../RefList.htm#ch_shell_ref">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="SHDESCRIPTIONID.htm">SHDESCRIPTIONID</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="SHELLFLAGSTATE.htm">SHELLFLAGSTATE</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>SHELLEXECUTEINFO</H1>
<BR CLEAR=ALL>
<PRE>typedef struct _SHELLEXECUTEINFO{
    DWORD cbSize; 
    ULONG fMask; 
    HWND hwnd; 
    LPCTSTR lpVerb; 
    LPCTSTR lpFile; 
    LPCTSTR lpParameters; 
    LPCTSTR lpDirectory; 
    int nShow; 
    HINSTANCE hInstApp; 
 
    // Optional members 
    LPVOID lpIDList; 
    LPCSTR lpClass; 
    HKEY hkeyClass; 
    DWORD dwHotKey; 
    HANDLE hIcon; 
    HANDLE hProcess; 
} SHELLEXECUTEINFO, FAR *LPSHELLEXECUTEINFO; 
 
</PRE>
<P>Contains information used by the <A HREF="../functions/ShellExecuteEx.htm#ShellExecuteEx">ShellExecuteEx</A> function.

<DL><DT><B>cbSize</B>
 </DT><DD>Size of the structure, in bytes. 
</DD><DT><B>fMask</B>
 </DT><DD>Array of flags that indicate the content and validity of the other structure members. This can be a combination of the following values:
<TABLE>
<TR><TD>SEE_MASK_CLASSKEY </TD><TD>Use the class key given by the <B>hkeyClass</B> member. </TD></TR>
<TR><TD>SEE_MASK_CLASSNAME </TD><TD>Use the class name given by the <B>lpClass</B> member. </TD></TR>
<TR><TD>SEE_MASK_CONNECTNETDRV </TD><TD>Validate the share and connect to a drive letter. The <B>lpFile</B> member is a Universal Naming Convention (UNC) path of a file on a network. </TD></TR>
<TR><TD>SEE_MASK_DOENVSUBST </TD><TD>Expand any environment variables specified in the string given by the <B>lpDirectory</B> or <B>lpFile</B> member. </TD></TR>
<TR><TD>SEE_MASK_FLAG_DDEWAIT </TD><TD>Wait for the DDE conversation to terminate before returning (if the <A HREF="../functions/ShellExecuteEx.htm#ShellExecuteEx">ShellExecuteEx</A> function causes a DDE conversation to start).</TD></TR>
<TR><TD>SEE_MASK_FLAG_NO_UI </TD><TD>Do not display an error message box if an error occurs. </TD></TR>
<TR><TD>SEE_MASK_HOTKEY </TD><TD>Use the hot key given by the <B>dwHotKey</B> member.</TD></TR>
<TR><TD>SEE_MASK_ICON </TD><TD>Use the icon given by the <B>hIcon</B> member.</TD></TR>
<TR><TD>SEE_MASK_IDLIST </TD><TD>Use the item identifier list given by the <B>lpIDList</B> member. </TD></TR>
<TR><TD>SEE_MASK_INVOKEIDLIST </TD><TD>Use the item identifier list given by the <B>lpIDList</B> member to invoke an application. If this member is NULL, the function creates an item identifier list and invokes the application. This flag overrides the SEE_MASK_IDLIST flag.</TD></TR>
<TR><TD>SEE_MASK_NOCLOSEPROCESS </TD><TD>Leave the process running after the <A HREF="../functions/ShellExecuteEx.htm#ShellExecuteEx">ShellExecuteEx</A> function exits. The <B>hProcess</B> member receives the handle to the process. </TD></TR>
</TABLE>
</DD><DT><B>hwnd</B>
 </DT><DD>Window handle to any message boxes that the system may produce while executing this function. 
</DD><DT><B>lpVerb</B>
 </DT><DD>Address of a string specifying the name of a verb. The verb specifies an action for the application to perform. This member defaults to Open if no verb is specified.
</DD><DT><B>lpFile</B>
 </DT><DD>Address of a null-terminated string that specifies the name of the file to open or print. The function can open an executable file or a document file, but it can only print a document file. If the path is not included with the name, the current directory is assumed. 
</DD><DT><B>lpParameters</B>
 </DT><DD>Address of a null-terminated string containing the application parameters. The parameters must be separated by spaces. To include double quotation marks, you must enclose the marks in double quotation marks, as in the following example:

<PRE>sei.lpParameters = "An example: \"\"\"quoted text\"\"\"";
</PRE>
<P>In this case, the application receives three parameters: An, example:, and "quoted text".
<P>If the <B>lpFile</B> member specifies a document file, this member should be NULL. 

</DD><DT><B>lpDirectory</B>
 </DT><DD>Address of a null-terminated string that specifies the name of the working directory. If this member is not specified, the current directory is used as the working directory.
</DD><DT><B>nShow</B>
 </DT><DD>Show flags. Can be one of the SW_ values described for the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>ShowWindow</A> function. If the <B>lpFile</B> specifies an executable file, this member specifies how the application is to be shown when it is opened. 
</DD><DT><B>hInstApp</B>
 </DT><DD>Receives a value greater than 32 if successful, or an error value that is less than or equal to 32 otherwise. Error values can be one of the following:
<TABLE>
<TR><TD> SE_ERR_FNF </TD><TD>File not found.</TD></TR>
<TR><TD>SE_ERR_PNF </TD><TD>Path not found.</TD></TR>
<TR><TD>SE_ERR_ACCESSDENIED </TD><TD>Access denied.</TD></TR>
<TR><TD>SE_ERR_OOM </TD><TD>Out of memory.</TD></TR>
<TR><TD>SE_ERR_DLLNOTFOUND </TD><TD>Dynamic-link library not found.</TD></TR>
<TR><TD>SE_ERR_SHARE </TD><TD>Cannot share an open file.</TD></TR>
<TR><TD>SE_ERR_ASSOCINCOMPLETE </TD><TD>File association information not complete.</TD></TR>
<TR><TD>SE_ERR_DDETIMEOUT </TD><TD>DDE operation timed out.</TD></TR>
<TR><TD>SE_ERR_DDEFAIL </TD><TD>DDE operation failed.</TD></TR>
<TR><TD>SE_ERR_DDEBUSY </TD><TD>DDE operation is busy.</TD></TR>
<TR><TD>SE_ERR_NOASSOC </TD><TD>File association not available.</TD></TR>
</TABLE>
</DD><DT><B>lpIDList</B>
 </DT><DD>Address of an <A HREF="ITEMIDLIST.htm#ITEMIDLIST">ITEMIDLIST</A> structure to contain an item identifier list uniquely identifying the file to execute. This member is ignored if the <B>fMask</B> member is not set to SEE_MASK_IDLIST. 
</DD><DT><B>lpClass</B>
 </DT><DD>Address of a null-terminated string specifying the name of a file class or a globally unique identifier (GUID).This member is ignored if <B>fMask</B> is not set to SEE_MASK_CLASSNAME.
</DD><DT><B>hkeyClass</B>
 </DT><DD>Handle to the registry key for the file class. This member is ignored if <B>fMask</B> is not set to SEE_MASK_CLASSKEY. 
</DD><DT><B>dwHotKey</B>
 </DT><DD>Hot key to associate with the application. The low-order word is the virtual key code, and the high-order word is a modifier flag (HOTKEYF_). For a list of modifier flags, see the description of the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>WM_SETHOTKEY</A> message. This member is ignored if <B>fMask</B> is not set to SEE_MASK_HOTKEY.
</DD><DT><B>hIcon</B>
 </DT><DD>Handle to the icon for the file class. This member is ignored if <B>fMask</B> is not set to SEE_MASK_ICON.
</DD><DT><B>hProcess</B>
 </DT><DD>Handle to the newly started application. This member is set on return and is always NULL if <B>fMask</B> is not set to SEE_MASK_NOCLOSEPROCESS.
</DD></DL>
<!--CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>