<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExtractIcon::GetIconLocation</TITLE>

<META NAME=MS-HKWD CONTENT="IExtractIcon::GetIconLocation">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Windows Shell API, interface">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="IExtractIcon_GetIconLocation"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IExtractIcon::GetIconLocation"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IExtractIcon::GetIconLocation"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../../RefList.htm#ch_shell_ref">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Extract.htm">IExtractIcon::Extract</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../ifileviewer/IFileViewer.htm">IFileViewer</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>IExtractIcon::GetIconLocation</H1>
<BR CLEAR=ALL>
<PRE>HRESULT GetIconLocation(
    UINT uFlags,
    LPSTR szIconFile,
    INT cchMax,
    LPINT piIndex,
    UINT *pwFlags
   );&#009;&#009;
</PRE>
<P>Retrieves the location and index of an icon.
<UL><LI>Returns NOERROR if the function returned a valid location, or S_FALSE if the shell should use a default icon.
</UL>
<DL><DT><I>uFlags</I>
 </DT><DD>Flags. This parameter can be zero or one or more of the following values: 
 <TABLE>
<TR><TD>GIL_ASYNC </TD><TD>The calling application supports asynchronous retrieval of icons. If the icon is cached by the receiving application, it should supply the icon and return S_OK. If the icon is not cached and must be retrieved, the receiving application should start an asynchronous icon retrieval operation, supply a default icon, and return E_PENDING. This method will be called again at a later time to attempt to retrieve the icon again. </TD></TR>
<TR><TD>GIL_FORSHELL </TD><TD>The icon is to be displayed in a shell folder. </TD></TR>
<TR><TD>GIL_OPENICON </TD><TD>The icon should be in the open state if both open- and closed-state images are available. If this flag is not specified, the icon should be in the normal or closed state. This flag is typically used for folder objects. </TD></TR>
</TABLE>
</DD><DT><I>szIconFile</I>
 </DT><DD>Address of the buffer that receives the icon location. The icon location is a null-terminated string that identifies the file that contains the icon. 
</DD><DT><I>cchMax</I>
 </DT><DD>Size of the buffer that receives the icon location.
</DD><DT><I>piIndex</I>
 </DT><DD>Address of an INT that receives the icon index, which further describes the icon location.
</DD><DT><I>pwFlags</I>
 </DT><DD>Address of a UINT value that receives zero or a combination of the following values: 
 <TABLE>
<TR><TD>GIL_DONTCACHE </TD><TD>The physical image bits for this icon should not be cached by the caller. This distinction is important to consider because a GIL_DONTCACHELOCATION flag may be introduced in future versions of the shell. </TD></TR>
<TR><TD>GIL_NOTFILENAME </TD><TD>The location is not a file name/index pair. Callers that decide to extract the icon from the location must call this object's <A HREF="Extract.htm#IExtractIcon_Extract">IExtractIcon::Extract</A> method to obtain the desired icon images. </TD></TR>
<TR><TD>GIL_PERCLASS </TD><TD>All objects of this class have the same icon. This flag is used internally by the shell. Typical implementations of <A HREF="IExtractIcon.htm#shell_iextracticon">IExtractIcon</A> do not require this flag because the flag implies that an icon handler is not required to resolve the icon on a per-object basis. The recommended method for implementing per-class icons is to register a DefaultIcon for the class. </TD></TR>
<TR><TD>GIL_PERINSTANCE </TD><TD>Each object of this class has its own icon. This flag is used internally by the shell to handle cases like Setup.exe, where objects with identical names can have different icons. Typical implementations of <A HREF="IExtractIcon.htm#shell_iextracticon">IExtractIcon</A> do not require this flag. </TD></TR>
<TR><TD>GIL_SIMULATEDOC </TD><TD>The caller should create a document icon using the specified icon. </TD></TR>
</TABLE>
</DD></DL>
<P>See also <A HREF="Extract.htm#IExtractIcon_Extract">IExtractIcon::Extract</A> 
<!-- *************************************************************************** -->
<!--CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>