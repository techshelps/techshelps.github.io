<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IReconcilableObject::Reconcile</TITLE>

<META NAME=MS-HKWD CONTENT="IReconcilableObject::Reconcile">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Windows Shell API, interface">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="IReconcilableObject_Reconcile"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IReconcilableObject::Reconcile"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IReconcilableObject::Reconcile"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../../RefList.htm#ch_shell_ref">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="GetProgressFeedbackMaxEstimate.htm">IReconcilableObject::GetProgressFeedbackMaxEstimate</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../ireconcileinitiator/IReconcileInitiator.htm">IReconcileInitiator</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>IReconcilableObject::Reconcile</H1>
<BR CLEAR=ALL>
<PRE>HRESULT IReconcilableObject::Reconcile(
    IReconcileInitiator *pInitiator,&#009;&#009;
    DWORD dwFlags,&#009;&#009;
    HWND hwndOwner,&#009;&#009;
    HWND hwndProgressFeedback,&#009;&#009;
    ULONG ulcInput,&#009;&#009;
    IMoniker **rgpmkOtherInput,&#009;&#009;
    LONG *plOutIndex,&#009;&#009;
    IStorage *pstgNewResidues,&#009;&#009;
    void *pvReserved&#009;&#009;
   );&#009;&#009;
</PRE>
<P>Reconciles the state of an object with one or more other objects. The reconciliation updates the internal state of the object by merging the states of all objects to form a combined state.

<UL><LI>Returns one of the following values if successful:
 <TABLE>
<TR><TD>S_OK </TD><TD>Reconciliation completed successfully, and the changes must be propagated to the other objects. </TD></TR>
<TR><TD>S_FALSE </TD><TD>No reconciliation actions were performed. The briefcase reconciler wishes to fall back to the initiator's bit copy implementation. This value may only be returned if RECONCILEF_ONLYYOUWERECHANGED is set in <I>dwFlags</I>. </TD></TR>
<TR><TD>REC_S_IDIDTHEUPDATES </TD><TD>Reconciliation was completed successfully, and all the objects involved (the object implementing the <B>Reconcile</B> method and all the other objects described by <I>rgpmkOtherInput</I>) have been updated appropriately. The initiator does not need, therefore, to do anything further to propagate the changes. The variable pointed to by <I>plOutIndex</I> should be set to -1L if <B>Reconcile</B> returns this value. The initiator will not save the source object's storage if <B>Reconcile</B> returns this value. This value may only be returned if RECONCILEF_YOUMAYDOTHEUPDATES was set in <I>dwFlags</I>. </TD></TR>
<TR><TD>REC_S_NOTCOMPLETE </TD><TD>The briefcase reconciler completed some, but not all, of the reconciliation. It may need user interaction. The changes will not be propagated to other objects. </TD></TR>
<TR><TD>REC_S_NOTCOMPLETEBUTPROPAGATE </TD><TD>The briefcase reconciler completed some, but not all, of the reconciliation. It may need user interaction. The changes will be propagated to the other objects. </TD></TR>
</TABLE>
<P>Otherwise, this method returns one of the following error values:
 <TABLE>
<TR><TD>REC_E_NORESIDUES </TD><TD>The briefcase reconciler does not support the generation of residues, so the request for residues is denied. The state of the object is unchanged. </TD></TR>
<TR><TD>REC_E_ABORTED </TD><TD>The briefcase reconciler stopped reconciliation in response to a termination request from the initiator (see <A HREF="../ireconcileinitiator/SetAbortCallback.htm#IReconcileInitiator_SetAbortCallback">IReconcileInitiator::SetAbortCallback</A> for more information). The state of the object is unspecified. </TD></TR>
<TR><TD>REC_E_TOODIFFERENT </TD><TD>Reconciliation cannot be carried out because the provided document versions are too dissimilar. </TD></TR>
<TR><TD>REC_E_INEEDTODOTHEUPDATES </TD><TD>The RECONCILEF_YOUMAYDOTHEUPDATES flag was not set when the object's <B>Reconcile</B> implementation was called; this implementation requires that this value be set in the <I>dwFlags</I> parameter. </TD></TR>
<TR><TD>OLE_E_NOTRUNNING </TD><TD>The object is an OLE embedded object that must be run before this operation can be carried out. The state of the object is unchanged. </TD></TR>
<TR><TD>E_UNEXPECTED </TD><TD>Unspecified error.  </TD></TR>
</TABLE>
</UL>
<DL><DT><I>pInitiator</I>
 </DT><DD>Address of the <A HREF="../ireconcileinitiator/IReconcileInitiator.htm#shell_ireconcileinitiator">IReconcileInitiator</A> interface for the initiator of the reconciliation process. This parameter must not be NULL.
</DD><DT><I>dwFlags</I>
 </DT><DD>Control flags for the reconciliation. This parameter may be zero or a combination of these values:
 <TABLE>
<TR><TD>RECONCILEF_FEEDBACKWINDOWVALID </TD><TD>The <I>hwndProgressFeedback</I> parameter is valid. </TD></TR>
<TR><TD>RECONCILEF_MAYBOTHERUSER </TD><TD>The briefcase reconciler can prompt for user interaction if it is needed. Without this value, user interaction is not permitted. The <I>hwndOwner</I> parameter is valid. </TD></TR>
<TR><TD>RECONCILEF_NORESIDUESOK </TD><TD>The briefcase reconciler can ignore requests for residues and carry out reconciliation. Reconcilers that do not support residues should check for this value whenever an initiator requests residues. Without this value, a reconciler that does not support residues must immediately return REC_E_NORESIDUES. </TD></TR>
<TR><TD>RECONCILEF_OMITSELFRESIDUE </TD><TD>The briefcase reconciler can discard any residue associated with this object. Initiators typically use this value for reconciliations that loop from generation to generation. </TD></TR>
<TR><TD>RECONCILEF_ONLYYOUWERECHANGED </TD><TD>The <B>Reconcile</B> method is being called to propagate changes in the changed object to other unchanged objects. This value will only be set if the following key exists in the registry.

<P><PRE>HKEY_CLASSES_ROOT\
   CLSID\
      &lt;clsid_of_reconciler&gt;\
         SingleChangeHook
</PRE>
<P>If this key is not present in the registry, the initiator carries out reconciliation by making the other unchanged objects binary identical copies of the changed object. The <I>rgpmkOtherInput</I> monikers identify the other objects. This value will only be set in <I>dwFlags</I> if RECONCILEF_YOUMAYDOTHEUPDATES is also set. If the briefcase reconciler completes the updates itself successfully, REC_S_IDIDTHEUPDATES should be returned and the variable pointed to by the <I>plOutIndex</I> parameter should be set to -1L. Note that S_OK should not be returned on success if this value is set in <I>dwFlags</I>. The initiator will not save the source object's storage if <B>Reconcile</B> returns REC_S_IDIDTHEUPDATES. If the reconciler wishes to fall back to the initiator's bit copy implementation, it may return S_FALSE.  </TD></TR>
<TR><TD>RECONCILEF_RESUMEDRECONCILIATION </TD><TD>The briefcase reconciler should resume reconciliation, using the partial residues provided. Without this value, the reconciler should ignore any "considered but rejected" information in any of the input versions. </TD></TR>
<TR><TD>RECONCILEF_YOUMAYDOTHEUPDATES </TD><TD>The briefcase reconciler can perform the updates. Without this value, the reconciler cannot perform the updates. If reconciliation is completed successfully, the reconciler should return REC_S_IDIDTHEUPDATES if it performed the updates or S_OK if it did not perform the updates.  </TD></TR>
</TABLE>
</DD><DT><I>hwndOwner</I>
 </DT><DD>Handle to the window to be used as the parent for any child windows that the briefcase reconciler creates. This parameter is valid only if RECONCILEF_MAYBOTHERUSER is specified in <I>dwFlags</I>.
</DD><DT><I>hwndProgressFeedback</I>
 </DT><DD>Handle to the progress feedback window to be displayed by the initiator. This parameter is valid only if RECONCILEF_FEEDBACKWINDOWVALID is specified in <I>dwFlags</I>. The briefcase reconciler may call the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>SetWindowText</A> function using this window handle to display additional reconciliation status information to the user.
</DD><DT><I>ulcInput</I>
 </DT><DD>Number of versions or partial residues specified in <I>dwFlags</I>. This parameter must not be zero.
</DD><DT><I>rgpmkOtherInput</I>
 </DT><DD>Address of an array that contains the addresses of the monikers to use to access the versions or partial residues to be reconciled.
</DD><DT><I>plOutIndex</I>
 </DT><DD>Address of the variable that receives an index value indicating whether the result of the reconciliation is identical to one of the initial versions. The variable is set to -1L if the reconciliation result is a combination of two or more versions. Otherwise, it is a zero-based index, with 0 indicating this object, 1 indicating the first version, 2 indicating the second version, and so on.
</DD><DT><I>pstgNewResidues</I>
 </DT><DD>Address of the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>IStorage</A> interface used to store the new residues. This parameter can be NULL to indicate that residues should not be saved.
</DD><DT><I>pvReserved</I>
 </DT><DD>Reserved; must be NULL.
</DD></DL>
<P>See also <A HREF="IReconcilableObject.htm#shell_ireconcilableobject">IReconcilableObject</A>
<!-- *************************************************************************** -->
<!--CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>