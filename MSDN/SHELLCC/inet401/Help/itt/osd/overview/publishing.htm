<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Publishing Applications to the Internet Using OSD</TITLE>

<META NAME=MS-HKWD CONTENT="Publishing Applications to the Internet Using OSD">
<META NAME="Keywords" CONTENT="OSD, Open Software Description, Software Update Channels, Publishing Applications">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="Publishing"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Publishing Applications to the Internet Using OSD"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Publishing Applications to the Internet Using OSD"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID="TOPIC_CONTENTS" HREF="overview.htm">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" ID="PRE_TOPIC" HREF="overview.htm">Open Software Description Overview</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" ID="NEXT_TOPIC" HREF="auto_update.htm">Automatically Updating ActiveX Controls</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>Publishing Applications to the Internet Using OSD</h1>

<p>This article describes how to use Microsoft&#174; Internet Explorer 4.01 support for the Channel Definition Format (CDF) and Open Software Description (OSD) to publish applications to the Internet.

<p>This article describes how to:

<ul>
<li>Prepare the application so it can utilize this functionally.
<li>Create a software update channel (described by a CDF file), which your users will subscribe to in order to receive updates.
<li>Utilize the OSD vocabulary inside the CDF file to describe new versions of your software.
</ul>

<h2>Notes and Requirements</h2>


<ul>
<li>This document applies to applications, not ActiveX&#153; Controls or Java applets.  For more information about updating an ActiveX control, see the <a href="auto_update.htm">Automatically Updating ActiveX Controls Using Software Update Channels</a> article.  For more information about Java applets, see the <a href="../../msicd/overview/cdlosd.htm">Extending Internet Component Download Using OSD</a> article.
<li>Users must have the Enable Scheduled Subscription Updates option set, or they must manually update their subscriptions to allow Internet Explorer 4.01 to check for updates.  This option is enabled by default.
</ul>



<h2>Preparing the Application</h2>

<p>Before creating a software update channel, the application should be prepared to handle two tasks:

<ul>
<li>Modifying the registry during setup to allow Internet Explorer to maintain the users' security settings and update their subscription to your channel.
<li>Modifying the shortcut to enable update notifications to be displayed to users when they use that shortcut to access your application.  This step is necessary only if you want the software update dialog box to appear when using the shortcut to the application when an update is available.
</ul>


<h3>Modifying the Registry to Maintain the User's Security Settings</h3>

<p>Because your users are receiving updates through the Internet, Internet Explorer respects the URL Security Zone setting you are in when making the software update. The behavior is as follows.

<table>
<tr>
<td><b>Security Zone level for your site</b></td>
<td><b>Software update channel behavior</b></td>
</tr>
<tr>
<td>High</td>
<td>No software update functions available</td>
</tr>
<tr>
<td>Medium</td>
<td>Requires the AuthorizedCDFPrefix (see below)</td>
</tr>
<tr>
<td>Low</td>
<td>All software update functions available</td>
</tr>
</table>

<p>For the medium setting, you must (during your installation routine) set the AuthorizedCDFPrefix key in the registry for your particular AppName (the Microsoft Application Logo 5 name). This authorizes particular URLs to notify the user of updates. The reason for this is security. By entering the URLs that are authorized to update your software, you prevent rogue sites from publishing false updates.

<p>AuthorizedCDFPrefix is a new key you must create under the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\&lt;Your App Name> branch of the registry. Any number of new string values is added to this key, each of which represents a location where Internet Explorer can get software updates. For example, if one of the strings is "http://testserver", any URL beginning with these letters is authorized to publish software updates. If you want to allow any site to publish updates, you can simply use "http:" as the string.



<h3>Modifying the shortcut</h3>

<p>In either the installation process for the software or the initial launch of the application, the shortcut to the application must be modified so that the system will be able to notify the user of any updates.  This also requires Internet Explorer 4.01 to work.  

<p><b>Note</b> Microsoft Installer (MSI) technology, which will be released in the near future, automatically generates modified shortcuts. 

<p>To modify the shortcut, you must do one of following: 

<ul>
<li>Call the following Windows&#174; function inside your installation code (or on the very first execution of your program) to create the shortcut:

<pre>IShellLink::SetPath(::{9db1186f-40df-11d1-aa8c-00c04fb67863}: AppName :: Path);
</pre>

<p>In this function, ::{9db1186f-40df-11d1-aa8c-00c04fb67863}: is a special identifier that should be used as listed; AppName is the name of your application in the registry's uninstall branch under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\&lt;Your App Name>, and Path is the path to the program (the normal target of the shortcut).
 
<li>"Bless" your shortcut after it is created using the Blesslnk tool provided by Microsoft in the \bin directory of the Internet Client SDK 4.01 refresh package. After placing your shortcut on the user's computer, you must run the following command:

<pre>Blesslnk -l AppName FullPath
</pre>

<p>where AppName is the name of your application in the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\&lt;Your App Name> branch of the registry, and FullPath is the full directory path to the shortcut.
</ul>




<h2>Creating the Software Update Channel</h2>

<p>Creating your own software update channel for Internet Explorer 4.01 is extremely easy. Simply use the following example, replacing the information with your own by following the simple steps below.

<pre>&lt;?XML version="1.0"?>

&lt;CHANNEL HREF="http://testserver/logo5/logo5.htm">
	&lt;TITLE>Green (MSAppLogo5) Test Channel&lt;/TITLE>
	&lt;LOGO HREF="http://testserver/logo5/green.ico" STYLE="icon"/>
	&lt;USAGE VALUE="SoftwareUpdate"/>
	&lt;SOFTPKG HREF="http://testserver/logo5/logo5.htm"
		NAME="{55272F7E-1B37-11D1-8933-00805F8A4D63}"
		VERSION="1,1,0,1"
		STYLE="MSAppLogo5"
		PRECACHE="yes"> 
		&lt;TITLE>Green&lt;/TITLE>
		&lt;ABSTRACT>Abstract: Green v1.1 application installed via channel&lt;/ABSTRACT>
		&lt;IMPLEMENTATION>
			&lt;CODEBASE HREF="http://testserver/logo5/green-x.exe" />
		&lt;/IMPLEMENTATION>
	&lt;/SOFTPKG>
&lt;/CHANNEL>
</pre>

<p>Make these changes to customize this example for your own software update channel:

<ol>
<li>Replace <B>CHANNEL HREF</B> 
to point to a URL that you want users to be sent to when they first subscribe to the channel and when they click the channel in the future.

<li>Change the <B>TITLE</B> to your own. This will show up in the Internet Explorer Favorites/Software Updates folder. This is usually your software's title plus the words "Update Channel".

<li>The <B>LOGO</B> is shown next to the <B>TITLE</B> in the Internet Explorer Software Updates folder. Choose your own custom icon or delete this tag (from &lt;LOGO to />) to use the default satellite dish logo from Internet Explorer.

<li>Replace <B>SOFTPKG HREF</B> to point to a URL that you want users to be sent to when an update is available. Initially (before there's a new version), if you don't know where the new information will be posted, you can point this to the same location as used for the <B>CHANNEL HREF</B>.

<li>Change the <B>NAME</B> to either a GUID (as shown) representing your software or to the application's name in the Uninstall branch of the registry (not the friendly name). If you don't know the name, run Regedit and look at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall to find the name. It will be listed under the Uninstall branch on the left.

<li>Change the <B>VERSION</B> number to your own. The version "a,b,c,d" is a.b.d.

<li>Change the <B>PRECACHE</B> to "no" if you do not want Internet Explorer to automatically receive the update at the subscription update time (either way, Internet Explorer will not install the update; it will simply make it available offline on the user's computer if you leave <B>PRECACHE</B> on).

<li>Change the <B>TITLE</B> to reflect your software's name. This will be shown in the update dialog box when the user is notified of an update.

<li>Change the <B>ABSTRACT</B> to give the user a description of the software. This will also be shown in the update dialog box.

<li>Change the <B>CODEBASE</B> to point to the URL of your software. This can point to a CAB or an EXE file. This does <i>not</i> point to an HTML page.
</ol>

<p>When you are done with these easy steps, put the CDF file on your Web server and request your users to subscribe to this channel when they come to your page. Your text can say, "Click here to subscribe to a channel to receive notifications of future updates of this software. You will remain anonymous, and we will not give out your name and address."




<h2>Handling Updates</h2>

<p>In the future, when the new version is available, you will need to change the CDF file on your Web server. On the next subscription update on your users' computers, they will get the new CDF. Make the following modifications:

<ol>
<li>Change the <B>VERSION</B> number to a larger number.

<li>Either overwrite the old CAB, EXE, or other file pointed to by the <b>CODEBASE</b> element with the new file, or change the <b>CODEBASE</b> to point to the new file.

<li>Replace the <b>SOFTPKG</b> <B>HREF</B> to point to the URL that you want the user to be sent to in order to read about the features and installation instructions of the new software.
</ol>

<p>After the next subscription update, the users can be notified of the new software in two ways:

<ul>
<li>If the shortcut to the application was modified, an update box (like the one below) will appear when they execute the shortcut to the application.

<p><img src="../../../art/ax_osd01.gif" width=363 height=154 border=0 alt="Software Update Dialog Box">

<p>Note that this requires the user to be running Internet Explorer 4.01 with the Windows Desktop Update. In addition, it requires a modification to the shortcut to your program. 

<li>In Internet Explorer, under Software Updates, there will be a gleam on your channel like the one shown here on the Circle Control channel.

<p><img src="../../../art/ax_osd02.gif" width=451 height=334 border=0 alt="Sample Software Update Menu">

<p>When the user clicks the gleaming channel, he or she will be taken to the page described by the &lt;SOFTPKG HREF=http://testserver/your_update_page.htm> tag to read about the update.  This page is also the page used to set up the program.
</ul>

<p>You can use this example with your own software update channel to get up and running very quickly.

<p>For additional information about the OSD vocabulary, see the specification at <a href="http://www.microsoft.com/standards/osd/">http://www.microsoft.com/standards/osd</a>. For additional information on CDF, see the specification at <a href="http://www.microsoft.com/standards/cdf-f.htm">http://www.microsoft.com/standards/cdf-f.htm</a>.  
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>