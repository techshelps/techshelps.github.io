<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FtpFindFirstFile</TITLE>

<META NAME=MS-HKWD CONTENT="FtpFindFirstFile">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="FtpFindFirstFile"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="FtpFindFirstFile"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="FtpFindFirstFile"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="FtpDeleteFile.htm">FtpDeleteFile</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="FtpGetCurrentDirectory.htm">FtpGetCurrentDirectory</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>FtpFindFirstFile</H1>

<PRE>HINTERNET FtpFindFirstFile(
    IN HINTERNET hFtpSession,
    IN LPCSTR lpszSearchFile,
    OUT LPWIN32_FIND_DATA lpFindFileData,
    IN DWORD dwFlags,
    IN DWORD dwContext
);
</PRE>
<P>Searches the specified directory of the given FTP session. File and directory entries are returned to the application in the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>WIN32_FIND_DATA</A> structure.

<UL><LI>Returns a valid handle for the request if the directory enumeration was started successfully; otherwise, returns NULL. To get a specific error message, call
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>GetLastError</A>. If the function finds no matching files, <B>GetLastError</B> returns ERROR_NO_MORE_FILES.

</UL>
<DL>
<DT><I>hFtpSession</I> </DT><DD>Valid handle to an FTP session returned from <A HREF="InternetConnect.htm#InternetConnect">InternetConnect</A>.
</DD><DT><I>lpszSearchFile</I> </DT><DD>Address of a null-terminated string that specifies a valid directory path or file name for the FTP server's file system. The string can contain wildcards, but no blank spaces are allowed. If the value of <I>lpszSearchFile</I> is NULL or if it is an empty string, it will find the first file in the current directory on the server.
</DD><DT><I>lpFindFileData</I> </DT><DD>Address of a
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>WIN32_FIND_DATA</A> structure that receives information about the found file or directory.
</DD><DT><I>dwFlags</I> </DT><DD>Application-defined value that associates this search with any application. Can be one of the following values:
<DL>
<DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_DONT_C">INTERNET_FLAG_DONT_CACHE</A> </DT><DD>Does not add the returned entity to the cache. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A>.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_HYPERL">INTERNET_FLAG_HYPERLINK</A> </DT><DD>Forces a reload if there was no Expires time and no Last-Modified time returned from the server when determining whether to reload the item from the network. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MAKE_P">INTERNET_FLAG_MAKE_PERSISTENT</A> </DT><DD>No longer supported.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MUST_C">INTERNET_FLAG_MUST_CACHE_REQUEST</A> </DT><DD>Causes a temporary file to be created if the file cannot be cached. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A>. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A> </DT><DD>Causes a temporary file to be created if the file cannot be cached. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A> </DT><DD>Does not add the returned entity to the cache. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RELOAD">INTERNET_FLAG_RELOAD</A> </DT><DD>Forces a download of the requested file, object, or directory listing from the origin server, not from the cache. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RESYNC">INTERNET_FLAG_RESYNCHRONIZE</A> </DT><DD>Causes the FTP resource to be reloaded from the server.
</DD></DL>
</DD><DT><I>dwContext</I> </DT><DD>Application-defined value that associates this search with any application data. This parameter is used only if the application has already called <A HREF="InternetSetStatusCallback.htm#InternetSetStatusCal">InternetSetStatusCallback</A> to set up a status callback function.
</DD></DL>
<P>This function enumerates both files and directories.

<P><B>FtpFindFirstFile</B> is similar to the Win32
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>FindFirstFile</A> function. Note, however, that only one <B>FtpFindFirstFile</B> can occur at a time within a given FTP session. The enumerations, therefore, are correlated with the FTP session handle. This is because the FTP protocol allows only a single directory enumeration per session.

<P>After calling <B>FtpFindFirstFile</B> and until calling <A HREF="InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A>, the application cannot call <B>FtpFindFirstFile</B> again on the given FTP session handle. If a call is made to <B>FtpFindFirstFile</B> on that handle, the function will fail with ERROR_FTP_TRANSFER_IN_PROGRESS.

<P>After beginning a directory enumeration with <B>FtpFindFirstFile</B>, the <A HREF="InternetFindNextFile.htm#InternetFindNextFile">InternetFindNextFile</A> function can be used to continue the enumeration.

<P>The <A HREF="InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A> function is used to close the handle returned from <B>FtpFindFirstFile</B>. If <B>InternetCloseHandle</B> closes the handle before <A HREF="InternetFindNextFile.htm#InternetFindNextFile">InternetFindNextFile</A> fails with ERROR_NO_MORE_FILES, the directory enumeration will be terminated.

<P>Because the FTP protocol provides no standard means of enumerating, some of the common information about files, such as file creation date and time, is not always available or correct. When this happens, <B>FtpFindFirstFile</B> and <A HREF="InternetFindNextFile.htm#InternetFindNextFile">InternetFindNextFile</A> fill in unavailable information with a best guess based on available information. For example, creation and last access dates will often be the same as the file's modification date.

<P>The application cannot call <B>FtpFindFirstFile</B> between calls to <A HREF="FtpOpenFile.htm#FtpOpenFile">FtpOpenFile</A> and <A HREF="InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A>.

<P>See also <A HREF="InternetSetStatusCallback.htm#InternetSetStatusCal">InternetSetStatusCallback</A>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>