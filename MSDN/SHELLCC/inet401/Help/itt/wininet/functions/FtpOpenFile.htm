<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FtpOpenFile</TITLE>

<META NAME=MS-HKWD CONTENT="FtpOpenFile">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="FtpOpenFile"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="FtpOpenFile"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="FtpOpenFile"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="FtpGetFile.htm">FtpGetFile</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="FtpPutFile.htm">FtpPutFile</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>FtpOpenFile</H1>

<PRE>HINTERNET FtpOpenFile(
    IN HINTERNET hFtpSession,
    IN LPCSTR lpszFileName,
    IN DWORD fdwAccess,
    IN DWORD dwFlags,
    IN DWORD dwContext
);
</PRE>
<P>Initiates access to a remote file for writing or reading.

<UL><LI>Returns a handle if successful, or NULL otherwise. To get a specific error message, call
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A>.

</UL>
<DL>
<DT><I>hFtpSession</I> </DT><DD>Valid handle to an FTP session.
</DD><DT><I>lpszFileName</I> </DT><DD>Address of a null-terminated string that contains the name of the file to access on the remote system.
</DD><DT><I>fdwAccess</I> </DT><DD>Value that determines how the file will be accessed. This can be GENERIC_READ or GENERIC_WRITE, but not both.
</DD><DT><I>dwFlags</I> </DT><DD>Conditions under which the transfers occur. The application should select one transfer type and any of the flags that control how the caching of the file will be controlled. The transfer type can be any one of the following values:
<DL>
<DT>FTP_TRANSFER_TYPE_ASCII </DT><DD>Transfers the file using FTP's ASCII (Type A) transfer method. Control and formatting information is converted to local equivalents.
</DD><DT>FTP_TRANSFER_TYPE_BINARY </DT><DD>Transfers the file using FTP's Image (Type I) transfer method. The file is transferred exactly as it exists with no changes. This is the default transfer method.
</DD><DT>FTP_TRANSFER_TYPE_UNKNOWN </DT><DD>Defaults to FTP_TRANSFER_TYPE_BINARY.
</DD><DT>INTERNET_FLAG_TRANSFER_ASCII </DT><DD>Transfers the file as ASCII. 
</DD><DT>INTERNET_FLAG_TRANSFER_BINARY </DT><DD>Transfers the file as binary. 
</DD></DL>
<P>The following values are used to control the caching of the file. The application can use one or more of the following values:

<DL>
<DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_DONT_C">INTERNET_FLAG_DONT_CACHE</A> </DT><DD>Does not cache the data, either locally or in any gateways. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A>.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_HYPERL">INTERNET_FLAG_HYPERLINK</A> </DT><DD>Forces a reload if there was no Expires time and no Last-Modified time returned from the server when determining whether to reload the item from the network.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MAKE_P">INTERNET_FLAG_MAKE_PERSISTENT</A> </DT><DD>No longer supported.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MUST_C">INTERNET_FLAG_MUST_CACHE_REQUEST</A>
</DT><DD>Causes a temporary file to be created if the file cannot be cached. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A>.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A> </DT><DD>Causes a temporary file to be created if the file cannot be cached. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A> </DT><DD>Does not cache the data, either locally or in any gateways.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RELOAD">INTERNET_FLAG_RELOAD</A> </DT><DD>Forces a download of the requested file, object, or directory listing from the origin server, not from the cache.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RESYNC">INTERNET_FLAG_RESYNCHRONIZE</A> </DT><DD>Causes the FTP resource to be reloaded from the server.
</DD></DL>
</DD><DT><I>dwContext</I> </DT><DD>Application-defined value that associates this search with any application data. This is only used if the application has already called <A HREF="InternetSetStatusCallback.htm#InternetSetStatusCal">InternetSetStatusCallback</A> to set up a status callback function.
</DD></DL>
<P> 


<B>FtpOpenFile</B> should be used in the following situations:
<UL><LI>An application has data it needs to send to an FTP server to be created as a file on the FTP server, but the application does not have a local file containing the data. After the file is opened with <B>FtpOpenFile</B>, the application uses <A HREF="InternetWriteFile.htm#InternetWriteFile">InternetWriteFile</A> to send the FTP file data to the server.
<LI>An application needs to retrieve a file from the server into application-controlled memory, instead of writing the file to disk. The application uses <A HREF="InternetReadFile.htm#InternetReadFile">InternetReadFile</A> after using <B>FtpOpenFile</B> to open the file.
<LI>An application needs a fine level of control over a file transfer. For example, the application may need to display a progress indicator when downloading a file to indicate to the user that the file transfer is or is not proceeding correctly.
</UL>
<P>After calling <B>FtpOpenFile</B> and until calling <A HREF="InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A>, all other calls to FTP functions on the same FTP session handle will fail and set the error message to ERROR_FTP_TRANSFER_IN_PROGRESS. 

<P>Only one file can be open in a single FTP session. Therefore, no file handle is returned and the application simply uses the FTP session handle when necessary.

<P>The <I>lpszFile</I> parameter can be either partially or fully qualified file names relative to the current directory. A backslash (\) or forward slash (/) can be used as the directory separator for either name. <B>FtpOpenFile</B> translates the directory name separators to the appropriate character before they are used.

<P>The <A HREF="InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A> function is used to close the handle returned from <B>FtpOpenFile</B>. If <B>InternetCloseHandle</B> closes the handle before all the data has been transferred, the transfer is terminated.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>