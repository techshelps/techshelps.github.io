<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HttpQueryInfo</TITLE>

<META NAME=MS-HKWD CONTENT="HttpQueryInfo">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="HttpQueryInfo"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="HttpQueryInfo"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="HttpQueryInfo"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="HttpOpenRequest.htm">HttpOpenRequest</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="HttpSendRequest.htm">HttpSendRequest</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>HttpQueryInfo</H1>

<PRE>BOOL HttpQueryInfo(
    IN HINTERNET hHttpRequest,
    IN DWORD dwInfoLevel,
    IN LPVOID lpvBuffer,
    IN LPDWORD lpdwBufferLength,
    IN OUT LPDWORD lpdwIndex,
);
</PRE>
<P>Queries for information about an HTTP request.

<UL><LI>Returns TRUE if successful, or FALSE otherwise. To get extended error information, call
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A>.


</UL>
<DL>
<DT><I>hHttpRequest</I> </DT><DD>Open HTTP request handle returned by <A HREF="HttpOpenRequest.htm#HttpOpenRequest">HttpOpenRequest</A> or <A HREF="InternetOpenUrl.htm#InternetOpenUrl">InternetOpenUrl</A>.
</DD><DT><I>dwInfoLevel</I> </DT><DD>Combination of the attribute to query and the flags that modify the request. The attributes can be any of the following values:



<DL>
<DT>HTTP_QUERY_ACCEPT </DT><DD>Retrieves the acceptable media types for the response.
</DD><DT>HTTP_QUERY_ACCEPT_CHARSET </DT><DD>Retrieves the acceptable character sets for the response.
</DD><DT>HTTP_QUERY_ACCEPT_ENCODING </DT><DD>Retrieves the acceptable content-coding values for the response.
</DD><DT>HTTP_QUERY_ACCEPT_LANGUAGE </DT><DD>Retrieves the acceptable natural languages for the response.
</DD><DT>HTTP_QUERY_ACCEPT_RANGES </DT><DD>Retrieves the types of range requests that are accepted for a resource.
</DD><DT>HTTP_QUERY_AGE </DT><DD>Retrieves the Age response-header field, which contains the sender's estimate of the amount of time since the response was generated at the origin server. </DD><DT>HTTP_QUERY_ALLOW </DT><DD>Receives the methods supported by the server.
</DD><DT>HTTP_QUERY_AUTHORIZATION </DT><DD>Retrieves the authorization credentials used for a request.
</DD><DT>HTTP_QUERY_CACHE_CONTROL </DT><DD>Retrieves the cache control directives.
</DD><DT>HTTP_QUERY_CONNECTION </DT><DD>Retrieves any options that are specified for a particular connection and must not be communicated by proxies over further connections.
</DD><DT>HTTP_QUERY_COOKIE </DT><DD>Retrieves any cookies associated with the request.
</DD><DT>HTTP_QUERY_CONTENT_BASE </DT><DD>Retrieves the base URI for resolving relative URLs within the entity.
</DD><DT>HTTP_QUERY_CONTENT_DESCRIPTION </DT><DD>Obsolete. Maintained for legacy application compatibility only.
</DD><DT>HTTP_QUERY_CONTENT_DISPOSITION </DT><DD>Obsolete. Maintained for legacy application compatibility only.
</DD><DT>HTTP_QUERY_CONTENT_ENCODING </DT><DD>Receives any additional content codings that have been applied to the entire resource.
</DD><DT>HTTP_QUERY_CONTENT_ID </DT><DD>Receives the content identification.
</DD><DT>HTTP_QUERY_CONTENT_LANGUAGE </DT><DD>Receives the language that the content is in.
</DD><DT>HTTP_QUERY_CONTENT_LENGTH </DT><DD>Receives the size of the resource, in bytes.
</DD><DT>HTTP_QUERY_CONTENT_LOCATION </DT><DD>Retrieves the resource location for the entity enclosed in the message.
</DD><DT>HTTP_QUERY_CONTENT_MD5 </DT><DD>Retrieves a MD5 digest of the entity-body for the purpose of providing an end-to-end message integrity check (MIC) for the entity-body. For more information, see RFC1864, <I>The Content-MD5 Header Field</I>, at <A HREF="http://ds.internic.net/rfc/rfc1864.txt" TARGET="_top">http://ds.internic.net/rfc/rfc1864.txt</A><IMG SRC="../../../art/external.gif" WIDTH="19" HEIGHT="8" ALT="External Link" > for more information.
</DD><DT>HTTP_QUERY_CONTENT_RANGE </DT><DD>Retrieves the location in the full entity-body where the partial entity-body should be inserted and the total size of the full entity-body.
</DD><DT>HTTP_QUERY_CONTENT_TRANSFER_ENCODING </DT><DD>Receives the additional content coding that has been applied to the resource.
</DD><DT>HTTP_QUERY_CONTENT_TYPE </DT><DD>Receives the content type of the resource (such as text/html). 
</DD><DT>HTTP_QUERY_COST </DT><DD>No longer implemented.
</DD><DT>HTTP_QUERY_DATE </DT><DD>Receives the date and time at which the message was originated.
</DD><DT>HTTP_QUERY_DERIVED_FROM </DT><DD>No longer supported.
</DD><DT>HTTP_QUERY_ETAG </DT><DD>Retrieves the entity tag for the associated entity.
</DD><DT>HTTP_QUERY_EXPIRES </DT><DD>Receives the date and time after which the resource should be considered outdated.
</DD><DT>HTTP_QUERY_FORWARDED </DT><DD>Obsolete. Maintained for legacy application compatibility only.
</DD><DT>HTTP_QUERY_FROM </DT><DD>Retrieves the e-mail address for the human user who controls the requesting user agent if the From header is given.
</DD><DT>HTTP_QUERY_HOST </DT><DD>Retrieves the Internet host and port number of the resource being requested.
</DD><DT>HTTP_QUERY_IF_MATCH </DT><DD>Retrieves the contents of the If-Match request-header field.
</DD><DT>HTTP_QUERY_IF_MODIFIED_SINCE </DT><DD>Retrieves the contents of the If-Modified-Since header.
</DD><DT>HTTP_QUERY_IF_NONE_MATCH </DT><DD>Retrieves the contents of the If-None-Match request-header field.
</DD><DT>HTTP_QUERY_IF_RANGE </DT><DD>Retrieves the contents of the If-Range request-header field. This header allows the client application to check if the entity related to a partial copy of the entity in the client application's cache has not been updated. If the entity has not been updated, send the parts that the client application is missing. If the entity has been updated, send the entire updated entity.
</DD><DT>HTTP_QUERY_IF_UNMODIFIED_SINCE </DT><DD>Retrieves the contents of the If-Unmodified-Since request-header field.
</DD><DT>HTTP_QUERY_LINK </DT><DD>Obsolete. Maintained for legacy application compatibility only.
</DD><DT>HTTP_QUERY_LAST_MODIFIED </DT><DD>Receives the date and time at which the server believes the resource was last modified.
</DD><DT>HTTP_QUERY_LOCATION </DT><DD>Retrieves the absolute URI used in a Location response-header.
</DD><DT>HTTP_QUERY_MAX </DT><DD>Retrieves the maximum value of an HTTP_QUERY_* value.
</DD><DT>HTTP_QUERY_MAX_FORWARDS </DT><DD>Retrieves the number of proxies or gateways that can forward the request to the next inbound server.
</DD><DT>HTTP_QUERY_MESSAGE_ID </DT><DD>No longer implemented.
</DD><DT>HTTP_QUERY_MIME_VERSION </DT><DD>Receives the version of the MIME protocol that was used to construct the message.
</DD><DT>HTTP_QUERY_ORIG_URI </DT><DD>Obsolete. Maintained for legacy application compatibility only.
</DD><DT>HTTP_QUERY_PRAGMA </DT><DD>Receives the implementation-specific directives that may apply to any recipient along the request/response chain.
</DD><DT>HTTP_QUERY_PROXY_AUTHENTICATE </DT><DD>Retrieves the authentication scheme and realm returned by the proxy.
</DD><DT>HTTP_QUERY_PROXY_AUTHORIZATION </DT><DD>Retrieves the header that is used to identify the user to a proxy that requires authentication.
</DD><DT>HTTP_QUERY_PUBLIC </DT><DD>Receives methods available at this server.
</DD><DT>HTTP_QUERY_RANGE </DT><DD>Retrieves the byte range of an entity.
</DD><DT>HTTP_QUERY_RAW_HEADERS </DT><DD>Receives all the headers returned by the server. Each header is terminated by "\0". An additional "\0" terminates the list of headers.
</DD><DT>HTTP_QUERY_RAW_HEADERS_CRLF </DT><DD>Receives all the headers returned by the server. Each header is separated by a carriage return/line feed (CR/LF) sequence.
</DD><DT>HTTP_QUERY_REFERER </DT><DD>Receives the URI of the resource where the requested URI was obtained.
</DD><DT>HTTP_QUERY_REFRESH </DT><DD>Obsolete. Maintained for legacy application compatibility only.
</DD><DT>HTTP_QUERY_REQUEST_METHOD </DT><DD>Receives the verb that is being used in the request, typically GET or POST.
</DD><DT>HTTP_QUERY_RETRY_AFTER </DT><DD>Retrieves the amount of time the service is expected to be unavailable.
</DD><DT>HTTP_QUERY_SERVER </DT><DD>Retrieves information about the software used by the origin server to handle the request.
</DD><DT>HTTP_QUERY_SET_COOKIE </DT><DD>Receives the value of the cookie set for the request.
</DD><DT>HTTP_QUERY_STATUS_CODE </DT><DD>Receives the status code returned by the server. For a list of possible values, see <A HREF="../constants/statuscodes.htm#wininet_statuscodes">HTTP Status Codes</A>.
</DD><DT>HTTP_QUERY_STATUS_TEXT </DT><DD>Receives any additional text returned by the server on the response line.
</DD><DT>HTTP_QUERY_TITLE </DT><DD>Obsolete. Maintained for legacy application compatibility only.
</DD><DT>HTTP_QUERY_TRANSFER_ENCODING </DT><DD>Retrieves the type of transformation that has been applied to the message body so it can be safely transferred between the sender and recipient.
</DD><DT>HTTP_QUERY_UPGRADE </DT><DD>Retrieves the additional communication protocols that are supported by the server.
</DD><DT>HTTP_QUERY_URI  </DT><DD>Receives some or all of the Uniform Resource Identifiers (URIs) by which the Request-URI resource can be identified.
</DD><DT>HTTP_QUERY_USER_AGENT </DT><DD>Retrieves information about the user agent that made the request.
</DD><DT>HTTP_QUERY_VARY </DT><DD>Retrieves the header that indicates that the entity was selected from a number of available representations of the response using server-driven negotiation.
</DD><DT>HTTP_QUERY_VERSION </DT><DD>Receives the last response code returned by the server.
</DD><DT>HTTP_QUERY_VIA </DT><DD>Retrieves the intermediate protocols and recipients between the user agent and the server on requests, and between the origin server and the client on responses.
</DD><DT>HTTP_QUERY_WARNING </DT><DD>Retrieves additional information about the status of a response that may not be reflected by the response status code.
</DD><DT>HTTP_QUERY_WWW_AUTHENTICATE </DT><DD>Retrieves the authentication scheme and realm returned by the server.
</DD></DL>
<P>The following modifiers can be used with the information values:
<DL>
<DT>HTTP_QUERY_CUSTOM </DT><DD>Causes <B>HttpQueryInfo</B> to search for the header name specified in <I>lpvBuffer</I> and store the header information in <I>lpvBuffer</I>.
</DD><DT>HTTP_QUERY_FLAG_COALESCE </DT><DD>Combines the values from headers with the same name into the output buffer.
</DD><DT>HTTP_QUERY_FLAG_NUMBER </DT><DD>Returns the data as a 32-bit number for headers whose value is a number, such as the status code.
</DD><DT>HTTP_QUERY_FLAG_REQUEST_HEADERS </DT><DD>Queries request headers only.
</DD><DT>HTTP_QUERY_FLAG_SYSTEMTIME </DT><DD>Returns the header value as a standard Win32
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>SYSTEMTIME</A> structure, which does not require the application to parse the data. Use for headers whose value is a date/time string, such as "Last-Modified-Time". 
</DD></DL>
</DD><DT><I>lpvBuffer</I> </DT><DD>Address of the buffer that receives the information.
</DD><DT><I>lpdwBufferLength</I> </DT><DD>Address of a value that contains the length of the data buffer. When the function returns, this parameter contains the address of a value specifying the length of the information written to the buffer. When the function returns strings, the following rules apply:
<UL><LI>If the function succeeds, <I>lpdwBufferLength</I> specifies the length of the string, in characters, minus 1 for the terminating null. 
<LI>If the function fails and ERROR_INSUFFICIENT_BUFFER is returned, <I>lpdwBufferLength</I> specifies the number of bytes that the application must allocate to receive the string.
</UL>
</DD><DT><I>lpdwIndex</I> </DT><DD>Address of a zero-based header index used to enumerate multiple headers with the same name. When calling the function, this parameter is the index of the specified header to return. When the function returns, this parameter is the index of the next header. If the next index cannot be found, ERROR_HTTP_HEADER_NOT_FOUND is returned.
</DD></DL>
<P><B>HttpQueryInfo</B> is used to return response or request headers from an HTTP request. 
<P>You can retrieve different types of data from <B>HttpQueryInfo</B>:
<UL><LI>strings (default)
<LI>SYSTEMTIME (for Data: Expires:, headers)
<LI>DWORD (for STATUS_CODE, CONTENT_LENGTH, and so on if HTTP_QUERY_INFO_NUMBER has been used)
</UL>
<P>See also <A HREF="HttpOpenRequest.htm#HttpOpenRequest">HttpOpenRequest</A>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>