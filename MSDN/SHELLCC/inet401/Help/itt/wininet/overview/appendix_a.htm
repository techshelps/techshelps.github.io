<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Appendix A: HINTERNET Handles</TITLE>

<META NAME=MS-HKWD CONTENT="Appendix A: HINTERNET Handles">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="HINTERNET"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Appendix A: HINTERNET Handles"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Appendix A: HINTERNET Handles"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="introduction.htm#ch_winineto">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="cache.htm">Caching</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="appendix_b.htm">Appendix B: Using Buffers</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Appendix A: HINTERNET Handles</H1>

<P>This section contains information about the handles that are used by the Win32 Internet functions and the hierarchy that they work in.


<H2><A NAME="About_HINTERNET_Hand">About HINTERNET Handles</A></H2>
<P>The handles that are created and used by the Win32 Internet functions are called HINTERNETs. The Win32 Internet functions return HINTERNET handles that are not interchangeable with the base Win32 handles, so they cannot be used with Win32 functions such as
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>ReadFile</A> or
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>CloseHandle</A>. Similarly, base Win32 handles cannot be used with the Win32 Internet functions. For example, a handle returned by
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>CreateFile</A> cannot be passed to <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A>.

<P>The <A HREF="../functions/InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A> function closes handles of type HINTERNET. Note that handle values are recycled quickly; therefore, if a handle is closed and a new handle is generated immediately, there is a good chance that the new handle will have the same value as the handle just closed.


<H2><A NAME="Handle_Hierarchy">Handle Hierarchy</A></H2>
<P>The HINTERNET handles are maintained in a tree hierarchy. The handle returned by the <A HREF="../functions/InternetOpen.htm#InternetOpen">InternetOpen</A> function is the root node. Handles returned by the <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A> function occupy the next level. Handles returned by the <A HREF="../functions/FtpFindFirstFile.htm#FtpFindFirstFile">FtpFindFirstFile</A>, <A HREF="../functions/FtpOpenFile.htm#FtpOpenFile">FtpOpenFile</A>, <A HREF="../functions/GopherFindFirstFile.htm#GopherFindFirstFile">GopherFindFirstFile</A>, <A HREF="../functions/GopherOpenFile.htm#GopherOpenFile">GopherOpenFile</A>, and <A HREF="../functions/HttpOpenRequest.htm#HttpOpenRequest">HttpOpenRequest</A> functions are the leaf nodes. 

<P>The following diagram illustrates the hierarchy of the HINTERNET handles. Each box in the diagram represents a Win32 Internet function that returns an HINTERNET handle.

<P>
<P><IMG SRC="../../../art/AX_WNT01.gif" WIDTH="357" HEIGHT="223" ALT="Functions That Create Handles" >
<P>
<P>At the top level is the <A HREF="../functions/InternetOpen.htm#InternetOpen">InternetOpen</A> function, which creates the root HINTERNET handle. The next level contains the <A HREF="../functions/InternetOpenUrl.htm#InternetOpenUrl">InternetOpenUrl</A> and <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A> functions. The functions that use the HINTERNET handle returned by <B>InternetConnect</B> make up the last level.

<P>The following diagram shows the functions that are dependent on the HINTERNET handle created by <A HREF="../functions/InternetOpenUrl.htm#InternetOpenUrl">InternetOpenUrl</A>. The shaded boxes represent functions that return HINTERNET handles, while the plain boxes represent functions that use the HINTERNET handle created by the associated function.

<P>
<P><IMG SRC="../../../art/AX_WNT02.gif" WIDTH="175" HEIGHT="140" ALT="Functions That Use The InternetOpenUrl Handle" >
<P>

<P><A HREF="../functions/InternetQueryDataAvailable.htm#InternetQueryDataAva">InternetQueryDataAvailable</A>, <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A>, and <A HREF="../functions/InternetSetFilePointer.htm#InternetSetFilePoint">InternetSetFilePointer</A> use the HINTERNET handle created by <A HREF="../functions/InternetOpenUrl.htm#InternetOpenUrl">InternetOpenUrl</A>.


<H3><A NAME="FTP_hierarchy">FTP hierarchy</A></H3>
<P>The following diagram shows the FTP functions that are dependent on the FTP session HINTERNET handle returned by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>. The shaded boxes represent functions that return HINTERNET handles, while the plain boxes represent functions that use the HINTERNET handle created by the function on which they depend.

<P>
<P><IMG SRC="../../../art/AX_WNT06.gif" WIDTH="174" HEIGHT="281" ALT="Functions That Use The FTP Session Handle" >
<P>

<P><A HREF="../functions/FtpCreateDirectory.htm#FtpCreateDirectory">FtpCreateDirectory</A>, <A HREF="../functions/FtpDeleteFile.htm#FtpDeleteFile">FtpDeleteFile</A>, <A HREF="../functions/FtpGetCurrentDirectory.htm#FtpGetCurrentDirecto">FtpGetCurrentDirectory</A>, <A HREF="../functions/FtpGetFile.htm#FtpGetFile">FtpGetFile</A>, <A HREF="../functions/FtpPutFile.htm#FtpPutFile">FtpPutFile</A>, <A HREF="../functions/FtpRemoveDirectory.htm#FtpRemoveDirectory">FtpRemoveDirectory</A>, <A HREF="../functions/FtpRenameFile.htm#FtpRenameFile">FtpRenameFile</A>, and <A HREF="../functions/FtpSetCurrentDirectory.htm#FtpSetCurrentDirecto">FtpSetCurrentDirectory</A> all use the HINTERNET handle created by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>.

<P>The following diagram shows the two FTP functions that return HINTERNET handles and the functions that are dependent on the HINTERNET handles created by them. The shaded boxes represent functions that return HINTERNET handles, while the plain boxes represent functions that use the HINTERNET handle created by the function on which they depend.

<P>
<P><IMG SRC="../../../art/AX_WNT03.gif" WIDTH="365" HEIGHT="183" ALT="Functions that use the handle from FtpOpen and FtpFindFirstFile" >
<P>

<P><A HREF="../functions/InternetFindNextFile.htm#InternetFindNextFile">InternetFindNextFile</A> is dependent on the HINTERNET handle created by <A HREF="../functions/FtpFindFirstFile.htm#FtpFindFirstFile">FtpFindFirstFile</A>, while <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A> and <A HREF="../functions/InternetWriteFile.htm#InternetWriteFile">InternetWriteFile</A> use the HINTERNET handle created by <A HREF="../functions/FtpOpenFile.htm#FtpOpenFile">FtpOpenFile</A>.



<H3><A NAME="Gopher_hierarchy">Gopher hierarchy</A></H3>
<P>The following diagram shows the Win32 Internet functions used for the Gopher protocol. The shaded boxes represent functions that return HINTERNET handles, while the plain boxes represent functions that use the HINTERNET handle created by the function on which they depend.

<P>
<P><IMG SRC="../../../art/AX_WNT04.gif" WIDTH="528" HEIGHT="147" ALT="Gopher Related Functions" >
<P>

<P><A HREF="../functions/GopherGetAttribute.htm#GopherGetAttribute">GopherGetAttribute</A> is dependent on the HINTERNET handle created by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>. <A HREF="../functions/InternetFindNextFile.htm#InternetFindNextFile">InternetFindNextFile</A> uses the HINTERNET handle created by <A HREF="../functions/GopherFindFirstFile.htm#GopherFindFirstFile">GopherFindFirstFile</A>. The handle created by <A HREF="../functions/GopherOpenFile.htm#GopherOpenFile">GopherOpenFile</A> is used by <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A> and <A HREF="../functions/InternetQueryDataAvailable.htm#InternetQueryDataAva">InternetQueryDataAvailable</A>.



<H3><A NAME="HTTP_hierarchy">HTTP hierarchy</A></H3>
<P>The following diagram shows the relationships of the Win32 Internet functions that are used for the HTTP protocol. The shaded boxes represent functions that return HINTERNET handles, while the plain boxes represent functions that use the HINTERNET handle created by the function on which they depend.

<P>
<P><IMG SRC="../../../art/AX_WNT05.gif" WIDTH="177" HEIGHT="230" ALT="Functions that use the handle from HttpOpenRequest" >
<P>

<P><A HREF="../functions/HttpAddRequestHeaders.htm#HttpAddRequestHeader">HttpAddRequestHeaders</A>, <A HREF="../functions/HttpQueryInfo.htm#HttpQueryInfo">HttpQueryInfo</A>, <A HREF="../functions/HttpSendRequest.htm#HttpSendRequest">HttpSendRequest</A>, <A HREF="../functions/HttpSendRequestEx.htm#HttpSendRequestEx">HttpSendRequestEx</A>, and <A HREF="../functions/InternetErrorDlg.htm#InternetErrorDlg">InternetErrorDlg</A> are dependent on the HINTERNET handle created by <A HREF="../functions/HttpOpenRequest.htm#HttpOpenRequest">HttpOpenRequest</A>. 

<P>The following diagram shows the Win32 Internet functions that use the HINTERNET handle created by <A HREF="../functions/HttpOpenRequest.htm#HttpOpenRequest">HttpOpenRequest</A> after it is sent by <A HREF="../functions/HttpSendRequest.htm#HttpSendRequest">HttpSendRequest</A>. The shaded boxes represent functions that return HINTERNET handles, while the plain boxes represent functions that use the HINTERNET handle created by the function on which they depend.

<P>
<P><IMG SRC="../../../art/AX_WNT07.gif" WIDTH="177" HEIGHT="202" ALT="Functions that use the handle after HttpSendRequest" >
<P>

<P>After <A HREF="../functions/HttpSendRequest.htm#HttpSendRequest">HttpSendRequest</A> has been used on the handle returned by <A HREF="../functions/HttpOpenRequest.htm#HttpOpenRequest">HttpOpenRequest</A>, <A HREF="../functions/InternetQueryDataAvailable.htm#InternetQueryDataAva">InternetQueryDataAvailable</A>, <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A>, and <A HREF="../functions/InternetSetFilePointer.htm#InternetSetFilePoint">InternetSetFilePointer</A> can be used on that handle.


<P>
<P><IMG SRC="../../../art/AX_WNT08.gif" WIDTH="185" HEIGHT="287" ALT="Functions that use the handle after HttpSendRequestEx" >
<P>

<P>After <A HREF="../functions/HttpSendRequestEx.htm#HttpSendRequestEx">HttpSendRequestEx</A> has been used on the handle returned by <A HREF="../functions/HttpOpenRequest.htm#HttpOpenRequest">HttpOpenRequest</A>, <A HREF="../functions/HttpEndRequest.htm#HttpEndRequest">HttpEndRequest</A>, <A HREF="../functions/InternetReadFileEx.htm#InternetReadFileEx">InternetReadFileEx</A>, and <A HREF="../functions/InternetWriteFile.htm#InternetWriteFile">InternetWriteFile</A> can be used on that handle. After <B>HttpEndRequest</B> has been used, <A HREF="../functions/InternetQueryDataAvailable.htm#InternetQueryDataAva">InternetQueryDataAvailable</A>, <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A>, and <A HREF="../functions/InternetSetFilePointer.htm#InternetSetFilePoint">InternetSetFilePointer</A> can be used on that handle.


<!-- ************************ BRADYA: END UPDATE ************************** -->


<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>