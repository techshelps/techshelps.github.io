<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DWebBrowserEvents2::BeforeNavigate2</TITLE>

<META NAME=MS-HKWD CONTENT="DWebBrowserEvents2::BeforeNavigate2">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, interface">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="DWebBrowserEvents2__"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="DWebBrowserEvents2::BeforeNavigate2"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="DWebBrowserEvents2::BeforeNavigate2"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../../WebBrowser.htm#ch_webbrowser">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="DWebBrowserEvents2.htm">DWebBrowserEvents2</A>
<IMG SRC="../../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CommandStateChange.htm">DWebBrowserEvents2::CommandStateChange</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>DWebBrowserEvents2::BeforeNavigate2</H1>

<PRE>void BeforeNavigate2(
    [in] IDispatch* pDisp, 
    [in] VARIANT* URL, 
    [in] VARIANT* Flags, 
    [in] VARIANT* TargetFrameName, 
    [in] VARIANT* PostData, 
    [in] VARIANT* Headers, 
    [out] VARIANT_BOOL* Cancel 
);
</PRE>
<P>Fires before a navigation occurs in the given WebBrowser (on either a window or frameset element).

<UL><LI>No return value.

</UL>
<DL>
<DT><I>pDisp</I> </DT><DD>Address of the frame's
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>IDispatch</A> interface. 
</DD><DT><I>URL</I> </DT><DD>URL to be navigated to.
</DD><DT><I>Flags</I> </DT><DD>Reserved for future use.
</DD><DT><I>TargetFrameName</I> </DT><DD>String that contains the name of the frame in which to display the resource, or NULL if no named frame is targeted for the resource.
</DD><DT><I>PostData</I> </DT><DD>Address of data to send to the server if the HTTP POST transaction is being used.
</DD><DT><I>Headers</I> </DT><DD>Additional HTTP headers to send to the server (HTTP URLs only). The headers can specify things like the action required of the server, the type of data being passed to the server, or a status code.
</DD><DT><I>Cancel</I> </DT><DD>Address of a cancel flag. An application can set this parameter to TRUE to cancel the navigation operation, or to FALSE to allow it to proceed.
</DD></DL>
<P>The <I>pDisp</I> parameter is that of the top-level or frame WebBrowser object corresponding to the navigation. The processing of this navigation can be modified by setting the <I>Cancel</I> parameter to TRUE and either ignoring or reissuing a modified navigation method to the WebBrowser object. The <I>URL</I> parameter can be a PIDL in the case of a shell namespace entity for which there is no URL representation.

<P>The post data specified by <I>PostData</I> is passed as a
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>SAFEARRAY</A> structure. The variant should be of type VT_ARRAY and point to a <B>SAFEARRAY</B>. The <B>SAFEARRAY</B> should be of element type VT_UI1, dimension one, and have an element count equal to the number of bytes of post data.

<P>This event replaces the <B>BeforeNavigate</B> and <B>FrameBeforeNavigate</B> events, which should no longer be used. Internet Explorer 4.0 will continue to fire the <B>BeforeNavigate</B> and <B>FrameBeforeNavigate</B> events for compatibility with Internet Explorer 3.0.

<P>Providing the <I>pDisp</I> pointer of the corresponding WebBrowser object gives the host better information and control over the Internet Explorer 3.0 specification, which used <B>FrameBeforeNavigate</B> and a target frame name to identify the target of navigation (target frame names are not unique).

<P><B>Applies To
</B>
<P>WebBrowser, Internet Explorer

<P>See also <A HREF="NavigateComplete2.htm#DWebBrowserEvents2__">DWebBrowserEvents2::NavigateComplete2</A>, <A HREF="../iwebbrowser2/Navigate2.htm#IWebBrowser2__Naviga">IWebBrowser2::Navigate2</A>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>