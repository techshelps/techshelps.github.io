<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Licensing and Distribution</TITLE>

<META NAME=MS-HKWD CONTENT="Licensing and Distribution">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_MSHTML_licensing"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Licensing and Distribution"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Licensing and Distribution"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="IEProg.htm#book_browsing">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="Deps.htm">Dependencies</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../script_debug/sdebug.htm">Microsoft Script Debugger for Internet Explorer</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Licensing and Distribution</H1>

<P>Application developers who want to redistribute Microsoft&#174; Internet Explorer technologies, such as the WebBrowser control, Wininet.dll, Urlmon.dll, or Comctl32.dll, must obtain a redistribution license for Microsoft&#174; Internet Explorer 4.0. The Internet Explorer self-extracting executable installs a number of system files and registry entries in addition to the actual WebBrowser control. You can license Microsoft Internet Explorer for Windows&#174; 95, Windows&#174; 3.1, Windows NT&#174; Workstation, and Apple Macintosh&#174; royalty-free to redistribute within your organization or to your customers. Plus, you can use the Microsoft Internet Explorer Administration Kit (IEAK) to easily create Internet Explorer distribution media, which you can customize to specify start and search pages and a favorites list. This lets your organization create and distribute a Web browser that reflects your specific needs and the needs of your users. For more information on redistributing Internet Explorer, see the Microsoft Web page at <A HREF="http://www.microsoft.com/ie/ieak/" TARGET="_top">http://www.microsoft.com/ie/ieak/</A>.
<P><A CLASS=tctop HREF="Licensing.htm#ie_browser_version"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Determining the Installed Version of Internet Explorer 4.0</A><BR>
<P><A CLASS=tctop HREF="Licensing.htm#ie_minimal_install"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Using the Internet Explorer 4.0 Minimal Installation Package</A><BR>
<P><A CLASS=tctop HREF="Licensing.htm#ie_needed"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Adding an Application to the Warning List for Internet Explorer 4.0 Uninstall</A><BR>
<!--************************************************************--><H2><A NAME="ie_browser_version">Determining the Installed Version of Internet Explorer 4.0</A></H2>
<P>If your application requires Internet Explorer 4.0 services, you must determine the version of Internet Explorer that is installed, if any, before installing your application. There are two methods that can be used to determine the installed version of Internet Explorer. The first obtains the version information from the registry, and the second obtains the version information from one of the Internet Explorer components.

 
<H3><A NAME="Determining_the_Inte">Determining the Internet Explorer Version from the Registry</A></H3>
<P>To obtain the installed Internet Explorer version from the registry, open the following registry key:

<PRE>HKEY_LOCAL_MACHINE\
   Software\
      Microsoft\
         Internet Explorer
</PRE>
<P>In this key, obtain the "Version" value. This is a string value that contains the Internet Explorer 4.0 version in the following format:

<PRE>"&lt;major version&gt;.&lt;minor version&gt;.&lt;build number&gt;.&lt;sub-build number&gt;"
</PRE>
<P>Internet Explorer 3.0x does not install this value, so if this value is retrieved and the major version is "4" and the minor version is "71", then Internet Explorer 4.0 is installed. 

<P>Internet Explorer 3.0x does install the "Build" value under this same key. For backward compatibility, Internet Explorer 4.0 modifies or adds the "Build" value also. Internet Explorer 3.0x's "Build" value is a string that contains a four-character build number. Internet Explorer 4.0's "Build" value is a string that contains a five-character value that takes the following format:

<PRE>"4&lt;build number&gt;"
</PRE>
<P>Therefore, if the "Build" value is the character '4' followed by a four-character build number, Internet Explorer 4.0 is installed.
 

 
<H3><A NAME="Determining_the_Inte">Determining the Internet Explorer Version from Shdocvw.dll</A></H3>
<P>The Internet Explorer browser is implemented in Shdocvw.dll. The version of this DLL is used to determine which version of Internet Explorer is installed. If this file is not present, Internet Explorer is either not installed or is not properly installed.

<P>The following are the different versions of Shdocvw.dll and the browser version that each represents.

<P><UL><LI><B>Version 4.70</B> &#150; Internet Explorer 3.0
<LI><B>Version 4.71</B> &#150; Internet Explorer 4.0
</UL>
<P>The following function retrieves the major and minor version numbers of the Shdocvw.dll that is installed on the local system.

<PRE>#include &lt;windows.h&gt;
#include &lt;shlwapi.h&gt;

HRESULT GetBrowserVersion(LPDWORD pdwMajor, LPDWORD pdwMinor)
{
HINSTANCE   hBrowser;

if(   IsBadWritePtr(pdwMajor, sizeof(DWORD)) || 
      IsBadWritePtr(pdwMinor, sizeof(DWORD)))
   return E_INVALIDARG;

*pdwMajor = 0;
*pdwMinor = 0;

//Load the DLL.
hBrowser = LoadLibrary(TEXT("shdocvw.dll"));

if(hBrowser)
   {
   HRESULT           hr = S_OK;
   DLLGETVERSIONPROC pDllGetVersion;
   
   /*
   You must get this function explicitly.
   */
   pDllGetVersion = (DLLGETVERSIONPROC)GetProcAddress(hBrowser, TEXT("DllGetVersion"));
   
   if(pDllGetVersion)
      {
      DLLVERSIONINFO    dvi;
      
      ZeroMemory(&amp;dvi, sizeof(dvi));
      dvi.cbSize = sizeof(dvi);
   
      hr = (*pDllGetVersion)(&amp;dvi);
      
      if(SUCCEEDED(hr))
         {
         *pdwMajor = dvi.dwMajorVersion;

         *pdwMinor = dvi.dwMinorVersion;
         }
      }
   else
      {
      /*
      If GetProcAddress failed, there is a problem with the DLL.
      */
      hr = E_FAIL;
      }
   
   FreeLibrary(hBrowser);

   return hr;
   }

return E_FAIL;
}
</PRE>
<H2><A NAME="ie_minimal_install">Using the Internet Explorer 4.0 Minimal Installation Package</A></H2>
<P>The Internet Explorer 4.0 minimal installation package includes the Internet Explorer 4.0 base browser, DirectShow, and the Microsoft Win32 VM for Java. The package can be run in normal mode with user interface and prompts or in automated mode without user interface and prompts. The following installation packages are available:

<P><TABLE>
<TR><TD><B>Installation Package
 </B></TD><TD><B>Target Platform
</B></TD></TR>
<TR><TD>ie4stw95.exe </TD><TD>Windows&#174; 95</TD></TR>
<TR><TD>ie4stnt.exe </TD><TD>Windows NT&#174; 4.0 for the Intel X86 processor</TD></TR></TABLE>
<P>The following command line:

<PRE>ie4stw95.exe /Q:A 
</PRE>
<P>will install the Internet Explorer 4.0 minimal installation package with the following options:

<UL><LI>No setup user interface.
<LI>No integrated desktop.
<LI>No reboot prompt.
<LI>Internet Explorer 4.0 will be made the default browser.
<LI>The Internet icon will be added to the desktop.
</UL>
<P>The following command line:

<PRE>ie4stw95.exe /Q:A /C:"ie4wzd.exe /Q:A /X /I:N /R:N /S:""#e"""
</PRE>
<P>will install the Internet Explorer 4.0 minimal installation package with the following options:

<UL><LI>No setup user interface.
<LI>No integrated desktop.
<LI>No reboot prompt.
<LI>Internet Explorer 4.0 will not be made the default browser.
<LI>The Internet icon will not be added to the desktop.
</UL>
<P>For other installation options, please refer to the Internet Explorer Administration Kit.

<P><B>Note</B>  These examples use the Windows 95 installation package, but the command line options are the same for all packages. 
<P>Before installing Internet Explorer 4.0, you must make sure that the setup application has the proper administration rights (if applicable) and that there is enough hard disk space available for the installation. The minimal installation package requires approximately 60 MB of free disk space to accommodate the temporary and installed files.

<P>Once the installation is complete, your setup application must reboot the computer in order for the Internet Explorer 4.0 installation to complete. Your setup application should ask users if they want to reboot the computer and give them an option not to. Internet Explorer 4.0 will not be useable until the computer has been rebooted.

 
<H2><A NAME="ie_needed">Adding an Application to the Warning List for Internet Explorer 4.0 Uninstall</A></H2>
<P>If your application requires Internet Explorer 4.0 services, you can add your application to the list of applications that require Internet Explorer 4.0 to be installed. When users attempt to uninstall Internet Explorer 4.0, this list will be displayed and they will be told that these applications may not function correctly if Internet Explorer 4.0 is uninstalled. Users will be asked if they still want to uninstall Internet Explorer 4.0. 

<P>To add your application to this list, add a string value under the following key:

<PRE>HKEY_LOCAL_MACHINE\
   Software\
      Microsoft\
         IE4\
            DependentComponents
</PRE>
<P>Under this key, create a string value that takes the following format:

<PRE>MyApp = "My Application."
</PRE>
<P>The value name in this example is "MyApp". Make sure the value name you create is unique among all other values in the same key. The value's data ("My Application.") is what is actually displayed to the user. 

<P>When your application is uninstalled, remember to remove any values you add under this key.


<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>