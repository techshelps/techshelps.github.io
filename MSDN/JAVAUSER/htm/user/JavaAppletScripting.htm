<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Controlling an Applet Using Scripting</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY BGCOLOR="White" TOPMARGIN=0 LEFTMARGIN=0 VLINK="#006699" ALINK="#006699">
<A NAME="top"></A>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="98%">
<TR>
<TD ROWSPAN=2 WIDTH=114 ALIGN="LEFT" VALIGN="TOP">
<IMG SRC="art/title_x3.gif" WIDTH="112" HEIGHT="108"  BORDER=0 ALT="Controlling an Applet Using Scripting"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH="100%">
<TR><TD WIDTH=10>&nbsp;</TD><TD VALIGN="top"><FONT FACE="Verdana,Arial,Helvetica" SIZE=1><B STYLE="color:#006699">In this topic</B><P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="JavaAppletScripting.htm#script_0002000201010000">Controlling a Java Applet Through Scripting</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="JavaAppletScripting.htm#script_0002000201020000">Firing Events from an Java Applet</A>
</FONT></TD></TR></TABLE>
</TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">
<P>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="355" VALIGN="bottom"><IMG SRC="art/articles2.gif" WIDTH="355" HEIGHT="27"  BORDER=0 ALT="Articles"></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="bottom">&nbsp;</TD><TD ALIGN="center" VALIGN="bottom"><A HREF="default.htm"><IMG SRC="art/homenrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Welcome!"></A></TD></TR>
<TR>
<TD WIDTH="355" ALIGN="right" VALIGN="top"><FONT COLOR="#006699" SIZE="4" FACE="VERDANA,ARIAL,HELVETICA"><B>Controlling an Applet Using Scripting</B></FONT></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">&nbsp;</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Welcome!</FONT></TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD WIDTH=20>&nbsp;</TD>
<TD>
<BR>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<BR><BR><H2 STYLE="color:#333366">Controlling an Applet Using Scripting</H2>
<P>Web developers can embed Microsoft&#174; ActiveX&#174; Controls into their Web pages and drive them using Microsoft&#174; Visual Basic&#174; Scripting Edition (VBScript). The Microsoft Win32 VM for Java (Microsoft VM) offers developers another option by making Java applets scriptable, too. When a Java applet is running in a browser, such as Microsoft&#174; Internet Explorer, all the public methods and variables of the applet automatically become available to VBScript or any other language supporting the ActiveX scripting protocol.

<H3 STYLE="color:#333366"><A NAME="script_0002000201010000">Controlling a Java Applet Through Scripting</A></H3><P>Consider the following fragment from a Java applet.

<PRE><FONT FACE="Courier" SIZE="2">

&#009;class Buzzer extends Applet

&#009;{

&#009;&#009;public int pitch;

&#009;&#009;public void buzz() 

&#009;&#009;{ 

&#009;&#009;&#009;//Play a sound at the specified pitch. 
&#009;&#009;&#009;...   

&#009;&#009;}

 ...

&#009;}

</FONT></PRE>
<P>To include this applet in your HTML page, use the &lt;APPLET&gt; tag, specifying the ID attribute. This enables you to refer to the applet from the scripting language, as shown in the following example:

<PRE><FONT FACE="Courier" SIZE="2">

&#009;&lt;APPLET CODE="Buzzer.class" ID=doorbell&gt;

</FONT></PRE>
<P>You can then define buttons that enable the user to control the applet, as shown in the following example.

<PRE><FONT FACE="Courier" SIZE="2">

&#009;&lt;INPUT TYPE=button VALUE="Higher" NAME="BtnHigher"&gt;

&#009;&lt;INPUT TYPE=button VALUE="Lower"  NAME="BtnLower"&gt;

&#009;&lt;INPUT TYPE=button VALUE="Play"   NAME="BtnPlay"&gt;

</FONT></PRE>
<P>The NAME attribute lets you refer to each button from the scripting language.

<P>In the scripting portion of your HTML page, you can define OnClick handlers for each button, making them manipulate the applet, as follows:

<PRE><FONT FACE="Courier" SIZE="2">

&#009;&lt;SCRIPT language = "VBScript"&gt;

&#009;

&#009;Sub BtnHigher_OnClick

&#009;&#009;document.doorbell.pitch = 880

&#009;End Sub



&#009;Sub BtnLower_OnClick

&#009;&#009;document.doorbell.pitch = 440

&#009;End Sub



&#009;Sub BtnPlay_OnClick

&#009;&#009;document.doorbell.buzz

&#009;End Sub



&#009;&lt;/SCRIPT&gt;

</FONT></PRE>
<P>Now, when a user clicks a button on the Web page, the appropriate VBScript handler is invoked, which in turn manipulates the Java applet. Note that when the applet is referenced from VBScript, its name has the identifier <B>document</B> attached to it.

<P>Using scripting, Java applets can be driven just like ActiveX controls. The script can read and write the public variables of the applet, as well as call its public methods (including passing parameters and reading return values). However, only classes derived from <B>java.Applet</B> 
class are directly accessible from the scripting language. If your Java applet includes other classes that you want to make available to the scripting language, you must define public methods in your <B>Applet</B> subclass that delegate to those classes. 


<P>You can also embed both Java applets and ActiveX controls in the same Web page and use VBScript handlers to connect them. For example, you can read values from an ActiveX control and pass them to a Java applet, or vice versa. You can even fire events from a Java applet. This automatic scripting capability is provided by the Microsoft VM for Java. As a result, your script code can manipulate Java applets developed with any tool, not just ones developed with Microsoft&#174; Visual J++&#153;. 

<H3 STYLE="color:#333366"><A NAME="script_0002000201020000">Firing Events from an Java Applet</A></H3><P>Applets in Internet Explorer 4.0 can fire events to scripts. To do so, use the &lt;applet&gt; tag and specify a &lt;param name=FireScriptEvents value=True&gt; tag, as shown in the following example. 

<P>A look at an example taken from the AFCBean sample in the SDK for Java may help to demonstrate how this works. 

<P>The AFCBean class in AFCBean.java contains a handleEvent method that fires an event called itemSelected.

<PRE><FONT FACE="Courier" SIZE="2">

    /**

     *  When a item is selected, an action is performed. The LIST_SELECT

     *  event is parsed and an event called itemSelected is fired.

     */

     public boolean handleEvent(Event e)

     {

        if ((e.target instanceof UIList) &amp;&amp; (e.id == Event.LIST_SELECT))

        {

            AFCBeanListener listener[];



            synchronized (m_listeners)

            {

                listener = new AFCBeanListener[m_listeners.size()];

                m_listeners.copyInto(listener);

            }



            for (int i=0; i&lt;listener.length; i++)

                listener[i].itemSelected(getSelectedItem());

        }



        return super.handleEvent(e);

    }

</FONT></PRE>
<P>In the AFCBean.html file, the following &lt;applet&gt; tag declares that the applet can fire events that will be handled by the script.

<PRE><FONT FACE="Courier" SIZE="2">

    &lt;applet code="AFCBean.class" name="AFCBean" width="300" height="300"&gt;

        &lt;param name="FiresScriptEvents" value="true"&gt;

    &lt;/applet&gt;

</FONT></PRE>
<P>The following JavaScript then sinks the event.

<PRE><FONT FACE="Courier" SIZE="2">

&lt;script language="JavaScript" for="AFCBean" event="itemSelected(s)"&gt;

    txtSelectedText.value = s;

&lt;/script&gt;

</FONT></PRE>
<P>Finally, the selected string is displayed in the table on the HTML page.

<PRE><FONT FACE="Courier" SIZE="2">

    &lt;tr&gt;

        &lt;td&gt;Sinks the event itemSelected and displays the string.&lt;/td&gt;

        &lt;td&gt;&lt;input name="txtSelectedText"&gt;&lt;/td&gt;

 &lt;/tr&gt;

&lt;/e&gt;

</FONT></PRE>
<P>When the &lt;object&gt; tag is supported by the Microsoft VM, it will assume the JDK 1.1 event model, so the <I>FireScriptEvents</I> parameter will not be required when using this tag.

<P>For more information about VBScript, see the VBScript Web site at <A href="http://www.microsoft.com/vbscript/">http://www.microsoft.com/vbscript/</A><IMG SRC="art/external.gif" WIDTH="19" HEIGHT="8" ALT="External Link" > (which is accessible using the Web Favorites command on the Help menu).


<P>
</FONT>
</TD>
</TR>
</TABLE>
<CENTER>
<P><TABLE WIDTH="95%"><TR><TD HEIGHT=1 BGCOLOR="RED"></TD></TR></TABLE>
<TABLE WIDTH="100%"><TR>
<TD ALIGN="left"><A HREF="#top"><IMG SRC="art/upnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Top"></A></TD>
<TD ALIGN="right">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><A HREF="cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A></FONT></TD></TR></TABLE>
</CENTER>
</BODY></HTML>
