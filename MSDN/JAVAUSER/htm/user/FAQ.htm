<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Frequently Asked Questions</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY BGCOLOR="White" TOPMARGIN=0 LEFTMARGIN=0 VLINK="#006699" ALINK="#006699">
<A NAME="top"></A>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="98%">
<TR>
<TD ROWSPAN=2 WIDTH=114 ALIGN="LEFT" VALIGN="TOP">
<IMG SRC="art/title_x3.gif" WIDTH="112" HEIGHT="108"  BORDER=0 ALT="JDirect"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH="100%">
<TR><TD WIDTH=10>&nbsp;</TD><TD VALIGN="top"><FONT FACE="Verdana,Arial,Helvetica" SIZE=1></FONT></TD></TR></TABLE>
</TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">
<P>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="365" VALIGN="bottom"><IMG SRC="art/jdirect2.gif" WIDTH="365" HEIGHT="27"  BORDER=0 ALT="JDirect"></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="bottom">&nbsp;</TD><TD ALIGN="center" VALIGN="bottom"><A HREF="Troubleshooting.htm"><IMG SRC="art/prevnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Previous"></A></TD><TD ALIGN="center" VALIGN="bottom"><A HREF="jdirect.htm"><IMG SRC="art/homenrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="JDirect"></A></TD></TR>
<TR>
<TD WIDTH="365" ALIGN="right" VALIGN="top"><FONT COLOR="#006699" SIZE="4" FACE="VERDANA,ARIAL,HELVETICA"><B>About J/Direct</B></FONT></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">&nbsp;</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Previous</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">JDirect</FONT></TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD WIDTH=20>&nbsp;</TD>
<TD>
<BR>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<BR><BR><H2 STYLE="color:#333366">Frequently Asked Questions</H2>
<P>In this section, answers to the following questions about Microsoft&#174; J/Direct&#153; are provided.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000001">What versions of the Microsoft Compiler for Java support J/Direct?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000002">What versions of the Microsoft virtual machine support J/Direct?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000003">Where can I find more code samples that use J/Direct?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000004">Where can I get prewritten declarations for the Win32 functions and constants?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000005">How can I programatically learn whether the auto modifier will select Unicode or ANSI on a given platform?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000006">Where I can find more services helpful for DLL calling?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000007">How do I obtain the application instance handle?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000008">How do I obtain the parameters passed to the WinMain function?</A>
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="FAQ.htm#jdirect_000700020f000009">How do I turn my Java application into an .exe file?</A>
</FONT></TD></TABLE>
<P><B><A NAME="jdirect_000700020f000001">What versions of the Microsoft Compiler for Java support J/Direct?</A></B>
<P>The version of the compiler available with the Microsoft SDK for Java version 3.0 pre-release 2 supports J/Direct. Use that version or later. To display the version number, execute <B>jvc</B> with no arguments on the command line. If you are copying the compiler manually, be aware that the Microsoft compiler is composed of three executables: <B>jvc.exe</B>, <B>jps.dll</B>, and <B>msjvc.dll</B>. See the SDK release notes for version numbers corresponding to that release.
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000002">What versions of the Microsoft virtual machine support J/Direct?</A></B>
<P>The version of the Microsoft VM available with the SDK for Java version 3.0 pre-release 2 and with Internet Explorer 4.0 supports J/Direct. Use that version or later. See the SDK release notes for version numbers corresponding to that release.
<P>To find out what version is installed using Windows Explorer, you need to find the executable <B>msjava.dll</B>, which is normally installed in your windows\system directory. Make sure that Windows Explorer is configured to show all files. (To do this, open the windows\system folder, pull down the View menu, select the Options item to display the Options dialog box. Select the view tab, and select Show all files.) Find <B>msjava.dll</B> in the folder and right-click it. From the pop-up menu, select the Properties item to display the Properties dialog box. Select the Version tab. You will see the version number displayed next to File Version.
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000003">Where can I find more code samples that use J/Direct?</A></B>
<P>You can find code samples under \MsVmJava\Samples\JDirect\ in the directory in which you install the SDK for Java.
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000004">Where can I get prewritten declarations for the Win32 functions and constants?</A></B>
<P>Prewritten declarations for the most common Win32 functions and constants can be downloaded separately. From the SDK for Java 3.0 pre-release 2 Component Download menu, select the check box next to Win32 API Java Package.
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000005">How can I programatically learn whether the auto modifier will select Unicode or ANSI on a given platform?</A></B>
<P>The system class com.ms.dll.<A HREF="DllLib.htm">DllLib</A> has a public integer field named <A HREF="DllLib.htm#com_0003000703020001">systemDefaultCharSize</A>. Its value is set to 1 (for ANSI) or 2 (for Unicode).
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000006">Where I can find more services helpful for DLL calling?</A></B>
<P>The <A HREF="def_pdll.htm">com.ms.dll</A> package includes several classes (especially <A HREF="DllLib.htm">DllLib</A>) that contain useful methods for extracting strings from native memory blocks, mapping raw pointers onto <B>@dll.struct</B> classes, copying bytes between various types, and other helpful tasks.
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000007">How do I obtain the application instance handle?</A></B>
<P>Many Windows functions (in particular, the USER32 functions) require the application instance handle as a parameter. In Win32, an instance handle is defined to be the same as a module handle. Thus, the instance handle can be obtained by passing NULL to the <B>GetModuleHandle</B> function.
<PRE><FONT FACE="Courier" SIZE="2">
  /** @dll.import("KERNEL32") */
  private static native int GetModuleHandle(String modName);

  int hInst = GetModuleHandle(null);
</FONT></PRE>
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000008">How do I obtain the parameters passed to the WinMain function?</A></B>
<P>Windows applications written in C have a WinMain function where execution begins. Java applications written in C have a main function instead.
<P>The Microsoft&#174; Windows&#174; operating system passes four parameters to <B>WinMain</B>. Here is how to obtain these values from Java.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The application instance handle:
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Pass NULL to the <B>GetModuleHandle</B> function. For more information, see the <A HREF="FAQ.htm#jdirect_000700020f000007">How do I obtain the application instance handle?</A> FAQ in this section. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The previous instance handle:
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">In Win32, this value is always NULL.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The command line:
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Passed as the <B>String</B> args[] parameter to main.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The default value to pass to <B>ShowWindow</B>:
</FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Can be obtained by <B>GetStartupInfo</B>. However, Microsoft&#174; Win32&#174; applications are encouraged to pass SW_SHOWDEFAULT to <B>ShowWindow</B> rather than using the value passed to <B>WinMain</B>.
</FONT></TD></TR></TABLE>
<P><BR><BR>

<P><B><A NAME="jdirect_000700020f000009">How do I turn my Java application into an .exe file?</A></B>
<P>The jexegen tool can be used to create an .exe file that can be launched like a normal Windows application. When using jexegen, you can select whether to build a GUI executable or a console executable. The default is console, but you can select GUI by specifying the /W switch. For example, consider the following Java application. 
<PRE><FONT FACE="Courier" SIZE="2">
public class app
{
  public static void main(String args[])
  {
    int hInst = GetModuleHandle(null);
    MessageBox(0,"Instance handle is " + 
               Integer.toHexString(hInst),"",0);             
  }

  /** @dll.import("KERNEL32") */
  private static native int GetModuleHandle(String modName);

  /** @dll.import("USER32") */
  private static native int MessageBox(int hWndOwner,String text,
                                       String title,int fuStyle); 
} 

</FONT></PRE>
<P>This class can be converted to a GUI executable by executing the following command lines.
<PRE><FONT FACE="Courier" SIZE="2">
  jvc app
  jexegen /W /out:app.exe /main:app *.class
</FONT></PRE>
<P>For details on the using the jexegen tool, see the <A href="exegen.htm">Introduction to Jexegen</A> article.
<P><BR><BR>

<P>
</FONT>
</TD>
</TR>
</TABLE>
<CENTER>
<P><TABLE WIDTH="95%"><TR><TD HEIGHT=1 BGCOLOR="RED"></TD></TR></TABLE>
<TABLE WIDTH="100%"><TR>
<TD ALIGN="left"><A HREF="#top"><IMG SRC="art/upnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Top"></A></TD>
<TD ALIGN="right">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><A HREF="cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A></FONT></TD></TR></TABLE>
</CENTER>
</BODY></HTML>
