<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Javareg (Version 3.0 Final Release)</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY BGCOLOR="White" TOPMARGIN=0 LEFTMARGIN=0 VLINK="#006699" ALINK="#006699">
<A NAME="top"></A>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="98%">
<TR>
<TD ROWSPAN=2 WIDTH=114 ALIGN="LEFT" VALIGN="TOP">
<IMG SRC="art/title_x3.gif" WIDTH="112" HEIGHT="108"  BORDER=0 ALT="Working with MS VM"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH="100%">
<TR><TD WIDTH=10>&nbsp;</TD><TD VALIGN="top"><FONT FACE="Verdana,Arial,Helvetica" SIZE=1></FONT></TD></TR></TABLE>
</TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">
<P>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="355" VALIGN="bottom"><IMG SRC="art/tools2.gif" WIDTH="355" HEIGHT="27"  BORDER=0 ALT="Tools"></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="bottom">&nbsp;</TD><TD ALIGN="center" VALIGN="bottom"><A href="jview.htm"><IMG SRC="art/prevnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Previous"></A></TD><TD ALIGN="center" VALIGN="bottom"><A HREF="def_tool.htm"><IMG SRC="art/homenrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Tools"></A></TD><TD ALIGN="center" VALIGN="bottom"><A href="cabarc.htm"><IMG SRC="art/nextnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Next"></A></TD></TR>
<TR>
<TD WIDTH="355" ALIGN="right" VALIGN="top"><FONT COLOR="#006699" SIZE="4" FACE="VERDANA,ARIAL,HELVETICA"><B>Using Javareg</B></FONT></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">&nbsp;</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Previous</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Tools</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Next</FONT></TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD WIDTH=20>&nbsp;</TD>
<TD>
<BR>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<BR><BR><H2 STYLE="color:#333366">Using Javareg</H2>
<P>Javareg is a command line tool for registering Java classes as COM (Component Object Model) components in the Microsoft&#174; Windows&#174; registry. This enables you to write Java classes, compile them, and then call them from any programming language (including Java) by means of COM. You can also configure your classes to be executed remotely (on a different computer) using distributed COM (DCOM).
<P><B>Note</B> The original javareg (that shipped with Microsoft&#174; Visual J++&#153;, versions 1.0 and 1.1) supported /surrogate differently than the 3.0 pre-release version. 
In its original version, javareg itself implemented a surrogate process. Now that DCOM supports a surrogate as part of
the system, and because the surrogate built into javareg was prototypical, support for the surrogate process has been dropped. 
The surrogate support in DCOM was made available in Microsoft&#174; Windows NT&#174; 4.0 Service Pack 2 (SP2) and DCOM for Microsoft&#174; Windows&#174; 95.
For more information on this feature of DCOM, see the documentation in the Microsoft Win32 Software Development Kit (SDK) update for Windows NT SP2.

<P>Javareg (version 3.0 pre-release 2) supports the following command line syntax:
<PRE><FONT FACE="Courier" SIZE="2">javareg [/?] [/register|/unregister]
        [/class:&#060;JavaClass&#062; [/clsid:&#060;clsid&#062;] [/progid:&#060;ProgID&#062;] [options]]</FONT></PRE>
<P>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/?</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Displays command-line help and usage.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/register</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers the specified Java class. The /register switch can also be used with several other switches to register a JavaBeans object as a Microsoft&#174; ActiveX&#174; control.
 <TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/codebase:</B>[<I>filename</I>|<I>URL</I>]
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">specifies the base location, either a URL or a filename, to obtain the Java class.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/control</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds the necessary registry information to enable containers to treat the Java class as an ActiveX control. You must also use the <I>/typelib:</I> switch if you use this switch. 
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/typelib:</B> [<I>filename</I>]
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Generates the type library for this Java class at the specified filename's location. 
 </FONT></TD></TR></TABLE>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/unregister</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Unregisters the specified Java class.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/class</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifes the Java class to register or unregister.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/clsid</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifes the CLSID to use for the Java class (optional).
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/progid</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifes the ProgID to use for the Java class (optional).
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/surrogate</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers to run in system provided surrogate process.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/remote:</B> <I>&#060;RemoteServerName&#062;</I>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Server to activate the class on (using DCOM).
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>/q</B>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Quiet mode. Suppresses all message boxes.
</FONT></TD></TR></TABLE>
<P>More details on these options are provided below.<P>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/q
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Javareg suppresses any message boxes it might display indicating success or failure. Regardless of whether this switch is specified, javareg will return 0 on success or 1 on failure.
<P></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/register
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Javareg registers the Java class specified in the registry. If /register is specified, at least /class:&#060;JavaClass&#062; must also be specified. Notice that javareg will also recognize /regserver for this command. 
 <P>You can use a series of switches to register a JavaBean object as an ActiveX control (mentioned previously). Notice that if you use /control to register a JavaBean, you must also generate a type library using /typelib:.
<PRE><FONT FACE="Courier" SIZE="2">
javareg /register /class:[classname] /codebase:[filename|URL]
        /control /typelib:[filename]
</FONT></PRE>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/unregister
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Javareg removes the registration information for a given Java class from the registry. If /unregister is specified, /class:&#060;JavaClass&#062; must also be specified. Notice that javareg will also recognize /unregserver for this command.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/class:&#060;JavaClass&#062;
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">This argument specifies the name of the Java class to register or unregister. If this switch is specified either /register or /unregister must also be specified. For example, the following command line will cause javareg to register the Java class Pager. Because /clsid:&#060;clsid&#062; is not specified, javareg will automatically generate a UUID to be used as the CLSID for the class (it uses the COM API CoCreateGUID()).<BR>
<PRE><FONT FACE="Courier" SIZE="2">javareg /register /class:Pager</FONT></PRE>
<P>If you execute javareg again with the same Java class name, javareg will reuse the CLSID already assigned to the Java class. As such, you can execute javareg with additional switches later to reconfigure your class (for example, by specifying the /surrogate switch).
<P></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/clsid:&#060;clsid&#062;
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Javareg uses the specified COM class ID (CLSID) rather than automatically generating one. For example, the following command will cause javareg to register the Java class Pager using the CLSID {2488D68A-D3BF-11D0-A145-080036006703}.<BR>
<PRE><FONT FACE="Courier" SIZE="2">
javareg /register /class:Pager 
    /clsid:{2488D68A-D3BF-11D0-A145-080036006703}
</FONT></PRE>
<P></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/progid:&#060;progid&#062;
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">By default, javareg does not assign a COM ProgID to your class. This switch lets you designate what ProgID to use. For example, the following command will cause javareg to register the Java class Pager and assign it the ProgID of "Pager.Java.1".<BR>
<PRE><FONT FACE="Courier" SIZE="2">javareg /register /class:Pager /progid:Pager.Java.1</FONT></PRE>
<P></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/surrogate
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Javareg writes the appropriate registry entries necessary to enable the Java class to be activated out-of-process. This is necessary if you want your Java class to be activated and called from a different computer. In other words, you use the /surrogate switch when registering your Java class to run as a DCOM server.
<P>For example, the following command will cause javareg to register the Java class Pager so that it can be run from a different computer and accessed through DCOM.<BR>
<PRE><FONT FACE="Courier" SIZE="2">
javareg /register /class:Pager 
        /clsid:{2488D68A-D3BF-11D0-A145-080036006703} 
        /surrogate
</FONT></PRE>
<P>Notice that it is not strictly necessary to specify the CLSID when using /surrogate. If you do not, javareg will generate one.
<P></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/remote:&#060;RemSerNm&#062;
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">If you want to activate and call a Java class on a different computer using distributed COM, use this switch on the client computer. When using this switch, the Java class cannot be activated on the client computer, only on the server. The &#060;RemoteServerName&#062; can be any computer identifier supported by distributed COM. Typically, it can be a NetBIOS name, a DNS name, or a 
decimal-dotted IP address.
</FONT></TD></TR></TABLE>
<P>The following example explains the necessary steps for using this functionality.

<OL><LI>Write a Java class with some public members (for example, Pager.java). 

<PRE><FONT FACE="Courier" SIZE="2">
class Pager &#009;
{
   public boolean Page(String PhoneNumber, String PIN, String Msg) 
   {
      System.out.println("Page request received. Sending.");
      System.out.println(" Phone: " + PhoneNumber);
      System.out.println(" PIN: " + PIN);
      System.out.println(" Message: " + Msg);
      return true;
   }
}
</FONT></PRE>
<LI>Compile the Java source (into Pager.class, for example), and move the .class file to your trusted class lib directory on the server (for example, C:\WINNT\Java\TrustLib\). <P>

<LI>On the server, run javareg. The following shows the Pager example:
<PRE><FONT FACE="Courier" SIZE="2">
javareg /register /class:Pager /progid:Pager.Java.1 
        /clsid:{2488D68A-D3BF-11D0-A145-080036006703}
        /surrogate
</FONT></PRE>
<LI>On the client, run javareg. The following shows the Pager example (replace "yourservername" with the name of the server in the previous step):
<PRE><FONT FACE="Courier" SIZE="2">
javareg /register /class:Pager /progid:Pager.Java.1 
        /clsid: :{2488D68A-D3BF-11D0-A145-080036006703}
        /remote:yourservername
</FONT></PRE>
<P>Now you can use Microsoft&#174; Visual Basic&#174; to create an instance of "Pager.Java.1". For example:
<PRE><FONT FACE="Courier" SIZE="2">
Dim x As Object
Set x = CreateObject("Pager.Java.1")
fSuccess = x.Page ("555-1212", "1234", "Call Home!")
</FONT></PRE>
</OL>
<P>The Pager class will be activated and will run remotely on <I>&#060;RemoteServerName&#062;</I>. 

<P>
</FONT>
</TD>
</TR>
</TABLE>
<CENTER>
<P><TABLE WIDTH="95%"><TR><TD HEIGHT=1 BGCOLOR="RED"></TD></TR></TABLE>
<TABLE WIDTH="100%"><TR>
<TD ALIGN="left"><A HREF="#top"><IMG SRC="art/upnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Top"></A></TD>
<TD ALIGN="right">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><A HREF="cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A></FONT></TD></TR></TABLE>
</CENTER>
</BODY></HTML>
