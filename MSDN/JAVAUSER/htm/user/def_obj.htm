<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>About com.ms.object</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY BGCOLOR="White" TOPMARGIN=0 LEFTMARGIN=0 VLINK="#006699" ALINK="#006699">
<A NAME="top"></A>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="98%">
<TR>
<TD ROWSPAN=2 WIDTH=162 ALIGN="LEFT" VALIGN="TOP">
<IMG SRC="art/title_x.gif" WIDTH="160" HEIGHT="108"  BORDER=0 ALT="Package com.ms.object"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH="100%">
<TR><TD WIDTH=10>&nbsp;</TD><TD VALIGN="top"><FONT FACE="Verdana,Arial,Helvetica" SIZE=1><B STYLE="color:#006699">In this topic</B><P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_obj.htm#commsobject_ovr_0000000101010000">Overview</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_obj.htm#commsobject_ovr_0000000101020000">Examples</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_obj.htm#commsobject_0000000101030000">Classes</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_obj.htm#commsobject_0000000101040000">Interfaces</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_obj.htm#commsobject_0000000101050000">Hierarchy</A>
</FONT></TD></TR></TABLE>
</TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">
<P>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="355" VALIGN="bottom"><IMG SRC="art/package2.gif" WIDTH="355" HEIGHT="27"  BORDER=0 ALT="Packages"></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="bottom"><A HREF="def_pack.htm"><IMG SRC="art/homenrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Packages"></A></TD><TD ALIGN="center" VALIGN="bottom"><A HREF="Category.htm"><IMG SRC="art/nextnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Next"></A></TD></TR>

<TR>
<TD WIDTH="355" ALIGN="right" VALIGN="top"><FONT COLOR="#006699" SIZE="4" FACE="VERDANA,ARIAL,HELVETICA"><B>Package com.ms.object</B></FONT></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Packages</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Next</FONT></TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD WIDTH=20>&nbsp;</TD>
<TD>
<BR>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<BR><BR><H2 STYLE="color:#333366">About com.ms.object</H2>
<P>This package provides classes and interfaces for implementing data transfer operations.
<H3 STYLE="color:#333366"><A NAME="commsobject_ovr_0000000101010000">Overview</A></H3><P>Many of the classes and interfaces in the <B>com.ms.object</B> package are designed to facilitate data transfer. The <A HREF="Transfer.htm">Transfer</A>, <A HREF="TransferSession.htm">TransferSession</A>, and <A HREF="MetaObject.htm">MetaObject</A> interfaces and the <A HREF="Category.htm">Category</A> class define the basic protocol for data transfer. The <A HREF="ObjectBag.htm">ObjectBag</A> and <A HREF="SimpleTransferSession.htm">SimpleTransferSession</A> classes provide default implementations for commonly used interfaces. 

<P>During data transfer, a data recipient obtains a <A HREF="TransferSession.htm">TransferSession</A> and acts upon it. The recipient might, for example, interrogate the session to determine the types of transfers supported (by using the <A HREF="TransferSession.htm#com_000000010b010200">getAvailableEffects</A> and <A HREF="TransferSession.htm#com_000000010b010300">getPreferredEffects</A> methods). The recipient might also ask the session for the data being transferred (by using the <A HREF="TransferSession.htm#com_000000010b010400">getTransferData</A> method). The data is represented in the form of a <A HREF="MetaObject.htm">MetaObject</A>, which can also be interrogated to determine what forms the transferred data can take.

<P>The <B>com.ms.object</B> package also contains classes and interfaces that allow Java components to obtain a system service. For instance, a Java component that is hosted inside a Microsoft&#174; ActiveX&#174; container might want to obtain the <A HREF="ActiveXControlServices.htm">ActiveXControlServices</A> system service. To obtain a system service, a Java component that implements the <A HREF="ISiteable.htm">ISiteable</A> interface could query for and obtain an <A HREF="ISite.htm">ISite</A> object. This site object could then be queried for the service using the <A HREF="IServiceObjectProvider.htm#com_0000000106010100">IServiceObjectProvider.queryService</A> method. If the requested service is not available, a <A HREF="ServiceNotFoundException.htm">ServiceNotFoundException</A> is thrown.  

<H3 STYLE="color:#333366"><A NAME="commsobject_ovr_0000000101020000">Examples</A></H3><P>The recipient might want to support transfer of text in HTML format if it is available and fall back to plain text if HTML is not available. The following example illustrates how to interrogate the <A HREF="MetaObject.htm">MetaObject</A> to determine whether HTML is supported.

<PRE><FONT FACE="Courier" SIZE="2">
class Recipient
{
   Category htmlCategory = new Category("text/html");
   Category plainCategory = new Category("text/plain");

   // This method interrogates a MetaObject for data transfer.
   public void interrogate(MetaObject data)
   {
     try
     {
        Class streamClass = Class.forName("java.io.InputStream");
        if (data.hasObject(htmlCategory, streamClass))
        {
          InputStream stream = data.getObject(htmlCategory, 
                                              streamClass);
          // Do something with HTML stream.
        }
        else if (data.hasObject(plainCategory, streamClass))
        {
          InputStream stream = data.getObject(plainCategory,
                                              streamClass);
          // Do something with plain text stream.
        }
     }
     catch(ClassNotFoundException e)
     {
     }       
   }
}
</FONT></PRE>
<P>For recipients that support many formats, it might be more efficient to enumerate the formats supported by the <A HREF="MetaObject.htm">MetaObject</A>. Using this technique, a recipient can determine possible actions based on the types of data that are offered.

<PRE><FONT FACE="Courier" SIZE="2">
class Recipient
{
   Category htmlCategory = new Category("text/html");
   Category plainCategeory = new Category ("text/plain");

   // The recipient may keep private flags to track what can
   // be done with the data.
   private static final int HAS_HTML = 1;
   private static final int HAS_TEXT = 2;

   // This method determines the values of the HAS_HTML 
   // and HAS_TEXT flags based on the data being offered.
   public int interrogate(MetaObject data)
   {
     private int avail = 0;
        
     try
     {
        Class streamClass = Class.forName("java.io.InputStream");
        Enumeration categories = data.objectCategories();
        if (categories != null)
        {
          while (categories.hasMoreElements())
          {
             Category category = (Category)categories.nextElement();
             if (category.equals(htmlCategory))
                avail |= HAS_HTML;
             else if (category.equals(plainCategory))
                avail |= HAS_TEXT;
          }
        }
     }
     catch (ClassNotFoundException e)
     {
     }

     return avail;
  }
}
</FONT></PRE>
<H3 STYLE="color:#333366"><A NAME="commsobject_0000000101030000">Classes</A></H3><DL>
<DT><A HREF="Category.htm">Class Category</A>
 </DT><DD>This class provides an abstract type identity.
</DD><DT><A HREF="ObjectBag.htm">Class ObjectBag</A>
 </DT><DD>This class is a default implementation of the <B>MetaObject</B> interface that can be used to implement delayed rendering.
</DD><DT><A HREF="ServiceNotFoundException.htm">Class ServiceNotFoundException</A>
 </DT><DD>This class represents an exception indicating that a requested service was not available. 
</DD><DT><A HREF="SimpleTransferSession.htm">Class SimpleTransferSession</A>
 </DT><DD>This class is a default implementation of the <B>TransferSession</B> interface.

</DD></DL>
<H3 STYLE="color:#333366"><A NAME="commsobject_0000000101040000">Interfaces</A></H3><DL>
<DT><A HREF="IServiceObjectProvider.htm">Interface IServiceObjectProvider</A>
 </DT><DD>This interface defines a method used to request a service from an object.
</DD><DT><A HREF="ISite.htm">Interface ISite</A>
 </DT><DD>This interface defines the <B>removeSiteable</B> method, which is called when an <B> ISiteable</B> object detaches itself from a site.
</DD><DT><A HREF="ISiteable.htm">Interface ISiteable</A>
 </DT><DD>This interface defines methods that set and retrieve the <B>ISite</B> object that is associated with an <B>ISiteable</B> object. 
</DD><DT><A HREF="MetaObject.htm">Interface MetaObject</A>
 </DT><DD>This interface defines an abstraction for an object that has multiple identities.
</DD><DT><A HREF="Transfer.htm">Interface Transfer</A>
 </DT><DD>This interface provides constants that represent transfer effects.
</DD><DT><A HREF="TransferSession.htm">Interface TransferSession</A>
 </DT><DD>This interface defines a data transfer session abstraction that is used to describe a transfer operation.

</DD></DL>
<H3 STYLE="color:#333366"><A NAME="commsobject_0000000101050000">Hierarchy</A></H3><PRE><FONT FACE="Courier" SIZE="2"><B>Object</B>
  |
  +--<A HREF="ObjectBag.htm">ObjectBag</A> (<A HREF="MetaObject.htm">MetaObject</A>)
  |
  +--<A HREF="SimpleTransferSession.htm">SimpleTransferSession</A> (<A HREF="TransferSession.htm">TransferSession</A>)
  |
  +--<A HREF="Category.htm">Category</A>

<B>Exception</B>
  |
  +--<A HREF="ServiceNotFoundException.htm">ServiceNotFoundException</A>

<A HREF="TransferSession.htm">TransferSession</A>
<A HREF="Transfer.htm">Transfer</A>
<A HREF="IServiceObjectProvider.htm">IServiceObjectProvider</A>
<A HREF="ISite.htm">ISite</A>
<A HREF="ISiteable.htm">ISiteable</A>
<A HREF="MetaObject.htm">MetaObject</A>
</FONT></PRE>
<P>
</FONT>
</TD>
</TR>
</TABLE>
<CENTER>
<P><TABLE WIDTH="95%"><TR><TD HEIGHT=1 BGCOLOR="RED"></TD></TR></TABLE>
<TABLE WIDTH="100%"><TR>
<TD ALIGN="left"><A HREF="#top"><IMG SRC="art/upnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="upnrm.gif"></A></TD>
<TD ALIGN="right">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"></FONT></TD></TR></TABLE>
</CENTER>
</BODY></HTML>
