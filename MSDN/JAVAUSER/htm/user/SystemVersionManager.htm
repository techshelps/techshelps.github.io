<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Class SystemVersionManager</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY BGCOLOR="White" TOPMARGIN=0 LEFTMARGIN=0 VLINK="#006699" ALINK="#006699">
<A NAME="top"></A>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="98%">
<TR>
<TD ROWSPAN=2 WIDTH=114 ALIGN="LEFT" VALIGN="TOP">
<IMG SRC="art/title_x3.gif" WIDTH="112" HEIGHT="108"  BORDER=0 ALT="Packages"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH="100%">
<TR><TD WIDTH=10>&nbsp;</TD><TD VALIGN="top"><FONT FACE="Verdana,Arial,Helvetica" SIZE=1><B STYLE="color:#006699">In this topic</B><P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="SystemVersionManager.htm#com_000300140e010000">Methods</A>
</FONT></TD></TR></TABLE>
</TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">
<P>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="355" VALIGN="bottom"><IMG SRC="art/package2.gif" WIDTH="355" HEIGHT="27"  BORDER=0 ALT="Packages"></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="bottom"><A HREF="StringComparison.htm"><IMG SRC="art/prevnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Previous"></A></TD><TD ALIGN="center" VALIGN="bottom"><A HREF="def_util.htm"><IMG SRC="art/pkgnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="This Package"></A></TD><TD ALIGN="center" VALIGN="bottom"><A HREF="Task.htm"><IMG SRC="art/nextnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Next"></A></TD></TR>
<TR>
<TD WIDTH="355" ALIGN="right" VALIGN="top"><FONT COLOR="#006699" SIZE="4" FACE="VERDANA,ARIAL,HELVETICA"><B>Package com.ms.util</B></FONT></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Previous</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">This<BR>Package</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Next</FONT></TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD WIDTH=20>&nbsp;</TD>
<TD>
<BR>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<BR><BR><H2 STYLE="color:#333366">Class SystemVersionManager</H2>
<PRE><FONT FACE="Courier" SIZE="2">public class SystemVersionManager implements <B>Runnable</B>
{
  // Methods
  public static Properties <A HREF="SystemVersionManager.htm#com_000300140e010100">createVersion</A> (int major, int minor, int
        buildnum, int buildinc, String description);
  public static Enumeration <A HREF="SystemVersionManager.htm#com_000300140e010200">enumerate</A> ();
  public static Properties <A HREF="SystemVersionManager.htm#com_000300140e010300">getPackageVersion</A> (String pkgname);
  public static Properties <A HREF="SystemVersionManager.htm#com_000300140e010400">getSystemComponentVersion</A> (
        String compname);
  public static Properties <A HREF="SystemVersionManager.htm#com_000300140e010500">getVMVersion</A> ();
  public void <A HREF="SystemVersionManager.htm#com_000300140e010600">run</A> ();
}
</FONT></PRE>
<P>This class provides methods that set and retrieve system version properties. Typically, this class is not called directly. Rather, it is used by implementing a VersionManager class that is derived from it. For a standard implementation of a VersionManager class, refer to the Samples\Version directory in the Microsoft SDK for Java. This class can be added, without editing, directly to your distributed packages. In doing so, applications can check the version information of the system components and your distributed classes. The VersionManager sample class works on any virtual machine, but the <B>SystemVersionManager</B> class is provided specifically for use with the Microsoft Win32 VM for Java. 
<P>When VersionManager methods are called, the VersionManager object first calls the <B>SystemVersionManager</B> methods to return system information. If the <B>SystemVersionManager</B> class returns nothing or does not exist, and the applet or application runs on the Microsoft VM, the sample implementation of the VersionManager class returns the information for the 3.0 release of Internet Explorer (since Internet Explorer 3.0 was the only version not to include <B>SystemVersionManager</B>). The package information retrieved by the VersionManager works in any virtual machine. The system information, of course, only works on the Microsoft VM. 
<P>You can request a package by name by using the <A HREF="SystemVersionManager.htm#com_000300140e010300">getPackageVersion</A> method. This method searches for the information in a Version (*.Version) class in the requested package or a superpackage. The version information is in a <B>Properties</B> object. All version objects have the following keys: 
<UL><LI>MajorVersion 
<LI>MinorVersion 
<LI>BuildNumber 
<LI>BuildIncrement 
<LI>Description 
</UL>
<P>All values are stored as instances of <B>Strings</B>. You can also use <A HREF="SystemVersionManager.htm#com_000300140e010400">getSystemComponentVersion</A> to request information about the following system components: 
<UL><LI>VM 
<LI>Classes 
<LI>TrustedClasses 
</UL>
<P>The following is an example of using the VersionManager class to retrieve the version of the Microsoft Virtual Machine for Java: 
<PRE><FONT FACE="Courier" SIZE="2">
// vmver.java

import java.util.Properties;
import java.util.Enumeration;

public class vmver
{
    public static void main (String[] args)
    {
        try
        {
            Properties props = VersionManager.getSystemComponentVersion("VM");
            if (props == null)
            {
                System.out.println("Not a Microsoft VM.");
            }
            else
            {
                Enumeration e = props.keys();
                while (e.hasMoreElements())
                {
                    String prop = (String)e.nextElement();
                    System.out.println(prop+": "+props.get(prop));
                }
            }
        }
        catch (Throwable e)
        {
            System.out.println("unexpected error:");
            e.printStackTrace();
        }
    }
}
</FONT></PRE>
<H3 STYLE="color:#333366"><A NAME="com_000300140e010000">Methods</A></H3><H4 STYLE="color:#333366"><A NAME="com_000300140e010100">createVersion</A></H4><BLOCKQUOTE>
<PRE><FONT FACE="Courier" SIZE="2">public static Properties createVersion (int major, int minor, int buildnum,
        int buildinc, String description);
</FONT></PRE>
<P><P>Creates a version object. 
<P><B>Return Value:</B> <P>Returns a <B>Property</B> object that contains the version properties. 

<P><TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>
<TR VALIGN=TOP BGCOLOR="#DDDDDD">
<TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Parameter</B></FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Description</B></FONT></TD></TR>
<TR VALIGN=TOP><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>major</I>
 </FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The major version number. 


</FONT></TD></TR><TR VALIGN=TOP><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>minor</I>
 </FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The minor version number. 


</FONT></TD></TR><TR VALIGN=TOP><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>buildnum</I>
 </FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The build number. 


</FONT></TD></TR><TR VALIGN=TOP><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>buildinc</I>
 </FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The incremental build number. 


</FONT></TD></TR><TR VALIGN=TOP><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>description</I>
 </FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The string description of the version. 

</FONT></TD></TR></TABLE>
<P><B>Remarks:</B> <P>A typical example of this method is the following internal call to <B>createVersion</B>, which creates a version object for system classes before incremental build 1155. 
<PRE><FONT FACE="Courier" SIZE="2">createVersion(4, 79, 0, 1154, "Microsoft(R) System 
Classes, 3.0 Prerelease")
</FONT></PRE>
</BLOCKQUOTE>
<H4 STYLE="color:#333366"><A NAME="com_000300140e010200">enumerate</A></H4><BLOCKQUOTE>
<PRE><FONT FACE="Courier" SIZE="2">public static Enumeration enumerate ();
</FONT></PRE>
<P><P>Retrieves the default system components that are provided with the version information. 

<P><B>Return Value:</B> <P>Returns an <B>Enumeration</B> object that contains the following <B>String</B> objects: 
<DL>
<DT>String 
 </DT><DD>Description 
</DD><DT>VM 
 </DT><DD>The VM version 
</DD><DT>Classes 
 </DT><DD>The version of the system classes 
</DD><DT>TrustedClasses 
 </DT><DD>The version of the classes in the TrustedLib path 
</DD></DL>
</BLOCKQUOTE>
<H4 STYLE="color:#333366"><A NAME="com_000300140e010300">getPackageVersion</A></H4><BLOCKQUOTE>
<PRE><FONT FACE="Courier" SIZE="2">public static Properties getPackageVersion (String pkgname);
</FONT></PRE>
<P><P>Retrieves the version information for the specified package. 

<P><B>Return Value:</B> <P>Returns a <B>Properties</B> object that contains the package version data. 

<P><TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>
<TR VALIGN=TOP BGCOLOR="#DDDDDD">
<TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Parameter</B></FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Description</B></FONT></TD></TR>
<TR VALIGN=TOP><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>pkgname</I>
 </FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The name of the package. 

</FONT></TD></TR></TABLE>
</BLOCKQUOTE>
<H4 STYLE="color:#333366"><A NAME="com_000300140e010400">getSystemComponentVersion</A></H4><BLOCKQUOTE>
<PRE><FONT FACE="Courier" SIZE="2">public static Properties getSystemComponentVersion (String compname);
</FONT></PRE>
<P><P>Retrieves the component version information. 

<P><B>Return Value:</B> <P>Returns a <B>Properties</B> object that contains the version information. 

<P><TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>
<TR VALIGN=TOP BGCOLOR="#DDDDDD">
<TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Parameter</B></FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Description</B></FONT></TD></TR>
<TR VALIGN=TOP><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>compname</I>
 </FONT></TD><TD><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The system component name, which can be one of the components returned by the <A HREF="SystemVersionManager.htm#com_000300140e010200">enumerate</A> method. 

</FONT></TD></TR></TABLE>
</BLOCKQUOTE>
<H4 STYLE="color:#333366"><A NAME="com_000300140e010500">getVMVersion</A></H4><BLOCKQUOTE>
<PRE><FONT FACE="Courier" SIZE="2">public static Properties getVMVersion ();
</FONT></PRE>
<P><P>Retrieves version data for the virtual machine (VM). 

<P><B>Return Value:</B> <P>Returns a <B>Properties</B> object that contains the VM version data. 

</BLOCKQUOTE>
<H4 STYLE="color:#333366"><A NAME="com_000300140e010600">run</A></H4><BLOCKQUOTE>
<PRE><FONT FACE="Courier" SIZE="2">public void run ();
</FONT></PRE>
<P><P>Runs when the thread originating in <A HREF="SystemVersionManager.htm">SystemVersionManager</A> <A HREF="SystemVersionManager.htm#com_000300140e010400">getSystemComponentVersion</A> is started. 
<P><B>Return Value:</B> <P>No return value. 

<P><B>Remarks:</B> <P>This method retrieves the value of the ClassesBuild string in the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Java VM registry key. 
</BLOCKQUOTE>
<P>
</FONT>
</TD>
</TR>
</TABLE>
<CENTER>
<P><TABLE WIDTH="95%"><TR><TD HEIGHT=1 BGCOLOR="RED"></TD></TR></TABLE>
<TABLE WIDTH="100%"><TR>
<TD ALIGN="left"><A HREF="#top"><IMG SRC="art/upnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="upnrm.gif"></A></TD>
<TD ALIGN="right">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><A HREF="cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A></FONT></TD></TR></TABLE>
</CENTER>
</BODY></HTML>
