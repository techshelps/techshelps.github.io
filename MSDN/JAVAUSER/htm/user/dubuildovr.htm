<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Introduction</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY BGCOLOR="White" TOPMARGIN=0 LEFTMARGIN=0 VLINK="#006699" ALINK="#006699">
<A NAME="top"></A>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="98%">
<TR>
<TD ROWSPAN=2 WIDTH=114 ALIGN="LEFT" VALIGN="TOP">
<IMG SRC="art/title_x3.gif" WIDTH="112" HEIGHT="108"  BORDER=0 ALT="Working with MS VM"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH="100%">
<TR><TD WIDTH=10>&nbsp;</TD><TD VALIGN="top"><FONT FACE="Verdana,Arial,Helvetica" SIZE=1><B STYLE="color:#006699">In this topic</B><P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" href="dubuildovr.htm#dubuildovr_0004000c01010000">Distributing Software Using Distribution Units</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" href="dubuildovr.htm#dubuildovr_0004000c01020000">Split Distribution Units</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" href="dubuildovr.htm#dubuildovr_0004000c01030000">Registering ActiveX Controls as JavaBeans</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" href="dubuildovr.htm#dubuildovr_0004000c01040000">Packaging a Java Library with Dubuild</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" href="dubuildovr.htm#dubuildovr_0004000c01050000">More Information</A>
</FONT></TD></TR></TABLE>
</TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">
<P>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="355" VALIGN="bottom"><IMG SRC="art/tools2.gif" WIDTH="355" HEIGHT="27"  BORDER=0 ALT="Tools"></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="bottom">&nbsp;</TD><TD ALIGN="center" VALIGN="bottom"><A href="cprmedit.htm"><IMG SRC="art/prevnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Previous"></A></TD><TD ALIGN="center" VALIGN="bottom"><A HREF="def_tool.htm"><IMG SRC="art/homenrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Tools"></A></TD><TD ALIGN="center" VALIGN="bottom"><A href="sampleini.htm"><IMG SRC="art/nextnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Next"></A></TD></TR>
<TR>
<TD WIDTH="355" ALIGN="right" VALIGN="top"><FONT COLOR="#006699" SIZE="4" FACE="VERDANA,ARIAL,HELVETICA"><B>Using DUBuild</B></FONT></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">&nbsp;</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Previous</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Tools</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Next</FONT></TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD WIDTH=20>&nbsp;</TD>
<TD>
<BR>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<BR><BR><H2 STYLE="color:#333366">Introduction</H2>
<P>A Distribution Unit (DU) is a cabinet file that contains an Open Software Distribution (OSD) manifest file (also known as a Distribution Unit Profile [DUP]), as well as content files. DUs are a new method for distributing software that is supported by the code download feature of Microsoft&#174; Internet Explorer 4.0. The OSD manifest file included in the cabinet file archive contains details on the version of the DU, the contents and their versions, and how to install the contents. It is written in XML.

 <P>The <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility writes the OSD file and places it in a cabinet file archive with any specified contents. Although this document focuses specifically on using <B>dubuild</B> to distribute and install Java packages with the Java Language Package Manager (JPM), <B>dubuild</B> is a general distribution standard; it can be used to distribute applications, libraries, and native code.

 <P>The <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility is similar to <A href="quickref.htm#quickref_0004000201000300">cabarc</A>, but uses the OSD manifest instead of .inf files. DUs written with <B>dubuild</B> (the OSD manifest in particular) are not recognized by earlier versions of Internet Explorer. 

 <P>The <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility has three separate functions.

<OL><LI>Creates an OSD and packages a Distribution Unit.
 <LI>Creates a Split, or Delta, Distribution Unit.
 <LI>Packages Microsoft&#174; ActiveX&#174; controls as JavaBeans objects.
</OL>
<H3 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01010000">Distributing Software Using Distribution Units</A></H3><P>The primary function of the <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility is to create DUs for software distribution targeted at Internet Explorer.

 <P>Traditionally, Java software distribution has been inefficient. You would archive classes in a .zip file, and then archive the .zip in another .zip file along with any documentation or other included files. Users would unpack the first archive (but not the second), add the included .zip to a path, set their classpath, and reboot.

 <P>DUs make this approach unnecessary. The OSD manifest included in the DU includes installation instructions for the Java Language Package Manager. The DUs still need to be created with a hierarchical directory, as with augmented cabinet files, but installation requirements are handled by Internet Explorer and the JPM. The distribution is provided through a special HTML script that includes an &lt;applet&gt; and <B>useslibrary</B> HTML tag set.

 <P>Creating DUs for Internet Explorer 3 is more involved. You can follow the MASTER.INF template and procedures as you would for creating a cabinet file, then add the .INF to your package, and finally, use the dubuild utility to package it. By default, the dubuild utility uses LZX compression, but Internet Explorer 3 uses MSZIP compression. You can use the <B>/Z</B> command line option to build DUs with MSZIP compression that are compatible with Internet Explorer 3. 

<H4 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01010100">Applet and Useslibrary</A></H4><P>The HTML tag set is similar to any applet script. The &lt;applet&gt; tag specifies the applet to run, and the extra &lt;param&gt; tags supply additional information to Internet Explorer 4.0 about the name and version of the DU that contains the Java classes needed to run the applet. There are three parameters associated with the applet tag.

<PRE><FONT FACE="Courier" SIZE="2">
&lt;applet code=com.ms.JPMBrowser.BrowserApplet
width=200
height=200&gt;
&lt;PARAM NAME=useslibrary VALUE="JPM Browser"&gt;
&lt;PARAM NAME=useslibrarycodebase VALUE="jpm.cab"&gt;
&lt;PARAM NAME=useslibraryversion VALUE="1,1,2,3"&gt;
&lt;/applet&gt;
</FONT></PRE>
<UL><LI>The <B>useslibrary</B> element specifies the friendly name of the DU. This name is registered with Internet Explorer and is used in conjunction with the DU's version number to indicate presence or absence of the contents of the DU in the Java Language Package Manager.
<LI>The <B>useslibrarycodebase</B> element specifies a URL and cabinet file archive to download (in this example, the cabinet file is local), if the DU is not already present on the current system.
<LI>The <B>useslibraryversion</B> element specifies the version number of the DU. This is used to update the Java Language Package Manager when new versions, or Split DUs, are encountered.
</UL>
<P>Using DUs to distribute code enables users to run applets without constantly downloading them in a networked environment. For example, where once you had to interact with security managers every time you visited a site and encountered a signed cabinet file or code, you can now install the code into the Java Language Package Manager on the first visit and avoid subsequent security interactions; the code is already installed. If the DU's cabinet file is signed, all security and permissions apply the first time the cabinet is downloaded.

<H4 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01010200">Installing Distribution Units</A></H4><P>The Java Language Package Manager and Internet Explorer go through several steps before a DU is installed.

<OL><LI>The Java Lanagugae Package Manager first determines if the DU is already registered by checking the friendly name of the DU, which is specified as a string in the <B>useslibrary</B> parameter.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">If the DU is not present on the current system, the appropriate cabinet file archive is downloaded from the URL specified by the <B>useslibrarycodebase</B> parameter.
</FONT></TD><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">If the DU is present on the current system, the version number, specified in the <B>useslibraryversion</B> parameter, is checked to determine whether the DU is current with the version offered. This eliminates the need to download, open, and examine the contents of the archive to determine if it is current (as is the case when you use &lt;object&gt; tags with Internet Explorer 3). 
</FONT></TD></TABLE>
<LI>If the local version number matches or is newer than the offered version, no action is performed. If the local version is older, the DU is downloaded and the OSD manifest is examined.
<LI>Internet Explorer and the JPM install the included packages according to the OSD.
<LI>The applet is executed. 
</OL>
<P><B>Note</B> Internet Explorer 3.x does not recognize <B>useslibrary</B> and its associated parameters. You have to use the &lt;applet&gt; and &lt;object&gt; tags to emulate this distribution.

<H3 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01020000">Split Distribution Units</A></H3><P>The second function of the <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility is to create Split, or Delta, DUs. This functionality is useful for updated versions of software where some of the files in the original DU have been modified (a service pack, for example). 

<P>In order to build a Split DU, you need to specify a new (version 2) cabinet file, the original path, and the original DU. Whole packages that contain changed files end up in the new DU. If there are no unchanged packages, everything ends up in the new DU. This command creates its own cab file, named ~NEWCAB.CAB, which holds the unchanged packages. The OSD in NEWCAB.CAB does not have a reference to the original CAB file. A command line to build a split DU follows:

<PRE><FONT FACE="Courier" SIZE="2">C:\..\&gtdubuild newcab.cab tree /P oldcab.cab /M /I *.class</FONT></PRE>
<P>When Internet Explorer encounters a Split DU in <B>useslibrarycodebase</B>, it follows the same steps previously described, with an additional step. If the newer version of the Split DU is not present on the local system, it will be downloaded, and the OSD manifest is examined. If the earlier version of the software, pointed to by the OSD file, does not also exist on the local system, it is downloaded as well. However, if the earlier version of the Split DU is already present on the system, no further action is performed. 

<H3 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01030000">Registering ActiveX Controls as JavaBeans</A></H3><P>The third function of the <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility is to register ActiveX controls as JavaBeans. 
<PRE><FONT FACE="Courier" SIZE="2">C:\..\&gt;dubuild /B package,class,regmode,progid,guid,iconfile,
                                  flags,tlbguid,tlbfile,bitmap32
</FONT></PRE>
<P>Simple Bean identification is done by only supplying the package name and class filename. ActiveX registration requires the regmode argument and at least the guid argument in addition. See <A href="quickref.htm#quickref_0004000201000a00">dubuild command line options</A> for more information on command line options.

<H3 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01040000">Packaging a Java Library with Dubuild</A></H3><P>The following material presents a step-by-step tutorial for installing a set of Java libraries into the Microsoft virtual machine using the <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility. This example uses the creation and distribution of the JPMBrowser package and covers the creation of DUs. They can be installed on machines with the Microsoft VM and Internet Explorer 4.0.

<P>There are three steps to creating and distributing DUs.
<OL><LI><A href="dubuildovr.htm#dubuildovr_0004000c01040100">Decide on a package name.</A>
<LI><A href="dubuildovr.htm#dubuildovr_0004000c01040200">Create the DU with the dubuild utility.</A>
<LI><A href="dubuildovr.htm#dubuildovr_0004000c01040300">Test install the DU from an HTML page.</A>
</OL>
<H4 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01040100">Decide on Your Package Names</A></H4><P>The package name for JPMBrowser is com.ms.JPMBrowser. There are guidelines to naming packages (this example is a Microsoft library for Java so it uses the <B>com.ms.</B> prefix; your package will use the form that follows the com.company.packagename naming convention), but generally choose a meaningful and descriptive name.

<P>Make sure your directory structure reflects the package name, as demonstrated below in the Microsoft&#174; Windows Explorer window for the example package.

<P><IMG SRC="art/Image2b.gif" WIDTH="489" HEIGHT="165" ALT="" >

<H4 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01040200">Create the Distribution Unit</A></H4><OL><LI>From a DOS prompt, change your working directory to the top-level project directory. For this example, it is C:\projects\JPMBrowser, the first directory shown in the previous Windows Explorer view. 

 <LI>Run the <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility, found in your Microsoft SDK for Java bin\packsign\ directory. Use the <B>/D</B> option to specify a friendly name for your DU, and use the <B>/I</B> option to specify that only Java class files are included. You must use full paths when using <B>dubuild</B>.

<LI>It is a good idea to run <B>extract /D</B> to view the resulting cabinet file and to verify that the proper files are included with the correct directory paths.
</OL>
<P>A demonstration of the preceding steps follows.
<PRE><FONT FACE="Courier" SIZE="2">
C:\&gt;cd \projects\JPMBrowser

C:\projects\JPMBrowser&gt;path
PATH=C:\WIN95;C:\WIN95\COMMAND;C:\SDK-JAVA.20\BIN\PACKSIGN;
C:\SDK-JAVA.20\BIN;

C:\..\JPMBrowser&gt;dubuild JPM.cab . /D "JPM Browser" /I C:\..\*.class /V 1,1,2,3

Microsoft (R) Distribution Unit Builder - version 4.79.2220
Copyright (C) Microsoft Corporation 1998. All rights reserved.


C:\projects\JPMBrowser&gt;extract /D jpm.cab
Microsoft (R) Diamond Extraction Tool - version (16) 1.00.0530 (04/3/95)
Copyright (c) Microsoft Corp 1994-1995. All rights reserved.

 Cabinet jpm.cab

07-30-1997  5:50:32p ----    295 JPM Browser.osd
07-20-1997  6:38:42p A---  1,960 com\ms\JPMBrowser\JPMPanel.class
07-20-1997  6:38:42p A---    678 com\ms\JPMBrowser\BrowserFrame.class
07-20-1997  6:38:42p A---  1,289 com\ms\JPMBrowser\BrowserApplet.class
                 4 Files   4,222 bytes
</FONT></PRE>
<P>The Open Software Distribution (OSD) file that is packaged with the DU is automatically generated by the <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> utility. The OSD file contains a list of the included Java packages and sets the version number to be 1.1.2.3. Note that when specifying version numbers on the command line, the version number must be comma-separated.

<P>Make sure that your packages are in the appropriate (in this case, com\ms) subdirectory, as shown above.

<H4 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01040300">Test Install the DU with an HTML Page</A></H4><P>To test the installation of the DU, you can write an HTML page that installs and runs the application or applet. The HTML script for the JPMBrowser sample applet uses an &lt;applet&gt; tag and several special <B>useslibrary</B> parameters. These parameters specify the friendly name, location, and version of the DU. For more information on the &lt;applet&gt; tag and associated parameters, see <A href="dubuildovr.htm#dubuildovr_0004000c01010000">Distributing Software Using Distribution Units</A>. 
<PRE><FONT FACE="Courier" SIZE="2">
&lt;applet code=com.ms.JPMBrowser.BrowserApplet
width=200
height=200&gt;
&lt;PARAM NAME=useslibrary VALUE="JPM Browser"&gt;
&lt;PARAM NAME=useslibrarycodebase VALUE="jpm.cab"&gt;
&lt;PARAM NAME=useslibraryversion VALUE="1,1,2,3"&gt;
&lt;/applet&gt;
</FONT></PRE>
<P>You can place this applet in an HTML file that is in the same directory as your cabinet file, or you can specify a remote location for the cabinet file in the <B>useslibrarycodebase</B> parameter. To test the installation, browse the HTML page in Internet Explorer. Internet Explorer should install the cabinet file and show the applet on the page.





<H3 STYLE="color:#333366"><A NAME="dubuildovr_0004000c01050000">More Information</A></H3><P>For more information on <A href="quickref.htm#quickref_0004000201000a00">dubuild</A> command-line options, see the <A href="quickref.htm#quickref_0004000201000a00">Dubuild Quick Reference</A>. 
<P>
</FONT>
</TD>
</TR>
</TABLE>
<CENTER>
<P><TABLE WIDTH="95%"><TR><TD HEIGHT=1 BGCOLOR="RED"></TD></TR></TABLE>
<TABLE WIDTH="100%"><TR>
<TD ALIGN="left"><A HREF="#top"><IMG SRC="art/upnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Top"></A></TD>
<TD ALIGN="right">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><A HREF="cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A></FONT></TD></TR></TABLE>
</CENTER>
</BODY></HTML>
