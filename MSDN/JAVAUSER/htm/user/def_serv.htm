<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>About com.ms.service</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>
<BODY BGCOLOR="White" TOPMARGIN=0 LEFTMARGIN=0 VLINK="#006699" ALINK="#006699">
<A NAME="top"></A>
<!--TOOLBAR_START-->
<!--TOOLBAR_END-->

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="98%">
<TR>
<TD ROWSPAN=2 WIDTH=114 ALIGN="LEFT" VALIGN="TOP">
<IMG SRC="art/title_x3.gif" WIDTH="112" HEIGHT="108"  BORDER=0 ALT="Packages"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH="100%">
<TR><TD WIDTH=10>&nbsp;</TD><TD VALIGN="top"><FONT FACE="Verdana,Arial,Helvetica" SIZE=1><B STYLE="color:#006699">In this topic</B><P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_serv.htm#commsservice_ovr_0003001001010000">Overview</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_serv.htm#commsservice_ovr_0003001001020000">The Jntsvc Tool</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_serv.htm#commsservice_ovr_0003001001030000">Example</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_serv.htm#commsservice_0003001001040000">Classes</A>
<P><IMG SRC="art/linkbull.gif" WIDTH="10" HEIGHT="8"  BORDER=0 ALT="*"><A STYLE="color: #333366;text-decoration:none" HREF="def_serv.htm#commsservice_0003001001050000">Hierarchy</A>
</FONT></TD></TR></TABLE>
</TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">
<P>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="355" VALIGN="bottom"><IMG SRC="art/package2.gif" WIDTH="355" HEIGHT="27"  BORDER=0 ALT="Packages"></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="bottom"><A HREF="def_pack.htm"><IMG SRC="art/homenrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Packages"></A></TD><TD ALIGN="center" VALIGN="bottom"><A HREF="Service.htm"><IMG SRC="art/nextnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="Next"></A></TD></TR>
<TR>
<TD WIDTH="355" ALIGN="right" VALIGN="top"><FONT COLOR="#006699" SIZE="4" FACE="VERDANA,ARIAL,HELVETICA"><B>Package com.ms.service</B></FONT></TD>
<TD WIDTH=20>&nbsp;</TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Packages</FONT></TD>
<TD ALIGN="center" VALIGN="top"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1">Next</FONT></TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD WIDTH=20>&nbsp;</TD>
<TD>
<BR>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<BR><BR><H2 STYLE="color:#333366">About com.ms.service</H2>
<P>This package enables you to write a Microsoft&#174; Windows NT&#174; system service in Java. (System services do not work under Microsoft&#174; Windows&#174; 95.) For more information about Windows NT system services, refer to the Microsoft&#174; Platform SDK.
<H3 STYLE="color:#333366"><A NAME="commsservice_ovr_0003001001010000">Overview</A></H3><P> To create and use a Windows NT service using this package, you must perform the following steps:
<UL><LI>Create your own service class by deriving it from the <A HREF="Service.htm">Service</A> class. 
<LI>Implement either a default constructor with no parameters or a constructor with a single <B>String</B>[] parameter. This constructor will be used to instantiate the service, and it should perform initialization during ServiceMain.
<LI>Implement your own versions of service callback methods (the methods that start with <B>handle</B>) to handle the various system service requests.
<LI>Use the query methods (the methods that begin with <B>can</B>) to determine which controls are accepted by a service (instead of testing the flags returned from <A HREF="Service.htm#com_0003001002020c00">getControlsAccepted</A>).
<LI>Use a built-in assassin to terminate a service that exceeds a time-out period specified by the <I>wait hint</I> value in status updates.
<LI>Use the jntsvc tool to generate a self-contained, self-installing and uninstalling, redistributable executable for the service.
</UL>
<P>The Microsoft SDK for Java includes several improvements in the <A HREF="def_serv.htm">com.ms.service</A> package that were not in version 1.5. The following list describes these improvements.
<OL><LI>Multiple services can be run within the same process. (Version 1.5 allowed only one service in a process.)
<LI>A new tool, jntsvc, generates self-contained executables for ease of distribution. A generated executable can install or uninstall itself by using the /install or /uninstall options. (Version 1.5 required several binaries to be present, along with a separate install program.)
<LI>The service can be started in command line mode, which is useful when starting the service from a debugger. (Version 1.5 required developers to define their own entry point to instantiate the service, and they had to invent
a way to simulate control events.)
<LI>Arguments can optionally be applied to the service.
</OL>
<H3 STYLE="color:#333366"><A NAME="commsservice_ovr_0003001001020000">The Jntsvc Tool</A></H3><P>The jntsvc tool generates a service executable. It is similar in usage and purpose to the jexegen tool. The use of the command file and specification of the class files in combination with the /base and /r options are identical to those used with jexegen. The following command line should be used to generate the executable.
<PRE><FONT FACE="Courier" SIZE="2">
  jntsvc /svcmain:classname [/base:dir] [/out:filename] [/r]
     [/r-] [/v] [@commandfile] files
</FONT></PRE>
<P>For detailed information on how to generate a service executable using the jntsvc tool, see the jntsvc section of the Tools <A href="quickref.htm#quickref_0004000201001100">Quick Reference</A>.

<P>After you have generated the executable, use the following command line to install, uninstall, or run the executable.
<PRE><FONT FACE="Courier" SIZE="2">
  "executable name" [options] [arguments to service]
</FONT></PRE>
<P>The following table briefly describes the available options.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/install </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Installs the service.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/uninstall </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Uninstalls the service.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/cmd:<I>service&nbsp;name</I> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Runs service <I>service name</I> in command line mode. This is useful when starting and controlling a service under a debugger. Messages that are normally sent to the event log are sent to the console. Service events can be simulated by entering the following commands in the console window. 
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">STOP </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends a SERVICE_CONTROL_STOP event to the service. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">PAUSE </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends a SERVICE_CONTROL_PAUSE event to the service. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">CONTINUE </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends a SERVICE_CONTROL_CONTINUE event to the service. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">SHUTDOWN </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends a SERVICE_CONTROL_SHUTDOWN event to the service. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">INTERROGATE </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends a SERVICE_CONTROL_INTERROGATE event to the service.
</FONT></TD></TR></TABLE>
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/username:<I>user&nbsp;name</I> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifies the account for the service to run as. The default
value is "LocalSystem". This option cannot be specified for multiple-service executables. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">/password:<I>password</I> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Specifies the password of the user name. 
</FONT></TD></TR></TABLE>
<P><B>Important Note:</B> As of version 2.5, the service information is contained within the generated executable. Therefore, the registry keys under HKLM\System\CurrentControlSet\Services that were used for version 1.5 services are no longer recognized. In version 1.5, certain parameter values were specified when the svcsetup was run. However, with version 2.5, to change the values of these parameters you must regenerate the executable. The only exceptions to this rule are the <I>password</I> and the <I>username</I> parameters, which are now options that you can specify on the generated executable.

<H3 STYLE="color:#333366"><A NAME="commsservice_ovr_0003001001030000">Example</A></H3><P>The following command line generates an executable for the test service included with the SDK for Java. 
<PRE><FONT FACE="Courier" SIZE="2">
jntsvc /svcmain:TestService /eventsource:TestService 
   /base:c:\..\bin\jntsvc TestService.class
</FONT></PRE>
<H3 STYLE="color:#333366"><A NAME="commsservice_0003001001040000">Classes</A></H3><DL>
<DT><A HREF="Service.htm">Class Service</A>
 </DT><DD>This class is a base class for creating Microsoft&#174; Windows NT&#174; system services in Java.
</DD><DT><A HREF="ServiceStatus.htm">Class ServiceStatus</A>
 </DT><DD>This class contains information about the state of a service.

</DD></DL>
<H3 STYLE="color:#333366"><A NAME="commsservice_0003001001050000">Hierarchy</A></H3><PRE><FONT FACE="Courier" SIZE="2"><B>Object</B>
  |
  +--<A HREF="Service.htm">Service</A>
  |
  +--<A HREF="ServiceStatus.htm">ServiceStatus</A> (<B>Cloneable</B>)
</FONT></PRE>
<P>
</FONT>
</TD>
</TR>
</TABLE>
<CENTER>
<P><TABLE WIDTH="95%"><TR><TD HEIGHT=1 BGCOLOR="RED"></TD></TR></TABLE>
<TABLE WIDTH="100%"><TR>
<TD ALIGN="left"><A HREF="#top"><IMG SRC="art/upnrm.gif" WIDTH="51" HEIGHT="38"  BORDER=0 ALT="upnrm.gif"></A></TD>
<TD ALIGN="right">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="1"><A HREF="cpyright.htm">&#169; 1998 Microsoft Corporation. All rights reserved. Terms of use.</A></FONT></TD></TR></TABLE>
</CENTER>
</BODY></HTML>
