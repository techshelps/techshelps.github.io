<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Freeing Hard Disk Space Automatically </title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000 dir=ltr>
<Font face="verdana,arial,helvetica" size="2">
<h1><a name="freeingharddiskspaceautomatically"></a>Freeing Hard Disk Space Automatically</h1>
<p>
In the article "Making the Most of Your Hard Disk Space, Part 2" [<i>Windows 95 Professional</i>, January 1998], we gave you several methods you could use to regain lost hard disk space. However, you must perform many of those methods on a regular basis to be effective. In this article, we'll discuss how to perform those procedures more conveniently.</p>
<h3>The basics</h3>
<p>
One of the best ways to automate a task is to build a batch file containing instructions for performing the task. Although a batch file can easily handle some of the steps in the main article, other steps involve running Windows programs such as Defrag. Fortunately, unlike its predecessors, Windows 95 allows you to launch Windows programs from a batch file. Therefore, we've created a batch file, shown in <b>Listing A</b>, that automates virtually every step of the task.</p>
<h3>A word of caution</h3>
<p>
It's important to manually test each command on your system before running the batch file. In addition, since our batch file deletes files, you should back up your system before running the batch file for the first time. You should also exercise extreme caution, ensuring that all the commands run correctly on your system. As you can see, we've added a comment before every command in the batch file to identify what the command does.</p>
<p>
In our batch file, we've used the default directory names. If you've used different directory names, you'll need to modify the batch file to compensate for each name change. You should also remove any commands that you don't feel comfortable running on your system.</p>
<h3>The batch file</h3>
<p>
To create the batch file shown in <b>Listing A</b>, open Notepad, type the batch file's commands, and save it in your Windows directory as Conserve.bat. Before you can run the batch file, you'll have to create in your Windows directory a text file called Y.txt that contains nothing more than the letter <i>Y</i>, as shown in <b>Figure A</b>. Our batch file uses Y.txt to avoid prompting the user for confirmation of various functions. The batch file contains only one point that requires user intervention. Since you can't run Defrag while ScanDisk is still running, we've included a Pause command that requires user input before the batch file will continue. The user must wait until ScanDisk is finished before pressing any key to instruct the batch file to start the Defrag utility.</p>
<p>
<b>Figure A</b></p>
<p>
<img src="w9p9812a.gif" border=0></p>
<p>
<b>The Y.txt file eliminates the need for almost all user intervention.</b></p>
<p>
After you've created the batch file and Y.txt, you must close all other applications. If an application is open, the batch file may erase a temporary file that's in use. </p>
<p>
<b>Listing A: Conserve.bat</b></p>
<pre><code>REM The following commands remove all files with the extensions
REM .bak, .old, .log, and .tmp from the root directory and from your
REM Windows directory. You should omit the appropriate lines if 
REM you're intentionally storing backups of your system configuration
REM information in a .bak or .old file or if you're compiling a LOG
REM file that you don't want to overwrite.

Erase C:\*.bak
Erase C:\Windows\*.bak
Erase C:\*.old
Erase C:\Windows\*.old
Erase C:\*.log
Erase C:\Windows\*.log
Erase C:\*.tmp
Erase C:\Windows\*.tmp

REM The following command erases the entire contents of your 
REM Windows\Temp directory. Don't execute this command unless
REM all other applications are closed.

REM The &lt;y.txt appended to the end of the command prevents
REM the command from asking for permission to delete the files.
REM You can make the command ask for permission to delete all the 
REM files in the directory by removing the &lt;y.txt. If you want the
REM command to ask for confirmation before deleting each individual
REM file, remove &lt;y.txt and replace it with /P .


Erase C:\Windows\Temp\*.* &lt;y.txt

REM The next set of commands are for Internet Explorer 3 users only.
REM These commands empty your cache and history directories. If you're
REM using Internet Explorer 4 or have information in these directories
REM that you want to preserve, you should omit these commands.

REM The &lt;y.txt appended to the end of the following commands,
REM prevents them from asking for permission to delete
REM the files. You can make the command ask for permission 
REM by removing the &lt;y.txt from the end of the commands.
REM If you want the command to ask for confirmation
REM before deleting each individual file, remove &lt;y.txt and
REM replace it with /P .

Erase C:\Windows\Tempor~1\Cache1\*.* &lt;y.txt
Erase C:\Windows\Tempor~1\Cache2\*.* &lt;y.txt 
Erase C:\Windows\Tempor~1\Cache3\*.* &lt;y.txt 
Erase C:\Windows\Tempor~1\Cache4\*.* &lt;y.txt 
Erase C:\Windows\History\*.* &lt;y.txt

REM This set of commands is for Internet Explorer 4 users only.
REM These commands empty your cache and history directories. If you're
REM using Internet Explorer 3 or have information in the directories
REM that you want to preserve, you should omit those commands.
REM You'll also have to customize the directory names, since they
REM are system-specific. For information on determining the appropriate 
REM directory names, see the article "Making the Most of Your Hard Disk Space,
REM Part 2" [Windows 95 Professional, January 1998]. 

REM The &lt;y.txt appended to the end of the following commands
REM prevents them from asking for permission to delete the
REM files. You can make the commands ask for permission to
REM delete all the files in the directory by removing 
REM &lt;y.txt from the end of the commands. If you want the
REM commands to ask for confirmation before deleting each
REM individual file, remove &lt;y.txt and replace it with /P .

Erase C:\Windows\Tempor~1\Ljz3akip\*.* &lt;y.txt
Erase C:\Windows\Tempor~1\Wca56jbi\*.* &lt;y.txt
Erase C:\Windows\Tempor~1\Epiiyh7y\*.* &lt;y.txt
Erase C:\Windows\Tempor~1\Ckzus002\*.* &lt;y.txt
Erase C:\Windows\History\*.* &lt;y.txt

REM The next command runs ScanDisk and repairs any damaged files on 
REM your hard disk. There are several switches you can use with this
REM command. These switches include
REM DRIVE   Specifies the hard disk to check
REM /A      Scans all nonremovable hard disks
REM /N      Starts and closes ScanDisk automatically
REM /P      Prevents ScanDisk from correcting errors that it encounters

ScanDisk /A /N

REM The Pause command that follows forces the batch file to wait until the user 
REM presses any key before continuing with the next command. Otherwise, the batch 
REM file will attempt to start Defrag while ScanDisk is still running. Since ScanDisk 
REM and Defrag can't run simultaneously, you must wait until ScanDisk
REM finishes before pressing a key to launch Defrag.

Pause

REM The following command tells Defrag to defragment your hard disk.
REM There are several switches you can use with this command. These
REM switches include
REM DRIVE  Specifies which hard disk to defragment
REM /ALL       Defragments all nonremovable hard disks
REM /F              Defragments files and free disk space
REM /U              Defragments files only
REM /Q              Defragments free space only
REM /CONCISE     Hides details during defragmentation
REM /DETAILED    Displays details during defragmentation
REM /NOPROMPT    Makes Defrag run automatically with no required user intervention.

Defrag /ALL /F /DETAILED / NOPROMPT
</code></pre>
<p>
<b>Conclusion </b></p>
<p>
Instead of manually running through the procedures we outlined in "Making the Most of Your Hard Disk Space, Part 2, " you can easily create a batch file to do routine hard disk cleaning. In this article, we've shown you how to create such a batch file.</p>
<p>
-----------------------------</p>
<p>
This article is reproduced from the January 1998 issue of <b><i>Windows 95 Professional</i>. <i>Windows 95 Professional</i></b> is an independently produced publication of The Cobb Group. No part of this article may be used or reproduced in any fashion (except in brief quotations used in critical articles and reviews) without prior consent of The Cobb Group. To contact The Cobb Group, please call (800) 223-8720 or (502) 493-3200.</p>
<p>
Copyright © 1998 The Cobb Group, a division of Ziff-Davis Inc. The Cobb Group and The Cobb Group logo are trademarks of Ziff-Davis Inc. All rights reserved. Reproduction in whole or in part in any form or medium without express written permission of Ziff-Davis is prohibited. </p>
</font></BODY>
</HTML>
