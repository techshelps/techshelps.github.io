<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The SQLCODE Variable</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H3>The SQLCODE Variable</H3><P CLASS="t">The most important and widely used field of the SQLCA data structure is the SQLCODE variable. Each time that SQL&nbsp;Server runs an Embedded SQL statement, it sets the value of the SQLCODE variable to indicate whether or not the last Embedded SQL statement completed successfully. A value of 0 indicates that the last Embedded SQL statement was successful. Values other than 0 indicate warnings or errors. </P>
<P CLASS="t">To use SQLCODE in your program, you can either declare it explicitly as long SQLCODE; or leave it undeclared and have the precompiler generate a declaration. However, the precompiler will only generate a declaration in a source module that contains a main() or a WinMain() function.</P>
<P CLASS="t">The preprocessor automatically inserts a definition of</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">extern long SQLCODE;
</FONT></PRE>
<P CLASS="t">in all .SQC modules, so the actual definition of SQLCODE should only occur in one module. If your project does not include a .SQC file that includes a main() or WinMain() function, you must explicitly declare SQLCODE in one of your modules. Explicit SQLCODE declarations can occur either inside or outside of a host variable declaration block.</P>
<P CLASS="t">For more information about SQLCODE, see Appendix A, "Advanced Programming." </P>
</FONT>
</BODY>
</HTML>
