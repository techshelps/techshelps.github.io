<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Call-level Method</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H2>Call-level Method</H2><P CLASS="t">SQL&nbsp;Server programs that are written using the DB-Library or ODBC API methods communicate directly with SQL&nbsp;Server through C function calls. DB-Library or ODBC functions pass SQL statements to SQL&nbsp;Server and return the results of queries. The call-level method of programming requires no precompiler; however, you cannot include Transact SQL statements in your C programs, like you can with Embedded SQL.</P>
<P CLASS="t">For example, to use DB-Library to connect to SQL&nbsp;Server and execute a simple query using the <I>pubs</I> sample database requires source code similar to the following:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">#define DBNTWIN32
#include &lt;sqlfront.h&gt;
#include &lt;sqldb.h&gt;

main()
{
    DBPROCESS *dbproc;
    LOGINREC *login;
    RETCODE r;

    dbinit();
    login = dblogin();
    if (login == NULL)
        return (1);
    DBSETLUSER(login, "my_login");
    DBSETLPWD(login, "my_password");
    dbproc = dbopen(login, "my_server");
    dbfreelogin(login);
    if (dbproc == NULL)
        return (1);
    dbuse(dbproc, "pubs");
    dbcmd(dbproc,
        "select au_fname from authors where au_lname = 'White'");
    r = dbsqlexec(dbproc);
    if (r == FAIL)
        return (1);
    while (1)
    {
        r = dbresults(dbproc);
        if (r == SUCCEED)
        {
            /* Process the rows with dbnextrow() */
        }
        if ((r == FAIL) || (r == NO_MORE_RESULTS))
            break;
    }
    return (0);
}
</FONT></PRE>
<P CLASS="t">The DB-Library approach, using C function calls, is more verbose and more flexible than the Embedded SQL approach, and it can be loosely coupled to any database structure. Because a great deal of the program's behavior can be changed dynamically, DB-Library programs are often general-purpose applications. DB-Library is well suited for environments where the database structure is not known in advance.</P>
</FONT>
</BODY>
</HTML>
