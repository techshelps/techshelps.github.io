<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Managing Transactions</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H2>Managing Transactions</H2><P CLASS="t">With Embedded SQL, you can use the full transaction control facilities of SQL&nbsp;Server.</P>
<P CLASS="t">The COMMIT<B> </B>statement marks the end of a user-defined transaction that was initiated by a BEGIN TRANSACTION statement. The COMMIT<B> </B>statement makes changes to the transaction's database permanent and visible to other users. It also removes all locks from the affected data so that other users can access the data. </P>
<P CLASS="t">As with other SQL&nbsp;Server applications, statements that are not bound by<B> </B>BEGIN TRANSACTION and COMMIT are automatically committed when the statement executes without an error.</P>
<P CLASS="t">The ROLLBACK<B> </B>statement reverses the effects of a user-specified transaction to the beginning of the OPEN TRANSACTION or to the last save point (marked by a Transact-SQL SAVE TRANSACTION statement) inside the open transaction. After a transaction is committed, it cannot be rolled back.</P>
<P CLASS="t">Note that by default, a COMMIT or ROLLBACK<B> </B>statement does not close cursors and applies only to the current connection if multiple connections are active. You can use the SET CURSOR_CLOSE_ON_COMMIT statement to automatically close all cursors on a connection when a COMMIT TRANSACTION or a ROLLBACK TRANSACTION statement is issued.</P>
</FONT>
</BODY>
</HTML>
