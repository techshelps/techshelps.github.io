<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Compiling and Linking for 16-bit Windows</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H3>Compiling and Linking for 16-bit Windows</H3><P CLASS="t">You can compile and link precompiled Embedded SQL programs for 16-bit Windows on a computer that is running the MS-DOS or 16-bit Windows operating system by using the Visual C++ development system (16-bit) version 1.52 or later.</P>
<P CLASS="t">Before you compile an Embedded SQL program for 16-bit Windows, set the LIB environment variable to include the full path where the following library files are located:</P>
<UL><LI> <FONT FACE="Symbol"></FONT>    CAW.LIB (supplied with Embedded SQL)</LI><LI> <FONT FACE="Symbol"></FONT>    SQLAKW.LIB (supplied with Embedded SQL)</LI><LI> <FONT FACE="Symbol"></FONT>    LIBW.LIB (supplied with 16-bit Visual C++)</LI><LI> <FONT FACE="Symbol"></FONT>    MLIBCEW.LIB or LLIBCEW.LIB (supplied with 16-bit Visual C++)</LI></UL><P CLASS="t">For example:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">SET LIB=C:\MSVC\LIB;C:\MSSQL\ESQL\LIB
</FONT></PRE>
<P CLASS="proch"><B><img src="prcarrow.gif">    To compile and link a program for 16-bit Windows</B></P>
<P CLASS="ls">    1.    Run the compiler CL.EXE as you would for 16-bit Windows to create an object file. For example:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">CL /c /W3 /AM MYPROGRM.C
</FONT></PRE>
<P CLASS="lt1">In the example, the compiler creates the object file MYPROGRM.OBJ. The <B>/AM</B> compiler option sets the memory model of the program to <I>medium</I>. You can use any additional compiler options that are allowed by the compiler. </P>
<P CLASS="ls">    2.    Run the linker LINK.EXE as you would for 16-bit Windows to link the compiled Embedded SQL object file and system libraries, which to creates an executable file for Windows. When linking files for Windows-based programs, you must explicitly link with the SQLAKW.LIB and CAW.LIB libraries. For example:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">LINK /NOD MYPROGRM.OBJ,,, LIBW.LIB MLIBCEW.LIB SQLAKW.LIB CAW.LIB, MYPROGRM.DEF;
</FONT></PRE>
<P CLASS="lt1">In the example, the compiled object file MYPROGRM.OBJ, the system libraries LIBW.LIB and MLIBCEW.LIB, and the Embedded SQL libraries SQLAKW.LIB and CAW.LIB are linked together to create the executable file MYPROGRM.EXE for Windows.</P>
<P></P>
<P CLASS="t">To run a 16-bit Windows–based Embedded SQL application, the dynamic-link libraries SQLAKW.DLL, MSDBLIB3.DLL, and DBNMP3.DLL (or other appropriate Net-Library) must be available in your path.</P>
</FONT>
</BODY>
</HTML>
