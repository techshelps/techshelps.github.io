<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLSTATE Messages</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H2>SQLSTATE Messages</H2><P CLASS="t">SQLSTATE codes return values that are errors, warnings, or "no data found" messages. The following table displays how SQLSTATE and SQLCODE messages correspond to each other.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="thf"><B>SQLSTATE code</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>SQLCODE code</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">First digit greater than 0</P></TD><TD VALIGN="TOP"><P CLASS="tt">Negative number</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">First digit equal to 1</P></TD><TD VALIGN="TOP"><P CLASS="tt">1</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">First digit equal to 2</P></TD><TD VALIGN="TOP"><P CLASS="tt">100</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">If a WHENEVER SQLERROR CALL <I>myproc() </I>statement is in effect, <I>myproc()</I> will be called in all cases where SQLSTATE returns a value with a nonzero first digit.</P>
<P CLASS="t">Use SQLSTATE to check for exceptions and warnings. To use SQLSTATE in your program, you must explicitly declare SQLSTATE within a host variable declaration block. For example:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">EXEC SQL BEGIN DECLARE SECTION ;
char SQLSTATE [6] ;  // 5 characters for code and one character for
                     // null terminator
EXEC SQL END DECLARE SECTION;
</FONT></PRE>
<P CLASS="t">Errors caught at compile time using the <B>/SQLACCESS</B> option will not be mapped to SQLSTATE values at runtime.</P>
<P CLASS="t">The following table lists SQL Server errors and the SQLSTATE codes they map to.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="58pt" VALIGN="TOP"><COL WIDTH="63pt" VALIGN="TOP"><COL WIDTH="225pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="thf"><B>SQLSTATE code</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>SQL Server message or DB-Library error numbers</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">01001</P></TD><TD VALIGN="TOP"><P CLASS="tt">532,10095 (DB-Library)</P></TD><TD VALIGN="TOP"><P CLASS="tt">Cursor update or delete failure due to optimistic concurrency check failure.  </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">01003</P></TD><TD VALIGN="TOP"><P CLASS="tt">8153</P></TD><TD VALIGN="TOP"><P CLASS="tt">Elimination of null values by set operator (warning )</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">01004</P></TD><TD VALIGN="TOP"><P CLASS="tt">n/a</P></TD><TD VALIGN="TOP"><P CLASS="tt">Select or fetch into host variable that is too short. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">02000</P></TD><TD VALIGN="TOP"><P CLASS="tt">n/a</P></TD><TD VALIGN="TOP"><P CLASS="tt">No data found.  Equivalent to SQLCODE = 100.  Occurs when:</P>
<P CLASS="tt">Cursor fetch at end of result set</P>
<P CLASS="tt">Cursor fetch on empty result set</P>
<P CLASS="tt">Singleton select returns no data</P>
<P CLASS="tt">Searched delete affects no rows*</P>
<P CLASS="tt">Insert…Select affects no rows*</P>
<P CLASS="tt">Searched update affects no rows*  </P>
<P CLASS="tt"><BR>The conditions designated with * are only detected when the program is compiled with the NOSQLACCESS option to NSQLPREP.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">07002</P></TD><TD VALIGN="TOP"><P CLASS="tt">n/a</P></TD><TD VALIGN="TOP"><P CLASS="tt">Number of columns does not match number of host variables.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">21000</P></TD><TD VALIGN="TOP"><P CLASS="tt">512</P></TD><TD VALIGN="TOP"><P CLASS="tt">Singleton select returns more than one row , or subquery preceded by = returns more than one value </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22001</P></TD><TD VALIGN="TOP"><P CLASS="tt">8152</P></TD><TD VALIGN="TOP"><P CLASS="tt">String data truncated on right on insert or update </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22002</P></TD><TD VALIGN="TOP"><P CLASS="tt">n/a</P></TD><TD VALIGN="TOP"><P CLASS="tt">Null value returned with no indicator variable provided.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22003</P></TD><TD VALIGN="TOP"><P CLASS="tt">168,220,232,234,<BR>236-238,244,<BR>246,248,519-524,<BR>535,8115,<BR>10015<BR>(DB-Library)</P></TD><TD VALIGN="TOP"><P CLASS="tt">Arithmetic overflow error</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22005</P></TD><TD VALIGN="TOP"><P CLASS="tt">206,235,245,247,249,<BR>256,257,305,409,518,<BR>529</P></TD><TD VALIGN="TOP"><P CLASS="tt">Datatype conversion error.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22008</P></TD><TD VALIGN="TOP"><P CLASS="tt">210,211,241,242,295,<BR>296,517</P></TD><TD VALIGN="TOP"><P CLASS="tt">Datatype conversion error.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22012</P></TD><TD VALIGN="TOP"><P CLASS="tt">8134</P></TD><TD VALIGN="TOP"><P CLASS="tt">Divide by zero error.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22019</P></TD><TD VALIGN="TOP"><P CLASS="tt">1010, 506</P></TD><TD VALIGN="TOP"><P CLASS="tt">Invalid escape character </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22022</P></TD><TD VALIGN="TOP"><P CLASS="tt">n/a</P></TD><TD VALIGN="TOP"><P CLASS="tt">Indicator variable overflow.  </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22024</P></TD><TD VALIGN="TOP"><P CLASS="tt">n/a</P></TD><TD VALIGN="TOP"><P CLASS="tt">Unterminated C string passed as input host variable</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">22025</P></TD><TD VALIGN="TOP"><P CLASS="tt">310</P></TD><TD VALIGN="TOP"><P CLASS="tt">Invalid escape sequence, e.g. escape char not followed by %, _, or escape char. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">23000 </P></TD><TD VALIGN="TOP"><P CLASS="tt">233,272,273,515,530,<BR>547,1505,1508,2601,<BR>2615,2626,2627,3604,<BR>3605</P></TD><TD VALIGN="TOP"><P CLASS="tt">Constraint violation </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">24000</P></TD><TD VALIGN="TOP"><P CLASS="tt">n/a</P></TD><TD VALIGN="TOP"><P CLASS="tt">Invalid cursor state.  </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">25000</P></TD><TD VALIGN="TOP"><P CLASS="tt">266,277,611,628,3902,<BR>3903,3906,3908,6401</P></TD><TD VALIGN="TOP"><P CLASS="tt">Transaction state error.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">40001</P></TD><TD VALIGN="TOP"><P CLASS="tt">1205,1211,2625,<BR>3309,7112</P></TD><TD VALIGN="TOP"><P CLASS="tt">Transaction rollback due to deadlock. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">42000</P></TD><TD VALIGN="TOP"><P CLASS="tt">207,208,213,229,<BR>230,260</P></TD><TD VALIGN="TOP"><P CLASS="tt">Syntax error, permission violation, or other non-specific error. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">44000 </P></TD><TD VALIGN="TOP"><P CLASS="tt">550</P></TD><TD VALIGN="TOP"><P CLASS="tt">View with check option violation </P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t"></P>
</FONT>
</BODY>
</HTML>
