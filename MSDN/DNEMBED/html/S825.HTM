<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Defining Cursors</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H2>Defining Cursors</H2><P CLASS="t">Standard cursors can be used to scroll through and update a results set. Standard cursors do not require a unique index for SQL Server version 6.5; do&nbsp;not require a timestamp or a second connection to a database for updates, and do&nbsp;not create a copy of the entire results set. The following tables summarize these differences.</P>
<P CLASS="t">Standard cursors will continue to be enhanced in later versions; however, browse cursors will not.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="118pt" VALIGN="TOP"><COL WIDTH="228pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="thf"><B>Standard cursor</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Connections to the server</P></TD><TD VALIGN="TOP"><P CLASS="tt">All share the same connection.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Timestamp column</P></TD><TD VALIGN="TOP"><P CLASS="tt">Not required.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Transaction behavior</P></TD><TD VALIGN="TOP"><P CLASS="tt">All cursors share the same transaction space. Standard cursors cannot block each other.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Unique index</P></TD><TD VALIGN="TOP"><P CLASS="tt">Not required for SQL Server version 6.5.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Data currency</P></TD><TD VALIGN="TOP"><P CLASS="tt">Data values are always current. Row membership depends on the SCROLLOPTION setting:</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt">If keyset-driven, membership is fixed at cursor-open time. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt">If dynamic, membership changes. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Restrictions on use of SQL language</P></TD><TD VALIGN="TOP"><P CLASS="tt">Cannot be used on stored procedures.<BR>Cannot contain UNION, GROUP BY, and<BR>HAVING clauses. In SQL Server version 6.5, dynamic cursors can contain an ORDER BY clause if the table has a unique index.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="119pt" VALIGN="TOP"><COL WIDTH="228pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="thf"><B>Browse cursor</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Connections to the server</P></TD><TD VALIGN="TOP"><P CLASS="tt">One per cursor, plus one base connection for all updates.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Timestamp column</P></TD><TD VALIGN="TOP"><P CLASS="tt">Required for positioned update or delete operations.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Transaction behavior</P></TD><TD VALIGN="TOP"><P CLASS="tt">Read-only cursors can block updates that are made by the same program.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Unique index</P></TD><TD VALIGN="TOP"><P CLASS="tt">Required for update only.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Data currency</P></TD><TD VALIGN="TOP"><P CLASS="tt">For read-only cursors, all data is current.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt">For updatable cursors, the server takes a snapshot of the data and stores it in the <I>tempdb</I> database when the cursor is opened.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Restrictions on use of SQL language</P></TD><TD VALIGN="TOP"><P CLASS="tt">Updatable cursors require the FOR BROWSE clause.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
</FONT>
</BODY>
</HTML>
