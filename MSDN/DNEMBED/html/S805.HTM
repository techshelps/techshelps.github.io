<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Compiling and Linking for Windows NT and Windows 95</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H3>Compiling and Linking for Windows&nbsp;NT and Windows&nbsp;95</H3><P CLASS="t">You can compile and link precompiled Embedded SQL programs for Windows&nbsp;NT and Windows 95 on a computer that is running the Windows&nbsp;NT or Windows 95 operating system by using the Visual C++ development system (32-bit) version 2.0.</P>
<P CLASS="t">Before you compile an Embedded SQL program for Windows&nbsp;NT or Windows 95, set the LIB environment variable to include the full path where the following library files are located:</P>
<UL><LI> <FONT FACE="Symbol"></FONT>    CAW32.LIB (supplied with Embedded SQL)</LI><LI> <FONT FACE="Symbol"></FONT>    SQLAKW32.LIB (supplied with Embedded SQL)</LI><LI> <FONT FACE="Symbol"></FONT>    KERNEL32.LIB (supplied with 32-bit Visual C++)</LI><LI> <FONT FACE="Symbol"></FONT>    USER32.LIB (supplied with 32-bit Visual C++)</LI><LI> <FONT FACE="Symbol"></FONT>    GDI32.LIB (supplied with 32-bit Visual C++)</LI><LI> <FONT FACE="Symbol"></FONT>    LIBCMT.LIB (supplied with 32-bit Visual C++)</LI></UL><P CLASS="t">For example:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">SET LIB=C:\MSDEV\LIB;C:\MSSQL\ESQL\LIB
</FONT></PRE>
<P CLASS="proch"><B><img src="prcarrow.gif">    To compile and link a program for Windows&nbsp;NT and Windows&nbsp;95</B></P>
<P CLASS="ls">    1.    Run the compiler CL.EXE as you would for Windows&nbsp;NT or Windows 95 to create an object file. For example:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">CL /c /W3 /D"_X86_" MYPROGRM.C
</FONT></PRE>
<P CLASS="lt1">In this example, the compiler creates the object file MYPROGRM.OBJ. The <B>/D"_X86_"</B> compiler option defines the symbol that is necessary for Windows&nbsp;NT and Windows 95 operating systems that run on Intel&reg;-based computers. You can use any additional compiler options that are allowed by the compiler. </P>
<P CLASS="ls">    2.    Run the linker (LINK.EXE) as you would for Windows&nbsp;NT or Windows&nbsp;95 to link the compiled Embedded SQL object file and system libraries, which creates an executable file for Windows&nbsp;NTor Windows 95. When linking files for Windows&nbsp;NT –based or Windows 95–based programs, you must explicitly link with the SQLAKW32.LIB and CAW32.LIB libraries. For example:</P>
<P CLASS="spacing"><BR></P>
<PRE><FONT FACE="NEW COURIER" SIZE= "3">LINK /NOD /subsystem:windows MYPROGRM.OBJ MYPROGRM.RES KERNEL32.LIB GDI32.LIB USER32.LIB LIBCMT.LIB SQLAKW32.LIB CAW32.LIB
</FONT></PRE>
<P CLASS="lt1">In the example, the compiled object file MYPROGRM.OBJ, the system libraries, and the Embedded SQL libraries SQLAKW32.LIB and CAW32.LIB are linked together to create the executable file MYPROGRM.EXE for Windows&nbsp;NT or Windows 95.</P>
<P CLASS="t">To run a Windows&nbsp;NT–based or Windows&nbsp;95–based Embedded SQL application, the dynamic-link libraries SQLAKW32.DLL, NTWDBLIB.DLL, and DBNMPNTW.DLL (or other appropriate Net-Library) must be available in your path.</P>
</FONT>
</BODY>
</HTML>
