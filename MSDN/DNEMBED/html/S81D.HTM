<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Preparing SQLDA for Data Input and Output</TITLE><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" link=#003399 vlink=#996699>
<FONT FACE="Verdana, Arial, Helvetica"SIZE="2">

<H3>Preparing SQLDA for Data Input and Output</H3><P CLASS="t">The SQLDA data structure contains descriptive information about each input parameter or output column. The structure contains the column name, the datatype, the length, and a pointer to the actual data buffer for each input or output parameter.</P>
<P CLASS="t">For output data that uses the SQLDA data structure, you can use the DESCRIBE statement (or the PREPARE statement with the INTO option) to enter the column name, the datatype, and other data into the appropriate fields of the SQLDA data structure.</P>
<P CLASS="t">Before using the SQLDA data structure in a PREPARE INTO or DESCRIBE statement, your application must set the size of the SQLDA data structure in bytes and the maximum number of entries. These numbers are reflected in the <I>sqldabc</I> and <I>sqln</I> fields, respectively. </P>
<P CLASS="t">Before performing a FETCH<B> </B>statement, the application must insert into the <I>sqldata</I> field the address of each program variable that will receive the data from the corresponding column. (The <I>sqldata</I> field is part of <I>sqlvar</I> within the SQLDA data structure.) If indicator variables are used, <I>sqlind</I> must also be set to the corresponding address. The datatype field (<I>sqltype</I>) and length field (<I>sqllen</I>) are filled with information in the SQL&nbsp;Server column from a PREPARE<B> </B>INTO or a DESCRIBE statement. The value in the datatype and length fields can be overridden by the application before a FETCH statement is executed. The <I>sqltype</I> code and the <I>sqld</I> address that are assigned must be one of the valid datatypes that are listed in the "Valid Values for <I>sqltype</I>" section, later in this chapter.</P>
<P CLASS="t">Before the DESCRIBE or PREPARE statement is issued, the value of <I>sqln</I> must be set higher than the anticipated number of output columns. If the number of columns is unknown, you can set <I>sqln</I> to 0 and then issue a DESCRIBE statement. No column detail information is moved into the SQLDA data structure, but the number of columns in the results set is inserted into <I>sqld</I>.</P>
<P CLASS="t">To use the SQLDA data structure for input data, your application must supply data for the fields of the entire SQLDA data structure, including the <I>sqln</I>, <I>sqld</I>, <I>sqldabc</I>, <I>sqltype</I>, <I>sqllen</I>, and <I>sqldata</I> fields for each variable. If the <I>sqltype</I> field has an odd code number (value), the address of the indicator variable must also be supplied.</P>
</FONT>
</BODY>
</HTML>
