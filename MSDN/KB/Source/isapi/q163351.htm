

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Required Privilege is Not Held ISAPI Debugging Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163351">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1997/02/07">
<META NAME="Keywords" CONTENT="IISAPI">
<META NAME="KBArea" CONTENT="Support; KB; ISAPI">
<META NAME="Description" CONTENT="  While attempting to debug an ISAPI extension, you may receive the following error message:     HTTP/1.0 500 Server Error ( A required privilege is not held by the    client. )  If you are running any CGI applications while running IIS interactively...">
<META NAME="Product" CONTENT="ISAPI">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QBWS,QAB4,QBWG,QA9A,QAAP,QBVV,QASR,QAI5,QDIR,QBW3,QAUJ,QAMB,QAG2,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Required Privilege is Not Held ISAPI Debugging Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163351</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server, versions 1.0, 2.0, 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
While attempting to debug an ISAPI extension, you may receive the following
error message:
<P>
<PRE>   HTTP/1.0 500 Server Error ( A required privilege is not held by the
   client. )

</PRE>If you are running any CGI applications while running IIS interactively,
you will need to grant the following right to the logged on use in addition
to the above:
<P>
<PRE>   - Replace a process level token.

</PRE><h2>CAUSE</h2>
 
<P>
This error occurs if the user context in which Internet Information Server
(IIS) is running does not have the following privileges:
<P>
<PRE>   - Act as a part of the operating system
   - Generate security audits

</PRE>Normally Internet Information Server (IIS) runs as a service and has system
permissions. Often when debugging ISAPI DLLs under IIS, users run IIS
interactively, in the context of the logged on user.
<P>
If the logged on user does not have the above privileges on the local
Windows NT Server or Workstation, IIS starts, but any attempts to access a
page on the server results in the above error on the browser.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Perform the following steps on the IIS server to correct the problem. It is
necessary to have administrative privileges on the IIS machine to perform
these steps:

<OL><P><LI>From the Administrative Tools group, run User Manager or User Manager
   for domains. If you are not using User Manager for Domains, skip to
   step 5.

<P><LI>From the User menu, choose Select Domain.

<P><LI>If the IIS server is a domain controller, select the domain in which it
   resides.

<P><LI>If the IIS server is a "stand alone" server or a workstation, enter the
   server name in the following form in the Domain text box and click OK:
<P>
<P><PRE>      \\machinename
</PRE>
<P><LI>From the Policies menu, choose User Rights.

<P><LI>Check the box labeled "Show Advanced User Rights."

<P><LI>In the drop-down list labeled "Right:," select "Act as a part of the
   operating system."

<P><LI>Choose the Add button.

<P><LI>In the Add User and Groups dialog box, ensure that the box labeled "Show
   names from:" displays the correct domain or machine name for the account
   to be added.

<P><LI>Click the Show Users button.

<P><LI>In the Names list, select the user account to be added.

<P><LI>Click the Add button. The user name now is listed in the Add Names
<P><PRE>    box.
</PRE>
<P><LI>Click OK.

<P><LI>Repeat steps 7 through 13 and add the user to the "Generate security
<P><PRE>    audit" right.
</PRE>
<P><LI>Log off and log on to the system. The above changes do not take effect
<P><PRE>    until a log on occurs.
</PRE><P>
</OL>If the IIS machine is a "stand-alone" server or a workstation that is also
a member of a domain, steps 3 through 5 are required.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information and detailed steps on how to debug an ISAPI DLL,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ISAPI/Q152054.htm">Q152054</A></B>
   TITLE     : "Tips for Debugging ISAPI DLLs"

</PRE></OL>Developer Studio version 4.1 and up, Technical Note 63
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : IISAPI<BR>
Technology          : kbInetDev<BR>
Version             : 1.0 2.0 3.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
