

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Property Sheet w/ Multiline Edit Control Ignores ESC Key </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130765">
<META NAME="KBModify" CONTENT="1995/09/29">
<META NAME="KBCreate" CONTENT="1995/05/25">
<META NAME="Keywords" CONTENT="kbui kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Pressing the ESC key when the focus is on a Multiline Edit control that is a child of a property sheet page, does not dismiss the property sheet control as expected.  CAUSE =====  When the ESC key is pressed while focus is on a Mutiline Edit contro...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QAPN,QAEV,QA7O,QAOE,QAMN,QAB5,QAH4,QAYC,QAHE,QBXV,QDL9,QBWO,QBWN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Property Sheet w/ Multiline Edit Control Ignores ESC Key</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130765</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Pressing the ESC key when the focus is on a Multiline Edit control that is
a child of a property sheet page, does not dismiss the property sheet
control as expected.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the ESC key is pressed while focus is on a Mutiline Edit control, the
IDCANCEL notification (sent with a WM_COMMAND message) is sent to the
property sheet dialog proc whose template contains the Multiline Edit
control. Property sheet dialog procs do not process this message, so it is
not forwarded to the property sheet control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Trap the IDCANCEL notification that is sent along with the WM_COMMAND
message in the property sheet dialog proc that contains the multiline edit
control. Then forward the message to the property sheet control. (The
property sheet control is the parent of all the property sheet page
dialogs.) The following code shows how to do this:
<P>
<P><h3>Code Sample</h3>
 
<P>
<PRE>//
//  FUNCTION: SheetDialogProc(HWND, UINT, WPARAM, LPARAM)
//
//  PURPOSE:  Processes messages for a page in the PPT sheet control.
//
//  PARAMETERS:
//    hdlg - window handle of the property sheet
//    wMessage - type of message
//    wparam - message-specific information
//    lparam - message-specific information
//
//  RETURN VALUE:
//    TRUE -  message handled
//    FALSE - message not handled
//

</PRE>LRESULT CALLBACK SheetDialogProc(HWND hdlg,
<PRE>                      UINT uMessage,
                     WPARAM wparam,
                     LPARAM lparam)
{
    LPNMHDR lpnmhdr;
    HWND    hwndPropSheet;
    switch (uMessage)
    {
   case WM_INITDIALOG:

      // Do whatever initializations you have here.
      return TRUE;


   case WM_NOTIFY:

      // more code here ...

      break;


    case WM_COMMAND:

       switch(LOWORD(wparam))
      {

         case IDCANCEL:

         // Forward this message to the parent window
         // so that the PPT sheet is dismissed
            SendMessage(GetParent(hdlg),
                          uMessage,
                          wparam,
                          lparam);
         beak;

         default:
         break;
      }
      break;

   }

</PRE>NOTE: This solution also works with wizard controls. This behavior is seen
under both Windows NT and Windows 95; the solution in this article works
for both platforms.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 user styles<BR>
KBCategory: kbui kbprb kbcode<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
