

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Services, Desktops, and Window Stations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171890">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="BseService">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  A Windows NT service has a Window station and Desktop combination associated with it. This is based on which account the service is running in.  If the service is running in the LocalSystem account and is not interactive (that is, the service type ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA0J,QACK,QAJQ,QAGU,QABA,QAI5,QAGQ,QBWS,QBWP,QBG2,QAAD,QBVV,QA7K,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Services, Desktops, and Window Stations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171890</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows NT versions 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A Windows NT service has a Window station and Desktop combination
associated with it. This is based on which account the service is running
in.
<P>
If the service is running in the LocalSystem account and is not interactive
(that is, the service type does not include the SERVICE_INTERACTIVE_PROCESS
flag), the service will use the following Window station and Desktop:
<P>
Service-0x0-3e7$\default where "Service-0x0-3e7$" is the name of the Window
station and "default" is the name of the desktop.
<P>
This is a noninteractive Window station.
<P>
If the service is running in the LocalSystem account and is interacting
with the desktop (that is, the service type includes the
SERVICE_INTERACTIVE_PROCESS flag), the service will use the following
Window station and Desktop:
<P>
Winsta0\default
<P>
This is an interactive Window station.
<P>
If the service is running in the security context of a user account, the
system will create a unique noninteractive Window station and Desktop for
that service. The name of the Window station will be based on the Logon
Security Identifier (SID) of the user:
<P>
Service-0xZ1-Z2$\default where Z1 is the high part and Z2 is the low part
of the Logon SID.
<P>
In addition, two services running in the same security context (same
service account name) will not receive the same Window station and Desktop
since Logon Security Identifier's(SID) are unique to that logon session.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A Window station can either be interactive or noninteractive. (At the
moment on Windows NT 3.51 and 4.0, only "Winsta0" can be an interactive
Window station.) Any Desktops created on the interactive Window station
will have the ability to become active. An active Desktop encompasses the
ability for user objects (such as windows and dialog boxes) created on the
Desktop to be visible to the interactively logged-on user (that is, the
user who logs on the system via CTRL-ALT-DELETE) and receive user input.
<P>
When the interactively logged-on user launches any processes, these
processes are associated with the "default" Desktop in the "Winsta0" Window
station. The "default" Desktop is considered the active Desktop. A process
on the active Desktop could switch Desktops such that another Desktop
becomes the active Desktop such as the "Winlogon" Desktop. Only one Desktop
can be the active Desktop at any one time. The SwitchDesktop API can be
used to activate a desktop. Please refer to the Platform SDK online
documentation for more information.
<P>
Desktops associated with a noninteractive Window station can create user
objects. These objects will never be visible to the interactively logged-on
user and will never receive any user input. If you have a noninteractive
Service running in the LocalSystem account, any user objects created by the
service will not be visible to the interactively logged-on user. In
addition, any processes launched by the service will also not be visible.
<P>
Following is other important information concerning Window stations and
desktops:

<UL><LI>Window messages can only be sent between processes on the same Desktop.
   They cannot be sent across processes associated with different Desktops.

<LI>Application-defined hooks are limited in the same way that Windows
   messages are. The hook procedure of a process running in a particular
   desktop will only get messages targeted for windows created in the same
   desktop.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : BseService<BR>
Version             : 3.51 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
