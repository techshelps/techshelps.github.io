

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Incorrect prototype for VDMStartTaskInWOW()in VDMDBG.H file </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171275">
<META NAME="KBModify" CONTENT="1997/07/11">
<META NAME="KBCreate" CONTENT="1997/07/10">
<META NAME="Keywords" CONTENT="BseMisc kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The function declaration for VDMStartTaskInWOW() API in VDMDBG.H is missing the WINAPI keyword as follows:     BOOL    WINAPI  // this keyword is missing in vdmdbg.h    VDMStartTaskInWOW(        DWORD           dwProcessId,        LPSTR           l...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAEY,QAR4,QAPF,QALZ,QAAP,QDIX,QDNN,QDIT,QDH6,QBVV,QA59,QAY5,QANA,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Incorrect prototype for VDMStartTaskInWOW()in VDMDBG.H file</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171275</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The function declaration for VDMStartTaskInWOW() API in VDMDBG.H is missing
the WINAPI keyword as follows:
<P>
<PRE>   BOOL
   WINAPI  // this keyword is missing in vdmdbg.h
   VDMStartTaskInWOW(
       DWORD           dwProcessId,
       LPSTR           lpCommandLine,
       WORD            wShow
   );

</PRE><h2>CAUSE</h2>
 
<P>
Without the WINAPI or PASCAL keyword, the Visual C++ Linker looks for the
symbol _VDMStartTaskInWOW, which is not available in the VDMDBG.LIB. With
the WINAPI keyword, the Linker looks for the correct symbol,
_VDMStartTaskInWOW@12 and finds it.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Fix the prototype in your local copy of VDMDBG.H file as follows:
<P>
<PRE>   BOOL WINAPI VDMStartTaskInWOW(
       DWORD           dwProcessId,
       LPSTR           lpCommandLine,
       WORD            wShow
   );

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
VDMDBG.DLL or Virtual DOS Machine (VDM) Debugging Library is a DLL that
provides a mechanism used to support debugging 16-bit applications under
Windows NT. VDMDBG.DLL is new for Windows NT 4.0 and works only under
Windows NT platform.
<P>
The functions and data structures used by this DLL are prototyped in the
header file VDMDBG.H. The services provided by this DLL are documented
separately in a help file called, VDMDBG.HLP, which is included with the
Win32 SDK in the \MSTOOLS\DOC\MISC\ directory. These services are not
included in the standard documentation for the Win32 Application
Programming Interface (API).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ntvdm vdmdbg.hlp nt5 nt5fix<BR>
Keywords            : BseMisc kbprg<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
