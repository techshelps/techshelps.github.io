

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Changing Text Alignment in an Edit Control Dynamiclly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q66942 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1990/11/14">
<META NAME="Keywords" CONTENT="kbui kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  A Microsoft Windows edit control aligns its contents to the left or right margins, or centers its contents, depending on the window style of the control. The control styles ES_LEFT, ES_CENTER, and ES_RIGHT specify left-, center-, and right-alignmen...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEB,QAHP,QA7O,QAOE,QAMN,QAB5,QDL9,QBWO,QBWN,QAJQ,QAPN,QBWQ,QAMB,QAHV,QADX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Changing Text Alignment in an Edit Control Dynamiclly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q66942 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.0 and 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A Microsoft Windows edit control aligns its contents to the left or right
margins, or centers its contents, depending on the window style of the
control. The control styles ES_LEFT, ES_CENTER, and ES_RIGHT specify left-,
center-, and right-alignment, respectively.
<P>
Only multiline edit controls can be right-aligned or centered. Single-line
edit controls are always left-aligned, regardless of the control style
given.
<P>
Windows does not support altering the alignment style of a multiline edit
control after it has been created. However, there are two methods that you
can use to cause a multiline edit control in a dialog box to appear to
change alignment. Note that in each of these methods, the dialog box that
contains the control must be created with the DS_LOCALEDIT style.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The first method applies to all platforms. The second method does not apply
to Windows 95. Under Windows 95, EM_SETHANDlE and EM_GETHANDLE are not
supported. For more information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q130759.htm">Q130759</A></B>
   TITLE     : EM_SETHANDLE and EM_GETHANDLE Messages Not Supported

</PRE><h3>Method 1</h3>
 
<P>
Create three controls: one left-aligned, one centered, and one right-
aligned. Each has the same dimensions and position in the dialog box, but
only one is initially made visible.
<P>
When the alignment is to change, call ShowWindow() to hide the visible
control and to make one of the other controls visible.
<P>
To keep the text identical in all three controls, use the EM_GETHANDLE and
EM_SETHANDLE messages to share the same memory among all three controls.
<P>
<P><h3>Method 2</h3>
 
<P>
Initially create a single control. When the text alignment is to change,
retrieve location, size, and style bits for the existing edit control.
Create a new control with the same size and in the same location, but
change the style bits to reflect the new alignment.
<P>
Send the EM_GETHANDLE to each control to retrieve a handle to the memory
that stores the contents. Send an EM_SETHANDLE to each control to exchange
the memory used by each. Finally, destroy the original control.
<P>
There is a sample application named EDALIGN in the Microsoft Software
Library that demonstrates each of these methods. Note, however, that this
sample is a Windows 3.1 sample only.
<P>
Download EDALIGN.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/EDALIGN.EXE">EDALIGN.EXE</A> <I>(size: 21720 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/EDALIGN.EXE">EDALIGN.EXE</A> <I>(size: 21720 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 4.00 95 EDALIGN.EXE<BR>
KBCategory: kbui kbfile<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
