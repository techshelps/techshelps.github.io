

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Inverting Color Inverts Palette Index, Not RGB Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71227 ">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1991/04/10">
<META NAME="Keywords" CONTENT="kbgraphic">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Performing any bitwise logical operator on a color, such as inversion, does not modify the color's RGB value; it instead changes the index into the system palette. This applies also to the ROP codes associated with the blt functions (BitBlt, Stretc...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QAPG,QAI4,QA28,QATJ,QDL9,QBWO,QBWN,QBVV,QAY5,QAB5,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Inverting Color Inverts Palette Index, Not RGB Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71227 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Performing any bitwise logical operator on a color, such as inversion,
does not modify the color's RGB value; it instead changes the index
into the system palette. This applies also to the ROP codes associated
with the blt functions (BitBlt, StretchBlt, and PatBlt) and in
the SetRop2 function. For display devices with hardware palettes
[generally, devices with fewer than 24 bits-per-pixel (BPP)], this can
produce unexpected or undesirable results.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Suppose the system palette contained the following colors:
<P>
<PRE>                                   Entry #
   Color      0      1      2      3      4      5      6      7
   -----
   Red   =    0   0x80      0      0   0x80   0x80      0   0x80
   Green =    0      0   0x80      0   0x80      0   0x80   0x80
   Blue  =    0      0      0   0x80      0   0x80   0x80   0x80

                                   Entry #
   Color      8      9      A      B      C      D      E      F
   -----
   Red   = 0xC0   0xFF      0      0   0xFF   0xFF      0   0xFF
   Green = 0xC0      0   0xFF      0   0xFF      0   0xFF   0xFF
   Blue  = 0xC0      0      0   0xFF      0   0xFF   0xFF   0xFF

</PRE>The inversion of colors would look like this:
(Half = half intensity, Full = full intensity)
<P>
<PRE>   Color          Index      Inverse Color   Index
   -----          -----      -------------   -----
   Black              0      White               F
   Half Red           1      Full Cyan           E
   Half Green         2      Full Magenta        D
   Half Blue          3      Full Yellow         C
   Half Yellow        4      Full Blue           B
   Half Magenta       5      Full Green          A
   Half Cyan          6      Full Red            9
   Dark Gray          7      Light Gray          8

</PRE>This obviously is not the desired effect. Inverting a full-intensity
color such as red will not invert to full-intensity cyan; instead, it
is inverted to half-intensity cyan.
<P>
This is also true for any logical operations performed on the bits of
a bitmap, pen, or flood fill through ROP codes. All operations are
done on the index of the color and not its RGB value.
<P>
Note that when using custom palettes on a palette capable device, the
application does not have control over the precise mapping between
logical palette indexes and system palette indexes. The results of
bitwise logical operations are unpredictable in such a case.
<P>
The only way for an application to precisely control color mixing is
to perform the operation on RGB values, then translate the RGB result
back into the most appropriate palette index.
<P>
For example, one way to do this is to mix colors in a 24 BPP
device-independent bitmap (DIB), then set the DIB bits into the device
context (DC) again when finished. Another method is to query the RGB
color of pixels to modify, do the mixing, and then use the SetPixel
function to apply the change to the DC.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 4.00 95<BR>
KBCategory: kbgraphic<BR>
KBSubcategory: GdiPal<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
