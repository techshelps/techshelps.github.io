

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Which Windows NT (Server or Workstation) Is Running? </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124305">
<META NAME="KBModify" CONTENT="1997/06/24">
<META NAME="KBCreate" CONTENT="1994/12/27">
<META NAME="Keywords" CONTENT="BseMisc BseRegistry kbcode kbprg kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  You can determine which variant of Windows NT (Windows NT Server or Windows NT Workstation) is running by using the technique described in this article. Then you can use this information to execute code based on which variant is running.  MORE INFO...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAUD,QDIK,QBWS,QDL9,QBWQ,QBWO,QBWN,QALW,QATX,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Which Windows NT (Server or Workstation) Is Running?</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124305</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.51 and 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can determine which variant of Windows NT (Windows NT Server or Windows
NT Workstation) is running by using the technique described in this
article. Then you can use this information to execute code based on which
variant is running.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To find out which product is currently running, you need to determine the
value of the following registry entry:
<P>
HKEY_LOCAL_MACHINE\SYSTEM\
CurrentControlSet
Control\
ProductOptions
<P>
Use the following table to determine which product is running:
<P>
<PRE>ProductType   Product
</PRE> 
<PRE>WINNT         Windows NT Workstation is running
SERVERNT      Windows NT Server is running
LANMANNT      Windows NT Advanced Server is running (Server as Domain
              controller)

</PRE>The sample code creates a WhichNTProduct() function to indicate whether
Windows NT Server or Windows NT Workstation in currently running. The
following table gives the meaning for each return value:
<P>
<PRE>Return Value       Meaning
</PRE> 
<PRE>RTN_SERVER         Windows NT Server is running
RTN_WORKSTATION    Windows NT Workstation is running
RTN_NTAS           Windows NT Advanced Server is running
RTN_UNKNOWN        Unknown product type was encountered
RTN_ERROR          Error occurred

</PRE>To get extended error information, call GetLastError(). Some error checking
is omitted, for brevity.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   #define RTN_UNKNOWN 0
   #define RTN_SERVER 1
   #define RTN_WORKSTATION 2
   #define RTN_NTAS 3
   #define RTN_ERROR 13

   unsigned int WhichNTProduct(void)

   DWORD
   WhichNTProduct(
       void
       )
   {
       #define MY_BUFSIZE 32 // arbitrary. Use dynamic allocation
       HKEY hKey;
       TCHAR szProductType[MY_BUFSIZE];
       DWORD dwBufLen=MY_BUFSIZE;
       LONG lRet;

       if(RegOpenKeyEx(HKEY_LOCAL_MACHINE,

   TEXT("SYSTEM\\CurrentControlSet\\Control\\ProductOptions"),
                       0,
                       KEY_QUERY_VALUE,
                       &amp;hKey) != ERROR_SUCCESS) return RTN_ERROR;

       lRet = RegQueryValueEx(hKey,
                       TEXT("ProductType"),
                       NULL,
                       NULL,
                       (LPBYTE)szProductType,
                       &amp;dwBufLen);

       RegCloseKey(hKey);

       if(lRet != ERROR_SUCCESS) return RTN_ERROR;

       // check product options, in order of likelihood
       if (lstrcmpi(TEXT("WINNT"), szProductType) == 0)
          return RTN_WORKSTATION;
       if(lstrcmpi(TEXT("SERVERNT"), szProductType) == 0)
          return RTN_SERVER;
       if(lstrcmpi(TEXT("LANMANNT"), szProductType) == 0) return RTN_NTAS;

       // else return Unknown
       return RTN_UNKNOWN;
   }
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : BseMisc BseRegistry kbcode kbprg kbcode kbhowto kbprg<BR>
Version             : 3.51 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
