

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: GP Fault in DDEML from XTYP_EXECUTE Timeout Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83999 ">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1992/04/27">
<META NAME="Keywords" CONTENT="kbui kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  A general protection (GP) fault occurs in DDEML When the following occurs:  1. A DDEML (Dynamic Data Exchange Server Library) server    application requires more time to process a XTYP_EXECUTE    transaction than the timeout value specified by a DD...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QARL,QAJH,QAKD,QDL9,QBWO,QBWN,QBBI,QAGI,QBXJ,QAJZ,QBV8,QAY5,QAB9,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: GP Fault in DDEML from XTYP_EXECUTE Timeout Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83999 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A general protection (GP) fault occurs in DDEML When the following occurs:

<OL><P><LI>A DDEML (Dynamic Data Exchange Server Library) server
   application requires more time to process a XTYP_EXECUTE
   transaction than the timeout value specified by a DDEML client
   application

<P><LI>The server application creates windows as part of its processing

<P><LI>The client application abandons the transaction because the
   transaction timed out
<P>
</OL><h2>CAUSE</h2>
 
<P>
The server application receives a window handle with the same value
as the hidden window created to control the transaction.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Specify a timeout value in the client application longer than the
time required by the server application to complete the task.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use DDEML, an application (either a client or a server) registers a
callback function with the library. The DDEML calls the callback
function for any DDE activity. A DDE transaction is similar to a
message; it contains a named constant, accompanied by other
parameters.
<P>
A client application issues a XTYP_EXECUTE transaction to instruct the
server application to execute a command. When a client calls the
DdeClientTransaction function to issue a transaction, it can specify a
timeout value, which is the amount of time (in seconds) the client is
willing to wait while the server processes the transaction. If the
server fails to execute the command within the specified timeout
value, the DDEML sends a message to the client that the transaction
timed out. Upon receipt of this message, the client can inform the
user, reissue the command, abandon the transaction, or take other
appropriate actions.
<P>
If a client application specifies a short timeout period (one second,
for example) and the server requires fifteen seconds to execute a
command, the client will receive notification that the transaction
timed out. If the client terminates the transaction, which is an
appropriate action, the DDEML will GP fault.
<P>
When the client sends an XTYP_EXECUTE transaction, the DDEML creates a
hidden window for the conversation. If the client calls the
DdeAbandonTransaction function to terminate the transaction, the DDEML
destroys the associated hidden window.
<P>
At the same time, the server application processes the execute
transaction, which might involve creating one or more windows. If the
server creates a window immediately after the DDEML destroys a window,
the server receives a window handle with the same value as that of the
destroyed window. After the server completes processing the execute
transaction, it returns control to the DDEML.
<P>
Normally, the DDEML determines that the callback function is returning
to a conversation that has been terminated. It calls the IsWindow
function with the window handle for the transaction's hidden window to
ensure that the handle remains valid.
<P>
Because the window handle has been allocated to the server
application, the IsWindow test succeeds. However, this handle no
longer corresponds to the transaction's hidden window. Therefore, when
the DDEML attempts to retrieve the pointer kept in the hidden window's
window extra bytes, the pointer is not available. When the DDEML uses
the contents of this memory, a GP fault is likely to result.
<P>
The current way to work around this problem is to specify a timeout
value in the client application that is longer than the time required
by the server to complete its processing.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 3.51 4.00 95<BR>
KBCategory: kbui kbprb<BR>
KBSubcategory: UsrDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
