

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Keep an MDI Window Always on Top </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108315">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1993/12/08">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When creating a multiple document interface (MDI) window, there are no styles available to have the new window stay on top of the other MDI windows. Alternatively, two methods are available to achieve this functionality:   - Process the WM_WINDOWPO...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QDL9,QBWO,QBWN,QAUD,QAYC,QAGX,QAJZ,QAI4,QBWQ,QAGQ,QAHE,QBXS,QAPN,QAKR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Keep an MDI Window Always on Top</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108315</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When creating a multiple document interface (MDI) window, there are no
styles available to have the new window stay on top of the other MDI
windows. Alternatively, two methods are available to achieve this
functionality:

<UL><LI>Process the WM_WINDOWPOSCHANGED message and call SetWindowPos() to
   change the Z-order of the window.

<LI>Install a timer for the MDI windows and reset the Z-order of the window
   when processing the WM_TIMER message.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
MDICREATESTRUCT has the field "style", which can be set with the styles for
the new MDI window. Extended styles, such as WS_EX_TOPMOST, are not
available in MDI windows. This field of MDICREATESTRUCT is passed to
CreateWindowEx() in the dwStyle parameter. The dwExStyle field is set to
0L. The two methods shown below cannot be used at the same time in the same
application.
<P>
Method 1: Process the WM_WINDOWPOSCHANGED message and call SetWindowPos()
to change the Z-order of the window.
<P>
<P><h3>Sample Code</h3>
 
<P>
LRESULT CALLBACK MdiWndProc (HWND hWnd, UINT message, WPARAM wParam,
<PRE>                    LPARAM lParam)
{
    static HWND hWndAlwaysOnTop = 0;
    switch (message)
     {
     case WM_CREATE :
         if (!hWndAlwaysOnTop)
          {
          SetWindowText (hWnd, "Always On Top Window");
          hWndAlwaysOnTop = hWnd;
          }
            break;
     case WM_WINDOWPOSCHANGED :
         if (hWndAlwaysOnTop)
          {
          WINDOWPOS FAR* pWP = (WINDOWPOS FAR*)lParam;
          if (pWP-&gt;hwnd != hWndAlwaysOnTop)
              SetWindowPos (hWndAlwaysOnTop, HWND_TOP, 0, 0, 0, 0,
                      SWP_NOACTIVATE | SWP_NOMOVE | SWP_NOSIZE);
          }
         break;
     //
     // Other Messages to process here.
     //
     case WM_CLOSE :
         if (hWndAlwaysOnTop == hWnd)
          hWndAlwaysOnTop = NULL;
     default :
         return DefMDIChildProc (hWnd, message, wParam, lParam);
     }
    return 0L;
</PRE>}
<P>
Method 2: Install a timer for the MDI windows and reset the Z-order of
the window when processing the WM_TIMER message.
<P>
<P><h3>Sample Code</h3>
 
<P>
LRESULT CALLBACK MdiWndProc (HWND hWnd, UINT message, WPARAM wParam,
<PRE>                    LPARAM lParam)
{
    static HWND hWndAlwaysOnTop = 0;
    switch (message)
     {
     case WM_CREATE :
         SetTimer (hWnd, 1, 200, NULL);
         if (!hWndAlwaysOnTop)
          {
          SetWindowText (hWnd, "Always On Top Window");
          hWndAlwaysOnTop = hWnd;
          }
            break;
     case WM_TIMER :
         if (hWndAlwaysOnTop)
          {
          SetWindowPos (hWndAlwaysOnTop, HWND_TOP, 0, 0, 0, 0,
                     SWP_NOACTIVATE | SWP_NOMOVE | SWP_NOSIZE);
          }
         break;
     case WM_DESTROY:
         KillTimer (hWnd, 1) ;
         break;
     //
     // Other Messages to process here.
     //
     case WM_CLOSE :
         if (hWndAlwaysOnTop == hWnd)
          hWndAlwaysOnTop = NULL;
     default :
         return DefMDIChildProc (hWnd, message, wParam, lParam);
     }
    return 0L;
</PRE>}
<P>
For additional information on changing the Z-order of child pop-up windows,
please see the following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q66943.htm">Q66943</A></B>
   TITLE     : Determining the Topmost Pop-Up Window
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 3.51 4.00 95<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrWndw<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
