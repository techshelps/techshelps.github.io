

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Block Size Must Be Set Before Doing Tape I/O </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165274">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1997/03/14">
<META NAME="Keywords" CONTENT="BseFileio BseTape">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  After you boot the system, Tape I/O functions fail and GetLastError returns 87L (ERROR_INVALID_PARAMETER). The same code begins to work after you run NTBackup or another tape backup program.  CAUSE =====  This behavior is by design. When you start ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHC,QBXS,QAY5,QAH4,QAA8,QBWP,QAHT,QAYS,QAGI,QBAO,QA3R,QAYY,QAXC,QABA,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Block Size Must Be Set Before Doing Tape I/O</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165274</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows NT versions 3.51, 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you boot the system, Tape I/O functions fail and GetLastError returns
87L (ERROR_INVALID_PARAMETER). The same code begins to work after you run
NTBackup or another tape backup program.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is by design. When you start the system, the tape drivers are
not initialized with a value for the tape media block size. Until the
system is properly initialized with this information, all tape I/O fails as
described above.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Once the tape block size is either retrieved or set, then the system allows
tape I/O operations to proceed normally. Please note that other conditions
may still cause I/O operations to fail.
<P>
To avoid this problem, call the SetTapeParameters function to set the MEDIA
information or call the GetTapeParameters function to get the MEDIA
information. These operations cause the block size to be communicated to
the parts of the system that require it.
<P>
A well-written program should always set or get the tape block size before
issuing tape I/O operations. Programs doing this during initialization will
never see the error described above. Getting or setting the tape block size
is recommended because this allows a program to allocate I/O buffers with
sizes that are multiples of the block size. I/O operations with a buffer
size not a multiple of the tape block size will fail as described above.
<P>
In Windows NT 3.51, if GetTapeParameters is used to get DRIVE information,
the tape block size is propagated to the other parts of the system. Other
Windows NT versions require that the MEDIA information be set or retrieved
in order to propagate the block size to the other parts of the system.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This setting is system-wide. Programs may operate successfully without
explicitly getting or setting the tape block size if some other program
(for example, NTBackup) retrieves or sets the block size first.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: KbBse Backup<BR>
Keywords          : BseFileio BseTape<BR>
Version           : WINDOWS NT:3.51,4.0;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
