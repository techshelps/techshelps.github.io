

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: EM_POSFROMCHAR &amp; EM_CHARFROMPOS Documented Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137805">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1995/10/05">
<META NAME="Keywords" CONTENT="UsrMisc kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Win32 SDK documentation for EM_POSFROMCHAR and EM_CHARFROMPOS is not correct when you use it with the RichEdit control version 1.x (Riched32.dll) and version 2.x (Riched20.dll). The two versions of the RichEdit control handle these messages dif...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QABK,QA7O,QAMN,QAB5,QBC9,QBC8,QA28,QATJ,QANO,QAUD,QAOE,QAKD,QBNK,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: EM_POSFROMCHAR &amp; EM_CHARFROMPOS Documented Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137805</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) versions 3.51, 4.0
<LI>Microsoft Win32s version 1.3
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Win32 SDK documentation for EM_POSFROMCHAR and EM_CHARFROMPOS is not
correct when you use it with the RichEdit control version 1.x
(Riched32.dll) and version 2.x (Riched20.dll). The two versions of the
RichEdit control handle these messages differently than the standard edit
control, and even from each other. The following information explains the
differences between the control's messages in each version.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The definitions for EM_POSFROMCHAR and EM_CHARFROMPOS should be documented
as follows:
<P>
<P><h3>EM_POSFROMCHAR</h3>
 
<P>
<PRE>   //For standard edit control.
   wParam = (WPARAM) wCharIndex; // Zero-based index of character.
   lParam = 0; // not used
   
   //For RichEdit control version 1.x.
   wParam = (WPARAM)pPoint;       // Address of POINT structure.
   lParam = (LPARAM)wCharIndex;   // Zero-based index of character.
   
   //For RichEdit control version 2.
   wParam = (WPARAM) wCharIndex; // Zero-based index of character.
   lParam = 0; // Not used.

</PRE>An application sends the EM_POSFROMCHAR message to retrieve the coordinates
of the specified character in an edit control.
<P>
Parameters:
<P>
pPoint - Value of wParam. Specifies a pointer to a POINT structure that
will receive the coordinates.
<P>
wCharIndex - Value of lParam. Specifies the zero-based index of the
character.
<P>
Return Value - For the standard edit control, the return value is the
position of the character. The horizontal coordinate is contained in the
LOWORD and the vertical coordinate is contained in the HIWORD. For a single-
line edit control, the y-coordinate is always zero.
<P>
For the RichEdit control version 1.x, the return value is not used.
<P>
For the RichEdit control version 2, the return value is the position of the
character. The horizontal coordinate is contained in the LOWORD and the
vertical coordinate is contained in the HIWORD.
<P>
Remarks:
<P>
For a single-line edit control, the y-coordinate is always zero. A returned
coordinate can be negative if the character has been scrolled outside the
control's client area. The coordinates are truncated to integer values and
are in screen units relative to the upper-left corner of the client area of
the control.
<P>
<P><h3>EM_CHARFROMPOS</h3>
 
<P>
<PRE>   //For standard edit control.
   wParam = 0; // Not used.
   lParam = (LPARAM)&amp;pPoints; // Pointer to a POINTS structure.
   
   //For RichEdit control version 1.x and 2.
   wParam = 0;                 // Not used.
   lParam = (LPARAM)&amp;pPoint;   // Address of a POINT structure.

</PRE>An application sends an EM_CHARFROMPOS message to retrieve the zero-based
character index and zero-based line index of the character nearest the
specified point in an edit control.
<P>
Parameters:
<P>
pPoints - Value of lParam. Specifies a pointer to a POINTS structure that
contains the coordinates for the character position wanted. The coordinates
are in screen units relative to the upper-left corner of the client area of
the control.
<P>
pPoint - Value of lParam. Specifies a pointer to a POINT structure that
contains the coordinates for the character position wanted. The coordinates
are in screen units relative to the upper-left corner of the client area of
the control.
<P>
Return Value - The return value specifies the character index.
 
Keywords          : UsrMisc kbdocerr</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
