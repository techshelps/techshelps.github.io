

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Obtain the Video for Windows Version </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140067">
<META NAME="KBModify" CONTENT="1996/08/05">
<META NAME="KBCreate" CONTENT="1995/11/21">
<META NAME="Keywords" CONTENT="kbmm kbprg kbdocerr kbhowto kbwebcontent">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  This article explains how to obtain the version number for Video for Windows.  MORE INFORMATION  Using the GetVersionEx() Function  Video for Windows has been incorporated into Windows 95 and Windows NT version 3.51. Therefore, 32-bit applications ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAYS,QBWQ,QAY5,QDK0,QBV8,QAB9,QABI,QAC1,QBWP,QAA1,QDIR,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Obtain the Video for Windows Version</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140067</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Video for Windows Development Kit version 1.1
<LI>Microsoft Windows Software Development Kit (SDK) version 3.1
<LI>Microsoft Win32 Software Development Kit (SDK) versions 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to obtain the version number for Video for
Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using the GetVersionEx() Function</h3>
 
<P>
Video for Windows has been incorporated into Windows 95 and Windows NT
version 3.51. Therefore, 32-bit applications should call the GetVersionEx()
function to determine the version of the operating system and consequently
the version of the multimedia system that is installed. GetVersionEx()
returns extended information about the version of the operating system that
is currently running.
<P>
<P><h3>Using the VideoForWindowsVersion() Function</h3>
 
<P>
16-bit applications (for example, those compiled with Visual C++ version
1.5x) should call the VideoForWindowsVersion() function to determine the
version of Video for Windows that is installed. The
VideoForWindowsVersion() function is not documented in the Video for
Windows Development Kit. However, many of the samples from the kit use this
function, and it is defined in the multimedia header files. The function is
exported by Msvideo.dll, which is usually located in the Windows\System
directory.
<P>
This function may be used to retrieve the major and minor versions of the
currently installed Video for Windows system under Windows 3.x. For
example, the following code fragment verifies that Video for Windows
version 1.1 or higher is currently running:
<P>
WORD   wVer;
<P>
<PRE>// First make sure you are running version 1.1 or later
</PRE>wVer = HIWORD(VideoForWindowsVersion());
if (wVer &lt; 0x010a)
{
<PRE>   // oops, too old
   MessageBox(NULL, "Video for Windows version is too old",
              "Error", MB_OK | MB_ICONSTOP);
   return FALSE;
</PRE>}
<P>
NOTE: As stated in the Win32 SDK, this function is obsolete in Windows
NT and Windows 95. The GetVersion() or GetVersionEx() functions should
be used on these platforms rather than VideoForWindowsVersion().
<P>
Here is an excerpt from the Win32 SDK "Multimedia, Introduction,
Multimedia Possibilities, Version Checking" documentation:
<P>
<PRE>   You may need to check the installed version of the multimedia
   system, particularly if your application takes advantage of
   features that were not available in previous releases. Although
   the multimedia header files contain two version-checking functions,
   they are obsolete. These obsolete functions are mmsystemGetVersion
   and VideoForWindowsVersion. Your application should rely on the
   standard Windows functions, GetVersion or GetVersionEx, instead.

</PRE><h3>Using the MCI String</h3>
 
<P>
The Multimedia Control Interface (MCI) string "info avivideo version"
should not be used to determine the installed version of Video for Windows.
This string is only meant to be displayed; it is not meant to be used for
version comparison. It will become obsolete in the future.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: win16sdk 1.10 3.10 4.00<BR>
KBCategory: kbmm kbprg kbdocerr kbhowto kbwebcontent<BR>
KBSubcategory: MMVideo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
