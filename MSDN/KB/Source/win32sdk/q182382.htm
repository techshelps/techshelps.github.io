

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Password Protecting Screen Savers without ScrnSave.lib </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182382">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1998/03/12">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The ScrnSave.lib static library provides the  standard  Windows 95 Screen Saver password, not Windows itself. The  standard  Windows 95 Screen Saver password is not available to Screen Savers that are not written to use ScrnSave.lib. Screen Savers ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWK,QAA8,QDL9,QBWO,QBWN,QBWQ,QBVV,QBSO,QAFR,QBWP,QA01,QAKR,QAH6,QAHE,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Password Protecting Screen Savers without ScrnSave.lib</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182382</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK)
<LI>Microsoft Windows NT versions 3.50, 3.51, 4.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ScrnSave.lib static library provides the "standard" Windows 95 Screen
Saver password, not Windows itself. The "standard" Windows 95 Screen Saver
password is not available to Screen Savers that are not written to use
ScrnSave.lib. Screen Savers that are not written to use ScrnSave.lib need
to implement independent password authentication, encryption, and storage.
<P>
Windows NT ignores the password handling within the Screen Saver and uses
the user's system password.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ScrnSave.lib library provides password protection for Screen Savers
that use it. Windows 95 Screen Savers that are not written with
ScrnSave.lib need to provide independent password handling. To do this,
Screen Savers need to provide a Password Change dialog box.
<P>
The Password Change dialog box is displayed when the Screen Saver is
started with a "/a &lt;HWND&gt;" argument, where &lt;HWND&gt; is an unsigned decimal
number representing the HWND of the owner window of the password dialog
box. If no HWND is passed in the Password Change dialog box, the foreground
window should own the Password Change dialog box.
<P>
When the Screen Saver runs it should check the HKEY_CURRENT_USER/
REGSTR_PATH_SCREENSAVE/REGSTR_VALUE_USESCRPASSWORD (REGSTR_PATH_SCREENSAVE
and REGSTR_VALUE_USESCRPASSWORD can be found in regstr.h) registry key if
it needs to use the Screen Saver's password protection. If the Screen Saver
does need to use its password protection, it needs to prevent the user from
switching to other applications without giving the password. To do this the
Screen Saver needs to call:
<P>
<PRE>   int prev;

   SystemParametersInfo(SPI_SCREENSAVERRUNNING,TRUE,&amp;prev,0);

</PRE>This prevents the user from using ALT+TAB to switch to another application
or CTRL+ALT+DELETE to kill the Screen Saver.
<P>
When the user hits a key or moves the mouse, the Screen Saver confirms the
password. If the password is validated, the Screen Saver calls the
following to re-enable task switching:
<P>
<PRE>   int prev;

   SystemParametersInfo(SPI_SCREENSAVERRUNNING,FALSE,&amp;prev,0);
</PRE> 
<PRE>Version           : WIN95;WINNT:3.50,3.51,4.0
Platform          : Win95 winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
