

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Setting Tab Stops in a Windows List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q66652 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1990/11/01">
<META NAME="Keywords" CONTENT="kbui kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Tab stops can be used in a list box to align columns of information. This article describes how to set tab stops in a list box and provides a code example that demonstrates the process.  MORE INFORMATION  To set tab stops in a list box, perform the...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAGB,QARP,QDL9,QBWO,QBWN,QACI,QABA,QBXS,QA01,QAJP,QA2O,QAPF,QADF,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Setting Tab Stops in a Windows List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q66652 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.0 and 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Tab stops can be used in a list box to align columns of information. This
article describes how to set tab stops in a list box and provides a code
example that demonstrates the process.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To set tab stops in a list box, perform the following three steps:

<OL><P><LI>Specify the LBS_USETABSTOPS style when creating the list box.

<P><LI>Assign the desired tab stops to an integer array.
<P>
   a. The tab stop values must be in increasing order -- back tab
<P><PRE>      stops are not allowed. The tabs work the same as typewriter
      tabs: once a tab stop is overrun, a tab character will move
      the cursor to the next tab stop. If the tab stop list is
      overrun (that is, the current position is greater than the last
      tab stop value), the default tab of eight characters is used.
</PRE><P>
   b. The tab stops should be specified in dialog units. On the
<P><PRE>      average, each character is about four horizontal dialog units in
      width.
</PRE><P>
   c. It is possible to hide columns of text from the user by
<P><PRE>      specifying tab stops beyond the right side of the list box. This
      can be a useful way to hide information used for the
      application's internal processing.
</PRE>
<P><LI>Send an LB_SETTABSTOPS message to the list box to set the tab
   stops. For example, in Windows 3.1:
<P>
<P><PRE>      SendMessage(GetDlgItem(hDlg, IDD_LISTBOX),
<PRE></PRE>                  LB_SETTABSTOPS,
                  TOTAL_TABS,
                  (LONG)(LPSTR)TabStopList);

   a. If wParam is set to 0 (zero) and lParam to NULL, the tab stops are
      set to two dialog units by default.

   b. SendMessage() will return TRUE if all of the tab stops are set
      successfully; otherwise, SendMessage() returns FALSE.

</PRE></OL><h3>Example</h3>
 
<P>
Below is an example of the process. Tab stops are set at character
positions 16, 32, 58, and 84.
<P>
<PRE>   int     TabStopList[TOTAL_TABS]; /*  Array to store tabs */

   TabStopList[0] = 16 * 4;          /* 16 spaces */
   TabStopList[1] = 32 * 4;          /* 32 spaces */
   TabStopList[2] = 58 * 4;          /* 58 spaces */
   TabStopList[3] = 84 * 4;          /* 84 spaces */

   SendMessage(GetDlgItem(hDlg, IDD_LISTBOX),
               LB_SETTABSTOPS,
               TOTAL_TABS,
               (LONG)(LPSTR)TabStopList);

</PRE>NOTE: For Win32, use LPARAM instead of LONG.
<P>
If the desired unit of measure is character position, then specifying
tab positions in dialog units is recommended. Dialog units are
independent of the current font; they are loosely based on the average
width of the system font. Each character takes approximately four
dialog units.
<P>
NOTE: Under Windows 95, dialog base units for dialogs based on non-system
fonts are calculated in a different way than under Windows 3.1. For more
information, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q125681.htm">Q125681</A></B>
   TITLE     : How to Calculate Dialog Base Units with Non-system-based
               Font

</PRE>For more control over the exact placement of a tab stop, the desired
position should be converted to a pixel offset and this offset should
be converted into dialog units. The following formula will take a
pixel position and convert it into the first tab stop position before
(or at) the desired pixel position:
<P>
<PRE>   TabStopList[n] = 4 * DesiredPixelPosition /
                     LOWORD(GetDialogBaseUnits());

</PRE>There is a sample application named TABSTOPS in the Microsoft Software
Library that demonstrates how tab stops are set and used in a list
box.
<P>
Download TABSTOPS.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/TABSTOPS.EXE">TABSTOPS.EXE</A> <I>(size: 22641 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/TABSTOPS.EXE">TABSTOPS.EXE</A> <I>(size: 22641 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 4.00 softlib<BR>
KBCategory: kbui kbfile<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
