

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: FindExecutable() Truncates Result at First Space in LFN </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140724">
<META NAME="KBModify" CONTENT="1995/12/11">
<META NAME="KBCreate" CONTENT="1995/12/06">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The FindExecutable function is supposed to retrieve the fully qualified path to the executable (.exe) file associated with the specified file name. For example, the following call to FindExecutable() should return the path to Winword.exe:     FindE...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAUD,QAFI,QATX,QBFY,QAH4,QAUJ,QAJH,QAY5,QBW5,QALW,QATO,QAPF,QAGI,QDO7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: FindExecutable() Truncates Result at First Space in LFN</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140724</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface included with:
<P>
<P><PRE>    - Microsoft Windows 95
    - Microsoft Windows NT versions 3.1, 3.5, 3.51
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The FindExecutable function is supposed to retrieve the fully qualified
path to the executable (.exe) file associated with the specified file name.
For example, the following call to FindExecutable() should return the path
to Winword.exe:
<P>
<PRE>   FindExecutable ("C:\\README.DOC", NULL, szBuffer);

</PRE>Assuming Winword.exe is currently in the C:\Msoffice\Winword directory, the
function, upon return, should fill szBuffer with the string
C:\Msoffice\Winword\Winword.Exe.
<P>
However, when you use FindExecutable() on a file whose associated
application is in a directory that has a long file name (LFN) that includes
a space, the function truncates the string up at the first space. Going
back to the previous code example, if Winword.exe is located in the
C:\Program Files\My Accessories directory, the function incorrectly returns
the truncated string C:\Program instead of the following expected string:
<P>
<PRE>   C:\Program Files\My Accessories\Winword.Exe

</PRE><h2>CAUSE</h2>
 
<P>
File associations are stored in the registry under HKEY_CLASS_ROOT, where
the executable name is actually stored under the key
<P>
<PRE>   HKEY_CLASSES_ROOT\&lt;file Type&gt;\shell\open\command = &lt;Name of Executable&gt;

</PRE>By design, long file names stored in the registry should be enclosed in
quotation marks. Otherwise, the system is made to treat the rest of the
characters following the space as arguments.
<P>
In the example, the path to WinWord.Exe should be stored in the registry
as:
<P>
<PRE>   HKEY_CLASSES_ROOT\Word.Document.6\shell\open\command =
    "C:\Program Files\My Accessories\Winword.Exe" /n

</PRE>which does causes FindExecutable to return the expected string.
<P>
Note that this problem does not occur when the short path name is stored in
the registry, instead of the long file name. Again, taking the same example
to WinWord.exe, this should not be a problem if the short path name
"C:\Progra~1\MYACCE~1\WINWORD.EXE" is stored in the registry instead of the
LFN version.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In some situations, applications do not have control over what gets stored
in the registry. It may be the associated application's setup program that
wrote the incorrect LFN string (without quotation marks) to the registry.
Any application that would then call FindExecutable() on this associated
application will run into this problem.
<P>
One workaround to this problem might be to parse the string returned and
replace the \0 character with a space. Stepping through a debugger, after
FindExecutable() returns, you will quickly find that although the space has
been replaced with the NULL character (\0), the rest of the string is left
intact, so simply reverting the \0 character back to a space gives the
expected string.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 3.10 3.50 invalid wrong<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: UsrShell<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
