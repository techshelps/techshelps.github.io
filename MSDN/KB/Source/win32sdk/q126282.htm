

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: DeviceIoControl Requires OVERLAPPED Struct w/ Async. </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126282">
<META NAME="KBModify" CONTENT="1995/09/25">
<META NAME="KBCreate" CONTENT="1995/02/19">
<META NAME="Keywords" CONTENT="kbprg kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT=" The documentation for DeviceIoControl is incomplete. It should warn you that unexpected behavior may occur when both the following are true:   - A DeviceIoControl request is followed by another DeviceIoControl request    on the same handle.   - Ther...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBB0,QBBI,QAO4,QAU9,QADP,QDL9,QBWO,QBWN,QBVV,QAY5,QAUD,QAPN,QAIC,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: DeviceIoControl Requires OVERLAPPED Struct w/ Async.</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126282</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
The documentation for DeviceIoControl is incomplete. It should warn you
that unexpected behavior may occur when both the following are true:

<UL><LI>A DeviceIoControl request is followed by another DeviceIoControl request
   on the same handle.

<LI>There was no OVERLAPPED structure passed into DeviceIoControl after the
   handle to the device or file was opened with FILE_FLAG_OVERLAPPED.
<P>
</UL>The following is a list of some of the unexpected behavior that may occur:

<UL><LI>Requests complete before expected.

<LI>There's undefined data in the returned buffers.

<LI>Unknown error codes are returned.

<LI>IRPs are held in a driver while the DeviceIoControl call has already
   returned.
<P>
</UL>When a handle is requested to a driver or file with FILE_FLAG_OVERLAPPED
specified, the executive prepares itself for all requests on that handle to
be asynchronous. Usually, when the request is sent down with an OVERLAPPED
structure, an event is placed in that OVERLAPPED structure. This event is
then stored in the FILE_OBJECT in kernel mode to use later to signal the
user-mode application when that IRP has been completed. If an event is not
specified, the value will be 0 in the FILE_OBJECT, when a second request is
sent down before the first request completes (and completes), the IO
manager will not have separate signals for the completion of the requests.
Therefore, the request will appear to be completed, while in reality the
IRP has not been completed by the underlying driver.
<P>
Please see the current documentation of GetOverlappedResult for more
information on the behavior of the executive when no OVERLAPPED structure
is specified when the handle to the driver or file was opened with
FILE_FLAG_OVERLAPPED.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 FILE_FLAG_OVERLAPPED DDK EVENT<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: BseFileio<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
