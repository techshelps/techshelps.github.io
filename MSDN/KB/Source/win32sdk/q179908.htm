

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Find the Edge of a Task Bar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179908">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1998/01/26">
<META NAME="Keywords" CONTENT="UsrShell kbcode">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When you use the SHAppBarMessage() function to retrieve information about a task bar, you do not receive a message that indicates where the AppBar position is relative to the edges of the screen. You use ABE_LEFT, ABE_RIGHT, ABE_TOP, and ABE_BOTTOM...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRR,QAUD,QAEV,QAGX,QBRT,QBVV,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Find the Edge of a Task Bar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179908</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use the SHAppBarMessage() function to retrieve information about a
task bar, you do not receive a message that indicates where the AppBar
position is relative to the edges of the screen. You use ABE_LEFT,
ABE_RIGHT, ABE_TOP, and ABE_BOTTOM to create the task bar, but you do not
get a message call that returns the edge position after the task bar is
created. This article shows how to find the edge of a task bar.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following function called GetEdge() uses the message ABM_GETTASKBARPOS
to get the bounding rectangle coordinates to determine where the task bar
appears.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   void CMainFrame::OnGetTaskbarPos()  // Message handler.
      {
         // Get a pointer to the Windows task manager.
      CWnd *pwnd = FindWindow("Shell_TrayWnd", NULL);

      if (pwnd != NULL)
      {
         APPBARDATA abd;

         abd.cbSize = sizeof(APPBARDATA);
         abd.hWnd = phwnd-&gt;m_hWnd;

         SHAppBarMessage(ABM_GETTASKBARPOS, &amp;abd);

         UINT uEdge = GetEdge(abd.rc);

         switch(uEdge)
         {
         case ABE_LEFT:
            break;
         case ABE_RIGHT:
            break;
         case ABE_TOP:
            break;
         case ABE_BOTTOM:
            break;
         default:
            AfxMessageBox("abd.uEdge not found");
                     return;
            }
         }
      }

      UINT CMainFrame::GetEdge(CRect rc)
      {
      UINT uEdge = -1;

      if (rc.top == rc.left &amp;&amp; rc.bottom &gt; rc.right)
      {
          uEdge = ABE_LEFT;
      }
      else if (rc.top == rc.left &amp;&amp; rc.bottom &lt; rc.right)
      {
          uEdge = ABE_TOP;
      }
      else if (rc.top &gt; rc.left )
      {
          uEdge = ABE_BOTTOM;
      }
      else
      {
          uEdge = ABE_RIGHT;
      }

         return uEdge;
      }
</PRE> 
<PRE>Keywords          : UsrShell kbcode
Version           : WINNT
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
