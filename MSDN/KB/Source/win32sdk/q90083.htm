

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Windows NT Servers in Locked Closets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90083 ">
<META NAME="KBModify" CONTENT="1997/04/11">
<META NAME="KBCreate" CONTENT="1992/10/08">
<META NAME="Keywords" CONTENT="BseMisc kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Some installations are required to restrict access to a server so that access to the server's keyboard/mouse is unavailable to most personnel. This type of server is referred to as a server in a locked closet.  The server administrators may provide...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAGU,QACK,QAIJ,QAH5,QAI5,QABT,QBWU,QANN,QAGR,QAJ6,QBW7,QDIV,QAVZ,QAM2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Windows NT Servers in Locked Closets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90083 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows NT versions 3.50, 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Some installations are required to restrict access to a server so that
access to the server's keyboard/mouse is unavailable to most personnel.
This type of server is referred to as a server in a locked closet.
<P>
The server administrators may provide an emergency reset button to end
users (for example, factory floor workers) in case the system locks up and
no administrators are present. In the case where an emergency reset button
cannot be provided, an administrator must come and physically unlock the
closet to reset the system. Remote administration is possible if the
machine in the locked closet is a node on a network.
<P>
Server software can be implemented as a Windows NT service so that it is
not necessary for a user to be interactively logged on to run the software.
For Windows NT in a locked closet, the service should be configured to
start automatically during boot.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows NT requires that the user press CTRL+ALT+DEL to log on. This
requirement implies that Windows NT doesn't lend itself well to the server
in a locked closet situation. A user must press CTRL+ALT+DEL and enter a
user ID and a password to log on and use the keyboard or mouse to interact
locally with a Windows NT machine. However, it is possible to configure the
machine as a server in a locked closet so that an administrator is not
required to unlock the door to start software or reset the system. The
administrator can configure the system so that services are started
automatically during boot. Once all the services are started, then the
system is fully functional and the administrator does not need to
intervene. If certain services fail to come up, but network service does
come up, then the system can be remotely administered.
<P>
Remote administration is possible, assuming that the required basic system
services are running. The machine must be on the network. The procedure
requires only Windows NT Workstation. In other words, Windows NT Server is
not an additional requirement.
<P>
Make sure that you have taken the following steps to start system services
automatically at system boot and to enable remote administration in case of
failure:

<OL><P><LI>Use the Service Control Manager to install any application code that
   must be started as soon as the Windows NT machine reboots.
<P>
   Write an application that installs the services and specifies that they
   should be started automatically. To find more information on the Win32
   APIs that support Services, search on "Services Overview" in the Win32
   SDK Programmer's Reference.
<P>
   Once this is done, the necessary application code can be made to start
   automatically upon system reboot, without anyone needing to press
   CTRL+ALT+DEL to log on or to take any other action using the server's
   local mouse/keyboard.

<P><LI>Make sure that the Workstation and Server services start automatically
   upon reboot.
<P>
   Use the Services application in Control Panel to ensure that both
   the Workstation and Server services start automatically upon
   reboot.
<P>
   This will permit an authorized person to remotely administer the system
   from another machine on the network. Thus, if something from step 1 goes
   wrong, the administrator still does not need to physically unlock the
   closet and log on. The administrator can log on to any machine on the
   network and use the tools on that machine to interact with the server.
<P>
</OL>For remote administration to be effective, the remote workstation must be
logged on to by either a domain user who has administrative privileges to
the Windows NT machine in the locked closet, or by a workgroup user who is
an administrator of the Windows NT machine in the locked closet.
<P>
When you configure Windows NT for use in a locked closet for a domain
network installation, use User Manager to add a user from the domain to the
Administrators Group for the machine. That domain user must log on to a
remote machine to administrate the machine in the locked closet.
<P>
When configuring Windows NT for use in a locked closet for a workgroup
installation, use User Manager on the remote workstation to create a user
with the same name and password as an administrator user of the machine in
the locked closet. The remote machine and the machine in the locked closed
must be in the same workgroup to allow remote administration.
<P>
Remote administration via dial-up telephone lines is available, but
requires RAS (Microsoft Remote Access Service). RAS permits a machine to
dial over telephone lines into a network, and to become a full participant
on the network. In this way, a system dialing in over RAS can be used to
remotely administer the system in the locked closet.
<P>
Note that while these steps allow servers locked in closets to be restored
without an administrator, it is still preferable to install a UPS
(uninterruptable power supply). Servers in locked closets usually need to
provide uninterrupted service to their clients, so a UPS is a better
solution. The capability to do remote administration serves as a backup in
case of failure.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : BseMisc kbprg<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
