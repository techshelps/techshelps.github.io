

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining Whether a WOW App is Running in Enhanced Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101893">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1993/07/26">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Windows NT and Windows NT Advanced Server will run a Windows 3.1 application in 386 enhanced mode on X86 machines (standard mode on RISC machines). The proper way to determine whether a Windows 3.1 application is in enhanced mode is to call GetWinF...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDL9,QBWQ,QBWN,QBWO,QA5W,QBWS,QABB,QAUD,QAGQ,QBXS,QDIO,QABA,QAJH,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Determining Whether a WOW App is Running in Enhanced Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101893</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) for Windows NT
   versions 3.1 and 3.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows NT and Windows NT Advanced Server will run a Windows 3.1
application in 386 enhanced mode on X86 machines (standard mode on RISC
machines). The proper way to determine whether a Windows 3.1 application is
in enhanced mode is to call GetWinFlags() and do a bit test for
WF_ENHANCED. This method is described on pages 486-487 in the Windows 3.1
Software Development Kit (SDK) "Programmer's Reference, Volume 2:
Functions."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Calling Interrupt 2F with AX=1600h</h3>
 
<P>
This method, which is described in the Windows 3.1 Device Development Kit
(DDK) checks to see whether a 386 memory manager is running. If Windows 3.1
is running in enhanced mode, it returns AL = 3 and 2 for standard mode.
Windows NT's WOW (Windows 16 on Windows NT) returns AL=0, which means
enhanced mode Windows is not running.
<P>
<P><h3>DWORD GetWinFlags()</h3>
 
<P>
The GetWinFlags() function retrieves the current Windows system and
memory configuration.
<P>
The configuration returned by GetWinFlags() can be a combination of the
following values:
<P>
<PRE>   Value          Meaning
   ----------------------------------------------------------------
   WF_80x87       System contains an Intel math coprocessor.
   WF_CPU286      System CPU is an 80286.
   WF_CPU386      System CPU is an 80386.
   WF_CPU486      System CPU is an i486.
   WF_ENHANCED    Windows is running in 386-enhanced mode. The WF_PMODE
                  flag is always set when WF_ENHANCED is set.
   WF_PAGING      Windows is running on a system with paged memory.
   WF_PMODE       Windows is running in protected mode. In Windows 3.1,
                  this flag is always set.
   WF_STANDARD    Windows is running in standard mode. The WF_PMODE
                  flag is always set when WF_STANDARD is set.
   WF_WIN286      Same as WF_STANDARD.
   WF_WIN386      Same as WF_ENHANCED.

</PRE>NOTE: When running in Windows NT, WF_WINNT will also be returned to tell
the 16-bit Windows-based application that you are running in Windows NT.
<P>
Example:
<P>
The following example uses the GetWinFlags() function to display
information about the current Windows system configuration:
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>int len;
char szBuf[80];
</PRE>DWORD dwFlags;
<P>
dwFlags = GetWinFlags();
<P>
len = sprintf(szBuf, "system %s a coprocessor",
<PRE>    (dwFlags &amp; WF_80x87) ? "contains" : "does not contain");
</PRE>TextOut(hdc, 10, 15, szBuf, len);
<P>
len = sprintf(szBuf, "processor is an %s",
<PRE>    (dwFlags &amp; WF_CPU286) ? "80286" :
    (dwFlags &amp; WF_CPU386) ? "80386" :
    (dwFlags &amp; WF_CPU486) ? "i486" : "unknown");
</PRE>TextOut(hdc, 10, 30, szBuf, len);
<P>
len = sprintf(szBuf, "running in %s mode",
<PRE>    (dwFlags &amp; WF_ENHANCED) ? "enhanced" : "standard");
</PRE>TextOut(hdc, 10, 45, szBuf, len);
<P>
len = sprintf(szBuf, "%s WLO",
<PRE>    (dwFlags &amp; WF_WLO) ? "using" : "not using");
</PRE>TextOut(hdc, 10, 60, szBuf, len);
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50<BR>
KBCategory: kbprg<BR>
KBSubcategory: SubSys<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
