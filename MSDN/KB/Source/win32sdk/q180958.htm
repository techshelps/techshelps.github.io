

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: How Clients Should Use SPI_SETSCREENREADER </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180958">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1998/02/12">
<META NAME="Keywords" CONTENT="BseRegistry">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Screen readers set the system-wide SPI_SETSCREENREADER flag when they initialize and clear it when they terminate. This flag is used by Accessibility-aware applications such as Internet Explorer (IE) and Word to control how the application interact...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAJH,QAEV,QBXS,QAIH,QAYC,QAY5,QAMB,QDL9,QBWO,QBWN,QBV9,QDL8,QATI,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: How Clients Should Use SPI_SETSCREENREADER</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180958</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Win32 Software Development Kit (SDK) on the following
<PRE>  platforms:
   - Microsoft Windows NT
   - Microsoft Windows 95
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Screen readers set the system-wide SPI_SETSCREENREADER flag when they
initialize and clear it when they terminate. This flag is used by
Accessibility-aware applications such as Internet Explorer (IE) and Word to
control how the application interacts with the system.
<P>
Because the SPI_SETSCREENREADER flag alters the behavior of these (and
other) applications, it must be modified carefully and must always be
followed by a WM_SETTINGCHANGE message. The WM_SETTINGCHANGE message
ensures that any active applications are given the opportunity to modify
behavior based upon the flag's new value.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you modify the SPI_SETSCREENREADER flag with a call to
SystemParametersInfo, you need to specify SPIF_SENDCHANGE in the last
parameter to broadcast a WM_SETTINGCHANGE message. Sending the
WM_SETTINGCHANGE message ensures that all active applications are notified
that the SPI_SETSCREENREADER flag has been set.
<P>
Similarly, when you write an application that depends on the value of the
SPI_SETSCREENREADER flag, be sure to handle the WM_SETTINGCHANGE message.
If your application receives this message, it should take the appropriate
action to preserve its proper operation.
<P>
For example, assume two different applications manipulate the
SPI_SCREENREADER flag as follows (without sending or handling the
WM_SETTINGCHANGE message):
<P>
<PRE>    *  Set SPI_SCREENREADER to TRUE when initializing.
    *  Set SPI_SCREENREADER to FALSE when terminating.

</PRE>If both applications begin executing, each application will set the flag to
TRUE. Then, when one of these applications terminates, the other
application will continue to execute under the incorrect assumption that
the SPI_SCREENREADER flag is still set.
<P>
To avoid this problem, an application that manipulates the SPI_SCREENREADER
flag should always use SPIF_SENDCHANGE to ensure other applications are
notified of the change. Furthermore, an application that is dependent on
this flag for proper operation should handle the WM_SETTINGCHANGE message
and react accordingly.
<P>
The following list contains two example of the type of runtime adjustments
that are made (by IE and Word) in response to changes in this system-wide
flag.
<P>
When the SPI_SETSCREENREADER flag is set:

<UL><LI>IE expands the bounding rectangle of graphic objects to allow the entire
   contents of the graphic objects' ALT text tags to be displayed. This
   allows screen readers to obtain the contents of an ALT text tag,
   regardless of the dimensions of the graphic it describes.

<LI>Word sends notifications of focus changes so that screen readers can
   keep the user informed of their current state and location.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
Microsoft Active Accessibility SDK
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SPIF_SENDCHANGE SPI_SCREENREADER MSAA<BR>
Keywords          : BseRegistry<BR>
Version           : WIN95;WINNT:4.0;<BR>
Platform          : Win95 winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
