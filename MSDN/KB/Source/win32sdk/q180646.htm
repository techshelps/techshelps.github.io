

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Display More Than 80 Characters in a Tooltip Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180646">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1998/02/06">
<META NAME="Keywords" CONTENT="UsrCtl">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  By default, the text displayed for an item in a tooltip control is limited to 80 characters. In some instances, you may want to have the tooltip display more than 80 characters.  MORE INFORMATION  To enable a tooltip control to display more than 80...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJQ,QAB5,QA7O,QAWT,QAOE,QAMN,QBQU,QATX,QAMB,QACJ,QDL9,QBWO,QBWN,QAWN,QAKE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Display More Than 80 Characters in a Tooltip Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180646</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) on the following
   platforms:
<P><PRE>    - Microsoft Windows NT
    - Microsoft Windows 95
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default, the text displayed for an item in a tooltip control is limited
to 80 characters. In some instances, you may want to have the tooltip
display more than 80 characters.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To enable a tooltip control to display more than 80 characters, you need to
specify that the text is available on a callback basis by setting the
lpszText member of the TOOLINFO structure to LPSTR_TEXTCALLBACK when the
tool is added to the tooltip control with the TTM_ADDTOOL message. When
this is done, the tooltip control sends the parent window a WM_NOTIFY
message with the TTN_NEEDTEXT notification code.
<P>
The TTN_NEEDTEXT notification's lParam is the address of a NMTTDISPINFO
structure. One member of this structure is the szText member. szText is a
character buffer that can hold up to 80 characters. Another member of this
structure is the lpszText member that is the address of a character buffer
that contains the text for the tool. By default, lpszText points to szText.
When processing the TTN_NEEDTEXT notification, you can either copy the
desired text to szText or change lpszText so that it points to a buffer
other than szText. To allow the tooltip control to display more than 80
characters for a tool, you must set lpszText to point to a buffer that you
allocate (and that contains the desired text).
<P>
After returning from the TTN_NEEDTEXT notification, the tooltip control
allocates a buffer and copies the text into this new buffer. As a result,
you can reuse the buffer for each TTN_NEEDTEXT notification. The buffer
that you use must be a static, global, or dynamically-allocated buffer as
long as it exists after returning from the notification. The buffer cannot
be created on the stack because it will not be valid after returning from
the message.
<P>
Add the TTS_NOPREFIX style to the tooltip control. You must do this because
the tooltip control will limit the text length to 80 characters again when
the control removes the "&amp;" characters.
 
<PRE>Keywords          : UsrCtl
Version           : WINNT:4.0; win95
Platform          : Win95 winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
