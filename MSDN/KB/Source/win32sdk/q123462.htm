

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: BUFFER.CREATE Command Not Documented </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123462">
<META NAME="KBModify" CONTENT="1995/09/29">
<META NAME="KBCreate" CONTENT="1994/12/01">
<META NAME="Keywords" CONTENT="kbnetwork kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  This article documents the BUFFER.CREATE command. This is a command that Microsoft added, so it is not documented in IBM LAN Technical Reference.  MORE INFORMATION  The AcsLan function topic in the Win32 Help file indicates that there are some diff...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACJ,QBWP,QBVV,QBWA,QABT,QBWE,QAY4,QAYV,QAVZ,QALO,QAH6,QBV8,QAB9,QANY,QAZA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: BUFFER.CREATE Command Not Documented</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123462</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK), version 3.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article documents the BUFFER.CREATE command. This is a command that
Microsoft added, so it is not documented in IBM LAN Technical Reference.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The AcsLan function topic in the Win32 Help file indicates that there are
some differences between Windows NT DLC and the CCB2 interface documented
in the IBM LAN Technical Reference. The most notable is that the buffer
pool must be specified on an open adapter instance basis, not per SAP.
After an adapter has been opened by using the DIR.OPEN.ADAPTER command, a
buffer pool must be given to the DLC driver by using BUFFER.CREATE.
<P>
The IBM LAN Technical Reference manual has no reference to BUFFER.CREATE.
However, the DLCAPI.H file contains the following structure with no other
information explaining how to use it:
<P>
typedef struct {
<PRE>    HANDLE hBufferPool;                // handle of new buffer pool
    PVOID pBuffer;                     // any buffer in memory
    ULONG cbBufferSize;                // buffer size in bytes
    ULONG cbMinimumSizeThreshold;      // minimum locked size
</PRE>} LLC_BUFFER_CREATE_PARMS, *PLLC_BUFFER_CREATE_PARMS;
<P>
Unlike DLC as described in IBM LAN Technical Reference, Windows NT DLC does
not support a buffer pool per SAP, but rather a buffer pool per process.
All buffers given to the application are allocated from the same pool. (You
can also allocate send buffers from the buffer pool, but this is not the
case in general.)
<P>
The application gives the buffer pool to DLC by using the BUFFER.CREATE
request. The parameters are:

<UL><LI>hBufferPool: the returned handle of the buffer pool. Supposedly, DLC can
   share buffer pools between processes but it doesn't, so it's useless.

<LI>pBuffer: the pointer to application allocated buffer pool. This can be
   allocated by any scheme you wish and can be any size.

<LI>cbBufferSize: the size of pBuffer.

<LI>cbMinimumSizeThreshold: the minimum locked size.
<P>
</UL>Because the buffer is passed on kernel mode, it must be mapped into system
space. It is divided into pages and further subdivided into 256-byte
segments (unknown to the application). DLC tries to return as many
contiguous segments as it can, but you may end up with a fragmented buffer,
containing a relatively long chain of small segments. To your advantage,
the largest DLC receive frame is usually around 4K.
<P>
DLC aligns the buffer to a page boundary, discarding any partial page
buffer after the last page. This is not a problem unless you allocate a
buffer less than a page, or one that is not page-aligned. In these cases,
you are in danger of not having a buffer.
<P>
Because the buffer must be mapped to system space, DLC needs to lock the
buffers into memory when receiving or sending from the buffers. To increase
performance, DLC tries to keep a certain amount of buffer locked at all
times. It will lock successive pages as the need arises. (In Windows NT,
the smallest lockable region is a page.) You can control the initial locked
area by setting the cbMinimumSizeThreshold value. If DLC does indeed lock
your pages in excess of cbMinimumSizeThreshold, it will try to unlock them
as they are freed up.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50<BR>
KBCategory: kbnetwork kbdocerr<BR>
KBSubcategory: NtwkMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
