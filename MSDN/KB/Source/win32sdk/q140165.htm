

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use NetUserAdd </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140165">
<META NAME="KBModify" CONTENT="1996/10/21">
<META NAME="KBCreate" CONTENT="1995/11/22">
<META NAME="Keywords" CONTENT="kbnetwork kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  NetUserAdd allows a Windows NT application to add a user to a Windows NT workstation or server programmatically. Adding a user with this function seems easy enough, but there are a few issues that are not obvious.  MORE INFORMATION  If you would li...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QBWP,QATX,QBWD,QBG2,QAMB,QAH5,QABI,QBVV,QAVZ,QAUJ,QDMW,QBWU,QBWE,QA7M V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use NetUserAdd</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140165</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) versions 3.1, 3.5,
   3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
NetUserAdd allows a Windows NT application to add a user to a Windows NT
workstation or server programmatically. Adding a user with this function
seems easy enough, but there are a few issues that are not obvious.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you would like to add users to a Windows NT workstation or server in
your application, you must use NetUserAdd. Given a server name, level, and
appropriate structure, a new user will be created. The following pointers
may help you avoid problems:

<OL><P><LI>As required of all Net* functions, submit all strings in UNICODE (wide
   characters). Use MultiByteToWideChar to convert standard ASCII strings
   into UNICODE strings. Don't forget to include the terminating NULL in
   string conversions.

<P><LI>Specify the server name as \\server. Be sure to include double
   backslashes, four backslashes if inside a C literal string.

<P><LI>Use the UF_SCRIPT required flag. Without it, you will get
   ERROR_INVALID_PARAMETER.

<P><LI>When using level 2, make sure your strings do not exceed the maximum
   lengths. Constants are defined for the maximum lengths. For example, the
   maximum lengths for params, comment, user comment, and full name is
   MAXCOMMENTSZ. Paths must fit within PATHLEN characters. UNC names for
   servers must fit in UNCLEN characters.

<P><LI>Use NetUserAdd only to add user accounts, not guest or administrator
   accounts. After the account is established, use NetUserSetGroups to add
   Administrator, Guest, or other groups to the new user account.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft LAN Manager, A Programmer's Guide by Ralph Ryan.
Microsoft LAN Manager Programmer's Reference.
Win32 SDK Documentation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: NETUSERADD LANMAN 3.10 3.50 3.51 4.00<BR>
KBCategory: kbnetwork kbprg kbhowto<BR>
KBSubcategory: NtwkMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
