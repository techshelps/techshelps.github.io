

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Change the Work Offline Status of a Printer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160456">
<META NAME="KBModify" CONTENT="1996/12/09">
<META NAME="KBCreate" CONTENT="1996/12/04">
<META NAME="Keywords" CONTENT="kbprint kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Printers in Windows 95 can be set to a state called Work Offline in which print jobs are spooled and held. The print jobs are not despooled until Work Offline is deactivated. The Work Offline state is reflected by the Work Offline item in the Print...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBW2,QACT,QBXS,QALS,QAGI,QBWQ,QAY5,QAJX,QAEF,QADR,QAIC,QBJZ,QDL9,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Change the Work Offline Status of a Printer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160456</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) for Windows 95,
   version 4.00 on the following platform: Win95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Printers in Windows 95 can be set to a state called Work Offline in which
print jobs are spooled and held. The print jobs are not despooled until
Work Offline is deactivated. The Work Offline state is reflected by the
Work Offline item in the Printer's File menu that indicates the condition
with a check mark.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
While the Work Offline state is reflected by the condition of the
PRINTER_STATUS_USER_INTERVENTION bit in a PRINTER_INFO structure's Status
member, it is actually an attribute of the printer. As such, it is
indicated and controlled by the PRINTER_ATTRIBUTE_WORK_OFFLINE bit of a
PRINTER_INFO_2 structure's Attribute member. The Attribute member is a
bitfield of Attribute bits for that printer. See the Win32 SDK online
documents for a complete description of this structure member and its
values.
<P>
Note that the Work Offline state of a printer in Windows is distinctly
different from a printer being Off-line. The difference is that the
PRINTER_ATTRIBUTE_WORK_OFFLINE attribute applies to a Window's Print Queue
and effects how the queue behaves, while the Off-line status of a physical
printer device is set on the device. The Off-line status of a physical
printer can be determined from the Status members of either a PRINTER_INFO
or JOB_INFO structure. See the Printer and Print Job status article in the
REFERENCE section in this article for details.
<P>
Attribute information for a printer can be read and written by the
GetPrinter and SetPrinter API functions. To determine if a printer is
currently in the Work Offline state, perform a logical AND of the
predefined constant PRINTER_ATTRIBUTE_WORK_OFFLINE and the Attribute member
of a PRINTER_INFO_2 structure with the C language "&amp;" operator. To change
the Work Offline state of a printer, follow these steps:

<OL><P><LI>Retrieve a PRINTER_INFO_2 structure for the printer by calling the
   GetPrinter function multiple times.

<P><LI>Change the PRINTER_ATTRIBUTE_WORK_OFFLINE bit of a PRINTER_INFO_2
   structure's Attribute member. The following sample code illustrates how
   to clear or set a bit of this bitfield properly:
<P>
   if (pi2-&gt;Attributes &amp; PRINTER_ATTRIBUTE_WORK_OFFLINE)
   {
<PRE>       DWORD   dwStatusMask;

       /* set, so clear the bit */
       dwStatusMask = ~(DWORD)(PRINTER_ATTRIBUTE_WORK_OFFLINE);
       pi2-&gt;Attributes = pi2-&gt;Attributes &amp; dwStatusMask;
   }
   else
   {
       /* not set, so set it */
       pi2-&gt;Attributes = pi2-&gt;Attributes | PRINTER_ATTRIBUTE_WORK_OFFLINE;
   }

</PRE><P><LI>Call the SetPrinter function to set the state of the printer by passing
   the modified structure.
<P>
</OL>Note that the PRINTER_ATTRIBUTE_WORK_OFFLINE attribute is not supported for
printers in Windows NT.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on calling Win32 Spooler API functions, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q158828.htm">Q158828</A></B>
   TITLE     : How To Call Win32 Spooler Enumeration APIs Properly

   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q140285.htm">Q140285</A></B>
   TITLE     : How to Modify Printer Settings by Using SetPrinter

   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q160129.htm">Q160129</A></B>
   TITLE     : How To Get the Status of a Printer and a Print Job
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kbhowto<BR>
KBSubcategory: GdiPrn GdiSpool<BR>
Additional reference words: 4.00 KbDSI GdiSpool Printer Properties
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
