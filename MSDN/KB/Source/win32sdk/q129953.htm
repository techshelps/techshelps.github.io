

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: C2371 BSTR Redefinition When VFW.H Included in MFC App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129953">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The following error message occurs when compiling an application with Microsoft Visual C++, version 2.0 or 2.1, which uses the Microsoft Video for Windows header file, VFW.H, and the Microsoft Foundation Classes (MFC):     c:\msvc20\include\oleauto...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBMR,QDL9,QBWO,QBWN,QA9Q,QBWP,QBFY,QAJH,QBWQ,QA56,QA55,QAH4,QAP2,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: C2371 BSTR Redefinition When VFW.H Included in MFC App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129953</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 3.50
WINDOWS NT
kbmm kbprb kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK), version 3.5
<LI>Microsoft Visual C++, 32-bit Edition, versions 2.0 and 2.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error message occurs when compiling an application with
Microsoft Visual C++, version 2.0 or 2.1, which uses the Microsoft Video
for Windows header file, VFW.H, and the Microsoft Foundation Classes (MFC):
<P>
<PRE>   c:\msvc20\include\oleauto.h(214) : error C2371: 'BSTR' : redefinition;
   different basic types

</PRE>This error message does not occur when using Microsoft Visual C++ version
1.5 for Windows with the Microsoft Video for Windows 1.1 DK installed while
running under Microsoft Windows operating system
version 3.1.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If the application does not require binary string (BSTR) support you can
eliminate this error message by defining "_AFX_NO_BSTR_SUPPORT" before the
MFC include files. For example, place the code below at the beginning of
the STDAFX.H file:
<P>
<PRE>   #define _AFX_NO_BSTR_SUPPORT

</PRE>If the application does require BSTR support, then you can eliminate this
error message by including the code below before including the VFW.H file:
<P>
<PRE>   #define OLE2ANSI

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This error message occurs by design. MFC versions 3.0 and 3.1 require
either that "OLE2ANSI" is defined when including the object linking and
embedding (OLE) headers or that "_AFX_NO_BSTR_SUPPORT" is defined. You
cannot use both ANSI-BSTRs (which is the default) and Unicode-BSTRs; you
must use one or the other.
<P>
The AFX.H file defines the BSTR type in order to allow CStrings to support
BSTRs. The VFW.H file unconditionally includes the OLE2.H file, which
eventually includes the OLEAUTO.H file, which also defines the BSTR type.
"_AFX_NO_BSTR_SUPPORT" disables CString support for BSTRs.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Generate a default application with AppWizard.
</OL>2. Add the statement "#include vfw.h" to the end of the STDAFX.H file.
3. Compile the application.
<P>
The VFW.H file is included with the Microsoft Visual C++, 32-bit Edition,
and the Microsoft Win32 SDK for Windows NT.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 2.00 2.10 CString port porting VfWDK<BR>
KBCategory: kbmm kbprb kberrmsg<BR>
KBSubcategory: MMVIDEO<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
