

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOC: Errors in Win32s Compatibility </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155861">
<META NAME="KBModify" CONTENT="1997/01/11">
<META NAME="KBCreate" CONTENT="1996/09/10">
<META NAME="Keywords" CONTENT="kbref kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The following Win32 APIs are listed in the Win32 Programmer's Reference as being supported under Win32s. This is incorrect. These Win32 APIs are not supported under Win32s:   - mouse_event  - CreateDIBPatternBrushPt()  - GetBinaryType()  The follow...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVV,QAHE,QALQ,QAH7,QAAP,QAUD,QANZ,QAI4,QABN,QBFY,QAB4,QDMW,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: Errors in Win32s Compatibility</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155861</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32s version 1.30c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following Win32 APIs are listed in the Win32 Programmer's Reference as
being supported under Win32s. This is incorrect. These Win32 APIs are not
supported under Win32s:

<UL><LI>mouse_event
<LI>CreateDIBPatternBrushPt()
<LI>GetBinaryType()
<P>
</UL>The following Win32 APIs are not listed in the Win32 Programmer's Reference
as being supported under Win32s. This is incorrect. These Win32 APIs are
supported under Win32s:

<UL><LI>There are none identified yet for 1.30c.
<P>
</UL>In addition, all of the BS_ button styles are marked as not supported under
Win32s. However, Win32s supports all of the button styles that Windows 3.1
supports.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following Win32 APIs and CRT (C Run-time) routines are supported under
Win32s, with the restrictions noted.
<P>
<PRE>Function                        Associated Restriction
</PRE> 
<PRE>CreateFile                      FILE_FLAG_NO_BUFFERING,
                                FILE_FLAG_WRITE_THROUGH,
                                FILE_FLAG_OVERLAPPED,
                                FILE_DELETE_ON_CLOSE,
                                FILE_ATTRIBUTE_COMPRESSED,
                                FILE_FLAG_RANDOM_ACCESS,
                                FILE_FLAG_SEQUENTIAL_SCAN,
                                FILE_FLAG_BACKUP_SEMANTICS,
                                FILE_FLAG_POSIX_SEMANTICS
                                and all SECURITY_* flags are not supported.

                                FILE_FLAG_SEQUENTIAL_SCAN and
                                FILE_FLAG_RANDOM_ACCESS are only for
                                optimization purposes, so no functionality
                                limitation is related with these flags.

                                lpSecurityAttributes and hTemplateFile
                                parameters are ignored.

                                Passing dwShareMode=0 opens the file in
                                compatibility mode, not in exclusive mode.
</PRE> 
<PRE>CreateFileMapping               SEC_COMMIT is supported, but not
                                SEC_IMAGE, SEC_NOCACHE or SEC_RESERVE.

                                PAGE_WRITECOPY is not supported.

                                lpFileMappingAttributes parameter is
                                ignored.
                                The size of named shared memory is limited
                                by Windows memory.
</PRE> 
<PRE>CreateDIBitmap                  DIB_PAL_INDICES
CreateDIBPatternBrush           DIB_PAL_PHYSINDICES
GetDIBits                       DIB_PAL_LOGINDICES   are not supported.
</PRE>SetDIBits
SetDIBitsToDevice
StretchDIBits
 
<PRE>CreateHalftonePallette()        Is supported only in 1.30 and later.
</PRE> 
<PRE>CreatePolyPolygonRgn            The polygon must be closed.
</PRE> 
<PRE>ExtEscape()                     Ignores the cbOutput parameter.
</PRE> 
<PRE>GetDCOrgEx()                    Thunked to GetDCOrg().
                                Does not return any error codes
</PRE> 
GetDCOrg() - A Win16 API that is not supported by Win32s. This is because
of compatibility reasons.
 
<PRE>GdiFlush()                      Does nothing.
</PRE> 
<PRE>SetGraphicsMode()               Does nothing and fails unless GM_COMPATIBLE
                                is specified
</PRE> 
<PRE>SetGraphicsMode()               Always returns GM_COMPATIBLE.
</PRE> 
<PRE>CreateProcess                   Handle inheritance is not supported.
                                Only creation flags supported are
                                DEBUG_PROCESS and DEBUG_ONLY_THIS_PROCESS.
                                The only priority supported is
                                NORMAL_PRIORITY_CLASS. The security
                                attributes are ignored.
</PRE> 
<PRE>GetFileInformationByHandle      ftCreationTime, ftLastAccessTime,
                                dwVolumeSerialNumber, nFileIndexHigh, and
                                nFileIndexLow are all 0.
</PRE> 
<PRE>GetFileTime                     Only lpLastWriteTime is supported.
</PRE>SetFileTime
 
<PRE>GetPrivateProfileString         lpszSection parameter cannot be NULL.
</PRE>GetProfileString
 
<PRE>GetSystemMetrics                SM_CMOUSEBUTTONS is not supported.
</PRE> 
<PRE>GetSystemPaletteEntries         The fourth parameter cannot be NULL.
</PRE> 
<PRE>GetVolumeInformation            Volume ID is not supported.
</PRE> 
<PRE>OpenProcess                     Settings for fdwAccess and fInherit are
                                ignored. In the implementation,
                                fdwAccess=PROCESS_ALL_ACCESS and
                                fInherit=TRUE.
</PRE> 
<PRE>PeekMessage                     hWnd cannot be -1.
</PRE> 
<PRE>PlaySound                       SND_ALIAS, SND_FILENAME, and
                                SND_NOWAIT are not supported.
</PRE> 
<PRE>RegisterClassEx                 Only partially implemented, similar to NT.
GetClassInfoEx                  Both APIs ignores the small icon that is
                                associated with the window class. Hence,
                                the hIconSm member of the WNDCLASSEX
                                structure is always set to NULL.
</PRE> 
<PRE>RegSetValueEx                   Only supports the REG_SZ entries.
</PRE> 
<PRE>SetClipboardData                Use only a global handle.
</PRE> 
<PRE>SetWindowsHookEx                dwThreadId parameter is ignored.
</PRE> 
<PRE>signal                          SIGBREAK is not supported.
</PRE> 
<PRE>spawn                           P_WAIT is not supported.
</PRE> 
<PRE>WaitForDebugEvent               Any dwTimeOut other than 0 is treated as
                                INFINITE.
</PRE> 
<PRE>WNetAddConnection               Password cannot be NULL, but can be "".
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbref kbdocerr<BR>
KBSubcategory: W32s<BR>
Additional reference words: 1.30c kbdss docbug
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
