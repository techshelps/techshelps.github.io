

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: _getdcwd() Returns the Root Directory Under Win32s </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98286 ">
<META NAME="KBModify" CONTENT="1996/12/17">
<META NAME="KBCreate" CONTENT="1993/05/02">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  In the following code segment, _getdcwd() always returns the root:     _getdcwd( 3, cBuf, MAX_PATH );    MessageBox( hWnd, cBuf,  Drive 3           , MB_OK );  Also, in the following code segment, _chdrive() and _getcwd() always return the root:   ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QBXB,QATJ,QAUD,QBFY,QAVV,QBWP,QA62,QAH4,QAC9,QAC1,QDH9,QANE,QAKJ,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: _getdcwd() Returns the Root Directory Under Win32s</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98286 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32s versions 1.1, 1.2, 1.30, 1.30a, and 1.30c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the following code segment, _getdcwd() always returns the root:
<P>
<PRE>   _getdcwd( 3, cBuf, MAX_PATH );
   MessageBox( hWnd, cBuf, "Drive 3 &lt;C drive&gt;", MB_OK );

</PRE>Also, in the following code segment, _chdrive() and _getcwd() always return
the root:
<P>
<PRE>   _chdrive( 3 );
   _getcwd( cBuf, MAX_PATH );
   MessageBox( hWnd, cbuf, "Drive 3 &lt;C drive&gt;", MB_OK );

</PRE><h2>CAUSE</h2>
 
<P>
When a Win32-based application starts on Win32s, the root is set as the
current directory for any drive except the default drive.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following code fragments work as expected under Win32s:
<P>
<PRE>   _getdcwd( 0, cBuf, MAX_PATH );
   MessageBox( hWnd, cBuf, "Drive 0 &lt;default drive&gt;", MB_OK );

   -or-

   GetCurrentDirectory( sizeof (cBuf), cBuf );
   MessageBox( hWnd, cBuf, "SCD", MB_OK );

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Windows NT uses the current directory of a process as the initial current
directory for the current drive of a child process. So for example, if the
current directory in the command prompt (CMD.EXE) is C:\WINNT then the
current directory of the child process will be C:\WINNT.
<P>
However, on Win32s, the current directory for any drive except the default
drive is set to the root and not the current directory of the parent
process. A Win32-based application running on Win32s calling _chdrive() or
SetCurrentDirectory() to change the drive GetCurrentDirectory or _getcwd()
will then return the root. The _getdcwd() function is a composite of
changing drives, getting the current directory of that drive, and change
back to the original drive. Therefore, _getdcwd() will always return the
root on Win32s.
<P>
Running the following sample to display the current directory of drives C
and D under Windows NT properly displays the full path of the drive.
Running the sample under Win32s always displays the root ("C:\", "D:\").
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>#include &lt;direct.h&gt;

</PRE>...
<P>
<PRE>   status =  _getdcwd(3, szPath, MAX_PATH);    // drive 3 == C:
   if( status != NULL )
   {
      MessageBox( hWnd, szPath, "Current working directory on C:", MB_OK );
   }

   status =  _getdcwd( 4, szPath, MAX_PATH );  // drive 4 == D:
   if( status != NULL )
   {
      MessageBox( hWnd, szPath, "Current working directory on D:", MB_OK );
   }

</PRE>...
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: W32s<BR>
Additional reference words: 1.10 1.20 1.30 1.30a 1.30c<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
