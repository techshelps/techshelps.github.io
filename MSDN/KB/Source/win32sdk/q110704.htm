

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Replacing Windows NT Control Panel's Mouse Applet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110704">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1994/01/27">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT=" The Control Panel includes a Mouse applet as a standard applet that is shipped with the system. In Windows 3.1, this applet can be overridden by an ISV/OEM's mouse driver or module. Windows 3.1 accomplished this by the Control Panel doing a GetModul...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTX,QBWP,QBXF,QAT7,QAGI,QAQ7,QAEV,QAUD,QAB5,QA7O,QAYC,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Replacing Windows NT Control Panel's Mouse Applet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110704</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.1 and 3.5
</UL></PRE> 
<P>
The Control Panel includes a Mouse applet as a standard applet that is
shipped with the system. In Windows 3.1, this applet can be overridden by
an ISV/OEM's mouse driver or module. Windows 3.1 accomplished this by the
Control Panel doing a GetModuleHandle() call on "Mouse". If MOUSE.DLL or
MOUSE.EXE was already loaded in the system, Control Panel would look for
the entry point "CPlApplet". If found, Control Panel would send the
following messages:
<P>
<PRE>   CPL_NEWINQUIRE

   -or-

   CPL_INQUIRE (the former is preferred)

</PRE>This would return the icon and strings to replace the mouse icon already in
Control Panel.
<P>
In Windows NT, because of the separation of Kernel drivers from
applications by the client-server interface, the GetModuleHandle() call
does not work. Consequently, the same functionality must be achieved in a
slightly different way. The Control Panel calls LoadLibrary( "Mouse" ) to
look for a MOUSE.DLL or a MOUSE.EXE. If this call fails, no other checks
are made.
<P>
If LoadLibrary() succeeds, the Control Panel looks for the "CPlApplet"
entry point, sends a CPL_INIT message, and then sends a CPL_NEWINQUIRE. If
CPL_NEWINQUIRE fails, a CPL_INQUIRE is sent; however, it is preferable to
have the applet implement the newer CPL_NEWINQUIRE message. The string
information returned by the CPL_NEWINQUIRE message can be in either UNICODE
or ANSI (UNICODE is preferred) as long as the dwSize field is set
correctly. See the CPL.H public header file for these messages and
structures (for example CPLINFOW or CPLINFOA, where CPLINFOW is the
default).
<P>
When the User double-clicks the Mouse applet icon, the MOUSE.DLL or
MOUSE.EXE will receive a CPL_DBLCLK message from the CPlApplet interface.
This routine must return TRUE to the Control Panel if the routine runs its
own dialog. If FALSE is returned, the internal Mouse Dialog box will be
presented to the User.
<P>
The Control Panel will send the CPL_EXIT message to the Mouse applet when
it wants to unload the module or terminate. The applet must use this
message to perform tasks such as calling UnRegisterWindowClass(), freeing
memory, and unloading DLLs.
<P>
NOTE: It is not possible to replace any of the other standard Windows NT
3.1 Control Panel applets. As of Windows NT 3.5, it is also possible to
replace the Keyboard applet in the same manner.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
