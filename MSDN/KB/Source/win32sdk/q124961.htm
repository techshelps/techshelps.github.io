

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: SNMP Sample Generates an Application Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124961">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/01/17">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Win32 SDK for Windows NT 3.5 contains a SNMP sample called SNMPUTIL (\MSTOOLS\SAMPLES\WIN32\SNMP\SNMPUTIL). Building this sample generates an executable file that causes an access violation. The message box displayed resembles the following:   ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QBWP,QAU3,QAMR,QBWS,QBFY,QAR4,QAFH,QBVV,QBHQ,QAAP,QADX,QACE,QA01,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: SNMP Sample Generates an Application Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124961</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.50
WINDOWS NT
kbnetwork kbnetwork kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Win32 SDK for Windows NT 3.5 contains a SNMP sample called SNMPUTIL
(\MSTOOLS\SAMPLES\WIN32\SNMP\SNMPUTIL). Building this sample generates an
executable file that causes an access violation. The message box displayed
resembles the following:
<P>
<PRE>                     snmputil.exe - Application Error
   -----------------------------------------------------------------
   The instruction at &lt;address&gt; referenced memory at &lt;address&gt;.  The
   memory could not be "read".

</PRE><h2>CAUSE</h2>
 
<P>
One part of the SNMP run times uses the C run-time routines provided by
CRTDLL.DLL. The other part of the SNMP run times uses the C run-time
routines that the application uses. Because many people are using Visual
C++ to build the samples, the run time routines used are in MSVCRT20.DLL.
The access violation occurs when memory allocated using one run time
version are freed using a different copy of the run time library.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
One possible solution is to build the sample application using the
CRTDLL.DLL version of the run time library. If you are using the makefile
supplied with the Win32 SDK, one way to accomplish this is to:

<OL><P><LI>Copy NTWIN32.MAK from your include directory to the working directory
   for the sample.
</OL>2. Change all references to MSVCRT.LIB in NTWIN32.MAK to CRTDLL.LIB.
<P>
If you are using a Visual C++ make file, you can:

<OL><P><LI>Select the "Ignore All Default Libraries" check box in the Linker
   Project Settings property page.
</OL>2. Add CRTDLL.LIB to the "Object/Library Modules" section in the Linker
<PRE>   Project Settings property page.

</PRE></OL>NOTE: CRTDLL.LIB does not ship with Visual C++. You can get the CRTDLL.LIB
file from the Win32 SDK in the \MSTOOLS\LIB\CRT\&lt;PLATFORM&gt; directory, where
&lt;PLATFORM&gt; would be replaced with the type of machine you are using (I386,
alpha, and so forth).
<P>
If you are using MFC 3.0, you will not be able to use CRTDLL.DLL because
MFC 3.0 uses some functions that are not supplied in CRTDLL.DLL.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed that this is a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in the
Win32 SDK version 3.51.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50<BR>
KBCategory: kbnetwork kbnetwork kbfixlist kbbuglist<BR>
KBSubcategory: NtwkSnmp<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
