

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Application Version Marking in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125705">
<META NAME="KBModify" CONTENT="1995/09/29">
<META NAME="KBCreate" CONTENT="1995/02/01">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Applications designed for Windows 95, whether 16- or 32-bit, should be marked for Windows version 4.0 so they receive the full benefit of new user interface features in Windows 95. Applications marked as being designed for earlier versions of Windo...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAJH,QAC1,QABA,QAW6,QAPN,QAGQ,QDNF,QBVV,QA01,QAIM,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Application Version Marking in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125705</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Applications designed for Windows 95, whether 16- or 32-bit, should be
marked for Windows version 4.0 so they receive the full benefit of new user
interface features in Windows 95. Applications marked as being designed for
earlier versions of Windows will display behavior consistent with the
Windows version 3.1 user interface, which is not always identical to
Windows 95 behavior.
<P>
Executables marked for Windows version 4.0 will load on Windows 95, Windows
NT version 3.5, Win32s version 1.15, and later versions, but not on earlier
versions.
<P>
NOTE: This article deals solely with marking executable files as compatible
with a particular Windows version. This is different from the version
resources (VS_VERSION_INFO) that may be contained in an executable.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Visual C++ version 2.1 linker defaults to marking executables
for Windows version 4.0 while the version 2.0 linker defaults to 3.1. The
Books Online section "Appendix B: Link Reference" incorrectly states that
versions 2.1 and 2.2 default to a subsystem of 3.10. To override the
default, the Microsoft Visual C++ linkers accept the following syntax for
the /SUBSYSTEM option:
<P>
<PRE>   /SUBSYSTEM:WINDOWS,4.0

</PRE>In the development environment, you can change the /SUBSYSTEM option by
going to the Project menu, selecting Settings, selecting either Win32 Debug
or Win32 Release, choosing the Link tab, and editing the Project Options.
To explicitly set the subsystem to the version prior to 4.0, specify a
subsystem of 3.10. The trailing 0 in 3.10 is required in this case.
<P>
You may need to perform a full link for this to take effect, but subsequent
incremental linking with this switch will work correctly.
<P>
To mark a 16-bit executable as Windows version 4.0 compatible, use the
16-bit resource compiler (RC.EXE) from the Windows 95 SDK to bind the
resources into the executable file. By default, this version of RC marks
the executable for version 4.0, but this can be overridden by using
the -30 or -31 switch.
<P>
An application will display several behavioral differences depending on
which Windows version the application is compatible with:

<OL><P><LI>All standard control windows owned by a version 4.0 application are
   drawn with a chiseled 3D look. To obtain the same effect for dialogs
   owned by a version 3.1 application, use the DS_3DLOOK dialog style.
   This style is ignored if the application is run on Windows platforms
   other than Windows 95. The dialog style DS_3DLOOK is not defined in the
   standard WINRES.H. Therefore, to use this style, you must define it as
<P>
<P><PRE>      #define DS_3DLOOK 0x0004L
</PRE><P>
   and or DS_3DLOOK into the STYLE line of each dialog in the project's .RC
   file. NOTE: Editing a dialog template using the resource editor removes
   this DS_3DLOOK style bit.
<P>
   NOTE: This symbol will be defined in a future release of Visual C++. At
   that time, you will get the error "symbol redefined". At that point, you
   can remove your definition of DS_3DLOOK.

<P><LI>Thunks created using the Windows 95 SDK Thunk Compiler will not work
   unless the 16-bit thunk DLL is marked for version 4.0.

<P><LI>Windows version 3.1 allowed 16-bit applications to share GDI resources
   such as font or bitmap handles. For backwards compatibility, Windows 95
   does not clean up objects left undeleted by a 16-bit version 3.x
   application when that application terminates because these objects may
   be in use by another application. Instead, such objects remain valid as
   long as there are any 16-bit applications running. When all 16-bit
   applications are closed, these objects are freed.
<P>
   On the other hand, is is assumed that 16-bit version 4.0 applications
   follow the Windows 95 guidelines, and do not share objects. Thus, all
   objects owned by a 16-bit version 4.0-based application are freed when
   the application terminates.
<P>
   Win32-based applications cannot freely share GDI objects, so all owned
   objects are freed when a Win32-based application terminates regardless
   of the version of the application.

<P><LI>New window messages, such as WM_STYLECHANGED, are only sent to windows
   owned by a version 4.0 application.

<P><LI>Printer DCs are reset during StartPage() in applications marked with
   version 4.0
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
