

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Owner-Draw: Overview and Sources of Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q64327 ">
<META NAME="KBModify" CONTENT="1996/03/11">
<META NAME="KBCreate" CONTENT="1990/07/31">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Owner-draw controls are a new feature of Windows version 3.0. Because your application does all the drawing of the contents of the controls, you can customize them any way you like. Owner-draw controls are similar to predefined controls in that Win...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAB5,QA7O,QAMN,QAOE,QDL9,QBWO,QBWN,QALS,QBWQ,QBBI,QAEV,QBVV,QATX,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Owner-Draw: Overview and Sources of Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q64327 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.0 and 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Owner-draw controls are a new feature of Windows version 3.0. Because your
application does all the drawing of the contents of the controls, you can
customize them any way you like. Owner-draw controls are similar to
predefined controls in that Windows will handle the control's functionality
and mouse and keyboard input processing. However, you are responsible for
drawing the owner-draw control in its normal, selected, and focus states.
<P>
You can create owner-draw controls from the menu, button, and list-box
classes. You can create owner-draw combo boxes, but they must have the
CBS_DROPDOWNLIST style (equates to a static text item and a list box). The
elements of an owner-draw control can be composed of strings, bitmaps,
lines, rectangles, and other drawing functions in any combination, in your
choice of colors.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Windows SDK sample application MENU demonstrates owner-draw menu items.
The SDK sample application OWNCOMBO is a fairly large example of owner-draw
and predefined list boxes and combo boxes.
<P>
The Microsoft Software Library contains simplified examples of an owner-
draw push button, owner-draw list boxes, and an owner-draw drop-down list
style combo box. Each of these examples includes descriptive text in a
related Knowledge Base article. For additional information, please see the
following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN16SDK/Q64326.htm">Q64326</A></B>
   TITLE     : Owner-Draw: Handling WM_DRAWITEM for Drawing Controls

   -or-

   ARTICLE-ID: <B><A HREF="../WIN16SDK/Q64328.htm">Q64328</A></B>
   TITLE     : Owner-Draw: 3-D Push Button made from Bitmaps with Text

   -or-

   ARTICLE-ID: <B><A HREF="../WIN16SDK/Q65792.htm">Q65792</A></B>
   TITLE     : Owner-Draw Example: Right - and Decimal Alignment

</PRE>To respond to a WM_MEASUREITEM message, you MUST specify the height of the
appropriate item in your control. Optionally, you can specify the item's
width as well.
<P>
If you want to do something special when a string is deleted from a list
box, you should process WM_DELETEITEM messages. Windows's default action is
to erase the deleted string and to redraw the list box.
<P>
If you want to have control over the sorting for the order of items in a
list box or combo box that does not have the *_HASSTRINGS style, you should
specify the appropriate *_SORT style and process WM_COMPAREITEM messages.
If the *_SORT and *_HASSTRINGS styles are present, Windows will
automatically do the sorting without sending WM_COMPAREITEM messages. If
*_SORT is not specified, WM_COMPAREITEM messages will not be generated and
items will be displayed in the list box in the order in which they were
inserted.
<P>
The heart of owner-draw controls is the response to WM_DRAWITEM messages.
During this processing is when you draw an entire button or each individual
item in a menu, list box, or combo box. Because Windows does not interfere
in the drawing of owner-draw controls, your application must draw the
specified control item. The display of the control must indicate the state
of the control. Common states are as follows:

<OL><P><LI>Focus state (has the focus or not)

<P><LI>Selection state (selection or not)

<P><LI>Emphasis state (active, grayed, or disabled) (less common to
   process)
<P>
</OL>See the article titled "Owner-Draw: Handling WM_DRAWITEM for Drawing
Controls" for information about drawing controls in their various
states. Familiarity with the WM_DRAWITEM message and the various
control states is extremely helpful before trying to follow the code
examples.
<P>
Under Windows 95, the BS_BITMAP style allows buttons to display bitmaps
without using owner-draw.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 4.00 owndraw od owner draw<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
