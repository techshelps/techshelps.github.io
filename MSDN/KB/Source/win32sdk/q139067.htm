

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: FILEDRAG: How to Support File Drag Server Capabilities </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139067">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1995/11/02">
<META NAME="Keywords" CONTENT="kbfile kbhowto kbole">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Sample code is available that shows how an application can provide the File Drag drop server capabilities. It shows how to set up the data structures for CF_HDROP and ShellIDList formats. In this sample, the user can enable support for any combinat...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9N,QAH6,QAJH,QACI,QAPF,QAD7,QDNG,QDL9,QBWQ,QBWO,QBWN,QAXE,QBW9,QBJZ,QAJ4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: FILEDRAG: How to Support File Drag Server Capabilities</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139067</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbole kbfile kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sample code is available that shows how an application can provide the File
Drag drop server capabilities. It shows how to set up the data structures
for CF_HDROP and ShellIDList formats. In this sample, the user can enable
support for any combination of CF_HDROP and ShellIDList format and see the
drag drop result. To obtain this sample:
<P>
Download FILEDRAG.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location
      Type mssupport
      Double-click the MS Software Library icon
      Find the appropriate product area
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/FILEDRAG.EXE">FILEDRAG.EXE</A> <I>(size: 70856 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/FILEDRAG.EXE">FILEDRAG.EXE</A> <I>(size: 70856 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib\Mslfiles directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/FILEDRAG.EXE">FILEDRAG.EXE</A> <I>(size: 70856 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
In Windows 3.x, the only application that could act as a File Drag-Drop
server was File Manager. Now the file drag-drop server capability is
extended to all applications via OLE Drag Drop.
<P>
An OLE drag-drop server application that supports the CF_HDROP format can
support file drag drop as does File Manager. The Windows system generates
the appropriate WM_DROPFILES message for client applications that support
File Drop, or the Windows system passes the IDataObject if the client
application supports OLE Drop target for CF_HDROP format.
<P>
One of the new features of the shell is when you drop files on an icon on
the desktop. The Shell opens the particular application with the drop file
in it provided the application supports command line arguments where file
can be passed as in this example:
<P>
<PRE>   notepad.exe myfile.txt

</PRE>This feature could also be provided by a file drag drop server that
supports the ShellIDList format, in addition to the CF_HDROP format.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00<BR>
KBCategory: kbole kbfile kbhowto<BR>
KBSubcategory:<BR>
Keywords            : kbfile kbhowto kbole<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
