

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: OLE Libraries Fix List </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134799">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT=" Fixes in OLE 2.02 (Win32s 1.2)  The following is a list of the known bugs that were fixed in OLE 2.02, which is distributed with Win32s version 1.2.   - Changing the source of a link when the object is iconic does not update    the new link name.   ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAUD,QAM1,QA9Q,QBVV,QBKN,QAGI,QDIX,QALW,QAH4,QAAP,QAKP,QAW6,QAO3,QAO2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: OLE Libraries Fix List</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134799</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.20 1.25a 1.30 2.02 2.03
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries for Windows and Win32s, versions 2.02, 2.03
<LI>Microsoft Win32s, versions 1.2, 1.25a, and 1.3
</UL> 
<P>
<P><h3>Fixes in OLE 2.02 (Win32s 1.2)</h3>
 
<P>
The following is a list of the known bugs that were fixed in OLE 2.02,
which is distributed with Win32s version 1.2.

<UL><LI>Changing the source of a link when the object is iconic does not update
   the new link name.

<LI>GetClassfile fails if the offset is greater than 32K.

<LI>GetClassfile returns NO_ERROR when the clsid string in the registry
   contains illegal characters.

<LI>The IStream returned from CreateStreamOnHGlobal does not support
   QueryInterface correctly.

<LI>GetClassfile fails if the offset is negative.

<LI>For composite monikers, IMoniker::CommonPrefixWith returns the wrong
   hresult if both monikers have a common prefix. For item monikers,
   IMoniker::CommonPrefixWith doesn't handle the case that the other
   moniker is not an item moniker.

<LI>CreateGenericComposite fails when handling an item moniker with an
   anti moniker.

<LI>For item monikers, IMoniker::ParseDisplayName causes a general
   protection (GP) fault when pmkToLeft is NULL.

<LI>For anti monikers, IMoniker::RelativePathTo returns an interface pointer
   without first calling AddRef and returns a wrong hresult.

<LI>The ILockBytes returned from CreateILockBytesOnHGlobal does not support
   QueryInterface correctly.

<LI>ICLassFactory::LockServer returns the wrong hresult.

<LI>OLE time APIs do not validate input pointers.

<LI>For composite monikers, calling IMoniker::RelativePathTo leaks memory.

<LI>OleLoadFromStream(pstrm, IID_IUnknows, &amp;pmk) always returns
   E_NOINTERFACEW (0x80004002).

<LI>When registering a new pointer to unknown with an existing key,
   IBindCtx::RegisterObjectParam does not release the old pointer,
   resulting in a memory leak.

<LI>IBindCtx::RevokeObjectBound fails with MK_E_NOTBOUND even though the
   object is in the list.

<LI>IPersistFile::IsDirty fails.

<LI>There is no marshalling code for IPersistStream.

<LI>For pointer monikers, IMoniker::IsRunning is not implemented correctly.

<LI>Drawing a metafile causes a leak of many palettes.

<LI>OleMetafilePictFromIconAndLabel mishandles long labels.

<LI>OleMetafilePictFromIconAndLabel tries to write to a label.
<P>
</UL><h3>Fixes in OLE 2.03 (Win32s 1.25)</h3>
 
<P>
The following is a list of the known bugs that were fixed in OLE 2.03,
which is distributed with Win32s version 1.25.

<UL><LI>IMalloc::DidAlloc does not return 1 for memory it allocates.

<LI>There is no marshalling code for IEnumUnknown, IMoniker, and
   IEnumMoniker.

<LI>MkParseDisplayName silently fails if the server is already running.

<LI>Wrong cbSize in OBJECTDESCRIPTOR.

<LI>GPF occurs when marshalling a MSG structure in 16-32 interop.

<LI>Bug in remoting of OA interfaces (32-bit only).

<LI>Bug in second activation of the olespy tool. It may not run.

<LI>OleConvertOLESTREAMToIStorage always saves CLSID_NULL instead of the
   real clsid.

<LI>GPF marshalling ILockBytes::Stat, IStorage::Stat, and IStream::Stat.

<LI>GPF with 16-32 interop when the 32-bit application installs a hook.
<P>
</UL><h3>Fixes in OLE 2.03 (Win32s 1.25a)</h3>
 
<P>
The following is a list of the known bugs that were fixed in OLE 2.03,
which is distributed with Win32s version 1.25a.

<UL><LI>Can't unload an Excel Add-in.

<LI>Cross-bitness QueryInterface does not return the correct error code.

<LI>Japanese NEC PCs may crash when calling CoCreateGuid.

<LI>Failure to call a 32-bit OA server if the calling chain is too long.
   Therefore, you can not do the following: OA controller -&gt; OA serverA -&gt;
   OA serverB -&gt; OA serverC.
<P>
</UL><h3>Fixes in 32-bit OLE (Win32s 1.3)</h3>
 
<P>
The following is a list of the known bugs that were fixed in the 32-bit OLE
which is distributed with Win32s version 1.3.

<UL><LI>General protection (GP) fault when a 32-bit container activates a 16-bit
   server more than once and uses both OA intefaces and core OLE
   interfaces.

<LI>When a call to OleGetClipboard fails, the clipboard become corrupted and
   other applications can not use it.

<LI>A 16-bit container copies data to the clipboard and a 32-bit server uses
   the Paste Special dialog. The string from the object descriptor is
   corrupted and a general protection (GP) fault may occur.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.20 1.30<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: LeTwoMisc W32s<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
