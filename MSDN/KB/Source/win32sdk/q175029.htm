

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Troubleshooting Windows CE Emulation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175029">
<META NAME="KBModify" CONTENT="1997/10/13">
<META NAME="KBCreate" CONTENT="1997/10/10">
<META NAME="Keywords" CONTENT="kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Windows CE Emulation environment is only available on Windows NT 4.0. It enables a developer to develop Windows CE applications that will run on Windows NT. The applications are built using an INTEL based compiler and linker and run as a normal...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QBXB,QATJ,QDL9,QBWO,QBWN,QBWP,QBWQ,QA9N,QASB,QAA1,QBIC,QANE,QABI,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Troubleshooting Windows CE Emulation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175029</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows CE, versions 1.0, 1.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows CE Emulation environment is only available on Windows NT 4.0.
It enables a developer to develop Windows CE applications that will run on
Windows NT. The applications are built using an INTEL based compiler and
linker and run as a normal Win32 application.
<P>
The following guide describes the problems that can occur in the Emulation
environment and how to resolve them.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Background</h3>
 
<P>
Visual C++ for Windows CE installs all of its components into a
subdirectory called "WCE". This is located in the DevStudio directory. When
installation is complete, the following directory structure exists:
<P>
<PRE>   +--Devstudio
      +--WCE
          +--EMUL
               +--BIN
               +--WINDOWS

</PRE>This is not the full install tree, but it is the portion of the tree that
is required by emulation. The emulation object store exists in a single
file called WCEOBSTR.DAT, which is located in the "EMUL" directory. The
object store is the storage location for all files, databases, and the
registry. When the emulation shell executes a program, the emulation shell
copies the file to the "EMUL" directory and executes the program from this
location. All of the emulation system components that emulate both SDK and
DDK environments are located in the "BIN" directory. There is a second copy
of Shell32.exe in the Windows directory. The emulation shell uses this copy
of Shell32.exe only for resource retrieval (that is, ICONs). Finally,
Serial.Dll exists in the Windows directory and is used by DDK emulation.
<P>
In addition to the required directory structure, the installation process
also makes an addition to the user's PATH environment variable. That
addition is "...\Devstudio\WCE\emul\bin", which is where components of the
emulation shell are installed.
<P>
<P><h3>Problem Situations</h3>
 

<OL><P><LI>Emulation shell fails to run or displays incorrectly.
<P>
</OL>The Emulation shell, Shell32.exe, can be executed in one of two ways.
First you can use Windows NT to launch Shell32.exe, or you can have
Microsoft Visual C++ launch the shell when you execute an emulation
application.
<P>
In both situations, Shell32.exe can fail for the following reasons:

<UL><LI>Some shell required components (that is, filesys.exe) cannot be
   located. Check to ensure that your PATH environment variable contains
   the path to your emulation BIN directory (that is,
   "...\Devstudio\WCE\emul\bin").

<LI>The emulation objectstore is corrupt. Replace the Wceobstr.dat file
   located in the "...\WCE\EMUL" directory with a new copy from the
   installation CD. On the CD the location of the DAT file is
   "...\wcedev\Wce\Emul".

<LI>Shell32 cannot communicate with filesys.exe. This problem is not so
   obvious. If you are having problems, then execute "filesys.exe -c". This
   will cleanly shutdown the emulation object store and allow it to
   properly restart the next time Shell32.exe is executed.

</UL><OL><P><LI>Empfile.exe fails to copy files to the Emulation objectstore.
<P>
</OL>Microsoft Visual C++ uses Empfile.exe to copy an executable module into the
emulation object store. In addition, it can be used from the command prompt
to perform COPY operations to the emulation objectstore. To determine the
command line parameter of Empfile.exe, from a command prompt execute the
following command: "empfile /?".
<P>
Empfile.exe can fail to copy for the following reasons:

<UL><LI>The emulation objectstore is corrupt. Replace the Wceobstr.dat file
   located in the "...\WCE\EMUL" directory with a new copy from the
   installation CD. On the CD the location of the DAT file is
   "...\wcedev\Wce\Emul".

<LI>The emulation object store is full.

<LI>In Microsoft Visual C++, Empfile.exe can fail to execute if Microsoft
   Visual C++ cannot locate the application. Check your directories options
   for each platform and make sure that the "Executable files" directory
   list includes the path to your SharedIDE components (that is,
   "...\DevStudio\SharedIDE\bin").
</UL> 
<PRE>Keywords          : kbtshoot
Version           : WINNT:
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
