

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Windows 95 Styles Make Attaching Bitmap to Button Easier </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125673">
<META NAME="KBModify" CONTENT="1998/01/05">
<META NAME="KBCreate" CONTENT="1995/02/01">
<META NAME="Keywords" CONTENT="UsrWndw">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Under Windows 95, there are two new button styles (BS_BITMAP and BS_ICON). Using these styles makes attaching a bitmap or an icon to a button in Windows 95 easier than it was in Windows version 3.1.  MORE INFORMATION  Under Windows version 3.1 you ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5D,QAJD,QDL9,QBWO,QBWN,QANS,QBWQ,QBBI,QAKJ,QACI,QA39,QAB2,QBVV,QATX,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Windows 95 Styles Make Attaching Bitmap to Button Easier</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125673</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under Windows 95, there are two new button styles (BS_BITMAP and BS_ICON).
Using these styles makes attaching a bitmap or an icon to a button in
Windows 95 easier than it was in Windows version 3.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Under Windows version 3.1 you create the button by using the CreateWindow()
function with the BS_OWNERDRAW style to attach a bitmap or an icon to a
button. Each time the parent window receives the WM_DRAWITEM message the
bitmap or the icon must be loaded and drawn on the button.
<P>
Under Windows 95 you can create a button with style BS_BITMAP to display a
bitmap instead of text on the button. After you create the button by using
CreateWindow() function, assign the bitmap to the button by sending a
BM_SETIMAGE message to the button with the wparam as IMAGE_BITMAP and
lparam as a handle to the bitmap. Windows displays the specified bitmap on
the button. The attached bitmap should not be deleted until the button is
destroyed, or another bitmap is assigned to the button.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   hwndButton = CreateWindow(
                 "BUTTON",   // predefined class
                 "OK",       // button text
                 WS_VISIBLE| WS_CHILD | BS_DEFPUSHBUTTON |BS_BITMAP,
                 //styles
                 // Size and position values are given explicitly, because
                 // the CW_USEDEFAULT constant gives zero values for
                 // buttons.
                 5, // starting x position
                 5, // starting y position
                 30,// button width
                 18, // button  height
                 hWnd,// parent window
                 NULL,// No menu
                 (HINSTANCE) GetWindowLong(hWnd,
                             GWL_HINSTANCE), NULL); // pointer not needed

   // load the bitmap, NOTE: delete it only when it's no longer being used.
   hBitmap   = LoadBitmap(hInst,MAKEINTRESOURCE(IDB_BITMAP1));
   // associate the bitmap with the button.
   SendMessage(hwndButton,BM_SETIMAGE,(WPARAM)IMAGE_BITMAP,
              (LPARAM)(HANDLE)hBitmap);

</PRE>Under Windows 95, you can also create a button with style BS_ICON to
display a icon instead of text on the button. After creating the button by
using CreateWindow() function, assign the icon to the button by sending a
BM_SETIMAGE message to the button with the wparam as IMAGE_ICON and the
lparam as the handle to the icon. Windows displays the specified icon on
the button.
<P>
NOTE: The system handles cleanup of icons or cursors loaded from resources.
Therefore, the icon should not be deleted unless the icon was created at
run time by using CreateIcon() function.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE> hwndButton = CreateWindow(
                  "BUTTON",   // predefined class
                  "OK",       // button text
                  WS_VISIBLE | WS_CHILD | BS_DEFPUSHBUTTON|BS_ICON,//styles
               // Size and position values are given explicitly, because
               // the CW_USEDEFAULT constant gives zero values for buttons.

                   5, // starting x position
                   5, // starting y position
                  30, // button width
                  18, // button height
                  hWnd,   // parent window
                  NULL,   // No menu
                  (HINSTANCE) GetWindowLong(hWnd,GWL_HINSTANCE),
                  NULL);      // pointer not needed

 // load the icon, NOTE: you should delete it after assigning it.
 hIcon = LoadIcon(hInst,MAKEINTRESOURCE(IDI_ICON1));
 // associate the icon with the button.
 SendMessage(hwndButton,BM_SETIMAGE,(WPARAM)IMAGE_ICON,
            (LPARAM)(HANDLE)hIcon);

</PRE>If a bitmap or icon is not specified via the BM_SETIMAGE message and the
BS_BITMAP or BS_ICON style is specified, a blank button with no text is
displayed.
 
<PRE>Keywords          : UsrWndw
Platform          : Win95
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
