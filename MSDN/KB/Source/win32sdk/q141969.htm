

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Win95 Uses Known16DLLs Registry Key to Find 16-bit DLLs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141969">
<META NAME="KBModify" CONTENT="1997/05/09">
<META NAME="KBCreate" CONTENT="1996/01/02">
<META NAME="Keywords" CONTENT="BseDll kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The process of loading a DLL for the first time, implicitly or explicitly, invokes Windows 95 to search for the specified DLL in a predefined order until the DLL is found or all search efforts are exhausted. In Windows 95, the string values associa...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QBXB,QATJ,QAFI,QATX,QAKD,QDNN,QBBI,QAJQ,QDNF,QAUJ,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Win95 Uses Known16DLLs Registry Key to Find 16-bit DLLs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141969</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface included with:
   - Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The process of loading a DLL for the first time, implicitly or explicitly,
invokes Windows 95 to search for the specified DLL in a predefined order
until the DLL is found or all search efforts are exhausted. In Windows 95,
the string values associated with the Known16DLLs registry key have the
ability to reset the normal search order used to locate and load a 16-bit
DLL to a new predefined order. Thus, a string value that identifies a 16-
bit DLL and is also associated with the Known16DLLs registry key will force
Windows 95 to begin its search for the DLL in the System directory - not
the current directory.
<P>
<P><h2>MORE INFORMARTION</h2>
 
<P>
In Windows 95, the predefined order that is used to locate and load a
16-bit DLL is specified as follows:

<OL><P><LI>The current directory.

<P><LI>The Windows directory (the directory containing Win.com).

<P><LI>The Windows system directory (the directory containing such system files
   as Gdi.exe).

<P><LI>The directory containing the executable file for the current task.

<P><LI>The directories listed in the PATH environment variable.
<P>
</OL>NOTE: If a 16-bit DLL is already loaded by some running application,
Windows 95 does not search for the DLL to load, even if the full path name
is supplied to LoadLibrary. Instead Windows 95 will resolve the imports to
link to the DLL already in memory.
<P>
This search order is reset if a 16-bit DLL being loaded has a string value
with the same name as the 16-bit DLL specified in the Known16DLLs registry
key. The Known16DLLs registry key is located at:
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SessionManager

</PRE></OL>The data associated with the DLL string value can take any form. An example
of such a string value is:
<P>
<PRE>Name                       Data
</PRE> 
<PRE>"COMMCTRL.DLL"             "SYSTEM COMMCTRL.DLL"


</PRE>When a string value for a 16-bit DLL exists, the new search order is as
follows:

<OL><P><LI>The Windows system directory.

<P><LI>The Windows directory.

<P><LI>The current directory.

<P><LI>The directory from which the application loaded.

<P><LI>The directories that are listed in the PATH environment variable.
<P>
</OL>There are three ways that this DLL string value can be added to the
registry:

<UL><LI>An end user can use Regedit.exe to add the 16-bit DLL string value to
   the Known16DLLs registry key.
<P>
   -or-

<LI>The 16-bit DLL string value can be added programmatically to the
   Known16DLLs registry key using registry APIs.
<P>
   -or-

<LI>Windows 95 can automatically add the 16-bit DLL string value to the
   Known16DLLs registry key.
<P>
</UL>The first two ways to add the 16-bit DLL string value are basic and require
no further explanation; however, the third method is more complex. Each
time a 16-bit DLL is loaded from the Windows System directory, Windows 95
checks the Known16DLLs registry key for a string value that has that same
name. If the string value does not exist, Windows 95 creates it in the
Known16DLLs registry key. Thus, any application that uses a DLL that has
the same name as a DLL listed in the Known16DLLs registry key will always
use the reset search order to locate the DLL. As long as the DLL exists in
the Windows System directory and can be loaded by another application,
deletion of the string value will not be effective in returning the search
order to its original predefined state.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: search path 16 3.1 loadlibrary win95 order<BR>
Keywords            : BseDll kbenv<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
