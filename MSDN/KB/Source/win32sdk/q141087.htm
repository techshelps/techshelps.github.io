

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: MarkMIDI Utility Not Provided in Win32 SDK </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141087">
<META NAME="KBModify" CONTENT="1996/12/02">
<META NAME="KBCreate" CONTENT="1995/12/11">
<META NAME="Keywords" CONTENT="kbmm kbprg kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Win32 SDK multimedia documentation refers to the MarkMIDI utility in the following topics:     Using the MARKMIDI Utility    Using the MCI MIDI Sequencer with High-Level Audio    Authoring Guidelines for MIDI Files  However, this utility is not...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAN0,QAYS,QAHR,QDL9,QBWO,QBWN,QBCU,QBWQ,QBVV,QDL2,QA9O,QA3T,QAWI,QBII,QAZB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: MarkMIDI Utility Not Provided in Win32 SDK</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 2, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141087</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) version 3.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Win32 SDK multimedia documentation refers to the MarkMIDI utility
in the following topics:
<P>
<PRE>   Using the MARKMIDI Utility
   Using the MCI MIDI Sequencer with High-Level Audio
   Authoring Guidelines for MIDI Files

</PRE>However, this utility is not provided in the Win32 SDK.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Due to advances in the MIDI capabilities of PC sound cards and MIDI
synthesizers and in particular support for the General MIDI Level 1
specification, the authoring of MIDI files according to the old Microsoft
Windows 3.1 SDK Authoring Guidelines for MIDI Files is no longer
recommended. Thus, the purpose for which MarkMIDI was designed (to set a
flag in the header of such files) is no longer required. Also, the
incorrect use of this utility can degrade the playback quality of MIDI
files authored according to the General MIDI (GM) specification. Therefore
it was decided to no longer include this utility in the Win32 SDK.
<P>
The information in the Win32 SDK topics regarding authoring MIDI files is
obsolete information from the Windows 3.1 SDK documentation. It should be
followed only if there is some special reason to author a file according to
the old Windows 3.1 guidelines. In general, however, only GM files (or
extensions to GM such as Roland's GS or Yamaha's XG specification) should
be authored, and for these files the MarkMIDI utility must not be used.
<P>
MIDI files authored according to the old Windows 3.1 guidelines have MIDI
data on channels 1 through 10, with channel 10 being percussion, and
important MIDI data is duplicated on Channels 11 through 16, with 16 being
percussion. For such files, the MarkMIDI utility from the Windows 3.1 SDK
absolutely must be used to mark the files. The MCI sequencer (Mciseq.drv)
checks for the flag set by MarkMIDI so that it knows to play back only MIDI
channels 1 through 10. Without the flag, all 16 channels are played back as
GM, and track 16 plays back incorrectly.
<P>
Most synthesizers and PC sound cards now support GM, which provides better
sound quality than is derived from files authored according to the old
Windows 3.1 guidelines. In general, there should be no reason to author
MIDI files with MarkMIDI according to the old Windows 3.1 guidelines.
<P>
If a MIDI file authored according to the old Windows 3.1 guidelines is not
marked, it will sound bad when played with the MCI sequencer on Windows 95.
For example, if such a file included percussion on channel 16, all of that
channel's data would probably be played with some instrumental sound other
than percussion, and the result would be non-musical. Also, if a GM file
has been marked, the MCI sequencer will only play channels 1 through 10. In
that case, any MIDI data sent to channels 11 through 16 will not be heard.
<P>
<P><h2>REFERENCES</h2>
 
<P>
The General MIDI specification referred to in this article is not available
from Microsoft. It is published by and is copyrighted material of the MIDI
Manufacturers Association (MMA). For information on obtaining this and
other MIDI specifications from the MMA, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>  ARTICLE-ID: <B><A HREF="../WIN32SDK/Q140203.htm">Q140203</A></B>
  TITLE     : How to Obtain MIDI Specifications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 3.50<BR>
KBCategory: kbmm kbprg kbdocerr<BR>
KBSubcategory: MMMidi<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 2, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
