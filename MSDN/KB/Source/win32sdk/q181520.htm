

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: WSAIoctl SIO_GET_INTERFACE_LIST Option Problem </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181520">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1998/02/20">
<META NAME="Keywords" CONTENT="NtwkWinsock">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Winsock 2 WSAIoctl() SIO_GET_INTERFACE_LIST API option fails to retrieve valid IP interface information on Windows NT 4.0 when it is compiled with include files from the latest Platform SDK release (Oct 97 and later).  CAUSE =====  The INTERFAC...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABA,QAP2,QAKP,QBBS,QALZ,QDKW,QAH4,QDIX,QAJ2,QBWD,QDKF,QAY2,QAO4,QALQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: WSAIoctl SIO_GET_INTERFACE_LIST Option Problem</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181520</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Winsock 2 WSAIoctl() SIO_GET_INTERFACE_LIST API option fails to
retrieve valid IP interface information on Windows NT 4.0 when it is
compiled with include files from the latest Platform SDK release (Oct 97
and later).
<P>
<P><h2>CAUSE</h2>
 
<P>
The INTERFACE_INFO typedef in WS2TCPIP.H is incompatible with Winsock 2 on
Windows NT 4.0. This header file takes future IPV6 capabilities into
consideration, which causes the INTERFACE_INFO type to be too large for IP
data retrieved from WSAIoctl().
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this, you can define and use the original prototype of
INTERFACE_INFO in WSAIoctl() calls in your application as a new type
definition. The original type is referenced as normal. However, by adding a
C preprocessor define to replace all occurrences of the original type with
the type just defined, the process is practically transparent to the
programmer. Notice in the following section of code, the correctly sized
structure is defined as OLD_INTERFACE_INFO followed by a preprocessor
define that replaces all occurrences of the incorrect INTERFACE_INFO with
OLD_INTERFACE_INFO.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   typedef struct _OLD_INTERFACE_INFO
   {
      u_long      iiFlags;      /* Interface flags */
      sockaddr   iiAddress;      /* Interface address */
      sockaddr   iiBroadcastAddress;    /* Broadcast address */
      sockaddr   iiNetmask;      /* Network mask */
   } OLD_INTERFACE_INFO;
   
   #define INTERFACE_INFO OLD_INTERFACE_INFO

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
 
<PRE>Keywords          : NtwkWinsock
Version           : WINNT:4.0
Platform          : winnt
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
