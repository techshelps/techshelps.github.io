

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing TAPI Service Providers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131356">
<META NAME="KBModify" CONTENT="1996/12/16">
<META NAME="KBCreate" CONTENT="1995/06/08">
<META NAME="Keywords" CONTENT="kbprg kbwebcontent kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When installing TAPI Service Providers (TSPs), there is more involved than just copying the TSP files to the system directory. The TAPI system files may need to be installed, and the TSP must be installed into TAPI. However, this process can vary g...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAA1,QDI2,QDL9,QBWN,QBWQ,QBTX,QBWP,QBWB,QABI,QDIR,QAGQ,QBXB,QATJ,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Installing TAPI Service Providers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131356</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Telephony Software Development Kit (TAPI SDK),
   version 1.0
<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P><PRE>    - Microsoft Windows NT version 4.0
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When installing TAPI Service Providers (TSPs), there is more involved than
just copying the TSP files to the system directory. The TAPI system files
may need to be installed, and the TSP must be installed into TAPI. However,
this process can vary greatly from one Windows version to another.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
First and foremost, be sure to do version checking when installing all
files.
<P>
Second, use a setup application rather than relying on an .INF file. While
the ATSP sample uses a .INF file to install, there are several major
problems with using a .INF file:

<UL><LI>TAPI needs to already be installed (which isn't guaranteed under Windows
   3.1 or Windows for Workgroups).

<LI>You can't do operating system version checking if you use an .INF file.

<LI>You can't do file version checking with an .INF file.

<LI>Bugs that won't be fixed in Windows NT 4.0 prevent an .INF file
   installation.
<P>
</UL><h3>Files Necessary for Windows 3.1 or Windows for Workgroups</h3>
 
<P>
When a TSP is installed under Windows 3.1 or Windows for Workgroups, it
must check and make sure all the necessary system files are present. The
files to be installed can be found in the TAPI 1.0 SDK \REDIST directory
and must be distributed with the TSP. Some of these are optional and some
are not. Here is a list of files and where they should be placed:
<P>
Mandatory TAPI files:
<P>
<PRE>    TELEPHON.CPL [system]
    TAPI.DLL     [system]
    TAPIADDR.DLL [system]
    TAPIEXE.EXE  [system]
    TELEPHON.HLP [system]

</PRE>Optional TAPI files:
<P>
<PRE>    ATSPEXE.EXE  [system]
    ATSP.TSP     [system]
    ATSP.HLP     [system]
    DIALER.EXE   [windows]
    DIALER.HLP   [windows]

</PRE><h3>Files Necessary for Windows 95 and Windows NT 4.0</h3>
 
<P>
The TAPI 1.0 redistributable files are only for use on Windows 3.1 and
Windows for Workgroups. These files must not be installed to any other
operating systems. Other Windows operating systems either don't support
TAPI (Windows NT 3.51 and earlier) or come with TAPI already installed
(Windows 95, Windows NT 4.0 and later versions of both platforms).
<P>
One complication for Windows 95 is the TELEPHON.CPL file. This file is
installed to the system directory by default along with all the rest of the
Windows 95 TAPI files. However, because this file is not needed by most
people using Windows 95, it is installed in the system directory as
TELEPHON.CP$ to reduce control panel clutter. TSPs that need this applet
should first look in the system directory for TELEPHON.CPL; if that isn't
found, the TSP should locate TELEPHON.CP$ (also looking in the system
directory), and rename it to TELEPHON.CPL.
<P>
<P><h3>Installing the TSP</h3>
 
<P>
Once all the files are installed, the TSP must now be installed into TAPI.
Under Windows version 3.1, this is done through the Telephony Control Panel
applet (TELEPHON.CPL). There are no APIs to automate the installation, so
TSP installation programs must either tell the user how to install their
TSP into TAPI or use an application such as MSTEST that can simulate
keystrokes to automate this part of the installation. Note that TSPs must
have version information (as demonstrated by the ATSP sample) to show in
the Add Driver dialog.
<P>
Adding TSPs through the Telephony Control Panel is also available under
Windows 95 and Windows NT 4.0, but the exact sequence of keystrokes is
slightly different. However, several TAPI APIs (lineAddProvider,
lineConfigProvider, and lineRemoveProvider) have been added that make the
TELEPHON.CPL installation unnecessary. It's a good idea for TSP to have its
own control panel applet that calls these APIs, rather than rely on
TELEPHON.CPL. The setup program should install the TSP directly by using
these APIs instead of asking the user to run a control panel applet.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.30 1.40 2.00 4.00 95<BR>
KBCategory: kbprg kbwebcontent<BR>
KBSubcategory: TAPI
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
