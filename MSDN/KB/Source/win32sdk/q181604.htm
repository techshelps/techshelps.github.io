

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Determine Default Language ID of Windows 95 or WinNT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181604">
<META NAME="KBModify" CONTENT="1998/02/25">
<META NAME="KBCreate" CONTENT="1998/02/23">
<META NAME="Keywords" CONTENT="KBIntlDev">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Some applications need to get the operating system's language ID. GetSystemDefaultLangID doesn't work, because the user can change it in the Control Panel.  For example, on English Windows 95, the user opens Control Panel, clicks Regional Settings,...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBTX,QDIR,QBWQ,QDL9,QBWO,QBWN,QBWI,QABA,QA4H,QAPN,QAWP,QAGU,QDJ2,QBAO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Determine Default Language ID of Windows 95 or WinNT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 25, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181604</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Some applications need to get the operating system's language ID.
GetSystemDefaultLangID doesn't work, because the user can change it in the
Control Panel.
<P>
For example, on English Windows 95, the user opens Control Panel, clicks
Regional Settings, and changes the setting from English US to French France
in the Regional Settings Properties dialog box. As a result,
GetSystemDefaultLangID changes to French too. On Windows NT, the user
clicks Control Panel, clicks Regional Settings, and opens the Regional
Settings Properties dialog box. In the Regional Settings Properties dialog
box, the user selects a different Locale in a different language, selects
the "Set as system default locale" check box, and then restarts the
computer. As a result GetSystemDefaultLangID changes too the new language
too.
<P>
This article explains more reliable methods you can use to get the
installed operating system's language ID.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following methods are available to get the installed operating system's
language ID:

<UL><LI>Under Windows 95, retrieve the installed operating system's Locale ID
   from HKEY_CURRENT_USER\Control Panel\desktop\ResourceLocale
   (HKEY_USERS\.Default\Control Panel\desktop\ResourceLocale. Use
   LANGIDFROMLCID to retrieve the Language ID value from the Locale value.
<P>
   NOTE: This key does not exist under Windows NT, therefore, this method
   does not work under Windows NT.

<LI>Under Windows NT 4.0 and Windows 95 (only Windows 95 installations that
   have turned on user profile), retrieve the installed operating system's
   Locale ID from HKEY_USERS\.DEFAULT\Control Panel\International. Then get
   the Language ID from the LCID.
<P>
   NOTE: This method only works under Windows 95 after user profile has
   been turned on. Otherwise, it does not work under Windows 95.

<LI>Under both Windows NT and Windows 95, you can get the language
   information in the FileVersionInfo of User.exe by calling
   GetFileVersionInfo, and then VerQueryValue (on
   \\VarFileInfo\\Translation") on the VersionInfo block of the operating
   system's User.exe.
<P>
   NOTE: This method is the most reliable. It works well under both Windows
   NT and Windows 95. This method also works for Windows 3.1.
</UL> 
<PRE>Keywords          : KBIntlDev
Version           : WINNT:4.0;WIN95
Platform          : Win95 winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 25, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
