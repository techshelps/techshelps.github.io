

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 95 Uses KnownDLLs Registry Key to Find 32-bit DLLs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151646">
<META NAME="KBModify" CONTENT="1996/07/01">
<META NAME="KBCreate" CONTENT="1996/05/28">
<META NAME="Keywords" CONTENT="kbenv kbusage kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The process of loading a DLL, implicitly or explicitly, invokes Windows 95 to search for the specified DLL in a predefined order until the DLL is found or all search efforts are exhausted. In Windows 95, the string values associated with the KnownD...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBBI,QDNN,QAKD,QBXB,QATX,QATJ,QBWQ,QAFI,QAUJ,QDNF,QAPF,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 95 Uses KnownDLLs Registry Key to Find 32-bit DLLs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151646</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface included with:
<P><PRE>    - Microsoft Windows 95
</PRE>
<LI>Microsoft Win32 Software Development Kit for:
<P><PRE>    - Microsoft Windows 95
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The process of loading a DLL, implicitly or explicitly, invokes Windows 95
to search for the specified DLL in a predefined order until the DLL is
found or all search efforts are exhausted. In Windows 95, the string values
associated with the KnownDLLs Registry key have the ability to reset the
normal search order used to locate and load a 32-bit DLL to a new
predefined order. Thus, a string value that identifies a 32-bit DLL and is
also associated with the KnownDLLs Registry key will force Windows 95 to
begin its search for the DLL in the System directory, not the current
directory.
<P>
MORE INFORMATION
 
<P>
In Windows 95, the predefined order used to locate and load a 32-bit DLL is
specified as follows:

<OL><P><LI>The directory from which the application loaded.

<P><LI>The current directory.

<P><LI>The Windows system directory. Use the GetSystemDirectory function to
   get the path of this directory.

<P><LI>The Windows directory. Use the GetWindowsDirectory function to get the
   path of this directory.

<P><LI>The directories that are listed in the PATH environment variable.
<P>
</OL>This search order is reset if:

<OL><P><LI>The DLL name passed to LoadLibrary specifies the .DLL extension.

<P><LI>The 32-bit DLL specified has a Registry string value with the same
   name, excluding the extension, as the 32-bit DLL specified in the
   KnownDLLs Registry key. The KnownDLLs Registry key is located at:
<P>
   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SessionManager
<P>
</OL>The data associated with the DLL string value must specify the actual DLL
name for the DLL to be found and loaded. This DLL name does not need to
match the string value name and is not required to following any naming
convention. Some examples of such string values are:
<P>
<PRE>      Name               Data
   -----------------------------------------------
     MYDLL1             MYDLL.DLL
     MYDLL2             MYREALDLL2.DLL

</PRE></OL>When a string value for a 32-bit DLL exists, the new search order in the
Windows system directory is as follows:

<OL><P><LI>If MYDLL1.DLL is passed to LoadLibrary, the Registry key MYDLL1 is used
   to load MYDLL.DLL.

<P><LI>If the DLL name specified in the data value, MYDLL.DLL for example,
   cannot be found, LoadLibrary on MYDLL1.DLL will fail and a call to
   GetLastError will return error 2 "The system cannot find the file
   specified".

<P><LI>If MYDLL.DLL or MYDLL is passed to LoadLibrary, the normal search
   pattern is used to locate and load MYDLL.DLL.
<P>
</OL>Following are ways that this DLL string value can be added to the Registry:

<UL><LI>An end user can use Regedit.exe to add the 32-bit DLL string value to
   the KnownDLLs Registry key.
<P>
   -or-

<LI>The 32-bit DLL string value can be added programmatically to the
   Known32DLLs Registry key using Registry APIs.
<P>
</UL>To revert back to the default search pattern, the Registry key must be
removed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: search path loadlibrary win95 order<BR>
KBCategory: kbenv kbusage kbprg<BR>
KBSubcategory: BseDll
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
