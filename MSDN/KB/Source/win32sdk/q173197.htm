

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ResetDC Disables Duplex Printing on PCL Printers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173197">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1997/08/27">
<META NAME="Keywords" CONTENT="GdiDc GdiPrn">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When you call ResetDC to change any printer setting, it appears to disable Duplex (double-sided) printing when the target printer is a Hewlett Packard PCL printer.  CAUSE =====  PCL printers treat a change in paper size as a new print job that requ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAGI,QACT,QBWA,QAYV,QDL9,QBWO,QBWN,QAIF,QAY5,QALQ,QBXS,QA4P,QBXV,QAAL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ResetDC Disables Duplex Printing on PCL Printers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173197</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows NT 4.0
   - Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you call ResetDC to change any printer setting, it appears to disable
Duplex (double-sided) printing when the target printer is a Hewlett Packard
PCL printer.
<P>
<P><h2>CAUSE</h2>
 
<P>
PCL printers treat a change in paper size as a new print job that requires
the printer to be initialized. This causes the printer to eject any page
that is currently in the printer. The PCL printer drivers for Windows
assume that the page size has been changed when ResetDC is called, unless
the orientation of the page has changed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent having a page ejected when you call the ResetDC function, make
sure that the function is called only between individual sheets of paper.
Calling the ResetDC function before printing odd-numbered pages is
sufficient for most applications that use duplex printing. However, some
applications require that you change the page orientation on a page-by-page
basis. In this case, you can call ResetDC between individual sheets of
paper if the orientation has changed.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Note that when this problem occurs the print job continues and the sheets
of paper are passed through the printer's duplexer, but the sheets are only
printed on one side.
<P>
Because of the page size initialization requirement for PCL printers,
Windows PCL drivers treat the ResetDC function differently. These drivers
allow only the orientation to change between the front and back pages of a
sheet of paper. This means that ResetDC will eject the page unless the
orientation (and only the orientation) has changed from the previous page.
Calling ResetDC with a DEVMODE buffer that has not changed causes the
printer to eject the page.
<P>
In general, you should only call ResetDC when printer settings change.
Calling ResetDC for every page when the DEVMODE buffer has not changed is
unnecessary. By doing so, you risk having a page ejected from the printer,
which has a high probability of occurring.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: fail bug<BR>
Keywords          : GdiDc GdiPrn<BR>
Version           : WINDOWS:95; WINDOWS NT:4.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
