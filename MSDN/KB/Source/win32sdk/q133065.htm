

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining Connected Joysticks Under Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133065">
<META NAME="KBModify" CONTENT="1995/07/25">
<META NAME="KBCreate" CONTENT="1995/07/24">
<META NAME="Keywords" CONTENT="kbmm">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The joystick API joyGetNumDevs() behaves differently on Windows 95 than it does in other implementations, so a different technique, involving joyGetPosEx(), is required to determine the number of joysticks available during game play.  This article ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAKC,QDJN,QAG8,QBC6,QBXE,QAI5,QADK,QDL9,QBWQ,QBWO,QBWN,QAU9,QAA1,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Determining Connected Joysticks Under Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133065</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The joystick API joyGetNumDevs() behaves differently on Windows 95 than it
does in other implementations, so a different technique, involving
joyGetPosEx(), is required to determine the number of joysticks available
during game play.
<P>
This article provides the code for a function called JoysticksConnected()
that demonstrates how to determine the number of connected joysticks.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Under Windows 95, the joyGetNumDevs() API returns: 0 if no joystick drivers
have been installed or 16 (the highest possible number of connected
joysticks) in all other cases. This behavior is by design. To determine the
actual number of joysticks installed, use the joyGetPosEx() API.
<P>
The design for Windows 95 joystick drivers calls for the driver to
support two independent joystick input devices. Therefore, during driver
installation, two registry keys are created, and initialized. The keys
correspond to joystick 0 and joystick 1, respectively.
<P>
If no joystick support is available (no drivers), joyGetNumDevs() returns
0.
<P>
When joyGetNumDevs() returns a non-zero value, joyGetPosEx() returns
JOYERR_NOERRROR or JOYERR_PARMS (defined in the file MMSYSTEM.H). You can
examine the return values and determine the number of joysticks connected
as shown below. NOTE: when linking, WINMM.LIB must be from the Win32 SDK:
<P>
<PRE>   int JoysticksConnected( )
   {
   // determine number of joysticks installed in Windows 95

      JOYINFOEX info;      // extended information

      int njoyId = 0;      // first joystick

      int nConnected = 0;  // goal - number of joysticks connected

      MMRESULT dwResult;   // examine return values

   // Loop through all possible joystick IDs until we get the error
   // JOYERR_PARMS. Count the number of times we get JOYERR_NOERROR
   // indicating an installed joystick driver with a joystick currently
   // attached to the port.

      while ((dwResult = joyGetPosEx(njoyId++,&amp;info)) != JOYERR_PARMS)

      if (dwResult == JOYERR_NOERROR)
         ++nConnected;    // the count of connected joysticks

      return nConnected;  // return the count of joysticks found

   } // JoysticksConnected
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 JOYERR connect kbinf<BR>
KBCategory: kbmm<BR>
KBSubcategory: MMJoy<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 25, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
