

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Trusted DDE Shares </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128125">
<META NAME="KBModify" CONTENT="1995/09/29">
<META NAME="KBCreate" CONTENT="1995/03/27">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  To allow someone else to connect to DDE shares when you are logged in, you have to trust your existing DDE share. The reason is that when the other person connects to the share remotely, the application he will connect to is running in your securit...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3A,QAZ2,QAGU,QAI5,QA0K,QATQ,QBWS,QAK7,QDNQ,QBG2,QBVV,QAHT,QAA1,QBWP,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Trusted DDE Shares</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128125</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT version 3.5
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To allow someone else to connect to DDE shares when you are logged in, you
have to trust your existing DDE share. The reason is that when the other
person connects to the share remotely, the application he will connect to
is running in your security context, not the remote user's, because you are
the logged-on user. You need to give permission for the other person to
access the share. Even another person who is an administrator cannot trust
a share for your account.
<P>
In your code, you would use NDdeShareAdd() to create the share and
NDdeSetTrustedShare() to trust the share.
<P>
Alternatively, you can use DDESHARE to create the share. For more
information on DDESHARE, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q114089.htm">Q114089</A></B>
   TITLE     : Using the Windows NT NetDDE Share Manager

</PRE>If you have a DDE share that always needs to be available, you can write
a program that trusts the specific shares and sets up a logon script
to trust the share for every user. The logon script should be a .BAT
file that calls the .EXE file, so that you can add other things to the
logon script as necessary.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The online documentation for NDdeSetTrustedShare says:
<P>
<PRE>   The NDdeSetTrustedShare function is called to promote the
   referenced DDE share to trusted status within the current
   user's context.

</PRE>DDE shares are a machine resource, not an account resource, just as
shared drives are. However, NetDDE runs an application that must run
in the context of the current user. This is the reason that the share
must be trusted, so that the application can run in the user's context.
<P>
The prototype for the function is:
<P>
<PRE>   UINT NDdeSetTrustedShare(lpszServer, lpszShareName, dwTrustOptions)

</PRE>The parameter lpszServer is the address of the server name on which the
DDE share resides. The DDE Share Database (DSDM) will be modified. This
service manages the shared DDE conversations and is used by the NetDDE
service. This parameter will generally be the current machine, because
you can't trust a share for someone else.
<P>
The dwTrustOptions are NDDE_TRUST_SHARE_START and NDDE_TRUST_SHARE_INIT.
NDDE_TRUST_SHARE_START allows the DDE server, such as Excel, to be
started in the user's context. This allows a DDE client to make a NetDDE
connection without the DDE server already running. When the NetDDE agent
on the server machine detects the attempted connection, it launches the
associated DDE server application if it is not already running.
<P>
NDDE_TRUST_SHARE_INIT allows a client to initiate to the DDE server if it
is already executing in the user's context. This allows a DDE client to
make a NetDDE connection to a DDE server already running on the server
machine. If the DDE server is not already running, the connection will
fail.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrNetDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
