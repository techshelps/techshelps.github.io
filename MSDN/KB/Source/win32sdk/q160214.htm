

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: 32-bit Font Files Not Recognized by Windows 95 Shell </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160214">
<META NAME="KBModify" CONTENT="1996/12/04">
<META NAME="KBCreate" CONTENT="1996/12/02">
<META NAME="Keywords" CONTENT="kbprg kbgraphic kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When you try to install a 32-bit Portable Executable (PE) font resource file in Windows 95 version 4.0 via the fonts folder, the installation fails and Windows 95 displays an error message indicating that the font is not a valid font file. Also, at...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QBWQ,QDL9,QBWO,QBWN,QAIM,QDNF,QAA1,QDI2,QBVV,QABA,QBIC,QA6A,QDIR,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 32-bit Font Files Not Recognized by Windows 95 Shell</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160214</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API)
   for Windows 95, version 4.00
   on the following platform: Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to install a 32-bit Portable Executable (PE) font resource
file in Windows 95 version 4.0 via the fonts folder, the installation fails
and Windows 95 displays an error message indicating that the font is not a
valid font file. Also, attempts to view the font file by double-clicking
the file produce the same message.
<P>
<P><h2>CAUSE</h2>
 
<P>
The fonts folder in the Windows 95 shell does not recognize 32-bit PE font
file resources.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Although the fonts folder in the Windows 95 shell does not recognize font
resources that are in the 32-bit PE format, the operating system does. A 32-
bit PE font resource can be installed into Windows 95 programmatically.
This is accomplished by calling the AddFontResource function, updating the
Registry, and broadcasting a notification message to inform other apps that
a font has been installed. These procedures are documented in the
Installing Fonts section of the Guide to Programming Windows 95 in the
Win32 SDK and the Knowledge Base articles in the REFERENCES section below.
<P>
Also, 32-bit PE font resources may cause a General Protection Fault in
Windows 95 version 4.0 under certain circumstances. Please see The
REFERENCES section in this article for further details. Microsoft
recommends that Windows 95 applications that ship font resources use 16-bit
font resource files. Shipping 16-bit font resources will avoid the 32-bt PE
font file bugs in Windows 95 and will have the added benefit of being
portable if you design your application for Win32s.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on subjects discussed above, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q100487.htm">Q100487</A></B>
   TITLE     : Use 16-Bit .FON files for Cross-Platform Compatibility

   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q137882.htm">Q137882</A></B>
   TITLE     : BUG: 32-Bit .FON files Causes GP Fault with Standard VGA
               Driver

   ARTICLE-ID: <B><A HREF="../WIN16SDK/Q76535.htm">Q76535</A></B>
   TITLE     : SAMPLE: Creating a Custom Raster Font
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb kbgraphic kbprb<BR>
KBSubcategory: GdiFnt<BR>
Additional reference words: 4.00 KbDSI
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
