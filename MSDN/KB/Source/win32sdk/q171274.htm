

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: ADDITIVE Keyword Does Not Work in Custom .ADM Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171274">
<META NAME="KBModify" CONTENT="1997/07/11">
<META NAME="KBCreate" CONTENT="1997/07/10">
<META NAME="Keywords" CONTENT="BseRegistry kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Resource Kit for Windows 95 and the Platform SDK document how to create custom .ADM files that can be used with the System Policy Editor (POLEDIT.EXE) under the Windows 95 and Windows NT platforms. This documentation refers to the ADDITIVE keyw...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJX,QAVW,QAVX,QAKD,QBVR,QDIF,QBWP,QAEY,QBKX,QAHD,QAP2,QAKC,QBVV,QAL0,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ADDITIVE Keyword Does Not Work in Custom .ADM Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171274</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Resource Kit for Windows 95 and the Platform SDK document how to create
custom .ADM files that can be used with the System Policy Editor
(POLEDIT.EXE) under the Windows 95 and Windows NT platforms. This
documentation refers to the ADDITIVE keyword that you can use to add values
to the System Registry via a list box entry in the Policy Editor. The
ADDITIVE keyword is documented as follows:
<P>
<PRE>   ADDITIVE
   If specified, values set in the list box are added to whatever values
   exist in the target Registry entry. Existing values are not deleted; by
   default, the content of list boxes will "override" whatever values are
   set in the target Registry. Specifically, a control value is inserted in
   the policy file which causes existing values to be deleted before the
   values set in the policy file are merged.

</PRE>When you use the ADDITIVE keyword in a custom .ADM file in Windows NT 4.0,
it does not add values to the target registry entry. Instead it replaces
all the old values with the new value specified in the list box entry. In
addition, even if no changes are made, any binary data type in the registry
key is replaced by a string data type.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not use the ADDITIVE keyword while creating custom .ADM files to be used
by the Policy Editor.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the System Policy Editor
(POLEDIT.EXE) component of the Microsoft products listed at the beginning
of this article. We are researching this bug and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Below is a sample TEST.ADM file that reproduces the problem with the
ADDITIVE keyword. This .ADM file will modify the following key in the
Registry:
<P>
<PRE>  "Software\Microsoft\WindowsNT\CurrentVersion\Winlogon\System".

</PRE>The existing value for this registry key is probably "lsass.exe" or
"lsass.exe spoolss.exe". When the following .ADM file is used with the
System Policy Editor, it allows the user to append any string, say
"TEST.EXE" to the existing value. The final value for this registry key
should then be "lsass.exe TEST.EXE" or "lsass.exe spoolss.exe TEST.EXE"
depending on what the value was before the modification.
<P>
<PRE>     CLASS MACHINE
     CATEGORY "SYSTEM Startup Programs"
       POLICY "Execute My TEST Program in system context"
         KEYNAME "Software\Microsoft\Windows NT\CurrentVersion\Winlogon"
         PART "Add Entry"
             LISTBOX EXPLICITVALUE ADDITIVE
         END PART
       END POLICY
     END CATEGORY


</PRE><h3>Steps to Reproduce the Problem</h3>
 

<OL><P><LI>First, save your original WINLOGON key by exporting it to a .REG file
   using the Registry Editor (REGEDTI.EXE).

<P><LI>Add the above TEST.ADM file into the System Policy Editor along
   with WINNT.ADM and COMMON.ADM.

<P><LI>Inside the Policy Editor, open the Registry and select the "Execute
   Custom Program" option listed in the TEST.ADM file above. Add a string
   like "TEST.EXE" which should be added to the existing value of the
   Winlogon registry key. Close the Policy Editor saving your changes to
   the Registry.

<P><LI>Open the Registry Editor and check the Winlogon registry key to see if
   "TEST.EXE" was appended to the key.  You will notice that this key only
   contains "TEST.EXE", and that the original values have been deleted.

<P><LI>To restore the Registry back to normal, double-click the .REG file
   created in Step 1.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
The Template file format for .ADM files is documented in the following
places:

<UL><LI>Windows 95 Resource Kit under the section User Profiles and System
   Services, System Policies

<LI>Platform SDK documentation under the section Setup and Systems
   Management Services, System Policies
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: poledit winnt<BR>
Keywords            : BseRegistry kbprg<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
