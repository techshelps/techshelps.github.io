

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD:Macro to Select Envelope Return Address from AutoText Entries </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81171 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/02/27">
<META NAME="Keywords" CONTENT="kbenvelope kbmacroexample macword ntword winword word6 word7 word95 wordnt kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The Create Envelope command in Microsoft Word allows you to specify a  mailing address and return address for an envelope. In certain situations,  you may want to choose from several return addresses. This article includes  a macro that displays Au...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJN,QAIH,QAR5,QDJF,QAH4,QBJZ,QBWS,QBE7,QBE6,QAY2,QAUR,QAG2,QA2Q,QBML,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD:Macro to Select Envelope Return Address from AutoText Entries</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81171 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Create Envelope command in Microsoft Word allows you to specify a 
mailing address and return address for an envelope. In certain situations, 
you may want to choose from several return addresses. This article includes 
a macro that displays AutoText entries from which you can select a return 
address.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web: 
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B> 

</PRE>The first few lines of the macro determine how many AutoText entries you
want to choose from and what their names are. You should customize the Dim
Combobox1$(x) line by substituting the correct number of AutoText entries 
for "x," and you should insert the correct number of combobox1$(X) ="" 
entries for each AutoText entry that you want listed.
<P>
<P><h3>Word versions 6.x, 7.x</h3>
 

<OL><P><LI>On the Tools menu, choose Macro.

<P><LI>Select Normal.dot (Global Template) from the Macros Available In list.
   In the Macro Name box, type "ToolsCreateEnvelope" (without the quotation
   marks), and click Create.

<P><LI>Change the text of the ToolsCreateEnvelope macro to read as follows:
<P>
<PRE>   Sub MAIN
      Dim Combobox1$(2)
      combobox1$(0) = "HomeAddress"
      combobox1$(1) = "Business"
      combobox1$(2) = "Other"
      Begin Dialog UserDialog 320, 144, "Microsoft Word"
         ComboBox 10, 6, 160, 108, ComboBox1$(), .ComboBox1
         OKButton 211, 23, 88, 21
         CancelButton 211, 47, 88, 21
      End Dialog
      Dim dlg As UserDialog
      dlg.combobox1 = combobox1$(0)
      x = Dialog(dlg)
      If x = 0 Then Goto theend
      Dim dlg2 As ToolsCreateEnvelope
      GetCurValues dlg2
      a$ = GetAutoText$(dlg.combobox1)
      dlg2.EnvReturn = a$
      n = Dialog(dlg2)
      If n &lt;&gt; 0 Then ToolsCreateEnvelope dlg2
   theend:
   End Sub

</PRE><P><LI>Press CTRL+F4 to close the macro-editing window. (Press COMMAND+F4 on 
   the Macintosh). Click Yes when prompted to save changes to 
   Global:ToolsCreateEnvelope.

<P><LI>On the File menu, click Save All. (If you are prompted to save
   changes to Normal.dot, click Yes.)

<P><LI>Create AutoText entries named "HomeAddress," "Business," and "Other."
<P>
</OL>When you run the above macro, a dialog box prompts you to select an
AutoText entry name. Select an entry and click OK. The contents of the
AutoText entry are inserted into the Return Address edit box.
<P>
<P><h3>Word 2.x</h3>
 

<OL><P><LI>From the Tools menu, choose Macro.

<P><LI>Under Show, select Global Macros. In the Macro Name box, type
   "ToolsCreateEnvelope" (without the quotation marks), and click Edit.

<P><LI>Change the text of the ToolsCreateEnvelope macro as in step 3 of the
   Word 6.x, 7.x procedure above, except change the following macro
   command
<P>
<P><PRE>      a$ = GetAutoText$(dlg.combobox1)
</PRE><P>
   to:
<P>
<P><PRE>      a$ = GetGlossary$(dlg.combobox1)
</PRE>
<P><LI>Press CTRL+F4 to close the macro-editing window. (Press COMMAND+F4 on 
   the Macintosh). Click Yes when prompted to keep the changes to 
   Global:ToolsCreateEnvelope.

<P><LI>On the File menu, click Save All. Click Yes when prompted to save global 
   glossary and command changes.

<P><LI>Create glossary entries named "HomeAddress," "Business," and "Other."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, pages 165, 174,
228
<P>
"Microsoft Word for Windows and OS/2 Technical Reference," pages 143,
150, 192
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: tool bar toolbar winword2<BR>
Keywords          : kbenvelope kbmacroexample macword ntword winword word6 word7 word95 wordnt kbmacro<BR>
Version           : WINDOWS:2.0,2.0a,2.0a-CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.6.0.1a<BR>
Platform          : MACINTOSH Win95 WINDOWS winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
