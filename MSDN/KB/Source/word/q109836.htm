

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Macro to Check for Multiple Instances of Word </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109836">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You start Word when another instance of Word is already running, but you get no message to that effect.  CAUSE =====  In Microsoft Windows, if a share program such as SHARE.EXE, VSHARE.386, or any other share utility is in use, multiple instances o...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QBWS,QDL9,QBWO,QBWN,QAGB,QAJZ,QBJZ,QABH,QABI,QDO7,QAF3,QAIJ,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Macro to Check for Multiple Instances of Word</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109836</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Windows operating system versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You start Word when another instance of Word is already running, but you
get no message to that effect.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Microsoft Windows, if a share program such as SHARE.EXE, VSHARE.386, or
any other share utility is in use, multiple instances of the same program
can be run at the same time. You cannot configure Word to prevent this from
occurring.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The follow macro, when named AUTOEXEC, will check to see if any other
instances of Word are running and if so, will then give you the option of
closing one instance or allowing a new instance.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this macro code "as is" without
warranty of any kind, either express or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.

<OL><P><LI>On the Tools menu, click Macro.

<P><LI>In the Macro Name text box, type "AutoExec" (without the quotation
   marks).

<P><LI>Be sure the Macros Available In list box displays NORMAL.DOT.

<P><LI>Click the Create button.

<P><LI>Type the following macro:
<P>
<PRE>Sub MAIN
     On Error Goto bye
     Dim ListBox1$(1)
     count = 0
     Text$ = "There is currently another instance of Word for Windows \
</PRE></OL>running . Please choose the instance you wish to Close Or choose Cancel \
to run both instances ."
<PRE>     size = AppCount() - 1
     Dim winnames$(size)
     AppGetNames winnames$()
     For i = 0 To size
      If InStr(1, winnames$(i), "Microsoft Word") Then
       count = count + 1
       ListBox1$(count - 1) = winnames$(i)
      End If
      If count &gt; 1 Then
       Begin Dialog UserDialog 322, 174, "Microsoft Word"
        OKButton 222, 121, 88, 21
        CancelButton 222, 147, 88, 21
        ListBox 10, 70, 300, 45, ListBox1$(), .ListBox1
        Text 10, 6, 300, 60, text$, .Text1
       End Dialog
       Dim dlg As UserDialog
       If Dialog(dlg) = - 1 Then
        AppClose(ListBox1$(dlg.ListBox1))
       End If
       i = size
      End If
     Next
bye:       '&lt;-- This line MUST be left aligned
    End Sub

</PRE>NOTE: In the macro above, the continuation character "\" is not necessary
if the text is typed without a carriage return at the end of the line.

<OL><P><LI>On the File menu, click Save All, and click Yes when prompted to
   save changes to the AutoExec macro.

<P><LI>Exit Word.
<P>
</OL>To test the macro, restart Word and then start a second instance of Word.
You should receive a dialog box stating there are two instances of Word for
Windows running. It will allow you to 1) choose one instance to close, or
2) choose Cancel to allow both applications to run simultaneously.
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 6.0 6.0a 6.0c 7.0 word95 copies copy two<BR>
word7 word6 winword determine<BR>
Version           : 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
