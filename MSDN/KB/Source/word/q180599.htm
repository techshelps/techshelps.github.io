

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD97:How to Use Query to Merge Two Excel Files for Data Source </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180599">
<META NAME="KBModify" CONTENT="1998/02/26">
<META NAME="KBCreate" CONTENT="1998/02/05">
<META NAME="Keywords" CONTENT="kbmerge kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The information in this article describes how to use Microsoft Query to merge two Excel 97 files. You may want to do this so that you can combine related information into a single file and use it in a mail merge.  MORE INFORMATION  Merging two Exce...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALI,QDME,QBI0,QBWS,QBVP,QBJZ,QAYY,QAIH,QAK6,QA2Q,QBTS,QBRG,QAUJ,QA7O,QA7N P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97:How to Use Query to Merge Two Excel Files for Data Source</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180599</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Query for Windows 95, version 8.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The information in this article describes how to use Microsoft Query to
merge two Excel 97 files. You may want to do this so that you can combine
related information into a single file and use it in a mail merge.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Merging two Excel files allows you to combine related information into a
single file.
<P>
Note that there are a number of other ways to create a mail merge data
source. For more information about mail merge data sources, click Contents
And Index on the Help menu, click the Index tab in Word Help, type the
following text
<P>
<PRE>   mail merge, data sources

</PRE>and then double-click the selected text to go to the "mail merge data
sources" topic. If you are unable to find the information you need, ask the
Office Assistant.
<P>
<P><h2>EXAMPLE: MERGING TWO EXCEL FILES</h2>
 
<P>
One file could contain a list of ID numbers, first names, last names, and
positions, while another file could contain a list of ID numbers,
addresses, and salaries.
<P>
If the ID numbers in both files are the same, you can link the two files by
using the similar ID field. This allows you to create a mail merge that
contains contain the ID numbers, first names, last names, addresses,
positions, and salaries. To put the files together inside Microsoft Query
they need to be in the correct format in Excel. Each column of information
needs to have a heading name (do not use spaces, quotation marks,
apostrophes, or hyphens in the heading name).
<P>
Here are two sample Excel files. In File1, cell A1 contains the word
IDNumber, cell B1 contains the word Firstname, cell C1 is Lastname, and
cell D1 is Position. In File2, cell A1 contains the word IDNumber, cell B1
is Address, and cell C1 is Salary.
<P>
File1:
<P>
<PRE>   A1: IDNumber B1: Firstname C1: Lastname   D1: Position
   A2: 1        B2: James     C2: Jones      D2: Clerk
   A3: 2        B3: Harry     C3:  Anderson  D3: Administration

</PRE>File2:
<P>
<PRE>   A1: IDNumber   B1: Address        C1:  Salary
   A2: 1          B2: 333 3rd Ave.   C2: $20,000
   A3: 2          B3: 444 4th St.    C3: $25,000

</PRE>The IDNumber column in File1 should be similar to the IDNumber column in
File2. That is, the column heading should be the same and the information
in File1 should correspond to the information in File2. That is, IDNumber 1
should represent the same employee in both sheets. That is James Jones
(IDNumber 1 in File1) should live at 333 3rd Ave (IDNumber 1 in File 2).
When you connect the two files using Microsoft Query, you can retrieve all
of the information about James Jones into a single data source.
<P>
<P><h3>Modifying the Files in Excel</h3>
 
<P>
After the files have been created, name the ranges of information in each
sheet. To do this, follow these steps:

<OL><P><LI>Start Microsoft Excel.

<P><LI>Open the first workbook and select the sheet that contains the
   information you want to use in the mail merge. Select the portion of the
   file containing the text.

<P><LI>On the Insert menu, point to Name, and then click Define. Type a name
   and click OK.

<P><LI>Save the file.

<P><LI>Repeat steps 1-4 for the second file. (Be sure to save the files in the
   same directory.)

<P><LI>Close Excel.
<P>
</OL>After modifying the files in Excel, you can start the mail merge in Word.
<P>
<P><h3>Starting the Mail Merge</h3>
 
<P>
To start the mail merge, follow these steps:

<OL><P><LI>Open Word.

<P><LI>On the File menu, click New, and then click OK.

<P><LI>On the Tools menu, click Mail Merge.

<P><LI>Click Create, click Form Letters, and click Active Window.
<P>
</OL>Now you're ready to create the Data Source.
<P>
<P><h3>Creating a Microsoft Query Data Source</h3>
 
<P>
To create the Microsoft Query Data Source, follow these steps:

<OL><P><LI>In the Word Mail Merge Helper, click Get Data, and click Create Data
   Source. Click the MS Query button.

<P><LI>With &lt;New Data Source&gt; selected, click to select the "Use the Query
   Wizard to create/edit queries" check box, and click OK.

<P><LI>Type any name for your data source.

<P><LI>Under Select A Driver, select Microsoft Excel Driver (*.xls).

<P><LI>Click Connect.

<P><LI>Select the Database Version (for example, Excel 97), and click Select
   Workbook.

<P><LI>Locate and select the first Excel file, and click OK to return to the
   Choose Data Source dialog box.
<P>
</OL><h3>Creating the Query</h3>
 
<P>
To create the query, follow these steps:

<OL><P><LI>Your newly created data source should be highlighted in the Choose Data
   Source dialog box. If not, select it, and then click OK.

<P><LI>In the "Query Wizard - Choose Columns" dialog box, under Available
   Tables And Columns, double-click the named range that appears.
<P>
   This will reveal your column titles.

<P><LI>One at a time, select the column names you want to use to create the
   mail merge data source and click the "&gt;" button (note that you must
   select a field that both sheets have in common--in this case IDNumber).

<P><LI>Click Next twice (to ignore filtering and sorting).

<P><LI>Select the "View Data Or Edit Query In Microsoft Query" option and click
   Finish.
<P>
</OL>Microsoft Query will be started and the information from the first Excel
file will be available.
<P>
<P><h3>Adding the Second File and Joining the Data in Microsoft Query</h3>
 
<P>
To join the data in Microsoft Query, follow these steps:

<OL><P><LI>In Microsoft Query, click Add Tables on the Table menu.

<P><LI>At the bottom of the Add Tables dialog box, next to Workbook, select the
   other Excel file you want to use in the merge. (Note that this file must
   be located in the same directory as the file you added in the Query
   Wizard.)

<P><LI>Click Add and then click Close.

<P><LI>In the first Excel table, click the field you want to join (for example,
   the IDNumber field) and drag the pointer to the similar field in the
   second Excel table.
<P>
   A join line should appear.
<P>
   NOTE: Some field names may appear in the query pane (the big white
   rectangle under the tables). You can use these fields, or you can delete
   each one by positioning the insertion point over the field name until a
   down arrow is displayed. To delete the field, click to select the
   column, and press DELETE.
<P>
</OL><h3>Selecting the Fields You Want to Use in the Mail Merge</h3>
 
<P>
To select the fields you want to use in the mail merge, follow these steps:

<OL><P><LI>In the first table, click the first field name that you want to use.

<P><LI>Drag the field name to the query pane.

<P><LI>Repeat steps 1-2 for each field that you want to use.

<P><LI>On the File menu, click Return Data To Microsoft Word.
<P>
</OL>Word for Windows will then prompt you to Edit Your Main Document.
<P>
<P><h3>Creating the Mail Merge Main Document</h3>
 
<P>
To create the mail merge main document, follow these steps:

<OL><P><LI>When you receive the "Word found no merge fields in your main
   document..." message, click Edit Your Main Document.
<P>
   The merge fields from both Excel files are now available on the Insert
   Merge Field button on your mail merge toolbar.

<P><LI>To insert the merge fields in your document, click the Insert Merge
   Field on the mail merge toolbar.

<P><LI>On the Tools menu, click Mail Merge.

<P><LI>Click the Merge button.

<P><LI>Click the Merge button to merge to a new document.
<P>
</OL>The merged data should include information from both Excel tables.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WORD/Q142756.htm">Q142756</A></B>
   TITLE     : WD: How to Design and Set Up Mail Merge Data Sources

   ARTICLE-ID: <B><A HREF="../WORD/Q155179.htm">Q155179</A></B>
   TITLE     : WD: How to Use a Microsoft Excel Data Source for Word Mail
               Merge

   ARTICLE-ID: <B><A HREF="../WORD/Q159817.htm">Q159817</A></B>
   TITLE     : WD97: Can't Connect, Insert Database with ODBC and MSQuery

   ARTICLE-ID: <B><A HREF="../WORD/Q141922.htm">Q141922</A></B>
   TITLE     : WD: How to Start a Mail Merge
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: options DDE<BR>
Keywords          : kbmerge kbinterop<BR>
Version           : WINDOWS:8.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
