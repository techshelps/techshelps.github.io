

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLE Automation: Using Functions That Return Strings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105683">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1993/10/22">
<META NAME="Keywords" CONTENT="kbole kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use Microsoft WordBasic functions in Visual Basic, keywords that return strings--that is, keywords that end in a dollar sign ($)-- must be enclosed in square brackets or an error message will occur.  Example 1 ---------  The following Word...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA5F,QAIH,QAUD,QA01,QAB9,QBV8,QAY5,QALZ,QAB4,QATX,QAK4,QAMA,QA4N,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OLE Automation: Using Functions That Return Strings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105683</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use Microsoft WordBasic functions in Visual Basic, keywords
that return strings--that is, keywords that end in a dollar sign ($)--
must be enclosed in square brackets or an error message will occur.
<P>
<P><h3>Example 1</h3>
 
<P>
The following WordBasic instruction returns the current date:
<P>
<PRE>   a$ = Date$()

</PRE>In Visual Basic, the same instruction is specified as follows:
<P>
<PRE>   worddate = WordObj.[Date$]()

</PRE>The following Visual Basic example uses Word's Date$() function to
post the current date in a message box:
<P>
Dim WordObj As Object
Dim worddate As String
Set WordObj = CreateObject("Word.Basic")
worddate = WordObj.[Date$]()
MsgBox worddate
<P>
If you omit the square brackets that surround "Date$", Visual Basic
will post the following error message:
<P>
<PRE>   Identifier can't end with type-declaration character

</PRE><h3>Example 2</h3>
 
<P>
The following WordBasic instruction shows the GetBookmark$() function
as it might appear in a WordBasic macro:
<P>
<PRE>   mark$ = GetBookmark$("Address")

</PRE>In Visual Basic, the same instruction would be specified as follows:
<P>
<PRE>   mark$ = WordObj.[GetBookmark$]("Address")

</PRE>The following Visual Basic procedure opens the Word document TEST.DOC,
and then uses the WordBasic GetBookmark$() function to return the
text of the "Address" bookmark in a message box:
<P>
<PRE>Sub Command1_Click ()
</PRE>Dim WordObj As Object
Dim Mark As String
Set WordObj = CreateObject("Word.Basic")
WordObj.FileOpen "D:\WinWord6\Test.doc"
Mark = WordObj.[GetBookmark$]("Address")
MsgBox Mark
<PRE>End Sub


</PRE><h2>More Information</h2>
 
Visual Basic 4.x does not require the square backets "[ ]".  They can
however be used, as with VB3, without modification.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory:  kbmacro<BR>
KBSubcategory:<BR>
Additional query words: 6.0 ole automation word basic word6 word7<BR>
6.0a 6.0c 7.0 word95 object visual basic dollar sign brackets function<BR>
return winword<BR>
Keywords          : kbole kbmacro<BR>
Version           : 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
