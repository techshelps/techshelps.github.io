

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"File in Use by Another Program" After OLE Automation Session </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105410">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="kbole">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you run an OLE 2.0 automation session in which you create a WordBasic object in a client application (such as Microsoft Visual Basic version 3.0) that accesses Word for Windows as a server, the following error message may occur in the next sessi...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAKR,QAHE,QA2K,QABA,QDL9,QBWO,QBWN,QDO7,QA5F,QBWS,QBWQ,QAN1,QBXS,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>"File in Use by Another Program" After OLE Automation Session</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105410</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0
<LI>Microsoft Windows operating system version 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you run an OLE 2.0 automation session in which you create a
WordBasic object in a client application (such as Microsoft Visual
Basic version 3.0) that accesses Word for Windows as a server, the
following error message may occur in the next session of Word when you
try to save your NORMAL.DOT file:
<P>
<PRE>   This file is in use by another application or user.
   (&lt;path&gt;\NORMAL.DOT)

</PRE><h2>CAUSE</h2>
 
<P>
The Word command line in your Windows REG.DAT file does not include
the /Automation switch. Specifically, in the CLSID key, under the WordBasic
(WordBasic) Class ID key, the LocalServer key value must
include the /Automation switch. If this switch is missing, the OLE 2.0
Automation (OLE Auto) transaction launches a session of Word that is
not completely removed from memory when you close Word. In other
words, it remains in memory as a "ghost" Word session. As a result,
the file handle to the NORMAL.DOT file remains open, and this prevents
you from saving NORMAL.DOT in a later Word session.
<P>
The "ghost" Word session does not appear in the Windows Task List. The
only way to close it is to exit and restart Windows.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Save your NORMAL.DOT file to a different name such as NORMAL.OLD, then
exit Word. Exit and restart Windows. If necessary, you can rename
NORMAL.OLD to NORMAL.DOT. Then resolve this problem using the steps in
the Resolution section below.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use one of the following methods to add the /Automation switch to
your REG.DAT file.
<P>
<P><h3>Method 1: Merge WINWORD6.REG Registration File</h3>
 
<P>
Note: The WINWORD6.REG file contains information based on the options
you chose when you originally set up Word. If the location of
WINWORD.EXE or any of the OLE applications supplied with Word has
changed since you first installed Word, the WINWORD6.REG file will not
correctly update your registration information. In this case, you
should use Method 2 below instead.

<OL><P><LI>In Windows File Manager, open your Word 6.0 program directory
   (the default is WINWORD6).

<P><LI>In the Word 6.0 program directory, select the WINWORD6.REG file.

<P><LI>From the File menu, choose Run and then choose OK.
<P>
   -or-
<P>
   Double-click the WINWORD6.REG file.

<P><LI>The following message should appear in a Registration Info Editor
   dialog box:
<P>
   Information in &lt;drive and path&gt;\WINWORD6.REG has been
   successfully registered in the registration database.
<P>
</OL><h3>Method 2: Manually Edit the REG.DAT File</h3>
 
<P>
Use the following instructions to add the /Automation switch to your
REG.DAT file:

<OL><P><LI>In Windows Program Manager, choose Run from the File menu.

<P><LI>Type "REGEDIT /v" (without the quotation marks) and then choose OK.

<P><LI>From the Search menu, choose Find Key.

<P><LI>In the Find What box, type "\CLSID" (without the quotation marks)
   and then choose OK.

<P><LI>Under the CLSID key, locate the WordBasic Class ID key, which
   appears as follows:
<P>
<P><PRE>      \
      |-CLSID
       |-{000209FE-0000-0000-C000-000000000046}=WordBasic
<PRE></PRE>        |-AutoConvertTo &lt;optional key&gt;
        |-LocalServer=&lt;path&gt;WINWORD.EXE
        |-ProgID=WordBasic

   Note: There may be several other Class ID keys above the WordBasic
   Class ID key, so you may need to scroll through several screens
   to find it.

</PRE><P><LI>Select the LocalServer key.

<P><LI>In the Value box, modify the setting so it appears as follows:
<P>
<P><PRE>      &lt;path&gt;WINWORD.EXE /Automation
</PRE>
<P><LI>After you add the /Automation switch to the LocalServer value,
   the WordBasic Class ID key should appear as follows:
<P>
<P><PRE>      \
      |-CLSID
       |-{000209FE-0000-0000-C000-000000000046}=WordBasic
<PRE></PRE>        |-AutoConvertTo &lt;optional key&gt;
        |-LocalServer=&lt;path&gt;WINWORD.EXE /Automation
        |-ProgID=Word.Basic

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
By default, the Word Setup program adds the /Automation command line
switch to REG.DAT. If you manually delete this switch, Word does not
restore it the next time you start Word.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: <BR>
KBSubCategory:<BR>
Additional query words: 6.0 object linking embedding wordbasic winword<BR>
word6<BR>
Keywords          : kbole<BR>
Version           : 6.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
