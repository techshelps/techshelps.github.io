

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CopyFile Command Altered by Hide MS-DOS Extension Option </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134808">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="kbmacroexample">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use the WordBasic command, CopyFile, the copy of the file does not have an extension. As a result, the copied file loses its association with Microsoft Word and becomes a generic Windows 95 file. The following code results in this problem:...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAVX,QAVW,QDL9,QBWO,QBWN,QBIC,QBFY,QAH4,QBV8,QABI,QBWQ,QBBI,QAFF,QAOG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>CopyFile Command Altered by Hide MS-DOS Extension Option</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134808</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-cd, 2.0b, 2.0c,
   6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Windows 95 operating system, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the WordBasic command, CopyFile, the copy of the file does not
have an extension. As a result, the copied file loses its association with
Microsoft Word and becomes a generic Windows 95 file. The following code
results in this problem:
<P>
<PRE>   Sub MAIN
   CopyFile "c:\storage\test.doc", "c:\temp"
   End Sub

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when the "Hide MS-DOS file extensions for file types
that are registered" is checked in Windows Explorer. (To locate this
option, in Windows Explorer, click Options on the View menu.)
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Word for Windows
95 version 7.0. This problem was corrected in Word version 7.0a for Windows
95.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, use one of the following methods to preserve
the copied file's association with Microsoft Word.
<P>
Method 1. Make sure the "Hide MS-DOS file extensions for file types that
<PRE>          are registered" option in Windows Explorer is not checked.

</PRE>Method 2. Use the Declare command to make a CopyFileA call to
<PRE>          Kernel32.dll. To do this, use the following macro:

          NOTE: The sample assumes that you have a Microsoft Word document
          called "Test.doc" located in the C:\Storage folder.

          Declare Function CopyFileA Lib "kernel32"(a$ As String, b$ As
          String, n As Integer) As Integer

          Sub MAIN
             x = CopyFileA("c:\storage\test.doc", "c:\temp\test.doc ", 3)
          End Sub

          NOTE: Using a number greater than 0 in the above example will not
          overwrite an existing file. The file specified as the destination
          remains the same. However, if 0 is used, as in the example below,
          the destination file will be overwritten by the specified file if
          it exists in the specified directory.

          Declare Function CopyFileA Lib "kernel32"(a$ As String, b$ As
          String, n As Integer) As Integer

          Sub MAIN
             x = CopyFileA("a:\test.doc", "c:\test.doc ", 0)
          End Sub

</PRE>WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this macro code "as is" without
warranty of any kind, either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage buglist7.0 fixlist7.0a<BR>
KBSubcategory: kbmacroexample
<P>

Additional reference words: 7.0 word95 copyfile copy file wordbasic<BR>
word7 winword word basic macro example 6.0 6.0a 6.0c 7.0 7.0a 2.0<BR>
2.0a 2.0a-cd 2.0b 2.0c
<P>

Keywords          : kbmacroexample<BR>
Version           : 2.x 6.0 6.0a 6.0c 7.0 7.0a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
