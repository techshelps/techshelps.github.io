

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD: Macro Function to Test for Valid Directory Path </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87422 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/07/29">
<META NAME="Keywords" CONTENT="kbmacroexample macword ntword winword word7 word8 word95 word97 macword98 kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you create a macro that attempts to change to an invalid directory path, you may receive either of the following error messages:     Run-time error '76':  Path not found       -or-     Wordbasic error 76:  Path not found   CAUSE =====  Before yo...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAFI,QBXB,QATJ,QAH4,QBFM,QBS0,QAB4,QA5F,QBVV,QAAP,QAVX,QAVW,QAFF,QDO9 P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Macro Function to Test for Valid Directory Path</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87422 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b, 2.0c,
   6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word 97 for Windows
<LI>Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
<LI>Microsoft Word 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create a macro that attempts to change to an invalid directory path,
you may receive either of the following error messages:
<P>
<PRE>   Run-time error '76': "Path not found"

    -or-

   Wordbasic error 76: "Path not found"

</PRE><h2>CAUSE</h2>
 
<P>
Before you switch to a directory using the Microsoft WordBasic or Visual
Basic for Applications ChDir statement, ensure that the directory is valid.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Create macro code to test whether a directory path is valid.
<P>
<P><h3>Visual Basic for Applications</h3>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<PRE>   Sub ChangeDir()
      cdDir = "&lt;Replace with a valid directory path&gt;"
      If Dir(cdDir, vbDirectory) &lt;&gt; "" then
         ChDir cdDir
      Else
         MsgBox "Specified directory is invalid!", vbOKOnly + vbCritical
      End If
   End Sub

</PRE><h3>WordBasic</h3>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this macro code 'as is' without
warranty of any kind, either express or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.
<P>
Word 6.x, 7.x:
<P>
<P>
<PRE>   Sub MAIN
      If CountDirectories("&lt;Replace with a valid directory path&gt;") \
      &gt; - 1 Then
         MsgBox "Directory is valid"
      Else
         MsgBox "Directory is not valid"
      End If
   End Sub

</PRE>NOTE: The Word 6.x for Windows CountDirectories() function returns -1 if
the directory path is not valid.
<P>
Word 2.0:
<P>
<PRE>   Sub MAIN
      On Error Goto errorhandle
      ChDir "&lt;Replace with a valid directory path&gt;"
   errorhandle: ' NOTE: This line must be left aligned.
      If err = 76 Then
         MsgBox "Directory is not valid"
      Else
         MsgBox "Directory is valid"
      End If
   End Sub

</PRE>The On Error statement is used to trap the WordBasic error. If the error
number is 76, then a message box indicates that the path is not valid.
<P>
NOTE: Macintosh users, the above macro examples contain Windows path
information. Be sure to use a valid Macintosh path. For example:
<P>
<PRE>   ChDir "Mac HD:Microsoft Word 6"

</PRE><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, page 162
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword word95 word7 word6 ChDir winword winword2<BR>
macword word8 word97<BR>
Keywords          : kbmacroexample macword ntword winword word7 word8 word95 word97 macword98 kbmacro<BR>
Version           : WINDOWS:2.0,2.0a,2.0a- CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a,97; MACINTOSH:6.0,6.0.1,98<BR>
Platform          : MACINTOSH Win95 WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
