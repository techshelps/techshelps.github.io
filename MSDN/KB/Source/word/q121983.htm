

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using a Macro to Insert a Custom Formatted Date </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121983">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1994/10/25">
<META NAME="Keywords" CONTENT="kbmacroexample">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article describes how to write a macro that prompts you to enter a number of days from the current day and then inserts the resulting date in a custom format.  MORE INFORMATION  WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS A...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QAYZ,QACI,QAGJ,QBJZ,QA9N,QAFF,QACE,QAY2,QBFH,QAUD,QANE,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using a Macro to Insert a Custom Formatted Date</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121983</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to write a macro that prompts you to enter a
number of days from the current day and then inserts the resulting date in
a custom format.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.

<OL><P><LI>From the Tools menu, choose Macro. Type a name for the new macro and
   choose the Create button.

<P><LI>In the macro editing window, enter the text below. (Sub MAIN and End Sub
   are already listed.)
<P>
   Word 7.0
   --------
<P>
<PRE>   Sub MAIN
    Defaultdate$=GetPrivateProfileString$(
     "HKEY_CURRENT_USER\software\Micr soft\Word\7.0\Options","dateformat",
      "")
    SetPrivateProfileString(
     "HKEY_CURRENT_USER\software\Microsoft\Word\7.0 Options", "dateformat",
     "MMMM d,yyyy", "")
    Days$ = InputBox$("Please enter the number of days from Today ")
    NumDays = Val(days$)
    serialEndDate = Now() + numDays
    EndDate$ = Date$(serialEndDate)
    Insert enddate$
    SetPrivateProfileString
     "HKEY_CURRENT_USER\software\Microsoft\Word\7.0\Options", "dateformat",
     "defaultdate$", ""
   End Sub

   This macro prompts you to enter a number of days from today and then
   inserts the resulting dat in "MMMM d, yyyy"(December 31, 2000) format.

   Word 6.0
   --------

   Sub MAIN
    Defaultdate$ = GetPrivateProfileString$("microsoft word",
     "dateformat","winword6.ini")
    SetPrivateProfileString "microsoft word", "dateformat", "MMMM d,
     yyyy","winword6.ini"
    Days$ = InputBox$("Please enter the number of days from today")
    NumDays = Val(days$)
    SerialEndDate = Now() + numDays
    EndDate$ = Date$(serialEndDate)
    Insert enddate$
    SetPrivateProfileString "microsoft word", "dateformat", defaultdate$,
     "winword6.ini"
   End Sub

   This macro prompts you to enter a number of days from today and then
   inserts the resulting date in "MMMM d, yyyy"(December 31, 2000) format.

</PRE><P><LI>From the File menu, choose Close, and be sure to save the changes to the
   macro.

<P><LI>To run the macro, choose Macro from the Tools menu, select the macro
   name you assigned in step 1, and choose the Run button.
<P>
</OL>To insert a date for 30 days from today, use the following macro:
<P>
<PRE>   Word 7.0
   --------

   Sub MAIN
    Defaultdate$ = GetPrivateProfileString$
     (HKEY_CURRENT_USER\software\Microsoft\Word\7.0\Options", "dateformat",
     "")
    SetPrivateProfileString
     "HKEY_CURRENT_USER\software\Microsoft\Word\7.0\Options", "dateformat",
      MMM d, yyyy", ""
    NumDays = 30
    SerialEndDate = Now() + NumDays
    EndDate$ = Date$(serialEndDate)
    Insert enddate$
    SetPrivateProfileString
     "HKEY_CURRENT_USER\software\Microsoft\Word\7.0\Options", "dateformat",
      "defaultdate$", ""
   End Sub

</PRE></OL><h3>Word 6.0</h3>
 
<P>
<PRE> Sub MAIN
  Defaultdate$ = GetPrivateProfileString$("microsoft word",
   "dateformat","winword6.ini")
  SetPrivateProfileString "microsoft word", "dateformat", "MMMM d,
   yyyy", "winword6.ini"
  NumDays = 30
  SerialEndDate = Now() + numDays
  EndDate$ = Date$(serialEndDate)
  Insert enddate$
  SetPrivateProfileString "microsoft word", "dateformat", defaultdate$,
   "winword6.ini"
 End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbmacro<BR>
KBSubcategory: kbmacroexample<BR>
Additional reference words: 6.0 6.0a 6.0c word6 7.0 word95 word7<BR>
winword<BR>
Keywords          : kbmacroexample<BR>
Version           : 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
