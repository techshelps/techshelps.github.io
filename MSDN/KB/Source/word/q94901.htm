

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD: Out-of-Memory Error with Macro That Edits Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94901 ">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1993/01/24">
<META NAME="Keywords" CONTENT="kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Word for Windows, it is possible to receive an out of memory error while running a macro that performs a large number of edits to a document.  CAUSE =====  This out of memory error may be an indication that there are too many edits to ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QAG8,QAB4,QAEF,QAAP,QDO0,QAFF,QACI,QDL9,QBWQ,QBWO,QBWN,QAZM,QAZL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Out-of-Memory Error with Macro That Edits Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94901 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Word for Windows, it is possible to receive an out of memory
error while running a macro that performs a large number of edits to a
document.
<P>
<P><h2>CAUSE</h2>
 
<P>
This out of memory error may be an indication that there are too
many edits to the document, rather than an insufficient amount of memory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To eliminate this error, add a FileSave command to your macro so that the
document is saved periodically.
<P>
When using a macro to search and replace text in a document, the FileSave
command is often needed after a number of replacements have been made. The
FileSave command clears the Word edit buffer so that the macro can continue
making edits.
<P>
Below is a sample macro that replaces all semicolons with tabs in a
document. The If statement and count variable are used to save the document
after every 30 replacements.
<P>
<P><h3>Word 6.0</h3>
 
<P>
<PRE>   Sub MAIN
      ToolsOptionsSave .FastSaves = 0
      StartOfDocument
      count = 0
      EditFindClearFormatting
      EditFind .Find = ";", .Direction = 0
      While EditFindFound()
         count = count + 1
         EditClear
         Insert Chr$(9)
         If count = 30 Then
            FileSave
            count = 0
         End If
         RepeatFind
      Wend
   End Sub

</PRE><h3>Word 2.x</h3>
 
<P>
<PRE>  Sub MAIN
  ToolsOptionsSave .FastSaves = 0
  StartOfDocument
  count = 0
  EditFindClearFormatting
  EditFind .Find = ";", .Direction = 2
    While EditFindFound()
      count = count + 1
      EditClear
      Insert Chr$(9)
      If count = 30 Then
        FileSave
        count = 0
      End If
      EditFind .Find = ";",  .Direction = 2
    Wend
  End Sub

</PRE>WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, pages 180, 181,
333-334.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: memory error WordBasic errmsg winword2 winword 7.0 <BR>
word95  err msg  insufficient macword 6.0.1 word7 word6 out of memory<BR>
Keywords          : kbmacro<BR>
Version           : WINDOWS: 2.x, 6.0, 6.0a, 6.0c, 7.0; MACINTOSH: 6.0, 6.0.1<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
