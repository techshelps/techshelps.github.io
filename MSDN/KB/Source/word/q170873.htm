

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD97: IPF Viewing Name or Path on Linked Floating Picture </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170873">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1997/07/01">
<META NAME="Keywords" CONTENT="kbwordvba kbgraphic">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you insert a linked, floating picture into a Microsoft Word 97 document, select it, and then try to view the SourcePath and SourceName properties in Visual Basic for Applications, you may receive the following error message:     This program h...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAIH,QAPN,QAYS,QAMB,QAKP,QADK,QAH4,QA9N,QAW6,QBV8,QAB9,QA5F,QAUJ,QAMA P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: IPF Viewing Name or Path on Linked Floating Picture</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170873</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you insert a linked, floating picture into a Microsoft Word 97
document, select it, and then try to view the SourcePath and SourceName
properties in Visual Basic for Applications, you may receive the following
error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.

   If the problem persists, contact the program vendor.

</PRE>Clicking the Details button gives the following message:
<P>
<PRE>   WINWORD caused an invalid page fault in module MSO97.DLL.

</PRE><h2>RESOLUTION</h2>
 
<P>
To correct this problem, install Microsoft Word 97 Service Release 1 (SR-
1).
<P>
To work around this problem, use one of the following methods.
<P>
Method 1: Use a Different Visual Basic for Applications Command
 
<P>
Instead of using the following two commands
<P>
<PRE>   ?Selection.ShapeRange(1).linkformat.sourcepath
   ?Selection.ShapeRange(1).linkformat.sourcename

</PRE>use the following single command to return both the source name and the
source path:
<P>
<PRE>   ?Selection.ShapeRange(1).linkformat.SourceFullName

</PRE><h3>Method 2: Change the Type of Picture</h3>
 
<P>
Change the pictures from floating to inline or framed before running the
Visual Basic for Applications code to view the SourceName or SourcePath
properties.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Word 97 for
Windows. This problem was corrected in Microsoft Word 97 SR-1.
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The problem occurs when you insert a linked, floating picture and then try
to view the path and name information through Visual Basic for
Applications. This can be done by inserting and selecting the linked,
floating, starting the Visual Basic editor, and using the Immediate window
to enter the following commands:
<P>
<PRE>   ?Selection.ShapeRange(1).linkformat.sourcepath
   ?Selection.ShapeRange(1).linkformat.sourcename

</PRE>Immediately after you execute the second Visual Basic for Applications
command you will receive the Invalid Page Fault (IPF). Executing only one
command will not generate the IPF. The order in which you execute the
commands has no effect on the IPF.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about floating objects, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A HREF="../WORD/Q161692.htm">Q161692</A></B>
   TITLE: WD97: Problems With Float Over Text Objects

   ARTICLE ID: <B><A HREF="../WORD/Q155804.htm">Q155804</A></B>
   TITLE: WD97: Inserted Picture or Drawing Object Moves Down Page

   ARTICLE ID: <B><A HREF="../WORD/Q167738.htm">Q167738</A></B>
   TITLE: WD97: Can't See or Manipulate Objects (and Other Odd Behavior)

   ARTICLE ID: <B><A HREF="../WORD/Q155802.htm">Q155802</A></B>
   TITLE: WD97: Word Doesn't Find "Float Over Text" Objects
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sr1 release1 general protection GPF crash 8.0 8.00<BR>
Keywords          : kbwordvba kbgraphic<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
