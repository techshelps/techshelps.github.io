

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD97: WordBasic MacroCopy Command Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170267">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1997/06/17">
<META NAME="Keywords" CONTENT="kbwordvba winword word8 word97 kbmacro kbusage">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you attempt to use a WordBasic.MacroCopy command to copy a macro from any location other than a local template to any location other than a global template, the copy may fail.  The table that follows details how the WordBasic.MacroCopy, WordBa...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA36,QA7H,QANG,QABA,QAN1,QBQ9,QBV8,QAB9,QA9N,QAB4,QASB,QAG4,QAKE,QA5F P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: WordBasic MacroCopy Command Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170267</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows, Service Release 1 (SR-1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to use a WordBasic.MacroCopy command to copy a macro
from any location other than a local template to any location other
than a global template, the copy may fail.
<P>
The table that follows details how the WordBasic.MacroCopy,
WordBasic.Organizer, and Application.OrganizerCopy commands
perform in Microsoft Word 97 SR-1. 
<P>
NOTE: "Global Temp" indicates any template loaded globally (i.e.
through Tools/Templates and Add-Ins) other than Normal.
<P>
An error will be generated when trying to perform any of the
illegal copies. The error message will change depending on the
command used and the target.
<P>
Programmatic Macro Copy in Word 97 SR-1
<P>
<P><h3>Using WordBasic.MacroCopy</h3>
 
<PRE>Source       Target        Valid  Err  Error Message

Document     Document      Yes
Document     Template      Yes
Document     Normal        Yes
Document     Global Temp   No*    24   Bad Parameter
Template     Document      Yes
Template     Template      Yes
Template     Normal        Yes
Template     Global Temp   No*    24   Bad Parameter
Normal       Document      No     24   Bad Parameter
Normal       Template      No     24   Bad Parameter
Normal       Normal        No     24   Bad Parameter
Normal       Global Temp   No     24   Bad Parameter
Global Temp  Document      No     24   Bad Parameter
Global Temp  Template      No     24   Bad Parameter
Global Temp  Normal        No     24   Bad Parameter
Global Temp  Global Temp   No     24   Bad Parameter

</PRE><h3>Using WordBasic.Organizer</h3>
 
<PRE>Source       Target        Valid  Err  Error Message

Document     Document      Yes
Document     Template      Yes
Document     Normal        Yes
Document     Global Temp   No*    1844 The project item cannot be copied
Template     Document      Yes
Template     Template      Yes
Template     Normal        Yes
Template     Global Temp   No*    1844 The project item cannot be copied
Normal       Document      No     102  Command failed
Normal       Template      No     102  Command failed
Normal       Normal        No     102  Command failed
Normal       Global Temp   No     102  Command failed
Global Temp  Document      No     102  Command failed
Global Temp  Template      No     102  Command failed
Global Temp  Normal        No     102  Command failed
Global Temp  Global Temp   No     1844 The project item cannot be copied

</PRE><h3>Using Application.OrganizerCopy</h3>
 
<PRE>Source       Target        Valid  Err  Error Message

Document     Document      Yes
Document     Template      Yes
Document     Normal        Yes
Document     Global Temp   No*    5940 The project item cannot be copied
Template     Document      Yes 
Template     Template      Yes 
Template     Normal        Yes 
Template     Global Temp   No*    5940 The project item cannot be copied
Normal       Document      No     4198 Command failed
Normal       Template      No     4198 Command failed
Normal       Normal        No     4198 Command failed
Normal       Global Temp   No     4198 Command failed
Global Temp  Document      No     4198 Command failed
Global Temp  Template      No     4198 Command failed
Global Temp  Normal	   No     4198 Command failed
Global Temp  Global Temp   No     5940 The project item cannot be copied

</PRE>* Copying from a document or template to a Global Temp WILL WORK if
the Global Temp is open in Word for editing.
<P>
<P><h2>CAUSE</h2>
 
<P>
This functionality is by design in Microsoft Word 97 SR-1, in an effort to
reduce the spread of macro viruses. This behavior is different from
Microsoft Word 97. In Microsoft Word 97, the command will be executed as
expected.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Instead of using the WordBasic object to copy macros from one location to
another, use the Microsoft Word 97 object model.
<P>
For more information about equivalent commands in the Microsoft Word 97
object model, click the Office Assistant, type "What is
WordBasic.MacroCopy?," click Search, and then click to view "Visual Basic
Equivalents for WordBasic Commands."
<P>
NOTE: You must be in the Visual Basic Editor before you click the Office
Assistant for help.
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Word Help is not installed on your computer, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about macro viruses, please see the following articles
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A HREF="../WORD/Q134727.htm">Q134727</A></B>
   TITLE: WD: What to Do If You Have a Macro Virus

   ARTICLE ID: <B><A HREF="../WORD/Q163932.htm">Q163932</A></B>
   TITLE: WD: Frequently Asked Questions About Word Macro Viruses

   ARTICLE ID: <B><A HREF="../WORD/Q162198.htm">Q162198</A></B>
   TITLE: WD97: Article List: Microsoft Word 97 Word Macro Virus

</PRE>For more information about macro viruses, click the Office Assistant, type
"macro virus," click Search, and then click "Check documents for macros
that might contain viruses."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sr1 release1 8.0 8.0<BR>
Keywords          : kbwordvba winword word8 word97 kbmacro kbusage<BR>
Version           : WINDOWS:97SR1<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
