

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Close Command on Control Menu Unavailable in Custom Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106256">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1993/11/03">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Word for Windows, the Close command on the Control menu is unavailable (dimmed) in user-defined dialog boxes that do not contain a Cancel button.  CAUSE =====  The Close command on the Control menu of a dialog box and the Cancel button in a dial...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QAIH,QA01,QAMN,QAAW,QAGC,QANF,QA7O,QAOE,QAB5,QA4P,QANX,QBV8,QAFF,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Close Command on Control Menu Unavailable in Custom Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106256</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Word for Windows, the Close command on the Control menu is
unavailable (dimmed) in user-defined dialog boxes that do not contain
a Cancel button.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Close command on the Control menu of a dialog box and the Cancel
button in a dialog box serve the same purpose, namely to close the
dialog box without making any changes. When a user-defined dialog box
does not contain a Cancel button, Word assumes that you should not be
able to close the dialog box without making some change.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Even though Close is grey on the application control menu you are able to
use ALT+F4 to close the dialog box. The below code effectively disables
ALT+F4
<P>
ALT+F4 will return a 0 value as though Cancel was pressed.
<P>
<PRE>Sub MAIN
</PRE>Begin Dialog UserDialog 320, 54, "Microsoft Word"
<PRE>   TextBox 10, 22, 160, 18, .TextBox1
   PushButton 190, 18, 108, 21, "Click here", .Push1
   Text 10, 6, 44, 13, "Name", .Text1
</PRE>End Dialog
Dim dlg As UserDialog
again:
Choice = Dialog(dlg)
If Choice = 0 Then
Goto again
Else
<PRE>   Name$ = dlg.textbox1
   MsgBox "hello " + Name$
</PRE>End If
<PRE>End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following WordBasic macro is an example of a user-defined dialog
box in which the Close command on the Control menu is unavailable:
<P>
<PRE>Sub MAIN
</PRE>Begin Dialog UserDialog 200, 80, "Microsoft Word"
<PRE>   OKButton 50, 25, 88, 21     '0
</PRE>End Dialog
Dim dlg As UserDialog
Dialog dlg
<PRE>End Sub

</PRE>Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 6.0a 6.0 grey gray greyed grayed word6<BR>
6.0c 7.0 word95 word7 winword
<P>

Version           : 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
