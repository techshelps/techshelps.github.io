

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD97: What to Do If You Have a Macro Virus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181079">
<META NAME="KBModify" CONTENT="1998/03/04">
<META NAME="KBCreate" CONTENT="1998/02/13">
<META NAME="Keywords" CONTENT="kbdta kbvirus kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The first macro virus was discovered in the summer of 1995. Since that time, other macro viruses have appeared. This article describes what to do if you think you might have a Word macro virus, or if you want to ensure that your documents never bec...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBQ9,QBJZ,QAH4,QBWS,QAIH,QAEF,QAMN,QACI,QBHJ,QAGB,QA36,QBVV,QA9N,QAL3,QAUR P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: What to Do If You Have a Macro Virus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181079</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The first macro virus was discovered in the summer of 1995. Since that
time, other macro viruses have appeared. This article describes what to do
if you think you might have a Word macro virus, or if you want to ensure
that your documents never become infected with one.
<P>
The following are some symptoms of a Word macro virus that are known to
affect Word and Word documents:

<UL><LI>When you try to save a document, Word only lets you save the
   document as a template.
<P>
<P><PRE>    -or-
</PRE>
<LI>The icon for the file looks like a template rather than a document.
<P>
<P><PRE>    -or-
</PRE>
<LI>When you open a document, a dialog box showing the number 1 appears.
<P>
<P><PRE>    -or-
</PRE>
<LI>The commands of Macro and Customize no longer show on the Tools menu.
<P>
<P><PRE>    -or-
</PRE>
<LI>New macros appear in the list of macros. AutoOpen and FileSaveAs macros
   may also appear; if you already had macros by these names, their content
   may have been changed by the macro virus.

<LI>Unusual or unexpected messages appear when you open a Word
   document or template.
<P>
</UL>NOTES:

<UL><LI>In Word 97 there is a the Macro Virus Protection option (on the Tools
   menu, click Options, and click the General tab) designed to alert you if
   you open a file that contains macros, regardless of what the macros do.
   For a permanent solution, you must use anti-virus software that is
   specifically designed to detect and prevent macro viruses.

<LI>Word doesn't look for or remove any macro viruses from existing
   documents and templates. It will simply warn you if the document you
   are opening contains macros. The warning lets you either open the
   document with the macros active or open it with the macros disabled.
   You should not open a document with the macros active unless you are
   absolutely sure that the document contains no harmful macro viruses.
<P>
</UL>For a long-term solution to macro viruses, install anti-virus software that
is specifically designed to detect macro viruses. For information on anti-
virus software vendors, including software capable of detecting and
preventing macro viruses, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q49500.htm">Q49500</A></B>
   TITLE     : Anti-Virus Software Vendors

</PRE><h2>WORKAROUND</h2>
 
<P>
Use the following workarounds as interim solutions only.
<P>
<P><h3>Method 1: Press SHIFT When You Open a File</h3>
 
<P>
If you do not have any of the symptoms described in this article, but you
do not want to be affected by a macro virus, hold down the SHIFT key when
you open a file that might be affected by a macro virus. Pressing SHIFT
will prevent any Auto macros from being run; if a macro virus is present,
it will not be loaded.
<P>
<P><h3>Method 2: Delete the Macro and Recover the Document</h3>
 
<P>
If you have experienced the symptoms listed in this article, or if you
suspect that you have a macro virus that is not described here, use the
following steps to remove the offending macros and correct affected
documents. (Remember, this is only a temporary solution; because new
macros are being created, these steps may not work):

<OL><P><LI>Close Word and rename the Normal.dot file to Name.dot.

<P><LI>Make a back-up copy of an affected file.

<P><LI>Open Word and on the File menu click Open.

<P><LI>Navigate to the folder containing the affected file.

<P><LI>Click to select the affected file.

<P><LI>Press and hold the SHIFT key and click Open.
<P>
   Continue to hold the SHIFT key until the affected file is open
   in Word.
<P>
   NOTE:Holding the SHIFT key while opening a file keeps any of Words
   automatic macros from running.

<P><LI>To remove suspect virus containing macros, do the following:
<P>
   a. On the Tools menu, point to Macro, and then click Macros.
<P>
   b. In the Macros In list, click All Active Templates and documents.
<P>
   c. Select the suspect macro and click Delete. Click Yes
<P><PRE>      when asked if you want to delete the macro.
</PRE><P>
   d. Repeat step c for all suspect macros.
<P>
   e. Click Cancel or the x to close the Macros dialog box.

<P><LI>To recover the text of an infected document:
<P>
   a. Select the entire document by pressing CTRL+A, or by clicking
<P><PRE>      Select All on the Edit menu.
</PRE><P>
   b. Delete the document's final paragraph mark from the selection
<P><PRE>      by pressing SHIFT+LEFT ARROW.
</PRE><P>
   c. On the Edit menu, click Copy.
<P>
   d. On the File menu, click New. Select the template you want to
<P><PRE>      use, and click OK.
</PRE><P>
   e. On the Edit menu, click Paste.
<P>
   f. Repeat step 7 to ensure that the virus containing macros have not
<P><PRE>      again replicated.
</PRE><P>
   g. Save the document.

<P><LI>Repeat these steps for any document suspect of containing a macro
   virus.
<P>
</OL>NOTE:If this method does not work, try Method 3.
<P>
<P><h3>Method 3: Use the Organizer to temporarily clean up macro viruses</h3>
 
<P>
Use the Organizer to clean up the macro virus. Keep in mind that if
other files were opened after the infected file, they most likely will
be infected as well.
<P>
To remove the virus from the Normal template:

<OL><P><LI>Close all documents. If an infected document is open, it can easily
   reinfect Normal.dot.

<P><LI>On the Tools menu, click Templates and Add-Ins, and click the Organizer
   button.

<P><LI>Select the Macro Project Items tab and rename or delete all of the
   following macros:
<P>
<P><PRE>      NewMacros
      AutoClose
      AutoExec
      AutoOpen
      FileExit
      FileNew
      FileOpen
      FileSave
      FileSaveAs
      Macros
      ToolsMacro
</PRE>
<P><LI>Click Close.

<P><LI>Press SHIFT and on the File menu, click Save All to save the template.
<P>
</OL>To remove the virus from infected documents:
<P>
If a file is infected, use the same method as above, but remove the macros
from both the Normal template and also from the infected document
(template) while in the Organizer. When you are done, press SHIFT and on
the File menu and click Save All and move on to the next file. Keep in
mind that every time you open an infected file it will infect your Normal
template, so you constantly need to remove the macros from the Normal
template.
<P>
<P><h3>Method 4: Insert It into a New Document</h3>
 
<P>
With this method, you will need to rename Normal.dot and then on the Insert
menu, click File to temporarily remove the macros. This method is
particularly useful with The macro virus called "CAP" that removes Macro
and Customize from the Tools menu.
<P>
NOTE:In this situation, the Templates And Add-Ins command on the Tools
menu may not work.

<OL><P><LI>Close Word and rename the Normal.dot file to Name.dot.

<P><LI>Open Word and verify that Macro and Customize are on the Tools menu.

<P><LI>Open a new document and on the Insert menu, click File.

<P><LI>Navigate to the folder containing the affected file.

<P><LI>Click to select the affected file.

<P><LI>Press and hold the SHIFT key and click OK.
<P>
<P><PRE>    Continue to hold the SHIFT key until the affected file is open
    in Word.
</PRE><P>
<P><PRE>    NOTE:Holding the SHIFT key while opening a file keeps any of Words
    automatic macros from running.
</PRE>
<P><LI>To see if there are any macros in the new document (there should not be
   any listed), point to Macro on the Tools menu, and then click Macros.
   In the Macros In list, click "All active templates and documents."
   Under Macro Name, there should not be any macros listed. Click Cancel.

<P><LI>Save the file with a different file name.

<P><LI>Delete the infected file.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
A macro virus is a program written in the macro language of a program,
like Word. It propagates itself among data files and can harm your files
or your computer's operating system.
<P>
Word macro viruses do not travel freely over the Internet or any other
media; they can only be transferred when a user opens a document or
template that contains the virus macro.
<P>
Microsoft Internet Assistant and documents created or read by it
cannot be affected by such macros. Internet Assistant, by design,
blocks the mechanism that distributes the macro virus.
<P>
Macro viruses cannot be transferred by WordMail unless an affected document
is embedded in the e-mail message and the receiver opens the document.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: disinfect protect protected corporate infect saving<BR>
opening saveas nuclear DMV prank concept word97 word8<BR>
Keywords          : kbdta kbvirus kbfaq<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 4, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
