

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Corruption with Macro Run on ToolsGrammar and ToolsSpelling </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82251 ">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1992/03/30">
<META NAME="Keywords" CONTENT="kbproof kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you run a macro that calls a modeless dialog box such as ToolsSpelling or ToolsGrammar in Microsoft Word for Windows unexpected results occur if you use ToolsMacro to run the command rather than calling the command directly.  MORE INFORMATION  A...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QAIH,QANX,QAKR,QAHE,QAH4,QBWS,QAGI,QAK3,QBKH,QBVV,QBFY,QA9N,QAO4,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Corruption with Macro Run on ToolsGrammar and ToolsSpelling</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82251 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you run a macro that calls a modeless dialog box such as
ToolsSpelling or ToolsGrammar in Microsoft Word for Windows
unexpected results occur if you use ToolsMacro to run the command
rather than calling the command directly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A modeless dialog box is one that you can activate and switch away
from by clicking another active window. For example, you can click
your document to switch away from the dialog box. The Spelling and
Grammar commands have this type of dialog box.
<P>
A modal dialog box is a one that requires you to choose the OK or
Cancel button to close the dialog box before you can switch to another
action, window, or dialog box.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid any unexpected results when calling a modeless dialog box,
use the command directly. In a macro, use the ToolsSpelling and
ToolsGrammar commands rather than ToolsMacro "ToolsSpelling" or
ToolsMacro "ToolsGrammar."
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In a new document, type "This is an sentence." (without the
   quotation marks).

<P><LI>Create and run the following macro:
<P>
<PRE>   Sub MAIN
   SendKeys "%c"
   ToolsMacro .Name = "ToolsGrammar", .Run, .Show = 0
   Insert "yo"
   End Sub

</PRE></OL>The document becomes corrupt. The text reads "Thisis," but the cursor
cannot go past the second letter. You cannot select the entire
document.
<P>
Note: This behavior occur on the first try.
<P>
It is expected that the word "an" should be replaced with "a," and the
selection should not be altered. The "yo" should not be inserted until
after the dialog box has been exited. The problem is that "yo" is
inserted underneath the dialog box before the change is made, but the
dialog box does not lose the focus. This problem occurs with any
modeless dialog box.
<P>
Any macro that uses ToolsMacro .Run on a modeless dialog box
(ToolsSpelling, ToolsGrammar) will experiencee similar problems.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory:  kbmacro<BR>
KBSubcategory:<BR>
Additional query words: winword2 2.0 2.0a 2.0a-CD word6<BR>
winword 2.0b
<P>

Keywords          : kbproof kbmacro<BR>
Version           : 2.0 2.0a 2.0a-CD 2.0b 2.0c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
