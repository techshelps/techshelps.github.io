

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD: Deleting an Entry Line from an .INI Settings File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120028">
<META NAME="KBModify" CONTENT="1997/08/05">
<META NAME="KBCreate" CONTENT="1994/08/30">
<META NAME="Keywords" CONTENT="kbprg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft WordBasic includes two statements to read and write information to a private settings file often referred to as an .INI file: SetPrivateProfileString and GetPrivateProfileString. Neither of these commands, however, allow you to remove an ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QDL9,QBWQ,QBWO,QBWN,QATX,QAMB,QAEF,QBWP,QA0B,QA5F,QAY2,QABA,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Deleting an Entry Line from an .INI Settings File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120028</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft WordBasic includes two statements to read and write information
to a private settings file often referred to as an .INI file:
SetPrivateProfileString and GetPrivateProfileString. Neither of these
commands, however, allow you to remove an entire entry line from a private
settings file or .INI file.
<P>
The following WordBasic macro demonstrates the use of the Windows
WritePrivateProfileString function in order to remove an entry from an .INI
file.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h3>Word for Windows version 6.x</h3>
 
<P>
<PRE>   Declare Function DeleteProfileStr Lib "kernel"(Section$, Key$, \
   Value As Long, FName$) As Integer Alias "WritePrivateProfileString"

   Sub MAIN
   FName$ = "C:\WINWORD\TEXT.INI"
   Section$  = "Section"
   Key$ = "Entry1"
   x = DeleteProfileStr(Section$, Key$, 0, FName$)
   End Sub

</PRE><h3>Windows 95 or Windows NT</h3>
 
<P>
<PRE>   Declare Function WritePrivateProfileString Lib "kernel32" Alias \
   "WritePrivateProfileStringA"(Section$, Key$, Value As Long, FName$) \
   As Long

   Sub MAIN
   FName$ = "C:\TEST.INI"
   Section$  = "Section"
   Key$ = "Entry1"
   x = WritePrivateProfileString(Section$, Key$, 0, FName$)
   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The above WordBasic macro deletes the Entry1= line from the Text.ini file
in the C:\Winword directory. Before running the macro, the contents of the
Text.ini file appear as follows:
<P>
<PRE>   [Section]
   Entry1="Text for entry 1"
   Entry2="More text"

</PRE>After running the above macro the contents of the Text.ini file appear as
follows:
<P>
<PRE>   [Section]
   Entry2="More text"

</PRE>For more information about the Windows WritePrivateProfileString function,
query on the following words in the Microsoft Knowledge Base:
<P>
<PRE>   writeprivateprofilestring and windows and calls

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 6.0 6.0a WritePrivateProfileString Delete Key<BR>
word6 Entry Private Settings File DeleteProfileStr 7.0 word95 word7 ntword <BR>
wordnt<BR>
Keywords          : kbprg kbusage<BR>
Version           : 6.0 6.0a 6.0c 7.0 7.0a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
