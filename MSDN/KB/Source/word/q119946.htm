

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Nested Merge with IncludeText Field Does Not Merge File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119946">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1994/08/29">
<META NAME="Keywords" CONTENT="kbmerge kbprint">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You may receive several errors when you try to nest a merge field within the IncludeText field. (Note: For compatibility with earlier versions of Word for Windows, you can use Include instead of IncludeText.) If your document contains the following...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAB4,QA5V,QA2S,QAAP,QBVV,QAXB,QAG2,QAIH,QDME,QA2Q,QBRG,QBJZ,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Nested Merge with IncludeText Field Does Not Merge File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119946</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Windows operating system version 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive several errors when you try to nest a merge field within
the IncludeText field. (Note: For compatibility with earlier versions of
Word for Windows, you can use Include instead of IncludeText.) If your
document contains the following field
<P>
<PRE>   {IncludeText {mergefield &lt;filename&gt;}}

</PRE>where &lt;filename&gt; represents a field that contains a valid path and
filename, and you select the View Merged Data option before merging your
main document and data file, you will get the following error message:
<P>
<PRE>   Error! Not a valid filename"

</PRE>When performing the merge to a document or to the printer, you will receive
the following error message
<P>
<PRE>   A field calculation error occurred in Record &lt;record number&gt;.

</PRE>where &lt;record number&gt; is the number of the record being merged. This error
repeats for each record in the data document, and the resulting document
will contain the message:
<P>
<PRE>   Error! Not a valid filename

</PRE>If you first merge to a new document (not to the printer), you can select
the field in the merged document and press F9 to update the merge field. If
the data record originally contained full path information (for example,
C:\PATH\FILENAME), you will get the following error and you will not be
able to include the document in your merge:
<P>
<PRE>   Error! Filename not specified!

</PRE>If the original data record contains only the filename and the file is in
the current directory, the field will update at this point, without an
error.
<P>
This type of merge works correctly in Word version 2.x.
<P>
<P><h2>CAUSE</h2>
 
<P>
As the field updates, it reads the field braces of the nested field and
interprets the braces as part of the path. Since field braces are not valid
characters in a path, you receive the above errors.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Word versions 6.0, 6.0a,
and 6.0c for Windows. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If the {mergefield &lt;filename&gt;} refers to data that contains a path, first
format the field braces as hidden. Since you cannot select a single field
brace without selecting the entire field, you must first format the entire
field as hidden, then format the field type ("mergefield") and field
instructions (the data field name) as not hidden. Use the following steps
to do this:

<OL><P><LI>Select the field ({mergefield filename}).

<P><LI>From the Format menu, choose Font. Under Effects, select Hidden and then
   choose the OK button.

<P><LI>Select the text inside the field braces only.

<P><LI>From the Format menu, choose Font. Under Effects, clear the Hidden
   option then choose the OK button.

<P><LI>Your new document will contain the error:
<P>
<P><PRE>      Error! Not a valid filename.
</PRE><P>
   Choose Select All or press CTRL+A to highlight the entire document.

<P><LI>Press F9 to update the fields.
<P>
   Note: If you skip steps 3 and 4, your new document will contain a hidden
   path and filename that will generate the following message, and you will
   not be able to update the field:
<P>
<P><PRE>      Error! Filename not specified!
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: <BR>
KBSubcategory: kbmerge<BR>
Additional reference words: 6.0 6.0a 6.0c winword include word6<BR>
includetext merge mergefield error err field calculation filename not<BR>
specified invalid winword<BR>
Keywords          : kbmerge kbprint<BR>
Version           : 6.0 6.0a 6.0c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
