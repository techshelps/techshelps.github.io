

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GP Fault Closing Template Attached to Mail Merge Data File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115834">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1994/06/05">
<META NAME="Keywords" CONTENT="kbmerge">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  An  illegal instruction  error may occur in Word 7 when you close a document based on a template that is attached to a mail merge data file. In Windows 3.x general protection (GP) fault may occur  The GP fault occurs whether you save the main docum...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALI,QDME,QBKN,QBTS,QAIH,QA1S,QA39,QA9E,QDKY,QAGB,QAO4,QA36,QABT,QBWS,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>GP Fault Closing Template Attached to Mail Merge Data File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115834</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a 6.00c
WINDOWS
kbprint
buglist6.00 buglist6.00a buglist6.00c fixlist7.00
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An "illegal instruction" error may occur in Word 7 when you close a
document based on a template that is attached to a mail merge data file.
In Windows 3.x general protection (GP) fault may occur  The GP fault occurs
whether you save the main document or not. In other words, the GP fault
occurs when you close a mail merge main document you created using a main
document template.
<P>
Note: Sometimes, before the GP fault, the following error message occurs:
<P>
<PRE>   An application called via DDE did not respond to the Exit command.

</PRE><h2>CAUSE</h2>
 
<P>
The GP fault occurs if you used DDE (dynamic data exchange) to create the
mail merge data file attachment in the template. The problem occurs
regardless of which main document type you create (namely Form Letters,
Mailing Labels, Envelopes, or Catalog).
<P>
The problem does not occur if you used Open Database Connectivity (ODBC) to
attach the data file.
<P>
For example, this problem occurs if you attach a Microsoft Excel workbook
or Microsoft Access database as a mail merge data source using DDE.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Word versions 6.0, 6.0a and
6.00c for Windows. This problem was corrected in Word version 7.0 for
Windows 95.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Method 1: When you create a template for a mail merge main document, use
<PRE>          the following procedure to attach the data file using ODBC
          instead of DDE:

          a. From the Tools menu, choose Mail Merge. If you have not yet
             done so, choose the Create button to designate the template as
             a mail merge main document.

          b. In the Mail Merge Helper dialog box, choose the Get Data
             button. From the menu that appears, choose Open Data Source.

          c. In the Open Data Source dialog box, select the Confirm
             Conversions option so an X appears in the check box.

          d. Select the database and then choose OK.

          e. In the Confirm Data Source dialog box, select the ODBC
             conversion method for your data source. For example, if you
             are attaching a Microsoft Access database, select MS Access
             Databases via ODBC (*.mdb) or MS Access 2.0 Databases via
             ODBC (*.mdb).

          f. Choose OK.

</PRE>Method 2: If you want to use DDE to attach the data file, you can avoid the
<PRE>          GP fault problem by closing the DDE channel to the data file
          before you close your Word document. You can add the following
          AutoClose macro to your template to close the channel:

             Sub Main
             MailMergeReset
             End Sub

          WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS
          AT YOUR OWN RISK. Microsoft provides this macro code "as is"
          without warranty of any kind, either express or implied,
          including but not limited to the implied warranties of
          merchantability and/or fitness for a particular purpose.

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Word User's Guide," version 6.0, pages 641-646, 676-692
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint buglist6.00 buglist6.00a buglist6.00c fixlist7.00<BR>
KBSubcategory: kbmerge<BR>
Additional reference words: 6.00 6.00a gpf break link winword word6<BR>
6.00c<BR>
Keywords          : kbmerge<BR>
Version           : 6.00 6.00a 6.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
