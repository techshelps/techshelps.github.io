

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MacroDesc$() and CountMacros() Exclude Some Commands </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105548">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you run MacroDesc$() and CountMacros() for the following Word commands, a WordBasic error occurs and the functions return no value:     Columns    Condensed    Expanded    FontSize (see the  Notes  section below for additional information)    Lo...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBV8,QAB9,QAH4,QACI,QA9N,QAUD,QALQ,QDO7,QBM2,QDL9,QBWQ,QBWO,QBWN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MacroDesc$() and CountMacros() Exclude Some Commands</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105548</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you run MacroDesc$() and CountMacros() for the following Word commands,
a WordBasic error occurs and the functions return no value:
<P>
<PRE>   Columns
   Condensed
   Expanded
   FontSize (see the "Notes" section below for additional information)
   Lowered
   Raised
   FileOpenFile
   Shading
   Borders
   Color
   Symbol

</PRE>These Word for Windows commands do not appear in the Macro Name list, even
if you select All Word Commands from the Macros Available In list.
<P>
<P><h2>CAUSE</h2>
 
<P>
Word does not display these commands because they are not allocated
commands, which means they require a parameter that you cannot supply
through a Word dialog box.
<P>
In contrast, in Word 2.x the MacroDesc$() and CountMacros() functions
return values for the above WordBasic commands.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following macro will demonstrate this behavior in Word 6.0, 7.0:
<P>
<PRE>Sub MAIN
</PRE>FileNewDefault
<PRE>cm = CountMacros(, - 1)      ' Counts All Macros Global, AddIn, BuiltIn
gm = CountMacros(0)          ' Counts Just Global macros
am = CountMacros(,, - 1)     ' Counts Just AddIn macros

</PRE>On Error Resume Next
For i = ((gm + am) + 388) To (((gm + am) + 388) + 20)
<PRE>     Insert Str$(i) + Chr$(9)
     mn$ = "" : md$ = ""
     mn$ = MacroName$(i, 0, - 1)
     Bold 1 : Insert mn$
     Bold 0 : Insert Chr$(9)
     md$ = MacroDesc$(mn$)
     If md$ = "" Then md$ = "(none)"
     Insert md$ : InsertPara
     Print cm, i, mn$ + " - " + md$
</PRE>Next
<PRE>End Sub

</PRE>Kbcategory: kbusage kbmacro
KBSubcategory:
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 6.0 winword word6 6.0a 6.0c 7.0 word95<BR>
word7<BR>
Version           : 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
