

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Exit Macro Does Not Return Insertion Point to Correct Position </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120670">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1994/09/18">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you use an Exit macro in a protected form document to position the insertion point into an unprotected section of the document, Word for Windows positions the insertion point in the next FORM field in your document. This happens regardless of wh...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QACI,QAIH,QA7O,QBC9,QBC8,QANO,QAGB,QAFF,QBQU,QA9N,QAVY,QAJP,QAUJ,QAK7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Exit Macro Does Not Return Insertion Point to Correct Position</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120670</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use an Exit macro in a protected form document to position the
insertion point into an unprotected section of the document, Word for
Windows positions the insertion point in the next FORM field in your
document. This happens regardless of whether your Exit macro reprotects the
document.
<P>
The following macro demonstrates this problem:
<P>
<PRE> Sub MAIN
  ToolsUnprotectDocument
  LineDown 3
  Insert "Testing"
  ToolsProtectSection .Section=1, .Protect = 1
 End Sub

</PRE>Notice that Word positions the insertion point in the next FORM field
instead of leaving it after the word "Testing". In addition, you can no
longer insert paragraph marks or tabs in your document, and the BACKSPACE
key does not work. You must close and then reopen your document to regain
full Word functionality.
<P>
<P><h2>CAUSE</h2>
 
<P>
If your Exit macro re-protects the form document, Word moves to the next
FORM field by design. In a protected document, you can position the
insertion point only in FORM fields.
<P>
If, on the other hand, your Exit macro leaves the form document
unprotected, Word's behavior is unexpected.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Word listed
above. We are researching this problem and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Create an Exit macro that unprotects your document and then calls another
macro to move the insertion point in your document. The following two
sample macros demonstrate this workaround (In these examples, the first
section needs to be a protected section):
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h3>Exit Macro (Name: MyMacro1)</h3>
 
<P>
<PRE> Sub Main
  ToolsUnprotectDocument
  x=Now()
  OnTime x, "MyMacro2"  ' MyMacro2 is the name of the 2nd macro.
 End Sub

</PRE><h3>Secondary Macro (Name: MyMacro2)</h3>
 
<P>
Note: The name of this macro must be the same as the name you use in
the OnTime statement in the first macro.
<P>
<PRE> Sub Main
  EditGoto "s1" ' (Insert the commands here that move the insertion point.)
  Insert "Testing"
 End Sub

</PRE>The following sample Exit macro reprotects your document after the
secondary macro runs:
<P>
<PRE> Sub Main
    ToolsUnprotectDocument
    x=Now()
    OnTime x, "MyMacro2"
    s=1 'or the number of the section you are protecting
    ToolsProtectDocument .Type=2
    ToolsProtectSection .Section=s, .Protect=1
 End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbmacro buglist6.0 buglist6.0a buglist6.0c<BR>
KBSubcategory:<BR>
Additional query words: winword 6.0 6.0a 6.0c word6 7.0 word95<BR>
word7<BR>
Version           : 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
