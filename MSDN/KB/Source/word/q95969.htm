

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Macro to Copy WordBasic String to Clipboard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95969 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1993/03/02">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article contains a Word for Windows macro that copies a WordBasic string to the Windows Clipboard.  WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this macro code  as is  without warranty o...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAY5,QA4Q,QAB9,QBV8,QACJ,QDL9,QBWQ,QBWO,QBWN,QANH,QAH4,QATX,QAGU,QBW6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Macro to Copy WordBasic String to Clipboard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95969 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains a Word for Windows macro that copies a WordBasic
string to the Windows Clipboard.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this macro code "as is" without
warranty of any kind, either express or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: Below are the required API calls that must be made to Windows.
Make sure you use the list appropriate to your Word version or your
system may hang or become unusable.
<P>
Word for Windows NT, Word 7.0 for Windows 95
Declare statements (32-bit Word)
 
<P>
<PRE>Declare Function GetFocus Lib "user32"() As Long
Declare Function OpenClipboard Lib "user32"(hwnd As Long) As Long
Declare Function CloseClipboard Lib "user32"() As Long
Declare Function EmptyClipboard Lib "user32" As Long
Declare Function SetClipboardData Lib "user32"(wFormat As Long, hData As
</PRE>Long) As Long
<PRE>Declare Function CopyStrtoLp Lib "Kernel32" Alias "lstrcpy"(lpDest As Long,
</PRE>lpScr As String) As Long
<PRE>Declare Function GlobalAlloc Lib "Kernel32"(wFlags As Long, dwBytes As
</PRE>Long) As Long
<PRE>Declare Function GlobalLock Lib "Kernel32"(hL As Long) As Long
Declare Sub  GlobalUnlock Lib "Kernel32"(hU As Long)
Declare Function GlobalFree Lib "Kernel32"(hF As Long) As Long

</PRE>Word 2.0x, Word 6.0x for Windows 3.1x Declare Statements (16-bit Word)
 
<P>
<PRE>Declare Function GetFocus Lib "user"() As Integer
Declare Function OpenClipboard Lib "user"(hwnd As Integer) As Integer
Declare Function CloseClipboard Lib "user"() As Integer
Declare Function SetClipBoardData Lib "user"(uFormat As Integer, hData As
</PRE>Integer) As Integer
<PRE>Declare Function EmptyClipboard Lib "user" As Integer
Declare Function CopyStrtoLp Lib "kernel"(lpDest As Long, lpScr As String)
</PRE>As Long Alias "lstrcpy"
<PRE>Declare Function GlobalAlloc Lib "Kernel"(wFlags As Long, dwBytes As
</PRE>Integer) As Integer
<PRE>Declare Function GlobalLock Lib "kernel"(h As Integer) As Long
Declare Sub  GlobalUnlock Lib "kernel"(h As Integer)
Declare Function GlobalFree Lib "kernel"(h As Integer) As Integer

</PRE><h3>Example</h3>
 
<P>
<PRE>Sub MAIN
</PRE>If  SetClipBoard("This is a test of the national broadcasting
system.") Then EditPaste
<PRE>End Sub

</PRE>Function SetClipBoard(szText$)
<PRE>'* Get the handle to the active Window.
</PRE>hwnd = GetFocus
<P>
<PRE>'* Add some NULL terminating characters to the String.
</PRE>szText$ = szText$ + Chr$(0) + Chr$(0)
<P>
<PRE>'* Allocate some global memory and copy the string to this memory.
</PRE>nSize = Len(szText$)
hData = GlobalAlloc(2, nSize)
hMem = GlobalLock(hData)
hMem = CopyStrtoLp(hMem, szText$)
<P>
<PRE>'* Unlock the memory handle, the clipboard must receive an unlocked
</PRE>handle.
GlobalUnlock(hData)
<P>
<PRE>'* Open the clipboard
</PRE>If(OpenClipboard(hwnd) &lt;&gt; 0) Then
<PRE>        '* Clear current contents, add hData, Close Clipboard.
     n = EmptyClipboard
     n = SetClipBoardData(1, hData)
        '* the clipboard must be closed before any one else can access it.
     n = CloseClipboard
</PRE>Else
<PRE>     n = 0
        '* Clipboard failed, free memory
        n2 = GlobalFree(hData)
</PRE>End If
SetClipBoard = n
End Function
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Programming Windows 3.1," 3rd edition, by Charles Petzold, Microsoft
Press, Copyright 1992, Chapter 16
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.0 6.0 6.0a 6.0c 2.0 2.0a 2.0a-CD 2.0b<BR>
2.0c word6 word95 wordnt winword winword2 winapi word7<BR>
Version           : 2.x 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
