

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining the Number of Instances an Application Is Running </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99955 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1993/06/10">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Sometimes your WordBasic macro may need to determine how many instances of an application are currently running in memory.  MORE INFORMATION  Word 6.0  In Word 6.0, API calls may be avoided by displaying the active applications alphabetically in a ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QAKC,QBC6,QDL9,QBWQ,QBWO,QBWN,QBVP,QAUJ,QAJH,QBWS,QAG8,QADK,QDO7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Determining the Number of Instances an Application Is Running</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99955 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes your WordBasic macro may need to determine how many instances
of an application are currently running in memory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Word 6.0
 
<P>
In Word 6.0, API calls may be avoided by displaying the active applications
alphabetically in a listbox similar to the Task List. This sample macro may
be enhanced to return the actual number of a specific window if that is
desired.
<P>
<PRE>Sub MAIN
 size = AppCount() - 1
 Dim winnames$(size)
 AppGetNames winnames$()
 SortArray winnames$()
 Begin Dialog UserDialog 420, 162, "Active Application List"
      Text 156, 14, 138, 13, "Active Applications.", .Text1
      ListBox 41, 35, 340, 84, winnames$(), .ListBox1
      OKButton 170, 133, 88, 21
 End Dialog
 Dim dlg As UserDialog
 Dialog dlg
End Sub

</PRE><h3>Word 2.x</h3>
 
<P>
In Word for Windows 2.x, you can call GetModuleUsage in the
Windows Kernel dynamic-link library (DLL) to determine how
many instances of an application are running in memory.
<P>
The following macro example demonstrates the use of the
Windows GetModuleUsage function to determine how many
instances of Word for Windows are running. "MSWORD" is the
module name for Word for Windows, but any other application
module name can be substituted below. (For example, the
module name for Microsoft Excel is "EXCEL.")
<P>
<PRE>Declare Function GetModuleHandle Lib "Kernel"(ModuleName$)
</PRE>As Integer
<PRE>Declare Function GetModuleUsage Lib "Kernel"(hTask As
</PRE>Integer) As Integer
<P>
<PRE>Sub MAIN
</PRE>Number = GetModuleUsage(GetModuleHandle("MSWORD"))
If number = 1 Then
<PRE>  MsgBox "There is" + Str$(Number) +\
  " instance of Word running."
</PRE>Else
<PRE>  MsgBox "There are" + Str$(Number) +\
  " instances of Word running."
</PRE>EndIf
<PRE>End Sub

</PRE>The module name for an application is usually the name of
the executable file.
<P>
<PRE>   Module Name       Program .EXE Filename
   -----------       ---------------------

   EXCEL             EXCEL.EXE
   MSMAIL            MSMAIL.EXE
   MSACCESS          MSACCESS.EXE

</PRE>WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE
IS AT YOUR OWN RISK. Microsoft provides this macro code "as
is" without warranty of any kind, either express or implied,
including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, pages
30-44
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbmacro<BR>
KBSubcategory: kbmacroexample<BR>
Additional query words: GetModuleHandle GetModuleUsage winword<BR>
winword2 2.0 2.0a 2.0b 2.0c 2.0a-CD  running declare dll<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
