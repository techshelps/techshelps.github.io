

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD: Calculation in Form Field Shows Wrong Result </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110656">
<META NAME="KBModify" CONTENT="1998/03/04">
<META NAME="KBCreate" CONTENT="1994/01/26">
<META NAME="Keywords" CONTENT="kbproof macword winword word6 word7 word95 word97 macword98 kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When a form field calculation involves another calculated form field, the results may be incorrect.  The two scenarios below illustrate this symptom.  Scenario #1 - No formatting in the Number Format of a Form Field ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QAIH,QAE5,QAPP,QBWR,QAL3 P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Calculation in Form Field Shows Wrong Result</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110656</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a form field calculation involves another calculated form field, the
results may be incorrect.
<P>
The two scenarios below illustrate this symptom.
<P>
<P><h3>Scenario #1 - No formatting in the Number Format of a Form Field</h3>
 
<P>
<PRE>   TYPE OF
   TEXTFORM                                     ACTUAL  EXPECTED
   FIELD          EXPRESSION       BOOKMARK     RESULT   RESULT
   -------------------------------------------------------------

   NUMBER         NONE             Text1         100       100
   CALCULATION    =Text1           Text2         100       100
   CALCULATION    =Text1 + Text2   Text3         100200    200

</PRE>This results in doubling the value of form field 2 (Text2).
<P>
<P><h3>Scenario #2 - Dollar sign on either or both form fields</h3>
 
<P>
<PRE>   TYPE OF
   TEXTFORM                                              ACTUAL  EXPECTED
   FIELD          EXPRESSION     FORMATTING      BKMRK   RESULT   RESULT
   -----------------------------------------------------------------------

   NUMBER       NONE            Dollar Sign     Text1     100       100
   CALCULATION  =Text1          Dollar Sign     Text2    $100      $100
   CALCULATION  =Text1 + Text2  Doesn't Matter  Text3    $300       200

</PRE>This results in doubling the value of form field 2 (Text2).
<P>
<P><h2>CAUSE</h2>
 
<P>
Word defines the bookmarks assigned to the calculation form fields
incorrectly. As a result, Word does not correctly parse these form fields;
it concatenates them instead.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, use any of the following methods.
<P>
<P><h3>Method 1: Avoid Referring to Any Other Calculation Fields</h3>
 
<P>
Change the final calculation to avoid referring to any other calculation
fields. Include all math formulas in one calculation field. This method is
only appropriate for simple calculations.
<P>
In the earlier example, because the third form field includes a formula
from the second form field, the entry in the third form field expression
would need to be changed to: Text1 (Bookmark from the first form field) +
Text1 (Expression from the second form field).
<P>
<P><h3>Method 2: Redefine the Bookmarks So Word Calculates the Formula Correctly</h3>
 
<P>
NOTE: You must repeat this procedure each time you change a particular form
field in the Text Form Field Options dialog box.
<P>
To redefine the bookmarks so Word calculates the formula correctly, use
these steps with each incorrect Calculation form field:

<OL><P><LI>Turn on field code view by pressing ALT+F9 (Windows) or OPTION+F9
   (Macintosh).

<P><LI>Select the Calculation form field that produces incorrect results.
<P>
<P><PRE>    Be sure to include the field brackets ({}) in the selection.
</PRE>
<P><LI>On the Edit menu (Word 6.x, 7.x) or Insert menu (Word 97, Word 98
   Macintosh Edition), click Bookmark.
<P>
<P><PRE>    The bookmark for the selected form field is selected.
</PRE>
<P><LI>Click Add.
<P>
<P><PRE>    This redefines the bookmark to include the field brackets.
</PRE>
<P><LI>Press F9 to update the field, and then press ALT+F9 (Windows) or
   OPTION+F9 (Macintosh) to switch back to field code results view.
<P>
</OL>The result should now be correct.
<P>
<P><h3>Method 3: Define a New Bookmark That Includes the First Calculation Field</h3>
 
<P>
NOTE: You do not need to repeat this procedure if you change the form field
in the Text Form Field Options dialog box.
<P>
To define a new bookmark that includes the first Calculation field in your
formula plus one space following it, follow these steps:

<OL><P><LI>Turn on field code view by pressing ALT+F9 (Windows) or OPTION+F9
   (Macintosh).

<P><LI>Select the first Calculation form field that is referenced in your
   formula (=) field. Include the space that follows this field in your
   selection. The selection should resemble the following example:
<P>
<PRE>         { FORMTEXT {=text1}}
         ^                   ^
         |                   |
         Start of            End of
         selection           selection

</PRE><P><LI>On the Edit menu, click Bookmark.

<P><LI>Type a new name in the Bookmark Name box and then click Add.

<P><LI>Turn off field code view by pressing ALT+F9 (Windows) or OPTION+F9
   (Macintosh).

<P><LI>In your second calculation field, use the bookmark you defined in step 4
   above instead of the bookmark that Word set for the first Calculation
   form field.
<P>
</OL><h3>Method 4: In a Table, Use Table Cell References Rather Than Bookmark Names</h3>
 
<P>
Use table cell references rather than bookmark names in the Calculation
form field.
<P>
NOTE: This method works only if there are no other Number form fields in
any table cell you reference in your Calculation form field.
<P>
For example, change this calculation
<P>
<PRE>   {FORMTEXT {=Text1 + Text2}}

</PRE></OL>to the following
<P>
<PRE>   {FORMTEXT {=A1 + A2}}

</PRE>where the Text1 bookmark is in table cell A1 and the Text2 bookmark is in
table cell A2.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Word User's Guide," version 6.0, pages 309-312
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: append appends<BR>
Keywords          : kbproof macword winword word6 word7 word95 word97 macword98 kbfaq<BR>
Version           : Windows:6.0,6.0a,6.0c,7.0,7.0a,97;Macintosh:5.0,5.1,5.1a,6.0,6.0.1,6.0.1a,9 8<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 4, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
