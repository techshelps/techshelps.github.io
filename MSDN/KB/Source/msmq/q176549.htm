

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Using E-mail to Send Unattended Install Scripts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176549">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/11/10">
<META NAME="Keywords" CONTENT="MQDeploy MQSecurity">
<META NAME="KBArea" CONTENT="Support; KB; msmq">
<META NAME="Description" CONTENT="  The information in this article applies only to the version of Microsoft Message Queue Server (MSMQ) packaged with Microsoft NT Server 4.0 Enterprise Edition. There is a separate article dealing with unattended install scripts and the version of MS...">
<META NAME="Product" CONTENT="msmq">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QARL,QDIZ,QDNQ,QABV,QBWP,QAFI,QAYC,QDL9,QBWQ,QBWO,QBWN,QA3A,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Using E-mail to Send Unattended Install Scripts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176549</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Message Queue Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The information in this article applies only to the version of Microsoft
Message Queue Server (MSMQ) packaged with Microsoft NT Server 4.0
Enterprise Edition. There is a separate article dealing with unattended
install scripts and the version of MSMQ bundled with the Microsoft NT
Option Pack.
<P>
This article describes how to create a series of batch files to automate
the unattended installation of MSMQ Independent and Dependent clients and
MSMQ servers. A batch file can be inserted into an email message with
instructions for the user to double click the batch file icon. This
automatically starts an unattended installation of MSMQ Client or Server
software from an install share on an MSMQ Server. The Msmqinst.ini file
automatically sets all MSMQ settings. However, Windows 95 requires the
Distributed Component Object Model for Windows 95 (DCOM95) prior to
installation.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When determining your client rollout process it is important to consider
the topology of the MSMQ Enterprise Network. For example, let's say you are
an administrator of a firm's computer systems. You have a Primary
Enterprise Controller (PEC) located at the headquarters in Seattle. The
Primary Site Controllers (PSC) are required at three regional branches in
Chicago, New York, and Atlanta. There are 1,000 Independent MSMQ Clients at
each of the four locations. In this case, you need to create a separate
batch file for each type of install. PSC, Independent Client and each of
the four locations.
<P>
Seven different batch files are required for this scenario. The first three
are for each PSC at Chicago, New York, and Atlanta. The last four are for
the independent client installs in Seattle, Chicago, New York, and Atlanta.
The PEC in this case serves as an install share for each of the three PSCs.
When these PSCs are installed, each should be set up with its own install
share. After the PSCs in Chicago, New York and Atlanta are setup and
tested, they can serve as install shares for their individual locations
Independent Client installations. You need to create four Msmqinst.ini
files, one for each site.
<P>
The following lines in a batch file make a net connection to an MSMQ
install share and start the unattended MSMQ Setup routine. The batch file
can then be sent in an e-mail message to the individuals that need to
install MSMQ Independent Client. The following example runs the Setup
routine for an Independent Client in quiet mode.
<P>
<PRE>      @echo off
      Rem
      Rem
      \\server\msmqinst\client.ind\setup /q

</PRE>A separate batch file is required for each type of MSMQ installation. The
Setup in quiet mode references the Msmqinst.ini file in either the install
folder or the Windows folder. If there is a Msmqinst.ini file in both the
MSMQ install folder and the Windows folder, MSMQ Setup uses the
Msmqinst.ini file in the Windows folder. The Msmqinst.ini parameters need
to be set prior running a Setup.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information on an unattended Setup of MSMQ or MSMQ Setup,
refer to the MSMQ Administrator Guide. For sample Msmqinst.ini scripts,
refer to the MSMQ Administrator Guide.
<P>
 
<PRE>Keywords          : MQDeploy MQSecurity
Version           : WINNT:1.0
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
