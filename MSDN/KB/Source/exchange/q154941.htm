

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: How to Determine Which Public Folder Replica is Used </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154941">
<META NAME="KBModify" CONTENT="1997/03/04">
<META NAME="KBCreate" CONTENT="1996/08/19">
<META NAME="Keywords" CONTENT="kbusage XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  In Microsoft Exchange Server, replicas of public folders could be present on several Microsoft Exchange Servers in different Microsoft Exchange Sites of the Microsoft Exchange Organization.  This article describes the algorithm that is used to dete...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRU,QAI5,QAJQ,QBG2,QBVX,QAJP,QADK,QAGU,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: How to Determine Which Public Folder Replica is Used</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154941</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Exchange Server, replicas of public folders could be present
on several Microsoft Exchange Servers in different Microsoft Exchange
Sites of the Microsoft Exchange Organization.
<P>
This article describes the algorithm that is used to determine which
public folder replica is accessed when a user tries to open the contents
of a public folder.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>If an instance of the public folder exists on the user's Public Folder
   Server, that instance is used. The Public Folder Server is determined
   by the Public Folder field on the General property page for the
   client's Private Information Store (IS).

<P><LI>If there is no instance on the user's server, but there is one instance
   in the Site, that instance is used.

<P><LI>If there are several instances in the Site, the IS uses a per computer
   random number (called a connection modulus) to determine which Server
   in the Site it will connect to. This specifies a per computer method of
   determining the connection. In other words, two different users on the
   same computer will connect to the same Server to view the public
   folder.
<P>
   Since the connection modulus is random per computer, this method will
   distribute connections across all the available instances in the Site.
   This provides load balancing to Servers within the Site.
<P>
</OL>NOTE: The connection-modulus server may not be the same for a client for
all public folders. For example, if SERVER1 is the user's Public Folder
Server, and SERVER2 and SERVER3 are other Public Folder Servers in the same
Site that contain replicas of a public folder, FOLDER1. The user's
connection-modulus server could be SERVER3. Now, suppose there is another
public folder, FOLDER2, for which SERVER2, SERVER3, and SERVER4 are Public
Folder Servers containing replicas of this folder. In this case, the user's
connection-modulus for FOLDER2 could be SERVER2.

<OL><P><LI>If the connection modulus server cannot be connected to, the remaining
   Servers in the Site with the replicas are tried. Those Servers that
   already have an RPC connection with the client are tried first.

<P><LI>If no instances are available in the Site, but there is at least one
   Site available with instances, the Affinity to the Sites is used to
   rank the order in which connections to the Sites will be attempted. The
   affinity is set on the site Public Folder Affinity page. It allows an
   administrator to set a cost to each of the other Sites in the
   enterprise.
<P>
</OL>The cost ranks the order the client will attempt connection and the lowest
cost Site is attempted first. Once the Site is determined, its Servers are
tried in random order. If two Sites have the same cost, the Servers in
those Sites are pooled together and tried in a random order. Connections to
Servers in Sites without an affinity setting are not attempted.
<P>
NOTE: Clients must have RPC connectivity to the servers in the Affinity
<PRE>      Sites. Otherwise, the clients will not be able to access the public
      folders in the other Sites, even though the Affinity has been
      correctly set.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hang<BR>
Keywords            : kbusage XADM kbusage<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
