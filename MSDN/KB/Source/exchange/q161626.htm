

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: Troubleshooting IPX/SPX Connections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161626">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/12/31">
<META NAME="Keywords" CONTENT="XCLN kbnetwork kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The client cannot connect to a computer running Microsoft Exchange Server using IPX/SPX. Remote procedure call (RPC) pings work, but not with security. In addition, you may receive the following error:     Your Microsoft Exchange Server is unavaila...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QBWP,QBWO,QBWS,QDL9,QBWN,QDIK,QBWQ,QAVZ,QARL,QBTX,QBWD,QAA1,QABH,QDKF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Troubleshooting IPX/SPX Connections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161626</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows NT client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows 95 client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The client cannot connect to a computer running Microsoft Exchange Server
using IPX/SPX. Remote procedure call (RPC) pings work, but not with
security. In addition, you may receive the following error:
<P>
<PRE>   Your Microsoft Exchange Server is unavailable.

</PRE><h2>CAUSE</h2>
 
<P>
The IPX/SPX protocol is not configured correctly for Microsoft Exchange
Server access.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following is a checklist you can use to ensure that the IPX/SPX
protocol is correctly configured:

<OL><P><LI>Make sure IPX/SPX (NWLINK) is installed on the computer running
   Microsoft Exchange Server, the computer running the Microsoft Exchange
   client, and any primary or backup domain controllers.

<P><LI>Gateway Services for NetWare (GSNW) or File and Print Services for
   NetWare (FPNW) must be installed and running on the computer running
   Windows NT Server and Microsoft Exchange Server.
<P>
   If the client's "primary login" is "Microsoft Network", then FPNW
   must be installed and configured.
<P>
   If the client's "primary login" is "Novell Network", then GSNW
   must be installed and configured.
<P>

<P><LI>Make sure the SAP service is running on the computer running Windows NT
   Server and Microsoft Exchange Server (it should be installed with GSNW
   or FPNW).

<P><LI>If NetWare is the primary network logon, make sure GSNW is installed,
   running, and has a Preferred Server on the computer running Windows NT
   Server and Microsoft Exchange Server (in the GSNW Control Panel, change
   preferred server from &lt;none&gt; to the appropriate Novell Server).

<P><LI>Check IPX/SPX frame types. It is recommended that you manually set this
   on both the computer running Microsoft Exchange Server and its clients.
   (On the computer running Windows NT Server, go to the Network Control
   Panel and click IPX/SPX. Click Properties, click to check "Manual Frame
   Type Detection" and add the appropriate frame type, such as 802.3.)

<P><LI>If "Manual Frame Type Detection" is selected, make sure the network
   number is unique for every server on the network.

<P><LI>Make sure the packet size is the same on Token ring, or a smaller size
   on Ethernet. In the Net.cfg file on computers running Windows for
   Workgroups or Windows 3.1, make sure MaxFrameSize equals an appropriate
   size, such as 1,496. On client computers running Windows 95, go to the
   Network Control Panel, click IPX/SPX, and then click Properties. Click
   Advanced, and set "Force Even Length Packets" to yes. Client computers
   running Windows 95 or Windows NT Workstation should adjust the frame
   size to their primary logon server. On Token ring, if the primary logon
   server is Novell or another computer running Windows NT Server, make
   sure the computer running Microsoft Exchange Server or Windows NT Server
   is set to the same Packet Size.

<P><LI>On computers running Windows for Workgroups or Windows 3.1, open the
   Net.cfg (or Shell.cfg) file and make sure IPX packets=50, IPX
   Sockets=50, and READ ONLY COMPATIBILITY=OFF. In the [NETWORK] section of
   the System.ini file, set Directhost=OFF.
<P>
</OL>If you have verified that IPX is configured correctly, you can use the
following steps for additional troubleshooting:

<OL><P><LI>Run Rpings.exe on the server. Make sure there are valid endpoints (set
   for use) for ncadg_ipx and ncacn_spx.

<P><LI>Run Rpingc32.exe on client computers running Windows 95 or Windows NT
   Workstation, to make sure IPX/SPX can complete an RPC "ping" to the
   server. Also try this "with security."

<P><LI>On the client, try logging in without using default network security.
   (On the Tools menu, click Services. Select Microsoft Exchange Server,
   click Properties, and then click Advanced. Click to clear the check from
   "use network security during logon.") This forces a prompt to appear
   for the user to enter Windows NT Server domain, account, and password
   information.

<P><LI>Update the IPX/SPX drivers.
   The latest version, as of 11/96, is VLM 1.21 and is available on 
   <B><A HREF="http://www.novell.com">http://www.novell.com.</A></B> Search for VLM Client Kit for Dos/MS Windows v1.21.
<P>
   NOTE: Many old VLM NetWare drivers will not connect to Microsoft
   Exchange Server. On computers running Windows for Workgroups 3.11 or
   Windows 3.1, you may need updated versions of Nwipxspx.dll and
   Nwcalls.dll.

<P><LI>Move ncacn_spx to be first in the binding order. Reboot.

<P><LI>If there is a Microsoft Proxy Server installed on the network, try
   turning off DNS. (In the Network Control Panel, select TCP/IP and click
   Properties. Click the DNS Configuration tab, and click Disable DNS.)
   You can keep the TCP/IP functionality by adding to the hosts file. In
   the hosts file, make one entry for the Microsoft Exchange Server as
   &lt;IP address&gt; &lt;Microsoft Exchange Server Name, or NetBIOS name&gt;, and one
   for the Proxy Server as &lt;IP Address&gt; &lt;proxy server fully qualified
   domain name, such as server.company.com&gt;.

<P><LI>Check the Event Viewer on the computers running Windows NT Server
   (the computers running Microsoft Exchange Server, the PDC, or the BDC
   servers) for errors.

<P><LI>Check the network settings to make sure that there are no compression
   settings on the network routers. If so, try removing compression on
   the routers. (If compression on routers is an issue, contact the router
   manufacturer to see if there are any known issues with Windows NT
   Server.)

<P><LI>Make sure IPX/SPX is routable on the network.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
For more information, see the following article in the Microsoft Knowledge
Base, the Microsoft Exchange Installation Guide - the Introduction and 
Appendix A, and the Readme.wri file on the Microsoft Exchange Client 
Software compact disc:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q136516.htm">Q136516</A></B>
   TITLE     : XCLN: Improving Windows Client Startup Times
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbfaq<BR>
Keywords          : XCLN kbnetwork kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
