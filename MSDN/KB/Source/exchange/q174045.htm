

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: Installing and Using the CleanSweep Tool </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174045">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1997/09/18">
<META NAME="Keywords" CONTENT="XCLN kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article discusses how to obtain, install and use the CleanSweep tool. This  tool enables you to delete permissions, forms, views, rules, or reply rule  templates from a Microsoft Exchange Server mailbox. When you delete the rules  and permissi...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QBWP,QAYC,QAPF,QARL,QAIB,QAEF,QAB5,QBWQ,QBWS,QBMI,QBKX,QBJZ,QDL9,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Installing and Using the CleanSweep Tool</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174045</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to: 

<UL><LI>Microsoft Exchange Windows 95 client, version 5.0
<LI>Microsoft Exchange Windows NT client, versions 4.0 and 5.0
<LI>Microsoft Outlook Windows 95 client, versions 8.00, 8.01, 8.02, and 8.03
<LI>Microsoft Outlook Windows NT client, versions 8.00, 8.01, 8.02, and 8.03
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses how to obtain, install and use the CleanSweep tool. This 
tool enables you to delete permissions, forms, views, rules, or reply rule 
templates from a Microsoft Exchange Server mailbox. When you delete the rules 
and permissions associated with a folder, all rules and permissions for 
the folder are deleted. This utility is useful for cases where it has been 
determined that Out of Office (OOF) messages or other rules are not functioning 
properly.
<P>
Note: You may view a list of this and other BackOffice and Exchange Resource Kit 
extentions and download them from <B><A HREF="http://backoffice.microsoft.com/">http://backoffice.microsoft.com/.</A></B>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The CleanSweep tool may be obtained from the Microsoft BackOffice Resource Kit, 
Part Two compact disk.
<P>
NOTE: The CleanSweep tool does not work with the Microsoft Exchange Windows 95 
client, version 4.0. It is recommended that you use this extension with the 
following clients:
<P>
<PRE>   Microsoft Exchange Windows 95 client, version 5.0
   Microsoft Exchange Windows NT client, versions 4.0 and 5.0
   Microsoft Outlook Windows 95 client, versions 8.00, 8.01, 8.02, and 8.03
   Microsoft Outlook Windows NT client, versions 8.00, 8.01, 8.02, and 8.03

</PRE><h3>Installing the CleanSweep Tool</h3>
 
<P>
To install the extension, follow these steps:

<OL><P><LI>From the Exchange\&lt;operating system&gt;\&lt;platform&gt;\Admin\Cleanswp subdirectory 
   of the Microsoft BackOffice Resource Kit, Part Two compact disk, copy 
   CLNSWP32.DLL to your system directory (\System32 on Windows NT).

<P><LI>Using the Registry editor (RegEdit.exe for Windows 95 or RegEdt32.exe for
   Windows NT), add the CLNSWP value to the following Registry key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Exchange\Client\Extensions
</PRE>
<P><LI>Enter the following text as a String (REG_SZ) value:
<P>
<P><PRE>      4.0;&lt;drive&gt;:\&lt;path&gt;\CLNSWP32.DLL;2
</PRE><P>
   ...where &lt;drive&gt; and &lt;path&gt; indicate the location in which you copied
   the file. The following example assumes the file is located in the 
   C:\WINNT\SYSTEM32 directory:
<P>
<P><PRE>      4.0;C:\WINNT\SYSTEM32\CLNSWP32.DLL;2
</PRE>
<P><LI>Exit the Registry Editor.

<P><LI>Restart the Microsoft Exchange or Microsoft Outlook client.
<P>
</OL>NOTE: You must verify that the Ctl3d32.dll file exists in the System or 
System32 directory. The Clnswp32.dll calls this file and it may not be 
installed by default. If it does not exist, extract it from the Microsoft 
Exchange Client compact disk. To do this, follow these steps:

<OL><P><LI>Open a command prompt.
</OL>2. Change to the compact disk drive.
3. Under Windows 95, enter CD\Win95 and press Return.
<PRE>   Under Window NT, enter CD\Winnt\I386 and press Return.
</PRE></OL>4. Enter the following extract command to extract the file:
<P>
<PRE>      extract /a exchng4.cab ctl3d32.dll /L  C:\Windows\System

      -or-

      extract /a exchng4.cab ctl3d32.dll /:L  C:\Winnt\System32

</PRE>For the Microsoft Outlook 97 Client that is shipped with Exchange Server 
version 5.5, the CTL3D32.DLL file can be found in the \&lt;platform&gt;\Os 
directory.
<P>
<P><h3>Using the CleanSweep Tool</h3>
 
<P>
When the CleanSweep tool is installed, the Clean Sweep option is added to the 
Tools menu of the Microsoft Exchange or Microsoft Outlook client. To use the 
CleanSweep extension, follow the steps below:

<OL><P><LI>OPTIONAL: Save any existing rules prior to running the Clean Sweep tool.
   For more information on how to save existing rules, see the following article
   in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../EXCHANGE/Q152852.htm">Q152852</A></B> 
      TITLE: XADM: Steps to Move User and Inbox Assistant Rules
</PRE>
<P><LI>Select the folder (such as Inbox) that contains the items you want to delete.

<P><LI>From the Tools menu, select Clean Sweep.

<P><LI>Select the items to delete. Choose OK.
<P>
<P>
</OL>Listed below are two scenarios in which you might need to run the CleanSweep tool:
<P>
A. The Out of Office Assistant responds with two OOF messages instead of one
<PRE>   message. To correct this behavior, follow these steps:

   1. Select the Inbox folder.
   2. Choose Clean Sweep from the Tools menu.
   3. Select the Rule Reply Templates option.
   4. Select the Details button and check all boxes that contain the following text:

      &lt;no subject&gt;

   5. Choose OK twice.
   6. In the OOF Assistant, delete and recreate the OOF rule.

      Note: The steps above will remove the multiple OOF replies, but will not
            delete the Inbox Assistant rules.

</PRE></OL>B. The Out of Office Assistant responds to incoming mail even when it has been
<PRE>   disabled. To correct this behavior:

   1. Start the CleanSweep tool.
   2. Select Rules and Rule Reply Templates.
   3. Select the Details button and select ONLY the boxes titled then select OK
      on this dialog box.
   4. Choose OK.
   5. In the OOF Assistant, delete and recreate the OOF rule.

   Note: This will correct the OOF if it is corrupt and not firing, or if it is
         firing even when disabled. However, as a side effect you will lose all
         Inbox Assistant rules as well.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: clean sweep<BR>
Keywords          : XCLN kbhowto<BR>
Version           : 4.0 5.0 8.00 8.01 8.02 8.03<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
