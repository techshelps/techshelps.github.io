

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCON: Event Error 3120: A Resource Limit has Been Reached </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155302">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1996/08/26">
<META NAME="Keywords" CONTENT="XCON kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Message Transfer Agent (MTA) terminates with an Event ID 9405 and the following sequence of events appears in the Event Log:     Event ID 2037  An internal MTA error occurred. There is a negative    connection count for local...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO4,QAPN,QAAP,QAB4,QABA,QA4H,QA2O,QAZV,QAIM,QAH4,QABN,QBG2,QASP,QAH6,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Event Error 3120: A Resource Limit has Been Reached</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155302</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Message Transfer Agent (MTA) terminates with an
Event ID 9405 and the following sequence of events appears in the Event
Log:
<P>
<PRE>   Event ID 2037  An internal MTA error occurred. There is a negative
   connection count for locality 52. [BASE KERNEL 6 117] (10)

   Event ID 2197  An MTA database server error was encountered while
   locking a queue. Called from XAPI. Procedure 131. Database error code:
   ODXOINIU - Object does not exist. Queue: 00000000. [DB Server TRANSFER
   28 84] (14)

   Event ID 2191  An MTA database server error was encountered while 
   adding an entry to a queue. Called from XAPI. Procedure 131. Database 
   error code: ODXOINIU - Object does not exist. Queue name: 00000000. 
   Object at fault: 060000EE. [DB Server TRANSFER 28 62] (14)

   Event ID 2198  An MTA database server error was encountered while
   unlocking a queue. Called from XAPI. Procedure 131. Database error 
   code: ODXOINIU - Object does not exist. Queue: 00000000. [DB Server 
   TRANSFER 28 127] (14)

   Event ID 3128  An MTA database server error was encountered. [XAPI
   TRANSFER 28 131] (14)

   Event ID 3120  A resource limit has been reached when attempting to 
   open an association. Number of sessions configured: 80. [XAPI MAIN BASE 
   1 91] (14)

   Event ID 9405  An unexpected error has occurred which may cause the MTA
   to terminate. Error: ExchHeapFree Failure. [BASE INCOMING RPC 193] (16)

   Event ID 9405 An unexpected error has occurred which may cause the MTA
   to terminate. Error: Exception e0020002 occurred at Address 77f3cbcd
   [BASE INCOMING RPC 193] (16)

</PRE>Note that in the example above, these events appear in the order in which
they occurred; they appear in this order if the Event Viewer is configured
to view the oldest events first.
<P>
<P><h2>CAUSE</h2>
 
<P>
The MTA terminated due to a resource shortage. The MTA is attempting to 
add local resources for remotely-hosted connectors such as the Internet 
Mail Connector (IMC) or the MS Mail Connector (MSMI).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Change the following registry entry to 0x20 to avoid this resource
shortage:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services
                     \MSExchangeMTA\Parameters\MT gateway clients

</PRE>The default setting is 0x08 and is adequate under normal conditions.
However, when an installation has several gateways and connectors
configured, additional resources may be required.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Crash SP2 stop ECB ASB shortage bind<BR>
Keywords          : XCON kbusage<BR>
Version           : 4.0 4.0a 5.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
