

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Suitable Applications for Exchange Server Event Scripting </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181036">
<META NAME="KBModify" CONTENT="1998/02/17">
<META NAME="KBCreate" CONTENT="1998/02/13">
<META NAME="Keywords" CONTENT="XADM XGen kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Microsoft Exchange Server 5.5 Scripting Agent provides the ability to run server-side scripts in response to events that occur in folders, including private mailboxes. This article will explain why the proper application of Event Scripting is limit...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAO4,QAPN,QAEV,QBWS,QA5M,QAYC,QART,QAFI,QAJH,QBWP,QBVV,QAEF,QBMI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Suitable Applications for Exchange Server Event Scripting</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181036</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Exchange Server 5.5 Scripting Agent provides the ability to run
server-side scripts in response to events that occur in folders, including
private mailboxes. This article will explain why the proper application of
Event Scripting is limited to medium-volume workflow and administrative
applications.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Because the Microsoft Exchange Server 5.5 Scripting Agent permits scripts
to run against individual mailboxes, many developers have attempted to
write Inbox Agents in VBScript. These attempts have yielded poor results,
because the Event Scripting Agent is not designed to replace traditional
mailbox agents written in C/C++. Such agents are normally used to scan
every piece of mail in or out of the system for viruses, or to archive
every message for government record-keeping purposes.
<P>
There are several vital limitations to the Microsoft Exchange Event Service
that render it unsuitable for such applications:
<P>
- There is no guarantee that a script will see every message. The Event
<PRE>   Service fires events asynchronously with respect to the Microsoft
   Exchange information store. This means that the information store does
   not block an event script (wait for it to run) before letting other
   processes or users access the folder or message. Consequently, that
   message could be moved, copied, deleted, or modified before a script has
   a chance to run. For example, a script to process all outgoing messages,
   applied to the OnMessageCreated event in the Outbox folder, may not
   react to the event before the new message has been delivered and deleted
   from your Outbox.

</PRE>- Some of these types of scripting applications may face problems of
<PRE>   scale. Depending on the application's purpose, either the script would
   have to be manually installed in every folder for every user, or event
   volume would simply be too high to process with an interpreted language
   like VBScript.

</PRE>- When a VB script runs for every new message arriving at a folder, the
<PRE>   performance of Exchange Server will slow to that of your script.

</PRE>- Event Scripts run in a privileged Windows NT security context, that of
<PRE>   the Exchange Server service account. One grave consequence of this
   arrangement is the possibility that a script can open any mailbox on the
   server and make changes to the contents, without the owner's knowledge.
   The Exchange 5.5 Release Notes state: "The Scripting Agent is not a
   safe, general purpose replacement for the Inbox Assistant rules because
   it allows new code to be installed and run on your servers."

</PRE><h2>REFERENCES</h2>
 
<P>
<PRE>   Microsoft Exchange Scripting Agent Help File
   Microsoft Exchange Server 5.5 Release Notes
   Microsoft Exchange Server Product Group

</PRE> 
<PRE>Keywords          : XADM XGen kbusage
Version           : WINDOWS:5.5
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 17, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
