

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: Troubleshooting Client Memory Issues on Windows 3.x </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161468">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1996/12/23">
<META NAME="Keywords" CONTENT="kb3rdparty kbinterop kbusage XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The 16-bit Microsoft Exchange Windows 3.x client (the 16-bit Microsoft Exchange client) is the client that is installed for users running Windows 3.1 or Windows for Workgroups version 3.11 operating systems.  Memory Issues with the 16-bit Client: T...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW6,QBWO,QDL9,QBWN,QBWQ,QARL,QAIJ,QBWS,QDIV,QAEF,QBE7,QBE6,QBCU,QAM1,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Troubleshooting Client Memory Issues on Windows 3.x</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161468</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows 95 client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows NT client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The 16-bit Microsoft Exchange Windows 3.x client (the 16-bit Microsoft
Exchange client) is the client that is installed for users running Windows
3.1 or Windows for Workgroups version 3.11 operating systems.
<P>
Memory Issues with the 16-bit Client: The most common symptom of low memory
conditions on a 16-bit client is that the Microsoft Exchange client starts,
but no other Windows application runs as long as the Microsoft Exchange
client is running. This issue is directly related to amount of available
memory below 640 KB (conventional memory). If you encounter a situation in
which there is not enough memory below 640 KB in the Windows system virtual
machine to create a task database (TDB), you may receive "Out of memory"
and "Insufficient memory" errors in the Microsoft Windows 3.1x and Windows
for Workgroups 3.1x operating systems.
<P>
Low memory errors are more prevalent on computers running Windows 3.x using
IPX/SPX. Conventional memory is even more restricted on computers using
Token Ring network cards. Computers running TCP/IP or NetBEUI have much
lower conventional memory requirements. In most cases, these requirements
can be eliminated by optimizing the configuration and following the steps
in the Troubleshooting section below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Troubleshooting 16-Bit Memory:
<P>
The following is a list of steps that you can use to help reduce "Out of
memory" errors when starting the Microsoft Exchange client.

<OL><P><LI>Optimize conventional memory as much as possible. If you have MS-DOS
   version 6.0 or 6.2, use MemMaker to optimize conventional memory.

<P><LI>Change the order in which your programs or drivers load. This may alter
   where the fixed code gets located, and minimize memory fragmentation.

<P><LI>Disable any applications that start automatically when you start
   Windows (check the Win.ini file Load= and Run= lines and the Startup
   group).

<P><LI>Run Windows Setup and change to standard Windows drivers (for example,
   a standard VGA video driver and no mouse).

<P><LI>Use the Program Manager (Progman.exe) as your Windows shell.

<P><LI>Remove any third-party Windows drivers or virtual device drivers (VxDs).

<P><LI>On computers running Windows for Workgroups, click to clear the check
   from the option to use Network DDE (this option is found in the Network
   Control Panel under Start Up). Doing this saves 60 KB of conventional
   memory.

<P><LI>Configure the computer to use either TCP/IP or NetBEUI.

<P><LI>Test a single computer using the Memvalet utility.
<P>
</OL>Memory Valet:
<P>
If the computer's conventional memory has been fully optimized and the
16-bit client still generates "Out of memory" errors, try to use a utility
that forces DLLs to load in upper memory, such as Memvalet.
<P>
NOTE: Memvalet has not been specifically tested with the Microsoft Exchange
client, and is an unsupported utility. This utility should be used only
after normal troubleshooting steps have failed. You can find this utility
at the following address:
<P>
<PRE>   <B><A HREF="ftp://ftp.microsoft.com/bussys/exchange/exchange-unsup-ed/Memval.zip">ftp://ftp.microsoft.com/bussys/exchange/exchange-unsup-ed/Memval.zip</A></B>

</PRE></OL>How Memory Valet Works:
<P>
A TDB is required for each Windows-based application that is loaded. The
TDB requires 512 bytes of fixed, contiguous memory, and it must be below
640 KB (that is, in the low-memory area). If the Windows loader cannot find
the memory for a TDB below 640 KB, it does not try to find the memory above
640 KB; instead, it fails and returns an "Out of memory" error.
<P>
When Windows starts, Memory Valet allocates a block of memory below 640 KB
and "stripes" it with alternating 512-byte and 32-byte allocations. The 512-
byte allocations are free, contiguous spaces that are available for use by
applications. As new non-TBD requests for fixed memory (which the Windows
memory manager allocates to the lowest address space possible) begin to
fill the lower memory spaces, Memory Valet forces them into higher address
spaces, thus reserving the lowest memory slots for new TBDs. An alternative
to Memory Valet is a utility from Gamma Research Inc. that is similar to
Memvalet called Moremem. Please see <B><A HREF="http://www.moremem.com">http://www.moremem.com</A></B> for more
information.
<P>
Moremem is distributed by Gamma Research Inc., a vendor independent of
Microsoft; we make no warranty, implied or otherwise, regarding this
product's performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kb3rdparty kbinterop kbusage XCLN<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
