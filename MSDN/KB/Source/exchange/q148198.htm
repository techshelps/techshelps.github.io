

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Where Newprof.exe Gets the Username </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148198">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/03/09">
<META NAME="Keywords" CONTENT="XADM kbsetup kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Automatic Profile Generator (Newprof.exe) reads a Profile Descriptor File (PRF) and creates a profile based on the information in this file. One of the settings in the PRF is for the Microsoft Exchange mailbox name for which ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QAA1,QDI2,QDIZ,QAGU,QBWF,QDJ2,QBVV,QAB4,QARM,QARL,QBWD,QAUD,QAH4,QBSZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Where Newprof.exe Gets the Username</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148198</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The Information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Exchange Automatic Profile Generator (Newprof.exe) reads a
Profile Descriptor File (PRF) and creates a profile based on the
information in this file. One of the settings in the PRF is for the
Microsoft Exchange mailbox name for which the profile is being created. If
this entry is missing or does not have a value associated with it,
Newprof.exe automatically inserts a user name into the profile. The user
name inserted may or may not be a valid Microsoft Exchange user.
<P>
This article explains where Newprof.exe gets the user name that it uses in
the profile.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When it creates a profile, Newprof.exe looks in the PRF for the
MailboxName= entry under the section containing the Microsoft Exchange
Server Service settings. If this entry is missing or empty, Newprof.exe
uses the user name specified during the Setup process.
<P>
Most Microsoft products use a setup toolkit (ACME) for their Setup
programs. When the Setup program is run, users are prompted for their name
and company name. This information is saved on the local computer for later
use. This allows the Setup program to automatically populate the above
information if the user has run the Setup program for most other Microsoft
products.
<P>
Newprof.exe reads this setup information to obtain the user name, and adds
this user name to the profile being created.
<P>
Depending on the operating system of the client computer, the Setup
information is saved in different locations.
<P>
Windows NT or Windows 95:
<P>
Under Windows NT and Windows 95, the setup user information is saved in the
Registry in the following Key:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\MS Setup(ACME)\User Info

</PRE>The above key has two values: DefName and DefCompany, for the user name and
company name, respectively.
<P>
Windows 3.x:
<P>
Under Windows 3.x, the setup information is saved in the Win.ini file, in
the following section:
<P>
<PRE>   [MS User Info]
   DefName= &lt;User Name&gt;
   DefCompany= &lt;Company Name&gt;

</PRE>Since the Microsoft Exchange Client Setup program does not check the user
and company name entered by the user, it is possible that the default
profile created by Newprof.exe, when it is spawned by the client Setup
program, will contain a user name not found in the Microsoft Exchange
Directory. In this case, when the user runs the Microsoft Exchange client
for the first time, the following error message will be displayed:
<P>
<PRE>   Microsoft Exchange could not be started. The name could not be matched
   to a name in the address list."

</PRE>Upon clicking the OK button, the Microsoft Exchange Server Properties
dialog will be displayed that allows the user to change the Microsoft
Exchange account and/or server name.
<P>
In order to avoid confusing users when they see the above dialog, one
workaround to this problem will be to manually edit the Default.prf file
present in the client installation share point. Edit the entry MailboxName=
in the [Service2] section with the following information and if the entry
is not present, add it:
<P>
<PRE>   MailboxName= Enter your Microsoft Exchange Mailbox Name

</PRE>Now when the Microsoft Exchange Client Setup program is run, the default
profile created will have "Enter your Exchange Mailbox Name" as the mailbox
name. When the Microsoft Exchange client is run for the first time, it will
not be able to find an entry in the Microsoft Exchange Directory with the
name "Enter your Exchange Mailbox Name". This will cause the Microsoft
Exchange client to display the error message indicating that the name could
not be matched in the address list. Upon clicking OK to dismiss the error
message, the Microsoft Exchange Server Properties dialog will be displayed.
The edit box for the mailbox name will contain "Enter your Exchange Mailbox
Name". The user can then enter his/her mailbox name and then click on the
CheckName button to verify the name entered.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbfaq<BR>
Keywords          : XADM kbsetup kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
