

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Adding/Removing Recipient Containers to MSMail Dir-Sync </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152935">
<META NAME="KBModify" CONTENT="1997/04/21">
<META NAME="KBCreate" CONTENT="1996/06/25">
<META NAME="Keywords" CONTENT="kbinterop XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT=" SYMPTOM  When a Microsoft Exchange Server is participating as a requestor in the Microsoft Mail directory synchronization (dir-sync), entire Microsoft Mail postoffice lists may be removed from the Global Address List (GAL).  CAUSE =====  When a Micr...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR2,QAEF,QAW6,QA3P,QAY2,QAYC,QDH6,QA9N,QAY4,QANJ,QAGU,QAE1,QACI,QDKD,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Adding/Removing Recipient Containers to MSMail Dir-Sync</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152935</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOM</h2>
 
<P>
When a Microsoft Exchange Server is participating as a requestor in the
Microsoft Mail directory synchronization (dir-sync), entire Microsoft Mail
postoffice lists may be removed from the Global Address List (GAL).
<P>
<P><h2>CAUSE</h2>
 
<P>
When a Microsoft Exchange Server is participating as a requestor in the
Microsoft Mail dir-sync, inappropriately adding and removing recipient
containers into and out of the dir-sync stream can generate large numbers
of dir-sync transactions and potentially result in the accidental removal
of entire Microsoft Mail postoffice lists from the Global Address List
(GAL).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article details how to avoid generating these excess dir-sync
transactions in three situations: when exporting Microsoft Exchange users
into the dir-sync stream, with Microsoft Mail, and with a link monitor.
<P>
Generally, Exchange Server participates as a requestor to the Microsoft
Mail dir-sync for the purpose of exporting:

<UL><LI>Exchange users into the dir-sync stream.
<LI>Custom recipients (non-Microsoft Mail) into the shared file system (SFS)
   dir-sync stream.
<P>
</UL>For administrative and organizational purposes, various recipients may be
grouped into specific recipient containers. For instance, all Exchange
users within a site may be grouped into one or more recipient containers.
Likewise, custom recipients can be logically grouped into recipient
containers--for instance, all external SMTP recipient addresses may be
grouped into one or more recipient containers.
<P>
These recipient containers are added to, or removed from, the Microsoft
Mail directory synchronization (dir-sync) stream as follows:

<OL><P><LI>Start the Microsoft Exchange Administrator program,  and expand the
   Site, Configuration, and Connections containers.

<P><LI>Double-click the dir-sync-requestor object, click the Export Containers
   tab, and modify the Export these Recipients field.
<P>
</OL>The act of adding these recipient containers to, or removing them from, the
Microsoft Mail dir-sync stream results in a large number of dir-sync
transactions. Dir-sync messages containing Add, Modify, Delete, or Replace
transactions are sent to the dir-sync server (DSS). These messages contain
the standard dir-sync transactions, but the transactions can combine in
ways that are unexpected.
<P>
Exchange Recipient Containers:
<P>
By default, new Exchange mailboxes are created in the site’s recipients
container. However, an alternate container can specified on the Advanced
property page.
<P>
Microsoft Mail Custom Recipients Containers:
<P>
When a Microsoft Exchange Server system is functioning as a requestor to
SFS dir-sync, do not allow custom recipients for users on Microsoft Mail
postoffices to be exported from Exchange to the SFS DSS. Only SFS
postoffices hosting these users should be sending updates or modifications
about their users to the DSS.
<P>
If you create custom recipients for Microsoft Mail postoffice users within
Microsoft Exchange Server, create these recipients in containers that are
not exported (for dir-sync). Additionally, the custom recipients may be
hidden or the trust level raised to 100 to prevent them from exporting.
<P>
Exporting these custom recipients and/or removing their container(s) from
the list of exported recipients can result in Replace transactions for the
SFS users' postoffices added to the list of pending dir-sync transactions.
This can result in unnecessary dir-sync processing and in the temporary
loss of PCMail address information from Global Address Lists (GALS).
Subsequent recovery can require large numbers of dir-sync transactions.
<P>
Exchange Link Monitor:
<P>
When configuring a link monitor to a Microsoft Mail postoffice, the
administrator must configure a bogus custom recipient so that the
postoffice will be monitored. The link monitor then sends messages to this
bogus custom recipient. When the Microsoft Mail message transfer agent
(MTA) determines that the user does not exist, a non-delivery report (NDR)
is sent back to the link monitor. Reception of the NDR by the link monitor
confirms that the link is up and working properly. If no NDR is received
within the configured time frame, the link monitor signals that the link is
down.
<P>
Adding or removing this custom recipient to or from the dir-sync stream can
result in a Replace for this user’s postoffice being added to the list of
pending dir-sync transactions. During the next T2 cycle, the DSS will
process this transaction, effectively instructing all other postoffices
participating in dir-sync to remove this postoffice’s entire list from
their GALs. This can be resolved by doing a full export from the postoffice
that is not currently in the GAL and completing the manual dir-sync
process. After performing a full export from the missing postoffice(s), the
normal dir-sync cycle should restore the missing addresses.
<P>
To avoid this problem, create link monitor recipients in their own
container and do not export them into the dir-sync process. Another
suggestion is to set the trust level of the custom recipient container to
100 to prevent the recipients from exporting to Microsoft Mail. For more
information on link monitors, review Chapter 16 of the Exchange
Administrator's Guide. For more information on directory synchronization
with other systems (such as Microsoft Mail), review Chapter 14 of the
"Microsoft Exchange Server Administrator's Guide."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: addresses missing disappear lost link monitor<BR>
gone<BR>
Keywords            : kbinterop XADM<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
