

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Creating First/Last Names for MS Mail Custom Recipients </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148500">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1996/03/14">
<META NAME="Keywords" CONTENT="kbusage XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When you use Directory Synchronization between Microsoft Exchange and Microsoft Mail, custom recipients are created on the Microsoft Exchange side for each Microsoft Mail user.  When you look at the properties of the created custom recipients, the ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAML,QAUJ,QAR2,QAYZ,QA7O,QA7N,QA5V,QA3P,QARM,QBRZ,QARW,QABH,QABI,QAQ7,QBVP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Creating First/Last Names for MS Mail Custom Recipients</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148500</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use Directory Synchronization between Microsoft Exchange and
Microsoft Mail, custom recipients are created on the Microsoft Exchange
side for each Microsoft Mail user.
<P>
When you look at the properties of the created custom recipients, the
Firstname and Lastname fields are empty. This is because, on the Microsoft
Mail side, each account has only a Display Name and there are no separate
fields for the first and the last names. As a result of this, when the
custom recipients are created on the Microsoft Exchange side, there is no
information available to fill the Firstname and Lastname fields of the
custom recipients.
<P>
Empty Firstname and Lastname fields can cause address resolution from the
client to behave differently than that for Microsoft Exchange mailboxes.
This might be noticed in the client, when the Check Names command does not
bring up a list of all possible matches and does not find Microsoft Mail
custom recipients created during Directory Synchronization. The reason for
this is that the Check Names command uses the Lastname and Firstname fields
for Address Resolution. For more information on how the Check Names command
works, please refer to the following article:
<P>
<PRE>   Article ID: <B><A HREF="../EXCHANGE/Q147400.htm">Q147400</A></B>
   TITLE     : XCLN: How the Check Names Command Works

</PRE>This article describes a way to automatically parse the Display Name and
then populate the Firstname and Lastname fields of all Microsoft Mail
custom recipients.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The process of modifying the custom recipient information involves
exporting the custom recipient data to a text file, modifying this text
file, and then re-importing this data back into the Microsoft Exchange
directory. The steps below indicate how this is done.
<P>
The following steps refer to Microsoft Excel 7.0. Most other spreadsheet
programs can also be used. We assume that Directory Synchronization has
been used to create the Microsoft Mail custom recipients and that these
recipients are created in a recipient container called MS Mail Users. The
Display name of the custom recipients is assumed to have the format:
&lt;FirstName&gt; &lt;LastName&gt;

<OL><P><LI> From the Microsoft Exchange Administrator program, select the Directory
<P><PRE>    Export command from the Tools menu.
</OL></PRE>2.  Select the container that holds the MS Mail custom recipients (MS Mail
<PRE>    Users).
</PRE></OL>3.  Select a file to export the information to (Msmail.csv).
4.  In the Export Objects section, select only Custom Recipient.
5.  Click the Export button. This should export all the user information to
<PRE>    the file selected (Msmail.csv).
</PRE>6.  Open the file Msmail.csv in Microsoft Excel, or any other spreadsheet
<PRE>    that can read delimited text files.
</PRE>7.  The first line in this file should contain the object field names.
<P>
For the rest of the steps we assume that the rows are labeled numerically
and the columns alphabetically. In other words, the rows start from 1, and
the columns from A.

<OL><P><LI> Search for the field, First Name. Normally this field should be in
<P><PRE>    Column B.
    Search for the field, Last name. Normally this field should be in
    Column C.
    Search for the field, Display Name. Normally this field should be in
    Column D.
</OL></PRE>9.  Click on cell B2. This cell is for the First name of the first record
<PRE>    and should be empty.
    Type in =LEFT(D2,FIND(" ",D2)-1).
    Hit the Enter key.
    Cell B2 should now have the first word of the contents of Cell D2.
    Assuming that Display Name has the format: &lt;FirstName&gt; &lt;Last Name&gt;,
    cell B2 should contain the first name of the custom recipient.
</PRE></OL>10. Click on cell C2. This cell is for the Last name of the first record
<PRE>    and should be empty.
    Type in =RIGHT(D2,LEN(D2)-LEN(B2)-1).
    Hit the Enter key.
    Assuming that Display Name has the format: &lt;FirstName&gt; &lt;Last Name&gt;,
    cell C2 should contain the last name of the custom recipient.
</PRE>11. Select the cell B2.
<PRE>    Move the mouse cursor to the bottom right corner of this cell. The
    cursor should now change to a + (plus) sign.
</PRE>12. While the cursor is a + sign, hold down the left mouse button and
<PRE>    drag the cursor to the last row. Now release the left mouse button.
    For each row, Column B should now be filled with the first name of
    the custom recipient specified in that row.
</PRE>13. Select the cell C2.
<PRE>    Move the mouse cursor to the bottom right corner of this cell. The
    cursor should now change to a + (plus) sign.
</PRE>14. While the cursor is a + sign, hold down the left mouse button and
<PRE>    drag the cursor to the last row. Now release the left mouse button.
    For each row, Column C should now be filled with the last name of
    the custom recipient specified in that row.
</PRE>15. Save the file and exit out of Microsoft Excel.
16. From the Microsoft Exchange Administrator program, select the
<PRE>    Directory Import command from the Tools menu.
</PRE>17. Select the file we just modified (Msmail.csv).
18. Click the Import button.
19. After the Import has completed, check the properties of the Microsoft
<PRE>    Mail custom recipients we just modified. Each custom recipient should
    now have the First and Last name fields populated.

</PRE>If the Display Name is in a different format than the one assumed above
(&lt;FirstName&gt; &lt;Lastname), the formula specified in steps 9 and 10 will need
to be modified depending on the format of the display name. The rest of the
steps will remain the same.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbusage XADM<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
