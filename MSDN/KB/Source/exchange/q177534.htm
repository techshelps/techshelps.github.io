

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: LME-PROFS-MEXDIA Crashes Processing a Long File Extension </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177534">
<META NAME="KBModify" CONTENT="1998/01/05">
<META NAME="KBCreate" CONTENT="1997/12/02">
<META NAME="Keywords" CONTENT="kbbug5.00 XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="-   The Microsoft Exchange to OV/VM transform (LME-PROFS-MEXDIA) process may terminate unexpectedly with an access violation. The resulting Drwtsn32.log and/or User.dmp may have a stack back trace similar to the following:      function: XFMDOSFEMFin...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7R,QAI4,QAYA,QBFY,QAOG,QAEV,QAYC,QAR4,QAEF,QBW7,QAI5,QBWG,QAKP,QDJO,QA5T V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: LME-PROFS-MEXDIA Crashes Processing a Long File Extension</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177534</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
<LI>Linkage Message Exchange, version 3.2
</UL> 
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange to OV/VM transform (LME-PROFS-MEXDIA) process may
terminate unexpectedly with an access violation. The resulting Drwtsn32.log
and/or User.dmp may have a stack back trace similar to the following:
<P>
<P>
<PRE>   function: XFMDOSFEMFind
           0037defe 837de800         cmp   dword ptr [ebp-0x18],0x0
</PRE>ss:018cdca6=????????
<PRE>           0037df02 0f850b000000     jne     XFMDOSFEMFind+0xc0 (0037df13)
           0037df08 66c745e40200     mov     word ptr [ebp-0x1c],0x2
</PRE>ss:018cdca7=????
<PRE>           0037df0e e916000000       jmp     XFMDOSFEMFind+0xd6 (0037df29)
           0037df13 8b45e8           mov     eax,[ebp-0x18]
</PRE>ss:018cdca6=????????
<PRE>           0037df16 83c008           add     eax,0x8
           0037df19 8945fc           mov     [ebp-0x4],eax
</PRE>ss:018cdca6=????????
<PRE>           0037df1c 8b45fc           mov     eax,[ebp-0x4]
</PRE>ss:018cdca6=????????
<PRE>           0037df1f 668b4004         mov     ax,[eax+0x4]
</PRE>ds:0236ea15=????
<PRE>           0037df23 8b4d0c           mov     ecx,[ebp+0xc]
</PRE>ss:018cdca6=????????
<PRE>   FAULT -&gt;0037df26 668901           mov     [ecx],ax
</PRE>ds:20202020=????
<PRE>           0037df29 668b45e4         mov     ax,[ebp-0x1c]
</PRE>ss:018cdca7=????
<PRE>           0037df2d e900000000       jmp     XFMDOSFEMFind+0xdf (0037df32)
           0037df32 5f               pop     edi
           0037df33 5e               pop     esi
           0037df34 5b               pop     ebx
           0037df35 c9               leave
           0037df36 c3               ret
           0037df37 55               push    ebp
           0037df38 8bec             mov     ebp,esp
           0037df3a 83ec0c           sub     esp,0xc
           0037df3d 53               push    ebx

   *----&gt; Stack Back Trace &lt;----*

   FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
   0012f2a0 20202020 20202020 20202020 20202020 20202020
</PRE>LSXFM!XFMDOSFEMFind
<P>
<PRE>   *----&gt; Raw Stack Dump &lt;----*
   0012f278  30 00 00 00 70 0c ab 00 - 00 f0 fd 7f 00 00 00 00
</PRE>0...p...........
<PRE>   0012f288  47 89 bd 00 30 3d 38 00 - 43 53 43 20 20 20 20 20  G...0=8.CSC
   0012f298  20 20 20 20 4f 89 bd 00 - 20 20 20 20 20 20 20 20      O...
   0012f2a8  20 20 20 20 20 20 20 20 - 20 20 20 20 20 20 20 20
   0012f2b8  20 20 20 20 00 53 43 20 - 20 20 20 20 20 20 20 20      .SC
   0012f2c8  20 20 20 20 20 20 20 20 - 20 20 20 20 20 20 20 20
   0012f2d8  20 20 20 20 20 20 20 20 - 20 20 20 20 20 20 20 20
   0012f2e8  00 00 00 00 70 0c ab 00 - 00 00 00 00 05 00 00 00
</PRE>....p...........
<PRE>   0012f2f8  50 f3 12 00 5a d2 00 10 - 70 ba bd 00 dc f2 12 00
</PRE>P...Z...p.......
<PRE>   0012f308  01 00 00 00 b0 ff 12 00 - 48 b0 f3 77 40 ca f3 77
</PRE>........H..w@..w
<PRE>   0012f318  ff ff ff ff 4c f3 12 00 - 50 d5 00 10 a4 01 00 00
</PRE>....L...P.......
<PRE>   0012f328  b4 f3 12 00 05 00 00 00 - 78 f3 12 00 af 13 f0 77
</PRE>........x......w
<PRE>   0012f338  a4 01 00 00 cb d4 00 10 - 30 00 00 00 70 0c ab 00
</PRE>........0...p...
<PRE>   0012f348  00 f0 fd 7f 00 00 fd 7f - 38 c6 02 10 14 00 12 00
</PRE>........8.......
<PRE>   0012f358  88 f3 12 00 b9 ea 00 10 - 30 00 00 00 70 0c ab 00
</PRE>........0...p...
<PRE>   0012f368  00 f0 fd 7f 00 f0 fd 7f - 00 00 fd 7f 10 c5 02 10
</PRE>................
<PRE>   0012f378  05 00 00 00 00 00 00 00 - 30 00 00 00 02 00 12 00
</PRE>........0.......
<PRE>   0012f388  bc f3 12 00 11 6a 37 00 - 02 5a 40 00 01 00 00 00
</PRE>.....j7..Z@.....
<PRE>   0012f398  30 00 00 00 30 00 00 00 - 70 0c ab 00 00 f0 fd 7f
</PRE>0...0...p.......
<PRE>   0012f3a8  94 f7 12 00 c4 f3 12 00 - 0a 12 40 00 30 00 00 00
</PRE>..........@.0...
<P>
This occurs on a message with an attachment sent from Exchange to an OV/VM
user.
<P>
<P><h2>CAUSE</h2>
 
<P>
The LME-PROFS-MEXDIA process allocated a buffer to hold an file attachment
extension name up to 8 characters long. When the process encountered a file
extension longer that 8 characters, it overwrote the buffer and wrote onto
the stack, causing an access violation and process termination.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Manually delete the message using the Queue Viewer extension of the Linkage
Exchange - Office Vision/VM Connector. The message will be the first in the
Outbound from Exchange queue (READY-OUT).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Linkage Message Exchange,
version 3.2.
<P>
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: crash hang GPF general protection fault linkage<BR>
Keywords          : kbbug5.00 XFOR<BR>
Version           : 5.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
