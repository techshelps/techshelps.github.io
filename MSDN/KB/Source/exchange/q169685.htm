

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: When Remote Clients Support MAPI, BP9 not Sent </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169685">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/06/05">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00.sp2 XFOR kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Forwarding messages by way of an X.400 connector may result in messages without a message body part arriving at foreign (non-Exchange) X.400 systems. This represents a loss of data in these foreign systems.  CAUSE =====  When you select the  Remote...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QBE7,QBE6,QBG2,QAID,QABI,QBWS,QAYC,QBWP,QAPN,QANE,QABH,QDIZ,QA2Q,QARL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: When Remote Clients Support MAPI, BP9 not Sent</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169685</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Forwarding messages by way of an X.400 connector may result in messages
without a message body part arriving at foreign (non-Exchange) X.400
systems. This represents a loss of data in these foreign systems.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you select the "Remote clients support MAPI" check box on the X.400
Connector general property page, this causes the Microsoft Exchange message
transfer agent (MTA) to drop the X.400 protocol for forwarded messages. As
a result, non-Exchange systems may see messages that do not have a message
body part.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<UL><LI>Do not select the "Remote clients support MAPI" check box on the X.400
   Connector general property page.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.0. This problem has been corrected in the latest U.S. Service
Pack for Microsoft Exchange Server version 5.0. For information on
obtaining the service pack, query on the following word in the Microsoft
Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Even though the Microsoft Exchange MTA behaves as it has been configured,
Microsoft recognizes the need to be able to send the X.400 protocol along
with the message.
<P>
The need for the required behavior discussed in this article should become
more distinct by looking at the scenario outlined below.
<P>
Microsoft Exchange Server acts as a common backbone for both Microsoft
Exchange Server systems and non-Exchange X.400 systems. At Exchange systems
off the backbone, administrative burden can be eased, by using a minimal
configuration to connect to the Exchange X.400 backbone. This minimal
configuration could for example include an address space of 'C=*' on the
X.400 connector to the backbone. On the same connector, the 'Remote clients
support MAPI' check box is activated, for maximal Exchange
interoperability.
<P>
Without the hotfix discussed here, the X.400 protocol for forwarded
messages would be dropped for messages sent over such an X.400 connector.
On forwarding such a message from the Exchange backbone to a non-Exchange
system, data loss will occur, because the message will not have a message
body part.
<P>
The X.400 protocol for forwarded messages is sometimes referred to as BP9.
Please note that the MS Exchange MTA behaves as described in this article,
because it is configured that way. The fix discussed herein allows to
configure the wanted behavior on a per connector basis. The default
behavior for Exchange is to drop BP9 on X.400 links configured with the
option 'Remote clients support MAPI'. Please do the following to allow BP9
being sent additionally, after applying the hotfix, for EACH X.400
connector you want Exchange's default setting to be changed:

<OL><P><LI>Start the Exchange Admin module in raw mode using the following syntax:
<P>
<P><PRE>      ADMIN -R
</PRE>
<P><LI>Change to the Connections container.

<P><LI>Highlight the X.400 connector that you want to change.

<P><LI>Click the Raw Properties entry on the File menu. This brings up the
   raw-property page of the selected connector.

<P><LI>In the "List attributes of type" box in the lower left corner of the
   property page, select "Non existing".

<P><LI>In the "Object attributes" list, select the Heuristics property by
   clicking it.

<P><LI>In the "Edit value" field enter 512 (0x200 hex) and click the Set
   button. It should become active when you type the value.

<P><LI>Click Apply and then click OK. This should close the raw-property
   page for this connector.

<P><LI>Check that your modifications have been applied properly by opening
   the raw-property page of the modified connector again. The "Heuristics"
   property with a value of 512 should show up, after "Existing" objects
   in the "List attributes of type" select box have been chosen.

<P><LI>Repeat steps 1 through 9 for each connector you want to modify.

<P><LI>If you want the modifications to take effect immediately, stop and
   restart the service Microsoft Exchange message transfer agent.
<P>
</OL><h2>INSTALLATION</h2>
 

<OL><P><LI>Run HOTFIX /I at a Windows NT command prompt.

<P><LI>Run HOTFIX /V at a Windows NT command prompt to verify that the fixed
   files have been installed properly.

<P><LI>Before proceeding to step 4, refer to the configuring instructions in
   the "More Information" section of this article.

<P><LI>For your changes to take effect, you must stop and restart all Microsoft
   Exchange Server services.
</OL> 
<PRE>Keywords          : kbbug5.00 kbfix5.00.sp2 XFOR kbusage
Version           : WinNT:5.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
