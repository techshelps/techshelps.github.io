

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCON: Mail Sent Outside Site via X.400 Takes Illogical Route </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159186">
<META NAME="KBModify" CONTENT="1997/04/09">
<META NAME="KBCreate" CONTENT="1997/01/07">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00.sp4 kbusage XCON">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Mail destined outside of the site via X.400 Connector may be rerouted out to another seemingly  illogical  and higher cost site, and then routed back into the site with the X.400 Connector to the target site. The message then routes out the appropr...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAM5,QAEF,QAC2,QAJP,QAYC,QBG2,QAID,QBE7,QBE6,QAR5,QBVX,QA9N,QAY1,QABI,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Mail Sent Outside Site via X.400 Takes Illogical Route</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159186</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Mail destined outside of the site via X.400 Connector may be rerouted out
to another seemingly "illogical" and higher cost site, and then routed back
into the site with the X.400 Connector to the target site. The message then
routes out the appropriate connector.
<P>
Additionally, the GWART0.MTA within a site will list a redundant,
"circular" route back into itself similar to the following:
<P>
<PRE>   c=&lt;US&gt;
    a=&lt;SOME-NAME&gt;
     p=&lt;COMPANY&gt;
           ROUTE1, 0001
           /O=SOME-NAME/OU=NEW-YORK/../CN=ROUTE1

           SITE CONNECTOR (UNITED KINGDOM), 0002
           /O=SOME-NAME/OU=NEW-YORK/../CN=SITE CONNECTOR (UNITED KINGDOM)
           /O=SOME-NAME/OU=UNITED KINGDOM/../CN=SITE CONNECTOR (NEW-YORK)

</PRE>According to the above GWART taken from a server in the NEW-YORK site,
messages addressed to the address space "c=US;a=SOME-NAME;p=COMPANY;..."
have two possible routes: the lowest cost is via ROUTE1, with a cost of
0001; the second route is a site connector to the United Kingdom, but it is
a circular route that routes out to UNITED KINGDOM, and returns back into
the NEW-YORK site.
<P>
In extreme cases, this may contribute to slow mail delivery, MTA queue
backlogs, and possibly non-delivery reports (NDRs).
<P>
<P><h2>CAUSE</h2>
 
<P>
The routing calculation logic calculates all possible routes, including
circular routes. The algorithm then filters out the circular routes,
removing them from the routing information database (RID). There was a bug
in the filtering process that resulted in a failure to remove the last
circular route.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<OL><P><LI>On the Configuration menu, click Site Addressing.

<P><LI>Clear the "Share address space with other X.400 systems" check box.
<P>
</OL>NOTE: If Microsoft Exchange Server is deployed in a messaging environment
where it must coexist with an existing X.400 message handling system (MHS)
and share the same address space, the "Share address space" check box must
be selected. If Microsoft Exchange Server must share an existing address
space, there is no workaround.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Exchange Server version
4.0.
This problem was corrected in the latest Microsoft Exchange 4.0 U.S. Service Pack. For information on obtaining the service pack, query on the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
One server in a site is "responsible" for rebuilding the RID for the site.
The server maintaining this responsibility will have its Distinguished Name
(DN) listed under raw properties for "Configure, Site Addressing, Rid-
Server".
<P>
MTAs within the site use an image of this routing table in memory and
maintain two copies of it in text files on disk
<P>
NOTE: Do not modify these files. Editing the following files will not
affect routing):
<P>
<PRE>   \EXCHSRVR\MTADATA\GWART0.MTA and GWART1.MTA.

</PRE>GWART0 is a copy of what is currently in use, and GWART1 is a copy of the
RID prior to the current one. The RID is automatically rebuilt
approximately 10 minutes after any change affecting routing replicates
within the site. Additionally, it is rebuilt according to the schedule
specified under "Configuration, Site Addressing, Routing Calculation
Schedule" and can be forced to rebuild under: "Configuration, Site
Addressing, Routing, Recalculate Routing" or "&lt;servername&gt;, Message
Transfer Agent, Recalculate Routing."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug4.00 kbfix4.00.sp4 kbusage XCON<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
