

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: How to Embed an OLE Object in an Exchange Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160287">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1996/12/03">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article shows you how to embed a bitmap image in a Microsoft Exchange Forms Designer Form RichEdit field by extending the form with Microsoft Visual Basic 4.0 16-bit version.  NOTE: Only the bitmap image (BMP) format is supported in the Exchan...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAI2,QA7O,QA7N,QAPN,QAH4,QBQU,QA5F,QAMA,QAB2,QAFI,QACI,QAA1,QDMW,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: How to Embed an OLE Object in an Exchange Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160287</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to embed a bitmap image in a Microsoft Exchange
Forms Designer Form RichEdit field by extending the form with Microsoft
Visual Basic 4.0 16-bit version.
<P>
NOTE: Only the bitmap image (BMP) format is supported in the Exchange Forms
Designer RichEdit field.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To embed a bitmap image in a Microsoft Exchange Forms Designer Form
RichEdit field:

<OL><P><LI>First, the designer must create an Exchange Form using the Exchange
   Forms Designer.

<P><LI>The form must contain one RichEdit field whose reference name is:
<P>
<P><PRE>      MAPI_BODY_CUSTOM
</PRE>
<P><LI>Install the form to the appropriate folder or registry.

<P><LI>Exit the Exchange Forms Designer and load the Formname.vbp file into
   Visual Basic 4.0 16-bit version.

<P><LI>In Visual Basic, create a command button on the form panel.

<P><LI>In Visual Basic, select the picture control (named Picture1 by
   default) and place that onto the form paneling.

<P><LI>In Visual Basic, place the following code behind the command button
   created in step 5. In the first line of code, the LoadPicture method
   points to the path and file to find the bitmap image you want to load.
   In this example, "c:\exchange\current.bmp" is used.
<P>
<P><PRE>      Picture1.Picture = LoadPicture("c:\exchange\current.bmp")
      Clipboard.Clear
      Clipboard.SetData Picture1.Picture, vbCFBitmap
      MAPI_Body_Custom_Ctrl.Action = 12  'RE_ACTION_PASTE
</PRE><P>
</OL>NOTE: For the recipient to successfully display the form bitmap image, the
file will need to be available at the path specified in the LoadPicture
method. This can be done by modifying the .CFG file, for the form project
in the File#= entry. This entry is used to copy files locally, along with
the form executable.

<OL><P><LI>Using the Exchange Client Forms Manager, install the form into the
   appropriate folder or library.
</OL> 
<PRE>Keywords          : XADM kbusage
Version           : winnt:4.0
Platform          : winnt</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
