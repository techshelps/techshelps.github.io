

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCON: Configuring MTA TCP/IP Port # for X.400 and RPC Listens </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161931">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1997/02/18">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix4.00.sp4 XCON">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Message Transfer Agent (MTA) in versions Microsoft Exchange Server 4.0 Service Pack 4 (SP4) and 5.0 contains two new features that allow the MTA to be configured to use different TCP/IP port numbers for X.400 connectors and f...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKG,QAKD,QDJP,QDNT,QAL0,QABA,QBE7,QBE6,QAKC,QBWP,QDO3,QDJ3,QDIZ,QBVV,QA4F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Configuring MTA TCP/IP Port # for X.400 and RPC Listens</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161931</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0 SP4
<LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Exchange Message Transfer Agent (MTA) in versions Microsoft
Exchange Server 4.0 Service Pack 4 (SP4) and 5.0 contains two new features
that allow the MTA to be configured to use different TCP/IP port numbers
for X.400 connectors and for RPC listens.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By default, the Microsoft Exchange MTA will use TCP/IP port 102 to
communicate with other X.400 MTAs. For example, if two Microsoft Exchange
Sites are connected by an X.400 Connector with a TCP/IP MTA Stack, both
MTAs will communicate over port 102 by default. However, this port number
is now configurable with the addition of the following registry value:
<P>
<PRE>   RFC1006 Port Number

</PRE>This case-sensitive registry value is a DWORD and does not exist by
Default. To add the registry value:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Run the Registry Editor(Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Services\MSExchangeMTA\Parameters
</PRE>
<P><LI>Add the following case-sensitive DWORD value:
<P>
<P><PRE>      RFC1006 Port Number
</PRE>
<P><LI>Quit Registry Editor.
<P>
</OL>If the "RFC1006 Port Number" registry value does not exist in the
registry, the Microsoft Exchange MTA will assume a value of 102 for this
setting and thus will expect all X.400 MTA communication to occur over
port 102 when using a TCP/IP MTA stack. All MTAs that communicate with
each other over X.400 need to use the same TCP/IP port number.
<P>
The other additional registry setting allows the MTA to be configured to
listen to remote procedure calls (RPC) on a specific port number. It is
not necessary for all Microsoft Exchange MTAs to be configured to listen
for RPC communication on the same port. RPC communication relies on the
End-Point Mapper to relay the appropriate port number so that further
communication can then be directly achieved by going directly to the port
number that the End-Point Mapper reported for a specific server. This
behavior can be examined by using a network sniffer such as Network
Monitor to monitor the RPC communication between two MTAs.
<P>
The following registry value determines what TCP/IP port a given MTA will
use to listen for RPC communication:
<P>
<PRE>   TCP/IP port for RPC listens

</PRE></OL>This case-sensitive registry value is a DWORD and does not exist by
default. To add the registry value:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
but can be added using regedt32 to the following registry key:

<OL><P><LI>Run the Registry Editor(Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      SYSTEM\CurrentControlSet\Services\MSExchangeMTA\Parameters
</PRE>
<P><LI>Add the case-sensitive registry value below. This is a DWORD:
<P>
<P><PRE>      TCP/IP port for RPC listens
</PRE>
<P><LI>Quit Registry Editor.
<P>
</OL>The MTA does not read either of these two registry values dynamically.
Therefore, once a change has been made to one of these registry settings,
the MTA must be stopped and restarted before the change will go into
effect.
<P>
For more information about the ramifications and guidelines for static 
port assignment of Exchange services, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q180795.htm">Q180795</A></B>
   TITLE: XADM: Intrasite Directory Replication Fails with Error 1720

</PRE></OL>These two new features are available in Microsoft Exchange Version 4.0
Service Pack 4 (SP4) and in Microsoft Exchange Version 5.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: firewall<BR>
Keywords          : kbbug4.00 kbbug5.00 kbfix4.00.sp4 XCON<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
