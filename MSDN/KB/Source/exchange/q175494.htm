

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: Dequeing SMTP Mail Outside of Dialup Connections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175494">
<META NAME="KBModify" CONTENT="1998/01/28">
<META NAME="KBCreate" CONTENT="1997/10/22">
<META NAME="Keywords" CONTENT="XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Microsoft Exchange Server has the ability to send a command or ETRN (with version 5.0 Service Pack 1) to another host to prompt that host to send any messages waiting for the specified domain (also known as  dequeuing ).  However, by default, this ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QBG2,QAI5,QACK,QBWP,QBWS,QAVZ,QAPF,QANE,QAIJ,QBKX,QDLU,QDJI,QAWM,QATO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Dequeing SMTP Mail Outside of Dialup Connections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 28, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175494</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server versions 5.0 and 5.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Exchange Server has the ability to send a command or ETRN (with
version 5.0 Service Pack 1) to another host to prompt that host to send any
messages waiting for the specified domain (also known as "dequeuing").
<P>
However, by default, this functionality is limited to only dial-up
connections.
<P>
If this functionality is required outside of the dial-up connections of the
Internet Mail Service (like in the case of Dial-up or Dial-on-demand
routers), you must use some method to send this command manually, either
through a batch file or the use of a third-party dequeing application.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Create a batch file to run on Windows NT AT Command Scheduler (available in
the Windows NT Resource Kit) or other third-party scheduling application.
The following are example batch files:
<P>
<PRE>  Example 1: (assumes Internet Mail Service is always running)

  PING &lt;other_hosts_ip_address&gt; ---&gt; makes the dialup router initiate its
  connection
  PING &lt;other_hosts_ip_address&gt; ---&gt; verify connection
  FINGER My.DomainA.Com@ISP.Host.DomainB.Com ---&gt; to dequeue

  Example 2: (assumes Internet Mail Service is always running)

  PING &lt;other_hosts_ip_address&gt; ---&gt; makes the dialup router initiate its
  connection
  PING &lt;other_hosts_ip_address&gt; ---&gt; verify connection
  &lt;Retrieval Program&gt; ---&gt; third-party program that dequeues mail

  Example 3: (assumes Internet Mail Service is NOT running)

  PING &lt;other_hosts_ip_address&gt; ---&gt; makes the dialup router initiate its
  connection
  PING &lt;other_hosts_ip_address&gt; ---&gt; verify connection
  NET START MSExchangeIMC ---&gt; starts the Internet Mail Service
  &lt;Retrieval Method: command or executable&gt;
  NET STOP MSExchangeIMC ---&gt; stops the Internet Mail Service
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: DEQUEUE ETRN RETRIEVAL<BR>
Keywords          : XFOR<BR>
Version           : WinNT:5.0,5.5<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 28, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
