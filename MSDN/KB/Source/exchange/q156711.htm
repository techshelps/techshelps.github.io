

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: Exchange Win95 Client with DNS Polls for New Mail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156711">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1996/10/11">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00.sp3 kbnetwork XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When you configure a Microsoft Exchange Windows 95 client to use Domain Name Service (DNS), it will typically poll for new messages every 60 seconds rather than use push notification in which the Microsoft Exchange Server notifies the Microsoft Exc...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAUJ,QARL,QAUD,QAYC,QAGI,QBBI,QBWQ,QDL9,QBWO,QBWN,QAH6,QARM,QAIF,QDN1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Exchange Win95 Client with DNS Polls for New Mail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156711</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you configure a Microsoft Exchange Windows 95 client to use Domain
Name Service (DNS), it will typically poll for new messages every 60
seconds rather than use push notification in which the Microsoft Exchange
Server notifies the Microsoft Exchange client that new message(s) have
arrived.
<P>
<P><h2>CAUSE</h2>
 
<P>
During Microsoft Exchange client initialization, it attempts to determine
if any network cards are available that use the IPX or TCP/IP network
protocols. These protocols can be used by the Microsoft Exchange Server to
send push notifications to Microsoft Exchange clients informing them of new
mail delivery.
<P>
When this protocol detection mechanism succeeds, the Microsoft Exchange
Server sends push notifications (via network datagrams) directly to the
Microsoft Exchange client. These datagrams instruct the client to poll for
new mail (which has just arrived). Typically, in the absence of new mail
messages, an idle Microsoft Exchange client communicates with the Microsoft
Exchange Server once an hour to ensure that communication with the server
is still operational.
<P>
When this protocol detection mechanism fails to detect the presence of IPX
or TCP/IP, the Microsoft Exchange client will resort to polling for new
mail every 60 seconds.
<P>
The protocol detection mechanism for TCP/IP uses a call to gethostname()
that returns the host name for the local computer.
<P>
Remarks in the Win32 Software Development Kit (SDK) about gethostname()
state:
<P>
<PRE>   This routine returns the name of the local host into the buffer
   specified by the name parameter. The host name is returned as a null-
   terminated string. The form of the host name is dependent on the
   Windows Sockets provider -- it may be a simple host name, or it may
   be a fully qualified domain name.

</PRE>If gethostname() is called on a computer that has DNS disabled, the
returned value will simply be the computer name. If the computer has DNS
enabled, the host name itself can be specified (and it could be different
than the computer name) and a domain name suffix can be specified
(something like org.com) which is added to the host name when forming a
fully qualified domain name for the host.
<P>
An example of a simple host name is comp01. An example of a fully qualified
domain name is comp01.org.com
<P>
In the case of the Microsoft Exchange client, the buffer provided to this
call is sized at 15 characters, the maximum size of a NetBIOS computer
name. When Windows NT calls gethostname(), it always returns a simple host
name that is typically the same as the NetBIOS computer name and it will
fit within the buffer provided. On Windows 95, a call to gethostname()
returns the fully qualified domain name that typically exceeds the buffer
length.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Disable DNS on Windows 95, or remove the domain name suffix entry from the
Windows 95 TCP/IP properties DNS configuration property page, and ensure
that the host name specified is 15 characters or less in length.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0. This problem was corrected in the latest Microsoft Exchange
Service Pack. For information on obtaining the Service Pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Hostname DNS Polling Pushing Push Poll RPC MSRPC<BR>
Notification<BR>
Keywords            : kbbug4.00 kbfix4.00.sp3 kbnetwork XCLN<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
