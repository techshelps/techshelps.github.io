

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: How to Create Exchange Templates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152436">
<META NAME="KBModify" CONTENT="1997/04/21">
<META NAME="KBCreate" CONTENT="1996/06/14">
<META NAME="Keywords" CONTENT="kbusage XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article explains how to create Microsoft Exchange templates and which files are needed to create the templates. The files needed are Unicode text file (WTX), Compiled WTX/Binary Display Table (BLT), Binary file to process the different OP code...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA7O,QA7N,QAC2,QA36,QAH4,QBE7,QBE6,QAB5,QAI4,QAYZ,QATX,QAMB,QAIJ,QBXR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: How to Create Exchange Templates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152436</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to create Microsoft Exchange templates and which
files are needed to create the templates. The files needed are Unicode text
file (WTX), Compiled WTX/Binary Display Table (BLT), Binary file to process
the different OP codes (SCR), and help (HLP).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WTX file is a plain Unicode text file. To create this text file, use
the Save As feature in Notepad, and select the Unicode format. This file is
similar to the old TPL file. Its format allows you to control where the
various fields are positioned on the screen, as well as the behavior of the
input fields, for example, default value, read-only, required, etc. All of
the op-codes are found on the Microsoft Exchange SDK.
<P>
For example,
<P>
<PRE> 0, 0, 0, 0, DTCT_PAGE, 0x00000000, 0x00000000, 0,MCI User
</PRE>12, 50, 20, 8, DTCT_LABEL, 0x00000000, 0x00000000, 0,Alias:
75, 141, 18, 12, DTCT_EDIT, 0x00000006, 0x3001001E, 30,*
<P>
-or-
<P>
Once the WTX is complete, you need to compile it with a tool included in
the SDK. This tool is called Template.exe. It takes the WTX file as input
and outputs a BLT file.
<P>
Now you can verify the location of the different fields by importing the
file into the one-off address container. Create a CSV similar to this one
and use the directory import tool to bring it into exchange.
<P>
<PRE>Obj-Class    Mode  Common-Name    Address-Entry-Display-Table   Address-
Entry-Display-Table-MSDOS   Original-Display-Table  Original-Display-Table-
MSDOS  Help-File-Name    Help-Data16    Help-Data32    Address-Syntax
Address-Type    Admin-Display-Name

Address-Template  Create    /cn=Configuration/cn=Addressing/cn=Address-
Templates/cn=409/cn=MCITelex   =MCITelex.blt  =MCITelex.blt  =MCITelex.blt
#NAME?             =MCITelex.BIN MCI   MCI Telex Address

</PRE>After you verify the field positioning, etc., you are now ready to create a
binary file that will control how the various fields will be processed. The
SDK suggests using DEBUG for this task. However, Dev Studio is a better
choice, specially if you plan to make any editing changes. In most cases
you take the information entered by the user and concatenate it into a
single address line.
<P>
For example, in Microsoft Mail for PC Networks, you would take the network
name, postoffice name, and the user ID and concatenate them using '/' to
separate the various parts of the address. Within this binary file you need
to specify an offset to locate the various text characters that are
inserted when completing the address. It is easier to use locate all this
type of text fields at the beginning of the file instead of at the end, so
your offsets do not keep changing. In order to make this work you need to
put a JMP operand (00 00 00 03) as the first instruction and indicate the
offset of where the program starts.
<P>
If you run debug or Dev Studio, you will notice that the actual program
does not start until 6A (hex).
<P>
<PRE>   Instructions      Op Code
   03 00 00 00    00000003 JMP
   6A 00 00 00    0000006A Offset
   Text fields ...
   ...
   04 00 00 00    00000004 Verify
   1E 00 00 78    7800001E Field #1 defined on WTX
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbusage XADM<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
