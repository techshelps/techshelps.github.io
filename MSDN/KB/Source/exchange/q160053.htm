

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: Mobile Users of Exchange on Win3.1 Using One Configuration </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160053">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="kbsetup XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  For computers running Microsoft Windows 3.1 and LAN Manager for MS-DOS, the ShivaRemote is used to remotely access computers running Microsoft Exchange Server. However, those users who need to carry the computer back and forth between home and an o...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QBWS,QAA1,QDIZ,QAVZ,QAB5,QAU9,QAI5,QDI2,QA01,QAGU,QBXT,QBWE,QBAO,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Mobile Users of Exchange on Win3.1 Using One Configuration</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160053</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 3.x client, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
For computers running Microsoft Windows 3.1 and LAN Manager for MS-DOS, the
ShivaRemote is used to remotely access computers running Microsoft Exchange
Server. However, those users who need to carry the computer back and forth
between home and an office have to reconfigure the settings every time they
move, because transport layer protocols cannot be bound to a LAN card
driver and to the ShivaRemote driver at the same time.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
An administrator can set up one configuration that works both at home and
at the office for these users. The workaround is to load two transport
drivers, NetBEUI and TCP/IP, which are bound to a LAN card driver and the
ShivaRemote driver respectively. Because the NetBEUI protocol provides the
fastest throughput to NetBIOS resources when accessed over a remote access
connection, it can be used for remote connectivity and the TCP/IP is used
on a LAN. Do the following procedures to make the configuration work:

<OL><P><LI>Install the LAN Manager for MS-DOS version 2.2, and select TCP/IP and
   NetBEUI.

<P><LI>Configure the TCP/IP with the following:
<P>
   a. Enable DHCP in the "TCP/IP Settings" dialog box.
<P>
   b. Type the Username, and Hostname, and enable Windows Sockets in the
<P><PRE>      "DNR and Sockets Settings" dialog box. To bring up the "DNR and
      Sockets Settings" dialog box, click the Advanced button in the
      "TCP/IP Settings" dialog box.
</PRE><P>
   c. Type the Computername, Username and Domain in the "Workstation
<P><PRE>      Settings" dialog box.
</PRE>
<P><LI>After the installation of the LAN Manager is complete, install the
   Microsoft Exchange client for Windows 3.x. Select the custom
   installation that includes the ShivaRemote software.

<P><LI>Run the ShivaRemote Setup program from the Microsoft Exchange program
   group, as follows:
<P>
</OL>a. Select the COM port and the type of modem you use.
<P>
b. Enable NetBEUI/LLC in the "Protocol Configuration" dialog.
<P>
c. When ShivaRemote Setup is complete, restart your computer so that the
<PRE>   configuration changes you made take effect.

</PRE><P><LI>After the computer restarts, in the Config.sys file, add the line
<P>
   DEVICE=C:\EXCHANGE\SHIVA\DIALNDIS.EXE (After the line
   DEVICE=...\PROTMAN.DOS /i:C:\LANMAN.DOS)

<P><LI>Modify the Protocol.ini file in the Lanman.dos directory. Leave the
   TCP/IP section intact.
<P>
<P><PRE>      [NetBEUI_XIF]
<PRE></PRE>      ;BINDINGS="LAN Card Driver"    Make this line a comment.
      BINDINGS=SDIALIN$                  Add this line.
      [SDIALIN$]                                    Add this line.
      DriverName=SDIALIN$                Add this line.

</PRE><P><LI>Restart the computer.
<P>
</OL>If users want to use the remote mail functionality of the Exchange, the
Exchange profile needs to be configured as follows.

<OL><P><LI>Double-click the Microsoft Exchange Services icon in the Microsoft
   Exchange program group. Then, click the Add button to create a new
   profile.

<P><LI>When the Setup Wizard prompts for "Do you travel with this computer",
   click Yes to create offline folder use in this profile.

<P><LI>After the profile is created, select this profile and click the
   Properties button.

<P><LI>Select the Microsoft Exchange Server Information service and click the
   Properties button. The "Microsoft Exchange Server" dialog is brought up
   and you should see four tabs, General, Advanced, Dial-Up Networking and
   Remote Mail.

<P><LI>On the General tab, click "Work offline and use dial-up networking".

<P><LI>On the Dial-Up Networking tab, click "Dial using the following
   connection" and click the Setup button to bring up the "ShivaRemote
   Connect" dialog box.
<P>
   a. Type the Description, Dial-in Name, Password and Phone number.
<P>
   b. Click Port Setup in the Tools menu to make sure that the port and
<P><PRE>      modem are configured correctly.
</PRE><P>
   c. Click the Options button to make sure that the NetBEUI/LLC is
<P><PRE>      enabled.
</PRE><P>
   d. On the File menu, click Save to save the settings. For more
<P><PRE>      information on creating a connection file, refer to the ShivaRemote
      Online Guide.
</PRE><P>
   e. Exit the "ShivaRemote Connect" dialog box.

<P><LI>On the Dial-Up Networking tab, you should see the description of the
   just created connection file that appears in the drop-down list. Click
   this connection and type the User name, Password, and Domain.

<P><LI>Click OK to save the settings.
<P>
<P>
</OL>NOTE: This Microsoft Exchange profile has to be used to connect to a
computer running Microsoft Exchange server on a LAN at least once before it
can be used remotely because the offline folder file needs to be created
and synchronized.
<P>
<P><h2>REFRENCE</h2>
 
<P>
The following sample files of Config.sys, Autoexec.bat and Protocol.ini are
included here as reference.
<P>
----- Autoexec.bat -------
C:\WIN3.1\SMARTDRV.EXE
@ECHO OFF
PROMPT $p$g
PATH C:\WIN3.1;C:\DOS
SET TEMP=C:\DOS
@REM ==== LANMAN 2.2a == DO NOT MODIFY BETWEEN THESE LINES == LANMAN 2.2a
 
set path=c:\lanman.dos\netprog;%path%;c:\exchange\shiva
set SHIVA=C:\exchange\shiva
C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\umb.com
NET START WORKSTATION
LOAD TCPIP
SOCKETS
LOAD NETBEUI
@REM ==== LANMAN 2.2a == DO NOT MODIFY BETWEEN THESE LINES == LANMAN 2.2a
 
<P>
----- Config.sys -------
DEVICE=C:\DOS\SETVER.EXE
DEVICE=C:\DOS\HIMEM.SYS
DEVICE=C:\LANMAN.DOS\DRIVERS\DOSUTILS\EMM386.EXE NoEMS
REM DEVICE=C:\WIN3.1\EMM386.EXE NoEMS
DOS=HIGH,UMB
FILES=30
SHELL=C:\DOS\COMMAND.COM C:\DOS\  /p
LASTDRIVE=Z
DEVICE=C:\WIN3.1\SMARTDRV.EXE /DOUBLE_BUFFER
STACKS=9,256
DEVICE=C:\LANMAN.DOS\DRIVERS\PROTMAN\PROTMAN.DOS /i:C:\LANMAN.DOS
device=c:\exchange\shiva\dialndis.exe
DEVICE=C:\LANMAN.DOS\DRIVERS\ETHERNET\NE2000\NE2000.DOS
DEVICE=C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\tcpdrv.dos /i:C:\LANMAN.DOS
DEVICE=C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\nemm.dos
<P>
----- Protocol.ini --------
[PROTMAN]
<PRE>  DRIVERNAME = PROTMAN$
  DYNAMIC = YES
  PRIORITY = NETBEUI

</PRE></OL>[SDIALIN$]
DriverName=SDIALIN$
<P>
[TCPIP_XIF]
<PRE>  DRIVERNAME      = TCPIP$
  IPADDRESS0 =
  SUBNETMASK0 =
  DEFAULTGATEWAY0 =
  NBSESSIONS = 6
  TCPSEGMENTSIZE  = 1450
  TCPWINDOWSIZE   = 1450
  LOAD            = tcptsr[c],tinyrfc[c],emsbfr[cr]
  UNLOAD          = "unloadt /notsr[dc]"
  BINDINGS = "NE2000_NIF"
  NETFILES = C:\LANMAN.DOS\ETC
  LANABASE = 0

</PRE>[NETBEUI_XIF]
<PRE>  Drivername = netbeui$
  SESSIONS = 6
  NCBS = 12
  ;BINDINGS = "NE2000_NIF"
  BINDINGS = SDIALIN$
  LANABASE = 1

</PRE>[NE2000_NIF]
; protocol.ini section for the Novell NE2000 Card
<PRE>    IOBASE = 0x300
    INTERRUPT = 3
    DRIVERNAME = MS2000$

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbsetup XCLN<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
