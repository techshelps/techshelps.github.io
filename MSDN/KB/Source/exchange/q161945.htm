

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCON: MSMail Shows Blank Icon for File Attachments from Internet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161945">
<META NAME="KBModify" CONTENT="1997/07/15">
<META NAME="KBCreate" CONTENT="1997/01/08">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix4.00.sp4 kbfix5.00.sp1 XCON kbbug4.00">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When you are using the Microsoft Mail client or the Microsoft Exchange Client connected to a Microsoft Mail postoffice, file attachments included in messages from Internet users contain blank icons. This is true even for icons that are associated w...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAV0,QAV1,QAR4,QAYC,QAIH,QARL,QA5T,QAY2,QAEV,QABA,QAM1,QAB2,QBWP,QBVV,QANS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: MSMail Shows Blank Icon for File Attachments from Internet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161945</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are using the Microsoft Mail client or the Microsoft Exchange
Client connected to a Microsoft Mail postoffice, file attachments included
in messages from Internet users contain blank icons. This is true even for
icons that are associated with programs on the local computer. The document
does open correctly when it is clicked, if an associated program exists for
the attachment.
<P>
For example, your Microsoft Mail client shows a blank icon for an attached
Microsoft Word document, even though you have Word installed. Double-
clicking the blank icon starts Word (if it is not already started),
and the document opens correctly in Word.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Mail clients display icon images according to the following
algorithms:
<P>
<P><h3>Winmail.dat File Does Not Exist</h3>
 
<P>
If an e-mail message has an attachment, and no Winmail.dat file, the
mail client will display an icon for the file if an association for the
file extension has been established. The Winmail.dat file is a special file
created by Microsoft Mail clients that contains MAPI property information,
rich-text formatting, icon images, and other non-text related items.
<P>
<P><h3>Winmail.dat File Does Exist</h3>
 
<P>
If an e-mail message has an attachment and a Winmail.dat file, the
mail client will display the icon image present in the Winmail.dat file.
The Winmail.dat file always contains an icon image for each attachment.
<P>
When mail from the Internet Mail Connector (IMC) is passed to the Microsoft
Mail Connector interchange (MSMI), the MSMI always projects a Winmail.dat
file for any message that contains an attachment. Because the original
message received by the MSMI may not contain an icon image (if it
originated from a client other than Microsoft Mail), the MSMI inserts a
blank icon image into the Winmail.dat file.
<P>
Because the Microsoft Mail client sees a Winmail.dat file (created by the
MSMI), it expects an icon image to be present.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use either of the following methods:
<P>
<P><h3>Method 1: Migrate Users</h3>
 
<P>
Migrate users to the Microsoft Exchange Client using Microsoft Exchange
Server as their message store. In this standard configuration, Microsoft
Exchange clients will display an icon if present from the sender. If no
icon is present, the client will display an icon associated with the file
based on its associations.
<P>
<P><h3>Method 2: Use the Fix Described</h3>
 
<P>
The Status section of this article describes a fix that is available from
Microsoft Technical Support.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange versions
4.0 and 5.0.
This problem was corrected in the latest Microsoft Exchange Server 4.0 and 5.0
U.S. Service Packs. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To operate, the fix requires that the Microsoft Exchange Server computer
that is running the Microsoft Mail Connector interchange (MSMI) must be
running Microsoft Windows NT 4.0. In addition, the fix works by allowing
the MSMI to provide an icon image for documents (instead of using a blank
icon image). For the fix to work, the applications for the documents that
are received as blank icons must be installed on the Microsoft Exchange
Server computer with the fix. (That is, you must install Microsoft Word for
Windows on the Microsoft Exchange server, if .doc files are received with
blank icons.)
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<UL><LI>To activate the fix, you must add a value to the registry:
<P>
   Edit the registry key as follows:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services
<PRE></PRE>         \MSExchangeMSMI\Parameters

   Add the following registry value (type of DWORD set to 1):

      Search for icon on server

</PRE></UL>If this registry entry is present and the value is set to 1, the MSMI
will search the Windows NT registry of the server that it is running on to
locate an executable file that contains the icon for the associated
extension of the attachment file name.
<P>
If this registry entry is not present, the default value is FALSE or 0.
In this case, the MSMI will use the default icon for attachments in a
message that do not already have an icon image. This is normal behavior of
the MSMI.
<P>
For additional information about Winmail.dat, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q136204.htm">Q136204</A></B>
   TITLE     : XCLN: Sending Messages in Rich-Text Format
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug4.00 kbbug5.00 kbfix4.00.sp4 kbfix5.00.sp1 XCON kbbug4.00<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
