

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: How to Set Up Windows 95 Roving Users with Profgen.exe </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182035">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1998/03/04">
<META NAME="Keywords" CONTENT="XCLN kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Using the Exchange Resource Kit utility Profgen.exe, you can set up roving users for the Exchange Windows 95 client without using server-based Windows 95 profiles. Several conditions must be met and several steps must be followed to accomplish this...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QAGU,QDJ2,QARL,QDL9,QBWQ,QBWO,QBWN,QABA,QBKX,QBC9,QBC8,QANO,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: How to Set Up Windows 95 Roving Users with Profgen.exe</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182035</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 95 client, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using the Exchange Resource Kit utility Profgen.exe, you can set up roving
users for the Exchange Windows 95 client without using server-based Windows
95 profiles. Several conditions must be met and several steps must be
followed to accomplish this. Although it is possible to do this with the
aid of the Exchange Resource Kit utility Profgen.exe, the use of
Profgen.exe is not officially supported by Microsoft Product Support
Services (PSS) and is offered "as is."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
PSS recommends that roving Exchange users be set up by using server-based
Windows 95 user profiles. It is possible to set up Exchange roving users
without using server-based Windows 95 profiles with the aid of the Exchange
Resource Kit utility Profgen.exe. When you set up Exchange roving users
using Profgen.exe, the roving user's mailbox name must match the roving
user's Windows NT username, because Profgen.exe creates a temporary profile
referencing a mailbox name that is drawn from the currently logged on
user's Windows NT username. Perform the following steps to set up Exchange
roving users with Profgen.exe:

<OL><P><LI>Run the Exchange Setup Editor (Stfedtr.exe) against the client install
   point.
<P>
   The Exchange Setup Editor is in the &lt;client_install_point&gt;\Stfedtr
   subdirectory. The client install point is created by running the
   Setup.exe program from the appropriate language subdirectory (for
   example, \Eng) of the Exchange Client CD.
   After you bring up the Exchange Setup Editor, specify the following
   options:
<P>
   From the User Options dialog box:
<P>
<P><PRE>    - Specify a "Home Server". This home server does not have to be the
</PRE>   same server that all users have their mailbox on, but it does need to be
   a server in the same Exchange site that the roving users have their
   mailboxes in.
<P>
<P>
   From the Setup Program Options dialog box:
<P>
<P><PRE>    - Specify to install only the Exchange Server Service on the Services
</PRE>   tab.
<P><PRE>    - Specify "C:\Exchange" as the "Directory for client software" on the
</PRE>   General tab.
<P>
   After you run the setup editor against the appropriate client install
   point, the Default.prf file is created in the client install point and
   contains the Exchange profile settings that you just applied. Now, when
   the user installs Exchange from the client install point, the
   Newprof.exe and Default.prf files are copied down to the Exchange client
   directory during Setup. The client must be installed in the "Exchange"
   directory (the default) on all computers that will be used for roving
   users.

<P><LI>You must copy Profgen.exe to the user's Exchange directory on the client
   computer. Also, every computer that is to be used as a "roving" client
   must have a copy of the Profgen.ini file in its Windows directory with
   the following settings:
<P>
<P><PRE>      [NEWPROF]
      PathToExeFile=c:\exchange\newprof.exe
      PathToPRFFile= C:\exchange\default.prf
      DisplayUI=0
      AutoExecute=0
</PRE><P>
<P><PRE>      [PROFGEN]
      Logging=0
      UpdateMailboxName=0
      DoNotRenamePRF=1
      UseLoginIDAsProfileName=1
      ;must have this entry for multiple users at the same computer or
      ;any profiles after the 1st one will not be created
</PRE>
<P><LI>Profgen.exe must be called with a login script or must be called with
   the Load=statement in the Win.ini file as follows:
<P>
<P><PRE>      Load=c:\exchange\profgen.exe
</PRE><P>
   When started, Profgen.exe will create the Profgen.tmp file in the root
   of the hard disk drive of the client computer. Profgen.tmp is a modified
   copy of the Default.prf file and is used by Newprof.exe to set up a
   profile with a mailbox based on the currently logged-on user's ID.

<P><LI>When the user logs on to the Exchange client, this newly created profile
   will be the default profile and will have the name of the user's
   mailbox. As long as the Windows NT user ID matches the mailbox name, the
   user can access messages.
<P>
   After you set up a Windows 95 computer for roving users this way, it is
   not necessary to restart a computer that another account is logged on to
   if you want to access your messages. If you select Start, Shut Down, and
   then "Close all programs and log on as a different user", Windows 95
   will run Profgen.exe again and create a new profile. This assumes that
   this particular Windows 95 computer is set up for the option "Users can
   customize their preferences and desktop settings" (in Control Panel /
   Passwords / User Profiles).
<P>
</OL>It is important to use the latest version of Profgen.exe when setting this
up. The correct version has a file size of 78 KB (80,752 bytes) and a date
of 8/07/96. This is available on the Microsoft Web site @
<B><A HREF="ftp://ftp.microsoft.com/bussys/exchange/exchange-unsup-ed/">ftp://ftp.microsoft.com/bussys/exchange/exchange-unsup-ed/</A></B>
<P>
For more information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A HREF="../EXCHANGE/Q159978.htm">Q159978</A></B>
   TITLE     : XADM: Troubleshooting Profgen.exe Problems

   ARTICLE ID: <B><A HREF="../EXCHANGE/Q159504.htm">Q159504</A></B>
   TITLE     : XCLN: Profgen.exe Fails to Replace MailBoxName
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Roaming profgen.exe roving users profiles<BR>
Keywords          : XCLN kbusage<BR>
Version           : WINDOWS:4.0,5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
