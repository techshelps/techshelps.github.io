

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: Correspondence Between Foreign.nsf and Lmd.* </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174697">
<META NAME="KBModify" CONTENT="1997/12/23">
<META NAME="KBCreate" CONTENT="1997/10/06">
<META NAME="Keywords" CONTENT="XFOR kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  After you recreate the Foreign.nsf file from scratch, any full loads or updates to existing users have no effect from Exchange to Lotus Notes. You may also see the following errors for the process DXANOTES in the LinkAge logs:     1997/09/22 18:29:...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXB,QAD2,QBDM,QATJ,QAGU,QAXB,QAFI,QBEK,QBEJ,QAUJ,QAY2,QAYV,QAEF,QBXD,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Correspondence Between Foreign.nsf and Lmd.*</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174697</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you recreate the Foreign.nsf file from scratch, any full loads or
updates to existing users have no effect from Exchange to Lotus Notes.
You may also see the following errors for the process DXANOTES in the
LinkAge logs:
<P>
<PRE>   1997/09/22 18:29:40- DXANOTES(0165) 2 64083:Transaction: ### - Record
   has already been added - Treat as an update
   &gt;&gt; lndxapi(1965)
   1997/09/22 18:29:44- DXANOTES(0165) 1 41116:Error opening Notes document
   with id = ####
   &gt;&gt; lsnabapi(1012)
   1997/09/22 18:29:44- DXANOTES(0165) 2 41127:Notes Package ID: Notes
   Storage Facility (NSF). Extended Reason String: Invalid or nonexistent
   document
   &gt;&gt; lsnabapi(3118)
   1997/09/22 18:29:44- DXANOTES(0165) 1 64103:Error {System failure}
   detected opening Note
   &gt;&gt; lndxapi(2512)
   1997/09/22 18:29:44- DXANOTES(0165) 2 64073:Error {System failure}:
   While processing Transaction ###
   &gt;&gt; lndxapi(1397)

</PRE>Applies to the LinkAge Notes Connector with LinkAge Directory Exchange
version 3.2 (components include LinkAge Exchange DXA, LinkAge Notes DXA,
and LinkAge DXM).
<P>
<P><h2>CAUSE</h2>
 
<P>
The LinkAge Directory Exchange Manager (DXM) sends the full load to the
Notes Directory Exchange Agent (DXA); however, the Notes DXA compares each
user being added to the LMD table, which has not been reset. Because the
entry exists in the Local Mapping Directory (LMD), the Notes DXA assumes
that the entry should be interpreted as an update to an existing user in
Foreign.nsf, though the Foreign.nsf has been cleared. The Notes DXA then
attempts to update the person document in Foreign.nsf that no longer
exists. The result is that the user is not added, and the above error
occurs in the LinkAge log files (located in Linkage\Logs directory).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
This workaround should only be used when Foreign.nsf has been recreated
from scratch. The following procedure requires a directory pull/push on the
Notes side, which could take a significant amount of time to transmit and
process:

<OL><P><LI>Stop the DXANOTES process, or shut down the LinkAge Directory Exchange
   service.
</OL>2. Go to the LINKAGE\DXANOTES directory and delete, rename, or move the
<PRE>   following files:

      Dlockfil.dat
      Lmd.dat
      Lmd.ix1
      Lmd.ix2

</PRE><P><LI>Start the DXANOTES process, or start the LinkAge Directory Exchange
   service.
</OL>4. Request a full load from Notes. This will bring in a full directory from
<PRE>   Notes and recreate the LMD tables.
</PRE></OL>5. Send a full load from DXM to Notes. This will ensure that the LMD also
<PRE>   represents what currently exists in Exchange.

</PRE>Step 5 may produce duplicate entries in the Notes address book if it was
not empty; that is, if it contains any Exchange users. The LMD tables have
a correlation between the document ID and the key fields (username, domain)
of the person document. When this LMD table is removed, the Notes DXA will
try to insert these names as new documents, not modifications, though the
identically named user is in the address book.
To recover, or prevent this, in the case where Exchange names are stored in
a separate address book, recreate a blank address book for the Exchange
names, and redo steps 1-5.
In the case where Exchange names are stored in the same address book as
other Notes names, a solution would have to be researched.
<P>
<P>
Additional query word: LDE
 
<PRE>Keywords          : XFOR kbusage
Version           : WinNT:4.0
Platform          : WINDOWS
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
