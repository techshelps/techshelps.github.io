

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: How To Reset Microsoft Exchange DirSync Numbers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152231">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1996/06/07">
<META NAME="Keywords" CONTENT="XFOR kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Sometimes it is necessary to reset the Directory Synchronization (DirSync) sequence numbers when troubleshooting Microsoft Mail Directory Synchronization problems with a Microsoft Exchange Server participating as a requestor or as the DirSync serve...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKC,QBC6,QAG8,QAPN,QBXS,QAW6,QAIJ,QAB7,QBJZ,QAWN,QBWS,QANN,QAA7,QBXB,QBWU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: How To Reset Microsoft Exchange DirSync Numbers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152231</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Exchange Server, versions 4.0, 5.0, 5.5
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes it is necessary to reset the Directory Synchronization (DirSync)
sequence numbers when troubleshooting Microsoft Mail Directory
Synchronization problems with a Microsoft Exchange Server participating as
a requestor or as the DirSync server.
<P>
For comprehensive information on how the MSMail DirSync process works and a
description of all DirSync sequence numbers, please refer to application
note WA0725 Directory Synchronization [Dir-Sync].
<P>
Resetting DirSync numbers should be only performed as part of a systematic
approach to troubleshooting DirSync problems as documented in the above
mentioned application note.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
DirSync numbers are stored in different places depending on what role the
Microsoft Exchange Server plays in the process:

<UL><LI>Microsoft Exchange as a DirSync Server: All Remote DirSync Requesters
   appear on the right hand side of the Microsoft Exchange Administrator
   program when viewing the DirSync server object on the left. DirSync
   numbers for each requestor appear in raw-mode for each Remote DirSync
   Requestor object.
<LI>Microsoft Exchange as a DirSync requestor: There is only one DirSync
   requestor object defined in this case. Microsoft Exchange keeps all
   DirSync numbers in this one object. Also viewable only while in raw-
   mode.
<P>
</UL>Microsoft Exchange uses the following sync numbers:

<UL><LI>DXA-Conf-Seq (Confirmation sequence number) - On the Remote DirSync
   Requestor object, this number keeps track of what has been acknowledged
   by each requestor.  When all transactions have been confirmed, this
   number should match the DXA-Svr-Seq.  The  DXA-Conf-Seq number can be
   less than the DXA-Svr-Seq if the server has sent updates to the
   requestor and no acknowledgment has been received from the requestor
   (this usually happens after the next T1 time).
<LI>DXA-Imp-Seq (Import sequence number) - Amount of full imports requests
   sent by the requestor.
<LI>DXA-Req-Seq (Requestor sequence number) - Cumulative total of number of
   transactions sent by the requestor to the server.
<LI>DXA-Svr-Seq (Server sequence number) - Cumulative total of number of
   transactions sent by the server to the one requestor.
<P>
</UL>Resetting DirSync numbers requires that the Microsoft Exchange
Administrator program be run in raw mode:  ADMIN /R
<P>
If Microsoft Exchange is acting as the DirSync server you can reset numbers
for individual remote DirSync requesters as follows:

<OL><P><LI>Start the Microsoft Exchange Administrator program in raw mode: ADMIN /R
</OL>2. Select the DirSync Server object you created under the site Connections
<PRE>   object.
</PRE></OL>3. On the right hand side, select the remote DirSync requestor you want to
<PRE>   reset the sync numbers for.
</PRE>4. Select the Raw Properties option from the File menu.
5. On the bottom of the Remote DirSync Requester Dialog, change List 
<PRE>   Attributes of Type to ALL. 
</PRE>6. Set the following attributes to 0: DXA-Conf-Seq, DXA-Imp-Seq, DXA-Req-Seq,
<PRE>   and DXA-Svr-Seq.
</PRE>7. Stop and start the Microsoft Directory Synchronization Service.
8. You must now run Listds.exe on the requestor to reset the DirSync numbers
<PRE>   (refer to wa0725).

</PRE>If Microsoft Exchange is acting as a requestor:

<OL><P><LI>Start the Microsoft Exchange Administrator program in raw mode: ADMIN /R
</OL>2. Select the DirSync Requestor object you created under the site
<PRE>   Connections object.
</PRE></OL>3. Select the Raw Properties option from the File menu.
4. Set the following attributes to 0: DXA-Conf-Seq, DXA-Imp-Seq, DXA-Req-
<PRE>   Seq, and DXA-Svr-Seq.
</PRE>5. Stop and start the Microsoft Directory Synchronization Service.
6. You must remove and reconfigure the Microsoft Exchange postoffice
<PRE>   through the Microsoft Mail Administrator program on the MSMail DirSync
   server as well (refer to AppNote WA0725).
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : XFOR kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
