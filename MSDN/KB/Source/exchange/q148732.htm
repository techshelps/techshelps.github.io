

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Setting TCP/IP Port Numbers for Internet Firewalls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148732">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1996/11/14">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article explains how to configure the Microsoft Exchange Information  Store, Directory, and System Attendant Services to use predefined TCP/IP  port numbers. This is useful when configuring Internet firewalls or  routers.   MORE INFORMATION  S...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKG,QDJP,QAL0,QAKD,QBWP,QAB4,QACK,QDJ3,QDIZ,QBVW,QAIJ,QAAP,QDNT,QBXI,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Setting TCP/IP Port Numbers for Internet Firewalls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148732</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to configure the Microsoft Exchange Information 
Store, Directory, and System Attendant Services to use predefined TCP/IP 
port numbers. This is useful when configuring Internet firewalls or 
routers. 
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Some Internet firewalls may not accept TCP/IP port numbers that Microsoft 
Exchange Server uses for Remote Procedure Call (RPC) communication. To 
solve this problem, add port 135 to your firewall and configure Microsoft 
Exchange Server to use the ports that your firewall will allow. The 
computer must be restarted for these changes to take effect.
<P>
To configure the RPC Port for the Microsoft Exchange Directory Service:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that 
may require you to reinstall Windows NT. Microsoft cannot guarantee that 
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      SYSTEM\CurrentControlSet\Services\MSExchangeDS\Parameters
</PRE>
<P><LI>Add the following registry value
<P>
<P><PRE>      TCP/IP port
</PRE><P>
   as DWORD value, specifying the port to be used. The RADIX should
   be set to decimal when entering the value.

<P><LI>Quit Registry Editor.
<P>
</OL>Configuring the RPC Port for the Microsoft Exchange Information Store 
Service:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that 
may require you to reinstall Windows NT. Microsoft cannot guarantee that 
problems resulting from the incorrect use of Registry Editor can be solved. 
Use Registry Editor at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      SYSTEM\CurrentControlSet\Services\MSExchangeIS\ParametersSystem
</PRE>
<P><LI>Add the following registry value
<P>
<P><PRE>      TCP/IP port
</PRE><P>
   as DWORD value, specifying the port to be used. The RADIX should 
   be set to decimal when entering the value.

<P><LI>Quit Registry Editor.
<P>
</OL>Configuring the RPC Port for the Microsoft Exchange System Attendant:
<P>
In order to Administer an Exchange Server across a firewall, the 
Microsoft Exchange System Attendant should be configured to use a 
specific RPC port as well.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that 
may require you to reinstall Windows NT. Microsoft cannot guarantee that 
problems resulting from the incorrect use of Registry Editor can be solved. 
Use Registry Editor at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      SYSTEM\CurrentControlSet\Services\MSExchangeSA\Parameters
</PRE>
<P><LI>Add the following registry value
<P>
<P><PRE>      TCP/IP port
</PRE><P>
   as DWORD value, specifying the port to be used. The RADIX should 
   be set to decimal when entering the value.

<P><LI>Quit Registry Editor.
<P>
</OL>Note: The DWORD value should be in decimal.
<P>
Note: This ONLY has to be changed on the computer running Microsoft
Exchange Server. Clients always connect to port 135, the RPC endpoint 
mapper, and then ask what ports they should use for the Directory and
Information Store Services. 
<P>
WARNING: DO NOT assign ports immediately above the 1023 range. For 
more information about the ramifications and guidelines for static 
port assignment of Exchange services, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q180795.htm">Q180795</A></B>
   TITLE: XADM: Intrasite Directory Replication Fails with Error 1720
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : XADM kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
