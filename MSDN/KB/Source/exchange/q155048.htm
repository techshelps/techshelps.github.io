

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: Troubleshooting Startup of Windows Client Using TCP/IP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155048">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/08/20">
<META NAME="Keywords" CONTENT="XCLN kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When you start the Microsoft Exchange client, one of the more common reasons for slow startup is the failure to resolve the Microsoft Exchange Server TCP/IP host name. This document discusses the steps for eliminating host name resolution issues on...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QARL,QDIV,QANE,QAUJ,QDL9,QBWQ,QBWO,QBWN,QDNT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Troubleshooting Startup of Windows Client Using TCP/IP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155048</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows 95 client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows NT client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you start the Microsoft Exchange client, one of the more common
reasons for slow startup is the failure to resolve the Microsoft Exchange
Server TCP/IP host name. This document discusses the steps for eliminating
host name resolution issues on client computers with TCP/IP running. Start
troubleshooting by going to the Microsoft Exchange Server properties of the
user profile. With the correct server name and mailbox entered, click the
Check Name button to get an idea of how much time it is taking to resolve
the name. If the time to resolve is greater than 30 to 40 seconds, continue
the troubleshooting steps in this article to help improve startup times.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In the Microsoft Exchange Server properties of the client profile, type the
IP address instead of the server name and click Check Name. This will not
only test name resolution, but also will do a basic RPCPING to the computer
running Microsoft Exchange Server.
<P>
If the IP address fails to resolve to the correct Exchange Server name,
there is either a problem with Remote Procedure Calls (RPCs) to the
computer running Microsoft Exchange Server or a problem with the IP Address
of the computer running Microsoft Exchange Server. if the IP address
failed, proceed as below:

<OL><P><LI>At an MS-DOS prompt, try to PING the IP address of Exchange Server. If
  this fails, then there may be a networking issue or a TCP/IP
</OL>configuration
<PRE>  issue that is not allowing connection to the Exchange Server machine.
</PRE></OL>This
<PRE>  issue must be resolved before the Exchange client will be able to connect
  to the Exchange Server over TCP/IP.

</PRE><P><LI>If a Ping of the IP address works correctly, but a profile checkname
  fails to resolve the IP address, then the RPC Binding Order may be
  incorrect. Ensure the RPC Binding Order includes ncacn_ip_tcp first in
</OL>the
<PRE>  list. (ref <B><A HREF="../EXCHANGE/Q136516.htm">Q136516</A></B>)

</PRE></OL>IP Address Resolves?
If the IP address quickly resolves to the correct Microsoft Exchange Server
name, continue with Host Name Resolution Troubleshooting below:
<P>
Host Name Resolution Troubleshooting - Ping Microsoft Exchange Server Name:
<P>
At this point, the computer running Microsoft Exchange Server is available
for connection via IP address. The next step is to verify host name
resolution. At an MS-DOS prompt, ping the Microsoft Exchange Server name.
<P>
Ping Server Name Succeeds?
<P>
If Pinging the Exchange Server Name works in a timely manner, but client
starts up slowly, the RPC binding order may need to be modified.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q136516.htm">Q136516</A></B>
   TITLE     : XCLN: Improving Windows Client Startup Times

</PRE>Ping Server Name Fails?
<P>
Run IPCONFIG /all (or WINIPCFG on Windows 95) and check what address is set
in the Domain Name Server (DNS) entry field. DNS can be set for all TCP
clients by means of dynamic host configuration protocol (DHCP) or by using
the TCP Configuration in Control Panel for the individual computers.
Continue with DNS Configuration Troubleshooting below.
<P>
DNS Configuration Troubleshooting - Ping DNS IP Address
<P>
If IPCONFIG displays an IP address in the DNS Servers field, then the
client machine is configured to resolve Host Names via DNS. The next step
in trouble shooting is to verify the DNS Server is available. At an MS-DOS
prompt, Ping the DNS IP Address. If the DNS does not respond to the
request, additional attempts are made at 5, 10, 15, 20, 5, 10, 15, and 20-
second intervals. This is the design of DNS and is usually the root cause
of slow client startup.
<P>
Ping DNS Server Fails?
<P>
If the client computer is configured for a DNS server that is not
available, DNS either needs to be disabled or needs to be configured for a
DNS server that is available at all times.
<P>
Ping DNS Server Succeeds?
<P>
If the DNS server is available and configured properly, the Microsoft
Exchange Server name and IP address need to be added to the DNS database.
Once this is done, pinging the Microsoft Exchange Server name will resolve
to an IP address by the DNS server, allowing for faster startup times of
the Microsoft Exchange client.
<P>
Add Microsoft Exchange Server to HOSTS File
<P>
The HOSTS file gets read every time a Winsock application attempts to
resolve a host name. There are NO #PRE options to preload entries (that is
how it is done in LMHOSTS). You can add the Microsoft Exchange Server entry
to the HOSTS file and try again without having to restart Windows. The
HOSTS file on Windows 95 is located in the Windows directory and on Windows
NT in Windows\System32\Drivers\&lt;and so on&gt;.
<P>
Name Resolution
<P>
Below is the order of host name resolution over TCP/IP:
<P>
<PRE>   1. HOSTS file
</PRE>2. DNS Server
3. NetBIOS Cache
4. WINS server
5. Broadcast
6. LMHOSTS file
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbfaq winnt win16 win95<BR>
Keywords          : XCLN kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
