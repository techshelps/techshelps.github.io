

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: Interoperability Between Exchange Server 5.0 and 5.5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177956">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/12/10">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00 kbfix5.00.sp2 XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  There are a number of non-trivial interoperability issues between Exchange 5.0 and 5.5 in RTF to HTML and Imail.  Some of the issues are the following:  1. If you create an HTML in any codepage OTHER then ANSI / ISO-8859-1 and put some internationa...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QAYV,QBWA,QADF,QAMB,QAG9,QA3Z,QA3Y,QASJ,QABI,QDO3,QAYZ,QAR4,QAHT,QADX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Interoperability Between Exchange Server 5.0 and 5.5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177956</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
There are a number of non-trivial interoperability issues between Exchange
5.0 and 5.5 in RTF to HTML and Imail.  Some of the issues are the
following:

<OL><P><LI>If you create an HTML in any codepage OTHER then ANSI / ISO-8859-1 and
</OL>put some international characters between &lt;TT&gt; and &lt;/TT&gt;.  Then convert the
HTML round trip HTML-&gt;RTF-&gt;HTML the International characters between &lt;TT&gt;&gt;
and &lt;/TT&gt; are corrupted.  This corruption is permanent and can't be fixed
y changing the browser character set or font.
2. After HTML-&gt;RTF conversion, an extra space at the line following
&lt;Hn&gt;...&lt;/Hn&gt; is emitted.
3. Loss of background color and bad formatting of table cells. Incorrect
handling of &lt;TD&gt; ... &lt;TD&gt; sequence (with no &lt;/TD&gt;).
4. The background color information is appended as text output after HTML-
&gt;RTF-&gt;TEXT conversion.
5. The Body tag property is corrupted when converted to Unicode.
6. There is corruption of the &lt;TITLE&gt; tag of an embedded message when
converting to Unicode.
7. Foreign mail using extended Latin characters gets sent as US-ASCII with
all the accents stripped.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
The same corruption happens for any HTML tag implying monospace font, i.e.,
&lt;TT&gt;, &lt;KBD&gt;, &lt;SAMP&gt;, and &lt;CODE&gt;.  The problem is caused by not marking the
monospace font (second font in RTF font table) with the correct character
set, which means the font is treated as ANSI.
<P>
Since cell formatting is independent of the formatting outside of the table
(IE and NN behavior), we now save and restore overlapping tag stack around
tables and emit \plain keyword in RTF at the table start. Also, we make
sure any new cell terminates the previous one and any cell formatting is
ind
pendent of each other (e.g., FONT started and not terminated in one cell
does not propagate to the next one).
<P>
RTF keywords \background and \shpinst needed to be marked as IGNORABLE, so
that the destination gets ignored for plain text processing when in the
encapsulated range.
<P>
Now we have better codepage detection.  In ambiguous cases (when the
character fits into multiple codepages),we use the non-Western one.
Specifically, if you compose a message using a non-Western character set on
a machine set to the Western locale, we will use that character set even if
the first
nternational character encountered fits into Western codepage.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem Microsoft Exchange Server
version 5.0.
<P>
This problem has been corrected in the latest U.S. Service Pack for
Microsoft Exchange Server version 5.0. For information on obtaining the
Service Pack, query on the following word in the Microsoft Knowledge 
Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE></OL> 
<PRE>Keywords          : kbbug5.00 kbfix5.00 kbfix5.00.sp2 XFOR
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
