

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: How to Force Static Mapping of Sockets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155831">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1996/09/10">
<META NAME="Keywords" CONTENT="XCLN kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article tells you how to allow the Microsoft Exchange Client to  connect to Microsoft Exchange Server over an existing connection to the Internet and through a firewall. In order to do this, make the ports assigned to these connections static....">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKG,QDJP,QAI5,QBXB,QACK,QBG2,QA63,QAL0,QBVW,QAYY,QARL,QAAP,QAB4,QBSO,QATJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: How to Force Static Mapping of Sockets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155831</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article tells you how to allow the Microsoft Exchange Client to 
connect to Microsoft Exchange Server over an existing connection to the
Internet and through a firewall. In order to do this, make the ports
assigned to these connections static. This requires you to add entries to
the registry.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The computer must be restarted for these changes to take effect.
<P>
To make the ports static:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows NT. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeDS\Parameters
</PRE><P>

<P><LI>Add the following entry for the Microsoft Exchange Directory service:
<P>
<P><PRE>      TCP/IP port REG_DWORD
      DATA: &lt;port number to assign&gt;
</PRE><P>
   NOTE:  DO NOT assign ports immediately above the 1023 range. For more
<PRE>          information about the ramifications and guidelines for static
          port assignment of Exchange services, please see the following
          article in the Microsoft Knowledge Base:

             ARTICLE-ID: <B><A HREF="../EXCHANGE/Q180795.htm">Q180795</A></B>
             TITLE: XADM: Intrasite Directory Replication Fails with Error
                    1720

   EXAMPLE: "TCP/IP Port"=dword:000004C9(1225)

   The decimal number 1225 was used for the DS, which is 4C9 in hexadecimal.

</PRE><P><LI>Go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeIS\ParametersSystem
</PRE>
<P><LI>Add the following entry for the Information Store:
<P>
<P><PRE>      TCP/IP port REG_DWORD
      DATA: &lt;port number to assign&gt;
</PRE><P>
   NOTE:  DO NOT assign ports immediately above the 1023 range. For more
<PRE>          information about the ramifications and guidelines for static
          port assignment of Exchange services, please see the following
          article in the Microsoft Knowledge Base:

             ARTICLE-ID: <B><A HREF="../EXCHANGE/Q180795.htm">Q180795</A></B>
             TITLE: XADM: Intrasite Directory Replication Fails with Error
                    1720

   EXAMPLE: "TCP/IP Port"=dword:000004CA(1226)

   The decimal number 1226 was used for the IS, 4CA in hexadecimal format.

</PRE><P><LI>Quit Registry Editor.
<P>
</OL>After this, you will need to configure the packet filter (or firewall) to
allow TCP connections to be made to these ports as well as to port 135.
<P>
<P><h3>Further Explanation</h3>
 
<P>
A packet filter (or firewall) will deny connection attempts made to any
port for which you have not explicitly allowed connections. Microsoft
Exchange Server does use a well-known static port (port 135) to listen for
client connects to the RPC Endpoint Mapper Service. However, after the
client connects to this socket, Microsoft Exchange Server then re-assigns
the client two random ports to use when communicating with the Directory
and the Information Store. This makes it impossible to allow these through
the firewall without forcing them to be statically assigned.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please refer to the Readme.wri file on the 
Microsoft Exchange Server version 4.0 compact disc.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : XCLN kbusage<BR>
Version           : 4.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
