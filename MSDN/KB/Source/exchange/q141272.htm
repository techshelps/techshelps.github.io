

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: How Exchange Clients Use MSMAIL.INI and SHARED.INI </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141272">
<META NAME="KBModify" CONTENT="1997/04/21">
<META NAME="KBCreate" CONTENT="1995/12/14">
<META NAME="Keywords" CONTENT="kbenv kbusage XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   This article describes...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARL,QAOG,QA0B,QBE7,QBE6,QDL9,QBWQ,QBWO,QBWN,QA3A,QBWP,QBBI,QAYC,QBVV,QAV1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: How Exchange Clients Use MSMAIL.INI and SHARED.INI</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141272</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 95 client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows NT client, versions 4.0 and 5.0
</UL> 
<P>
IMPORTANT: This article contains information about the registry. Before you
edit the registry, you should first make a backup copy of the registry
files (System.dat and User.dat). Both are hidden files in the Windows
folder.
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how the Microsoft Exchange Windows client use the
MSMAIL.INI and SHARED.INI files that are created by version 3.x of
Microsoft Mail for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Exchange 16-Bit Client</h3>
 
<P>
The Microsoft Exchange client for Windows 3.x does not support 32-
bit extensions. It reads the MSMAIL.INI and SHARED.INI files, just
like the Microsoft Mail client for Windows 3.x. On startup, the
Exchange 16-bit client performs the following steps:

<OL><P><LI>The Exchange 16-bit client searches the [Options] section of
   EXCHNG.INI for the SharedExtsDir, SharedExtsServer, and
   SharedExtsPassword entries. If found, an anonymous connection
   to the server is made with the provided password. Then a
   search for the SHARED.INI file in the directory specified by
   any SharedExtsDir entry is performed.

<P><LI>The Exchange 16-bit client searches the MSMAIL.INI file for a
   SharedExtensionsDir entry. If found, Exchange will search for
   the SHARED.INI file in the directory indicated. The Exchange 16-
   bit client will never look for the MSMAIL32.INI or SHARED32.INI
   file.

<P><LI>If a SHARED.INI file is found, Exchange reads the extension entries
   specified in the [Custom Menus], [Custom Commands], and [Custom
   Messages] sections.

<P><LI>The Exchange 16-bit client then reads the extension entries
   ([Custom Menus], [Custom Commands], and [Custom Messages]
   sections) specified in the MSMAIL.INI file.
<P>
</OL>The Exchange 16-bit client will ignore any extension entries whose
version parameter is appended with a ',32' (for example, 3.0,32) as
these are only supported by Exchange 32-bit clients.
<P>
NOTE: Specifying the bit of the extension in the version number
will result in a syntax error if read by the Mail 3.x client for
Windows 3.x or Microsoft Windows NT.
<P>
<P><h3>Microsoft Exchange 32-Bit Client</h3>
 
<P>
The 32-bit Microsoft Exchange client supports 16-bit Microsoft Mail 3.x
client extensions as well as 32-bit extensions for the Microsoft Windows NT
version of the Microsoft Mail 3.x client. The following steps describe how
the extensions are read when the Microsoft Exchange 32-bit client starts
up.

<OL><P><LI>The Microsoft Exchange 32-bit client will look for extensions
   in the HKEY_CURRENT_USER\Software\Microsoft\Mail\Microsoft Mail
   registry key. This is the location where extensions for the
   Microsoft Mail 3.x client for Windows NT are installed. In order to
   be consistent across 32-bit platforms, this registry is also used
   by the Microsoft Exchange client for Windows 95.

<P><LI>The Microsoft Exchange 32-bit clients look in the registry for
   a SharedExtsDir in the KEY_CURRENT_USER\Software\Microsoft
   \Exchange\Client\Options registry key. If present, it also gets
   the SharedExtsServer and SharedExtsPassword entries. If the
   SharedExtsDir entry is not present, it looks in the MSMAIL32.INI
   file for the Microsoft Mail 3.x SharedExtensionsDir entry. If it
   is not found, it will use the MSMAIL.INI file to look for the
   SharedExtensionsDir. If a SharedExtensionsDir entry is found, it
   is parsed into the Microsoft Exchange equivalents. An anonymous
   connection to the server is made with the provided password, if
   required.

<P><LI>The Microsoft Exchange 32-bit client looks in the shared directory for a
   SHARED32.INI file. If found, it will not look for SHARED.INI file.

<P><LI>The Microsoft Exchange 32-bit client reads extensions ([Custom Menus],
   [Custom Commands], and [Custom Messages] sections) from the
   SHARED32.INI file found in step 3.

<P><LI>The Microsoft Exchange 32-bit client reads extensions from the
   MSMAIL32.INI file.

<P><LI>If the SHARED32.INI file is not found, the Microsoft Exchange 32-bit
   client looks for a SHARED.INI file in the same location.

<P><LI>The Microsoft Exchange 32-bit client reads the MSMAIL.INI file.
<P>
</OL>Microsoft Exchange supports an enhancement to the version parameter of the
extension registration entry. The version number can be followed by ',16'
to indicate a 16-bit extension DLL or by ',32' to indicate a 32-bit
extension DLL. If the version does not specify either of these settings,
Microsoft Exchange assumes that the bit of the extension matches the
bit corresponding to the file name.
<P>
For example, the MSMAIL32.INI file corresponds to 32 bits, and the
SHARED.INI file corresponds to 16 bits. Specifying the bit of the
extension in the version number will result in a syntax error if it is read
by the Microsoft Mail 3.x client for either Windows 3.x or Windows NT.
<P>
For additional information on how the Microsoft Exchange client can be
configured to exclude certain Microsoft Mail 3.x client extensions, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q136804.htm">Q136804</A></B>
   TITLE     : Loading/Disabling MS Mail 3.x Win Client Extensions
</PRE></OL>crossref
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: faq<BR>
Keywords            : kbenv kbusage XCLN<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
