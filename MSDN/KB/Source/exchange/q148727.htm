

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: Internet Mail Connector Fails to Start </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148727">
<META NAME="KBModify" CONTENT="1997/11/26">
<META NAME="KBCreate" CONTENT="1996/03/20">
<META NAME="Keywords" CONTENT="XFOR kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  If you attempt to start the Microsoft Exchange Internet Mail Connector (IMC) service from the Services tool in Control Panel, or from a command window with  net start msexchangeimc,  the following error may appear:     Error 2140, the Specified Ser...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAYC,QAIJ,QAC2,QBWS,QBWD,QDIV,QBVV,QDIZ,QA9N,QAPN,QAAP,QAR5,QANJ,QADK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Internet Mail Connector Fails to Start</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148727</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you attempt to start the Microsoft Exchange Internet Mail Connector
(IMC) service from the Services tool in Control Panel, or from a command
window with "net start msexchangeimc," the following error may appear:
<P>
<PRE>   Error 2140, the Specified Service failed to start.

</PRE>After this error a notification dialog box appears, stating that the
service failed to respond to the service control request. Depending on your
hardware and the resource activity, this notification may take several
hours to appear.
<P>
CAUSE
 
<P>
Commonly known reasons for the IMC to fail on startup:

<UL><LI>The property pages for the IMC have not been configured.

<LI>The startup account on the service is not correct.

<LI>Non-replicated or incorrect IMC Address Space.

<LI>The Windows NT TCP/IP has not been configured.

<LI>The X.400 address of the IMC Administrator has been removed.

<LI>Problems with the Queue.dat or a data file:
<P><PRE>      C:\exchsrvr\imcdata\queue.dat.
</PRE>
<LI>Messages are stuck in the MTS-IN or MTS-OUT queue
<P>
</UL><h2>RESOLUTIONS</h2>
 
<P>
<P><h3>The Property Pages for the IMC Have Not Been Configured:</h3>
 
<P>
Refer to chapter 11 in the "Microsoft Exchange Server Administrator s
Guide" for more information. Commonly, administrators omit the
configuration of the IMC s Address Space tab. To correctly configure it:

<OL><P><LI>Click the New Internet button, leave the E-mail Domain blank, click the
   Apply button, and click OK.

<P><LI>Now you need to recalculate the routing information on this computer
   running Microsoft Exchange Server. To do this, drop out of the IMC
   object, highlight the Configuration container, review the properties of
   the Site Addressing object, select the Routing tab, and click the
   Recalculate Routing button.
<P>
</OL><h3>Non-Replicated or Incorrect IMC Address Space:</h3>
 
<P>
If the IMC has been configured, but has not been used, it is possible that
its Address Space is not active or is incorrect in the Microsoft Exchange
environment. To ensure a correct Address Space is used, it is easiest to
remove the existing Internet Address Space(s) for the IMC and re-enter it.
In short, Address Spaces are simply the Microsoft Exchange way to filter
outbound IMC mail by Domain Name. If this entry is invalid or not recorded
correctly in the Windows NT Registry, it will result in the above error. To
refresh this, do the following:

<OL><P><LI>Click the IMC object s Address Space tab, select the SMTP
   Address Type[s] in the window, and click the Remove button.

<P><LI>Drop out of the IMC object, highlight the Configuration container, and
   review the properties of the Site Addressing object.

<P><LI>Select the Routing tab and press the Recalculate Routing button.
<P>
</OL><h3>Windows NT TCP/IP Has Not Been Configured:</h3>
 
<P>
The administrator must configure the DNS button under TCP/IP in Control
Panel Network. The Host Name, Domain Name, and the Domain Name
Service Search Order IP number must be correctly configured.
<P>
<P><h3>The X.400 Address of the IMC Administrator Has Been Removed:</h3>
 
<P>
To verify, run the Microsoft Exchange Administrator program and check the
Administrator s Mailbox on the Internet Mail tab in the IMC object. Once
you find the Administrator account, go back to the Global Address List and
review the Properties of this account. To verify, select the Email Address
tab. There should be three E-mail addresses here by default: one MS, one
SMTP, and one X.400. This account must have all three address types. The
lack of an X.400 address will result in the above error.
<P>
<P><h3>Problems with the Queue.dat File: C:\Exchsrvr\Imcdata\Queue.dat:</h3>
 
<P>
The Queue.dat file contains administrative information about the status of
IMC messages and queues. This file may be purged to alleviate the above
error. When the IMC is restarted it will recreate this file.
<P>
NOTE: Removing the queue.dat file should not be a common occurrence and
should only be done when the IMC is not running. If this file is marked
Read-Only, remove the attribute, delete the file, and restart the IMC
Service.
<P>
If, after deleting the Queue.dat file the IMC, still does not start:

<OL><P><LI>Move the files in the Imcdata\In and the Imcdata\Out directories to
   another location.

<P><LI>Delete the queue.dat file.

<P><LI>Start the IMC.
<P>
</OL>IF the IMC now starts, you can:

<OL><P><LI>Stop the IMC.

<P><LI>Move the message files back into the respective directories

<P><LI>Delete the queue.dat file.

<P><LI>Restart the IMC.
<P>
</OL>Moving the messages in a few at a time will narrow down the offending file,
which should be deleted and not processed.
<P>
Messages Are Stuck in the MTS-IN or MTS-OUT Queue
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: 165505
   TITLE     : XFOR: How to View/Delete Messages in MTS-IN and MTS-OUT
               Queues


</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
The Queue.dat file can be safely renamed or deleted without fear of losing
mail. The IMC should start up correctly and then process mail normally.
<P>
The Queue.dat file contains administrative information about the status of
Internet mail queues and messages, both inbound and outbound. This file
does not contain the actual messages themselves. If this file is deleted or
renamed, Microsoft Exchange Server should rebuild or recreate the file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : XFOR kbusage<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>
Issue type        : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
