

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCON: Sockets Error When Connecting to Foreign X.400 MTA </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151626">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1996/05/28">
<META NAME="Keywords" CONTENT="kb3rdparty XCON">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT=" SYMPTOM  When you connect to foreign X.400 MTAs using the Microsoft Exchange X.400 Connector via TCP/IP, SOCKETS ERRORs might occur. The following errors may be written to the NT Event log when the connection is initiated from the foreign MTA.  mess...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QAAP,QAB4,QA2O,QABA,QBG2,QBE7,QBE6,QBEK,QBEJ,QAEV,QDNT,QAIB,QAIA,QBWD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Sockets Error When Connecting to Foreign X.400 MTA</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151626</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOM</h2>
 
<P>
When you connect to foreign X.400 MTAs using the Microsoft Exchange X.400
Connector via TCP/IP, SOCKETS ERRORs might occur. The following errors may
be written to the NT Event log when the connection is initiated from the
foreign MTA.
<P>
message NMI9236: Internal Operating System Error, severity 12
<P>
<PRE>          (BASE IL TCP/IP DRVR(22) Proc 262) 04-10-96 05:52:10pm
          Receive socket closed on CB 1
            Socket error   0

</PRE>message NMI1279: X.400 Service Event, severity 8
<P>
<PRE>          (PLATFORM KERNEL(6) Proc 94) 04-10-96 05:52:10pm
          Session - Remote initiation of Transport Disconnection
            Control block index 1, type 1

</PRE>message NMI2036: Internal Processing Error, severity 10
<P>
<PRE>          (BASE TCP/IP DRVR(22) Proc 138) 04-10-96 05:52:10pm
          Lost connections to locality 4

</PRE>message NMI9225: Internal Processing Error, severity 14
<P>
<PRE>          (BASE IL TCP/IP DRVR(22) Proc 255) 04-10-96 05:52:10pm
          Bad message type 769 for socket CB 1 in state 2

</PRE>As a result, the foreign MTA is not able to establish a connection.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Analyzing the connection attempt shows that in the example below the remote
MTA is not able to interpret a CONNECT CONFIRM. This frame was sent by
Microsoft Exchange as an answer to a CONNECT REQUEST.
<P>
The following is a traced CONNECT CONFIRM frame sent by Microsoft Exchange:
<P>
<PRE>ADDR  HEX                                                ASCII
</PRE>0000  00 00 A2 00 C0 4A 00 80  5F D4 A0 48 08 00 45 00  .....J.._..H..E.
0010  00 54 E9 A6 40 00 20 06  04 0A 86 26 34 4D 86 26  .T..@. ....&amp;4M.&amp;
0020  2C 5A 00 66 06 13 01 CF  46 C8 5D 5B 6A 31 50 18  ,Z.f....F.][j1P.
0030  22 09 60 73 00 00 03 11  00 2C 27 D0 01 CA 00 29  ".`s.....,'....)
0040  00 C1 0D 53 57 49 53 53  4C 49 46 45 54 53 41 50  ...SWISSLIFETSAP
0050  C2 0D 45 58 43 48 41 4E  47 45 54 53 41 50 31 C0  ..EXCHANGETSAP1.
<PRE>0060  01 0B                                             ..

</PRE>This trace shows Byte 37 as set to 11.
A receiving MTA may refuse this frame and disconnect.
<P>
<P><h2>STATUS</h2>
 
<P>
According to RFC-1006, the Byte at address 37 is reserved, meaning a
receiving MTA should not try to interpret this Byte. Instead of refusing
the frame it should accept it.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kb3rdparty XCON<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
