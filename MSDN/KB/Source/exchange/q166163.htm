

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCLN: Err Msg: No Transport Provider Was Available </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166163">
<META NAME="KBModify" CONTENT="1997/12/31">
<META NAME="KBCreate" CONTENT="1997/03/31">
<META NAME="Keywords" CONTENT="XCLN kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information on how to do this, view the  Restoring the Registry  online Help t...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QBJZ,QAEV,QAL0,QAKD,QAC2,QARL,QAP2,QBVV,QAIJ,QAH6,QAR5,QBWS,QA6A,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Err Msg: No Transport Provider Was Available</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166163</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 3.x client, version 4.0
<LI>Microsoft Exchange Windows 95 client, version 4.0
<LI>Microsoft Exchange Windows NT client, version 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it
if a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
This problem occurs with Microsoft Exchange Client in offline mode. When
you reply to an SMTP message for which a custom recipient exists in the
Exchange Server Global Address List (GAL), the following non-delivery
report (NDR) is returned immediately:
<P>
<PRE>   No transport provider was available for delivery to this recipient.

</PRE><h2>CAUSE</h2>
 
<P>
The Microsoft Exchange Server Internet Mail Connector (IMC) resolves the
reply-to address as an internal Exchange Server mailbox when receiving mail
from the Internet. When the IMC does a directory look-up and finds the
sender's e-mail address in the directory, it replaces the SMTP address with
the X.500 address. This makes the message appear as though it has been sent
internally, and confuses the client when offline.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" online Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" online Help
topics in Regedt32.exe. Note that you should back up the registry before
you edit it.
<P>
To resolve this problem, you must perform these steps on the computer
running Microsoft Exchange Server (not on the client computer). There are
different resolutions for Exchange Server versions 4.0 and 5.0:
<P>
<P><h3>Exchange Server 4.0</h3>
 
<P>
This fix allows verification of messages sent by certain Exchange users.
The FROM address is compared to a list of users. If the address matches,
the message is not delivered and an event log message is generated. It
is also possible to save the message in order to identify the first SMTP
host that was contacted.

<OL><P><LI>Install Service Pack 3 and perform the following:

<P><LI> Stop the IMC.

<P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Go to the following key in the registry:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services
      /MSExchangeIMC/Parameters
</PRE>
<P><LI>On the Edit menu, click Add Value and add the following entry:
<P>
<P><PRE>      Value Name: TurfDir
      Data Type: REG_SZ
</PRE>
<P><LI>A dialog box entitled String Editor will be presented. Add the following
   information:
<P>
<P><PRE>      C:\EXCHSRVR\IMCDATA\TURFDIR
</PRE>
<P><LI>On the Edit menu, click Add value and add the following entry:
<P>
<P><PRE>      Value Name: TurfTable
      Data Type: REG_MULTI_SZ
</PRE>
<P><LI>A dialog box entitled Multi-String Editor will be presented. Add the
   following information :
<P>
<P><PRE>      user1@site.domain
      user2@site.domain
</PRE><P>
   The Turf Table contains a list of e-mail addresses used to verify the
   FROM address on incoming Internet mail. They should be entered one per
   line with no extra spaces or delimiters. They are case insensitive. If a
   match is found, the message will be saved to the directory specified in
   the TURFDIR value.

<P><LI>Exit Registry Editor.

<P><LI>Restart the Internet Mail Connector service.
<P>
</OL><h3>Exchange Server 5.0</h3>
 

<OL><P><LI>Stop the Internet Mail Service.

<P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Go to the following key in the registry:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services
      /MSExchangeIMC/Parameters
</PRE>
<P><LI>Edit the registry using Regedt32.exe and change the value for ResolveP2
   registry key.

<P><LI>Highlight the value ResolveP2.

<P><LI>On the Edit menu, click DWORD and change the value from 0 to 1.

<P><LI>Exit Registry Editor.
<P>
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The following are further aspects of the symptom:

<UL><LI>If Exchange Client is started online, and the same message is replied
   to, the "no transport provider" NDR does not occur.

<LI>If you are offline and you reply to the message, and then retype the
   SMTP message exactly as it appears on the To line, the NDR does not
   occur

<LI>Adding entries to the PAB or OAB does not change this behavior.

<LI>If, after you click Reply, the properties of the To line are brought up,
   the properties show up as a Distinguished Name (it looks like any other
   native Exchange Client user), not as a PAB-type (SMTP) entry.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: spoof table<BR>
Keywords          : XCLN kbusage<BR>
Version           : WinNT:4.0; Win95:4.0;WINDOWS:4.0<BR>
Platform          : Win95 WINDOWS winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
