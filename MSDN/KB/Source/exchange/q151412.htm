

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCON: MTA Only AllowS 64 TCP/IP or TP4 Connections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151412">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1996/05/22">
<META NAME="Keywords" CONTENT="XCON kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Server message transfer agent (MTA) has a limit on the number of allowed socket control blocks for TCP and TP4. This limit is currently a shared maximum of 64 (0x40). The minimum number that must be allocated to either TCP or...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAHC,QABN,QDNT,QABA,QAR4,QBG2,QA2O,QAI5,QAB4,QAA8,QBWD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: MTA Only AllowS 64 TCP/IP or TP4 Connections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151412</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Server message transfer agent (MTA) has a limit on
the number of allowed socket control blocks for TCP and TP4. This limit is
currently a shared maximum of 64 (0x40). The minimum number that must be
allocated to either TCP or TP4 is 2, which means that the maximum any one
transport stack can have allocated is 62 (0x3E). The default is set to 20
(0x14) for each.
<P>
When the limit is reached, the following error message is logged in the
Windows NT event log:
<P>
<PRE>   MSExchangeMTA   Warning   Resource   9156
   A resource limit has been reached while attempting to open an
   association. There are no free control blocks available for network type
   1. The configured count is 40. [BASE IL MAIN BASE 1 282] (10)

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange version
4.0.
A supported fix is now available, but has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Technical Support for more information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The MTA uses one control block for each connection (whether remotely or
locally initiated). It also uses one to listen for incoming connections.
<P>
If slow links (slower than 128Kbps) and/or large messages are involved and
message backlogging is therefore likely, you can allow 10 control blocks
per X.400-Link. This enables MTA traffic to be handled more efficiently by
virtue of multiple connections to each remote link, without suffering from
a resource shortage.
<P>
NOTE: There is no requirement to change the TP4 Thread or TCP/IP Thread
values; the code will self-adjust based on the count of control blocks.
<P>
The following registry values hold the TCP/IP and TP4 control block
settings:
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\CurrentControlSet\
   Services\MSExchangeMTA\Parameters\TCP/IP Control blocks

   HKEY_LOCAL_MACHINE\System\CurrentControlSet\
   Services\MSExchangeMTA\Parameters\TP4 Control blocks

</PRE>With the fix implemented, a maximum total of 2,000 control blocks is
allowed.
<P>
NOTE: If X.25 is also being used as a messaging protocol stack, the total
of X.25 + TCP/IP control blocks can be no greater than 1,250.
 
<PRE>Keywords          : XCON kbusage
Version           : version
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
