

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Replication or Knowledge Consistency Check Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166312">
<META NAME="KBModify" CONTENT="1997/10/01">
<META NAME="KBCreate" CONTENT="1997/04/03">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When attempting to perform a knowledge consistency check (KCC), you receive the following warning:     An error was encountered by the knowledge consistency checker on server    'ServerName'.                                                         ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QAB4,QAAP,QABH,QBXB,QAOC,QACK,QAR4,QAYC,QAFO,QBWS,QBWP,QBVV,QAPN,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Replication or Knowledge Consistency Check Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166312</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Exchange Server version 5.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to perform a knowledge consistency check (KCC), you receive
the following warning:
<P>
<PRE>   An error was encountered by the knowledge consistency checker on server
   'ServerName'. &lt;&lt;0xc1030b1e - The knowledge consistency check did not
   correct directory inconsistencies. Be sure the directory service is
   running, and then try again. If the error recurs, try stopping the
   directory service and the Administrator program and then restarting
   them. To view details of the error, see the application event log in
   the Windows NT Event Viewer on the Microsoft Exchange Server computer
   on which you checked knowledge consistency.

</PRE>You will also receive the following replication error in the application
log:
<P>
<PRE>   Event ID: 1091
   Source: MSExchangeDS
   Type: Warning
   Category: Replication

   The directory replication agent (DRA) attempted to open mail with name
   /o=Organization/ou=SITE/cn=Configuration/cn=Servers/cn=ServerName/cn=
   Microsoft DSA:ServerName but received error 2147942487. Messages could
   not be sent. Make sure that the mail service on this Microsoft Exchange
   Server computer is running.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Error 2147942487 is a Jet-level error indicating that an invalid MAPI
parameter has been passed on by the messaging service
(MAPI_E_INVALID_PARAMETER). This could happen if Mapi32.dll is not a
supported version or the latest version supplied with Exchange or the
latest service pack.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Stop all Exchange services and copy the Mapi32.dll file from the Exchange
Server 5.0 CD. Replace the Mapi32.dll file in the \&lt;system&gt;\system32 with
the correct Mapi32.dll file. Remove the read-only attribute on the
Mapi32.dll file and restart the Exchange services.
 
<PRE>Keywords          : XADM kbusage
Version           : 5.0
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
