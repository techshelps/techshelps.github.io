

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XCON: EDK Gateway Gets Directory Name Instead of E-mail Address </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164697">
<META NAME="KBModify" CONTENT="1997/07/15">
<META NAME="KBCreate" CONTENT="1997/03/06">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix4.00.sp4 kbfix5.00.sp1 kbusage XCON">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  A gateway developed for Microsoft Exchange Server 4.0 may extract a message from a computer running Microsoft Exchange Server that contains a directory name (DN) instead of an e-mail address. This problem occurs if the computer running Microsoft Ex...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXB,QBVW,QAC2,QAUJ,QATJ,QAD2,QAFI,QAYC,QBE7,QBE6,QAR5,QBWD,QAEV,QAN0,QBW4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: EDK Gateway Gets Directory Name Instead of E-mail Address</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164697</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
<P>
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
<LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A gateway developed for Microsoft Exchange Server 4.0 may extract a message
from a computer running Microsoft Exchange Server that contains a directory
name (DN) instead of an e-mail address. This problem occurs if the computer
running Microsoft Exchange Server receives a message from another computer
running Microsoft Exchange Server that is connected over a 1988 X.400 link.
<P>
<P><h2>CAUSE</h2>
 
<P>
In the X.400 P1 header information fields, there is information about the
recipients and originator of an e-mail message. These fields contain the
X.400 addresses, and may contain the directory names of the recipients and
originator. According to the X.400 Blue Book specification, a directory
name is a valid optional field.
<P>
When a message arrives at the gateway's MTS-OUT folder and the originator
or reciepient address is a directory name in the form of
"EX:/O=Org/OU=Site...," the gateway developer should use the
IABContainer::ResolveNames and IAdrBook::PrepareRecips methods to resolve
the directory name to an address that is meaningful to the gateway. To
perform this, the gateway must have access to an address book.
<P>
This may not be possible in certain cases. For example, it is not possible
when sending over the following route:
<P>
<PRE>   Exchange Server 1 -&gt; 1988 X.400 link -&gt; Exchange Server 2 -&gt; Gateway

</PRE>The gateway has an address space for X.400 defined. If there is no
replication between the two Microsoft Exchange Server sites and
organizations, there is no way for the gateway to query an address book. It
may not be possible to resolve the recipient or originator address to a
meaningful e-mail address, and message delivery will fail.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
versions 4.0 and 5.0.
This problem was corrected in the latest Microsoft Exchange Server 4.0 and 5.0
U.S. Service Packs. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug4.00 kbbug5.00 kbfix4.00.sp4 kbfix5.00.sp1 kbusage XCON<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
