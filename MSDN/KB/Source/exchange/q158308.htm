

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: Err Msg: Initialization of Dynamic Link Library Failed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158308">
<META NAME="KBModify" CONTENT="1997/06/24">
<META NAME="KBCreate" CONTENT="1996/10/28">
<META NAME="Keywords" CONTENT="XFOR kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Starting more than seven combined instances of the PCMTA, MSMI, IMC, Schedule+ Free * Busy Connector, MTA, or Directory Synchronization fails on a system running Windows NT 4.0 (or Windows NT 4.0 SP1) and Microsoft Exchange Server 4.0. Seven instan...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAIJ,QBWP,QDL9,QBWQ,QBWO,QBWN,QACK,QAAP,QDNN,QBWS,QAL0,QAKP,QAKD,QABN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Err Msg: Initialization of Dynamic Link Library Failed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158308</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbusage
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server version 4.0
</UL> 
<P>
SYMPTOMS
 
<P>
Starting more than seven combined instances of the PCMTA, MSMI, IMC,
Schedule+ Free &amp; Busy Connector, MTA, or Directory Synchronization fails on
a system running Windows NT 4.0 (or Windows NT 4.0 SP1) and Microsoft
Exchange Server 4.0. Seven instances is generally the limit for running
these services concurrently; however, this may vary, depending on the order
in which the services are started. The eighth instance generates an error
and it fails to start. The error message is as follows:
<P>
<PRE>   Initialization of the dynamic link library D:\WINNT\system32\USER32.dll
   has failed. The process is terminating abnormally.

</PRE>This is followed by a second error message:
<P>
<PRE>   Could not start the &lt;%insert service name here%&gt; on &lt;%computername%&gt;.
   Error 2186: The service is not responding to the control function.

</PRE>No event log errors are reported (with logging at maximum for Microsoft
Exchange).
<P>
CAUSE
 
<P>
The system has run out of memory for creating a new desktop heap for the
service being started.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To fix this problem, edit the registry and restart the computer.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows NT. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Control\SessionManager\SubSystems\Windows
</PRE><P>
   The default data for this value will look something like the following
   (all on one line):
<P>
   %SystemRoot%\system32\csrss.exe ObjectDirectory=\Windows
   SharedSection=1024,3072 Windows=On SubSystemType=Windows
   ServerDll=basesrv,1
   ServerDll=winsrv:UserServerDllInitialization,3
   ServerDll=winsrv:ConServerDllInitialization,2 ProfileControl=Off
   MaxRequestThreads=16

<P><LI>Make the following change to this value:
<P>
   Scan along the line until you reach the part that defines the
   SharedSection values and add ",512" after the second number. This value
   should now look something like the following:
<P>
<P><PRE>      %SystemRoot%\system32\csrss.exe ObjectDirectory=\Windows
      SharedSection=1024,3072,512 Windows=On SubSystemType=Windows
      ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3
      ServerDll=winsrv:ConServerDllInitialization,2 ProfileControl=Off
      MaxRequestThreads=16
</PRE>
<P><LI>Quit Registry Editor and restart the computer.
<P>
</OL>This change will limit the size of desktop heaps created by
non-interactive services to 512K, which should be ample for most services.
<P>
For a fuller definition of what the first two parameters of SharedSection
mean, see Microsoft Knowledge Base article <B><A HREF="../WINNT/Q126962.htm">Q126962</A></B>, referenced below.
<P>
REFERENCES
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q142676.htm">Q142676</A></B>
   TITLE     : Overcoming User32.dll Initialization Failures

   ARTICLE-ID: <B><A HREF="../WINNT/Q126962.htm">Q126962</A></B>
   TITLE     : Increasing the Desktop Application Heap
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory: XFOR<BR>
Additional query words: 4.00 PCMTA event id 7000<BR>
Keywords            : XFOR kbusage<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
